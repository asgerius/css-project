[{"tags": ["vba", "excel", "vbscript", "wsh"], "answers": [{"comments": [{"owner": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "edited": false, "score": 0, "creation_date": 1479999109, "post_id": 40775866, "comment_id": 68800928, "body": "Thanks for your feedback. I get the following error after changing the code: &quot;Cannot run the macro &#39;Backup3&#39;. The macro may not be available in this workbook or all macros may be disabled. Code: 800A03EC. Source: Microsoft Excel.&quot; Error is happening in this line: ObjWB.Application.Run(&quot;Backup3&quot;)."}, {"owner": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "edited": false, "score": 0, "creation_date": 1480000034, "post_id": 40775866, "comment_id": 68801495, "body": "It worked after I moved the macro from Module to Microsoft Excel Objects  --&gt; Sheet1(Sheet1). Changed the line that had error before as: ObjWB.Application.Run(&quot;Sheet1.Backup3&quot;)  - thank you for your feedback, it helped me look to the right place."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 3, "last_activity_date": 1479943984, "creation_date": 1479943984, "answer_id": 40775866, "question_id": 40775689, "link": "https://stackoverflow.com/questions/40775689/running-a-macro-from-a-vbs-file-giving-error/40775866#40775866", "title": "Running a Macro from a VBS File Giving Error", "body": "<p>The workbook that you're referencing in <code>Application.Run</code> has to be open in the context of your <code>Application</code> object.  Just open it first, then call it:</p>\n\n<pre><code>Dim ObjExcel, ObjWB\nSet ObjExcel = CreateObject(\"Excel.Application\")\nObjExcel.Visible = True\n\nSet ObjWB = ObjExcel.Workbooks.Open(\"C:\\Automation\\TestCasesBackupScript.xlsm\")\nObjWB.Application.Run(\"Backup3\")\n\nObjWB.Close False\nObjExcel.Quit\nSet ObjExcel = Nothing\n</code></pre>\n\n<p>Note: If <code>Backup3</code> actually returns a Workbook object (which is the only reason to use the syntax <code>Set ObjWB = ObjExcel.Application.Run</code>, you'll want to capture that reference in its own variable.</p>\n"}], "owner": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3901, "favorite_count": 1, "accepted_answer_id": 40775866, "answer_count": 1, "score": 0, "last_activity_date": 1479943984, "creation_date": 1479942867, "last_edit_date": 1531164843, "question_id": 40775689, "link": "https://stackoverflow.com/questions/40775689/running-a-macro-from-a-vbs-file-giving-error", "title": "Running a Macro from a VBS File Giving Error", "body": "<p>I am using a vbs code to open and run an Excel macro automatically but getting the following error message: </p>\n\n<p><strong>Error:</strong> Cannot run the Macro \"file location\". The macro may not be available in this workbook or all macros may be disabled. \nCode: 800A03EC\nSource: Microsoft Excel </p>\n\n<p><strong>VBS Code:</strong> </p>\n\n<pre><code>Dim ObjExcel, ObjWB\nSet ObjExcel = CreateObject(\"Excel.Application\")\nObjExcel.Visible = True\n\n\nSet ObjWB = ObjExcel.Application.Run(\"C:\\Automation\\TestCasesBackupScript.xlsm!Backup3\")\n\n\nObjWB.Close False\nObjExcel.Quit\nSet ObjExcel = Nothing\n</code></pre>\n\n<p>Macro is enabled and the \"Backup3\" is the Sub name in a module of TestCasesBackupScript.xlsm file. </p>\n\n<p>Hoping for feedback.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "connection-string"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479942939, "post_id": 40775643, "comment_id": 68775112, "body": "What type of database are you connecting <i>to</i>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1479948542, "post_id": 40775643, "comment_id": 68776530, "body": "<a href=\"https://www.connectionstrings.com/\" rel=\"nofollow noreferrer\">connectionstrings.com</a>"}], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "is_accepted": false, "score": 0, "last_activity_date": 1479951081, "last_edit_date": 1479951081, "creation_date": 1479950065, "answer_id": 40776659, "question_id": 40775643, "link": "https://stackoverflow.com/questions/40775643/unable-to-connect-to-db-from-vba-but-able-to-connect-from-access/40776659#40776659", "title": "Unable to connect to DB from VBA but able to connect from Access", "body": "<p>The provider you as using in the connection string is for MS Access.\nIf thats the correct database then do the following.\nAdd the refrence \"Microsoft Office 14.0 Access Database Engine object library.</p>\n\n<pre><code>Dim cnString, query As String\nDim rs As New ADODB.Recordset\n\n'If older version of MS access then try Provider=Microsoft.Jet.OLEDB.4.0;'\n\ncnSTring= \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=&lt;Path&gt;;Jet OLEDB:Database Password=&lt;Pass&gt;;\"\nquery = \"SELECT * FROM TABLE\"    \nrs.Open query, cnString, adOpenStatic, adLockOptimistic\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7202615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/387f9507d31be16c867fb7fab08b1552?s=128&d=identicon&r=PG&f=1", "display_name": "MWR", "link": "https://stackoverflow.com/users/7202615/mwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 327, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513158819, "creation_date": 1479942578, "last_edit_date": 1513158819, "question_id": 40775643, "link": "https://stackoverflow.com/questions/40775643/unable-to-connect-to-db-from-vba-but-able-to-connect-from-access", "title": "Unable to connect to DB from VBA but able to connect from Access", "body": "<p>I'm able to connect to a database using Access, but not from VBA.  In Access, I use the server name, Windows NT Integrated Security,and the database name.  In VBA, I've tried many variations of variable names and values in the connection string, and the db.Open command always fails. I generally get an error about not being able to find an installable ISAM, or Multiple-step OLE DB operation generated errors.  Is there a way to determine what I can use as a connection string from the working Access connection? One example of code that fails with the latter error:</p>\n\n<pre><code>Dim db As Object\nDim adoRS As Object\nSet db = CreateObject(\"ADODB.Connection\")\nSet adoRS = CreateObject(\"ADODB.recordset\")\ndb.Open \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n\"Server=sql03;\" &amp; _\n\"Database=db1;\" &amp; _\n\"Integrated Security=SSPI;\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479942626, "post_id": 40775596, "comment_id": 68775004, "body": "I am not sure I understand what you mean as a list in C1. Are you talking about some type of object like a ListObject (AKA Table) or rather just all the text values listed encapsulated by quotes and delimited by commas? If you&#39;re not familiar with the command there is the <code>JOIN</code> command in VBA that concatenates an array with delimiters. You can just grab the values from your range into an array and then join them and output to C1."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1479944689, "post_id": 40775596, "comment_id": 68775632, "body": "for Excel 2016 there is the <a href=\"https://support.office.com/en-us/article/TEXTJOIN-function-357b449a-ec91-49d0-80c3-0e8fc845691c\" rel=\"nofollow noreferrer\"><code>TEXTJOIN</code></a> function. Otherwise, you can copy the range and get the the text from the clipboard."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1479943867, "post_id": 40775692, "comment_id": 68775402, "body": "Will this put it into one cell with quotes and comma"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1479947233, "post_id": 40775692, "comment_id": 68776242, "body": "Isn&#39;t that what you&#39;re looking to do ?"}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1479948571, "post_id": 40775692, "comment_id": 68776537, "body": "Tim, thanks, I will have to try the code out tomorrow but thank you for help"}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480017655, "post_id": 40775692, "comment_id": 68809750, "body": "I am getting an error when I try to run this final result, Sheets(Array(Range(&quot;B1&quot;).Value)).Copy can anyone share some light run time error 9"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480022731, "post_id": 40775692, "comment_id": 68811481, "body": "I wouldn&#39;t expect that to work.  What exactly are you trying to do with that line?  If you want to copy a bunch of sheets based on a list of sheet names then this wouldn&#39;t be a good approach."}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480024090, "post_id": 40775692, "comment_id": 68811918, "body": "I have a workbook with 60 sheets, and I recorded a macro, which gave me the idea of arrays and using lists when copying sheets into a new workbook. It worked fine when I quote and comma a list and put it in the array, but this is time consuming, as I have thirty variations to do. I wanted to make it dynamic.  I was going to use your code to quote and comma a list of sheets and plug it in a range value, which I hoped the VBA array would pickup and view it as a list of items concatenated as a string, but i am getting error messages, and pulling out my hair, any ideas???"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480026824, "post_id": 40775692, "comment_id": 68812688, "body": "See my edit above - I think this is what you&#39;re looking for."}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480028590, "post_id": 40775692, "comment_id": 68813142, "body": "Just so we are clear, so if I have list of 6 sheets in the array, I am keen for it to copy these 6 from the current population and than move it to a new workbook"}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480028699, "post_id": 40775692, "comment_id": 68813170, "body": "I am trying this out now"}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480029070, "post_id": 40775692, "comment_id": 68813260, "body": "I am trying this out now, I am little confused, am i using all three of your macro&#39;s or just the two in the bottom or just the one, and am I put in the ranges, ignore this comment i see what your doing"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480029134, "post_id": 40775692, "comment_id": 68813272, "body": "Just what&#39;s in the EDIT section.  &quot;tester&quot; is just an example of how you&#39;d call the <code>CopySheets</code> sub - I have no idea what the rest of your workflow might look like, so that&#39;s just a small sub to show how you could call the main code with a list name."}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480030144, "post_id": 40775692, "comment_id": 68813498, "body": "I am getting Subscript out of range error, I have amended (&quot;Groups&quot;)  with Group2 and added the sheet names below col b and its not working. Is this just creating the string, or copy sheets in a new workbook?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480030554, "post_id": 40775692, "comment_id": 68813584, "body": "Sounds like you have a sheet name which doesn&#39;t exist in your workbook.    If you can share your workbook (via DropBox etc) I&#39;ll take a look tomorrow."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480115743, "post_id": 40775692, "comment_id": 68846792, "body": "Upload your workbook to a file-sharing service like Box, Dropbox, Google drive, etc etc, then post a link to the file"}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480124385, "post_id": 40775692, "comment_id": 68848472, "body": "Do you have a linkedin account"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480124934, "post_id": 40775692, "comment_id": 68848549, "body": "I&#39;d prefer not to use that."}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480125429, "post_id": 40775692, "comment_id": 68848632, "body": "I have a gmail account I prefer not to use that, as the link will show up my name. Supposing you open a new workbook, you have 10 sheets, if you are to select odd sheets, can you show me how your sub routine works. I used your concept and used your grouping technique, but writing the code and than concatenating the string element on a sheet and than copied the code from the spreadsheet to the vba script screen, this was quite time consuming"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480125880, "post_id": 40775692, "comment_id": 68848716, "body": "I&#39;m not clear why you&#39;re still concatenating a string to do this?  If you don&#39;t want to use your gmail account you can sign up for a free Dropbox account, or any other filesharing platform..."}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1480622733, "post_id": 40775692, "comment_id": 69051104, "body": "Hi Tim I got your second method working, I also got the first method of  string concatenation working, but with the first method you have to copy from spreadsheet and paste it into the visual basic editor. This is for knowledge purposes but why does the array not recognise the concatenated line as a string, for the first method. I have been creating several seperate subs and than calling them."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 5, "last_activity_date": 1480026733, "last_edit_date": 1480026733, "creation_date": 1479942895, "answer_id": 40775692, "question_id": 40775596, "link": "https://stackoverflow.com/questions/40775596/excel-vba-array-list/40775692#40775692", "title": "Excel VBA Array list", "body": "<p>You can use Join() and Transpose().  </p>\n\n<p>For example:</p>\n\n<pre><code>Sub transpose()\n\n    Dim rng As Range\n    Dim ws As Worksheet\n    Dim last As Range\n\n    Set ws = ActiveSheet\n\n    Set last = ws.Cells(Rows.Count, \"A\").End(xlUp)\n    Set rng = ws.Range(ws.Range(\"A1\"), last)\n\n    ws.Range(\"B1\").Value = \"\"\"\" &amp; Join(Application.Transpose(rng.Value), \"\"\",\"\"\") &amp; \"\"\"\"\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>: now I see what you really want to do (create an array of sheet names to pass to <code>Sheets.Copy()</code>) here's one approach...</p>\n\n<p>Add a sheet named (eg) \"Groups\" to hold your various lists of sheets to be copied:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BmFZU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BmFZU.png\" alt=\"enter image description here\"></a></p>\n\n<p>Group names are in Row 1, with a list of sheets below each name.</p>\n\n<p>Then use this code:</p>\n\n<pre><code>'to demo the \"CopySheets()\" sub...\nSub Tester()\n\n    CopySheets \"Group2\" 'copy all sheets in Group2\n\nEnd Sub\n\n\n'Create of copy for all sheets under \"GroupName\" header...\nSub CopySheets(GroupName As String)\n\n    Dim rng As Range, arr\n    Dim ws As Worksheet\n    Dim f As Range\n\n    Set ws = ThisWorkbook.Sheets(\"Groups\") '&lt;&lt; has lists of sheet names\n\n    'find the header for the group to be copied\n    Set f = ws.Rows(1).Find(GroupName, lookat:=xlWhole)\n\n    If Not f Is Nothing Then\n        'found the header, so create an array of the sheet names\n        Set rng = ws.Range(f.Offset(1, 0), ws.Cells(ws.Rows.Count, f.Column).End(xlUp))\n        arr = Application.transpose(rng.Value)\n        'use the array in the sheets Copy method\n        ThisWorkbook.Sheets(arr).Copy\n\n    Else\n        'alert if you tried to copy a non-existent group\n        MsgBox \"Sheet group '\" &amp; GroupName &amp; \"' was not found!\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1974, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480026733, "creation_date": 1479942336, "last_edit_date": 1479943717, "question_id": 40775596, "link": "https://stackoverflow.com/questions/40775596/excel-vba-array-list", "title": "Excel VBA Array list", "body": "<p>I am a toddler in VBA </p>\n\n<p>I have a large range this could be more than 1000 text values (This could be going down A1), I am trying to concatenate all values with quote and comma into one cell (C1), i know of the transpose formula, but I am not sure my vba array will recognise this as a list.  </p>\n\n<p>I am keen for my array formula to recognize c1 as list, in order to carry out my action.</p>\n\n<p>I am really keen to keep this clean and not use the concatenation and drag various formulas down.</p>\n\n<p>I came across this, but this does not paste all the values into one cell.</p>\n\n<pre><code>Sub transpose()\nDim rng As Range\nDim ws As Worksheet\nDim last As Range\n\nSet ws = ActiveSheet   \nSet last = ws.Cells(Rows.Count, \"A\").End(xlUp)\nSet rng = ws.Range(\"A1\", last)\n\nFor Each cell In rng\n    Dim hold As String\n    hold = \"\"\"\"\n    hold = hold + cell.Value\n    hold = hold + \"\"\"\" + \", \"\n    cell.Value = hold\nNext cell\n\nrng.Copy\nActiveWorkbook.Sheets(2).Range(\"A1\").PasteSpecial transpose:=True\nEnd Sub\n</code></pre>\n\n<p>Code done by ryan E</p>\n\n<p>If anyone can suggest any cheats on gathering list for Arrays that would be great. Other than using the Macro tool in excel</p>\n\n<p>Example. </p>\n\n<p>A1 = company1\nA2 = company2\netc</p>\n\n<p>Solution</p>\n\n<p>C1 would show in one cell \"company1\", \"company2\", .... \"company10000\"</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 1, "last_activity_date": 1479940528, "creation_date": 1479940528, "answer_id": 40775272, "question_id": 40775161, "link": "https://stackoverflow.com/questions/40775161/subtracting-cells-only-when-there-is-a-value-on-another-cell/40775272#40775272", "title": "Subtracting cells only when there is a value on another cell", "body": "<p>put this in F1 and copy down. You must enter the formula with Ctrl-Shift-Enter, as it's an array formula:</p>\n\n<p><code>=SUM(IF(A1:E1=\"x\", 0, $A$1:$E$1))</code></p>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 632152, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5d34191ba54230852cf3dede237f90e0?s=128&d=identicon&r=PG", "display_name": "Dreni", "link": "https://stackoverflow.com/users/632152/dreni"}, "edited": false, "score": 0, "creation_date": 1479942558, "post_id": 40775283, "comment_id": 68774983, "body": "Worked perfect. Thanks"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 6, "last_activity_date": 1479940604, "creation_date": 1479940604, "answer_id": 40775283, "question_id": 40775161, "link": "https://stackoverflow.com/questions/40775161/subtracting-cells-only-when-there-is-a-value-on-another-cell/40775283#40775283", "title": "Subtracting cells only when there is a value on another cell", "body": "<p>This is a simple <code>SUMIFS</code> formula</p>\n\n<pre><code>=SUMIFS($A$1:$E$1,$A2:$E2,\"\")\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 632152, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5d34191ba54230852cf3dede237f90e0?s=128&d=identicon&r=PG", "display_name": "Dreni", "link": "https://stackoverflow.com/users/632152/dreni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 40775283, "answer_count": 2, "score": -1, "last_activity_date": 1479940604, "creation_date": 1479939990, "last_edit_date": 1531161705, "question_id": 40775161, "link": "https://stackoverflow.com/questions/40775161/subtracting-cells-only-when-there-is-a-value-on-another-cell", "title": "Subtracting cells only when there is a value on another cell", "body": "<p>My spreadsheet looks something like this:</p>\n\n<pre>A1 B1 C1 D1 E1 F1\n10 7  2  5  11 =SUM(A1:E1)\n\nA2 B2 C2 D2 E2 F2\nX     X  X     =18\n\nA3 B3 C3 D3 E3 F3\n   X        X  =17</pre>\n\n<p>On the <strong>F</strong> column starting from <strong>F2</strong> I want excel to sum the value from <strong>F1</strong> and subtract values where the letter X is present. In my example the sum on cell <strong>F1</strong> is 35.\nThe value on <strong>F2</strong> should therefore be:<br>\n35(retrieved from F1)<br>\n-10(letter X is present on <strong>A2</strong> and since <strong>A1</strong> has the value 10 we subtract that value)<br>\n-2(same thing here, letter X is present on <strong>C2</strong> and since <strong>C1</strong> has the value of 2 we subtract that value)<br>\n-5(and same here aswell, <strong>D2</strong> has letter X present and since <strong>D1</strong> has the value of 5 we subtract that value).   </p>\n\n<p>So <strong>35-10-2-5=18</strong>. The value of <strong>F2</strong> should be <strong>18</strong>. </p>\n\n<p>And on <strong>F3</strong> in my example the value should be <strong>35-7-11=17</strong>.   </p>\n\n<p>This formula should work for every row starting from <strong>F2</strong>.</p>\n\n<p>How can I achieve this?  </p>\n\n<p>I'm thinking maybe using the IF ISBLANK function but I'm a noob.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1483740861, "post_id": 40775142, "comment_id": 70236423, "body": "If you make it easier for responders to help you, there is a better chance of getting a response. <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1500652739, "last_edit_date": 1500652739, "creation_date": 1500651593, "answer_id": 45241669, "question_id": 40775142, "link": "https://stackoverflow.com/questions/40775142/restrict-search-to-the-last-week-of-appointments/45241669#45241669", "title": "Restrict search to the last week of appointments", "body": "<p>I can guess that you are missing two statements.</p>\n\n<pre><code>oItems.IncludeRecurrences = True\noItems.Sort \"[Start]\"\n</code></pre>\n\n<p>If this is the case, you can ask another question about why the Restrict requires these additional statements. Someone may have an answer.</p>\n\n<p>Minimal, Complete, and Verifiable example. Try commenting out either or both statements. You should see that the items are not the same.</p>\n\n<pre><code>Option Explicit\n\nSub LastWeekAppts()\n\nDim objFolder As Folder\n\nDim oItems As items\nDim oRestrItems As items\n\nDim strRestriction As String\nDim myStart As Date\nDim myEnd As Date\n\nDim temp As Object\n\nSet objFolder = Session.GetDefaultFolder(olFolderCalendar)\nSet oItems = objFolder.items\n\n' *****************************************\n' Odd results without these two statements\noItems.IncludeRecurrences = True\noItems.Sort \"[Start]\"\n' *****************************************\n\nmyEnd = Date\nmyStart = DateAdd(\"d\", -7, Date)\n\nDebug.Print \" myStart: \" &amp; myStart\nDebug.Print \" myEnd  : \" &amp; myEnd\n\nstrRestriction = \"[Start] &lt;= '\" &amp; myEnd _\n                      &amp; \"' AND [End] &gt;= '\" &amp; myStart &amp; \"'\"\nDebug.Print strRestriction\n\nSet oRestrItems = oItems.Restrict(strRestriction)\n\nFor Each temp In oRestrItems\n    Debug.Print temp.start &amp; \" - \" &amp; temp.Subject\nNext temp\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 4676957, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rAqnB.png?s=128&g=1", "display_name": "phfb", "link": "https://stackoverflow.com/users/4676957/phfb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500652739, "creation_date": 1479939886, "last_edit_date": 1483374144, "question_id": 40775142, "link": "https://stackoverflow.com/questions/40775142/restrict-search-to-the-last-week-of-appointments", "title": "Restrict search to the last week of appointments", "body": "<p>I'm trying to grab the last week of appointments using VBA in Outlook.</p>\n\n<p>I'm using the .Restrict method, but something is making my string grab 3 years further back.</p>\n\n<p>I start by declaring formatted dates for my time bracket:</p>\n\n<pre><code>myStart = Format(DateAdd(\"d\", -7, Now()), \"ddddd h:nn AMPM\")\nmyEnd = Format(Now(), \"ddddd h:nn AMPM\")  \n</code></pre>\n\n<p>I build a string to hold my restriction criterion.</p>\n\n<pre><code>strRestriction = \"[Start] &lt;= '\" &amp; myEnd _\n&amp; \"' AND [End] &gt;= '\" &amp; myStart &amp; \"'\"\n</code></pre>\n\n<p>Finally I call restrict on my appointment items:</p>\n\n<pre><code>Set oRestrItems = oItems.Restrict(strRestriction)\n</code></pre>\n\n<p>For a little more context, here's how I use/call the result:</p>\n\n<pre><code>For Each oApptItem In oRestrItems 'oItems will grab everything, but that's hardly perfect.\n    If oApptItem.Sensitivity &lt;&gt; olPrivate Then\n        MsgBox (oApptItem.Subject)\n        MsgBox (oApptItem.Start)\n        MsgBox (oApptItem.End)\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "tsql", "automation", "import-from-excel", "vba"], "comments": [{"owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "edited": false, "score": 1, "creation_date": 1479953544, "post_id": 40774823, "comment_id": 68777691, "body": "If you have sql server installed, you&#39;ll also have the &#39;import and export data wizard&#39;, accessible via the start menu. That&#39;s what I&#39;d use."}, {"owner": {"reputation": 101, "user_id": 7191505, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe379f347d04a0c48914716e64806bfc?s=128&d=identicon&r=PG&f=1", "display_name": "ANASI-Newbie", "link": "https://stackoverflow.com/users/7191505/anasi-newbie"}, "reply_to_user": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "edited": false, "score": 0, "creation_date": 1480705502, "post_id": 40774823, "comment_id": 69090023, "body": "&#39;Import and export&#39; can work with one file at a time plus it does not allow me to select data rows - My header is at row 5 and data starts from row 6 to row 48 - rest everything under row 48 is backup data or formulas. How can i select just row 5-48 with 5 as my header?.. thank you"}, {"owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "edited": false, "score": 0, "creation_date": 1480833782, "post_id": 40774823, "comment_id": 69121859, "body": "there should be a &#39;header rows to skip&#39; option. import/export data wizard is just a shortcut to making a ssis package, so if you go with Juans approach, you&#39;ll also find that this is an option on the data source."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7191505, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe379f347d04a0c48914716e64806bfc?s=128&d=identicon&r=PG&f=1", "display_name": "ANASI-Newbie", "link": "https://stackoverflow.com/users/7191505/anasi-newbie"}, "edited": false, "score": 0, "creation_date": 1480705598, "post_id": 40785602, "comment_id": 69090071, "body": "Thank you Juan .. but this does not allow me to select data rows - My header is at row 5 and data starts from row 6 to row 48 - rest everything under row 48 is backup data or formulas. How can i select just row 5-48 with 5 as my header?.. thank you"}], "tags": [], "owner": {"reputation": 170, "user_id": 2157632, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3664d508720d3a775d7ea9d56055b4fe?s=128&d=identicon&r=PG", "display_name": "Juan Piaggio", "link": "https://stackoverflow.com/users/2157632/juan-piaggio"}, "is_accepted": false, "score": 4, "last_activity_date": 1479988016, "creation_date": 1479988016, "answer_id": 40785602, "question_id": 40774823, "link": "https://stackoverflow.com/questions/40774823/auto-importing-into-tsql-table-from-different-excel-sheets/40785602#40785602", "title": "Auto Importing into TSQL Table from different Excel sheets", "body": "<p><strong>Option 1: SSIS</strong></p>\n\n<p>If you are trying to do a recurring process to run every day/week/month, I would recommend to use Integration Services SSIS</p>\n\n<p>This is a nice tutorial:\n<a href=\"https://www.simple-talk.com/sql/ssis/moving-data-from-excel-to-sql-server-10-steps-to-follow/\" rel=\"nofollow noreferrer\">https://www.simple-talk.com/sql/ssis/moving-data-from-excel-to-sql-server-10-steps-to-follow/</a></p>\n\n<p>You can run this job using a SQL Agent.</p>\n\n<p><strong>Option 2: OLEDB connection</strong></p>\n\n<p>Step 1: download \"2007 Office System Driver: Data Connectivity Components\n\" if not installed    <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=23734\" rel=\"nofollow noreferrer\">https://www.microsoft.com/en-us/download/details.aspx?id=23734</a></p>\n\n<p>Step 2: Enable Ad Hoc Distributed Queries</p>\n\n<pre><code>       EXEC sp_configure 'show advanced options', 1\nRECONFIGURE\nGO\n\nEXEC sp_configure 'ad hoc distributed queries', 1\nRECONFIGURE\nGO\n\n\n   EXEC master . dbo. sp_MSset_oledb_prop N'Microsoft.ACE.OLEDB.12.0' , N'AllowInProcess' , 1\nGO\n\nEXEC master . dbo. sp_MSset_oledb_prop N'Microsoft.ACE.OLEDB.12.0' , N'DynamicParameters' , 1\nGO\n</code></pre>\n\n<p>Step 3: Run Query</p>\n\n<pre><code>SELECT  exl.name\nINTO #myExcelData\nFROM OPENROWSET ('Microsoft.Ace.OLEDB.12.0'\n,'Excel 12.0; Database=C:\\Projects\\StackOverflow\\A.xlsx; Extended Properties=''EXCEL 12.0;HDR=NO;IMEX=1'\n,'SELECT * FROM [Sheet1$]') AS exl\n</code></pre>\n\n<p><strong>Option 3: Wizard</strong>\nIf this is a one time process, you can use wizard</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1480976462, "creation_date": 1480976462, "answer_id": 40984419, "question_id": 40774823, "link": "https://stackoverflow.com/questions/40774823/auto-importing-into-tsql-table-from-different-excel-sheets/40984419#40984419", "title": "Auto Importing into TSQL Table from different Excel sheets", "body": "<p>Try what Juan suggested, but do it like this:</p>\n\n<pre><code>SELECT * FROM [SheetName$A1:B2]\n</code></pre>\n\n<p>Does that work for you?</p>\n"}], "owner": {"reputation": 101, "user_id": 7191505, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe379f347d04a0c48914716e64806bfc?s=128&d=identicon&r=PG&f=1", "display_name": "ANASI-Newbie", "link": "https://stackoverflow.com/users/7191505/anasi-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1480976462, "creation_date": 1479938386, "last_edit_date": 1531161705, "question_id": 40774823, "link": "https://stackoverflow.com/questions/40774823/auto-importing-into-tsql-table-from-different-excel-sheets", "title": "Auto Importing into TSQL Table from different Excel sheets", "body": "<p>I am trying to auto-import data from 12 different files, each file with 6-10 sheets. Is there a process by which data can be auto extracted by 'selected sheets' ONLY from each file and loaded into a single file (or SQL table).</p>\n\n<p>Example:</p>\n\n<pre><code>File A with Columns \"Name\" Column \"Amount\". \nFile A has total of 4 sheets (2 sheets named \"ABC Trend\", \"DEF Trend\")\nFile B - 6 sheets (2 sheets named \"XXX Trend\", \"DEF Trend\")\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>import into Table C (or File C - One Sheet) with 'Trend' data\n\n\"Name\", \"Amount\", \"FromFile\", \"FromSheet\"\nJo,      56.3 ,      A ,     ABC Trend\nMary,    16.3 ,      A ,     ABC Trend\nDave,    26.3 ,      A ,     ABC Trend\nJim,     26.3 ,      A ,     DEF Trend\nMary,    16.3 ,      A ,     DEF Trend\nDave,    26.3 ,      A ,     DEF Trend\nShu,     16.3 ,      B ,     XXX Trend\nMarie,   16.3 ,      B ,     XXX Trend\nTom,     26.3 ,      B ,     XXX Trend\nJack,    26.3 ,      B ,     DEF Trend\nMa,      16.3 ,      B ,     DEF Trend\nDoe,     26.3 ,      B ,     DEF Trend\n\n*Ideal would be to load into a SQL table\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1479938235, "post_id": 40774681, "comment_id": 68773498, "body": "<code>Min()</code> returns a value, not a range object. You&#39;d need to use Find() or Match() to locate the cell with the Minimum value and then delete it.  You might find it easier to use <code>Application.Small(a, i)</code> inside your loop: then you wouldn&#39;t need to delete the cells you&#39;ve already copied."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479938542, "post_id": 40774681, "comment_id": 68773624, "body": "Also you&#39;ll want to decide whether you want to use the early-bound <code>Application.WorksheetFunction.Min</code> or the late-bound <code>Application.Min</code> function. Consistency please!"}, {"owner": {"reputation": 13883, "user_id": 6815131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c38385f9eb57b70176498fa5c3b4c99?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C", "link": "https://stackoverflow.com/users/6815131/joe-c"}, "edited": false, "score": 0, "creation_date": 1479939262, "post_id": 40774681, "comment_id": 68773881, "body": "Welcome to Stack Overflow! It looks like you need to learn to use a debugger.  Please help yourself to some <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">complementary debugging techniques</a>.  If you still have issues afterwards, please feel free to come back with more details."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 13883, "user_id": 6815131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c38385f9eb57b70176498fa5c3b4c99?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C", "link": "https://stackoverflow.com/users/6815131/joe-c"}, "edited": false, "score": 0, "creation_date": 1479939790, "post_id": 40774681, "comment_id": 68774069, "body": "@JoeC note that VBA is written in the glorious Visual Basic Editor (VBE) IDE, which doesn&#39;t feature half of the debugging tools available to Java or C# programmers in Eclipse or Visual Studio. So.. good read, relevant and all - but debugging VBA code is more often than not limited to stepping through and outputting stuff to the <i>immediate pane</i>... which doesn&#39;t quite help much when you don&#39;t know why you&#39;re getting the error you&#39;re getting, like &quot;Object required&quot; in this case. That said I totally agree with <a href=\"https://github.com/rubberduck-vba/Rubberduck/blob/next/README.md\" rel=\"nofollow noreferrer\">get a Rubberduck</a> =)"}, {"owner": {"reputation": 1, "user_id": 7202402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7473d970f11d25c0d74e86ee5d118523?s=128&d=identicon&r=PG&f=1", "display_name": "C sanogo", "link": "https://stackoverflow.com/users/7202402/c-sanogo"}, "edited": false, "score": 0, "creation_date": 1479939880, "post_id": 40774681, "comment_id": 68774104, "body": "You guys are awesome Thank you"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479939945, "post_id": 40774681, "comment_id": 68774124, "body": "@Csanogo notice the hollow checkmark next to Tim&#39;s answer - you can click it to mark the answer as accepted if it solved your problem."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1479938639, "creation_date": 1479938639, "answer_id": 40774876, "question_id": 40774681, "link": "https://stackoverflow.com/questions/40774681/sort-in-increasing-order-by-deleting-the-minimum-value-each-time-loop-finds-the/40774876#40774876", "title": "Sort in increasing order by deleting the minimum value each time loop finds the next minimum", "body": "<p><code>Min()</code> returns a value, not a range object. You'd need to use <code>Find()</code> or <code>Match()</code> to locate the cell with the Minimum value and then delete it. You might find it easier to use <code>Application.Small(a, i)</code> inside your loop: then you wouldn't need to delete the cells you've already copied</p>\n\n<pre><code>Sub decreasing()\n\n    Dim a As Range, b As Range\n    Dim i As Integer\n    Dim n As Long\n    Dim minimum As Long\n\n    n = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n    Set a = Sheet1.Range(Sheet1.Cells(1, \"A\"), Sheet1.Cells(n, \"A\"))\n\n    For i = 1 To Application.Count(a)\n        Sheet1.Cells(i, \"B\").Value = Application.Small(a, i)\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1479974619, "creation_date": 1479974619, "answer_id": 40780904, "question_id": 40774681, "link": "https://stackoverflow.com/questions/40774681/sort-in-increasing-order-by-deleting-the-minimum-value-each-time-loop-finds-the/40780904#40780904", "title": "Sort in increasing order by deleting the minimum value each time loop finds the next minimum", "body": "<p>since you're sorting don't reinvent the wheel and use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow noreferrer\"><code>Sort()</code></a> method of <code>Range</code> object:</p>\n\n<pre><code>Sub decreasing2()        \n    With Sheet1\n        With .Range(\"A1\", .Cells(Rows.COUNT, 1).End(xlUp))\n            .Offset(, 1).Value = .Value\n            .Offset(, 1).Sort key1:=Range(\"B1\"), order1:=xlAscending, Header:=xlYes '\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7202402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7473d970f11d25c0d74e86ee5d118523?s=128&d=identicon&r=PG&f=1", "display_name": "C sanogo", "link": "https://stackoverflow.com/users/7202402/c-sanogo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479974619, "creation_date": 1479937690, "question_id": 40774681, "link": "https://stackoverflow.com/questions/40774681/sort-in-increasing-order-by-deleting-the-minimum-value-each-time-loop-finds-the", "title": "Sort in increasing order by deleting the minimum value each time loop finds the next minimum", "body": "<p>I currently am trying to make a code on VBA that would sort my values in an increasing order. After my program finds the minimum value and adds it to another column the column \"B\" , I wanted to make the cell of the minimum disappear in order to find my new minimum and enter it to the column \"B\" right under the initial value. Here is my code. For some reason  it wont delete the cell and gives me a \"Object required error\" . Please help</p>\n\n<pre><code>Option Explicit\nSub decreasing()\nDim a As Range, b As Range\nDim i As Integer\nDim n As Long\nDim minimum As Long\n\nn = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n\ni = 1\n\nWhile Cells(i, \"A\") &lt;&gt; \"\"\ni = i + 1\nFor i = 1 To n\n\n  Set a = Range(Cells(1, \"A\"), Cells(n, \"A\"))\n\nCells(i, \"B\") = Application.WorksheetFunction.Min(a)\n\nApplication.Min(a).Cells.Delete\n\n\n\n   Next i\nWend\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "winapi", "screen"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1479939489, "post_id": 40774508, "comment_id": 68773955, "body": "You don&#39;t need a program to do this. You can tile the windows."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479940855, "post_id": 40774508, "comment_id": 68774469, "body": "If you <i>do</i> want a program to do this, I&#39;d recommend using the API to tile the windows.  See <a href=\"http://stackoverflow.com/a/15773260/4088852\">this answer</a>."}, {"owner": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "edited": false, "score": 0, "creation_date": 1480144940, "post_id": 40774508, "comment_id": 68851766, "body": "I don&#39;t want to tile the windows, I need to resize them during the execution of the macro."}], "owner": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479937497, "creation_date": 1479936848, "last_edit_date": 1479937497, "question_id": 40774508, "link": "https://stackoverflow.com/questions/40774508/split-the-screen-between-applications-in-vba", "title": "Split the screen between applications in VBA", "body": "<p>I'm working with my Excel files on two different monitor, 2560x1080 at work and 1920x1080 at home.</p>\n\n<p>The file is used to open and manipulate Internet Explorer by using IE object and I want to split the screen in two and have IE window to the right, always 1000 pixels wide and Excel to the left, occupying the rest of the screen, regardless of the monitor I'm using.</p>\n\n<p>How can I do that? I tried using this:</p>\n\n<pre><code>Public Declare PtrSafe Function GetSystemMetrics32 Lib \"user32\" Alias \"GetSystemMetrics\" (ByVal nIndex As Long) As Long\n\nWith Application\n    .WindowState = xlNormal\n    .Left = 0\n    .Top = 0\n    .Height = (vidheight * 0.75) - 28\n    .Width = (vidWidth - 1000) * 0.75\nEnd With\n\nSet IE = CreateObject(\"internetexplorer.application\")\napiShowWindow IE.hwnd, 1\n\nWith IE\n    .Left = (vidWidth - 1000) * 0.75\n    .Top = 0\n    .Height = (vidheight * 0.75) - 28\n    .Width = 1000 * 0.75\nEnd With\n</code></pre>\n\n<p>It doesn't work, not even the height of the windows is not the same, even though it has the same formula for both windows...</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1479934954, "post_id": 40774028, "comment_id": 68772029, "body": "Is the <code>Filename1</code> workbook already open in the application?  You should be able to see it in the Workbooks collection using Watch or Debug."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1479935439, "post_id": 40774028, "comment_id": 68772254, "body": "Are <code>FileName1</code> and <code>SheetName1</code> both <code>String</code> variables?  Does <code>FileName1</code> only include the base filename (with extension) or do you have the full path in that variable too?  Perhaps put a <code>Debug.Print FileName1</code> into your code before the line that is crashing."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1479935741, "post_id": 40774028, "comment_id": 68772392, "body": "What are you passing to that procedure? The parameters are all implicitly <code>Variant</code>, so it will happily take whatever you throw at it. If that&#39;s meant to be names, defined them <code>As String</code>. If they&#39;re meant to be objects, define them as <code>Workbook</code> and <code>Worksheet</code> objects."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479936859, "post_id": 40774028, "comment_id": 68772884, "body": "Just to be clear: nobody can answer this question without making assumptions, until you <a href=\"https://stackoverflow.com/posts/40774028/edit\">edit</a> to clarify what you&#39;re feeding that procedure with."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479939500, "post_id": 40774028, "comment_id": 68773963, "body": "Start by figuring out if it&#39;s the filename or the sheet  reference which is wrong: it&#39;s not possible to tell when you have them both in one line, so split that up or pull out <code>Workbooks(FileName1)</code> into a <code>With...End With</code> wrapper."}, {"owner": {"reputation": 94, "user_id": 2480580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bs2TV.png?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2480580/andy"}, "edited": false, "score": 0, "creation_date": 1479948900, "post_id": 40774028, "comment_id": 68776608, "body": "What is error message?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1479948945, "post_id": 40774028, "comment_id": 68776618, "body": "FYI - to get rid of <code>ColumnLetter</code> you can use <code>Check = WorksheetFunction.CountA(Workbooks(FileName1).Sheets(SheetNa&zwnj;&#8203;me1).Columns(ColumnN&zwnj;&#8203;umber))</code>.  I made that modification (because I didn&#39;t have the <code>LastColumnLetter</code> function, which I assume takes <code>ColumnNumber</code> and returns the &quot;letter&quot; of the column one column to the right) and your function worked for me - i.e. it set the column widths on a sheet based on the column widths of another sheet, for each column that had at least 2 non-empty cells in the &quot;source&quot; sheet, stopping when it found a column with 1 or 0 cells."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 94, "user_id": 2480580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bs2TV.png?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2480580/andy"}, "edited": false, "score": 0, "creation_date": 1479948972, "post_id": 40774028, "comment_id": 68776624, "body": "@Andy - Title says it is runtime error 9."}, {"owner": {"reputation": 94, "user_id": 2480580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bs2TV.png?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2480580/andy"}, "edited": false, "score": 0, "creation_date": 1479949171, "post_id": 40774028, "comment_id": 68776657, "body": "<code>letter1 = &quot;A&quot;     letter2 = &quot;B&quot;     Check = WorksheetFunction.CountA(Workbooks(&quot;Book1&quot;).Sheets(&quot;Sheet1&quot;)&zwnj;&#8203;.Range(letter1 &amp; &quot;:&quot; &amp; letter2))</code> this worked,no error message."}, {"owner": {"reputation": 74, "user_id": 5429423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqCKe.jpg?s=128&g=1", "display_name": "Fixer", "link": "https://stackoverflow.com/users/5429423/fixer"}, "reply_to_user": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1480352989, "post_id": 40774028, "comment_id": 68916138, "body": "@RBarryYoung Yes, as stated in the title, all files are loaded and visible."}, {"owner": {"reputation": 74, "user_id": 5429423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqCKe.jpg?s=128&g=1", "display_name": "Fixer", "link": "https://stackoverflow.com/users/5429423/fixer"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1480353022, "post_id": 40774028, "comment_id": 68916155, "body": "@YowE3K The post has been edited with the string contents."}, {"owner": {"reputation": 74, "user_id": 5429423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqCKe.jpg?s=128&g=1", "display_name": "Fixer", "link": "https://stackoverflow.com/users/5429423/fixer"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480353099, "post_id": 40774028, "comment_id": 68916190, "body": "@Mat&#39;sMug The post has been edited with the string contents."}, {"owner": {"reputation": 74, "user_id": 5429423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqCKe.jpg?s=128&g=1", "display_name": "Fixer", "link": "https://stackoverflow.com/users/5429423/fixer"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480353118, "post_id": 40774028, "comment_id": 68916200, "body": "@TimWilliams The post has been edited with results."}, {"owner": {"reputation": 74, "user_id": 5429423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqCKe.jpg?s=128&g=1", "display_name": "Fixer", "link": "https://stackoverflow.com/users/5429423/fixer"}, "edited": false, "score": 0, "creation_date": 1480353396, "post_id": 40774028, "comment_id": 68916374, "body": "Before anyone asks me to post all the code, there are thousands of lines of code in all this. This one subroutine is the only one breaking. Is it possible that previous code that hides the window for FIleName1 but later unhides it is messing things up? I had to do that because Excel kept putting data on the wrong workbook unless I hid it."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 1, "creation_date": 1480353591, "post_id": 40774028, "comment_id": 68916489, "body": "Side Note: &quot;files are present and loaded&quot; is sufficiently ambiguous to not really mean anything.  &quot;Open in the Excel application, and visible as a worksheet&quot; may or may not be what was intended by &quot;present and loaded&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480354848, "post_id": 40850228, "comment_id": 68917192, "body": "Good for you. I hope you still take a moment to read my answer though, because the way your code is written is just asking for more of such errors to happen. Fix the actual code problem, not just the typos."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 2, "creation_date": 1480358021, "post_id": 40850228, "comment_id": 68918882, "body": "In your OP, you had said: <b>&quot;I have verified that all the file names and sheet names are present and accounted for in the same instance of Excel. I have checked for misspellings, extra characters, and &#39;invisible&#39; characters and none are present.&quot;</b> And i post this comment not to rub it in, but to help you appreciate why Mat&#39;s comments are so important. We all make silly mistakes. That&#39;s what we do. Well structured code will help you spot your exact error much quicker, and then you will save sooo much time."}], "tags": [], "owner": {"reputation": 74, "user_id": 5429423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqCKe.jpg?s=128&g=1", "display_name": "Fixer", "link": "https://stackoverflow.com/users/5429423/fixer"}, "is_accepted": true, "score": 1, "last_activity_date": 1493907193, "last_edit_date": 1493907193, "creation_date": 1480354426, "answer_id": 40850228, "question_id": 40774028, "link": "https://stackoverflow.com/questions/40774028/i-cant-figure-out-why-this-is-giving-me-a-runtime-error-9-yes-the-files-are-p/40850228#40850228", "title": "I can&#39;t figure out why this is giving me a runtime error 9 (yes, the files are present and loaded)", "body": "<p>I have been looking at this too long.</p>\n\n<p>FileName1 was coming across as \"Orignial Datasheet.xlsx\" not \"Original Datasheet.xlsx\"</p>\n\n<p>That is why it wasn't connecting. My mistake, sorry for bothering everyone.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1480354611, "creation_date": 1480354611, "answer_id": 40850279, "question_id": 40774028, "link": "https://stackoverflow.com/questions/40774028/i-cant-figure-out-why-this-is-giving-me-a-runtime-error-9-yes-the-files-are-p/40850279#40850279", "title": "I can&#39;t figure out why this is giving me a runtime error 9 (yes, the files are present and loaded)", "body": "<p>I don't have your answer, but runtime error 9 sounds a lot like one of these values isn't what you think it is - and with the code you have it's hard to tell exactly where it's blowing up.</p>\n\n<p>Start with turning this:</p>\n\n<blockquote>\n<pre><code>Sub CopyColumnWidths(FileName1, SheetName1, FileName2, SheetName2)\n</code></pre>\n</blockquote>\n\n<p>into this (assuming the procedure is called from within the same module - if it's called from another module, make it <code>Public Sub</code>):</p>\n\n<pre><code>Private Sub CopyColumnWidths(ByVal FileName1 As String, ByVal SheetName1 As String, ByVal FileName2 As String, ByVal SheetName2 As String)\n</code></pre>\n\n<p>Changing your signature to use <code>String</code> parameters passed <em>by value</em> shouldn't break your code in any way, but makes things more explicit and therefore improves readability and makes your intent clearer.</p>\n\n<p>Moving on.</p>\n\n<blockquote>\n<pre><code>ColumnNumber = 1\n</code></pre>\n</blockquote>\n\n<p>Where's that coming from? Declare it. Stick <code>Option Explicit</code> at the top of your module, and then <strong>declare every variable</strong> until your code compiles again (Option Explicit will make VBA refuse to compile code that uses undeclared variables).</p>\n\n<pre><code>Dim ColumnNumber As Long\nColumnNumber = 1\n</code></pre>\n\n<p>Now that we know <code>ColumnNumber</code> and <code>Check</code> are local variables declared in the same scope (right?), we move on:</p>\n\n<pre><code>Dim Check As Long\nCheck = WorksheetFunction.CountA(Workbooks(FileName1).Sheets(SheetName1).Columns(ColumnNumber))\n</code></pre>\n\n<p>This line is doing too many things: we don't know that <code>Workbooks(FileName1)</code> is succeeding, and we don't know that its <code>Sheets(SheetName1)</code> is succeeding either - yet we call its <code>Columns</code> member regardless, assuming blue skies and sunshine.</p>\n\n<p>Don't assume blue skies and sunshine.</p>\n\n<p>Break it down.</p>\n\n<pre><code>Dim sourceBook As Workbook\nSet sourceBook = Workbooks(FileName1)\n\nDim sourceSheet As Worksheet\nSet sourceSheet = sourceBook.Worksheets(SheetName1)\n\nCheck = WorksheetFunction.CountA(sourceSheet.Columns(ColumnNumber))\n</code></pre>\n\n<p>If your code runs up to that point, your problem is half-solved - you have the same issue here, and you're fetching the same <code>Workbook</code> and <code>Worksheet</code> objects <em>again</em> - instead, <em>break it down</em>, assign local object variables, and <em>reuse them</em>:</p>\n\n<blockquote>\n<pre><code>Workbooks(FileName2).Sheets(SheetName2).Columns(ColumnNumber).ColumnWidth = Workbooks(FileName1).Sheets(SheetName1).Columns(ColumnNumber).ColumnWidth\n</code></pre>\n</blockquote>\n\n<pre><code>Dim destinationBook As Workbook\nSet destinationBook = Workbooks(FileName2)\n\nDim destinationSheet As Worksheet\nSet destinationSheet = destinationBook(SheetName2)\n\ndestinationSheet.Columns(ColumnNumber).ColumnWidth = sourceSheet.Columns(ColumnNumber).ColumnWidth\n\nColumnNumber = ColumnNumber + 1\nCheck = WorksheetFunction.CountA(sourceSheet.Range(ColumnLetter &amp; \":\" &amp; ColumnLetter))\n</code></pre>\n\n<p>Step through (<kbd>F8</kbd>) this code line by line, then you'll know exactly which instruction is blowing up. Cramming everything into as few code lines as possible and chaining 2, 3, 4 member accesses <em>assuming it will \"just work\"</em> makes it nearly impossible to know that.</p>\n\n<hr>\n\n<blockquote>\n  <p><em>Is it possible that previous code that hides the window for FIleName1 but later unhides it is messing things up? I had to do that because <strong>Excel kept putting data on the wrong workbook unless I hid it</strong>.</em></p>\n</blockquote>\n\n<p>This sounds like you have code (elsewhere?) that works off <code>ActiveSheet</code>, or <code>ActiveWorkbook</code>, explicitly or (more likely?) implicitly.</p>\n\n<p>If you find yourself using unqualified <code>Range</code>, <code>Cells</code>, <code>Rows</code>, <code>Columns</code> or <code>Names</code> calls, you're implicitly referring to the active sheet. Replace them with explicitly qualified member calls using the worksheet object you mean to refer to. There's no magic, Excel (VBA actually) can't guess your intentions; it doesn't \"keep putting data on the wrong workbook\" - it puts data exactly where you tell it to put it. Hiding the workbook is just a terribly bad work-around: you're still not telling it <em>explicitly</em> where you mean to put it.</p>\n"}], "owner": {"reputation": 74, "user_id": 5429423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqCKe.jpg?s=128&g=1", "display_name": "Fixer", "link": "https://stackoverflow.com/users/5429423/fixer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 40850228, "answer_count": 2, "score": 0, "last_activity_date": 1493907199, "creation_date": 1479934625, "last_edit_date": 1493907199, "question_id": 40774028, "link": "https://stackoverflow.com/questions/40774028/i-cant-figure-out-why-this-is-giving-me-a-runtime-error-9-yes-the-files-are-p", "title": "I can&#39;t figure out why this is giving me a runtime error 9 (yes, the files are present and loaded)", "body": "<pre><code>Sub CopyColumnWidths(FileName1, SheetName1, FileName2, SheetName2)\n    ColumnNumber = 1\n    Check = WorksheetFunction.CountA(Workbooks(FileName1).Sheets(SheetName1).Columns(ColumnNumber))\n    Do While Check &gt; 0\n        ColumnLetter = LastColumnLetter(ColumnNumber)\n        Workbooks(FileName2).Sheets(SheetName2).Columns(ColumnNumber).ColumnWidth = Workbooks(FileName1).Sheets(SheetName1).Columns(ColumnNumber).ColumnWidth\n        ColumnNumber = ColumnNumber + 1\n        Check = WorksheetFunction.CountA(Workbooks(FileName1).Sheets(SheetName1).Range(ColumnLetter &amp; \":\" &amp; ColumnLetter))\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Ok, so this is my code. I have verified that all the file names and sheet names are present and accounted for in the same instance of Excel. I have checked for misspellings, extra characters, and 'invisible' characters and none are present.</p>\n\n<p>I tried, for troubleshooting purposes, putting in a Workbooks(FileName1).Activate and it wouldn't work either. In different code that particular file does get hidden, but at the time this code is executed that workbook is visible and present.</p>\n\n<p>For the life of me I cannot figure out why this is breaking and could use a hand. </p>\n\n<p>This is running on Excel 2013, 64-bit if it matters.</p>\n\n<p>------- More Info</p>\n\n<p>FileName1 is \"Original Datasheet.xlsx\"\nFileName2 is \"Split Datasheet.xlsx\"\nSheetName1 (and SheetName2) are \"1a. Contents\"</p>\n\n<p>When I try to activate FileName2, it works. When I try to activate FileName1, it fails. The sheet names don't matter, it doesn't 'see' FileName1, even though it is present and I can select it in the 'Switch Windows' dropdown.</p>\n\n<p>Repeating again for those who didn't read the title the first time: Yes, all files are loaded in the same instance of Excel. All Files Are Present.</p>\n"}, {"tags": ["vba", "excel", "range", "cells"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1479935626, "post_id": 40773907, "comment_id": 68772339, "body": "<code>Cells(LRow, &quot;D&quot;)</code> and <code>Cells(6, &quot;D&quot;)</code> are implicitly referring to the active worksheet. Hence you can only use them to define a range on the active worksheet. If that&#39;s not <code>destBook.Sheets(&quot;Sheet1&quot;)</code>, then things go boom. Which part is unclear?"}, {"owner": {"reputation": 13, "user_id": 7199404, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8hr2w-lsF7I/AAAAAAAAAAI/AAAAAAAAAAA/aDd4MOCTJUY/photo.jpg?sz=128", "display_name": "Huzaifa Essajee", "link": "https://stackoverflow.com/users/7199404/huzaifa-essajee"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479985281, "post_id": 40773907, "comment_id": 68791869, "body": "OK, I understand now how to explicitly define the object. For instance, <code>destBook.Sheets(&quot;Sheet1&quot;).Cells(LRow, &quot;D&quot;)</code>.  Why does the last line above work though with <code>.Address</code>? Is it doing the same thing or something different?"}, {"owner": {"reputation": 13, "user_id": 7199404, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8hr2w-lsF7I/AAAAAAAAAAI/AAAAAAAAAAA/aDd4MOCTJUY/photo.jpg?sz=128", "display_name": "Huzaifa Essajee", "link": "https://stackoverflow.com/users/7199404/huzaifa-essajee"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479990420, "post_id": 40773907, "comment_id": 68795261, "body": "After your clarification and reviewing <a href=\"http://stackoverflow.com/questions/17733541/why-does-range-work-but-not-cells\">link</a> again, I now understand what the answer is trying to describe."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 7199404, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8hr2w-lsF7I/AAAAAAAAAAI/AAAAAAAAAAA/aDd4MOCTJUY/photo.jpg?sz=128", "display_name": "Huzaifa Essajee", "link": "https://stackoverflow.com/users/7199404/huzaifa-essajee"}, "is_accepted": false, "score": 0, "last_activity_date": 1479990574, "last_edit_date": 1495540798, "creation_date": 1479990574, "answer_id": 40786481, "question_id": 40773907, "link": "https://stackoverflow.com/questions/40773907/why-does-define-range-with-cell-address-work-but-not-cell-only-excel-vba/40786481#40786481", "title": "Why does define range with cell.address work but not cell only Excel VBA?", "body": "<p>The correct code in this case is</p>\n\n<pre><code>Set LRowA = destBook.Sheets(\"Sheet1\").Cells(LRow, \"D\")\nSet FRowA = destBook.Sheets(\"Sheet1\").Cells(6, \"D\")\n</code></pre>\n\n<p>An explanation can be found here: <a href=\"https://stackoverflow.com/questions/17733541/why-does-range-work-but-not-cells\">Why does Range work, but not Cells?</a> and further clarity from Mat's Mug comment above.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 7199404, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8hr2w-lsF7I/AAAAAAAAAAI/AAAAAAAAAAA/aDd4MOCTJUY/photo.jpg?sz=128", "display_name": "Huzaifa Essajee", "link": "https://stackoverflow.com/users/7199404/huzaifa-essajee"}, "edited": false, "score": 0, "creation_date": 1479999580, "post_id": 40787811, "comment_id": 68801230, "body": "My understanding is that this answer is an efficient method of writing VBA in comparison to my answer, correct?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 13, "user_id": 7199404, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8hr2w-lsF7I/AAAAAAAAAAI/AAAAAAAAAAA/aDd4MOCTJUY/photo.jpg?sz=128", "display_name": "Huzaifa Essajee", "link": "https://stackoverflow.com/users/7199404/huzaifa-essajee"}, "edited": false, "score": 0, "creation_date": 1479999977, "post_id": 40787811, "comment_id": 68801464, "body": "Yes, but use whatever is easier to maintain. I don&#39;t think the difference in speed will be noticeable. <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/11274/always-define-and-set-references-to-all-workbooks-and-sheets#t=201611241506412220564\">stackoverflow.com/documentation/excel-vba/1107/&hellip;</a>"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 0, "last_activity_date": 1479994505, "creation_date": 1479994505, "answer_id": 40787811, "question_id": 40773907, "link": "https://stackoverflow.com/questions/40773907/why-does-define-range-with-cell-address-work-but-not-cell-only-excel-vba/40787811#40787811", "title": "Why does define range with cell.address work but not cell only Excel VBA?", "body": "<p>Saving the range can make it easier:</p>\n\n<pre><code>Set rngFrom = sourceBook.Sheets(\"Sheet1\").Range(\"B\" &amp; FirstRow, \"B\" &amp; LastRow)\nSet rngTo = destBook.Sheets(\"Sheet1\").Range(\"C6\").Resize(rngFrom.Rows.Count)\n\nrngTo.Value = rngFrom.Value\nrngTo.Offset(, 1).Formula = \"=C6*2.236936\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7199404, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8hr2w-lsF7I/AAAAAAAAAAI/AAAAAAAAAAA/aDd4MOCTJUY/photo.jpg?sz=128", "display_name": "Huzaifa Essajee", "link": "https://stackoverflow.com/users/7199404/huzaifa-essajee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 1, "accepted_answer_id": 40787811, "answer_count": 2, "score": 0, "last_activity_date": 1479994505, "creation_date": 1479934103, "last_edit_date": 1495540382, "question_id": 40773907, "link": "https://stackoverflow.com/questions/40773907/why-does-define-range-with-cell-address-work-but-not-cell-only-excel-vba", "title": "Why does define range with cell.address work but not cell only Excel VBA?", "body": "<p>I'm trying to work out how to apply a formula to a range of cells that is defined based on the Range.End method explained <a href=\"https://www.excelcampus.com/vba/find-last-row-column-cell/\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>I've avoided Select etc. as per <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a>.</p>\n\n<p>I've used the code below earlier on with regards to Range(Cells, Cells) and I had the desired output of copying an unknown number of rows dataset in column B related to a particular search entry for data in column A.</p>\n\n<pre><code>Set CopyFrom1 = Cells(FirstRow, \"B\")    \nSet CopyFrom2 = Cells(LastRow, \"B\")\n\nsourceBook.Sheets(\"Sheet1\").Range(CopyFrom1, CopyFrom2).Copy _\n    destBook.Sheets(\"Sheet1\").Range(\"C6\")\n</code></pre>\n\n<p>Now the dataset is copied across to destBook, I want to apply a formula to it. However, I don't know how many rows it is, so I use the Range(Cells, Cells) method again.</p>\n\n<pre><code>LRow = destBook.Sheets(\"Sheet1\").Cells(Rows.Count, \"C\").End(xlUp).Row\nSet LRowA = Cells(LRow, \"D\")\nSet FRowA = Cells(6, \"D\")\ndestBook.Sheets(\"Sheet1\").Range(LRowA, FRowA).Formula = \"=C6*2.236936\"\n</code></pre>\n\n<p>This resulted in: <em>run-time error '1004': Application-defined or object-defined error.</em> </p>\n\n<p>I tried this method of qualifying Cells <a href=\"https://stackoverflow.com/questions/17733541/why-does-range-work-but-not-cells\">Why does Range work, but not Cells?</a>, since the VBA code is running from the sourceBook and I'm working in destBook (different Workbook). However, I get <em>run-time error '438': Object doesn't support this property or method</em>. I don't quite understand what's different here in comparison to what I'm trying to achieve.</p>\n\n<p>Just before posting this, I found <a href=\"https://stackoverflow.com/a/30030763/7199404\">https://stackoverflow.com/a/30030763/7199404</a>, which gave me the result I needed. Code below:</p>\n\n<pre><code>destBook.Sheets(\"Sheet1\").Range(LRowA.Address, FRowA.Address).Formula = \"=C6*2.236936\"\n</code></pre>\n\n<p>Could someone please explain to me why this works and the others do not?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 756, "user_id": 6549541, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YsVtB.jpg?s=128&g=1", "display_name": "atclaus", "link": "https://stackoverflow.com/users/6549541/atclaus"}, "is_accepted": true, "score": 0, "last_activity_date": 1479935970, "creation_date": 1479935970, "answer_id": 40774320, "question_id": 40773872, "link": "https://stackoverflow.com/questions/40773872/loop-through-rows-and-select-dynamic-range-of-columns-to-edit/40774320#40774320", "title": "Loop through rows and select dynamic range of columns to edit", "body": "<p>You need to first create an end range. You were close!</p>\n\n<pre><code>Sub Color_row()\n   Dim EndRow As Long\n   Dim e As Long\n   Dim EndCol, StartCol As Range\n\n   EndRow = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n\n  For e = 2 To EndRow\n    If (Range(\"E\" &amp; e).Value = \"WLO\") Then\n        Set EndCol = Range(\"J\" &amp; e).End(xlToRight)\n        Set StartCol = Range(\"J\" &amp; e)\n        Range(StartCol, EndCol).Interior.ColorIndex = 3\n    End If\n  Next e\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 7202137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7375302fa5e46a7d200967361d99c50e?s=128&d=identicon&r=PG", "display_name": "lsmith", "link": "https://stackoverflow.com/users/7202137/lsmith"}, "edited": false, "score": 0, "creation_date": 1479938395, "post_id": 40774577, "comment_id": 68773561, "body": "That makes sense! Thank you!"}], "tags": [], "owner": {"reputation": 1, "user_id": 7202264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de9954cc0dd2d290d03abe38e799ce0?s=128&d=identicon&r=PG&f=1", "display_name": "MattR", "link": "https://stackoverflow.com/users/7202264/mattr"}, "is_accepted": false, "score": 0, "last_activity_date": 1479937153, "creation_date": 1479937153, "answer_id": 40774577, "question_id": 40773872, "link": "https://stackoverflow.com/questions/40773872/loop-through-rows-and-select-dynamic-range-of-columns-to-edit/40774577#40774577", "title": "Loop through rows and select dynamic range of columns to edit", "body": "<p>In your Then clause, the Selection is wherever your active cell is, so it will highlight to that row. Change the Selection to be your start point, which is J and the row number.</p>\n\n<pre><code>Sub Color_row()\n   Dim EndRow As Long\n   Dim e As Long\n\n   EndRow = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n\n  For e = 2 To EndRow\n    If (Range(\"E\" &amp; e).Value = \"WLO\") Then\n      Range(\"J\" &amp; e, Range(\"J\" &amp; e).End(xlToRight)).Interior.ColorIndex = 3\n    End If\n  Next e\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7202137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7375302fa5e46a7d200967361d99c50e?s=128&d=identicon&r=PG", "display_name": "lsmith", "link": "https://stackoverflow.com/users/7202137/lsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2675, "favorite_count": 0, "accepted_answer_id": 40774320, "answer_count": 2, "score": 0, "last_activity_date": 1479937153, "creation_date": 1479933951, "last_edit_date": 1531161705, "question_id": 40773872, "link": "https://stackoverflow.com/questions/40773872/loop-through-rows-and-select-dynamic-range-of-columns-to-edit", "title": "Loop through rows and select dynamic range of columns to edit", "body": "<p>I am trying to loop through a variable number of rows, searching for a value in Column E (i.e.\"WLO\"). When I find a row with \"WLO\" in Column E I want to select the cells in that row from Column J until the end of the data in that row. The number of columns populated after Column J will vary as this is used in multiple spreadsheets so the selection to the right needs to be dynamic. I want to do something like the below code but currently it turns every row between the first instance of WLO to the last instance of WLO red, even if there are rows with other values in between. <a href=\"https://i.stack.imgur.com/QFtcy.png\" rel=\"nofollow noreferrer\">See Screenshot of current results here.</a></p>\n\n<pre><code>Sub Color_row()\n   Dim EndRow As Long\n   Dim e As Long\n\n   EndRow = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n\n  For e = 2 To EndRow\n    If (Range(\"E\" &amp; e).Value = \"WLO\") Then\n      Range(\"J\" &amp; e, Selection.End(xlToRight)).Interior.ColorIndex = 3\n    End If\n  Next e\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/FLhR4.png\" rel=\"nofollow noreferrer\">This is an example of I would like to be able to do</a>\nThanks for any advice. It is greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 3, "last_activity_date": 1479933986, "creation_date": 1479933986, "answer_id": 40773880, "question_id": 40773847, "link": "https://stackoverflow.com/questions/40773847/retrieving-the-value-from-a-merged-named-range-via-vba/40773880#40773880", "title": "Retrieving the value from a merged, named range via VBA", "body": "<p>Try</p>\n\n<pre><code>ExampleVar = Range(\"ExampleRange\").Cells(1,1).Value\n</code></pre>\n"}], "owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 40773880, "answer_count": 1, "score": 1, "last_activity_date": 1479933986, "creation_date": 1479933842, "question_id": 40773847, "link": "https://stackoverflow.com/questions/40773847/retrieving-the-value-from-a-merged-named-range-via-vba", "title": "Retrieving the value from a merged, named range via VBA", "body": "<p>I am trying to get the value from a merged, named range in Excel however it keeps throwing up exceptions.</p>\n\n<p>If you merge the cells from B2:F10 and then give them a named range of `ExampleRange'</p>\n\n<p>The following code fails to retrieve the value:</p>\n\n<pre><code>ExampleVar = Range(\"ExampleRange\").Value\n</code></pre>\n\n<p>However, if I did the following (I don't want to use this method) it works perfectly fine:</p>\n\n<pre><code> ExampleVar = Range(\"B2\").Value\n</code></pre>\n\n<p>How can I get the named range version to work?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7202087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6770cb102e3b13190da94dabd7867ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Woodman", "link": "https://stackoverflow.com/users/7202087/woodman"}, "edited": false, "score": 0, "creation_date": 1479943399, "post_id": 40775488, "comment_id": 68775239, "body": "I really appreciate your helping - I tried to follow the thread you pointed me to - but I am failing. Bascially I am having trouble specifying the custom folder. My Cel_Emails folder is at teh top level and I am trying toa ccess it using :"}, {"owner": {"reputation": 9, "user_id": 7202087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6770cb102e3b13190da94dabd7867ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Woodman", "link": "https://stackoverflow.com/users/7202087/woodman"}, "edited": false, "score": 0, "creation_date": 1479943749, "post_id": 40775488, "comment_id": 68775369, "body": "I really appreciate your helping - I tried to follow the thread you pointed me to - but I am failing. Bascially I am having trouble specifying the custom folder. My Cel_Emails folder is at teh top level and I am trying to access it using : Set Celfolder=Outlook.Application.GetNamespace(&quot;MAPI&quot;).Folders(&quot;&zwnj;&#8203;Cel_Emails&quot;) - but I keep getting a type mismatch error. Can you please help and post a snippet that shows me _&gt; if I have a folder called Cel_Emails&quot; on the default level -and I want to do a search so that only the emails with &quot;Example&quot; in the subject line show (all others are masked) -"}, {"owner": {"reputation": 596, "user_id": 6855437, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/QYZ8M.png?s=128&g=1", "display_name": "BLang", "link": "https://stackoverflow.com/users/6855437/blang"}, "reply_to_user": {"reputation": 9, "user_id": 7202087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6770cb102e3b13190da94dabd7867ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Woodman", "link": "https://stackoverflow.com/users/7202087/woodman"}, "edited": false, "score": 0, "creation_date": 1479951199, "post_id": 40775488, "comment_id": 68777106, "body": "I am a little confused, is your, &quot;Cel_Emails&quot; a folder in your mailbox? or is it a whole separate mail box that has its own inbox and sent etc."}], "tags": [], "owner": {"reputation": 596, "user_id": 6855437, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/QYZ8M.png?s=128&g=1", "display_name": "BLang", "link": "https://stackoverflow.com/users/6855437/blang"}, "is_accepted": false, "score": 0, "last_activity_date": 1479941642, "last_edit_date": 1495535416, "creation_date": 1479941642, "answer_id": 40775488, "question_id": 40773675, "link": "https://stackoverflow.com/questions/40773675/outlook-search-emails-with-specific-word-in-subject-in-non-default-email-folder/40775488#40775488", "title": "Outlook search emails with specific word in subject in non-default email folder", "body": "<p>Kind of a repeat question, this will get you started. <a href=\"https://stackoverflow.com/questions/9076634/get-reference-to-additional-inbox\">Get reference to additional Inbox</a></p>\n\n<p>If you would like to know how to cycle through emails in a folder and open them based on a word in the subject i will edit my answer and post it below.</p>\n"}], "owner": {"reputation": 9, "user_id": 7202087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6770cb102e3b13190da94dabd7867ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Woodman", "link": "https://stackoverflow.com/users/7202087/woodman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 302, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1479941642, "creation_date": 1479933099, "question_id": 40773675, "link": "https://stackoverflow.com/questions/40773675/outlook-search-emails-with-specific-word-in-subject-in-non-default-email-folder", "title": "Outlook search emails with specific word in subject in non-default email folder", "body": "<p>Help please- I am a complete newbie at this - I have a folder called \"Cel_Emails\" at the same level as the default folders. It contains some emails  , and I manually do a search for all emails in this folder and look for all emails  containing the word \"Example\" in the subject line (at which point - it only shows those emails and hides all other emails in that folder).  </p>\n\n<p>I am trying to write a vba script to do this - but am failing miserably - can anyone please help ?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1479933507, "post_id": 40773537, "comment_id": 68771364, "body": "You can always use <code>SendKeys</code> to simulate <code>CTRL+C</code>"}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "reply_to_user": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1479934896, "post_id": 40773537, "comment_id": 68772002, "body": "I find SendKeys unreliable, but for purpose of narrowing down the issue, I&#39;ve used <code>SendKeys &quot;^c&quot;, True</code> instead of Selection.Copy with the same poor effect. If I&#39;ve properly sent CTRL+C, then the problem lies almost certainly in bringing Word document to front. Can it be done at all? If yes, does Word application need to be visible?"}], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479935099, "creation_date": 1479932541, "last_edit_date": 1479935099, "question_id": 40773537, "link": "https://stackoverflow.com/questions/40773537/vba-cant-properly-copy-object-from-word-document-if-it-isnt-active-brought", "title": "VBA - can&#39;t properly copy object from Word Document if it isn&#39;t active (brought to front)", "body": "<p>When I select logo object from footer, <code>Selection.Copy</code> creates an object in Clipboard, which - tested in Break Mode - after pasting anywhere appears as 2 next line separators: Chr(13) chr(10) Chr(13) Chr(10).</p>\n\n<p>If after selecting logo object with code, I manually navigate to template document and use CTRL + C, it is properly stored in Clipboard.</p>\n\n<p>I tried <code>tempDoc.Activate</code> before <code>Selection.Copy</code>, but it doesn't bring template file to front (I have openedDoc open as well at the same time).</p>\n\n<pre><code>Sub changeHeadersFooters(openedDoc As Object, tempDoc As Object)\n\nDim shp As Object, logo As Object\nDim HdFt As Object, hdrOpened As Object    \n\n'create logo object in template doc\nFor Each HdFt In tempDoc.Sections(1).footers\n    If HdFt.Exists Then\n        For Each shp In HdFt.Shapes\n            If InStr(shp.Name, \"image\") &lt;&gt; 0 Then Set logo = shp: Exit For\n        Next shp\n    End If\nNext HdFt\n\nSet hdrOpened = openedDoc.Sections(1).footers(1)\n\nlogo.Select\nSelection.Copy\nWith hdrOpened.Range\n    .Collapse Direction:=1 'wdCollapseStart=1, wdCollapseEnd = 0\n    .Paste\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1479932336, "post_id": 40773171, "comment_id": 68770811, "body": "AFAIK, a custom format of <code>00:00</code> wouldn&#39;t be valid.  Do you perhaps mean <code>hh:mm</code>?  But if you are using <code>hh:mm</code> then entering &quot;0300&quot; would cause Excel to display the time of midnight on day 300 (i.e. 26 October 1900).  Or have you used a format of <code>00\\:00</code>?  But <code>00\\:00</code> would cause an entry of &quot;03:00&quot; to be calculated as 0.125 (1/8th of a day) and displayed as &quot;00:00&quot;.  I&#39;m afraid that I am confused."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1479933227, "post_id": 40773171, "comment_id": 68771242, "body": "Why don&#39;t you just replace <code>;</code> with <code>:</code> and run the normal macro that you have?"}, {"owner": {"reputation": 3, "user_id": 4729532, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50d532c2d1ebc5b0bca8720d6e2554a1?s=128&d=identicon&r=PG&f=1", "display_name": "jynxy", "link": "https://stackoverflow.com/users/4729532/jynxy"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1479933472, "post_id": 40773171, "comment_id": 68771352, "body": "Sorry i meant 00\\:00 this works fine. @niclas i dont have any macro at present i need one on cell change. ive tried but not sure what im doing is right."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4729532, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50d532c2d1ebc5b0bca8720d6e2554a1?s=128&d=identicon&r=PG&f=1", "display_name": "jynxy", "link": "https://stackoverflow.com/users/4729532/jynxy"}, "edited": false, "score": 0, "creation_date": 1479989212, "post_id": 40775313, "comment_id": 68794447, "body": "Hi nbayly Thanks for your comment. i have tried this, if i enter 0302 the time changes to 03:02 as expected. if i enter 03:02 this now changes to 00:00 which is no good, and if i enter 03;02 it remains the same. have i done something wrong ?"}, {"owner": {"reputation": 3, "user_id": 4729532, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50d532c2d1ebc5b0bca8720d6e2554a1?s=128&d=identicon&r=PG&f=1", "display_name": "jynxy", "link": "https://stackoverflow.com/users/4729532/jynxy"}, "edited": false, "score": 0, "creation_date": 1479991139, "post_id": 40775313, "comment_id": 68795758, "body": "Ok im getting closer, [code]Private Sub Worksheet_Change(ByVal Target As Range)     If Target.CountLarge = 1 And Target.Column = 1 And Target.Row &gt; 5 Then         Target.Value = Replace(Target.Value, &quot;;&quot;, &quot;:&quot;)     End If End Sub  [/code] however i have to remove the cell format, so this now allow 03:02 and converts 03;02 to 03:02 however i now need it so that when i enter 0302 it converts to 03:02"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 3, "user_id": 4729532, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50d532c2d1ebc5b0bca8720d6e2554a1?s=128&d=identicon&r=PG&f=1", "display_name": "jynxy", "link": "https://stackoverflow.com/users/4729532/jynxy"}, "edited": false, "score": 0, "creation_date": 1480006990, "post_id": 40775313, "comment_id": 68805481, "body": "That proves a lot more difficult than your original ask mainly because the event won&#39;t fire until after you enter the value and Excel reformats the number. Are you presetting your cells in column A as Time format? The problem you have is that Excel is trying to interpret and reformat your input so I don&#39;t know anyway to find the manual input before Excel does this. Maybe set your column as Text and create a time format validation and then set that cell format to time."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 3, "user_id": 4729532, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50d532c2d1ebc5b0bca8720d6e2554a1?s=128&d=identicon&r=PG&f=1", "display_name": "jynxy", "link": "https://stackoverflow.com/users/4729532/jynxy"}, "edited": false, "score": 0, "creation_date": 1480007079, "post_id": 40775313, "comment_id": 68805505, "body": "This seems a bit more extensive than your original ask. If you found my answer suitable to your original question could you kindly mark it as such. You might want to resubmit your followup as a new question to get more eyeballs. Cheers."}, {"owner": {"reputation": 3, "user_id": 4729532, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50d532c2d1ebc5b0bca8720d6e2554a1?s=128&d=identicon&r=PG&f=1", "display_name": "jynxy", "link": "https://stackoverflow.com/users/4729532/jynxy"}, "edited": false, "score": 0, "creation_date": 1480074864, "post_id": 40775313, "comment_id": 68829628, "body": "please see below."}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 0, "last_activity_date": 1479940683, "creation_date": 1479940683, "answer_id": 40775313, "question_id": 40773171, "link": "https://stackoverflow.com/questions/40773171/excel-time-format/40775313#40775313", "title": "Excel Time Format", "body": "<p>On your sheets change event you would place the following code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.CountLarge = 1 And Target.Column = 1 And Target.Row &gt; 5 Then\n        Target.Value2 = Replace(Target.Value2, \";\", \":\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>Explaining the code... it first checks to make sure that the change isn't on multiple cells (ie paste) and that the change is on column A below Row 5. If it does pass the conditional it simply replaces <code>;</code> for <code>:</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 4729532, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50d532c2d1ebc5b0bca8720d6e2554a1?s=128&d=identicon&r=PG&f=1", "display_name": "jynxy", "link": "https://stackoverflow.com/users/4729532/jynxy"}, "is_accepted": true, "score": 0, "last_activity_date": 1480074849, "creation_date": 1480074849, "answer_id": 40804474, "question_id": 40773171, "link": "https://stackoverflow.com/questions/40773171/excel-time-format/40804474#40804474", "title": "Excel Time Format", "body": "<p>This does what i require.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nDim xStr As String\nDim xVal As String\nSet rng1 = Range(\"A:A\")\nSet rng2 = Range(\"C:C\")\nSet rng3 = Range(\"I:I\")\nOn Error GoTo EndMacro\nIf Application.Intersect(Target, Union(rng1, rng2, rng3)) Is Nothing Then Exit Sub\nIf Target.Count &gt; 1 Then Exit Sub\nIf Target.Value = \"\" Then Exit Sub\nIf Target.Row &lt; 5 Then Exit Sub\nApplication.EnableEvents = False\nWith Target\n    If Not .HasFormula Then\n        Target.Value = Replace(Target.Value, \";\", \":\")\n        Target.Value = Left(Target.Value, 5)\n        xVal = .Value\n        Select Case Len(xVal)\n            Case 1 ' e.g., 1 = 00:01 AM\n                xStr = \"00:0\" &amp; xVal\n            Case 2 ' e.g., 12 = 00:12 AM\n                xStr = \"00:\" &amp; xVal\n            Case 3 ' e.g., 735 = 07:35 AM\n                xStr = \"0\" &amp; Left(xVal, 1) &amp; \":\" &amp; Right(xVal, 2)\n            Case 4 ' e.g., 1234 = 12:34\n                xStr = Left(xVal, 2) &amp; \":\" &amp; Right(xVal, 2)\n            Case 5 ' e.g., 12:45 = 12:45\n                xStr = Left(xVal, 2) &amp; Mid(xVal, 2, 1) &amp; Right(xVal, 2)\n            Case Else\n                Err.Raise 0\n        End Select\n        .Value = Format(TimeValue(xStr), \"hh:mm\")\n    End If\nEnd With\nApplication.EnableEvents = True\nExit Sub\n</code></pre>\n\n<p>EndMacro:\n    Application.EnableEvents = True\nEnd Sub</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 3, "user_id": 4729532, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50d532c2d1ebc5b0bca8720d6e2554a1?s=128&d=identicon&r=PG&f=1", "display_name": "jynxy", "link": "https://stackoverflow.com/users/4729532/jynxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 40804474, "answer_count": 2, "score": 0, "last_activity_date": 1480074849, "creation_date": 1479931186, "last_edit_date": 1531161705, "question_id": 40773171, "link": "https://stackoverflow.com/questions/40773171/excel-time-format", "title": "Excel Time Format", "body": "<p>Having trouble with time formatting.</p>\n\n<p>I have set the cell to custom format 00:00.</p>\n\n<p>Currently in column A a date is inputted, this can be as 0300 which converts to 03:00 which is perfect or you can just enter 03:00.</p>\n\n<p>I now have a problem if a user enters 03;00 as i need this to display 03:00</p>\n\n<p>how can i ensure that all times are in the hh:mm format and not in hh;mm etc.</p>\n\n<p>This needs to auto change on input for anything in column A, except what is the header (A1:A5) although this should not be affected.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479941822, "post_id": 40773057, "comment_id": 68774757, "body": "The examples you link to are dependent only on the VBScript regular expressions library - that isn&#39;t a part of Office, but is typically (always?) present on Windows PC&#39;s (note this would not fly on a Mac) so it shouldn&#39;t make any difference which version you&#39;re using [on Windows].."}, {"owner": {"reputation": 3767, "user_id": 4752883, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fb3af89e0d02269d8abb9f42c283bb8f?s=128&d=identicon&r=PG&f=1", "display_name": "alpha_989", "link": "https://stackoverflow.com/users/4752883/alpha-989"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479944785, "post_id": 40773057, "comment_id": 68775661, "body": "I understand you can use regular experessions once you install the VBscript library in functions, but I was wondering is whether I would be able to use regular expressions using the &quot;Find and replace&quot; dialog box?  Find and replace is just quicker to find particular cells rather than using the filter option or using function in cells, when you have a large partially undstrucred work sheet"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479947174, "post_id": 40773057, "comment_id": 68776219, "body": "The built-in Find/Replace has a fairly limited set of options: these are distinct from the methods described in the answers to your linked question."}, {"owner": {"reputation": 3767, "user_id": 4752883, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fb3af89e0d02269d8abb9f42c283bb8f?s=128&d=identicon&r=PG&f=1", "display_name": "alpha_989", "link": "https://stackoverflow.com/users/4752883/alpha-989"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479953675, "post_id": 40773057, "comment_id": 68777715, "body": "Let me clarify.. I was asking.. if I install the VBscript regular expressions addon in the link above.. will I be able to search using regular expressions using the built-in &quot;Find/Replace&quot;?  I know about the limitations of Find/Replace... that is what I am trying to overcome using this addon.."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479959821, "post_id": 40773057, "comment_id": 68779207, "body": "No - you can use it in VBA but not in the built in dialogs.  It&#39;s not really an add-in,  just something you can use from a script."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1479960394, "post_id": 40773057, "comment_id": 68779325, "body": "Making this in-built functionality has been suggested in User Voice. MSFT are looking at it. Time to implementation is anyone&#39;s guess."}, {"owner": {"reputation": 3767, "user_id": 4752883, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fb3af89e0d02269d8abb9f42c283bb8f?s=128&d=identicon&r=PG&f=1", "display_name": "alpha_989", "link": "https://stackoverflow.com/users/4752883/alpha-989"}, "edited": false, "score": 0, "creation_date": 1480290770, "post_id": 40773057, "comment_id": 68887925, "body": "Ok thank you.. do you know of any addins that might give this functionality?  has anybody tried this: <a href=\"http://www.codedawn.com/excel-add-ins.php\" rel=\"nofollow noreferrer\">codedawn.com/excel-add-ins.php</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1479975901, "creation_date": 1479975901, "answer_id": 40781229, "question_id": 40773057, "link": "https://stackoverflow.com/questions/40773057/excel-use-find-and-replace-with-regular-expressions-after-referencing-vbscript/40781229#40781229", "title": "Excel - use Find and Replace with regular expressions after referencing vbscript.dll", "body": "<p>No - once you have reference the regular expressions library you will be able to use regular expressions in VBA code, but there won't be any new options in the Find and Replace dialog:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YRxc9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YRxc9.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3767, "user_id": 4752883, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fb3af89e0d02269d8abb9f42c283bb8f?s=128&d=identicon&r=PG&f=1", "display_name": "alpha_989", "link": "https://stackoverflow.com/users/4752883/alpha-989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 40781229, "answer_count": 1, "score": 1, "last_activity_date": 1479975901, "creation_date": 1479930753, "last_edit_date": 1531161705, "question_id": 40773057, "link": "https://stackoverflow.com/questions/40773057/excel-use-find-and-replace-with-regular-expressions-after-referencing-vbscript", "title": "Excel - use Find and Replace with regular expressions after referencing vbscript.dll", "body": "<p>Somebody here suggested that you can add regular expressions in Excel <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a></p>\n\n<p>Before I jump into the additional steps necessary to make regular expressions work, I am curious to know whether I will be able to use regular expressions <strong>with the built-in Find and Replace dialog</strong> in Excel 2013/2016 if I follow the steps outlined above?</p>\n\n<p>I know that I can use the wild cards * in Excel, but not sure of the other options available if I enable Regular expressions.</p>\n"}, {"tags": ["excel", "export-to-pdf", "vba"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4350930, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-CJyyzvDtBlw/AAAAAAAAAAI/AAAAAAAAABY/wPj0VY1_2gQ/photo.jpg?sz=128", "display_name": "John Aschenbrenner", "link": "https://stackoverflow.com/users/4350930/john-aschenbrenner"}, "is_accepted": false, "score": 0, "last_activity_date": 1480448955, "last_edit_date": 1480448955, "creation_date": 1480447732, "answer_id": 40874234, "question_id": 40772903, "link": "https://stackoverflow.com/questions/40772903/print-multiple-sheets-and-sheet-ranges-with-hidden-areas-in-one-print-job-excel/40874234#40874234", "title": "Print multiple Sheets and Sheet Ranges with hidden areas in one Print Job Excel VBA", "body": "<p>I did finally figure this out with what I think is the simplest solution.  I copied the page twice onto separate worksheets and then simply hid the areas that did not need to be printed.  I then delete the worksheets which always ask the user for permission, not the best but it works.  As an enhancement I could safe to a separate workbook in the %temp% directory.  That way it would not ask permission to delete as no deletion would be necessary.</p>\n\n<p>ADD.  I did not realize this but I can easily turn off the alerts in VBA and solve that display pop up problem.</p>\n"}], "owner": {"reputation": 21, "user_id": 4350930, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-CJyyzvDtBlw/AAAAAAAAAAI/AAAAAAAAABY/wPj0VY1_2gQ/photo.jpg?sz=128", "display_name": "John Aschenbrenner", "link": "https://stackoverflow.com/users/4350930/john-aschenbrenner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480448955, "creation_date": 1479930175, "last_edit_date": 1531161705, "question_id": 40772903, "link": "https://stackoverflow.com/questions/40772903/print-multiple-sheets-and-sheet-ranges-with-hidden-areas-in-one-print-job-excel", "title": "Print multiple Sheets and Sheet Ranges with hidden areas in one Print Job Excel VBA", "body": "<p>This is similar to another post I saw but different enough that I feel I needed to ask the question.  I have a sheet ranges that I want to Export to a PDF.  But here is where it gets difficult.  One sheet that I need to print does not fit on the entire print area so what I need to do is print part of the sheet (Range) on one page and have the leftover columns print to a different page.  Normally this would just need to be a separate range but I need to keep the leftmost columns for context of that second range.  So the second page needs to have two print ranges on one page, is that possible?  Or, can I somehow print the second page with a hidden area, i.e. removing the columns that were printed on the first page?  If I went with this latter solution I would need to unhide those columns after the print job finished.  I want to keep all of the printing exported to one PDF.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479929806, "post_id": 40772722, "comment_id": 68769506, "body": "You probably don&#39;t have a worksheet named &quot;wsS2&quot; in the active workbook when the loop runs. Also, the 2nd line of the loop&#39;s body does absolutely nothing. Or did you cut off an underscore after <code>.Copy</code>?"}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1479930162, "post_id": 40772722, "comment_id": 68769651, "body": "When do you get the error? In the first iteration of the loop or afterwards?"}, {"owner": {"reputation": 13, "user_id": 7201428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca664baef5246968bfe47125cbce3529?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan M", "link": "https://stackoverflow.com/users/7201428/ryan-m"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479930290, "post_id": 40772722, "comment_id": 68769726, "body": "@Mat&#39;sMug I apologize, wsS2 is defined earlier in the code as &quot;Raw Data&quot;, and I do have a sheet with that name. as for the underscore... yes, I did cut that off. I will replace it and see i that works!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1479930373, "post_id": 40772722, "comment_id": 68769768, "body": "You can get rid of the <code>If Not i = ending Then</code> test by changing the loop to <code>Do Until i = ending ... Loop</code>."}, {"owner": {"reputation": 13, "user_id": 7201428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca664baef5246968bfe47125cbce3529?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan M", "link": "https://stackoverflow.com/users/7201428/ryan-m"}, "reply_to_user": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1479930382, "post_id": 40772722, "comment_id": 68769772, "body": "@FDavidov I&#39;m not sure. Is there a way to check that without actually testing it on the workbook?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1479930424, "post_id": 40772722, "comment_id": 68769797, "body": "If <code>wsS2</code> is a variable, remove the quotes.  Same for <code>wsS1</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479930559, "post_id": 40772722, "comment_id": 68769878, "body": "^^ that is the problem."}, {"owner": {"reputation": 13, "user_id": 7201428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca664baef5246968bfe47125cbce3529?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan M", "link": "https://stackoverflow.com/users/7201428/ryan-m"}, "edited": false, "score": 0, "creation_date": 1479930632, "post_id": 40772722, "comment_id": 68769917, "body": "Removing the quotes did it, thanks for the help all!"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 7201428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca664baef5246968bfe47125cbce3529?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan M", "link": "https://stackoverflow.com/users/7201428/ryan-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1479930923, "creation_date": 1479930923, "answer_id": 40773100, "question_id": 40772722, "link": "https://stackoverflow.com/questions/40772722/subscript-out-of-range-in-do-while/40773100#40773100", "title": "subscript out of range in do while", "body": "<blockquote>\n  <p>If wsS2 is a variable, remove the quotes. Same for wsS1. \u2013 Comintern</p>\n</blockquote>\n\n<p>Removing the quotes does it!</p>\n"}], "owner": {"reputation": 13, "user_id": 7201428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca664baef5246968bfe47125cbce3529?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan M", "link": "https://stackoverflow.com/users/7201428/ryan-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 0, "accepted_answer_id": 40773100, "answer_count": 1, "score": 0, "last_activity_date": 1479930923, "creation_date": 1479929409, "question_id": 40772722, "link": "https://stackoverflow.com/questions/40772722/subscript-out-of-range-in-do-while", "title": "subscript out of range in do while", "body": "<p>I am trying to copy values from one workbook to another for a variable amount of rows, dictated by the \"ending\" variable. The problem is, I get a subscript out of range error on the first line of the Do While loop. I have tried changing the Range to many different values, including static ones (like \"A23\") to no avail. What else can I try?</p>\n\n<pre><code>i = 1\n    If Not i = ending Then\n        Do\n            Worksheets(\"wsS2\").Range(\"A\" &amp; 23 + i).copy\n            Worksheets(\"wsS1\").Range (\"A\" &amp; 15 + i)\n            i = i + 1\n        Loop While Not i = ending\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1479929754, "post_id": 40772690, "comment_id": 68769478, "body": "<code>For</code> statements are of the form <code>For variable = start To end [ Step stepvalue ]</code> so you probably want <code>For row = 2 To .Rows.Count</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1479930571, "post_id": 40772690, "comment_id": 68769887, "body": "But see the answer by Gary&#39;s Student, which will stop you from filling up every second row, for a million+ rows, with the value 1."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1479930569, "last_edit_date": 1479930569, "creation_date": 1479929839, "answer_id": 40772826, "question_id": 40772690, "link": "https://stackoverflow.com/questions/40772690/how-to-get-the-count-of-rows-in-a-sheet/40772826#40772826", "title": "How to get the count of rows in a sheet?", "body": "<p>You do not need a <code>Loop</code>:</p>\n\n<pre><code>Sub dural()\n    Dim N As Long, summary As Worksheet\n    Set summary = ActiveSheet\n\n    With summary\n        .Range(\"$A$1:$A$100\").RemoveDuplicates Columns:=1, Header:=xlYes\n        N = .Cells(Rows.Count, 1).End(xlUp).Row\n        .Range(\"B2:B\" &amp; N).Value = 1\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong><em>Note:</em></strong> The code assumes there is nothing else in column <strong>A</strong>.</p>\n"}], "owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 40772826, "answer_count": 1, "score": 0, "last_activity_date": 1479930569, "creation_date": 1479929294, "last_edit_date": 1531164843, "question_id": 40772690, "link": "https://stackoverflow.com/questions/40772690/how-to-get-the-count-of-rows-in-a-sheet", "title": "How to get the count of rows in a sheet?", "body": "<p>I am trying this code</p>\n\n<pre><code>row = 2\nWith Summary\n    .Range(\"$A$1:$A$100\").RemoveDuplicates Columns:=1, Header:=xlYes\n    For row To .Rows.Count\n        .Cells(row, 2) = 1\n        row = row + 1\n    Next row\nEnd With\n</code></pre>\n\n<p>but I get a syntax error in the for loop statement</p>\n\n<p>How should this look like?</p>\n"}, {"tags": ["mysql", "vba", "ms-access", "adodb"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1479931117, "post_id": 40772503, "comment_id": 68770150, "body": "You should not be using <code>rs.Open</code> for action queries. Use <code>conn.Execute</code> instead."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479931312, "post_id": 40772503, "comment_id": 68770254, "body": "Or better, create an <code>ADODB.Command</code> and <code>.Execute</code> that."}, {"owner": {"reputation": 1, "user_id": 5951498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbb8fe987fa4f14a7dbbe8fb9eb8f7da?s=128&d=identicon&r=PG", "display_name": "Bastian", "link": "https://stackoverflow.com/users/5951498/bastian"}, "edited": false, "score": 0, "creation_date": 1479936381, "post_id": 40772503, "comment_id": 68772671, "body": "Thank you, switched to ADODB.Command"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5951498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbb8fe987fa4f14a7dbbe8fb9eb8f7da?s=128&d=identicon&r=PG", "display_name": "Bastian", "link": "https://stackoverflow.com/users/5951498/bastian"}, "is_accepted": false, "score": 0, "last_activity_date": 1479936361, "last_edit_date": 1495542270, "creation_date": 1479936361, "answer_id": 40774407, "question_id": 40772503, "link": "https://stackoverflow.com/questions/40772503/mysql-queries-via-odbc-from-ms-access-vba-adodb-asynchronous-execution-does-not/40774407#40774407", "title": "MySQL-Queries via ODBC from MS Access VBA: ADODB asynchronous execution does not work", "body": "<p>Thank you for helping, I found the answer here:\n<a href=\"https://stackoverflow.com/questions/22659411/vb6-ado-asynchronous-command-and-closing-the-connection\">VB6, ADO, Asynchronous command and closing the connection</a></p>\n\n<p>You have to create a new connection for every recordset/command you want to execute in parallel because otherwise the query will be stacked on the connections execution list. Do not forget to close the connection after execution of each query.</p>\n"}], "owner": {"reputation": 1, "user_id": 5951498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbb8fe987fa4f14a7dbbe8fb9eb8f7da?s=128&d=identicon&r=PG", "display_name": "Bastian", "link": "https://stackoverflow.com/users/5951498/bastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593957641, "creation_date": 1479928585, "last_edit_date": 1593957641, "question_id": 40772503, "link": "https://stackoverflow.com/questions/40772503/mysql-queries-via-odbc-from-ms-access-vba-adodb-asynchronous-execution-does-not", "title": "MySQL-Queries via ODBC from MS Access VBA: ADODB asynchronous execution does not work", "body": "<p>I am using an Access Database as a frontend with MySQL as a backend. To save time with rather time intensive queries I would like to have the MySQL-Server run these in parallel.</p>\n\n<p>Currently I cannot work out to tell VBA to send them asynchronously. My code is like this:</p>\n\n<pre><code>Do While ...\n   Dim rs_newRecordSet As ADODB.Recordset\n   Set rs_newRecordSet = New ADODB.Recordset\n   rs_newRecordSet.Open Ext_TranslateQuery(str_query), Ext_Connection, , , adAsyncExecute\nLoop\n</code></pre>\n\n<p>So during the Do while loop several queries are opened through a recordset with the option adAsyncExecute. The queries are all INSERT INTO ... SELECT FROM-Queries, so I do not expected the recordsets to return anything.</p>\n\n<p>Problem now is, that even though the adAsyncExecute-Option is specified, VBA seems to wait until the Recordset.Open-Command is finished. Furthermore, if I run a <em>show processlist</em> on the mysql schema I do see just one thread with an INSERT INTO ...-Query.</p>\n\n<p>Why does VBA wait for the execution of the query and how can I change this?</p>\n\n<p>Many thanks\nBastian</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7001138, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153665545370904/picture?type=large", "display_name": "Kyle ", "link": "https://stackoverflow.com/users/7001138/kyle"}, "edited": false, "score": 0, "creation_date": 1479930685, "post_id": 40772589, "comment_id": 68769941, "body": "Hey! Thanks for the response. I tried your code and it copies and pastes correctly except that it only starts pasting data at A49. This means there is a gap between the info pasted from A10:J48. At A49, the information from Sheet1 pastes and then the rest follows suit. Let me know if you need any clarification."}, {"owner": {"reputation": 15, "user_id": 7001138, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153665545370904/picture?type=large", "display_name": "Kyle ", "link": "https://stackoverflow.com/users/7001138/kyle"}, "edited": false, "score": 0, "creation_date": 1479930913, "post_id": 40772589, "comment_id": 68770038, "body": "Update, I tried replacing r = r+39 as you mentioned and it fixed the above issue...thanks!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 15, "user_id": 7001138, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153665545370904/picture?type=large", "display_name": "Kyle ", "link": "https://stackoverflow.com/users/7001138/kyle"}, "edited": false, "score": 0, "creation_date": 1479930941, "post_id": 40772589, "comment_id": 68770050, "body": "(a) Do you have a sheet (other than &quot;COMBINATION&quot;) that has blanks in cells A10:J48?  (b) Is the &quot;COMBINATION&quot; sheet actually named &quot;COMBINATION&quot;, or is it perhaps named &quot;Combination&quot;?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 15, "user_id": 7001138, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153665545370904/picture?type=large", "display_name": "Kyle ", "link": "https://stackoverflow.com/users/7001138/kyle"}, "edited": false, "score": 0, "creation_date": 1479931206, "post_id": 40772589, "comment_id": 68770196, "body": "If your &quot;COMBINATION&quot; sheet is actually called &quot;Combination&quot;, the alternative method of calculating <code>r</code> will work only <b>as long as &quot;Combination&quot; is the first sheet processed</b>.  If the incorrect name is what was causing the blanks to be placed into the results, the correct way to fix the error would be to change the <code>If</code> statement to correctly reflect the name of the sheet which is to be ignored."}, {"owner": {"reputation": 15, "user_id": 7001138, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153665545370904/picture?type=large", "display_name": "Kyle ", "link": "https://stackoverflow.com/users/7001138/kyle"}, "edited": false, "score": 0, "creation_date": 1479989432, "post_id": 40772589, "comment_id": 68794615, "body": "My &quot;COMBINATION&quot; sheet is exactly as &quot;COMBINATION&quot;. Thanks for your help!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1479929344, "last_edit_date": 1479929344, "creation_date": 1479928968, "answer_id": 40772589, "question_id": 40772403, "link": "https://stackoverflow.com/questions/40772403/code-cleanup-for-combining-sheets/40772589#40772589", "title": "Code Cleanup for Combining Sheets", "body": "<p>I would use code like the following:</p>\n\n<pre><code>Dim ws As Worksheet\nDim r As Long\n\n'Copy A1:J9 from the first sheet\nWorksheets(\"Sheet1\").Range(\"A1:J9\").Copy\nWorkSheets(\"COMBINATION\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues, _\n                                                   Operation:=xlNone, _\n                                                   SkipBlanks:=False, _\n                                                   Transpose:=False\n\n'Now loop through every sheet (except \"COMBINATION\") copying cells A10:J48\n\nr = 10  ' first sheet will be copied to row 10 in COMBINATION\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"COMBINATION\" Then\n        ws.Range(\"A10:J48\").Copy\n        Worksheets(\"COMBINATION\").Range(\"A\" &amp; r).PasteSpecial Paste:=xlPasteValues, _\n                                                              Operation:=xlNone, _\n                                                              SkipBlanks:=False, _\n                                                              Transpose:=False\n\n        'Set pointer ready for next sheet\n        r = r + 39\n    End If\nNext\n\n'Set column widths\nWorksheets(\"COMBINATION\").Columns.AutoFit\n</code></pre>\n\n<p>If your sheets don't always have data in all 39 rows (10 to 48), replace <code>r = r + 39</code> with</p>\n\n<pre><code>r = Worksheets(\"COMBINATION\").Range(\"A\" &amp; Worksheets(\"COMBINATION\").Rows.Count).End(xlUp).Row + 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "is_accepted": false, "score": 0, "last_activity_date": 1479929013, "creation_date": 1479929013, "answer_id": 40772601, "question_id": 40772403, "link": "https://stackoverflow.com/questions/40772403/code-cleanup-for-combining-sheets/40772601#40772601", "title": "Code Cleanup for Combining Sheets", "body": "<p>Put the repeating code into a loop (untested):</p>\n\n<pre><code>Dim i as Integer\n\nFor i=2 to 341\n    Sheets(i).Select\n    Range(\"A10:J10\").Select\n    Range(\"J10\").Activate\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"COMBINATION\").Select\n    NextFree = Range(\"A10:A\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\n    Range(\"A\" &amp; NextFree).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1479930196, "creation_date": 1479930196, "answer_id": 40772908, "question_id": 40772403, "link": "https://stackoverflow.com/questions/40772403/code-cleanup-for-combining-sheets/40772908#40772908", "title": "Code Cleanup for Combining Sheets", "body": "<p><code>Range.PasteSpecial xlPasteValues</code> is convenient but slow.  It is much faster to define your 'Target' range to be the same size as your source range and do a direct assignment.</p>\n\n<pre><code>Sub CombineData()\n    Application.ScreenUpdating = False\n\n    Dim ws As Worksheet\n    Dim Target As Range\n    With Worksheets(\"COMBINATION\")\n        .Range(\"A1:J9\").Value = Worksheets(\"Sheet1\").Range(\"A1:J49\").Value\n        For Each ws In Worksheets\n            If ws.Name &lt;&gt; .Name Then\n                Set Target = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1)\n                Target.Resize(39, 10).Value = ws.Range(\"A10:J48\").Value\n            End If\n        Next\n    End With\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7001138, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153665545370904/picture?type=large", "display_name": "Kyle ", "link": "https://stackoverflow.com/users/7001138/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 40772589, "answer_count": 3, "score": 0, "last_activity_date": 1479930196, "creation_date": 1479928151, "question_id": 40772403, "link": "https://stackoverflow.com/questions/40772403/code-cleanup-for-combining-sheets", "title": "Code Cleanup for Combining Sheets", "body": "<p>I do not have much experience with VBA but I will start by explaining my situation.</p>\n\n<p>I have a workbook with 341 sheets. Each sheet is identical in layout in that they occupy the space A1:J48. I need to combine all of these into one sheet called \"COMBINATION\". The information of relevance is from A10:J48. I also need to have the cells from A1:J9 as they are the title which is shared across all the sheets.</p>\n\n<p>What I did was write a code that copies A1:J48 for Sheet1 (to get the title and info) and pastes it into \"COMBINATION\" with the paste special as text, then a code that goes to Sheet2 and copies from A10:J48 and pastes it in the first empty cell in column A of \"COMBINATION\". </p>\n\n<p>This brings me to my problem. I have realized that there must be an easier way of doing this instead of copying the code 339 more times for each of the sheets.</p>\n\n<p>See below the code. It does what I want correctly but as mentioned, I would like to find a way to not do this 339 more times...</p>\n\n<pre><code>Sheets(\"Sheet1\").Select\nRange(\"A1:J48\").Select\nSelection.Copy\nSheets(\"COMBINATION\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nSelection.Columns.AutoFit\n\nSheets(\"Sheet2\").Select\nRange(\"A10:J10\").Select\nRange(\"J10\").Activate\nRange(Selection, Selection.End(xlDown)).Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"COMBINATION\").Select\nNextFree = Range(\"A10:A\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\nRange(\"A\" &amp; NextFree).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n"}, {"tags": ["c++", "excel", "vba", "winapi"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1479927312, "post_id": 40772166, "comment_id": 68768279, "body": "A <code>bool</code> is not the same as a <code>BOOL</code>.  The C++ function should be using <code>BOOL</code>."}, {"owner": {"reputation": 162, "user_id": 6841200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0ee3fbb31ed128f84ac6b61df829ca4?s=128&d=identicon&r=PG&f=1", "display_name": "kaineub", "link": "https://stackoverflow.com/users/6841200/kaineub"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1479929528, "post_id": 40772166, "comment_id": 68769392, "body": "I knew that they weren&#39;t the same. I didn&#39;t know that the Boolean type in VBA wasn&#39;t the same as bool in C++ though. I&#39;ll use BOOL from now on. Thanks."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1479930204, "post_id": 40772166, "comment_id": 68769674, "body": "You should be using the types that the Windows API has defined when passing or returning values like this.  This includes <code>LONG</code>, <code>BOOL</code>, <code>ULONG</code>, etc.  A <code>bool</code> is a C++ type that can only be used in C++ applications.  It can vary in size and implementation, which is why you should not use it for VBA purposes.  <a href=\"http://stackoverflow.com/questions/4897844/is-sizeofbool-defined\">For more reading...</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 3, "creation_date": 1479936484, "post_id": 40772166, "comment_id": 68772718, "body": "VB&#39;s <code>Boolean</code> is actually <code>VARIANT_BOOL</code> in C/C++. Also see <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20041222-00/?p=36923\" rel=\"nofollow noreferrer\">BOOL vs. VARIANT_BOOL vs. BOOLEAN vs. bool</a>"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1479939855, "post_id": 40772166, "comment_id": 68774098, "body": "@PaulMcKenzie: You should delete your comments. At least the first one is blatantly wrong, with the second one being misleading. The upvotes on your first comment may be misinterpreted as authoritative affirmation."}], "owner": {"reputation": 162, "user_id": 6841200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0ee3fbb31ed128f84ac6b61df829ca4?s=128&d=identicon&r=PG&f=1", "display_name": "kaineub", "link": "https://stackoverflow.com/users/6841200/kaineub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 457, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479933174, "creation_date": 1479927128, "last_edit_date": 1479933174, "question_id": 40772166, "link": "https://stackoverflow.com/questions/40772166/c-dll-bool-value-always-read-as-false-in-vba", "title": "C++ DLL bool value always read as False in VBA", "body": "<p>I have a DLL that I wrote using C++ that contains functions like this:</p>\n\n<pre><code>bool _stdcall vbaBoolTest(LPSAFEARRAY *values)\n</code></pre>\n\n<p>I have set up Visual Studio to let me debug the DLL using Excel. I declare the function in VBA like this:</p>\n\n<pre><code>Private Declare Function vbaBoolTest Lib \"myDLL.dll\" (ByRef values() As Double) As Boolean\n</code></pre>\n\n<p>and I noticed that the function would always evaluate to True on the VBA side of things. I can debug the macro that uses these functions and set break points in the C++ code as well. I have tried forcing the value to be false in C++ but the macro always reads the return value as False. I got around it by changing the return type to BOOL in C++ and returning either TRUE or FALSE.</p>\n\n<p>I wanted to know if this is the recommended way of doing things or if there is a better way.</p>\n"}, {"tags": ["excel", "range", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479925780, "post_id": 40771463, "comment_id": 68767488, "body": "not clear what you are trying to achieve ? can you simulate it manually in an Excel sheet and add it to your post ? it will help us help you"}, {"owner": {"reputation": 11, "user_id": 4085296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/623831931/picture?type=large", "display_name": "Gustavo Zambrano", "link": "https://stackoverflow.com/users/4085296/gustavo-zambrano"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479927720, "post_id": 40771463, "comment_id": 68768487, "body": "I just added an example of the data"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1479927936, "creation_date": 1479927936, "answer_id": 40772354, "question_id": 40771463, "link": "https://stackoverflow.com/questions/40771463/copy-filename-into-a-range-of-length-of-adjacent-column-as-filldown-macro/40772354#40772354", "title": "Copy filename into a range of length of adjacent column (as filldown) macro", "body": "<p>If I am correctly understanding what you are trying to do (i.e. copy <code>WBName</code> into every cell in column D, starting from the row after the last used cell in column D and finishing in the row of the last used cell in column E), then this should work:</p>\n\n<pre><code>Dim WB As Workbook\nDim lastRowD As Long\nDim lastRowE As Long\nDim WBname As String\n\nSet WB = Workbooks.Open(fileName:= _\n        \"C:\\Users\\gustavo\\Documents\\Minambiente\\TUA\\2015\\Consolidar_base\\CVC.xlsx\")\n\nWBname = Replace(WB.Name, \".xlsx\", \"\") \n\nWith ThisWorkbook.Sheets(1)\n    lastRowD = .Range(\"D\" &amp; .Rows.Count).End(xlUp).Row\n    lastRowE = .Range(\"E\" &amp; .Rows.Count).End(xlUp).Row\n    .Range(.Cells(lastRowD + 1, \"D\"), .Cells(lastRowE, \"D\")).Value = WBname\nEnd With\n</code></pre>\n\n<p>The line setting the values could alternatively be written as:</p>\n\n<pre><code>.Range(\"D\" &amp; (lastRowD + 1) &amp; \":D\" &amp; lastRowE).Value = WBname\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4085296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/623831931/picture?type=large", "display_name": "Gustavo Zambrano", "link": "https://stackoverflow.com/users/4085296/gustavo-zambrano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "accepted_answer_id": 40772354, "answer_count": 1, "score": 0, "last_activity_date": 1479927936, "creation_date": 1479924461, "last_edit_date": 1531164843, "question_id": 40771463, "link": "https://stackoverflow.com/questions/40771463/copy-filename-into-a-range-of-length-of-adjacent-column-as-filldown-macro", "title": "Copy filename into a range of length of adjacent column (as filldown) macro", "body": "<p>I want to assign a filename (say \"CVC\") from the first empty cell of column D to the row of that column that matches the last non-empty row of column E (similar to a filldown procedure). However, I'm having problems with the copy method in the last row of code. this is my try:</p>\n\n<pre><code>Dim WB As Workbook\nDim lastRow As Long\n\nSet WB = Workbooks.Open(fileName:= _\n        \"C:\\Users\\gustavo\\Documents\\Minambiente\\TUA\\2015\\Consolidar_base\\CVC.xlsx\")\n\nWBname = Replace(WB.Name, \".xlsx\", \"\") \n\nlastRow = ThisWorkbook.Sheets(1).Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n\nThisWorkbook.Sheets(1).Range(Cells(Rows.Count, 4).End(xlUp).Offset(1, 0), \"D\" &amp; lastRow).Value = WBname\n</code></pre>\n\n<p>Right now, my data looks as follows:</p>\n\n<pre><code>\"column D\" \u00a6 \"Column E\"\n  valueD   \u00a6   ValueE\n  valueD   \u00a6   ValueE\n           \u00a6   ValueE\n           \u00a6   ValueE\n           \u00a6   ValueE \n</code></pre>\n\n<p>After running the macro, the data would look as follows</p>\n\n<pre><code>\"column D\" \u00a6 \"Column E\"\n  valueD   \u00a6   ValueE\n  valueD   \u00a6   ValueE\n   CVC     \u00a6   ValueE\n   CVC     \u00a6   ValueE\n   CVC     \u00a6   ValueE --&gt; Note that what I am coping is the filename CVC \n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 13, "user_id": 7201428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca664baef5246968bfe47125cbce3529?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan M", "link": "https://stackoverflow.com/users/7201428/ryan-m"}, "edited": false, "score": 0, "creation_date": 1479923771, "post_id": 40771128, "comment_id": 68766355, "body": "Glad it help you! Have you tried replacing the first first loop with a sort of the data, and to replace the second loop with something like that <code>Range.resize(ubound(array),ubound(array,2)).value=Array</code> to post the entire array at once?"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 0, "last_activity_date": 1479923173, "creation_date": 1479923173, "answer_id": 40771128, "question_id": 40770907, "link": "https://stackoverflow.com/questions/40770907/check-to-see-if-a-value-is-present-then-copy-to-another-worksheet/40771128#40771128", "title": "Check to see if a value is present, then copy to another worksheet", "body": "<p>Taken from <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Range.Find Method (Excel)</a>:</p>\n\n<blockquote>\n  <p>When the search reaches the end of the specified search range, it\n  wraps around to the beginning of the range. To stop a search when this\n  wraparound occurs, save the address of the first found cell, and then\n  test each successive found-cell address against this saved address.</p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 7201428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca664baef5246968bfe47125cbce3529?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan M", "link": "https://stackoverflow.com/users/7201428/ryan-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 40771128, "answer_count": 1, "score": 1, "last_activity_date": 1479923173, "creation_date": 1479922458, "question_id": 40770907, "link": "https://stackoverflow.com/questions/40770907/check-to-see-if-a-value-is-present-then-copy-to-another-worksheet", "title": "Check to see if a value is present, then copy to another worksheet", "body": "<p>I'm trying to take a rough list of data, then copy it into a pre-formatted, organized form. To do this, I have the rough list set up so that each item on the list is numbered in order, no matter if there are spaces between items. The macro I am trying to make will take that rough list and copy it to the form without any spaces. Bear with me, I have been trying to teach myself Visual Basic, so the code I have may be... messy. Currently, the problem that I am having is that I get an overflow on i = i + 1.</p>\n\n<pre><code>Sub Print_Sheet_Populate()\n'\n' Print_Sheet_Populate Macro\n' Takes Items from Raw Data sheet and puts them in Print Sheet sheet.\n'\n\n'\nDim wsS1 As Worksheet\nDim wsS2 As Worksheet\nDim ending As Long\nDim copy() As Long\nDim i As Long\n\nSet wsS1 = Sheets(\"Raw Data\")\nSet wsS2 = Sheets(\"Print Sheet\")\n\nWith wsS1.Range(\"A:A\") 'To copy the item numbers in the rough data to an array\n    i = 1\n        Set c = .Find(i, LookIn:=xlValues)\n        If Not c Is Nothing Then\n            ReDim copy(i)\n            copy(i - 1) = c.Value\n            Do\n                i = i + 1\n                ending = i\n            Loop While Not c Is Nothing\n        End If\nEnd With\n\nWith wsS2.Range(\"A24:A324\") 'To paste the data from the array to the form\n    i = 1\n        If Not i = ending Then\n            Do\n                Worksheets(\"wsS2\").Range(\"A\" &amp; i).Value = copy(i - 1)\n                i = i + 1\n            Loop While Not c Is Nothing\n        End If\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1479922114, "post_id": 40770781, "comment_id": 68765361, "body": "Have you tried, .submit?"}, {"owner": {"reputation": 15, "user_id": 7145878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13609a660e33a5804487028504a0752a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Cooper", "link": "https://stackoverflow.com/users/7145878/chris-cooper"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479978163, "post_id": 40770781, "comment_id": 68786798, "body": "I have tried IEDoc.getElementsByTagName(&quot;form&quot;)(0).Submit however I knew this wouldnt work as the property doesent exist in the form. Is there another option I could try?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479979858, "post_id": 40770781, "comment_id": 68787840, "body": "Have you tried using the HTML and Internet libraries, the you can assign form(0) to a formobject, and truly look at the properties using locals/intellisense <a href=\"https://msdn.microsoft.com/en-us/library/ms970672.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms970672.aspx</a>"}, {"owner": {"reputation": 15, "user_id": 7145878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13609a660e33a5804487028504a0752a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Cooper", "link": "https://stackoverflow.com/users/7145878/chris-cooper"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479981214, "post_id": 40770781, "comment_id": 68788825, "body": "I selected both Internet Controls and HTML Object libraries references. <code>Dim My_Form As HTMLFormElement &#39;Variant &#39;IHTMLFormElement  &#39;rest of the code  MsgBox TypeName(IEDoc.getElementsByTagName(&quot;form&quot;)(0)) &#39; returns HTMLFormElement</code>  <code>My_Form = IEDoc.getElementsByTagName(&quot;form&quot;)(0) &#39; 1) if declaring My_Form as a IHTMLFormElement I get &quot;Type Mismatch&quot; on that line 2) if declaring My_Form as a HTMLFormElement I get a &quot;Run-time error &#39;91&#39; : Object variable or With blick variable not set&quot; 3)  if declaring My_Form as a Variant , this line works but of course My_Form.Click doesn&#39;t do anything</code>"}, {"owner": {"reputation": 15, "user_id": 7145878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13609a660e33a5804487028504a0752a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Cooper", "link": "https://stackoverflow.com/users/7145878/chris-cooper"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479981367, "post_id": 40770781, "comment_id": 68788958, "body": "<code>My_Form.Click  IEDoc.getElementsByName(&quot;knopf&quot;)(0).Click &#39; nothing happens when clicking on a random element of the form</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479981414, "post_id": 40770781, "comment_id": 68788979, "body": "Can you post the URL?"}, {"owner": {"reputation": 15, "user_id": 7145878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13609a660e33a5804487028504a0752a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Cooper", "link": "https://stackoverflow.com/users/7145878/chris-cooper"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479983255, "post_id": 40770781, "comment_id": 68790361, "body": "It&#39;s an intranet URL so it won t work for you, but  I edit my post and will put a bigger picture of the HTML code"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7145878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13609a660e33a5804487028504a0752a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Cooper", "link": "https://stackoverflow.com/users/7145878/chris-cooper"}, "edited": false, "score": 0, "creation_date": 1479983645, "post_id": 40783229, "comment_id": 68790661, "body": "Nathan you legend, it worked perfectly. Declaring the form this way enabled the Intellisense from VBA and activated the &quot;submit&quot; property ! Thanks so much"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 15, "user_id": 7145878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13609a660e33a5804487028504a0752a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Cooper", "link": "https://stackoverflow.com/users/7145878/chris-cooper"}, "edited": false, "score": 0, "creation_date": 1479983940, "post_id": 40783229, "comment_id": 68790898, "body": "No worries, I know that chaining together is allowed and easy enough to do, but readability and intellisense with some of them, it helps to break it up.  You can spend hours debugging otherwise. :)"}, {"owner": {"reputation": 15, "user_id": 7145878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13609a660e33a5804487028504a0752a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Cooper", "link": "https://stackoverflow.com/users/7145878/chris-cooper"}, "edited": false, "score": 0, "creation_date": 1479984378, "post_id": 40783229, "comment_id": 68791207, "body": "Thanks man, I would up-vote your answer but unfortunately I dont have enough reputation yet haha"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1479981671, "creation_date": 1479981671, "answer_id": 40783229, "question_id": 40770781, "link": "https://stackoverflow.com/questions/40770781/how-to-click-on-that-form/40783229#40783229", "title": "How to click on that form?", "body": "<p>This is how I'd go about it, using SO as the URL</p>\n\n<pre><code>Sub x()\n\nDim ie As SHDocVw.InternetExplorer\nDim f As MSHTML.HTMLFormElement\n\nSet ie = New SHDocVw.InternetExplorer\nie.Visible = True\nie.navigate \"http://stackoverflow.com/questions/tagged/vba\"\n\nDo While ie.readyState &lt;&gt; READYSTATE_COMPLETE Or ie.Busy\n    DoEvents\nLoop\n\nSet f = ie.document.getElementsByTagName(\"form\")(0)\nf.elements(0).value=\"SQL\"\nf.submit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7145878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13609a660e33a5804487028504a0752a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Cooper", "link": "https://stackoverflow.com/users/7145878/chris-cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 40783229, "answer_count": 1, "score": 0, "last_activity_date": 1479983429, "creation_date": 1479921986, "last_edit_date": 1495542841, "question_id": 40770781, "link": "https://stackoverflow.com/questions/40770781/how-to-click-on-that-form", "title": "How to click on that form?", "body": "<p>I am not familiar with html and I am trying to submit a form from VBA.\nI managed to select it, but then is there a special command to send it ?</p>\n\n<p><img src=\"https://i.stack.imgur.com/btrY0.png\" alt=\"This is what the form looks like.\">.</p>\n\n<p>I tried to click on it to submit it, but this doesn't work.</p>\n\n<pre><code>IEDoc.getElementsByTagName(\"form\")(0).Click\n</code></pre>\n\n<p>I know my attempts sound poor, but I was at first trying to click on element which had a onclick property which returns false and I didn't manage to get this to work.\nI found an other solution which worked but made the whole code crash at some point, this solution was to use the SendKeys method. You can see the article </p>\n\n<p><a href=\"https://stackoverflow.com/questions/40492161/running-click-event-with-no-result\">Running Click event with no result</a> </p>\n\n<p>my colleague posted about it</p>\n\n<p>Any tips are welcome.</p>\n\n<p>EDIT : <a href=\"https://i.stack.imgur.com/rJqAw.png\" rel=\"nofollow noreferrer\">Bigger picture of the HTML code with full form</a></p>\n"}, {"tags": ["excel", "events", "timing", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479921997, "post_id": 40770496, "comment_id": 68765300, "body": "Are you handling <code>Application.Workbook_Open</code> events in the helper add-in, or just the <code>ThisWorkbook.Workbook_Open</code> event of the add-in?"}, {"owner": {"reputation": 300, "user_id": 2764387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aedffb31a6854e01fbddfb891d2439f8?s=128&d=identicon&r=PG&f=1", "display_name": "Zenigata", "link": "https://stackoverflow.com/users/2764387/zenigata"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479922124, "post_id": 40770496, "comment_id": 68765369, "body": "Just <code>ThisWorkbook.Workbook_Open</code>, do you think I&#39;ve a chance with <code>Application.Workbook_Open</code>? I&#39;m not able to think it out."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479925091, "post_id": 40770496, "comment_id": 68767108, "body": "I was thinking that you might be able to test if <code>Wb.Path &lt;&gt; vbNullString</code> in <code>Application.Workbook_Open</code>.  Haven&#39;t tested anything though."}, {"owner": {"reputation": 300, "user_id": 2764387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aedffb31a6854e01fbddfb891d2439f8?s=128&d=identicon&r=PG&f=1", "display_name": "Zenigata", "link": "https://stackoverflow.com/users/2764387/zenigata"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479930558, "post_id": 40770496, "comment_id": 68769877, "body": "That could be something, I&#39;ll test it (I think it will return the path for the temp xlsx, but I&#39;ll test and see)"}], "owner": {"reputation": 300, "user_id": 2764387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aedffb31a6854e01fbddfb891d2439f8?s=128&d=identicon&r=PG&f=1", "display_name": "Zenigata", "link": "https://stackoverflow.com/users/2764387/zenigata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480069514, "creation_date": 1479921111, "last_edit_date": 1531164843, "question_id": 40770496, "link": "https://stackoverflow.com/questions/40770496/timing-problerm-on-workbook-open", "title": "Timing problerm on Workbook_Open()", "body": "<p>I think I'm running on a timing problem here.  </p>\n\n<p><strong>Scenario:</strong><br>\nhave an helper add-in checking for updates upon Excel starts and update another add-in.  </p>\n\n<p>The tricky part is \"upon Excel starts\". I'm able to check for updates upon opening Excel through the Workbook_Open() event of the helper add-in.<br>\nIn fact it does work and the other plugin gets updated.  </p>\n\n<p>The problem is when the user open Excel clicking on an .xlsx/.xls/.csv/etc file.  </p>\n\n<p>I want to detect this and in the case Excel is opened through the Excel icon run the updates check otherwise it has to do nothing.  </p>\n\n<p>How can I determine in which way Excel was opened?  </p>\n\n<p><strong>What I tried so far:</strong>  </p>\n\n<ul>\n<li>verifying if there are non-addin Workbooks opened (not working)</li>\n<li>verifying Application.Ready (not working)</li>\n</ul>\n\n<p>both tests are not working because, I think, the helper add-in Workbook_Open event is fired before the empty Workbook is created (in case Excel was launched through its icon) or loaded (in case Excel was launched through the click of an .xls file).  </p>\n\n<p>Thank you in advance :)</p>\n\n<hr>\n\n<p><strong>Possible solution implemented, checking command line parameters:</strong>\n<a href=\"https://www.dmcinfo.com/latest-thinking/blog/id/247/read-command-line-parameters-from-vba\" rel=\"nofollow noreferrer\">https://www.dmcinfo.com/latest-thinking/blog/id/247/read-command-line-parameters-from-vba</a></p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function GetCommandLineA Lib \"kernel32\" () As Long\nPrivate Declare Function lstrcpynA Lib \"kernel32\" ( _\n   ByVal pDestination As String, ByVal pSource As Long, _\n   ByVal iMaxLength As Integer) As Long\n\nPrivate Sub Workbook_Open()\n    Dim pCmdLine As Long     ' Pointer to the string\n    Dim strCmdLine As String ' Command line string\n\n    ' Get the pointer to the command line string\n    pCmdLine = GetCommandLineA\n\n    ' Fill the string with zeros\n    ' 300 characters for command line seems to be enough\n    strCmdLine = String(300, vbNullChar)\n\n    ' Copy from the pointer to VBA-style string\n    lstrcpynA strCmdLine, pCmdLine, Len(strCmdLine)\n\n    ' At this point we got the string\n    ' But rest of it filled with 0 characters.\n    strCmdLine = Left(strCmdLine, InStr(1, strCmdLine, vbNullChar) - 1)\nEnd Sub\n</code></pre>\n\n<p>If Excel is launched alone the result is:</p>\n\n<p><code>\"C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.EXE\"</code></p>\n\n<p>otherwise:</p>\n\n<p><code>\"C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.EXE\" /dde</code></p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 3, "last_activity_date": 1479921313, "creation_date": 1479921313, "answer_id": 40770554, "question_id": 40770315, "link": "https://stackoverflow.com/questions/40770315/delete-every-row-with-a-particular-string-in-it/40770554#40770554", "title": "Delete every row with a particular string in it", "body": "<pre><code>Dim d As Document\nDim p As Paragraph\n\nSet d = ActiveDocument\n\nFor Each p In d.Paragraphs\n    If Left(p.Range, Len(\"Asdfsadfsdsd\")) = \"Asdfsadfsdsd\" Then\n        p.Range.Delete\n    End If\nNext p\n</code></pre>\n"}], "owner": {"reputation": 1364, "user_id": 1324967, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/96e360b53f3344ad5049cb2e6c54b96a?s=128&d=identicon&r=PG", "display_name": "Paul Terwilliger", "link": "https://stackoverflow.com/users/1324967/paul-terwilliger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 40770554, "answer_count": 1, "score": 1, "last_activity_date": 1479921313, "creation_date": 1479920568, "question_id": 40770315, "link": "https://stackoverflow.com/questions/40770315/delete-every-row-with-a-particular-string-in-it", "title": "Delete every row with a particular string in it", "body": "<p>I am using Microsoft Word 2010.</p>\n\n<p>I have a document spanning thousands of pages.  I need to write a macro that deletes every paragraph that begins with the string <code>mystring</code>.  How would I write this?</p>\n\n<p>EDIT: I have figured out how to write a macro and how to delete a paragraph once my cursor is at the beginning of the paragraph.  I need to find a way to do a \"find\" search</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479919278, "post_id": 40769802, "comment_id": 68763668, "body": "The <code>Offset</code> calls and worksheet accesses are probably what&#39;s killing you in performance - pull all the values you need into an array and work with that."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479919387, "post_id": 40769802, "comment_id": 68763738, "body": "Also, you can just set the values at the end <code>rngCell.value=Me.Range(Target.Offset(u, 0), Target.Offset(d, 0)).value</code>, making rngCell the same depth etc as d-u"}], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1479936008, "post_id": 40773136, "comment_id": 68772514, "body": "Suggest to replace <code>Target.Value</code> with <code>Target.Cells(1).Value</code> to replicate what original OP&#39;s code is doing. If the Target range has more than one cells and the range of ID&#39;s has a higher number of cells than the Target range, then some cells in [COLUMN] will be filled with <code>#N&#47;A</code>"}, {"owner": {"reputation": 69, "user_id": 7128363, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eCJyI.jpg?s=128&g=1", "display_name": "Senzar", "link": "https://stackoverflow.com/users/7128363/senzar"}, "edited": false, "score": 0, "creation_date": 1479977147, "post_id": 40773136, "comment_id": 68786196, "body": "Thanks both for the initial advice and the consequent correction!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1479977290, "last_edit_date": 1479977290, "creation_date": 1479931036, "answer_id": 40773136, "question_id": 40769802, "link": "https://stackoverflow.com/questions/40769802/vba-loops-and-offsets-in-worksheet-change/40773136#40773136", "title": "VBA: Loops and Offsets in Worksheet_Change", "body": "<p>There is no reason for this loop</p>\n\n<pre><code>For Each rngCell In Me.Range(Target.Offset(u, 0), Target.Offset(d, 0))\n    Application.EnableEvents = False\n    rngCell.Value = Target.Value\n    Application.EnableEvents = True\nNext\n</code></pre>\n\n<p>You can assign the <code>Target.Value</code> to all the cells at once.</p>\n\n<pre><code>Application.EnableEvents = False\nMe.Range(Target.Offset(u, 0), Target.Offset(d, 0)).Value = Target.Cells(1).Value\nApplication.EnableEvents = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 7128363, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eCJyI.jpg?s=128&g=1", "display_name": "Senzar", "link": "https://stackoverflow.com/users/7128363/senzar"}, "edited": false, "score": 0, "creation_date": 1479977985, "post_id": 40774444, "comment_id": 68786690, "body": "I had bad experiences with ListObjects when running codes in Mac OS. Also, it means a completely new logic for me but I strongly appreciate your help and effort, thanks so much @EMM"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1479936529, "creation_date": 1479936529, "answer_id": 40774444, "question_id": 40769802, "link": "https://stackoverflow.com/questions/40769802/vba-loops-and-offsets-in-worksheet-change/40774444#40774444", "title": "VBA: Loops and Offsets in Worksheet_Change", "body": "<p>This solution avoids the loops and uses the advantages of the Excel Table (ListObject excel object)</p>\n\n<p>Try this code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim lobTrg As ListObject\nDim aIDs As Variant\nDim bPos As Byte\n\n    If Target.Columns.CountLarge &gt; 1 Then Exit Sub\n\n    Rem Application Setting - OFF\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Rem Set List Object\n    Set lobTrg = Me.ListObjects(\"TABLE\")\n\n    Rem Work with the ListObject Methods &amp; Properties\n    With lobTrg\n\n        Rem Validate Target Range vs ListObject Field [COLUMN]\n        If Not (Intersect(Target, .ListColumns(\"COLUMN\").DataBodyRange) Is Nothing) Then\n\n            Rem Remove Active Filters from the ListObject\n            If Not (.AutoFilter Is Nothing) Then .Range.AutoFilter\n\n            Rem Set Array with ID's Affected by the Changes in Field [COLUMN]\n            aIDs = Target.Offset(, -13).Value2\n            aIDs = WorksheetFunction.Transpose(aIDs)\n\n            Rem Filter ListObject using the ID's Array\n            bPos = .ListColumns(\"COLUMN\").Index - 13\n            .Range.AutoFilter Field:=bPos, Criteria1:=aIDs, Operator:=xlFilterValues\n\n            Rem Update Field [COLUMN] value for all the ID's\n            .ListColumns(\"COLUMN\").DataBodyRange _\n                .SpecialCells(xlCellTypeVisible).Value = Target.Cells(1).Value2\n\n            Rem Removes Filters from List Object\n            .Range.AutoFilter\n\n    End If: End With\n\n    Rem Application Setting - ON\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Suggest to read the following pages to gain a deeper understanding of the resources used:</p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/ff839458.aspx\" rel=\"nofollow noreferrer\">ListObject Members (Excel)</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx\" rel=\"nofollow noreferrer\">With Statement</a>, </p>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 7128363, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eCJyI.jpg?s=128&g=1", "display_name": "Senzar", "link": "https://stackoverflow.com/users/7128363/senzar"}, "is_accepted": false, "score": 0, "last_activity_date": 1480075133, "last_edit_date": 1480075133, "creation_date": 1480005193, "answer_id": 40791204, "question_id": 40769802, "link": "https://stackoverflow.com/questions/40769802/vba-loops-and-offsets-in-worksheet-change/40791204#40791204", "title": "VBA: Loops and Offsets in Worksheet_Change", "body": "<p><strong>(1st update)</strong></p>\n\n<p>I rebuilded the code with your suggestions.</p>\n\n<p>This is the result:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim u As Long, d As Long\nDim id As Variant\nIf Target.Columns.CountLarge &gt; 1 Then Exit Sub\nIf Not Intersect(Target, Me.Range(\"TABLE[COLUMN]\")) Is Nothing Then\n    Application.ScreenUpdating = False\n    id = Me.Range(\"TABLE[ID]\").Value\n    u = Target.Row - 1\n    d = Target.Row + Target.Count - 2\n    Do While id(u, 1) = id(u - 1, 1)\n        u = u - 1\n    Loop\n    Do While id(d, 1) = id(d + 1, 1)\n        d = d + 1\n    Loop\n    Application.EnableEvents = False\n    Me.Range(Target.Cells(1).Offset(u - Target.Row + 1, 0), Target.Cells(1).Offset(d - Target.Row + 1, 0)).Value = Target.Cells(1).Value\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I applied the changes by blocks. First, I removed the loop For-Next which was unnecessary and slightly improved the performance. Secondly, I replaced the <code>Offset</code> which was looking for the ID with an array but it did not really make any difference.</p>\n\n<p>Let's go for a second round, any other idea?</p>\n\n<p>Thanks!</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": -1, "last_activity_date": 1480025565, "creation_date": 1480025565, "answer_id": 40795147, "question_id": 40769802, "link": "https://stackoverflow.com/questions/40769802/vba-loops-and-offsets-in-worksheet-change/40795147#40795147", "title": "VBA: Loops and Offsets in Worksheet_Change", "body": "<p>With those do while loops, you can possibly use the find function.</p>\n\n<p>Here is a rough idea of what I mean.</p>\n\n<p>In a sheet in column A put the following in row 1 down to 9</p>\n\n<pre><code>0\n0\n0\n1\n1\n1\n2\n2\n2\n</code></pre>\n\n<p>Go into the VBE and bring up the debug window using CTRL-G and enter the following:</p>\n\n<pre><code>?range(\"A1:A9\").Find(1).address\n</code></pre>\n\n<p>It will return $A$4 as the first instance of \"1\"</p>\n\n<p>Now this itself is no good to you because you want to detect when it NO LONGER equals something.</p>\n\n<p>No problem (Assuming your data is grouped).</p>\n\n<p>Now put this into the VBE:</p>\n\n<pre><code>?range(\"A1:A9\").Findprevious.Address\n</code></pre>\n\n<p>When you press enter you will get $A$6 which is the address of the last occurrence, we can simply offset this like this:</p>\n\n<pre><code>?range(\"A1:A9\").Findprevious.offset(1,0).Address\n</code></pre>\n\n<p>and you will get the next cell's address of $A$7 ie when it no longer equals what you feed in.</p>\n\n<p>Hopefully there is something in this that you can apply to remove those other loops.</p>\n\n<p>You do need both of these together though as the first line sets up the search:</p>\n\n<pre><code>?range(\"A1:A9\").Find(1).address\n?range(\"A1:A9\").Findprevious.offset(1,0).Address\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1484517857, "post_id": 40804527, "comment_id": 70531794, "body": "Nice application of the theory, neat and concise :). Glad it worked out for you."}], "tags": [], "owner": {"reputation": 69, "user_id": 7128363, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eCJyI.jpg?s=128&g=1", "display_name": "Senzar", "link": "https://stackoverflow.com/users/7128363/senzar"}, "is_accepted": true, "score": 0, "last_activity_date": 1480201737, "last_edit_date": 1480201737, "creation_date": 1480075013, "answer_id": 40804527, "question_id": 40769802, "link": "https://stackoverflow.com/questions/40769802/vba-loops-and-offsets-in-worksheet-change/40804527#40804527", "title": "VBA: Loops and Offsets in Worksheet_Change", "body": "<p><strong>(2nd and last update)</strong></p>\n\n<p>I updated the code with @Dan Donoghue's idea (thanks!).</p>\n\n<p>And this is the result:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Columns.CountLarge &gt; 1 Then Exit Sub\nIf Not Intersect(Target, Me.Range(\"TABLE[COLUMN]\")) Is Nothing Then\n    Dim u As Long, d As Long\n    u = Range(\"TABLE[ID]\").Find(Range(\"TABLE[ID]\").Cells(Target.Row - 1, 1)).Row\n    d = Range(\"TABLE[ID]\").Find(Range(\"TABLE[ID]\").Cells(Target.Row + Target.Count - 2, 1), searchdirection:=xlPrevious).Row\n    Application.EnableEvents = False\n    Me.Range(Target.Cells(1).Offset(u - Target.Row, 0), Target.Cells(1).Offset(d - Target.Row, 0)).Value = Target.Cells(1).Value\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>What I appreciate from this last update is that it made the code look lighter. However, it is working slightly slower compared to the previous update.</p>\n\n<p>I set a timer in all the versions that I posted so far and I ran the code for 3 rows in column 13 which belong to identical ID to test how fast the code performs in the same conditions.</p>\n\n<p>My initial code: 0.55 seconds.</p>\n\n<p>1st update (<code>For-Next</code> out, <code>Offset</code> out &amp; <code>Array</code> in): 0.19 seconds.</p>\n\n<p>2nd update (<code>Do While</code> out &amp; <code>Find</code> in): 0.20 seconds.</p>\n\n<p>Since I cannot beat the 20 seconds time, I think I will use this version as the code is more clean.</p>\n\n<p>Thanks a lot once again.</p>\n"}], "owner": {"reputation": 69, "user_id": 7128363, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eCJyI.jpg?s=128&g=1", "display_name": "Senzar", "link": "https://stackoverflow.com/users/7128363/senzar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 40804527, "answer_count": 5, "score": -1, "last_activity_date": 1480201737, "creation_date": 1479919020, "last_edit_date": 1480075097, "question_id": 40769802, "link": "https://stackoverflow.com/questions/40769802/vba-loops-and-offsets-in-worksheet-change", "title": "VBA: Loops and Offsets in Worksheet_Change", "body": "<p><strong>(Find the updated version in the answers)</strong></p>\n\n<p>I have a code which is working well but a little bit slow and I would like to know how to make it more efficient. The fact that the code includes two loops could be one of the possible reasons.</p>\n\n<p>Below you can find the whole code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Columns.CountLarge &gt; 1 Then Exit Sub\nIf Not Intersect(Target, Me.Range(\"TABLE[COLUMN]\")) Is Nothing Then\n    Application.ScreenUpdating = False\n    Dim rngCell As Range, urg As Range, drg As Range, u As Integer, d As Integer\n    d = 0\n    u = 0\n    Set urg = Target.Cells(1, 1)\n    Set drg = Target.Cells(Target.Count, 1)\n    Do While drg.Offset(d, -13) = drg.Offset(d + 1, -13)\n        d = d + 1\n    Loop\n    Do While urg.Offset(u, -13) = urg.Offset(u - 1, -13)\n        u = u - 1\n    Loop\n    For Each rngCell In Me.Range(Target.Offset(u, 0), Target.Offset(d, 0))\n        Application.EnableEvents = False\n        rngCell.Value = Target.Value\n        Application.EnableEvents = True\n    Next\n    Application.ScreenUpdating = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The code is inserting the same input value (column 13) for all the adjacent cells with the same ID (column 1). For example, if I would input a 3 for Column13 in either ID002 or ID003:</p>\n\n<pre><code>Column1 Column2 Column3... Column13       Column13\nID001   1       1          1          &gt;   1\nID002   2       2          2          &gt;   3\nID002   3       3          2          &gt;   3\nID003   4       4          4          &gt;   4\n</code></pre>\n\n<p>Once I unput the value, it takes a few seconds to recalculate the adjacent cells so I would appreciate whatever advice that will make this code work faster.</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1479919073, "post_id": 40769662, "comment_id": 68763546, "body": "try: <code>Range_Grid(1).Copy ActiveSheet.Cells(4, 1)</code>"}, {"owner": {"reputation": 271, "user_id": 5295839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LLvSS.gif?s=128&g=1", "display_name": "BenDev", "link": "https://stackoverflow.com/users/5295839/bendev"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1479920337, "post_id": 40769662, "comment_id": 68764363, "body": "Thanks it works in a way. But I&#39;ve just realized that the range saved in the array is not really saved as independant entity, I mean that it seems to be a pointer to the cell on the sheet. So if after the line Set Range_Grid(1) = ActiveSheet.Cells(2, 3), I go manually change the value and property of this cell on the sheet to get an empty cell, then the Range_Grid(1).Copy ActiveSheet.Cells(4, 1) leaves the cell(4,1) empty too..."}], "answers": [{"comments": [{"owner": {"reputation": 271, "user_id": 5295839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LLvSS.gif?s=128&g=1", "display_name": "BenDev", "link": "https://stackoverflow.com/users/5295839/bendev"}, "edited": false, "score": 0, "creation_date": 1479920693, "post_id": 40770109, "comment_id": 68764579, "body": "Thanks. I&#39;ve already written a whole function based on saving separated parts of the properties to retrieve them when I need to. So I was searching for a full property solution. I guess there is not really solutions as I&#39;ve red a lot of forum on this subject and people always says they thought there wasn&#39;t really a solution."}], "tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": false, "score": 0, "last_activity_date": 1479919919, "creation_date": 1479919919, "answer_id": 40770109, "question_id": 40769662, "link": "https://stackoverflow.com/questions/40769662/excel-vba-assign-all-properties-to-a-cell-from-an-array-of-range/40770109#40770109", "title": "Excel vba : assign all properties to a cell from an array of range", "body": "<p>There is no way of moving all of the formatting from a range in an array back into excel at once. This leaves you with two options: either you copy within excel as Scott Craner suggested, or you copy each type of formatting individually. For example, if you wanted to copy the value (which is the default and hence is what is copied in your original code) and the cell background colour, then you could use the following code:</p>\n\n<pre><code>Sub Test()\n    Dim Range_Grid(1) As Range\n\n    Set Range_Grid(1) = ActiveSheet.Cells(2, 3)\n    ActiveSheet.Cells(4, 1) = Range_Grid(1)\n    ActiveSheet.Cells(4, 1).Interior.ColorIndex = Range_Grid(1).Interior.ColorIndex\nEnd Sub\n</code></pre>\n\n<p>Unfortunately there are probably over a dozen types of formatting that you may want to deal with at any given time...</p>\n"}, {"comments": [{"owner": {"reputation": 271, "user_id": 5295839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LLvSS.gif?s=128&g=1", "display_name": "BenDev", "link": "https://stackoverflow.com/users/5295839/bendev"}, "edited": false, "score": 0, "creation_date": 1479975901, "post_id": 40770379, "comment_id": 68785516, "body": "Thanks for the alternative. But in fact here you just copy/paste from the sheet to the sheet. My goal was to saved a grid from a sheet into an array, and later, whatever has been done one the original sheet, &quot;paste back&quot; from the array to the sheet. It&#39;s about dealing to manage an engine for undo-redo function, because the undo stack is automatically erased by Excel when something is written on the sheet by the code... So I&#39;ve already created an engine that works fine just for a few properties like value, text, color...but it works by saving properties individually."}], "tags": [], "owner": {"reputation": 305, "user_id": 6317652, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036004296437081/picture?type=large", "display_name": "PedroMVM", "link": "https://stackoverflow.com/users/6317652/pedromvm"}, "is_accepted": false, "score": 0, "last_activity_date": 1479920748, "creation_date": 1479920748, "answer_id": 40770379, "question_id": 40769662, "link": "https://stackoverflow.com/questions/40769662/excel-vba-assign-all-properties-to-a-cell-from-an-array-of-range/40770379#40770379", "title": "Excel vba : assign all properties to a cell from an array of range", "body": "<p>There's an alternative: use Copy and PasteSpecial functions.</p>\n\n<pre><code>Sub Test()\n\n    ActiveSheet.Cells(2, 3).Copy\n    ActiveSheet.Cells(4, 1).PasteSpecial(xlPasteAll)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 271, "user_id": 5295839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LLvSS.gif?s=128&g=1", "display_name": "BenDev", "link": "https://stackoverflow.com/users/5295839/bendev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1039, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1479920748, "creation_date": 1479918686, "last_edit_date": 1531164843, "question_id": 40769662, "link": "https://stackoverflow.com/questions/40769662/excel-vba-assign-all-properties-to-a-cell-from-an-array-of-range", "title": "Excel vba : assign all properties to a cell from an array of range", "body": "<p>My goal is to save a Cell and all its properties and value in an array of range, and then write back all properties and values of this cell to another cell from the array (like a copy paste function but pasting from the array).</p>\n\n<p>Here is a simple test procedure :</p>\n\n<pre><code>Sub Test()\n    Dim Range_Grid(1) As Range\n    Dim CellAdress As String\n    Dim i As Long\n\n    Set Range_Grid(1) = ActiveSheet.Cells(2, 3)\n    ActiveSheet.Cells(4, 1) = Range_Grid(1)\nEnd Sub\n</code></pre>\n\n<p>So here in the first element of the array Range_Grid(1), I really get the full range saved and I can access every property the original range ActiveSheet.Cells(2, 3) had, like font style, format, color, comment, etc..</p>\n\n<p>But when I try to write this range from array to another empty cell, it only write the value...</p>\n\n<p>Any idea how to write all the properties from the array like if it was a copy/paste from sheet to sheet?</p>\n"}, {"tags": ["c#", "vba", "excel", "visual-studio-setup-proje"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1481408210, "post_id": 40769455, "comment_id": 69367881, "body": "<a href=\"https://support.microsoft.com/en-us/kb/202261\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/202261</a>"}], "owner": {"reputation": 80, "user_id": 4246127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47e4a3272a5601fe67cd1853a0578a55?s=128&d=identicon&r=PG&f=1", "display_name": "Jmnstr", "link": "https://stackoverflow.com/users/4246127/jmnstr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479918104, "creation_date": 1479918104, "question_id": 40769455, "link": "https://stackoverflow.com/questions/40769455/missing-references-in-excel-vba-workbook", "title": "Missing References in Excel-VBA workbook", "body": "<p>I've got an Excel-VBA spreadsheet that is installed with a Visual Studios Setup Project...</p>\n\n<p>I made a changes to the VBA code, tested the change, plugged the new spreadsheet into the setup project, built the setup project and sent it to Q/A.</p>\n\n<p>I got a response back saying that she couldn't even get the thing installed... One of the projects (Called BMath) is missing a reference in the VBA spreadsheet... </p>\n\n<p>It appears to me that the path is being split after the '#':</p>\n\n<p><strong>Missing BMath Path:</strong></p>\n\n<blockquote>\n  <p>C:\\_Data\\B\\1.0\\20161007_1024\\C</p>\n</blockquote>\n\n<p><strong>Working BPattern Path:</strong></p>\n\n<blockquote>\n  <p>C:\\_Data\\B\\1.0\\20161007_1024\\C#\\B\\Deployment\\BPattern.tlb</p>\n</blockquote>\n\n<p>Why would this ONLY be happening to BMath, and not the other (7) references in that exact same folder? (C:\\_Data\\B\\1.0\\20161007_1024\\C#\\B\\Deployment\\)</p>\n\n<p>Thanks for the input.</p>\n"}, {"tags": ["vba", "excel", "replace"], "comments": [{"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 0, "creation_date": 1479919082, "post_id": 40769372, "comment_id": 68763552, "body": "Does the value you search occurs in other cell than D5, for example D20?"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 0, "creation_date": 1479919178, "post_id": 40769372, "comment_id": 68763612, "body": "@Limak They can, but the problem is that sometimes they do not. The value can occur once in the data range or it can occur a few thousand times."}, {"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 0, "creation_date": 1479919412, "post_id": 40769372, "comment_id": 68763755, "body": "But in this specific example? I&#39;m asking if the problem is, that when the <code>findString</code> occurs in data i.e. in cells D10, D23 and D34, this <code>Do Until</code> loop goes infinitely through this 3 cells, over and over. Or, if it only will go through the first one (D10 in this example)."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 0, "creation_date": 1479919697, "post_id": 40769372, "comment_id": 68763953, "body": "@Limak It will only go through the first one over and over again (D10 in this example)"}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 6317652, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036004296437081/picture?type=large", "display_name": "PedroMVM", "link": "https://stackoverflow.com/users/6317652/pedromvm"}, "is_accepted": false, "score": 0, "last_activity_date": 1479918679, "creation_date": 1479918679, "answer_id": 40769659, "question_id": 40769372, "link": "https://stackoverflow.com/questions/40769372/iterate-over-all-cells-that-are-found-in-do-until-loop/40769659#40769659", "title": "Iterate Over All Cells That Are Found in Do Until Loop", "body": "<p>I wrote an article recently about Find, but it's in Portuguese, I think it won't help you.</p>\n\n<p>In that article I've put an example code, which you can study and understand how it does work:</p>\n\n<pre><code>Sub FindTest()\n\nDim Interval As Range\nDim Value As String\nDim Result As Range\nDim PreviousResult As Range\n\nSet Interval = Range(\"A1:A1000\")\nValue = \"Pedro*\"\nSet Result = Intervalo.Find(Value, LookIn:=xlFormulas, LookAt:=xlWhole, _\n    SearchOrder:=xlByColumns)\n\nIf Result Is Nothing Then\n    Debug.Print \"Value not found\"\n    Exit Sub\nEnd If\n\nDo\n    Debug.Print Result.Value\n    Set PreviousResult = Result\n    Set Result = Interval.Find(Value, After:=PreviousResult, _\n        LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByColumns)\nLoop Until Result.Row &lt; PreviousResult.Row\n\nEnd Sub\n</code></pre>\n\n<p>It is a good idea to read <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Find documentation</a> to understand each parameter. I hope that it helps you.</p>\n"}, {"comments": [{"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1479919398, "post_id": 40769786, "comment_id": 68763747, "body": "Adam I have that already, but I would rather only have to search the definitions sheet once to satisfy all incidences of that string in the main sheet. Rather than possibly searching for the same string many times in both sheets."}, {"owner": {"reputation": 55, "user_id": 6726572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6b7692f19625dcb229a50c7e6b72c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Turner", "link": "https://stackoverflow.com/users/6726572/adam-turner"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 1, "creation_date": 1479920326, "post_id": 40769786, "comment_id": 68764358, "body": "If that is the case, then you need to add an argument to .findnext.  It has an optional argument of a starting cell.  So in your code, you will need to set a variable to the exact cell you find each instance of the findstring, then use that variable as the argument for findnext.  Example"}, {"owner": {"reputation": 55, "user_id": 6726572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6b7692f19625dcb229a50c7e6b72c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Turner", "link": "https://stackoverflow.com/users/6726572/adam-turner"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 1, "creation_date": 1479920576, "post_id": 40769786, "comment_id": 68764513, "body": "Set replaceValuesRange = MainInputSheet.Range(MainInputSheet.Cells(2, 4), MainInputSheet.Cells(lastRow, 4)).FindNext(replaceValuesRange)"}, {"owner": {"reputation": 55, "user_id": 6726572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6b7692f19625dcb229a50c7e6b72c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Turner", "link": "https://stackoverflow.com/users/6726572/adam-turner"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1479920681, "post_id": 40769786, "comment_id": 68764575, "body": "A perfect example of what I am suggesting can be found at <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196143.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff196143.aspx</a>"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1479921569, "post_id": 40769786, "comment_id": 68765075, "body": "I tried the solution you listed and i&#39;m still getting stuck in the same cell over and over again.  Unsure why the range is being listed as a single range."}], "tags": [], "owner": {"reputation": 55, "user_id": 6726572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6b7692f19625dcb229a50c7e6b72c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Turner", "link": "https://stackoverflow.com/users/6726572/adam-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1479918967, "creation_date": 1479918967, "answer_id": 40769786, "question_id": 40769372, "link": "https://stackoverflow.com/questions/40769372/iterate-over-all-cells-that-are-found-in-do-until-loop/40769786#40769786", "title": "Iterate Over All Cells That Are Found in Do Until Loop", "body": "<p>It looks to me like your problem is that you have set replaceValuesRange as a range object.  You then use the do loop to run until that range is nothing.  The problem is that the range is still an object and will stay an object until you do something else to that variable.  I would change this to another for loop and iterate through the range.</p>\n\n<p>Maybe something like</p>\n\n<p>for i = 2 to lastrow 'your variable range starts at row 2 and goes until the last row.<br>\n   code here<br>\nnext i</p>\n"}, {"tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": true, "score": 1, "last_activity_date": 1479921382, "creation_date": 1479921382, "answer_id": 40770578, "question_id": 40769372, "link": "https://stackoverflow.com/questions/40769372/iterate-over-all-cells-that-are-found-in-do-until-loop/40770578#40770578", "title": "Iterate Over All Cells That Are Found in Do Until Loop", "body": "<p>Your problem is, that </p>\n\n<pre><code>Set replaceValuesRange = MainInputSheet.Range(MainInputSheet.Cells(2, 4), MainInputSheet.Cells(lastRow, 4)).FindNext\n</code></pre>\n\n<p>will start searching from the begging every time. To continue searching (show next occurrence of searched value) you have to use: </p>\n\n<pre><code>Set replaceValuesRange = MainInputSheet.Range(MainInputSheet.Cells(2, 4), MainInputSheet.Cells(lastRow, 4)).FindNext(replaceValuesRange)\n</code></pre>\n\n<p>Now the problem is, that the <code>Do Until</code> loop will go infinitely, but for every cell with searched value. I am not sure if there is some smarter way to stop the loop, but I just save row number of first found cell to <code>fstRow</code> variable, and then change <code>StopStop</code> variable for <code>True</code> when the loop will find this first cell once more:</p>\n\n<pre><code>Dim StopStop As Boolean\nDim fstRow As Long\n\n    StopStop = False\n    Set replaceValuesRange = MainInputSheet.Range(MainInputSheet.Cells(2, 4), MainInputSheet.Cells(lastRow, 4)).Find(findString)\n    If Not replaceValuesRange Is Nothing Then fstRow = replaceValuesRange.Row\n    Do Until replaceValuesRange Is Nothing Or StopStop\n        Set replaceValuesRange = MainInputSheet.Range(MainInputSheet.Cells(2, 4), MainInputSheet.Cells(lastRow, 4)).FindNext(replaceValuesRange)\n        If replaceValuesRange.Row = fstRow Then StopStop = True\n    Loop\n</code></pre>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 40770578, "answer_count": 3, "score": 1, "last_activity_date": 1479921382, "creation_date": 1479917838, "question_id": 40769372, "link": "https://stackoverflow.com/questions/40769372/iterate-over-all-cells-that-are-found-in-do-until-loop", "title": "Iterate Over All Cells That Are Found in Do Until Loop", "body": "<p>I am attempting to find duplicated values and in a column in excel and put 3 values in the corresponding columns next to the item.  The problem I am struggling with is that my search range is finding the same range over and over again rather than moving on to the next range that's found to contain the string or setting the <code>replaceValuesRange</code> to <code>Nothing</code>.</p>\n\n<p>I subsequently decided to change the string value to <code>MainInputSHeet.Cells(loopCounter, 4).Value = findString &amp; \" FOUND\"</code> in an attempt to change the value of the string, but I still get stuck in the find loop, which I assume is because the string is still existing within the cell.</p>\n\n<p>Any ideas?  The issue exists in the <code>Do Until</code> Loop.  Everything else is working fine</p>\n\n<p>This is what the immediate window looks like iterating through the DoLoop:</p>\n\n<pre><code>$D$5\n$D$5\n$D$5\n$D$5\n$D$5\n$D$5\n$D$5\n$D$5\n$D$5\n$D$5\n</code></pre>\n\n<p><strong>Main code block</strong></p>\n\n<pre><code>Option Explicit\nPublic Const DIR_SDR_PRODUCT_DEFINITIONS_FILEPATH As String = \"U:\\Research_Dev Docs\\DevFolder\\SDR Sheet\\SDRProductDefinitionsICE.xlsx\"\n\nPublic Sub TranslateAndPullProductInformation()\n\n    Dim lastRow As Integer, loopCounter As Integer\n    Dim sdrICEDefinitions As Workbook\n    Dim DefinitionsSheet As Worksheet\n    Dim findString As String, productTypeString As String, marketTypeString As String, contractTypeString As String\n    Dim searchRange As Range, findValuesRange As Range, replaceValuesRange As Range\n\n    'Checks file exists in specificed path, assigns workbook name, assigns proper worksheet for information definitions\n    If Len(Dir(DIR_SDR_PRODUCT_DEFINITIONS_FILEPATH)) = 0 Then GoTo BAIL_OUT\n\n    Set sdrICEDefinitions = Workbooks.Open(DIR_SDR_PRODUCT_DEFINITIONS_FILEPATH)\n\n    Set DefinitionsSheet = sdrICEDefinitions.Sheets(1)\n\n    Set searchRange = DefinitionsSheet.Range(\"A:A\")\n\n    lastRow = MainInputSheet.Cells(MainInputSheet.Rows.Count, \"D\").End(xlUp).Row\n\n    For loopCounter = 2 To lastRow\n\n        If IsEmpty(MainInputSheet.Cells(loopCounter, 3)) = True Then\n\n            findString = MainInputSheet.Cells(loopCounter, 4).Value\n\n            Set findValuesRange = searchRange.Find(findString)\n\n            Set replaceValuesRange = MainInputSheet.Range(MainInputSheet.Cells(2, 4), MainInputSheet.Cells(lastRow, 4)).Find(findString)\n\n            Do Until replaceValuesRange Is Nothing\n\n                'Product Name\n                MainInputSheet.Cells(loopCounter, 1) = findValuesRange.Offset(0, 1).Value\n\n                'Market Type\n                MainInputSheet.Cells(loopCounter, 2) = findValuesRange.Offset(0, 2).Value\n\n                'Contract Type\n                MainInputSheet.Cells(loopCounter, 3) = findValuesRange.Offset(0, 3).Value\n\n                MainInputSheet.Cells(loopCounter, 4).Value = findString &amp; \" FOUND\"\n\n                Set replaceValuesRange = MainInputSheet.Range(MainInputSheet.Cells(2, 4), MainInputSheet.Cells(lastRow, 4)).FindNext\n\n                Debug.Print replaceValuesRange.Address\n\n            Loop\n\n        End If\n\n    Next\n\nExit Sub\n\nBAIL_OUT:\n\n    MsgBox (\"ProductDefinitions File not found\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479918608, "post_id": 40769291, "comment_id": 68763220, "body": "Not related to the question, but you also need to test the length to make sure that after you &quot;build&quot; a username this way that it will fit in the backing field."}], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 1435538, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/psDMV.jpg?s=128&g=1", "display_name": "Joel Priddy", "link": "https://stackoverflow.com/users/1435538/joel-priddy"}, "edited": false, "score": 0, "creation_date": 1479918153, "post_id": 40769393, "comment_id": 68762908, "body": "This assumes that the previous &quot;i&quot; is only one character in perpetuity (if I remember my VB correctly).  You should do a character count on &quot;i.ToString&quot; to ensure you are getting rid of the right number of characters."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1479918251, "post_id": 40769393, "comment_id": 68762963, "body": "Yes, this will return funny results for i &gt;= 10"}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 1, "last_activity_date": 1479918278, "last_edit_date": 1479918278, "creation_date": 1479917899, "answer_id": 40769393, "question_id": 40769291, "link": "https://stackoverflow.com/questions/40769291/vba-loop-until-function-is-true-changing-passed-value-each-time/40769393#40769393", "title": "VBA loop until function is true, changing passed value each time", "body": "<p>Sorry, but this is the corrected version!</p>\n\n<p>Change your code to this instead:</p>\n\n<pre><code>Dim Username As String\nUsername = generateUsername(LCase(Left(FirstName, 1) &amp; LastName))\n\nFunction generateUsername(Username As String) As String\nDim NewName  as String\nDim i As Integer\ni = 1\nNewName = Username\nDo While checkUsername(NewName)\n    If checkUsername(NewName) Then\n       Exit Do\n    Else\n       NewName  = Username &amp; i\n       i = i + 1\n    End If\nLoop\n\ngenerateUsername = NewName\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 2, "last_activity_date": 1479918960, "last_edit_date": 1479918960, "creation_date": 1479918137, "answer_id": 40769466, "question_id": 40769291, "link": "https://stackoverflow.com/questions/40769291/vba-loop-until-function-is-true-changing-passed-value-each-time/40769466#40769466", "title": "VBA loop until function is true, changing passed value each time", "body": "<p>I assume <code>checkUsername()</code> returns true if the username exists?</p>\n\n<p>Then your <code>If</code> condition is wrong - you want to exit if it <strong>doesn't</strong> exist.</p>\n\n<p>Your loop gets clearer if you use two variables:</p>\n\n<pre><code>Function generateUsername(origUsername As String) As String\n\n    Dim i As Integer\n    Dim Username As String\n\n    i = 1\n    Username = origUsername\n\n    Do While checkUsername(Username)\n'        If Not checkUsername(Username) Then\n'           Exit Do\n'        Else\n           Username = origUsername &amp; i\n           i = i + 1\n'        End If\n    Loop\n\n    generateUsername = Username\n\nEnd Function\n</code></pre>\n\n<p>Edit: as pointed out by Joel, the additional <code>checkUsername()</code> in the loop isn't needed. Since it probably involves a <code>DLookup</code> or similar, it is actually harmful to performance.<br>\nI commented it out above.</p>\n"}, {"comments": [{"owner": {"reputation": 441, "user_id": 1435538, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/psDMV.jpg?s=128&g=1", "display_name": "Joel Priddy", "link": "https://stackoverflow.com/users/1435538/joel-priddy"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1479918801, "post_id": 40769522, "comment_id": 68763356, "body": "Ya. I completely missed it the first time I read it.  That explains why he never reaches the &quot;Else&quot;."}], "tags": [], "owner": {"reputation": 441, "user_id": 1435538, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/psDMV.jpg?s=128&g=1", "display_name": "Joel Priddy", "link": "https://stackoverflow.com/users/1435538/joel-priddy"}, "is_accepted": true, "score": 3, "last_activity_date": 1479918694, "last_edit_date": 1479918694, "creation_date": 1479918280, "answer_id": 40769522, "question_id": 40769291, "link": "https://stackoverflow.com/questions/40769291/vba-loop-until-function-is-true-changing-passed-value-each-time/40769522#40769522", "title": "VBA loop until function is true, changing passed value each time", "body": "<p>What I would do is, when the username exists already (see Andre's answer for the code that will accomplish this a different way):</p>\n\n<ul>\n<li>check what the previous \"i\" number was, as a string, to see how many characters I need to cut off the end of username</li>\n<li>set username equal to a substring of username, which will cut off the last X characters (X being the number of characters the previous \"i\" was)</li>\n<li>add the new \"i\" to the end username</li>\n</ul>\n\n<p>That will solve your naming issue.</p>\n\n<p>For your issue of looking for unique names, no one will be able to help with that until we can see what the code looks like for the \"checkUsername\" function. Make sure that that function is returning the value you are expecting, first.  I suspect the problem is in there.</p>\n\n<p>EDIT:</p>\n\n<p>I also don't understand why you have an \"If/Else\" statement in your loop.  You already determined that it was true.  See below for simplified version (again, assuming I got the code right for VB...I usually do it in C#):</p>\n\n<pre><code>Do While Not checkUsername(NewName)        \n    NewName  = Username &amp; i\n    i = i + 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 5827, "user_id": 263960, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/db28c95cf834131dfd92a86e81bac466?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/263960/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 40769522, "answer_count": 3, "score": 0, "last_activity_date": 1479918960, "creation_date": 1479917612, "question_id": 40769291, "link": "https://stackoverflow.com/questions/40769291/vba-loop-until-function-is-true-changing-passed-value-each-time", "title": "VBA loop until function is true, changing passed value each time", "body": "<p>I have a form that adds new users. I'm trying to auto generate the username, which needs to be unique. I have a function checkUsername that takes the string passed and checks the db table to see if that username exists. It returns false if the username exists and true if not.</p>\n\n<p>What I'm trying to do is if the username already exists then add a number on to the end and check again. I want to keep looping until a unqiue username is found. Heres my attempt at a loop below, however its returning usernames that already exist. Also I prefer it to increment the number rather than just adding it to the end. Currently the pattern ends up being username1, username12, username123.</p>\n\n<pre><code>'Generate username\nDim Username As String\nUsername = generateUsername(LCase(Left(FirstName, 1) &amp; LastName))\n\nFunction generateUsername(Username As String) As String\n\n    Dim i As Integer\n    i = 1\n\n    Do While checkUsername(Username)\n        If checkUsername(Username) Then\n           Exit Do\n        Else\n           Username = Username &amp; i\n           i = i + 1\n        End If\n    Loop\n\n    generateUsername = Username\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7136683, "user_type": "registered", "profile_image": "https://graph.facebook.com/1323384477713530/picture?type=large", "display_name": "Linda Elksn\u012bte", "link": "https://stackoverflow.com/users/7136683/linda-elksn%c4%abte"}, "edited": false, "score": 0, "creation_date": 1479917771, "post_id": 40769254, "comment_id": 68762640, "body": "I wrote this and it seems to work: <code>c = Cells(j - 1, &quot;E&quot;).Value</code> What do you think about this version?"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 3, "user_id": 7136683, "user_type": "registered", "profile_image": "https://graph.facebook.com/1323384477713530/picture?type=large", "display_name": "Linda Elksn\u012bte", "link": "https://stackoverflow.com/users/7136683/linda-elksn%c4%abte"}, "edited": false, "score": 0, "creation_date": 1479917997, "post_id": 40769254, "comment_id": 68762809, "body": "This will work as well when you provide numeric row and column. Note that in your &quot;not working&quot; example you try to address previous <i>column</i> <code>&quot;E-1&quot;</code>, whereas in you comment you subtract one from the <i>row</i>. <code>Offset</code> method will work if you use named ranges or provide columns as letters. Both are good."}, {"owner": {"reputation": 3, "user_id": 7136683, "user_type": "registered", "profile_image": "https://graph.facebook.com/1323384477713530/picture?type=large", "display_name": "Linda Elksn\u012bte", "link": "https://stackoverflow.com/users/7136683/linda-elksn%c4%abte"}, "edited": false, "score": 0, "creation_date": 1479918924, "post_id": 40769254, "comment_id": 68763445, "body": "Thanks you a lot! :)"}], "tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": true, "score": 0, "last_activity_date": 1479918273, "last_edit_date": 1479918273, "creation_date": 1479917479, "answer_id": 40769254, "question_id": 40768974, "link": "https://stackoverflow.com/questions/40768974/if-is-greater-than-previous-cell-at-different-location/40769254#40769254", "title": "If is greater than previous cell at different location", "body": "<p>Use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840060.aspx\" rel=\"nofollow noreferrer\"><code>Range.Offset(rowOffset, colOffset)</code></a> method:</p>\n\n<pre><code>c = Cells(j, \"E\").Offset(0, -1).Value  ' addresses \"previous\" column\nc = Cells(j, \"E\").Offset(-1, 0).Value  ' addresses \"previous\" row\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7136683, "user_type": "registered", "profile_image": "https://graph.facebook.com/1323384477713530/picture?type=large", "display_name": "Linda Elksn\u012bte", "link": "https://stackoverflow.com/users/7136683/linda-elksn%c4%abte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 40769254, "answer_count": 1, "score": 0, "last_activity_date": 1479918273, "creation_date": 1479916701, "question_id": 40768974, "link": "https://stackoverflow.com/questions/40768974/if-is-greater-than-previous-cell-at-different-location", "title": "If is greater than previous cell at different location", "body": "<p>I have to check, if the value in cell \"C\" is greater than 0, but less than value in PREVIOUS cell \"E\"., for example, checking, if the value at cell \"3C\" is greater than 0, but less than value in cell \"2E\". I have put in RGB for it to color the error included cell red. I'm also using UserForms for input.</p>\n\n<p>This is my code in Excel VBA:</p>\n\n<pre><code>    X = Cells(j, \"C\").Value \n    d = Cells(j, \"E\").Value\n    c = Cells(j, \"E-1\").Value\n    If X &gt;= c And X &lt; 0 Or X &lt; 0 Or X &gt;= c Then\n            Cells(j, \"C\").Interior.Color = 255\n            UserForm1.inpBox.Value = j\n            UserForm1.Label1.Caption = (j &amp; \". Row has an error!\")\n            UserForm1.Show\n            Cells(j, \"C\") = UserForm1.inpBox.Value\n            Cells(j, \"C\").Interior.Color = RGB(255, 255, 255)\n        End If\n</code></pre>\n\n<p>I know that there is a mistake in here, but I can't figure out, what to put in it's place for it to work:</p>\n\n<pre><code>    X = Cells(j, \"C\").Value \n    d = Cells(j, \"E\").Value\n    c = Cells(j, \"E-1\").Value\n    If X &gt;= c And X &lt; 0 Or X &lt; 0 Or X &gt;= c Then\n</code></pre>\n"}, {"tags": ["vba", "postmessage", "user32"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1479918088, "creation_date": 1479918088, "answer_id": 40769452, "question_id": 40768949, "link": "https://stackoverflow.com/questions/40768949/invalid-procedure-call-or-argument-error-5-when-calling-user32-postmessage/40769452#40769452", "title": "Invalid Procedure Call or Argument (Error 5) when calling User32 PostMessage", "body": "<p>This never even makes the call to <code>PostMessage</code> - the error is in this bit:</p>\n\n<pre><code>Asc(Mid$(vbCr, i, 1))\n</code></pre>\n\n<p>The variable <code>i</code> is never declared or assigned a value (and is a great argument for adding <code>Option Explicit</code> to all your modules...) so it is trying to read <code>Mid$</code> from position 0.  It's 1 based, thus your error.</p>\n\n<p>That said, it isn't clear why you're trying to extract 1 character from a 1 character long literal.  <code>Asc(Mid$(vbCr, i, 1))</code> is the same as <code>Asc(vbCr)</code> which is <em>always</em> <code>13</code>.  Just use this:</p>\n\n<pre><code>result = PostMessage(h, WM_CHAR, 13&amp;, 0&amp;)\n</code></pre>\n\n<p>Note that this doesn't match your comment of \"send \"calc.exe\" followed by carraige return\" at all.  In order to do that with <code>WM_CHAR</code> messages, you need to post all of the individual characters. Just skip the <code>Asc</code> and <code>Mid$</code> entirely by treating the string as a byte array:</p>\n\n<pre><code>Dim chars() As Byte\nchars = StrConv(\"calc.exe\" &amp; vbCr, vbFromUnicode)\nDim i As Long\nFor i = LBound(chars) To UBound(chars)\n    result = PostMessage(h, WM_CHAR, CLng(chars(i)), 0&amp;)\n    'Check result to see if you need to bail here.\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7200832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/745b3afdc02ac98aed0fb1600edd836e?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7200832/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1479918088, "creation_date": 1479916640, "question_id": 40768949, "link": "https://stackoverflow.com/questions/40768949/invalid-procedure-call-or-argument-error-5-when-calling-user32-postmessage", "title": "Invalid Procedure Call or Argument (Error 5) when calling User32 PostMessage", "body": "<p>The following code returns \"Run-Time Error 5: Invalid procedure call or argument\" at the line: </p>\n\n<p>result = PostMessage(h, WM_CHAR, Asc(Mid$(vbCr, i, 1)), 0&amp;)</p>\n\n<pre><code>Private Const WM_CHAR = &amp;H102\nDeclare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\nDeclare Function PostMessage Lib \"user32\" Alias \"PostMessageA\" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long\n\nSub PostToCmdLine()\n    Dim h As Long\n    Dim result As Boolean\n    ' find dos prompt window\n    h = FindWindow(vbNullString, \"c:\\windows\\system32\\cmd.exe\")\n    Stop\n    If h Then\n        ' send \"calc.exe\" followed by carraige return\n        result = PostMessage(h, WM_CHAR, Asc(Mid$(vbCr, i, 1)), 0&amp;)\n        ' optional, check postmessage result\n        If result = False Then MsgBox (\"postmessage failed!\")\n        'close the hidden dos prompt window\n        ' SendTxt(h, \"exit\" &amp; vbCr)\n    Else\n        MsgBox (\"dos prompt window not found\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "edited": false, "score": 0, "creation_date": 1479930557, "post_id": 40768796, "comment_id": 68769875, "body": "The file locations are mutually exclusive; radio buttons or a dropdown would have been a better idea than checkboxes."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "edited": false, "score": 0, "creation_date": 1479935378, "post_id": 40773199, "comment_id": 68772214, "body": "Thank you, that actually helped me a lot and opened my eyes to a different approach for this problem."}, {"owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "reply_to_user": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "edited": false, "score": 0, "creation_date": 1479936743, "post_id": 40773199, "comment_id": 68772837, "body": "Excellent. That is basically what I was trying to do."}], "tags": [], "owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "is_accepted": true, "score": 1, "last_activity_date": 1479931270, "creation_date": 1479931270, "answer_id": 40773199, "question_id": 40768796, "link": "https://stackoverflow.com/questions/40768796/vba-open-document-based-on-cell-value-with-multiple-conditions/40773199#40773199", "title": "VBA: Open Document based on Cell Value with multiple conditions", "body": "<p>Here are some ideas you can use. You'll have to update your code in a couple of places.</p>\n\n<pre><code>Server=\"C:\\Server\\\" &amp; A1 &amp; \".xls\" 'Get the filename from Cell A1\n\nLocal=\"C:\\Local\\\" &amp; A1 &amp; \".xls\"   'Get the filename from Cell A1\n\n\nIf (Serverbox.value = true &amp; Localbox2.value= false) Then\n    WB2=Workbooks.Open(Server) \nEnd If\n\nIf (Serverbox.value = false &amp; Localbox2.value= true) Then\n    WB2=Workbooks.Open(Local) \nEnd If\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1003, "favorite_count": 0, "accepted_answer_id": 40773199, "answer_count": 1, "score": 0, "last_activity_date": 1479931270, "creation_date": 1479916216, "last_edit_date": 1531161705, "question_id": 40768796, "link": "https://stackoverflow.com/questions/40768796/vba-open-document-based-on-cell-value-with-multiple-conditions", "title": "VBA: Open Document based on Cell Value with multiple conditions", "body": "<p>I'm still new to VBA so  I'm looking for advise to accomplish the following task:\nI Have a cell <code>A1</code> and two <code>Checkboxes (Serverbox1 &amp; Localbox2)</code></p>\n\n<p><code>A1</code> is a Pulldown menu with values like Apple1, Banana1 etc... which represent excel file names. Excel should open the picked file  and exporting a cell or a range, for example <code>A2</code> from <code>WB1</code> to <code>WB2</code> by clicking the Export Button.</p>\n\n<p><code>Private Sub exportData_Click()</code></p>\n\n<p><code>Dim WB1 as Workbook</code></p>\n\n<p><code>Dim WB2 as Workbook</code></p>\n\n<p><code>Server=\"C:\\Server\\Apple1.xls\"</code></p>\n\n<p><code>Local=\"C:\\Local\\Apple1.xls\"</code></p>\n\n<p><code>Set WS1=ThisWorkBook</code></p>\n\n<p><code>Set WB1=ActiveWorkbook</code></p>\n\n<p><code>WS2=WB2.Sheets(1)</code></p>\n\n<p><code>Set WB2=Workbooks.Open(Server</code> OR <code>Local)</code>\nSomehow that needs to changes automatically. </p>\n\n<p>So that  <code>Set WB2=Workbooks.Open(Server)</code>only applies \nIf <code>A1 = Apple1 &amp; Serverbox.value = true &amp; Localbox2.value= false</code></p>\n\n<p>And <code>Set WB2=Workbooks.Open(Local)</code> only applies <code>If A1 = Apple1 &amp; Serverbox.value = false &amp; Localbox2.value= true</code></p>\n\n<p>Once the file is open it would continue to copy data to <code>Apple1.xls</code> or <code>Banana1.xls</code> based on the input above.</p>\n\n<p><code>ws2.range(\"A2\")=ws1.range(\"A2\")</code></p>\n\n<p>I dont need to worry about auto saving anything, it will be a manual process (preferred).\nI appreciate any help!</p>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1479916003, "post_id": 40768643, "comment_id": 68761425, "body": "I just tried and didn&#39;t get an error, where is the error happening?  Your 2nd loop just produces 6,8,10,12,14,16,18 and 20, so why not have a variable y, starting at 6 incrementing by 2 each time?"}, {"owner": {"reputation": 361, "user_id": 5461381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G5dPd.png?s=128&g=1", "display_name": "Petter_M", "link": "https://stackoverflow.com/users/5461381/petter-m"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479916138, "post_id": 40768643, "comment_id": 68761518, "body": "@Nathan_Sav the loop/sequence that is giving error is the  <code>For y = 2 * (3 + k) To 2 * (3 + k)</code> which is linked on For <code>k = 0 To 7</code>. But if I set <code>For y = 6 to 6</code>, for example, it goes normally."}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 2, "creation_date": 1479916268, "post_id": 40768643, "comment_id": 68761618, "body": "You should probably <code>Dim</code> <code>k</code> and <code>y</code> as <code>Long</code> instead of <code>Double</code>. There may be some rounding errors happening?"}, {"owner": {"reputation": 361, "user_id": 5461381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G5dPd.png?s=128&g=1", "display_name": "Petter_M", "link": "https://stackoverflow.com/users/5461381/petter-m"}, "reply_to_user": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1479916476, "post_id": 40768643, "comment_id": 68761751, "body": "@bobajob I&#39;ve already tried to <code>Dim k</code>and <code>Dim y as Long</code>, but got the same &quot;Run-time Mismatch Error&quot;."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1479916511, "post_id": 40768643, "comment_id": 68761776, "body": "See my answer... just get rid of the y loop since it only triggers once."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1479916898, "post_id": 40768643, "comment_id": 68762055, "body": "What line throws the error? I suspect <code>UserForm1.Controls(Textbox).Value = Worksheets(&quot;PANEL&quot;).Cells(y, 45).Value</code>. So have a look what <code>Worksheets(&quot;PANEL&quot;).Cells(y, 45).Value</code> is if the error occurs."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 2, "creation_date": 1479916980, "post_id": 40768643, "comment_id": 68762110, "body": "Regardless of whether that&#39;s where the error stems from, a <code>For</code> loop counter should never be a floating-point type, @bobajob has a point. Make them <code>Long</code> integers and get <i>that</i> off the plate already."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1479917047, "post_id": 40768643, "comment_id": 68762154, "body": "FWIW <code>Textbox As String</code> is shadowing the <code>TextBox</code> type, which may or may not be problematic. Avoid naming locals with identifiers that already exist in reference type libraries."}, {"owner": {"reputation": 361, "user_id": 5461381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G5dPd.png?s=128&g=1", "display_name": "Petter_M", "link": "https://stackoverflow.com/users/5461381/petter-m"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1479917182, "post_id": 40768643, "comment_id": 68762244, "body": "@AxelRichter Thanks a lot! I just put <code>0.0</code> in the IFERROR function instead of only <code>0</code> and everything went well!"}, {"owner": {"reputation": 361, "user_id": 5461381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G5dPd.png?s=128&g=1", "display_name": "Petter_M", "link": "https://stackoverflow.com/users/5461381/petter-m"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479917322, "post_id": 40768643, "comment_id": 68762345, "body": "@Mat&#39;sMug  and bobajob  also many thanks for your support!!"}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 5461381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G5dPd.png?s=128&g=1", "display_name": "Petter_M", "link": "https://stackoverflow.com/users/5461381/petter-m"}, "edited": false, "score": 0, "creation_date": 1479916758, "post_id": 40768866, "comment_id": 68761961, "body": "the error still persists, but if I omit the <code>k</code> from  <code>y = 2 * (3 + k)</code> as <code>y = 2 * 3</code>, it goes well."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 361, "user_id": 5461381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G5dPd.png?s=128&g=1", "display_name": "Petter_M", "link": "https://stackoverflow.com/users/5461381/petter-m"}, "edited": false, "score": 1, "creation_date": 1479916990, "post_id": 40768866, "comment_id": 68762118, "body": "@Petter_Mendes I copied and pasted this code exactly and didn&#39;t get an error until <code>UserForm1.Controls</code> line (because I obviously don&#39;t have your text boxes built).  I had NO error on Type Mismatch."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 361, "user_id": 5461381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G5dPd.png?s=128&g=1", "display_name": "Petter_M", "link": "https://stackoverflow.com/users/5461381/petter-m"}, "edited": false, "score": 1, "creation_date": 1479917148, "post_id": 40768866, "comment_id": 68762215, "body": "Updated per @Mat&#39;sMug Suggestion"}, {"owner": {"reputation": 361, "user_id": 5461381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G5dPd.png?s=128&g=1", "display_name": "Petter_M", "link": "https://stackoverflow.com/users/5461381/petter-m"}, "edited": false, "score": 0, "creation_date": 1479917437, "post_id": 40768866, "comment_id": 68762416, "body": "Many Thanks for the help!"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 1, "last_activity_date": 1479917059, "last_edit_date": 1479917059, "creation_date": 1479916442, "answer_id": 40768866, "question_id": 40768643, "link": "https://stackoverflow.com/questions/40768643/for-next-loop-with-function-error/40768866#40768866", "title": "For Next Loop with Function Error", "body": "<p>Just get rid of the <code>y</code> loop.  It only triggers once so just set <code>y</code> each time you move through the <code>k</code> loop.</p>\n\n<pre><code>Sub Update_TextBox_Preco()\n\nDim k As Long\nDim myarray2 As Variant\nDim y As Long\nDim TextBoxUp As String\nDim Textbox_1 As String\nDim line As Variant\n\n'Array with contained TextBox names\n    myarray2 = Array(\"TextBox_Moeda_Atual\", \"TextBox_Medida_Atual\", \"TextBox_Acond_Atual\", \"TextBox_Lote_Atual\", _\n                \"TextBox_Incoterm_Atual\", \"TextBox_p_liq_atual\", \"TextBox_encargo_atual\", \"TextBox_Frete_Atual\")\n\nFor k = 0 To 7\n    TextBoxUp = myarray2(k)\n    y = 2 * (3 + k)\n    UserForm1.Controls(TextBoxUp).Value = Worksheets(\"PANEL\").Cells(y, 45).Value\nNext k\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 5461381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G5dPd.png?s=128&g=1", "display_name": "Petter_M", "link": "https://stackoverflow.com/users/5461381/petter-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "accepted_answer_id": 40768866, "answer_count": 1, "score": 2, "last_activity_date": 1479917059, "creation_date": 1479915832, "last_edit_date": 1479916746, "question_id": 40768643, "link": "https://stackoverflow.com/questions/40768643/for-next-loop-with-function-error", "title": "For Next Loop with Function Error", "body": "<p>I am trying to create a loop to update some \"TextBox\" already created on Userform.\nThe problem is that when I link the line</p>\n\n<pre><code>              For y = 2 * (3 + k) To 2 * (3 + k)\n</code></pre>\n\n<p>With</p>\n\n<pre><code>    For k = 0 To 7\n</code></pre>\n\n<p>I get a Mismatch Error. But if I define y = 6, everything goes fine.</p>\n\n<p>Could you help me out?</p>\n\n<p>Please, see below the entire code:</p>\n\n<pre><code>    Sub Update_TextBox_Preco()\n\n    Dim k As Double\n    Dim myarray2 As Variant\n    Dim y As Double\n    Dim Textbox As String\n    Dim Textbox_1 As String\n    Dim line As Variant\n\n    Array with contained TextBox names\n        myarray2 = Array(\"TextBox_Moeda_Atual\", \"TextBox_Medida_Atual\", \"TextBox_Acond_Atual\", \"TextBox_Lote_Atual\", _\n                    \"TextBox_Incoterm_Atual\", \"TextBox_p_liq_atual\", \"TextBox_encargo_atual\", \"TextBox_Frete_Atual\")\n\n    For k = 0 To 7\n    Textbox = myarray2(k)\n              For y = 2 * (3 + k) To 2 * (3 + k)\n                 UserForm1.Controls(Textbox).Value = Worksheets(\"PANEL\").Cells(y, 45).Value\n              Next y\n    Next k\n\n    End Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "onclick"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1479915768, "post_id": 40768577, "comment_id": 68761277, "body": "I see <code>WHERE Skill = &#39;&#39;&quot;</code> at the end of the second query. Is it supposed to be so? Can you show the debug.print (sSQL) ?"}, {"owner": {"reputation": 133, "user_id": 5759481, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/78f6ea3216c01450ca8391644544f09d?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Mather", "link": "https://stackoverflow.com/users/5759481/jessica-mather"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1479915934, "post_id": 40768577, "comment_id": 68761381, "body": "This is the Debug.Print UPDATE tblSkillMatrix SET Skill = &#39;TCM review and practical experience of tools calibration (basic measurement tools)&#39;, Requirement = &#39;R&#39; WHERE Skill = &#39;&#39;. The &quot; at the end is because the sSQL requires a string value."}, {"owner": {"reputation": 133, "user_id": 5759481, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/78f6ea3216c01450ca8391644544f09d?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Mather", "link": "https://stackoverflow.com/users/5759481/jessica-mather"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1479916136, "post_id": 40768577, "comment_id": 68761515, "body": "I can see that the problem is that it isn&#39;t interpreting the WHERE statement properly, but I&#39;m not sure how else I can tell it to grab the Skills that have a NULL value."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1479916219, "post_id": 40768577, "comment_id": 68761584, "body": "Try with isnull <a href=\"https://msdn.microsoft.com/en-us/library/ms184325.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms184325.aspx</a>"}, {"owner": {"reputation": 133, "user_id": 5759481, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/78f6ea3216c01450ca8391644544f09d?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Mather", "link": "https://stackoverflow.com/users/5759481/jessica-mather"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1479919521, "post_id": 40768577, "comment_id": 68763830, "body": "Awesome, this worked. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1479926113, "creation_date": 1479926113, "answer_id": 40771917, "question_id": 40768577, "link": "https://stackoverflow.com/questions/40768577/adding-updating-a-sql-table-in-vba/40771917#40771917", "title": "Adding/Updating a sql table in VBA", "body": "<p>The error is in the wrong where clause. It should be with ISNULL. Here is a guidance how to use it - <a href=\"https://msdn.microsoft.com/en-us/library/ms184325.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/ms184325.aspx</a></p>\n"}], "owner": {"reputation": 133, "user_id": 5759481, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/78f6ea3216c01450ca8391644544f09d?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Mather", "link": "https://stackoverflow.com/users/5759481/jessica-mather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 40771917, "answer_count": 1, "score": 2, "last_activity_date": 1479926113, "creation_date": 1479915626, "question_id": 40768577, "link": "https://stackoverflow.com/questions/40768577/adding-updating-a-sql-table-in-vba", "title": "Adding/Updating a sql table in VBA", "body": "<p>I am trying to make it so that Query 1 inserts into 1 of the 3 fields based on whether the task value (grabbed from another table) is selected (true or false check box). This part works.</p>\n\n<p>Query 2 is supposed to update the other 2 fields that are empty to the values in a combo box. This part is not working. Syntactically it seems correct and it isn't crashing. But I just don't think it is reading it in the first place.</p>\n\n<p>All this is supposed to be accomplished via 1 button click. </p>\n\n<p>Query 1:</p>\n\n<pre><code>Sub DBInsert_SkillMatrix()\nsSQL = \"Insert into tblSkillMatrix (Task) Select Task from tblTask WHERE Selected = true\"\nSet db = CurrentDb\ndb.Execute (sSQL)\ndb.Close\nEnd Sub\n</code></pre>\n\n<p>Query 2:</p>\n\n<pre><code>Sub DBUpdate_SkillMatrix()\nDim db As DAO.Database\nsSQL = \"UPDATE tblSkillMatrix SET Skill = '\" &amp; Me.cboAST_Skill &amp; \"', Requirement = '\" &amp; Me.cboAST_Requirement &amp; \"' WHERE Skill = ''\"\nSet db = CurrentDb\nDebug.Print (sSQL)\ndb.Execute (sSQL)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 55, "user_id": 6726572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6b7692f19625dcb229a50c7e6b72c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Turner", "link": "https://stackoverflow.com/users/6726572/adam-turner"}, "edited": false, "score": 0, "creation_date": 1479915825, "post_id": 40768491, "comment_id": 68761318, "body": "Thanks for helping with the editing.  How do you do the code block?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479915877, "post_id": 40768491, "comment_id": 68761354, "body": "iedoc.getelementbyid(&quot;wob_tm&quot;).innertext"}, {"owner": {"reputation": 55, "user_id": 6726572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6b7692f19625dcb229a50c7e6b72c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Turner", "link": "https://stackoverflow.com/users/6726572/adam-turner"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479916197, "post_id": 40768491, "comment_id": 68761570, "body": "Perfect!  thank you very much!"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1479916250, "creation_date": 1479916250, "answer_id": 40768805, "question_id": 40768491, "link": "https://stackoverflow.com/questions/40768491/vba-pull-a-value-from-an-html-span/40768805#40768805", "title": "VBA: pull a value from an html span", "body": "<pre><code>iedoc.getelementbyid(\"wob_tm\").innertext \n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6726572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6b7692f19625dcb229a50c7e6b72c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Turner", "link": "https://stackoverflow.com/users/6726572/adam-turner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 0, "accepted_answer_id": 40768805, "answer_count": 1, "score": 0, "last_activity_date": 1479916250, "creation_date": 1479915382, "last_edit_date": 1479915711, "question_id": 40768491, "link": "https://stackoverflow.com/questions/40768491/vba-pull-a-value-from-an-html-span", "title": "VBA: pull a value from an html span", "body": "<p>I am sure this has been answered, but I think I might not know how to ask the question correctly, so any help that either points me in the right direction and/or answers the question would be greatly appreciated.</p>\n\n<p>I am attempting to pull a value out of a google search for weather.  The page has the code:</p>\n\n<pre><code> &lt;span class=\"wob_t\" id=\"wob_tm\" style=\"display: inline;\"&gt;60&lt;/span&gt;\n</code></pre>\n\n<p>What I want to get is the value \"60\".  The code I am working with is:</p>\n\n<pre><code>Set ie = CreateObject(\"InternetExplorer.Application\")\nie.Visible = True\nie.navigate (\"https://www.google.com/#q=weather+little+rock\")\nWhile ie.busy\n    DoEvents\nWend\nSet iedoc = ie.document\ntemp = iedoc.getElementById(\"wob_tm\").Value\n</code></pre>\n\n<p>Please and thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1479915316, "post_id": 40768281, "comment_id": 68760970, "body": "To generate the &quot;Sheet&quot; part, you would need to use <code>sh.Name</code>, so try <code>SubAddress:=&quot;&#39;&quot; &amp; sh.Name &amp; &quot;&#39;!&quot; &amp; Cells(round2, 2).Address</code> (the extra <code>&#39;</code>s are to ensure it continues to work if there are spaces, etc, in the sheet name).  You might also like to try <code>SubAddress:=sh.Cells(round2, 2).Address(External:=True)</code>"}, {"owner": {"reputation": 91, "user_id": 4676957, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rAqnB.png?s=128&g=1", "display_name": "phfb", "link": "https://stackoverflow.com/users/4676957/phfb"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1479918808, "post_id": 40768281, "comment_id": 68763364, "body": "@YowE3K, this worked perfectly.  All I needed to do was add that (External:=True), and it took right off.  Thank you so much for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1479926746, "creation_date": 1479926746, "answer_id": 40772080, "question_id": 40768281, "link": "https://stackoverflow.com/questions/40768281/how-do-i-link-to-another-sheet-in-excel-with-vba/40772080#40772080", "title": "How do I link to another sheet in Excel with VBA?", "body": "<p>There are two modifications you could use to get your code working:</p>\n\n<ol>\n<li><p>You could use</p>\n\n<p><code>SubAddress:=\"'\" &amp; Replace(sh.Name, \"'\", \"''\") &amp; \"'!\" &amp; Cells(round2, 2).Address</code></p>\n\n<p>in order to generate something of the form <code>SubAddress:=\"'Sheet name'!$A$1\"</code>.</p>\n\n<p>(The bits in the formula dealing with <code>'</code>s are to allow it to still work if there are spaces, etc, in the sheet name.  If you know that won't occur, e.g. because you defined the sheet names and no-one else will be changing them, you could simplify it to <code>SubAddress:=sh.Name &amp; \"!\" &amp; Cells(round2, 2).Address</code>)</p></li>\n</ol>\n\n<p><br></p>\n\n<ol start=\"2\">\n<li><p>You could use</p>\n\n<p><code>SubAddress:=sh.Cells(round2, 2).Address(External:=True)</code></p>\n\n<p>which would generate something of the form <code>SubAddress:=\"'[Book1.xlsx]Sheet name'!$A$1\"</code></p></li>\n</ol>\n"}], "owner": {"reputation": 91, "user_id": 4676957, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rAqnB.png?s=128&g=1", "display_name": "phfb", "link": "https://stackoverflow.com/users/4676957/phfb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "accepted_answer_id": 40772080, "answer_count": 1, "score": 0, "last_activity_date": 1479926746, "creation_date": 1479914723, "question_id": 40768281, "link": "https://stackoverflow.com/questions/40768281/how-do-i-link-to-another-sheet-in-excel-with-vba", "title": "How do I link to another sheet in Excel with VBA?", "body": "<p>I'm trying to generate a list of hyperlinks in excel and link them dynamically to another cell in a different sheet.  Could someone explain how I need to format the reference?  Currently, it looks like this:</p>\n\n<pre><code>'p2r is one sheet\n'sh is another\n'Subaddress is currently linking to the correct location, wrong sheet.\n    '(It's linking to [p2r]'s cells, not [sh]'s cells)\n\np2r.Hyperlinks.Add_\n    Anchor:=p2r.Cells(p2rIndex, 1), _\n    Address:=\"\", _\n    SubAddress:=sh.Cells(round2, 2).Address, _\n    TextToDisplay:=PrevRow\n</code></pre>\n\n<p>Thanks for the help!  I've seen others use a format like: Sheet!A1, but when I tried something like:</p>\n\n<pre><code>SubAddress:=sh &amp; \"!\" &amp; Cells(round2, 2).Address\n</code></pre>\n\n<p>I got no results of value.</p>\n"}, {"tags": ["vba", "excel", "colon-equals"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 5, "creation_date": 1479914504, "post_id": 40768172, "comment_id": 68760417, "body": "I wouldn&#39;t call <code>:=</code> an &quot;operator&quot; - it&#39;s more like a &quot;named argument specifier&quot;."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479914848, "post_id": 40768172, "comment_id": 68760664, "body": "<code>call function (argument:=value)</code> say all arguments are optional, and there are 10, you want to pass the 5th by name, then variable setting such as and <code>let variable=x</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 5, "creation_date": 1479915849, "post_id": 40768588, "comment_id": 68761337, "body": "<code>=</code> is also used as a boolean operator, which is why it is important not to accidentally use <code>=</code> instead of <code>:=</code> - e.g. <code>MsgBox Title=&quot;Title1&quot;, prompt=&quot;Hello world&quot;</code> would probably equate to <code>MsgBox False, False</code> if <code>Option Explicit</code> wasn&#39;t being used."}], "tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": true, "score": 11, "last_activity_date": 1479915917, "last_edit_date": 1479915917, "creation_date": 1479915656, "answer_id": 40768588, "question_id": 40768172, "link": "https://stackoverflow.com/questions/40768172/what-is-the-difference-between-and-in-excel-vba/40768588#40768588", "title": "What is the difference between := and = in Excel VBA", "body": "<p>As you already know, <code>=</code> is used to assign values or set objects - e.g. <code>i=1</code></p>\n\n<p><code>:=</code> on the other hand (like Comintern mentioned), is used to to assign a value to a certain <strong>named</strong> argument, afaik only ever inside a method or function.</p>\n\n<p>Consider the following example: you could use something like <code>MsgBox \"Hello World\", , \"Title1\"</code> - specifying <code>MsgBox</code>'s arguments in the default order - the <code>prompt</code>, the default <code>Buttons</code>-style, then the <code>Title</code>.</p>\n\n<p>Alternatively, one could use <code>:=</code> to write <code>MsgBox Title:=\"Title1\", prompt:=\"Hello world\"</code></p>\n\n<p>Notice that </p>\n\n<ul>\n<li><p>the order of the arguments is of no importance here and</p></li>\n<li><p>there is no need to specify empty placeholders for default-arguments <code>, ,</code>.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479917347, "post_id": 40768733, "comment_id": 68762362, "body": "The only <i>required</i> argument to <code>Range.Find</code> is <code>What</code>; it&#39;s not true that you need to specify all arguments - you need to specify all arguments <i>that you&#39;re not providing a value for</i>."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479917452, "post_id": 40768733, "comment_id": 68762429, "body": "@Mat&#39;sMug Clarified you would have to use commas to get through optional values."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1523323308, "post_id": 40768733, "comment_id": 86502582, "body": "Just to point out, in the example above, this would also function the same as the above examples: <code>Range(&quot;A1:A500&quot;).Find 2,, xlValues</code>. Which one looks more tidy is a matter of opinion.  If fewer keystroke is the goal, even this functions the same: <code>[A1:A500].Find 2,,-4163</code>.  Also, <b>parentheses are optional if the function is not returning a value</b> (Such as <code>MsgBox &quot;Hi&quot;</code>), and if all the rest of the parameters are blank and/or default, no further comma&#39;s need to be included (ie. <code>\u2026xlValue, , , , , ,</code> = <code>\u2026xlValue</code>)"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 3, "last_activity_date": 1479917426, "last_edit_date": 1479917426, "creation_date": 1479916081, "answer_id": 40768733, "question_id": 40768172, "link": "https://stackoverflow.com/questions/40768172/what-is-the-difference-between-and-in-excel-vba/40768733#40768733", "title": "What is the difference between := and = in Excel VBA", "body": "<p>Let us take for example the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\"><code>Range.Find</code> method</a></p>\n\n<blockquote>\n  <p><em>expression</em>.<strong>Find(<em>What, After, LookIn, LookAt, SearchOrder, SearchDirection, MatchCase, MatchByte, SearchFormat</em>)</strong></p>\n</blockquote>\n\n<p>That is a <strong><em>LOT</em></strong> of conditions to set!  But you just want a simple search of the number <code>2</code> in <code>Range(\"A1:A500\")</code>:</p>\n\n<p>Without the <code>:=</code> operator, you would have to use commas to get to any optional variables to set:</p>\n\n<pre><code>Range(\"A1:A500\").Find(2, , xlValue, , , , , , )\n</code></pre>\n\n<p>With the <code>:=</code> operator, you can specify which conditions you want without delineating through all the default settings:</p>\n\n<pre><code>Range(\"A1:A500\").Find(what:=2, lookin:=xlValues)\n</code></pre>\n"}], "owner": {"reputation": 531, "user_id": 6254149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/1UvBh.jpg?s=128&g=1", "display_name": "Moreno", "link": "https://stackoverflow.com/users/6254149/moreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15510, "favorite_count": 0, "accepted_answer_id": 40768588, "answer_count": 2, "score": 8, "last_activity_date": 1542114704, "creation_date": 1479914420, "last_edit_date": 1542114704, "question_id": 40768172, "link": "https://stackoverflow.com/questions/40768172/what-is-the-difference-between-and-in-excel-vba", "title": "What is the difference between := and = in Excel VBA", "body": "<p>I have been working with Excel for a while, yet i have never read what is the difference between these two operators (\"regardless of i have used both\")\n <code>:=</code> and <code>=</code> in Excel VBA</p>\n"}, {"tags": ["vba", "excel", "calendar", "excel-2013"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1479911554, "post_id": 40767022, "comment_id": 68758378, "body": "what line is the error thrown at?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1479911777, "post_id": 40767022, "comment_id": 68758534, "body": "you might need to declare the date variable that is being transferred as public. Its hard to say though without seeing too much more"}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 1, "creation_date": 1479911778, "post_id": 40767022, "comment_id": 68758537, "body": "Could it be that you need to reference the form the calendar control is on?  ie frmCalendar.Calendar1.Value"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1479915962, "post_id": 40767705, "comment_id": 68761394, "body": "I get a compile error of Method or data member not found on .Calendar1  If I remove the &quot;.&quot; I get a debug error of &#39;Object Required&#39;"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1479916088, "post_id": 40767705, "comment_id": 68761482, "body": "@StarsFlyFreeFromCozyNights - Make <code>Calendar1</code> public instead of private."}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1479916275, "post_id": 40767705, "comment_id": 68761628, "body": "Calendar1 = New cCalendar (syntax from the link I posted that I followed to set-up this)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1479916324, "post_id": 40767705, "comment_id": 68761655, "body": "@StarsFlyFreeFromCozyNights - Just followed the link.  You need to change <code>Private WithEvents Calendar1 As cCalendar</code> to <code>Public WithEvents Calendar1 As cCalendar</code>"}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1479916539, "post_id": 40767705, "comment_id": 68761806, "body": "That removes the compile error, and if I hover over .Calendar1.Value it shows the value, but I still get a debug error of object required."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1479916831, "post_id": 40767705, "comment_id": 68762013, "body": "@StarsFlyFreeFromCozyNights - Remove the line <code>Set Calendar1 = Nothing</code> from the <code>QueryClose</code> event."}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1479917158, "post_id": 40767705, "comment_id": 68762223, "body": "Same issue - debug error of object required.  It will write to a cell problem free, but not back to the text box on the &quot;caller&quot; form"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1479917282, "post_id": 40767705, "comment_id": 68762316, "body": "Do you have a textbox named <code>txtBegin</code>?"}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1479917952, "post_id": 40767705, "comment_id": 68762784, "body": "Yes - textbox is named txtBegin"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1479918188, "post_id": 40767705, "comment_id": 68762924, "body": "@StarsFlyFreeFromCozyNights - I can&#39;t replicate that behavior at all. Does <code>txtBegin.Value = &quot;foo&quot;</code> work on that line instead?"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1506030269, "last_edit_date": 1506030269, "creation_date": 1479912928, "answer_id": 40767705, "question_id": 40767022, "link": "https://stackoverflow.com/questions/40767022/get-date-picked-into-user-form-text-box/40767705#40767705", "title": "Get Date Picked Into User Form Text Box", "body": "<p>You're unloading <code>frmCalendar</code> and then trying to read a value from it.  You need to create a non-default instance of the calendar form (using <code>New</code>).  Then instead of calling <code>Unload Me</code> in <code>Calendar1_DblClick</code>, use <code>Me.Hide</code> to return execution to the calling code:</p>\n\n<p>In <code>frmCalendar</code>:</p>\n\n<pre><code>Private Sub Calendar1_DblClick()\n    ActiveCell.Value = Calendar1.Value\n    Me.Hide\nEnd Sub\n</code></pre>\n\n<p>In <code>UserForm1</code>:</p>\n\n<pre><code>Private Sub txtBegin_Enter()\n    controlwithfocus = ActiveControl.Name\n    With New frmCalendar                      'Create a new form instance\n        .Show\n        txtBegin.Value = .Calendar1.Value     'Form is hidden, but not unloaded.\n    End With                                  'Form unloads here.\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506030269, "creation_date": 1479911017, "question_id": 40767022, "link": "https://stackoverflow.com/questions/40767022/get-date-picked-into-user-form-text-box", "title": "Get Date Picked Into User Form Text Box", "body": "<p>I have two user forms, one is a calendar that I used this guide on how to create <a href=\"https://sites.google.com/site/e90e50/calendar-control-class\" rel=\"nofollow noreferrer\">https://sites.google.com/site/e90e50/calendar-control-class</a> and one is where a begindate and enddate will be selected.  I am attempting to get the date selected from frmCal into a textbox on userform1.  This is how I am calling from userform1</p>\n\n<pre><code>Private Sub txtBegin_Enter()\n  controlwithfocus = ActiveControl.Name\n  frmCalendar.Show    \n  UserForm1.txtBegin.Value = Calendar1.Value\nEnd Sub\n</code></pre>\n\n<p>Which does not work, it throws an error of </p>\n\n<blockquote>\n  <p>object required</p>\n</blockquote>\n\n<p>Now this syntax is in the calendar code behind and is able to write to a cell problem free.  My issue is I do not want to write to a cell, I want to write to either txtBegin, or txtEnd depending on which text box \"called\" the form calendar to open.</p>\n\n<pre><code>Private Sub Calendar1_DblClick()\n  ActiveCell.Value = Calendar1.Value\n  Unload Me\nEnd Sub\n</code></pre>\n\n<p>How can I modify this in order to have <code>Calendar1.Value</code> write to the \"calling\" text-box and not a cell on the worksheet?</p>\n\n<p><strong>EDIT</strong> <br>And I am using Excel 2013 64 Bit edition</p>\n"}, {"tags": ["excel", "ado", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7200482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b674816bc28b0216545c884b398842aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Samson", "link": "https://stackoverflow.com/users/7200482/mats-samson"}, "edited": false, "score": 0, "creation_date": 1479979337, "post_id": 40767350, "comment_id": 68787524, "body": "Yes, Doug, that&#39;s exactly what I&#39;m asking for. But I&#39;ve very little knowledge in SQL and ADO, the reason why I&#39;m asking for help! As you see there are few lines of code and the spelling is of course what I checked first. The error is trigged at &quot;rec.Open sqlstr, con, adOpenUnspecified, adLockUnspecified. I can&#39;t find any more <b>required</b> parameters for the Open statement."}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1479911998, "creation_date": 1479911998, "answer_id": 40767350, "question_id": 40766915, "link": "https://stackoverflow.com/questions/40766915/write-update-data-via-ado-to-closed-excel-workbook/40767350#40767350", "title": "Write/update data via ADO to closed Excel workbook", "body": "<p>The usual reason for this error is a missing or misspelled value. I would go over the SQL statement specifically and see whats off</p>\n"}, {"comments": [{"owner": {"reputation": 415, "user_id": 6099655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d343b8c6fa75c600166e1b9aa9183a05?s=128&d=identicon&r=PG&f=1", "display_name": "CWilson", "link": "https://stackoverflow.com/users/6099655/cwilson"}, "edited": false, "score": 0, "creation_date": 1483474306, "post_id": 40782767, "comment_id": 70109512, "body": "Exclamation marks would make a difference... but you meant quotation marks, which probably make more of a difference. Good job answering your own question."}], "tags": [], "owner": {"reputation": 31, "user_id": 7200482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b674816bc28b0216545c884b398842aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Samson", "link": "https://stackoverflow.com/users/7200482/mats-samson"}, "is_accepted": false, "score": 1, "last_activity_date": 1479980601, "creation_date": 1479980601, "answer_id": 40782767, "question_id": 40766915, "link": "https://stackoverflow.com/questions/40766915/write-update-data-via-ado-to-closed-excel-workbook/40782767#40782767", "title": "Write/update data via ADO to closed Excel workbook", "body": "<p>I found the fault! The sqlstr should be written:</p>\n\n<pre><code>sqlstr = \"UPDATE [Sheet1$] SET [Number] = \"\"16900\"\" WHERE [ID] = \"\"INum\"\"\"\n</code></pre>\n\n<p>It's the exclamation marks that matters! I don't know why it's required in this way, if the exclamation marks are required to concatenate different parts of the string. But they look to be out of sequence, there's 1 too much in the end!</p>\n"}], "owner": {"reputation": 31, "user_id": 7200482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b674816bc28b0216545c884b398842aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Samson", "link": "https://stackoverflow.com/users/7200482/mats-samson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479980601, "creation_date": 1479910722, "last_edit_date": 1531164843, "question_id": 40766915, "link": "https://stackoverflow.com/questions/40766915/write-update-data-via-ado-to-closed-excel-workbook", "title": "Write/update data via ADO to closed Excel workbook", "body": "<p>I'm trying to change the number in a closed Excel workbook using ADO. I found the below code written in 2015 by L42. But the procedure stops with the error \"No value given for one or more required parameters\". I can't find where something is missing!</p>\n\n<pre><code>Sub ChangeNum()\nDim con As ADODB.Connection, rec As ADODB.Recordset\nDim sqlstr As String, datasource As String\n  Set con = New ADODB.Connection: Set rec = New ADODB.Recordset\n  datasource = \"D:\\DropBox\\TraderShare\\TraderNum.xlsx\"\nDim sconnect As String\n  sconnect = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n             \"Data Source=\" &amp; datasource &amp; \";\" &amp; _\n             \"Extended Properties=\"\"Excel 12.0 Xml;HDR=YES\"\";\"\n  con.Open sconnect\n  sqlstr = \"UPDATE [Sheet1$] SET [Number] = \"\"16900\"\" WHERE [ID] = INum\"\n  rec.Open sqlstr, con, adOpenUnspecified, adLockUnspecified 'adLockOptimistic , adOpenStatic, adLockReadOnly\n  con.Close\n  Set rec = Nothing: Set con = Nothing\nEnd Sub\n</code></pre>\n\n<p>Grateful for any help!</p>\n"}, {"tags": ["excel", "combobox", "userform", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1479913658, "creation_date": 1479913658, "answer_id": 40767926, "question_id": 40766522, "link": "https://stackoverflow.com/questions/40766522/populating-combobox-on-a-second-userform/40767926#40767926", "title": "Populating Combobox on a Second UserForm", "body": "<p>Declare you text.value variables as Public Variables (at the top of the module) and then you can call the values in your combobox assignments. </p>\n"}], "owner": {"reputation": 1, "user_id": 7200425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c2ab43c783352bfb0c7dc7f1ddab72?s=128&d=identicon&r=PG&f=1", "display_name": "V.Shao", "link": "https://stackoverflow.com/users/7200425/v-shao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479913658, "creation_date": 1479909722, "last_edit_date": 1531161705, "question_id": 40766522, "link": "https://stackoverflow.com/questions/40766522/populating-combobox-on-a-second-userform", "title": "Populating Combobox on a Second UserForm", "body": "<p>I've created a <code>Userform</code> that requires the user to fill in a number of text boxes and combo boxes. A portion of the form has a command box that opens a second <code>Userform</code> (Userform 1). I've managed to set it up, but the combo boxes for the second userform won't populate. I'm using the exact same code and reference the same <code>LookupLists</code> (a Excel Worksheet). I've also tried to give the combo box a specific value that I've entered manually (<code>cboSENTPROJ1.Value = 9</code>), but that doesn't work either.</p>\n\n<p>This is the code I have for Initializing <code>UserForm1</code>:</p>\n\n<pre><code>Private Sub UserForm1_Initialize()\n\nDim cPROJ As Range\nSet ws = Worksheets(\"LookupLists\")\n\nFor Each cPROJ In ws.Range(\"Projects\")\n  With Me.cboSENTPROJ1\n     .AddItem cPROJ.Value\n     .List(.ListCount - 1, 1) = cPROJ.Offset(0, 1).Value\n   End With\n Next cPROJ\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1479914105, "creation_date": 1479914105, "answer_id": 40768068, "question_id": 40766347, "link": "https://stackoverflow.com/questions/40766347/change-tab-order-of-some-activex-and-form-controls/40768068#40768068", "title": "Change tab order of some ActiveX and Form Controls", "body": "<p>There isn't a way to do this via the properties (that I'm aware of), but you can always just use the <code>KeyDown</code> event, trap the tab key, and then use <code>.Verb</code> to set focus to where you want.  For example, if you have a CheckBox, a ComboBox, and a TextBox:</p>\n\n<pre><code>Private Sub CheckBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = 9 Then\n        ComboBox1.Verb\n    End If\nEnd Sub\n\nPrivate Sub ComboBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = 9 Then\n        TextBox1.Verb\n    End If\nEnd Sub\n\nPrivate Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = 9 Then\n        CheckBox1.Verb\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5888781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Humon.png?s=128&g=1", "display_name": "holyFackel", "link": "https://stackoverflow.com/users/5888781/holyfackel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1135, "favorite_count": 0, "accepted_answer_id": 40768068, "answer_count": 1, "score": 0, "last_activity_date": 1479914105, "creation_date": 1479909202, "question_id": 40766347, "link": "https://stackoverflow.com/questions/40766347/change-tab-order-of-some-activex-and-form-controls", "title": "Change tab order of some ActiveX and Form Controls", "body": "<p>I have created some <code>text-boxes</code> (<code>ActiveX Controls</code>), <code>checkboxes</code> (<code>Form Controls</code>) and one <code>end-button</code> (<code>Form Controls</code>) in my Worksheet and wanted to <code>tab</code> between them.</p>\n\n<p>How can I achieve that?</p>\n\n<p>Maybe it's only possible with VBA.</p>\n\n<p>Thank you very much in advance for your answers...</p>\n"}, {"tags": ["vba", "excel", "hyperlink", "macros"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1479909374, "post_id": 40766261, "comment_id": 68756887, "body": "well there&#39;s a few questions that you need to answer. Are all the pdf&#39;s in the same folder? IF so this is super easy."}, {"owner": {"reputation": 3, "user_id": 7200328, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XJ_x99yGb2U/AAAAAAAAAAI/AAAAAAAAIv0/msStUKQ2b3o/photo.jpg?sz=128", "display_name": "Mendelyeev Moura", "link": "https://stackoverflow.com/users/7200328/mendelyeev-moura"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1480931793, "post_id": 40766261, "comment_id": 69151948, "body": "Yes, all files are in the same folder!"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1479909420, "creation_date": 1479909420, "answer_id": 40766425, "question_id": 40766261, "link": "https://stackoverflow.com/questions/40766261/macro-to-create-hyperlinks-to-specific-files-on-same-excel-file-folder/40766425#40766425", "title": "Macro to create Hyperlinks to specific files on same excel file folder", "body": "<p>You don't need a macro for this - you can get the filepath information from the <code>CELL</code> function, then build a hyperlink.  Assuming that the file is in cell B2:</p>\n\n<pre><code>=HYPERLINK(CONCATENATE(LEFT(CELL(\"filename\",B2),FIND(\"[\",CELL(\"filename\",B2))-1),B2,\".pdf\"))\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7200328, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XJ_x99yGb2U/AAAAAAAAAAI/AAAAAAAAIv0/msStUKQ2b3o/photo.jpg?sz=128", "display_name": "Mendelyeev Moura", "link": "https://stackoverflow.com/users/7200328/mendelyeev-moura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 994, "favorite_count": 0, "accepted_answer_id": 40766425, "answer_count": 1, "score": 0, "last_activity_date": 1480932019, "creation_date": 1479908932, "question_id": 40766261, "link": "https://stackoverflow.com/questions/40766261/macro-to-create-hyperlinks-to-specific-files-on-same-excel-file-folder", "title": "Macro to create Hyperlinks to specific files on same excel file folder", "body": "<p>I\u00b4m new on VBA coding on excel, and need your help. I have the following problem, for example:</p>\n\n<p>1) On the folder I have the template.xlsx and few archives:</p>\n\n<pre><code>alpha.pdf\nbeta.pdf\ndelta.pdf\ngamma.pdf\n</code></pre>\n\n<p>2) inside template.xlsx I have the columns:</p>\n\n<pre><code>PRICE   FILE     ADDRESS\n1       alpha\n1       beta\n1       delta\n1       gamma\n...     ...     ...\n</code></pre>\n\n<p>3) I want to create a macro to set hyperlink on each cell on Column \"B\" to respective file on folder.</p>\n\n<p>Can I do it with VBA? On the real excel file I have more than 1000 rows.</p>\n"}, {"tags": ["vba", "excel", "autofill"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1479911908, "post_id": 40766203, "comment_id": 68758612, "body": "What problems do you encounter with the code you&#39;ve posted?"}, {"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1479912544, "post_id": 40766203, "comment_id": 68759038, "body": "The problem is the code does not fill the cells below E13."}], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1479912830, "post_id": 40767511, "comment_id": 68759252, "body": "Thanks tjb1. It works perfectly. I will now compare both codes to see what was missing."}, {"owner": {"reputation": 459, "user_id": 6532310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cf1a3d74a483383d895f07192ee6?s=128&d=identicon&r=PG&f=1", "display_name": "tretom", "link": "https://stackoverflow.com/users/6532310/tretom"}, "edited": false, "score": 0, "creation_date": 1479915247, "post_id": 40767511, "comment_id": 68760926, "body": "if you use this solution, I recommend to check (and maybe use) &quot;value2&quot; instead of &quot;value&quot;. (For differences between them, just google it...)"}, {"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1479917490, "post_id": 40767511, "comment_id": 68762447, "body": "Is there any difference in the computation time by using Value2 instead of Value? I went search the difference and it is mainly in Value2 it does not include Date or Currency. Since I am defining the variable type, how does it affect in this solution?"}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1479919136, "post_id": 40767511, "comment_id": 68763583, "body": "If it was formatted as a date in the worksheet it would return a different value using <code>value</code> vs <code>value2</code>."}, {"owner": {"reputation": 459, "user_id": 6532310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cf1a3d74a483383d895f07192ee6?s=128&d=identicon&r=PG&f=1", "display_name": "tretom", "link": "https://stackoverflow.com/users/6532310/tretom"}, "edited": false, "score": 0, "creation_date": 1479972759, "post_id": 40767511, "comment_id": 68783856, "body": "as far as I know it doesn&#39;t depend on your variable type, but on your cell format. e.g.: format cell E5 to currency, then run this macro: <code>Sub test() Dim i As Double     Cells(4, 5).Value = 12.12345     Cells(5, 5).Value = 12.12345     i = Cells(5, 5).Value     Cells(7, 5).Value = i     i = Cells(5, 5).Value2     Cells(8, 5).Value = i End Sub</code> it enters the value 12.12345 into cell E4 and E5. Then it takes the value of cell E5 into a Double variant and then enters <b>value</b> into E7 and <b>value2</b> into E8. You lost precision using <b>value</b>, while you kept it using <b>value2</b>."}], "tags": [], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "is_accepted": false, "score": 0, "last_activity_date": 1479912974, "last_edit_date": 1479912974, "creation_date": 1479912414, "answer_id": 40767511, "question_id": 40766203, "link": "https://stackoverflow.com/questions/40766203/how-to-autofill-multiple-cells-with-a-formula-using-dynamic-range/40767511#40767511", "title": "How to autofill multiple cells with a formula using dynamic range", "body": "<p>This will fill the actual formula into the range and then replace it with the values. I also changed <code>lastrow</code> to long so it can be used in the other lines correctly and pulled the starting row from your range.</p>\n\n<pre><code> Dim StartCellM As Range\n Dim lastRow As Long\n Dim multiplication As Integer\n\n With ThisWorkbook.Sheets(1) \n     multiplication = .Range(\"D4\").Value * .Range(\"D6\").Value\n     countRows = multiplication - 1\n\n     Set StartCellM = .Range(\"E13\")\n     lastRow = StartCellM.Row + countRows\n\n    .Range(\"E13:E\" &amp; lastRow).Formula = \"=D13*(G13-F13)\"\n    .Range(\"E13:E\" &amp; lastRow).Value = .Range(\"E13:E\" &amp; lastRow).Value 'Remove this line to keep formula\n End With\n</code></pre>\n\n<p>The formula will break if you change the row your start cell is on and don't change the row in the formula to match so this code will use the row from <code>StartCellM</code> in the formula instead of hard coding it.</p>\n\n<pre><code>Dim StartCellM As Range\nDim lastRow As Long, startRow As Long\nDim multiplication As Integer\n\nWith ThisWorkbook.Sheets(1)\n    multiplication = .Range(\"D4\").Value * .Range(\"D6\").Value\n    countRows = multiplication - 1\n\n    Set StartCellM = .Range(\"E13\")\n\n    startRow = StartCellM.Row\n    lastRow = startRow + countRows\n\n    .Range(\"E\" &amp; startRow &amp; \":E\" &amp; lastRow).Formula = \"=D\" &amp; startRow &amp; \"*(G\" &amp; startRow &amp; \"-F\" &amp; startRow &amp; \")\"\n    .Range(\"E\" &amp; startRow &amp; \":E\" &amp; lastRow).Value = .Range(\"E\" &amp; startRow &amp; \":E\" &amp; lastRow).Value 'Remove this line to keep formula\nEnd With\n</code></pre>\n\n<p>I also moved everything inside the <code>With</code> so it will pull all the values from the correct sheet.</p>\n"}, {"comments": [{"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1479914194, "post_id": 40767611, "comment_id": 68760223, "body": "tretom, you first define the formula for the starting cell and then you are moving downward the position of cells right? I am really green in programming. I am starting with vba."}, {"owner": {"reputation": 459, "user_id": 6532310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cf1a3d74a483383d895f07192ee6?s=128&d=identicon&r=PG&f=1", "display_name": "tretom", "link": "https://stackoverflow.com/users/6532310/tretom"}, "reply_to_user": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1479915045, "post_id": 40767611, "comment_id": 68760782, "body": "oh sorry, I just forgot to erase your deltaMassFormula. I didn&#39;t use it. You just have to tell the first row and last row, then loop through the rows, and set the formula property of the given cell - in this case cell(i, 2), what could be written as you used it: cell(i, &quot;B&quot;) - to to the string, built on the right side of the equation"}, {"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1479915711, "post_id": 40767611, "comment_id": 68761238, "body": "Understood. Thank you tretom."}], "tags": [], "owner": {"reputation": 459, "user_id": 6532310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cf1a3d74a483383d895f07192ee6?s=128&d=identicon&r=PG&f=1", "display_name": "tretom", "link": "https://stackoverflow.com/users/6532310/tretom"}, "is_accepted": false, "score": 0, "last_activity_date": 1479914712, "last_edit_date": 1479914712, "creation_date": 1479912687, "answer_id": 40767611, "question_id": 40766203, "link": "https://stackoverflow.com/questions/40766203/how-to-autofill-multiple-cells-with-a-formula-using-dynamic-range/40767611#40767611", "title": "How to autofill multiple cells with a formula using dynamic range", "body": "<p>it fills the column B with the formula:</p>\n\n<pre><code>Sub filler()\n\n    Dim i As Long\n    Dim startRow As Long\n    Dim lastRow As Long\n    Dim multiplication As Integer\n\n    multiplication = Cells(4, 4).Value * Cells(6, 4).Value\n\n    startRow = 13\n    lastRow = startRow + multiplication - 1\n\n    For i = startRow To lastRow\n        Cells(i, 2).Formula = \"=D\" &amp; i &amp; \"*(G\" &amp; i &amp; \"-F\" &amp; i &amp; \")\"\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2085, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479914712, "creation_date": 1479908765, "last_edit_date": 1531164843, "question_id": 40766203, "link": "https://stackoverflow.com/questions/40766203/how-to-autofill-multiple-cells-with-a-formula-using-dynamic-range", "title": "How to autofill multiple cells with a formula using dynamic range", "body": "<p>I have one dynamic table that is created based on the multiplication of Cells(4,\"D\") and Cells(6,\"D\") that gives the total number of rows. The column number is fixed and defined from B to G. The first row with data is line 13. </p>\n\n<p>I want to write a formula deltaMassFormula that introduces in column B the following: deltaMassFormula = D13 * (G13 - F13) and automatically it fills down until the countRows equals the total number of rows (multiplication variable) </p>\n\n<p>For instance, if multiplication = 4 then</p>\n\n<p>E13 = D13 * (G13 - F13)</p>\n\n<p>E14 = D14 * (G14 - F14)</p>\n\n<p>E15 = D15 * (G15 - F15)</p>\n\n<p>E16 = D16 * (G16 - F16)</p>\n\n<p><strong>My Code</strong>: </p>\n\n<pre><code> Dim StartCellM As Range    \n Dim lastRow As Long    \n Dim deltaMassFormula As Integer    \n Dim multiplication As Integer\n\n multiplication = Cells(4, \"D\").Value * Cells(6, \"D\").Value    \n countRows = multiplication - 1\n\n Set StartCellM = Cells(13, \"E\")    \n Set lastRow = Cells(13, \"E\") + countRows\n\n deltaMassFormula = Cells(13, \"D\") * (Cells(13, \"G\") - Cells(13, \"F\"))\n\n With ThisWorkbook.Sheets(1)     \n    .Range(\"E13\").Formula = deltaMassFormula    \n    .Range(\"E13:E\" &amp; lastRow).FillDown    \n End With\n</code></pre>\n\n<p>Anyone can help me? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479908273, "post_id": 40765985, "comment_id": 68756145, "body": "try changing <code>ws.Range(ws.Cells(r, 1), Cells(r, 20)).Copy Destination:=ThisWorkbook.Sheets(&quot;SummaryAccrual&quot;).Range(&quot;A&quot; &amp; lr2 + 1)</code>  to : <code>ws.Range(ws.Cells(r, 1), Cells(r, 20)).Copy ThisWorkbook.Sheets(&quot;SummaryAccrual&quot;).Range(&quot;A&quot; &amp; lr2 + 1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7200286, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102385004525608/picture?type=large", "display_name": "Alex Neale", "link": "https://stackoverflow.com/users/7200286/alex-neale"}, "edited": false, "score": 0, "creation_date": 1479911298, "post_id": 40766179, "comment_id": 68758209, "body": "Hi Arcade, You fixed the first problem, thanks!  Do you know how I would get the VBA to just paste the values rather than formulas? I tried the other two suggestions and couldn&#39;t get either to run. (one came up with an error, the other didn&#39;t copy anything)"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 1, "user_id": 7200286, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102385004525608/picture?type=large", "display_name": "Alex Neale", "link": "https://stackoverflow.com/users/7200286/alex-neale"}, "edited": false, "score": 0, "creation_date": 1479914776, "post_id": 40766179, "comment_id": 68760608, "body": "@AlexNeale I edited my post. If user3598756&#39;s answer doesn&#39;t work for you, add a comment and describe the problem :)"}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 0, "last_activity_date": 1479914675, "last_edit_date": 1479914675, "creation_date": 1479908713, "answer_id": 40766179, "question_id": 40765985, "link": "https://stackoverflow.com/questions/40765985/copying-and-pasting-dynamic-ranges-on-vba-error-range-of-object-worksheet/40766179#40766179", "title": "copying and pasting dynamic ranges on VBA, Error: Range of object_worksheet,", "body": "<p>Here's your problem:</p>\n\n<pre><code>ws.Range(ws.Cells(r, 1), Cells(r, 20)).Copy \n</code></pre>\n\n<p>the second <code>Cells</code> has no sheet specified so it will assume you mean the active sheet. If the active sheet is not <code>ws</code> then it will fail because a range can't span multiple sheets. Hence use</p>\n\n<pre><code>ws.Range(ws.Cells(r, 1), ws.Cells(r, 20)).Copy\n</code></pre>\n\n<p>or</p>\n\n<pre><code>With ws\n    .Range(.Cells(r, 1), .Cells(r, 20)).Copy ....\nEnd With\n</code></pre>\n\n<hr>\n\n<p>edit: to paste only values, either just set the <code>.Value</code> property of the range, like user3598756 suggested:</p>\n\n<pre><code>ThisWorkbook.Sheets(\"SummaryAccrual\").Range(\"A\" &amp; lr2 + 1).Resize(1, 20).Value = ws.Range(ws.Cells(r, 1), ws.Cells(r, 20)).Value\n</code></pre>\n\n<p>or use <code>PasteSpecial</code> with the <code>xlPasteValues</code> option:</p>\n\n<pre><code>ws.Range(ws.Cells(r, 1), ws.Cells(r, 20)).Copy\nThisWorkbook.Worksheets(\"SummaryAccrual\").Range(\"A\" &amp; lr2 + 1).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>the first option usually is much faster.</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1479910739, "creation_date": 1479910739, "answer_id": 40766924, "question_id": 40765985, "link": "https://stackoverflow.com/questions/40765985/copying-and-pasting-dynamic-ranges-on-vba-error-range-of-object-worksheet/40766924#40766924", "title": "copying and pasting dynamic ranges on VBA, Error: Range of object_worksheet,", "body": "<p>since you're interested in pasting values only, this should be faster:</p>\n\n<pre><code>Option Explicit\n\nSub AccrualCombiner()\n    Dim Path As String\n    Dim FileName As String\n    Dim Wkb As Workbook\n    Dim ws As Worksheet\n    Dim answer As Integer\n    Dim r As Long\n\n    answer = MsgBox(\"Would you like to combine Accruals for current period?\", vbYesNo + vbQuestion, \"Confirmation\")        \n    If answer = vbYes Then\n        Application.EnableEvents = False\n        Application.ScreenUpdating = False\n        Application.DisplayAlerts = False\n        Application.AskToUpdateLinks = False\n\n        Path = \"C:\\Users\\alexander.neale\\Desktop\\Test\"\n        With ThisWorkbook.Worksheets(\"SummaryAccrual\")\n            FileName = Dir(Path &amp; \"\\*.xls\", vbNormal)\n            Do Until FileName = \"\"\n                Set Wkb = Workbooks.Open(FileName:=Path &amp; \"\\\" &amp; FileName)\n                For Each ws In Wkb.Worksheets\n                    If WorksheetFunction.CountIf(ws.Range(ws.Cells(14, 1), ws.Cells(60, 1)), \"1\") &gt; 0 Then\n                        For r = 14 To 60 Step 1\n                            If ws.Range(\"A\" &amp; r).Value = \"1\" Then\n                                .Cells(.Rows.COUNT, \"A\").End(xlUp).Offset(1).Resize(, 20).Value = ws.Range(ws.Cells(r, 1), ws.Cells(r, 20)).Value\n                            End If\n                        Next r\n                    End If\n                Next ws\n                Wkb.Close False\n                FileName = Dir()\n            Loop\n        End With\n\n        Application.EnableEvents = True\n        Application.ScreenUpdating = True\n        Application.DisplayAlerts = True\n        Application.AskToUpdateLinks = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7200286, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102385004525608/picture?type=large", "display_name": "Alex Neale", "link": "https://stackoverflow.com/users/7200286/alex-neale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479914675, "creation_date": 1479908161, "last_edit_date": 1531164843, "question_id": 40765985, "link": "https://stackoverflow.com/questions/40765985/copying-and-pasting-dynamic-ranges-on-vba-error-range-of-object-worksheet", "title": "copying and pasting dynamic ranges on VBA, Error: Range of object_worksheet,", "body": "<p>I have written/hashed together a programme for copying in a row of data for when the row meets a certain criteria (column A = \"1\") for all workbooks sitting in a test folder on my desktop; the programme worked initially but now pulls up an error here:</p>\n\n<pre><code>ws.Range(ws.Cells(r, 1), Cells(r, 20)).Copy Destination:=ThisWorkbook.Sheets(\"SummaryAccrual\").Range(\"A\" &amp; lr2 + 1)\n</code></pre>\n\n<p>Once this is sorted, I'm also concerned that this method of copying and pasting will paste formulas and not values, is there an easy way to paste values?</p>\n\n<p>Thanks for all your help, I super appreciate it!</p>\n\n<p><strong>My Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub AccrualCombiner()\n\nDim Path As String\nDim FileName As String\nDim Wkb As Workbook\nDim cWkb As Workbook\nDim ws As Worksheet\nDim answer As Integer\nDim lr As Long, lr2 As Long, r As Long\nDim rc As Object\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.AskToUpdateLinks = False\n\nanswer = MsgBox(\"Would you like to combine Accruals for current period?\", vbYesNo + vbQuestion, \"Confirmation\")\n\nIf answer = vbYes Then\n    Set cWkb = Application.ActiveWorkbook\n    lr2 = ThisWorkbook.Sheets(\"SummaryAccrual\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Path = \"C:\\Users\\alexander.neale\\Desktop\\Test\"\n    FileName = Dir(Path &amp; \"\\*.xls\", vbNormal)\n\n    Do Until FileName = \"\"\n\n        Set Wkb = Workbooks.Open(FileName:=Path &amp; \"\\\" &amp; FileName)\n        For Each ws In Wkb.Worksheets\n            For r = 14 To 60 Step 1\n                If ws.Range(\"A\" &amp; r).Value = \"1\" Then\n                    ws.Range(ws.Cells(r, 1), Cells(r, 20)).Copy Destination:=ThisWorkbook.Sheets(\"SummaryAccrual\").Range(\"A\" &amp; lr2 + 1)\n                    lr2 = ThisWorkbook.Sheets(\"SummaryAccrual\").Cells(Rows.Count, \"A\").End(xlUp).Row\n                End If\n            Next r\n        Next ws\n        Wkb.Close False\n        FileName = Dir()\n    Loop\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.AskToUpdateLinks = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba", "decimal-point"], "comments": [{"owner": {"reputation": 1312, "user_id": 2181811, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2390fa3108fe3a63ceafb79cd67452c0?s=128&d=identicon&r=PG", "display_name": "Andrew Magerman", "link": "https://stackoverflow.com/users/2181811/andrew-magerman"}, "edited": false, "score": 0, "creation_date": 1479911560, "post_id": 40765556, "comment_id": 68758382, "body": "your regex is going to select the stuff between the quotes - but you&#39;re saying that&#39;s the bit you don&#39;t want to change. It would be helpful if you could show what you want to do."}, {"owner": {"reputation": 1312, "user_id": 2181811, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2390fa3108fe3a63ceafb79cd67452c0?s=128&d=identicon&r=PG", "display_name": "Andrew Magerman", "link": "https://stackoverflow.com/users/2181811/andrew-magerman"}, "edited": false, "score": 0, "creation_date": 1479911806, "post_id": 40765556, "comment_id": 68758552, "body": "The syntax for the number formatting : <a href=\"https://support.office.com/en-us/article/Create-or-delete-a-custom-number-format-78f2a361-936b-4c03-8772-09fab54be7f4\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a> is pretty general, so you&#39;d need to cover many different cases (i.e. one, two, three or four parameters), check for escaped characters, etc. That doesn&#39;t apply if you control the input, obviously."}, {"owner": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "edited": false, "score": 0, "creation_date": 1479912411, "post_id": 40765556, "comment_id": 68758952, "body": "How about retrieveing the existing number format, and then using Replace(numberFormat, &quot;.0&quot;, &quot;.00&quot;) if you want to increase the number of decimals, and Replace(numberFormat, &quot;.0&quot;, &quot;.&quot;) if you want to decrease, before writing back the edited numberFormat?"}, {"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "reply_to_user": {"reputation": 1312, "user_id": 2181811, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2390fa3108fe3a63ceafb79cd67452c0?s=128&d=identicon&r=PG", "display_name": "Andrew Magerman", "link": "https://stackoverflow.com/users/2181811/andrew-magerman"}, "edited": false, "score": 0, "creation_date": 1479913713, "post_id": 40765556, "comment_id": 68759884, "body": "I&#39;ve added the output of what I want to achieve in the above. @AndrewMagerman I am aware that the current RegEx is no good, I kind of stopped half way to ask the question in here, so apologies for that. With regards to the input, I know that there might be cases that I have not covered in my examples above (note, I added three more odd cases), I am happy."}, {"owner": {"reputation": 1312, "user_id": 2181811, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2390fa3108fe3a63ceafb79cd67452c0?s=128&d=identicon&r=PG", "display_name": "Andrew Magerman", "link": "https://stackoverflow.com/users/2181811/andrew-magerman"}, "edited": false, "score": 0, "creation_date": 1479914470, "post_id": 40765556, "comment_id": 68760399, "body": "how do you want to input the desired number format? Are you reading it from the text string?"}, {"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1479914678, "post_id": 40765556, "comment_id": 68760525, "body": "I want to change the <code>.NumberFormat</code> that is already in the cell."}, {"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1479915318, "post_id": 40765556, "comment_id": 68760972, "body": "This regex is getting pretty close: <code>[\\&quot;].*?[\\&quot;]|(0[\\.0+]?)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "is_accepted": true, "score": 0, "last_activity_date": 1479919108, "creation_date": 1479919108, "answer_id": 40769840, "question_id": 40765556, "link": "https://stackoverflow.com/questions/40765556/macro-to-change-the-number-format-to-a-certain-number-of-decimal-places/40769840#40769840", "title": "Macro to change the number format to a certain number of decimal places", "body": "<p>After spending all afternoon thinking about this, I found an answer that works for all the example formats I've posted above:</p>\n\n<pre><code>Sub ChangeDecimalPoints(sRange As Range, DP As Integer)\nDim sCell As Range, sFmt As String, sNewFmt As String\nDim regEx As New VBScript_RegExp_55.RegExp, arrMatch As Variant, i As Long, arrReplace As Variant\n\nsNewFmt = \"0\" &amp; IIf(DP &gt; 0, \".\", \"\")\nFor i = 1 To DP\n    sNewFmt = sNewFmt &amp; \"0\"\nNext i\n\nFor Each sCell In sRange\n    sFmt = sCell.NumberFormat\n    With regEx\n        .Global = True\n        .ignorecase = True\n        .Pattern = \"[\\\"\"].*?[\\\"\"]|(0\\.?0*)\"\n        If .test(sFmt) Then\n            Set arrMatch = .Execute(sFmt)\n            For i = arrMatch.Count - 1 To 0 Step -1\n                If Not IsEmpty(arrMatch(i).submatches(0)) Then\n                    sFmt = WorksheetFunction.Replace(sFmt, arrMatch(i).FirstIndex + 1, arrMatch(i).Length, sNewFmt)\n                End If\n            Next i\n        End If\n    End With\n    sCell.NumberFormat = sFmt\nNext sCell\nEnd Sub\n</code></pre>\n\n<p>I am not sure if there is a way to get this to work without <code>.submatches</code>, I assume there might be a way using `regEx.Replace(input, \"$match\") but I was too lazy for that and this works just as well.</p>\n"}, {"comments": [{"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1479920638, "post_id": 40770223, "comment_id": 68764553, "body": "I don&#39;t think this would work for simple <code>0.0</code> type number formats. Have you tested it?"}, {"owner": {"reputation": 1312, "user_id": 2181811, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2390fa3108fe3a63ceafb79cd67452c0?s=128&d=identicon&r=PG", "display_name": "Andrew Magerman", "link": "https://stackoverflow.com/users/2181811/andrew-magerman"}, "reply_to_user": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1479920830, "post_id": 40770223, "comment_id": 68764677, "body": "I tested all your examples"}, {"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1479920901, "post_id": 40770223, "comment_id": 68764721, "body": "Yes, but I want this to work on simple examples as well. See my code above. The examples are the worst possible number formats I could come up with. I still want this to work on something as simple as <code>0.00</code> and not change anything if the number format is <code>General</code>."}, {"owner": {"reputation": 1312, "user_id": 2181811, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2390fa3108fe3a63ceafb79cd67452c0?s=128&d=identicon&r=PG", "display_name": "Andrew Magerman", "link": "https://stackoverflow.com/users/2181811/andrew-magerman"}, "reply_to_user": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1479921253, "post_id": 40770223, "comment_id": 68764908, "body": "Then the input conditions stated in your question are not exhaustive. The specification of the number formatting is very flexible."}, {"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1479942334, "post_id": 40770223, "comment_id": 68774912, "body": "I mean fair enough but I stated quite clearly that I want this to work with all kinds of number formats and I have listed examples. I cannot possibly post all kinds of number formats."}], "tags": [], "owner": {"reputation": 1312, "user_id": 2181811, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2390fa3108fe3a63ceafb79cd67452c0?s=128&d=identicon&r=PG", "display_name": "Andrew Magerman", "link": "https://stackoverflow.com/users/2181811/andrew-magerman"}, "is_accepted": false, "score": 0, "last_activity_date": 1479920261, "creation_date": 1479920261, "answer_id": 40770223, "question_id": 40765556, "link": "https://stackoverflow.com/questions/40765556/macro-to-change-the-number-format-to-a-certain-number-of-decimal-places/40770223#40770223", "title": "Macro to change the number format to a certain number of decimal places", "body": "<p>I would go for</p>\n\n<pre><code>(?&lt;=#,##)([^%\"]+)\n</code></pre>\n\n<p>which will match anything betwee #,## and the first quote or % found after that, and puts it in a group.</p>\n\n<p>Then you replace what you get with 0.00.</p>\n"}], "owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 40769840, "answer_count": 2, "score": 0, "last_activity_date": 1479920261, "creation_date": 1479906930, "last_edit_date": 1479913573, "question_id": 40765556, "link": "https://stackoverflow.com/questions/40765556/macro-to-change-the-number-format-to-a-certain-number-of-decimal-places", "title": "Macro to change the number format to a certain number of decimal places", "body": "<p>I am looking to change the number of decimals displayed in a cell using a macro. I want the macro to work with all kinds of custom formats, I have the following examples that I want to properly change:</p>\n\n<pre><code>$ #,##0.00\" Test 0.00\";[Red]$ -#,##0.00\" Test 0.00\"\n$ #,##0.00\" Test 0.00\";[Red]$ -#,##0.00\" Test 0.00\"\n$ #,##0.0000\" Test 0.00\";[Red]$ -#,##0.0000\" Test 0.00\"\n$ #,##0\" Test 0.00\";[Red]$ -#,##0\" Test 0.00\"\n$ #,##0.0000000\" Test 0.00\";[Red]$ -#,##0.0000000\" Test 0.00\"\n$ #,##0%\" Test 0.00\";[Red]8\" Test 0.00\"\n$ #,##0%\" Test 0.00\";[Red]8\" Test 0.00\"\n\"Test 0.0000\"$ #,##0.0000000\" Test 0.00\";[Red]\"Test 0.0000\"$ -#,##0.0000000\" Test 0.00\"\n\"Test 0.0000\"$ #,##0%\" Test 0.00\";[Red]\"Test 0.0000\"8\" Test 0.00\"\n\"Test 0.0000\"$ #,##0%\" Test 0.00\";[Red]\"Test 0.0000\"8\" Test 0.00\"\n</code></pre>\n\n<p>Note, I have used <code>0.00</code> inside quotes. I don't want the script to change this, I want them to stay that way.</p>\n\n<p>I have started a bit using RegEx but I am not sure if this is the right approach:</p>\n\n<pre><code>Sub ChangeDecimalPoints(sRange As Range, DP As Integer)\nDim sCell As Range, sFmt As String\nDim regEx As New VBScript_RegExp_55.RegExp, arrMatch As Variant, i As Long\n\nFor Each sCell In sRange\n    sFmt = sCell.NumberFormat\n    With regEx\n        .Global = True\n        .ignorecase = True\n        .Pattern = \"[^\"\"]+|(0\\.[0]+)\"\n        If .test(sFmt) Then\n            Set arrMatch = .Execute(sFmt)\n            i = 0\n            Do Until i = arrMatch.Count\n                Debug.Print sFmt, arrMatch(i)\n                i = i + 1\n            Loop\n        End If\n    End With\nNext sCell\nEnd Sub\n</code></pre>\n\n<p>Edit:\nTo show an example of how I want it to change, if I run the following (assuming the list above shows the <code>.NumberFormat</code> of <code>Selection</code>):<br>\n<code>ChangeDecimalPoints Selection, 2</code></p>\n\n<p>I want the output of the above to be the following:</p>\n\n<pre><code>$ #,##0.00\" Test 0.00\";[Red]$ -#,##0.00\" Test 0.00\"\n$ #,##0.00\" Test 0.00\";[Red]$ -#,##0.00\" Test 0.00\"\n$ #,##0.00\" Test 0.00\";[Red]$ -#,##0.00\" Test 0.00\"\n$ #,##0.00\" Test 0.00\";[Red]$ -#,##0.00\" Test 0.00\"\n$ #,##0.00\" Test 0.00\";[Red]$ -#,##0.00\" Test 0.00\"\n$ #,##0.00%\" Test 0.00\";[Red]8\" Test 0.00\"\n$ #,##0.00%\" Test 0.00\";[Red]8\" Test 0.00\"\n\"Test 0.0000\"$ #,##0.00\" Test 0.00\";[Red]\"Test 0.0000\"$ -#,##0.00\" Test 0.00\"\n\"Test 0.0000\"$ #,##0.00%\" Test 0.00\";[Red]\"Test 0.0000\"8\" Test 0.00\"\n\"Test 0.0000\"$ #,##0.00%\" Test 0.00\";[Red]\"Test 0.0000\"8\" Test 0.00\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "plot", "charts", "axes"], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 5247192, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-XESaam5JJI8/AAAAAAAAAAI/AAAAAAAAADc/symL3XOVoQg/photo.jpg?sz=128", "display_name": "\u0218tefan Blaga", "link": "https://stackoverflow.com/users/5247192/%c8%98tefan-blaga"}, "edited": false, "score": 0, "creation_date": 1480405683, "post_id": 40810798, "comment_id": 68936353, "body": "It&#39;s a little difficult because first I create chart and after that I read the values and create the series. This code: .Axes(xlValue).MinimumScale = dMinValue     .Axes(xlValue).MaximumScale = dMaxValue  works only when create the chart and not when you create the series."}], "tags": [], "owner": {"reputation": 531, "user_id": 1946796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vd55i.jpg?s=128&g=1", "display_name": "Rafa Barragan", "link": "https://stackoverflow.com/users/1946796/rafa-barragan"}, "is_accepted": false, "score": 1, "last_activity_date": 1480099187, "creation_date": 1480099187, "answer_id": 40810798, "question_id": 40765466, "link": "https://stackoverflow.com/questions/40765466/symmetry-towards-y-axis-in-series-vba-excel/40810798#40810798", "title": "Symmetry towards Y axis in Series VBA Excel", "body": "<p>Hi you could try something like this:</p>\n\n<pre><code>Dim dMinValue as Double, dMaxValue as Double\n\nWith PPSChart\n    dMinValue = application.WorksheetFunction.Min(\"='\" &amp; _\n                    shInfo.Name &amp; \"'!R\" &amp; RowCount - UBound(tests) - 1 _ \n                    &amp; \"C\" &amp; CInt(4 * (col + 1) - 2) &amp; \":R\" &amp; RowCount - 1  _\n                    &amp; \"C\" &amp; CInt(4 * (col + 1) - 2))\n\n    dMaxValue = application.WorksheetFunction.Max(\"='\" &amp; _\n                    shInfo.Name &amp; \"'!R\" &amp; RowCount - UBound(tests) - 1 _ \n                    &amp; \"C\" &amp; CInt(4 * (col + 1) - 2) &amp; \":R\" &amp; RowCount - 1  _\n                    &amp; \"C\" &amp; CInt(4 * (col + 1) - 2))\n    ....\n    .Axes(xlValue).MinimumScale = dMinValue\n    .Axes(xlValue).MaximumScale = dMaxValue\n    ....\nEnd With\n</code></pre>\n\n<p>My advice, you should assign your Series Values to an object for easy use</p>\n\n<pre><code>Dim rSerie as Range\nSet rSerie = Range(\"='\" &amp; _\n                        shInfo.Name &amp; \"'!R\" &amp; RowCount - UBound(tests) - 1 _ \n                        &amp; \"C\" &amp; CInt(4 * (col + 1) - 2) &amp; \":R\" &amp; RowCount - 1  _\n                        &amp; \"C\" &amp; CInt(4 * (col + 1) - 2)))\n\nWith ....\n    dMinValue = Application.WorksheetFunction.Min(rSerie)\n    ....\nEnd with\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15238, "user_id": 1544886, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvwKK.png?s=128&g=1", "display_name": "K Scandrett", "link": "https://stackoverflow.com/users/1544886/k-scandrett"}, "is_accepted": false, "score": 0, "last_activity_date": 1480415807, "creation_date": 1480415807, "answer_id": 40863645, "question_id": 40765466, "link": "https://stackoverflow.com/questions/40765466/symmetry-towards-y-axis-in-series-vba-excel/40863645#40863645", "title": "Symmetry towards Y axis in Series VBA Excel", "body": "<pre><code>Sub AddChartObject()\n    Dim myChtObj As ChartObject\n\n    Set myChtObj = ActiveSheet.ChartObjects.Add _\n        (Left:=100, Width:=375, Top:=75, Height:=225)\n    myChtObj.Chart.SetSourceData Source:=Sheets(\"Sheet1\").Range(\"A3:G14\")\n    myChtObj.Chart.ChartType = xlXYScatterLines\n\n    ' delete random series that might be generated\n    For Each mySeries In myChtObj.Chart.SeriesCollection\n        mySeries.Delete\n    Next mySeries\n\n    ' add series\n    Set mySeries = myChtObj.Chart.SeriesCollection.NewSeries\n    mySeries.XValues = Array(0, 300)\n    mySeries.Values = Array(88, 65)\n\n    ' rescale axis after adding series\n    With myChtObj.Chart.Axes(xlCategory) ' otherwise can use ActiveSheet.ChartObjects(1).Chart.Axes(xlCategory)\n        .MinimumScale = -350 'ActiveSheet.Range(\"C33\").Value\n        .MaximumScale = 350 'ActiveSheet.Range(\"D54\").Value\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/lA9SF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lA9SF.png\" alt=\"symmetrical horizontal axis\"></a></p>\n"}], "owner": {"reputation": 404, "user_id": 5247192, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-XESaam5JJI8/AAAAAAAAAAI/AAAAAAAAADc/symL3XOVoQg/photo.jpg?sz=128", "display_name": "\u0218tefan Blaga", "link": "https://stackoverflow.com/users/5247192/%c8%98tefan-blaga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1480415807, "creation_date": 1479906646, "last_edit_date": 1479909844, "question_id": 40765466, "link": "https://stackoverflow.com/questions/40765466/symmetry-towards-y-axis-in-series-vba-excel", "title": "Symmetry towards Y axis in Series VBA Excel", "body": "<p>I have plot done some plots using Chart object and SeriesCollection.NewSeries\nThe portion of the code is like this</p>\n\n<pre><code>Private Function AddSeriesAndFormats(PPSChart As Chart, shInfo As Worksheet, tests() As PPS_Test, RowCount As Integer, col As Integer, smoothLine As Boolean, lineStyle As String, transparency As Integer, lineWidth As Single, ByRef position As Integer) As Series\n\nDim mySeries As Series\n\nSet mySeries = PPSChart.SeriesCollection.NewSeries\nWith mySeries\n    .Name = tests(0).GetString()\n    .XValues = \"='\" &amp; shInfo.Name &amp; \"'!R\" &amp; RowCount - UBound(tests) - 1 &amp; \"C\" &amp; CInt(4 * (col + 1) - 2) &amp; \":R\" &amp; RowCount - 1 &amp; \"C\" &amp; CInt(4 * (col + 1) - 2)\n    .Values = \"='\" &amp; shInfo.Name &amp; \"'!R\" &amp; RowCount - UBound(tests) - 1 &amp; \"C\" &amp; CInt(4 * (col + 1) - 1) &amp; \":R\" &amp; RowCount - 1 &amp; \"C\" &amp; CInt(4 * (col + 1) - 1)\n    .Smooth = smoothLine\n    .Format.line.Weight = lineWidth\n    .Format.line.DashStyle = GetLineStyle(lineStyle)\n    .Format.line.transparency = CSng(transparency / 100)\n    .MarkerStyle = SetMarkerStyle(position)\n    .MarkerSize = 9\n    .MarkerForegroundColorIndex = xlColorIndexNone\nEnd With\n\nSet AddSeriesAndFormats = mySeries\n\nEnd Function\n</code></pre>\n\n<p>and the PPSChart is created like this</p>\n\n<pre><code>Private Function AddChartAndFormatting(chartName As String, chartTitle As String, integralBuffer As Integer, algoPropertyName As String) As Chart\n\nDim PPSChart As Chart, mySeries As Series\n\nSet PPSChart = Charts.Add\nWith PPSChart\n    .Name = chartName\n    .HasTitle = True\n    .chartTitle.Characters.Text = chartTitle\n    .ChartType = xlXYScatterLines\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    If algoPropertyName &lt;&gt; \"\" Then 'case for Generic PPS plots\n        .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = algoPropertyName\n    Else\n        .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"PL/PR max(avg_\" &amp; integralBuffer &amp; \"ms) [mbar]\" 'case for the bumper obsolate algorithm\n    End If\n    .Axes(xlCategory, xlPrimary).AxisTitle.Text = \"Bumper Position [mm]\"\nEnd With\n\n' delete random series that might be generated\nFor Each mySeries In PPSChart.SeriesCollection\n    mySeries.Delete\nNext mySeries\n\nSet AddChartAndFormatting = PPSChart\n\nEnd Function\n</code></pre>\n\n<p>An example of the result is like in this picture below\n<a href=\"https://i.stack.imgur.com/aRXZX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aRXZX.jpg\" alt=\"enter image description here\"></a>\nWhat I want is to have the X axis starting from -350, even that I do not have values in the left side of the Y axis (in the negative side). Practically, what I want to have is the Y axis in the middle, even if the plotted values are positive (symmetry between maximum X value and minimum X value towards Y axis). \nCan You tell me if it is possible and give me some examples? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1479905796, "post_id": 40765134, "comment_id": 68754421, "body": "Will the string always be &quot;BPV/&quot; and have the number at the end with nothing else?"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1479906070, "post_id": 40765134, "comment_id": 68754618, "body": "How is your code not working?"}, {"owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "edited": false, "score": 0, "creation_date": 1479906504, "post_id": 40765134, "comment_id": 68754897, "body": "string will remain the same."}, {"owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "edited": false, "score": 0, "creation_date": 1479906517, "post_id": 40765134, "comment_id": 68754905, "body": "the code is not generating the next serial number"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 1, "creation_date": 1479906535, "post_id": 40765134, "comment_id": 68754918, "body": "Will the last row always have the highest number?"}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1479906664, "post_id": 40765134, "comment_id": 68755011, "body": "Are you entering <code>BPV&#47;#</code> into column B as you create them or are they already there?"}, {"owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "edited": false, "score": 0, "creation_date": 1479907490, "post_id": 40765134, "comment_id": 68755591, "body": "The last will always have the highest number"}, {"owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "edited": false, "score": 0, "creation_date": 1479907516, "post_id": 40765134, "comment_id": 68755609, "body": "No i have to create"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479908082, "post_id": 40765134, "comment_id": 68756017, "body": "@Salman Khan try the code in my answer below"}], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1479907562, "creation_date": 1479907562, "answer_id": 40765786, "question_id": 40765134, "link": "https://stackoverflow.com/questions/40765134/code-to-generate-a-sequential-range/40765786#40765786", "title": "Code to Generate a Sequential Range", "body": "<p>You could enter this <code>FormulaArray</code> in <code>Sheet1</code> let's say in <code>A1</code>:</p>\n\n<pre><code>=MAX(VALUE(SUBSTITUTE(B:B,\"BPV/\",\"\")))\n</code></pre>\n\n<p>Then have this line pointing to that cell:</p>\n\n<pre><code>NextNum = Worksheets(\"Sheet1\").Range(\"A1\").value2\n</code></pre>\n\n<ul>\n<li>FormulaArrays are entered pressing* <code>[Ctrl]</code> <em>+</em> <code>[Shift]</code> <em>+</em> <code>[Enter]</code> <em>simultaneously, you shall see</em> <code>{</code> <em>and</em> <code>}</code> <em>around the formula if entered correctly</em></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "edited": false, "score": 0, "creation_date": 1479911259, "post_id": 40765893, "comment_id": 68758180, "body": "Shai, it gives an error if i place a heading in column B i.e. Voucher #. KIndly advise how to fix."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "edited": false, "score": 0, "creation_date": 1479911419, "post_id": 40765893, "comment_id": 68758292, "body": "@SalmanKhan try edited code, start the <code>For</code> loop from row 2 instead of 1"}, {"owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "edited": false, "score": 0, "creation_date": 1479912043, "post_id": 40765893, "comment_id": 68758717, "body": "ReDim myArr(2 To LastRow)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "edited": false, "score": 0, "creation_date": 1479913410, "post_id": 40765893, "comment_id": 68759670, "body": "@SalmanKhan I just ran the code above, worked nicely, Can you upload a screen-shot of &quot;sheet1&quot; to your post ? maybe I am missing something"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "edited": false, "score": 0, "creation_date": 1479914675, "post_id": 40765893, "comment_id": 68760524, "body": "I meant a screen shot of Sheet1 with the data,  not the user form"}, {"owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "edited": false, "score": 0, "creation_date": 1479916091, "post_id": 40765893, "comment_id": 68761484, "body": "@ Shai It doesn&#39;t gives an error when there is data in row 2. It only gives error when there is no data in row 2..."}, {"owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "edited": false, "score": 0, "creation_date": 1479916355, "post_id": 40765893, "comment_id": 68761679, "body": "@ Shai i resolved the issue by editing the following lines       ReDim myArr(1 To LastRow)     &#39; read all cells contents and convert them to array of numbers     For lRow = 2 To LastRow"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1479918868, "last_edit_date": 1479918868, "creation_date": 1479907872, "answer_id": 40765893, "question_id": 40765134, "link": "https://stackoverflow.com/questions/40765134/code-to-generate-a-sequential-range/40765893#40765893", "title": "Code to Generate a Sequential Range", "body": "<p>In order to find the <code>Max</code> value in Column B , that consists of <code>String</code>s, I am reading the strings into an array on type <code>Long</code> (in case you have very large numbers), using the <code>Mid</code> function. Afterwards, I can find the <code>Max</code> value in the array of numbers.</p>\n\n<p>Conveting using the <code>Mid</code> function is done with the following line:</p>\n\n<pre><code>myArr(lRow) = CLng(Mid(.Cells(lRow, 2), 5))\n</code></pre>\n\n<p>the value 5 is calculated by <code>Len(prefix) +1</code></p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub UserForm_Initialize()\n\nDim NextNum As Long, prefix As String\nDim LastRow As Long, lRow As Long\nDim myArr() As Long\n\nprefix = \"BPV/\"\n\nWith Sheets(\"Sheet1\")\n    'find last row with data in Column B\n    LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n    ReDim myArr(2 To LastRow)\n    ' read all cells contents and convert them to array of numbers\n    ' start from 2nd row , 1st row has headers\n    For lRow = 2 To LastRow\n        If Mid(.Cells(lRow, 2), 5) &lt;&gt; \"\" Then\n            myArr(lRow) = CLng(Mid(.Cells(lRow, 2), 5))\n        End If\n    Next lRow\n\n    ' find maximum value in array\n    NextNum = WorksheetFunction.Max(myArr)\nEnd With\n\nMe.TextBox2.Enabled = False\nMe.TextBox2.Value = prefix &amp; NextNum + 1\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2zBza.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2zBza.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1480116608, "creation_date": 1480116608, "answer_id": 40813424, "question_id": 40765134, "link": "https://stackoverflow.com/questions/40765134/code-to-generate-a-sequential-range/40813424#40813424", "title": "Code to Generate a Sequential Range", "body": "<p>This solutions uses the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193019.aspx\" rel=\"nofollow noreferrer\">Application.Evaluate Method (Excel)</a> to obtain the Last Voucher number at once avoiding the use of <code>For...Next</code>. It also uses constants <em>(<code>Const</code>)</em> to hold the Prefix and the <code>MAX</code> formula.</p>\n\n<pre><code>Private Sub UserForm_Initialize_EEM_Publish()\nConst kPrefix As String = \"BPV/\"\nConst kFml As String = \"=MAX(IFERROR(1\" &amp; _\n    \"*VALUE(SUBSTITUTE(#rTrg,\"\"#Prefix\"\",\"\"\"\"))\" &amp; _\n    \"*(SEARCH(\"\"#Prefix\"\",#rTrg)),0))\"\nDim rTrg As Range, sFml As String\nDim lNextNum As Long, l As Long\n\n    Rem Get Last Voucher Number\n    With ThisWorkbook.Worksheets(\"Sheet1\").Columns(\"B\")\n        Set rTrg = .Cells(1).Resize(.Cells(.Rows.Count).End(xlUp).Row)\n    End With\n    sFml = kFml\n    sFml = Replace(sFml, \"#Prefix\", kPrefix)\n    sFml = Replace(sFml, \"#rTrg\", rTrg.Address(, , , 1))\n    lNextNum = Application.Evaluate(sFml)\n\n    Rem Set Next Voucher Number\n    l = 1 + lNextNum\n    Me.TextBox2.Enabled = False\n    Me.TextBox2.Value = sPrefix &amp; i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 40765893, "answer_count": 3, "score": -1, "last_activity_date": 1480116608, "creation_date": 1479905676, "last_edit_date": 1531161705, "question_id": 40765134, "link": "https://stackoverflow.com/questions/40765134/code-to-generate-a-sequential-range", "title": "Code to Generate a Sequential Range", "body": "<p>I have a userform whose image is below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/x9wL1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x9wL1.png\" alt=\"enter image description here\"></a></p>\n\n<p>What i need is when i open the userform, there should be sequential number against voucher # textbox.</p>\n\n<p>for example.\nColumn B has values BPV/1, BPV/2, BPV/3.\nWhat i need is when i run the userform, the voucher # textbox should show the next serial number i.e. BPV/4 and so on...</p>\n\n<p>Below is my code.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim NextNum As Long, prefix As String\nDim i As Long\n\nprefix = \"BPV/\"\nNextNum = Application.WorksheetFunction.Max(Worksheets(\"Sheet1\").Columns(2))\ni = NextNum + 1\n\nMe.TextBox2.Enabled = False\nMe.TextBox2.Value = prefix &amp; i\n\nEnd Sub\n</code></pre>\n\n<p>Kindly review the code and advise how to achieve it.</p>\n\n<p>Thanks\nSalman Khan</p>\n"}, {"tags": ["vba", "excel", "object"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1479906042, "post_id": 40765125, "comment_id": 68754598, "body": "define <code>FindRowNumber</code> As <code>Long</code>, so <code>FindRowNumber As Double</code> sould be also <code>FindRowNumber As Long</code>"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1479906139, "post_id": 40765125, "comment_id": 68754661, "body": "<a href=\"https://stackoverflow.com/search?q=%22Object+variable+or+with+block+variable+not+set%22\">stackoverflow.com/&hellip;</a>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1479906213, "post_id": 40765125, "comment_id": 68754713, "body": "you also need to trap the case the <code>Find</code> was unsuccesful, with <code>If Not FindRow is Nothing Then</code>"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1479908557, "post_id": 40765125, "comment_id": 68756348, "body": "FindRow should be declared as a Range also."}], "answers": [{"comments": [{"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 2, "creation_date": 1479906779, "post_id": 40765230, "comment_id": 68755103, "body": "Why, when the error occurs one line later? If that was the problem, the error would occur on the line where <code>ScTotalWs</code> is used, wouldn&#39;t it?"}, {"owner": {"reputation": 11, "user_id": 7200064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0c8f85fcbd0940dc38fb593bfb335c?s=128&d=identicon&r=PG&f=1", "display_name": "Miwiph", "link": "https://stackoverflow.com/users/7200064/miwiph"}, "edited": false, "score": 0, "creation_date": 1479908353, "post_id": 40765230, "comment_id": 68756198, "body": "I don&#39;t think this is the problem, as I have defined all worksheets in a different module."}, {"owner": {"reputation": 151, "user_id": 5257520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153534737047192/picture?type=large", "display_name": "snibbo", "link": "https://stackoverflow.com/users/5257520/snibbo"}, "reply_to_user": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1479909514, "post_id": 40765230, "comment_id": 68756967, "body": "@Tomalak you are right, my bad, did not read the last sentence :-("}], "tags": [], "owner": {"reputation": 151, "user_id": 5257520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153534737047192/picture?type=large", "display_name": "snibbo", "link": "https://stackoverflow.com/users/5257520/snibbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1479905957, "creation_date": 1479905957, "answer_id": 40765230, "question_id": 40765125, "link": "https://stackoverflow.com/questions/40765125/vba-object-variable-or-with-block/40765230#40765230", "title": "VBA Object variable or with block", "body": "<p>Probably, you need to define \"ScTotalWs\".</p>\n\n<pre><code>Set ScTotalWs = ThisWorkbook.Worksheets(\"Table1\")\n</code></pre>\n\n<p>Of course,  you need to Change [Table1] according to your file.</p>\n"}, {"tags": [], "owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "is_accepted": false, "score": 1, "last_activity_date": 1479906133, "last_edit_date": 1592644375, "creation_date": 1479906133, "answer_id": 40765297, "question_id": 40765125, "link": "https://stackoverflow.com/questions/40765125/vba-object-variable-or-with-block/40765297#40765297", "title": "VBA Object variable or with block", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\"><code>Range.Find()</code> method</a> is not guaranteed to return anything (logical, if you think about it). The documentation states clearly:</p>\n<blockquote>\n<h3>Remarks</h3>\n<p>This method returns <code>Nothing</code> if no match is found.</p>\n</blockquote>\n<p>Never use the result of such a method call without checking that it is valid.</p>\n<pre><code>Set FindRow = ScTotalWs.Range(&quot;AF10:AF47&quot;).Find(What:=&quot;Grand Total&quot;, LookIn:=xlValues)\n\nIf Not FindRow Is Nothing Then\n    Lastrow = FindRow.Row - 1\n    ' etc\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1479920514, "post_id": 40767308, "comment_id": 68764473, "body": "This would still fail if <code>.Find()</code> would return <code>Nothing</code>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 1, "creation_date": 1479928983, "post_id": 40767308, "comment_id": 68769119, "body": "@Tomalak, it can&#39;t since there&#39;s the previous check with CountIf() to make it sure there&#39;s at least one occurrence of the wanted value"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1479931536, "post_id": 40767308, "comment_id": 68770376, "body": "Ah, I missed that. Should have been made explicit, as Find() usally calls for result verification."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1479933893, "post_id": 40767308, "comment_id": 68771542, "body": "@Tomalak, I wrote it quite clearly right before typing in the code"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1479934397, "post_id": 40767308, "comment_id": 68771771, "body": "Oh well. Of course you did. The upvote was mine, so there is not much else I csn do."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1479934788, "post_id": 40767308, "comment_id": 68771964, "body": "@Tomalak, thank you for upvote. I didn&#39;t mean to ask you for anything. I just commented after you because my understanding was you didn&#39;t notice my explicit explanation about CountIf() making the check of Find() result against Nothing unnecessary."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1479911900, "creation_date": 1479911900, "answer_id": 40767308, "question_id": 40765125, "link": "https://stackoverflow.com/questions/40765125/vba-object-variable-or-with-block/40767308#40767308", "title": "VBA Object variable or with block", "body": "<p><code>Find()</code> method of <code>Range</code> object has a subtle trap in that it assumes for some parameters, if not explicitly declared, their <em>last</em> value, with <em>last</em> being   their values used during the last use of that method, even if from Excel UI!</p>\n\n<p>so you'd better always explicitly specify all those parameters and assure you're actually searching as you want it to be done:</p>\n\n<pre><code>Set FindRow = ScTotalWs.Range(\"AF10:AF47\").Find(What:=\"Grand Total\", LookIn:=xlValues, lookat:=xlPart, MatchCase:=False)\n</code></pre>\n\n<p>but you could also avoid the setting and checking against <code>Nothing</code> of the <code>Range</code> object returned by the <code>Range</code> object <code>Find()</code> method by using <code>WorksheetFunction.CountIf()</code> function, as follows:</p>\n\n<pre><code>Sub Update_All_Graphs()\n    Dim Lastrow As Long\n\n    With ScTotalWs.Range(\"AF10:AF47\") '&lt;--| reference relevant range of wanted worksheet\n        If WorksheetFunction.CountIf(.Cells, \"Grand Total\") &gt; 0 Then '&lt;--| if there's at least one occurrence of \"Grand Total\"\n            Lastrow = .Find(What:=\"Grand Total\", LookIn:=xlValues, lookat:=xlPart, MatchCase:=False).row - 1 '&lt;--| set your 'LastRow'\n            With .Parent '&lt;--| reference the parent worksheet of referenced range, for all subsequent ranges references\n                .ChartObjects(\"1_EOST\").Activate\n                ActiveChart.SeriesCollection(1).Select\n                ActiveChart.SetSourceData source:=.Range(\"AJ10:AJ\" &amp; Lastrow &amp; \", AK10:AK\" &amp; Lastrow &amp; \", AL10:AL\" &amp; Lastrow)\n            End With\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7200064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0c8f85fcbd0940dc38fb593bfb335c?s=128&d=identicon&r=PG&f=1", "display_name": "Miwiph", "link": "https://stackoverflow.com/users/7200064/miwiph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1479911900, "creation_date": 1479905661, "last_edit_date": 1531164843, "question_id": 40765125, "link": "https://stackoverflow.com/questions/40765125/vba-object-variable-or-with-block", "title": "VBA Object variable or with block", "body": "<p>I keep getting the </p>\n\n<blockquote>\n  <p>Object variable or with block variable not</p>\n</blockquote>\n\n<p>set error even though I have defined all variables. I know there are plenty of other questions regarding this being asked here, however non of them seem to help me. </p>\n\n<p>I am simply trying to update a number of graphs. I have used the code before in other workbooks, which is why i cannot find the error. </p>\n\n<pre><code>Sub Update_All_Graphs()\n    Call SETWorksheets\n\n    Dim Lastrow As Long\n    Dim ShName As String\n    Dim FindRow, FindRowNumber As Double\n\n    Set FindRow = ScTotalWs.Range(\"AF10:AF47\").Find(What:=\"Grand Total\", LookIn:=xlValues)\n    FindRowNumber = FindRow.Row\n    Lastrow = FindRowNumber - 1\n\n    ScTotalWs.ChartObjects(\"1_EOST\").Activate\n    ActiveChart.SeriesCollection(1).Select\n    ActiveChart.SetSourceData Source:=Range(\"AJ10:AJ\" &amp; Lastrow &amp; \", AK10:AK\" &amp; Lastrow &amp; \", AL10:AL\" &amp; Lastrow)\nEnd Sub\n</code></pre>\n\n<p>The error shows up on the <code>FindrowNumber = FindRow.row</code> line. </p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1479906507, "post_id": 40764776, "comment_id": 68754899, "body": "As a quick sidenote - you might want to change <code>finalRow</code> and <code>i</code> to a <code>Long</code> instead of an <code>Integer</code>. That tends to be a run-time error waiting to happen."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1479907211, "post_id": 40764776, "comment_id": 68755418, "body": "When you say &quot;something goes wrong&quot; do you mean it&#39;s throwing an error or just not functioning as expected?"}, {"owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1479907756, "post_id": 40764776, "comment_id": 68755801, "body": "There is no error. Just this: although scenarios 1 and 2 keep on working, whenever I search for a country on which I know there are entries for &quot;Category&quot; and &quot;Subcategory&quot;, the script prompts scenario 4 as if there were no matches for that &quot;Country&quot;, &quot;Category&quot; and &quot;Subcategory&quot;. Thank you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "edited": false, "score": 1, "creation_date": 1479909541, "post_id": 40764776, "comment_id": 68756985, "body": "Another quick side note - you are copying your column headers into the results sheet inside the iteration (under your IF statement in scenario 3). If you are finding multiple rows that meet your criteria it might slow your code down somewhat as its only necessary to do once. Just a thought :)"}, {"owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1479909595, "post_id": 40764776, "comment_id": 68757022, "body": "Good point! Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1479909260, "post_id": 40766175, "comment_id": 68756815, "body": "Still does not work. Scenarios 1,2 and 3 started working when I changed what you suggested and scenario 4 just returns the &quot;Results&quot; sheet blank instead of the <code>MsgBox</code>."}, {"owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1479909284, "post_id": 40766175, "comment_id": 68756830, "body": "Yes, scenario 3 accounts for the event that &quot;Category&quot; and &quot;Subcategory&quot; are blank."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1479909313, "post_id": 40766175, "comment_id": 68756845, "body": "Well if three already accounts for it, why are you spinning your wheels?"}, {"owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1479909461, "post_id": 40766175, "comment_id": 68756942, "body": "Because in scenario 4 &quot;Category&quot; and &quot;Subcategory&quot; are not left blank. Rather, they are filled in by the user but the database just does not have any matches for the combination of that specific &quot;Country&quot; and &quot;Category&quot; and/or &quot;Subcategory&quot;."}, {"owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1479911208, "post_id": 40766175, "comment_id": 68758146, "body": "Sorry, I don&#39;t think I am understanding. Where should I put the first bit of code?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1479911513, "post_id": 40766175, "comment_id": 68758358, "body": "underneath the first FIND() method."}, {"owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1479912663, "post_id": 40766175, "comment_id": 68759125, "body": "Still the same. Scenario 4 returns a blank &quot;Results&quot; sheet. but if I have understood correctly, in your suggestion, the script looks for a &quot;Category&quot; independently of the &quot;Country&quot;, i.e., it does not look for the &quot;Category&quot; only in the country searched but in the total range of categories. Right?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1479913159, "post_id": 40766175, "comment_id": 68759497, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/128841/discussion-between-doug-coats-and-franciscofcosta\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1479914528, "last_edit_date": 1479914528, "creation_date": 1479908705, "answer_id": 40766175, "question_id": 40764776, "link": "https://stackoverflow.com/questions/40764776/if-elseif-statements-in-excel-vba/40766175#40766175", "title": "IF ElseIF statements in Excel VBA", "body": "<pre><code>Private Sub SearchButton_Click()\n\nDim country As String 'Search query category user-inputted\nDim Category As String 'Search query category user-inputted\nDim Subcategory As String 'Search query category user-inputted\nDim finalrow As Integer\nDim LastRowForTable As Long 'Last filled row in Results table\nDim i As Integer 'row counter\nDim ws As Worksheet\n\nSet ws = Sheets(\"Database\")\n\n'Erase any entries from the Results sheet\nSheets(\"Results\").Range(\"B10:J200000\").ClearContents\n\n'Define the user-inputed variables\ncountry = Sheets(\"Results\").Range(\"D5\").Value\nCategory = Sheets(\"Results\").Range(\"D6\").Value\nSubcategory = Sheets(\"Results\").Range(\"D7\").Value\nfinalrow = Sheets(\"Database\").Range(\"A200000\").End(xlUp).Row\n\n'If statement for search    \nWith Worksheets(\"Database\")\n    Set c = .Range(\"A:A\").Find(What:=country, After:=.Cells(1, 1), _\n            LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, _\n            SearchDirection:=xlNext, MatchCase:=False)\n    If Not c Is Nothing Then\n    Else\n        MsgBox \"Unfortunately, the database does not have any sources for information in \" &amp; country &amp; \". Please search for sources in relating to another country.\"\n        Sheets(\"Results\").Range(\"D5\").ClearContents\n        Sheets(\"Results\").Range(\"D6\").ClearContents\n        Sheets(\"Results\").Range(\"D7\").ClearContents\n        Exit Sub\n    End If\nEnd With\n\n'If the country field is left empty, there is no need to even run a search\nIf country = \"\" Then\n    Sheets(\"Results\").Range(\"B10:J200000\").Clear\n    MsgBox \"You must select a country in order to search the database. Please do so in the drop-down list provided.\"\n    Sheets(\"Results\").Range(\"D5\").ClearContents\n    Sheets(\"Results\").Range(\"D6\").ClearContents\n    Sheets(\"Results\").Range(\"D7\").ClearContents\n    Exit Sub\nEnd If\n\nFor i = 2 To finalrow\n\n    'If the country field is filled in and there results from the search made\n    If Sheets(\"Database\").Cells(i, 1) = country And _\n        (Sheets(\"Database\").Cells(i, 3) = Category Or Category = \"\") And _\n        (Sheets(\"Database\").Cells(i, 4) = Subcategory Or Subcategory = \"\") Then\n\n        'Copy the headers of the \"Database\" sheet\n        With Sheets(\"Database\")\n            .Range(\"A1:I1\").Copy\n        End With\n        Sheets(\"Results\").Range(\"B10:J10\").PasteSpecial\n\n        'Copy the rows of the table that match the search query\n        With Sheets(\"Database\")\n            .Range(.Cells(i, 1), .Cells(i, 9)).Copy\n        End With\n        Sheets(\"Results\").Range(\"B20000\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n\n    ElseIf Sheets(\"Database\").Cells(i, 1) = country And _\n        (Sheets(\"Database\").Cells(i, 3) &lt;&gt; Category) Then\n\n        Dim question As Integer\n        question = MsgBox(\"Unfortunately, the Database has no sources regarding \" &amp; Category &amp; \" in \" &amp; country &amp; \". Would you perhaps want to broaden your search and see all sources regarding \" &amp; country &amp; \"?\", vbYesNo + vbQuestion, \"Empty Sheet\")\n\n        MsgBox question\n        If question = vbYes Then\n            Sheets(\"Results\").Range(\"D6\").ClearContents\n            Sheets(\"Results\").Range(\"D7\").ClearContents\n            Category = Sheets(\"Results\").Range(\"D6\").Value\n            Subcategory = Sheets(\"Results\").Range(\"D7\").Value\n            If Sheets(\"Database\").Cells(i, 1) = country And _\n                (Sheets(\"Database\").Cells(i, 3) = Category Or Category = \"\") And _\n                (Sheets(\"Database\").Cells(i, 4) = Subcategory Or Subcategory = \"\") Then\n\n                'Copy the headers of the \"Database\" sheet\n                    With Sheets(\"Database\")\n                        .Range(\"A1:I1\").Copy\n                    End With\n                    Sheets(\"Results\").Range(\"B10:J10\").PasteSpecial\n\n                        'Copy the rows of the \"Database\" that match the search query\n                    With Sheets(\"Database\")\n                        .Range(.Cells(i, 1), .Cells(i, 9)).Copy\n                    End With\n                    Sheets(\"Results\").Range(\"B20000\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n            End If\n        Else\n            Sheets(\"Results\").Range(\"D5\").ClearContents\n            Sheets(\"Results\").Range(\"D6\").ClearContents\n            Sheets(\"Results\").Range(\"D7\").ClearContents\n            Exit Sub\n        End If\n\n    End If\n\nNext i\n\n'Hides search form\nMe.Hide\n\n'Toggle Results sheet\nSheets(\"Results\").Activate\n\nEnd Sub\n</code></pre>\n\n<p>Ok what i did:</p>\n\n<p>Stopped the end of sub and recalling. </p>\n\n<p>Stuck scenario 3 in the if msgbox=yes clause. This of course requires that we reset category and subcategory to blank, which I also did. </p>\n"}], "owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 886, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1479914528, "creation_date": 1479904620, "last_edit_date": 1479905530, "question_id": 40764776, "link": "https://stackoverflow.com/questions/40764776/if-elseif-statements-in-excel-vba", "title": "IF ElseIF statements in Excel VBA", "body": "<p>I am trying to write a script for a country-based Database search. The search is ran on a sheet full of data called \"Database\" and the results pasted to a different sheet called \"Results\".</p>\n\n<p>The search is dependent on user-inputted variables, which I have defined as \"Country\", \"Category\" and \"Subcategory\":</p>\n\n<pre><code>country = Sheets(\"Results\").Range(\"D5\").Value\nCategory = Sheets(\"Results\").Range(\"D6\").Value\nSubcategory = Sheets(\"Results\").Range(\"D7\").Value\nfinalrow = Sheets(\"Database\").Range(\"A200000\").End(xlUp).Row\n</code></pre>\n\n<p>I want the search criteria filled in by the user through a <code>UserForm</code> to lead to different scenarios. As such:</p>\n\n<p>1 - If the user  searches for a country that is not included in the database, the search will not run and a message saying so will pop up. I used a <code>.Find</code> function to so:</p>\n\n<pre><code>With Worksheets(\"Database\")\n        Set c = .Range(\"A:A\").Find(What:=country, After:=.Cells(1, 1), _\n                LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, _\n                SearchDirection:=xlNext, MatchCase:=False)\n        If Not c Is Nothing Then\n        Else\n            MsgBox \"Unfortunately, the database does not have any sources for information in \" &amp; country &amp; \". Please search for sources in relating to another country.\"\n            Sheets(\"Results\").Range(\"D5\").ClearContents\n            Sheets(\"Results\").Range(\"D6\").ClearContents\n            Sheets(\"Results\").Range(\"D7\").ClearContents\n            Exit Sub\n        End If\n    End With\n</code></pre>\n\n<p>2- If the user does not produce a name of a country to search for, the search will not run. I used an <code>IF</code> statement to do so:</p>\n\n<pre><code>If country = \"\" Then\n        Sheets(\"Results\").Range(\"B10:J200000\").Clear\n        MsgBox \"You must select a country in order to search the database. Please do so in the drop-down list provided.\"\n        Sheets(\"Results\").Range(\"D5\").ClearContents\n        Sheets(\"Results\").Range(\"D6\").ClearContents\n        Sheets(\"Results\").Range(\"D7\").ClearContents\n        Exit Sub\n    End If\n</code></pre>\n\n<p>3 - If the user searches for a country in the database, the search runs, either listing all matches for the country or, if the user has narrowed the search by providing \"Category\" and \"Subategory\", listing only those database entries which match the three criteria. I have done this through an <code>IF</code> statement, separate from the first one:</p>\n\n<pre><code>For i = 2 To finalrow\n\n    'If the country field is filled in and there results from the search made\n    If Sheets(\"Database\").Cells(i, 1) = country And _\n        (Sheets(\"Database\").Cells(i, 3) = Category Or Category = \"\") And _\n        (Sheets(\"Database\").Cells(i, 4) = Subcategory Or Subcategory = \"\") Then\n\n            'Copy the headers of the \"Database\" sheet\n            With Sheets(\"Database\")\n            .Range(\"A1:I1\").Copy\n            End With\n            Sheets(\"Results\").Range(\"B10:J10\").PasteSpecial\n\n            'Copy the rows of the \"Database\" that match the search query\n            With Sheets(\"Database\")\n            .Range(.Cells(i, 1), .Cells(i, 9)).Copy\n            End With\n            Sheets(\"Results\").Range(\"B20000\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n</code></pre>\n\n<p>4 - As a last scenario, I want the script to react to the event where the user provides a \"Country\", a \"Category\" and/or a \"Subcategory\" but, although the database has entries for that country, it does not have entries for that country in that category or subcategory. In this case, I want the script to ask the user if it wants to see all information on the searched country, regardless of \"Category\" or \"Subategory\". I tried to do this through an <code>IfElse</code> statement, part of the previous <code>IF</code> statement:</p>\n\n<pre><code>ElseIf Sheets(\"Database\").Cells(i, 1) = country And _\n       (Sheets(\"Database\").Cells(i, 3) &lt;&gt; Category) Then\n        Dim question As Integer\n        question = MsgBox(\"Unfortunately, the Database has no sources regarding \" &amp; Category &amp; \" in \" &amp; country &amp; \". Would you perhaps want to broaden your search and see all sources regarding \" &amp; country &amp; \"?\", vbYesNo + vbQuestion, \"No results for your search\")\n        Sheets(\"Results\").Range(\"D6\").ClearContents\n        Sheets(\"Results\").Range(\"D7\").ClearContents\n        MsgBox question\n            If question = vbYes Then\n              Close\n              Call SearchButton_Click\n              Exit Sub\n            Else\n              Sheets(\"Results\").Range(\"D5\").ClearContents\n              Sheets(\"Results\").Range(\"D6\").ClearContents\n              Sheets(\"Results\").Range(\"D7\").ClearContents\n              Exit Sub\n            End If\n</code></pre>\n\n<p>These are the four scenarios I want the script to account for as possible.</p>\n\n<p>The search and the script as a whole are running fine when only scenarios 1, 2 and 3 are in place. However, when I insert the script of the <code>ElseIf</code> statement in scenario 4, something goes wrong. Although scenarios 1 and 2 keep on working, whenever I search for a country on which I know there are entries for \"Category\" and \"Subcategory\", the script prompts scenario 4 as if there were no matches for that \"Country\", \"Category\" and \"Subcategory\".</p>\n\n<p>I am not sure what I might be doing wrong or what the problem is with my <code>ElseIf</code> statement. </p>\n\n<hr>\n\n<h2>Whole Code</h2>\n\n<pre><code>Private Sub SearchButton_Click()\n\nDim country As String 'Search query category user-inputted\nDim Category As String 'Search query category user-inputted\nDim Subcategory As String 'Search query category user-inputted\nDim finalrow As Integer\nDim LastRowForTable As Long 'Last filled row in Results table\nDim i As Integer 'row counter\nDim ws As Worksheet\n\nSet ws = Sheets(\"Database\")\n\n'Erase any entries from the Results sheet\nSheets(\"Results\").Range(\"B10:J200000\").ClearContents\n\n'Define the user-inputed variables\ncountry = Sheets(\"Results\").Range(\"D5\").Value\nCategory = Sheets(\"Results\").Range(\"D6\").Value\nSubcategory = Sheets(\"Results\").Range(\"D7\").Value\nfinalrow = Sheets(\"Database\").Range(\"A200000\").End(xlUp).Row\n\n'If statement for search    \nWith Worksheets(\"Database\")\n    Set c = .Range(\"A:A\").Find(What:=country, After:=.Cells(1, 1), _\n            LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, _\n            SearchDirection:=xlNext, MatchCase:=False)\n    If Not c Is Nothing Then\n    Else\n        MsgBox \"Unfortunately, the database does not have any sources for information in \" &amp; country &amp; \". Please search for sources in relating to another country.\"\n        Sheets(\"Results\").Range(\"D5\").ClearContents\n        Sheets(\"Results\").Range(\"D6\").ClearContents\n        Sheets(\"Results\").Range(\"D7\").ClearContents\n        Exit Sub\n    End If\nEnd With\n\n'If the country field is left empty, there is no need to even run a search\nIf country = \"\" Then\n    Sheets(\"Results\").Range(\"B10:J200000\").Clear\n    MsgBox \"You must select a country in order to search the database. Please do so in the drop-down list provided.\"\n    Sheets(\"Results\").Range(\"D5\").ClearContents\n    Sheets(\"Results\").Range(\"D6\").ClearContents\n    Sheets(\"Results\").Range(\"D7\").ClearContents\n    Exit Sub\nEnd If\n\nFor i = 2 To finalrow\n\n    'If the country field is filled in and there results from the search made\n    If Sheets(\"Database\").Cells(i, 1) = country And _\n        (Sheets(\"Database\").Cells(i, 3) = Category Or Category = \"\") And _\n        (Sheets(\"Database\").Cells(i, 4) = Subcategory Or Subcategory = \"\") Then\n\n        'Copy the headers of the \"Database\" sheet\n        With Sheets(\"Database\")\n            .Range(\"A1:I1\").Copy\n        End With\n        Sheets(\"Results\").Range(\"B10:J10\").PasteSpecial\n\n        'Copy the rows of the table that match the search query\n        With Sheets(\"Database\")\n            .Range(.Cells(i, 1), .Cells(i, 9)).Copy\n        End With\n        Sheets(\"Results\").Range(\"B20000\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n\n    ElseIf Sheets(\"Database\").Cells(i, 1) = country And _\n        (Sheets(\"Database\").Cells(i, 3) &lt;&gt; Category) Then\n\n        Dim question As Integer\n        question = MsgBox(\"Unfortunately, the Database has no sources regarding \" &amp; Category &amp; \" in \" &amp; country &amp; \". Would you perhaps want to broaden your search and see all sources regarding \" &amp; country &amp; \"?\", vbYesNo + vbQuestion, \"Empty Sheet\")\n        Sheets(\"Results\").Range(\"D6\").ClearContents\n        Sheets(\"Results\").Range(\"D7\").ClearContents\n\n        MsgBox question\n        If question = vbYes Then\n            Close\n            Call SearchButton_Click\n            Exit Sub\n        Else\n            Sheets(\"Results\").Range(\"D5\").ClearContents\n            Sheets(\"Results\").Range(\"D6\").ClearContents\n            Sheets(\"Results\").Range(\"D7\").ClearContents\n            Exit Sub\n        End If\n\n    End If\n\nNext i\n\n'Hides search form\nMe.Hide\n\n'Toggle Results sheet\nSheets(\"Results\").Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1479905507, "post_id": 40764471, "comment_id": 68754234, "body": "<i>&quot;and then setting the checkbox value = false&quot;</i> did you do this with an UPDATE SQL? If you instead set the form checkbox value, there shouldn&#39;t be a write conflict, since the record isn&#39;t written."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479905894, "post_id": 40764471, "comment_id": 68754496, "body": "SQL Server uses 1 and 0 whereas MS Access uses -1 and 0. Do you have code to make this happen?"}, {"owner": {"reputation": 1849, "user_id": 3242154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c368f3140571a8d9a652dcf4607d549?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/3242154/nicolas"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479906791, "post_id": 40764471, "comment_id": 68755114, "body": "@Fionnuala when setting a checkbox control to true/false directly this doesn&#39;t matter since the controlsource behind it is the bit field from the sql server and access does the translation itself (correctly)."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479907000, "post_id": 40764471, "comment_id": 68755273, "body": "Not in my experience. Perhaps I am using an older version of SQL Server."}, {"owner": {"reputation": 1849, "user_id": 3242154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c368f3140571a8d9a652dcf4607d549?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/3242154/nicolas"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1479907008, "post_id": 40764471, "comment_id": 68755278, "body": "@Andre no, this isn&#39;t being done with an update statement, it is done directly to the controlsource / checkbox control, the record is in matter of fact &#39;written&#39; since the onclick event checks/fills the control and by doing that also sets the underlying controlsource behind it (so it is saved) - this is done automatically by access. Then I uncheck it again (in code) if it isn&#39;t valid (checkbox=false)."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479907197, "post_id": 40764471, "comment_id": 68755408, "body": "I should mention that I have a very similar set-up for one client and do not get write conflicts. This is why i suspect that you have some code that is causing the problem, as, it seems, does Andre."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1479909478, "post_id": 40764471, "comment_id": 68756952, "body": "I don&#39;t understand. If the user clicks a bound checkbox, how is its controlsource changed? Or the record automatically saved? Please post the full code you have/had for <i>&quot;First I tried to do this simply in the click event of the checkbox&quot;</i> - this should be the right way to do this."}], "answers": [{"tags": [], "owner": {"reputation": 1849, "user_id": 3242154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c368f3140571a8d9a652dcf4607d549?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/3242154/nicolas"}, "is_accepted": false, "score": 0, "last_activity_date": 1479910621, "creation_date": 1479910621, "answer_id": 40766874, "question_id": 40764471, "link": "https://stackoverflow.com/questions/40764471/write-conflict-on-updating-form-checkbox-with-multi-table-view-as-recordsouce/40766874#40766874", "title": "Write conflict on updating form checkbox with multi-table view as recordsouce", "body": "<p>Fixed it by using a button to set the checkbox bound field to checked/unchecked and making the checkbox itself invisible. This seems to work (better). </p>\n"}], "owner": {"reputation": 1849, "user_id": 3242154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c368f3140571a8d9a652dcf4607d549?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/3242154/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479910621, "creation_date": 1479903734, "question_id": 40764471, "link": "https://stackoverflow.com/questions/40764471/write-conflict-on-updating-form-checkbox-with-multi-table-view-as-recordsouce", "title": "Write conflict on updating form checkbox with multi-table view as recordsouce", "body": "<p>I have created a form with a View as recordsource, this view combines 1 table and another view (with 2 tables in it). \nWhen the checkbox is clicked a validation happens in the Access code that checks if the records checkbox may be updated, if this is not the case then the checkbox value should change back to 0/false. </p>\n\n<p>First I tried to do this simply in the <code>click event</code> of the checkbox and then setting the <code>checkbox value = false</code> when it does not validate. This however gives a <code>write conflict</code>. Next I tried it with a <code>Me.Dirty = false</code> in front of it, this also doesn't help (still getting the write conflict). The <code>checkbox.undo</code> gives the same result. </p>\n\n<p>Then I thought to do it in the <code>before update</code> and use a simple <code>cancel=true</code>, this however causes the focus not to change (it keeps the focus on the same record and never moves from it).</p>\n\n<p>The <code>Timestamp</code> is usually what I use to ignore write conflict messages, I included the timestamp of the main table but this doesn't work (probably because the view is multiple-table based). </p>\n\n<p>Some additional info: </p>\n\n<ul>\n<li>The view is created in the SQL server and is linked to Access </li>\n<li>The primary keys of the view (so it is editable) are set by executing a CREATE UNIQUE INDEX statement </li>\n</ul>\n\n<p>Any ideas how I can get this to work? </p>\n"}, {"tags": ["arrays", "vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1479903848, "post_id": 40764092, "comment_id": 68753176, "body": "Item 1 has Item 2 as a child.  Item 2 has a Item 1 as a child.  Item 2 has a itself as a child,  This is not a tree structure."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1479904296, "post_id": 40764092, "comment_id": 68753435, "body": "BTW: The plural of child is children. If English spelling was consistent how would we make it difficult to learn.   What does: &quot;I want to know, if I move two top level parents, have they similar childs? This should be possible from whatever level.&quot;? What does moving have to do with having similar children?  How do you reconcile &quot;top level&quot; and &quot;any level&quot;?"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1479909029, "post_id": 40764092, "comment_id": 68756664, "body": "Agree with @TonyDallimore. Can&#39;t understand what you want to achieve. Maybe a picture of the desired result would help."}, {"owner": {"reputation": 45, "user_id": 7199766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfadc3c00bbf82947ce8b878c083e76?s=128&d=identicon&r=PG&f=1", "display_name": "PhilHar", "link": "https://stackoverflow.com/users/7199766/philhar"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1480053534, "post_id": 40764092, "comment_id": 68818773, "body": "Thanks you for your answers. The real example ist: I have some CAD assemblies that I want to import to a PDM system. I can&#39;t import two parants that have equal children. So I have this table. @Tony Dallimore: Item 1 has children 2,4,6. Item 4 has children 2 and 3. Item 3 has child 5. This IS a tree structure."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1480083450, "post_id": 40764092, "comment_id": 68834675, "body": "Comment of 4 hours ago replaced to add missing word.  Your table does not confirm to any assemblies known to me. If 1 is a car and 2 is a wheel then a wheel can be a child of a car but a car cannot be a child of a wheel. A wheel cannot be a child of a wheel. You need to explain what real world components can match your table"}, {"owner": {"reputation": 45, "user_id": 7199766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfadc3c00bbf82947ce8b878c083e76?s=128&d=identicon&r=PG&f=1", "display_name": "PhilHar", "link": "https://stackoverflow.com/users/7199766/philhar"}, "edited": false, "score": 0, "creation_date": 1480314956, "post_id": 40764092, "comment_id": 68893848, "body": "I removed the line that said 1 is a child of 2 - you are right!"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1480600277, "post_id": 40764092, "comment_id": 69036814, "body": "I do not known what PDM system you are using but I would view a system crashing because a component is being used as part of a previously loaded assembly as a major bug. If the supplier could not fix the bug quickly, I would reject the system as unfit for purpose and demand my money back."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1480600316, "post_id": 40764092, "comment_id": 69036835, "body": "Suppose I want to import 1. It has children 2, 4 and 6.  I import 2 and then its child 3. I cannot import 4 because its two children have already been imported. Perhaps I should not have imported 2 as a child of 1 but as a child of 4.  How do you handle situations like this?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1480600346, "post_id": 40764092, "comment_id": 69036855, "body": "If the PDM system database is empty, user A can import the subset of the data that is useful to them.  The data useful to user B does not conflict with user A&#39;s data so user B&#39;s data can be imported as well.  However, the data useful to user C does conflict with user A&#39;s data but not user B&#39;s. Do you need a system that warns user C that they must wait for user A to delete their data?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1480600431, "post_id": 40764092, "comment_id": 69036929, "body": "How do you handle the import and deletion of data?  Does this Excel worksheet hold the authoritative definition of the relationship between parents and their children?"}, {"owner": {"reputation": 45, "user_id": 7199766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfadc3c00bbf82947ce8b878c083e76?s=128&d=identicon&r=PG&f=1", "display_name": "PhilHar", "link": "https://stackoverflow.com/users/7199766/philhar"}, "edited": false, "score": 0, "creation_date": 1481524223, "post_id": 40764092, "comment_id": 69395137, "body": "Tony Dallimore - show me a PDM system which can handle importing a physically exact same CAD file twice at the same time without showing any errors."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1483441988, "post_id": 40764092, "comment_id": 70090381, "body": "If a comment is posted against your question, you are told. If a comment is posted against my answer, I am told. But if you post a comment against your question then nobody is told unless you place an @ before their name. I checked your question for some days after 1Dec16 in case you did not know this but I had given up before 12Dec16 so it was only today that I noticed your comment."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1483442027, "post_id": 40764092, "comment_id": 70090406, "body": "I am not an expert on PDM systems. However, the basis of good design is that components are reused where possible. How can you version manage your systems if you cannot record that component X is used in A, B and C?  What if component X has several versions? Can you record that A contains version 1 of X and B contains version 2 of X?  My interest in Product Data Management systems is the version control of software. I have hundreds of routines in tens of products. I fail to see how a PDM system with the deficiencies you describe would help."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1483442065, "post_id": 40764092, "comment_id": 70090424, "body": "My interpretation is that you have to live with your PDM system and you are using Excel to handle what it does not. Following the comment in which I criticise your PDM system, I ask three questions to help me understand what you are doing with Excel. Are these questions sensible or have I misunderstood what you are doing?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7199766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfadc3c00bbf82947ce8b878c083e76?s=128&d=identicon&r=PG&f=1", "display_name": "PhilHar", "link": "https://stackoverflow.com/users/7199766/philhar"}, "edited": false, "score": 0, "creation_date": 1480053798, "post_id": 40774979, "comment_id": 68818868, "body": "Hey, the real identifiiers are strings (filenames) and the list is a list of 337.000 rows and the resulting dictionary/array/list could have up to 15 levels."}, {"owner": {"reputation": 45, "user_id": 7199766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfadc3c00bbf82947ce8b878c083e76?s=128&d=identicon&r=PG&f=1", "display_name": "PhilHar", "link": "https://stackoverflow.com/users/7199766/philhar"}, "edited": false, "score": 0, "creation_date": 1480315382, "post_id": 40774979, "comment_id": 68894049, "body": "Your help is amazing. I need to explain &quot;equal children&quot; more specific: If ABC has KLM as a child (on level 4) and FGH has KLM as child (on level 3) they have an equal child and can&#39;t be imported. The structure doesn&#39;t need to be the same. If a minimum of one child is equal, the two assemblies can&#39;t be imported at the same time. To understand why: If you import two equal files at the same time, which one is the correct one? The import procedure crashes. One should be imported first, the second one should be reused from the PDM system as a single source of truth."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 45, "user_id": 7199766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfadc3c00bbf82947ce8b878c083e76?s=128&d=identicon&r=PG&f=1", "display_name": "PhilHar", "link": "https://stackoverflow.com/users/7199766/philhar"}, "edited": false, "score": 0, "creation_date": 1480431573, "post_id": 40774979, "comment_id": 68953520, "body": "You will have to include a lot more information in your question if I am to understand your requirement and offer constructive advice.  In your example data 1 is a child of 2 and 2 is a child of 1 and 2.  What real world items do 1 and 2 represent?  2 is a child of 1, 2 and 4.  If you can only import 2 as a component once, which of 1, 2 and 4 do you import?  What is to happen to the other two parents?  Importing 1 as the ultimate parent seem would sensible but, if you cannot import two of its children, how is that possible?"}, {"owner": {"reputation": 45, "user_id": 7199766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfadc3c00bbf82947ce8b878c083e76?s=128&d=identicon&r=PG&f=1", "display_name": "PhilHar", "link": "https://stackoverflow.com/users/7199766/philhar"}, "edited": false, "score": 0, "creation_date": 1480489549, "post_id": 40774979, "comment_id": 68978674, "body": "We have several users that import the data. But if a user imports a parent as any child that an other is is importing at the same time the import crashes. So the first user has to import tha parent with all children and after that the second user can start. I will found out parents that can be imported parallely at the same time without crashes because they have not one single equal child in what ever level. Sorry for the loss of information."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1480111620, "last_edit_date": 1480111620, "creation_date": 1479939053, "answer_id": 40774979, "question_id": 40764092, "link": "https://stackoverflow.com/questions/40764092/build-multilevel-array-from-single-relation-table/40774979#40774979", "title": "Build multilevel array from single relation table", "body": "<p>You do not give enough information about your requirement to give a definitive answer so here are some ideas.</p>\n\n<p>My first attempt at a structure would be:</p>\n\n<pre><code>  | Parents | Children |\n1 | 2       | 2  4  6  |\n2 | 1  2  4 | 1  2  3  |\n3 | 2  4    | 5        |\n4 | 1       | 2  3     |\n5 | 3       |          |\n6 | 1       |          |\n</code></pre>\n\n<p>That is, for each of the items, I would have a list of parents and a list of children.  I would consider the effort to create this structure and consider how easily I could answer required questions from this structure.  This was not a difficult structure to build manually so should not be a difficult structure for a macro to build.  You want to know if two items have the same children. This can be determined quickly by examining the lists of children for the two items.</p>\n\n<p>You would need a full review against your planned uses for this structure.  However, for the moment this structure looks satisfactory.</p>\n\n<p>In your table, the identifiers for the items are the numbers 1 to 6 without gaps.  If this is representative of the real data, I would probably define a user type and hold the data as an array:</p>\n\n<pre><code>Type utItem\n  Parents() As Long\n  Children() as Long\nEnd Type\n\nDim Items() as utItem\n</code></pre>\n\n<p>If the real identifiers are strings or scattered numbers, I believe I would go for a dictionary.  For each entry, the key would be the identifier and the item would be a pair of arrays: one for parents and one for children.</p>\n\n<p><strong>Proposal 2</strong></p>\n\n<p>The additional information suggests a structure like this is what you require:</p>\n\n<pre><code>Prnt | D?| Children\n ABC |   | BBC  BBD  FGI  FGJ  KLM \n STU | D | BBC  BBD  FGI  FGJ  KLM\n GHI | D | BBC  BBD  FGI  FGJ  KLM\n ABD |   | BBC  FGJ\n FGH | D | BBC  FGI  FGJ  KLM\n ABE |   | BBC  FGI  FGJ  KLM\n</code></pre>\n\n<p>The three letter identifiers represent filename.  The real filenames will be longer but that does not matter.</p>\n\n<p>For each parent, the children have been listed in alphabetic order.  The list has then been sorted by the identifiers of the children with the sequence of parents being unimportant.  For example, STU and GHI have the same children.  If the list was sorted by children then parent, the GHI row would come first.  If it were important for the GHI row to come first, you need to add this requirement.</p>\n\n<p>A D in the second column indicates that the row has the same children as the previous row.</p>\n\n<p>There is nothing in this list to indicate if ABC, for example, has its own parent or parents.  Such information may be helpful during the building of this list but it is not needed once the list is complete.</p>\n\n<p>You want to load this data to a PDM system.  You can add item ABC and its children to the PDM system but you cannot add STU because it has the same children.  I do not understand.  You cannot just ignore item STU because it may have parents which will reference it.</p>\n\n<p>The loading of data to the PDM system will be a one-time exercise.  Creating the above structure cannot be impossibly slow but does not have to be lightning fast.  For example, five minutes might be wonderful, forty-five minutes would be acceptable but twenty hours would not be acceptable.</p>\n"}], "owner": {"reputation": 45, "user_id": 7199766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfadc3c00bbf82947ce8b878c083e76?s=128&d=identicon&r=PG&f=1", "display_name": "PhilHar", "link": "https://stackoverflow.com/users/7199766/philhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480314883, "creation_date": 1479902681, "last_edit_date": 1531164843, "question_id": 40764092, "link": "https://stackoverflow.com/questions/40764092/build-multilevel-array-from-single-relation-table", "title": "Build multilevel array from single relation table", "body": "<p>I have an excel file with two columns. The first column (A) has parents and the second has children (B). A row has the information, what the parent of a child is.</p>\n\n<pre><code>Parent  |   Child\n1       |   2\n1       |   4\n1       |   6\n2       |   3\n4       |   2\n4       |   3\n3       |   5\n</code></pre>\n\n<p>I now want to build a multilevel array that has i tree structure.\nWhat I want to achieve is, that I later want to give a parent (e.g. 2) and receive a list of levels and children and their level.\nThe global goal should be: I want to know, if I move two top level parents, have they similar childs? This should be possible from whatever level.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479903503, "post_id": 40764012, "comment_id": 68752937, "body": "You&#39;ll need to look at application level using an addin perhaps"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 5, "user_id": 7199879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbed8e5604b521b215288817826de20?s=128&d=identicon&r=PG&f=1", "display_name": "Muffin", "link": "https://stackoverflow.com/users/7199879/muffin"}, "edited": false, "score": 0, "creation_date": 1479906793, "post_id": 40764439, "comment_id": 68755118, "body": "What is the error, you need to use wb not activeworkbook in the sub"}, {"owner": {"reputation": 5, "user_id": 7199879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbed8e5604b521b215288817826de20?s=128&d=identicon&r=PG&f=1", "display_name": "Muffin", "link": "https://stackoverflow.com/users/7199879/muffin"}, "edited": false, "score": 0, "creation_date": 1479907199, "post_id": 40764439, "comment_id": 68755410, "body": "I did and still not working, where exactly this code should be placed in personal file, in ThisWorkBook or in a some module?"}, {"owner": {"reputation": 5, "user_id": 7199879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbed8e5604b521b215288817826de20?s=128&d=identicon&r=PG&f=1", "display_name": "Muffin", "link": "https://stackoverflow.com/users/7199879/muffin"}, "edited": false, "score": 0, "creation_date": 1479907265, "post_id": 40764439, "comment_id": 68755458, "body": "Error giving me in module &quot;only valid in object module&quot;"}, {"owner": {"reputation": 5, "user_id": 7199879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbed8e5604b521b215288817826de20?s=128&d=identicon&r=PG&f=1", "display_name": "Muffin", "link": "https://stackoverflow.com/users/7199879/muffin"}, "edited": false, "score": 0, "creation_date": 1479910089, "post_id": 40764439, "comment_id": 68757340, "body": "Personal file is in <a href=\"https://www.dropbox.com/s/7wjzsgqx4j627sg/PERSONAL.XLSB?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/7wjzsgqx4j627sg/PERSONAL.XLSB?dl=0</a>  / code is in ThisWorkBook. Can you try it?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 5, "user_id": 7199879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbed8e5604b521b215288817826de20?s=128&d=identicon&r=PG&f=1", "display_name": "Muffin", "link": "https://stackoverflow.com/users/7199879/muffin"}, "edited": false, "score": 0, "creation_date": 1479914013, "post_id": 40764439, "comment_id": 68760099, "body": "The error you are getting cant happen, are you definitely putting in Thisworkbook in Personal?"}, {"owner": {"reputation": 5, "user_id": 7199879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbed8e5604b521b215288817826de20?s=128&d=identicon&r=PG&f=1", "display_name": "Muffin", "link": "https://stackoverflow.com/users/7199879/muffin"}, "edited": false, "score": 0, "creation_date": 1479972946, "post_id": 40764439, "comment_id": 68783964, "body": "^ shouldn&#39;t it be in ThisWorkbook of personal file?  This error is happening when I put the code in Module."}, {"owner": {"reputation": 5, "user_id": 7199879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbed8e5604b521b215288817826de20?s=128&d=identicon&r=PG&f=1", "display_name": "Muffin", "link": "https://stackoverflow.com/users/7199879/muffin"}, "edited": false, "score": 0, "creation_date": 1479973869, "post_id": 40764439, "comment_id": 68784476, "body": "Where I am supposed to use the &quot;CUSTOM_EXCEL&quot; in my code?"}, {"owner": {"reputation": 5, "user_id": 7199879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbed8e5604b521b215288817826de20?s=128&d=identicon&r=PG&f=1", "display_name": "Muffin", "link": "https://stackoverflow.com/users/7199879/muffin"}, "edited": false, "score": 0, "creation_date": 1479973977, "post_id": 40764439, "comment_id": 68784541, "body": "Ok nevermind, It is working now - so I should always refer to Wb in everything."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1479913985, "last_edit_date": 1479913985, "creation_date": 1479903643, "answer_id": 40764439, "question_id": 40764012, "link": "https://stackoverflow.com/questions/40764012/vba-code-to-work-on-all-workbooks/40764439#40764439", "title": "VBA code to work on ALL workbooks", "body": "<p>using the personal like this should help</p>\n\n<pre><code>Public WithEvents CUSTOM_EXCEL As Excel.Application\n\nPrivate Sub CUSTOM_EXCEL_WorkbookBeforeSave(ByVal Wb As Workbook, ByVal SaveAsUI As Boolean, Cancel As Boolean)\nLastrow = Wb.ActiveSheet.Cells(Rows.Count, 12).End(xlUp).Row\nIf Wb.Name Like \"FR_*\" And WorksheetFunction.CountIf(Wb.ActiveSheet.Range(Cells(4, 12), _\n    Cells(Lastrow, 12)), \"&lt;&gt;Pending Distribution\") &gt; 0 Then\n    MsgBox \"Warning, column L has values other than Pending Distribution\"\n    Cancel = True\nEnd If\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    Set CUSTOM_EXCEL = Application\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/jN58Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jN58Z.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 7199879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbed8e5604b521b215288817826de20?s=128&d=identicon&r=PG&f=1", "display_name": "Muffin", "link": "https://stackoverflow.com/users/7199879/muffin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 40764439, "answer_count": 1, "score": 0, "last_activity_date": 1479913985, "creation_date": 1479902481, "last_edit_date": 1531164843, "question_id": 40764012, "link": "https://stackoverflow.com/questions/40764012/vba-code-to-work-on-all-workbooks", "title": "VBA code to work on ALL workbooks", "body": "<p>I have this code: </p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nLastrow = ActiveSheet.Cells(Rows.Count, 12).End(xlUp).Row       \n\nIf ActiveWorkbook.Name Like \"FR_*\" And WorksheetFunction.CountIf(ActiveSheet.Range(Cells(4, 12), Cells(Lastrow, 12)), \"&lt;&gt;Pending Distribution\") &gt; 0 Then\n    MsgBox \"Warning, column L has values other than Pending Distribution\"\n    Cancel = True\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>It works when it is saved into the Workbook in vba but it doesn't work in Personal.xlsb </p>\n\n<p>I want to make it work on ALL workbook that start with FR_ , but it is not working despite I am using ActiveSheet and ActiveWorkbook, why ? </p>\n"}, {"tags": ["excel", "vba", "pdf", "charts", "excel-charts"], "answers": [{"comments": [{"owner": {"reputation": 4959, "user_id": 783421, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7634fc50bf44d5c0e9e5cd819fb912ad?s=128&d=identicon&r=PG", "display_name": "Qbik", "link": "https://stackoverflow.com/users/783421/qbik"}, "edited": false, "score": 0, "creation_date": 1479901743, "post_id": 40763672, "comment_id": 68751779, "body": "can I set some properties of activesheet which will influence the zoom size with which AR opens pdf ?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4959, "user_id": 783421, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7634fc50bf44d5c0e9e5cd819fb912ad?s=128&d=identicon&r=PG", "display_name": "Qbik", "link": "https://stackoverflow.com/users/783421/qbik"}, "edited": false, "score": 1, "creation_date": 1479901831, "post_id": 40763672, "comment_id": 68751840, "body": "As far as I know - nope. But if you find a way, I would be interested to know it as well, so please tag me in it :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1479901590, "creation_date": 1479901590, "answer_id": 40763672, "question_id": 40763428, "link": "https://stackoverflow.com/questions/40763428/vba-open-pdf-after-export-from-excel-with-specified-zoom-level/40763672#40763672", "title": "VBA open .pdf after export from Excel with specified Zoom level", "body": "<p>I doubt that it is possible to save it with a specific zoom to pdf.\nHowever, the best workaround I may think of is to do the following:</p>\n\n<p>In Acrobat Reader set the default Zoom to the one you want it like this:</p>\n\n<pre><code>Edit&gt;Preferences&gt;Accessibility&gt;Override Page Display\n</code></pre>\n"}], "owner": {"reputation": 4959, "user_id": 783421, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7634fc50bf44d5c0e9e5cd819fb912ad?s=128&d=identicon&r=PG", "display_name": "Qbik", "link": "https://stackoverflow.com/users/783421/qbik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1505, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479901590, "creation_date": 1479900918, "question_id": 40763428, "link": "https://stackoverflow.com/questions/40763428/vba-open-pdf-after-export-from-excel-with-specified-zoom-level", "title": "VBA open .pdf after export from Excel with specified Zoom level", "body": "<p>I save active sheet as <code>.pdf</code> file with <code>OpenAfterPublish:=True</code> option, can I pass additional parameter which specify <code>zoom</code> level with which this pdf will be opened (my default is Acrobat Reader) ?</p>\n\n<pre><code>ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    SOMENAME, Quality:=xlQualityMinimum, IncludeDocProperties:=True, IgnorePrintAreas:=False _\n    , OpenAfterPublish:=True\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros", "copy"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479900736, "post_id": 40763314, "comment_id": 68751046, "body": "something like this: use a <code>String</code> , <code>Dim StrPath as String</code> , <code>StrPath = &quot;C:&#47;&#47;Results_2561.xlsm&quot;</code> , and <code>Set book1 = Workbooks.Open(StrPath )</code>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1479900871, "post_id": 40763314, "comment_id": 68751152, "body": "How about opening a file dialog at the beginning of the macro?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1479900910, "post_id": 40763314, "comment_id": 68751192, "body": "better avoid using <code>Activate</code> , <code>Selection</code> and <code>Select</code>. You could have one <b>BIG</b> <code>With Workbooks(&quot;Results_2561&quot;)</code> in the start of your code, then to copy use <code>.Range(&quot;B27:B41&quot;).Copy</code> , to PasteSpecial <code>Workbooks(&quot;Overall_Results&quot;).Range(&quot;G2&quot;).PasteSpecial xlValues</code> (you need another parametr if you are using <code>PasteSpecial </code>"}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1479900927, "post_id": 40763314, "comment_id": 68751209, "body": "or perhaps define an input box variable, and type the name of the file it will come from in the input box. Then use that stored variable in the opening of the file"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 55, "user_id": 7199530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c54729acc11dd1140ad6f2678b53da?s=128&d=identicon&r=PG&f=1", "display_name": "conor_k9", "link": "https://stackoverflow.com/users/7199530/conor-k9"}, "edited": false, "score": 0, "creation_date": 1479908185, "post_id": 40763566, "comment_id": 68756087, "body": "You are welcome. Please see also edited code for further reduction of typing efforts and a more robust approach for range references with explicit worksheet qualification. If my answer solved your question you may want to mark it as accepted. Thank you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1479908037, "last_edit_date": 1479908037, "creation_date": 1479901260, "answer_id": 40763566, "question_id": 40763314, "link": "https://stackoverflow.com/questions/40763314/excel-macro-setting-a-variable-for-a-workbooks-location/40763566#40763566", "title": "Excel Macro: Setting a variable for a workbooks location?", "body": "<p>since you're only interested in copying values you could use this helper <code>Sub</code></p>\n\n<pre><code>Sub CopyValues(rngToCopyFrom As Range, rngToCopyTo As Range)\n    With rngToCopyFrom\n        rngToCopyTo.Resize(.Rows.COUNT, .Columns.COUNT).Value = .Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>to be exploited in your main code like follows:</p>\n\n<pre><code>Sub main()\n    Dim wsTo As Worksheet\n\n    Set wsTo = Workbooks(\"Overall_Results\").ActiveSheet '&lt;--| set the worksheet to paste values to\n    With Workbooks(\"Results_2561\").ActiveSheet '&lt;--| reference the worksheet to copy values from\n        CopyValues .Range(\"B27:B41\"), wsTo.Range(\"G2\")\n        CopyValues .Range(\"C27:C41\"), wsTo.Range(\"C2\")\n        CopyValues .Range(\"I28:I40\"), wsTo.Range(\"G17\")\n        CopyValues .Range(\"J28:J40\"), wsTo.Range(\"C17\")\n    End With\nEnd Sub\n</code></pre>\n\n<p>should your relevant workbooks have more than one sheet, then just substitute</p>\n\n<pre><code>ActiveSheet\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Worksheets(\"myRelevantShetName\") '&lt;--|change \"myRelevantShetName\" to the actual name of the relevant worksheet in each workbook\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 7199530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c54729acc11dd1140ad6f2678b53da?s=128&d=identicon&r=PG&f=1", "display_name": "conor_k9", "link": "https://stackoverflow.com/users/7199530/conor-k9"}, "edited": false, "score": 0, "creation_date": 1479902352, "post_id": 40763777, "comment_id": 68752165, "body": "That&#39;s brilliant! Thank you so much!"}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": false, "score": 0, "last_activity_date": 1479901870, "creation_date": 1479901870, "answer_id": 40763777, "question_id": 40763314, "link": "https://stackoverflow.com/questions/40763314/excel-macro-setting-a-variable-for-a-workbooks-location/40763777#40763777", "title": "Excel Macro: Setting a variable for a workbooks location?", "body": "<p>First of all, you don't have to Activate workbook every time when you want to copy/paste something. Just declare it in <code>Range()</code> property, for example:</p>\n\n<pre><code>''''''Section 1''''''\nWorkbooks(\"Results_2561\").Sheets(1).Range(\"B27:B41\").Copy\nWorkbooks(\"Overall_Results\").Sheets(1).Range(\"G2\").PasteSpecial\n</code></pre>\n\n<p>You can set Workbook as variable like:</p>\n\n<pre><code>Sub copying()\nDim wb1 As Workbook, wb2 As Workbook\nSet wb1 = Workbooks(\"Results_2561\")\nSet wb2 = Workbooks(\"Overall_Results\")\n\n''''''Section 1''''''\nwb1.Sheets(1).Range(\"B27:B41\").Copy\nwb2.Sheets(1).Range(\"G2\").PasteSpecial\nEnd Sub\n</code></pre>\n\n<p>Finally, as @A.S.H suggested, you can add a file dialog where you point which files you want to use. I have put it in some function (don't forget to put it in the same project as your <code>copying</code> macro):</p>\n\n<pre><code>Function strPath() As String\nDim intResult As Integer\nApplication.FileDialog(msoFileDialogFilePicker).Title = \"Select file\"\nintResult = Application.FileDialog(msoFileDialogFilePicker).Show\nIf intResult &lt;&gt; 0 Then\n    strPath = Application.FileDialog(msoFileDialogFilePicker).SelectedItems(1)\nEnd If\nEnd Function\n</code></pre>\n\n<p>So your final code for Section 1 would look like:</p>\n\n<pre><code>Sub copying()\nDim wb1 As Workbook, wb2 As Workbook\nMsgBox \"Show file to copy form.\"\nSet wb1 = Workbooks.Open(strPath())\nMsgBox \"Show file to paste in.\"\nSet wb2 = Workbooks.Open(strPath())\n\n''''''Section 1''''''\nwb1.Sheets(1).Range(\"B27:B41\").Copy\nwb2.Sheets(1).Range(\"G2\").PasteSpecial\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 7199530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c54729acc11dd1140ad6f2678b53da?s=128&d=identicon&r=PG&f=1", "display_name": "conor_k9", "link": "https://stackoverflow.com/users/7199530/conor-k9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 40763566, "answer_count": 2, "score": 1, "last_activity_date": 1479908037, "creation_date": 1479900596, "question_id": 40763314, "link": "https://stackoverflow.com/questions/40763314/excel-macro-setting-a-variable-for-a-workbooks-location", "title": "Excel Macro: Setting a variable for a workbooks location?", "body": "<p>I need to write a macro script that will copy data from one xml workbook and paste the values to another workbook. I've written the below macro that works fine, but i need to run this every week for several different documents so it means i have to replace the document name for each run.</p>\n\n<p>Here's what i have so far:</p>\n\n<pre><code>Sub copying()\n\n''''''Section 1''''''\nWorkbooks(\"Results_2561\").Activate 'workbook i'm copying from\nRange(\"B27:B41\").Select\nSelection.Copy\nWorkbooks(\"Overall_Results\").Activate 'workbook i'm pasting to\nRange(\"G2\").PasteSpecial\n\n''''''Section 2''''''\nWorkbooks(\"Results_2561\").Activate\nRange(\"C27:C41\").Select\nSelection.Copy\nWorkbooks(\"Overall_Results\").Activate\nRange(\"C2\").PasteSpecial\n\n''''''Section 3''''''\nWorkbooks(\"Results_2561\").Activate\nRange(\"I28:I40\").Select\nSelection.Copy\nWorkbooks(\"Overall_Results\").Activate\nRange(\"G17\").PasteSpecial\n\n''''''Section 4''''''\nWorkbooks(\"Results_2561\").Activate\nRange(\"J28:J40\").Select\nSelection.Copy\nWorkbooks(\"Overall_Results\").Activate\nRange(\"C17\").PasteSpecial\n\nEnd Sub\n</code></pre>\n\n<p>...\nand that's only half the script. Is there a way i can declare a variable at the start and set it as the Workbooks file path so i can call that instead of typing and retyping it over and over again?\nPreferably without using something like</p>\n\n<pre><code>Dim book1 as Workbook\nSet book1 = Workbooks.Open(\"C://Results_2561.xlsm\")\n</code></pre>\n\n<p>..as this keeps opening and closing the document when i run the script.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "edited": false, "score": 0, "creation_date": 1479909258, "post_id": 40762889, "comment_id": 68756811, "body": "Add another <code>While ie.Busy</code> Loop after you navigate to google.com the second time"}, {"owner": {"reputation": 11, "user_id": 7199609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40c8bd7166a0e6a6ee3dd82814efdf1?s=128&d=identicon&r=PG&f=1", "display_name": "Raulsoul", "link": "https://stackoverflow.com/users/7199609/raulsoul"}, "reply_to_user": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "edited": false, "score": 0, "creation_date": 1480016524, "post_id": 40762889, "comment_id": 68809329, "body": "its not working  Can you check code your self on vba and run its working? If you get answer so give me code here thanks"}], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "reply_to_user": {"reputation": 11, "user_id": 7199609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40c8bd7166a0e6a6ee3dd82814efdf1?s=128&d=identicon&r=PG&f=1", "display_name": "Raulsoul", "link": "https://stackoverflow.com/users/7199609/raulsoul"}, "edited": false, "score": 0, "creation_date": 1480339321, "post_id": 40809514, "comment_id": 68907492, "body": "Yes I did and it worked. But I tested it again and realized that it sometimes enters the second search text in the first tab. Will look into it again as soon as I have time"}, {"owner": {"reputation": 11, "user_id": 7199609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40c8bd7166a0e6a6ee3dd82814efdf1?s=128&d=identicon&r=PG&f=1", "display_name": "Raulsoul", "link": "https://stackoverflow.com/users/7199609/raulsoul"}, "edited": false, "score": 0, "creation_date": 1480354928, "post_id": 40809514, "comment_id": 68917242, "body": "Dear i need really urgent this if you do this right now i pleasure you"}, {"owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "reply_to_user": {"reputation": 11, "user_id": 7199609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40c8bd7166a0e6a6ee3dd82814efdf1?s=128&d=identicon&r=PG&f=1", "display_name": "Raulsoul", "link": "https://stackoverflow.com/users/7199609/raulsoul"}, "edited": false, "score": 0, "creation_date": 1480440713, "post_id": 40809514, "comment_id": 68959678, "body": "Have a look into <a href=\"http://stackoverflow.com/questions/16523271/accessing-ie-tabs-once-created\">this post</a>"}, {"owner": {"reputation": 11, "user_id": 7199609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40c8bd7166a0e6a6ee3dd82814efdf1?s=128&d=identicon&r=PG&f=1", "display_name": "Raulsoul", "link": "https://stackoverflow.com/users/7199609/raulsoul"}, "edited": false, "score": 0, "creation_date": 1480596440, "post_id": 40809514, "comment_id": 69034261, "body": "Its not my answer i was see but its not work you see my code what is in missing please guide me"}], "tags": [], "owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "is_accepted": false, "score": 0, "last_activity_date": 1480092678, "creation_date": 1480092678, "answer_id": 40809514, "question_id": 40762889, "link": "https://stackoverflow.com/questions/40762889/how-i-can-put-value-on-google-search-using-vba-on-ie-next-tab/40809514#40809514", "title": "How i can put value on Google search using VBA on ie next tab?", "body": "<p>Please try this:  </p>\n\n<pre><code>Sub FillinternetForm()\n\nDim ie As Object\n\nSet ie = CreateObject(\"Internetexplorer.Application\")\n\nie.Navigate \"https://google.com\"\n\nie.Visible = True\n\nWhile ie.Busy\n\n    DoEvents 'wait until IE is done loading page.\n\nWend\n\nie.Document.getElementById(\"lst-ib\").Value = \"Fast Sub\"\n\nie.Navigate \"https://google.com\", CLng(2048)\n\nWhile ie.Busy\n\n    DoEvents 'wait until IE is done loading page.\n\nWend\n\nWith CreateObject(\"Shell.Application\").Windows\n\n    Set ie = .Item(.Count - 1)\n\nEnd With\n\nWhile ie.Busy\n\n    DoEvents 'wait until IE is done loading page.\n\nWend\n\nie.Document.getElementById(\"lst-ib\").Value = \"Fast slow Sub\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7199609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40c8bd7166a0e6a6ee3dd82814efdf1?s=128&d=identicon&r=PG&f=1", "display_name": "Raulsoul", "link": "https://stackoverflow.com/users/7199609/raulsoul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 465, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480092678, "creation_date": 1479899517, "last_edit_date": 1531164843, "question_id": 40762889, "link": "https://stackoverflow.com/questions/40762889/how-i-can-put-value-on-google-search-using-vba-on-ie-next-tab", "title": "How i can put value on Google search using VBA on ie next tab?", "body": "<p>This is the code :    </p>\n\n<pre><code>Sub FillinternetForm()\n\nDim ie As Object\n\nSet ie = CreateObject(\"Internetexplorer.Application\")\n\nie.Navigate \"https://google.com\"\n\nie.Visible = True\n\nWhile ie.Busy\n\nDoEvents 'wait until IE is done loading page.\n\nWend\n\nie.Document.all(\"lst-ib\").Value = \"Fast Sub\"\n\nie.Navigate \"https://google.com\", CLng(2048)\n\nie.Document.all(\"lst-ib\").Value = \"Fast slow Sub\"\n\nEnd Sub\n</code></pre>\n\n<p>First Tab working well when second open its not fill value guide about this</p>\n"}, {"tags": ["vba", "excel", "zipfile"], "answers": [{"comments": [{"owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "edited": false, "score": 0, "creation_date": 1479900354, "post_id": 40762970, "comment_id": 68750784, "body": "But I want a specific zipped file only."}], "tags": [], "owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "is_accepted": false, "score": 1, "last_activity_date": 1479899719, "creation_date": 1479899719, "answer_id": 40762970, "question_id": 40762860, "link": "https://stackoverflow.com/questions/40762860/deleting-a-zipped-file/40762970#40762970", "title": "Deleting a zipped file", "body": "<p>if you wish to delete any zip file in Folder:</p>\n\n<pre><code> Kill  folderName &amp; \"\\*.zip\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "edited": false, "score": 0, "creation_date": 1479900319, "post_id": 40762985, "comment_id": 68750764, "body": "But I&#39;ve already tried this. This returns a <code>File not Found</code> error. Thanks"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "edited": false, "score": 0, "creation_date": 1479900353, "post_id": 40762985, "comment_id": 68750783, "body": "Which windows are you using? With Windows 7 and 8 it works quite well."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "edited": false, "score": 1, "creation_date": 1479900754, "post_id": 40762985, "comment_id": 68751055, "body": "Well, then make sure that you give the exact path. It works."}, {"owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "edited": false, "score": 0, "creation_date": 1479948164, "post_id": 40762985, "comment_id": 68776453, "body": "Updated my question. Thanks :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1479899757, "creation_date": 1479899757, "answer_id": 40762985, "question_id": 40762860, "link": "https://stackoverflow.com/questions/40762860/deleting-a-zipped-file/40762985#40762985", "title": "Deleting a zipped file", "body": "<p>This works like a charm:</p>\n\n<pre><code>Kill  \"C:\\Users\\gropc\\Desktop\\test.zip\"\n</code></pre>\n"}], "owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1521478461, "creation_date": 1479899437, "last_edit_date": 1521478461, "question_id": 40762860, "link": "https://stackoverflow.com/questions/40762860/deleting-a-zipped-file", "title": "Deleting a zipped file", "body": "<p>Is there anyway to delete a zip file using Excel VBA?\nI've tried using <code>Kill  folderName &amp; \"\\*.*\"</code> but this will only delete the files in a folder and <code>rmdir foldername</code> delete an empty folder.\nI have this line of code which has the directory of the zipped file</p>\n\n<pre><code>dim ws as Worksheet\nset ws = thisworkbook.sheets(\"Sheet1\")\nws.range(\"P3\").value ' contains the directory of the zip file\n\ndebug.print ws.range(\"P3\").value 'result C:\\Documents\\MyFilesZip  23-Nov-16_18-06-03.zip\nkill ws.range(\"P3\").value\n</code></pre>\n\n<p>I've done it that way but it errors saying: `Path not found\n Can you give me some ideas please?</p>\n\n<p>Already figured it out, since the zipped file is hidden, and maybe has other attributes, I've set the attribute of the file first to <code>vbNormal</code> before killing it :)</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1479900059, "post_id": 40762806, "comment_id": 68750553, "body": "Which lines returns the error?  Is it <code>Basket.Open SQLSyntax, link</code>?"}, {"owner": {"reputation": 35, "user_id": 5597053, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8fb3370da5106b3fd843b15661d24fb7?s=128&d=identicon&r=PG&f=1", "display_name": "A Supertramp", "link": "https://stackoverflow.com/users/5597053/a-supertramp"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1479936190, "post_id": 40762806, "comment_id": 68772583, "body": "Yes, sorry, Basket.Open SQLSyntax, link returns the error."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5597053, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8fb3370da5106b3fd843b15661d24fb7?s=128&d=identicon&r=PG&f=1", "display_name": "A Supertramp", "link": "https://stackoverflow.com/users/5597053/a-supertramp"}, "edited": false, "score": 0, "creation_date": 1479990828, "post_id": 40764336, "comment_id": 68795552, "body": "Hi @DougCoats thank you for your response. I have replaced <code>Basket.Open SQLSyntax, link</code> with <code>Set Basket = link.Execute(SQLSyntax)</code> in the above VBA code. It resulted in the same &quot;Command text was not set for the command object&quot; error unfortunately :("}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 35, "user_id": 5597053, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8fb3370da5106b3fd843b15661d24fb7?s=128&d=identicon&r=PG&f=1", "display_name": "A Supertramp", "link": "https://stackoverflow.com/users/5597053/a-supertramp"}, "edited": false, "score": 0, "creation_date": 1480000354, "post_id": 40764336, "comment_id": 68801689, "body": "@ASuperTramp maybe you should parsing the SQL directly in Visual Studio instead of pulling form worksheet? Maybe there is a formatting issues going on."}, {"owner": {"reputation": 35, "user_id": 5597053, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8fb3370da5106b3fd843b15661d24fb7?s=128&d=identicon&r=PG&f=1", "display_name": "A Supertramp", "link": "https://stackoverflow.com/users/5597053/a-supertramp"}, "edited": false, "score": 1, "creation_date": 1480500680, "post_id": 40764336, "comment_id": 68985073, "body": "This is fixed now. It was a formatting issue. Thank you very much for your help."}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 0, "last_activity_date": 1479903394, "creation_date": 1479903394, "answer_id": 40764336, "question_id": 40762806, "link": "https://stackoverflow.com/questions/40762806/connecting-sql-and-excel/40764336#40764336", "title": "Connecting SQL and Excel", "body": "<p>YOu never open the recordset?</p>\n\n<pre><code> Set basket = link.Execute(\"SELECT * FROM Table1;\")\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5597053, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8fb3370da5106b3fd843b15661d24fb7?s=128&d=identicon&r=PG&f=1", "display_name": "A Supertramp", "link": "https://stackoverflow.com/users/5597053/a-supertramp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 40764336, "answer_count": 1, "score": 0, "last_activity_date": 1479903394, "creation_date": 1479899326, "last_edit_date": 1531164843, "question_id": 40762806, "link": "https://stackoverflow.com/questions/40762806/connecting-sql-and-excel", "title": "Connecting SQL and Excel", "body": "<p>I'm trying to establish a link between Excel and SQL however I get the following error message \"Command text was not set for the command object\" when running the VBA code. I'm very new to VBA, can anyone see where I am going wrong please?</p>\n\n<p>FYI I have copied the SQL code in Sheet2.Range(\"A2\") </p>\n\n<p>Here is my VBA code.</p>\n\n<pre><code>Sub Update()\n\nDim link As New ADODB.Connection\nDim login As String\nDim SQLSyntax As String\nDim Basket As New ADODB.Recordset\n\nlogin = \"DRIVER=SQL Server Native Client 10.0;SERVER=xxxxxx;UID=sa;PWD=xxxxx;APP=2007 Microsoft Office system;WSID=PC3;DATABASE=ST_L1;\"\nSQLSyntax = Sheet2.Range(\"A2\").Text\n\nlink.Open login\nBasket.Open SQLSyntax, link\n\nBasket.Close\nlink.Close\n\nEnd Sub\n</code></pre>\n\n<p>My SQL code (which works fine in SQL).  </p>\n\n<pre><code>Select P.spn as [Number],P.[Group],P.Name, isnull(T.Calls,0) as [Calls in last 2 months (excluding internals)], isnull(L.[Internal Calls],0) as [Internal Calls] ,isnull(M.[Last call],0)as [Last call] from ST_L1.dbo.Numbers P\nleft join\n(Select COUNT(*)as [Calls],SPN from ST_L1.dbo.Main where CLI not in (Select CLI from ST_L1.dbo.internalCLI)\nand start between convert (date,getdate()-62 )and convert (date,getdate())\ngroup by SPN)T on T.SPN = P.spn\nleft join (Select max(start)[Last call],SPN from ST_L1.dbo.Main\ngroup by SPN)M on M.SPN = P.spn\nleft join \n(Select COUNT(*)as [Internal Calls],SPN from ST_L1.dbo.Main where CLI in (Select CLI from ST_L1.dbo.internalCLI)\nand start between convert (date,getdate()-62 )and convert (date,getdate())\ngroup by SPN)L on L.SPN = P.spn\nwhere LEFT(P.spn,4) not in ('0870') and P.[Group] in \n('BlaBla', 'BlaBla2') \norder by T.Calls asc,M.[Last call]\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 4, "last_activity_date": 1479898571, "creation_date": 1479898571, "answer_id": 40762506, "question_id": 40762402, "link": "https://stackoverflow.com/questions/40762402/use-a-for-loop-to-fill-a-combobox/40762506#40762506", "title": "Use a For-loop to fill a Combobox", "body": "<p><code>.Additem</code> is a method, not a property you can set. You have to provide the item as an argument, i.e.</p>\n\n<pre><code>.AddItem Sheet2.Cells(5, col)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1479900840, "creation_date": 1479900840, "answer_id": 40763400, "question_id": 40762402, "link": "https://stackoverflow.com/questions/40762402/use-a-for-loop-to-fill-a-combobox/40763400#40763400", "title": "Use a For-loop to fill a Combobox", "body": "<p>as an alternative you could use the <code>List</code> property of <code>ComboBox</code> object and fill it via an array as follows:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    With Sheet1.Range(\"A1\") 'reference the cell that contains the value for the amount of names\n        If .Value &gt; 0 Then Me.ComboBox1.List = GetValues(.Value) '&lt;--| fill ComboBox via its 'List' property passing it the array returned by GetValues() function \n    End With\nEnd Sub\n\nFunction GetValues(nCols As Long) As Variant\n    Dim n As Long\n\n    ReDim vals(1 To nCols) As Variant '&lt;--| size the array to match the amount of names passed in\n    For n = 1 To nCols\n        vals(n) = Sheet2.Cells(5, 2 + 8 * (n - 1)) '&lt;--| fill the array: the first name is in column 2, the next in column 10, etc.\n    Next\n    GetValues = vals '&lt;--| return the filled array\nEnd Function\n</code></pre>\n\n<p>which will also make your code more \"modular\" </p>\n"}], "owner": {"reputation": 69, "user_id": 2177972, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IVMed.jpg?s=128&g=1", "display_name": "Peleus", "link": "https://stackoverflow.com/users/2177972/peleus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1902, "favorite_count": 0, "accepted_answer_id": 40762506, "answer_count": 2, "score": 0, "last_activity_date": 1479900840, "creation_date": 1479898329, "question_id": 40762402, "link": "https://stackoverflow.com/questions/40762402/use-a-for-loop-to-fill-a-combobox", "title": "Use a For-loop to fill a Combobox", "body": "<p>For a project I want to fill a Combobox on a Userform with a variable amount of options. The amount of options depends on an amount given earlier in the sheet. The user will input a value and assign names to all these values. It could be that there are just 2 names, but it could also be that there are 10 for example.</p>\n\n<p>I would like the Combobox to use the value given (amount of names) to fill itself with the names, which are stored at different locations. My current code is presented below, but it gives me the following Compile error and then selects the <code>.AddItem</code> part as source of the error..</p>\n\n<blockquote>\n  <p>Compile error: Expected Function or variable</p>\n</blockquote>\n\n<pre><code>Private Sub UserForm_Initialize()\n'Sheet1.Range(\"A1\") contains the value for the amount of names\n\nIf Sheet1.Range(\"A1\") = 0 Or Sheet1.Range(\"A1\") = \"\" Then\n    'Do Nothing\nElse\n    With ComboBox1\n        For n = 1 To Sheet1.Range(\"A1\")\n            'col determines the column in which the names are found\n            'The first name is in column 2, the next in column 10, etc.\n            col = 2 + 8 * (n - 1)\n            .AddItem = Sheet2.Cells(5, col)\n        Next\n    End With\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Hopefully my problem is clear. I have the feeling that I am already very close to the answer, but I could not find it anywhere using Google..</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1479897806, "post_id": 40762109, "comment_id": 68748824, "body": "have you stepped through the code first ?"}, {"owner": {"reputation": 65, "user_id": 7031315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/973472f52fcf30d963c83c128e10f0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Sub", "link": "https://stackoverflow.com/users/7031315/sub"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1479905470, "post_id": 40762109, "comment_id": 68754208, "body": "Yes, but I didn&#39;t found anything that might cause it and the program doesn&#39;t give me any kind of error."}, {"owner": {"reputation": 65, "user_id": 7031315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/973472f52fcf30d963c83c128e10f0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Sub", "link": "https://stackoverflow.com/users/7031315/sub"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1479914607, "post_id": 40762109, "comment_id": 68760477, "body": "I fixed the issue by adding some format and page layout code, but now if I run the other macro, not the macro which I discussed above, I get incredible gibberish. Here is an example: &#249;R&lt;2z&#250;]&#171;&#246;\u02dc&#251;&quot;\u0161 q x&#249;$&#189;&#233;\u0152&#204;&#189;&#249;l {y F&#235;&#217;tu &#231;&#241;\u02c6{&#252;&#198;&#231;.&#240;&#195;&#240;&#240;&#220;&#181;a&#188;&#180;LP&#206;&#228;&#161;W\u2021/worksheets/_rels/sheet1.xml.rels .  The document is filled with this. What is this and how do I get rid of this? The expected outcome should have been several charts. Is it because  I ran a macro on the original logfile, backed it up and then I ran it  again with an different macro?"}, {"owner": {"reputation": 65, "user_id": 7031315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/973472f52fcf30d963c83c128e10f0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Sub", "link": "https://stackoverflow.com/users/7031315/sub"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1480434099, "post_id": 40762109, "comment_id": 68955273, "body": "I also fixed the issue above."}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1480437827, "post_id": 40762109, "comment_id": 68957937, "body": "well done! what did you do?"}, {"owner": {"reputation": 65, "user_id": 7031315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/973472f52fcf30d963c83c128e10f0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Sub", "link": "https://stackoverflow.com/users/7031315/sub"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1483714376, "post_id": 40762109, "comment_id": 70222079, "body": "A bit late, but I will post the answer shortly."}], "owner": {"reputation": 65, "user_id": 7031315, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/973472f52fcf30d963c83c128e10f0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Sub", "link": "https://stackoverflow.com/users/7031315/sub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479897577, "creation_date": 1479897577, "question_id": 40762109, "link": "https://stackoverflow.com/questions/40762109/cannot-edit-files-when-opened-via-msofiledialogopen-in-vba-for-excel-2016", "title": "Cannot edit files when opened via msoFileDialogOpen in VBA for Excel 2016", "body": "<p>What I'm trying to do is open a file with the .csv extension, search for a string and then replace it with another string. I did this via msoFileDialogOpen and Selection.Replace. Windows Explorer opens and I can search, but the data in the .csv files doesn't display in Excel, no matter what I do. Funny thing is, I have another macro with the exact same msoFileDialogOpen code and there it works. Also tried to copy/paste this code and adjust it, but nothing.</p>\n\n<p>I really have no idea what this is and how to fix it. I tried different codes, but unfortunately they don't work. Here is my code:</p>\n\n<pre><code>     Private Sub Comma()\n    ' Opens the Windows File Explorer, so you can select csv files\n        Dim dlgResult\n        Dim ofd As FileDialog\n        Set ofd = Application.FileDialog(msoFileDialogOpen)\n            With ofd\n              .AllowMultiSelect = False\n              .Filters.Clear\n              .Filters.Add \"CSV files\", \"*.csv\", 1\n              .Show\n        If .SelectedItems.Count &lt;&gt; 0 Then\n            dlgResult = .SelectedItems.Item(1)\n        Else\n            MsgBox \"You selected Cancel. Macro will now exit\"\n        Exit Sub\n    End If\n    End With\n' This removes the annoying unnecessary double qoute within the logfiles, so you can actually run the csv macro without screwing everything up\n    dlgResult = \"TEXT;\" &amp; dlgResult\n        With ActiveSheet.QueryTables.Add(Connection:= _\n            dlgResult, _\n            Destination:=Range(\"$A$1:$P$9999\"))\n            Range(\"A1:P5000\").Select\n            Selection.Replace What:=\"\"\"\", Replacement:=\"\", LookAt:=xlPart, _\n                SearchOrder:=xlByRows, MatchCase:=False\n            ThisWorkbook.RefreshAll\n\n            Selection.Replace What:=\",,\", Replacement:=\"\", LookAt:=xlPart, _\n                SearchOrder:=xlByRows, MatchCase:=False\n            ThisWorkbook.RefreshAll\n\n            Selection.Replace What:=\",,\", Replacement:=\",\", LookAt:=xlPart, _\n                SearchOrder:=xlByRows, MatchCase:=False\n            ThisWorkbook.RefreshAll\n\n\n    ' This will overwrite the logfile.\n        ThisWorkbook.SaveCopyAs _\n        Filename:=\"C:\\Dir\\Dir\\Dir\\Dir\\Dir\" &amp; \"\\\" &amp; _\n        ThisWorkbook.Name\n            MsgBox \"File saved in the Logs directory.\"\n\n    ' This will clear the sheet and opens the menu again, so you can continu with the next macro\n    '   Application.DisplayAlerts = False\n    '   Worksheets(\"Sheet1\").Range(\"A1:P5000\").Clear\n    '   Application.DisplayAlerts = True\n        MacroSelect.Show\n    End With\n    End Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "sql-server-2012", "ms-access-2013"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1479899533, "post_id": 40761907, "comment_id": 68750167, "body": "Does the user <code>CIS\\ZAnsari</code> exist on the SQL Server? If you click &quot;Test Data Source&quot;, does that work?"}, {"owner": {"reputation": 23238, "user_id": 2404470, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a1a5377833fe110fd04a7d750822a13c?s=128&d=identicon&r=PG&f=1", "display_name": "Zameer Ansari", "link": "https://stackoverflow.com/users/2404470/zameer-ansari"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1479899842, "post_id": 40761907, "comment_id": 68750422, "body": "@Andre It works <a href=\"https://i.stack.imgur.com/jCqjY.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/jCqjY.png</a>. Can you add this to the question? I have got the privilege issues"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1479900622, "post_id": 40761907, "comment_id": 68750974, "body": "I can, but in that image it says &quot;Client version 09&quot; and in your question it is &quot;Client version 11&quot;. So it seems to be a different DSN?"}, {"owner": {"reputation": 23238, "user_id": 2404470, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a1a5377833fe110fd04a7d750822a13c?s=128&d=identicon&r=PG&f=1", "display_name": "Zameer Ansari", "link": "https://stackoverflow.com/users/2404470/zameer-ansari"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1479903396, "post_id": 40761907, "comment_id": 68752860, "body": "@Andre No, sorry I&#39;m wrong. <code>Test Data Source</code> is failing. Please add <a href=\"https://i.stack.imgur.com/HgoIi.png\" rel=\"nofollow noreferrer\">this image</a>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1479904342, "post_id": 40761907, "comment_id": 68753454, "body": "Secret: you can do it yourself, just add the code manually to your question. E.g. <code>![Test failed](https:&#47;&#47;i.stack.imgur.com&#47;HgoIi.png)</code>"}], "owner": {"reputation": 23238, "user_id": 2404470, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a1a5377833fe110fd04a7d750822a13c?s=128&d=identicon&r=PG&f=1", "display_name": "Zameer Ansari", "link": "https://stackoverflow.com/users/2404470/zameer-ansari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 629, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479908717, "creation_date": 1479897085, "last_edit_date": 1495542852, "question_id": 40761907, "link": "https://stackoverflow.com/questions/40761907/microsoft-sql-server-login-connection-failed-sql-state-28000", "title": "Microsoft SQL Server login. Connection failed: SQL state 28000", "body": "<p>We're quite very new into this space... </p>\n\n<p>So, we've got a few linked tables in MS-Access:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Fp0Y7.png\" alt=\"Linked tables in MS-Access\"></p>\n\n<p>When hovered, they've this detail in the tooltip:</p>\n\n<blockquote>\n  <p>ODBC:DSN=EHSDB_Replica;Trusted_Connection=Yes;APP=Microsoft Office 2013;DATABASE=EHSDB_Replica;TABLE=dbo.Accident</p>\n</blockquote>\n\n<p>Seems like, we've got the DNS configured correctly:</p>\n\n<p><img src=\"https://i.stack.imgur.com/VLVKX.png\" alt=\"DSN configuration\"></p>\n\n<p>When tested, the DSN is also failing:</p>\n\n<p><img src=\"https://i.stack.imgur.com/HgoIi.png\" alt=\"Test failed\"></p>\n\n<p>Whenever we try to open the tables, it throws the below error:</p>\n\n<blockquote>\n  <p>Login failed for user </p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/sFClx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sFClx.png\" alt=\"enter image description here\"></a></p>\n\n<p>We already tried the following:</p>\n\n<ul>\n<li><a href=\"https://dba.stackexchange.com/a/39636\">ODBC Data Source SQL Server Connection - Login Failed For User</a></li>\n<li><a href=\"http://support.microsoft.com/en-in/kb/2121736\" rel=\"nofollow noreferrer\">Error message when you try to authenticate an ODBC connection to your SQL Server 2005 or 2008 SQL Instance by using the \u2018sa\u2019 credentials: \"Login failed for \u2018sa\u2019.\u201d</a></li>\n<li><a href=\"https://stackoverflow.com/a/26774688/7172091\">SQLServer Error: 18546 - SQLState 28000</a></li>\n</ul>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1479897510, "post_id": 40761869, "comment_id": 68748618, "body": "I haven&#39;t used <code>CreateForecastSheet</code>, but looking at the help it contains 10 arguments and you&#39;ve got 11 - you&#39;ve got <code>Timeline</code> in there twice.  Also remove <code>wbk</code> from the start of the line (or remove the space after the wbk and remove the <code>With wbk</code> &amp; <code>End With</code> lines)."}, {"owner": {"reputation": 1, "user_id": 7177485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58528e646d307589d39f9c1882e1e5ff?s=128&d=identicon&r=PG", "display_name": "zmr", "link": "https://stackoverflow.com/users/7177485/zmr"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1479898084, "post_id": 40761869, "comment_id": 68749032, "body": "Tried your suggestions but it says syntax error. However, thanks!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1479899707, "post_id": 40761869, "comment_id": 68750312, "body": "@zmr you didn&#39;t set your <code>wbk</code> in the section of code you shared, where do you set it ?"}], "owner": {"reputation": 1, "user_id": 7177485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58528e646d307589d39f9c1882e1e5ff?s=128&d=identicon&r=PG", "display_name": "zmr", "link": "https://stackoverflow.com/users/7177485/zmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479896990, "creation_date": 1479896990, "question_id": 40761869, "link": "https://stackoverflow.com/questions/40761869/createforecastsheet-expression-in-vba", "title": "CreateForecastSheet expression in VBA", "body": "<p>I am new with VBA and trying to use expression CreateForecastSheet to generate data based on historical data. I run the code below and got a run-time error '91' message for the line where the CreateForecastSheet syntax is. Anybody knows how to solve this? I got this syntax from <a href=\"https://msdn.microsoft.com/en-us/library/office/mt575009.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/mt575009.aspx</a>. Any helps will be appreciated. Thanks!</p>\n\n<pre><code>Sub main()\n\nDim Timeline As Range\nDim Values As Range\nDim ForecastStart, ForecastEnd, ConfInt, Seasonality As Variant\nDim DataCompletion As Variant\nDim Aggregation As Variant\nDim ChartType As Variant\nDim ShowStatsTable As Variant\nDim wbk As Workbook\n\nSet Timeline = Sheet4.Range(\"L2:L366\")\nSet Values = Sheet4.Range(\"N2:N366\")\nForecastStart = 367\nForecastEnd = 732\nConfInt = 0.9\nSeasonality = 1\nDataCompletion = 1\nAggregation = 1\nChartType = 0\nShowStatsTable = True\n\nWith wbk\nwbk .CreateForecastSheet(Timeline, Timeline, Values, ForecastStart, ForecastEnd, ConfInt, Seasonality, DataCompletion, Aggregation, ChartType, ShowStatsTable)\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 105, "user_id": 4712453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rLDEr.jpg?s=128&g=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/4712453/nautilus"}, "edited": false, "score": 0, "creation_date": 1479899937, "post_id": 40762660, "comment_id": 68750483, "body": "Strange it worked well in all my tests, nevertheless just make an edit try now and let me know..."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 2, "last_activity_date": 1479988128, "last_edit_date": 1592644375, "creation_date": 1479898938, "answer_id": 40762660, "question_id": 40761751, "link": "https://stackoverflow.com/questions/40761751/excel-vba-execute-code-in-newly-created-workbook/40762660#40762660", "title": "Excel VBA execute code in newly created workbook", "body": "<p>When copying a worksheet with no <code>Destination</code> excel creates a <code>New Workbook</code>, and the <code>New Workbook</code> with its only <code>Worksheet</code> are active.</p>\n<p><strong>EDIT:</strong> I just realized that in the final code these lines from the original code:</p>\n<pre><code>'Copy the &quot;Print&quot; sheet\n Worksheets(&quot;Print&quot;).Copy\n</code></pre>\n<p>Were moved inside the</p>\n<pre><code>With ActiveWorkbook\n</code></pre>\n<p>That was previously referring to the <code>New Workbook</code> created by the <code>Worksheet.Copy</code> and that now refers to the <code>Source Workbook</code></p>\n<p>So let see what the Op's final code is actually doing:</p>\n<p>Here the <code>ActiveWorkbook</code> is the [Source Workbook] and the <code>ActiveSheet</code> <em>must be [Print]</em></p>\n<pre><code>With ActiveWorkbook\n</code></pre>\n<p>This copies the <code>ActiveSheet</code> creating a <code>New Workbook</code> with only one sheet</p>\n<pre><code>     ActiveSheet.Copy\n    \n</code></pre>\n<p>These lines are affecting the <code>ActiveSheet</code> [Print] in the [Source Workbook].\nNot because of the <code>With</code> statement but because <em>it's the one active</em></p>\n<pre><code>    Cells.Copy\n    Range(&quot;A1&quot;).PasteSpecial Paste:=xlPasteValues\n    Application.CutCopyMode = False\n</code></pre>\n<p>The commands within a <code>With</code> intended to affect object that it refers to must start with a dot [.]; however these lines are invalid because Cells and Range are not Methods nor Properties of the Workbook Object, thus en error would have been triggered.</p>\n<blockquote>\n<p><strong>With Statement</strong></p>\n<p>Executes a series of statements on a single object or a user-defined type.</p>\n<p><em>(from the msdn.microsoft.com help)</em></p>\n</blockquote>\n<p>This saves the Workbook referred by the <code>With</code> statement, <em>which still has the formulas</em></p>\n<pre><code>   'Save the file as new\n   .SaveAs FileName:=&quot;C:\\&quot; &amp; FileName\n\nEnd With\n</code></pre>\n<p>Try this code:</p>\n<pre><code>Sub SaveInvoice_TEST_1()\n'Create a filename based on invoicenumber\nDim FileName As String\n    With ThisWorkbook\n        FileName = .Sheets(&quot;Sale&quot;).Range(&quot;C3&quot;).Value\n        'Copy the &quot;Print&quot; sheet\n        .Worksheets(&quot;Print&quot;).Copy\n    End With\n    \n    With ActiveWorkbook\n        Rem Replace Formulas with Values\n        .Sheets(1).UsedRange.Value = .Sheets(1).UsedRange.Value2\n        'Save the file as new\n        .SaveAs FileName:=&quot;C:\\&quot; &amp; FileName\n    End With\n    End Sub\n</code></pre>\n<p>Suggest to read the following pages to gain a deeper understanding of the resources used:</p>\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx\" rel=\"nofollow noreferrer\">With Statement</a></p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 4712453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rLDEr.jpg?s=128&g=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/4712453/nautilus"}, "edited": false, "score": 0, "creation_date": 1479899656, "post_id": 40762745, "comment_id": 68750264, "body": "Well, That&#39;s the strange thing. ActiveSheet.Copy does create a copy but it doesn&#39;t seem to activate the copied file. Except for saving, that is the only function I can run in the &quot;With ActiveWorkbook&quot;"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1479905556, "post_id": 40762745, "comment_id": 68754266, "body": "<code>Sheet.Copy</code> is behaving as as expected, the problem lies in the incorrect use of the <code>With</code> statement. see <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx\" rel=\"nofollow noreferrer\">With Statement</a>"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1479899171, "creation_date": 1479899171, "answer_id": 40762745, "question_id": 40761751, "link": "https://stackoverflow.com/questions/40761751/excel-vba-execute-code-in-newly-created-workbook/40762745#40762745", "title": "Excel VBA execute code in newly created workbook", "body": "<p>Try something like the following. Read the help page for 'ActiveSheet.Copy' - note that it creates a new workbook and activates it</p>\n\n<pre><code>Dim MyWkbk as workbook \n\nset MyWkbk = ActiveWorkbook\nActiveSheet.Copy\n\nWith ActiveWorkbook\n    Cells.Copy\n    Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n    Application.CutCopyMode = False\n\n   'Save the file as new\n   .SaveAs FileName:=\"C:\\\" &amp; FileName\n   '.close\nEnd With\n\n\nMyWkBk.activate\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 4712453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rLDEr.jpg?s=128&g=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/4712453/nautilus"}, "is_accepted": false, "score": 0, "last_activity_date": 1479905589, "creation_date": 1479905589, "answer_id": 40765101, "question_id": 40761751, "link": "https://stackoverflow.com/questions/40761751/excel-vba-execute-code-in-newly-created-workbook/40765101#40765101", "title": "Excel VBA execute code in newly created workbook", "body": "<p>Thanks to @EEM the solution was found.</p>\n\n<p>Here's the code I used:</p>\n\n<pre><code>Sub SaveInvoice()\n    Dim FileName As String\n\n    With ThisWorkbook\n        'Create a filename based on invoicenumber\n        FileName = .Sheets(\"Sale\").Range(\"C3\").Value\n\n        'Copy the \"Print\" sheet\n        .Worksheets(\"Print\").Copy\n    End With\n\n    With ActiveWorkbook\n        'Replace Formulas with Values\n        .Sheets(1).UsedRange.Value = .Sheets(1).UsedRange.Value2\n\n        'Save the file as new\n        .SaveAs FileName:=\"C:\\\" &amp; FileName\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4712453, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rLDEr.jpg?s=128&g=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/4712453/nautilus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 40762660, "answer_count": 3, "score": 0, "last_activity_date": 1479988128, "creation_date": 1479896692, "question_id": 40761751, "link": "https://stackoverflow.com/questions/40761751/excel-vba-execute-code-in-newly-created-workbook", "title": "Excel VBA execute code in newly created workbook", "body": "<p>I'm trying to save one worksheet in my excel file to a new file, but without the formula's.</p>\n\n<p>I have this code that is working to get the file saved:</p>\n\n<pre><code>Sub SaveInvoice()\n\n 'Create a filename based on invoicenumber\n Dim FileName As String\n FileName = Sheets(\"Sale\").Range(\"C3\").Value\n\n 'Copy the \"Print\" sheet\n Worksheets(\"Print\").Copy\n\n With ActiveWorkbook\n    'Save the file as new\n    .SaveAs FileName:=\"C:\\\" &amp; FileName\n End With\n\nEnd Sub\n</code></pre>\n\n<p>This works like a charm, however I need to strip out the formula's so I googled and fount this piece of code:</p>\n\n<pre><code>ActiveSheet.Copy\nCells.Copy\nRange(\"A1\").PasteSpecial Paste:=xlPasteValues\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>And this works as well, however once I merge the two pieces of code together the whole function breaks.</p>\n\n<pre><code> With ActiveWorkbook\n    'Transform cells to values\n     ActiveSheet.Copy\n     Cells.Copy\n     Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n     Application.CutCopyMode = False\n\n    'Save the file as new\n    .SaveAs FileName:=\"C:\\\" &amp; FileName\n End With\n</code></pre>\n\n<p>This results in my base worksheet beeing stripped from formula's.</p>\n\n<p>I need to know how I can call the function on the newle created workbook.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 2378895, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/44614b12eb7d2787b2c7ebb50c69a555?s=128&d=identicon&r=PG", "display_name": "user2378895", "link": "https://stackoverflow.com/users/2378895/user2378895"}, "edited": false, "score": 0, "creation_date": 1479897368, "post_id": 40761885, "comment_id": 68748527, "body": "Thanks! I thought about using that but I thought that I could only refer to sheet level names that way. When you autolist members for Activeworkbook, there is no &quot;Range&quot;."}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": false, "score": 1, "last_activity_date": 1479897026, "creation_date": 1479897026, "answer_id": 40761885, "question_id": 40761735, "link": "https://stackoverflow.com/questions/40761735/excel-vba-set-varible-to-workbook-level-named-range/40761885#40761885", "title": "Excel vba set varible to workbook level named range", "body": "<p>For example:</p>\n\n<pre><code>Set rngLookup = Range(\"Lookup\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 311, "user_id": 2378895, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/44614b12eb7d2787b2c7ebb50c69a555?s=128&d=identicon&r=PG", "display_name": "user2378895", "link": "https://stackoverflow.com/users/2378895/user2378895"}, "edited": false, "score": 0, "creation_date": 1479898438, "post_id": 40761977, "comment_id": 68749324, "body": "Thanks, that makes sense. Still don&#39;t understand why @Limak approach works. The range object doesn&#39;t apply to workbooks, so how can it be used to refer to workbook level named ranges? Seems to me that it would only work with sheet level names...."}], "tags": [], "owner": {"reputation": 246, "user_id": 6788933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d2b2dc42c7da9169786fe754ce86cd4?s=128&d=identicon&r=PG&f=1", "display_name": "user6788933", "link": "https://stackoverflow.com/users/6788933/user6788933"}, "is_accepted": false, "score": 3, "last_activity_date": 1479898153, "last_edit_date": 1479898153, "creation_date": 1479897219, "answer_id": 40761977, "question_id": 40761735, "link": "https://stackoverflow.com/questions/40761735/excel-vba-set-varible-to-workbook-level-named-range/40761977#40761977", "title": "Excel vba set varible to workbook level named range", "body": "<p>You are trying to set a Name object to a Range object. </p>\n\n<p>Use </p>\n\n<pre><code>Set rngLookup = ActiveWorkbook.Names(\"Lookup\").RefersToRange\n</code></pre>\n\n<p>Check this:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff834918.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff834918.aspx</a></p>\n"}], "owner": {"reputation": 311, "user_id": 2378895, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/44614b12eb7d2787b2c7ebb50c69a555?s=128&d=identicon&r=PG", "display_name": "user2378895", "link": "https://stackoverflow.com/users/2378895/user2378895"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1479898153, "creation_date": 1479896667, "question_id": 40761735, "link": "https://stackoverflow.com/questions/40761735/excel-vba-set-varible-to-workbook-level-named-range", "title": "Excel vba set varible to workbook level named range", "body": "<p>I have a workbook level named range \"Lookup\" that is 2 columns. It will be used as find/replace pairs.  When I try to set a range variable to the named range, I get a type mismatch error. How do you set a variable to a workbook level named range?</p>\n\n<pre><code>Sub UpdateResults()\nDim rngLookup As Range, rngUpdate As Range, sFrom As String, sTo As String, iLookupRowCount As Long, iRow As Long\nSet rngLookup = ActiveWorkbook.Names(\"Lookup\")\nIf rngLookup Is Nothing Then GoTo ExitSub\n\nSet rngUpdate = ActiveWorkbook.Names(\"Resource_File\")\nIf rngUpdate Is Nothing Then GoTo ExitSub\n\niLookupRowCount = rngLookup.Rows.Count\nIf iLookupRowCount &lt; 1 Then GoTo ExitSub\n\nFor iRow = 1 To iLookupRowCount\n    sFrom = rngLookup.Cells(iRow, 1)\n    sTo = rngLookup.Cells(iRow, 2)\nDebug.Print sFrom\nDebug.Print sTo\nNext iRow\n\n\nExit Sub\nExitSub:\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2076, "user_id": 3347936, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/16bac86a1d4188dce1d6900dd1ede207?s=128&d=identicon&r=PG&f=1", "display_name": "Rockstar", "link": "https://stackoverflow.com/users/3347936/rockstar"}, "edited": false, "score": 0, "creation_date": 1479896073, "post_id": 40761416, "comment_id": 68747614, "body": "How would you determine how many rows should go to file 1 and how many should go to file 2 ?"}, {"owner": {"reputation": 3315, "user_id": 3501291, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89fb241ad4ea9fd549d9a0c89d8d6e8e?s=128&d=identicon&r=PG", "display_name": "otorrillas", "link": "https://stackoverflow.com/users/3501291/otorrillas"}, "reply_to_user": {"reputation": 2076, "user_id": 3347936, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/16bac86a1d4188dce1d6900dd1ede207?s=128&d=identicon&r=PG&f=1", "display_name": "Rockstar", "link": "https://stackoverflow.com/users/3347936/rockstar"}, "edited": false, "score": 0, "creation_date": 1479896367, "post_id": 40761416, "comment_id": 68747823, "body": "@Rockstar grouping by &quot;Entity&quot;"}, {"owner": {"reputation": 2076, "user_id": 3347936, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/16bac86a1d4188dce1d6900dd1ede207?s=128&d=identicon&r=PG&f=1", "display_name": "Rockstar", "link": "https://stackoverflow.com/users/3347936/rockstar"}, "edited": false, "score": 0, "creation_date": 1479896556, "post_id": 40761416, "comment_id": 68747983, "body": "Okay, so are you sure you have fixed files to be generated based on groupings ? I mean it should be a constant, right?"}, {"owner": {"reputation": 57, "user_id": 5539065, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48dc9059eea3e772e9bbbd80936a7ad4?s=128&d=identicon&r=PG&f=1", "display_name": "dbo", "link": "https://stackoverflow.com/users/5539065/dbo"}, "edited": false, "score": 0, "creation_date": 1479900510, "post_id": 40761416, "comment_id": 68750898, "body": "Yep, the generated files will have always the same structure (same number of columns)"}], "answers": [{"tags": [], "owner": {"reputation": 3315, "user_id": 3501291, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89fb241ad4ea9fd549d9a0c89d8d6e8e?s=128&d=identicon&r=PG", "display_name": "otorrillas", "link": "https://stackoverflow.com/users/3501291/otorrillas"}, "is_accepted": false, "score": 0, "last_activity_date": 1479897160, "creation_date": 1479897160, "answer_id": 40761946, "question_id": 40761416, "link": "https://stackoverflow.com/questions/40761416/excel-vba-generate-fxls-files-based-on-unique-values-in-one-column/40761946#40761946", "title": "Excel VBA : Generate fxls files based on unique values in one column", "body": "<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow noreferrer\"><code>autofilter</code></a> for selecting the rows under the same entity and then, copy each of them to a file.</p>\n\n<p>So, for filtering the rows under <code>A</code> entities, it would be something like:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"A1\").AutoFilter _ \n field:=1, _ \n Criteria1:=\"A\", _ \n VisibleDropDown:=False\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5539065, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48dc9059eea3e772e9bbbd80936a7ad4?s=128&d=identicon&r=PG&f=1", "display_name": "dbo", "link": "https://stackoverflow.com/users/5539065/dbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479897160, "creation_date": 1479895811, "last_edit_date": 1531164843, "question_id": 40761416, "link": "https://stackoverflow.com/questions/40761416/excel-vba-generate-fxls-files-based-on-unique-values-in-one-column", "title": "Excel VBA : Generate fxls files based on unique values in one column", "body": "<p>I have an Excel file containing this sample data.</p>\n\n<pre><code>A          B           C        D\nEntity     Container   login    mail\nA          1           tutu     tutu@tutu.com\nA          1           toto     tutu@toto.com\nA          2           tata     tutu@tata.com\nB          3           tete     tutu@tete.com\nB          4           titi     tutu@titi.com\n</code></pre>\n\n<p>Column A contains 2 Entities (A and B)</p>\n\n<p>I would like generate 2 Excel files based on the unique values in column A of the original above file (so the goal is to generate Entity_A.xls and Entity_B.xls)</p>\n\n<p>Entity_A.xls would contains one sheet (\"Users_Entity_A) containing :</p>\n\n<pre><code>A          B        C\nContainer  login    mail\n1          tutu     tutu@tutu.com\n1          toto     tutu@toto.com\n2          tata     tutu@tata.com\n</code></pre>\n\n<p>Entity_B.xls would contains one sheet (\"Users_Entity_B) containing :</p>\n\n<pre><code>A           B       C\nContainer   login   mail\n3           tete    tutu@tete.com\n4           titi    tutu@titi.com\n</code></pre>\n\n<p>How can I do that in VBA? The range (nb of rows) in the original file can change very often. The numbers of entities too.</p>\n\n<p>Thanks in advance for all your help</p>\n"}, {"tags": ["vba", "excel", "printing", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8220727, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-K6CgA2VNfrg/AAAAAAAAAAI/AAAAAAAAATY/V-PdL-K_maU/photo.jpg?sz=128", "display_name": "David Lewis", "link": "https://stackoverflow.com/users/8220727/david-lewis"}, "is_accepted": false, "score": 0, "last_activity_date": 1500385641, "creation_date": 1500385641, "answer_id": 45168684, "question_id": 40761400, "link": "https://stackoverflow.com/questions/40761400/vba-excel-application-commandbars-executemso-printpreviewandprint-number-of/45168684#45168684", "title": "VBA Excel Application.CommandBars.ExecuteMso (&quot;PrintPreviewAndPrint&quot;) number of copies?", "body": "<p>I have MS Word 2010 running.</p>\n\n<p>Once in Backstage view, I can use SendKeys to type \"alt\", \"P\", \"N\", \"2\" to set the number of copies. Eg.:  </p>\n\n<pre><code>...\nApplication.CommandBars.ExecuteMso (\"PrintPreviewAndPrint\")\nSendKeys \"%PN2\", False\n</code></pre>\n\n<p>This sets the number of copies to 2.  The user can change the number of copies though.  </p>\n"}], "owner": {"reputation": 1, "user_id": 5493515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68f5d6ac3f70b4c5e35dcc6ea1c59ec?s=128&d=identicon&r=PG&f=1", "display_name": "m1nd", "link": "https://stackoverflow.com/users/5493515/m1nd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1285, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500385641, "creation_date": 1479895758, "last_edit_date": 1531164843, "question_id": 40761400, "link": "https://stackoverflow.com/questions/40761400/vba-excel-application-commandbars-executemso-printpreviewandprint-number-of", "title": "VBA Excel Application.CommandBars.ExecuteMso (&quot;PrintPreviewAndPrint&quot;) number of copies?", "body": "<p>i am writing on a short excel vba function to print multiple word documents.</p>\n\n<p>I need to use this code:</p>\n\n<pre><code>...\nSet WordApp = CreateObject(\"Word.Application\")   \nSet wordObj = WordApp.documents.Open(file)\n...\nwordObj.Application.CommandBars.ExecuteMso (\"PrintPreviewAndPrint\")\n</code></pre>\n\n<p>to show the \"Backstage\" Print and Preview Dialog, and prompt the user to confirm the print. </p>\n\n<p>However the number of copies should be set by the function and if possible not be changeable by the user.</p>\n\n<p>I couldn't find anything usefull searching the web. Does anybody know if it's possible to do it?</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"tags": [], "owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "is_accepted": false, "score": 1, "last_activity_date": 1479896402, "creation_date": 1479896402, "answer_id": 40761641, "question_id": 40761288, "link": "https://stackoverflow.com/questions/40761288/loop-through-a-specific-list-of-folders-and-their-subfolders-vba-macro/40761641#40761641", "title": "Loop through a specific list of folders and their subFolders VBA Macro", "body": "<p>Just iterate through the array create a new path fo objFolder every time.\nThis should work:    </p>\n\n<pre><code>Sub Move_Files_To_Folder()\n\nDim Fso As Object, objFolder As Object, objSubFolder As Object\nDim FromPath As String\nDim FileInFolder As Object, i as integer\n\nFoldersName = Array(\"Shipment\", \"Backlog\", \"Released\", \"Unreleased\") \nFromPath = \"C:\\Reports\\\"\nSet Fso = CreateObject(\"Scripting.filesystemobject\")\n\nfor i = 1 to ubound(FoldersName)\n\n  Set objFolder = Fso.GetFolder(FromPath &amp; FoldersName(i) &amp; \"\\\")\n\n  For Each objSubFolder In objFolder.subfolders\n    For Each FileInFolder In objSubFolder.Files\n\n        If InStr(1, FileInFolder.name, \".xlsx\") Or InStr(1, FileInFolder.name, \".zip\") Then\n            FileInFolder.Move (objSubFolder.Path &amp; \"\\2016\\\" &amp; MonthName(Month(FileInFolder.DateCreated)) &amp; \"\\\")\n        End If\n\n    Next FileInFolder\nNext objSubFolder\nnext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1479896619, "creation_date": 1479896619, "answer_id": 40761715, "question_id": 40761288, "link": "https://stackoverflow.com/questions/40761288/loop-through-a-specific-list-of-folders-and-their-subfolders-vba-macro/40761715#40761715", "title": "Loop through a specific list of folders and their subFolders VBA Macro", "body": "<p>You might use a Dictionary object (Scripting library) and look it up for each subfolder name </p>\n\n<pre><code>Dim dic As Object\nSet dic = CreateObject(\"Scripting.dictionary\")\nFor Each word In Array(\"Shipment\", \"Backlog\", \"Released\", \"Unreleased\")\n    dic.Add word, word\nNext\n\nFor Each objSubFolder In objFolder.SubFolders\n    If dic.contains(objSubFolder.Name) Then\n    'etc etc..\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 6667879, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d24125511b2a08c2ed9f433f6412aae4?s=128&d=identicon&r=PG&f=1", "display_name": "JuniorDev", "link": "https://stackoverflow.com/users/6667879/juniordev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1757, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1479896619, "creation_date": 1479895502, "last_edit_date": 1531164843, "question_id": 40761288, "link": "https://stackoverflow.com/questions/40761288/loop-through-a-specific-list-of-folders-and-their-subfolders-vba-macro", "title": "Loop through a specific list of folders and their subFolders VBA Macro", "body": "<p>i have created a solution to Loop through all folders and their SubFolders from a path then move files based on a condition. </p>\n\n<pre><code>Sub Move_Files_To_Folder()\n\nDim Fso As Object, objFolder As Object, objSubFolder As Object\nDim FromPath As String\nDim FileInFolder As Object\n\nFromPath = \"C:\\Reports\\\"\nSet Fso = CreateObject(\"Scripting.filesystemobject\")\nSet objFolder = Fso.GetFolder(FromPath)\n\nFor Each objSubFolder In objFolder.subfolders\n    For Each FileInFolder In objSubFolder.Files\n\n        If InStr(1, FileInFolder.name, \".xlsx\") Or InStr(1, FileInFolder.name, \".zip\") Then\n            FileInFolder.Move (objSubFolder.Path &amp; \"\\2016\\\" &amp; MonthName(Month(FileInFolder.DateCreated)) &amp; \"\\\")\n        End If\n\n    Next FileInFolder\nNext objSubFolder\n\nEnd Sub\n</code></pre>\n\n<p>It works fine but i wanted to adjust my macro to Loop through specific folders under my path and all their SubFolders. </p>\n\n<p>So instead of <code>For Each objSubFolder In objFolder.subfolders</code> I want to create an array list which contains the names of folders under my path to loop through.</p>\n\n<p>Something like this </p>\n\n<pre><code>FoldersName = Array(\"Shipment\", \"Backlog\", \"Released\", \"Unreleased\") \nFor Each objSubFolder In objFolder.FoldersName\nFor Each FileInFolder In objSubFolder.Files\n'rest of my code\nNext FileInFolder\nNext objSubFolder\n</code></pre>\n\n<p>So as a summary, my solution loop through all folders and subFolders under my path and i want to adjust it to a list of folders under my path and all their subFolders. </p>\n\n<p>I have tried to create this <code>array</code> and add it to the <code>For Each</code> but everytime i run i get the error in that line. Any suggestions please how to write it correctly ? Thank you very much.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1479897312, "post_id": 40760985, "comment_id": 68748487, "body": "Sharing your code attempt is a good way to attract other users who want to help you in improving it. We are not a code4free community."}], "answers": [{"tags": [], "owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "is_accepted": false, "score": 0, "last_activity_date": 1479898830, "creation_date": 1479898830, "answer_id": 40762612, "question_id": 40760985, "link": "https://stackoverflow.com/questions/40760985/send-an-email-if-a-cell-in-excel-has-a-specific-date/40762612#40762612", "title": "Send an email, if a cell in Excel has a specific date", "body": "<p>Pretty general question but lets first talk about the possible approach.\n1. Get date from cells in a loop\n2. If date matches with a particular date, call a sub to send mail\n3. Pass corresponding mail ids in parameter (of the sendMail method) to send mail</p>\n\n<p>I won't be able to give you exact code but here is roughly how it will be:</p>\n\n<pre><code>For i = 1 to n\n  strDate = workbooks.worksheet(\"Sheet1\").cells(i,1)\n  emailList = workbooks.worksheet(\"Sheet1\").cells(i,2)\n  if (strDate=expectedDate) then\n     call sendMail(emailList)\n  end if\nNext\n\n\nPublic function sendMail(emailList)\n\nDim OutApp As Object\nDim OutMail As Object\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n\n On Error GoTo err\n\n\n'Now open a new mail\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\nWith OutMail\n.To = emailList\n.CC = \"\"\n.Subject = \"test\"\n.Body = \"the content of the mail\"\nEnd With\nOn Error GoTo 0\n\n\n'set nothing to the objects created\nSet OutMail = Nothing\nSet OutApp = Nothing\n\n'Now set the application properties back to true\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nMsgBox (\"Email has been Sent Successfully\")\nExit Sub\nerr:\n    MsgBox err.Description\nEnd function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7199217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58df99972e087b2e42a3dc3d6450c652?s=128&d=identicon&r=PG&f=1", "display_name": "Sarvesh Agnihotri", "link": "https://stackoverflow.com/users/7199217/sarvesh-agnihotri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520638141, "creation_date": 1479894703, "last_edit_date": 1531164843, "question_id": 40760985, "link": "https://stackoverflow.com/questions/40760985/send-an-email-if-a-cell-in-excel-has-a-specific-date", "title": "Send an email, if a cell in Excel has a specific date", "body": "<ol>\n<li>Excel will have a list of different dates and receivers' email ids across each date.</li>\n<li>If the cell has a specific date, an auto-email will be sent to the email ids mentioned across it.</li>\n<li>The mail is to be sent through Outlook.</li>\n</ol>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1479894929, "creation_date": 1479894929, "answer_id": 40761068, "question_id": 40760551, "link": "https://stackoverflow.com/questions/40760551/vba-saved-a-new-file-how-to-use-this-file-for-coding-further/40761068#40761068", "title": "VBA saved a new file how to use this file for coding further", "body": "<p>are you looking for something along these lines:</p>\n\n<pre><code> ActiveWorkbook.SaveAs Filename:=sPath &amp; x &amp; \"extract\" &amp; \".xlsx\", FileFormat:= _\n</code></pre>\n\n<p>xlOpenXMLWorkbook, CreateBackup:=False\n   ActiveWorkbook.Close False</p>\n\n<p>sPath is defined at the beginning of the macro thus:  (on a mac...)</p>\n\n<pre><code>Dim sPath As String\n</code></pre>\n\n<p>sPath = MacScript(\"(path to desktop folder as string)\")</p>\n"}], "owner": {"reputation": 1, "user_id": 7199112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5bfa74f57d5e75ab44523e299ae1e59?s=128&d=identicon&r=PG&f=1", "display_name": "user666621", "link": "https://stackoverflow.com/users/7199112/user666621"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 14, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479896444, "creation_date": 1479893478, "last_edit_date": 1531164843, "question_id": 40760551, "link": "https://stackoverflow.com/questions/40760551/vba-saved-a-new-file-how-to-use-this-file-for-coding-further", "title": "VBA saved a new file how to use this file for coding further", "body": "<p>I saved an Excel file with a name of a dynamically changing cell value. E.g. <code>1Extract</code>, <code>2Extract</code>, <code>3Extract</code>, etc. </p>\n\n<p>How do I activate this new work book for further coding, E.g. <code>windows(DynamicCellValueString &amp; \"Extract\").Activate</code>?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479892535, "post_id": 40759972, "comment_id": 68745222, "body": "what is the sheet&#39;s name that you want your fomula in ? also, to which sheet are you looking to find your <code>LastRow</code> ?"}, {"owner": {"reputation": 1, "user_id": 7155084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf73f82e36d1af1c209bb8c7dcb7506?s=128&d=identicon&r=PG&f=1", "display_name": "Saran", "link": "https://stackoverflow.com/users/7155084/saran"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479892746, "post_id": 40759972, "comment_id": 68745367, "body": "I am in sheet2."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479892856, "post_id": 40759972, "comment_id": 68745450, "body": "<code>sheet2</code> is the name of your worksheet ? or your index ? you are trying to use <code>Vlookup</code> to look for values in corresponding value in Column B to another workbook named <code>Tracking Sheet Opens</code> ?"}, {"owner": {"reputation": 1, "user_id": 7155084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf73f82e36d1af1c209bb8c7dcb7506?s=128&d=identicon&r=PG&f=1", "display_name": "Saran", "link": "https://stackoverflow.com/users/7155084/saran"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479892972, "post_id": 40759972, "comment_id": 68745520, "body": "I am working in sheet 2 and my look up table is in Tracking sheet."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479893266, "post_id": 40759972, "comment_id": 68745722, "body": "not according to your code, in your code you have <code>&#39;[Tracking Sheet Opens.xlsb]Data&#39;!</code> , it means you are trying to look at worksheet &quot;Data&quot; in another workbook &quot;Tracking Sheet Opens.xlsb&quot; (saved as <code>.xlsb</code>) . are both of your worksheets in the same workbook ?"}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1479893311, "post_id": 40759972, "comment_id": 68745748, "body": "If you want to fill down to the last row within column B, then you should change the <code>LastRow</code> variable to <code>xlUp</code> on column B. <code>LastRow = Range(&quot;B&quot; &amp; Rows.Count).End(xlUp).Row</code>"}, {"owner": {"reputation": 1, "user_id": 7155084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf73f82e36d1af1c209bb8c7dcb7506?s=128&d=identicon&r=PG&f=1", "display_name": "Saran", "link": "https://stackoverflow.com/users/7155084/saran"}, "edited": false, "score": 0, "creation_date": 1479893619, "post_id": 40759972, "comment_id": 68745940, "body": "Thanks that&#39;s worked well. But now my result shown only =VLOOKUP(B2,&#39;[Tracking Sheet Opens.xlsb]Data&#39;!$B$1:$J$65530,9,0) to all my rows? I want answer to be displayed"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479893791, "post_id": 40759972, "comment_id": 68746072, "body": "@Saran try the code in my answer below, see if it works like you intended"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7155084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf73f82e36d1af1c209bb8c7dcb7506?s=128&d=identicon&r=PG&f=1", "display_name": "Saran", "link": "https://stackoverflow.com/users/7155084/saran"}, "edited": false, "score": 0, "creation_date": 1479895511, "post_id": 40760539, "comment_id": 68747216, "body": "Hi Shai,thanks for your comments. It worked well. But the results shows only forumla not a result.  means shows only  - =VLOOKUP(B2,&#39;[Tracking Sheet Opens.xlsb]Data&#39;!$B$1:$J$65530,9,0)&quot; in all rows in C column"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1, "user_id": 7155084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf73f82e36d1af1c209bb8c7dcb7506?s=128&d=identicon&r=PG&f=1", "display_name": "Saran", "link": "https://stackoverflow.com/users/7155084/saran"}, "edited": false, "score": 0, "creation_date": 1479895667, "post_id": 40760539, "comment_id": 68747328, "body": "@Saran if your porblem is not solved, i would like to try and help, but I think i am missing some information here. 1. what are the names of the worksheets ? the sheet with this formula (&quot;Sheet2&quot;) ,and where lies the whole data ? what it&#39;s sheet nanme ? are both sheets in the same workbook ?"}, {"owner": {"reputation": 1, "user_id": 7155084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf73f82e36d1af1c209bb8c7dcb7506?s=128&d=identicon&r=PG&f=1", "display_name": "Saran", "link": "https://stackoverflow.com/users/7155084/saran"}, "edited": false, "score": 0, "creation_date": 1479896420, "post_id": 40760539, "comment_id": 68747863, "body": "1. File I am working on Testing 2. lookup value date is Tracking Sheet Opens Sheet name I am working is Sheet 1"}, {"owner": {"reputation": 1, "user_id": 7155084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf73f82e36d1af1c209bb8c7dcb7506?s=128&d=identicon&r=PG&f=1", "display_name": "Saran", "link": "https://stackoverflow.com/users/7155084/saran"}, "edited": false, "score": 0, "creation_date": 1479900770, "post_id": 40760539, "comment_id": 68751069, "body": "I have updated coding as follows:  Now its workings fine.Range(&quot;C2&quot;).Formula = &quot;=VLOOKUP(B2,&#39;Master Data&#39;!A:B,2,0)&quot;                      Selection.TextToColumns Destination:=Range(&quot;C2&quot;), DataType:=xlDelimited, _             TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _             Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _             :=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True                                       Range(&quot;C2:C&quot; &amp; LastRow).FillDown."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1, "user_id": 7155084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf73f82e36d1af1c209bb8c7dcb7506?s=128&d=identicon&r=PG&f=1", "display_name": "Saran", "link": "https://stackoverflow.com/users/7155084/saran"}, "edited": false, "score": 0, "creation_date": 1479901035, "post_id": 40760539, "comment_id": 68751282, "body": "@Saran instead of putting it here as a comment, you can answer you own question, just add another <code>Answer</code> here with your working code. hope I&#39;ve helped"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1479893894, "last_edit_date": 1479893894, "creation_date": 1479893459, "answer_id": 40760539, "question_id": 40759972, "link": "https://stackoverflow.com/questions/40759972/fill-formula-in-c2-to-corresponding-last-row-of-the-b-column/40760539#40760539", "title": "Fill formula in C2 to corresponding last row of the B column", "body": "<p>I am not sure from the PO if the searched range in the <code>VLookup</code> is in \"Tracking\" sheet in the same workbook, or it's in \"Data\" sheet in another workbook named \"Tracking Sheet Opens\" ,so my answer covers both scenarios.</p>\n\n<h2>Code</h2>\n\n<pre><code>Option Explicit\n\nSub CopyVLookupFormulaDown()\n\nDim LastRow As Long\n\nWith Sheets(\"Sheet2\")\n    ' find last row with data in Column A in \"Sheet2\"\n    'LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n    ' from post maybe need to look for last row in Column B\n    LastRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n\n    ' Option 1: check value of cell B2 in \"sheet2\" with the range\n    ' in sheet \"Data\" in another workbook named \"Tracking Sheet Opens\"\n    .Range(\"C2\").Formula = \"=VLOOKUP(B2,'[Tracking Sheet Opens.xlsb]Data'!$B$1:$J$65530,9,0)\"\n\n\n    ' Option 2: check value of cell B2 in \"sheet2\" with the range\n    ' in sheet \"Tracking\" in the same workbook\n    .Range(\"C2\").Formula = \"=VLOOKUP(B2,'Tracking'!$B$1:$J$65530,9,0)\"\n\n    ' same line for both options, copy formula down\n    .Range(\"C2:C\" &amp; LastRow).FillDown\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7155084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf73f82e36d1af1c209bb8c7dcb7506?s=128&d=identicon&r=PG&f=1", "display_name": "Saran", "link": "https://stackoverflow.com/users/7155084/saran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479893894, "creation_date": 1479891775, "last_edit_date": 1531164843, "question_id": 40759972, "link": "https://stackoverflow.com/questions/40759972/fill-formula-in-c2-to-corresponding-last-row-of-the-b-column", "title": "Fill formula in C2 to corresponding last row of the B column", "body": "<p>I am working in a new project and new to VBA. I have to fill formula to C2 to last row on the B column. my code as below</p>\n\n<pre><code>LastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nRange(\"C2\").Select\nRange(\"C2:C\" &amp; LastRow).Formula = \"=VLOOKUP(B2,'[Tracking Sheet Opens.xlsb]Data'!$B$1:$J$65530,9,0)\"\n</code></pre>\n\n<p>This prompt me as error 1004 - method range or object global failed</p>\n\n<p>Pls suggest me to way forward.  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479891622, "post_id": 40759867, "comment_id": 68744652, "body": "you prefer with VBA ? or a formula ?"}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479891640, "post_id": 40759867, "comment_id": 68744658, "body": "Formula would be better."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479894295, "post_id": 40759867, "comment_id": 68746412, "body": "OK, try my formula below"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1479893422, "last_edit_date": 1479893422, "creation_date": 1479892639, "answer_id": 40760271, "question_id": 40759867, "link": "https://stackoverflow.com/questions/40759867/select-next-higher-number-in-array-based-on-a-minimum-criteria/40760271#40760271", "title": "Select next higher number in array based on a minimum criteria", "body": "<p>Using INDEX/MATCH you could restrict the range that's looked at, although I feel there's a better way:  </p>\n\n<p><code>=LARGE(INDEX($B:$B,MATCH($D$1,$A:$A,0)):INDEX($B:$B,COUNTA($A:$A)),COUNTIF(INDEX($B:$B,MATCH($D$1,$A:$A,0)):INDEX($B:$B,COUNTA($A:$A)),\"&gt;\"&amp;$D$2))</code></p>\n\n<p>You could place the INDEX/MATCH into a named range to make the formula shorter.</p>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1479896571, "post_id": 40760766, "comment_id": 68748004, "body": "Yep, I feel there&#39;s a better way to my answer - I really should try waking up before posting an answer."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1479894108, "creation_date": 1479894108, "answer_id": 40760766, "question_id": 40759867, "link": "https://stackoverflow.com/questions/40759867/select-next-higher-number-in-array-based-on-a-minimum-criteria/40760766#40760766", "title": "Select next higher number in array based on a minimum criteria", "body": "<p>You can use <code>COUNTIFS</code> to include multiple criteria, instead of your <code>COUNTIF</code>.</p>\n\n<p>So in Cell D3 put the formula below:</p>\n\n<pre><code>=LARGE(B$1:B$10,COUNTIFS(B$1:B$10,\"&gt;\"&amp;D2,B$1:B$10,\"&gt;\"&amp;D1))\n</code></pre>\n\n<p>It means that the formula is searching for 2 criterias:</p>\n\n<ol>\n<li>Cells Value is larger than value in Cell D2 (<code>Input</code>).</li>\n<li>Cells Value is larger than value in Cell D1 (<code>Minimum</code>).</li>\n</ol>\n"}], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 40760766, "answer_count": 2, "score": 0, "last_activity_date": 1479894108, "creation_date": 1479891447, "last_edit_date": 1531161705, "question_id": 40759867, "link": "https://stackoverflow.com/questions/40759867/select-next-higher-number-in-array-based-on-a-minimum-criteria", "title": "Select next higher number in array based on a minimum criteria", "body": "<p>I have the following Excel spreadsheet:</p>\n\n<pre><code>              A           B              C       D \n1             0         0.99          Minimum:   6\n2             1         0.99          Input:     3\n3             2         2.99          Result:    4.99\n4             3         2.99\n5             4         4.99\n6             5         4.99\n7             6         7.99         \n8             7         7.99\n9             8         9.99 \n10            9         9.99\n</code></pre>\n\n<p>The formula in cell <strong>D3</strong> is:</p>\n\n<pre><code>=LARGE(B$1:B$10,COUNTIF(B$1:B$10,\"&gt;\"&amp;D2))\n</code></pre>\n\n<p>This formula selects the next highest number in the array in\n<strong>Column B</strong> based on the input in cell <strong>D3</strong>.\nFor example:\nIf the input in cell <strong>D3</strong> is <em>3</em> it will select\n4.99 instead of 2.99.\nAll this works perfectly with the formula in cell <strong>D3</strong>.</p>\n\n<p>However, now I want to insert a minimum criteria into this system\nin cell <strong>D1</strong>.\nFor example: If the minimum is 6 the formula in cell <strong>D3</strong> should notice it\nand select 7.99 instead of 4.99.</p>\n\n<p>Do you have any idea how to solve this issue?\nIs there a way to do it without using an array formula?</p>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1479892303, "post_id": 40759788, "comment_id": 68745094, "body": "which line does the error appear on? you can step through your code by pressing the F8 key"}, {"owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "edited": false, "score": 3, "creation_date": 1479894000, "post_id": 40759788, "comment_id": 68746210, "body": "Set objWorkbooks2 = WScript.GetObject(&quot;C:\\rd\\python_scripts\\private_bank_mini3.x&zwnj;&#8203;lsx&quot;) , needs fully qualified path name of the file that contains the object persisted to disk."}, {"owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "edited": false, "score": 2, "creation_date": 1479894352, "post_id": 40759788, "comment_id": 68746450, "body": "but why do you need those pauses?? process is synchronous, workbook.open wont start executing until previous one, objExcel.EnableEvents = False, is finished anyway..."}, {"owner": {"reputation": 13, "user_id": 7158230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935cb3bc448f88539a592d0d147e99ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cocalero", "link": "https://stackoverflow.com/users/7158230/cocalero"}, "edited": false, "score": 0, "creation_date": 1479897321, "post_id": 40759788, "comment_id": 68748494, "body": "Sorry but I don&#39;t understand your comment tsolina: &quot;needs fully qualified path name of the file that contains the object persisted to disk&quot;"}, {"owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "edited": false, "score": 0, "creation_date": 1479898190, "post_id": 40759788, "comment_id": 68749121, "body": "instead &quot;private_bank_mini3.xlsx&quot; this &quot;C:\\rd\\python_scripts\\private_bank_mini3.xlsx&quot;, so complete path"}, {"owner": {"reputation": 13, "user_id": 7158230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935cb3bc448f88539a592d0d147e99ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cocalero", "link": "https://stackoverflow.com/users/7158230/cocalero"}, "edited": false, "score": 0, "creation_date": 1479898506, "post_id": 40759788, "comment_id": 68749385, "body": "Sorry, so according you this following line is wrong ? Set objWorkbook1 = objExcel.Workbooks.Open(&quot;C:\\rd\\python_scripts\\private_bank_m&zwnj;&#8203;ini3.xlsx&quot;)"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "reply_to_user": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "edited": false, "score": 0, "creation_date": 1479898569, "post_id": 40759788, "comment_id": 68749436, "body": "No, @tsolina is saying that the <code>Set objWorkbooks2 = WScript.GetObject(&quot;private_bank_mini3.xlsx&quot;)</code> is wrong"}, {"owner": {"reputation": 13, "user_id": 7158230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935cb3bc448f88539a592d0d147e99ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cocalero", "link": "https://stackoverflow.com/users/7158230/cocalero"}, "edited": false, "score": 0, "creation_date": 1479898791, "post_id": 40759788, "comment_id": 68749599, "body": "But my problem is with the Open function: Set objWorkbook1 = objExcel.Workbooks.Open(&quot;C:\\rd\\python_scripts\\private_bank_m&zwnj;&#8203;ini3.xlsx&quot;)"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1479899491, "post_id": 40759788, "comment_id": 68750129, "body": "Try to create a file with only the lines up to the <code>Set objWorkbook1 = objExcel.Workbooks.Open(&quot;C:\\rd\\python_scripts\\private_bank_m&zwnj;&#8203;\u200c\u200bini3.xlsx&quot;)</code>. See if it works or you still get an error. Your code works just fine on my end"}, {"owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "edited": false, "score": 0, "creation_date": 1479899783, "post_id": 40759788, "comment_id": 68750374, "body": "can you open that document manually?"}, {"owner": {"reputation": 13, "user_id": 7158230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935cb3bc448f88539a592d0d147e99ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cocalero", "link": "https://stackoverflow.com/users/7158230/cocalero"}, "edited": false, "score": 0, "creation_date": 1479900170, "post_id": 40759788, "comment_id": 68750634, "body": "Yes, but my file charge an Add-in and I think this is the problem. Because this code works with a file that doesn&#39;t use this Add-In. How can I manage it please ?"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1479900272, "post_id": 40759788, "comment_id": 68750722, "body": "Which add-in does it trigger?"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "reply_to_user": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 4, "creation_date": 1479900375, "post_id": 40759788, "comment_id": 68750803, "body": "@VictorMoraes Doesn&#39;t matter. Add-ins must be loaded explicitly when instantiating Excel from a script. Possible duplicate of <a href=\"http://stackoverflow.com/q/213375/1630171\">Loading addins when Excel is instantiated programmatically</a>."}, {"owner": {"reputation": 13, "user_id": 7158230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935cb3bc448f88539a592d0d147e99ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cocalero", "link": "https://stackoverflow.com/users/7158230/cocalero"}, "edited": false, "score": 0, "creation_date": 1479900686, "post_id": 40759788, "comment_id": 68751014, "body": "Thank you. So in this case, how can we do this in VB Script please ?"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1479903336, "post_id": 40759788, "comment_id": 68752814, "body": "@AnsgarWiechers thanks for the info, I&#39;ve never had to load add-ins in Excel, so it is good to know that. Sebastian, Ansgar has provided a link with the answer to your question :)"}, {"owner": {"reputation": 13, "user_id": 7158230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935cb3bc448f88539a592d0d147e99ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cocalero", "link": "https://stackoverflow.com/users/7158230/cocalero"}, "edited": false, "score": 0, "creation_date": 1479904263, "post_id": 40759788, "comment_id": 68753424, "body": "Yes, but I am still confuse because the response a VBA script and I don&#39;t know how can I put it in my VBScript"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1479906777, "post_id": 40759788, "comment_id": 68755101, "body": "Instead of the (implicit) <code>Application</code> object that you have in VBA use your (explicit) application object variable (<code>objExcel</code>) in VBScript."}, {"owner": {"reputation": 13, "user_id": 7158230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935cb3bc448f88539a592d0d147e99ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cocalero", "link": "https://stackoverflow.com/users/7158230/cocalero"}, "edited": false, "score": 0, "creation_date": 1479907447, "post_id": 40759788, "comment_id": 68755565, "body": "I have update my code, but I don&#39;t understand how manage it"}, {"owner": {"reputation": 954, "user_id": 3898606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f8b8ea74a1d7fde222a1863b571b71?s=128&d=identicon&r=PG&f=1", "display_name": "oracle certified professional", "link": "https://stackoverflow.com/users/3898606/oracle-certified-professional"}, "edited": false, "score": 1, "creation_date": 1479913486, "post_id": 40759788, "comment_id": 68759720, "body": "I think this is wrong (line 12): <code>Next CurrAddin</code>. Comment out or otherwise remove the <code>CurrAddin</code>"}], "owner": {"reputation": 13, "user_id": 7158230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935cb3bc448f88539a592d0d147e99ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cocalero", "link": "https://stackoverflow.com/users/7158230/cocalero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "closed_date": 1479937080, "answer_count": 0, "score": 0, "last_activity_date": 1479907406, "creation_date": 1479891208, "last_edit_date": 1479907406, "question_id": 40759788, "link": "https://stackoverflow.com/questions/40759788/open-method-of-worksheet-fails", "closed_reason": "Duplicate", "title": "Open Method of Worksheet fails", "body": "<p>I do not understand why there is this error in my VBScript:</p>\n\n<pre><code>'D\u00e9claration des variables\nDim objExcel, objWorkbook, CurrAddin\n'Cr\u00e9ation des Objets\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = True\n\nFor Each CurrAddin In objExcel.AddIns\n    If CurrAddin.Installed Then\n        CurrAddin.Installed = False\n        CurrAddin.Installed = True\n    End If\nNext CurrAddin\n\nSet objWorkbook = objExcel.Workbooks.Open(\"C:\\rd\\python_scripts\\private_bank_mini3.xlsx\")\n'Set objWorkbook = objExcel.Workbooks.Open(\"C:\\rd\\python_scripts\\Test.xlsx\")\n\n'Pause de 10 secondes\nWScript.Sleep 10000\n'Pause de 8 heures\n'WScript.Sleep 28800000\n\n'Enregistrement\nobjExcel.EnableEvents = False\nobjWorkbook.Close False\nobjExcel.EnableEvents = True\n\n'Fermeture de Excel\n'objExcel.Quit\n\n'D\u00e9sallocation m\u00e9moire \nSet objExcel = Nothing\nSet objWorkbook = Nothing\n\n'Fermeture du Script\nWScript.Quit\n</code></pre>\n\n<p>Please find below my error messages:</p>\n\n<p><a href=\"https://i.stack.imgur.com/AB3kb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AB3kb.png\" alt=\"Error message1\"></a></p>\n\n<p>My script works with the file \"Test.xlsx\" but not with the \"private_bank_mini3.xlsx\", the difference between those is the charging of a Add-In at the opening of the second file.</p>\n\n<p>Have you got an idea to manage it please?</p>\n"}, {"tags": ["excel", "vba", "smtp", "office365"], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1479890103, "creation_date": 1479890103, "answer_id": 40759448, "question_id": 40759447, "link": "https://stackoverflow.com/questions/40759447/solution-for-office-365-sending-email-vba/40759448#40759448", "title": "Solution for Office 365 Sending Email (VBA)", "body": "<p>Would like to share the solution, I build to resolve sending email thru Office365 SMTP.</p>\n\n<p>1) We need to build a Custom DLL for Excel</p>\n\n<p>2) Pack the DLL as installer, then install in computer (If you wish to share your macro)</p>\n\n<p>3) Consume the DLL thru Excel VBA</p>\n\n<p>Let get start:</p>\n\n<p>1) Create Custom DLL for Excel (source code)</p>\n\n<p>The important spot make everything work is the domain</p>\n\n<pre><code>client.Credentials = new System.Net.NetworkCredential(Email, Password, \"outlook.com\");\n</code></pre>\n\n<p>If the domains are wrong or empty it will not work.</p>\n\n<pre><code>using System.Net.Mail;\n\nnamespace Eric_Library\n{\n    public class SMTP\n    {\n        public string oSMTP(string Email, string Password, string subject, string htmlBody, \n                            string[] Attachments,\n                            string To, string Cc, string Bcc)\n        {\n            Email = Email.Trim();\n\n        try\n        {\n            if (!Email.EndsWith(\"@outlook.com\", StringComparison.CurrentCultureIgnoreCase))\n                throw new Exception(\"Your domain is not matching\");\n\n            System.Net.Mail.SmtpClient client = new System.Net.Mail.SmtpClient(\"smtp.office365.com\");\n            client.TargetName = \"STARTTLS/smtp.office365.com\";\n            client.UseDefaultCredentials = false;\n\n            //Domain name can be \"company.com\" or \"outlook.com\" or etc\n            client.Credentials = new System.Net.NetworkCredential(Email, Password, \"outlook.com\");\n            client.EnableSsl = true;\n            client.Port = 587;\n            client.DeliveryMethod = System.Net.Mail.SmtpDeliveryMethod.Network;\n\n            System.Net.Mail.MailMessage msg = new System.Net.Mail.MailMessage();\n            msg.From = new MailAddress(Email);\n            msg.CC.Add(Email);\n            msg.Subject = subject;\n            msg.Body = htmlBody;\n            msg.IsBodyHtml = true;\n\n            if (string.IsNullOrEmpty(To))\n                throw new Exception(\"To cannot be blank\");\n            else\n            {\n                To.Replace(\";\", \",\");\n                msg.To.Add(To);\n            }\n\n            if (!string.IsNullOrEmpty(Cc))\n            {\n                Cc.Replace(\";\", \",\");\n                msg.CC.Add(Cc);\n            }\n\n            if (!string.IsNullOrEmpty(Bcc))\n            {\n                Bcc.Replace(\";\", \",\");\n                msg.Bcc.Add(Bcc);\n            }\n\n            if (Attachments.Count() &gt; 0)\n            {\n                foreach (var item in Attachments)\n                {\n                    if (!string.IsNullOrEmpty(item))\n                    {\n                        System.Net.Mail.Attachment attachment;\n                        attachment = new System.Net.Mail.Attachment(item);\n                        msg.Attachments.Add(attachment);\n                    }\n                }\n            }\n\n            client.Send(msg);\n            return \"Message Sent : \" + DateTime.Now.ToString();\n        }\n        catch (Exception ex)\n        {\n            return ex.Message;\n        }\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>*** Remember to check Register for COM interop, else you will not able to add it as Reference in VBA\n<a href=\"https://i.stack.imgur.com/u3IjS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u3IjS.png\" alt=\"enter image description here\"></a></p>\n\n<p>2) Pack the DLL as installer (My project name is Office365 SMTP Library)\nCreate installer is really easy, remember to grap these 2 files into installer, then build it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lBESn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lBESn.png\" alt=\"enter image description here\"></a></p>\n\n<p>3) Consume the DLL thru Excel VBA\nGo to the Program directory, then select the tlb file add it as reference.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ChAPx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ChAPx.png\" alt=\"enter image description here\"></a></p>\n\n<p>--> if you share your macro to other user, make sure they have install the DLL too</p>\n\n<p>--> they do not need to add reference again, Excel will look for that automatically.</p>\n\n<p>Now you can consume the DLL</p>\n\n<pre><code>Private Sub test_oMail()\n\nDim oMsg As Office365_SMTP_Library.SMTP\nSet oMsg = New Office365_SMTP_Library.SMTP\n\nDim nArr_Attach() As String\nReDim nArr_Attach(1)\n\nnArr_Attach(0) = \"C:\\Users\\Public\\Pictures\\Sample Pictures\\Chrysanthemum.jpg\"\nnArr_Attach(1) = \"C:\\Users\\Public\\Pictures\\Sample Pictures\\Koala.jpg\"\n\nDebug.Print oMsg.oSmtp(\"email\", \"password\", _\n                \"Testing Subject\", \"&lt;p&gt;First Paragraph&lt;/p&gt;&lt;p&gt;Second Paragraph&lt;/p&gt;\", _\n                nArr_Attach, \"TO\", \"CC\", \"BCC\")\n\nEnd Sub\n</code></pre>\n\n<p>--> Pass in the attachment as array, so that you can have as much as you wish\n--> but remember the max limit is 30MB for Office365 per email</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8849, "favorite_count": 1, "accepted_answer_id": 40759448, "answer_count": 1, "score": 3, "last_activity_date": 1479890103, "creation_date": 1479890103, "question_id": 40759447, "link": "https://stackoverflow.com/questions/40759447/solution-for-office-365-sending-email-vba", "title": "Solution for Office 365 Sending Email (VBA)", "body": "<p>I have search around for few months, but still getting solution.</p>\n\n<p>Sending Email using CDO for Office365, is not working.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8mdyG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8mdyG.png\" alt=\"enter image description here\"></a></p>\n\n<p>Getting Error like Transport failed to connect or Authentication Failure.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1479889978, "post_id": 40759232, "comment_id": 68743662, "body": "What problem are you having?"}, {"owner": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "reply_to_user": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1479890270, "post_id": 40759232, "comment_id": 68743801, "body": "I want to get Amount and Account variable value copied to sheet ws as it loops through all values the sheet ws should get those values one after another"}, {"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1479890392, "post_id": 40759232, "comment_id": 68743855, "body": "Amount first followed by account?"}, {"owner": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "reply_to_user": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1479890713, "post_id": 40759232, "comment_id": 68744043, "body": "Yes , on the second sheet Amount goes to Range(&quot;E6&quot;) and continuous down on ext amount"}, {"owner": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "reply_to_user": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1479890779, "post_id": 40759232, "comment_id": 68744088, "body": "Account goes to Range(&quot;E6&quot;).offset(0,1) and continuous on next account loop"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "edited": false, "score": 0, "creation_date": 1479891567, "post_id": 40759673, "comment_id": 68744617, "body": "Getting Application defined or object defined error ."}, {"owner": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "edited": false, "score": 0, "creation_date": 1479891598, "post_id": 40759673, "comment_id": 68744638, "body": "I have multiple values in Amount for each account"}, {"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "reply_to_user": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "edited": false, "score": 0, "creation_date": 1479892283, "post_id": 40759673, "comment_id": 68745078, "body": "Which line gives error? Also I thought for each account there are multiple values and you want them listed, one on top of the other?"}, {"owner": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "edited": false, "score": 0, "creation_date": 1479892438, "post_id": 40759673, "comment_id": 68745170, "body": "target.Range(&quot;E5&quot;).End(xlDown).Offset(1, 0) = Cells(rng.Row, col)"}, {"owner": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "edited": false, "score": 0, "creation_date": 1479892490, "post_id": 40759673, "comment_id": 68745196, "body": "But yes you are correct I have multiple account on Column A and each row has multiple amount"}, {"owner": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "edited": false, "score": 0, "creation_date": 1479892577, "post_id": 40759673, "comment_id": 68745255, "body": "In this way we will have unique amount but they might have same account"}, {"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "reply_to_user": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "edited": false, "score": 0, "creation_date": 1479892589, "post_id": 40759673, "comment_id": 68745264, "body": "Do you get any output or does the line throw an error straight away?"}, {"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "reply_to_user": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "edited": false, "score": 0, "creation_date": 1479895301, "post_id": 40759673, "comment_id": 68747080, "body": "Hmmm. It worked for me on my machine. Is <code>target</code> set up correctly e.g. there is a worksheet called <code>updated</code>?. You may have to simplify the code to isolate the error..."}, {"owner": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "edited": false, "score": 0, "creation_date": 1479896783, "post_id": 40759673, "comment_id": 68748137, "body": "Once it reaches to if loop and tries to put the value it errors  out."}, {"owner": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "edited": false, "score": 0, "creation_date": 1479898040, "post_id": 40759673, "comment_id": 68748999, "body": "I have updated the subroutine and question on this page as well."}], "tags": [], "owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1479890845, "creation_date": 1479890845, "answer_id": 40759673, "question_id": 40759232, "link": "https://stackoverflow.com/questions/40759232/vba-two-for-loop-and-collect-the-value-to-second-sheet/40759673#40759673", "title": "VBA Two for Loop and Collect the value to second sheet", "body": "<p>Try this:</p>\n\n<pre><code>Sub Test()\n\nDim source As Worksheet, target As Worksheet, rng As Range, col As Integer, account As Range\n\nSet source = ActiveSheet\nSet target = Worksheets(\"Updated\")\n\nFor Each rng In source.Range(\"A8:A\" &amp; Range(\"A8\").End(xlDown).Row)\n\n    Set account = rng\n\n    For col = 2 To rng.End(xlToRight).Column\n\n        If Cells(rng.Row, col) &lt;&gt; 0 Then\n\n            target.Range(\"E5\").End(xlDown).Offset(1, 0) = Cells(rng.Row, col)\n            target.Range(\"E5\").End(xlDown).Offset(0, 1) = account\n\n        End If\n\n    Next col\n\nNext rng\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7198692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4521cf490bcb39174a8afef3c9b579df?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kumar", "link": "https://stackoverflow.com/users/7198692/a-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480074789, "creation_date": 1479889346, "last_edit_date": 1531164843, "question_id": 40759232, "link": "https://stackoverflow.com/questions/40759232/vba-two-for-loop-and-collect-the-value-to-second-sheet", "title": "VBA Two for Loop and Collect the value to second sheet", "body": "<p>I am trying to get this subroutine working .</p>\n\n<p>I have data in one sheet(ws1) through which i would loop and copy the data if the values are not 0 to sheet(ws).Range(\"E5\").end(xldown).offset(1,0)</p>\n\n<p>Please help</p>\n\n<hr>\n\n<pre><code> Sub Test()\n\n Dim r As Integer\n Dim c As Integer\n Dim amount As Long\n Dim account As Variant\n Dim Acct As Range\n Dim Amt As Range\n Dim ws1 As Worksheet\n Dim target As Range\n Dim ws As Worksheet\n Set ws1 = ActiveSheet \n Set ws = Worksheets(\"Updated\")\n Set target = ws.Range(\"E5:E\" &amp; Range(\"E5\").End(xlDown)).Select\n\n   ws1.Activate\n\n  Range(\"A8\").Select\n\n   For r = 8 To ActiveCell.End(xlDown).Row\n\n  Cells(r, 1).Select\n  account = ActiveCell.Value\n\n   For c = 2 To ActiveCell.End(xlToRight).Column\n\n    ActiveCell.Offset(0, 1).Select        \n    amount = ActiveCell.Value\n\n   If ActiveCell.Value &lt;&gt; 0 Then\n\n    target.Offset(1, 0).Value = amount       \n    target.Range(\"E5\").End(xlDown).Offset(0, 1) = account\n\n    End If\n\n     Next     \n       Next\n\n     ActiveCell.Offset(1, 0).Select\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vbscript"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1479896367, "post_id": 40759211, "comment_id": 68747821, "body": "See <a href=\"http://www.devhut.net/2010/06/23/vbscript-createset-trusted-location-using-vbscript/\" rel=\"nofollow noreferrer\">devhut.net/2010/06/23/&hellip;</a>"}, {"owner": {"reputation": 163, "user_id": 5389466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/cuWpu.jpg?s=128&g=1", "display_name": "Michael Shtefanitsa", "link": "https://stackoverflow.com/users/5389466/michael-shtefanitsa"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1479905761, "post_id": 40759211, "comment_id": 68754399, "body": "it would be enough to write only   <code>Set reg = CreateObject(&quot;wscript.shell&quot;) strLnKey = &quot;HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Secu&zwnj;&#8203;rity\\Trusted Locations\\AllowNetworkLocations&quot; reg.RegWrite strLnKey, 1, &quot;REG_DWORD&quot;</code>&quot;"}], "owner": {"reputation": 163, "user_id": 5389466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/cuWpu.jpg?s=128&g=1", "display_name": "Michael Shtefanitsa", "link": "https://stackoverflow.com/users/5389466/michael-shtefanitsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "closed_date": 1479899645, "answer_count": 0, "score": 1, "last_activity_date": 1479895524, "creation_date": 1479889270, "last_edit_date": 1479895524, "question_id": 40759211, "link": "https://stackoverflow.com/questions/40759211/allow-trusted-location-in-my-network", "closed_reason": "Duplicate", "title": "Allow trusted location in my network", "body": "<p>I try to <strong>allow trusted location</strong> in regestry for my <strong>Excel</strong> in <strong>local network</strong> but when I run it  i have an error of compilation </p>\n\n<pre><code>Public Function AllowNetworkLocations()\nDim strLnKey As String\nDim reg As Object\n\nSet reg = CreateObject(\"wscript.shell\")\nstrLnKey = \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\Trusted Locations\\AllowNetworkLocations\"\nreg.RegWrite strLnKey, 1, \"REG_DWORD\"\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7Nbo7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Nbo7.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word", "selection"], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 3601475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63eb2cefd40f4ce33c7733d7eb74ef53?s=128&d=identicon&r=PG&f=1", "display_name": "Prebsus", "link": "https://stackoverflow.com/users/3601475/prebsus"}, "is_accepted": true, "score": 5, "last_activity_date": 1479890317, "creation_date": 1479890317, "answer_id": 40759502, "question_id": 40759119, "link": "https://stackoverflow.com/questions/40759119/how-to-extend-selection-to-whole-paragraph-via-vba/40759502#40759502", "title": "How to Extend Selection to whole paragraph via VBA", "body": "<p>Try using a different WdUnit like wdParagraph:</p>\n\n<pre><code>Selection.Expand wdParagraph\n</code></pre>\n\n<p>See this link for an overview of the different WdUnits:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff838950.aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff838950.aspx</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1479890554, "creation_date": 1479890554, "answer_id": 40759566, "question_id": 40759119, "link": "https://stackoverflow.com/questions/40759119/how-to-extend-selection-to-whole-paragraph-via-vba/40759566#40759566", "title": "How to Extend Selection to whole paragraph via VBA", "body": "<p>If you know one of the enumerated values then you can use the <code>Object Explorer</code> to find the name of the Enumeration.  By referencing the Enumeration you'll be able to use Intellisense to determine all the valid values.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qUh6w.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qUh6w.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5540, "user_id": 1291538, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b3843851649dc5387a5f75dd34410f35?s=128&d=identicon&r=PG", "display_name": "JustMe", "link": "https://stackoverflow.com/users/1291538/justme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3212, "favorite_count": 0, "accepted_answer_id": 40759502, "answer_count": 2, "score": 2, "last_activity_date": 1479895072, "creation_date": 1479888839, "last_edit_date": 1479895072, "question_id": 40759119, "link": "https://stackoverflow.com/questions/40759119/how-to-extend-selection-to-whole-paragraph-via-vba", "title": "How to Extend Selection to whole paragraph via VBA", "body": "<p>I am using this code to extend selection to whole line on word document, Now I want to extend selection to whole paragraph</p>\n\n<pre><code>Selection.Expand wdLine\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 5514311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c65262ac9d1ec03020e35110f772a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sue Su", "link": "https://stackoverflow.com/users/5514311/sue-su"}, "edited": false, "score": 0, "creation_date": 1480297066, "post_id": 40765850, "comment_id": 68889215, "body": "No, I tested in my lab and another colleagues labs, all works. it just can be reproduced on another machine.  my custom activity invoked on outlook item_read action. when I open the email the action works fine,  just preview activity not works. Is it possible some dll was be disabled that affect this problem? I saw mssphtb.dll be disabled in outlook add-in settings.  Best Regards, Sue."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 261, "user_id": 5514311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c65262ac9d1ec03020e35110f772a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sue Su", "link": "https://stackoverflow.com/users/5514311/sue-su"}, "edited": false, "score": 0, "creation_date": 1480347235, "post_id": 40765850, "comment_id": 68912578, "body": "Again, Outlook <i>thinks</i> your one-off form has a script - take a look at the message with OutlookSpy (<a href=\"http://www.dimastr.com/outspy\" rel=\"nofollow noreferrer\">dimastr.com/outspy</a>) - click IMessage button, look at the SideEffects named property."}, {"owner": {"reputation": 261, "user_id": 5514311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c65262ac9d1ec03020e35110f772a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sue Su", "link": "https://stackoverflow.com/users/5514311/sue-su"}, "edited": false, "score": 0, "creation_date": 1481620971, "post_id": 40765850, "comment_id": 69438843, "body": "Thanks Dmitry. I will take a look at customer&#39;s lab."}, {"owner": {"reputation": 261, "user_id": 5514311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c65262ac9d1ec03020e35110f772a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sue Su", "link": "https://stackoverflow.com/users/5514311/sue-su"}, "edited": false, "score": 0, "creation_date": 1481622135, "post_id": 40765850, "comment_id": 69439549, "body": "I have a question, if this property is 1, I change it to 0 then save message. It will be change back to 1 again, if I re-click the message."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 261, "user_id": 5514311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c65262ac9d1ec03020e35110f772a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sue Su", "link": "https://stackoverflow.com/users/5514311/sue-su"}, "edited": false, "score": 0, "creation_date": 1481647350, "post_id": 40765850, "comment_id": 69456337, "body": "1 is fine (it is seOpenToDelete bit). You want to make sure there is no seHasScript (0x2000)."}, {"owner": {"reputation": 261, "user_id": 5514311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c65262ac9d1ec03020e35110f772a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sue Su", "link": "https://stackoverflow.com/users/5514311/sue-su"}, "edited": false, "score": 0, "creation_date": 1481701439, "post_id": 40765850, "comment_id": 69477695, "body": "Another question, how did you find this property, cause I googled it, I couldn&#39;t found any website described this property."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 261, "user_id": 5514311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c65262ac9d1ec03020e35110f772a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sue Su", "link": "https://stackoverflow.com/users/5514311/sue-su"}, "edited": false, "score": 0, "creation_date": 1481739275, "post_id": 40765850, "comment_id": 69501077, "body": "See <a href=\"https://msdn.microsoft.com/en-us/library/partnercenter/cc842271.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/partnercenter/cc842271.aspx</a>"}, {"owner": {"reputation": 261, "user_id": 5514311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c65262ac9d1ec03020e35110f772a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sue Su", "link": "https://stackoverflow.com/users/5514311/sue-su"}, "edited": false, "score": 1, "creation_date": 1482464098, "post_id": 40765850, "comment_id": 69792269, "body": "Thanks again. By the way Outlook Spy is very powerful, it is a good plug-in for our devs."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1479907744, "creation_date": 1479907744, "answer_id": 40765850, "question_id": 40758624, "link": "https://stackoverflow.com/questions/40758624/outlook-2010-disabled-customize-preview/40765850#40765850", "title": "Outlook 2010 disabled customize preview", "body": "<p>That means your custom one-off form contains a script, or at least Outlook thinks that it does.  </p>\n"}], "owner": {"reputation": 261, "user_id": 5514311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c65262ac9d1ec03020e35110f772a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sue Su", "link": "https://stackoverflow.com/users/5514311/sue-su"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 40765850, "answer_count": 1, "score": -1, "last_activity_date": 1593415153, "creation_date": 1479886912, "last_edit_date": 1593415153, "question_id": 40758624, "link": "https://stackoverflow.com/questions/40758624/outlook-2010-disabled-customize-preview", "title": "Outlook 2010 disabled customize preview", "body": "<p>I wrote a custom form in outlook 2010 that for reprocessing message.  When I focused on an email the preview panel showed \"this item contains active content that cannot be displayed\". But When I double click email and open a new message form everything is ok.</p>\n\n<p>I supposed does any group policy or outlook settings disabled this action?</p>\n\n<p>help me!</p>\n\n<p>Best Regards,\nSue.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479887337, "post_id": 40758586, "comment_id": 68742278, "body": "are you looking to find &quot;testing&quot; only in one cell <code>Cells(row1, 6)</code>  - one cell that consits of Column &quot;F&quot; of current row ?  or the entire row ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479888250, "post_id": 40758586, "comment_id": 68742751, "body": "try the code in my answer below, see if it works for you"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480425434, "post_id": 40758586, "comment_id": 68949050, "body": "did you test any of the answers you got? some feedback would be nice"}, {"owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480574799, "post_id": 40758586, "comment_id": 69021426, "body": "yes the one from clintB worked for me thanks"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480574934, "post_id": 40758586, "comment_id": 69021490, "body": "you do realize that in your case the <code>Instr</code> and <code>Like</code> functions behave the same ? In any way, accept his answer by clicking the little <b>V</b> next to his answer"}], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "is_accepted": true, "score": 0, "last_activity_date": 1479887542, "last_edit_date": 1495539941, "creation_date": 1479887542, "answer_id": 40758776, "question_id": 40758586, "link": "https://stackoverflow.com/questions/40758586/find-text-testing-in-a-particular-cell-and-check-condition/40758776#40758776", "title": "Find text &quot;testing&quot; in a particular cell and check condition", "body": "<p>Use instr instead of search. Its easier to use.</p>\n\n<pre><code> set ws = Sheets(\"BH_Testing Practice_0_FY17_Sale\")\n\n If( InStr(ws.Cells(row1, 1), SearchStr))&gt;0) THEN\n     ...\n END IF\n</code></pre>\n\n<p>Much like the comment posted to this question just recently:\n<a href=\"https://stackoverflow.com/questions/40754813/excel-vba-check-for-specific-value-in-cell\">Excel VBA Check for specific value in cell</a></p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1479887820, "creation_date": 1479887820, "answer_id": 40758841, "question_id": 40758586, "link": "https://stackoverflow.com/questions/40758586/find-text-testing-in-a-particular-cell-and-check-condition/40758841#40758841", "title": "Find text &quot;testing&quot; in a particular cell and check condition", "body": "<p>Using the <code>Like</code> function you can find if a certain cell contains the string of \"testing\" in it. Adding the wilcard sign (<code>*</code>) before and after the \"testing\" means that \"testing\" can appear also in the begining or the end of the entire cell's string.</p>\n\n<p>(I commented some of the cariables in the code, not to get an error)</p>\n\n<h2>Code</h2>\n\n<pre><code>Option Explicit\n\nSub FindTesting()\n\nDim Atdes As Integer\nDim Lamt As Integer\nDim Tcr As Integer\nDim row1    As Long\nDim columnAA As Integer\n\n'OG = 2\n'Oid = 3\nrow1 = 3\nLamt = 10\nTcr = 12\nAtdes = 6\ncolumnAA = 27\n'columnAB = 28\n'columnAC = 29\n'columnAD = 30\n'columnAE = 31\n\nWith Sheets(\"BH_Testing Practice_0_FY17_Sale\")\n    Do While .Cells(row1, 1).Value &lt;&gt; \"\"\n        ' check if current row Column F contains \"testing\"\n        If .Cells(row1, 6) Like \"*testing*\" Then\n            .Cells(row1, columnAA).Value = \"CAT\"\n        End If\n\n        row1 = row1 + 1\n    Loop\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 40758776, "answer_count": 2, "score": 0, "last_activity_date": 1480118757, "creation_date": 1479886761, "last_edit_date": 1480118757, "question_id": 40758586, "link": "https://stackoverflow.com/questions/40758586/find-text-testing-in-a-particular-cell-and-check-condition", "title": "Find text &quot;testing&quot; in a particular cell and check condition", "body": "<p>I have some description text in  column \"F\". e.g. are </p>\n\n<pre><code>f1= P&amp;PES - INTEROPERABILITY TESTING &amp; VALIDATION SRVCS \nf2= CMT-PEL-PRODUCT ENGINEERING \nf3 = AO-TESTING-TESTING EXCELLENCE\n</code></pre>\n\n<p>Now I want to run a loop which will take individual cell into consideration and check if value in particular cells contains \"testing\". </p>\n\n<p>If it contains \"testing\" then there are some conditions which I want to execute. </p>\n\n<p>If it does not contains \"testing\" word then next cell wil be checked like f2 will be checked and so on. </p>\n\n<p>The loop should go on till there is a value. Below is the code I have written but it only works for the first time when it finds the value testing in f1 when it checks for f2 it does not find testing word and then it throws an error error.\"Object variable or with block variable not set\" and the macro stops.</p>\n\n<p>Code below:</p>\n\n<pre><code>Dim Atdes As Integer\nDim Lamt As Integer\nDim Tcr As Integer\n\nOG = 2\nOid = 3\nrow1 = 3\nLamt = 10\nTcr = 12\nAtdes = 6\ncolumnAA = 27\ncolumnAB = 28\ncolumnAC = 29\ncolumnAD = 30\ncolumnAE = 31\n\nDo While Sheets(\"BH_Testing Practice_0_FY17_Sale\").Cells(row1, 1).Value &lt;&gt; \"\"\n\n    ' To find testing word\n    Sheets(\"BH_Testing Practice_0_FY17_Sale\").Cells(row1, 6).Select\n    If Selection.find(What:=\"testing\", After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Activate Then\n\n        Sheets(\"BH_Testing Practice_0_FY17_Sale\").Cells(row1, columnAA).Value = \"CAT\"\n    End If\n    row1 = row1 + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-project"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479998228, "post_id": 40758046, "comment_id": 68800379, "body": "try the code in my answer below and let me know how it works for you :)"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1479998164, "creation_date": 1479998164, "answer_id": 40789038, "question_id": 40758046, "link": "https://stackoverflow.com/questions/40758046/add-a-summary-line-in-ms-project/40789038#40789038", "title": "Add a summary line in MS Project", "body": "<p>Try the code below for a VBA solution, once you select a few tasks (let's say 3) it will add a Summary tasks above them, and indent these 3 tasks inside.</p>\n\n<pre><code>Option Explicit\n\nSub AddSummayTask()\n\nDim t               As Task\nDim i               As Long\nDim RowsSelected()  As Long\nDim FirstRow        As Long\nFirstRow = 10000\n\n' redim the array of tasks selected to maximum size of 1000\nReDim RowsSelected(0 To 1000)\ni = 0\n\n' loop through all selected tasks\nFor Each t In ActiveSelection.Tasks\n\n    ' add current task ID (row) to an array\n    RowsSelected(i) = t.ID\n\n    ' check for the first row\n    If FirstRow &gt; t.ID Then FirstRow = t.ID\n\n    i = i + 1\nNext t\n\n' redim array of tasks selected to actual size\nReDim Preserve RowsSelected(0 To i - 1)\n\n' add a Task before the first selected row\nActiveProject.Tasks.Add Name:=\"Summary test\", before:=FirstRow\n\n' loop through all rows of selected tasks and indent them\nFor i = 0 To UBound(RowsSelected)\n    ActiveProject.Tasks(RowsSelected(i) + 1).OutlineIndent\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 2356484, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/FPJHI.png?s=128&g=1", "display_name": "Frank_Vr", "link": "https://stackoverflow.com/users/2356484/frank-vr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 40789038, "answer_count": 1, "score": -1, "last_activity_date": 1593559501, "creation_date": 1479884708, "last_edit_date": 1593559501, "question_id": 40758046, "link": "https://stackoverflow.com/questions/40758046/add-a-summary-line-in-ms-project", "title": "Add a summary line in MS Project", "body": "<p>How do you add a summary line for a few tasks in a MS Project schedule dynamically?</p>\n\n<pre><code>Dim ProjTasks = pj.ActiveProject.Tasks\n\nProjTasks.Add()\nProjTasks(1).name = \"Summary Line\"\nProjTasks.Add()\nProjTasks(2).name = \"Task1\"\nProjTasks.Add()\nProjTasks(3).name = \"Task2\"\nProjTasks.Add()\nProjTasks(4).name = \"Task3\"\n</code></pre>\n\n<p>Do you select a bunch of tasks then use the \"OutlineIndent\" command (seems cumbersome)?</p>\n"}, {"tags": ["arrays", "vba", "excel", "ms-office"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479883342, "post_id": 40757611, "comment_id": 68740298, "body": "what version of Excel are you using ? French ? what is <code>For i = 1 To ocup(numDis, 1)</code> suppost to be ?"}, {"owner": {"reputation": 15, "user_id": 7065499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf8b68ba72a51b5ffdd3fd658302483?s=128&d=identicon&r=PG&f=1", "display_name": "jf8769", "link": "https://stackoverflow.com/users/7065499/jf8769"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479884129, "post_id": 40757611, "comment_id": 68740650, "body": "I&#39;m using excel 2016 in portuguese! &quot;ocup&quot; it&#39;s a variat array too, but that&#39;s working properly, i will edit the main post to insert it in the code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1479885160, "post_id": 40757611, "comment_id": 68741148, "body": "You never show how <code>tsInicio(i)</code> and <code>tsFim(i)</code> are instantiated. <code>Evaluate(&quot;=ROW(&quot; &amp; tsInicio(i) &amp; &quot;:&quot; &amp; tsFim(i) &amp; &quot;)&quot;)</code> will just return the a number not an array."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7065499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf8b68ba72a51b5ffdd3fd658302483?s=128&d=identicon&r=PG&f=1", "display_name": "jf8769", "link": "https://stackoverflow.com/users/7065499/jf8769"}, "edited": false, "score": 0, "creation_date": 1479885500, "post_id": 40758025, "comment_id": 68741309, "body": "It worked, thank you! Is there another way to retrieve the variables from a variant type array or this is the only one?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 15, "user_id": 7065499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf8b68ba72a51b5ffdd3fd658302483?s=128&d=identicon&r=PG&f=1", "display_name": "jf8769", "link": "https://stackoverflow.com/users/7065499/jf8769"}, "edited": false, "score": 0, "creation_date": 1479886420, "post_id": 40758025, "comment_id": 68741774, "body": "Usually you can also index it in the usual way, but you need to know the number of dimensions, the size of each element, etc. With <code>For Each</code> you  need less prior knowledge."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1479884630, "creation_date": 1479884630, "answer_id": 40758025, "question_id": 40757611, "link": "https://stackoverflow.com/questions/40757611/using-a-variant-array-in-a-loop-error-13-type-mismatch/40758025#40758025", "title": "Using a Variant Array in a loop (error 13 type mismatch)", "body": "<p>Without understanding deeply what you are trying to achieve, obviously each element of tsPeriodo is an variant/array itself, so you end up with some kind of a (non-standard) 2D array. To catch all the elements inside it in your loop, you can try this:</p>\n\n<pre><code>Dim k, l\nFor Each k In tsPeriodo\n    For Each l In k\n      ' doSomething, i.e.\n      variable = \"x_\" &amp; i &amp; \"_\" &amp; j &amp; \"_\" &amp; l\n\n    Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7065499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf8b68ba72a51b5ffdd3fd658302483?s=128&d=identicon&r=PG&f=1", "display_name": "jf8769", "link": "https://stackoverflow.com/users/7065499/jf8769"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 0, "accepted_answer_id": 40758025, "answer_count": 1, "score": 0, "last_activity_date": 1479884630, "creation_date": 1479882956, "last_edit_date": 1479884225, "question_id": 40757611, "link": "https://stackoverflow.com/questions/40757611/using-a-variant-array-in-a-loop-error-13-type-mismatch", "title": "Using a Variant Array in a loop (error 13 type mismatch)", "body": "<p>I'm doing a for loop and need to use a Variant Array type, but i'm getting Error 13 (type mismatch). I want k to be 3, 4 and 5 for the 1st value, and so on (according to variable inspection below). I just don't know how to make vba read the array. I've tried using <code>tsperiodo(i)(j)</code> but it hasn't worked either.</p>\n\n<p>Here is the variant array:</p>\n\n<pre><code>ReDim ocup(1 To numDis, 1 To numSalas) As Variant\n\nFor i = 1 To numDis\n    For j = 1 To numSalas\n        If capacidadeSalas(j) - alunos(i) &gt;= 0 Then\n        ocup(i, j) = 1\n        End If\n    Next\nNext    \n\nReDim tsPeriodo(1 To numDis) As Variant\n\nFor i = 1 To numDis\n    tsPeriodo(i) = Application.Transpose(Evaluate(\"=ROW(\" &amp; tsInicio(i) &amp; \":\" &amp; tsFim(i) &amp; \")\"))\nNext\n</code></pre>\n\n<p>and here is where i want to use it:</p>\n\n<pre><code>For i = 1 To ocup(numDis, 1)\n    For j = 1 To ocup(1, numSalas)\n        For k = 1 To tsPeriodo(i)  'this is where im getting error 13\n            variable = \"x_\" &amp; i &amp; \"_\" &amp; j &amp; \"_\" &amp; k\n        Next\n    Next\nNext\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/yNFZ9.png\" rel=\"nofollow noreferrer\">variable inspection for the tsperiodo(i)</a></p>\n"}, {"tags": ["excel", "parsing", "split", "copy", "vba"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1479893947, "post_id": 40756735, "comment_id": 68746169, "body": "What&#39;s the problem you&#39;re encountering? Will using a formula solve it?"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 6413648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-73RIFpvU6ZY/AAAAAAAAAAI/AAAAAAAAAYM/-8d5vCMj-EQ/photo.jpg?sz=128", "display_name": "Mark Wittkowski", "link": "https://stackoverflow.com/users/6413648/mark-wittkowski"}, "is_accepted": false, "score": 0, "last_activity_date": 1479950780, "creation_date": 1479950780, "answer_id": 40776725, "question_id": 40756735, "link": "https://stackoverflow.com/questions/40756735/vba-copy-split-part-of-cell-in-one-column-into-a-new-column/40776725#40776725", "title": "VBA - copy (split) part of cell in one column into a new column", "body": "<pre><code>Sub Transfer()\nDim LastRow As Long\nDim y As Integer\n  Dim x As Integer\n\nWith ActiveSheet\n    LastRow = .Cells(.Rows.Count, \"k\").End(xlUp).Row\nEnd With\ny = 1\n\nFor x = 1 To LastRow\n  range(\"k\" &amp; y).Select\n  ActiveCell.Offset(0, 7) = Left(range(\"k\" &amp; y), 10)\n   y = y + 1\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6413648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-73RIFpvU6ZY/AAAAAAAAAAI/AAAAAAAAAYM/-8d5vCMj-EQ/photo.jpg?sz=128", "display_name": "Mark Wittkowski", "link": "https://stackoverflow.com/users/6413648/mark-wittkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1479950780, "creation_date": 1479879021, "last_edit_date": 1531161705, "question_id": 40756735, "link": "https://stackoverflow.com/questions/40756735/vba-copy-split-part-of-cell-in-one-column-into-a-new-column", "title": "VBA - copy (split) part of cell in one column into a new column", "body": "<p>I have the following date/time in <code>Column K</code></p>\n\n<pre><code>Mon Nov 14 20:15:14 EST 2016\n</code></pre>\n\n<p>I'd like to copy the first 3 parts <code>'Mon Nov 14'</code> and add it to <code>column R</code> for all rows in a workbook with a variable file name.</p>\n\n<p><code>Column K</code> remains unchanged and it is always 10 characters. The date for less than 10 contains a leading 0.</p>\n\n<p>Thanks so much for anyone able to help! </p>\n"}, {"tags": ["vba", "excel", "loops", "debugging", "encoding"], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1479872977, "creation_date": 1479872977, "answer_id": 40755695, "question_id": 40755678, "link": "https://stackoverflow.com/questions/40755678/why-does-my-vba-code-keep-hanging/40755695#40755695", "title": "Why does my VBA code keep hanging?", "body": "<p>Your code hangs because you dont have any check s for null/vbnullstring or 0 values. i.e.:</p>\n\n<pre><code>IF Dis.Cells(x,6).Value &lt;&gt; vbNullString OR Dis.Cells(x,6).Value &lt;&gt; 0 Then....\n</code></pre>\n\n<p>reason this is needed is to keep excle from looping through each cell till out of memory...</p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1479879926, "creation_date": 1479879926, "answer_id": 40756918, "question_id": 40755678, "link": "https://stackoverflow.com/questions/40755678/why-does-my-vba-code-keep-hanging/40756918#40756918", "title": "Why does my VBA code keep hanging?", "body": "<p>Your <code>Do While</code>loop is an infinite loop. Once it catches a cell such that <code>Dis.Cells(x, 9).Value &gt; 1</code> it will loop forever, because inside the loop, nothing will change, neither <code>x</code> nor <code>Dis.Cells(x, 9).Value</code>.</p>\n\n<p>I think you have to think again the logic of the subroutine. Maybe replacing that loop with a simple <code>IF</code> test would do. </p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7193388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c3b4fe1f2dea3c2328f4cd5789a2ef?s=128&d=identicon&r=PG&f=1", "display_name": "Chesca", "link": "https://stackoverflow.com/users/7193388/chesca"}, "edited": false, "score": 0, "creation_date": 1479949107, "post_id": 40757970, "comment_id": 68776649, "body": "Thank you so much @thomas inzina :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1479884445, "creation_date": 1479884445, "answer_id": 40757970, "question_id": 40755678, "link": "https://stackoverflow.com/questions/40755678/why-does-my-vba-code-keep-hanging/40757970#40757970", "title": "Why does my VBA code keep hanging?", "body": "<p>The <code>Do Loop</code> will not exit until <code>Dis.Cells(x, 9).Value &gt; 1</code>.  Inside the <code>Do Loop</code> you change values in <code>Dis.Cells(x, 8)</code>.  If <code>Dis.Range(\"I3:I600\")</code> does not have formulas in it or if anyone of the cells in <code>Dis.Cells(x, 9).Value never exceed1 then the</code>Do Loop` will never exit.  </p>\n\n<pre><code>Do While Dis.Cells(x, 9).Value &gt; 1\n    'IF same amount, get row number to get corresponding date, reference that date\n    For y = 3 To 600\n\n    Next y\nLoop\n</code></pre>\n\n<p>You should also turn off <code>ScreenUpdating</code> while the code is running.  If you don't need any formulas to recalculate then set <code>Calculation</code> to <code>xlCalculationManual</code>.</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n</code></pre>\n\n<p>Why are you using <code>Range.Copy</code>?</p>\n\n<pre><code>Cheque.Cells(y, 2).Copy Destination:=Dis.Cells(x, 8)\n</code></pre>\n\n<p>A direct assignment is much more effecient</p>\n\n<pre><code>Dis.Cells(x, 8) = Cheque.Cells(y, 2)\n</code></pre>\n\n<p>If there are no formula that you need to recalculate then using an array instead should cut you execution time to under 1 second.</p>\n"}], "owner": {"reputation": 1, "user_id": 7193388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c3b4fe1f2dea3c2328f4cd5789a2ef?s=128&d=identicon&r=PG&f=1", "display_name": "Chesca", "link": "https://stackoverflow.com/users/7193388/chesca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 485, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1481970248, "creation_date": 1479872856, "last_edit_date": 1481970248, "question_id": 40755678, "link": "https://stackoverflow.com/questions/40755678/why-does-my-vba-code-keep-hanging", "title": "Why does my VBA code keep hanging?", "body": "<p>I attached two links to a flowchart of how the VBA code should go about, and a screenshot of my two sheets.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hOE9r.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hOE9r.png\" alt=\"image\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/zPDhx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zPDhx.png\" alt=\"image2\"></a></p>\n\n<p>Basically, I have two sheets - \"Disbursements\" &amp; \"Cheque Info\". On the Disbursements' sheet, I need to consider only the rows with count > 1 (column I). For example, I won't consider row 8 of column I, but will consider row 12. Every row that has a count of > 1 should have a value on row H by the end of the run. \nAfter considering which row has a count >1, we check if the corresponding amount (column F) is equal to Cheque Info's column E. Then if for example, for row 12 of disbursements, 1,384.35 is equal to row 9 of Cheque Info. We must get the difference of these dates then store it to a variable \"Current\". But there are many \"1,384.35\" that we must get the minimum difference for the dates, thus a need for a loop. </p>\n\n<p>Again, I need to do loops for each row that has a count of >1 on disbursements' column I, so that I will get the date on Cheque Info (with the same amount) that has a minimum gap from the date on Disbursements sheet. For example, the date that has the least gap for 1/18/2016 (for the amount 1,384.35) is 1/4/2016. </p>\n\n<p>Here is my current code:</p>\n\n<pre><code>Sub F110Loop()\n\nDim x As Integer 'current amount\nDim y As Integer\nDim d As Double 'delta between Disbursement date and Cheque Release date\nDim Current As Integer\nDim Least As Integer\nDim Dis As Worksheet\nDim Cheque As Worksheet\nDim wb As Workbook\n\nSet wb = ThisWorkbook\nSet Dis = wb.Sheets(\"Disbursements\")\nSet Cheque = wb.Sheets(\"Cheque Info\")\nwb.Activate\n\nFor x = 4 To 600\n    Do While Dis.Cells(x, 9).Value &gt; 1\n        'IF same amount, get row number to get corresponding date, reference that date\n        For y = 3 To 600\n            If Dis.Cells(x, 6).Value = Cheque.Cells(y, 5).Value Then\n                'THEN get delta\n                Current = Dis.Cells(x, 4).Value -Cheque.Cells(y, 2)\n                'IF current is less than the least delta\n            ElseIf Current &lt; Least Then\n                'THEN update new value of delta\n                Current = Least\n            Else\n                'copy paste the date (from the least delta row)\n                Cheque.Cells(y, 2).Copy Destination:=Dis.Cells(x, 8)\n            End If\n        Next y\n    Loop\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 1, "creation_date": 1479870850, "post_id": 40755334, "comment_id": 68736528, "body": "When deleting rows you want to go from the bottom to top or skip incrementing row counter when you actually delete a row. Also, if you are not using the return value from MsgBox - don&#39;t use parenthesis. Your comparison logic seems ok. At the very top <code>Dim r, s, i, t As Long</code> means that r, s, i are <code>Variant</code> and only t is <code>Long</code>. So it is those little things that seem to screw your logic up somewhere."}, {"owner": {"reputation": 1, "user_id": 7197689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/600e4417be25762283134c68b9036e7b?s=128&d=identicon&r=PG&f=1", "display_name": "Yoke Meng Wee", "link": "https://stackoverflow.com/users/7197689/yoke-meng-wee"}, "reply_to_user": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1479873038, "post_id": 40755334, "comment_id": 68737043, "body": "Thanks! i redefine the variant, and it works."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1479870977, "creation_date": 1479870977, "answer_id": 40755406, "question_id": 40755334, "link": "https://stackoverflow.com/questions/40755334/compare-cells-to-delete-rows-value-is-true-but-not-deleting-rows/40755406#40755406", "title": "Compare cells to delete rows, value is true but not deleting rows", "body": "<p>When deleting alway go from the last index to the first.  This applies to listboxes, comboboxes, ranges, ...etc.</p>\n\n<h2>If you delete from first to last then you will skip every other row</h2>\n\n<p><a href=\"https://i.stack.imgur.com/C92bb.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C92bb.gif\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/Ii35G.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ii35G.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 7197689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/600e4417be25762283134c68b9036e7b?s=128&d=identicon&r=PG&f=1", "display_name": "Yoke Meng Wee", "link": "https://stackoverflow.com/users/7197689/yoke-meng-wee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479870977, "creation_date": 1479870302, "last_edit_date": 1531164843, "question_id": 40755334, "link": "https://stackoverflow.com/questions/40755334/compare-cells-to-delete-rows-value-is-true-but-not-deleting-rows", "title": "Compare cells to delete rows, value is true but not deleting rows", "body": "<p>I'm trying to compare 2 cells and if its true that row will be deleted, i tried using msgbox to return the value and it shows its true, but row is not deleting.\nThe first cell is derived using formula in 1 sheet and the other is just numbers, does that make a difference?</p>\n\n<pre><code>Dim r, s, i, t As Long\nDim com, cc, bl, acc As Long\nDim rDB, rInput As Range\nDim shDB, shInput As Worksheet\n\nSet shDB = ActiveWorkbook.Sheets(\"Database\")\nSet rDB = shDB.Range(\"A1\", \"T1000\")\n\nSet shInput = ActiveWorkbook.Sheets(\"Data Input\")\nSet rInput = shInput.Range(\"A1\", \"R1000\")\n\nr = 2\nDo While Len(shDB.Cells(r, 1).Formula) &gt; 0\n    com = shInput.Cells(7, 5).Value\n    cc = shInput.Cells(5, 5).Value\n    bl = shInput.Cells(9, 5).Value\n    acc = shInput.Cells(5, 10).Value\n    MsgBox (com &amp; \" \" &amp; shDB.Cells(r, 1).Value &amp; \" \" &amp; cc &amp; \" \" &amp; rDB.Cells(r, 2).Value &amp; \" \" &amp; rDB.Cells(r, 3).Value &amp; \" \" &amp; bl &amp; \" \" &amp; rDB.Cells(r, 4).Value &amp; \" \" &amp; acc)\n    If shDB.Cells(r, 1).Value = com And rDB.Cells(r, 2).Value = cc And rDB.Cells(r, 3).Value = bl And rDB.Cells(r, 4).Value = acc Then\n    shDB.Rows(r).EntireRow.Delete\n    MsgBox (\"deleting rows\")\n    Else\n        r = r + 1\n    End If\nLoop\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1479896775, "post_id": 40755231, "comment_id": 68748130, "body": "It&#39;s not the tables, but the controls on forms and reports that display the values, that must be changed. So iterate Forms, Controls, Property Format and adjust when &#163; is found."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1479938529, "post_id": 40755231, "comment_id": 68773617, "body": "Is this application running in the UK or Australia? In some cases you may be able to change the Regional Settings to get the results you want, however if you&#39;re in the UK, I doubt you want to set them to Australian else unintended results may appear with other products. You can change masks and formats, but that may be brutal. We deployed to 70+ countries, but since all users were &#39;US&#39; employees, we required them to stick with English (US)."}, {"owner": {"reputation": 637, "user_id": 3943525, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/d8275f615ded24fa4ba8464635bc96ad?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis Cianci", "link": "https://stackoverflow.com/users/3943525/lewis-cianci"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1481772680, "post_id": 40755231, "comment_id": 69513694, "body": "@WayneG.Dunn The format field is set to &quot;&#163;#,##0.00;-&#163;#,##0.00&quot; on every single field of type &quot;Currency&quot;, my machine is set to Australia region but it doesn&#39;t help :("}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1481827088, "post_id": 40755231, "comment_id": 69542461, "body": "I just replaced my answer with a description of what I discovered in testing, plus two ways that you can change the number format. One at design time, the other at run time."}], "answers": [{"comments": [{"owner": {"reputation": 637, "user_id": 3943525, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/d8275f615ded24fa4ba8464635bc96ad?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis Cianci", "link": "https://stackoverflow.com/users/3943525/lewis-cianci"}, "edited": false, "score": 0, "creation_date": 1479880420, "post_id": 40755393, "comment_id": 68739202, "body": "Thanks for that John. I did try this approach via VBA in Access but I didn&#39;t get very far.  Do you have any sample code that might help?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 637, "user_id": 3943525, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/d8275f615ded24fa4ba8464635bc96ad?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis Cianci", "link": "https://stackoverflow.com/users/3943525/lewis-cianci"}, "edited": false, "score": 0, "creation_date": 1480020397, "post_id": 40755393, "comment_id": 68810729, "body": "@LewisCianci - what does that mean - you didn&#39;t get very far? Can you show your code you tried and what happened or didn;t happen that was supposed to? DId it change the field formats in the table? Do you have form fields that you need to change as well"}], "tags": [], "owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "is_accepted": false, "score": 0, "last_activity_date": 1479870881, "creation_date": 1479870881, "answer_id": 40755393, "question_id": 40755231, "link": "https://stackoverflow.com/questions/40755231/how-can-i-change-every-format-on-every-field-in-a-database/40755393#40755393", "title": "How can I change every Format on every field in a database?", "body": "<p>You will need to iterate through the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820997.aspx\" rel=\"nofollow noreferrer\">TableDefs</a> and call <a href=\"http://allenbrowne.com/func-DAO.html#SetPropertyDAO\" rel=\"nofollow noreferrer\">SetProperty</a> for each field where you wish to change the format.</p>\n"}, {"comments": [{"owner": {"reputation": 637, "user_id": 3943525, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/d8275f615ded24fa4ba8464635bc96ad?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis Cianci", "link": "https://stackoverflow.com/users/3943525/lewis-cianci"}, "edited": false, "score": 0, "creation_date": 1481840204, "post_id": 40771330, "comment_id": 69548967, "body": "Thanks this looks like the most promising response thus far.  Can I ask a question - are you using the inbuilt access VBA editor to do this stuff?  I am used to the Visual Studio IDE and wonderful intellisense, and the intellisense in Access seems a bit haphazard."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 637, "user_id": 3943525, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/d8275f615ded24fa4ba8464635bc96ad?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis Cianci", "link": "https://stackoverflow.com/users/3943525/lewis-cianci"}, "edited": false, "score": 0, "creation_date": 1481843038, "post_id": 40771330, "comment_id": 69550129, "body": "Yes, I&#39;m just using VBA editor built into Access (Office 2010). You should be able to just copy the code, paste into a module and run it."}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 2, "last_activity_date": 1481827051, "last_edit_date": 1481827051, "creation_date": 1479923939, "answer_id": 40771330, "question_id": 40755231, "link": "https://stackoverflow.com/questions/40755231/how-can-i-change-every-format-on-every-field-in-a-database/40771330#40771330", "title": "How can I change every Format on every field in a database?", "body": "<p>First, please read the following and see if that fixes your issue with the currency formats: <a href=\"http://www.everythingaccess.com/tutorials.asp?ID=Using-the-Currency-field-data-type---without-the-hassle\" rel=\"nofollow noreferrer\">http://www.everythingaccess.com/tutorials.asp?ID=Using-the-Currency-field-data-type---without-the-hassle</a></p>\n\n<p>If not, read on...</p>\n\n<p>After further testing, it seems changing the 'format' property for a field in the table doesn't help you at all with existing forms/reports. Therefore you have two options to solve the format issue: (Method 1) is to change the design view of all forms/reports to use an explicit format; or (Method 2) use some VBA code to set the format property at run-time (when the object is opened). If you have many fields to change, option (1) will be easier. Read the instructions for option (Method 2) then you get to decide.</p>\n\n<p>The following VBA code can loop thru all reports and forms. I currently have it set to only process one form and one report, and I suggest you start small, then when satisfied with the results, process all objects. </p>\n\n<p>Look at each place where I have used '###' as it explains something you can/should change.</p>\n\n<p><strong><em>Method 1:</em></strong></p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\n' NOTE!!!! Look at all comments containing '###' for notes\nSub Fix_Reports_and_Forms()\n    Change_Form_Properties\n    Change_Report_Properties\nEnd Sub\n\nFunction Change_Form_Properties()\nDim dbs         As DAO.Database\nDim ctr         As Container\nDim doc         As Document\nDim frm         As Form\nDim ctl         As Control\nDim ObjectName  As String\nDim i           As Integer\nDim bChg        As Boolean\n\n    Set dbs = CurrentDb\n    Set ctr = dbs.Containers!Forms\n\n    For Each doc In ctr.Documents\n        ObjectName = doc.Name\n\n        '### For testing, I suggest you change the following code to select only ONE Form. Later, remove the IF to do all.\n        If ObjectName = \"Table1\" Then  ' ### If you want to process ALL forms, remove this 'IF' and matching 'End If'\n            DoCmd.OpenForm ObjectName, acViewDesign\n            DoCmd.Minimize\n            Set frm = Forms(doc.Name)\n            Debug.Print \"Form: \" &amp; frm.Name &amp; vbTab &amp; \"Ctls: \" &amp; frm.Controls.Count\n            bChg = False\n\n            For Each ctl In frm.Controls                    ' Loop thru all controls\n                If ctl.ControlType = acTextBox Then         ' Is this a TextBox?\n                    Debug.Print vbTab &amp; ctl.Name &amp; vbTab &amp; \"Type: \" &amp; ctl.ControlType &amp; vbTab &amp; \"Format: \" &amp; ctl.Properties(\"Format\")\n                    If ctl.Properties(\"Format\") &lt;&gt; \"\" Then\n                        ' Add code to test if some currency format\n                        If ctl.Properties(\"Format\") = \"Currency\" Then\n                            ctl.Properties(\"Format\") = \"\u00a3#,##0.00;-\u00a3#,##0.00\"\n                            bChg = True\n                        ElseIf ctl.Properties(\"Format\") = \"$#,##0.00;-$#,##0.00\" Then\n                            ctl.Properties(\"Format\") = \"\u00a3#,##0.00;-\u00a3#,##0.00\"\n                            bChg = True\n                        Else        ' ### any other formats that need to be changed?\n                            ' Add code if needed\n                        End If\n                    Else\n                        ' ### Here I am checking for a specific field name as ControlSource\n                        ' This is not needed if you can identify controls by above code.\n                        If ctl.Properties(\"ControlSource\") = \"CurrFld\" Then\n                            ctl.Properties(\"Format\") = \"\u00a3#,##0.00;-\u00a3#,##0.00\"\n                            bChg = True\n                        End If\n                    End If\n                ElseIf ctl.ControlType = acComboBox Then        ' ### Add code for other control types as needed\n                    ' Do something if necessary\n                End If\n            Next ctl\n            If bChg = True Then     ' Save changes\n                DoCmd.Close acForm, ObjectName, acSaveYes\n            Else                    ' Do not Save\n                DoCmd.Close acForm, ObjectName, acSaveNo\n            End If\n\n        End If              '### Remove if processing ALL Form Names\n    Next doc\n\nEnd Function\n\nFunction Change_Report_Properties()\nDim dbs         As DAO.Database\nDim ctr         As Container\nDim doc         As Document\nDim rpt         As Report\nDim ctl         As Control\nDim ObjectName  As String\nDim i           As Integer\nDim bChg        As Boolean\n\n    Set dbs = CurrentDb\n    Set ctr = dbs.Containers!Reports\n\n    For Each doc In ctr.Documents\n        ObjectName = doc.Name\n\n        '### For testing, I suggest you change the following code to select only ONE Form. Later, remove the IF to do all.\n        If ObjectName = \"Table1\" Then  ' ### If you want to process ALL Reports, remove this 'IF' and matching 'End If'\n            DoCmd.OpenReport ObjectName, acViewDesign\n            DoCmd.Minimize\n            Set rpt = Reports(doc.Name)\n            Debug.Print \"Report: \" &amp; rpt.Name &amp; vbTab &amp; \"Ctls: \" &amp; rpt.Controls.Count\n            bChg = False\n\n            For Each ctl In rpt.Controls\n                If ctl.ControlType = acTextBox Then\n                    Debug.Print vbTab &amp; ctl.Name &amp; vbTab &amp; \"Type: \" &amp; ctl.ControlType &amp; vbTab &amp; \"Format: \" &amp; ctl.Properties(\"Format\")\n                    If ctl.Properties(\"Format\") &lt;&gt; \"\" Then\n                        ' Add code to test if some currency format\n                        If ctl.Properties(\"Format\") = \"Currency\" Then\n                            ctl.Properties(\"Format\") = \"\u00a3#,##0.00;-\u00a3#,##0.00\"\n                            bChg = True\n                        ElseIf ctl.Properties(\"Format\") = \"$#,##0.00;-$#,##0.00\" Then\n                            ctl.Properties(\"Format\") = \"\u00a3#,##0.00;-\u00a3#,##0.00\"\n                            bChg = True\n                        Else        ' any other formats that need to be changed?\n                            ' Add code if needed\n                        End If\n                    Else\n                        '### Here I am checking for a specific field name as ControlSource\n                        If ctl.Properties(\"ControlSource\") = \"CurrFld\" Then\n                            ctl.Properties(\"Format\") = \"\u00a3#,##0.00;-\u00a3#,##0.00\"\n                            bChg = True\n                        End If\n                    End If\n                ElseIf ctl.ControlType = acComboBox Then        ' ### Add code for other control types as needed\n                    ' Do something if necessary\n                End If\n            Next ctl\n            If bChg = True Then     ' Save changes\n                DoCmd.Close acReport, ObjectName, acSaveYes\n            Else                    ' Do not Save\n                DoCmd.Close acReport, ObjectName, acSaveNo\n            End If\n\n        End If              '### Remove if processing ALL Report Names\n    Next doc\n\nEnd Function\n</code></pre>\n\n<p><strong><em>Method 2</em></strong></p>\n\n<p>I found a method of changing the format at Run-Time at this site: <a href=\"http://donnedwards.openaccess.co.za/2009/03/microsoft-access-and-ten-year-old.html\" rel=\"nofollow noreferrer\">http://donnedwards.openaccess.co.za/2009/03/microsoft-access-and-ten-year-old.html</a></p>\n\n<p>The steps involved may prove too difficult if you have many fields that need to have the format changed. Here are the steps required, followed by some sample code.</p>\n\n<ol>\n<li>Open the form/report in design view</li>\n<li>Open the properties for the 'Detail Section'</li>\n<li>In the TAG property, list every control name where you want to change the format, delimited with comma's.</li>\n<li>Add a Form/Report 'On Open' event and insert the code shown below.</li>\n<li>Save the changes</li>\n<li><p>Run the report/form</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub Report_Open(Cancel As Integer)\n'\n'// Fix up CURRENCY formatting\n'\nDim strField As String, strTag As String, n As Long\n    strTag = Me.Detail.Tag\n    If Len(strTag) &gt; 2 Then\n        strTag = strTag &amp; \",\"\n        n = InStr(1, strTag, \",\")\n        While n &gt; 0\n            strField = Mid$(strTag, 1, n - 1)\n            strTag = Mid$(strTag, n + 1)\n            'Me(strField).Format = \"Currency\"\n            Me(strField).Format = \"\u00a3#,##0.00;-\u00a3#,##0.00\"\n            n = InStr(1, strTag, \",\")\n        Wend\n    End If\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 637, "user_id": 3943525, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/d8275f615ded24fa4ba8464635bc96ad?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis Cianci", "link": "https://stackoverflow.com/users/3943525/lewis-cianci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481827051, "creation_date": 1479869543, "question_id": 40755231, "link": "https://stackoverflow.com/questions/40755231/how-can-i-change-every-format-on-every-field-in-a-database", "title": "How can I change every Format on every field in a database?", "body": "<p>I've been tasked with making a series of changes to an access database.  One of them is to change the format in the database from UK to Australian.</p>\n\n<p>The \"cost\" fields in the database have the type of Currency, but the \"Format\" is \"\u00a3#,##0.00;-\u00a3#,##0.00\".  Changing Format to \"Currency\" makes it display as $, but these fields are everywhere across different tables in this database.</p>\n\n<p>Is there a central spot to change it, or if not, is there some VBA that I could write to do this?  I attempted to do it via VBA script, using a For Each iterator over every table, but I don't understand how to change the \"Format\" field via that method.</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "userform", "finance"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1479868860, "post_id": 40755041, "comment_id": 68736057, "body": "the way you call Call_Eur is wrong syntax. You dont have to define the types of parameters when calling a sub."}, {"owner": {"reputation": 29, "user_id": 6935351, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8c191d67faac52f349e29fa7d026303?s=128&d=identicon&r=PG&f=1", "display_name": "Vedant Dhawan", "link": "https://stackoverflow.com/users/6935351/vedant-dhawan"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1479869138, "post_id": 40755041, "comment_id": 68736118, "body": "@A.S.H When I don&#39;t define the parameters it still gives me a syntax error.  What other way could I call it?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1479869649, "post_id": 40755041, "comment_id": 68736256, "body": "I think you need to define (<code>Dim</code>) the variables (<code>exercisePrice</code>, <code>riskfreeRate </code> etc) in a different way, i.e. as global scope."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1479870239, "creation_date": 1479870239, "answer_id": 40755325, "question_id": 40755041, "link": "https://stackoverflow.com/questions/40755041/pricing-a-european-option-using-simulaitons/40755325#40755325", "title": "Pricing a European Option using Simulaitons", "body": "<p>BIG RED FLAG!!!!</p>\n\n<p><a href=\"https://i.stack.imgur.com/TcJs5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TcJs5.png\" alt=\"enter image description here\"></a></p>\n\n<p>When calling a subroutine. you need to pass values into it.  Not redefine it's parameters.</p>\n\n<pre><code>Private Sub CmdOK_Click() '&lt;--- ERROR!!!\n    Call Call_Eur(12.50, 13.43, 14, 33.56, 100, 13.67)\nEnd Sub\n</code></pre>\n\n<p>I prefer removing the parenthesis and not using Call at all.</p>\n\n<pre><code>Private Sub CmdOK_Click() '&lt;--- ERROR!!!\n    Call_Eur 12.50, 13.43, 14, 33.56, 100, 13.67\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6935351, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8c191d67faac52f349e29fa7d026303?s=128&d=identicon&r=PG&f=1", "display_name": "Vedant Dhawan", "link": "https://stackoverflow.com/users/6935351/vedant-dhawan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479870239, "creation_date": 1479868159, "question_id": 40755041, "link": "https://stackoverflow.com/questions/40755041/pricing-a-european-option-using-simulaitons", "title": "Pricing a European Option using Simulaitons", "body": "<p>I have created a user form that allows the user to change the various variables involved in pricing an option (Exercise Price, volatility..etc) along with allowing the user to change the simulations needed to arrive at the Price (or mean price in this case). However, I am unable to call the public subs within my code once I click the <strong>OK</strong> Button. Any suggestions on what I'm doing wrong would be greatly appreciated. [I have also included a picture of my user form below]</p>\n\n<p><a href=\"https://i.stack.imgur.com/xBs5G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xBs5G.png\" alt=\"User Form\"></a>   </p>\n\n<pre><code>   Option Explicit\n      Private cancel As Boolean\n\n        Public Function ShowInputsDialog(currentPrice As Single, _\n        exercisePrice As Single, riskfreeRate As Double, _\n        volatility As Single, duration As Single, simulation As Double) As Boolean\n\n    Call Initialize\n    Me.Show\n    If Not cancel Then\n\n     'Capture the other inputs.\n        currentPrice = txtCurrentPrice.Text\n        exercisePrice = txtExercisePrice.Text\n        riskfreeRate = txtRiskfreeRate.Text\n        volatility = txtVolatility.Text\n        duaration = txtDuration.Text\n        simulation = txtSimulation.Text\n\n     ShowInputsDialog = Not cancel\n    Unload Me\n    End Function\n\n     Public Sub ErrorCheck()\n    ' Perform error checking for user inputs.\n\n    If IsNumeric(currentPrice) = False Or currentPrice &lt; 0 Then\n        MsgBox (\"Please enter a numeric value for the Current Price\")\n    End If\n    If IsNumeric(exercisePrice) = False Or exercusePrice &lt; 0 Then\n         MsgBox (\"Please enter a positive numeric value for the exercise price\")\n    End If\n    If IsNumeric(riskfreeRate) = False Then\n        MsgBox (\"Please enter a numerical value for the risk-free rate\")\n    End If\n    If IsNumeric(volatility) = False Then\n        MsgBox (\"Please enter a numerical value for the Standard deviation\")\n    End If\n    If IsNumeric(duration) = False Then\n        MsgBox (\"Please enter a numerical valye for duration\")\n    End If\n\n    End Sub\n\n    Public Sub Call_Eur(currentPrice As Single, _\n        exercisePrice As Single, riskfreeRate As Double, _\n        volatility As Single, duration As Single, simulation As Double)\n        Dim stockPrice As Single\n        Dim CallcashflowTermination As Single\n        Dim PutcashflowTermination As Single\n        Dim CalldiscountedValue As Double\n        Dim PutdiscountedValue As Double\n        Dim i As Integer\n        Dim CallMean As Double\n        Dim PutMean As Double\n        Dim arrayCallPrice() As Integer\n        Dim arrayPutPrice() As Integer\n    For i = 1 To simulation\n    ' stock price\n    stockPrice = currentPrice * Exp((riskfreeRate - 0.5 * volatility ^ 2) * duration + volatility * Application.WorksheetFunction.Norm_Inv(Rnd(), 0, 1) * Sqr(duration))\n\n    ' option cash flow at termination\n    CallcashflowTermination = Application.WorksheetFunction.Max(0, stockPrice - exercisePrice)\n    PutcashflowTerminatio = Application.WorksheetFunction.Funciton.Max(0, exercisePrice - stockPrice)\n\n    ' discounted value of the option\n    CalldiscountedValue = CallcashflowTermination * Exp(-duration * riskfreeRate)\n    PutdiscountedValue = PutcashflowTermination * Exp(-duration * riskfreeRate)\n\n    arrayCallPrice(i) = CalldiscountedValue\n    arrayPutPrice(i) = PutdiscountedValue\n\n    CallMean = Application.WorsheetFunction.Average(arrayCallPrice)\n    PutMean = Application.WorksheetFunction.Average(arrayPutPrice)\n\n    Next i\n\n    MsgBox \"The Call option price is \" &amp; CallMean &amp; \" the Put option price is \" &amp; PutMean\n\nEnd Sub\n Private Sub CmdCancel_Click()\n    Me.Hide\n    cancel = True\nEnd Sub\n\nPrivate Sub CmdOK_Click() '&lt;--- ERROR!!!\nCall Call_Eur(currentPrice As Single, _\n        exercisePrice As Single, riskfreeRate As Double, _\n        volatility As Single, duration As Single, simulation As Double)\nEnd Sub\n\nPrivate Sub UserForm_Click()\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 4, "creation_date": 1479866859, "post_id": 40754813, "comment_id": 68735530, "body": "<code>If Instr(ws.range(&quot;H&quot; &amp; lastrow), &quot;Total Attachment Size: &quot;) &gt; 0 Then</code> (or just <code>If ws.range(&quot;H&quot; &amp; lastrow) = &quot;Total Attachment Size: &quot; Then</code> if you want it to exactly match)."}], "answers": [{"tags": [], "owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "is_accepted": false, "score": 0, "last_activity_date": 1479897995, "creation_date": 1479897995, "answer_id": 40762267, "question_id": 40754813, "link": "https://stackoverflow.com/questions/40754813/excel-vba-check-for-specific-value-in-cell/40762267#40762267", "title": "Excel VBA Check for specific value in cell", "body": "<p>This is as per your code, if you want to check all H column values then let me know, we can run a loop and clear all cells containing the value</p>\n\n<pre><code>Dim str As String\nOn Error Resume Next\nstr = Application.WorksheetFunction.Search(\"Total Attachment Size: \",Sheet1.Range(\"H\" &amp; Sheet1.Range(\"H500000\").End(xlUp).Row).Value, 1)\n\nIf Err.Number = 0 Then\n\nSheet1.Range(\"H\" &amp; Sheet1.Range(\"H500000\").End(xlUp).Row).ClearContents\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1352, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479969405, "creation_date": 1479866443, "last_edit_date": 1531164843, "question_id": 40754813, "link": "https://stackoverflow.com/questions/40754813/excel-vba-check-for-specific-value-in-cell", "title": "Excel VBA Check for specific value in cell", "body": "<p>I'm having a big trouble with my situation right now. My question is, is there any way I can delete the cell contents if its cell value has a string <code>Total Attachment Size:</code> ? </p>\n\n<p>I have this part but don't know how to proceed. Been searching in the net for any ideas, but unfortunately it is not enough.</p>\n\n<pre><code>dim lastrow as integer\ndim ws as worksheet\n\nset ws = ThisWorkbook.sheets(\"Sheet1\")\n\nlastrow = ws.cells(rows.count, 8).end(xlup).row\n\nif ws.range(\"H\" &amp; lastrow) contains `Total Attachment Size: ` then \n    ws.range(\"H\" &amp; lastrow).clearcontents\n    lastrow = ws.cells(rows.count, 8).end(xlup).row\n\nend if\n</code></pre>\n\n<p>Any help is much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1479866448, "post_id": 40754711, "comment_id": 68735427, "body": "Add your code to the question."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1479866564, "post_id": 40754711, "comment_id": 68735452, "body": "pls try <code>Application.Goto Workbooks(...).Sheets(...).Range(&quot;A2&quot;)</code> (replace the <code>...</code> with the names). Does the error still pop up?"}], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": -1, "last_activity_date": 1479867459, "creation_date": 1479867459, "answer_id": 40754960, "question_id": 40754711, "link": "https://stackoverflow.com/questions/40754711/run-time-error-9-subscript-out-of-range-when-activating-sheet/40754960#40754960", "title": "Run time error 9 Subscript out of range when activating sheet", "body": "<p>Fully referencing things will be more beneficial. PLus all the selecting and activating is super sloppy</p>\n\n<pre><code>Application.Workbooks(\"Book1\").Worksheets(1).Range(\"A1\").Value = 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 3049674, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b4798191d021ad8608cf2ad82c0282d2?s=128&d=identicon&r=PG&f=1", "display_name": "user3049674", "link": "https://stackoverflow.com/users/3049674/user3049674"}, "edited": false, "score": 0, "creation_date": 1479915300, "post_id": 40754977, "comment_id": 68760961, "body": "Thanks Dirk. This fixed it!"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 3, "last_activity_date": 1479867606, "creation_date": 1479867606, "answer_id": 40754977, "question_id": 40754711, "link": "https://stackoverflow.com/questions/40754711/run-time-error-9-subscript-out-of-range-when-activating-sheet/40754977#40754977", "title": "Run time error 9 Subscript out of range when activating sheet", "body": "<p>Simple typo:</p>\n\n<p><code>draftProcedures</code> is the \"codename\" of the sheet. But the <code>Sheets()</code> needs the \"sheet name\"</p>\n\n<p>Simply change your</p>\n\n<pre><code>Sheets(\"draftProcedures\").Activate\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Sheets(\"ProceduresInDraft\").Activate\n</code></pre>\n\n<p>or</p>\n\n<pre><code>draftProcedures.Activate\n</code></pre>\n\n<p>;)</p>\n"}], "owner": {"reputation": 3, "user_id": 3049674, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b4798191d021ad8608cf2ad82c0282d2?s=128&d=identicon&r=PG&f=1", "display_name": "user3049674", "link": "https://stackoverflow.com/users/3049674/user3049674"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4988, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1479869095, "creation_date": 1479865461, "last_edit_date": 1479869095, "question_id": 40754711, "link": "https://stackoverflow.com/questions/40754711/run-time-error-9-subscript-out-of-range-when-activating-sheet", "title": "Run time error 9 Subscript out of range when activating sheet", "body": "<p><img src=\"https://i.stack.imgur.com/f0eZg.png\" alt=\"Here is my Code\">  </p>\n\n<p><img src=\"https://i.stack.imgur.com/dpOHb.png\" alt=\"After Debugging\"></p>\n\n<p>When I try to activate the draftProcedure sheet as the image shows, I get a run time error(even though there are no spelling mistakes). But it runs with no problems when I use another sheet in the same worksheet. What could be my problem here? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 559, "user_id": 3703566, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100007694648240/picture?type=large", "display_name": "Sami", "link": "https://stackoverflow.com/users/3703566/sami"}, "edited": false, "score": 3, "creation_date": 1479863584, "post_id": 40754436, "comment_id": 68734718, "body": "what happens if you declare the ticker=0 before the for loop?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1479864068, "post_id": 40754436, "comment_id": 68734841, "body": "That&#39;s a truckload of code. You should narrow down on the issue to make a question people will want to answer. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 4, "creation_date": 1479864261, "post_id": 40754436, "comment_id": 68734887, "body": "This is beside the point, but this line is bad form: <code>Dim counter, counter1, counters, duplicateCount, ticker As Long</code>.  (all variables <i>except</i> <code>ticker</code> are implied as Variant type. only <code>ticker</code> is <code>Long</code> data type).  Your other declaration statements suffer the same fate."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1479864397, "post_id": 40754436, "comment_id": 68734923, "body": "Also, the screenshot doesn&#39;t really illustrate the problem you describe. Have you put a breakpoint on <code>ticker = (1+ticker)</code> in order to see how many times that statement is executing? And then to observe whether its value changes (as it should)? I suspect your problem is elsewhere, and merely diagnosed improperly."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 559, "user_id": 3703566, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100007694648240/picture?type=large", "display_name": "Sami", "link": "https://stackoverflow.com/users/3703566/sami"}, "edited": false, "score": 1, "creation_date": 1479864831, "post_id": 40754436, "comment_id": 68735028, "body": "On closer review, @Sami&#39;s point is a good one.  At each iteration of <code>i</code>, you reset <code>ticker=0</code>. Now, you could still increment within <code>j</code> loop, but right now it&#39;s not clear what cases are observed as failure. Add simple <code>Debug.Print</code> statements ahead of the <code>ticker = (1+ticker)</code> statement and see if that helps narrow down the logical error(s)?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1479868647, "post_id": 40754436, "comment_id": 68736002, "body": "The screenshot does exactly show your mistake. Try: <code>Dim i As Byte: i = 1: Stop: i = (i + 1): Stop</code>. At the first <code>Stop</code> <code>i</code> is 1. Evaluating the braces <code>(i + 1)</code> becomes correctly <code>(1 + 1)</code> which is 2. but that does not mean that <code>i</code> is 2 at that point (just hovering over <code>i</code> shows <code>i = 1</code>). And at the second <code>Stop</code> (now <code>i</code> IS 2) it evaluates to <code>(i + 1) = 3</code> which is correct because <code>i</code> is 2 and <code>(2 + 1)</code> is 3. I am sure that the code workes perfectly (at least this problem) and there simply is no error at that part as most computers are good at increasing integers by one :D"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 2, "creation_date": 1479865125, "post_id": 40754651, "comment_id": 68735099, "body": "I thought that too but there is a <code>j loop</code> inside the <code>i loop</code> that the OP increments the ticker in <code>ticker = (1 + ticker)</code>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1479865160, "post_id": 40754651, "comment_id": 68735112, "body": "This is possible answer, more detail needed from OP to say this definitively, though."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1479865497, "post_id": 40754651, "comment_id": 68735185, "body": "Well it appears this is not the correct answer because ticker needs to reference one or two, so zero does need to reset at the beginning of eahc iteration of i."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1479865877, "post_id": 40754651, "comment_id": 68735279, "body": "@DavidZemens   does this look right to you?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1479866459, "post_id": 40754651, "comment_id": 68735428, "body": "That&#39;s a good point on the If/Else condition Doug. My only qualm at this point is that, it&#39;s not clear OP has done due diligence in debugging and actually identifying the problem -- and if his diagnosis is wrong, then this answer may not actually solve it. He states that <code>ticker</code> doesn&#39;t increment, but is unable to demonstrate that (via Debug statements, for example). I&#39;m nearly certain that <code>ticker = ticker + 1</code> in the Immediate pane would prove him wrong, though :)"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1479868027, "post_id": 40754651, "comment_id": 68735852, "body": "If the searched string <code>anString</code> is multiple times in the <code>SAPanArray</code> - array then <code>ticker</code> should increase. After the first time it is found, it should be 1 and 2 at the second time (3 at the third time and so on). Why do you think it can&#39;t be 2? What does prevent it from being 2? I don&#39;t get your logic Doug :("}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1479868354, "post_id": 40754651, "comment_id": 68735932, "body": "Well that requires more input from OP @DirkReichal but i def conceed to your point - i was just going off what i saw in the moment. So, you could be right there and an oversight on my part. thanks for catching that. I also qualified that in my response though."}, {"owner": {"reputation": 53, "user_id": 4484546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ISQCw40KBRo/AAAAAAAAAAI/AAAAAAAAAGU/OSIdIMSJinw/photo.jpg?sz=128", "display_name": "Zane ", "link": "https://stackoverflow.com/users/4484546/zane"}, "edited": false, "score": 0, "creation_date": 1479924111, "post_id": 40754651, "comment_id": 68766552, "body": "The format of my comment is terrible, let me change my original question. I am new to this"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 1, "last_activity_date": 1479866726, "last_edit_date": 1479866726, "creation_date": 1479864925, "answer_id": 40754651, "question_id": 40754436, "link": "https://stackoverflow.com/questions/40754436/my-counting-variable-will-not-increment-beyond-the-value-of-1-vba/40754651#40754651", "title": "My counting variable will not increment beyond the value of 1 vba", "body": "<pre><code>            For i = LBound(SAPanArray) To UBound(SAPanArray)\n\n                anString = Trim(Split(SAPanArray(i), \" \")(0))\n                ticker = 0\n                Set a = FindNextEmpty(Sheets(\"SAPdata\").Range(\"F4\"))\n\n                If IsInArrayC(anString, SAPanArray) = 0 Then\n\n                Else\n                    For j = LBound(SAPbulkArray) To UBound(SAPbulkArray)\n                        If InStr((SAPbulkArray(j)), anString) &gt; 0 Then\n                            ticker = (1 + ticker)\n                        End If\n\n                        If ticker = 1 Then\n\n                        ElseIf ticker = 2 Then\n</code></pre>\n\n<p>OK Forgive me for hack/slashing everything but this helps me read your logical order.</p>\n\n<p>Ticker only really evers needs to be 1 or 0 due to your line of reasoning. The</p>\n\n<pre><code> ElseIf ticker =2\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code> Elseif ticker = 0\n</code></pre>\n\n<p>OR</p>\n\n<pre><code> Else\n'some more code\n</code></pre>\n\n<p>So yoyu could save yourself the the trouble UNLESS ticker needs to be greater than 1 ever. So far by what you posted it doesnt need to be. </p>\n"}], "owner": {"reputation": 53, "user_id": 4484546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ISQCw40KBRo/AAAAAAAAAAI/AAAAAAAAAGU/OSIdIMSJinw/photo.jpg?sz=128", "display_name": "Zane ", "link": "https://stackoverflow.com/users/4484546/zane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "closed_date": 1479867264, "answer_count": 1, "score": 0, "last_activity_date": 1479924538, "creation_date": 1479863403, "last_edit_date": 1479924538, "question_id": 40754436, "link": "https://stackoverflow.com/questions/40754436/my-counting-variable-will-not-increment-beyond-the-value-of-1-vba", "closed_reason": "Not suitable for this site", "title": "My counting variable will not increment beyond the value of 1 vba", "body": "<p>My apologies for the confusion. Here goes an attempt to clarify:</p>\n\n<p>Pseudo code:</p>\n\n<ol>\n<li>For each item in list one (i) --> set counting variable to zero</li>\n<li>Check each item in list two (j)</li>\n<li>If list one item matches list two item then increment counter AND store value</li>\n<li>If count == 1 then do stuff (list one item found in list two ONE time)</li>\n<li>If count ==2 then do other stuff (list one item found in list two TWO times)</li>\n<li>Next item</li>\n</ol>\n\n<p>My problem is that the \"ticker\" variable gets incremented inside of the equation, but the value of the variable never changes from 1 to 2. Thus, the statement \"If count = 2\" never fires. My picture shows where I have broken the code at each iteration of the j For loop to monitor the value of the \"ticker\" variable. On the iteration when the \"ticker\" should change from 1 to 2 the equation inside of the IF statement shows that it is incremented, but the variable's value, shown in the locals window, does not change.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RcuCT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RcuCT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Code:</p>\n\n<pre><code>For i = LBound(SAPanArray) To UBound(SAPanArray)\n            anString = Trim(Split(SAPanArray(i), \" \")(0))\n            ticker = 0\n            Set a = FindNextEmpty(Sheets(\"SAPdata\").Range(\"F4\"))\n\n            If IsInArrayC(anString, SAPanArray) = 0 Then\n                Sheets(\"SAPdata\").Cells((a.Row), (a.Column)).Value = Sheets(\"SAPdata\").Cells((i + 3), 9).Value\n                Sheets(\"SAPdata\").Cells((a.Row), 7).Value = (Sheets(\"SAPdata\").Cells((i + 3), 10).Value) * 2000\n                Sheets(\"SAPdata\").Cells((a.Row), 7).Interior.Color = RGB(255, 192, 0)\n            Else\n                For j = LBound(SAPbulkArray) To UBound(SAPbulkArray)\n                SAPbulkArray = WorksheetFunction.Transpose(Sheets(\"SAPdata\").Range(\"F4:F\" &amp; (Sheets(\"SAPdata\").Range(\"F\" &amp; Cells.Rows.Count).End(xlUp).Row)))\n\n                    If InStr((SAPbulkArray(j)), anString) &gt; 0 Then\n                        ticker = (1 + ticker)\n                        dupArray(ticker) = Sheets(\"SAPdata\").Cells((j + 3), 7).Value\n                    End If\n\n                    If ticker = 1 Then\n                        If ((Sheets(\"SAPdata\").Cells((i + 3), 10).Value) * 2000) &lt;&gt; (Sheets(\"SAPdata\").Cells((j + 3), 7).Value) Then\n                            Sheets(\"SAPdata\").Cells((a.Row), (a.Column)).Value = Sheets(\"SAPdata\").Cells((i + 3), 9).Value\n                            Sheets(\"SAPdata\").Cells((a.Row), 7).Value = (Sheets(\"SAPdata\").Cells((i + 3), 10).Value) * 2000\n                            Sheets(\"SAPdata\").Cells((a.Row), 7).Interior.Color = RGB(255, 192, 0)\n                        End If\n                    ElseIf ticker = 2 Then\n                        summer = (dupArray(1)) + ((Sheets(\"SAPdata\").Cells((i + 3), 10).Value) * 2000)\n                        If summer &lt;&gt; dupArray(2) Then\n                            If Not IsEmpty(Sheets(\"SAPdata\").Cells((j + 3), 11)) Then\n                                Sheets(\"SAPdata\").Cells((j + 3), 7).Value = Sheets(\"SAPdata\").Cells((i + 3), 11).Value\n                            End If\n\n                            Sheets(\"SAPdata\").Cells((i + 3), 11).Value = Sheets(\"SAPdata\").Cells((j + 3), 7).Value\n                            Sheets(\"SAPdata\").Cells((i + 3), 11).Font.Color = vbWhite\n                            Sheets(\"SAPdata\").Cells((j + 3), 7).Value = ((Sheets(\"SAPdata\").Cells((i + 3), 10).Value) * 2000) + Sheets(\"SAPdata\").Cells((j + 3), 7).Value\n                            Sheets(\"SAPdata\").Cells((j + 3), 7).Interior.Color = RGB(255, 192, 0)\n                        End If\n                    End If\n\n                Next\n            End If\n        Next\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 691, "user_id": 4353060, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/LOLzx.png?s=128&g=1", "display_name": "Monomeeth", "link": "https://stackoverflow.com/users/4353060/monomeeth"}, "edited": false, "score": 1, "creation_date": 1479868629, "post_id": 40754698, "comment_id": 68735994, "body": "That works! And for a bonus, I actually understand it! :) Thank you so much!"}], "tags": [], "owner": {"reputation": 94, "user_id": 2480580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bs2TV.png?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2480580/andy"}, "is_accepted": true, "score": 1, "last_activity_date": 1479865377, "creation_date": 1479865377, "answer_id": 40754698, "question_id": 40754274, "link": "https://stackoverflow.com/questions/40754274/sum-values-in-one-column-for-all-rows-with-matching-data-in-another-column-eith/40754698#40754698", "title": "Sum values in one column for all rows with matching data in another column, either through VBA or a combination of formulas/functions", "body": "<p>Use <code>IF</code> and <code>SUMIF</code> ,Maybe you can try this:<a href=\"https://i.stack.imgur.com/y2Zpr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y2Zpr.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 691, "user_id": 4353060, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/LOLzx.png?s=128&g=1", "display_name": "Monomeeth", "link": "https://stackoverflow.com/users/4353060/monomeeth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 979, "favorite_count": 0, "accepted_answer_id": 40754698, "answer_count": 1, "score": 0, "last_activity_date": 1479869600, "creation_date": 1479862153, "last_edit_date": 1531161705, "question_id": 40754274, "link": "https://stackoverflow.com/questions/40754274/sum-values-in-one-column-for-all-rows-with-matching-data-in-another-column-eith", "title": "Sum values in one column for all rows with matching data in another column, either through VBA or a combination of formulas/functions", "body": "<p>My title needs explanation. Below is some sample data so I can explain what I'm looking for:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wymgn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wymgn.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What I need is a formula, macro or function that will <code>sum</code> the <strong>Duration values</strong> in Column <code>C</code> for each of the <strong>unique IP addresses</strong>. Using the example above, cell <code>D2</code> would result in displaying the same as cell <code>C2</code> as there's only one duration value pertaining to the IP address in <code>A2</code>. However, cell <code>D6</code> would result in displaying the sum of the duration values in <code>C3:C6</code> as the IP address for each of these are identical in <code>A3:A6</code>.</p>\n\n<p>So, in a nutshell I need the total sum of duration for each unique IP address. Ideally, for ease of reference, the <code>sum</code> will occur in the cell corresponding with the last row of each unique address rather than all cells in Column <code>D</code>. Below is an example of how this would look:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Qn03O.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Qn03O.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>In the above sample cells <code>D3, D4, D5</code> and <code>D12</code> are blank, but I would be happy with another solution so long as I can easily identify the cells that have a summed duration in them.</p>\n\n<p>I have played with a number of formulas using SUMIF, MATCH, INDEX but in all these cases I need to <em>specify</em> the IP address for them to work. Obviously, having to do this defeats the purpose.</p>\n\n<p>I've also tried a combination of <code>IF</code> and <code>MAX</code>, but this only partly automates identifying which rows need to be summed, which isn't a huge time saver. For example, I tried:</p>\n\n<pre><code>=IF($C2=MAX(IF($A2=$A$2:$A$5630,$C$2:$C$5630,-1)),\"Sum\",\"\")\n</code></pre>\n\n<p>The above formula does identify the rows I need to add the <code>SUM</code> formula in column <code>D</code>, but that's still a manual process to do the actual summing.</p>\n\n<p>Any hints etc would be greatly appreciated as I have nine spreadsheets with thousands of rows of IP addresses and need a way to automate this task.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1479861330, "post_id": 40754131, "comment_id": 68734209, "body": "That code doesn&#39;t compile. You need to remove the first <code>End If</code>."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1479861521, "post_id": 40754131, "comment_id": 68734257, "body": "<code>myArray(2) = myArray(2)+1</code> <i>is</i> the correct way to increment an array value by 1, so if the final value is less than you expect, this line is being executed less often than you expect. There is nothing about that line which stops the sum at 1."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1479861826, "post_id": 40754131, "comment_id": 68734309, "body": "Your array is created/initialized each time this piece of code is executed, so the values will start at zero. If you are expecting it to increase in-between different invocations, it wont. However, in a single invocation there is nothing that makes it stick at 1."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1479864974, "post_id": 40754131, "comment_id": 68735057, "body": "If your intention is to keep counts between runs, what you could do is change <code>myArray</code> from a local variable to a parameter of the sub. Do something like change <code>Sub CountCustomer</code> to <code>Sub UpdateCounts(myArray)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7016009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b168372609d85cfd28252d8bd890375?s=128&d=identicon&r=PG&f=1", "display_name": "VaL1cE", "link": "https://stackoverflow.com/users/7016009/val1ce"}, "edited": false, "score": 0, "creation_date": 1479917413, "post_id": 40754656, "comment_id": 68762398, "body": "Thanks for the advice, it&#39;s definitely good to have better and faster ways to make my code."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1479864960, "creation_date": 1479864960, "answer_id": 40754656, "question_id": 40754131, "link": "https://stackoverflow.com/questions/40754131/increase-value-of-an-element-in-array-vba/40754656#40754656", "title": "increase value of an element in array vba", "body": "<p>A couple of options below.</p>\n\n<ul>\n<li>Better to work with arrays for speed than loops (option 2)</li>\n<li>For this particular example you can use <code>CountIF</code> directly (option 1)</li>\n</ul>\n\n<p>If you have multiple processing routes then <code>Select</code> can be more efficient than <code>Else If</code></p>\n\n<p><em>code #1</em></p>\n\n<pre><code>Sub Option1()\nDebug.Print \"number of 5's: \" &amp; Application.WorksheetFunction.CountIf([a1:a10], 5)\nDebug.Print \"number of 3's: \"; Application.WorksheetFunction.CountIf([a1:a10], 3)\nEnd Sub\n</code></pre>\n\n<p><em>code #2</em></p>\n\n<pre><code>Sub Option2()\nDim x\nDim myArray(1 To 5)\nDim lngCnt As Long\n\n'put range into 2D variant array\nx = [a1:a10].Value2\nFor lngCnt = 1 To UBound(x)\n    Select Case x(lngCnt, 1)\n    Case 5\n    myArray(4) = myArray(4) + 1\n    Case 3\n    myArray(2) = myArray(2) + 1\n    Case Else\n    'do nothing\n    End Select\nNext\n\nDebug.Print myArray(4), myArray(2)\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 7016009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b168372609d85cfd28252d8bd890375?s=128&d=identicon&r=PG&f=1", "display_name": "VaL1cE", "link": "https://stackoverflow.com/users/7016009/val1ce"}, "edited": false, "score": 0, "creation_date": 1479917358, "post_id": 40754801, "comment_id": 68762371, "body": "Very good to know, I&#39;ve been doing weird workarounds to try to get that kind of info, like printing out the values I&#39;m looking at for every row in my file.  I&#39;m kinda learning as I go."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1479866324, "creation_date": 1479866324, "answer_id": 40754801, "question_id": 40754131, "link": "https://stackoverflow.com/questions/40754131/increase-value-of-an-element-in-array-vba/40754801#40754801", "title": "increase value of an element in array vba", "body": "<p>Your code works as expected.  You should watch:<a href=\"https://www.youtube.com/watch?v=DlqKfYTgc9Q&amp;t=40s&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5&amp;index=3\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 3 - What to do When Things Go Wrong (Errors and Debugging)</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/cuefP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cuefP.png\" alt=\"enter image description here\"></a>\nHere I set up watches to monitor your variables. The watches for <code>myArray(2)</code> and <code>myArray(4)</code> are set to break when there value changes.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ErNX4.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ErNX4.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 41, "user_id": 7016009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b168372609d85cfd28252d8bd890375?s=128&d=identicon&r=PG&f=1", "display_name": "VaL1cE", "link": "https://stackoverflow.com/users/7016009/val1ce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2681, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1479866324, "creation_date": 1479861008, "last_edit_date": 1479864956, "question_id": 40754131, "link": "https://stackoverflow.com/questions/40754131/increase-value-of-an-element-in-array-vba", "title": "increase value of an element in array vba", "body": "<p>I am working in VBA for Excel, and I have an array of integers.  What I am trying to do is add 1 to a specific element inside the array when my conditions have been met.  In my example code if the cell in column A is a 5 then I would like to add 1 in the 5th position of the array or if the cell is a 3 then add 1 to the 3rd position of the array.</p>\n\n<pre><code>Sub CountCustomers()\n    Dim myArray(5)\n    Dim i as integer\n    For i = 1 to 10\n        If Cells(i,1) = 5 Then\n           myArray(4) = myArray(4)+1\n        ElseIf Cells(i,1) = 3 Then\n           myArray(2) = myArray(2)+1\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>When I run it like this it ends up with a 1 in the correct position but will not increase the values any higher. Is there a way to do this? </p>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1479858804, "post_id": 40753768, "comment_id": 68733545, "body": "<code>Worksheet_Change</code> is an event handler, so it <i>has to</i> be a <code>Sub</code> to function. What exactly is meant by &quot;I now need to expand this code to a range of multiple cells&quot;?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1479858843, "post_id": 40753768, "comment_id": 68733551, "body": "In addition to Comintern&#39;s comment, I think your real issue is identifying the cause of: &quot;Previously, when refreshing my workbook, it updated the date, now it does not, and only updates when the value inside the cell has changed&quot;"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1479858887, "post_id": 40753768, "comment_id": 68733569, "body": "<i>if I am not mistaken.</i>  You are :)  A subroutine can easily operate on a range of cells."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1479858901, "post_id": 40753768, "comment_id": 68733573, "body": "So is <code>Worksheet_SelectionChange</code>. It can&#39;t be a function either. Instead of asking how to do something you can&#39;t, ask about what you&#39;re trying to accomplish instead. (BTW, you <i>are</i> wrong. Both of those event handlers already accept a range of cells - that&#39;s what a <code>Range</code> is by definition.)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1479858955, "post_id": 40753768, "comment_id": 68733592, "body": "So I would advise this: re-write/edit your question with a better description of <i>what you need</i>, instead of <i>what you think you need</i>. Example input/output scenarios would be helpful as well."}, {"owner": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1479859028, "post_id": 40753768, "comment_id": 68733613, "body": "This code only applies to one cell, I want to drag it down a range of cells so it then applies to those cells aswell, not just &#39;D4&#39; and &#39;L4&#39;. @DavidZemens I want it like that, I do not want the cells updating when  refresh the workbook. That part of the problem is fixed."}, {"owner": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "edited": false, "score": 0, "creation_date": 1479859300, "post_id": 40753768, "comment_id": 68733685, "body": "I have edited my description, please let me know what else you require in order to fix my problem, thanks."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1479860163, "post_id": 40753768, "comment_id": 68733910, "body": "I think you are confusing the <code>Worksheet_Change</code> event (which is triggered when there is a change on the worksheet) with a User-Defined-Function (which is a function that you can enter into an Excel cell, in a similar way to functions such as <code>SUM</code> and <code>VLOOKUP</code>).  The <code>Worksheet_Change</code> event applies to the <b>whole</b> worksheet, while a UDF applies only to the cell in which it is used (although it can be used multiple times in multiple cells, and thus can be &quot;copied down&quot; if you wanted to).  I am pretty certain that what you want to do is impossible with a UDF."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1479860176, "post_id": 40753768, "comment_id": 68733914, "body": "It isn&#39;t clear what you want, exactly. If you want a UDF -- just write it directly. I don&#39;t see how thinking of it as a modification of a worksheet change sub which doesn&#39;t do what you want is particularly helpful. Just scrap what you have and start again."}, {"owner": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1479860374, "post_id": 40753768, "comment_id": 68733959, "body": "@YowE3K The sub I have written only applies to one cell, I guess I am trying to work out a way to have it spread out to a certain selection of cells. Ie. <code>D4:D12</code> which updates the date in <code>L4:L12</code> accordingly."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1479860540, "post_id": 40753768, "comment_id": 68734007, "body": "The easiest way to do what you want is, in the <code>SelectionChange</code> event, store away the 9 different values instead of the one value you currently do, and then, in the <code>Change</code> event process things if any of the cells in D4:D12 are the Target and the corresponding &quot;old value&quot; is different to the &quot;current value&quot;.  It is very hard (probably impossible) to store an &quot;old value&quot; using a UDF."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1479862943, "post_id": 40753768, "comment_id": 68734557, "body": "@YowE3K probably could be done with a module/static variable and/or a <code>Name</code> in the worksheet, but it would be convoluted to do either way."}], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "edited": false, "score": 0, "creation_date": 1479867095, "post_id": 40754754, "comment_id": 68735582, "body": "There is no date showing in cell L4, or anywhere else, even when I am changing the value of the data. It&#39;s a bit hard to debug your code as I am sort of new to VBA scripting within Excel.  Thanks for your help though!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "edited": false, "score": 0, "creation_date": 1479867422, "post_id": 40754754, "comment_id": 68735681, "body": "@juiceb0xk - can you put a breakpoint on the first line of each subroutine and just make sure that it is reaching the code.  Other than the code being in the wrong sheet, or EnableEvents being False, I can&#39;t see why the code wouldn&#39;t run.  (It was working fine when I tested it before posting.)"}, {"owner": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "edited": false, "score": 0, "creation_date": 1479868189, "post_id": 40754754, "comment_id": 68735896, "body": "The code isn&#39;t breaking anywhere. It is in the correct sheet too. I have put a breakpoint on each line of code and none of them are breaking at all."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "edited": false, "score": 0, "creation_date": 1479868585, "post_id": 40754754, "comment_id": 68735988, "body": "It sounds like somehow <code>Application.EnableEvents</code> got set to <code>False</code> but never went through to the end of the code to set it back to <code>True</code> again.  Go to the Immediate Window in the VBA IDE and type in <code>Application.EnableEvents = True</code> (and press Enter), then try again.  (I have to go to a meeting now - I won&#39;t be back for about 4 hours.)"}, {"owner": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "edited": false, "score": 0, "creation_date": 1479869146, "post_id": 40754754, "comment_id": 68736119, "body": "It&#39;s giving me an <code>invalid outside procedure</code> compile error. I&#39;m not sure where else to type <code>Application.EnableEvents = True</code>. If I completely remove the EnableEvents code, it still doesn&#39;t update the date."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "edited": false, "score": 0, "creation_date": 1479882768, "post_id": 40754754, "comment_id": 68740074, "body": "The immediate window (if not already visible) can probably (possibly depending on what version of Excel you are using) be displayed in the IDE by selecting View / Immediate Window, or usually Ctrl-G works too."}, {"owner": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "edited": false, "score": 0, "creation_date": 1479883523, "post_id": 40754754, "comment_id": 68740368, "body": "Okay, thank you for that insight. It&#39;s all working now, that&#39;s awesome thanks, now to debug your code and find out what really is going on."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "edited": false, "score": 0, "creation_date": 1479883924, "post_id": 40754754, "comment_id": 68740547, "body": "Just remember that, if you stop the code after <code>Application.EnableEvents = False</code> has been executed, no further Events will be executed until you go through the <code>Application.EnableEvents = True</code> statement."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1479865848, "creation_date": 1479865848, "answer_id": 40754754, "question_id": 40753768, "link": "https://stackoverflow.com/questions/40753768/how-can-i-spread-a-sub-to-a-multiple-range-of-cells/40754754#40754754", "title": "How can I spread a sub to a multiple range of cells?", "body": "<p>Try the following code:</p>\n\n<pre><code>Dim oldValue()\n\nPublic Sub Worksheet_SelectionChange(ByVal Target As Range)\n    oldValue = Me.Range(\"D4:D12\").Value\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Me.Range(\"D4:D12\")) Is Nothing Then\n        Application.EnableEvents = False\n        Dim c As Range\n        For Each c In Intersect(Target, Me.Range(\"D4:D12\"))\n            'Check value against what is stored in \"oldValue\" (row 4 is in position 1, row 5 in position 2, etc)\n            If oldValue(c.Row - 3, 1) &lt;&gt; c.Value Then\n                'Update value in column L (8 columns to the right of column D)\n                c.Offset(0, 8).Value = Date 'or possibly \"= Now()\" if you need the time of day that the cell was updated\n            End If\n        Next\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "edited": false, "score": 0, "creation_date": 1479871204, "post_id": 40755245, "comment_id": 68736618, "body": "That&#39;s awesome, I&#39;ll have to try it out later, but thanks in advance. I was going to do this without VBA, but looks as if it can be done."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "edited": false, "score": 0, "creation_date": 1479871340, "post_id": 40755245, "comment_id": 68736642, "body": "Good luck in advanced!!  Cheers"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1479869655, "creation_date": 1479869655, "answer_id": 40755245, "question_id": 40753768, "link": "https://stackoverflow.com/questions/40753768/how-can-i-spread-a-sub-to-a-multiple-range-of-cells/40755245#40755245", "title": "How can I spread a sub to a multiple range of cells?", "body": "<p><a href=\"https://i.stack.imgur.com/RsMfF.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RsMfF.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Set up a hidden sheet to hold the old values. </p>\n\n<hr>\n\n<pre><code>Sub SetupMirrorValues()\n    With Worksheets.Add\n        .Name = \"MirrorValues\"\n        .visibilty = xlSheetVeryHidden\n        .Range(\"D4:D10,D12,D14:D20\") = Worksheets(\"Sheet1\").Range(\"D4:D10,D12,D14:D20\")\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>In the <code>Worksheet_Change</code> event handler, you would check the <code>Target</code> cells that intersect with the range you want to monitor.  If there are differences then you update the timestamp and the cell on the hidden sheet that corresponds to the changed cell.</p>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n\n    Dim cell As Range, DRange As Range\n    Set DRange = Range(\"D4:D10,D12,D14:D20\")\n    If Not Intersect(DRange, Target) Is Nothing Then\n        For Each cell In Intersect(DRange, Target)\n\n            If cell.Value &lt;&gt; Worksheets(\"MirrorValues\").Range(cell.Address) Then\n                cell.EntireRow.Cells(1, \"L\").Value = Now\n                Worksheets(\"MirrorValues\").Range(cell.Address) = cell.Value\n            End If\n\n        Next\n    End If\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 859, "user_id": 4225659, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rW9gpVSaf70/AAAAAAAAAAI/AAAAAAAAAC8/Gik6PGJChuk/photo.jpg?sz=128", "display_name": "juiceb0xk", "link": "https://stackoverflow.com/users/4225659/juiceb0xk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 40754754, "answer_count": 2, "score": 0, "last_activity_date": 1479869655, "creation_date": 1479858587, "last_edit_date": 1479860797, "question_id": 40753768, "link": "https://stackoverflow.com/questions/40753768/how-can-i-spread-a-sub-to-a-multiple-range-of-cells", "title": "How can I spread a sub to a multiple range of cells?", "body": "<p>The purpose of this code is to update the date in a cell as a certain cell's contents are changed.</p>\n\n<p>Since this was originally coded inside a sub, I now need to expand this code to a range of multiple cells. Ie. At this moment, the code only takes cell D4 and updates cell L4, I want to be able to drag this function down so it can reach a multiple range of cells; take D5 and update L5 etc.</p>\n\n<p>Here's my code as the sub:</p>\n\n<pre><code>Dim oldValue\n\nPublic Sub Worksheet_SelectionChange(ByVal Target As Range)\noldValue = Target.Worksheet.Range(\"D4\").Value\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range) \n  If Not Intersect(Target, Target.Worksheet.Range(\"D4\")) Is Nothing Then\n    If oldValue &lt;&gt; Target.Worksheet.Range(\"D4\").Value Then\n        Target.Worksheet.Range(\"L4\").Value = Date\n    End If\n  End If\nEnd Sub\n</code></pre>\n\n<p>The problem here, is that I don't know how to properly expand my code to match a further selection of cells. Here's my attempt:</p>\n\n<pre><code>Dim oldValue\n\nPublic Sub Worksheet_SelectionChange(ByVal Target As Range)\noldValue = Target.Worksheet.Range(\"D4\", \"D21\").Value\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Target.Worksheet.Range(\"D4\", \"D21\")) Is Nothing Then\n    If oldValue &lt;&gt; Target.Worksheet.Range(\"D4\", \"D21\").Value Then\n        Target.Worksheet.Range(\"L4\", \"L21\").Value = Date\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>EDIT: The sub I have written only applies to one cell, I am trying to work out a way to have it spread out to a certain selection of cells. Ie. D4:D12 which updates the date in L4:L12 accordingly.</p>\n\n<p>If anyone could help me, that would be greatly appreciated. </p>\n"}, {"tags": ["vba", "ms-access", "expression"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1479857948, "post_id": 40753556, "comment_id": 68733274, "body": "Change to:     &quot;&#39; And [Invoice... too many quotes"}, {"owner": {"reputation": 1, "user_id": 7180241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e04fd5fe086495d30b8168c9f7a9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Brenner", "link": "https://stackoverflow.com/users/7180241/jon-brenner"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1479858082, "post_id": 40753556, "comment_id": 68733318, "body": "Thank you so much!"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 6356172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184ce542d2545edcec36cbcd18924adc?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Thompson", "link": "https://stackoverflow.com/users/6356172/dale-thompson"}, "is_accepted": false, "score": 0, "last_activity_date": 1479858355, "creation_date": 1479858355, "answer_id": 40753721, "question_id": 40753556, "link": "https://stackoverflow.com/questions/40753556/microsoft-access-expression-dsum-multiple-criteria-dates/40753721#40753721", "title": "Microsoft Access Expression - DSum Multiple Criteria - Dates", "body": "<p>If the [campaign_id] field is a number type, don't put it in single quotes.</p>\n\n<p>If the [invoice_date] field is a date type, don't enclose it in # tags.</p>\n\n<pre><code>Expr1: DSum(\"[current_invoice_amount]\",\"[tblAccountingDatabase]\",\"[campaign_id]=\" &amp; [campaign_id] &amp; \" And [invoice_date]&lt;=\" &amp; [invoice_date])\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7180241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e04fd5fe086495d30b8168c9f7a9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Brenner", "link": "https://stackoverflow.com/users/7180241/jon-brenner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6291, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513002184, "creation_date": 1479857399, "last_edit_date": 1513002184, "question_id": 40753556, "link": "https://stackoverflow.com/questions/40753556/microsoft-access-expression-dsum-multiple-criteria-dates", "title": "Microsoft Access Expression - DSum Multiple Criteria - Dates", "body": "<p>I'm trying to write a DSum expression with multiple criteria, but can't seem to get it right. Not totally Access-savvy, but pretty sure I have the syntax correct. The result I get with only one criteria is correct. When I add a second, the expression ignores both criteria, and gives me a sum for the entire column. Any idea what I'm doing wrong??? The goal is to have a \"rolling total\" for each campaign, so each time a new invoice is sent it is added to this rolling total field. Best excel equivalent formula: <code>=SUMIFS(current_invoice_amount,campaign_id,A2,invoice_date,\"&lt;=\"&amp;B2)    A2 is campaign id and B2 is invoice date. Pretend formula is in C2.</code> </p>\n\n<p>Here's the Access Expression that won't work:</p>\n\n<pre><code>Expr1: DSum(\"[current_invoice_amount]\",\"[tblAccountingDatabase]\",\"[campaign_id]='\" &amp; [campaign_id] &amp; \"'\" And \"[invoice_date]&lt;=#\" &amp; [invoice_date] &amp; \"#\")\n</code></pre>\n\n<p>Here's an axample of what the table should look like:</p>\n\n<pre><code>campaign   invoice_date   current_invoice_amount   rolling_total\na             1/1/16                5                    5\na             2/1/16                6                    11\na             3/1/16                4                    15\nb             1/1/16                4                    4\nb             2/1/16                4                    8\nc             1/1/16                6                    6\n</code></pre>\n"}, {"tags": ["vba", "selenium-webdriver", "webdriver"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1529843642, "last_edit_date": 1529843642, "creation_date": 1529843061, "answer_id": 51009933, "question_id": 40753383, "link": "https://stackoverflow.com/questions/40753383/web-driver-how-to-select-option-in-dynamic-drop-down-in-vba/51009933#51009933", "title": "Web driver how to select option in DYNAMIC drop down in VBA", "body": "<p><strong>CSS selector:</strong></p>\n\n<p>You can use a CSS selector to target the option of choice and then <code>.Click</code> to select. You extract the option value into a variable which you concatenate into the CSS selector string.</p>\n\n<p><strong>Your example:</strong></p>\n\n<p>For your example, you can use selector  <code>select option[value='5.0']</code>, where 5.0 is extracted into a variable.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lWEur.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lWEur.png\" alt=\"CSS query\"></a></p>\n\n<pre><code>CONST SELECTED_INDEX As String = \"5.0\"\nWEB3.FindElementByCss(\"select option[value='\" &amp; SELECTED_INDEX &amp; \"']\").Click\n</code></pre>\n\n<hr>\n\n<p>Here is an example using Facebook and selecting the drop down day for birthday.</p>\n\n<p>CSS selector for Facebook birthday day:</p>\n\n<pre><code>#day option[value='18']\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/8qlMU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8qlMU.png\" alt=\"CSS query\"></a></p>\n\n<p>This reads as element with id <code>\"day\"</code>, containing tag <code>option</code>, with attribute <code>value</code> that is <code>=18</code>. <code>#</code> is id selector and <code>[]</code> is for attribute.</p>\n\n<hr>\n\n<pre><code>VBA Code:\n\nOption Explicit\nPublic Sub MakeSelection()\n    Dim d As WebDriver\n    Set d = New ChromeDriver\n    Const URL = \"https://www.facebook.com/\"\n    Const SELECTED_INDEX As Long = 18\n    With d\n        .Start \"Chrome\"\n        .get URL\n        'Selector was e.g. for day 1 \"#day option[value='1']\"\n        .FindElementByCss(\"#day option[value='\" &amp; SELECTED_INDEX &amp; \"']\").Click\n\n        Stop '&lt;= Delete me later\n        .Quit\n        Application.ScreenUpdating = True\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 42, "user_id": 7197000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/049ab23f836d1c0df330838a03aad717?s=128&d=identicon&r=PG&f=1", "display_name": "J.Rob", "link": "https://stackoverflow.com/users/7197000/j-rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1513, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1529843642, "creation_date": 1479856557, "question_id": 40753383, "link": "https://stackoverflow.com/questions/40753383/web-driver-how-to-select-option-in-dynamic-drop-down-in-vba", "title": "Web driver how to select option in DYNAMIC drop down in VBA", "body": "<p>I have this HTML</p>\n\n<pre><code>&lt;div class=\"ui-widget\"&gt;\n&lt;select name=\"calAlum\" style=\"display: none;\"&gt;undefined\n&lt;option value=\"\"&gt;&lt;/option&gt; \n&lt;option value=\"5.0\"&gt;5.0&lt;/option&gt;\n &lt;option value=\"5.1\"&gt;5.1&lt;/option&gt; \n&lt;option value=\"5.2\"&gt;5.2&lt;/option&gt;\n &lt;option value=\"5.3\"&gt;5.3&lt;/option&gt;\n &lt;option value=\"5.4\"&gt;5.4&lt;/option&gt;\n &lt;option value=\"5.5\"&gt;5.5&lt;/option&gt;\n &lt;option value=\"5.6\"&gt;5.6&lt;/option&gt;\n &lt;option value=\"5.7\"&gt;5.7&lt;/option&gt;\n &lt;option value=\"5.8\"&gt;5.8&lt;/option&gt;\n &lt;option value=\"5.9\"&gt;5.9&lt;/option&gt;\n &lt;option value=\"6.0\"&gt;6.0&lt;/option&gt;\n &lt;option value=\"6.1\"&gt;6.1&lt;/option&gt;\n &lt;option value=\"6.2\"&gt;6.2&lt;/option&gt;\n &lt;option value=\"6.3\"&gt;6.3&lt;/option&gt;\n &lt;option value=\"6.4\"&gt;6.4&lt;/option&gt;\n &lt;option value=\"6.5\"&gt;6.5&lt;/option&gt;\n &lt;option value=\"6.6\"&gt;6.6&lt;/option&gt;\n &lt;option value=\"6.7\"&gt;6.7&lt;/option&gt;\n &lt;option value=\"6.8\"&gt;6.8&lt;/option&gt;\n &lt;option value=\"6.9\"&gt;6.9&lt;/option&gt;\n &lt;option value=\"7.0\"&gt;7.0&lt;/option&gt;\n &lt;option value=\"7.1\"&gt;7.1&lt;/option&gt;\n &lt;option value=\"7.2\"&gt;7.2&lt;/option&gt;\n &lt;option value=\"7.3\"&gt;7.3&lt;/option&gt;\n &lt;option value=\"7.4\"&gt;7.4&lt;/option&gt;\n &lt;option value=\"7.5\"&gt;7.5&lt;/option&gt;\n &lt;option value=\"7.6\"&gt;7.6&lt;/option&gt;\n &lt;option value=\"7.7\"&gt;7.7&lt;/option&gt;\n &lt;option value=\"7.8\"&gt;7.8&lt;/option&gt;\n &lt;option value=\"7.9\"&gt;7.9&lt;/option&gt;\n &lt;option value=\"8.0\"&gt;8.0&lt;/option&gt;\n &lt;option value=\"8.1\"&gt;8.1&lt;/option&gt;\n &lt;option value=\"8.2\"&gt;8.2&lt;/option&gt;\n &lt;option value=\"8.3\"&gt;8.3&lt;/option&gt;\n &lt;option value=\"8.4\"&gt;8.4&lt;/option&gt;\n &lt;option value=\"8.5\"&gt;8.5&lt;/option&gt;\n &lt;option value=\"8.6\"&gt;8.6&lt;/option&gt;\n &lt;option value=\"8.7\"&gt;8.7&lt;/option&gt;\n &lt;option value=\"8.8\"&gt;8.8&lt;/option&gt;\n &lt;option value=\"8.9\"&gt;8.9&lt;/option&gt;\n &lt;option value=\"9.0\"&gt;9.0&lt;/option&gt;\n &lt;option value=\"9.1\"&gt;9.1&lt;/option&gt;\n &lt;option value=\"9.2\"&gt;9.2&lt;/option&gt;\n &lt;option value=\"9.3\"&gt;9.3&lt;/option&gt;\n &lt;option value=\"9.4\"&gt;9.4&lt;/option&gt;\n &lt;option value=\"9.5\"&gt;9.5&lt;/option&gt;\n &lt;option value=\"9.6\"&gt;9.6&lt;/option&gt;\n &lt;option value=\"9.7\"&gt;9.7&lt;/option&gt;\n &lt;option value=\"9.8\"&gt;9.8&lt;/option&gt;\n &lt;option value=\"9.9\"&gt;9.9&lt;/option&gt;\n &lt;option value=\"10.0\"&gt;10.0&lt;/option&gt;\n &lt;/select&gt;\n</code></pre>\n\n<p>when i click on the objetc display all the list but if a press \"5\" for example the list show only \"5.0\", \"5.1\" ,\"5.2\" etc. and when i press 5.8 only show me \"5.8\" llike valu to select</p>\n\n<p>So i want to select any option with VBA, (whith other combox i dont have problems but with this have error)</p>\n\n<p>i have tried this</p>\n\n<pre><code>sub CALF()\n\nDim H As selenium.Keys\n\n*Here  find the element \"select\" whit the name \"calAlum\"* i dont have problem\n\nFor Each element In WEB3.FindElementsByTag(\"select\")\n\nIf element.Attribute(\"name\") = \"calAlum\" Then\n\n element.AsSelect.selectbyvalue Activecell *in this part show error*\n\nEnd If\n\nNext\n\nMsgBox \"fin\"\n\nEnd Sub\n</code></pre>\n\n<p>but for this drop down doesnt work i tried to use diferent ways but dont work, NOTE: this code go to inside IF</p>\n\n<p>\"to focus the box but dont work\"</p>\n\n<pre><code>element.click \n</code></pre>\n\n<p>\"to write value dont work\"</p>\n\n<pre><code>element.sendkeys \"5.8\"\n</code></pre>\n\n<p>\"to copy value in clipboard then paste value in the objetc dont work\"</p>\n\n<pre><code>WEB3.SetClipBoard ActiveCell.Value\nelement.SendKeys Control, \"V\"\n</code></pre>\n\n<p>but if manually select any value in the object like \"9.8\" and the in the code use</p>\n\n<pre><code>R= element.value\n</code></pre>\n\n<p>or</p>\n\n<pre><code>R=elment.attrribute(\"value\")\n</code></pre>\n\n<p>return \"9.8\" then i use</p>\n\n<pre><code>element.asselect.selectbyvalue R  work\n</code></pre>\n\n<p>but if i change R= \"9.7\" and use</p>\n\n<pre><code>element.asselect.selectbyvalue R\n</code></pre>\n\n<p>return Error value no found</p>\n\n<p>then i tried after to wrap webelement in selectelemnet this</p>\n\n<pre><code>r= element.SelectedOption\n\nr= element.asselect.selectedoption\n</code></pre>\n\n<p>to know what option is selected, but both return void \"\" obviusly is rare because  R= element.value return \"9.8\" then i use </p>\n\n<pre><code>element.asselect.options\n\nfor i=0 to element.asselect.options\n\nr(i)=element.asselect.selectedoption\n\nnext\n</code></pre>\n\n<p>to know all option are in selectelement \"element\"  but return error its necesary a object so use</p>\n\n<pre><code>r = element.IsSelected\n</code></pre>\n\n<p>but return false thats to say i cant use the object like webelement and if i wrap to selectelment the object dont have any option, someone can help me.</p>\n\n<p>If you help me how to select the object o how to manipulate object \"select\" dynamic</p>\n"}, {"tags": ["c++", "excel", "vba"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1479854020, "post_id": 40752767, "comment_id": 68731856, "body": "<code>LPSTR controlStr = new char[256];   PCHAR convstrout = new char[256];     if (controlVal == 1) {  controlStr = &quot;Ping&quot;;</code>  This is a memory leak of huge proportions.  Also, you can&#39;t learn C++ by winging it or by guessing what looks right.  Mistakes like the above are easy to make if you don&#39;t learn the language properly."}, {"owner": {"reputation": 11, "user_id": 7197020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5782527e3913a97dca98fdd6136860f?s=128&d=identicon&r=PG&f=1", "display_name": "R. Reid", "link": "https://stackoverflow.com/users/7197020/r-reid"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1479854450, "post_id": 40752767, "comment_id": 68732032, "body": "I&#39;m just trying to get past the DLL calling error right now. I will get internal help from some people who understand C++ better than I do once I am able to just get the DLL working from inside Excel, which is the first hurdle I need to get over."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1479854552, "post_id": 40752767, "comment_id": 68732072, "body": "What is &quot;VRTTCONVERSION_API&quot;?  Does this mean <code>stdcall</code>, <code>cdecl</code>, etc?  That is what you should focus on to solve the issue.  Whatever it is, then the VBA function has to have the same calling convention.  That is basically it in a nutshell."}, {"owner": {"reputation": 11, "user_id": 7197020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5782527e3913a97dca98fdd6136860f?s=128&d=identicon&r=PG&f=1", "display_name": "R. Reid", "link": "https://stackoverflow.com/users/7197020/r-reid"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1479854998, "post_id": 40752767, "comment_id": 68732245, "body": "It is __declspec(dllexport)"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1479855196, "post_id": 40752767, "comment_id": 68732311, "body": "So the calling convention, when not given in C++ is <code>cdecl</code>.  Is the VBA function using the <code>cdecl</code> calling convention?  If VBA cannot call <code>cdecl</code> functions, you need to change the C++ code to add <code>_stdcall</code>."}, {"owner": {"reputation": 562, "user_id": 2976741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/36265b8c98776b0d215baa2d4fb89027?s=128&d=identicon&r=PG&f=1", "display_name": "goldcode", "link": "https://stackoverflow.com/users/2976741/goldcode"}, "edited": false, "score": 0, "creation_date": 1479855335, "post_id": 40752767, "comment_id": 68732360, "body": "__cdecl VRTTCONVERSION_API long controlVTT(BYTE controlVal, BYTE valueVal) may help"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 562, "user_id": 2976741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/36265b8c98776b0d215baa2d4fb89027?s=128&d=identicon&r=PG&f=1", "display_name": "goldcode", "link": "https://stackoverflow.com/users/2976741/goldcode"}, "edited": false, "score": 0, "creation_date": 1479855499, "post_id": 40752767, "comment_id": 68732414, "body": "@goldcode I believe it should be <code>__stdcall</code>, but not sure it comes before or after the <code>_declspec</code>.  In any event, the OP needs to change their C++ function to <code>__stdcall</code>, as I believe VBA uses this calling convention."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479855753, "post_id": 40752767, "comment_id": 68732519, "body": "It may just be how the BYTE parameters are being marshaled - VBA chokes on unsigned types. I&#39;d give <code>(controlVal As Any, valueVal As Any)</code> a shot before I tried anything else."}, {"owner": {"reputation": 562, "user_id": 2976741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/36265b8c98776b0d215baa2d4fb89027?s=128&d=identicon&r=PG&f=1", "display_name": "goldcode", "link": "https://stackoverflow.com/users/2976741/goldcode"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1479855913, "post_id": 40752767, "comment_id": 68732570, "body": "@PaulMcKenzie right __stdcall is perhaps a better bet since its an &#39;inter-language&#39; call."}, {"owner": {"reputation": 11, "user_id": 7197020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5782527e3913a97dca98fdd6136860f?s=128&d=identicon&r=PG&f=1", "display_name": "R. Reid", "link": "https://stackoverflow.com/users/7197020/r-reid"}, "edited": false, "score": 0, "creation_date": 1479856237, "post_id": 40752767, "comment_id": 68732701, "body": "Aha! VBA uses stdcall. I have changed my VRTTCONVERSION_API define and all seems to be working. Thank you very much!"}], "owner": {"reputation": 11, "user_id": 7197020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5782527e3913a97dca98fdd6136860f?s=128&d=identicon&r=PG&f=1", "display_name": "R. Reid", "link": "https://stackoverflow.com/users/7197020/r-reid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479853530, "creation_date": 1479853530, "question_id": 40752767, "link": "https://stackoverflow.com/questions/40752767/bad-dll-calling-convention-in-excel", "title": "Bad DLL Calling Convention in Excel", "body": "<p>I have tried the tricks posted here (at least the ones I have found), but I still can't seem to rid myself of the dreaded \"Bad DLL Calling Convention\" error. Here is my (very simple) c++ code:</p>\n\n<pre><code>VRTTCONVERSION_API long controlVTT(BYTE controlVal, BYTE valueVal)\n{\n    LPSTR controlStr = new char[256];\n    PCHAR convstrout = new char[256];\n\n    if (controlVal == 1) {\n        controlStr = \"Ping\";\n    }else if (controlVal == 2) {\n        controlStr = \"0 Init Tool Default\";\n    }\n    if (bGetGeneralAccessFunctionPointer()) {\n        return (pGeneral)(controlStr, convstrout, 256);\n    }\n    else {\n        printf(\"failed to acquire function pointer.\\n\");\n        return -1;\n    }\n}\n</code></pre>\n\n<p>This SHOULD accept bytes as inputs and return a long. I know the return works as I have another function that doesn't accept any inputs and returns the long and that one works fine.</p>\n\n<p>Here is the VBA code (again, simple):</p>\n\n<pre><code>Public Declare PtrSafe Function controlVTT Lib \"VRTTConversionDLL.dll\" Alias \"#4\" (ByVal controlVal As Byte, ByVal valueVal As Byte) As Long\n\nSub testControl()\n\nDim retval As Long\nDim bFunc As Byte\nDim bVal As Byte\n\nbVal = 0\nbFunc = 1\n\nretval = controlVTT(bFunc, bVal)\nMsgBox retval\nbFunc = 2\nretval = controlVTT(bFunc, bVal)\nMsgBox retval    \nEnd Sub\n</code></pre>\n\n<p>I know the #4 alias is correct (from using DLL Export Viewer). This function also works when I call it from another C++ function (see below):</p>\n\n<pre><code>int main()\n{\n    long retVal;\n    retVal = controlVTT(1, 0);\n    printf(\"Return: %08X \\n\", retVal);\n    retVal = controlVTT(2, 0);\n    printf(\"Return: %08X \\n\", retVal);\n    return 0;   return 0;\n}\n</code></pre>\n\n<p>Obviously, I'm not a professional programmer and I'm probably missing something basic, but I am truly stuck.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1479868062, "post_id": 40752689, "comment_id": 68735865, "body": "Should <code>reportRow</code> be reset back to 1 each time you open a new workbook?"}, {"owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1479909101, "post_id": 40752689, "comment_id": 68756706, "body": "yup i forgot that part, thanks."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1479942275, "post_id": 40752689, "comment_id": 68774899, "body": "Does resetting <code>reportRow</code> to 1 each time you open a workbook fix the problem with only the data from the first workbook being pasted?"}], "owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479853201, "creation_date": 1479853201, "last_edit_date": 1531164843, "question_id": 40752689, "link": "https://stackoverflow.com/questions/40752689/macro-not-pasting-from-each-file-stored-in-a-collection", "title": "Macro not pasting from each file stored in a collection", "body": "<p>My code only returns one files data but not the whole collection.</p>\n\n<pre><code>'Collect all data from audit templates\nRecursiveDir colFiles, path, \"*.xlsm\", True\nFor Each varFile In colFiles\n    Set reportBook = Workbooks.Open(varFile)\n    Set suSummary = reportBook.Sheets(\"SU Summaries\")\n    Do While suSummary.Cells(reportRow, 1) &lt;&gt; \"\" 'Only report if there are scanned files\n        lineNum = lineNum + 1\n        With suSummary\n            scanDate = FileDateTime(varFile)\n            scanned = .Cells(reportRow, 2)\n            auditor = .Cells(reportRow, 3)\n        End With\n        ReDim Preserve reportArray(3, lineNum)\n        reportArray(0, lineNum) = scanDate\n        reportArray(1, lineNum) = scanned\n        reportArray(2, lineNum) = auditor\n        reportRow = reportRow + 1\n    Loop\nreportBook.Close SaveChanges:=False\nNext varFile\n\n'Paste data into Scan Sheet\nFor lineNum = 1 To UBound(reportArray, 2)\n    With scanSheet\n        .Cells(baseRow, 1) = reportArray(0, lineNum) 'Date Scanned\n        .Cells(baseRow, 2) = reportArray(1, lineNum) 'Scanned\n        .Cells(baseRow, 3) = reportArray(2, lineNum) 'Auditor\n        .Cells(baseRow, 4).Formula = \"=IF(LEN(C\" &amp; baseRow &amp; \")&gt;2,TRIM(LEFT(TRIM(C\" &amp; baseRow &amp; \"),2)),C\" &amp; baseRow &amp; \")\" 'Auditor1\n        .Cells(baseRow, 5).Formula = \"=IF(LEN(C\" &amp; baseRow &amp; \")&gt;2,TRIM(RIGHT(TRIM(C\" &amp; baseRow &amp; \"),2)),C\" &amp; baseRow &amp; \")\" 'Auditor 2\n        .Cells(baseRow, 6).Formula = \"=B\" &amp; baseRow &amp; \"/2\" 'Average Scanned\n        .Cells(baseRow, 7).Formula = \"=IF(OR(ISNA(VLOOKUP(D\" &amp; baseRow &amp; \",Summary!A:C,1,0)),ISNA(VLOOKUP(E\" &amp; baseRow &amp; \",Summary!A:C,1,0))),\"\"MISSING\"\",\"\"GOOD\"\")\" 'Auditor CK\n    End With\n    baseRow = baseRow + 1\nNext lineNum\n</code></pre>\n\n<p>The macro runs fine and opens up all the workbooks, but it only will paste data from the first workbook instead of all of them.</p>\n"}, {"tags": ["excel", "vba", "runtime"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1479852630, "post_id": 40752481, "comment_id": 68731256, "body": "bet you dont have a worksheet named &quot;Generate Report&quot;, do you?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479855221, "post_id": 40752481, "comment_id": 68732318, "body": "<code>ThisWorkbook.Worksheets(&quot;Generate Report&quot;).Range(&quot;E2,D5,D7,H2,E3&quot;).Interior.ColorIndex = 0</code> (once you figure out the worksheet name issue)"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 4245796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f7e5d5a19cdb7e94369e90670c4a92?s=128&d=identicon&r=PG&f=1", "display_name": "seppdepp3", "link": "https://stackoverflow.com/users/4245796/seppdepp3"}, "is_accepted": false, "score": 0, "last_activity_date": 1479852504, "creation_date": 1479852504, "answer_id": 40752531, "question_id": 40752481, "link": "https://stackoverflow.com/questions/40752481/run-time-error-1004/40752531#40752531", "title": "Run-time error 1004:", "body": "<p>Check the name of your worksheet, is it \"Generate Report\"?</p>\n"}], "owner": {"reputation": 1, "user_id": 7196977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae76d1823656316b2233bbdf0154b94f?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Guse", "link": "https://stackoverflow.com/users/7196977/dan-guse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479912061, "creation_date": 1479852283, "last_edit_date": 1479912061, "question_id": 40752481, "link": "https://stackoverflow.com/questions/40752481/run-time-error-1004", "title": "Run-time error 1004:", "body": "<p>Hi I am very new to coding on excel and have been trying to fix a xlsm file that links a bunch of data sheets together that was created by a previous employee. when ever I click on the button to generate a report from the other workbooks I receive error 1004. I ran the debug and the error showing up is</p>\n\n<pre><code>Private Sub resetErrors()\n    With ThisWorkbook.Worksheets(\"Generate Report\")\n        .Range(\"E2\").Interior.ColorIndex = 0\n        .Range(\"D5\").Interior.ColorIndex = 0\n        .Range(\"D7\").Interior.ColorIndex = 0\n        .Range(\"D9\").Interior.ColorIndex = 0\n        .Range(\"H2\").Interior.ColorIndex = 0\n        .Range(\"E3\").Interior.ColorIndex = 0\n    End With\nEnd Sub\n</code></pre>\n\n<p>the range e2 is the one highlighted. I thought it had to do with missing data on one of the worksheets but cannot seem to find any. Any help in a very simple terms would be greatly appreciated. Thanks</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1479853619, "post_id": 40752450, "comment_id": 68731683, "body": "By it&#39;s nature, a pass-thru query has an ODBC connection. That is not required for a local query as you can simply execute the SQL. Why don&#39;t you just grab the SQL (like: currentdb.querydefs(&quot;passthru&quot;).SQL) then execute (but not using that prior connection)?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1479899040, "post_id": 40752450, "comment_id": 68749763, "body": "If the two queries have different SQL (as your code suggests), I would just keep both queries. And only switch <code>SubForm1.SourceObject</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 0, "creation_date": 1479919631, "post_id": 40762183, "comment_id": 68763899, "body": "It will be next week before I can confirm this works, but logically I think it will work fine. I didn&#39;t think to just wipe out the query definition and re-create it. Thanks!"}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": true, "score": 0, "last_activity_date": 1479897745, "creation_date": 1479897745, "answer_id": 40762183, "question_id": 40752450, "link": "https://stackoverflow.com/questions/40752450/change-access-query-type-dynamically-in-vba-from-a-pass-through-odbc-query-to/40762183#40762183", "title": "Change Access Query Type Dynamically in VBA from a Pass Through (ODBC) Query to a regular Select Query", "body": "<p>The correct way is to delete and create the QueryDef.</p>\n\n<p>add this before changing to local table:</p>\n\n<pre><code>DoCmd.DeleteObject acQuery, qd.name\nSet qd= MyDB.CreateQueryDef(qd.name)\nqd.SQL = \"Select * from ALocalTable;\"\nqd.close\n</code></pre>\n\n<p>and if you want to go back to passthrough:</p>\n\n<pre><code>DoCmd.DeleteObject acQuery, qd.name\nSet qd= MyDB.CreateQueryDef(qd.name)\nqd.connect = GET_CONNECTION_STRING\nqd.SQL = \"Select * from SomeRemoteTable;\"\nqd.close\n</code></pre>\n\n<p>for update queries set \"qd.ReturnsRecords = false\"</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1159, "favorite_count": 0, "accepted_answer_id": 40762183, "answer_count": 1, "score": 1, "last_activity_date": 1479897745, "creation_date": 1479852133, "last_edit_date": 1495535417, "question_id": 40752450, "link": "https://stackoverflow.com/questions/40752450/change-access-query-type-dynamically-in-vba-from-a-pass-through-odbc-query-to", "title": "Change Access Query Type Dynamically in VBA from a Pass Through (ODBC) Query to a regular Select Query", "body": "<p>I am interested in using a Microsoft Access Query dynamically, sometimes as a Pass Through query using ODBC to get to a remote SQL Server and sometimes as a local Select query to get to a table inside the same Access database. However, the QueryDef.Type property is read-only and I can't figure out how to change it. </p>\n\n<p>So in code it looks like:</p>\n\n<pre><code>Dim qd As DAO.QueryDef\nSet qd = CurrentDB.QueryDefs(\"qrySubForm1\")\n\n'this line turns the qd.Type property to dbQSQLPassThrough automatically I believe\nqd.Connect = \"ODBC;--connectionstring--\"  \n\nqd.SQL = \"Select * from SomeRemoteTable\"\n\n'populate the subform with the results of the Pass Through query\nSubForm1.SourceObject = \"Query.qrySubForm1\" \n\n'Intent: change to regular select query.\nqd.Type = dbQSelect   ' Error: read-only property\n\nqd.SQL = \"Select * from ALocalTable\"\n\n' now change the SubForm to show results of the local query\nSubForm1.SourceObject = \"Query.qrySubForm1\"  \n</code></pre>\n\n<p>The QueryDef Type property is one of the values in <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192931.aspx\" rel=\"nofollow noreferrer\">this</a> enum.</p>\n\n<p>If I switch between two local queries, or between two pass-through queries it works fine. It's only when I try to switch between a pass-through query and a local query that I'm having trouble. </p>\n\n<p><strong>Update:</strong>\n<a href=\"https://stackoverflow.com/a/4685372/2363207\">This</a> answer to another SO question seems to suggest that I can add a property to the query definition, but I'm not sure if that would apply in the case of the \"Type.\"</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 2, "creation_date": 1479852480, "post_id": 40752349, "comment_id": 68731182, "body": "For CF Color use: <code>MsgBox Selection.DisplayFormat.Interior.ColorIndex</code>"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "reply_to_user": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1479855606, "post_id": 40752349, "comment_id": 68732457, "body": "Hi @Fadi, thanks for the input. I tried that to no avail (noted under &quot;The Problem&quot;)"}, {"owner": {"reputation": 94, "user_id": 2480580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bs2TV.png?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2480580/andy"}, "edited": false, "score": 0, "creation_date": 1479863536, "post_id": 40752349, "comment_id": 68734702, "body": "CF Color and cell&#39;s format will conflict.Clear CF Color and try again."}, {"owner": {"reputation": 191, "user_id": 5149107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf2d7652f551f5c58c3005cb880f39f?s=128&d=identicon&r=PG&f=1", "display_name": "hughg", "link": "https://stackoverflow.com/users/5149107/hughg"}, "reply_to_user": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 1, "creation_date": 1479872778, "post_id": 40752349, "comment_id": 68736967, "body": "I think @Fadi comment should work. Note the <code>.DisplayFormat</code> makes it different to what you noted under &quot;The Problem&quot;, but only works from Excel 2010"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1479884196, "post_id": 40752349, "comment_id": 68740683, "body": "Probably you can name the ranges in Selection and preserve these names in an array. Use Selection.Area for the ranges. Then later iterate through the named ranges and do the stuff with them."}], "owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479851692, "creation_date": 1479851692, "question_id": 40752349, "link": "https://stackoverflow.com/questions/40752349/highlight-entire-row-based-on-conditional-formatting", "title": "Highlight entire row based on Conditional Formatting", "body": "<p><strong>THE BACKGROUND</strong></p>\n\n<p>I'm writing a Sub to audit a report that is received daily. It is meant to check for blanks in 3 columns and duplicates in a fourth, then delete all rows that did not have an issue (i.e. no duplicates, no blanks).</p>\n\n<p>Blanks are found in each row with:</p>\n\n<pre><code>lRow = Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n\nSet MR = Range(\"D1:D\" &amp; lRow)\nFor Each cell In MR\nIf cell.Value = \"\" Then cell.EntireRow.Interior.ColorIndex = 2\nNext\n\nSet MR = Range(\"E1:E\" &amp; lRow)\nFor Each cell In MR\nIf cell.Value = \"\" Then cell.EntireRow.Interior.ColorIndex = 2\nNext\n\nSet MR = Range(\"M1:M\" &amp; lRow)\nFor Each cell In MR\nIf cell.Value = \"\" Then cell.EntireRow.Interior.ColorIndex = 2\nNext\n</code></pre>\n\n<p>And duplicates by Conditional Formatting here:</p>\n\n<pre><code>   Columns(\"J:J\").Select\n    Selection.FormatConditions.AddUniqueValues\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    Selection.FormatConditions(1).DupeUnique = xlDuplicate\n    With Selection.FormatConditions(1).Font\n        .Color = -16383844\n        .TintAndShade = 0\n    End With\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 13551615\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n</code></pre>\n\n<hr>\n\n<p><strong>THE PROBLEM</strong></p>\n\n<p>The code that I am using to delete \"non-issue\" rows only keeps rows whose entire row has a fill. The conditional formatting for duplicates does not allow for highlighting of more than just the cell, to my knowledge. </p>\n\n<p>To solve this, I tried to use some code to find cells with the conditional formatting fill (<code>ColorIndex 38</code>), and fill the entire row, but it seems that the CF does not actually fill the cell as <code>MsgBox Selection.Interior.ColorIndex</code> returns \"-4142\" (<code>NoFill</code>). </p>\n\n<hr>\n\n<p><strong>THE QUESTION</strong></p>\n\n<p>How can I either:</p>\n\n<ul>\n<li>Identify conditionally formatted cells and fill the entire row?</li>\n</ul>\n\n<p>or</p>\n\n<ul>\n<li>Remove only rows that do not contain a single cell that is filled?</li>\n</ul>\n"}]