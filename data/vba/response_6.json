[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 1, "creation_date": 1424302993, "post_id": 28595811, "comment_id": 45498804, "body": "Try:     Lastrow = Cells.Find(&quot;*&quot;, Range(&quot;A1&quot;), xlValues, , xlByRows, xlPrevious).Row"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1424305392, "post_id": 28595811, "comment_id": 45499586, "body": "Your only using Column 1 or column 22 so you can find the last row in one of those columns.:<code>lastrow=Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row</code> or <code>lastrow=cells(rows.count,22).end(xlup).row</code>"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1424305548, "post_id": 28596345, "comment_id": 45499652, "body": "Thanks...replaced the code.  However, now the code stops at &quot;Range(Cells(1, 1), Cells(Lastrow, 22)).Select&quot; with a 1004 error: Application-Defined or Object-Defined error.  As I step through I notice &quot;LastRow&quot; becomes = 2, yet it should be 4 as I have checked the table of values (4 rows, 22 columns)....this is bazaar!"}, {"owner": {"reputation": 7506, "user_id": 622391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea6f87ff9eacc4b168afcb647d69977?s=128&d=identicon&r=PG", "display_name": "Simon M\u1d9cKenzie", "link": "https://stackoverflow.com/users/622391/simon-m%e1%b6%9ckenzie"}, "reply_to_user": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1424305989, "post_id": 28596345, "comment_id": 45499796, "body": "Maybe instead of <code>Range(Cells(1, 1), Cells(Lastrow, 22)).Select</code> (which looks fine to me anyway), you should use <code>Range(&quot;A1&quot;, Range(&quot;A1&quot;).SpecialCells(xlLastCell)).Select</code>..."}, {"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1424307830, "post_id": 28596345, "comment_id": 45500392, "body": "This looks like a bigger problem.  The Donation Table.xlsm was exported by Access 2007 as the result of a query; data stored in &quot;DonationDataQuery&quot; sheet.  Noticed that all number fields had a green triangle - numbers stored as text.  This was necessary as the data was being input by visually impaired persons.  Now when I try to open the sheet and fix the text to number issue, using code added above, it stops at &quot;Range(&quot;A1:O50&quot;).Select&quot; with error 1004...now will have to post another question  :("}, {"owner": {"reputation": 7506, "user_id": 622391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea6f87ff9eacc4b168afcb647d69977?s=128&d=identicon&r=PG", "display_name": "Simon M\u1d9cKenzie", "link": "https://stackoverflow.com/users/622391/simon-m%e1%b6%9ckenzie"}, "reply_to_user": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1424310632, "post_id": 28596345, "comment_id": 45501170, "body": "Does the sheet have a limited number of columns? I can&#39;t see why <code>Range(&quot;A1:O50&quot;).Select</code> would fail unless your sheet doesn&#39;t have a cell <code>&quot;O50&quot;</code>, which I don&#39;t think is possible, or if somehow selection isn&#39;t possible (i.e. the sheet has lost focus)..."}, {"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1424564733, "post_id": 28596345, "comment_id": 45603171, "body": "Thanks for the input...I was trying to open another file and run some code in that file, copy the results, and bring it back into my current workbook...too much trouble so just copied the data and closed the file, then pasted into current workbook and manipulated the data in the current workbook....problem solved."}], "tags": [], "owner": {"reputation": 7506, "user_id": 622391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea6f87ff9eacc4b168afcb647d69977?s=128&d=identicon&r=PG", "display_name": "Simon M\u1d9cKenzie", "link": "https://stackoverflow.com/users/622391/simon-m%e1%b6%9ckenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1424304864, "last_edit_date": 1424304864, "creation_date": 1424304180, "answer_id": 28596345, "question_id": 28595811, "link": "https://stackoverflow.com/questions/28595811/simple-lastrow-code-copied-from-others-does-not-work/28596345#28596345", "title": "Simple Lastrow code COPIED from others does not work?", "body": "<p>If your sheet doesn't contain a cell with \"*\" inside it, <code>Cells.Find(\"*\", [A1], , , xlByRows, xlPrevious)</code> will be null. If you then reference <code>.Row</code>, you will get the error you've described.</p>\n\n<p>It appears that you're trying to find the last populated row in the sheet. The code below will give you the last row in column \"A\" with content:</p>\n\n<pre><code>LastRow = Range(\"A1\").End(xlDown).Row\n</code></pre>\n\n<p>Note that if you want to select all items in the sheet, this will give you a range containing all populated cells:</p>\n\n<pre><code>Dim allCells As Range\nSet allCells = Range(\"A1\", Range(\"A1\").SpecialCells(xlLastCell))\n</code></pre>\n\n<p>Both of these pieces of code were created by recording a macro, selecting cell \"A1\", and pressing <kbd>Ctrl</kbd>+<kbd>Down</kbd> and <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>End</kbd> respectively. Recording macros is a great way to start any vba function!</p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1424337632, "creation_date": 1424337632, "answer_id": 28602570, "question_id": 28595811, "link": "https://stackoverflow.com/questions/28595811/simple-lastrow-code-copied-from-others-does-not-work/28602570#28602570", "title": "Simple Lastrow code COPIED from others does not work?", "body": "<p>From your errors, I'd assume your code is in a worksheet code module and therefore all your Range and Cells calls refer to that sheet unless qualified with a worksheet object. Try this instead:</p>\n\n<pre><code>Dim Lastrow               As Long\nDim NumPickups            As Long\nDim rFound                As Range\n\nWith Workbooks.Open(Filename:=\"C:\\Users\\dads\\Downloads\\Donation Data.xlsm\").Worksheets(\"DonationDataQuery\")\n\n    Set rFound = .Cells.Find(\"*\", .Range(\"A1\"), , , xlByRows, xlPrevious)\n    If rFound Is Nothing Then\n        Lastrow = 2\n    Else\n        Lastrow = rFound.Row\n    End If\n\n    NumPickups = Lastrow - 1\n\n    .Range(.Cells(1, 1), .Cells(Lastrow, 22)).Copy Destination:=Workbooks(\"test.xlsm\").ActiveSheet.Range(\"J1\")\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "accepted_answer_id": 28596345, "answer_count": 2, "score": 0, "last_activity_date": 1424337632, "creation_date": 1424301264, "last_edit_date": 1531164843, "question_id": 28595811, "link": "https://stackoverflow.com/questions/28595811/simple-lastrow-code-copied-from-others-does-not-work", "title": "Simple Lastrow code COPIED from others does not work?", "body": "<p>Code clearly opens Workbook and Worksheet (with four rows of data)....but then STOPS at \"Lastrow = Cells.....\"   with Error 91 \"Object Variable or With Block Variable Not Set.\"</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Dim Lastrow As Long, NumPickups As Integer\r\n\r\nWorkbooks.Open Filename:=\"C:\\Users\\dads\\Downloads\\Donation Data.xlsm\"\r\n\r\nWorksheets(\"DonationDataQuery\").Activate\r\n\r\nLastrow = Cells.Find(\"*\", [A1], , , xlByRows, xlPrevious).Row\r\n\r\nNumPickups = Lastrow - 1\r\n\r\nRange(Cells(1, 1), Cells(Lastrow, 22)).Select\r\n\r\nSelection.Copy\r\n\r\nWindows(\"test.xlsm\").Activate\r\n\r\nRange(\"J1\").Select\r\n\r\nActiveSheet.Paste\r\n\r\nWindows(\"Donation Data.xlsm\").Activate</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Revised code approach based on comment below:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Private Sub GeneratePickupData_Click()\r\n\r\n'Open the Donation Data.xlsm and copy the data to this worksheet\r\n\r\nWorkbooks.Open Filename:=\"C:\\Users\\dads\\Downloads\\Donation Data.xlsm\"\r\nWorksheets(\"DonationDataQuery\").Activate\r\n\r\n'covert numbers brought over by Acess as text to numbers\r\n\r\nRange(\"A1:O50\").Select\r\n    With Selection\r\n        Selection.NumberFormat = \"General\"\r\n        .Value = .Value\r\n    End With\r\n\r\nDim Lastrow As Long, NumPickups As Integer\r\n\r\nLastrow = 0\r\nNumPickups = 0\r\n\r\n''Lastrow = Cells.Find(\"*\", [A1], , , xlByRows, xlPrevious).Row\r\nLastrow = Range(\"A1\").End(xlDown).Row\r\n\r\nNumPickups = Lastrow - 1\r\n\r\n'Range(Cells(1, 1), Cells(Lastrow, 22)).Select\r\nRange(\"A1\", Range(\"A1\").SpecialCells(xlLastCell)).Select\r\n\r\nRange(\"A1:V50\").Select\r\n\r\nSelection.Copy\r\n\r\nWindows(\"Pickup Form Gen 2.xlsm\").Activate\r\n\r\nRange(\"J1\").Select\r\n\r\nActiveSheet.Paste\r\n\r\nWindows(\"Donation Data.xlsm\").Activate\r\n\r\n\r\nActiveSheet.UsedRange.ClearContents\r\n\r\nActiveWorkbook.Save\r\n\r\nActiveWindow.Close</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1424305595, "post_id": 28595755, "comment_id": 45499663, "body": "<code>Range(&quot;B1:B68&quot;)=&quot;=FindMyOrderNumber(RC[-1])&quot;</code>  try it."}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1424335471, "post_id": 28595755, "comment_id": 45509078, "body": "@Davesexcel Sounds like an answer to me, if you can also explain why their current code isn&#39;t working that would make an excellent one at that."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4581436, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/7545830288380bdeb4e5e2029a542f44?s=128&d=identicon&r=PG&f=1", "display_name": "user4581436", "link": "https://stackoverflow.com/users/4581436/user4581436"}, "edited": false, "score": 0, "creation_date": 1424356636, "post_id": 28607170, "comment_id": 45521901, "body": "The problem that  I am having now is that column A will grow larger past over time I tried using:       Range(&quot;B:B&quot;) = &quot;=FindMyOrderNumber(RC[-1])&quot;  - to cover my bases but then my Excel would crash."}, {"owner": {"reputation": 37, "user_id": 4581436, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/7545830288380bdeb4e5e2029a542f44?s=128&d=identicon&r=PG&f=1", "display_name": "user4581436", "link": "https://stackoverflow.com/users/4581436/user4581436"}, "edited": false, "score": 0, "creation_date": 1424358285, "post_id": 28607170, "comment_id": 45523108, "body": "You are awesome! Thank you so much."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1424357841, "last_edit_date": 1424357841, "creation_date": 1424351001, "answer_id": 28607170, "question_id": 28595755, "link": "https://stackoverflow.com/questions/28595755/issue-creating-autofill-macro-with-a-vba-function/28607170#28607170", "title": "Issue Creating Autofill Macro with a VBA Function", "body": "<p>Add application.volatile to the function, that way it will calculate as the sheet changes.</p>\n\n<pre><code>Function FindMyOrderNumber(strOrder As String) As String\n\n    Dim ws As Worksheet\n    Dim rng As Range\n    Application.Volatile\n    For Each ws In Worksheets\n        If ws.CodeName &lt;&gt; \"Sheet3\" Then\n            Set rng = Nothing\n            On Error Resume Next\n            Set rng = ws.Cells.Find(What:=strOrder, LookAt:=xlWhole)\n            On Error GoTo 0\n            If Not rng Is Nothing Then\n                FindMyOrderNumber = ws.Name\n                Exit For\n            End If\n        End If\n    Next\n\n    Set rng = Nothing\n    Set ws = Nothing\n\nEnd Function\n</code></pre>\n\n<p>It also wouldn't hurt to calculate the sheet when You add the formula to the range.</p>\n\n<pre><code>Sub Button1_Click()\n    Dim Rws As Long, Rng As Range\n    Rws = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set Rng = Range(Cells(1, 2), Cells(Rws, 2))\n    Rng = \"=FindMyOrderNumber(RC[-1])\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4581436, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/7545830288380bdeb4e5e2029a542f44?s=128&d=identicon&r=PG&f=1", "display_name": "user4581436", "link": "https://stackoverflow.com/users/4581436/user4581436"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 28607170, "answer_count": 1, "score": 0, "last_activity_date": 1424357841, "creation_date": 1424301038, "last_edit_date": 1495541560, "question_id": 28595755, "link": "https://stackoverflow.com/questions/28595755/issue-creating-autofill-macro-with-a-vba-function", "title": "Issue Creating Autofill Macro with a VBA Function", "body": "<p>I am having an issue creating a macro that will autofill a VBA function named \"FindMyOrderNumber\". Every time I run a macro to Autofill \"FindMyOrderNumber\" only the first cell in the column is populated. </p>\n\n<p>This function will look up an order number in column A (A1) and return the name of the worksheet it can be found B (B1).  </p>\n\n<pre><code>Option Explicit\nFunction FindMyOrderNumber(strOrder As String) As String\n\n    Dim ws As Worksheet\n    Dim rng As Range\n\n    For Each ws In Worksheets\n        If ws.CodeName &lt;&gt; \"Sheet3\" Then\n            Set rng = Nothing\n            On Error Resume Next\n                Set rng = ws.Cells.Find(What:=strOrder, LookAt:=xlWhole)\n            On Error GoTo 0\n            If Not rng Is Nothing Then\n                FindMyOrderNumber = ws.Name\n                Exit For\n            End If\n        End If\n    Next\n\n    Set rng = Nothing\n    Set ws = Nothing\n\nEnd Function\n</code></pre>\n\n<p>I created this macro to enter my VBA function \"=findmyordernumber(a1)\" in cell B1 then to Autofill column B.</p>\n\n<pre><code>Sub AutofillVBAFunction()\n\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"=FindMyOrderNumber(RC[-1])\"\n    Selection.Autofill Destination:=Range(\"B1:B68\")\n    Range(\"B1:B68\").Select\nEnd Sub\n</code></pre>\n\n<p>After I run this macro only B1 is populated.</p>\n\n<p>Sorry if this has been discussed I am new and I tried <a href=\"https://stackoverflow.com/questions/847301/how-to-fill-up-cells-within-a-excel-worksheet-from-a-vba-function\">How to fill-up cells within a Excel worksheet from a VBA function?</a> and other questions and I could not apply it to my issue. </p>\n\n<p>Please help</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1424320062, "post_id": 28595694, "comment_id": 45503451, "body": "Suggest you add your answer below, which shows the code you have tried, to your question, to keep it from being closed"}, {"owner": {"reputation": 29, "user_id": 4581620, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-1nfIahG7mKI/AAAAAAAAAAI/AAAAAAAAAAA/ukLdoYni-s8/photo.jpg?sz=128", "display_name": "SnakZ Maynard", "link": "https://stackoverflow.com/users/4581620/snakz-maynard"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1424335226, "post_id": 28595694, "comment_id": 45508957, "body": "Where i added the code was not the right place ?"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 4581620, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-1nfIahG7mKI/AAAAAAAAAAI/AAAAAAAAAAA/ukLdoYni-s8/photo.jpg?sz=128", "display_name": "SnakZ Maynard", "link": "https://stackoverflow.com/users/4581620/snakz-maynard"}, "is_accepted": false, "score": 0, "last_activity_date": 1424314340, "creation_date": 1424314340, "answer_id": 28597894, "question_id": 28595694, "link": "https://stackoverflow.com/questions/28595694/vbaexcel-regex-matche-replace-and-divid-newbe/28597894#28597894", "title": "VBA(excel) Regex matche , replace and divid (newbe)", "body": "<p>this is the best i could come up with lol </p>\n\n<pre><code>Sub ExtractSDI()\nDim text As String\nDim result As String\nDim allMatches As Object\nDim RE As Object\nSet RE = CreateObject(\"vbscript.regexp\")\n\ntext = \"RR# FM454\"\n\nRE.Pattern = \"(RR# [a-z]{2}\\d+)\"\nRE.Global = True\nRE.IgnoreCase = True\nSet allMatches = RE.Execute(text)\n\nIf allMatches.Count &lt;&gt; 0 Then\n'full name\n    result = allMatches.Item(0).SubMatches.Item(0)\n\n    'remove the RR#\n    text = result\n    RE.Pattern = \"([a-z]{2}\\d+)\"\n    Set allMatches = RE.Execute(text)\n    result2 = allMatches.Item(0).SubMatches.Item(0)\n\n    ' Keep only numbers\n    text = result2\n    RE.Pattern = \"(\\d+)\"\n    Set allMatches = RE.Execute(text)\n    result3 = allMatches.Item(0).SubMatches.Item(0)\n\n    ' Gives me the FM\n    text = result2\n    RE.Pattern = \"([a-z]{2})\"\n    Set allMatches = RE.Execute(text)\n    result4 = allMatches.Item(0).SubMatches.Item(0)\n    ' Gives me the F\n    text = result4\n    RE.Pattern = \"([a-z]{1})\"\n    Set allMatches = RE.Execute(text)\n    result5 = allMatches.Item(0).SubMatches.Item(0)\n\n    ' Gives me M\n    result6 = Replace(result4, result5, \"\")\n\nEnd If\n\n\nMsgBox (result &amp; \".....\" &amp; result2 &amp; \"..........\" &amp; result3 &amp; \".....\" &amp; result4 &amp; \"...\" &amp; result5 &amp; \".....\" &amp; result6)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 4581620, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-1nfIahG7mKI/AAAAAAAAAAI/AAAAAAAAAAA/ukLdoYni-s8/photo.jpg?sz=128", "display_name": "SnakZ Maynard", "link": "https://stackoverflow.com/users/4581620/snakz-maynard"}, "edited": false, "score": 0, "creation_date": 1424335248, "post_id": 28598174, "comment_id": 45508966, "body": "that does the trick and it look like you just showed me how to make an array what is something i been trying to figure out for some time now :D"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1424316789, "creation_date": 1424316789, "answer_id": 28598174, "question_id": 28595694, "link": "https://stackoverflow.com/questions/28595694/vbaexcel-regex-matche-replace-and-divid-newbe/28598174#28598174", "title": "VBA(excel) Regex matche , replace and divid (newbe)", "body": "<p>I think you are on the right track with a regex, but I would suggest a single regex, and then just pull out the parts using Submatches.  For example:</p>\n\n<pre><code>Option Explicit\nFunction SDI(S As String)\n    Dim RE As Object, allMatches As Object, SM As Object\n    Const sPat As String = \"\\b(RR#)\\s+([A-Z])([A-Z])(\\d+)\"\n    Dim vResult(0 To 3) As Variant\n    Dim I As Long\n\nSet RE = CreateObject(\"vbscript.regexp\")\nWith RE\n    .Global = True\n    .IgnoreCase = True  'or false, depending on your requirements\n    .Pattern = sPat\n    If .test(S) = True Then\n        Set allMatches = RE.Execute(S)\n        Set SM = allMatches(0).submatches\n        For I = 0 To SM.Count - 1\n            vResult(I) = SM(I)\n        Next I\n    End If\nEnd With\n\nMsgBox Join(vResult, \".....\")\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4581620, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-1nfIahG7mKI/AAAAAAAAAAI/AAAAAAAAAAA/ukLdoYni-s8/photo.jpg?sz=128", "display_name": "SnakZ Maynard", "link": "https://stackoverflow.com/users/4581620/snakz-maynard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "closed_date": 1424341522, "accepted_answer_id": 28598174, "answer_count": 2, "score": -2, "last_activity_date": 1424316789, "creation_date": 1424300782, "question_id": 28595694, "link": "https://stackoverflow.com/questions/28595694/vbaexcel-regex-matche-replace-and-divid-newbe", "closed_reason": "Needs more focus", "title": "VBA(excel) Regex matche , replace and divid (newbe)", "body": "<p>Off that bat let me say im real new to VBA(Excel) :D </p>\n\n<p>Anyway i have an input of<br>\nVigil, RR# FM3434 , Vigil</p>\n\n<p>I need the input(from cell) divided into</p>\n\n<p>RR# FM3434</p>\n\n<p>F</p>\n\n<p>M</p>\n\n<p>3434</p>\n\n<p>and put all 4 parts into there own variable so i can play with them. RR# is the only thing that well stay the same the F and M along with the numbers well change and numbers can be longer but well stop with a space or ,</p>\n\n<p>so would be find</p>\n\n<p>RR# LM5464</p>\n\n<p>place in a variable then remove \"RR# \" then remove the numbers placing them in a variable and then divid the L and M and place both of them into there own variable</p>\n\n<p>And if its not tell hard plz leave notes on the coding giving some info on what is going on :D as always ty for any help any of you can give me </p>\n"}, {"tags": ["vba", "solidworks"], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 3997692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9nnp.jpg?s=128&g=1", "display_name": "Artem", "link": "https://stackoverflow.com/users/3997692/artem"}, "is_accepted": false, "score": 0, "last_activity_date": 1425927466, "last_edit_date": 1425927466, "creation_date": 1425901992, "answer_id": 28941367, "question_id": 28595314, "link": "https://stackoverflow.com/questions/28595314/assert-fails-after-succesfully-selecting-a-plane-using-selectbyid2/28941367#28941367", "title": "assert fails after (succesfully) selecting a plane using selectbyId2", "body": "<p>If make assumption that you performing this code as it written, then there is only one way to get \"false\" at second SelectByID2 is a typo. </p>\n\n<p>Try to record a macro as you selecting this planes in the FM (if you select them in graphical area their ID probably will be left blank). After that, save your macro in a language you prefer and open it for editing and you will see through which ID you can access them.</p>\n\n<p>And if you have code between those lines, then probably you've already selected this plane and you're trying select it second time and in this case selection returns false.</p>\n"}], "owner": {"reputation": 1, "user_id": 4581559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe0ae1be9c0c2525c820d246edbf453?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/4581559/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425927466, "creation_date": 1424298884, "question_id": 28595314, "link": "https://stackoverflow.com/questions/28595314/assert-fails-after-succesfully-selecting-a-plane-using-selectbyid2", "title": "assert fails after (succesfully) selecting a plane using selectbyId2", "body": "<p>In the following snippet the first assertion succeeds and the second fails (bStat=False) even though the selection has actually succeeded (plane is selected)</p>\n\n<p>What am I missing? \nThanks for advice/explanation</p>\n\n<pre><code>bStat = swDocExt.SelectByID2(FirstSelection, \"PLANE\", 0, 0, 0, False, 0, Nothing, swSelectOptionDefault) \nDebug.Assert bStat  \n\nbStat = swDocExt.SelectByID2(SecondSelection, \"PLANE\", 0, 0, 0, True, 0, Nothing, swSelectOptionDefault)\nDebug.Assert bStat \n</code></pre>\n\n<p>Note:\nFirstSelection = \"Front Plane@2x6 Wall-1@Assem1\" </p>\n\n<p>SecondSelection = \"Front Plane@Assem1\"</p>\n"}, {"tags": ["string", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2111, "user_id": 1157509, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/51738db85f6b494857eb3d2a22bdbdf8?s=128&d=identicon&r=PG&f=1", "display_name": "ikathegreat", "link": "https://stackoverflow.com/users/1157509/ikathegreat"}, "edited": false, "score": 0, "creation_date": 1424301456, "post_id": 28595360, "comment_id": 45498256, "body": "Yup that did the trick thanks. Used <code>pos - 1</code> to remove an extra space at the end."}], "tags": [], "owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "is_accepted": true, "score": 1, "last_activity_date": 1424301991, "last_edit_date": 1424301991, "creation_date": 1424299109, "answer_id": 28595360, "question_id": 28595306, "link": "https://stackoverflow.com/questions/28595306/remove-right-half-of-string-after-a-certain-number-of-spaces/28595360#28595360", "title": "Remove right half of string after a certain number of spaces", "body": "<p>You can do this using <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1%28v=vs.90%29.aspx\" rel=\"nofollow\">InStr</a> to find the starting position of the five spaces, and then <a href=\"https://msdn.microsoft.com/en-us/library/y050k1wb%28v=vs.90%29.aspx\" rel=\"nofollow\">Left</a> to take just the part of the string before that:</p>\n\n<pre><code>Dim pos As Integer\n\npos = InStr(ProductID, \"     \")\n\nIf pos &gt; 0 Then\n   ProductID = Left(ProductID, pos - 1)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 2111, "user_id": 1157509, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/51738db85f6b494857eb3d2a22bdbdf8?s=128&d=identicon&r=PG&f=1", "display_name": "ikathegreat", "link": "https://stackoverflow.com/users/1157509/ikathegreat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 28595360, "answer_count": 1, "score": 0, "last_activity_date": 1424301991, "creation_date": 1424298841, "last_edit_date": 1531161705, "question_id": 28595306, "link": "https://stackoverflow.com/questions/28595306/remove-right-half-of-string-after-a-certain-number-of-spaces", "title": "Remove right half of string after a certain number of spaces", "body": "<p>I'm writing a macro in Excel that is reading some text from a single cell.</p>\n\n<pre><code>ProductID = rw.Cells(1, 1).Text\n</code></pre>\n\n<p>However the cell may contain some buffer characters, specifically 5 consecutive space characters. I am trying to remove all the characters (length and actual text may vary) after the 5 spaces (including the spaces).</p>\n\n<p>So if the string was:</p>\n\n<pre><code>MyProduct123     removethis\n</code></pre>\n\n<p>The desired string would be </p>\n\n<pre><code>MyProduct123\n</code></pre>\n\n<p>It seems I can remove the 5 spaces with</p>\n\n<pre><code>Replace(MyProductStr, \"     \", \"\")\n</code></pre>\n\n<p>but how can I get the position of the right side string or the text to remove that?</p>\n"}, {"tags": ["vba", "email", "outlook", "move"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4565326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242969a2ca16771228c793bbddbd8bad?s=128&d=identicon&r=PG&f=1", "display_name": "zasx150", "link": "https://stackoverflow.com/users/4565326/zasx150"}, "edited": false, "score": 0, "creation_date": 1424296671, "post_id": 28594303, "comment_id": 45496069, "body": "I&#39;m getting the error: &quot;Run Time Error &#39;-2147221233 (8004010f)&#39;: Sorry, exchange Activesync doesn&#39;t support what you&#39;re trying to do.&quot; (I&#39;m using Outlook 2013, by the way)"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 25, "user_id": 4565326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242969a2ca16771228c793bbddbd8bad?s=128&d=identicon&r=PG&f=1", "display_name": "zasx150", "link": "https://stackoverflow.com/users/4565326/zasx150"}, "edited": false, "score": 0, "creation_date": 1424297738, "post_id": 28594303, "comment_id": 45496652, "body": "You are most likely getting this error at this line <code>Set myDestFolder = Application.GetNamespace(&quot;MAPI&quot;).Folders(&quot;youremailaddress&quot;)&zwnj;&#8203;.Folders(&quot;[Gmail]&quot;).&zwnj;&#8203;Folders(&quot;Spam&quot;)</code>, if so make sure you have the write folder names. Please let me know"}, {"owner": {"reputation": 25, "user_id": 4565326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242969a2ca16771228c793bbddbd8bad?s=128&d=identicon&r=PG&f=1", "display_name": "zasx150", "link": "https://stackoverflow.com/users/4565326/zasx150"}, "edited": false, "score": 0, "creation_date": 1424300490, "post_id": 28594303, "comment_id": 45497885, "body": "What do I replace &quot;[Gmail]&quot; and &quot;MAPI&quot; with? I replaced &quot;youremailaddress&quot; with my email, including the &#39;@outlook.com&#39;, and I replaced &quot;spam&quot; with &quot;spam&quot;, which is a subfolder I made of the &quot;Inbox&quot; folder."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1424305846, "post_id": 28594303, "comment_id": 45499748, "body": "You can surely get to the Junk folder the long way by walking the chain of folders. It is simpler for default folders.  Set myDestFolder = Application.GetNamespace(&quot;MAPI&quot;).GetDefaultFolder(olFolderJu&zwnj;&#8203;nk)  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866724.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff866724.aspx</a>  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff861868%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1424306374, "post_id": 28594303, "comment_id": 45499935, "body": "Based on your description please try <code>Set myDestFolder = Application.GetNamespace(&quot;MAPI&quot;).GetDefaultFolder(olFolderIn&zwnj;&#8203;box).Folders(&quot;Spam&quot;)</code>"}, {"owner": {"reputation": 25, "user_id": 4565326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242969a2ca16771228c793bbddbd8bad?s=128&d=identicon&r=PG&f=1", "display_name": "zasx150", "link": "https://stackoverflow.com/users/4565326/zasx150"}, "edited": false, "score": 0, "creation_date": 1424311759, "post_id": 28594303, "comment_id": 45501443, "body": "The code looks like it should be working, but no matter what I try, I still get the error message mentioned above. The only &quot;solution&quot; I can find is people saying to downgrade to Outlook 2010, which is hardly ideal. This makes no sense; why would I get an error message saying Activesync can&#39;t move an email to another folder? I&#39;m able to do it manually."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1424352188, "post_id": 28594303, "comment_id": 45518976, "body": "What line of code causes the error? Did you try to debug the code?"}, {"owner": {"reputation": 25, "user_id": 4565326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242969a2ca16771228c793bbddbd8bad?s=128&d=identicon&r=PG&f=1", "display_name": "zasx150", "link": "https://stackoverflow.com/users/4565326/zasx150"}, "edited": false, "score": 0, "creation_date": 1424360489, "post_id": 28594303, "comment_id": 45524678, "body": "If a folder&#39;s name was incorrect, wouldn&#39;t I get an &quot;object not found&quot; error?  When the error comes up, it doesn&#39;t indicate what line is causing the error, but it seems to occur whenever I&#39;m trying to use the &#39;MailItem.Move method. I take it no one else can replicate the problem?"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1424361573, "post_id": 28594303, "comment_id": 45525512, "body": "Have you taken a look at this thread <a href=\"https://social.technet.microsoft.com/Forums/office/en-US/4e6f660d-fe2a-426b-9506-19f6bf2816dc/cannot-movecopy-messages-from-pst-to-activesync-hotmail-folder?forum=outlook\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/Forums/office/en-US/&hellip;</a> it appears that this is a bug with Outlook 2013. Several workarounds are proposed. I don&#39;t get this problem because I use gmail :)."}, {"owner": {"reputation": 25, "user_id": 4565326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242969a2ca16771228c793bbddbd8bad?s=128&d=identicon&r=PG&f=1", "display_name": "zasx150", "link": "https://stackoverflow.com/users/4565326/zasx150"}, "edited": false, "score": 0, "creation_date": 1424362901, "post_id": 28594303, "comment_id": 45526526, "body": "Macros not being able to move mail to another folder seems to be a pretty big design flaw. Because I&#39;m not attempting to sync my emails between multiple accounts, Activesync seems like it shouldn&#39;t even effect me. Oh well, I guess I&#39;ll be rolling back to Outlook 2010. Thanks for your time and help everyone."}, {"owner": {"reputation": 25, "user_id": 4565326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242969a2ca16771228c793bbddbd8bad?s=128&d=identicon&r=PG&f=1", "display_name": "zasx150", "link": "https://stackoverflow.com/users/4565326/zasx150"}, "edited": false, "score": 0, "creation_date": 1424365627, "post_id": 28594303, "comment_id": 45528479, "body": "I&#39;m replying again to say that the above code works flawlessly on Outlook 2010, thanks!"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 1, "last_activity_date": 1424295852, "last_edit_date": 1424295852, "creation_date": 1424294971, "answer_id": 28594303, "question_id": 28594107, "link": "https://stackoverflow.com/questions/28594107/move-selected-email-to-junk-e-mail-folder-in-outlook-using-vba-macro/28594303#28594303", "title": "Move Selected Email to Junk E-mail folder in Outlook using VBA Macro", "body": "<p>This will work for you</p>\n\n<pre><code>Sub MoveItems()\n    Dim myDestFolder As Outlook.Folder\n    Set myDestFolder = Application.GetNamespace(\"MAPI\").Folders(\"youremailaddress\").Folders(\"[Gmail]\").Folders(\"Spam\") ' or Junk\n    Dim myItem As Object\n    Set myItem = GetCurrentItem\n    myItem.Move myDestFolder\nEnd Sub\n\nFunction GetCurrentItem() As Object\n    Dim objApp As Outlook.Application\n    Set objApp = Application\n    On Error Resume Next\n    Select Case TypeName(objApp.ActiveWindow)\n    Case \"Explorer\"\n    Set GetCurrentItem = objApp.ActiveExplorer.Selection.Item(1)\n    Case \"Inspector\"\n    Set GetCurrentItem = objApp.ActiveInspector.CurrentItem\n    End Select\n    GetCurrentItem.UnRead = False\n    Set objApp = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1230, "user_id": 155687, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60d4532b799a1ff5f985df6f402cdfe3?s=128&d=identicon&r=PG", "display_name": "Vladislav", "link": "https://stackoverflow.com/users/155687/vladislav"}, "is_accepted": false, "score": 0, "last_activity_date": 1536568737, "creation_date": 1536568737, "answer_id": 52253955, "question_id": 28594107, "link": "https://stackoverflow.com/questions/28594107/move-selected-email-to-junk-e-mail-folder-in-outlook-using-vba-macro/52253955#52253955", "title": "Move Selected Email to Junk E-mail folder in Outlook using VBA Macro", "body": "<p>My version of macros:</p>\n\n<pre><code>Public Sub MarkSelectedAsSpam()\n    Dim junkFolder As Outlook.Folder\n    Set junkFolder = Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderJunk)\n    Dim email As Object\n    For Each email In Application.ActiveExplorer.Selection\n        email.Move junkFolder\n    Next\nEnd Sub\n</code></pre>\n\n<p>Removes selected emails to junk folder.</p>\n"}], "owner": {"reputation": 25, "user_id": 4565326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242969a2ca16771228c793bbddbd8bad?s=128&d=identicon&r=PG&f=1", "display_name": "zasx150", "link": "https://stackoverflow.com/users/4565326/zasx150"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1769, "favorite_count": 0, "accepted_answer_id": 28594303, "answer_count": 2, "score": 1, "last_activity_date": 1536568737, "creation_date": 1424294321, "question_id": 28594107, "link": "https://stackoverflow.com/questions/28594107/move-selected-email-to-junk-e-mail-folder-in-outlook-using-vba-macro", "title": "Move Selected Email to Junk E-mail folder in Outlook using VBA Macro", "body": "<p>I'm attempting to create a sub that will simply move any currently selected mail to the default junk folder in Outlook when the sub is called.<br>\nI'm having a very hard time finding any references I can use, and would appreciate help.</p>\n"}, {"tags": ["vba", "excel", "charts", "labels"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "is_accepted": false, "score": 0, "last_activity_date": 1424304717, "creation_date": 1424304717, "answer_id": 28596452, "question_id": 28593435, "link": "https://stackoverflow.com/questions/28593435/flexible-data-label-formatting/28596452#28596452", "title": "Flexible Data Label Formatting", "body": "<p>I think the words \"conditional formatting\" are your issue here: I've had problems with VBA reading the underlying format of a cell when it's conditionally formatted (admittedly, my issue was with colour, rather than number format, but I expect the reasons for it not working would be the same).</p>\n\n<p>If you adopt your second approach, i.e. relying on the worksheet's format using the chart's \"<strong>Linked to source</strong>\" option, then on a trigger of when the drop-down option is changed, you could use VBA to <strong>set</strong> the format on the worksheet instead of using conditional formatting - then the chart would pick up whatever format you're using.</p>\n"}, {"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456010438, "post_id": 35507131, "comment_id": 58750111, "body": "Welcome to StackOverflow. Please take a moment to read the site guidelines about answering questions. Posting code with no explanation about why it helps solve the problem and - in this case - how to use it is discouraged. Your contribution will have more value if you explain how this helps answer the question AND how to use this code snippet. Not everyone will recognize that you&#39;re showing information from a VBA Immediate Window..."}], "tags": [], "owner": {"reputation": 1, "user_id": 5951498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbb8fe987fa4f14a7dbbe8fb9eb8f7da?s=128&d=identicon&r=PG", "display_name": "Bastian", "link": "https://stackoverflow.com/users/5951498/bastian"}, "is_accepted": false, "score": 0, "last_activity_date": 1455891200, "last_edit_date": 1455891200, "creation_date": 1455890452, "answer_id": 35507131, "question_id": 28593435, "link": "https://stackoverflow.com/questions/28593435/flexible-data-label-formatting/35507131#35507131", "title": "Flexible Data Label Formatting", "body": "<p>Please try this:</p>\n\n<pre><code>?Format(1000,\"$#,##0.0,\")\n$1.000,0\n?Format(1000,\"$#,##0,.0\")\n$1,0\n?Format(1234,\"$#,##0,.0\")\n$1,2\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4538864, "user_type": "registered", "profile_image": "https://graph.facebook.com/2710696737938/picture?type=large", "display_name": "LCG", "link": "https://stackoverflow.com/users/4538864/lcg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1069, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1455891200, "creation_date": 1424291854, "question_id": 28593435, "link": "https://stackoverflow.com/questions/28593435/flexible-data-label-formatting", "title": "Flexible Data Label Formatting", "body": "<p>I'm hoping to add custom data labels to a stacked bar chart in Excel 2010. Each bar will have a label value pulled from a value in the sheet which is not necessarily equal to the height of the bar itself. </p>\n\n<p>The sheet I'm making is a template and has drop-down selections to change the units of the data. For example: $MM with 1 decimal point, K with 2 decimal points, $ with 0 decimal points, etc... I'm running into an issue formatting the labels to match the data formatting selections. I've tried two approaches:</p>\n\n<ol>\n<li><p>Formatting the data labels themselves using VBA. Partial code below for $K with one decimal: </p>\n\n<pre><code>`With ActiveChart.SeriesCollection(x).Points(y)`\n</code></pre>\n\n<p><code>.DataLabel.Text.NumberFormat = \"$#,##0.0,\"</code></p></li>\n</ol>\n\n<p>Unfortunately, the labels don't seem to read the commas and divide by one thousand, so I can't accurate display thousands or millions. A value of 1000 in the above code will display as $1,000.0 instead of the desired $1.0.</p>\n\n<ol start=\"2\">\n<li>Format the values in the worksheet, and then just read them with VBA. Basically, I use conditional formatting to properly display the values on the sheet, and then read them with <code>.DataLabel.Text = Cells(r,c)</code></li>\n</ol>\n\n<p>Unfortunately, though the data is formatted correctly, the values are unchanged and the labels display with no custom formatting at all. </p>\n\n<p>Is there any reasonable way to achieve my goal? I'm hoping there's a way to either (1) make commas count when changing data label number formats or (2) change the actual values of the data in my sheet based on the formatting drop-down selections (instead of just giving them custom formatting which leaves the value unchanged).</p>\n\n<p>Thank you,\nLance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 0, "creation_date": 1424290034, "post_id": 28592879, "comment_id": 45492356, "body": "this has nothing to do with mysql.  Please remove that tag."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1424290423, "post_id": 28592879, "comment_id": 45492554, "body": "Have you tried stacking one on top of the other and using <i>Remove Duplicates</i>?"}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "reply_to_user": {"reputation": 5049, "user_id": 3593640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ily9M.jpg?s=128&g=1", "display_name": "Rashmin Javiya", "link": "https://stackoverflow.com/users/3593640/rashmin-javiya"}, "edited": false, "score": 0, "creation_date": 1424339846, "post_id": 28592879, "comment_id": 45511590, "body": "@RashminJaviya Regarding your change to my suggested edit, please see <a href=\"http://meta.stackoverflow.com/q/260776/3725745\">this discussion on Meta</a> about removing salutations and similar content from posts."}, {"owner": {"reputation": 59971, "user_id": 1835379, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/i63aC.gif?s=128&g=1", "display_name": "Cerbrus", "link": "https://stackoverflow.com/users/1835379/cerbrus"}, "reply_to_user": {"reputation": 5049, "user_id": 3593640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ily9M.jpg?s=128&g=1", "display_name": "Rashmin Javiya", "link": "https://stackoverflow.com/users/3593640/rashmin-javiya"}, "edited": false, "score": 0, "creation_date": 1424341143, "post_id": 28592879, "comment_id": 45512417, "body": "@RashminJaviya: &quot;Thanks in advance&quot; is fluff that should be removed from questions, you shouldn&#39;t have edited the edit suggestion..."}], "answers": [{"tags": [], "owner": {"reputation": 344, "user_id": 1134623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49cbe1fd6ccd8927321e1cca48987ab?s=128&d=identicon&r=PG", "display_name": "Erin Halbmaier", "link": "https://stackoverflow.com/users/1134623/erin-halbmaier"}, "is_accepted": false, "score": 0, "last_activity_date": 1500255776, "last_edit_date": 1500255776, "creation_date": 1500140042, "answer_id": 45120993, "question_id": 28592879, "link": "https://stackoverflow.com/questions/28592879/how-to-use-excel-vba-to-compare-two-worksheets-and-keep-rows-with-unique-ids/45120993#45120993", "title": "How to use Excel VBA to compare two worksheets and keep rows with unique IDs", "body": "<p>If you are able to add a column to your current worksheet data (I hide it so no one changes it!), you could simply have the macro fill in a value - \"x\", timestamp, etc - in this \"Archived\" column after it has archived the row.  Then when you run the macro to archive columns that meet the appropriate criteria, you can either </p>\n\n<p>1) filter the table to Criteria1:=vbNullString to get only the un-archived rows and work with myRange.SpecialCells(xlCellTypeVisible) </p>\n\n<p>Example:</p>\n\n<pre><code>Dim currentSheet as Worksheet\nDim TblLength as long\nDim Table as string\n\nTable = \"TableName\"\nSet currentSheet = ActiveSheet\n\nWith currentSheet.Range(Table)\n   TblLength = .Columns(1).Rows.Count\n   'clear any existing filters\n   .AutoFilter  \n\n   'set new filters\n   .AutoFilter Field:=currentSheet.Range(Table &amp; \"[Transferred]\").Column, Criteria1:=vbNullString\nEnd With\n\nIf currentSheet.Range(\"A1:A\" &amp; TblLength + 1).Columns(1).SpecialCells(xlCellTypeVisible).Count - 1 &gt; 0 Then\n  'make sure we have visible rows\n  Set CopyRange = currentSheet.SpecialCells(xlCellTypeVisible).Copy\n  'other code\nEnd If\n</code></pre>\n\n<p>or </p>\n\n<p>2) loop through all rows in the current worksheet and test If Range(\"Table[Archived]\")(Row) = vbNullString to tell whether or not you have archived it.</p>\n\n<p>Example:</p>\n\n<pre><code>For Row = 1 To Range(Table).Rows.Count\n   If Range(Table &amp; \"[Archived]\")(Row) = vbNullString Then\n          'your code here\n   End if\nNext Row\n</code></pre>\n\n<p>Alternatively, you could sort the archiveSheet by one of the columns - for example, if listing securities sales and purchases, by the Cusip column.  You could then have your first loop be through currentSheet, and the first check on the inner loop through archiveSheet tests to see if the cusips match.  That way, once you are past that cusip in archiveSheet, you can exit the loop - still requires a lot of looping, but a little bit less!</p>\n\n<p>Example:</p>\n\n<pre><code>archiveSheet.Sort Key1:=\"Cusip\", order1:=xlAscending, header:=xlYes\n\nFor iRow2 = 2 To ALastRow\n    match = 0\n    'assuming the cusip is in column A...\n    myCusip = currentSheet.Range(\"A\" &amp; iRow2).Value\n    'we want to know if we've reached it yet\n    cusipMatched = false\n    For iRow = 2 To LastRow2\n\n        If myCusip = archiveSheet.Range(\"A\" &amp; iRow).Value Then\n           cusipMatched = true\n           'your code to check if the row matches\n        Else\n           If cusipMatched Then\n              'we've already reached our cusip, so now we are past it\n              ' this exits the current For loop and continues on in the outer For loop\n              Exit For\n           End if\n        End if\n   Next iRow\nNext iRow2\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4581180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/673fd9b18d76cf5b5fa88730a174c86a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581180", "link": "https://stackoverflow.com/users/4581180/user4581180"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1500255776, "creation_date": 1424289907, "last_edit_date": 1424341097, "question_id": 28592879, "link": "https://stackoverflow.com/questions/28592879/how-to-use-excel-vba-to-compare-two-worksheets-and-keep-rows-with-unique-ids", "title": "How to use Excel VBA to compare two worksheets and keep rows with unique IDs", "body": "<p>Basically I am trying to use Excel and VBA to query new values to a worksheet, run some checks and calculations on the query data and archive the rows that meet a certain criteria.  I have the current worksheet cross referenced to an archive worksheet and any rows that are not already in the archived worksheet are copied to it.  I was using two for loops to iterate through IDs in each worksheet but as I have learned like everybody before me that once the row numbers become significant the macro becomes unwieldingly slow.  I have tried using range examples with variants but can only get comparisons between columns to return column values not the whole row.  </p>\n\n<p>A sample of my loop code is as follows:</p>\n\n<pre><code>Dim ALastRow As Long, ALastCol As Long\nWith ActiveSheet\n    ALastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    ALastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd With\n\nDim iRow2 As Integer, counter As Integer, IDrow As Integer, match As Integer\nDim This_Sheet4 As Worksheet\n\nActiveWorkbook.Sheets(QueryArray(i, 1)).Activate\nSet This_Sheet4 = ThisWorkbook.Sheets(Archive)\n\ncounter = 1\nIDrow = 5\nFor iRow = 2 To LastRow2\n    match = 0\n    For iRow2 = 2 To ALastRow\n        If match = 0 Then\n            If iRow2 = ALastRow Then\n                    If ThisWorkbook.Sheets(QueryArray(i, 1)).Cells(iRow, 12).Value &gt; 1.11111111111111E-02 Then\n                            If ThisWorkbook.Sheets(QueryArray(i, 1)).Cells(iRow, IDrow).Value = ThisWorkbook.Sheets(Archive).Cells(iRow2, IDrow).Value Then\n                            match = 1\n                            Else\n                            ThisWorkbook.Sheets(QueryArray(i, 1)).Rows(iRow).Copy Destination:=ThisWorkbook.Sheets(Archive).Rows(ALastRow + counter)\n                            counter = counter + 1\n                            ActiveWorkbook.Sheets(Archive).Activate\n                            Cells(iRow2, 1).Select\n                            End If\n                        End If\n                Else\n                    If ThisWorkbook.Sheets(QueryArray(i, 1)).Cells(iRow, IDrow).Value = ThisWorkbook.Sheets(Archive).Cells(iRow2, IDrow).Value Then\n                    match = 1\n                    Else\n                    ActiveWorkbook.Sheets(QueryArray(i, 1)).Activate\n                    Cells(iRow, 1).Select\n                    End If\n                End If\n            Else\n            End If\n        Next iRow2\n    Next iRow\nNext\n</code></pre>\n"}, {"tags": ["ms-access", "textbox", "datepicker", "vba", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1424291207, "post_id": 28593054, "comment_id": 45493002, "body": "What event did you use to have the Msgbox pop up?"}, {"owner": {"reputation": 187, "user_id": 1949212, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d4bd5de53d79cbd8bbf7e7e4eff47f4?s=128&d=identicon&r=PG", "display_name": "Dm3k1", "link": "https://stackoverflow.com/users/1949212/dm3k1"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1428694958, "post_id": 28593054, "comment_id": 47288379, "body": "@newd Apologies for the late reply. The full code that is executed (its a call procedure) is as follows: <code>If CurrentProject.AllForms(&quot;TaskAdd&quot;).IsLoaded Then MsgBox (&quot;Success&quot; &amp; vbCrLf &amp; &quot;Task Number: &quot; &amp; Forms!TaskAdd!tboTaskNumber &amp; &quot; has been assigned.&quot;) Else MsgBox (&quot;Success&quot;) End If DoCmd.Close DoCmd.OpenForm &quot;Service_Landing&quot; DoCmd.Requery</code>   ---- I apologize also I appear to not know how to return on a comment."}, {"owner": {"reputation": 187, "user_id": 1949212, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d4bd5de53d79cbd8bbf7e7e4eff47f4?s=128&d=identicon&r=PG", "display_name": "Dm3k1", "link": "https://stackoverflow.com/users/1949212/dm3k1"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1429048073, "post_id": 28593054, "comment_id": 47418230, "body": "This is a known access bug. closing and marking as answered."}], "tags": [], "owner": {"reputation": 187, "user_id": 1949212, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d4bd5de53d79cbd8bbf7e7e4eff47f4?s=128&d=identicon&r=PG", "display_name": "Dm3k1", "link": "https://stackoverflow.com/users/1949212/dm3k1"}, "is_accepted": true, "score": 0, "last_activity_date": 1424290534, "creation_date": 1424290534, "answer_id": 28593054, "question_id": 28592498, "link": "https://stackoverflow.com/questions/28592498/ms-access-date-picker-works-on-first-record-save-update-etc-but-after-submi/28593054#28593054", "title": "MS Access Date Picker works on first record (save, update etc.), but after submit doesn&#39;t fill textbox on other records", "body": "<p>Okay, so the issue has to do with the dialog msgbox. When a record is saved successfully I had set to have a message box be displayed that said \"Success\". Despite having used the exact same code in other applications, by commenting this out the problem is not replicated. </p>\n\n<p>There must be something linked between MsgBox and the date picker. </p>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 1949212, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d4bd5de53d79cbd8bbf7e7e4eff47f4?s=128&d=identicon&r=PG", "display_name": "Dm3k1", "link": "https://stackoverflow.com/users/1949212/dm3k1"}, "is_accepted": false, "score": 0, "last_activity_date": 1428695113, "creation_date": 1428695113, "answer_id": 29569554, "question_id": 28592498, "link": "https://stackoverflow.com/questions/28592498/ms-access-date-picker-works-on-first-record-save-update-etc-but-after-submi/29569554#29569554", "title": "MS Access Date Picker works on first record (save, update etc.), but after submit doesn&#39;t fill textbox on other records", "body": "<p>@newd Apologies for the late reply. The full code that is executed (its a call procedure) is as follows: </p>\n\n<p><code>If CurrentProject.AllForms(\"TaskAdd\").IsLoaded Then \nMsgBox (\"Success\" &amp; vbCrLf &amp; \"Task Number: \" &amp; Forms!TaskAdd!tboTaskNumber &amp; \" has been assigned.\") \nElse \nMsgBox (\"Success\") \nEnd If \nDoCmd.Close \nDoCmd.OpenForm \"Service_Landing\" \nDoCmd.Requery</code></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8908935, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/981c2badb6a95e71945ad678b53f93cb?s=128&d=identicon&r=PG", "display_name": "Lisa Howard", "link": "https://stackoverflow.com/users/8908935/lisa-howard"}, "is_accepted": false, "score": 1, "last_activity_date": 1510165570, "creation_date": 1510165570, "answer_id": 47187062, "question_id": 28592498, "link": "https://stackoverflow.com/questions/28592498/ms-access-date-picker-works-on-first-record-save-update-etc-but-after-submi/47187062#47187062", "title": "MS Access Date Picker works on first record (save, update etc.), but after submit doesn&#39;t fill textbox on other records", "body": "<p>This answer is coming a couple years too late - but as I searched for a resolution - I never found it online.  Hopefully this will help someone else:</p>\n\n<p>To make the date picker portion usable, you must go to the Form the text box sits on and change the property Allow Edits (Data Tab) to Yes.</p>\n"}], "owner": {"reputation": 187, "user_id": 1949212, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d4bd5de53d79cbd8bbf7e7e4eff47f4?s=128&d=identicon&r=PG", "display_name": "Dm3k1", "link": "https://stackoverflow.com/users/1949212/dm3k1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 0, "accepted_answer_id": 28593054, "answer_count": 3, "score": 0, "last_activity_date": 1510165570, "creation_date": 1424288648, "question_id": 28592498, "link": "https://stackoverflow.com/questions/28592498/ms-access-date-picker-works-on-first-record-save-update-etc-but-after-submi", "title": "MS Access Date Picker works on first record (save, update etc.), but after submit doesn&#39;t fill textbox on other records", "body": "<p>Thank you in advance for your assistance.</p>\n\n<p>I have an interesting problem. When I open my access program and use the date picker (its a date field textbox, bound, short date format) I can update an existing record using the date picker (date selected, fills the textbox that is bound to the date field in the DB)... but ONLY add ONCE. This only happens in one form, which is a data-entry form with no edits, deletions etc.  </p>\n\n<p>I'm totally flabbergasted, after saving the record (and I've played around with changing the way it saves the record, from dirty = false and runcommand acccmdsaverecord), I've checked every format option - and I'm really pulling my hair out! This is an enabled and unlocked textbox</p>\n\n<p>The date picker does show, and lets me select a date from the calendar, but then it does not get carried over into the textbox and likewise to the table. </p>\n\n<p>It goes across all forms as well. I've tried removing code, saving, and re-pasting - this did not solve the problem. </p>\n\n<p>Have any of you experienced this? And do any of you have an idea of how to troubleshoot this?</p>\n\n<p>Thank you so much!</p>\n\n<p>Daniel</p>\n"}, {"tags": ["excel", "matrix", "vba"], "comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1424288087, "post_id": 28592240, "comment_id": 45491098, "body": "Where are you putting the results of the summations?  Or where do you want to put them?"}, {"owner": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1424288514, "post_id": 28592240, "comment_id": 45491383, "body": "I was thinking of just slapping them onto another sheet, but I&#39;m open to ideas. I plan on doing a Remove Duplicates on the summations."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 1, "creation_date": 1424295396, "post_id": 28592240, "comment_id": 45495391, "body": "I just was testing some ideas out of my own and I was wondering if you knew the count of how many combinations there would be for a 16x56 matrix.  From reading your comments it sounds like the number of combinations would be (columns^rows).  For the example data you have, that would be 11^10 or 25937424601 which is already way to big for excel to handle let alone getting into the 16x56....is that count correct?"}, {"owner": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1424295824, "post_id": 28592240, "comment_id": 45495642, "body": "Thanks, @chancea. I&#39;m able to remove most 0s and bring it down to a 16x9 matrix. I will update my post accordingly."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1424299864, "post_id": 28592240, "comment_id": 45497608, "body": "Your update reduces the number of combinations to a little over 8 * 10^9.  Still a lot but better than 9^16 = 2 * 10^15.  If you could generate all these combinations, where would you store the results?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1424301216, "post_id": 28592240, "comment_id": 45498170, "body": "Would you like a new algorithm that would handle the new data?  My first algorithm is no longer appropriate."}, {"owner": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "edited": false, "score": 0, "creation_date": 1424380831, "post_id": 28592240, "comment_id": 45537256, "body": "If you have one that is efficient (from a time perspective), then yes please!"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1424382298, "post_id": 28592240, "comment_id": 45538098, "body": "I know how I would tackle your revised problem.  I don&#39;t know if all 8 thousand million combinations can be generated in a realistic time period.  I will experiment.  Do you really need all combinations?  If you could say: &quot;I only need the positive ones&quot; or something like that, the problem could become much more managable."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1424450544, "post_id": 28592240, "comment_id": 45567806, "body": "With Excel VBA, which is interpreted, I can generate 50,000,000 combinations in 13.25 minutes.  With VB.net which is compiled to machine code, the same number of combinations takes about 28 seconds.  This suggests that a VB.net program could complete the task in 70 minutes.  I can post the VB.net code or if you email me (see my profile for address) I can send the executable program.  By the way, I am outputting the sums to files with one sum per line.  I start a new file every 1,000,000 sums.  I have one 5Mb file but most are over 10Mb with 17Mb being the most common size."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1424451232, "post_id": 28592240, "comment_id": 45568198, "body": "I got the file sizes wrong.  I was appending rather than over writing They are closer to 6Mb each."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1424548629, "post_id": 28592240, "comment_id": 45598580, "body": "I have posted an explanation of my new solution and the VB.net code which told 51 minutes to create 8063 files with all but the last containing 1,000,000 sums.  I accidentally deleted the VBA code so cannot offer that.  If you have access to Visual Basic I have given you enough information to create the program.  Otherwise, email me and I will send you the executable program."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "edited": false, "score": 0, "creation_date": 1424291673, "post_id": 28593183, "comment_id": 45493287, "body": "Thanks! This answer feels right. I understand the theory of it, but I&#39;m not familiar with implementing arrays as parameters for loops. Could you point me to the right direction?"}, {"owner": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "edited": false, "score": 0, "creation_date": 1424294576, "post_id": 28593183, "comment_id": 45494916, "body": "Would I need to have a loop layer for each row and then fill up the array?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "edited": false, "score": 1, "creation_date": 1424295563, "post_id": 28593183, "comment_id": 45495480, "body": "I am testing the outer loop at the moment.  What I had not thought about was how many values you are going to generate.  16^56 values are going to take a long time to generate and need a lot of storage space."}, {"owner": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "edited": false, "score": 0, "creation_date": 1424295761, "post_id": 28593183, "comment_id": 45495597, "body": "Thanks, @Tony Dallimore. I found out just 15-20 minutes ago that I can de-Dup on the 0s. That being said, I have to evaluate only one 0 per row, so I&#39;m able to compress my data down to a 16row x 9col matrix. Much better."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "edited": false, "score": 0, "creation_date": 1424296696, "post_id": 28593183, "comment_id": 45496082, "body": "16^9 is better than 16^56 but it will still take a looooong time.  My rough calculation suggests it will take days."}, {"owner": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "edited": false, "score": 0, "creation_date": 1424297165, "post_id": 28593183, "comment_id": 45496324, "body": "Ouch. Is there a way to segment the work load?... maybe Excel isn&#39;t the solution here then. I may have to look into going the SQL Server route. Thanks for the effort though. Good insight."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "edited": false, "score": 1, "creation_date": 1424298063, "post_id": 28593183, "comment_id": 45496813, "body": "To generate all values for columns 11 to 15 took 2 seconds. To generate all values for columns 10 to 15 took 13 seconds. To generate all values for columns 9 to 15 took 116 seconds. To generate all values for columns 8 to 15 took 1,047 seconds. Each extra column takes about 9 times longer than the previous. This is will take years."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "edited": false, "score": 0, "creation_date": 1424298109, "post_id": 28593183, "comment_id": 45496836, "body": "I will post the code if you wish but I am not sure of its value."}, {"owner": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "edited": false, "score": 0, "creation_date": 1424380766, "post_id": 28593183, "comment_id": 45537221, "body": "Thanks again for the help and advice. No need for the code since, as you said, it wouldn&#39;t be practical. I&#39;m marking your answer as correct though, since it&#39;s a good and true one technically."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 2, "last_activity_date": 1424548355, "last_edit_date": 1424548355, "creation_date": 1424290983, "answer_id": 28593183, "question_id": 28592240, "link": "https://stackoverflow.com/questions/28592240/excel-in-vba-how-do-i-find-all-possible-sums-of-values-in-a-matrix-using-1-v/28593183#28593183", "title": "Excel -- In VBA, how do I find all possible sums of values in a matrix using 1 value per row?", "body": "<p>It is possible to solve this type of problem with recursion but I find it easier without.</p>\n\n<p>Consider a speedometer.  Each cycle adds one to the rightmost digit. If that digit overflows from nine to zero, you add one to the next digit to the left.  If that digit overflows, you add one to the digit to its left.  This continues until a digit does not overflow or the left-most digit overflows.  So the values you see on your speedometer are:</p>\n\n<pre><code>0 0 0 0\n0 0 0 1\n0 0 0 2\n: : : :\n0 0 0 9\n0 0 1 0\n0 0 1 1\n: : : :\n0 0 1 9\n0 0 2 0\n: : : :\n0 0 9 9\n0 1 0 0\n: : : :\n9 9 9 9\n</code></pre>\n\n<p>If the digits of the speedometer are the entries in an integer array, a simple loop can cycle through these values.</p>\n\n<p>For your problem:</p>\n\n<ul>\n<li>You need 16 entries in your array, one per row in your matrix.</li>\n<li>Each digit can take value between 0 and 55 rather than 0 to 9.</li>\n</ul>\n\n<p>With this change, your speedometer cycles from:</p>\n\n<pre><code>  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0\n</code></pre>\n\n<p>to</p>\n\n<pre><code> 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55\n</code></pre>\n\n<p>If you number your columns from 0 to 55, each digit tells you which column to use for the corresponding row.</p>\n\n<p>One of the values through which your speedometer cycles is:</p>\n\n<pre><code> 1 45  5 30  8 22  1  0 38 51 14 42 29 31 46  7\n</code></pre>\n\n<p>Which tells you to sum:</p>\n\n<pre><code>Column 1 of first row\nColumn 45 of second row\nColumn 5 of third row\nColumn 30 of fourth row\nAnd so on\n</code></pre>\n\n<p>Another loop will extract and sum these values.</p>\n\n<p>So the outer loops will cycle the speedometer from {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0} to {55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55}.  For each value on the speedometer, the inner loop calculates and stores the sum.</p>\n\n<p><strong>Section 2</strong></p>\n\n<p>Little change is required to update the original code for the new requirement.</p>\n\n<p>In the original, I had a \u201cspeedometer\u201d that cycled from (0, 0, 0, \u2026) to (55, 55, 55, \u2026) with every \u201cwheel\u201d having values from 0 to 55.  I have now added an array which gives the maximum value for each \u201cwheel.\u201d  For example, the first \u201cwheel\u201d can take values 0 to 5 which correspond to the six values to be extracted from the matrix: -144   -5    0   12   16   20.</p>\n\n<pre><code>  5  2  4  8  2  1  1  3  1  5  7  1  8  3  4  5    New maximum values\n\n  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0    Minimum values\n\n 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55    Old maximum values\n</code></pre>\n\n<p>I typed the data from the image of your matrix into Sheet1 of a new workbook:</p>\n\n<p><img src=\"https://i.stack.imgur.com/RpCdM.png\" alt=\"Worksheet matrix\"></p>\n\n<p>My macro imported that matrix into a variant array.  There is an overhead for every access to a variable of type variant so I copied the data to a Long array.  To demonstrate the macro creates the array correctly, I output:</p>\n\n<pre><code>Row Lst ---0 ---1 ---2 ---3 ---4 ---5 ---6 ---7 ---8\n  0   5 -144   -5    0   12   16   20\n  1   2  -16    0   50\n  2   4    0    5    8   11   70\n  3   8  -96  -57  -47  -45  -29  -13   -2    0    3\n  4   2  -74  -18    0\n  5   1    0    8\n  6   1  589    0\n  7   3  -61  -44  -26    0\n  8   1  -55    0\n  9   5  -18    0    9   18   50   58\n 10   7  -66  -36    0    2   16   46   62   82\n 11   1    0    8\n 12   8 -279 -272 -253 -229 -165 -121  -74  -38    0\n 13   3  -24  -19  -17    0\n 14   4  -43  -27  -21   -9    0\n 15   5 -406  -91  -64  -29   -3    0\n</code></pre>\n\n<p>The column \u201cLst\u201d gives the last entry in each row.</p>\n\n<p>For the first version of the macro, I output diagnostic information for the first 200 sums to Sheet2:</p>\n\n<p><img src=\"https://i.stack.imgur.com/DYarl.png\" alt=\"First 200 sums\"></p>\n\n<p>This was sufficient for me to believe the macro was cycling the speedometer correctly, extracting values from the matrix correctly and summing those values correctly.</p>\n\n<p>For the second version of the macro, I removed all diagnostic code and output the sums to a file.  I switch files after 1,000,000 sums to keep the file sizes manageable.  After creating file 50, the macro exited.  Creating those 50 files took 13 minutes 15 seconds.  The top of the first file is:</p>\n\n<p><img src=\"https://i.stack.imgur.com/MpwHW.png\" alt=\"File 0001\"></p>\n\n<p>I then switched to Visual Basic 2010.  I created a Windows Application with a simple form:</p>\n\n<p><img src=\"https://i.stack.imgur.com/yor91.png\" alt=\"Form\"></p>\n\n<p>I have six controls of which four are named as shown and another <code>lblMessage</code> is not visible until the end.  The value 8000 for <code>lblFileNumMax</code> is replaced at runtime by the calculated number of files to be created.  The value 1 for <code>lblFileNumCrnt</code> is updated every time a new file is created.  With about 100 created per minute, this provides an adequate indication of progress.</p>\n\n<p>I could have loaded the matrix from Excel but I decided it was easier to hard code.  Apart from that there is little difference in the code from the VBA version.  I retained the trap that stopped the generation after 50 files had been created and used a batch file to check the VBA files were the same as the VB files:</p>\n\n<pre><code>Del compare.txt\ncomp \"Sums 0001.txt\" \"Sums 00001VBA.txt\" &lt;N.txt &gt;&gt;Compare.txt\ncomp \"Sums 0002.txt\" \"Sums 00002VBA.txt\" &lt;N.txt &gt;&gt;Compare.txt\ncomp \"Sums 0003.txt\" \"Sums 00003VBA.txt\" &lt;N.txt &gt;&gt;Compare.txt\ncomp \"Sums 0004.txt\" \"Sums 00004VBA.txt\" &lt;N.txt &gt;&gt;Compare.txt\ncomp \"Sums 0005.txt\" \"Sums 00005VBA.txt\" &lt;N.txt &gt;&gt;Compare.txt\n</code></pre>\n\n<p>I then removed the trap and let the program create all 8063 files which took 51 minutes 45 seconds on my 2.1 GHz laptop.</p>\n\n<p>I cannot post the VBA code because I accidentally deleted it along with the 8063 files totally 40 Gb which were big enough to cause my recycle bin to overflow.</p>\n\n<p>The VB.net code is below.</p>\n\n<pre><code>Option Strict On\nImports System.IO\n\nPublic Class Form1\n  Dim fileOut As StreamWriter\n  Private Sub cmdStart_Click(sender As System.Object, e As System.EventArgs) Handles cmdStart.Click\n\n    Dim matrix(,) As Integer = {{-144, -5, 0, 12, 16, 20, 0, 0, 0}, _\n                                {-16, 0, 50, 0, 0, 0, 0, 0, 0}, _\n                                {0, 5, 8, 11, 70, 0, 0, 0, 0}, _\n                                {-96, -57, -47, -45, -29, -13, -2, 0, 3}, _\n                                {-74, -18, 0, 0, 0, 0, 0, 0, 0}, _\n                                {0, 8, 0, 0, 0, 0, 0, 0, 0}, _\n                                {589, 0, 0, 0, 0, 0, 0, 0, 0}, _\n                                {-61, -44, -26, 0, 0, 0, 0, 0, 0}, _\n                                {-55, 0, 0, 0, 0, 0, 0, 0, 0}, _\n                                {-18, 0, 9, 18, 50, 58, 0, 0, 0}, _\n                                {-66, -36, 0, 2, 16, 46, 62, 82, 0}, _\n                                {0, 8, 0, 0, 0, 0, 0, 0, 0}, _\n                                {-279, -272, -253, -229, -165, -121, -74, -38, 0}, _\n                                {-24, -19, -17, 0, 0, 0, 0, 0, 0}, _\n                                {-43, -27, -21, -9, 0, 0, 0, 0, 0}, _\n                                {-406, -91, -64, -29, -3, 0, 0, 0, 0}}\n\n    Dim lastEntryPerRow() As Integer = {5, 2, 4, 8, 2, 1, 1, 3, 1, 5, 7, 1, 8, 3, 4, 5}\n\n    Const sumsPerFile As Long = 1000000\n\n    Dim fileOutNum As Integer\n    Dim fileOutNumMax As Long\n    Dim finished As Boolean\n    Dim numSums As Integer\n    Dim pathProg As String\n    Dim posChar As Int32\n    Dim speedo() As Integer\n    Dim sumCrnt As Integer\n    Dim rowCrnt As Integer\n    Dim rowMax As Integer = matrix.GetUpperBound(0)\n    Dim timeStart As Long\n\n    cmdStart.Visible = False\n    cmdExit.Visible = False\n\n    ' Extract folder containing program\n    pathProg = Application.ExecutablePath\n    posChar = InStrRev(pathProg, \"\\\")\n    If posChar &lt;&gt; 0 Then\n      ' Discard the name of the program\n      pathProg = Mid(pathProg, 1, posChar)\n    End If\n\n    ' Initialise Speedo to all zeros\n    ReDim speedo(rowMax)\n    For rowCrnt = 0 To rowMax\n      speedo(rowCrnt) = 0\n    Next\n\n    ' Calculate number of files to be created\n    fileOutNumMax = 1\n    For rowCrnt = 0 To rowMax\n      fileOutNumMax *= CLng(lastEntryPerRow(rowCrnt) + 1)\n    Next\n    fileOutNumMax = CInt(fileOutNumMax / sumsPerFile)\n\n    lblFileNumMax.Text = CStr(fileOutNumMax)\n\n    ' Initialise control variables\n    numSums = 0\n    fileOutNum = 1\n    finished = False\n    lblFileNumCrnt.Text = CStr(fileOutNum)\n    Application.DoEvents()\n\n    timeStart = (Hour(DateTime.Now) * 24 + Minute(DateTime.Now)) * 60 + Second(DateTime.Now)\n\n    Do While True\n\n      ' False means overwrite if file already exists\n      fileOut = New StreamWriter(pathProg &amp; \"\\Sums \" &amp; Format(fileOutNum, \"0000\") &amp; \".txt\", False)\n\n      Do While True\n\n        ' Output sum identified by current value of Speedo\n        sumCrnt = 0\n        numSums = numSums + 1\n        For rowCrnt = 0 To rowMax\n          sumCrnt += matrix(rowCrnt, speedo(rowCrnt))\n        Next\n        fileOut.WriteLine(sumCrnt)\n\n        ' Generate next value for Speedo\n        ' Process entries from left to right\n        For rowCrnt = 0 To rowMax\n          If speedo(rowCrnt) = lastEntryPerRow(rowCrnt) Then\n            ' This column is about to overflow\n            speedo(rowCrnt) = 0\n            If rowCrnt = rowMax Then\n              ' rightmost entry has overflowed. All done\n              finished = True\n              Exit Do\n            End If\n            ' Continue with For-Loop to step next column to right\n          Else\n            ' This column is not about to overflow\n            speedo(rowCrnt) = speedo(rowCrnt) + 1\n            ' Have finished generation\n            Exit For\n          End If\n        Next\n\n        If numSums &gt;= sumsPerFile Then\n          Exit Do\n        End If\n\n      Loop\n\n      fileOut.Close()\n      fileOut = Nothing\n      numSums = 0\n      fileOutNum = fileOutNum + 1\n      'If fileOutNum &gt;= 51 Then\n      '  Exit Do\n      'End If\n      If finished Then\n        Exit Do\n      End If\n      lblFileNumCrnt.Text = CStr(fileOutNum)\n      Application.DoEvents()\n\n    Loop\n\n    Debug.Print(CStr((Hour(DateTime.Now) * 24 + Minute(DateTime.Now)) * 60 + _\n                      Second(DateTime.Now) - timeStart) &amp; \" seconds\")\n\n    cmdExit.Visible = True\n\n  End Sub\n  Private Sub cmdExit_Click(sender As System.Object, e As System.EventArgs) Handles cmdExit.Click\n\n    If fileOut IsNot Nothing Then\n      fileOut.Close()\n      fileOut = Nothing\n    End If\n\n    Me.Close()\n\n  End Sub\nEnd Class\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 3133304, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vqMt0.jpg?s=128&g=1", "display_name": "AnalyzeThis", "link": "https://stackoverflow.com/users/3133304/analyzethis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1116, "favorite_count": 0, "accepted_answer_id": 28593183, "answer_count": 1, "score": 0, "last_activity_date": 1424548355, "creation_date": 1424287792, "last_edit_date": 1531164843, "question_id": 28592240, "link": "https://stackoverflow.com/questions/28592240/excel-in-vba-how-do-i-find-all-possible-sums-of-values-in-a-matrix-using-1-v", "title": "Excel -- In VBA, how do I find all possible sums of values in a matrix using 1 value per row?", "body": "<p>I've searched around a good bit for this answer, but nothing quite solves my issue. Here's what I'm doing...</p>\n\n<p>I've got a worksheet that houses a matrix of [edit: 16rows x 9cols]. The cells of the matrix are positive and negative integers. Here's an example of a portion of the data:</p>\n\n<p><img src=\"https://i.stack.imgur.com/22Bae.png\" alt=\"enter image description here\"></p>\n\n<p>I need to find all possible Summations with the condition that only one value can be chosen per row. In other words, I would take the first value in each row and add them up. Then, I would take the 2nd value of the first row and add it to all the other rows' first values...on and on until I am finding the summation of the last value of each row.</p>\n\n<p>So to start, I would want to store the Sum of (-144, -16, 0, -96, -74, 0, 589, -61, -55, -18, -66, 0, -279, -24, -43, -406). The  next Sum to store would be (-5, -16, 0, -96, -74, 0, 589, -61, -55, -18, -66, 0, -279, -24, -43, -406).</p>\n\n<p>I'm trying to think of a clever way to use a <code>For</code> loop with <code>GoTo</code> statements, but I'm open to any ideas. Perhaps a recursive function?</p>\n"}, {"tags": ["vba", "excel", "sql-like"], "comments": [{"owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 0, "creation_date": 1424286139, "post_id": 28591701, "comment_id": 45489925, "body": "use the instr function: if instr(1,rng5.Cells(i, 1).Value, &quot;test&quot;)&gt;0 then"}, {"owner": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "reply_to_user": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 0, "creation_date": 1424286369, "post_id": 28591701, "comment_id": 45490077, "body": "Ok. Will this work even if the word test is apart of a longer phrase?"}, {"owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 0, "creation_date": 1424286519, "post_id": 28591701, "comment_id": 45490170, "body": "exactly it returns the position of one string inside another.  If it returns greater than 0, then the sought string exists in the searched string."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424287104, "post_id": 28591701, "comment_id": 45490515, "body": "I would add this modification <code>if CBool(instr(1,rng5.Cells(i, 1).Value, &quot;test&quot;, vbTextCompare)) then</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1424288927, "post_id": 28591701, "comment_id": 45491647, "body": "This is appears to be a duplicate of question: <a href=\"http://stackoverflow.com/questions/28589625/loop-filter-in-excel-vba\">Loop Filter in Excel VBA</a>.  What was wrong with the answer there?  Even using the same variables and test phrases used in comments by that poster."}], "answers": [{"tags": [], "owner": {"reputation": 1551, "user_id": 150533, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0540c6f40ab8933535bbf2cf2a80cb9d?s=128&d=identicon&r=PG", "display_name": "kurast", "link": "https://stackoverflow.com/users/150533/kurast"}, "is_accepted": false, "score": 2, "last_activity_date": 1424286310, "creation_date": 1424286310, "answer_id": 28591801, "question_id": 28591701, "link": "https://stackoverflow.com/questions/28591701/like-operator-in-excel-vba/28591801#28591801", "title": "Like operator in Excel VBA", "body": "<p>The <code>OR</code> operator works only on booleans, so you must present booleans to it. You cant ommit terms like you did</p>\n\n<pre><code>For i = 1 To rng5.Rows.Count\n\n    If rng5.Cells(i, 1).Value Like \"*test*\" Or rng5.Cells(i, 1).Value Like  \"*Test*\" Or rng5.Cells(i, 1).Value Like  \"*Demo*\" Or rng5.Cells(i, 1).Value Like  \"*demo*\" Then\n        rng5.Cells(i, 1).EntireRow.Hidden = True\n    End If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "reply_to_user": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "edited": false, "score": 0, "creation_date": 1424287098, "post_id": 28591820, "comment_id": 45490512, "body": "is there a possibility that any instance of rng5.Cells(i, 1).Value could not be a string?  If so, wrap it in a CStr function    CStr(rng5.Cells(i, 1).Value)"}], "tags": [], "owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "is_accepted": true, "score": 1, "last_activity_date": 1424286369, "creation_date": 1424286369, "answer_id": 28591820, "question_id": 28591701, "link": "https://stackoverflow.com/questions/28591701/like-operator-in-excel-vba/28591820#28591820", "title": "Like operator in Excel VBA", "body": "<p>use the Instr Function</p>\n\n<pre><code>For i = 1 To rng5.Rows.Count\n\n    If instr(1,rng5.Cells(i, 1).Value, \"test\")&gt;0  Or instr(1,rng5.Cells(i, 1).Value, \"Test\")&gt;0 Or instr(1,rng5.Cells(i, 1).Value, \"demo\")&gt;0  Or instr(1,rng5.Cells(i, 1).Value, \"Demo\")&gt;0 Then\n        rng5.Cells(i, 1).EntireRow.Hidden = True\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1424350621, "creation_date": 1424350621, "answer_id": 28607023, "question_id": 28591701, "link": "https://stackoverflow.com/questions/28591701/like-operator-in-excel-vba/28607023#28607023", "title": "Like operator in Excel VBA", "body": "<p>use Lcase or Ucase if required verify on content of the data using like  without case sensative</p>\n\n<pre><code>Sub test()\n    For i = 1 To rng5.Rows.Count\n        If LCase(rng5.Cells(i, 1).Value) Like \"*test*\" Or _\n            LCase(rng5.Cells(i, 1).Value) Like \"*demo*\" Then\n\n            rng5.Cells(i, 1).EntireRow.Hidden = True\n\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2179, "favorite_count": 0, "accepted_answer_id": 28591820, "answer_count": 3, "score": 2, "last_activity_date": 1424350621, "creation_date": 1424285930, "question_id": 28591701, "link": "https://stackoverflow.com/questions/28591701/like-operator-in-excel-vba", "title": "Like operator in Excel VBA", "body": "<p>I have an if statement in a for loop in which I am trying to compare the current Cell value to other strings using the like operator.  For some reason this is giving me a type mismatch error.  Is this because the <code>rng5.Cells(i, 1).Value</code> is not a string?  Any help would be greatly appreciated! I have pasted the original code below.</p>\n\n<pre><code>For i = 1 To rng5.Rows.Count\n\n    If rng5.Cells(i, 1).Value Like \"*test*\" Or \"*Test*\" Or \"*Demo*\" Or \"*demo*\" Then\n        rng5.Cells(i, 1).EntireRow.Hidden = True\n    End If\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1424285705, "post_id": 28591546, "comment_id": 45489633, "body": "When assigning a range, you need to use the <code>Set</code> keyword, so the line should be <code>Set g_0 = RngMk(&quot;Table1&quot;, A, &quot;Name&quot;)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4576226"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1424285930, "post_id": 28591546, "comment_id": 45489793, "body": "I added <code>Set</code>, and it did get rid of <code>Run-time error &#39;91&#39;</code>, however now I get a new error: <code>Run-time error &#39;424&#39;: Object required</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1424286004, "post_id": 28591546, "comment_id": 45489836, "body": "Is your variable <code>A</code> set to be a <code>RngType</code> object which is required by your function?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4576226"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1424286265, "post_id": 28591546, "comment_id": 45490004, "body": "Are you saying I should add an object type after <code>Public Enum RngType</code> for example <code>Public Enum RngType As Long</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424286278, "post_id": 28591546, "comment_id": 45490014, "body": "I believe the function is actually returning a concatenated string. The problem would seem to be later where <code>g_0 = RngMk(&quot;Table1&quot;, A, &quot;Name&quot;)</code> should be more like <code>Set g_0 = Range(RngMk(&quot;Table1&quot;, A, &quot;Name&quot;))</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424286364, "post_id": 28591546, "comment_id": 45490072, "body": "what does the <i>Immediate Window</i> show when <code>?RngMk(&quot;Table1&quot;, A, &quot;Name&quot;)</code> is thrown at it?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424287027, "post_id": 28591546, "comment_id": 45490476, "body": "You need to add <code>Set</code> both in the last line of your function <i>and</i> when you call the function; <code>Set RngMk = Range(str)</code> and <code>Set g_0 = RngMk(&quot;Table1&quot;, A, &quot;Name&quot;)</code>   You should also define the return type of your function as <code>Range</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4576226"}, "edited": false, "score": 0, "creation_date": 1424286735, "post_id": 28591660, "comment_id": 45490302, "body": "That did it! Thank you <code>@Kyle</code> and thank you everyone for suggesting to add <code>Set</code> before my expressions"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1424286884, "post_id": 28591660, "comment_id": 45490403, "body": "You are very welcome. I never realized a function can actually return an object, so thank you!"}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 0, "last_activity_date": 1424286391, "last_edit_date": 1424286391, "creation_date": 1424285798, "answer_id": 28591660, "question_id": 28591546, "link": "https://stackoverflow.com/questions/28591546/vba-excel-error-when-trying-to-create-range-using-a-function/28591660#28591660", "title": "VBA Excel - Error when trying to create range using a function", "body": "<p>In your function use</p>\n\n<pre><code>Set RngMk = Range(str)\n</code></pre>\n\n<p>This should solve your issue.</p>\n\n<p>And still \"set\" g_0 = rngmk(.....)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4576226"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 28591660, "answer_count": 1, "score": 0, "last_activity_date": 1424286391, "creation_date": 1424285433, "question_id": 28591546, "link": "https://stackoverflow.com/questions/28591546/vba-excel-error-when-trying-to-create-range-using-a-function", "title": "VBA Excel - Error when trying to create range using a function", "body": "<p>I'm not sure where the problem is with this bit of code I worked out. I have the following public declarations and function:</p>\n\n<pre><code>Public g_0 As Range\nPublic Enum RngType\n    A = 1\n    H = 2\n    X = 3\nEnd Enum\n\n\nFunction RngMk(csTable As String, csType As RngType, Optional csHeaderName As Variant = \"\")\n\nDim str As String\n\nSelect Case csType\n    Case RngType.A\n        If csHeaderName = \"\" Then\n            str = csTable &amp; \"[#All]\"\n        Else:\n            str = csTable &amp; \"[[#All],[\" &amp; csHeaderName &amp; \"]]\"\n        End If\n    Case RngType.H\n        If csHeaderName = \"\" Then\n            str = csTable &amp; \"[#Headers]\"\n        Else:\n            str = csTable &amp; \"[[#Headers],[\" &amp; csHeaderName &amp; \"]]\"\n        End If\n    Case RngType.X\n        If csHeaderName = \"\" Then\n            str = csTable\n        Else:\n            str = csTable &amp; Chr(91) &amp; csHeaderName &amp; Chr(93)\n        End If\nEnd Select\n\nRngMk = Range(str)\n\nEnd Function\n</code></pre>\n\n<p>The code above should establish any range inside a given table ListObject. However, when I add the following into a Sub</p>\n\n<pre><code>g_0 = RngMk(\"Table1\", A, \"Name\")\n\ng_0.Select\n</code></pre>\n\n<p>I get the error \"91 - Object variable or With block variable not set\". I'm not sure what I'm missing...</p>\n"}, {"tags": ["vba", "vbscript"], "answers": [{"comments": [{"owner": {"reputation": 1422, "user_id": 2557854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8ce7e2aeef8bef05414806fc18aae490?s=128&d=identicon&r=PG&f=1", "display_name": "maihabunash", "link": "https://stackoverflow.com/users/2557854/maihabunash"}, "edited": false, "score": 0, "creation_date": 1424286703, "post_id": 28591885, "comment_id": 45490277, "body": "thx Jeanno please advice - where I can add you code in my script?"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 1422, "user_id": 2557854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8ce7e2aeef8bef05414806fc18aae490?s=128&d=identicon&r=PG&f=1", "display_name": "maihabunash", "link": "https://stackoverflow.com/users/2557854/maihabunash"}, "edited": false, "score": 0, "creation_date": 1424287242, "post_id": 28591885, "comment_id": 45490599, "body": "<code>If Instr(1, UCase(objFile.Name), UCase(&quot;access.log&quot;)) And CheckMonths(3,objFile.Name)  Then</code>"}, {"owner": {"reputation": 1422, "user_id": 2557854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8ce7e2aeef8bef05414806fc18aae490?s=128&d=identicon&r=PG&f=1", "display_name": "maihabunash", "link": "https://stackoverflow.com/users/2557854/maihabunash"}, "edited": false, "score": 0, "creation_date": 1424291582, "post_id": 28591885, "comment_id": 45493229, "body": "first I +1 for you -  Another rlittle quastion if for example I want to delete some files that contain the access.log and VAR.log and ddd.log then how to put these files in the ( ..... ) , I try (&quot;access.log VAR.log ddd.log&quot;) but its not work ?"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 1422, "user_id": 2557854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8ce7e2aeef8bef05414806fc18aae490?s=128&d=identicon&r=PG&f=1", "display_name": "maihabunash", "link": "https://stackoverflow.com/users/2557854/maihabunash"}, "edited": false, "score": 1, "creation_date": 1424291949, "post_id": 28591885, "comment_id": 45493448, "body": "You will need to use the <code>Or</code> operator so something like <code>If (Instr(1, UCase(objFile.Name), UCase(&quot;access.log&quot;)) Or Instr(1, UCase(objFile.Name), UCase(&quot;VAR.log&quot;)) Or Instr(1, UCase(objFile.Name), UCase(&quot;ddd.log&quot;))) And And CheckMonths(3,objFile.Name) ThenCheckMonths(3,objFile.Name) Then</code>"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 1, "last_activity_date": 1424286593, "creation_date": 1424286593, "answer_id": 28591885, "question_id": 28590999, "link": "https://stackoverflow.com/questions/28590999/vb-script-delete-files-that-contain-word-and-older-then-x-month/28591885#28591885", "title": "VB script + delete files that contain word and older then X month", "body": "<p>I don't know if <code>FileDateTime</code>, <code>Date</code> and <code>DateDiff</code> are supported in VBS. If not you can easily port your VBS code to VBA. DateDiff will find the difference between two dates in months.</p>\n\n<pre><code>Function CheckMonths(nMonths As Integer, fPath As String) As Boolean\n    CheckMonths = False\n    If DateDiff(\"m\", FileDateTime(fPath), Date) = nMonths Then\n        CheckMonths = True\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1422, "user_id": 2557854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8ce7e2aeef8bef05414806fc18aae490?s=128&d=identicon&r=PG&f=1", "display_name": "maihabunash", "link": "https://stackoverflow.com/users/2557854/maihabunash"}, "edited": false, "score": 0, "creation_date": 1424291529, "post_id": 28591976, "comment_id": 45493192, "body": "first I +1 for you - Another rlittle quastion if for example I want to delete some files that contain the access.log and VAR.log and ddd.log then how to put these files in the ( ..... ) , I try (&quot;access.log VAR.log ddd.log&quot;) but its not work ?"}], "tags": [], "owner": {"reputation": 528, "user_id": 3657197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trSj0.jpg?s=128&g=1", "display_name": "Pupa Rebbe", "link": "https://stackoverflow.com/users/3657197/pupa-rebbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1424286919, "creation_date": 1424286919, "answer_id": 28591976, "question_id": 28590999, "link": "https://stackoverflow.com/questions/28590999/vb-script-delete-files-that-contain-word-and-older-then-x-month/28591976#28591976", "title": "VB script + delete files that contain word and older then X month", "body": "<p>Change this line</p>\n\n<pre><code>If Instr(UCase(objFile.Name), UCase  (\"access.log\"))     Then\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>If Instr(1, UCase(objFile.Name), UCase(\"access.log\")) And DateDiff(\"m\", objFile.DateLastModified, Date) &gt;= 12 Then\n</code></pre>\n"}], "owner": {"reputation": 1422, "user_id": 2557854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8ce7e2aeef8bef05414806fc18aae490?s=128&d=identicon&r=PG&f=1", "display_name": "maihabunash", "link": "https://stackoverflow.com/users/2557854/maihabunash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 28591885, "answer_count": 2, "score": 0, "last_activity_date": 1424286919, "creation_date": 1424283674, "question_id": 28590999, "link": "https://stackoverflow.com/questions/28590999/vb-script-delete-files-that-contain-word-and-older-then-x-month", "title": "VB script + delete files that contain word and older then X month", "body": "<p>the following VB script , will remove the files under Temp dir and contain the word <strong>access.log</strong></p>\n\n<p>how to change this VB script in order to remove only files that contain the word \"access.log\" and are old then 1  or 2 or 3 ... month</p>\n\n<p>I want to add in the VB some parameter that will contain the month Number\nand the files will be deleted according to this parameter</p>\n\n<p>for example if <strong>Month_do_del=12</strong></p>\n\n<p>Then only files that contain <strong>access.log</strong> that old then 12 month will be deleted</p>\n\n<pre><code>   If LCase(Right(Wscript.FullName, 11)) = \"wscript.exe\" Then\n     strPath = Wscript.ScriptFullName\n     strCommand = \"%comspec% /k cscript  \"\"\" &amp; strPath &amp; \"\"\"\"\n     Set objShell = CreateObject(\"Wscript.Shell\")\n     objShell.Run(strCommand), 1, True\n     Wscript.Quit\n End If\n\nSet objNetwork = CreateObject(\"WScript.Network\")\nstrLog = \"Files deleted on \" &amp; objNetwork.ComputerName &amp; \" at \" &amp; Now &amp;    VbCrLf &amp; \"====================================================\"\n  Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\nstrFilesToDelete = \"\"\nShowSubFolders objFSO.GetFolder(\"G:\\Temp\")\n If InStr(strFilesToDelete, \"|\") &gt; 0 Then\narrFiles = Split(strFilesToDelete, \"|\")\nFor Each strFilePath In arrFiles\n    DeleteFile strFilePath\nNext\n  ElseIf strFilesToDelete &lt;&gt; \"\" Then\nDeleteFile strFilesToDelete\n  Else\nWScript.Echo \"No files were found.\"\nstrLog = strLog &amp; VbCrLf &amp; \"No files were found.\"\n End If\n\n Set objLogFile = objFSO.CreateTextFile(\"C:\\FileDeletionLog.log\", True)\n objLogFile.Write strLog\n objLogFile.Close\n Set objLogFile = Nothing\n\n  Sub ShowSubFolders(Folder)\nOn Error Resume Next\nFor Each objFile In Folder.Files\n    If Err.Number &lt;&gt; 0 Then\n        WScript.Echo \"Error reading \" &amp; Folder.Path\n           strLog = strLog &amp; VbCrLf &amp; \"Error reading \" &amp;    Folder.Path\n        Err.Clear\n        On Error Resume Next\n        Exit For\n     Else\n        On Error GoTo 0\n             If Instr(UCase(objFile.Name), UCase  (\"access.log\"))     Then\n            If strFilesToDelete = \"\" Then\n                strFilesToDelete = objFile.Path\n            Else\n                        strFilesToDelete =    strFilesToDelete &amp; \"|\" &amp; objFile.Path\n            End If\n        End If\n    End If\n   Next\n    For Each Subfolder in Folder.SubFolders\n    ShowSubFolders Subfolder\n  Next\n  End Sub\n\n\n\n\n  Sub DeleteFile(strFilePath)\nOn Error Resume Next\nWScript.Echo \"Deleting \" &amp; strFilePath\nobjFSO.DeleteFile strFilePath, True\nIf Err.Number &lt;&gt; 0 Then\n    WScript.Echo \"Could not delete \" &amp; strFilePath\n    strLog = strLog &amp; VbCrLf &amp; \"Could not delete \" &amp; strFilePath\n    Err.Clear\n    On Error GoTo 0\nElse\n    On Error GoTo 0\n        strLog = strLog &amp; VbCrLf &amp; \"Successfully deleted \" &amp; strFilePath\n End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "file-exists"], "answers": [{"comments": [{"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1424289280, "post_id": 28591418, "comment_id": 45491857, "body": "It is almost perfect! Only problem is that it loops trough all files in the folder and I get the message file not found once for every file"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1424290393, "post_id": 28591418, "comment_id": 45492539, "body": "I have updated my answer. Please let me know if that works for you"}, {"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1424290877, "post_id": 28591418, "comment_id": 45492823, "body": "Compile error:  it says: Exit Do not within Do...Loop"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1424291310, "post_id": 28591418, "comment_id": 45493072, "body": "oops! it has been a long day :(. Fixed it again"}, {"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1424291485, "post_id": 28591418, "comment_id": 45493169, "body": "mine as well :) so I took out the &quot;Exit Do&quot; now if I add the name I search for instead of the &quot;test&quot; it pops up a message for every file it found, if I use a variable (target.range) as I should, I get the &quot;File not found&quot; even if the file exists. I feel that we are very close!"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1424292171, "post_id": 28591418, "comment_id": 45493587, "body": "did you change <code>file = Dir(&quot;c:\\testfolder\\&quot;)</code> to the directory where your files are?"}, {"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1424292448, "post_id": 28591418, "comment_id": 45493732, "body": "yes, the script works perfectly, it was my bad. I figured out that the upper case does matter so x is not equal X. I have got tired as well. Thank you very much for the help! I accept the solution!"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 1, "last_activity_date": 1424291274, "last_edit_date": 1424291274, "creation_date": 1424285044, "answer_id": 28591418, "question_id": 28590752, "link": "https://stackoverflow.com/questions/28590752/excel-vba-check-if-file-exists-with-a-twist/28591418#28591418", "title": "Excel VBA check if file exists with a twist", "body": "<p>You can try the following. You don't really need to use any shell functionality</p>\n\n<pre><code>     Sub LoopThroughFilesWorkbook_SheetFollowHyperlink(ByVal Sh As Object, ByVal Target As Hyperlink)\n        Dim MyObj As Object, MySource As Object, file As Variant, myBool As Boolean\n        file = Dir(\"c:\\testfolder\\\")\n        Do While file &lt;&gt; \"\"\n            Bool = False\n            If InStr(file, \"test\") &gt; 0 Then ' you can change teh condition here to fit your criteria\n               myBool = True\n               MsgBox (\"Found\" &amp; file)\n            End If\n            file = Dir\n        Loop\n        If Not myBool Then\n            MsgBox (\"File not found\")\n        End If\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 1, "accepted_answer_id": 28591418, "answer_count": 1, "score": 1, "last_activity_date": 1424291274, "creation_date": 1424282929, "last_edit_date": 1531164843, "question_id": 28590752, "link": "https://stackoverflow.com/questions/28590752/excel-vba-check-if-file-exists-with-a-twist", "title": "Excel VBA check if file exists with a twist", "body": "<p>It is hard to be specific and short in this topic, but I try my best:</p>\n\n<p>Let's say we have a folder on a specific location where we get files with names for example let's use x1; x2; x3, etc.</p>\n\n<p>Then we have an excel file where we have numbers in a column. ex. 1; 2; 3; etc.</p>\n\n<p>I have written a script that makes it possible to click those numbers so an explorer window will pop up searching for the specific number in the folder.</p>\n\n<p>For example we click the number \"2\", and an explorer window will pop up with the search result for \"2x\" in that specific folder.</p>\n\n<p>The script looks like this:</p>\n\n<pre><code>Private Sub Workbook_SheetFollowHyperlink(ByVal Sh As Object, ByVal Target As Hyperlink)\n\nDim c As String\nDim backup As String\n\nc = Target.Range\nbackup = \"~%3D\" &amp; Left(c, 7)\n\n    If Left(c, 1) = \"C\" And Len(c) &gt; 7 And Right(c, 1) = \"$\" Then 'this part doesn't really matter\n    RetVal = Shell(\"c:\\Windows\\explorer.exe \"\"search-ms:displayname=Search%20Results&amp;crumb=System.Generic.String%3A\" &amp; backup &amp; \"%20kind%3A%3Dfolder&amp;crumb=location:%5C%5Cserver%5Cbackup$\", vbNormalFocus)\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I wonder if it is possible somehow, to find out if there is a file that matches the search or it does not exists. What I mean is, for example if I click on the number \"2\" in excel, the explorer will pop up and it will show the files which names contain \"x2\" or it will show \"<strong>No items match your search.</strong>\"</p>\n\n<p>I would like to return this somehow to excel if we have a search result <strong>or</strong> we don't.\nEven a Boolean would do the trick for me.</p>\n\n<p>I can not use the ordinary check like: </p>\n\n<pre><code>If Dir(folder) = \"\" Then\n</code></pre>\n\n<p>because we can have multiple files with the same name and their name contains the date of their creation. ex. x1_02_04_2015 and we can also have an x1_05_11_2014</p>\n\n<p>Thank You in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424286378, "post_id": 28590426, "comment_id": 45490082, "body": "What is the exact chart type? Does it have at least one series plotted?"}, {"owner": {"reputation": 11, "user_id": 4580681, "user_type": "registered", "profile_image": "https://graph.facebook.com/1627800164106869/picture?type=large", "display_name": "Ralf Tassman", "link": "https://stackoverflow.com/users/4580681/ralf-tassman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424287254, "post_id": 28590426, "comment_id": 45490606, "body": "It is a line graph.  I have been working on 11 separate series for the chart.  The chart has the correct series names in the legend.  The Y axis is created.  The data for all the series exists but is not connected yet.  Was trying to get the x axis done so chart would know which goes where."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4580681, "user_type": "registered", "profile_image": "https://graph.facebook.com/1627800164106869/picture?type=large", "display_name": "Ralf Tassman", "link": "https://stackoverflow.com/users/4580681/ralf-tassman"}, "edited": false, "score": 0, "creation_date": 1424286007, "post_id": 28590600, "comment_id": 45489839, "body": "Thank you for taking the time to answer.  I added your changes (which cleaned up my code) but it still complains on the MinimumScale.  I tried changing the code to use 0 and 100 instead of minimum and maximum and it still complains."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1424286174, "post_id": 28590600, "comment_id": 45489946, "body": "Undeclared variables are of type <code>Variant</code>, not <code>Object</code>"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 11, "user_id": 4580681, "user_type": "registered", "profile_image": "https://graph.facebook.com/1627800164106869/picture?type=large", "display_name": "Ralf Tassman", "link": "https://stackoverflow.com/users/4580681/ralf-tassman"}, "edited": false, "score": 0, "creation_date": 1424286556, "post_id": 28590600, "comment_id": 45490190, "body": "@RalfTassman Paste you entire code then."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424286676, "post_id": 28590600, "comment_id": 45490258, "body": "@TimWilliams yes variant correct it"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424287406, "post_id": 28590600, "comment_id": 45490708, "body": "But that is not the cause of the problem - as long as the assigned values are numeric then it should raise no error. In any case, the return values from Min/Max are Doubles: try (eg) <code>Debug.Print TypeName(minimum)</code>"}, {"owner": {"reputation": 11, "user_id": 4580681, "user_type": "registered", "profile_image": "https://graph.facebook.com/1627800164106869/picture?type=large", "display_name": "Ralf Tassman", "link": "https://stackoverflow.com/users/4580681/ralf-tassman"}, "edited": false, "score": 0, "creation_date": 1424289084, "post_id": 28590600, "comment_id": 45491745, "body": "Changed from Variant to Double.  Debug.Print TypeName(minimum) comes up as double.  I tried Debug.Print &quot;xlValue: &quot; &amp; TypeName(ActiveSheet.ChartObjects(activeObjs).Chart.Axes(xlV&zwnj;&#8203;alue).MaximumScale = 100).  This comes up as boolean.  Using xlCategory in place of xlValue throws an error."}], "tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": false, "score": 0, "last_activity_date": 1424286533, "last_edit_date": 1424286533, "creation_date": 1424282445, "answer_id": 28590600, "question_id": 28590426, "link": "https://stackoverflow.com/questions/28590426/xlcategory-error-in-vba/28590600#28590600", "title": "xlCategory error in vba", "body": "<p>Correct these lines accordingly</p>\n\n<pre><code>Dim minimum As Double: minimum = Cdbl(Application.WorksheetFunction.Min(rng))\nDim maximum As Double: maximum = Cdbl(Application.WorksheetFunction.Max(rng))\n</code></pre>\n\n<p>As per your code, the method fails because of the type mismatch. <code>minimum</code> and <code>maximum</code> are declared without <code>Dim</code> which makes them variant rather than double datatype and your method according to MSDN is Read/write <strong>Double</strong>.</p>\n\n<p>Add <code>Option Explicit</code> in your VBA editor so that you will get a compiler error rather a runtime error. This means that you will alerted if there is a missing <code>dim</code>.</p>\n\n<p>Add <code>Option Explicit</code> only once in your code. It has to be outside outside of your subroutines.</p>\n"}], "owner": {"reputation": 11, "user_id": 4580681, "user_type": "registered", "profile_image": "https://graph.facebook.com/1627800164106869/picture?type=large", "display_name": "Ralf Tassman", "link": "https://stackoverflow.com/users/4580681/ralf-tassman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2106, "favorite_count": 0, "closed_date": 1424294301, "answer_count": 1, "score": 1, "last_activity_date": 1424286533, "creation_date": 1424281914, "last_edit_date": 1531164843, "question_id": 28590426, "link": "https://stackoverflow.com/questions/28590426/xlcategory-error-in-vba", "closed_reason": "Duplicate", "title": "xlCategory error in vba", "body": "<p>I have a graph that has dates on the x-axis with minimum and maximum values using Excel VBA.</p>\n\n<pre><code>Set rng = ActiveWorkbook.Worksheets(\"Project Data\").Range(\"A5:A202\")\n\nminimum = Application.WorksheetFunction.Min(rng)\nmaximum = Application.WorksheetFunction.Max(rng)\n\nWith ActiveSheet.ChartObjects(\"Initiation\").Chart\n    With .Axes(xlCategory)\n        .MinimumScale = minimum\n        .MaximumScale = maximum\n    End With\n    With .Axes(xlValue, xlPrimary)\n        .MinimumScale = 0\n        .MaximumScale = 100\n    End With\nEnd With\n</code></pre>\n\n<p>The second internal \"With\" using \"xlValue\" works fine.</p>\n\n<p>The first internal \"With\" using \"xlCategory\" causes a runtime error: Method \"MinimumScale\" of object \"Axis\" failed.</p>\n\n<p>I cannot figure out what the problem is.  Does anyone know what is is?</p>\n\n<p>Thanks much.</p>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1424278481, "post_id": 28588961, "comment_id": 45485170, "body": "Can you supply some data, an example and an output of what you want to achieve?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424279423, "post_id": 28588961, "comment_id": 45485822, "body": "Is there a hard return in that cell you show, is is the text just wrapped? If there is a return you can use <code>Split(yourValueHere,chr(10))</code> and then go from there."}], "answers": [{"comments": [{"owner": {"reputation": 1835, "user_id": 2443476, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/7fafc67c892104145e8296b2242f4d43?s=128&d=identicon&r=PG", "display_name": "user2443476", "link": "https://stackoverflow.com/users/2443476/user2443476"}, "edited": false, "score": 0, "creation_date": 1424279537, "post_id": 28589429, "comment_id": 45485896, "body": "The problem is that my cell is not like this, On the first line there is 1 parent, and on the second line there is 1 child, and it&#39;s stay like this whatever the width of the column. The option &quot;automatically send to line (translation in french)&quot; is activated."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1835, "user_id": 2443476, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/7fafc67c892104145e8296b2242f4d43?s=128&d=identicon&r=PG", "display_name": "user2443476", "link": "https://stackoverflow.com/users/2443476/user2443476"}, "edited": false, "score": 0, "creation_date": 1424280516, "post_id": 28589429, "comment_id": 45486563, "body": "@user2443476  <b>Please clarify the contents of a single cell.</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1424279008, "creation_date": 1424279008, "answer_id": 28589429, "question_id": 28588961, "link": "https://stackoverflow.com/questions/28588961/use-regex-in-a-wrapped-text-value-cell/28589429#28589429", "title": "use regex in a wrapped text value cell", "body": "<p>With data like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/rDtBv.png\" alt=\"enter image description here\"></p>\n\n<p>click on a cell and run:</p>\n\n<pre><code>Sub Family()\n    ary = Split(ActiveCell.Value, \" \")\n    nParent = CLng(ary(0))\n    nChild = CLng(ary(2))\n    MsgBox nParent &amp; vbCrLf &amp; nChild\nEnd Sub\n</code></pre>\n\n<p><em>(regex is not necessary)</em></p>\n"}, {"tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 0, "last_activity_date": 1424293947, "creation_date": 1424293947, "answer_id": 28594003, "question_id": 28588961, "link": "https://stackoverflow.com/questions/28588961/use-regex-in-a-wrapped-text-value-cell/28594003#28594003", "title": "use regex in a wrapped text value cell", "body": "<p>I agree with @Gary's Student that you don't seem to need Regex but if you insist on it, I think the code below works.  You'll need to add in reference to Microsoft VBScript Regular Expressions 5.5 from Tools -> References.</p>\n\n<pre><code> Sub main()\n        Dim value As String\n        Dim re As VBScript_RegExp_55.RegExp\n        Dim matches As VBScript_RegExp_55.MatchCollection\n        Dim match As VBScript_RegExp_55.match\n\n        value = Range(\"A1\").value\n\n        Set re = New VBScript_RegExp_55.RegExp\n        re.Pattern = \"\\d+\"\n        re.Global = True\n\n        Set matches = re.Execute(value)\n\n        For Each match In matches\n            Debug.Print match.value\n        Next\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1424328408, "creation_date": 1424328408, "answer_id": 28600184, "question_id": 28588961, "link": "https://stackoverflow.com/questions/28588961/use-regex-in-a-wrapped-text-value-cell/28600184#28600184", "title": "use regex in a wrapped text value cell", "body": "<pre><code>Dim arr, parent, child\n\narr = Split(ActiveCell.Value, Chr(10))'split on hard return\nparent=arr(0)\nchild=arr(1)\n\n'then split each line on space....\ndebug.print Split(parent,\" \")(0) 'number\ndebug.print Split(parent,\" \")(1) 'text\n\ndebug.print Split(child,\" \")(0) 'number\ndebug.print Split(child,\" \")(1) 'text\n</code></pre>\n"}], "owner": {"reputation": 1835, "user_id": 2443476, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/7fafc67c892104145e8296b2242f4d43?s=128&d=identicon&r=PG", "display_name": "user2443476", "link": "https://stackoverflow.com/users/2443476/user2443476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1424328408, "creation_date": 1424277775, "last_edit_date": 1531164843, "question_id": 28588961, "link": "https://stackoverflow.com/questions/28588961/use-regex-in-a-wrapped-text-value-cell", "title": "use regex in a wrapped text value cell", "body": "<p>I have a cell like this :</p>\n\n<pre><code>1 parent\n 1 child\n</code></pre>\n\n<p>I am getting the value  in vba :</p>\n\n<pre><code>Dim nbChild As String\nDim nbParent As String\nSheets(\"Feuil1\").Cells(C.Row - 1, C.Column).Value\n</code></pre>\n\n<p>However, I would like to put the number of parent and child in 2 separates variables nbParent and nbChild, so I was thinking to use regex to capture the groups (digit number before parent and digit number before child).</p>\n\n<p>But I don't know how to do it. Thanks in advance for your help</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 12569, "user_id": 1316573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1499fb08570f294d76e76da46cf3b89?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1316573/daniel"}, "edited": false, "score": 0, "creation_date": 1424278027, "post_id": 28588857, "comment_id": 45484848, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.linksources.aspx\" rel=\"nofollow noreferrer\">Workbook.LinkSources</a> provides an array of links. but your code does not treat it as an array. Have you tried looping through the array?"}, {"owner": {"reputation": 30, "user_id": 3944802, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76f896674798fe6984c4b060b5befc70?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Almond", "link": "https://stackoverflow.com/users/3944802/thomas-almond"}, "reply_to_user": {"reputation": 12569, "user_id": 1316573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1499fb08570f294d76e76da46cf3b89?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1316573/daniel"}, "edited": false, "score": 0, "creation_date": 1424279030, "post_id": 28588857, "comment_id": 45485570, "body": "I&#39;m not sure this would make any difference, the code above does what I expect it to do, ActiveWorkbook.Changelink is replacing the array with my new source name however I need a way of specifically targeting the links within certain sheets within the workbook rather than the whole workbook as one."}, {"owner": {"reputation": 12569, "user_id": 1316573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1499fb08570f294d76e76da46cf3b89?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1316573/daniel"}, "edited": false, "score": 0, "creation_date": 1424279302, "post_id": 28588857, "comment_id": 45485750, "body": "I admit to not really wanting to experiment, but perhaps <a href=\"http://www.mrexcel.com/forum/excel-questions/555468-changing-link-source-via-visual-basic-applications.html#post2743777\" rel=\"nofollow noreferrer\">this answer in Mr. Excel forums</a> will help."}, {"owner": {"reputation": 30, "user_id": 3944802, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76f896674798fe6984c4b060b5befc70?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Almond", "link": "https://stackoverflow.com/users/3944802/thomas-almond"}, "reply_to_user": {"reputation": 12569, "user_id": 1316573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1499fb08570f294d76e76da46cf3b89?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1316573/daniel"}, "edited": false, "score": 0, "creation_date": 1424279625, "post_id": 28588857, "comment_id": 45485961, "body": "Haha entertainly I spent an hour or so earlier banging my head off the desk trying to figure that one out - to me it seems as though the &quot;answer&quot; doesn&#39;t actually answer the question. Maybe I need to spend some more time playing around with the code, I can sense an evening in front of my laptop ahead."}, {"owner": {"reputation": 12569, "user_id": 1316573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1499fb08570f294d76e76da46cf3b89?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1316573/daniel"}, "edited": false, "score": 0, "creation_date": 1424280671, "post_id": 28588857, "comment_id": 45486666, "body": "Okay, well. The particularly useful part of that answer is the for loop. You really only need to understand that. It loops through the links and then looks in the specific sheet for that link and changes it if it finds it. This is because for whatever reason the VBA doesn&#39;t provide a Worksheet.ChangeLink method. By searching the worksheet instead of calling Workbook.ChangeLink you can explicitly choose which links to change. Certainly a pain, but it looks workable."}], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1424279832, "creation_date": 1424279832, "answer_id": 28589723, "question_id": 28588857, "link": "https://stackoverflow.com/questions/28588857/using-vba-to-change-source-links-within-sheets-instead-of-workbook/28589723#28589723", "title": "Using VBA to change source links within sheets instead of workbook", "body": "<p>The code below will print the name of each link in the workbook to the immediate window. From there you should be able to write logic around which links to deal with based on sheet name. </p>\n\n<pre><code>Sub link()\nDim i As Integer\nDim x As Variant\nx = ThisWorkbook.LinkSources(xlLinkTypeExcelLinks)\nFor i = 1 To UBound(x)\nDebug.Print x(i)\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "is_accepted": false, "score": 0, "last_activity_date": 1424346149, "creation_date": 1424346149, "answer_id": 28605462, "question_id": 28588857, "link": "https://stackoverflow.com/questions/28588857/using-vba-to-change-source-links-within-sheets-instead-of-workbook/28605462#28605462", "title": "Using VBA to change source links within sheets instead of workbook", "body": "<p>i use a similar code to do stuff, you will need to adapt this piece of code :</p>\n\n<pre><code>Dim Sh As Worksheet\nwith Thisworkbook\n    For Each Sh In .Worksheets\n        For q = 1 To Sh.Hyperlinks.Count\n            h = Sh.Hyperlinks(q).Address\n            If Left(h, Len(.Path)) &lt;&gt; Left(.Path, Len(.Path)) Then\n                If InStr(1, h, \"\\OBJETS\\\") &gt; 0 Then 'obtenir le nom du fichier sans chemin\n                    h = Mid(h, InStrRev(h, \"\\OBJETS\\\", Len(h)) + 1, Len(h))\n                ElseIf InStr(1, h, \"\\R\u00e8gles\\\") &gt; 0 Then 'obtenir le nom du fichier sans chemin\n                    h = Mid(h, InStrRev(h, \"\\R\u00e8gles\\\", Len(h)) + 1, Len(h))\n                Else\n                    h = Mid(h, InStrRev(h, \"\\\", Len(h)) + 1, Len(h))\n                End If\n                Sh.Hyperlinks(q).Address = Replace(Replace(.Path, \"\\OBJETS\", \"\"), \"\\R\u00e8gles\", \"\") &amp; \"\\\" &amp; h\n            End If\n        Next q\n    Next Sh\n    Set Sh = Nothing\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 30, "user_id": 3944802, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76f896674798fe6984c4b060b5befc70?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Almond", "link": "https://stackoverflow.com/users/3944802/thomas-almond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15608, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1424346149, "creation_date": 1424277537, "last_edit_date": 1424277549, "question_id": 28588857, "link": "https://stackoverflow.com/questions/28588857/using-vba-to-change-source-links-within-sheets-instead-of-workbook", "title": "Using VBA to change source links within sheets instead of workbook", "body": "<p>I'm currently attempting to write some VBA into a userform that will allow me to change say all the external links in sheet1 to workbookA, then all the external links in sheet2 to workbookB, then all in sheet3 to workbookC etc. etc. </p>\n\n<p>I've used this code to do all the links in the workbook</p>\n\n<pre><code>Private Sub btnUpdate_Click()\n\nDim Source As String\n\nApplication.ScreenUpdating = False\ncurrentsource = ActiveWorkbook.LinkSources(xlExcelLinks)\n\n    'This is just a record of the changing source files\n     Sheets(\"Notes\").Range(\"C2\") = currentsource\n\n    'txtDirectory is the new source location chosen in my userform \n     Sheets(\"Notes\").Range(\"C3\") = txtDirectory\n\nSource = Sheets(\"Notes\").Range(\"C2\")\n\nActiveWorkbook.ChangeLink Name:=Source, NewName:=txtDirectory, Type:=xlExcelLinks\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>This works perfectly, however I now need to adapt it to change the links depending on the sheet I'm in.</p>\n\n<p>I've done a lot of googling to no avail, I've also spent quite a bit of time with my head in my VBA books.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["sql", "vba", "datetime", "adodb", "type-conversion"], "answers": [{"comments": [{"owner": {"reputation": 628, "user_id": 125371, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b2a882b64af94ec20fc54aaebb19ac?s=128&d=identicon&r=PG", "display_name": "cosmarchy", "link": "https://stackoverflow.com/users/125371/cosmarchy"}, "edited": false, "score": 0, "creation_date": 1424289882, "post_id": 28588803, "comment_id": 45492260, "body": "thanks for your reply.  I changed as suggested however it didn&#39;t fix the issue so i&#39;ve updated the original post with more details and the new error."}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "reply_to_user": {"reputation": 628, "user_id": 125371, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b2a882b64af94ec20fc54aaebb19ac?s=128&d=identicon&r=PG", "display_name": "cosmarchy", "link": "https://stackoverflow.com/users/125371/cosmarchy"}, "edited": false, "score": 0, "creation_date": 1424293015, "post_id": 28588803, "comment_id": 45494049, "body": "Add a watch to <code>dteModifiedDate</code>, what is assigned to the variable when it gets assigned?"}, {"owner": {"reputation": 628, "user_id": 125371, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b2a882b64af94ec20fc54aaebb19ac?s=128&d=identicon&r=PG", "display_name": "cosmarchy", "link": "https://stackoverflow.com/users/125371/cosmarchy"}, "edited": false, "score": 0, "creation_date": 1424293279, "post_id": 28588803, "comment_id": 45494185, "body": "It gets assigned &#39;18/02/2015 16:48:44&#39; as Date type"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "reply_to_user": {"reputation": 628, "user_id": 125371, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b2a882b64af94ec20fc54aaebb19ac?s=128&d=identicon&r=PG", "display_name": "cosmarchy", "link": "https://stackoverflow.com/users/125371/cosmarchy"}, "edited": false, "score": 0, "creation_date": 1424293601, "post_id": 28588803, "comment_id": 45494390, "body": "Just to check, you have tried using <code>adDate</code> without the length parameter specified?"}, {"owner": {"reputation": 628, "user_id": 125371, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b2a882b64af94ec20fc54aaebb19ac?s=128&d=identicon&r=PG", "display_name": "cosmarchy", "link": "https://stackoverflow.com/users/125371/cosmarchy"}, "edited": false, "score": 0, "creation_date": 1424293834, "post_id": 28588803, "comment_id": 45494529, "body": "Yes, I have tried it with the adDate parameter without length :)"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "reply_to_user": {"reputation": 628, "user_id": 125371, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b2a882b64af94ec20fc54aaebb19ac?s=128&d=identicon&r=PG", "display_name": "cosmarchy", "link": "https://stackoverflow.com/users/125371/cosmarchy"}, "edited": false, "score": 0, "creation_date": 1424294053, "post_id": 28588803, "comment_id": 45494634, "body": "I&#39;m not sure then in which case. The only other thing I can thing of is try to define <code>dteModifiedDate</code> as a string and use it with <code>adDate</code>. It should be automatically converted. Worth a try."}, {"owner": {"reputation": 628, "user_id": 125371, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b2a882b64af94ec20fc54aaebb19ac?s=128&d=identicon&r=PG", "display_name": "cosmarchy", "link": "https://stackoverflow.com/users/125371/cosmarchy"}, "edited": false, "score": 0, "creation_date": 1424329090, "post_id": 28588803, "comment_id": 45506398, "body": "Unfortunately not.  Seems like it doesn&#39;t like the conversion between the two data types but, I think if I remove dteModifiedDate from a parameter and just build the string, it should work....perhaps!!"}], "tags": [], "owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "is_accepted": false, "score": 1, "last_activity_date": 1424277397, "creation_date": 1424277397, "answer_id": 28588803, "question_id": 28588710, "link": "https://stackoverflow.com/questions/28588710/type-conversion-errors-with-datetime/28588803#28588803", "title": "Type Conversion Errors with DateTime", "body": "<p>You don't need to specify the length of the date. Also <code>adDate</code> should be fine:</p>\n\n<pre><code>cm.Parameters.Append cm.CreateParameter(\"@ModifiedDate\", adDate, adParamInput, , dteModifiedDate)\n</code></pre>\n"}], "owner": {"reputation": 628, "user_id": 125371, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b2a882b64af94ec20fc54aaebb19ac?s=128&d=identicon&r=PG", "display_name": "cosmarchy", "link": "https://stackoverflow.com/users/125371/cosmarchy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424289784, "creation_date": 1424277143, "last_edit_date": 1424289784, "question_id": 28588710, "link": "https://stackoverflow.com/questions/28588710/type-conversion-errors-with-datetime", "title": "Type Conversion Errors with DateTime", "body": "<p>I am trying to add data to a SQL database column which called 'ModifiedDate' and is of type 'DateTime', using the following code:</p>\n\n<pre><code>Dim fso As FileSystemObject\nDim dteModifiedDate As Date\nDim cm As ADODB.Command\nDim cn As ADODB.Connection\n\nSet fso = New FileSystemObject\nSet cm = New ADODB.Command\nSet cn = New ADODB.Connection\n\ncn.CursorLocation = adUseClient\ncn.ConnectionString = strDBConnectionString\ncn.Open\n\nSet cm.ActiveConnection = cn\n\ndteModifiedDate = fso.GetFile(\"C:\\TestFile.txt\").DateLastModified\n\ncm.Parameters.Append cm.CreateParameter(\"@ModifiedDate\", adDBDate, adParamInput, , dteModifiedDate)\n\ncm.CommandText = \"SELECT CAST('@ModifiedDate' as DateTime) FROM MainData\"\ncm.CommandType = adCmdText\n\ncm.Execute\n</code></pre>\n\n<p>The problem is that when I run this, the code breaks on the execute statement with this error:</p>\n\n<pre><code>Run-time error -2147217913 (80040e07)\nconversion failed when converting date and/or time from character string. \n</code></pre>\n\n<p>I have tried several different 'Type's for the command (adDate,adDBTimestamp,adWChar etc...) but get errors regarding conversion between data types.</p>\n\n<p>What data type do you use for this?  Obviously I need to be able to get the parameter data type correct with a type that is compatible with the SQL table data type.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 0, "last_activity_date": 1424279105, "last_edit_date": 1424279105, "creation_date": 1424278651, "answer_id": 28589288, "question_id": 28588582, "link": "https://stackoverflow.com/questions/28588582/on-hover-on-list-box-to-show-a-text-box/28589288#28589288", "title": "on hover on list box to show a text box", "body": "<p>To access different columns in a listbox you can use this: </p>\n\n<pre><code>Me.ListBox1.Column(0)\n</code></pre>\n\n<p>The 0 being the first column, simply adjust to what column you want to show. So if you are doing this in VBA code you would use the OnUpdate event and end up with something like this: </p>\n\n<pre><code>Private Sub ListBox1_AfterUpdate()\n    Me.ListBox1.ControlTipText = Me.ListBox1.Column(0)\nEnd Sub\n</code></pre>\n\n<p>Take note that the field you want the Controltip text to show up for must be selected.  I don't believe there is any way to change that shows up in the control tip text without implicitly selecting a row in the listbox. </p>\n"}], "owner": {"reputation": 2732, "user_id": 2061886, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dkfiz.jpg?s=128&g=1", "display_name": "lightweight", "link": "https://stackoverflow.com/users/2061886/lightweight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1499, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1436296200, "creation_date": 1424276807, "last_edit_date": 1436296200, "question_id": 28588582, "link": "https://stackoverflow.com/questions/28588582/on-hover-on-list-box-to-show-a-text-box", "title": "on hover on list box to show a text box", "body": "<p>I have a access <code>listbox</code> that has 2 columns and the column width is...2\";0\" so the second one is hidden. </p>\n\n<p>I know I can do a <code>controltip</code> to display a single line but the values in the 2nd column are quite long.  They are descriptions of what is in column 1. </p>\n\n<p>How can one display a <code>textbox</code> with the value in the 2nd column when hovered over a specific item in the list box?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1424289436, "post_id": 28588413, "comment_id": 45491960, "body": "What data type is your &quot;Date_field_name&quot; field?"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1424289933, "post_id": 28588413, "comment_id": 45492293, "body": "@Newd Date/time short date"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1424290006, "post_id": 28588413, "comment_id": 45492335, "body": "I don&#39;t think you need to do the datevalue thing at all then."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1424290132, "post_id": 28588413, "comment_id": 45492419, "body": "How are you planning to set the startdate and enddate variables?"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1424290185, "post_id": 28588413, "comment_id": 45492444, "body": "I am picking up those values from two cells in excel"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1424290506, "post_id": 28588413, "comment_id": 45492611, "body": "What are they going to look like in the excel sheet?"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1424290604, "post_id": 28588413, "comment_id": 45492670, "body": "I have it formatted at mm/dd/yyyy."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1424290733, "post_id": 28588413, "comment_id": 45492745, "body": "Okay, I have updated my answer with two ways to do that.  The last one is only if you have them in the wrong format for some reason."}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1424290828, "post_id": 28588413, "comment_id": 45492797, "body": "Ok, I will give that a go and ping back. God bless you and your time mate. I have been struggling with this and really appreciate anyone tying to help me!!!"}], "answers": [{"comments": [{"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424281524, "post_id": 28588800, "comment_id": 45487183, "body": "Thanks for your reply Newd. I get an error undefined function &#39;Nz&#39; in expression."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424282377, "post_id": 28588800, "comment_id": 45487681, "body": "Sorry, I forgot nz is a VBA function, I will update my post with an alternative."}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424284239, "post_id": 28588800, "comment_id": 45488768, "body": "I get this error when i try your code: Extra ) in query expression &#39;datevalue(IIf(IsNull(Date_Field_Name),  &#39;01-&#173;01&#173;-1969&#39;, Date_Field_Name))) &gt;= #01&#173;-01&#173;-2015#AND  datevalue(IIf(IsNull(Date_Field_Name), &#39;01-&#173;01&#173;-1969&#39;,  Date_Field_Name))) &lt;= #01&#173;-31&#173;-2015#&#39;."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424287747, "post_id": 28588800, "comment_id": 45490918, "body": "Looks like it only needs )) not ))) free hand coding isn&#39;t my forte."}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424339424, "post_id": 28588800, "comment_id": 45511364, "body": "mate your first solution worked actually. I used &#39; instead of &quot;. thank you so much!! I really appreciate it!"}], "tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": true, "score": 2, "last_activity_date": 1424290431, "last_edit_date": 1424290431, "creation_date": 1424277389, "answer_id": 28588800, "question_id": 28588413, "link": "https://stackoverflow.com/questions/28588413/vba-data-type-mismatch-when-blank-record-exists-in-ms-access/28588800#28588800", "title": "VBA data type mismatch when blank record exists in MS Access", "body": "<p>I generally see this kind of situation handled with a NZ function so that the field is just never left blank. So something like this:</p>\n\n<pre><code>strSql = \"SELECT Count(*) FROM tablename WHERE datevalue(Nz(Date_field_name,\"01-01-1969\")) &gt;= \" &amp; Format(startdate, \"\\#mm-dd-yyyy\\#\") &amp; \"AND datevalue(Nz(Date_field_name,\"01-01-1969\")) &lt;= \" &amp; Format(enddate, \"\\#mm-dd-yyyy\\#\")\n</code></pre>\n\n<p>This also goes off of the assumption that you are just showing some stripped down code because you declare you variables then run a query without ever changing those variables to be a date. </p>\n\n<p>The \"01-01-1969\" date should work for what you are looking for but if not adjust accordingly. Also my freehand SQL isn't amazing so some syntax might be a little off. </p>\n\n<p>Correction on code: </p>\n\n<pre><code>strSql = \"SELECT Count(*) FROM tablename WHERE datevalue(IIf(IsNull(Date_field_name),\"01-01-1969\", Date_Field_Name)) &gt;= \" &amp; Format(startdate, \"\\#mm-dd-yyyy\\#\") &amp; \" AND datevalue(IIf(IsNull(Date_field_name),\"01-01-1969\", Date_Field_Name)) &lt;= \" &amp; Format(enddate, \"\\#mm-dd-yyyy\\#\")\n</code></pre>\n\n<p>And if this doesn't suit your fancy if you take a look here: <a href=\"http://www.w3schools.com/sql/sql_isnull.asp\" rel=\"nofollow\">http://www.w3schools.com/sql/sql_isnull.asp</a> There are other alternative ways to deal with nulls. </p>\n\n<p>Round three, I think the Null idea was a red herring, pretty sure it is a lot of the un-needed formatting and that the \"Format\" part wasn't actually setting it to a date so it wouldn't do the comparison properly.  Try out: </p>\n\n<pre><code>strSql = \"SELECT Count(*) FROM tablename WHERE Date_field_name &gt;= #\" &amp; startdate &amp; \"# AND Date_Field_Name &lt;= #\" &amp; enddate &amp; \u201c#\u201d\n</code></pre>\n\n<p>If your enddate and startdate are going to come in a non-date format then use </p>\n\n<pre><code>strSql = \"SELECT Count(*) FROM tablename WHERE Date_field_name &gt;= #\" &amp; Format(startdate,\"\\#mm-dd-yyyy\\#\") &amp; \"# AND Date_Field_Name &lt;= #\" &amp; Format(enddate,\"\\#mm-dd-yyyy\\#\") &amp; \u201c#\u201d\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424281289, "post_id": 28588929, "comment_id": 45487039, "body": "Thanks for the quick reply Stewbob. I tried your code and getting an error on this line: If (Not IsNull(myRecordSet(Date_field_name).Value)). This is getting highlighted in red."}, {"owner": {"reputation": 16352, "user_id": 107899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RCasx.png?s=128&g=1", "display_name": "Stewbob", "link": "https://stackoverflow.com/users/107899/stewbob"}, "reply_to_user": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 1, "creation_date": 1424281461, "post_id": 28588929, "comment_id": 45487146, "body": "@marv, I forgot the <code>Then</code> after the If statement.  I edited the post to show that."}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424282142, "post_id": 28588929, "comment_id": 45487540, "body": "I added my complete code above. i think i&#39;m missing something very simple. getting a with block variable not set :( kindly help"}, {"owner": {"reputation": 16352, "user_id": 107899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RCasx.png?s=128&g=1", "display_name": "Stewbob", "link": "https://stackoverflow.com/users/107899/stewbob"}, "reply_to_user": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424282296, "post_id": 28588929, "comment_id": 45487633, "body": "@marv, You&#39;re getting the error because, once again I got sloppy with my code.  You have <code>rst.MoveNext</code> and it should be <code>rs.MoveNext</code> in your case.  I edited my post (again) to show that you need to use the same <code>RecordSet</code> object in the <code>If</code> statement and in the <code>.MoveNext</code> statement."}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424283540, "post_id": 28588929, "comment_id": 45488376, "body": "I corrected the rst. to rs and still get the same error :("}, {"owner": {"reputation": 16352, "user_id": 107899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RCasx.png?s=128&g=1", "display_name": "Stewbob", "link": "https://stackoverflow.com/users/107899/stewbob"}, "reply_to_user": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424284212, "post_id": 28588929, "comment_id": 45488748, "body": "@marv, you have commented out:  &#39;Set rs = cn.Execute(strSql)     Did you mean to do that?  That line is what runs the query and populates the rs object."}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424284540, "post_id": 28588929, "comment_id": 45488948, "body": "sorry about that, i was a typo. I dont have it commented in my actual code. still getting this annoying data type mismatch error :/"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1424285142, "post_id": 28588929, "comment_id": 45489277, "body": "the current error is &quot;data type mismatch in criteria expression&quot; :("}], "tags": [], "owner": {"reputation": 16352, "user_id": 107899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RCasx.png?s=128&g=1", "display_name": "Stewbob", "link": "https://stackoverflow.com/users/107899/stewbob"}, "is_accepted": false, "score": 2, "last_activity_date": 1424282193, "last_edit_date": 1424282193, "creation_date": 1424277729, "answer_id": 28588929, "question_id": 28588413, "link": "https://stackoverflow.com/questions/28588413/vba-data-type-mismatch-when-blank-record-exists-in-ms-access/28588929#28588929", "title": "VBA data type mismatch when blank record exists in MS Access", "body": "<p>There is most likely a proper way to do this within the query string, but I haven't run across it.  For this type of situation, I do it in two steps:</p>\n\n<p>Instead of running a Count query, I will run a standard SELECT query to return all the records in the date range of interest.\nThen I will loop through all the items in the recordset, discarding any that are null, and counting the rest.</p>\n\n<pre><code>While (myRecordSet.EOF = False)\n  If (Not IsNull(myRecordSet(Date_field_name).Value)) Then\n    myCounter = myCounter + 1\n  End If\n  myRecordSet.MoveNext\nWend\n</code></pre>\n\n<p>This is not the optimal way to do this in my opinion, but I have used it in the past and I know that it works.</p>\n"}], "owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1697, "favorite_count": 1, "accepted_answer_id": 28588800, "answer_count": 2, "score": 2, "last_activity_date": 1472231571, "creation_date": 1424276356, "last_edit_date": 1531164843, "question_id": 28588413, "link": "https://stackoverflow.com/questions/28588413/vba-data-type-mismatch-when-blank-record-exists-in-ms-access", "title": "VBA data type mismatch when blank record exists in MS Access", "body": "<p>I have the following vba query that works fine if there are no blank records in a particular field that contains dates. The error occurs when a blank exists in a particular record.</p>\n\n<p><strong>What am I trying to do?:</strong> extract a count out of my database between a date range. The startdate and enddate are cell references formatted as \"MM/DD/YYYY\" and the datebase field containing the dates are formatted as Date/Time, \"short date\".</p>\n\n<p><strong>query that works if my field column doesnt contain any blanks:</strong></p>\n\n<pre><code>Dim startdate As Date\nDim enddate As Date\nstrSql = \"SELECT Count(*) FROM tablename WHERE datevalue(Date_field_name) &gt;= \" &amp; Format(startdate, \"\\#mm-dd-yyyy\\#\") &amp; \"AND datevalue(Date_field_name) &lt;= \" &amp; Format(enddate, \"\\#mm-dd-yyyy\\#\")\n</code></pre>\n\n<p><strong>I tried adding IS NOT NULL and that doesnt work:(</strong></p>\n\n<pre><code>strSql = \"SELECT Count(*) FROM tablename WHERE ANOTHER_Field_Name IS NOT NULL AND datevalue(Date_field_name) &gt;= \" &amp; Format(startdate, \"\\#mm-dd-yyyy\\#\") &amp; \"AND datevalue(Date_field_name) &lt;= \" &amp; Format(enddate, \"\\#mm-dd-yyyy\\#\")\n</code></pre>\n\n<p>help me pls!! This is driving me mad.</p>\n\n<p><strong>EDIT</strong> The complete code:</p>\n\n<pre><code>Public Sub counter()\nDim cn As Object\nDim rs As Object\nDim strSql As String\nDim strConnection As String\nDim myCounter As Variant\nDim startdate As Date\nDim enddate As Date\nSet cn = CreateObject(\"ADODB.Connection\")\nstrConnection = \"Provider=Microsoft.Jet.OLEDB.4.0; \" &amp; _\n    \"Data Source=Data.mdb\"\nstrSql = \"SELECT Count(*) FROM tablename WHERE datevalue(Date_field_name) &gt;= \" &amp; Format(startdate, \"\\#mm-dd-yyyy\\#\") &amp; \"AND datevalue(Date_field_name) &lt;= \" &amp; Format(enddate, \"\\#mm-dd-yyyy\\#\")\ncn.Open strConnection\n'Set rs = cn.Execute(strSql)\n\nWhile (rs.EOF = False)\nIf (Not IsNull(rs(Sent_To_Tech_Date).Value)) Then\nmyCounter = myCounter + 1\nEnd If\nrs.MoveNext\nWend\nrs.Close\nSet rs = Nothing\ncn.Close\nSet cn = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "printing", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1424277734, "post_id": 28588026, "comment_id": 45484675, "body": "I don&#39;t think so. Even if you use <code>ShellExecute</code> to print it, the workbook will still be opened, printed and then closed."}, {"owner": {"reputation": 15, "user_id": 4580339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fea1dd654c7f685592b46d30d5e3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Adriaan", "link": "https://stackoverflow.com/users/4580339/adriaan"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1424412245, "post_id": 28588026, "comment_id": 45546980, "body": "Ok but how than I don&#39;t want to see Just print."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1424427573, "creation_date": 1424427573, "answer_id": 28626566, "question_id": 28588026, "link": "https://stackoverflow.com/questions/28588026/executeexcel4macro-to-print-closed-workbook/28626566#28626566", "title": "ExecuteExcel4Macro to print closed workbook", "body": "<p>This is the API version:</p>\n\n<pre><code> Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" _\n                                      (ByVal hWnd As Long, ByVal lpOperation As String, ByVal lpFile As String, _\n                                       ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long\nConst SW_HIDE            As Long = 0&amp;\nSub PrintFile(strFilepath As String)\n   ShellExecute Application.hWnd, \"Print\", strFilepath, 0&amp;, 0&amp;, SW_HIDE\nEnd Sub\n</code></pre>\n\n<p>Your calling code then just uses:</p>\n\n<pre><code>Call PrintFile(\"C:\\path to file.xls\")\n</code></pre>\n\n<p>for example.</p>\n"}], "owner": {"reputation": 15, "user_id": 4580339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fea1dd654c7f685592b46d30d5e3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Adriaan", "link": "https://stackoverflow.com/users/4580339/adriaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "accepted_answer_id": 28626566, "answer_count": 1, "score": 0, "last_activity_date": 1424427573, "creation_date": 1424275255, "last_edit_date": 1531164843, "question_id": 28588026, "link": "https://stackoverflow.com/questions/28588026/executeexcel4macro-to-print-closed-workbook", "title": "ExecuteExcel4Macro to print closed workbook", "body": "<p>I managed to get data out of a workbook with the ExecuteExcel4Macro.\nBut can i print the one sheet in the file, without opening the file?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1424276577, "post_id": 28587966, "comment_id": 45483882, "body": "What is the purpose of your <code>Load Me</code> line? The form must already be loaded for the code to be running."}, {"owner": {"reputation": 162, "user_id": 4403619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K8hvt.png?s=128&g=1", "display_name": "phrebh", "link": "https://stackoverflow.com/users/4403619/phrebh"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1424277103, "post_id": 28587966, "comment_id": 45484246, "body": "@Rory Actually, no it doesn&#39;t have to be loaded for this code to run. The DisplayOOBLinks procedure is called from another module. It reformats the form and a couple of its controls at runtime then loads the form so that I can set the Tag property before it is shown."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1424277214, "post_id": 28587966, "comment_id": 45484338, "body": "Nope - if that code is in the form, the form <b>must</b> be loaded for it to run. Since userforms are auto-instancing, as soon as you use a line like <code>userform.something</code> the form will be loaded automatically."}, {"owner": {"reputation": 162, "user_id": 4403619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K8hvt.png?s=128&g=1", "display_name": "phrebh", "link": "https://stackoverflow.com/users/4403619/phrebh"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1424278257, "post_id": 28587966, "comment_id": 45485013, "body": "@Rory Oh, I see what you are saying. I had it in there (in a different form) when I first wrote that procedure in a different module. I can remove it; however, that has nothing to do with my issue."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1424280735, "post_id": 28587966, "comment_id": 45486702, "body": "UserForm_Initialize() is where the code should be if you want something to happen when the UserForm shows."}, {"owner": {"reputation": 162, "user_id": 4403619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K8hvt.png?s=128&g=1", "display_name": "phrebh", "link": "https://stackoverflow.com/users/4403619/phrebh"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1424285395, "post_id": 28587966, "comment_id": 45489440, "body": "@Davesexcel I disagree. Initialize runs when the form is loaded. Activate should run when a form is shown. Initialize wouldn&#39;t work for me because I have to do work to the form after it loads, but before it is seen."}], "answers": [{"tags": [], "owner": {"reputation": 162, "user_id": 4403619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K8hvt.png?s=128&g=1", "display_name": "phrebh", "link": "https://stackoverflow.com/users/4403619/phrebh"}, "is_accepted": true, "score": 1, "last_activity_date": 1424700617, "creation_date": 1424700617, "answer_id": 28675668, "question_id": 28587966, "link": "https://stackoverflow.com/questions/28587966/excel-vba-userform-activate-not-triggering-on-show/28675668#28675668", "title": "Excel VBA - UserForm_Activate not triggering on Show", "body": "<p>Well, since no one (including me) could come up with anything better, I'll share my workaround and give it another few days before I close the question. </p>\n\n<p>After I show the form, I call the activate procedure manually: <code>UserForm_Activate</code>. It works, but I'd still like to know why it isn't triggering automatically.</p>\n"}], "owner": {"reputation": 162, "user_id": 4403619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K8hvt.png?s=128&g=1", "display_name": "phrebh", "link": "https://stackoverflow.com/users/4403619/phrebh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2043, "favorite_count": 0, "accepted_answer_id": 28675668, "answer_count": 1, "score": 0, "last_activity_date": 1485382470, "creation_date": 1424275074, "last_edit_date": 1531164843, "question_id": 28587966, "link": "https://stackoverflow.com/questions/28587966/excel-vba-userform-activate-not-triggering-on-show", "title": "Excel VBA - UserForm_Activate not triggering on Show", "body": "<p>I am working in Excel 2010 on a large project. Part of it checks for balanced amounts in several different files and if any of them are out of balance, a form pops up with a list of clickable links to the files in question and the expected values. Up until recently, this has been working fine, but this morning I see that the Activate procedure isn't being called when I Show the form. If I click elsewhere and then click on the form again, the Activate procedure runs as it should. It just doesn't run the first time. I even tried stepping through the code and it's not called at all.</p>\n\n<p>As you can see, I didn't change the name of the default \"UserForm_Activate\". I will say that I have added a lot of code to the project since the last time this functionality worked, but none of that code relates to this form or the procedure that calls it. (That being said, I still plan on looking for a connection there.)</p>\n\n<p>The form is set up to be non-modal. I also have another form that I use as a user interface that is also non-modal and therefore stays visible when this form pops up. The OOBItems object in the code is a Dictionary object with the expected value as the data and the file paths as the keys. LabelLink is a class that makes the links clickable.</p>\n\n<pre><code>Option Explicit\n\nPrivate LinkLabel() As LabelLink\n\n\n'***********************************************************************\n'Name:          UserForm_Activate\n'Description:   Adds links as clickable labels to form when it is shown.\n'\n'Revision History:\n'Date       Author  Changes made\n'***********************************************************************\nPrivate Sub UserForm_Activate()\n    Const LABELHEIGHT As Integer = 10\n    Const LABELSTARTTOP As Integer = 40\n    Const LABELWIDTH As Integer = 428\n    Const LABELLEFT As Integer = 6\n    Const MCSLABEL As String = \"Forms.Label.1\"\n    Const BLUE As Long = 16711680 'RGB(0, 0, 255)\n    Const PURPLE As Long = 16711935 'RGB(255, 0, 255)\n\n    Dim Links() As String\n    Dim LinkStart As Integer, LinkEnd As Integer\n    Dim LinkCount As Integer, LinkNum As Integer\n\n    'split the tag back into links\n    Links() = Split(Me.Tag, \"||\")\n\n    LinkStart = LBound(Links)\n    LinkEnd = UBound(Links)\n    LinkCount = LinkEnd - LinkStart + 1\n\n    ReDim LinkLabel(LinkStart To LinkEnd)\n\n    'loop through links to add them as labels\n    For LinkNum = LinkStart To LinkEnd\n\n        'create new instance of the LabelLink class\n        Set LinkLabel(LinkNum) = New LabelLink\n\n        'add the label to the form\n        Set LinkLabel(LinkNum).mObjLbl = Me.Controls.Add(MCSLABEL)\n\n        'format the label\n        With LinkLabel(LinkNum).mObjLbl\n            .Caption = Links(LinkNum)\n            .Height = LABELHEIGHT\n            .Left = LABELLEFT\n            .Width = LABELWIDTH\n            .Top = .Height * LinkNum + LABELSTARTTOP\n            .Font.Underline = True\n            .Font.Size = 8\n\n            'trying to fix the issue of the clicked link text going back to\n            'blue if you click on the main form then click back to this form\n            If .ForeColor = PURPLE Then\n                .ForeColor = PURPLE\n            Else\n                .ForeColor = BLUE\n            End If\n        End With\n    Next LinkNum\n\n    'refresh form\n    Me.Repaint\nEnd Sub\n\n\n'***********************************************************************\n'Name:          DisplayOOBLinks\n'Description:   Takes an array of links and opens the form to show them.\n'\n'Revision History:\n'Date       Author  Changes made\n'***********************************************************************\nPublic Sub DisplayOOBLinks(OOBItems As Object)\n    Const FORMBASEHEIGHT As Integer = 72\n    Const LABELHEIGHT As Integer = 12\n\n    Dim LinkCount As Integer\n    Dim TotalsText As String\n\n    'get count of OOB items\n    LinkCount = OOBItems.Count\n\n    'resize userform for the number of links to show\n    Me.Height = LinkCount * LABELHEIGHT + FORMBASEHEIGHT\n\n    'resize the expected totals textbox for the number of OOB items\n    Me.Controls(\"ExpectedTotals\").Height = (LinkCount + 1) * LABELHEIGHT\n\n    'add OOB values to expected totals textbox text\n    Me.Controls(\"ExpectedTotals\").text = \"Expected totals:\" &amp; vbLf &amp; Join(OOBItems.Items, vbLf)\n\n    'preload the form so that the tag can be set\n    Load Me\n\n    'join the links into one string to assign to the tag since forms don't take\n    'any parameters\n    Me.Tag = Join(OOBItems.Keys, \"||\")\n\n    'show the form\n    Me.Show\nEnd Sub\n</code></pre>\n\n<p>This is the entirety of the code module for the form in question.</p>\n\n<p>Can anyone see why the <code>Me.Show</code> line would show my form, but not run the Activate procedure? I guess I could call it specifically after I show the form but I'd rather not use a workaround when I shouldn't have to.</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 0, "creation_date": 1424277501, "post_id": 28587911, "comment_id": 45484550, "body": "You are getting rid of the comment indicators before each line when you run this, correct?"}, {"owner": {"reputation": 1, "user_id": 4580232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63a17a3dbec957c4c1b3460d89f8bf7?s=128&d=identicon&r=PG&f=1", "display_name": "MikeOIS", "link": "https://stackoverflow.com/users/4580232/mikeois"}, "reply_to_user": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 0, "creation_date": 1424280377, "post_id": 28587911, "comment_id": 45486460, "body": "Hi D_Zab -- I have commented out the section which I am having trouble with. It should not be commented out, though. Thank you"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1424287835, "post_id": 28587911, "comment_id": 45490959, "body": "What exactly is the issue? This looks as though the &quot;Customer&quot; and &quot;Job&quot; should each go into the last row of the column you specified on &quot;sheet1&quot;. Are some values being copied over?"}, {"owner": {"reputation": 1, "user_id": 4580232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63a17a3dbec957c4c1b3460d89f8bf7?s=128&d=identicon&r=PG&f=1", "display_name": "MikeOIS", "link": "https://stackoverflow.com/users/4580232/mikeois"}, "edited": false, "score": 0, "creation_date": 1424291346, "post_id": 28587911, "comment_id": 45493092, "body": "Kyle - thanks for your response. Currently, the only cell being copied is the  &quot;customer&quot;, no others. Additionally, when I open another instance of the REQUEST, it copies over existing values -- it does not go down to the next available row in the SCHEDULE. TIA."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4580232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63a17a3dbec957c4c1b3460d89f8bf7?s=128&d=identicon&r=PG&f=1", "display_name": "MikeOIS", "link": "https://stackoverflow.com/users/4580232/mikeois"}, "edited": false, "score": 0, "creation_date": 1424298969, "post_id": 28593272, "comment_id": 45497223, "body": "Hi D_Zab, thank you for your input. I copied your code so that I could try to manipulate it, but I got stuck on the following line: &#39;code&#39;wbk.Sheets(&quot;sheet1&quot;).Range(&quot;B&quot; &amp; Rows.Count + 1).PasteSpecial&#39;code&#39; this generated an Run-time error 1004. Application-define or object-defined error.  I did try to post a picture so that it would be easier to visualize the objective, but I did not have enough rep. Could you kindly advise what we can do to move past this?"}, {"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "reply_to_user": {"reputation": 1, "user_id": 4580232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63a17a3dbec957c4c1b3460d89f8bf7?s=128&d=identicon&r=PG&f=1", "display_name": "MikeOIS", "link": "https://stackoverflow.com/users/4580232/mikeois"}, "edited": false, "score": 0, "creation_date": 1424300468, "post_id": 28593272, "comment_id": 45497876, "body": "I made a mistake, try it now."}, {"owner": {"reputation": 1, "user_id": 4580232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63a17a3dbec957c4c1b3460d89f8bf7?s=128&d=identicon&r=PG&f=1", "display_name": "MikeOIS", "link": "https://stackoverflow.com/users/4580232/mikeois"}, "edited": false, "score": 0, "creation_date": 1424302284, "post_id": 28593272, "comment_id": 45498565, "body": "Hi D_Zab -- I tested your code but still received the same 1004 RT error, sorry. Can you kindly let me know what we can change? Thanks"}], "tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": false, "score": 0, "last_activity_date": 1424300453, "last_edit_date": 1424300453, "creation_date": 1424291306, "answer_id": 28593272, "question_id": 28587911, "link": "https://stackoverflow.com/questions/28587911/excel-2013-vba-copy-to-next-open-row-on-target-workbook/28593272#28593272", "title": "Excel 2013 - VBA - Copy to next open row on target workbook", "body": "<p>Without seeing the sheets it's impossible for me to know where to paste to, but it looks like your problem is your only copying one cell at a time so that's all that will copy. You need to copy the entire range and then if you paste it to the first open cell in your destination sheet it will paste everything.</p>\n\n<p>You will probably still need to tweak this a bit but hopefully it will give you enough to work with:</p>\n\n<pre><code>'TESTING - TO COPY ABOVE VALUES TO MASTER SCHEDULE'\nDim wbk As Workbook\nDim strFirstFile As String\nDim strSecondFile As String\n\nstrFirstFile = \"CNC WORK ORDER REQUEST - V2.XLSM\"\nstrSecondFile = \"C:\\Users\\Mike\\Desktop\\MASTER SCHEDULE.XLSX\"\n\n'CUSTOMER Copy:\nSet wbk = Workbooks(strFirstFile)\nwbk.Sheets(\"sheet1\").Range(\"E1:E5\").Copy\n\nSet wbk = Workbooks.Open(strSecondFile)\nwbk.Sheets(\"sheet1\").Range(\"B1\").End(xlDown).Offset(1, 0).PasteSpecial (xlPasteValues)\n\n'JOB# Copy:\nSet wbk = Workbooks(strFirstFile)\nwbk.Sheets(\"sheet1\").Range(\"B9:B18\").Copy\nSet wbk = Workbooks(strSecondFile)\nwbk.Sheets(\"sheet1\").Range(\"C1\").End(xlDown).Offset(1, 0).PasteSpecial \n\n\nwbk.Save\nwbk.Close\n\n'END TESTING\n</code></pre>\n\n<p>Just an FYI, if you're looking for the user to input a lot of data check into making a userform. They're not hard to make and will be much easier for your users to input a bunch of data. It also gives you some control over validating it.</p>\n"}], "owner": {"reputation": 1, "user_id": 4580232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63a17a3dbec957c4c1b3460d89f8bf7?s=128&d=identicon&r=PG&f=1", "display_name": "MikeOIS", "link": "https://stackoverflow.com/users/4580232/mikeois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424300453, "creation_date": 1424274916, "last_edit_date": 1424277526, "question_id": 28587911, "link": "https://stackoverflow.com/questions/28587911/excel-2013-vba-copy-to-next-open-row-on-target-workbook", "title": "Excel 2013 - VBA - Copy to next open row on target workbook", "body": "<p>I have been able to get quite far on my project by using a lot of the solutions posted on here. Unfortunately, I simply cannot workout the bugs and could really use some help. What I am trying to accomplish is as follows:</p>\n\n<p>-\"CNC WORK ORDER REQUEST - V2.XLSM\" is the source workbook where a department will input their requests for any sort of CNC work. I have formatted it so the output is consistent. A whole department of people will have access to it on their local computers. </p>\n\n<p>-\"MASTER SCHEDULE.XLSX\" is the target workbook where I would like a particular range of cells copied to, on the next available row of cells in this workbook. This workbook is for upper management to have visibility on a \"master schedule\" that is created by the submissions of the CNC WORK ORDER REQUEST workbook. </p>\n\n<p>I do feel that the WORKORDER REQUEST is fine, but I am having issue with copying to the next open row of cells on the MASTER SCHEDULE. I cannot get all of the cells to copy to the next open row. </p>\n\n<p>The code I have is as follows: </p>\n\n<pre><code>Sub Auto_Open()\n\nMsgBox \"Welcome, please enter information in *ALL* subsquent prompts as instructed.\"\n\nDim Customer\nCustomer = InputBox(\"Enter customer name\")\nRange(\"e1\") = Customer\n\nDim Job\nJob = InputBox(\"Enter Job#\")\nRange(\"e2\") = Job\n\nDim JobName\nJobName = InputBox(\"Enter job name / description\")\nRange(\"e3\") = JobName\n\nDim TodaysDate\nTodaysDate = InputBox(\"Enter today's date\")\nRange(\"E4\") = TodaysDate\n\nDim Manager\nManager = InputBox(\"Enter your Intials\")\nRange(\"e5\") = Manager\n\nMsgBox \"Before entering which machine will run this part, you must get this information from Ronnie\", vbOKOnly\n\nDim Machine\nMachine = InputBox(\"Enter which machine this will be run on. Options are: Thermwood -or- MultiCam\")\nRange(\"b9\") = Machine\n\nDim Part\nPart = InputBox(\"Enter part name as per drawing\")\nRange(\"B10\") = Part\n\nDim Qty\nQty = InputBox(\"Enter Qty needed including overs\")\nRange(\"B11\") = Qty\n\nDim Material\nMaterial = InputBox(\"Enter material type with details\")\nRange(\"B12\") = Material\n\nDim Thickness\nThickness = InputBox(\"Enter material thickness\")\nRange(\"b13\") = Thickness\n\nDim EdgeFinish\nEdgeFinish = InputBox(\"Enter edge finish for this part - MILL FINISH, FLAME POLISH, DIAMOND POLISH, DIAMOND AND BUFF\")\nRange(\"B14\") = EdgeFinish\n\nDim MaterialInHouse\nMaterial = InputBox(\"If material is in house, type YES, if not, enter the ETA\")\nRange(\"B15\") = MaterialInHouse\n\nDim AddtionalProcessing\nAddtionalProcessing = InputBox(\"Please note any subsequent processing required\")\nRange(\"B16\") = AddtionalProcessing\n\nDim NeedBy\nNeedBy = InputBox(\"Enter required completion date for parts\")\nRange(\"B17\") = NeedBy\n\nDim AddtionalNotes\nAddtionalNotes = InputBox(\"Enter any additional notes, if required\")\nRange(\"B18\") = AddtionalNotes\n\n'TESTING - TO COPY ABOVE VALUES TO MASTER SCHEDULE'\n'Dim wbk As Workbook\n'Dim strFirstFile As String\n'Dim strSecondFile As String\n\n'strFirstFile = \"CNC WORK ORDER REQUEST - V2.XLSM\"\n\n'strSecondFile = \"C:\\Users\\Mike\\Desktop\\MASTER SCHEDULE.XLSX\" 'CHANGE TO TARGET FILE ONCE DETERMINED\n\n'CUSTOMER COPY:\n'Set wbk = Workbooks(strFirstFile)\n'With wbk.Sheets(\"sheet1\")\n'.Range(\"E1\").Copy\n'End With\n'Set wbk = Workbooks.Open(strSecondFile)\n'With wbk.Sheets(\"sheet1\").Range(\"b\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial(xlPasteValues)\n'End With\n\n'JOB# COPY:\n'Set wbk = Workbooks(strFirstFile)\n'With wbk.Sheets(\"sheet1\")\n'.Range(\"E2\").Copy\n'End With\n'Set wbk = Workbooks(strSecondFile)\n'With wbk.Sheets(\"sheet1\").Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial\n'End With\n\n\n'wbk.Save\n'wbk.Close\n\n'END TESTING\n\n\nMsgBox \"Please print and submit to Ronnie.\", vbOKOnly 'ADD COMMENT BELOW BACK UP HERE ONCE SCHEDULE COMPLETE\n'Workorder has already been uploaded to schedule\",\n\nEnd Sub\n</code></pre>\n\n<p>Sorry if I did not articulate myself well enough with what I'm trying to accomplish. I tried posting images, but was not allowed.  I am really looking forward to solving this as it will help organize the company I am working with. Thanks in advance! </p>\n\n<p>Kind regards,\nMike Q </p>\n"}, {"tags": ["vba", "parsing", "eml"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1424275290, "post_id": 28587844, "comment_id": 45482969, "body": "which line raises the error?"}, {"owner": {"reputation": 922, "user_id": 2104778, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88674e9f27a022d664d7b544c7e3b336?s=128&d=identicon&r=PG", "display_name": "user2104778", "link": "https://stackoverflow.com/users/2104778/user2104778"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1424275456, "post_id": 28587844, "comment_id": 45483076, "body": "Question edited to answer your question"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424275486, "post_id": 28587844, "comment_id": 45483103, "body": "<code>Set OL = GetObject(, &quot;Outlook.Application&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 922, "user_id": 2104778, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88674e9f27a022d664d7b544c7e3b336?s=128&d=identicon&r=PG", "display_name": "user2104778", "link": "https://stackoverflow.com/users/2104778/user2104778"}, "edited": false, "score": 0, "creation_date": 1424276898, "post_id": 28588152, "comment_id": 45484106, "body": "Awesome. You are my hero."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1424275647, "creation_date": 1424275647, "answer_id": 28588152, "question_id": 28587844, "link": "https://stackoverflow.com/questions/28587844/open-and-read-eml-files-with-vba/28588152#28588152", "title": "Open and read .eml files with VBA", "body": "<p>The <code>GetObject</code> function takes the class name as second argument:</p>\n\n<pre><code>Set OL = GetObject(, \"Outlook.Application\")\n</code></pre>\n\n<p>It's <code>CreateObject</code> which would take it first:</p>\n\n<pre><code>Set OL = CreateObject(\"Outlook.Application\")\n</code></pre>\n\n<p>Note that Outlook will only run one instance, ever. You should be able to call the <code>CreateObject</code> function and would not need to use <code>GetObject</code>. If Outlook is already open, <code>CreateObject</code> will return that instance, if outlook is not already open, it will create one.</p>\n"}], "owner": {"reputation": 922, "user_id": 2104778, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88674e9f27a022d664d7b544c7e3b336?s=128&d=identicon&r=PG", "display_name": "user2104778", "link": "https://stackoverflow.com/users/2104778/user2104778"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4352, "favorite_count": 0, "accepted_answer_id": 28588152, "answer_count": 1, "score": 0, "last_activity_date": 1424275696, "creation_date": 1424274760, "last_edit_date": 1424275696, "question_id": 28587844, "link": "https://stackoverflow.com/questions/28587844/open-and-read-eml-files-with-vba", "title": "Open and read .eml files with VBA", "body": "<p>I need to open and read .eml files using VBA. Shockingly this seems to be difficult. Please help. The below code gives this error at line <code>Set OL = GetObject(\"Outlook.Application\")</code>:</p>\n\n<blockquote>\n  <p>Run-time error '-2147221020 (800401e4)': \n  Automation error \n  Invalid Syntax</p>\n</blockquote>\n\n<p>Code:</p>\n\n<pre><code>Private Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long\n\nPrivate Const SW_SHOWNORMAL As Long = 1\nPrivate Const SW_SHOWMAXIMIZED As Long = 3\nPrivate Const SW_SHOWMINIMIZED As Long = 2\n\nSub test11()\n    strMyFile = \"C:\\test.eml\"\n    Dim Myinspect As Outlook.Inspector\n    Dim MyItem As Outlook.MailItem\n    Dim OL As Object\n\n    If Dir(strMyFile) = \"\" Then\n        MsgBox \"File \" &amp; strMyFile &amp; \" does not exist\"\n    Else\n        ShellExecute 0, \"Open\", strMyFile, \"\", \"C:\\test1.eml\", SW_SHOWNORMAL\n    End If\n\n    Set OL = GetObject(\"Outlook.Application\")\n    Set Myinspect = OL.ActiveInspector\n    Set MyItem = Myinspect.CurrentItem\n    MsgBox \"Subject = \" &amp; MyItem.Subject\n    MsgBox \"Body = \" &amp; MyItem.Body\n    MyItem.Close 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1424274938, "post_id": 28587485, "comment_id": 45482717, "body": "It&#39;s the name of a shape on the MLS sheet. I&#39;d guess it&#39;s a rounded rectangle ;)"}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1424275838, "post_id": 28588036, "comment_id": 45483333, "body": "Thank you, that is obviously right. It turns out that this portion of the code is unused and that the colors are set directly as background colors in the cells of the sheet. That is why I was confused."}], "tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": false, "score": 2, "last_activity_date": 1424275284, "creation_date": 1424275284, "answer_id": 28588036, "question_id": 28587485, "link": "https://stackoverflow.com/questions/28587485/excel-shapes-rangearraysomename-whats-the-defined-range/28588036#28588036", "title": "Excel Shapes.Range(Array(&quot;someName&quot;)) - whats the defined range?", "body": "<p>When you create a shape Excel will automatically name it for you.  You can change this name by selecting the shape and changing it in the Name Box.</p>\n\n<p><img src=\"https://i.stack.imgur.com/OEsHD.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/7OmVX.png\" alt=\"enter image description here\"></p>\n\n<hr>\n\n<p>As @Rory pointed out, if your code is working then the shape is located on the MLS sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "is_accepted": true, "score": 3, "last_activity_date": 1424275704, "last_edit_date": 1424275704, "creation_date": 1424275392, "answer_id": 28588075, "question_id": 28587485, "link": "https://stackoverflow.com/questions/28587485/excel-shapes-rangearraysomename-whats-the-defined-range/28588075#28588075", "title": "Excel Shapes.Range(Array(&quot;someName&quot;)) - whats the defined range?", "body": "<p><code>Worksheets(\"MLS\").Shapes.Range(Array(\"Rounded Rectangle 1\"))</code> refers to a shape named \"Rounded Rectangle 1\" on the worksheet \"MLS\" so you won't find the definition you're looking for in your code, it's an object that exists on the worksheet.</p>\n\n<p><code>Worksheets(\"SheetName\").Shapes.Range([arg])</code> is used to reference a subset of the shapes present on the named worksheet (i.e. objects in that sheet's <code>Shapes</code> collection). The argument of the <code>Shapes.Range</code> method can either be:</p>\n\n<ul>\n<li>An Integer, referring to the index of the shape in the <code>Shapes</code> collection</li>\n<li>A String, referring to the name of a shape in the <code>Shapes</code> collection.</li>\n<li>An Array containing strings and/or integers, referring to the names/indices of shapes in the <code>Shapes</code> collection.</li>\n</ul>\n\n<p>In your specific case the use of <code>Array(\"Rounded Rectangle 1\")</code> is unnecessary and the line in question could have been written as</p>\n\n<pre><code>Worksheets(\"MLS\").Shapes.Range(\"Rounded Rectangle 1\") \n</code></pre>\n\n<p>with the same effect, or even just </p>\n\n<pre><code>Worksheets(\"MLS\").Shapes(\"Rounded Rectangle 1\")\n</code></pre>\n\n<p>However if there were multiple Rounded Rectangles on your sheet then you would need to use the full fat reference your mystery programmer used, something along the lines of</p>\n\n<pre><code>Worksheets(\"MLS\").Shapes.Range(Array(\"Rounded Rectangle 1\", \"Rounded Rectangle 2\", \"Rounded Rectangle 3\"))\n</code></pre>\n\n<p>Which would return a collection containing the shape objects Rounded Rectangle 1, 2 &amp; 3.</p>\n"}], "owner": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16033, "favorite_count": 0, "accepted_answer_id": 28588075, "answer_count": 2, "score": 2, "last_activity_date": 1424275704, "creation_date": 1424273892, "last_edit_date": 1424274714, "question_id": 28587485, "link": "https://stackoverflow.com/questions/28587485/excel-shapes-rangearraysomename-whats-the-defined-range", "title": "Excel Shapes.Range(Array(&quot;someName&quot;)) - whats the defined range?", "body": "<p>I have the following code snippet in Excel VBA: </p>\n\n<pre><code>With Worksheets(\"MLS\").Shapes.Range(Array(\"Rounded Rectangle 1\")).Fill\n    .ForeColor.RGB = RGB(166, 166, 166)\n    .Transparency = 0.3\nEnd With\n</code></pre>\n\n<p>I don't know where \"Rounded Rectangle 1\" is defined and what kind of shape or range it refers to. It is not defined within the VBA Code, I have already tried searching the whole project for the name.</p>\n\n<p>Where can I find the definition of \"Rounded Rectangle 1\" and what might have been the programmers intent in referring to a range/shape using this shapes/range/array construct?</p>\n"}, {"tags": ["forms", "vba", "excel"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1424274484, "post_id": 28587466, "comment_id": 45482380, "body": "Could you show more code pleasE?"}, {"owner": {"reputation": 3412, "user_id": 3344236, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003962689676/picture?type=large", "display_name": "ares777", "link": "https://stackoverflow.com/users/3344236/ares777"}, "edited": false, "score": 0, "creation_date": 1424274622, "post_id": 28587466, "comment_id": 45482484, "body": "It is a problem with path or file.  Check your drive for errors, too."}, {"owner": {"reputation": 752, "user_id": 2349366, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/47591ce8c8042e821d41d483093cd57d?s=128&d=identicon&r=PG", "display_name": "Taylor Lopez", "link": "https://stackoverflow.com/users/2349366/taylor-lopez"}, "edited": false, "score": 0, "creation_date": 1424274678, "post_id": 28587466, "comment_id": 45482534, "body": "This is the entire contents of the module that is being activated on the button press on my Excel sheet, and this is where it&#39;s pointing when I hit &quot;debug&quot; on the error. Is it possible for the error to be somewhere within the form code even though it&#39;s stopping me here?"}], "answers": [{"comments": [{"owner": {"reputation": 752, "user_id": 2349366, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/47591ce8c8042e821d41d483093cd57d?s=128&d=identicon&r=PG", "display_name": "Taylor Lopez", "link": "https://stackoverflow.com/users/2349366/taylor-lopez"}, "edited": false, "score": 0, "creation_date": 1424276219, "post_id": 28588180, "comment_id": 45483621, "body": "That On Error command only handles the line beneath is correct? Is it possible to apply a single On Error to an entire block without declaring a separate function?"}, {"owner": {"reputation": 752, "user_id": 2349366, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/47591ce8c8042e821d41d483093cd57d?s=128&d=identicon&r=PG", "display_name": "Taylor Lopez", "link": "https://stackoverflow.com/users/2349366/taylor-lopez"}, "edited": false, "score": 0, "creation_date": 1424276706, "post_id": 28588180, "comment_id": 45483985, "body": "That was definitely the solution. The constructor for my form has some code that&#39;s <i>supposed</i> to check for file existence, but it was breaking. Since I&#39;m only hiding and showing the form, that also explains why it broke between yesterday and today. The form already existed and it wasn&#39;t calling that constructor."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 752, "user_id": 2349366, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/47591ce8c8042e821d41d483093cd57d?s=128&d=identicon&r=PG", "display_name": "Taylor Lopez", "link": "https://stackoverflow.com/users/2349366/taylor-lopez"}, "edited": false, "score": 0, "creation_date": 1424276878, "post_id": 28588180, "comment_id": 45484089, "body": "<code>On Error</code> applies to an entire <i>scope</i>"}, {"owner": {"reputation": 752, "user_id": 2349366, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/47591ce8c8042e821d41d483093cd57d?s=128&d=identicon&r=PG", "display_name": "Taylor Lopez", "link": "https://stackoverflow.com/users/2349366/taylor-lopez"}, "edited": false, "score": 0, "creation_date": 1424889506, "post_id": 28588180, "comment_id": 45740411, "body": "Aha! Additionally, Error blocks can <i>kind of</i> be established by using <code>On Error GoTo [error handling label] [ code that could throw errors ] On Error GoTo 0</code>"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1424275693, "creation_date": 1424275693, "answer_id": 28588180, "question_id": 28587466, "link": "https://stackoverflow.com/questions/28587466/vba-6-5-bad-file-name-or-number-error-on-form-show-run-time-error-52/28588180#28588180", "title": "VBA 6.5 - &quot;Bad File Name or Number&quot; error on Form.Show - Run-time Error 52", "body": "<blockquote>\n  <p><em>My form does open files from a directory, but if this were the problem, wouldn't it direct me to the line of code doing the file opening?</em></p>\n</blockquote>\n\n<p>Not without an error handler, and not without error handling configured to break in classes. The code you posted is irrelevant to the issue and isn't causing the error.</p>\n\n<p>Your form has some code that runs on load/initialization/activation, which fails opening a file, as the error message says.</p>\n\n<p>Any code that's accessing outside resources <strong>must</strong> have error handling.</p>\n\n<pre><code>Private Sub DoSomething\nOn Error GoTo CleanFail\n\n    DoSomethingThatCanBlowUp\n\nCleanExit:\n    Exit Sub\n\nCleanFail:\n    ' handle errors here\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 752, "user_id": 2349366, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/47591ce8c8042e821d41d483093cd57d?s=128&d=identicon&r=PG", "display_name": "Taylor Lopez", "link": "https://stackoverflow.com/users/2349366/taylor-lopez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1680, "favorite_count": 0, "accepted_answer_id": 28588180, "answer_count": 1, "score": 0, "last_activity_date": 1426087371, "creation_date": 1424273836, "last_edit_date": 1426087371, "question_id": 28587466, "link": "https://stackoverflow.com/questions/28587466/vba-6-5-bad-file-name-or-number-error-on-form-show-run-time-error-52", "title": "VBA 6.5 - &quot;Bad File Name or Number&quot; error on Form.Show - Run-time Error 52", "body": "<p>EDIT: This ended up being more of a \"how does the MS VBA IDE work?\" kind of question. It was highlighting a function call when it erred out, but it was a line of code within the function actually causing the issue. By using the \"Step Into\" and \"Step Over\" actions (F8 and Shift+F8 respectively by default), you can walk through your code until you find the line that actually caused the error. Trying to step over <i>this</i> line will cause the VBA IDE to go back to the initially-highlighted line of code.</p>\n\n<hr>\n\n<p>I have a simple VBA user form I've developed for use with Microsoft Excel 2007. A button on one of my sheets shows this form using the following lines of VBA:</p>\n\n<pre><code>Sub ShowMyDialog()\n    MyFormName.Show\nEnd Sub\n</code></pre>\n\n<p>This was working perfectly fine yesterday. Today I open the .xlsm file and click the button to show the form again, and I get a \"Run-time Error 52: Bad File Name or Number\" error.</p>\n\n<p>When I click \"Debug\" it just takes me to the line in which I'm showing the form above. The name is correct, and this hasn't changed since the last time it was in a working state. My form <em>does</em> open files from a directory, but if this were the problem, wouldn't it direct me to the line of code doing the file opening?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "range", "selection"], "answers": [{"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1424275617, "post_id": 28587328, "comment_id": 45483182, "body": "user wants to <i>increase</i> by 1, not <i>store</i> 1"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1424278412, "post_id": 28587328, "comment_id": 45485107, "body": "@iDevlop -- Not how I&#39;m reading it.  If they wanted to increase by 1, they would have just said add 1 to the existing value or increase the existing value by 1, not add &quot;+1&quot; &lt;-- note +1 in quotes, from their title."}, {"owner": {"reputation": 3, "user_id": 4580204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0323223966131072a07720571955a4e4?s=128&d=identicon&r=PG&f=1", "display_name": "Jameson5285", "link": "https://stackoverflow.com/users/4580204/jameson5285"}, "edited": false, "score": 0, "creation_date": 1424289776, "post_id": 28587328, "comment_id": 45492190, "body": "Correct, I want to add 1 to the existing value of each of the cells in the user selected range. I should have been more clear."}], "tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": false, "score": 0, "last_activity_date": 1424273452, "creation_date": 1424273452, "answer_id": 28587328, "question_id": 28587154, "link": "https://stackoverflow.com/questions/28587154/how-do-i-add-1-to-all-cells-in-a-user-selected-range/28587328#28587328", "title": "How do I add \u201c+1\u201d to all cells in a user selected range?", "body": "<p>This should work for you:</p>\n\n<pre><code>Dim r, c As Range\nSet r = Selection\n\nFor Each c In r\n    c.Value = \"+1\"\nNext\n</code></pre>\n\n<p>This assumes that your cell formats will display \"+1\" instead of \"1\".  You can set the format of your cells to \"Text\".</p>\n"}, {"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1424275494, "post_id": 28587967, "comment_id": 45483109, "body": "interesting how &quot;Paste Add&quot; handles formulas"}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 3, "last_activity_date": 1424275074, "creation_date": 1424275074, "answer_id": 28587967, "question_id": 28587154, "link": "https://stackoverflow.com/questions/28587154/how-do-i-add-1-to-all-cells-in-a-user-selected-range/28587967#28587967", "title": "How do I add \u201c+1\u201d to all cells in a user selected range?", "body": "<p>The below code uses the built-in Paste Special Add feature to add 1 to every cell in the selected range.</p>\n\n<pre><code>Sub AddOneToSelection()\n\n    Dim rBlank As Range\n\n    If TypeName(Selection) = \"Range\" Then\n\n        'Put a '1' in an unused cell and copy it\n        Set rBlank = ActiveSheet.Cells.SpecialCells(xlLastCell).Offset(1, 0)\n        rBlank.Value = 1\n        rBlank.Copy\n\n        'Paste Special Add over the selection\n        Selection.PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlAdd\n\n        'Get rid of the copied cell\n        rBlank.ClearContents\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The benefit of this over looping is that Paste Special Add treats formulas and values differently and you don't have to code that part yourself.</p>\n\n<p>The downside is you increase your UsedRange by one row, if that matters to you.</p>\n"}], "owner": {"reputation": 3, "user_id": 4580204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0323223966131072a07720571955a4e4?s=128&d=identicon&r=PG&f=1", "display_name": "Jameson5285", "link": "https://stackoverflow.com/users/4580204/jameson5285"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1972, "favorite_count": 0, "accepted_answer_id": 28587967, "answer_count": 2, "score": 0, "last_activity_date": 1448334935, "creation_date": 1424272967, "last_edit_date": 1448334935, "question_id": 28587154, "link": "https://stackoverflow.com/questions/28587154/how-do-i-add-1-to-all-cells-in-a-user-selected-range", "title": "How do I add \u201c+1\u201d to all cells in a user selected range?", "body": "<p>I need to have the user select a range of cells with their mouse and then run a macro to <code>add +1</code> to that selected range. The range will often be different every time, so it cannot be defined.</p>\n\n<p>Here's what I have so far, it just works on a single active cell, I cannot get it to work on a range selection, because I do not know what to define or function to utilize.</p>\n\n<p>My code Follows:</p>\n\n<pre><code>Sub Add()\nActiveCell.Value = ActiveCell.Value + 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "paste"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1424274183, "creation_date": 1424274183, "answer_id": 28587598, "question_id": 28587083, "link": "https://stackoverflow.com/questions/28587083/macro-excel-to-copy-value-till-blank-cell-and-paste-to-next-sheet/28587598#28587598", "title": "macro excel to copy value till blank cell and paste to next sheet", "body": "<p>Click on any cell in the first row you want to consider and run this small macro:</p>\n\n<pre><code>Sub marine()\n    Dim rng As Range, sh As Worksheet, i As Long, j As Long\n    Dim sName As String, wf As WorksheetFunction\n    Dim r1 As Long, r2 As Long\n    Set wf = Application.WorksheetFunction\n    Set rng = ActiveCell\n    Set sh = ActiveSheet\n    sName = sh.Name\n    r1 = rng.Row\n\n    For i = 1 To Sheets.Count\n        If Sheets(i).Name = sName Then\n            j = i + 1\n            Exit For\n        End If\n    Next i\n\n    For i = r1 To Rows.Count\n        If wf.CountA(Cells(i, 1).EntireRow) = 0 Then\n            Range(Cells(r1, 1), Cells(i - 1, 1)).EntireRow.Copy Sheets(j).Range(\"A1\")\n            Exit Sub\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 4580188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1441246e82c82778f3301366865907e7?s=128&d=identicon&r=PG&f=1", "display_name": "hari", "link": "https://stackoverflow.com/users/4580188/hari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1424279587, "creation_date": 1424272787, "last_edit_date": 1424279587, "question_id": 28587083, "link": "https://stackoverflow.com/questions/28587083/macro-excel-to-copy-value-till-blank-cell-and-paste-to-next-sheet", "title": "macro excel to copy value till blank cell and paste to next sheet", "body": "<p>i have a sheet with many rows and the number of rows may vary for different similar files.i need to get a script where i can copy the values in the rows  till the next row is blank and paste it to the next sheet.Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1424272574, "post_id": 28586924, "comment_id": 45481047, "body": "Sounds like Proc3 should not handle the error. Proc2 should."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1424275083, "post_id": 28586924, "comment_id": 45482829, "body": "You can make your routines into functions that return a Boolean to indicate success. Thus the calling code can check the result and exit if required."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424280018, "post_id": 28586924, "comment_id": 45486214, "body": "Once you&#39;ve handled an error, it&#39;s handled: it won&#39;t bubble back up the call stack unless you re-raise it from within your handler.  Exactly how you would structure your code to deal with this would depend on the impact of the error on the rest of the process."}], "answers": [{"tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": false, "score": 3, "last_activity_date": 1424273609, "last_edit_date": 1424273609, "creation_date": 1424272875, "answer_id": 28587118, "question_id": 28586924, "link": "https://stackoverflow.com/questions/28586924/how-to-pass-err-raise-errors-up-the-stack/28587118#28587118", "title": "How to pass Err.Raise errors up the stack", "body": "<p>In general, if you have error handling enabled, your code will immediately jump to the next line in the method where error handling is enabled.  As such, when you have error handling enabled at a higher level in the call stack, this means your code will immediately jump to the point right after the method call in the <strong>lowest</strong> method in the call stack where error handling is enabled.  </p>\n\n<p>For example (assume all code in this answer starts with a call to <code>Proc1</code>):</p>\n\n<pre><code>Sub Proc1()\n    On Error Resume Next\n    MsgBox 1\n    Proc2\n    MsgBox 6\nEnd Sub\n\nSub Proc2()\n    MsgBox 2\n    Proc3\n    MsgBox 5\nEnd Sub\n\nSub Proc3()\n    MsgBox 3\n    Dim x As Integer\n    x = CInt(\"x\")\n    MsgBox 4\nEnd Sub\n</code></pre>\n\n<p>This will display \"1\", \"2\", \"3\", then \"6\" because of the error it encounters in <code>Proc3</code>.  If the error weren't present, it would, of course, display \"1\", \"2\", \"3\", \"4\", \"5\", \"6\".</p>\n\n<p>Now, you can enable error handling separately at a lower level in the call stack.  For instance, if I add <code>On Error Resume Next</code> to <code>Proc2</code> like this:</p>\n\n<pre><code>Sub Proc2()\n    On Error Resume Next\n    MsgBox 2\n    Proc3\n    MsgBox 5\nEnd Sub\n</code></pre>\n\n<p>Then my output becomes \"1\", \"2\", \"3\", \"5\", \"6\".  Note the addition of the \"5\" because now the error handling is occurring in <code>Proc2</code> and continuing on the next line.</p>\n"}], "owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424273609, "creation_date": 1424272330, "question_id": 28586924, "link": "https://stackoverflow.com/questions/28586924/how-to-pass-err-raise-errors-up-the-stack", "title": "How to pass Err.Raise errors up the stack", "body": "<p>Suppose Proc1 calls Proc2, which calls Proc3.</p>\n\n<p>In Proc3 I generate an error with Err.Raise and handle the error. So far so good, but now I exit Proc3 and control passes to Proc2, which due to the error in Proc3 should branch into cleanup and exiting. However, Proc2 doesn't know an error occurred in Proc3, so instead it proceeds normally. Same with Proc1.</p>\n\n<p>What's a good way to handle that? All I can think of is checking for each possible Err.Raise error in Proc3's error handler, and raising the same error again there. And then doing the same in Proc2. But that doesn't seem to work, and it seems like there must be a better way anyway.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1424272290, "post_id": 28586767, "comment_id": 45480885, "body": "So your question is, <i>how do I protect / unprotect a worksheet</i>? I believe this is possibly answered 1000+ times on this site, did you try a quick search?"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1424272387, "post_id": 28586767, "comment_id": 45480935, "body": "Look at this ya amr Ali <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.protect.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}, {"owner": {"reputation": 27, "user_id": 2059934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18fc6c1f88683ffc8ca41b029e18afa3?s=128&d=identicon&r=PG", "display_name": "Amr Ali", "link": "https://stackoverflow.com/users/2059934/amr-ali"}, "edited": false, "score": 0, "creation_date": 1424272454, "post_id": 28586767, "comment_id": 45480970, "body": "@ Mat&#39;s Mug. No, i  wrote this function as an example. My issue was with <code>For Each - Next</code> statement since i have 2 loops inside each other and i can not fix it well."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1424272731, "post_id": 28586767, "comment_id": 45481146, "body": "You should <a href=\"https://stackoverflow.com/posts/28586767/edit\">edit</a> your post to make your question clearer. &quot;Stuck at a line of code&quot; is kinda vague, and having nested loops isn&#39;t an issue all by itself - please describe the problem you are having, help us help you!"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 2059934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18fc6c1f88683ffc8ca41b029e18afa3?s=128&d=identicon&r=PG", "display_name": "Amr Ali", "link": "https://stackoverflow.com/users/2059934/amr-ali"}, "is_accepted": false, "score": 0, "last_activity_date": 1424281808, "creation_date": 1424281808, "answer_id": 28590400, "question_id": 28586767, "link": "https://stackoverflow.com/questions/28586767/loop-through-cells-range-against-worksheets/28590400#28590400", "title": "Loop through cells range against worksheets", "body": "<p>I successfully managed to write a function to loop through all workbook sheets and compare it against a defined list in cells range then do some actions.</p>\n\n<pre><code>Public Function Test()\n\nDim wks, xlWSH As Worksheet\nDim myRange, Cell As Range\nDim ProtectIt As Boolean\n\n'Refer to sheet name where you save your sheet names list\nSet wks = Worksheets(\"SheetName\")\nWith wks\n'Refer to first cell where your sheet names list starts. Here is \"A1\"\nSet myRange = .Range(.Cells(1, \"A\"), .Cells(.Rows.Count, \"A\").End(xlUp))\nEnd With\n\nFor Each xlWSH In ActiveWorkbook.Worksheets\n\nFor Each Cell In myRange\n'If sheet name is in your list then set DoIt to False\nIf xlWSH.Name = Cell.Value Then\nDoIt = False\nExit For\nElse\nDoIt = True\nEnd If\nNext Cell\n\nIf DoIt = True Then\nWith xlWSH\n'Do Some Actions With Sheet\nEnd With\nEnd If\n\nNext xlWSH\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 2059934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18fc6c1f88683ffc8ca41b029e18afa3?s=128&d=identicon&r=PG", "display_name": "Amr Ali", "link": "https://stackoverflow.com/users/2059934/amr-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424281808, "creation_date": 1424271824, "last_edit_date": 1531164843, "question_id": 28586767, "link": "https://stackoverflow.com/questions/28586767/loop-through-cells-range-against-worksheets", "title": "Loop through cells range against worksheets", "body": "<p>I have a workbook with so many sheets. I have a list of sheet names written somewhere in a sheet. I need to write a function to protect only those sheets which are not in this list.</p>\n\n<p>I think i am stuck at a line of code. Could you help me.</p>\n\n<pre><code>Public Function Test()\nOn Error GoTo Test_Err\n\nDim wks, xSheet As Worksheet\nDim myRange As Range\nDim Cell As Range\n\nSet wks = Worksheets(\"HideTabs\")\n\nWith wks\nSet myRange = .Range(.Cells(1, \"D\"), .Cells(.Rows.Count, \"D\").End(xlUp))\nEnd With\n\nFor Each Cell In myRange\nFor Each xSheet In ActiveWorkbook.Worksheets\n\nIf xSheet.Name = Cell.Value Then\n' Do Something\nExit For\nElse\n' Do Something else\nEnd If\n\nNext xSheet\nNext Cell\n\nExit Function\nTest_Err:\n      MsgBox \"The Error Happened on (Test Function) Line : \" &amp; Erl &amp; vbNewLine &amp; _\n           \"Error Message : \" &amp; Err.Description &amp; vbNewLine &amp; _\n           \"Error Number : \" &amp; Err.Number &amp; vbNewLine &amp; vbNewLine &amp; _\n           sMsg, vbCritical, sTitle\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "qtp"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 1, "creation_date": 1424271502, "post_id": 28586615, "comment_id": 45480394, "body": "Have you tried anything yet?"}, {"owner": {"reputation": 512, "user_id": 4029005, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8b4ad34d3632c9a5784a643f24f2287b?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/4029005/raj"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1424271739, "post_id": 28586615, "comment_id": 45480540, "body": "For the Input Box handling scenario, I don&#39;t know how to start.Rest all code works fine. I tried to find out on google but didn&#39;t get anything that could help me. I tried using &quot;Application.DisplayAlert&quot; but it didn&#39;t work for me."}, {"owner": {"reputation": 98839, "user_id": 3848, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W10YY.jpg?s=128&g=1", "display_name": "Motti", "link": "https://stackoverflow.com/users/3848/motti"}, "edited": false, "score": 0, "creation_date": 1424284296, "post_id": 28586615, "comment_id": 45488802, "body": "can you attach a screen shot of the <i>input box</i> in question?"}, {"owner": {"reputation": 512, "user_id": 4029005, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8b4ad34d3632c9a5784a643f24f2287b?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/4029005/raj"}, "reply_to_user": {"reputation": 98839, "user_id": 3848, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W10YY.jpg?s=128&g=1", "display_name": "Motti", "link": "https://stackoverflow.com/users/3848/motti"}, "edited": false, "score": 0, "creation_date": 1424312901, "post_id": 28586615, "comment_id": 45501732, "body": "I have attached the screenshot. @Motti"}], "answers": [{"comments": [{"owner": {"reputation": 512, "user_id": 4029005, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8b4ad34d3632c9a5784a643f24f2287b?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/4029005/raj"}, "edited": false, "score": 0, "creation_date": 1424333533, "post_id": 28601161, "comment_id": 45508187, "body": "Thanks Motti! I agree with you but this only happens when I run the test set first time. However, I can modify the script but it&#39;s a part of already defined framework and I would not get the permission to modify the script. Is it not possible to do so via excel macro??"}, {"owner": {"reputation": 98839, "user_id": 3848, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W10YY.jpg?s=128&g=1", "display_name": "Motti", "link": "https://stackoverflow.com/users/3848/motti"}, "reply_to_user": {"reputation": 512, "user_id": 4029005, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8b4ad34d3632c9a5784a643f24f2287b?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/4029005/raj"}, "edited": false, "score": 0, "creation_date": 1424333777, "post_id": 28601161, "comment_id": 45508285, "body": "Sorry @RajKamal, I don&#39;t know"}], "tags": [], "owner": {"reputation": 98839, "user_id": 3848, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W10YY.jpg?s=128&g=1", "display_name": "Motti", "link": "https://stackoverflow.com/users/3848/motti"}, "is_accepted": false, "score": 1, "last_activity_date": 1424332718, "creation_date": 1424332718, "answer_id": 28601161, "question_id": 28586615, "link": "https://stackoverflow.com/questions/28586615/macro-code-to-click-on-ok-button-in-an-input-box-that-is-launched-through-qtp/28601161#28601161", "title": "Macro code to click on OK button in an Input Box that is launched through QTP", "body": "<p>It looks like the QTP script is explicitly asking for user input during the test run. This means that you lose a lot of the advantages of <em>automation</em> by forcing a human being to sit next to the machine while the test is run. </p>\n\n<p>I would suggest modifying the test so that it uses data automatically. In QTP this can be done via the <a href=\"http://www.tutorialspoint.com/qtp/qtp_datatables.htm\" rel=\"nofollow\">data table</a> or via test (or action) <a href=\"http://www.tutorialspoint.com/qtp/qtp_actions.htm\" rel=\"nofollow\">parameters</a>.</p>\n"}], "owner": {"reputation": 512, "user_id": 4029005, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8b4ad34d3632c9a5784a643f24f2287b?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/4029005/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424332718, "creation_date": 1424271418, "last_edit_date": 1424312405, "question_id": 28586615, "link": "https://stackoverflow.com/questions/28586615/macro-code-to-click-on-ok-button-in-an-input-box-that-is-launched-through-qtp", "title": "Macro code to click on OK button in an Input Box that is launched through QTP", "body": "<p>I am executing few QTP scripts through excel macro. But sometimes QTP throws some pop up where we have to click on OK manually after entering some value. I want to simulate this action in my macro code.</p>\n\n<p>Below is the screenshot of Input Box that I want to handle:</p>\n\n<p><img src=\"https://i.stack.imgur.com/ZIHkf.png\" alt=\"enter image description here\"></p>\n\n<p>Problem is that this <strong>Input Box is launched through QTP Script</strong> But I want to click on OK button using excel macro code. So, How can I get this Input Box and perform desired action? </p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 1, "creation_date": 1424270283, "post_id": 28586087, "comment_id": 45479630, "body": "Look at <code>Offset(1)</code>, what is it your trying to do here?"}], "answers": [{"tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": false, "score": 1, "last_activity_date": 1424270815, "creation_date": 1424270815, "answer_id": 28586411, "question_id": 28586087, "link": "https://stackoverflow.com/questions/28586087/vba-excel-2007-loops-insert-on-the-wrong-place-rows/28586411#28586411", "title": "VBA Excel 2007: Loops insert on the wrong place rows.", "body": "<p>Replace</p>\n\n<pre><code> Worksheets(\"overall\").Range(\"C\" &amp; oa_count).Select\n            ActiveCell.Offset(1).EntireRow.Insert\n</code></pre>\n\n<p>with</p>\n\n<pre><code>With Worksheets(\"overall\").Range(\"C\" &amp; oa_count).Offset(1,0).EntireRow.Insert\n</code></pre>\n\n<p>A little about <code>ActiveCell</code> from good fella MSDN:</p>\n\n<blockquote>\n  <p>Returns a Range object that represents the active cell in the active\n  window (the window on top) or in the specified window. If the window\n  isn't displaying a worksheet, this property fails. Read-only.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 3669165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e286bc666e74179b93c81bf22084add3?s=128&d=identicon&r=PG&f=1", "display_name": "J&#246;rg T.", "link": "https://stackoverflow.com/users/3669165/j%c3%b6rg-t"}, "edited": false, "score": 0, "creation_date": 1424333929, "post_id": 28587540, "comment_id": 45508352, "body": "Thanks a lot. The code works now at me :), but you forget this little thing: Before <code>while</code> and after <code>for</code> you need: <code>oa_count = 1</code>"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "reply_to_user": {"reputation": 25, "user_id": 3669165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e286bc666e74179b93c81bf22084add3?s=128&d=identicon&r=PG&f=1", "display_name": "J&#246;rg T.", "link": "https://stackoverflow.com/users/3669165/j%c3%b6rg-t"}, "edited": false, "score": 0, "creation_date": 1424344237, "post_id": 28587540, "comment_id": 45514258, "body": "yes, nicely spotted, but in fact <code>oa_count = 0</code> , so it starts at 1 on first loop (and not 2)."}], "tags": [], "owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "is_accepted": true, "score": 1, "last_activity_date": 1424274398, "last_edit_date": 1424274398, "creation_date": 1424274045, "answer_id": 28587540, "question_id": 28586087, "link": "https://stackoverflow.com/questions/28586087/vba-excel-2007-loops-insert-on-the-wrong-place-rows/28587540#28587540", "title": "VBA Excel 2007: Loops insert on the wrong place rows.", "body": "<p>when inserting one row, you don't need <code>oa_length = Worksheets(\"overall\").Cells(Rows.Count, 1).End(xlUp).Row + 1</code></p>\n\n<p>instead, <code>oa_length = oa_length + 1</code> would work faster.</p>\n\n<p>Also it should be before the <code>End if</code>.</p>\n\n<p>But still updating oa_length won't make the <code>For</code> loop go one row more.</p>\n\n<p>You must use a <code>While</code> or <code>repeat until</code> Loop for that purpose.</p>\n\n<pre><code>Option Explicit\n\nSub CopyData()\n\nDim dl_length&amp;\nDim oa_length&amp;\nDim dl_count&amp;\nDim oa_count&amp;\nDim Sh_oa As Worksheet\nDim Sh_dl As Worksheet\n\nWith ThisWorkbook\n    Set Sh_oa = .Sheets(\"overall\")\n    Set Sh_dl = .Sheets(\"download\")\nEnd With\n\nWith Sh_oa\n    oa_length = .Cells(.Rows.Count, 1).End(xlUp).Row 'i removed the +1, wich is a blank cell\nEnd With\n\nWith Sh_dl\n    dl_length = .Cells(.Rows.Count, 1).End(xlUp).Row\nEnd With\n\nWith Application 'this part is to make things faster...\n    .ScreenUpdating = False\n    .EnableEvents = False\n    .Calculation = xlCalculationManual\nEnd With\n\nFor dl_count = 1 To dl_length\n\n    While oa_count &lt;= oa_length\n\n        oa_count = oa_count + 1\n\n        If Sh_dl.Range(\"F\" &amp; dl_count).Value2 = Sh_oa.Range(\"C\" &amp; oa_count).Value2 Then\n\n            oa_count = oa_count + 1 'if you insert a line, you'll need to read a line after that later\n\n            With Sh_oa\n                .Rows(oa_count).Insert\n                .Cells(oa_count, 1).Value2 = \"Search and replace\"\n                .Range(\"E\" &amp; oa_count).Value2 = Sh_dl.Range(\"L\" &amp; dl_count).Value2\n            End With\n\n            oa_length = oa_length + 1 'wider the scope of checks\n\n       End If\n\n    Wend\n\nNext dl_count\n\nSet Sh_oa = Nothing\nSet Sh_dl = Nothing\n\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    .Calculation = xlCalculationAutomatic\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3669165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e286bc666e74179b93c81bf22084add3?s=128&d=identicon&r=PG&f=1", "display_name": "J&#246;rg T.", "link": "https://stackoverflow.com/users/3669165/j%c3%b6rg-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 28587540, "answer_count": 2, "score": 2, "last_activity_date": 1424274398, "creation_date": 1424269772, "question_id": 28586087, "link": "https://stackoverflow.com/questions/28586087/vba-excel-2007-loops-insert-on-the-wrong-place-rows", "title": "VBA Excel 2007: Loops insert on the wrong place rows.", "body": "<p>I wrote two loops to compare 2 lists and to insert missing informations from one list into the other.\nUnfortunately, the macro inserts in the middle of the runtime only rows below the 1st row. I tried to avoid this with an If-Statement, but then the mistake will start on the 2nd row.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub CopyData()\n\nDim dl_length As Integer\nDim oa_length As Integer\nDim dl_count As Integer\nDim oa_count As Integer\n\ndl_length = Worksheets(\"download\").Cells(Rows.Count, 1).End(xlUp).Row + 1\noa_length = Worksheets(\"overall\").Cells(Rows.Count, 1).End(xlUp).Row + 1\n\nFor dl_count = 1 To dl_length\n    For oa_count = 1 To oa_length\n\nIf Worksheets(\"download\").Range(\"F\" &amp; dl_count) = Worksheets(\"overall\").Range(\"C\" &amp; oa_count) Then\n            Worksheets(\"overall\").Range(\"C\" &amp; oa_count).Select\n            ActiveCell.Offset(1).EntireRow.Insert\n            Worksheets(\"overall\").Range(\"A\" &amp; oa_count + 1) = \"Search and replace\"\n            Worksheets(\"overall\").Range(\"E\" &amp; oa_count + 1) = Worksheets(\"download\").Range(\"L\" &amp; dl_count)\n       End If\n\n    oa_length = Worksheets(\"overall\").Cells(Rows.Count, 1).End(xlUp).Row + 1\n    Next oa_count\nNext dl_count\n\n\nEnd Sub\n</code></pre>\n\n<p>When I try to </p>\n\n<p>Can you please help me to improve the code?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "edited": false, "score": 0, "creation_date": 1424269632, "post_id": 28585948, "comment_id": 45479178, "body": "See if you can use this: <a href=\"http://stackoverflow.com/questions/20334764/need-help-scraping-with-excel-vba/20335096#20335096\" title=\"need help scraping with excel vba\">stackoverflow.com/questions/20334764/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424272203, "post_id": 28586603, "comment_id": 45480828, "body": "Hi Matteo thank you but I am not sure I can be able to make it"}, {"owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424272689, "post_id": 28586603, "comment_id": 45481116, "body": "I mean I tried but doesn&#39;t seem to be working , I copied and paste you code in new VBA module  and insert the function in B1 Could you please guide me through"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424273406, "post_id": 28586603, "comment_id": 45481621, "body": "Well, is there any link in A1 ? If yes, are you sure the link contains that object with that id? Be more specific with the error please, maybe set a breakpoint at the beginning of the code and try to run through step by step."}, {"owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424274085, "post_id": 28586603, "comment_id": 45482098, "body": "Yes In A1 there is link , I may be wrong in the beginning ,  &#39;&lt;span id=&quot;JS_topStoreCount&quot;&gt;&lt;/span&gt;&#39; is inside the html page  and is not included in the link  , so just to understand what I need to copy  , please refer to this page <a href=\"http://tinyurl.com/mzh4aey\" rel=\"nofollow noreferrer\">link</a> on the right of the page  you should see \uff0820\uff09 that is what I need to copy"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424274488, "post_id": 28586603, "comment_id": 45482383, "body": "Just tested with your link and I exactly get 20. What is the error you get on the Excel sheet?"}, {"owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424275172, "post_id": 28586603, "comment_id": 45482893, "body": "I am sorry I am not able to  make it work ,  so this is what I did : new excel sheet  , Link in &quot;A1&quot;  and paste &#39;=giveMeValue(A1)&#39; in &quot;B1&quot; . After that  TAB Developer &gt; Visual Basic  &gt; insert Module an paste your code .....after that  doesn&#39;t show any result ...miss something ?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424275174, "post_id": 28586603, "comment_id": 45482896, "body": "Just to make sure, I tell you what I did:  1) I create a module; 2) I copy-paste the code (including Function and End Function) into the module (not inside a sub!) 3) I type in any cell &quot;=giveMeValue(&quot; 4) I select the cell where the link of the page is 5) I close the bracket and press Enter. Nothing more, it sounds very strange that it doesn&#39;t work. Please give me more info about the error and the behavior, as well as about the Excel version."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424275242, "post_id": 28586603, "comment_id": 45482938, "body": "@user2482756 you need to add the function before; just try to press &quot;Enter&quot; on the cell B1, it will work."}, {"owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424275818, "post_id": 28586603, "comment_id": 45483319, "body": "ohhhh is working thx so much  the problem was the Hyperlink , is it possible to  have with the Hyperlink , and what do you mean by &quot;Do Loop and dynamically run only once through all the cells by redefining each time the value of link and the place where the .innerText should be printed.&quot; so in real time if numbers change change also the file ?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424276133, "post_id": 28586603, "comment_id": 45483559, "body": "If you have the hyperlink, you can write <code>=giveMeValue(Text(A1,))</code> instead of simply <code>=giveMeValue(A1)</code> (you take only the text part of the hyperlink). For the other question, it&#39;s better you close this question (by accepting the answer, if it works) and open a new one because it&#39;s very hard to make it by comments."}, {"owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424276695, "post_id": 28586603, "comment_id": 45483967, "body": "Ok  I get it  , thx   sorry but &#39;=giveMeValue(Text(A1,))&#39; is not working from my side with hyperlink , maybe need to change somthing on the module?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424277051, "post_id": 28586603, "comment_id": 45484206, "body": "No man, <a href=\"https://support.office.microsoft.com/en-ca/article/TEXT-function-29cea14b-bd86-426c-9985-cb2f0b19df58\" rel=\"nofollow noreferrer\">TEXT</a> is an Excel built-in function, you&#39;re probably just being wrong with the syntaxis. You&#39;re on the right way, just try a bit yourself fixing the minor problems and, if it works, don&#39;t forget to accept the answer ;)"}, {"owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424277368, "post_id": 28586603, "comment_id": 45484446, "body": "THX , I accepted the answer   , but to be honest I don&#39;t know how to fix it &#39;=giveMeValue(Text(A1,))&#39;, so this file will be all the time up to date now ?"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1424271394, "creation_date": 1424271394, "answer_id": 28586603, "question_id": 28585948, "link": "https://stackoverflow.com/questions/28585948/vba-get-element-by-id/28586603#28586603", "title": "VBA get element by id", "body": "<p>You can create a custom function with an XMLHTTP request: </p>\n\n<pre><code>Public Function giveMeValue(ByVal link As String) As String\n    Set htm = CreateObject(\"htmlFile\")\n    With CreateObject(\"msxml2.xmlhttp\")\n       .Open \"POST\", link, False\n       .send\n       htm.body.innerhtml = .responsetext\n    End With\n    With htm.getelementbyid(\"JS_topStoreCount\")\n       giveMeValue = .innerText\n    End With\n    htm.Close\n    Set htm = Nothing\nEnd Function\n</code></pre>\n\n<p>and just insert the function in the cell, for example in B1: </p>\n\n<pre><code>=giveMeValue(A1)\n</code></pre>\n\n<p>Of course, if you prefer not to have a function, you can embed the content of the function into a <code>Do Loop</code> and dynamically run only once through all the cells by redefining each time the value of <code>link</code> and the place where the <code>.innerText</code> should be printed.</p>\n"}], "owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "accepted_answer_id": 28586603, "answer_count": 1, "score": 0, "last_activity_date": 1424824748, "creation_date": 1424269387, "last_edit_date": 1531164843, "question_id": 28585948, "link": "https://stackoverflow.com/questions/28585948/vba-get-element-by-id", "title": "VBA get element by id", "body": "<p>Hello  I would appreciate some advice , I need to copy and past some data from webpage to excel  but  I am if this can be possible and how .</p>\n\n<p>Lets' say I have   a file  as :</p>\n\n<pre><code> A        B          \nLink     Data\n</code></pre>\n\n<p>I need to open the link on \"A\"  copy the <code>&lt;span id=\"JS_topStoreCount\"&gt;&lt;/span&gt;</code> result  of the page and Paste on \"B\"</p>\n\n<p>I have  many rows so has to repeat the same to all the rows </p>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1424271289, "creation_date": 1424271289, "answer_id": 28586564, "question_id": 28585279, "link": "https://stackoverflow.com/questions/28585279/how-to-add-value-to-combobox-from-column/28586564#28586564", "title": "How to add value to combobox from column?", "body": "<p>You can add the items during the <code>DropButtonClick</code> event, which fires when the users clicks the drop down button.</p>\n\n<p>For example:</p>\n\n<pre><code>Private Sub ComboBox21_DropButtonClick()\n    Me.ComboBox21.ListFillRange = \"Sheet2!B10:B16\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64, "user_id": 4334292, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-vmEQOoOmV8Q/AAAAAAAAAAI/AAAAAAAAACU/33PdJqKjobo/photo.jpg?sz=128", "display_name": "Senem Yurtcu", "link": "https://stackoverflow.com/users/4334292/senem-yurtcu"}, "edited": false, "score": 0, "creation_date": 1424331859, "post_id": 28586766, "comment_id": 45507509, "body": "I write this but I get error fourth line.                                                      <code>Private Sub ComboBoxTetiklenenEvent_DropButtonClick() With Sheet2.ComboBoxTetiklenenEvent     .Clear     For Each r In Sheets(&quot;Sheet2&quot;).Range(&quot;B10:B16&quot;)         .AddItem r.Value     Next r End With End Sub</code>  Fourth line is: <code>For Each r In Sheets(&quot;Sheet2&quot;).Range(&quot;B10:B16&quot;)</code>"}, {"owner": {"reputation": 313, "user_id": 4575440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/50966cef93d7998fa8ef97ac89835110?s=128&d=identicon&r=PG&f=1", "display_name": "joelc", "link": "https://stackoverflow.com/users/4575440/joelc"}, "reply_to_user": {"reputation": 64, "user_id": 4334292, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-vmEQOoOmV8Q/AAAAAAAAAAI/AAAAAAAAACU/33PdJqKjobo/photo.jpg?sz=128", "display_name": "Senem Yurtcu", "link": "https://stackoverflow.com/users/4334292/senem-yurtcu"}, "edited": false, "score": 0, "creation_date": 1424338753, "post_id": 28586766, "comment_id": 45510926, "body": "What is the name of sheet 2 alternatively use <code>Sheet2.Range(&quot;B10:B16&quot;)</code>"}], "tags": [], "owner": {"reputation": 313, "user_id": 4575440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/50966cef93d7998fa8ef97ac89835110?s=128&d=identicon&r=PG&f=1", "display_name": "joelc", "link": "https://stackoverflow.com/users/4575440/joelc"}, "is_accepted": false, "score": 1, "last_activity_date": 1424271823, "creation_date": 1424271823, "answer_id": 28586766, "question_id": 28585279, "link": "https://stackoverflow.com/questions/28585279/how-to-add-value-to-combobox-from-column/28586766#28586766", "title": "How to add value to combobox from column?", "body": "<p>If you remove the <code>.Clear</code> method it should work. The reason it is erroring is the <code>.Clear</code> is used to clear manually added items. Therefore, changing the <code>.ListFillRange</code> will be sufficient.</p>\n\n<p>However you could use this if you really want to use the <code>.Clear</code> method:</p>\n\n<p><code>With Sheet2.ComboBoxTetiklenenEvent\n    .Clear\n    For Each r In Sheets(\"Sheet2\").Range(\"B10:B16\")\n        .AddItem r.Value\n    Next r\nEnd With</code></p>\n"}, {"tags": [], "owner": {"reputation": 64, "user_id": 4334292, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-vmEQOoOmV8Q/AAAAAAAAAAI/AAAAAAAAACU/33PdJqKjobo/photo.jpg?sz=128", "display_name": "Senem Yurtcu", "link": "https://stackoverflow.com/users/4334292/senem-yurtcu"}, "is_accepted": false, "score": 0, "last_activity_date": 1424332638, "creation_date": 1424332638, "answer_id": 28601142, "question_id": 28585279, "link": "https://stackoverflow.com/questions/28585279/how-to-add-value-to-combobox-from-column/28601142#28601142", "title": "How to add value to combobox from column?", "body": "<p>Thank you @joelc and @user3561813.. </p>\n\n<p>I solved my problem. I renamed my 'sheet2' to 'components'. I used 'sheet2' in macro everytime. I changed it and solved that.</p>\n"}], "owner": {"reputation": 64, "user_id": 4334292, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-vmEQOoOmV8Q/AAAAAAAAAAI/AAAAAAAAACU/33PdJqKjobo/photo.jpg?sz=128", "display_name": "Senem Yurtcu", "link": "https://stackoverflow.com/users/4334292/senem-yurtcu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3693, "favorite_count": 0, "accepted_answer_id": 28586564, "answer_count": 3, "score": 0, "last_activity_date": 1453842245, "creation_date": 1424267436, "last_edit_date": 1453842245, "question_id": 28585279, "link": "https://stackoverflow.com/questions/28585279/how-to-add-value-to-combobox-from-column", "title": "How to add value to combobox from column?", "body": "<p>I want to set some data to combobox. This code block doesn't work in <code>Sub Auto_Open()</code>. How to solve this problem? What can I do?</p>\n\n<pre><code>With Sheet2.ComboBoxTetiklenenEvent\n.Clear\n.ListFillRange = \"Sheet2!B10:B16\"\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "merge", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "edited": false, "score": 0, "creation_date": 1424331866, "post_id": 28587475, "comment_id": 45507514, "body": "Thank you for the answer, after executing I have understood that I am able to execute mail merge all in one file, but my requirement is to generate individual letters for each employee. As I have to provide Individual letter to more than 500 Employees hence need a updated macro when I input the data into my excel Data file and run a macro button all the mail-merged data will be saved automatically both in PDF and Doc for individual employee, example If I run a macro for 500 Employees I should have 500 individual files merged with their data only &amp; save with their respective Names. Please help"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "edited": false, "score": 0, "creation_date": 1424358406, "post_id": 28587475, "comment_id": 45523169, "body": "Hema, The answer that I provided fixes your issues.  Please read it more closely."}, {"owner": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "edited": false, "score": 0, "creation_date": 1424453401, "post_id": 28587475, "comment_id": 45569498, "body": "Dear OpiesDad My Apologies, as you said yes this code is working great for me only problem is &quot;EmployeeName = .EmployeeName &#39;Assuming this is the field name&quot; showing error I am unable to save the file on each individual name. Please advise."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "edited": false, "score": 0, "creation_date": 1424453961, "post_id": 28587475, "comment_id": 45569816, "body": "You need to put whatever the column name is that is in the excel file. So if in the &quot;Data&quot; sheet, the column heading for the Employee Name is &quot;EmpName&quot;, then the line needs to be:     &quot;EmployeeName = .EmpName&quot;"}, {"owner": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "edited": false, "score": 0, "creation_date": 1424454840, "post_id": 28587475, "comment_id": 45570282, "body": "My Column Heading is EmployeeName hence added the line as it is &quot;EmployeeName = .EmployeeName&quot; still getting error &quot;Complie Error: syntax error&quot; and highlighting this line. I know I am bugging you on this but serious require your help. Thank you sooooo much. :-)"}, {"owner": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "edited": false, "score": 0, "creation_date": 1424455451, "post_id": 28587475, "comment_id": 45570600, "body": "Also If I just add EmployeeName=&quot;.EmployeeName&quot; then it is saving only one file (for the first row info) and then throwing a Run-time error &#39;91&#39;: Object Variable or with block variable not set. I think this is because there is already a file name as &quot;Offer Letter - .EmployeeName.docx&quot;"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "edited": false, "score": 0, "creation_date": 1424456866, "post_id": 28587475, "comment_id": 45571313, "body": "Oh, I see the problem.  There shouldn&#39;t be any quotes and this line needs to be within the &quot;With&quot; statement.  See above edit showing the end of the With statement."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "edited": false, "score": 0, "creation_date": 1424457302, "post_id": 28587475, "comment_id": 45571533, "body": "I&#39;m having a hard time editing the post, but the code should be &quot;With .DataSource &lt;cr&gt; .FirstRecord = r - 1 &lt;cr&gt; .LastRecord = r-1 &lt;cr&gt; .ActiveRecord = r-1 &lt;cr&gt; EmployeeName = .EmployeeName &lt;cr&gt; End With&quot; where &lt;cr&gt; stands for a newline."}, {"owner": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "edited": false, "score": 0, "creation_date": 1424675726, "post_id": 28587475, "comment_id": 45631321, "body": "Hi OpiesDad thank you for all the help I have tried to execute using the above changes but couldn&#39;t succeed. The major problem encountered is I am unable to run bulk files in one mail merge. When executing more than one mail-merge encountering Runtime Error: 91 (Object variable or with block variable not set) and highlighting the statement &quot;With objMMMD.MailMerge  &#39;With ActiveDocument.MailMerge&quot;. Please do advise."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "edited": false, "score": 0, "creation_date": 1424702818, "post_id": 28587475, "comment_id": 45646017, "body": "You need to put the &quot;set objMMMD = Nothing&quot; line OUTSIDE of the for loop.  Otherwise you no longer have a reference to the  open word document in the second loop.  Similarly, the &quot;objword.quit&quot; line needs to be outside of the loop or the file and Word will no longer be open."}, {"owner": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "edited": false, "score": 0, "creation_date": 1425013926, "post_id": 28587475, "comment_id": 45796532, "body": "Sadly this didn&#39;t work OpiesDad I have implemented the same but some how is it is showing the same Runtime Error: 91. Don&#39;t know what is wrong."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 5, "last_activity_date": 1481739906, "last_edit_date": 1481739906, "creation_date": 1424273865, "answer_id": 28587475, "question_id": 28585226, "link": "https://stackoverflow.com/questions/28585226/automating-mail-merge-using-excel-vba/28587475#28587475", "title": "Automating Mail Merge using Excel VBA", "body": "<p>To save the file in pdf format use  </p>\n\n<pre><code>objWord.ActiveDocument.ExportAsFixedFormat cDir &amp; NewFileName, _\n                  ExportFormat:=wdExportFormatPDF\n</code></pre>\n\n<p>It looks to me that when you are executing the mail merge, it should create a file with ALL of the letters, so when you open it, it would appear that the first letter is the one that is getting saved, but if you scroll down the word file that you have saved, you may find each letter on a new page.</p>\n\n<p>Instead, you want to execute the merge one letter at a time.<br>\nTo fix this, change the lines as follows: </p>\n\n<pre><code>With .DataSource\n  .FirstRecord = r-1\n  .LastRecord = r-1\n  .ActiveRecord = r-1\n</code></pre>\n\n<p>You need to use <code>r-1</code> because Word is going to use the record number in its dataset, and since the data starts in row 2, and the counter <code>r</code> is related to the row, you need <code>r-1</code>.</p>\n\n<p>You don't need to open up word each time, so put all of the code setting the datasource of the mail merge and creating the word doc outside of your main loop.</p>\n\n<pre><code>Const WTempName = \"letter.docx\" 'This is the 07/10 Word Templates name,  \nDim NewFileName As String\n\n' Setup directories\ncDir = ActiveWorkbook.path + \"\\\" 'Change if appropriate\nThisFileName = ThisWorkbook.Name\n\nOn Error Resume Next\n\n' Create a Word Application instance\nbCreatedWordInstance = False\nSet objWord = GetObject(, \"Word.Application\")\n\nIf objWord Is Nothing Then\n  Err.Clear\n  Set objWord = CreateObject(\"Word.Application\")\n  bCreatedWordInstance = True\nEnd If\n\nIf objWord Is Nothing Then\n    MsgBox \"Could not start Word\"\n    Err.Clear\n    On Error GoTo 0\n    Exit Sub\nEnd If\n\n' Let Word trap the errors\nOn Error GoTo 0\n\n' Set to True if you want to see the Word Doc flash past during construction\nobjWord.Visible = False\n\n'Open Word Template\nSet objMMMD = objWord.Documents.Open(cDir + WTempName)\nobjMMMD.Activate\n\n'Merge the data\nWith objMMMD\n.MailMerge.OpenDataSource Name:=cDir + ThisFileName, _\n    sqlstatement:=\"SELECT *  FROM `Data$`\"   ' Set this as required\n\nFor r = 2 To lastrow\n    If Cells(r, 7).Value = \"Letter Generated Already\" Then GoTo nextrow\n'rest of code goes here\n</code></pre>\n\n<p>Also, instead of checking the Excel file for the Employee name to create the file name, you could do this after you merge the document.  For me, this is a little more intuitive to link the file name to the letter you have just merged.  To do this update the line further to:</p>\n\n<pre><code>With .DataSource\n  .FirstRecord = r-1\n  .LastRecord = r-1\n  .ActiveRecord = r-1\n  EmployeeName = .EmployeeName 'Assuming this is the field name\n</code></pre>\n\n<p>Then immediately before saving the file you can do this:</p>\n\n<pre><code> ' Save new file\nNewFileName = \"Offer Letter - \" &amp; EmployeeName &amp; \".docx\"\nobjWord.ActiveDocument.SaveAs cDir + NewFileName\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 21, "user_id": 4574429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca1f3fe627354692331d785deca1ec?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/4574429/hema"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35291, "favorite_count": 5, "answer_count": 1, "score": 2, "last_activity_date": 1576911556, "creation_date": 1424267289, "last_edit_date": 1576911556, "question_id": 28585226, "link": "https://stackoverflow.com/questions/28585226/automating-mail-merge-using-excel-vba", "title": "Automating Mail Merge using Excel VBA", "body": "<p>I created a macro in Excel where I can mail-merge data from Excel into Word Letter Template and save the individual files in the folder.</p>\n\n<p>I have Employee data in Excel and I can generate any Employee letter using that Data and can save the individual Employee letter as per the Employee name.</p>\n\n<p>I have run mail-merge automatically and save individual files as per the Employee name. And every time it runs the file for one person it will give the status as Letter Already Generate so that it wont duplicate any Employee records.</p>\n\n<p>The problem is the output in all the merged files the output is same as the first row. Example: if my Excel has 5 Employee details I am able to save the 5 individual merged files on each employee name, however the merged data if of the first employee who is in Row 2.</p>\n\n<p>My rows have the below data:</p>\n\n<blockquote>\n  <p>Row A: has S.No.<br>\n  Row B: has Empl Name<br>\n  Row C: has Processing Date<br>\n  Row D: has Address<br>\n  Row E: Firstname<br>\n  Row F: Business Title<br>\n  Row G: Shows the status (if the letter is generated it shows \"Letter Generated Already\" after running the macro or it shows blank if it is new record entered.</p>\n</blockquote>\n\n<p>Also how can I save the output (merged file) also in PDF other than DOC file so the merged files will be in two formats one in DOC and the other one in PDF formats?</p>\n\n<pre><code>Sub MergeMe()\n\nDim bCreatedWordInstance As Boolean\nDim objWord As Word.Application\nDim objMMMD As Word.Document\nDim EmployeeName As String\nDim cDir As String\nDim r As Long\nDim ThisFileName As String\nlastrow = Sheets(\"Data\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nr = 2\nFor r = 2 To lastrow\nIf Cells(r, 7).Value = \"Letter Generated Already\" Then GoTo nextrow\nEmployeeName = Sheets(\"Data\").Cells(r, 2).Value\n\n' Setup filenames\nConst WTempName = \"letter.docx\" 'This is the 07/10 Word Templates name,  Change as req'd\nDim NewFileName As String\nNewFileName = \"Offer Letter - \" &amp; EmployeeName &amp; \".docx\" 'This is the New 07/10 Word Documents File Name, Change as req'd\"\n\n' Setup directories\ncDir = ActiveWorkbook.path + \"\\\" 'Change if appropriate\nThisFileName = ThisWorkbook.Name\n\nOn Error Resume Next\n\n' Create a Word Application instance\nbCreatedWordInstance = False\nSet objWord = GetObject(, \"Word.Application\")\n\nIf objWord Is Nothing Then\n  Err.Clear\n  Set objWord = CreateObject(\"Word.Application\")\n  bCreatedWordInstance = True\nEnd If\n\nIf objWord Is Nothing Then\nMsgBox \"Could not start Word\"\nErr.Clear\nOn Error GoTo 0\nExit Sub\nEnd If\n\n' Let Word trap the errors\nOn Error GoTo 0\n\n' Set to True if you want to see the Word Doc flash past during construction\nobjWord.Visible = False\n\n'Open Word Template\nSet objMMMD = objWord.Documents.Open(cDir + WTempName)\nobjMMMD.Activate\n\n'Merge the data\nWith objMMMD\n.MailMerge.OpenDataSource Name:=cDir + ThisFileName, sqlstatement:=\"SELECT *  FROM `Data$`\"   ' Set this as required\n\nWith objMMMD.MailMerge  'With ActiveDocument.MailMerge\n.Destination = wdSendToNewDocument\n.SuppressBlankLines = True\nWith .DataSource\n  .FirstRecord = wdDefaultFirstRecord\n  .LastRecord = wdDefaultLastRecord\nEnd With\n.Execute Pause:=False\nEnd With\nEnd With\n\n' Save new file\nobjWord.ActiveDocument.SaveAs cDir + NewFileName\n\n' Close the Mail Merge Main Document\nobjMMMD.Close savechanges:=wdDoNotSaveChanges\nSet objMMMD = Nothing\n\n' Close the New Mail Merged Document\nIf bCreatedWordInstance Then\nobjWord.Quit\nEnd If\n\n0:\nSet objWord = Nothing\nCells(r, 7).Value = \"Letter Generated Already\"\nnextrow:\n\nNext r\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 1, "creation_date": 1424267217, "post_id": 28585132, "comment_id": 45477600, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/5559279/excel-cell-from-which-a-function-is-called\">Excel cell from which a Function is called</a>"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1424267209, "creation_date": 1424267209, "answer_id": 28585205, "question_id": 28585132, "link": "https://stackoverflow.com/questions/28585132/how-a-excel-vba-macro-can-know-on-which-cell-it-is-called/28585205#28585205", "title": "How a Excel VBA macro can know on which cell it is called", "body": "<p><code>Application.Caller</code> will return the range that the function is entered into. If the formula is array-entered into multiple cells, it will return the entire range containing the array. If you only want the individual cell containing the formula you can use <code>Application.ThisCell</code>.</p>\n"}], "owner": {"reputation": 211, "user_id": 3222563, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4977535359085640ab60fe74c8cdea61?s=128&d=identicon&r=PG&f=1", "display_name": "JayMore", "link": "https://stackoverflow.com/users/3222563/jaymore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 608, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1424272591, "creation_date": 1424266994, "last_edit_date": 1424272591, "question_id": 28585132, "link": "https://stackoverflow.com/questions/28585132/how-a-excel-vba-macro-can-know-on-which-cell-it-is-called", "title": "How a Excel VBA macro can know on which cell it is called", "body": "<p>I have a custom macro function, declared in a Module :</p>\n\n<pre><code>Function myMacro(value as String) as String   \n    myMacro = \"Hello world \" &amp; value \nEnd Function\n</code></pre>\n\n<p>This macro is inserted in a cell (A1 for example) and take the value of B2 as parameter.</p>\n\n<pre><code>Fx(A1 cell) = \"MyMacro(B2)\"\n</code></pre>\n\n<p>So my MyMacro func is triggered each time the value in B2 is changed, which is normal and is exactly what I want.</p>\n\n<p>But i want to improve my macro to be more user friendly because my macro can take a long time (3 or 4 seconds) to execute. I want my macro to display \"computing...\" inside the resulting cell, before the real result is displayed.</p>\n\n<p>To do that, my macro have to know on wich cell the compute is done. In the previous example, my macro need to know that the macro is triggered on the A1 cell.</p>\n\n<p>The Application.Cell attrib contain the current cell (the one selected with the mouse), which is not always the cell containg the macro formula.</p>\n\n<p>Is there a way for a VBA function to know which cell call the function ?</p>\n"}, {"tags": ["forms", "date", "excel", "vba"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 3, "creation_date": 1424266611, "post_id": 28584907, "comment_id": 45477210, "body": "Is this for a textbox on a userform? If so you&#39;d put something like <code>Private Sub UserForm_Initialize()   Me.TextBox1 = Date End Sub</code> in the forms code."}, {"owner": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1424267204, "post_id": 28584907, "comment_id": 45477588, "body": "Thanks for this however it still doesn\u2019t update the date each time I submit the form"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1424267465, "post_id": 28584907, "comment_id": 45477778, "body": "What kind of button do you use? Does it call a macro? Where is the date you want to change located?"}, {"owner": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1424267776, "post_id": 28584907, "comment_id": 45477985, "body": "I have a submit button which is a command button, no this part of my code doesnt link back to a macro only the initial opening of the form is linked to a macro and the date I would like to change is located at the bottom of my userform in a textbox...do you need me to supply any of the code I currently have?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1424268213, "post_id": 28584907, "comment_id": 45478269, "body": "Then I suppose you have some code inside of a procedure called something like <code>Private Sub CommandButton1_Click()</code>, which decides what happens when you push the submit button? Insert the line <code>Me.TextBox1 = Date</code> into that procedure, and I think it should do what you want."}, {"owner": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1424268474, "post_id": 28584907, "comment_id": 45478429, "body": "That worked thankyou very much for all your help! :)"}], "answers": [{"comments": [{"owner": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "edited": false, "score": 0, "creation_date": 1424267362, "post_id": 28585069, "comment_id": 45477707, "body": "Thanks for the link that should come in very handy. I have created this within a userform however I cant get the date to work so I tried putting it out on the main user form template to see if it would make a difference. I seem to be getting an error with the code you suggested based on the Project part"}, {"owner": {"reputation": 3159, "user_id": 4450134, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0207987892f359cb7d9b56e8aa4fc75c?s=128&d=identicon&r=PG&f=1", "display_name": "HavelTheGreat", "link": "https://stackoverflow.com/users/4450134/havelthegreat"}, "reply_to_user": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "edited": false, "score": 0, "creation_date": 1424267641, "post_id": 28585069, "comment_id": 45477903, "body": "Well yes, you need to replace <code>Project.MyTxtBox</code> with whatever your respective UserForm and textbox are named. That part is arbitrary."}, {"owner": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "edited": false, "score": 0, "creation_date": 1424267940, "post_id": 28585069, "comment_id": 45478093, "body": "Sorry forgot to update the project name..I tired that but its only populating the first submit again"}, {"owner": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "edited": false, "score": 0, "creation_date": 1424268596, "post_id": 28585069, "comment_id": 45478502, "body": "I was able to add it in as a single line after my add command <code>Private Sub cmdAdd_Click()  BSPersonalData.txtdatecompleted = Date</code> and it seems to be working fine now. Thankyou for all your help!"}], "tags": [], "owner": {"reputation": 3159, "user_id": 4450134, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0207987892f359cb7d9b56e8aa4fc75c?s=128&d=identicon&r=PG&f=1", "display_name": "HavelTheGreat", "link": "https://stackoverflow.com/users/4450134/havelthegreat"}, "is_accepted": true, "score": 1, "last_activity_date": 1424268358, "last_edit_date": 1424268358, "creation_date": 1424266846, "answer_id": 28585069, "question_id": 28584907, "link": "https://stackoverflow.com/questions/28584907/date-in-vba-form/28585069#28585069", "title": "Date in VBA form", "body": "<p>Once again, I would recommend using a UserForm! Then in the code for that form, you can simply insert:</p>\n\n<pre><code>Private Sub UserForm_Initialize() Project.MyTxtBox = Date End Sub\n</code></pre>\n\n<p>I would recommend <a href=\"http://www.excel-easy.com/vba/userform.html\" rel=\"nofollow\"> this </a> resource for learning more about the possibilities of UserForms. </p>\n\n<p><strong>Edit</strong>: If you want to populate on the <code>Submit</code> button, you must find the initialization procedure for the click on that button. It will end in ..<code>_Click()</code>. Within that procedure you will have to add <code>Project.MyTxtBox = Date</code> and you should be good to go. </p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 2584755, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c518d74d91e2c8e77703b0175c335e74?s=128&d=identicon&r=PG", "display_name": "TEC C", "link": "https://stackoverflow.com/users/2584755/tec-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1424267075, "creation_date": 1424267075, "answer_id": 28585165, "question_id": 28584907, "link": "https://stackoverflow.com/questions/28584907/date-in-vba-form/28585165#28585165", "title": "Date in VBA form", "body": "<p>If your looking for this in VBA you would select your Developer tab, click on Visual Basic, create a new method, then paste this code in.</p>\n\n<pre><code>    Sub tDate()\nRange(\"A1\") = Date\nEnd Sub\n</code></pre>\n\n<p>after that link the button to the macro you just created. Every time the macro runs it will give you the current date.</p>\n"}], "owner": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1058, "favorite_count": 0, "accepted_answer_id": 28585069, "answer_count": 2, "score": 0, "last_activity_date": 1424268358, "creation_date": 1424266355, "last_edit_date": 1531164843, "question_id": 28584907, "link": "https://stackoverflow.com/questions/28584907/date-in-vba-form", "title": "Date in VBA form", "body": "<p>On my excel form I would like for my date to auto populate with today's date, I tried using the <code>=Today()</code> function but when I submitted after filling out the form it only appears to update it once.I need it to work each time I press the submit button. Any help/advice anyone could give would be greatly appreciated.</p>\n\n<p>Many Thanks\nPaula </p>\n"}, {"tags": ["vba", "excel", "ms-office", "ole"], "comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1424266183, "post_id": 28584563, "comment_id": 45476903, "body": "At first sight, all your issues come from your code. I&#39;d suggest revisiting the code. Or, if you want to get a valuable feedback specify what code you use for getting the job done."}, {"owner": {"reputation": 3293, "user_id": 2070674, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/a4oME.png?s=128&g=1", "display_name": "Oliver Busse", "link": "https://stackoverflow.com/users/2070674/oliver-busse"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1424266371, "post_id": 28584563, "comment_id": 45477034, "body": "What code you mean? The process when creating the OLE object?"}], "answers": [{"tags": [], "owner": {"reputation": 3293, "user_id": 2070674, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/a4oME.png?s=128&g=1", "display_name": "Oliver Busse", "link": "https://stackoverflow.com/users/2070674/oliver-busse"}, "is_accepted": false, "score": 1, "last_activity_date": 1424266981, "creation_date": 1424266981, "answer_id": 28585124, "question_id": 28584563, "link": "https://stackoverflow.com/questions/28584563/a-copy-of-excel-addin-is-created-in-my-documents-after-saving/28585124#28585124", "title": "A copy of Excel Addin is created in My Documents after saving", "body": "<p>I noticed that</p>\n\n<pre><code>ThisWorkbook.Save\n</code></pre>\n\n<p>was the reason. If I omit it no file is created. Strange that this saved the Addin file as xlsm file though.</p>\n"}], "owner": {"reputation": 3293, "user_id": 2070674, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/a4oME.png?s=128&g=1", "display_name": "Oliver Busse", "link": "https://stackoverflow.com/users/2070674/oliver-busse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1424266981, "creation_date": 1424265341, "last_edit_date": 1531164843, "question_id": 28584563, "link": "https://stackoverflow.com/questions/28584563/a-copy-of-excel-addin-is-created-in-my-documents-after-saving", "title": "A copy of Excel Addin is created in My Documents after saving", "body": "<p>I have an application (running in IBM Notes, using Lotusscript etc.) that create a new Excel object via OLE automation. In my app I create a new Workbook and saving it to a temporary folder (I am saving it as Excel Worksheet w/o macros -> type 52) so that the resuting file is sth. like that: </p>\n\n<pre><code>tmp_abc1234.xlsx\n</code></pre>\n\n<p>Then I open the file in Excel programmatically. I have an Excel Addin (filename is \"Teamoffice.xlam\" loaded where some macros reside I will trigger in the custom save actionbar button. In this save method I also call the save function:</p>\n\n<pre><code>Call ActiveWorkbook.Save\nCall ThisWorkbook.Save\n</code></pre>\n\n<p>For some reason Excel creates a file named \"Teamoffice.xlsm\" in the \"My Documents\" folder. The file itself cannot be opened in Excel (\"wrong file format error\") - of course, it's an Addin!</p>\n\n<p>This works well if I have only one Excel document open from my application. If I open a second (or more) I run into trouble: everytime I save on of those secondary opened (or newly created) documents Excel asks me if I want to overwrite that \"Teamoffice.xlsm\" file.</p>\n\n<p>I added VBA code to ma macro that detects if this file is there and tries to delete it. With no luck of course, as the first instance of Excel is locking that file already. Overwriting the file when aswering the Excel-question dialog works though, but I don't want that question to appear.</p>\n\n<p>Excel doesn't behave like that when using it stand-alone w/o OLE.</p>\n\n<p>Several questions resulting from this behavior:</p>\n\n<ol>\n<li>Why does Excel create this file? Can I stop it from doing so?</li>\n<li>How can I delete the file even if Excel has a handle on it or</li>\n<li>Can I tell Excel not tohave a handle on this file (if it's there) and let me kill it?</li>\n<li>Can I suppress the question dialog and always say \"yes, overwrite it\"?</li>\n</ol>\n\n<p>Office version is 2010 - and it makes me going nuts... so thanks in advance!\np.s.: I am not that VBA pro, so please be as detailed as you can effort :-)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1424265032, "post_id": 28584261, "comment_id": 45476196, "body": "The screenshot in your question doesn&#39;t do a lot (if anything) to help explain your problem. Have you tried stepping through the code manually (add a breakpoint before the problematic code and then execute it line-by-line by pressing F8)? It sounds like <code>IsEmpty(ActiveCell)</code> is always evaluating to False and thus your <code>Case True</code> is never being executed. Stepping through the code should be able to confirm or deny this."}, {"owner": {"reputation": 93, "user_id": 3506071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/370ca761e6b2e757bbc4f5d6f66cc2d4?s=128&d=identicon&r=PG&f=1", "display_name": "qcp", "link": "https://stackoverflow.com/users/3506071/qcp"}, "reply_to_user": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1424266376, "post_id": 28584261, "comment_id": 45477038, "body": "As you said: IsEmpty(ActiveCell) is always evaluating to False and thus  Case True is never executed. TO be honest I do not really know how to solve this..."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 3506071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/370ca761e6b2e757bbc4f5d6f66cc2d4?s=128&d=identicon&r=PG&f=1", "display_name": "qcp", "link": "https://stackoverflow.com/users/3506071/qcp"}, "edited": false, "score": 0, "creation_date": 1424693091, "post_id": 28586071, "comment_id": 45640112, "body": "Hi Aiken, that is exactly what I need, that is the idea. So you mean instead Range(&quot;A4&quot;).Offset(1,0) in my code above i should put just:  Range(&quot;A:A&quot;).SpecialCells(xlCellTypeVisible).Cells(5, 1).Activate ? And that is the only change, yep? Because that is what I did and it still reads the whole code as before... but at least there is no error messages as for now."}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "reply_to_user": {"reputation": 93, "user_id": 3506071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/370ca761e6b2e757bbc4f5d6f66cc2d4?s=128&d=identicon&r=PG&f=1", "display_name": "qcp", "link": "https://stackoverflow.com/users/3506071/qcp"}, "edited": false, "score": 0, "creation_date": 1424694206, "post_id": 28586071, "comment_id": 45640711, "body": "@user3506071 I did a little testing and the edited line of code in my answer should work."}], "tags": [], "owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "is_accepted": false, "score": 0, "last_activity_date": 1424694175, "last_edit_date": 1424694175, "creation_date": 1424269730, "answer_id": 28586071, "question_id": 28584261, "link": "https://stackoverflow.com/questions/28584261/excel-2007-vba-autofiltr-select-case-isempty-vs-copying/28586071#28586071", "title": "Excel 2007 VBA Autofiltr: Select Case IsEmpty vs Copying", "body": "<p>The issue here is that AutoFilter doesn't make rows non-existent, it simply hides them. Regardless of whether a filter has been applied <code>Range(\"A4\").Offset(1,0)</code> will always refer to cell A5 so if there's a value in A5 then <code>IsEmpty(ActiveCell)</code> will always return false.</p>\n\n<p>To solve this problem you're going to have to use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow\">SpecialCells</a> method of the Range object. The below code will activate the 1st visible cell in column A that's below cell A4, in your case the first row of results after filtering.</p>\n\n<pre><code>Range(\"A5:A\" &amp; ActiveSheet.Rows.Count).SpecialCells(xlCellTypeVisible).Cells(1, 1).Activate\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 3506071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/370ca761e6b2e757bbc4f5d6f66cc2d4?s=128&d=identicon&r=PG&f=1", "display_name": "qcp", "link": "https://stackoverflow.com/users/3506071/qcp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424694175, "creation_date": 1424264306, "question_id": 28584261, "link": "https://stackoverflow.com/questions/28584261/excel-2007-vba-autofiltr-select-case-isempty-vs-copying", "title": "Excel 2007 VBA Autofiltr: Select Case IsEmpty vs Copying", "body": "<p>I am struggling with my macro. </p>\n\n<p>GOAL &amp; MAIN IDEA:\nIt opens different xls files, based on Autofilter it checks 10th column to choose the rows with four \"last-friday-days\" (so if we have 18/02 it returns 13/02, 06/02, 30/01, 23/01.)</p>\n\n<p>PROBLEM:\nProblem is only when in my file there are no dates like aboves.Even though the file should be closed automatically it try to copying empty range!! I use Select Case (code below)</p>\n\n<p><img src=\"https://i.stack.imgur.com/gipN4.jpg\" alt=\"empty selection but it is still copying\"></p>\n\n<p>CODE:</p>\n\n<pre><code> Rows(\"4:4\").Select '*Autofilter - this part is ok*\n Selection.AutoFilter *' four last-Fridays from the Column - ok*\n ActiveSheet.Range(\"J5\", Range(\"J5\").End(xlDown)).AutoFilter Field:=10, Criteria1:=Array( _\n    LastFridayDate, Friday2weeksagoDate, Friday3weeksagoDate, Friday4weeksagoDate), Operator:= _\n       xlFilterValues\n\nRange(\"A4\").Offset(1, 0).Activate\n  Select Case IsEmpty(ActiveCell) ' *MISTAKE!!* \n    Case True MISTAKE!! *no data in file, file should be closed!*\n        Workbooks(\"prima UKACZEE.xls\").Close SaveChanges:=False\n    Case Else ' *this part always works*\n        Range(\"A5\", Range(\"A5\").End(xlDown).End(xlToRight)).Select\n        Selection.Copy\n        Workbooks(\"Makro XXX Claim Hours v.01.xls\").Sheets(\"TRN Claim Report - Labour\").Activate\n        Range(\"A5\").End(xlDown).Offset(1, 0).Activate\n        ActiveSheet.Paste\n\n    Application.DisplayAlerts = False *' closing file - ok*\n    Workbooks(\"prima UKACZEE.xls\").Close SaveChanges:=False\n    Application.DisplayAlerts = True\nEnd Select\n</code></pre>\n\n<p>If you could help. Appreciate</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 4550243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdcda557a8b3f5af363abfa7526c794f?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/4550243/jonas"}, "reply_to_user": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 0, "creation_date": 1424265011, "post_id": 28584253, "comment_id": 45476184, "body": "Well, to be perfectly honest with you this issue is way out of my league to solve and i have not done that much about it since i dont know where to start. Like i said in the post, any help along the way would be deeply appreciated (and i have searched this and other forums for solutions)"}, {"owner": {"reputation": 862, "user_id": 3454860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d8d587bb86f0014ebfb3c1f208f074?s=128&d=identicon&r=PG&f=1", "display_name": "Han Soalone", "link": "https://stackoverflow.com/users/3454860/han-soalone"}, "edited": false, "score": 2, "creation_date": 1424266294, "post_id": 28584253, "comment_id": 45476979, "body": "Your question is too broad to answer in this forum, and would require someone to code &quot;for you&quot;. That is not what this forum is based upon. We can help, but you have to define specific problem in your code for us to be able to help. Note also that you can do what you want without using vba at all by using default excel formulas, if you are not familiar with vba, I&#39;d suggest experimenting with <code>IF</code> and <code>VLOOKUP</code> formulas."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1424267135, "post_id": 28584253, "comment_id": 45477557, "body": "Is the <i>clearing</i> number always 4 digits long?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4550243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdcda557a8b3f5af363abfa7526c794f?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/4550243/jonas"}, "edited": false, "score": 0, "creation_date": 1424339227, "post_id": 28585126, "comment_id": 45511250, "body": "Hi Gary&#39;s Student, thank you for this, even if it&#39;s not exactly what i needed it&#39;s a big help. The problem is (and as usual) user-related, since some users enter the full clearing number of the range including the 9, and some dont. But i understand your formula and i will try to fix the rest myself, i need to learn this at some point anyway :). Thank you!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1424266987, "creation_date": 1424266987, "answer_id": 28585126, "question_id": 28584253, "link": "https://stackoverflow.com/questions/28584253/manipulate-numbers-in-a-specific-range/28585126#28585126", "title": "Manipulate numbers in a specific range", "body": "<p><strong>Without VBA</strong></p>\n\n<p>Put the clearing number in <strong>A1</strong> and the account number in <strong>B1</strong>; then in <strong>C1</strong> enter:</p>\n\n<pre><code>=A1&amp;IF(AND(A1&lt;=8400,A1&gt;=8300),9,\"\")\n</code></pre>\n\n<p>and in <strong>D1</strong> enter:</p>\n\n<pre><code>=B1 &amp; REPT(\"0\",15-LEN(B1)-LEN(C1)) &amp; C1\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/g8qhK.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 11, "user_id": 4550243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdcda557a8b3f5af363abfa7526c794f?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/4550243/jonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1424400229, "accepted_answer_id": 28585126, "answer_count": 1, "score": -2, "last_activity_date": 1424266987, "creation_date": 1424264285, "last_edit_date": 1531161705, "question_id": 28584253, "link": "https://stackoverflow.com/questions/28584253/manipulate-numbers-in-a-specific-range", "closed_reason": "Needs more focus", "title": "Manipulate numbers in a specific range", "body": "<p>My core problem is to manipulate account numbers written in different ways to be formatted in the same way. The account numbers consists of a clearing number and an account number. For example:</p>\n\n<p>The written account number is: Clearing 8357, and account number is 1234567.</p>\n\n<p>First of all, the code needs to identify that 8357 is the range 8300-8400. This means that the code should add a \"9\" between the clearing number and the account number. In some ranges there are no 9 at all and the clearing should be left as it is. </p>\n\n<p>Second, the account number in total needs to be exactly 15 numbers long, so in our case we need to add zeros between the clearing number and the account number.</p>\n\n<p>In our case the code should change the written account number from 8357 1234567 to \"835790001234567\"</p>\n\n<p>Any help along the way would be deeply appreciated.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 1, "creation_date": 1424262818, "post_id": 28583576, "comment_id": 45474951, "body": "You&#39;ll need to give us more than just a single line of code. As it stands we have no idea what <code>xQuery</code>, <code>strFilePath</code> and <code>xSheet</code> are, this information would be incredibly helpful in providing a correct answer."}, {"owner": {"reputation": 27, "user_id": 2059934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18fc6c1f88683ffc8ca41b029e18afa3?s=128&d=identicon&r=PG", "display_name": "Amr Ali", "link": "https://stackoverflow.com/users/2059934/amr-ali"}, "reply_to_user": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1424265223, "post_id": 28583576, "comment_id": 45476330, "body": "@Aiken I just made an edit to my post to include my code. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 2059934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18fc6c1f88683ffc8ca41b029e18afa3?s=128&d=identicon&r=PG", "display_name": "Amr Ali", "link": "https://stackoverflow.com/users/2059934/amr-ali"}, "edited": false, "score": 0, "creation_date": 1424266444, "post_id": 28584838, "comment_id": 45477088, "body": "thank you. But what if i have a range wider than this preset one ?"}], "tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": false, "score": 0, "last_activity_date": 1424266192, "creation_date": 1424266192, "answer_id": 28584838, "question_id": 28583576, "link": "https://stackoverflow.com/questions/28583576/export-access-query-to-same-sheet-every-time/28584838#28584838", "title": "Export access query to same sheet every time", "body": "<p>I'm guessing the below replacement to your existing code should do the trick</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acExport, 9, xQuery, strPath, True, \"SheetName!A1:Z200\"\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 2059934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18fc6c1f88683ffc8ca41b029e18afa3?s=128&d=identicon&r=PG", "display_name": "Amr Ali", "link": "https://stackoverflow.com/users/2059934/amr-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523798499, "creation_date": 1424262038, "last_edit_date": 1523798499, "question_id": 28583576, "link": "https://stackoverflow.com/questions/28583576/export-access-query-to-same-sheet-every-time", "title": "Export access query to same sheet every time", "body": "<p>I have an \"Excel Binary Workbook\" with named sheets and a MS ACCESS with queries named same as workbook sheets.</p>\n\n<p>For example i have a sheet like \"CustomersData\" and have a query named the same.</p>\n\n<p>My issue is when i run this code, it exports query data to \"CustomersData1\" not \"CustomersData\"</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acExport, 9, xQuery, strFilePath, True, xSheet\n</code></pre>\n\n<p>I was about to write function to delete firstly sheets before exporting data but i have another sheets in the same workbook have references to these sheets.</p>\n\n<p>My Code:</p>\n\n<pre><code>Public Function Export_To_Excel()\nOn Error GoTo Export_To_Excel_Err\n\nDim rs As DAO.Recordset\nDim xQuery As String\nDim strPath As String\nDim i As Long\n\nSet rs = CurrentDb.OpenRecordset(\"SELECT * FROM Export_Specs\")\n\nstrPath = \"D:\\Path\\To\\File.xlsb\"\n\ni = 0\n\nIf Not (rs.EOF And rs.BOF) Then\n        rs.MoveFirst\n    Do Until rs.EOF = True\n            xQuery = rs(\"Query_Name\")\n            DoCmd.TransferSpreadsheet acExport, 9, xQuery, strPath, True\n            i = i + 1\n        rs.MoveNext\n    Loop\nElse\n    MsgBox \"No queries found to export.\", vbCritical, \"Getting Queries\"\nEnd If\n\nMsgBox \"Finished. (\" &amp; i &amp; \") Queries were exported successfully to \" &amp; strPath, vbInformation, \"Exporting Data..\"\n\n\nrs.Close\nSet rs = Nothing\n\nExport_To_Excel_Exit:\n    Exit Function\n\nExport_To_Excel_Err:\n    MsgBox Error$\n    Resume Export_To_Excel_Exit\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31, "user_id": 4439988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6717fabf64f416b35d00a9bb5b77be?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/4439988/dimitri"}, "edited": false, "score": 0, "creation_date": 1424277083, "post_id": 28583113, "comment_id": 45484230, "body": "Found the answer here:    [<a href=\"http://stackoverflow.com/questions/12515896/prompting-user-to-select-text-file-from-get-external-data][1]\" title=\"prompting user to select text file from get external data%5d%5b1%5d\">stackoverflow.com/questions/12515896/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4439988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6717fabf64f416b35d00a9bb5b77be?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/4439988/dimitri"}, "edited": false, "score": 0, "creation_date": 1424275422, "post_id": 28583795, "comment_id": 45483059, "body": "I&#39;m not sure how this fits with my above code. I need to modify rows 5 and 7 so they are variable and dependent on a prompt to open a file."}, {"owner": {"reputation": 356, "user_id": 4568536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-TfMBGHHjwA4/AAAAAAAAAAI/AAAAAAAAKuA/akfD5PTiy0Y/photo.jpg?sz=128", "display_name": "Sergej", "link": "https://stackoverflow.com/users/4568536/sergej"}, "reply_to_user": {"reputation": 31, "user_id": 4439988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6717fabf64f416b35d00a9bb5b77be?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/4439988/dimitri"}, "edited": false, "score": 0, "creation_date": 1424769742, "post_id": 28583795, "comment_id": 45675218, "body": "@Dimitri since it is a working solution and the only answer, however it would be nice to check this answer as a solution..."}], "tags": [], "owner": {"reputation": 356, "user_id": 4568536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-TfMBGHHjwA4/AAAAAAAAAAI/AAAAAAAAKuA/akfD5PTiy0Y/photo.jpg?sz=128", "display_name": "Sergej", "link": "https://stackoverflow.com/users/4568536/sergej"}, "is_accepted": false, "score": 0, "last_activity_date": 1424262803, "creation_date": 1424262803, "answer_id": 28583795, "question_id": 28583113, "link": "https://stackoverflow.com/questions/28583113/macro-to-paste-text-open-file/28583795#28583795", "title": "Macro to paste text open file", "body": "<p>How about this solution from here: <a href=\"http://software-solutions-online.com/2014/03/11/excel-vba-open-file-dialog/\" rel=\"nofollow\">Link</a></p>\n\n<pre><code>Dim intChoice As Integer \nDim strPath As String \n\n'only allow the user to select one file \nApplication.FileDialog(msoFileDialogOpen).AllowMultiSelect = False\n'make the file dialog visible to the user \nintChoice = Application.FileDialog(msoFileDialogOpen).Show\n'determine what choice the user made \nIf intChoice &lt;&gt; 0 Then \n'get the file path selected by the user \nstrPath = Application.FileDialog(msoFileDialogOpen).SelectedItems(1) \n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4439988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6717fabf64f416b35d00a9bb5b77be?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/4439988/dimitri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424262803, "creation_date": 1424260701, "last_edit_date": 1531161705, "question_id": 28583113, "link": "https://stackoverflow.com/questions/28583113/macro-to-paste-text-open-file", "title": "Macro to paste text open file", "body": "<p>I have the below macro that imports External Data From Text, sets the text to column by comma, and sets all columns to text. I'd like to modify the below so it opens a message box, prompts to open a file, and follows the procedure. Right now it's using the file path and name I had recorded from.</p>\n\n<pre><code>Cells.Select\n    Selection.NumberFormat = \"@\"\n    Range(\"A1\").Select\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;C:\\------\\FAC\\FAC010515.txt\", Destination:=Range( _\n        \"$A$1\"))\n        .Name = \"FAC010515\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(2, 2, 2, 2, 2, 2, 2, 2, 2)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 103, "user_id": 4449440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5860034107f022406b75e7d2af42612?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4449440/kai"}, "edited": false, "score": 0, "creation_date": 1424261241, "post_id": 28583065, "comment_id": 45474030, "body": "How to calculate with sheet names as integers? -&gt; Use CInt() | Is this somewaht similar to  <a href=\"http://stackoverflow.com/questions/6202074/vba-convert-string-to-int-if-string-is-a-number\" title=\"vba convert string to int if string is a number\">stackoverflow.com/questions/6202074/&hellip;</a>  ?"}, {"owner": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "reply_to_user": {"reputation": 103, "user_id": 4449440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5860034107f022406b75e7d2af42612?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4449440/kai"}, "edited": false, "score": 0, "creation_date": 1424261446, "post_id": 28583065, "comment_id": 45474155, "body": "No, that would be for cell content. I can&#39;t come up with mathematical solution. I might be able to code it, but I don&#39;t understand the logic."}, {"owner": {"reputation": 103, "user_id": 4449440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5860034107f022406b75e7d2af42612?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4449440/kai"}, "edited": false, "score": 0, "creation_date": 1424262142, "post_id": 28583065, "comment_id": 45474577, "body": "As a workaround, you could use ActiveWorkbook.Sheets(3).Activate or ActiveWorkbook.Sheets(&quot;Sheet3&quot;).Activate to switch in your code to the right sheet, make a new one and avtivate the sheet u where in before. I don&#39;t get how you actual question is the same as your headline. Hope this helps."}, {"owner": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "reply_to_user": {"reputation": 103, "user_id": 4449440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5860034107f022406b75e7d2af42612?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4449440/kai"}, "edited": false, "score": 0, "creation_date": 1424262943, "post_id": 28583065, "comment_id": 45475016, "body": "Well what you have just suggested is what I actually do. Problem is I have over 1000 sheets and it is not practical to search for next sheet lower than you need, to open needed sheet after it. I wan&#39;t vba to do that to preserve my working time."}], "answers": [{"comments": [{"owner": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "edited": false, "score": 0, "creation_date": 1424271550, "post_id": 28584351, "comment_id": 45480428, "body": "Yes that is exactly what I ment and want. Can you just subscribe what are CLng and CStr. ? TY"}, {"owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "reply_to_user": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "edited": false, "score": 0, "creation_date": 1424278802, "post_id": 28584351, "comment_id": 45485420, "body": "CLng converts a string to an integer -the sheet name is a string so you need to convert it to a number to compare. CStr converts a number to a string - you need to convert the new sheet number to a string so you can assign it as the sheet name."}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "reply_to_user": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "edited": false, "score": 0, "creation_date": 1424336162, "post_id": 28584351, "comment_id": 45509455, "body": "@Jelovac That this was the correct answer wasn&#39;t clear to me from your question, it might be worth editing your question accordingly."}], "tags": [], "owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "is_accepted": true, "score": 1, "last_activity_date": 1424268888, "last_edit_date": 1424268888, "creation_date": 1424264652, "answer_id": 28584351, "question_id": 28583065, "link": "https://stackoverflow.com/questions/28583065/how-to-calculate-with-sheet-names-as-integers/28584351#28584351", "title": "How to calculate with sheet names as integers?", "body": "<p>The following code with go through all the sheets. When it reaches one with a larger number it will insert the new sheet before it.</p>\n\n<pre><code>Public Sub Test()\n    AddSheetWithNumber shNum:=4\nEnd Sub\n\nPublic Sub AddSheetWithNumber(shNum As Long)\n\n    With ThisWorkbook\n\n        Dim sh As Worksheet\n        For Each sh In Worksheets\n            ' Find first sheet with number greater than new sheet number\n            If CLng(sh.Name) &gt; shNum Then\n                ' Add worksheet before sheet with larger number\n                .Worksheets.Add before:=sh\n                ActiveSheet.Name = CStr(shNum)\n                Exit For\n            End If\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "is_accepted": false, "score": 0, "last_activity_date": 1424352535, "creation_date": 1424352535, "answer_id": 28607659, "question_id": 28583065, "link": "https://stackoverflow.com/questions/28583065/how-to-calculate-with-sheet-names-as-integers/28607659#28607659", "title": "How to calculate with sheet names as integers?", "body": "<p>I came up with similar solution before I saw your example Paul. It might be usefull as well:</p>\n\n<pre><code>Sub New_Sheet()\n\nDim ExistingSheet As Integer\nDim NewSheet As Integer\nOn Error GoTo 30\nNewSheet = InputBox(\"Enter new sheet:\", \"NEW SHEET\")\n\n\nFor i = 3 To Sheets.Count - 3 'this is my work range\nExistingSheet = Sheets(i).Name\nIf ExistingSheet = NewSheet Then\n MsgBox (\"That sheet already exist!\")\n Sheets(i).Activate\n GoTo 30\nElse\n    On Error GoTo 10     'last 4 sheets have textual name like (subtotal, partners, etc) so error came up if I want to add sheet with bigest number(because it's comparing a textual name)\n    If NewSheet &gt; ExistingSheet Then   'error came up only in that case for now, so I make it place biggest sheet before textual one.\n     GoTo 20\n    Else\n        ActiveWorkbook.Sheets(\"Empty Card\").Copy _\n        after:=Sheets(i - 1)                        'Sheet with formulas and tables prepared for work\n        ActiveSheet.Name = NewSheet\n        ActiveSheet.Cells(2, 13) = ActiveSheet.Name\n    Exit Sub\n    End If\nEnd If\n20 Next i\n10      ActiveWorkbook.Sheets(\"Empty card\").Copy _\n        after:=Sheets(i - 1)      'didn't know of \"befor\" command\n        ActiveSheet.Name = NewSheet\n        ActiveSheet.Cells(2, 13) = ActiveSheet.Name\n30 Exit Sub\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1151, "favorite_count": 0, "accepted_answer_id": 28584351, "answer_count": 2, "score": 0, "last_activity_date": 1424352535, "creation_date": 1424260573, "question_id": 28583065, "link": "https://stackoverflow.com/questions/28583065/how-to-calculate-with-sheet-names-as-integers", "title": "How to calculate with sheet names as integers?", "body": "<p>I have many sheets(about 1000) with names as integer number like: 1 2 3 5 7 10 etc. They are ascending but not consistent, like I wrote.\nI have vba code that create new sheet with numbername from inputbox, after the activesheet(I activate sheet 3, run the code, enter 4 in inputbox and it creates sheet 4 after 3). What I need is solution how to (example): create a new sheet with name 4 after the sheetnumber 3, without haveing to be on sheet 3.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user14629932"}, "edited": false, "score": 0, "creation_date": 1606444467, "post_id": 28582897, "comment_id": 114970171, "body": "i dont know... i don&#39;t know why im making this comment"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 1274535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/004cf9905c261d4e267ea333822793f7?s=128&d=identicon&r=PG", "display_name": "Yura Perov", "link": "https://stackoverflow.com/users/1274535/yura-perov"}, "edited": false, "score": 0, "creation_date": 1424861807, "post_id": 28591159, "comment_id": 45721616, "body": "Thank you very much for your reply! Now I understand how to use .Refresh. Unfortunately, this does not update charts at all... :) This does update charts, <a href=\"http://stackoverflow.com/questions/4902703/excel-chart-wont-update\" title=\"excel chart wont update\">stackoverflow.com/questions/4902703/excel-chart-wont-update</a> , but unfortunately it blinks... :)"}], "tags": [], "owner": {"reputation": 180, "user_id": 4236677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EMte0.jpg?s=128&g=1", "display_name": "Zegad", "link": "https://stackoverflow.com/users/4236677/zegad"}, "is_accepted": true, "score": 11, "last_activity_date": 1424284173, "creation_date": 1424284173, "answer_id": 28591159, "question_id": 28582897, "link": "https://stackoverflow.com/questions/28582897/refresh-all-charts-without-blinking/28591159#28591159", "title": "Refresh all charts without blinking", "body": "<p><strong>Untested</strong> But the <em>.Refresh</em> may work with this:</p>\n\n<pre><code>Sub ChangeCharts()\nApplication.ScreenUpdating = False 'This line disable the on screen update for better performance, the blink you see, you could delete both lanes but it will run slower\nDim myChart As ChartObject\nFor Each myChart In ActiveSheet.ChartObjects\n    myChart.Chart.Refresh\nNext myChart\nApplication.ScreenUpdating = True'This line reenable the on screen update for better performance, the blink you see, you could delete both lanes but it will run slower\nEnd Sub\n</code></pre>\n\n<p>And that's because (as the link you provide shows) <em>.Refresh</em> only works with the object <strong>Chart</strong> and not with the object <strong>ChartObjects</strong> as you have been trying to apply it. Hope it'll guide you in the right direction. (also added quotes for the blink/flicker on screen in the code)</p>\n"}, {"comments": [{"owner": {"reputation": 271, "user_id": 6465671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0e0e4ce7a3b658474bb9378cd2b65216?s=128&d=identicon&r=PG&f=1", "display_name": "Bendaua", "link": "https://stackoverflow.com/users/6465671/bendaua"}, "edited": false, "score": 0, "creation_date": 1545316422, "post_id": 53491946, "comment_id": 94588425, "body": "I am sorry: The VBA-code is not working in my case. There is no chart-refresh happening, at least not with every SeriesCollections in the Chart. I have to manually click on &quot;data selection&quot; in the Diagram ribbon, then it updates."}, {"owner": {"reputation": 103, "user_id": 5280764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXu8t.png?s=128&g=1", "display_name": "Rodent", "link": "https://stackoverflow.com/users/5280764/rodent"}, "reply_to_user": {"reputation": 271, "user_id": 6465671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0e0e4ce7a3b658474bb9378cd2b65216?s=128&d=identicon&r=PG&f=1", "display_name": "Bendaua", "link": "https://stackoverflow.com/users/6465671/bendaua"}, "edited": false, "score": 0, "creation_date": 1545356623, "post_id": 53491946, "comment_id": 94603707, "body": "Bendaua - Sorry to hear you had no success with this. I&#39;ve just tried it again and it seems to work here. Maybe it&#39;s a version thing. I&#39;m using 2007 (yes really!). One thing I did earlier when I was experimenting was instead of chart refresh which has a bad reputation I simply got the chart to do something pointless such as set its title to its current title and this also worked. I don&#39;t go into VBA much these days and for what it&#39;s worth the VB.Net solution has made my Excel automation much cleaner. No more flicker. Cheers."}, {"owner": {"reputation": 103, "user_id": 5280764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXu8t.png?s=128&g=1", "display_name": "Rodent", "link": "https://stackoverflow.com/users/5280764/rodent"}, "reply_to_user": {"reputation": 271, "user_id": 6465671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0e0e4ce7a3b658474bb9378cd2b65216?s=128&d=identicon&r=PG&f=1", "display_name": "Bendaua", "link": "https://stackoverflow.com/users/6465671/bendaua"}, "edited": false, "score": 0, "creation_date": 1546161013, "post_id": 53491946, "comment_id": 94790419, "body": "Bendaua et al, just to finish off this rather messy inconclusive solution to what is a very messy Excel chart refresh problem. I have now tested the VBA version on Office 10 and you are correct that it does not work. I don&#39;t know why it should work in Office 2007 and not in Office 10 but I have now tested the VB.Net version on Office 10 and Office 2016 and the charts do not flash when screen updating is reenabled."}, {"owner": {"reputation": 103, "user_id": 5280764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXu8t.png?s=128&g=1", "display_name": "Rodent", "link": "https://stackoverflow.com/users/5280764/rodent"}, "reply_to_user": {"reputation": 271, "user_id": 6465671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0e0e4ce7a3b658474bb9378cd2b65216?s=128&d=identicon&r=PG&f=1", "display_name": "Bendaua", "link": "https://stackoverflow.com/users/6465671/bendaua"}, "edited": false, "score": 0, "creation_date": 1590320634, "post_id": 53491946, "comment_id": 109630817, "body": "Bendaua - This problem has not gone away but I have found a VB.Net solution that works perfectly on all Excel versions I have tried and with a bit of work the code may be transferable to VBA. The idea is to take a screen grab of the charts then place the image over the charts while you update them then remove the screen grab picture after the chart flickering has finished. It&#39;s not as complex as it may sound, at least not in VB.Net and it works really well but as this is a VBA post I&#39;ll only post the VB.Net code if asked."}], "tags": [], "owner": {"reputation": 103, "user_id": 5280764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXu8t.png?s=128&g=1", "display_name": "Rodent", "link": "https://stackoverflow.com/users/5280764/rodent"}, "is_accepted": false, "score": 1, "last_activity_date": 1545356219, "last_edit_date": 1545356219, "creation_date": 1543286186, "answer_id": 53491946, "question_id": 28582897, "link": "https://stackoverflow.com/questions/28582897/refresh-all-charts-without-blinking/53491946#53491946", "title": "Refresh all charts without blinking", "body": "<p>As is often the case I was sent to this VBA post following a VB.NET query regarding blinking or flashing Excel Charts after turning on Excel ScreenUpdating. Blinking Charts is something that has been driving me mad for a long time now and I have seen no solutions that work including the above solution that looks like it should work but doesn't. I have now found a solution that works 100% for all of my programs. As this is a VBA post I have shown a VBA solution to the flashing charts but my VB.NET solution is for anyone else who is sent to this post looking for a VB.NET solution. My solution is based on the answer by Zegad above but it has a couple of essential additions that are not documented and which to me are not obvious. Use the following sub as a replacement for \"MyXLApp.ScreenUpdating = True\". If you find it works for you please do not ask me to explain why it works. I'm sure there are many here who could probably explain this but for me it is the result of luck and dogged determination. An odd addition here is that you actually only need to activate and refresh then deactivate any one chart and all of the charts will update without flashing when re-enabled, See 'VB.NET CODE-2 sub below.</p>\n\n<pre><code>Sub ScrUpdateEnableNoFlicker()'VBA CODE\n    Dim myChartObj As ChartObject\n    For Each myChartObj In ActiveSheet.ChartObjects\n        myChartObj.Activate 'IMPORTANT ADDITION\n        myChartObj.Chart.Refresh\n    Next\n    Cells.Range(\"A1\").Select 'IMPORTANT ADDITION\n    Application.ScreenUpdating = True\nEnd Sub\n\nPrivate Sub ScrUpdateEnableNoFlicker() 'VB.NET CODE-1\n    'BEFORE TURNING SCREEN UPDATING BACK ON...\n    'ACTIVATE and refresh the chart objects on the sheet with the charts.\n    Dim aSheet As Excel.Worksheet = CType(mXLWrkbk.Sheets(\"Sheet1\"), Excel.Worksheet)\n    Dim aChartObjects As Excel.ChartObjects = CType(aSheet.ChartObjects, Excel.ChartObjects)\n    For Each achartobject As Excel.ChartObject In aChartObjects\n        achartobject.Activate() 'IMPORTANT - Will not work without activating first\n        Dim achart As Excel.Chart = achartobject.Chart\n        achart.Refresh()\n    Next\n    'Now deactivate the current activated chart object by selecting any cell\n    'THIS IS IMPORTANT - It will not work without doing this\n    Dim selRange As Excel.Range = aSheet.Range(\"A1\")\n    selRange.Select()\n    'Now turn Screen Updating back on...\n    'All of the Charts will have updated and will not flicker\n    mXLApp.ScreenUpdating = True\nEnd Sub\n\nPrivate Sub ScrUpdateEnableNoFlicker() 'VB.NET CODE-2\n    'BEFORE TURNING SCREEN UPDATING BACK ON...\n    'ACTIVATE ANY ONE of the chart objects on the sheet with the charts.\n    Dim aSheet As Excel.Worksheet = CType(mXLWrkbk.Sheets(\"Sheet1\"), Excel.Worksheet)\n    Dim aChartObject As Excel.ChartObject = CType(aSheet.ChartObjects(\"Chart 9\"), Excel.ChartObject)\n    aChartObject.Activate() 'IMPORTANT - Will not work without activating first\n    'Refresh just the ONE activated chart.\n    Dim aChart As Excel.Chart = aChartObject.Chart\n    aChart.Refresh()\n    'Now deactivate the current activated chart object by selecting any cell\n    'THIS IS IMPORTANT - It will not work without doing this\n    Dim selRange As Excel.Range = aSheet.Range(\"A1\")\n    selRange.Select()\n    'Now turn Screen Updating back on...\n    'You only need to activate/deactivate any one chart and all of the Charts will have updated and will not flicker\n    mXLApp.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 191, "user_id": 190405, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/633528c18d4eaecf59904ef894615983?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne Ivory", "link": "https://stackoverflow.com/users/190405/wayne-ivory"}, "edited": false, "score": 0, "creation_date": 1553653840, "post_id": 55168786, "comment_id": 97461052, "body": "Success!  Thank you Jon.  I initially skipped over this and tried several other solutions unsuccessfully.  Then I came back here and saw who wrote the post - Peltier Tech Blog is one of my go-to sites for problems and ideas.  (DoEvents was my first attempted solution - I still can&#39;t believe a single DoEvents doesn&#39;t Do <i>enough</i> Events!)"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "reply_to_user": {"reputation": 191, "user_id": 190405, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/633528c18d4eaecf59904ef894615983?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne Ivory", "link": "https://stackoverflow.com/users/190405/wayne-ivory"}, "edited": false, "score": 0, "creation_date": 1553708552, "post_id": 55168786, "comment_id": 97488830, "body": "Yeah, isn&#39;t that something?"}], "tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 7, "last_activity_date": 1552584895, "creation_date": 1552584895, "answer_id": 55168786, "question_id": 28582897, "link": "https://stackoverflow.com/questions/28582897/refresh-all-charts-without-blinking/55168786#55168786", "title": "Refresh all charts without blinking", "body": "<p>Happy Pi Day!</p>\n\n<p>I just did some experiments with animating charts, using VBA to change a counter in a cell, and worksheet formulas to recalculate chart data based on this counter.</p>\n\n<p>I used to do a lot of chart animations, back in the days of Excel 97-2003, and those ran pretty well. When Excel 2007 came out, the animations really degraded, and nothing seemed to help. But just now I did these tesst in the latest build of Office 365 (Version 1904, Build 11504). And it turns out, sometime in the past few years or so, Microsoft has made it work better.</p>\n\n<pre><code>Sub ChartAnimation1()\n  Dim i As Double\n  For i = 0 To 1000 Step 50\n    ActiveSheet.Range(\"Stepper\") = i\n  Next\nEnd Sub\n</code></pre>\n\n<p>The animation didn't animate, that is, the chart didn't change despite the data changing.</p>\n\n<p>My experience told me I should put something like <code>DoEvents</code> in the code after I change the cell's value.</p>\n\n<pre><code>Sub ChartAnimation2()\n  Dim i As Double\n  For i = 0 To 1000 Step 50\n    ActiveSheet.Range(\"Stepper\") = i\n    DoEvents\n  Next\nEnd Sub\n</code></pre>\n\n<p>This helped a little, the chart changed, but the animation was not smooth. Some steps were missed, and the effect was a herky-jerky animation.</p>\n\n<pre><code>Sub ChartAnimation3()\n  Dim i As Double\n  For i = 0 To 1000 Step 50\n    ActiveSheet.Range(\"Stepper\") = i\n    DoEvents\n    DoEvents\n  Next\nEnd Sub\n</code></pre>\n\n<p>This ran a bit more slowly than with one <code>DoEvents</code>, but it was a lot smoother; still not perfect, but pretty good.</p>\n\n<p>More than two DoEvents was overkill: the code took the same length of time, and the animation was not any smoother.</p>\n\n<p>I also tried various combinations of <code>Chart.Refresh</code>, <code>Chart.Activate</code>, and <code>ScreenUpdating</code>. Two takeaways:</p>\n\n<ul>\n<li>Without a couple <code>DoEvents</code>, the animation didn't work regardless of what other things I tried.</li>\n<li>With a couple <code>DoEvents</code>, none of these extra steps made the animation any smoother, but they could make it significantly slower.</li>\n</ul>\n\n<p>This was pretty interesting, so I'll blog about it some day. When I do I'll come back and post a link.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14716876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efa7d8da806e7644216c992831cf9c3a?s=128&d=identicon&r=PG&f=1", "display_name": "Icare88", "link": "https://stackoverflow.com/users/14716876/icare88"}, "is_accepted": false, "score": 0, "last_activity_date": 1606461008, "last_edit_date": 1606461008, "creation_date": 1606444341, "answer_id": 65031392, "question_id": 28582897, "link": "https://stackoverflow.com/questions/28582897/refresh-all-charts-without-blinking/65031392#65031392", "title": "Refresh all charts without blinking", "body": "<p>I was having this issue when hiding or showing a series in my chart. The change would not be apparent until I would scroll away then back again to the chart, which was really a pain. I tried all the above solutions with no luck until I realized unselecting and selecting again the chart before doing the change would work.</p>\n<p>myChart.TopLeftCell.Select</p>\n<p>myChart.Select</p>\n<p>...</p>\n<p>Good luck in your research for a solution ;)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14869576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700c030418b141fdb7936708bf12b0c4?s=128&d=identicon&r=PG", "display_name": "Steve Sergev", "link": "https://stackoverflow.com/users/14869576/steve-sergev"}, "is_accepted": false, "score": 0, "last_activity_date": 1608614151, "creation_date": 1608614151, "answer_id": 65403577, "question_id": 28582897, "link": "https://stackoverflow.com/questions/28582897/refresh-all-charts-without-blinking/65403577#65403577", "title": "Refresh all charts without blinking", "body": "<p>Thanks to those who have posted here before!  Without your successes, I would not have smooth animation of a dynamic simulation. In my case, it is an xlXYScatterLinesNoMarkers type chart.  Running in VBA.</p>\n<p>This works for me when changing the series programmatically.  The chart is animated smoothly.  Running Excel 2016 64 bit</p>\n<pre><code>Public Sub ShowOneAnimationFrame(worksheetName As String, chartName As String, _\n                                 xvals() As Double, yvals() As Double)\n\n    'update chart series programmatically\n    'Excel 2016 64bit\n    'Dec 21, 2020\n    'Author:  S^3\n    \n    Dim theChart As chart\n    Dim chrtObj As ChartObject\n    Dim oneSeries As Series\n    \n    Set chrtObj = Sheets(worksheetName).ChartObjects(chartName)\n    Set theChart = chrtObj.chart\n    \n    If theChart.SeriesCollection.Count = 0 Then\n        theChart.SeriesCollection.NewSeries\n    End If\n    Set oneSeries = theChart.SeriesCollection(1)\n    \n    'update the series with new values\n    oneSeries.XValues = xvals\n    oneSeries.Values = yvals\n    \n    theChart.Refresh  'required (this and the next line are required but the order doesn't matter)\n    chrtObj.Select    'required\n    Cells.Range(&quot;A1&quot;) = Cells.Range(&quot;A1&quot;).value  'something like this is required\n    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 1274535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/004cf9905c261d4e267ea333822793f7?s=128&d=identicon&r=PG", "display_name": "Yura Perov", "link": "https://stackoverflow.com/users/1274535/yura-perov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40887, "favorite_count": 0, "accepted_answer_id": 28591159, "answer_count": 5, "score": 4, "last_activity_date": 1608614151, "creation_date": 1424260099, "question_id": 28582897, "link": "https://stackoverflow.com/questions/28582897/refresh-all-charts-without-blinking", "title": "Refresh all charts without blinking", "body": "<p>The aim is to refresh all charts in Excel after cells recalculation.</p>\n\n<p>I work with Microsoft Excel 2010.</p>\n\n<p>As we know, there is a bug? in Excel so that Excel does not update charts even after</p>\n\n<pre><code>Application.CalculateFullRebuild\n</code></pre>\n\n<p>A known hack is to do something like this:</p>\n\n<pre><code>Application.ScreenUpdating = False\nTemp = ActiveCell.ColumnWidth\nActiveCell.Columns.AutoFit\nActiveCell.ColumnWidth = Temp\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>This does work. However, all Excel charts blink (they become white for a moment while updating). Could you advise, please, is there any way to avoid such blinking?</p>\n\n<p>I tried to call</p>\n\n<pre><code>.Refresh\n</code></pre>\n\n<p>on all charts (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff198180(v=office.14).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff198180(v=office.14).aspx</a>):</p>\n\n<pre><code>For Each ChartObject In ActiveSheet.ChartObjects\n    ChartObject.Refresh\nNext\n</code></pre>\n\n<p>but for some reason my Excel (2010) shows error #438 \"Object doesn't support this property or method\".</p>\n\n<p>Could you advise, please, do I miss something important?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1424261188, "creation_date": 1424261188, "answer_id": 28583296, "question_id": 28582850, "link": "https://stackoverflow.com/questions/28582850/message-box-popup-query/28583296#28583296", "title": "Message box popup query", "body": "<p>I'd store the lookup-result in a string, and only display the messagebox if the result is non-empty. You may want to check if vlookup actually succeeds at finding a result too, but the method is much the same:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n  Dim s As String\n  If Not Intersect(Target, Range(\"facops\")) Is Nothing Then\n    On Error Resume Next\n      s = WorksheetFunction.VLookup(Target.Offset(0, 0), Worksheets(\"Options\").Range(\"Options\"), 3)\n      If s &lt;&gt; \"\" Then\n        MsgBox s, vbOKOnly, \"Option Information\"\n      End If\n    On Error GoTo 0\n  End If\nEnd Sub\n</code></pre>\n\n<p>Positioning the messagebox is more tricky, a quick google shows e.g. <a href=\"http://www.mrexcel.com/forum/excel-questions/808305-visual-basic-applications-code-possition-message-box.html\" rel=\"nofollow\">this thread</a> on the Mr. Excel forums which provides some code for doing what you ask for. I haven't tried it out myself, so no guarantee that it will work, but unless you want to create a custom form or use an inputbox instead (both of which it is possible to position), that is my best suggestion.</p>\n"}, {"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1424261261, "creation_date": 1424261261, "answer_id": 28583322, "question_id": 28582850, "link": "https://stackoverflow.com/questions/28582850/message-box-popup-query/28583322#28583322", "title": "Message box popup query", "body": "<p>In order to prevent the pop-up for blank cells you can check the result of your VLookup prior to presenting it in a message box:</p>\n\n<pre><code>If Not IsEmpty(WorksheetFunction.VLookup(.......)) Then\n   MsgBox ...\nEnd If\n</code></pre>\n\n<p>A message box cannot be shown in a specific area of the screen. Yet, you can create a form instead, show the form with the error message, and show this form on the screen whereever you want. The following code example will show the form in the center of your Excel:</p>\n\n<pre><code>frmMessageBox.StartUpPosition = 0\nfrmMessageBox.Left = Application.Left + Application.Width / 2 - frmMessageBox.Width / 2\nfrmMessageBox.Top = Application.Top + Application.Height / 2 - frmMessageBox.Height / 2\nLoad frmMessageBox\nfrmMessageBox.Show\n</code></pre>\n\n<p>This example will show the form in the lower right corner of Excel:</p>\n\n<pre><code>frmMessageBox.Left = Application.Left + Application.Width - frmMessageBox.Width\nfrmMessageBox.Top = Application.Top + Application.Height - frmMessageBox.Height\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4579363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be09915d55b6c1ba1eab7a9c4f134467?s=128&d=identicon&r=PG&f=1", "display_name": "John Davies", "link": "https://stackoverflow.com/users/4579363/john-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1424261364, "creation_date": 1424259951, "last_edit_date": 1531164843, "question_id": 28582850, "link": "https://stackoverflow.com/questions/28582850/message-box-popup-query", "title": "Message box popup query", "body": "<p>I have the following code in an excel spreadsheet, however is there a way to prevent the message box popping up if the lookup value in the range is a blank cell? Also, is there a way to get the message box to pop up in a psecified area on the sheet.  Thanks in advance for any help!</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)   \nIf Not Intersect(Target, Range(\"facops\")) Is Nothing Then     \nOn Error Resume Next     \nMsgBox WorksheetFunction.VLookup(Target.Offset(0, 0), Worksheets(\"Options\").Range(\"Options\"), 3), vbOKOnly, \"Option Information\"     \nOn Error GoTo 0   \nEnd If \nEnd Sub\n</code></pre>\n"}, {"tags": ["image", "excel", "jpeg", "vba"], "answers": [{"comments": [{"owner": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "edited": false, "score": 0, "creation_date": 1424260472, "post_id": 28582813, "comment_id": 45473499, "body": "Thats brillaint thanks...seems it just doesnt like jpeg files"}, {"owner": {"reputation": 3159, "user_id": 4450134, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0207987892f359cb7d9b56e8aa4fc75c?s=128&d=identicon&r=PG&f=1", "display_name": "HavelTheGreat", "link": "https://stackoverflow.com/users/4450134/havelthegreat"}, "reply_to_user": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "edited": false, "score": 0, "creation_date": 1424260573, "post_id": 28582813, "comment_id": 45473570, "body": "@Paula No worries. That&#39;s interesting, I&#39;ll look into it. No way you can convert the image type in the meantime?"}, {"owner": {"reputation": 3159, "user_id": 4450134, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0207987892f359cb7d9b56e8aa4fc75c?s=128&d=identicon&r=PG&f=1", "display_name": "HavelTheGreat", "link": "https://stackoverflow.com/users/4450134/havelthegreat"}, "reply_to_user": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "edited": false, "score": 0, "creation_date": 1424261492, "post_id": 28582813, "comment_id": 45474186, "body": "@Paula also are you using Excel 2011?"}, {"owner": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "edited": false, "score": 0, "creation_date": 1424262097, "post_id": 28582813, "comment_id": 45474550, "body": "I managed to get to converted to bitmap which it seems to work ok with so that will do the trick :) and I am using excel 2010"}, {"owner": {"reputation": 3159, "user_id": 4450134, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0207987892f359cb7d9b56e8aa4fc75c?s=128&d=identicon&r=PG&f=1", "display_name": "HavelTheGreat", "link": "https://stackoverflow.com/users/4450134/havelthegreat"}, "reply_to_user": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "edited": false, "score": 0, "creation_date": 1424265051, "post_id": 28582813, "comment_id": 45476214, "body": "@Paula Great. If you found my answer helpful an upvote is always appreciated!"}, {"owner": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "edited": false, "score": 0, "creation_date": 1424266232, "post_id": 28582813, "comment_id": 45476935, "body": "sorry I would but it wont let me upvote until I get a 15 reputation..sorry once I get that I will certainly upvote this post"}], "tags": [], "owner": {"reputation": 3159, "user_id": 4450134, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0207987892f359cb7d9b56e8aa4fc75c?s=128&d=identicon&r=PG&f=1", "display_name": "HavelTheGreat", "link": "https://stackoverflow.com/users/4450134/havelthegreat"}, "is_accepted": true, "score": 1, "last_activity_date": 1424259843, "creation_date": 1424259843, "answer_id": 28582813, "question_id": 28582647, "link": "https://stackoverflow.com/questions/28582647/can-you-include-a-jpeg-or-any-image-onto-an-excel-form/28582813#28582813", "title": "Can you include a Jpeg or any image onto an excel form", "body": "<p>You are looking for the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264663.aspx\" rel=\"nofollow\"> UserForm </a> object, which has a picture property. There's a bit of info <a href=\"http://spreadsheetpage.com/index.php/tip/pasting_an_image_to_a_userform_control/\" rel=\"nofollow\"> here </a> on how to paste an image in a User Form control which you may find helpful. Best of luck!</p>\n"}], "owner": {"reputation": 269, "user_id": 4571447, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-1Yzpr6EaLOY/AAAAAAAAAAI/AAAAAAAAABw/cZz00iSFJoU/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/4571447/paula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 28582813, "answer_count": 1, "score": 0, "last_activity_date": 1424259843, "creation_date": 1424259313, "last_edit_date": 1531164843, "question_id": 28582647, "link": "https://stackoverflow.com/questions/28582647/can-you-include-a-jpeg-or-any-image-onto-an-excel-form", "title": "Can you include a Jpeg or any image onto an excel form", "body": "<p>not sure if this is possible can you add a jpeg or another image to a form created in the vba section in excel? If so would anyone know how to go about doing this...</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2597, "user_id": 2026637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/019b98c2b46b6b0e310a51207db34647?s=128&d=identicon&r=PG", "display_name": "grahamj42", "link": "https://stackoverflow.com/users/2026637/grahamj42"}, "is_accepted": false, "score": 4, "last_activity_date": 1424260268, "creation_date": 1424260268, "answer_id": 28582956, "question_id": 28582557, "link": "https://stackoverflow.com/questions/28582557/excel-vba-function-for-each-cell-in-selection-error-resulting-to-variable-not-de/28582956#28582956", "title": "Excel VBA Function For Each Cell in Selection error resulting to Variable Not Defined", "body": "<p>You have <code>Option Explicit</code> so the variable <em>Cell</em> must be declared :\n<code>Dim Cell As Range</code> at the start of your Sub CalculateColor().</p>\n"}], "owner": {"reputation": 971, "user_id": 2366974, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b562a3566cd4a21045b865dd875ee2d3?s=128&d=identicon&r=PG", "display_name": "Kay Singian", "link": "https://stackoverflow.com/users/2366974/kay-singian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5977, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424260268, "creation_date": 1424259074, "last_edit_date": 1531164843, "question_id": 28582557, "link": "https://stackoverflow.com/questions/28582557/excel-vba-function-for-each-cell-in-selection-error-resulting-to-variable-not-de", "title": "Excel VBA Function For Each Cell in Selection error resulting to Variable Not Defined", "body": "<p>I was writing A code function in excel that calls a subroutine after the function gets the input data.\nThe function is to color a cell or range of cells within a worksheet or another worksheet using the RGB values in the excel.</p>\n\n<p>However, I do not know how to call the cell values with the function I wrote once the subroutine is working. The Error says Variable not Defined. Looks like the \"For Each Cell in Selection\" line is causing the error, as the cell is not declared once I passed the data of the function to the subroutine.\nAlso, can someone provide the code on modifying other worksheet's cells in the form of: \"Cell.Interior.Color = RGB(Red, Green, Blue)\"? The worksheet's name is provided to be input by the user.  </p>\n\n<pre><code>Option Explicit\nDim Activate As Boolean\n\nPublic Function SETRGBCOLOR( _\n    Optional CurrentCellValue As Variant, _\n    Optional wksSheetname As String, _\n    Optional rngRange As Range, _\n    Optional byteRed As Byte = 0, _\n    Optional byteGreen As Byte = 0, _\n    Optional byteBlue As Byte = 0) As Variant\n\n    If IsMissing(CurrentCellValue) Then\n        SETRGBCOLOR = \"\"\n    Else\n        SETRGBCOLOR = CurrentCellValue\n    End If\n\n    Activate = False\n\n    'set greater RGB values than max RG value to 255, byte ignores the negative value of a digit\n    If byteRed &gt; 255 Then byteRed = 255\n    If byteGreen &gt; 255 Then byteGreen = 255\n    If byteBlue &gt; 255 Then byteBlue = 255\n\n    Activate = True\n\n    Call CalculateColor(wksSheetname, rngRange, byteRed, byteGreen, byteBlue)\nEnd Function\n\nPrivate Sub CalculateColor(wksSheetname As String, rngRange As Range, byteRed As Byte, byteGreen As Byte, byteBlue As Byte)\n    If Activate = True Then\n\n        If Trim(wksSheetname) &lt;&gt; \"\" Then\n            If Trim(rngRange) &lt;&gt; \"\" Then\n                For Each Cell In Selection\n                    Cell.Interior.Color = RGB(byteRed, byteGreen, byteBlue)\n                Next Cell\n            Else\n            End If\n        Else\n            If Trim(rngRange) &lt;&gt; \"\" Then\n                'For Each Cell In Selection\n                '    Cell.Interior.Color = RGB(byteRed, byteGreen, byteBlue)\n                'Next Cell\n            Else\n            End If\n        End If\n    End If\n    Activate = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powershell"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4579235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1749fbcf0bf0800ea1b6a3310728a5d?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Ouanes", "link": "https://stackoverflow.com/users/4579235/rami-ouanes"}, "edited": false, "score": 0, "creation_date": 1424267989, "post_id": 28583204, "comment_id": 45478121, "body": "Thank you for your answer. Well i tried your solution but I still have the vba error 1004."}, {"owner": {"reputation": 21, "user_id": 4579235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1749fbcf0bf0800ea1b6a3310728a5d?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Ouanes", "link": "https://stackoverflow.com/users/4579235/rami-ouanes"}, "edited": false, "score": 0, "creation_date": 1424335670, "post_id": 28583204, "comment_id": 45509181, "body": "Thank you a lot for your solution. I will test the ODBCConnection.Ready, but i think it has something to do with this post <a href=\"http://stackoverflow.com/questions/181585/rpc-e-servercall-retrylater-during-powershell-automation\" title=\"rpc e servercall retrylater during powershell automation\">stackoverflow.com/questions/181585/&hellip;</a> since when I take off the part of the macro run, the error described in the post comes up."}, {"owner": {"reputation": 81, "user_id": 5555155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x2qfq.png?s=128&g=1", "display_name": "T-Rez", "link": "https://stackoverflow.com/users/5555155/t-rez"}, "edited": false, "score": 0, "creation_date": 1568227698, "post_id": 28583204, "comment_id": 102211559, "body": "For me #1 just caused Excel to Hang, but number 2 worked when trying to refresh from a CSV"}], "tags": [], "owner": {"reputation": 5706, "user_id": 4424236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZmVLO.jpg?s=128&g=1", "display_name": "beatcracker", "link": "https://stackoverflow.com/users/4424236/beatcracker"}, "is_accepted": false, "score": 3, "last_activity_date": 1424271190, "last_edit_date": 1424271190, "creation_date": 1424260934, "answer_id": 28583204, "question_id": 28582443, "link": "https://stackoverflow.com/questions/28582443/make-powershell-wait-for-excel-to-finish-refreshing-pivot-table/28583204#28583204", "title": "Make PowerShell Wait for Excel to Finish Refreshing Pivot Table", "body": "<p>Shotgun approach:</p>\n\n<ol>\n<li><p>Excel has <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197917.aspx\" rel=\"nofollow\">Application.Ready</a> property. It <em>should</em> indicate when\nExcel is ready for automation communication, but <a href=\"http://www.databaseforum.info/16/15/df68562a383083ef.html\" rel=\"nofollow\">details are\nunclear</a>. Try something like this:</p>\n\n<pre class=\"lang-powershell prettyprint-override\"><code>$Excel = New-Object -ComObject Excel.Application\n\n# Do your stuff here\n\n# Wait for Excel to became ready\nwhile (!$Excel.Ready)\n{\n    Start-Sleep -Seconds 1\n}\n\n # Do other stuff\n</code></pre></li>\n<li><p>QueryTable has <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834459.aspx\" rel=\"nofollow\">Refreshing</a> property. Try this:</p>\n\n<pre class=\"lang-powershell prettyprint-override\"><code>$Excel = New-Object -ComObject Excel.Application\n$Workbook = $Excel.Workbooks.Open('C:\\Path\\To\\Workbook\\Data.xlsx')\n\n# Are any of the QueryTables refreshing?\n# Don't have Excel right now, so expression below might need some tweaking\nWhile (($Workbook.Sheets | ForEach-Object {$_.QueryTables | ForEach-Object {if($_.QueryTable.Refreshing){$true}}}))\n{\n    Start-Sleep -Seconds 1\n}\n</code></pre></li>\n<li><p>ODBCConnection has <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820965.aspx\" rel=\"nofollow\">Refreshing</a> property.Try this:</p>\n\n<pre class=\"lang-powershell prettyprint-override\"><code>$Excel = New-Object -ComObject Excel.Application\n$Workbook = $Excel.Workbooks.Open('C:\\Path\\To\\Workbook\\Data.xlsx')\n\n# Is ODBCConnection refreshing?\n# Don't have Excel right now, so expression below might need some tweaking\nWhile ($Workbook.ODBCConnection.Refreshing)\n{\n    Start-Sleep -Seconds 1\n}\n</code></pre></li>\n<li><p>Maybe those 5 files have <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835909.aspx\" rel=\"nofollow\">PivotCache.BackgroundQuery</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839662.aspx\" rel=\"nofollow\">ODBCConnection.BackgroundQuery</a> or <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839478.aspx\" rel=\"nofollow\">QueryTable.BackgroundQuery</a> property set to true?</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 607, "user_id": 5330333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610f55422d980ec228dc940ee2cda195?s=128&d=identicon&r=PG&f=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/5330333/carsten"}, "is_accepted": false, "score": 0, "last_activity_date": 1587492759, "creation_date": 1587492759, "answer_id": 61350247, "question_id": 28582443, "link": "https://stackoverflow.com/questions/28582443/make-powershell-wait-for-excel-to-finish-refreshing-pivot-table/61350247#61350247", "title": "Make PowerShell Wait for Excel to Finish Refreshing Pivot Table", "body": "<p>For me this simple code-snippet did the trick:</p>\n\n<pre><code>$sheet.Calculate()\n$null = $sheet.QueryTables.QueryTable.Refreshing\n</code></pre>\n\n<p>It looks like just getting the Refreshing-Attribute is enough to wait for the end of the refresh/calculation-cycle.</p>\n"}], "owner": {"reputation": 21, "user_id": 4579235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1749fbcf0bf0800ea1b6a3310728a5d?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Ouanes", "link": "https://stackoverflow.com/users/4579235/rami-ouanes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5292, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1590862165, "creation_date": 1424258719, "last_edit_date": 1590862165, "question_id": 28582443, "link": "https://stackoverflow.com/questions/28582443/make-powershell-wait-for-excel-to-finish-refreshing-pivot-table", "title": "Make PowerShell Wait for Excel to Finish Refreshing Pivot Table", "body": "<p>So I developed a Powershell script to refresh about 40 large excel files and save them, and in this script I run an excel macro to pass the excel (ODBC) connection parameters and then delete them from the excel file after the refresh is done. My only problem is that (for 5 files of these 40 files) when the RefreshAll command is launched, Powershell does not wait for Excel to finish refreshing and passes through to the next command which is the macro that invalidates the connection, which causes the error \"1004\" in the macro (Cannot access to the excel connection while the file is still refreshing.)</p>\n\n<p>After some research, I know that in Powershell v2, there's the concept of background jobs, but in my case, this is not an aside process, it belongs to the Excel process, so my Powershell shouldn't have to wait for Excel to quit to continue executing, on the contrary, I need the excel to stay open to continue the execution of Powershell.</p>\n\n<p>I know also that the start-sleep command is not the best for my situation since there is no fix value of time for the refresh to end, every file has its time and also every period of the month has its time (the volume of data increases everyday until the month ends).</p>\n\n<p>So my question is: Is it possible to make Powershell test if the Excel file has done refreshing its data, if yes it continues, else it waits even more? </p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "edited": false, "score": 0, "creation_date": 1462546724, "post_id": 28584850, "comment_id": 61695709, "body": "This is very similar to the answer posted <a href=\"http://stackoverflow.com/questions/28219298/setting-an-odbc-connection-string-in-vba/28220771#28220771\">here</a>, I think generally, you need to prefix the connection string with its type for both OLEDB and ODBC connections."}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "edited": false, "score": 0, "creation_date": 1462548381, "post_id": 28584850, "comment_id": 61696801, "body": "Also, another thing to check when adding &quot;OLEDB;&quot; to the front of your connection string is that your &quot;CmdType&quot; is set correctly, the original question uses 6(&quot;xlCmdTableCollection&quot;) but that won&#39;t work for every connection string, I&#39;ve found its good to double check the type, to make sure that it is consistent."}], "tags": [], "owner": {"reputation": 313, "user_id": 4575440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/50966cef93d7998fa8ef97ac89835110?s=128&d=identicon&r=PG&f=1", "display_name": "joelc", "link": "https://stackoverflow.com/users/4575440/joelc"}, "is_accepted": true, "score": 4, "last_activity_date": 1424266231, "creation_date": 1424266231, "answer_id": 28584850, "question_id": 28582123, "link": "https://stackoverflow.com/questions/28582123/workbooks-connections-add2-gives-runtime-error-5-invalid-procedure-call-or-argu/28584850#28584850", "title": "workbooks.connections.add2 gives runtime error 5: Invalid procedure call or argument", "body": "<p>Not sure whether this will help you, but I had a similar error earlier today and fixed it by typing: <code>OLEDB;</code> at the start of the connection string. So it read:</p>\n\n<p><code>OLEDB;Provider=Microsoft...</code></p>\n\n<p>It may help to use the wizard first and look at the connection string it generates; you can then use this in the VBA code.</p>\n"}], "owner": {"reputation": 2263, "user_id": 3841809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/3DLrQ.jpg?s=128&g=1", "display_name": "uncool", "link": "https://stackoverflow.com/users/3841809/uncool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3244, "favorite_count": 1, "accepted_answer_id": 28584850, "answer_count": 1, "score": 1, "last_activity_date": 1594638777, "creation_date": 1424257827, "last_edit_date": 1594638777, "question_id": 28582123, "link": "https://stackoverflow.com/questions/28582123/workbooks-connections-add2-gives-runtime-error-5-invalid-procedure-call-or-argu", "title": "workbooks.connections.add2 gives runtime error 5: Invalid procedure call or argument", "body": "<p>I've copied all arguments form an existing connection created manually through excel and going into -> connections -> connection -> properties. </p>\n\n<p>My code is below, I'm trying to execute a simple connection to my access database. But I keep getting the error message: runtime error 5: Invalid procedure call or argument. </p>\n\n<p>Code</p>\n\n<pre><code>Sub CustomPivotConnection()\n\n    Dim connstring As String: connstring = \"Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=C:\\Users\\username\\Desktop\\DataBase.accdb;Mode=ReadWrite;Extended Properties=;Jet OLEDB:System database=;Jet OLEDB:Registry Path=;Jet OLEDB:Engine Type=6;Jet OLEDB:Database Locking Mode=1;Jet OLEDB:Global Partial Bulk Ops=2;Jet OLEDB:Global Bulk Transactions=1;Jet OLEDB:New Database Password=;Jet OLEDB:Create System Database=False;Jet OLEDB:Encrypt Database=False;Jet OLEDB:Don't Copy Locale on Compact=False;Jet OLEDB:Compact Without Replica Repair=False;Jet OLEDB:SFP=False;Jet OLEDB:Support Complex Data=False;Jet OLEDB:Bypass UserInfo Validation=False;Jet OLEDB:Limited DB Caching=False;Jet OLEDB:Bypass ChoiceField Validation=False\"\n    Dim cmdstring As String: cmdstring = \"'AZN','BOL','Dates','Instruments'\"\n\n    Workbooks(\"WorkbookTester.xlsm\").Connections.Add2 _\n    \"Testing\", \"Testing\", connstring, cmdstring, 6, True, True\nEnd sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1424268256, "post_id": 28581690, "comment_id": 45478290, "body": "Did you consider connecting the <a href=\"https://support.office.com/en-us/article/Connect-an-Access-database-to-your-workbook-a3d6500c-4bec-40ce-8cdf-fb4edb723525?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">Access table to Excel workbook</a>? Also, as an aside why not run everything in Access which better handles: data storage (referential SQL engine instead of flatfile cache memory) and data entry (GUI forms with data type validation instead of rows and columns interface)?"}, {"owner": {"reputation": 97, "user_id": 4558239, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-nkkKFPeEdew/AAAAAAAAAAI/AAAAAAAAEQo/Uza7iTzmPFQ/photo.jpg?sz=128", "display_name": "Reetika Choudhary", "link": "https://stackoverflow.com/users/4558239/reetika-choudhary"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1424268922, "post_id": 28581690, "comment_id": 45478694, "body": "I tried doing it all in Access but I am a novie. I dnt know much. So have made part of the reports in excel and partly in excel."}, {"owner": {"reputation": 97, "user_id": 4558239, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-nkkKFPeEdew/AAAAAAAAAAI/AAAAAAAAEQo/Uza7iTzmPFQ/photo.jpg?sz=128", "display_name": "Reetika Choudhary", "link": "https://stackoverflow.com/users/4558239/reetika-choudhary"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1424268970, "post_id": 28581690, "comment_id": 45478721, "body": "do you mean linking when you say connecting access table to excel workbook?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1424312539, "post_id": 28581690, "comment_id": 45501645, "body": "Correct. Linking will create an Excel table that mirrors the Access table and that link will be real-time as data changes in Access side will reflect upon refresh or auto-refresh. However this is mainly to present Access data inside Excel for analytic and graphic purposes not to edit. I advise learning about simple Access tables and forms (wizards are available and online tutorials) for your users to better handle the data instead of back and forth copy and paste."}], "owner": {"reputation": 97, "user_id": 4558239, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-nkkKFPeEdew/AAAAAAAAAAI/AAAAAAAAEQo/Uza7iTzmPFQ/photo.jpg?sz=128", "display_name": "Reetika Choudhary", "link": "https://stackoverflow.com/users/4558239/reetika-choudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 690, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594645382, "creation_date": 1424256478, "last_edit_date": 1594645382, "question_id": 28581690, "link": "https://stackoverflow.com/questions/28581690/updating-records-in-access-from-excel-and-then-getting-back-same-records-when-us", "title": "Updating records in access from excel and then getting back same records when user wants", "body": "<p>This is a very common one. I have researched and found several codes for this but somehow it it is not working for me. </p>\n\n<p>Objective: When the User updates the excel sheet, the data should be saved/updated in access and tomorrow if user wants to view the same the in excel he should be able to see it. The common link between the two dataset is week numnber</p>\n\n<p>Tables I have: \nTable 1: There is one table called schedules. The columns are Associate name, associate ID and There in and out time for the week. There is one box in the upper left connect with week number in it. If User selects week 1, the dates in the column change and the schedule also changes. \nTable 2: It is the leave details table. There I have the employee leaves data i.e. leave start date, leave start time etc. \nTable 3: Calculations. Now here is where all the calculations are happening and the out is being displayed in the schedules sheet when the user clicks on teh refresh button</p>\n\n<p>Question: The part that I am unable to do is:</p>\n\n<ol>\n<li>after seeing the schedules displayed in the schedules table, if the user mannually updates the schedule, I want this data to be saved in MS access database. Say, its week 5 running, and at the start of the week user makes that change, I saved the data in access. In the same week, he again opens the data, now I want the user to see the data saved in access and not calculate. SO what I want my code to do is first go to access check if the data is available for the said week or not. If it is not available, come to excel and copy paste a certain data/worksheet. </li>\n</ol>\n\n<p>How do I update and create this check? </p>\n\n<p>Currently M using transferspreadsheet function but that is not solving the problem. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Option Explicit\r\n\r\nSub AccImport()\r\n    Dim acc As New Access.Application\r\n    acc.OpenCurrentDatabase \"C:\\Users\\rchoudh\\Documents\\GEC Project\\versions\\final\\Employee_application_Version_Final_Version.mdb\"\r\n    acc.DoCmd.transferspreadsheet _\r\n            TransferType:=acImport, _\r\n            SpreadSheetType:=acSpreadsheetTypeExcel12Xml, _\r\n            TableName:=\"SavedSchedule\", _\r\n            Filename:=Application.ActiveWorkbook.FullName, _\r\n            HasFieldNames:=True, _\r\n            Range:=\"SavedSchedule$A1:R10000\"\r\n    acc.CloseCurrentDatabase\r\n    acc.Quit\r\n    Set acc = Nothing\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 28, "user_id": 4530736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6208429024e57400212be4e75a9cf6?s=128&d=identicon&r=PG&f=1", "display_name": "JohnCitezen", "link": "https://stackoverflow.com/users/4530736/johncitezen"}, "edited": false, "score": 0, "creation_date": 1424261198, "post_id": 28583275, "comment_id": 45473999, "body": "Paste the code into a module. Adding a button to the spread sheet will make it easy to use"}], "tags": [], "owner": {"reputation": 28, "user_id": 4530736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6208429024e57400212be4e75a9cf6?s=128&d=identicon&r=PG&f=1", "display_name": "JohnCitezen", "link": "https://stackoverflow.com/users/4530736/johncitezen"}, "is_accepted": false, "score": 0, "last_activity_date": 1424261106, "creation_date": 1424261106, "answer_id": 28583275, "question_id": 28581013, "link": "https://stackoverflow.com/questions/28581013/find-nearest-cell-with-a-specific-value-in-vba/28583275#28583275", "title": "find nearest cell with a specific value in vba", "body": "<p>This is a Macro that uses the method you suggest.\nWhen a child is selected and the macro is run it will find the closest parent above the child providing:</p>\n\n<p>1) A1 is blank</p>\n\n<p>2) There is a blank cell between each family</p>\n\n<p>3) The families are in column A</p>\n\n<pre><code>Sub FindParent()\n    Dim ChildRow As Integer\n    Dim line As Integer\n    Dim Pline As Variant\n    Dim Parent As String\n\n    ChildRow = ActiveCell.Row   'find the row of the child\n    line = 1                                 'Start at row one\n\n    Do Until line = ChildRow        'check each cell if it is blank, if so the next cell is a parent.\n        If Range(\"A\" &amp; CStr(line)).Value = \"\" Then\n            Pline = line + 1\n        End If\n        line = line + 1\n    Loop\n\n    Parent = Range(\"A\" &amp; Pline).Value\n    MsgBox (\"The parent of \" &amp; ActiveCell.Value &amp; \" is \" &amp; Parent &amp; \".\")\n\nEnd Sub\n</code></pre>\n\n<p>This returns the result in a message box however this can easily be changed</p>\n"}], "owner": {"reputation": 1835, "user_id": 2443476, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/7fafc67c892104145e8296b2242f4d43?s=128&d=identicon&r=PG", "display_name": "user2443476", "link": "https://stackoverflow.com/users/2443476/user2443476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 434, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1424261106, "creation_date": 1424254576, "last_edit_date": 1531164843, "question_id": 28581013, "link": "https://stackoverflow.com/questions/28581013/find-nearest-cell-with-a-specific-value-in-vba", "title": "find nearest cell with a specific value in vba", "body": "<p>I have to developp a little program in vba (which I don't use very much).</p>\n\n<p>I have a sheet with \"parent\" lines, and for each parent, I have a list of \"child\" lines :</p>\n\n<pre><code>line 1 parent\nline 2 childa\nline 3 childb\nline 4\nline 5 parent\nline 6 childc\nline 7 childd\nline 8\nline 9 parent\nline 10 childe\n</code></pre>\n\n<p>I have to export these data in a new file, and be able to tell from each child at which parent he is connected.</p>\n\n<p>To do that I want to develop a macro with the following principe :</p>\n\n<p>For a child, I keep his line number in memory, then I do a findnext on parent until I exceed the line keep in memory. Basically when I am on a child, I want to find the cell of his closest parent starting from the top of the sheet.\nExemple : I call a function with the input parameter 2, I would like to get in return line 1.\ninput : line 7, return : line 5</p>\n\n<p>As I am not very familiar with vba, I am struggling a lot, thanks in advance for your help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1424254279, "post_id": 28580781, "comment_id": 45469840, "body": "Where is the Logic? Where did <code>Paul</code> come from?"}, {"owner": {"reputation": 621, "user_id": 2533944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21e51bd2ba24e85ada3874654d411592?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/2533944/julian"}, "edited": false, "score": 1, "creation_date": 1424254542, "post_id": 28580781, "comment_id": 45470013, "body": "Yes we can do this. What have you tried so far by yourself? And did you try using the SO search or maybe google?"}, {"owner": {"reputation": 3391, "user_id": 1904460, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bc9385eaf2bc405e21663f8650bf8de1?s=128&d=identicon&r=PG", "display_name": "DevelopmentIsMyPassion", "link": "https://stackoverflow.com/users/1904460/developmentismypassion"}, "edited": false, "score": 0, "creation_date": 1424254969, "post_id": 28580781, "comment_id": 45470319, "body": "Please let us know what logic we should use? If column B is John then will it be always John Paul ?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1424255149, "post_id": 28580781, "comment_id": 45470419, "body": "I wonder why everyone cares about the meaning of the question. The question is related to VBA basics, unless more information is provided."}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1424255397, "post_id": 28580781, "comment_id": 45470580, "body": "@stribizhev If the question is as simple as your answer implies then there&#39;s most likely a duplicate somewhere on the site, which would mean this question needs to be closed as a dupe. As it stands it&#39;s already either &#39;Too Broad&#39; or &#39;Unclear&#39;, depending on your personal interpretations of those close reasons. Those asking for clarification want the OP to improve his question so it&#39;s a good fit for SO, instead of wasting their time answering crap. Unclear questions probably shouldn&#39;t be answered because a clarification could make your answer entirely invalid and it justifies the crap question."}, {"owner": {"reputation": 13, "user_id": 2992797, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100001154013195/picture?type=large", "display_name": "kimizito", "link": "https://stackoverflow.com/users/2992797/kimizito"}, "edited": false, "score": 0, "creation_date": 1424255476, "post_id": 28580781, "comment_id": 45470641, "body": "This is just an example: If A &quot;student&quot; matching B &quot;John&quot;, then we should B &quot;Paul&quot; to &quot;Jonh Paul&quot;, or any other name we want, like &quot;Andy&quot;."}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1424255598, "post_id": 28580781, "comment_id": 45470729, "body": "@user2992797 You need to provide more than just an example and you should show evidence of attempting the problem yourself as well as detailing what&#39;s not working with your own attempted solution. As it stands the only actual question in your post is &quot;Can we do this?&quot; to which the answer is objectively &quot;Yes&quot; but I strongly suspect that won&#39;t solve the problem you&#39;re trying to solve."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 2992797, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100001154013195/picture?type=large", "display_name": "kimizito", "link": "https://stackoverflow.com/users/2992797/kimizito"}, "is_accepted": false, "score": -1, "last_activity_date": 1424257102, "last_edit_date": 1424257102, "creation_date": 1424256270, "answer_id": 28581623, "question_id": 28580781, "link": "https://stackoverflow.com/questions/28580781/excel-vba-search-and-replace-if-conditional/28581623#28581623", "title": "Excel VBA: Search and Replace If/Conditional", "body": "<p>Answering my question. Works for me:</p>\n\n<pre><code>Sub ChangeJohn()\n\nDim x As Integer\nDim i As Integer\n\nx = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 1 To x\n\nIf Range(\"A\" &amp; i).Value = \"Student\" Then\n    If Range(\"B\" &amp; i).Value = \"John\" Then\n        Range(\"B\" &amp; i).Value = \"John Paul\"\n    End If\nEnd If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 2992797, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100001154013195/picture?type=large", "display_name": "kimizito", "link": "https://stackoverflow.com/users/2992797/kimizito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1424257102, "creation_date": 1424253920, "question_id": 28580781, "link": "https://stackoverflow.com/questions/28580781/excel-vba-search-and-replace-if-conditional", "title": "Excel VBA: Search and Replace If/Conditional", "body": "<p>Can we do this with VBA?</p>\n\n<p>If text on column A = \"Student\" and text on column B = \"John\", replace B text with \"John Paul\".</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "ms-access", "goto"], "answers": [{"comments": [{"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1424263052, "post_id": 28581265, "comment_id": 45475085, "body": "In terms of structure and program flow this code is very similar to my given example, just with different syntax. With that in mind this would be a better answer if you could add some details about why the change in syntax is beneficial, what pitfalls does it avoid that I might hit with <code>GoTo</code>?"}, {"owner": {"reputation": 113, "user_id": 2990792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b2dc89279e999e4dd66de4767bae6?s=128&d=identicon&r=PG&f=1", "display_name": "Paras Gera", "link": "https://stackoverflow.com/users/2990792/paras-gera"}, "reply_to_user": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1424327704, "post_id": 28581265, "comment_id": 45505885, "body": "GoTo has to be used with real caution as it may make the code to be really complex after some iterations in the code. Also with GoTo, it allows you to do very weird/ugly things, such as jump out of scope without actually going out of scope, etc. With the Do loop you ensure the flow of the code, maintain the sanity and readability of the code."}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1424332092, "post_id": 28581265, "comment_id": 45507599, "body": "Good justification there but it&#39;s best to edit further information into your answer rather than just leaving it as a comment :)"}], "tags": [], "owner": {"reputation": 113, "user_id": 2990792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b2dc89279e999e4dd66de4767bae6?s=128&d=identicon&r=PG&f=1", "display_name": "Paras Gera", "link": "https://stackoverflow.com/users/2990792/paras-gera"}, "is_accepted": false, "score": 3, "last_activity_date": 1424356523, "last_edit_date": 1424356523, "creation_date": 1424255273, "answer_id": 28581265, "question_id": 28580651, "link": "https://stackoverflow.com/questions/28580651/is-there-a-way-i-can-avoid-using-goto-in-this-situation/28581265#28581265", "title": "Is there a way I can avoid using GoTo in this situation?", "body": "<p>GoTo can be replaced by using a do-while block (which has a false condition and runs only once) and using 'Exit Do' wherever you want to skip the rest of the code.</p>\n\n<p>So your code might now look like:</p>\n\n<pre><code>Private Sub cmdDoTheThing_Click()\nOn Error GoTo Err_cmdDoTheThing\n\n    Do\n        Screen.MousePointer = 11 'Hourglass/Equivalent\n\n        'Check all data is available to Do The Thing\n        If Not MyModule.ThingIsDoable(Me.PrimaryKey) Then\n            MsgBox \"Cannot Do The Thing, more preliminary things must be done first.\"\n            Exit Do\n        End If\n\n        'Try to Do The Thing (function returns false on failure)\n        If Not MyModule.DoTheThing(Me.PrimaryKey) Then\n            MsgBox \"Processing of The Thing failed.\"\n            Exit Do\n        End If\n\n        '...\n        'Stuff here I don't want to do if either of the above failed\n        '...\n    Loop While FALSE\n\nExit_cmdDoTheThing:\n    Screen.MousePointer = 0 'Default mouse pointer\n    Exit Sub\n\nErr_cmdDoTheThing:\n    MsgBox \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description\n    Resume Exit_DoTheThing\nEnd Sub\n</code></pre>\n\n<p>GoTo has to be used with real caution as it may make the code really complex after some iterations in the code. GoTo also allows you to do very weird/ugly things such as jump out of scope without actually going out of scope. With the do-while you ensure the flow of the code while maintaining the sanity and readability of the code.</p>\n"}, {"tags": [], "owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "is_accepted": true, "score": 1, "last_activity_date": 1425550087, "creation_date": 1425550087, "answer_id": 28875130, "question_id": 28580651, "link": "https://stackoverflow.com/questions/28580651/is-there-a-way-i-can-avoid-using-goto-in-this-situation/28875130#28875130", "title": "Is there a way I can avoid using GoTo in this situation?", "body": "<p>Raising a custom error can avoid the use of GoTo for subroutines with this error handling structure. This has the added benefit of making it clear to anyone reading the code that failure of certain functions to complete is considered an error in this situation, even if they do not raise an error upon failure.</p>\n\n<pre><code>Public Const cCustomErrNum = 9114\n\nPrivate Sub cmdDoTheThing_Click()\nOn Error GoTo Err_cmdDoTheThing\n\n    Screen.MousePointer = 11 'Hourglass/Equivalent\n\n    'Check all data is available to Do The Thing\n    If Not MyModule.ThingIsDoable(Me.PrimaryKey) Then\n        Err.Raise cCustomErrNum,\"cmd_DoTheThing_Click()\", _\n            \"Cannot Do The Thing, more preliminary things must be done first.\"\n    End If\n\n    'Try to Do The Thing (function returns false on failure)\n    If Not MyModule.DoTheThing(Me.PrimaryKey) Then\n        Err.Raise cCustomErrNum,\"cmd_DoTheThing_Click()\", _\n            \"Processing of The Thing failed.\"\n    End If\n\n    '...\n    'Stuff here I don't want to do if either of the above failed\n    '...\n\nExit_cmdDoTheThing:\n    Screen.MousePointer = 0 'Default mouse pointer\n    Exit Sub\n\nErr_cmdDoTheThing:\n    MsgBox \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description\n    Resume Exit_DoTheThing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 28875130, "answer_count": 2, "score": 1, "last_activity_date": 1425550087, "creation_date": 1424253573, "question_id": 28580651, "link": "https://stackoverflow.com/questions/28580651/is-there-a-way-i-can-avoid-using-goto-in-this-situation", "title": "Is there a way I can avoid using GoTo in this situation?", "body": "<p>So I've got a sub (triggered by a command button) which runs a process that seems quite time-consuming (between 5 and 20 seconds, dependant on the machine and how co-operative our network is feeling). To make it clear to the user that stuff is happening that they can't see I change the mouse pointer to an hourglass then change it back when the sub exits, regardless of the reason for the exit.</p>\n\n<p>With that in mind my code looks something like this (illustrative example, not actual code):</p>\n\n<pre><code>Private Sub cmdDoTheThing_Click()\nOn Error GoTo Err_cmdDoTheThing\n\n    Screen.MousePointer = 11 'Hourglass/Equivalent\n\n    'Check all data is available to Do The Thing\n    If Not MyModule.ThingIsDoable(Me.PrimaryKey) Then\n        MsgBox \"Cannot Do The Thing, more preliminary things must be done first.\"\n        GoTo Exit_cmdDoTheThing\n    End If\n\n    'Try to Do The Thing (function returns false on failure)\n    If Not MyModule.DoTheThing(Me.PrimaryKey) Then\n        MsgBox \"Processing of The Thing failed.\"\n        GoTo Exit_cmdDoTheThing\n    End If\n\n    '...\n    'Stuff here I don't want to do if either of the above failed\n    '...\n\nExit_cmdDoTheThing:\n    Screen.MousePointer = 0 'Default mouse pointer\n    Exit Sub\n\nErr_cmdDoTheThing:\n    MsgBox \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description\n    Resume Exit_DoTheThing\nEnd Sub\n</code></pre>\n\n<p>I don't want to repeat <code>Screen.MousePointer = 0</code> at every possible exit point so I figured a GoTo would serve as a decent shortcut since the <code>Exit_cmdDoTheThing</code> label was needed for error handling anyway.</p>\n\n<p>Is this a valid use-case for a GoTo statement and if not is there some other way I can achieve the same result? I don't want a sudden <a href=\"http://xkcd.com/292/\" rel=\"nofollow\">raptor attack</a> after all.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1424252340, "post_id": 28580104, "comment_id": 45468603, "body": "What have you declared <code>a</code>, <code>b</code>, <code>c</code> as? <code>Val(Null)</code> would result in <b>Invalid Use of Null</b> error."}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1424252918, "post_id": 28580104, "comment_id": 45468969, "body": "Which line throws the error ... what kind of objects are <code>txtStart</code>, <code>txtEnd</code>, <code>txtEffort</code> ?"}, {"owner": {"reputation": 115, "user_id": 4025565, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/13ba3984f46eb06d51c72a63c2b02c73?s=128&d=identicon&r=PG&f=1", "display_name": "xtina1231", "link": "https://stackoverflow.com/users/4025565/xtina1231"}, "edited": false, "score": 0, "creation_date": 1424315351, "post_id": 28580104, "comment_id": 45502303, "body": "I forgot to add these codes:  <code>Dim a As Date  Dim b As Date  Dim c As Double</code>"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1569756070, "post_id": 28580104, "comment_id": 102692350, "body": "Did my answer below help?"}], "answers": [{"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 0, "last_activity_date": 1482132964, "last_edit_date": 1482132964, "creation_date": 1424254141, "answer_id": 28580859, "question_id": 28580104, "link": "https://stackoverflow.com/questions/28580104/i-am-getting-run-time-error-13-type-mismatch/28580859#28580859", "title": "I am getting Run-Time Error &#39;13&#39;: Type Mismatch", "body": "<p>Judging by the code posted, time is being compared.</p>\n\n<p>The problem arises because <a href=\"http://www.techonthenet.com/excel/formulas/abs.php\" rel=\"nofollow noreferrer\"><code>Abs</code></a> expects a number, but in fact, a string is subtracted from a string, which causes an exception to throw.</p>\n\n<p>If <code>a</code> and <code>b</code> are string variables holding values like \"16:00\" that are later formatted into \"4:00\", I suggest implementing a function to calculate the time in minutes, and then their difference.</p>\n\n<p>Here is the function:</p>\n\n<pre><code>Function ConvertToMinutes(ByVal time_str As String) As Integer\nConvertToMinutes = 0\nOn Error GoTo Ende\nsplts = Split(time_str, \":\")\nConvertToMinutes = CInt(splts(0)) * 60 + CInt(splts(1))\nEnde:\nOn Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>Then, the code will look like</p>\n\n<pre><code>a = Trim(Format(txtStart.Text, \"hh:mm AMPM\"))\nb = Trim(Format(txtEnd.Text, \"hh:mm AMPM\"))\nC = Abs(ConvertToMinutes(b) - ConvertToMinutes(a)) * 24\n</code></pre>\n\n<p>Please adjust the calculations so that you get the required result.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1424255234, "last_edit_date": 1424255234, "creation_date": 1424254298, "answer_id": 28580916, "question_id": 28580104, "link": "https://stackoverflow.com/questions/28580104/i-am-getting-run-time-error-13-type-mismatch/28580916#28580916", "title": "I am getting Run-Time Error &#39;13&#39;: Type Mismatch", "body": "<p>You cannot throw text that looks like a date, time or datetime into the <code>Format</code> function without converting them to real dates.</p>\n\n<pre><code>  a = Format(CDate(txtStart.Text), \"hh:mm AMPM\")\n  b = Format(CDate(txtEnd.Text), \"hh:mm AMPM\")\n</code></pre>\n\n<p>You could also use <code>TimeValue</code> for the time. The <code>DateValue</code> function will only see the date portion of the text string. <code>CDate</code> sees both the date and time.</p>\n\n<p><strong>Addendum:</strong></p>\n\n<p>You will have the same problem with <code>c = Abs(b - a) * 24</code>. The output of the <code>Format</code> function is text so both <em>a</em> &amp; <em>b</em> will now be text representations of time. You need to convert them back to doubles representing time with <code>c = Abs(TimeValue(b) - TimeValue(a)) * 24</code>.</p>\n\n<p>You haven't provided much in the way of detail. There is probably a better way to do this.</p>\n"}], "owner": {"reputation": 115, "user_id": 4025565, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/13ba3984f46eb06d51c72a63c2b02c73?s=128&d=identicon&r=PG&f=1", "display_name": "xtina1231", "link": "https://stackoverflow.com/users/4025565/xtina1231"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482134381, "creation_date": 1424251961, "last_edit_date": 1482134381, "question_id": 28580104, "link": "https://stackoverflow.com/questions/28580104/i-am-getting-run-time-error-13-type-mismatch", "title": "I am getting Run-Time Error &#39;13&#39;: Type Mismatch", "body": "<p>I am having problems with my syntax below. I keep on getting Run Time error.\nPlease advise.</p>\n\n<pre><code>Dim a As Date Dim b As Date Dim c As Double\n\nIf Val(txtStart.Text) = Null Or Val(txtEnd.Text) = Null Then\n            Cells(eRow, 6).Value = txtEffort.Value\n        Else\n            a = Format(txtStart.Text, \"hh:mm AMPM\")\n            b = Format(txtEnd.Text, \"hh:mm AMPM\")\n            c = Abs(b - a) * 24\n            Cells(eRow, 6).Value = c\n        End If`\n</code></pre>\n\n<p>Your prompt response is much appreciated! Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2742, "user_id": 2519002, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f3ad6ad7d235bb93277b731f1c80280a?s=128&d=identicon&r=PG", "display_name": "Vasim", "link": "https://stackoverflow.com/users/2519002/vasim"}, "edited": false, "score": 0, "creation_date": 1424252485, "post_id": 28579913, "comment_id": 45468692, "body": "What does add-in do? I mean what is suppose to happen after you paste?"}, {"owner": {"reputation": 11, "user_id": 4578808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/372929edfdbf2f753f60566115bc7296?s=128&d=identicon&r=PG&f=1", "display_name": "Divyansh Darji", "link": "https://stackoverflow.com/users/4578808/divyansh-darji"}, "reply_to_user": {"reputation": 2742, "user_id": 2519002, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f3ad6ad7d235bb93277b731f1c80280a?s=128&d=identicon&r=PG", "display_name": "Vasim", "link": "https://stackoverflow.com/users/2519002/vasim"}, "edited": false, "score": 0, "creation_date": 1424262643, "post_id": 28579913, "comment_id": 45474866, "body": "There are background calculations by the add-in after the values are pasted."}, {"owner": {"reputation": 2742, "user_id": 2519002, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f3ad6ad7d235bb93277b731f1c80280a?s=128&d=identicon&r=PG", "display_name": "Vasim", "link": "https://stackoverflow.com/users/2519002/vasim"}, "edited": false, "score": 0, "creation_date": 1424264673, "post_id": 28579913, "comment_id": 45476001, "body": "Did you try <a href=\"http://www.dplot.com/blog/2010/03/calling-excel-add-in-functions-from-a-macro.html\" rel=\"nofollow noreferrer\">this</a>"}], "owner": {"reputation": 11, "user_id": 4578808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/372929edfdbf2f753f60566115bc7296?s=128&d=identicon&r=PG&f=1", "display_name": "Divyansh Darji", "link": "https://stackoverflow.com/users/4578808/divyansh-darji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1424261327, "creation_date": 1424251358, "last_edit_date": 1424261327, "question_id": 28579913, "link": "https://stackoverflow.com/questions/28579913/how-to-run-add-in-in-background-while-using-a-macro", "title": "How to run Add-in in background while using a macro?", "body": "<p>Suppose i'm using an Add-in in my excel sheet. I have written a macro where i take input from my input sheet and paste it in the add-in and then i get the output in another sheet which should be displayed further.</p>\n\n<p>The problem is when i run the macro it doesnt wait for the post processing to be done by the add in and just displays the output which was there before in those output cells.</p>\n\n<p>I have tried using Wait and Sleep after pasting the input values to give some time to do the postprocessing but still it doesnt work..it gives the same output.</p>\n\n<p>And it runs fine if i add a break point after pasting which helps to run the background processing but i want to run it without break point</p>\n\n<p>Please Help!</p>\n\n<pre><code>For j = 1 To i ' loop to check if case is selected\n\nChk = \"Chk_Case\" &amp; j\nIf Me.Controls(Chk).Value = True Then\n' For h = 1 To j ' if case is selected, inputs will be used to generate output and will be put in datasheet\n    ' to get col no of selected case\n    Case_Name = Me.Controls(Chk).Caption\n\n    Column_number = Application.WorksheetFunction.Match(Case_Name, Sheets(\"Sheet3\").Range(\"A7:K7\"), 0)\n    ' to get column name of selected case\n    Col_Name = GetColumnName(Column_number)\n    ''input range\n    FinalRange = Col_Name &amp; \"8:\" &amp; Col_Name &amp; \"29\"\n    ''copy input and paste in sheet 1 for output\n    Sheets(\"Sheet3\").Activate\n    Sheets(\"Sheet3\").Range(FinalRange).Select\n    Selection.Copy\n    Sheets(\"Sheet1\").Activate\n    Sheets(\"Sheet1\").Range(\"C6:C27\").Select\n    ActiveSheet.Paste\n   'Application.Wait (Now + TimeValue(\"00:00:10\"))\n    Application.CutCopyMode = False\n        '''pasting output from sheet 24 to datasheet\n       ' Sleep (4000)\n\n\n\n        Application.CalculateFull\n        Sheets(\"Sheet24\").Activate\n        Sheets(\"Sheet24\").Range(\"B17:G39\").Select\n        'Application.Wait (Now + TimeValue(\"00:00:10\"))\n        Selection.Copy\n\n\n       ' Application.Wait (Now + TimeValue(\"00:00:08\"))\n\n\n        Sheets(\"Datasheet\").Activate\n        Sheets(\"Datasheet\").Cells(6, 14 + g).PasteSpecial Paste:=xlPasteValues\n        Sheets(\"Datasheet\").Cells(6, 14 + g).PasteSpecial Paste:=xlPasteFormats\n        Application.CutCopyMode = False\n\n        g = g + 6\n'Next h\nEnd If\nNext j\n</code></pre>\n"}, {"tags": ["excel", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1424297665, "post_id": 28579107, "comment_id": 45496599, "body": "The Google Maps JavaScript API will work much better."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5436420, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c17a768ac20ec4e514414a2f555b0867?s=128&d=identicon&r=PG", "display_name": "user5436420", "link": "https://stackoverflow.com/users/5436420/user5436420"}, "is_accepted": false, "score": 0, "last_activity_date": 1444648947, "last_edit_date": 1444648947, "creation_date": 1444648559, "answer_id": 33079745, "question_id": 28579107, "link": "https://stackoverflow.com/questions/28579107/error-message-as-object-required-while-using-ie-document-getelementbyidinfo-wi/33079745#33079745", "title": "Error Message as Object Required while using IE.Document.getElementById(&quot;info_window&quot;).innerText", "body": "<p>Try using</p>\n\n<pre><code>Set IE = new SHDocVw.InternetExplorer\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>Set IE = CreateObject(\"InternetExplorer.Application\")\n</code></pre>\n\n<p>this never failed to work for me.</p>\n"}], "owner": {"reputation": 1, "user_id": 4573390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c075aab9059597a4b8cafe21f62e6b52?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijeet Ghosh", "link": "https://stackoverflow.com/users/4573390/abhijeet-ghosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 990, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451931791, "creation_date": 1424248405, "last_edit_date": 1531164843, "question_id": 28579107, "link": "https://stackoverflow.com/questions/28579107/error-message-as-object-required-while-using-ie-document-getelementbyidinfo-wi", "title": "Error Message as Object Required while using IE.Document.getElementById(&quot;info_window&quot;).innerText", "body": "<p>I am very new to VBA programming &amp; have been trying to capture the text that gets popup on the google map when I search using GPS Coordinates (Latitude and Longitude). I have been using the website www.gps-coordinates.net.</p>\n\n<p>Till now I have been able to pass the GPS Coordinates to the website input boxes and got the button clicked and the address pops'up on the google map in a box. While I am trying to get the address from the box using <code>IE.Document.getElementById(\"info_window\").innerText</code>, I get an error message</p>\n\n<blockquote>\n  <p>Runtime Error '424' Object Required</p>\n</blockquote>\n\n<p>I am not able to understand which object the code is referring to. I have search the internet for a solution but couldn't find anyone facing similar kind of problem, so couldn't find a ready solution for  this. The code snippet is mentioned below:</p>\n\n<pre><code>Sub GetPlaceName()\n\n    Dim btn As Variant\n    Dim IE As Object, Doc As Object\n    Dim sDD1 As String, sDD2 As String\n    Dim vAdd As Variant\n    Dim lat As Integer, longt As Integer, latrow As Integer, longrow As Integer\n\n    latrow = ActiveSheet.Cells(Rows.Count, \"B\").End(xlUp).Row - 1\n    longrow = ActiveSheet.Cells(Rows.Count, \"C\").End(xlUp).Row - 1\n    If latrow &lt;&gt; longrow Then\n        MsgBox \"The number of Latitudes &amp; Longitudes are not equal. \" &amp; vbNewLine &amp; \" PleaseCheck....\"\n    Else\n        Range(\"B2\").Select\n        For i = 2 To latrow\n            Set IE = CreateObject(\"InternetExplorer.Application\")\n            IE.Visible = True\n            IE.navigate \"http://www.gps-coordinates.net/\"\n            Do\n                DoEvents\n            Loop Until IE.ReadyState = READYSTATE_COMPLETE\n            Set Doc = IE.Document\n            Doc.getElementById(\"latitude\").Value = Range(\"B\" &amp; i).Cells.Value\n            Doc.getElementById(\"longitude\").Value = Range(\"C\" &amp; i).Cells.Value\n            With Doc\n                Set elems = .getElementsByTagName(\"button\")\n                For Each e In elems\n                    If e.getAttribute(\"onclick\") = \"codeLatLng(1)\" Then\n                        e.Click\n                        Exit For\n                    End If\n                Next e\n            End With\n            Do\n                DoEvents\n            Loop Until IE.ReadyState = READYSTATE_COMPLETE\n            sDD1 = IE.Document.getElementById(\"info_window\").innerText\n            vAdd = Split(sDD1, vbNewLine)\n            Cells(i, \"E\").Value = vAdd\n            IE.Quit\n            Set IE = Nothing\n            Set Doc = Nothing\n        Next i\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I believe that there must be a very small error which I am not able to figure out. It must also appear to be very silly to some of you but I really need help to fix this. Hope to receive reply soon... Thanks in advance :-)</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 4005, "user_id": 4200092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saOd8.png?s=128&g=1", "display_name": "GoBusto", "link": "https://stackoverflow.com/users/4200092/gobusto"}, "edited": false, "score": 1, "creation_date": 1424248438, "post_id": 28579077, "comment_id": 45466537, "body": "It&#39;s not clear what you&#39;re asking. Please <a href=\"http://stackoverflow.com/help/how-to-ask\">provide additional details</a> and <a href=\"http://stackoverflow.com/help/mcve\">post your code</a> so that we can see <a href=\"http://whathaveyoutried.com\" rel=\"nofollow noreferrer\">what you have tried so far</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": true, "score": 0, "last_activity_date": 1424261933, "creation_date": 1424261933, "answer_id": 28583538, "question_id": 28579077, "link": "https://stackoverflow.com/questions/28579077/sort-between-two-dates-in-excel-userform/28583538#28583538", "title": "Sort between two dates in excel userform", "body": "<p>For getting the start and end date use simply</p>\n\n<pre><code>Sub test()\nDim Mindt As Date\nDim Maxdt As Date\n\nMindt = Application.WorksheetFunction.Min(Range(\"A1:A10\")) 'change range as needed\nMaxdt = Application.WorksheetFunction.Max(Range(\"A1:A10\")) 'change range as needed\n\nEnd Sub\n</code></pre>\n\n<p>Your cells in range must be formated as date</p>\n"}], "owner": {"reputation": 33, "user_id": 4578693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10200196082982381/picture?type=large", "display_name": "Ax3landra", "link": "https://stackoverflow.com/users/4578693/ax3landra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 28583538, "answer_count": 1, "score": -1, "last_activity_date": 1424261933, "creation_date": 1424248245, "last_edit_date": 1424255818, "question_id": 28579077, "link": "https://stackoverflow.com/questions/28579077/sort-between-two-dates-in-excel-userform", "title": "Sort between two dates in excel userform", "body": "<p>I have an excel database with several dates. My dates are in range D, and I want to fine the start date and end date from my range. Please help!</p>\n\n<p>I using this code:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Table_Name\").Range.AutoFilter Field:=4, _\nCriteria1:=txtSDate.Value, Operator:=xlAnd, Criteria2:=txtEDate.Value\n</code></pre>\n\n<p>And I also have two buttons using the code below:</p>\n\n<pre><code>Private Sub txtEDate_Change()\nIf txtEDate.Text = \"\" Then\n    MsgBox \"You must enter a Date! \"\n    Exit Sub\nEnd If\nIf txtEDate.TextLength = 2 Or txtEDate.TextLength = 5 Then\n    txtEDate.Text = txtEDate.Text + \".\"\nEnd If\nIf txtEDate.TextLength = 2 Or txtEDate.TextLength = 5 Then\ntxtEDate.Text = txtEDate.Text + \"DD/MM/YYYY\"\nEnd If\nEnd Sub\n\nPrivate Sub txtSDate_Change()\nIf txtSDate.Text = \"\" Then\n    MsgBox \"You must enter a Date! \"\n    Exit Sub\nEnd If\nIf txtSDate.TextLength = 2 Or txtSDate.TextLength = 5 Then\n    txtSDate.Text = txtSDate.Text + \".\"\nEnd If\nIf txtSDate.TextLength = 2 Or txtSDate.TextLength = 5 Then\ntxtSDate.Text = txtSDate.Text + \"DD/MM/YYYY\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "edited": false, "score": 0, "creation_date": 1424245750, "post_id": 28578362, "comment_id": 45465383, "body": "You should be able to do so using 3 loops. <code>First loop:</code> run the fourth octet from 0 to 255 - <code>Second loop:</code> once the fourth octet reaches 255, reset the variable for the fourth octet to 0 and add 1 to the variable for the third octet - <code>Third loop:</code> when your variable for the third octet reaches 255, exit the loop. Structure being <code>third loop&gt;second loop&gt;first loop</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424248698, "post_id": 28579014, "comment_id": 45466655, "body": "Btw, 192.168.1.0 is C0A50100."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 6, "last_activity_date": 1424248275, "last_edit_date": 1424248275, "creation_date": 1424247971, "answer_id": 28579014, "question_id": 28578362, "link": "https://stackoverflow.com/questions/28578362/generate-a-specific-range-of-ip-address-in-ms-excel/28579014#28579014", "title": "Generate a specific range of IP address in MS.Excel", "body": "<p>Your starting IP address is 10.1.1.1. That is 0A010101 IN HEX. Put that in a cell, let's say A2. Put this formula in B2,</p>\n\n<pre><code>=HEX2DEC(LEFT(A2, 2))&amp;\".\"&amp;HEX2DEC(MID(A2, 3, 2))&amp;\".\"&amp;HEX2DEC(MID(A2, 5, 2))&amp;\".\"&amp;HEX2DEC(RIGHT(A2, 2))\n</code></pre>\n\n<p>Now put this formula in A3,</p>\n\n<pre><code>=DEC2HEX(HEX2DEC(A2)+1, 8)\n</code></pre>\n\n<p>Copy the formula from B2 to B3 then fill A3:B3 down as far as you want.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/Tq62B.png\" alt=\"IP Addresses\"></p>\n"}, {"tags": [], "owner": {"reputation": 1478, "user_id": 2866644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ae52996b1232c611a06e92d7b9e505d?s=128&d=identicon&r=PG&f=1", "display_name": "robotik", "link": "https://stackoverflow.com/users/2866644/robotik"}, "is_accepted": false, "score": 1, "last_activity_date": 1469344439, "creation_date": 1469344439, "answer_id": 38549625, "question_id": 28578362, "link": "https://stackoverflow.com/questions/28578362/generate-a-specific-range-of-ip-address-in-ms-excel/38549625#38549625", "title": "Generate a specific range of IP address in MS.Excel", "body": "<p>here's an elementary solution</p>\n\n<p>in <code>A1</code> put 1000 for starting at <code>1.0</code> or 0 for srating at <code>0.0</code></p>\n\n<p>in <code>A2</code> put <code>=A1+IF(MOD(A1,1000)&lt;255,1,745)</code></p>\n\n<p>in <code>B1</code> put <code>=\"192.168.\" &amp; QUOTIENT(A1,1000) &amp; \".\" &amp; MOD(A1,1000)</code> (of course the <code>\"192.168.\"</code> part is your first two octet, modify it to taste) </p>\n\n<p>copy the formula from <code>B1</code> to <code>B2</code> then fill <code>A2:B2</code> down and voil\u00e0.</p>\n"}], "owner": {"reputation": 143, "user_id": 2473249, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/Jq5KZ.jpg?s=128&g=1", "display_name": "Saad Awan", "link": "https://stackoverflow.com/users/2473249/saad-awan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10456, "favorite_count": 3, "accepted_answer_id": 28579014, "answer_count": 2, "score": 5, "last_activity_date": 1469344439, "creation_date": 1424245049, "last_edit_date": 1531161705, "question_id": 28578362, "link": "https://stackoverflow.com/questions/28578362/generate-a-specific-range-of-ip-address-in-ms-excel", "title": "Generate a specific range of IP address in MS.Excel", "body": "<p>I want to generate a specific range of IP from <code>192.168.1.0</code> to <code>192.168.255.255</code></p>\n\n<p>How can I do that job in Microsoft Excel?</p>\n\n<p>I used these formulas, but not work for all range of IP address:</p>\n\n<pre><code>Excel IP Addresses Increment the Third Octet\n=\"10.1.\"&amp;ROWS($A$1:A1)&amp;\".1\"\nExcel IP Addresses Increment the Fourth Octet\n=\"10.1.1.\"&amp;ROWS($A$1:A1)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1424249539, "post_id": 28578286, "comment_id": 45467063, "body": "I think the best way to show what you want to do is to provide a snap shot of before and after data."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4037625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d017d79ad587158e4246e93f9c11feb?s=128&d=identicon&r=PG&f=1", "display_name": "user4037625", "link": "https://stackoverflow.com/users/4037625/user4037625"}, "edited": false, "score": 0, "creation_date": 1427453022, "post_id": 28579680, "comment_id": 46792431, "body": "L42, thank you very much!!  The first part works precisely well!  I am studying the second part to better understand the logic behind (.value = .value - .offset(1,0).Value.  I think I would figure it out as I do some more mock up runs."}, {"owner": {"reputation": 13, "user_id": 4037625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d017d79ad587158e4246e93f9c11feb?s=128&d=identicon&r=PG&f=1", "display_name": "user4037625", "link": "https://stackoverflow.com/users/4037625/user4037625"}, "edited": false, "score": 0, "creation_date": 1427453062, "post_id": 28579680, "comment_id": 46792458, "body": "My apologies for the late reply.  I have been struggling with this for sometime, and have been doing the task manually.  Thank you! thank you!"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 13, "user_id": 4037625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d017d79ad587158e4246e93f9c11feb?s=128&d=identicon&r=PG&f=1", "display_name": "user4037625", "link": "https://stackoverflow.com/users/4037625/user4037625"}, "edited": false, "score": 0, "creation_date": 1427495871, "post_id": 28579680, "comment_id": 46816254, "body": "@user4037625 Glad it helped. Btw, see <a href=\"http://stackoverflow.com/help/someone-answers\">accepting answers</a> as one way of saying thank you here in SO. It was explained <a href=\"http://stackoverflow.com/tour\">here</a> as well. Most of the things I know, I learned here. This is a good community, everybody is willing to answer as long as you post a <a href=\"http://blogs.msmvps.com/jonskeet/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">reasonable question</a>."}, {"owner": {"reputation": 13, "user_id": 4037625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d017d79ad587158e4246e93f9c11feb?s=128&d=identicon&r=PG&f=1", "display_name": "user4037625", "link": "https://stackoverflow.com/users/4037625/user4037625"}, "edited": false, "score": 0, "creation_date": 1427666884, "post_id": 28579680, "comment_id": 46859392, "body": "You got it captain.  My apol for not accepting the answer earlier!  Thanks very much again.  I will also contribute as much as I can."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 0, "last_activity_date": 1424250546, "creation_date": 1424250546, "answer_id": 28579680, "question_id": 28578286, "link": "https://stackoverflow.com/questions/28578286/excel-vba-insert-value-with-relative-values/28579680#28579680", "title": "Excel VBA - insert value with relative values", "body": "<p>Try this:</p>\n\n<pre><code>Dim r As Range, nrow As Long, orow As Long\nSet r = ActiveCell\nnrow = r.Offset(1, 0).Row: orow = r.Row\nr.EntireRow.Copy\nr.Offset(1, 0).Insert xlDown\n\nRange(\"O\" &amp; nrow) = -Range(\"O4\") 'reverse the sign\nRange(\"P\" &amp; nrow) = -Range(\"P4\") 'reverse the sign\nWith Range(\"P\" &amp; orow)\n    .Value = .Value - .Offset(1, 0).Value\nEnd With\n</code></pre>\n\n<p>For Step 7, you cannot assign it as formula because that would be circular referencing.<br>\nAbove code already put the result in P30 (based on your example above). HTH.</p>\n"}], "owner": {"reputation": 13, "user_id": 4037625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d017d79ad587158e4246e93f9c11feb?s=128&d=identicon&r=PG&f=1", "display_name": "user4037625", "link": "https://stackoverflow.com/users/4037625/user4037625"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "accepted_answer_id": 28579680, "answer_count": 1, "score": 1, "last_activity_date": 1568429275, "creation_date": 1424244739, "last_edit_date": 1568429275, "question_id": 28578286, "link": "https://stackoverflow.com/questions/28578286/excel-vba-insert-value-with-relative-values", "title": "Excel VBA - insert value with relative values", "body": "<p>Would appreciate help of the experts!</p>\n\n<p>I am trying to write a code where:</p>\n\n<ol>\n<li>I select a cell and execute the macro  (say cell is L30)</li>\n<li>VBA copies the entire row that contain the active cell (whole data (mix of formula and hard coded numbers) from row 30 is copied)</li>\n<li>VBA inserts a new row beneath the copied row (so data in row 30 is moved down to row 31)</li>\n<li><p>VBA pastes the new row (row 31) with formula and hard coded numbers from copied row (row 30)</p></li>\n<li><p>In the new row's column O, VBA inserts numerical value from cell \"O4\" but in reverse sign (O7 has a number but it is based on a formula)</p></li>\n<li><p>In the new row's column P, VBA inserts numberical value from cell \"R4\" but in reverse sign (R4 also has a number but it is based on a formula)</p></li>\n<li><p>In P30, VBA inserts a formula where \"=original P30 value - P31\"</p></li>\n</ol>\n\n<p>I have written the code per below.  This seems to accomplish 1,2,3,4,5, but only partial 4 and 5 because I can't seem to put negative sign for the value O7 and R4 and inserting them into the new row.</p>\n\n<p>Step 6.. is something that I couldn't even get the ball rolling... </p>\n\n<p>I understand that this is a lot of steps that I am asking for.<br>\nSome guidance or hints would much appreciated.</p>\n\n<p>Thanks,</p>\n\n<pre><code>ActiveCell.Offset(1, 0).EntireRow.INSERT\nActiveCell.EntireRow.Copy ActiveCell.Offset(1, 0).EntireRow\n\nRange(\"O4\").Copy ActiveCell.Offset(1, 4)\nRange(\"R4\").Copy ActiveCell.Offset(1, 5)\n</code></pre>\n"}, {"tags": ["excel", "vba", "mailmerge"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1424243862, "post_id": 28577815, "comment_id": 45464591, "body": "I guess you SQL result with <code>null</code> if any data missing. What if you return <code>EmptyString</code> instead? With this dialog box- have you tried something like this: <a href=\"https://msdn.microsoft.com/en-us/library/ff192373(v=office.14).aspx\" rel=\"nofollow noreferrer\"><code>Application.DisplayAlerts</code></a>"}, {"owner": {"reputation": 13, "user_id": 4578419, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TrHNAKrKU94/AAAAAAAAAAI/AAAAAAAAADU/GYUSlRo-e4A/photo.jpg?sz=128", "display_name": "Ross Edwards", "link": "https://stackoverflow.com/users/4578419/ross-edwards"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1424295234, "post_id": 28577815, "comment_id": 45495304, "body": "Yeah I have.  I&#39;ve got a word application object called oWord and i&#39;ve set oWord.DisplayAlerts = wdAlertsNone The problem with the Null idea is that the SQL code is simply dumping the question and results in an iterative way.  There is no hardcoding to know what question/answer will exist.  Its only the mail merge document itself that has the specific code in it (as there will eventually be hundreds of these documents to match the inspection documents are engineers are using)."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 4578419, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TrHNAKrKU94/AAAAAAAAAAI/AAAAAAAAADU/GYUSlRo-e4A/photo.jpg?sz=128", "display_name": "Ross Edwards", "link": "https://stackoverflow.com/users/4578419/ross-edwards"}, "is_accepted": true, "score": 0, "last_activity_date": 1424656271, "creation_date": 1424656271, "answer_id": 28665846, "question_id": 28577815, "link": "https://stackoverflow.com/questions/28577815/vba-mail-merge-field-not-found-dialogue-box/28665846#28665846", "title": "VBA: Mail Merge - Field not found dialogue box", "body": "<p>Just incase someone else falls into a similar problem, here is how i solved this issue:</p>\n\n<ol>\n<li>Instead of opening up a datasource, open up a headersource instead.  In my case the headsource and data source are the same file.</li>\n<li>Compare the merge fields (&lt; word doc object >.MailMerge.Fields) to the fields inside your file (&lt; word doc object >.MailMerge.DataSource.FieldNames).  Delete each merge field when it is not found (&lt; MailMergeField >.delete).</li>\n<li>Open the data source as normal and set the first record to 2 if its the same file as your headerfile.</li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 4578419, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TrHNAKrKU94/AAAAAAAAAAI/AAAAAAAAADU/GYUSlRo-e4A/photo.jpg?sz=128", "display_name": "Ross Edwards", "link": "https://stackoverflow.com/users/4578419/ross-edwards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 28665846, "answer_count": 1, "score": 0, "last_activity_date": 1424656271, "creation_date": 1424242792, "question_id": 28577815, "link": "https://stackoverflow.com/questions/28577815/vba-mail-merge-field-not-found-dialogue-box", "title": "VBA: Mail Merge - Field not found dialogue box", "body": "<p>I've been writing a tool to extract data out of an SQL database via a set of ODBC tables inside Excel VBA and insert the information into some pre-formatted reports using a mail merge and a Word Object.  Some of the reports have some optional fields that may not always contain data.  In these occasions those optional fields will be absent in the database entirely.</p>\n\n<p>My code has been designed to be dynamic and produce the merge information (by way of a CSV file merged using VBA) using the question details in the database as the field headers.  My problem stems from when the option questions are absent from the output merge file and Word prompts the user to \"Remove Field\".  I've struggled to find a programmatic way to essentially answer this dialogue box on behalf of the user (which will always be to remove the field), or have word just know what to do and not require to ask.</p>\n\n<p>I've had no luck finding a module, command or function that will either tell the word object to clean this up automatically, or any handler to answer the question programmatically.  Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23458, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1424611049, "post_id": 28589798, "comment_id": 45612294, "body": "Have you tried deleting <i>all</i> &quot;*.exd&quot; files, as described in <a href=\"http://stackoverflow.com/questions/4495002/\">this question</a> and its answers?"}, {"owner": {"reputation": 71, "user_id": 4578409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5ad507ee1536e3125f05dcd606fe7ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Prem", "link": "https://stackoverflow.com/users/4578409/prem"}, "reply_to_user": {"reputation": 23458, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1425390589, "post_id": 28589798, "comment_id": 45936458, "body": "I have tried deleting all .exd files, but still that issue am facing."}], "answers": [{"tags": [], "owner": {"reputation": 1604, "user_id": 197559, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QwQOg.jpg?s=128&g=1", "display_name": "Kodak", "link": "https://stackoverflow.com/users/197559/kodak"}, "is_accepted": false, "score": 0, "last_activity_date": 1429717512, "creation_date": 1429717512, "answer_id": 29802603, "question_id": 28589798, "link": "https://stackoverflow.com/questions/28589798/object-library-invalid-or-contains-references-to-object-definitions-that-could/29802603#29802603", "title": "&quot;Object library invalid or contains references to object definitions that could not be found&quot; or &quot;Element not found&quot;", "body": "<p>I have uploaded c:\\windows\\syswow64\\fm20.dll from developers machine (newer) to the client (older) and it works fine now (both are 64 bit OSes). Unfortunately administrative privileges are required.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4949779, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205633299564337/picture?type=large", "display_name": "Francisco Javier Palacios Serr", "link": "https://stackoverflow.com/users/4949779/francisco-javier-palacios-serr"}, "is_accepted": false, "score": 0, "last_activity_date": 1600354962, "creation_date": 1600354962, "answer_id": 63940918, "question_id": 28589798, "link": "https://stackoverflow.com/questions/28589798/object-library-invalid-or-contains-references-to-object-definitions-that-could/63940918#63940918", "title": "&quot;Object library invalid or contains references to object definitions that could not be found&quot; or &quot;Element not found&quot;", "body": "<p>If copy only fm20.dll but It didn't work, but if you upload Languange Library fm20ENU.dll (or the properly language), works.</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1313521200, "open_beta_date": 1294686000, "closed_beta_date": 1294081200, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/dba/Img/apple-touch-icon@2.png", "twitter_account": "StackDBAs", "favicon_url": "https://cdn.sstatic.net/Sites/dba/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/dba/Img/apple-touch-icon.png", "audience": "database professionals who wish to improve their database skills and learn from others in the community", "site_url": "https://dba.stackexchange.com", "api_site_parameter": "dba", "logo_url": "https://cdn.sstatic.net/Sites/dba/Img/logo.png", "name": "Database Administrators", "site_type": "main_site"}, "on_date": 1424280046, "question_id": 93181}, "owner": {"reputation": 71, "user_id": 4578409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5ad507ee1536e3125f05dcd606fe7ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Prem", "link": "https://stackoverflow.com/users/4578409/prem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1308, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1600354962, "creation_date": 1424242617, "question_id": 28589798, "link": "https://stackoverflow.com/questions/28589798/object-library-invalid-or-contains-references-to-object-definitions-that-could", "title": "&quot;Object library invalid or contains references to object definitions that could not be found&quot; or &quot;Element not found&quot;", "body": "<p>I am getting this error when I open a workbook(Excel 2007) which having a ActiveX controls. I tried deleting MSForms.exd files, but still getting the same error message. Also I tried to add  MSCOMCTL.OCX file in references but no use.</p>\n\n<p>I would like to know if there any solution for this problem.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19, "user_id": 4574050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d7f83667ceee23b212c5d48f16c1923?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4574050/aaron"}, "edited": false, "score": 1, "creation_date": 1424273871, "post_id": 28577391, "comment_id": 45481957, "body": "Dane, thank you.  It&#39;s amazing how much help you can get from just having another set of eyes on an issue.  I&#39;m no expert, but a little embarrassed that the problem was literally staring me in the face.  Thanks again."}, {"owner": {"reputation": 734, "user_id": 4072870, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0ac60c8dfccd524dec0324413af2b6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dane I", "link": "https://stackoverflow.com/users/4072870/dane-i"}, "edited": false, "score": 0, "creation_date": 1424305319, "post_id": 28577391, "comment_id": 45499557, "body": "No worries. If my answer helped you out, please accept it as the answer"}, {"owner": {"reputation": 19, "user_id": 4574050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d7f83667ceee23b212c5d48f16c1923?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4574050/aaron"}, "reply_to_user": {"reputation": 734, "user_id": 4072870, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0ac60c8dfccd524dec0324413af2b6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dane I", "link": "https://stackoverflow.com/users/4072870/dane-i"}, "edited": false, "score": 1, "creation_date": 1424307384, "post_id": 28577391, "comment_id": 45500272, "body": "Sorry for my &quot;newbieness&quot; on the site, but where do I go to accept the answer?"}], "answers": [{"tags": [], "owner": {"reputation": 734, "user_id": 4072870, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0ac60c8dfccd524dec0324413af2b6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dane I", "link": "https://stackoverflow.com/users/4072870/dane-i"}, "is_accepted": true, "score": 0, "last_activity_date": 1424241530, "creation_date": 1424241530, "answer_id": 28577486, "question_id": 28577391, "link": "https://stackoverflow.com/questions/28577391/run-time-error-438-object-doesnt-support-this-property-or-method-error/28577486#28577486", "title": "Run-Time Error &#39;438&#39; object doesn&#39;t support this property or method error", "body": "<p>Your code repeats <code>ActiveCell.Offset</code>. This repetition needs to be removed.</p>\n"}], "owner": {"reputation": 19, "user_id": 4574050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d7f83667ceee23b212c5d48f16c1923?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4574050/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 0, "accepted_answer_id": 28577486, "answer_count": 1, "score": -3, "last_activity_date": 1424244980, "creation_date": 1424241094, "last_edit_date": 1424244980, "question_id": 28577391, "link": "https://stackoverflow.com/questions/28577391/run-time-error-438-object-doesnt-support-this-property-or-method-error", "title": "Run-Time Error &#39;438&#39; object doesn&#39;t support this property or method error", "body": "<p>I wish to loop through a spreadsheet with two date values to determine the number of months between the two dates.  My activecell is \"J2\" and the comparison values are in \"B2\" and \"C2\" respectively.  I'm attempting to use the DateDiff function to return the number of months between the two date values.<br>\nI was running a test on the code and encountered the following error message:  </p>\n\n<blockquote>\n  <p>\"Run-Time Error '438' object doesn't support this property or method\"</p>\n</blockquote>\n\n<p>I get the error message on the last line of code listed and don't understand why I'm getting the error on the activecell.offset.  I searched through similar questions, but was unable to find an answer for my problem.  Any help you can provide would be greatly appreciated.  Thanks.</p>\n\n<pre><code>Sub tstdate()\n\nDim IDate As Date    ' Declare variables.\nDim HDate As Date    ' Declare variables.\nDim cnt As Integer   ' Declare variables.\n\n\n    Range(\"j2\").Select\n    Do Until cnt = 7\n'\n    IDate = ActiveCell.OffsetActiveCell.Offset(0, -7)\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424241485, "post_id": 28577390, "comment_id": 45463638, "body": "Why do you say the Split &quot;doesn&#39;t work&quot; ?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 2, "creation_date": 1424243583, "post_id": 28577390, "comment_id": 45464471, "body": "have you tried something like: <code>Sheets(&quot;ws1&quot;).range(SplitFileLine(0)).value = SplitFileLine(1)</code> ?"}, {"owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1424251912, "post_id": 28577390, "comment_id": 45468354, "body": "@KazJaw . Can you please elaborate or give me a sample code??"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1424255391, "post_id": 28577390, "comment_id": 45470575, "body": "what I showed in my comment is just a sample code."}, {"owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424302255, "post_id": 28577390, "comment_id": 45498555, "body": "@TimWilliams i am fetching &quot;type Mismatch&quot; error where as  SplitFileLine is declared as variant."}, {"owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1424304803, "post_id": 28577390, "comment_id": 45499380, "body": "@KazJaw. That worked. Just tried it in real time. Thank you so much."}], "owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424244510, "creation_date": 1424241080, "last_edit_date": 1531164843, "question_id": 28577390, "link": "https://stackoverflow.com/questions/28577390/vba-copy-formatted-data-from-text-file-to-excel-worksheet-cell-address", "title": "VBA- Copy Formatted Data from Text File to Excel Worksheet (cell address)", "body": "<p>I have text file which has data mentioned below format </p>\n\n<pre><code>\"$B$6|9020541.78113024\"\n\"$C$6|91873471.2672928\"\n\"$D$6|596376192.52119\"\n\"$E$6|697270205.569613\"\n</code></pre>\n\n<p>Delimiters is \"|\"\nThe first half before the delimiter is the Cell Address (Say B6) and the second half is the value which has to be copied over the workbook to a specific sheet(Say worksheet1)</p>\n\n<p>I have already accomplished of loading the text file and read the content by looping but couldnt progress.</p>\n\n<pre><code>Open SplitTxtFile For Input As #1\n\nDo Until EOF(1)\n    Line Input #1, FileLine\n    Dim SplitFileLine As Variant\n    Dim newFileLine As String\n\n    newFileLine = Replace(FileLine, Chr(34), \"\")\n    SplitFileLine = Split(newFileLine, \"|\") ' This split doesnt work\n</code></pre>\n\n<p><code>'The data to be split and copy the value in appropriate cell address in the worksheet(ws1</code>)</p>\n\n<pre><code>Loop\n\nClose #1\n</code></pre>\n\n<p>Please help to progress further. Ignore the text file read portion which is already accomplished by reading the directory.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "filter", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 284, "user_id": 4294537, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a93aea8ae1e46b34575fe0e5b6cc3fa?s=128&d=identicon&r=PG&f=1", "display_name": "adrian", "link": "https://stackoverflow.com/users/4294537/adrian"}, "is_accepted": true, "score": 0, "last_activity_date": 1424242646, "creation_date": 1424242646, "answer_id": 28577766, "question_id": 28577067, "link": "https://stackoverflow.com/questions/28577067/perform-filtering-macro-on-an-excel-worksheet-in-a-workbook-from-another-worksh/28577766#28577766", "title": "perform filtering macro on an excel worksheet in a workbook, from another worksheet in a different workbook", "body": "<p>Try this out:</p>\n\n<pre><code>Sub filter_5PKT1_rows()\n\n\n\n\n    Dim file_name  As String\n    Dim sheet_name As String\n\n   file_name = \"C:\\Users\\Desktop\\pocket setter excel\\production_plan.xlsm\"  'Change to whatever file i want\n   sheet_name = \"production_plan\"   'Change to whatever sheet i want\n\n\n' we set wb as a new work book sonce we have to open it\n\nDim wb As New Workbook\n\n' To open and activate workbook, in this case production_plan\n' it opens and activates the workbook production_plan and activates the worksheet production plan\n' note: the work book has the name production_plan.xlsm and worksheet has the name production_plan\n\nSet wb = Application.Workbooks.Open(file_name)\n\nwb.Sheets(sheet_name).Activate\n\n    Dim My_Range As Range\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n\n\n    'Set filter range on ActiveSheet: A1 is the top left cell of the filter range\n    'and the header of the first column, L is the last column in the filter range.\n    'can also add the sheet name to the code like this\n\n Set My_Range = Range(\"A1:L\" &amp; LastRow(wb.ActiveSheet))\n\n ' select my range\n\n My_Range.Parent.Select\n\n If ActiveWorkbook.ProtectStructure = True Or _\n       My_Range.Parent.ProtectContents = True Then\n        MsgBox \"Sorry, not working when the workbook or worksheet is protected\", _\n               vbOKOnly, \"Copy to new worksheet\"\n        Exit Sub\n    End If\n\n    'Change ScreenUpdating, Calculation, EnableEvents, ....\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    wb.ActiveSheet.DisplayPageBreaks = False\n\n'Firstly, remove the AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n   ' My_Range.AutoFilter Field:=4, Criteria1:=\"=5PKT Men's\"\n\n   My_Range.AutoFilter Field:=4, Criteria1:=Array(\"5PKT Men's\", \"5PKT Women's\", \"5PKT Short\"), Operator:=xlFilterValues\n\n   ' subline and cs(commercial sample) line have no connection to pocket setter\n   ' therefore need to filter out these lines\n\n   My_Range.AutoFilter Field:=1, Criteria1:=Array(\"Band 01\", \"Band 02\", \"Band 03\", \"Band 04\", \"Band 05\", \"Band 06\", \"Band 07\", \"Band 08\", \"Band 09\", \"Band 10\", \"Band 11\", \"Band 12\", \"Band 13\", \"Band 14\", \"Band 15\", \"Band 16\", \"Band 17\", \"Band 18\", \"Band 19\", \"Band 20\"), Operator:=xlFilterValues\n\n ' DO NOT SORT ACCORDING TO ORDER QUANTITY.\n ' THIS IS BECAUSE THERE ARE INSTANCES,\n ' WHERE THE SAME STYLE NUMBER IS BROKEN INTO SEVERAL POS EACH HAVING VARYING ORDER QUANTITIES\n\n'Restore ScreenUpdating, Calculation, EnableEvents, ....\n    My_Range.Parent.Select\n    ActiveWindow.View = ViewMode\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\nEnd Sub\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlValues, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4577989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 1, "accepted_answer_id": 28577766, "answer_count": 1, "score": 3, "last_activity_date": 1424279655, "creation_date": 1424239575, "last_edit_date": 1424279655, "question_id": 28577067, "link": "https://stackoverflow.com/questions/28577067/perform-filtering-macro-on-an-excel-worksheet-in-a-workbook-from-another-worksh", "title": "perform filtering macro on an excel worksheet in a workbook, from another worksheet in a different workbook", "body": "<p>I have 2 work books, Book_1 and Book_2.</p>\n\n<p>I have written a macro to perform filtering functions.</p>\n\n<pre><code>    Sub filter_5PKT_rows()\n\n    Dim My_Range As Range\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n\n\n    'Set filter range on ActiveSheet: A1 is the top left cell of the filter range\n    'and the header of the first column, L is the last column in the filter range.\n    'can also add the sheet name to the code like this\n\n Set My_Range = Range(\"A1:L\" &amp; LastRow(ActiveSheet))\n\n ' select my range\n\n My_Range.Parent.Select\n\n If ActiveWorkbook.ProtectStructure = True Or _\n       My_Range.Parent.ProtectContents = True Then\n        MsgBox \"Sorry, not working when the workbook or worksheet is protected\", _\n               vbOKOnly, \"Copy to new worksheet\"\n        Exit Sub\n    End If\n\n    'Change ScreenUpdating, Calculation, EnableEvents, ....\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    ActiveSheet.DisplayPageBreaks = False\n\n'Firstly, remove the AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n   ' My_Range.AutoFilter Field:=4, Criteria1:=\"=5PKT Men's\"\n\n   My_Range.AutoFilter Field:=4, Criteria1:=Array(\"5PKT Men's\", \"5PKT Women's\", \"5PKT Short\"), Operator:=xlFilterValues\n\n   ' subline and cs(commercial sample) line have no connection to pocket setter\n   ' therefore need to filter out these lines\n\n   My_Range.AutoFilter Field:=1, Criteria1:=Array(\"Band 01\", \"Band 02\", \"Band 03\", \"Band 04\", \"Band 05\", \"Band 06\", \"Band 07\", \"Band 08\", \"Band 09\", \"Band 10\", \"Band 11\", \"Band 12\", \"Band 13\", \"Band 14\", \"Band 15\", \"Band 16\", \"Band 17\", \"Band 18\", \"Band 19\", \"Band 20\"), Operator:=xlFilterValues\n\n ' DO NOT SORT ACCORDING TO ORDER QUANTITY.\n ' THIS IS BECAUSE THERE ARE INSTANCES,\n ' WHERE THE SAME STYLE NUMBER IS BROKEN INTO SEVERAL POS EACH HAVING VARYING ORDER QUANTITIES\n\n'Restore ScreenUpdating, Calculation, EnableEvents, ....\n    My_Range.Parent.Select\n    ActiveWindow.View = ViewMode\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\nEnd Sub\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlValues, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>................................................................................</p>\n\n<p>This code works and performs the filtering according to my desire.</p>\n\n<p>Say i have rows in Book_1, worksheet_1,using the vba editor,</p>\n\n<p>i insert a module for VBA project Book_1 and type the coding,</p>\n\n<p>and run the macro, </p>\n\n<p>then the filtering occurs.</p>\n\n<p>............................................................................</p>\n\n<p><strong>But: This code will not enable me to perform filtering in Book_1 worksheet_1,</strong></p>\n\n<p><strong>if i place and execute the macro from Book_2 worksheet_1.</strong></p>\n\n<p><strong>I want to perform the filtering macro in Book_A worksheet1, from Book_2 worksheet1.</strong></p>\n\n<p><strong>How can this be done? How do i edit my coding?</strong> </p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424240404, "post_id": 28576820, "comment_id": 45463253, "body": "Sort your <code>old_text</code> values by length, so you replace the longest values first."}, {"owner": {"reputation": 581, "user_id": 4101357, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/711e556fb0305dc24b7c926a8da69a13?s=128&d=identicon&r=PG&f=1", "display_name": "Angad Arora", "link": "https://stackoverflow.com/users/4101357/angad-arora"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424241956, "post_id": 28576820, "comment_id": 45463826, "body": "Ahh Clever way to solve the problem (y), but i still think there would be a way out  by changing the code a little i suppose, i mean we just need to make vba consider the full cell value rather than just a part of the string. :)"}], "answers": [{"comments": [{"owner": {"reputation": 581, "user_id": 4101357, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/711e556fb0305dc24b7c926a8da69a13?s=128&d=identicon&r=PG&f=1", "display_name": "Angad Arora", "link": "https://stackoverflow.com/users/4101357/angad-arora"}, "edited": false, "score": 0, "creation_date": 1424247588, "post_id": 28578035, "comment_id": 45466172, "body": "Perfect :) ,Worked Like a Charm (y) Thank you soo much"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1424243693, "creation_date": 1424243693, "answer_id": 28578035, "question_id": 28576820, "link": "https://stackoverflow.com/questions/28576820/substitute-multi-values-excel-using-vba/28578035#28578035", "title": "Substitute Multi Values Excel using VBA", "body": "<p>If considering the full cell value is OK then:</p>\n\n<pre><code>Function SubstituteMultiple(text As String, old_text As Range, new_text As Range)\n\n    Dim i As Single, Result as String\n    Result = text\n    For i = 1 To old_text.Cells.Count\n        If text = old_text.Cells(i).Value Then\n            Result = new_text.Cells(i).Value\n            Exit For\n        End If\n    Next i\n    SubstituteMultiple = Result\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 4101357, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/711e556fb0305dc24b7c926a8da69a13?s=128&d=identicon&r=PG&f=1", "display_name": "Angad Arora", "link": "https://stackoverflow.com/users/4101357/angad-arora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "accepted_answer_id": 28578035, "answer_count": 1, "score": 0, "last_activity_date": 1424243693, "creation_date": 1424238413, "question_id": 28576820, "link": "https://stackoverflow.com/questions/28576820/substitute-multi-values-excel-using-vba", "title": "Substitute Multi Values Excel using VBA", "body": "<p>I have a working function created(written by someone else) with the help of VBA to replace multiple strings, my problem is it replaces the 1st instance not the full value of the string, i will explain with an example.</p>\n\n<p>Old Values</p>\n\n<ol>\n<li>Car </li>\n<li>Car Round Tyre</li>\n</ol>\n\n<p>New Values</p>\n\n<ol>\n<li>Bike </li>\n<li>Bus</li>\n</ol>\n\n<p>Now This Function can replace Car with Bike, but when it comes to \"Car Tyre\" it replaces Car with Bike and Ignores the \"Tyre\" Giving me Final Output as \"Bike Round Tyre\" but answer should be Bus</p>\n\n<pre><code>Function SubstituteMultiple(text As String, old_text As Range, new_text As Range)\nDim i As Single\nFor i = 1 To old_text.Cells.Count\n    Result = Replace(text, old_text.Cells(i), new_text.Cells(i))\n    text = Result\nNext i\nSubstituteMultiple = Result\nEnd Function\n</code></pre>\n\n<p>This Function is very helpful but just needs to be polished.</p>\n\n<p>Regards</p>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"tags": [], "owner": {"reputation": 3901, "user_id": 1201317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49cc80d6bc0b6e007248d660d1f6b7fa?s=128&d=identicon&r=PG", "display_name": "elrado", "link": "https://stackoverflow.com/users/1201317/elrado"}, "is_accepted": false, "score": 0, "last_activity_date": 1424240858, "last_edit_date": 1424240858, "creation_date": 1424237707, "answer_id": 28576685, "question_id": 28576588, "link": "https://stackoverflow.com/questions/28576588/vba-looping-issue-only-works-on-current-tab/28576685#28576685", "title": "VBA looping issue. Only works on current tab", "body": "<p><strong>Below code works</strong></p>\n\n<pre><code>Public Sub main()\n    Dim ws As Worksheet\n    For Each ws In ActiveWorkbook.Worksheets\n        ws.Cells(1, 2).Value = 11111\n    Next ws\nEnd Sub\n</code></pre>\n\n<p><strong>Try changing</strong></p>\n\n<pre><code>Dim ws As Worksheet For Each ws In ActiveWorkbook.Worksheets    \n     Call Update_OI    \nNext ws\n</code></pre>\n\n<p><strong>To</strong></p>\n\n<pre><code>Dim ws As Worksheet \nFor Each ws In ActiveWorkbook.Worksheets    \n     Call Update_OI    \nNext ws\n</code></pre>\n\n<p><strong><em>Or was it just copy paste formating problem. In this case I will remove my answer as it si no answer :).</em></strong></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4578168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bddbb7eb2a345e28418c171bb24897?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Smith", "link": "https://stackoverflow.com/users/4578168/ryan-smith"}, "edited": false, "score": 0, "creation_date": 1424297455, "post_id": 28577401, "comment_id": 45496489, "body": "Thanks for response.  I am getting a &quot;Reference not valid.&quot; error for the following code: ws.Cells(69, Colx).GoalSeek Goal:=goalvalue, _                    ChangingCell:=ws.Cells(10, Colx)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1424244030, "last_edit_date": 1424244030, "creation_date": 1424241130, "answer_id": 28577401, "question_id": 28576588, "link": "https://stackoverflow.com/questions/28576588/vba-looping-issue-only-works-on-current-tab/28577401#28577401", "title": "VBA looping issue. Only works on current tab", "body": "<p>You can pass the sheet object to <code>Update_OI</code>, and try <em>not</em> to use Select/Activate - you can almost always avoid that, and doing so will make your code more robust.</p>\n\n<pre><code>Sub UpdateAll()\n    Dim ws As Worksheet\n    For Each ws In ActiveWorkbook.Worksheets\n        Update_OI ws\n    Next ws\nEnd Sub\n\n\n\nSub Update_OI(ws as Worksheet)\n    Dim rng As Range, Colx As Long\n\n    For Colx = 3 To 81\n\n        Set rng = ws.Cells(10, Colx)\n\n        If rng.Offset(-8, 0).Value &lt;&gt; \"X\" And _\n           rng.Offset(-3, 0).Value &lt;&gt; 0 And _\n           Len(rng.Value) &gt; 0 Then \n\n\n            goalvalue = ws.Cells(70, Colx).Value\n\n            ws.Cells(69, Colx).GoalSeek Goal:=goalvalue, _\n                   ChangingCell:=ws.Cells(10, Colx)\n        End If\n\n    Next Colx\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4562, "user_id": 140187, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c625e8cc951231fc15116b3214fe24e?s=128&d=identicon&r=PG", "display_name": "The King", "link": "https://stackoverflow.com/users/140187/the-king"}, "is_accepted": true, "score": 0, "last_activity_date": 1424241472, "creation_date": 1424241472, "answer_id": 28577476, "question_id": 28576588, "link": "https://stackoverflow.com/questions/28576588/vba-looping-issue-only-works-on-current-tab/28577476#28577476", "title": "VBA looping issue. Only works on current tab", "body": "<p>Change your update all as below. It should work now.</p>\n\n<pre><code>Sub UpdateAll()\n   Dim ws As Worksheet\n   For Each ws In ActiveWorkbook.Worksheets\n        ws.Select\n        Call Update_OI\n    Next ws\n\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4578168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bddbb7eb2a345e28418c171bb24897?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Smith", "link": "https://stackoverflow.com/users/4578168/ryan-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 28577476, "answer_count": 3, "score": 0, "last_activity_date": 1424279675, "creation_date": 1424237268, "last_edit_date": 1424279675, "question_id": 28576588, "link": "https://stackoverflow.com/questions/28576588/vba-looping-issue-only-works-on-current-tab", "title": "VBA looping issue. Only works on current tab", "body": "<p>I am looking for a way with VBA in excel to loop through spreadsheet.  I found a lot of sites with recommendations on using a range function, but nothing specific enough that has solve the issues that I have. Macro will only work on current tab.  It will not loop through.</p>\n\n<pre><code>Sub UpdateAll()\n'\n' UpdateAll Macro\n'\n\nDim ws As Worksheet\nFor Each ws In ActiveWorkbook.Worksheets\n\nCall Update_OI\n\nNext ws\n\nEnd Sub\n\n\n\nSub Update_OI()\n'\n' Update_OI Macro\n\nDim rng As Range\n\n\nFor Colx = 3 To 81\n\n    Cells(10, Colx).Select\n\n\n  If ActiveCell.Offset(-8, 0) = \"X\" Then GoTo 4\n\n  If ActiveCell.Offset(-3, 0) = 0 Then GoTo 4\n\n  If ActiveCell.Value = vbNullString Then GoTo 4\n\n  If ActiveCell.Value &lt;&gt; vbNullString Then GoTo 1\n\n\n1\n    goalvalue = Cells(70, Colx).Value\n    Range(Cells(69, Colx), Cells(69, Colx)).GoalSeek Goal:=goalvalue, ChangingCell:=Range(Cells(10, Colx), Cells(10, Colx))\n\n\n4\nNext Colx\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1424235068, "creation_date": 1424235068, "answer_id": 28576208, "question_id": 28576130, "link": "https://stackoverflow.com/questions/28576130/function-does-not-pass-the-value/28576208#28576208", "title": "function does not pass the value", "body": "<p>Change:</p>\n\n<pre><code>Dim product, i, j, maxproduct As Long\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Dim product as long, i as long, j as long, maxproduct As Long\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>Dim i, j, count As Long\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Dim i as long, j as long, count As Long\n</code></pre>\n\n<p>I used to think putting it on the end applied it to everything on the row but it doesn't and I encountered a similar issue to you.</p>\n\n<p>I might add though, the way you have done this (assigning i and j to new variables a and b then using i and j in the second routine) is extremely confusing and I would strongly recommend against it.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4563541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9e653a974ae0cd39a9a05570c6aaf1?s=128&d=identicon&r=PG&f=1", "display_name": "amiros01", "link": "https://stackoverflow.com/users/4563541/amiros01"}, "edited": false, "score": 0, "creation_date": 1424263481, "post_id": 28576479, "comment_id": 45475333, "body": "Thank you very much guys for your help, assigning product and maxproduct in two separate lines fixed the problem."}, {"owner": {"reputation": 3, "user_id": 4563541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9e653a974ae0cd39a9a05570c6aaf1?s=128&d=identicon&r=PG&f=1", "display_name": "amiros01", "link": "https://stackoverflow.com/users/4563541/amiros01"}, "edited": false, "score": 0, "creation_date": 1424288640, "post_id": 28576479, "comment_id": 45491453, "body": "Is there any way to display intermediate values of the variables during debugging process. In C it is a valuable tool where one can spot a mistake immediately. Thank you"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3, "user_id": 4563541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9e653a974ae0cd39a9a05570c6aaf1?s=128&d=identicon&r=PG&f=1", "display_name": "amiros01", "link": "https://stackoverflow.com/users/4563541/amiros01"}, "edited": false, "score": 0, "creation_date": 1424288947, "post_id": 28576479, "comment_id": 45491663, "body": "@amiros01 - Too much information to be passed along here in any reasonable sense but you can start here - <a href=\"https://msdn.microsoft.com/en-us/library/h9b001cb(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Debuggin Macros</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1424237001, "last_edit_date": 1424237001, "creation_date": 1424236697, "answer_id": 28576479, "question_id": 28576130, "link": "https://stackoverflow.com/questions/28576130/function-does-not-pass-the-value/28576479#28576479", "title": "function does not pass the value", "body": "<p>First off, this is the wrong way to express what you are trying to accomplish. </p>\n\n<pre><code>maxproduct = product = 1\n</code></pre>\n\n<p>This says <em>\"maxproduct is equal to False\"</em>. <em>product</em> was just declared so it is for all intents and purposes a zero and not equal to <em>1</em>. You wanted to say,</p>\n\n<pre><code>maxproduct = 1\nproduct = 1\n</code></pre>\n\n<p>If you really need to put those last two on a single line then use a colon like this,</p>\n\n<pre><code>maxproduct = 1: product = 1\n</code></pre>\n\n<p>The same holds true for the similar syntax in the function.</p>\n\n<p>Now it is important to understand that VBA treats <em>True</em> as <em>-1</em> and <em>False</em> as <em>0</em> (<em>zero</em>). Since you are essentially initializing <em>maxproduct</em> and <em>product</em> as zeroes, you can multiply anything you want by it and you will still end up with zero. Again, the same holds true for the way this similar variable assignment was handled in the function.</p>\n\n<p>Here is my take on your project. </p>\n\n<pre><code>Option Explicit\n\nPublic Const maxA As Long = 20\nPublic Const maxB As Long = 50\nPublic Const cntC As Long = 13\n\nPublic Sub problem8()\n    Dim product As Long, i As Long, j As Long, maxproduct As Long\n    maxproduct = 1: product = 1\n\n    For i = 1 To maxA\n        For j = 1 To maxB\n            product = calcproduct(i, j)\n            If product &gt; maxproduct Then maxproduct = product\n        Next j\n    Next i\n    Range(\"AY1\").Value = maxproduct\nEnd Sub\n\nFunction calcproduct(ByVal a As Long, ByVal b As Long) As Long\n    Dim i As Long, j As Long, counter As Long\n    counter = 1: calcproduct = 1\n    For i = a To maxA\n        For j = b To maxB\n            calcproduct = Cells(i, j).Value * calcproduct\n            counter = counter + 1\n            If counter = cntC Then Exit Function\n        Next j\n    Next i\nEnd Function\n</code></pre>\n\n<p>I moved the limits to public constants which make it easier to modify for different sized regions. In your function you declared a <em>count</em> then started using a var called <em>counter</em> so I changed that to suit. As mentioned in another post, the variable declaration needs to be specific or you end up with a bunch of variants and a few longs.</p>\n"}], "owner": {"reputation": 3, "user_id": 4563541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9e653a974ae0cd39a9a05570c6aaf1?s=128&d=identicon&r=PG&f=1", "display_name": "amiros01", "link": "https://stackoverflow.com/users/4563541/amiros01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 28576479, "answer_count": 2, "score": 0, "last_activity_date": 1424237001, "creation_date": 1424234565, "question_id": 28576130, "link": "https://stackoverflow.com/questions/28576130/function-does-not-pass-the-value", "title": "function does not pass the value", "body": "<p>please help me with this problem. I'm just starting to use VBA and after searching the forum was not able to find a solution. I have 1000 single digit numbers in my spreadsheet. 20 rows of 50 numbers in each. my program suppose to find the largest product. For some reason my final answer is 0. I've done some debugging and the program goes through all the loops and iterations as expected. I suspect that my function does not pass the value back to my main </p>\n\n<pre><code>    Public Sub problem8()\n\nDim product, i, j, maxproduct As Long\nmaxproduct = product = 1\n\nFor i = 1 To 20\n    For j = 1 To 50\n        product = calcproduct(i, j)\n\n        If product &gt; maxproduct Then maxproduct = product\n    Next j\nNext i\nRange(\"AY1\").Value = maxproduct\n\nEnd Sub\n\nFunction calcproduct(ByVal a As Long, ByVal b As Long) As Long\n\nDim i, j, count As Long\ncounter = calcproduct = 1\nFor i = a To 20\n    For j = b To 50\n        calcproduct = Cells(i, j).Value * calcproduct\n        counter = counter + 1\n        If counter = 13 Then Exit Function\n    Next j\nNext i\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "loops", "excel", "merge"], "comments": [{"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 0, "creation_date": 1442095901, "post_id": 28575930, "comment_id": 52945339, "body": "feel free to mark my answer as your solution if it helped you"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4395512, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c9a23c07fb7b4b09fe3b26efa4c59f5e?s=128&d=identicon&r=PG&f=1", "display_name": "dcoder123", "link": "https://stackoverflow.com/users/4395512/dcoder123"}, "edited": false, "score": 0, "creation_date": 1424300053, "post_id": 28585701, "comment_id": 45497684, "body": "haven&#39;t checked where the problem is yet but it doesnt return any values when i run the macro with test variables."}, {"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "reply_to_user": {"reputation": 5, "user_id": 4395512, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c9a23c07fb7b4b09fe3b26efa4c59f5e?s=128&d=identicon&r=PG&f=1", "display_name": "dcoder123", "link": "https://stackoverflow.com/users/4395512/dcoder123"}, "edited": false, "score": 0, "creation_date": 1424332820, "post_id": 28585701, "comment_id": 45507900, "body": "how does your source look like? with my test variables is all working"}, {"owner": {"reputation": 5, "user_id": 4395512, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c9a23c07fb7b4b09fe3b26efa4c59f5e?s=128&d=identicon&r=PG&f=1", "display_name": "dcoder123", "link": "https://stackoverflow.com/users/4395512/dcoder123"}, "edited": false, "score": 0, "creation_date": 1424384568, "post_id": 28585701, "comment_id": 45539295, "body": "my code&#39;s super messy but basically its printing every value like 3 000 times (Every time i t loops through the tRow loop) regardless if it matches or not? trying to debug now.. the loop never sets itself to true for some reason."}], "tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": false, "score": 0, "last_activity_date": 1424268706, "creation_date": 1424268706, "answer_id": 28585701, "question_id": 28575930, "link": "https://stackoverflow.com/questions/28575930/how-to-make-the-for-loop-merge-new-values-across-sheets/28585701#28585701", "title": "How to make the for loop merge new values across sheets?", "body": "<p>You have 2 problems:</p>\n\n<p>problem 1: you reset <code>match = False</code> inside the <code>lRow</code> loop, this must be inside the <code>tRow</code> loop, otherwise if the first <code>match = True</code> hits then <code>match</code> is never reset</p>\n\n<p>problem 2: <code>If match = False Then</code> can't be entered because it is outside of your <code>tRow</code> loop. so <code>match</code> is set inside the loop but can not be reached by <code>If match = False Then</code></p>\n\n<p>so the working code should be</p>\n\n<pre><code>Sub Button13() 'merge\n\n    Dim lastSourceRow As Long, LastTargetRow As Long, allSheets As Long, lastSheet As Long\n    Dim source As String, TARGET As Integer\n    Dim tempVal As String, tempValE, tempValT\n    Dim tRow As Long, lRow As Long, lCol As Long, nRow As Long\n    Dim match As Boolean\n\n\n    source = \"Sheet2\"\n    lastSheet = \"10\"\n\n    lastSourceRow = Sheets(source).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n\n    For allSheets = 1 To lastSheet\n\n\n    TARGET = allSheets\n    LastTargetRow = Sheets(TARGET).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For lRow = 2 To lastSourceRow     'Loop through Rows on currentsheet\n        Count = \"0\"\n\n        tempVal = Sheets(source).Cells(lRow, \"B\").Value      'Assign the tempValue to compare\n        tempValE = Sheets(source).Cells(lRow, \"E\").Value\n\n        For tRow = 2 To LastTargetRow   'Loop through entire target sheet\n        tempValT = Sheets(TARGET).Cells(tRow, \"B\").Value\n            If (allSheets &lt;&gt; 2 Or allSheets &lt;&gt; 3) And tempVal = Sheets(TARGET).Cells(tRow, \"B\").Value And tempValE = Sheets(TARGET).Cells(tRow, \"E\").Value Then\n            match = True\n            ElseIf (allSheets &lt;&gt; 2 Or allSheets &lt;&gt; 3) And tempVal = Sheets(TARGET).Cells(tRow, \"B\").Value And tempValE = \"\" Then\n            match = True\n            ElseIf (allSheets &lt;&gt; 2 Or allSheets &lt;&gt; 3) And tempVal = Sheets(TARGET).Cells(tRow, \"B\").Value Then\n            match = True\n            'ElseIf Sheets(TARGET).Cells(tRow, \"G\").Value &lt; DateAdd(\"m\", -5, Date) Then\n            'match = True\n            End If\n\n\n        If match = False Then         'No Match found, copy row\n            nRow = Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n            For lCol = 1 To 26       'Copy entire row by looping through 6 columns\n                Sheets(\"Sheet1\").Cells(nRow, lCol).Value = Sheets(source).Cells(lRow, lCol).Value\n            Next lCol\n        End If\n\n'2 moved lines\nmatch = False                 'Reset boolean test for each new row\nNext tRow\n\n    Next lRow\n    Next allSheets\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4395512, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c9a23c07fb7b4b09fe3b26efa4c59f5e?s=128&d=identicon&r=PG&f=1", "display_name": "dcoder123", "link": "https://stackoverflow.com/users/4395512/dcoder123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424268706, "creation_date": 1424233310, "last_edit_date": 1424244949, "question_id": 28575930, "link": "https://stackoverflow.com/questions/28575930/how-to-make-the-for-loop-merge-new-values-across-sheets", "title": "How to make the for loop merge new values across sheets?", "body": "<p>I had someone help me make the initial code for this, Im trying to modify it however its wrong.</p>\n\n<p>I need to compare sheet 2 in a spreadsheet to sheets 4 to 10 and if the values of row e or b do not match any other row. copy the entire row to the bottom of sheet 1.</p>\n\n<p>This is what I have so far but the value isn't being set to true and it prints after every sheet. I'm stick</p>\n\n<pre><code> Sub Button13() 'merge\n\n    Dim lastSourceRow As Long, LastTargetRow As Long, allSheets As Long, lastSheet As Long\n    Dim source As String, TARGET As Integer\n    Dim tempVal As String, tempValE, tempValT\n    Dim tRow As Long, lRow As Long, lCol As Long, nRow As Long\n    Dim match As Boolean\n\n\n    source = \"Sheet2\"\n    lastSheet = \"10\"\n\n    lastSourceRow = Sheets(source).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n\n    For allSheets = 1 To lastSheet\n\n\n    TARGET = allSheets\n    LastTargetRow = Sheets(TARGET).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For lRow = 2 To lastSourceRow     'Loop through Rows on currentsheet\n        Count = \"0\"\n        match = False                 'Reset boolean test for each new row\n        tempVal = Sheets(source).Cells(lRow, \"B\").Value      'Assign the tempValue to compare\n        tempValE = Sheets(source).Cells(lRow, \"E\").Value\n\n        For tRow = 2 To LastTargetRow   'Loop through entire target sheet\n        tempValT = Sheets(TARGET).Cells(tRow, \"B\").Value\n            If (allSheets &lt;&gt; 2 Or allSheets &lt;&gt; 3) And tempVal = Sheets(TARGET).Cells(tRow, \"B\").Value And tempValE = Sheets(TARGET).Cells(tRow, \"E\").Value Then\n            match = True\n            ElseIf (allSheets &lt;&gt; 2 Or allSheets &lt;&gt; 3) And tempVal = Sheets(TARGET).Cells(tRow, \"B\").Value And tempValE = \"\" Then\n            match = True\n            ElseIf (allSheets &lt;&gt; 2 Or allSheets &lt;&gt; 3) And tempVal = Sheets(TARGET).Cells(tRow, \"B\").Value Then\n            match = True\n            'ElseIf Sheets(TARGET).Cells(tRow, \"G\").Value &lt; DateAdd(\"m\", -5, Date) Then\n            'match = True\n            End If\n        Next tRow\n\n\n        If match = False Then         'No Match found, copy row\n            nRow = Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n            For lCol = 1 To 26       'Copy entire row by looping through 6 columns\n                Sheets(\"Sheet1\").Cells(nRow, lCol).Value = Sheets(source).Cells(lRow, lCol).Value\n            Next lCol\n        End If\n\n    Next lRow\n    Next allSheets\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 96, "user_id": 4578016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dNN4_bmlanA/AAAAAAAAAAI/AAAAAAAAAj8/0Qy0uK7AUTk/photo.jpg?sz=128", "display_name": "Nitin Nair", "link": "https://stackoverflow.com/users/4578016/nitin-nair"}, "edited": false, "score": 0, "creation_date": 1424236258, "post_id": 28576232, "comment_id": 45461947, "body": "Hi, Thanks for the answer Mat. If I leave the Workbook open, chances are that others would be able to see the code. I don&#39;t want that scenario. Any other possible ways?"}, {"owner": {"reputation": 96, "user_id": 4578016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dNN4_bmlanA/AAAAAAAAAAI/AAAAAAAAAj8/0Qy0uK7AUTk/photo.jpg?sz=128", "display_name": "Nitin Nair", "link": "https://stackoverflow.com/users/4578016/nitin-nair"}, "edited": false, "score": 0, "creation_date": 1424401425, "post_id": 28576232, "comment_id": 45544234, "body": "I got a workaround. Thanks for the suggestion @Mat. I removed the <code>ActiveWorkbook.Close</code> method and secured the project with a password."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 96, "user_id": 4578016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dNN4_bmlanA/AAAAAAAAAAI/AAAAAAAAAj8/0Qy0uK7AUTk/photo.jpg?sz=128", "display_name": "Nitin Nair", "link": "https://stackoverflow.com/users/4578016/nitin-nair"}, "edited": false, "score": 0, "creation_date": 1424401697, "post_id": 28576232, "comment_id": 45544308, "body": "No problem. I&#39;m still trying to see where in your question it was ever mentioned that the idea was to prevent users from seeing the code... next time try to be more specific about what you&#39;re trying to achieve and what problem you are attempting to solve, you may get better answers."}, {"owner": {"reputation": 96, "user_id": 4578016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dNN4_bmlanA/AAAAAAAAAAI/AAAAAAAAAj8/0Qy0uK7AUTk/photo.jpg?sz=128", "display_name": "Nitin Nair", "link": "https://stackoverflow.com/users/4578016/nitin-nair"}, "edited": false, "score": 0, "creation_date": 1424401789, "post_id": 28576232, "comment_id": 45544338, "body": "Sure @Mat. Thanks :) Sorry I missed to add it."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1424235226, "creation_date": 1424235226, "answer_id": 28576232, "question_id": 28575917, "link": "https://stackoverflow.com/questions/28575917/how-to-open-excel-after-closing-it-through-vba/28576232#28576232", "title": "How to open Excel after closing it through VBA?", "body": "<p>Visual Basic for Applications lives in a <em>host</em>... application - here Microsoft Excel.</p>\n\n<p>If you have 10 workbooks opened, the Visual Basic Editor (VBE) will have 10 VBA projects in your <em>Project Explorer</em> window (Ctrl+R); closing one, will remove its VBA project from the VBE - the VBA code <em>is</em> in that workbook you just closed!</p>\n\n<p>There are two types of VBA projects: one is the <em>macro-enabled workbook</em> (.xlsm), the other is a <em>Microsoft Excel add-in</em> (.xlam). The former lives and dies with the <em>workbook</em> it's written in; the latter lives and dies with the <em>application</em> it's loaded in.</p>\n\n<p>If you need code that can manage multiple workbooks, consider saving as (F12) an add-in; <code>ActiveWorkbook.Close</code> would close the <em>active workbook</em>, and then the add-in is still loaded... and you can still view its VBA source.</p>\n\n<hr>\n\n<p>If you only mean to close a form, I suggest you don't implement the <code>QueryClose</code> handler, and let the form close by itself - <em>and leave the workbook open!</em>. <s>If you mean to close <em>another workbook</em>,</s> I strongly recommend you avoid <code>ActiveWorkbook</code> and use a <code>Workbook</code> object reference instead.</p>\n"}], "owner": {"reputation": 96, "user_id": 4578016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dNN4_bmlanA/AAAAAAAAAAI/AAAAAAAAAj8/0Qy0uK7AUTk/photo.jpg?sz=128", "display_name": "Nitin Nair", "link": "https://stackoverflow.com/users/4578016/nitin-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "accepted_answer_id": 28576232, "answer_count": 1, "score": -1, "last_activity_date": 1457706905, "creation_date": 1424233260, "last_edit_date": 1457706905, "question_id": 28575917, "link": "https://stackoverflow.com/questions/28575917/how-to-open-excel-after-closing-it-through-vba", "title": "How to open Excel after closing it through VBA?", "body": "<p>While coding for an automation tool using VBA for Excel, I came across this situation. I have coded the \"Close\" command button as well as the \"X\" on the top-right of the form window. Both codes are same and serving their purpose.</p>\n\n<p>I would like to know, if I close the workbook using the <code>ActiveWorkbook.Close</code> method in both the sub-procedures, then how to view the same Excel sheet's VBA project?</p>\n\n<p>I am using Microsoft Office 2010.</p>\n\n<p>Below is my code for reference:</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\nIf CloseMode = vbFormControlMenu Then\n    MsgBox \"Thanks for using! Tool will now close.\", vbInformation + vbOKOnly\n    Unload Me\n    ActiveWorkbook.Close\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2010", "excel-2007"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1516314888, "post_id": 28575754, "comment_id": 83648636, "body": "possible duplicate of <a href=\"https://stackoverflow.com/questions/19497659/excel-vba-autofilter-all-but-three/35120033?s=1|66.2429#35120033\">Excel VBA autofilter all but three</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4577989"}, "edited": false, "score": 1, "creation_date": 1424254405, "post_id": 28579593, "comment_id": 45469929, "body": "Thank you very much.  This is exactly what i was looking for, an informative and educational answer. Keep up the good work."}], "tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": true, "score": 26, "last_activity_date": 1424255262, "last_edit_date": 1424255262, "creation_date": 1424250232, "answer_id": 28579593, "question_id": 28575754, "link": "https://stackoverflow.com/questions/28575754/filter-out-multiple-criteria-using-excel-vba/28579593#28579593", "title": "filter out multiple criteria using excel vba", "body": "<p>I think (from experimenting - MSDN is unhelpful here) that there is no direct way of doing this.  Setting <code>Criteria1</code> to an <code>Array</code> is equivalent to using the tick boxes in the dropdown - as you say it will only filter a list based on items that match one of those in the array.</p>\n\n<p>Interestingly, if you have the literal values <code>\"&lt;&gt;A\"</code> and <code>\"&lt;&gt;B\"</code> in the list and filter on these the macro recorder comes up with</p>\n\n<pre><code>Range.AutoFilter Field:=1, Criteria1:=\"=&lt;&gt;A\", Operator:=xlOr, Criteria2:=\"=&lt;&gt;B\"\n</code></pre>\n\n<p>which works.  But if you then have the literal value <code>\"&lt;&gt;C\"</code> as well and you filter for all three (using tick boxes) while recording a macro, the macro recorder replicates precisely your code which then fails with an error.  I guess I'd call that a bug - there are filters you can do using the UI which you can't do with VBA.</p>\n\n<p>Anyway, back to your problem.  It is possible to filter values not equal to some criteria, but only up to two values which doesn't work for you:</p>\n\n<pre><code>Range(\"$A$1:$A$9\").AutoFilter Field:=1, Criteria1:=\"&lt;&gt;A\", Criteria2:=\"&lt;&gt;B\", Operator:=xlAnd\n</code></pre>\n\n<p>There are a couple of workarounds possible depending on the exact problem:</p>\n\n<ol>\n<li>Use a \"helper column\" with a formula in column B and then filter on that - e.g. <code>=ISNUMBER(A2)</code> or <code>=NOT(A2=\"A\", A2=\"B\", A2=\"C\")</code> then filter on <code>TRUE</code></li>\n<li>If you can't add a column, use autofilter with <code>Criteria1:=\"&gt;-65535\"</code> (or a suitable number lower than any you expect) which will filter out non-numeric values - assuming this is what you want</li>\n<li>Write a VBA sub to hide rows (not exactly the same as an autofilter but it may suffice depending on your needs).</li>\n</ol>\n\n<p>For example:</p>\n\n<pre><code>Public Sub hideABCRows(rangeToFilter As Range)\n  Dim oCurrentCell As Range\n  On Error GoTo errHandler\n\n  Application.ScreenUpdating = False\n  For Each oCurrentCell In rangeToFilter.Cells\n    If oCurrentCell.Value = \"A\" Or oCurrentCell.Value = \"B\" Or oCurrentCell.Value = \"C\" Then\n      oCurrentCell.EntireRow.Hidden = True\n    End If\n  Next oCurrentCell\n\n  Application.ScreenUpdating = True\n  Exit Sub\n\nerrHandler:\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 1, "creation_date": 1516800789, "post_id": 35055900, "comment_id": 83836919, "body": "First of all, I have consulted Excel documentation and AutoFilter function has no Criteria3 parameter ! And 3th, &#39;A&#39;, &#39;B&#39; and &#39;C&#39; are only an example; I can need a array with more than 3 values !"}], "tags": [], "owner": {"reputation": 1, "user_id": 5201506, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8YfXmkg9fak/AAAAAAAAAAI/AAAAAAAAAEI/hHJp4ada8VA/photo.jpg?sz=128", "display_name": "Ayanda Maphumulo", "link": "https://stackoverflow.com/users/5201506/ayanda-maphumulo"}, "is_accepted": false, "score": -3, "last_activity_date": 1453968429, "creation_date": 1453968429, "answer_id": 35055900, "question_id": 28575754, "link": "https://stackoverflow.com/questions/28575754/filter-out-multiple-criteria-using-excel-vba/35055900#35055900", "title": "filter out multiple criteria using excel vba", "body": "<p>Replace Operator:=xlOr with Operator:=xlAnd between your criteria. See below the amended script</p>\n\n<p>myRange.AutoFilter Field:=1, Criteria1:=\"&lt;>A\", Operator:=xlAnd, Criteria2:=\"&lt;>B\", Operator:=xlAnd, Criteria3:=\"&lt;>C\"</p>\n"}, {"tags": [], "owner": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "is_accepted": false, "score": 1, "last_activity_date": 1516279464, "creation_date": 1516279464, "answer_id": 48321690, "question_id": 28575754, "link": "https://stackoverflow.com/questions/28575754/filter-out-multiple-criteria-using-excel-vba/48321690#48321690", "title": "filter out multiple criteria using excel vba", "body": "<p>I don't have found any solution on Internet, so I have implemented one.</p>\n\n<p>The Autofilter code with criteria is then</p>\n\n<pre><code>iColNumber = 1\nDim aFilterValueArray() As Variant\nCall ConstructFilterValueArray(aFilterValueArray, iColNumber, Array(\"A\", \"B\", \"C\"))\n\nActiveSheet.range(sRange).AutoFilter Field:=iColNumber _\n    , Criteria1:=aFilterValueArray _\n    , Operator:=xlFilterValues\n</code></pre>\n\n<p>In fact, the ConstructFilterValueArray() method (not function) get all distinct values that it found in a specific column and remove all values present in last argument.</p>\n\n<p>The VBA code of this method is</p>\n\n<pre><code>'************************************************************\n'* ConstructFilterValueArray()\n'************************************************************\n\nSub ConstructFilterValueArray(a() As Variant, iCol As Integer, aRemoveArray As Variant)\n\n    Dim aValue As New Collection\n    Call GetDistinctColumnValue(aValue, iCol)\n    Call RemoveValueList(aValue, aRemoveArray)\n    Call CollectionToArray(a, aValue)\n\nEnd Sub\n\n'************************************************************\n'* GetDistinctColumnValue()\n'************************************************************\n\nSub GetDistinctColumnValue(ByRef aValue As Collection, iCol As Integer)\n\n    Dim sValue As String\n\n    iEmptyValueCount = 0\n    iLastRow = ActiveSheet.UsedRange.Rows.Count\n\n    Dim oSheet: Set oSheet = Sheets(\"X\")\n\n    Sheets(\"Data\")\n        .range(Cells(1, iCol), Cells(iLastRow, iCol)) _\n            .AdvancedFilter Action:=xlFilterCopy _\n                          , CopyToRange:=oSheet.range(\"A1\") _\n                          , Unique:=True\n\n    iRow = 2\n    Do While True\n        sValue = Trim(oSheet.Cells(iRow, 1))\n        If sValue = \"\" Then\n            If iEmptyValueCount &gt; 0 Then\n                Exit Do\n            End If\n            iEmptyValueCount = iEmptyValueCount + 1\n        End If\n\n        aValue.Add sValue\n        iRow = iRow + 1\n    Loop\n\nEnd Sub\n\n'************************************************************\n'* RemoveValueList()\n'************************************************************\n\nSub RemoveValueList(ByRef aValue As Collection, aRemoveArray As Variant)\n\n    For i = LBound(aRemoveArray) To UBound(aRemoveArray)\n        sValue = aRemoveArray(i)\n        iMax = aValue.Count\n        For j = iMax To 0 Step -1\n            If aValue(j) = sValue Then\n                aValue.Remove (j)\n                Exit For\n            End If\n        Next j\n     Next i\n\nEnd Sub\n\n'************************************************************\n'* CollectionToArray()\n'************************************************************\n\nSub CollectionToArray(a() As Variant, c As Collection)\n\n    iSize = c.Count - 1\n    ReDim a(iSize)\n\n    For i = 0 To iSize\n        a(i) = c.Item(i + 1)\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>This code can certainly be improved in returning an Array of String but working with Array in VBA is not easy.</p>\n\n<p>CAUTION: this code work only if you define a sheet named X because CopyToRange parameter used in AdvancedFilter() need an Excel Range !</p>\n\n<p>It's a shame that Microfsoft doesn't have implemented this solution in adding simply a new enum as xlNotFilterValues ! ... or xlRegexMatch !</p>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1516314041, "creation_date": 1516314041, "answer_id": 48331252, "question_id": 28575754, "link": "https://stackoverflow.com/questions/28575754/filter-out-multiple-criteria-using-excel-vba/48331252#48331252", "title": "filter out multiple criteria using excel vba", "body": "<p><strong>Alternative using VBA's Filter function</strong></p>\n\n<p>As an innovative alternative to @schlebe 's recent answer, I tried to use the <code>Filter</code> function integrated in <strong>VBA</strong>, which allows to <strong>filter out</strong> a given search string setting the third argument to False. All <em>\"negative\"</em> search strings (e.g. A, B, C) are defined in an array. I read the criteria in column A to a datafield array and basicly execute a subsequent filtering (A - C) to filter these items out. </p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub FilterOut()\nDim ws  As Worksheet\nDim rng As Range, i As Integer, n As Long, v As Variant\n' 1) define strings to be filtered out in array\n  Dim a()                    ' declare as array\n  a = Array(\"A\", \"B\", \"C\")   ' &lt;&lt; filter out values\n' 2) define your sheetname and range (e.g. criteria in column A)\n  Set ws = ThisWorkbook.Worksheets(\"FilterOut\")\n  n = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).row\n  Set rng = ws.Range(\"A2:A\" &amp; n)\n' 3) hide complete range rows temporarily\n  rng.EntireRow.Hidden = True\n' 4) set range to a variant 2-dim datafield array\n  v = rng\n' 5) code array items by appending row numbers\n  For i = 1 To UBound(v): v(i, 1) = v(i, 1) &amp; \"#\" &amp; i + 1: Next i\n' 6) transform to 1-dim array and FILTER OUT the first search string, e.g. \"A\"\n  v = Filter(Application.Transpose(Application.Index(v, 0, 1)), a(0), False, False)\n' 7) filter out each subsequent search string, i.e. \"B\" and \"C\"\n  For i = 1 To UBound(a): v = Filter(v, a(i), False, False): Next i\n' 8) get coded row numbers via split function and unhide valid rows\n  For i = LBound(v) To UBound(v)\n      ws.Range(\"A\" &amp; Split(v(i) &amp; \"#\", \"#\")(1)).EntireRow.Hidden = False\n  Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1524237631, "last_edit_date": 1524237631, "creation_date": 1524182461, "answer_id": 49931938, "question_id": 28575754, "link": "https://stackoverflow.com/questions/28575754/filter-out-multiple-criteria-using-excel-vba/49931938#49931938", "title": "filter out multiple criteria using excel vba", "body": "<p>An option using AutoFilter</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub FilterOutMultiple()\n    Dim ws As Worksheet, filterOut As Variant, toHide As Range\n\n    Set ws = ActiveSheet\n    If Application.WorksheetFunction.CountA(ws.Cells) = 0 Then Exit Sub 'Empty sheet\n\n    filterOut = Split(\"A B C D E F G\")\n\n    Application.ScreenUpdating = False\n    With ws.UsedRange.Columns(\"A\")\n        If ws.FilterMode Then .AutoFilter\n       .AutoFilter Field:=1, Criteria1:=filterOut, Operator:=xlFilterValues\n        With .SpecialCells(xlCellTypeVisible)\n            If .CountLarge &gt; 1 Then Set toHide = .Cells 'Remember unwanted (A, B, and C)\n        End With\n       .AutoFilter\n        If Not toHide Is Nothing Then\n            toHide.Rows.Hidden = True                   'Hide unwanted (A, B, and C)\n           .Cells(1).Rows.Hidden = False                'Unhide header\n        End If\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11056198, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f03199832bf7e0cff1b37690f249748d?s=128&d=identicon&r=PG", "display_name": "Ogier", "link": "https://stackoverflow.com/users/11056198/ogier"}, "is_accepted": false, "score": 0, "last_activity_date": 1550057927, "creation_date": 1550057927, "answer_id": 54669280, "question_id": 28575754, "link": "https://stackoverflow.com/questions/28575754/filter-out-multiple-criteria-using-excel-vba/54669280#54669280", "title": "filter out multiple criteria using excel vba", "body": "<p>Here an option using a list written on some range, populating an array that will be fiiltered. The information will be erased then the columns sorted.</p>\n\n<pre><code>Sub Filter_Out_Values()\n\n'Automation to remove some codes from the list\nDim ws, ws1 As Worksheet\nDim myArray() As Variant\nDim x, lastrow As Long\nDim cell As Range\n\nSet ws = Worksheets(\"List\")\nSet ws1 = Worksheets(8)\nlastrow = ws.Cells(Application.Rows.Count, 1).End(xlUp).Row\n\n'Go through the list of codes to exclude\nFor Each cell In ws.Range(\"A2:A\" &amp; lastrow)\n\n    If cell.Offset(0, 2).Value = \"X\" Then 'If the Code is associated with \"X\"\n        ReDim Preserve myArray(x) 'Initiate array\n        myArray(x) = CStr(cell.Value) 'Populate the array with the code\n        x = x + 1 'Increase array capacity\n        ReDim Preserve myArray(x) 'Redim array\n    End If\n\nNext cell\n\nlastrow = ws1.Cells(Application.Rows.Count, 1).End(xlUp).Row\nws1.Range(\"C2:C\" &amp; lastrow).AutoFilter field:=3, Criteria1:=myArray, Operator:=xlFilterValues\nws1.Range(\"A2:Z\" &amp; lastrow).SpecialCells(xlCellTypeVisible).ClearContents\nws1.Range(\"A2:Z\" &amp; lastrow).AutoFilter field:=3\n\n'Sort columns\nlastrow = ws1.Cells(Application.Rows.Count, 1).End(xlUp).Row\n'Sort with 2 criteria\nWith ws1.Range(\"A1:Z\" &amp; lastrow)\n    .Resize(lastrow).Sort _\n    key1:=ws1.Columns(\"B\"), order1:=xlAscending, DataOption1:=xlSortNormal, _\n    key2:=ws1.Columns(\"D\"), order1:=xlAscending, DataOption1:=xlSortNormal, _\n    Header:=xlYes, MatchCase:=False, Orientation:=xlTopToBottom, SortMethod:=xlPinYin\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4178018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a72175d143c8202eadd8f4ab13d4861?s=128&d=identicon&r=PG&f=1", "display_name": "JCCastillo", "link": "https://stackoverflow.com/users/4178018/jccastillo"}, "is_accepted": false, "score": 0, "last_activity_date": 1588868236, "last_edit_date": 1588868236, "creation_date": 1588797460, "answer_id": 61644936, "question_id": 28575754, "link": "https://stackoverflow.com/questions/28575754/filter-out-multiple-criteria-using-excel-vba/61644936#61644936", "title": "filter out multiple criteria using excel vba", "body": "<p>This works for me:\nThis is a criteria over two fields/columns (9 and 10), this filters rows with values >0 on column 9 and rows with values 4, 7, and 8 on column 10. <code>lastrow</code> is the number of rows on the data section.</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$O$\" &amp; lastrow).AutoFilter Field:=9, Criteria1:=\"&gt;0\", Operator:=xlAnd\nActiveSheet.Range(\"$A$1:$O$\" &amp; lastrow).AutoFilter Field:=10, Criteria1:=Arr(\"4\",\"7\",\"8\"), Operator:=xlFilterValues\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15753848, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6_x9gBWlYUA/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclMB3rU1KYQ3D3Fze-e2mV3j8hdlQ/s96-c/photo.jpg?sz=128", "display_name": "Rajesh kumar K", "link": "https://stackoverflow.com/users/15753848/rajesh-kumar-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1619259832, "last_edit_date": 1619259832, "creation_date": 1619258419, "answer_id": 67241498, "question_id": 28575754, "link": "https://stackoverflow.com/questions/28575754/filter-out-multiple-criteria-using-excel-vba/67241498#67241498", "title": "filter out multiple criteria using excel vba", "body": "<p>Please check this one for filtering out values in a range. It works</p>\n<pre><code>Selection.AutoFilter field:=33, Criteria1:=&quot;&lt;&gt;Array(IN1R,IN2R,INDA)&quot;, Operator:=xlFilterValues\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4577989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249377, "favorite_count": 10, "accepted_answer_id": 28579593, "answer_count": 8, "score": 18, "last_activity_date": 1619259832, "creation_date": 1424232187, "last_edit_date": 1573812128, "question_id": 28575754, "link": "https://stackoverflow.com/questions/28575754/filter-out-multiple-criteria-using-excel-vba", "title": "filter out multiple criteria using excel vba", "body": "<p>I have 8 variables in column A, 1,2,3,4,5 and A, B, C.<br>\nMy aim is to filter out A, B, C and display only 1-5.</p>\n\n<p>I can do this using the following code:</p>\n\n<pre><code>My_Range.AutoFilter Field:=1, Criteria1:=Array(\"1\", \"2\", \"3\",\"4\",\"5\"), _\n    Operator:=xlFilterValues\n</code></pre>\n\n<p>But what the code does is it filters variables 1 to 5 and displays them.</p>\n\n<p>I want to do the opposite, but yielding the same result, by filtering out A, B, C and showing variables 1 to 5</p>\n\n<p>I tried this code:</p>\n\n<pre><code>My_Range.AutoFilter Field:=1, Criteria1:=Array(\"&lt;&gt;A\", \"&lt;&gt;B\", \"&lt;&gt;C\"), _\n    Operator:=xlFilterValues\n</code></pre>\n\n<p>But it did not work.</p>\n\n<p><strong>Why cant I use this code ?</strong></p>\n\n<p>It gives this error:</p>\n\n<blockquote>\n  <p>Run time error 1004 autofilter method of range class failed</p>\n</blockquote>\n\n<p><strong>How can I perform this?</strong></p>\n"}, {"tags": ["html", "excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1424249221, "creation_date": 1424249221, "answer_id": 28579333, "question_id": 28575309, "link": "https://stackoverflow.com/questions/28575309/is-it-possible-to-create-a-hyperlink-which-will-activate-a-spreadsheet-and-run-a/28579333#28579333", "title": "Is it possible to create a hyperlink which will activate a spreadsheet and run a macro?", "body": "<p>No, it is not. </p>\n\n<p>It will not be working as you want. Even if you find a way (I don't think so) the Macro security settings can be set to not run macros on end user machines. </p>\n\n<p>I'd suggest looking for another options.</p>\n"}], "owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 28579333, "answer_count": 1, "score": 0, "last_activity_date": 1424249221, "creation_date": 1424229089, "last_edit_date": 1424229134, "question_id": 28575309, "link": "https://stackoverflow.com/questions/28575309/is-it-possible-to-create-a-hyperlink-which-will-activate-a-spreadsheet-and-run-a", "title": "Is it possible to create a hyperlink which will activate a spreadsheet and run a macro?", "body": "<p>I currently generate email queries from an excel/vba interface. These emails are to query a specific transaction. </p>\n\n<p>I would like to embed a hyperlink into these emails which would allow the user to navigate to the spreadsheet and trigger a macro with a parameter.</p>\n\n<p>EG: \n    <code>&lt;a href=\"excel:transcheck.xlsm ViewTrans(transID=1234)&gt;investigate&lt;/a&gt;</code></p>\n\n<p>The result of clicking this link should be that Excel is activated, the spreadsheet is opened, the ViewTrans subroutine within the macro is called with the paramater TransID = 1234. </p>\n\n<p>All google search results relate to embedding hyperlinks WITHIN excel, which is of course very straightforward. My question is about how to create an EXTERNAL hyperlink, that can be sent over email. Thanks in advance for advice.</p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access", "ado"], "comments": [{"owner": {"reputation": 620, "user_id": 3013378, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3a9dI.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3013378/mike"}, "edited": false, "score": 0, "creation_date": 1425064447, "post_id": 28575256, "comment_id": 45823614, "body": "What are the datatypes in the table [Data$] for the question and condition?"}, {"owner": {"reputation": 71, "user_id": 4574342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfe93aac8cae10926d1865e168421d2?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4574342/andrew"}, "reply_to_user": {"reputation": 620, "user_id": 3013378, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3a9dI.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3013378/mike"}, "edited": false, "score": 0, "creation_date": 1425434204, "post_id": 28575256, "comment_id": 45959534, "body": "Know I&#39;m probably not using the right terminology, but &quot;numbers&quot;."}, {"owner": {"reputation": 71, "user_id": 4574342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfe93aac8cae10926d1865e168421d2?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4574342/andrew"}, "reply_to_user": {"reputation": 620, "user_id": 3013378, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3a9dI.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3013378/mike"}, "edited": false, "score": 0, "creation_date": 1425435016, "post_id": 28575256, "comment_id": 45959706, "body": "Data sent to me is sometimes iffy (&quot;they&quot; like to use text formatting in Excel because they don&#39;t know how to show leading zeros the &quot;right&quot; way).   I did import the data into Access (fumbling newbie) and ran the SQL without problems. But I can only do it with one set of parameters at a time. If I could get the results for each time I ran the query into separate &quot;columns&quot; as the parameters change, that would be great. Or even exported to different sheets in Excel. I have code to consolidate the data."}, {"owner": {"reputation": 71, "user_id": 4574342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfe93aac8cae10926d1865e168421d2?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4574342/andrew"}, "reply_to_user": {"reputation": 620, "user_id": 3013378, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3a9dI.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3013378/mike"}, "edited": false, "score": 0, "creation_date": 1425435098, "post_id": 28575256, "comment_id": 45959723, "body": "Should mention that I&#39;ve already solved this problem the &quot;dumb&quot; way within Excel, automating the autofilter and copying the results to another sheet but what I really want to know is how to do this with SQL, preferrably on it&#39;s own within Access possible. (Sorry for multiple comments but there&#39;s a number of characters limit)"}, {"owner": {"reputation": 620, "user_id": 3013378, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3a9dI.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3013378/mike"}, "edited": false, "score": 1, "creation_date": 1425477886, "post_id": 28575256, "comment_id": 45978887, "body": "You&#39;re saying in the SQL that the question is not equal to &#39;-&#39; (dash), which is a string/text.  But you say that the question is a number.  I think that&#39;s the datatype mismatch.  You can&#39;t compare a number to a string like that.  What are you trying to do with that criteria?"}, {"owner": {"reputation": 71, "user_id": 4574342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfe93aac8cae10926d1865e168421d2?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4574342/andrew"}, "reply_to_user": {"reputation": 620, "user_id": 3013378, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3a9dI.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3013378/mike"}, "edited": false, "score": 0, "creation_date": 1425597489, "post_id": 28575256, "comment_id": 46040312, "body": "Sorry, the &quot;question&quot; part ( &#39;-&#39; ) is a string as you say.The &quot;condition&quot; part is a number."}], "owner": {"reputation": 71, "user_id": 4574342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfe93aac8cae10926d1865e168421d2?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4574342/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1424228721, "creation_date": 1424228721, "question_id": 28575256, "link": "https://stackoverflow.com/questions/28575256/sql-query-results-into-separate-columns-on-excel-worksheet", "title": "SQL query results into separate columns on Excel worksheet", "body": "<p>Previously I was able to run some VBA that ran several SQL queries and put the results in separate columns in a single Excel worksheet. There was a reference set to Microsoft ActiveX Data Objects 2.8 Library (Tools, References in the VBE).</p>\n\n<p>Although the code was working fine, recently I get an error message as follows -</p>\n\n<p>Run-time error '-2147217913 (80040e07)'\nData type mismatch in criteria expression</p>\n\n<p>Here is the code (the error appears in \"rs.Open sql, cn, adOpenStatic\" which is less than helpful). Please note that the same error appears in all VBA/SQL code I try to run, not just the code below.</p>\n\n<pre><code>Private Sub GetUniqueClassesListWithConditions()\n    Dim cn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim strWkbPath As String\n    Dim sql As String\n    Dim buf As Variant\n    Dim i As Long\n    Dim j As Long\n    Dim iTimes As Integer\n    Dim iQuestion As Integer\n    Dim iCondition As Integer\n    Dim iLimit As Integer\n    Dim sCondition As String\n    Dim iColumn As Integer\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n    End With\n\n    strWkbPath = ThisWorkbook.FullName\n\n    Worksheets.Add After:=Sheets(Sheets.Count)\n\n    For iQuestion = 1 To 14\n\n        For iTimes = 1 To 5\n\n            Select Case iTimes\n\n                Case 1\n                iLimit = 7\n                sCondition = \"Day\"\n\n                Case 2\n                iLimit = 6\n                sCondition = \"Time\"\n\n                Case 3\n                iLimit = 16\n                sCondition = \"Faculty\"\n\n                Case 4\n                iLimit = 13\n                sCondition = \"Department\"\n\n                Case 5\n                iLimit = 6\n                sCondition = \"Student Numbers\"\n\n            End Select\n\n            For iCondition = 1 To iLimit\n\n                sql = \"SELECT DISTINCT([Data$].Class) FROM [Data$] WHERE [Data$].Q\" &amp; iQuestion &amp; \" &lt;&gt; '-' AND [Data$].\" &amp; sCondition &amp; \"  = \" &amp; iCondition\n\n                j = 0\n\n                Set cn = New ADODB.Connection\n\n                cn.Provider = \"Microsoft.ACE.OLEDB.12.0\"\n\n                cn.Properties(\"Extended Properties\") = \"Excel 12.0;HDR=YES;IMEX=1\"\n\n                cn.Open strWkbPath\n\n                Set rs = New ADODB.Recordset\n\n                rs.Open sql, cn, adOpenStatic\n\n                ReDim buf(0 To rs.Fields.Count - 1, 0)\n\n                For i = 0 To rs.Fields.Count - 1\n\n                    buf(i, 0) = rs(i).Name\n\n                Next i\n\n                Do Until rs.EOF\n\n                    j = j + 1\n\n                    ReDim Preserve buf(0 To rs.Fields.Count - 1, 0 To j)\n\n                    For i = 0 To rs.Fields.Count - 1\n\n                        buf(i, j) = rs(i).Value\n\n                    Next i\n\n                    rs.MoveNext\n\n                Loop\n\n                rs.Close\n\n                cn.Close\n\n                Set cn = Nothing\n\n                Set rs = Nothing\n\n                iColumn = iColumn + 1\n\n                With ActiveSheet\n\n                    .Cells(1, iColumn).Value = \"Q\" &amp; iQuestion &amp; \", \" &amp; sCondition &amp; \"=\" &amp; iCondition\n\n                    .Cells(2, iColumn).Resize(UBound(buf, 2) + 1, UBound(buf, 1) + 1).Value = TransposeArray(buf)\n\n                End With\n\n            Next iCondition\n\n            iColumn = iColumn + 2\n\n        Next iTimes\n\n    Next iQuestion\n\n    With ActiveSheet\n\n        .Rows(1).Font.Bold = True\n\n        .Rows(2).EntireRow.Delete\n\n        .UsedRange.Columns.EntireColumn.AutoFit\n\n        On Error Resume Next\n\n        .Name = \"Unique Classes List (Condtions)\"\n\n        On Error GoTo 0\n\n    End With\n\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n        .EnableEvents = True\n    End With\n\nEnd Sub\n\nPrivate Function TransposeArray(buf)\n    Dim tmp()\n    Dim i As Long\n    Dim j As Long\n\n    ReDim tmp(UBound(buf, 2), UBound(buf, 1))\n\n    For i = LBound(buf, 1) To UBound(buf, 1)\n\n        For j = LBound(buf, 2) To UBound(buf, 2)\n\n            tmp(j, i) = buf(i, j)\n\n        Next j\n\n    Next i\n\n    TransposeArray = tmp\n\nEnd Function\n</code></pre>\n\n<p>If somebody can help me get the code running and/or tell me what the problem is, I'd be very grateful.</p>\n\n<p>Also, I'd like to do the same thing in Access. If I can export all of the results to an Excel file, even as different sheets in a workbook, it's easy for me to run some other code to combine the data into another worksheet. (I'm new to Access and know how to run SQL, but have no idea how to automate it, including putting the results in different \"columns\" and exporting it)</p>\n\n<p>Should mention my SQL \"skills\" are basic and I'm learning from w3schools as I go along (hope I'm not offending anybody here.</p>\n\n<p>Thanks for your help in advance.</p>\n"}, {"tags": ["html", "excel", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1424227623, "post_id": 28575063, "comment_id": 45459466, "body": "I&#39;d start by searching &quot;excel vba web scraping.&quot;"}, {"owner": {"reputation": 1192, "user_id": 3543350, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a568a3e7ea71d1fb8874b38c2689befc?s=128&d=identicon&r=PG&f=1", "display_name": "Red Shift", "link": "https://stackoverflow.com/users/3543350/red-shift"}, "edited": false, "score": 1, "creation_date": 1424227629, "post_id": 28575063, "comment_id": 45459467, "body": "Have you looked at something like <a href=\"http://www.wiseowl.co.uk/blog/s393/scraping-websites-vba.htm\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424229824, "post_id": 28575063, "comment_id": 45460050, "body": "There are plenty of examples for scraping Yahoo Finance around the web and probably a few here. Suggest you use yahoo.com to look for a few suitable ones."}], "answers": [{"tags": [], "owner": {"reputation": 638, "user_id": 2902799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8852504deabec33a23ba5909c6cfa007?s=128&d=identicon&r=PG", "display_name": "TRGWII", "link": "https://stackoverflow.com/users/2902799/trgwii"}, "is_accepted": true, "score": 1, "last_activity_date": 1424232653, "last_edit_date": 1495542510, "creation_date": 1424230673, "answer_id": 28575531, "question_id": 28575063, "link": "https://stackoverflow.com/questions/28575063/how-to-get-at-this-data/28575531#28575531", "title": "how to get at this data", "body": "<p>I would probably use an XML parser to get the text content first (or this: xmlString.replace(/&lt;[^>]+>/g, \"\") to replace all tags with empty strings), then use the following regexes to extract the information you need:</p>\n\n<pre><code>/-OPR\\s+(\\d+\\.\\d+)/\n/Bid:\\s+(\\d+\\.\\d+)/\n/Ask:\\s+(\\d+\\.\\d+)/\n/Open Interest:\\s+(\\d+,\\d+)/\n</code></pre>\n\n<p>This process can easily be done in nodejs (<a href=\"https://stackoverflow.com/q/7372972\">more info</a>)or with any other language that supports regex.</p>\n\n<hr>\n\n<p>live demo:</p>\n\n<ul>\n<li>Waits 1 second, then removes tags.</li>\n<li>Waits another second, then finds all patterns and creates a table.</li>\n</ul>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>wait = true; // Set to false to execute instantly.\r\n\r\nvar elem = document.getElementById(\"parsingStuff\");\r\nvar str = elem.textContent;\r\n\r\nvar keywords = [\"-OPR\", \"Bid:\", \"Ask:\", \"Open Interest:\"];\r\nvar output = {};\r\nvar timeout = 0;\r\n\r\nif (wait) timeout = 1000;\r\n\r\nsetTimeout(function() { // Removing tags.\r\n  elem.innerHTML = elem.textContent;\r\n}, timeout);\r\n\r\nif (wait) timeout = 2000;\r\n\r\nsetTimeout(function() { // Looking for patterns.\r\n  for (var i = 0; i &lt; keywords.length; i++) {\r\n    output[keywords[i]] = str.match(RegExp(keywords[i] + \"\\\\s+(\\\\d+[\\\\.,]\\\\d+)\"))[1];\r\n  }\r\n\r\n  // Creating basic table of found data.\r\n  elem.innerHTML = \"\";\r\n  var table = document.createElement(\"table\");\r\n  for (k in output) {\r\n    var tr = document.createElement(\"tr\");\r\n    var th = document.createElement(\"th\");\r\n    var td = document.createElement(\"td\");\r\n\r\n    th.style.border = \"1px solid gray\";\r\n    td.style.border = \"1px solid gray\";\r\n\r\n    th.textContent = k;\r\n    td.textContent = output[k];\r\n\r\n    tr.appendChild(th);\r\n    tr.appendChild(td);\r\n\r\n    table.appendChild(tr);\r\n  }\r\n  elem.appendChild(table);\r\n}, timeout);</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div id=\"parsingStuff\"&gt;\r\n  &lt;div class=\"yfi_rt_quote_summary\" id=\"yfi_rt_quote_summary\"&gt;\r\n    &lt;div class=\"hd\"&gt;\r\n      &lt;div class=\"title\"&gt;\r\n        &lt;h2&gt;GM Feb 2015 36.500 call (GM150220C00036500)&lt;/h2&gt;\r\n        &lt;span class=\"rtq_exch\"&gt;\r\n        &lt;span class=\"rtq_dash\"&gt;-&lt;/span&gt;OPR\r\n        &lt;/span&gt;\r\n        &lt;span class=\"wl_sign\"&gt;&lt;/span&gt;\r\n      &lt;/div&gt;\r\n    &lt;/div&gt;\r\n    &lt;div class=\"yfi_rt_quote_summary_rt_top sigfig_promo_1\"&gt;\r\n      &lt;div&gt;\r\n        &lt;span class=\"time_rtq_ticker\"&gt;\r\n\r\n        &lt;span id=\"yfs_110_gm150220c00036500\"&gt;0.83&lt;/span&gt;\r\n        &lt;/span&gt;\r\n      &lt;/div&gt;\r\n    &lt;/div&gt;undefined&lt;/div&gt;undefined\r\n  &lt;div class=\"yui-u first yfi-start-content\"&gt;\r\n    &lt;div class=\"yfi_quote_summary\"&gt;\r\n      &lt;div id=\"yfi_quote_summary_data\" class=\"rtq_table\"&gt;\r\n        &lt;table id=\"table1\"&gt;\r\n          &lt;tr&gt;\r\n            &lt;th scope=\"row\" width=\"48%\"&gt;Bid:&lt;/th&gt;\r\n            &lt;td class=\"yfnc_tabledata1\"&gt;\r\n\r\n              &lt;span id=\"yfs_b00_gm150220c00036500\"&gt;0.76&lt;/span&gt;\r\n            &lt;/td&gt;\r\n          &lt;/tr&gt;\r\n          &lt;tr&gt;\r\n            &lt;th scope=\"row\" width=\"48%\"&gt;Ask:&lt;/th&gt;\r\n            &lt;td class=\"yfnc_tabledata1\"&gt;\r\n\r\n              &lt;span id=\"yfs_a00_gm150220c00036500\"&gt;0.90&lt;/span&gt;\r\n            &lt;/td&gt;\r\n          &lt;/tr&gt;\r\n        &lt;/table&gt;\r\n        &lt;table id=\"table2\"&gt;\r\n          &lt;tr&gt;\r\n            &lt;th scope=\"row\" width=\"48%\"&gt;Open Interest:&lt;/th&gt;\r\n\r\n            &lt;td class=\"yfnc_tabledata1\"&gt;11,579&lt;/td&gt;\r\n          &lt;/tr&gt;\r\n        &lt;/table&gt;\r\n      &lt;/div&gt;\r\n    &lt;/div&gt;\r\n  &lt;/div&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 11746, "user_id": 95245, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a9645d49aa683c44714ba60392e9c5f?s=128&d=identicon&r=PG", "display_name": "Berryl", "link": "https://stackoverflow.com/users/95245/berryl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 28575531, "answer_count": 1, "score": -1, "last_activity_date": 1424305890, "creation_date": 1424227315, "last_edit_date": 1531164843, "question_id": 28575063, "link": "https://stackoverflow.com/questions/28575063/how-to-get-at-this-data", "title": "how to get at this data", "body": "<p>I am looking to scrape the three items that are highlighted and bordered from the html sample below. I've also highlighted a few markers that look useful.</p>\n\n<p>How would you do this?</p>\n\n<p><img src=\"https://i.stack.imgur.com/uwSGM.jpg\" alt=\"enter image description here\"></p>\n\n<p><strong>A Solution</strong></p>\n\n<p>Ok so this wasn't a great question and I'm actually surprised it didn't get down-voted more! Oh well, here are some bread crumbs for someone else.</p>\n\n<p>Three of the four items of info I want are the inner text of a span element with a known id (ie, $0.83 for \"yfs_l10_gm150220c00036500\"), so I the following helper class seems to be a decent and direct shot:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\r\n' GetSpanTextForId\r\n'\r\n' Returns the inner text from a span element known by the passed id\r\n'\r\n' param doc:     the source HTMLDocument\r\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\r\nFunction GetSpanTextForId(ByRef doc As HTMLDocument, ByVal spanId As String) As Double\r\n'   Error Handling\r\n    On Error GoTo ErrHandler\r\n    Dim sRoutine        As String\r\n    sRoutine = cModule &amp; \".GetSpanTextForId\"\r\n     \r\n    CheckArgNotNothing doc, \"doc\"\r\n    CheckArgNotBadString spanId, \"spanId\"\r\n'   Procedure\r\n    Dim oSpan As HTMLSpanElement\r\n    Set oSpan = doc.getElementById(spanId)\r\n    Check Not oSpan Is Nothing, \"Could not find span with id: \" &amp; Bracket(spanId)\r\n    GetSpanTextForId = oSpan.innerText\r\n    \r\n    Exit Function\r\n\r\nErrHandler:\r\n    Select Case DspErrMsg(sRoutine)\r\n         Case Is = vbAbort:  Stop: Resume    'Debug mode - Trace\r\n         Case Is = vbRetry:  Resume          'Try again\r\n         Case Is = vbIgnore:                 'End routine\r\n     End Select\r\n\r\n\r\nEnd Function</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>The only item not directly known by a span is the OpenInterest which is part of a table that is the 2nd child of an element with an id. The following methods return the cell that immediately follows the cell with the text I want (ie, \"Open Interest\")</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\r\n' GetOpenInterest\r\n'\r\n' The latest available Open Interest.\r\n'\r\n' param doc:     the source HTMLDocument\r\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\r\nFunction GetOpenInterest(ByRef doc As HTMLDocument) As Integer\r\n    Dim tbl As IHTMLTable\r\n    Set tbl = GetSummaryDataTable(doc, 1)\r\n    Dim k As Integer\r\n    k = mWebScrapeHelpers.GetCellNumberForTextStartingWith(tbl, \"Open Interest:\")\r\n    GetOpenInterest = CInt(mWebScrapeHelpers.GetCellTextFromCellNumber(tbl, k + 1))\r\nEnd Function\r\n\r\n\r\nFunction GetCellNumberForTextStartingWith(ByRef tbl As IHTMLTable, ByRef s As String) As Integer\r\n'   Error Handling\r\n    On Error GoTo ErrHandler\r\n    Dim sRoutine        As String\r\n    sRoutine = cModule &amp; \".GetCellNumberForTextStartingWith\"\r\n    \r\n    CheckArgNotNothing tbl, \"tbl\"\r\n    \r\n'   Procedure\r\n    Dim tblCell As HTMLTableCell\r\n    Dim k As Integer\r\n\r\n    For Each tblCell In tbl.Cells\r\n        If tblCell.innerText Like (\"*\" &amp; s) Then\r\n            GetCellNumberForTextStartingWith = k\r\n            Exit Function\r\n        End If\r\n        k = k + 1\r\n    Next\r\n    \r\n    ' if we got here it was not found so\r\n    GetCellNumberForTextStartingWith = -1\r\n    Exit Function\r\n\r\nErrHandler:\r\n    Select Case DspErrMsg(sRoutine)\r\n         Case Is = vbAbort:  Stop: Resume    'Debug mode - Trace\r\n         Case Is = vbRetry:  Resume          'Try again\r\n         Case Is = vbIgnore:                 'End routine\r\n     End Select\r\n     \r\nEnd Function\r\n\r\nFunction GetCellTextFromCellNumber(ByRef tbl As IHTMLTable, ByRef nbr As Integer) As String\r\n'   Error Handling\r\n    On Error GoTo ErrHandler\r\n    Dim sRoutine        As String\r\n    sRoutine = cModule &amp; \".GetCellNumberForTextStartingWith\"\r\n    \r\n    CheckArgNotNothing tbl, \"tbl\"\r\n    Check tbl.Cells.Length &gt; 0, \"table is empty\"\r\n    Check tbl.Cells.Length &gt;= nbr, \"table only has \" &amp; tbl.Cells.Length &amp; \" cells; can't get cell number \" &amp; nbr\r\n    \r\n'   Procedure\r\n    GetCellTextFromCellNumber = tbl.Cells(nbr).innerText\r\n    Exit Function\r\n\r\nErrHandler:\r\n    Select Case DspErrMsg(sRoutine)\r\n         Case Is = vbAbort:  Stop: Resume    'Debug mode - Trace\r\n         Case Is = vbRetry:  Resume          'Try again\r\n         Case Is = vbIgnore:                 'End routine\r\n     End Select\r\n\r\n\r\nEnd Function</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>These methods work fine but it does seem there are lots of different approaches that would work, including the regex parsing approach suggested as an answer. The <em>excellent</em> link by RedShift got more to the point of analyzing the html and coming up with a strategy. </p>\n\n<p>Cheers</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424224918, "post_id": 28574399, "comment_id": 45458763, "body": "If one or both of the cells in columns B and C are blank through content clearing, should the timestamp in column F be removed?"}, {"owner": {"reputation": 1, "user_id": 4577742, "user_type": "registered", "profile_image": "https://graph.facebook.com/518157808325545/picture?type=large", "display_name": "Erica Fran Mateo", "link": "https://stackoverflow.com/users/4577742/erica-fran-mateo"}, "edited": false, "score": 0, "creation_date": 1424823869, "post_id": 28574399, "comment_id": 45707152, "body": "Good question. No, I don&#39;t want that to happen"}], "answers": [{"tags": [], "owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "is_accepted": false, "score": 1, "last_activity_date": 1424273949, "last_edit_date": 1424273949, "creation_date": 1424223402, "answer_id": 28574483, "question_id": 28574399, "link": "https://stackoverflow.com/questions/28574399/how-to-get-excel-spreadsheet-to-auto-populate-date-time-using-vba/28574483#28574483", "title": "How to get Excel Spreadsheet to auto populate date &amp; time using VBA?", "body": "<p>\"Target\" will be the cell(s) that changed. It is possible to change more then one cell at a time (via ctrl-enter) so checking all cells in the Target isn't a bad idea.</p>\n\n<p>If you use the Intersect method it will get only the area of Target and the range you wanted to check that overlaps. This will then loop through those cells (if there are any) and if a value is found, timestamp them. </p>\n\n<p>As others have mentioned, disabling events before you plug the stamps will prevent calling another worksheet change event. Just be careful when debugging not to leave events off. </p>\n\n<p>You can read more about the event parameters here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff839775.aspx</a></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Excel.Range\n    Dim cll As Excel.Range\n    Set rng = Excel.Intersect(Target, Range(\"B:C\"))\n    If Not (rng Is Nothing) Then\n        Excel.Application.EnableEvents = False\n        For Each cll In rng.Cells\n            If Len(cll.Formula) &gt; 0 Then\n                Cells(cll.Row, 6).Value = Format$(Now, \"m/d/yyyy h:mm AM/PM\")\n            End If\n        Next\n        Range(\"F:F\").EntireColumn.AutoFit\n        Excel.Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "edited": false, "score": 0, "creation_date": 1424223646, "post_id": 28574498, "comment_id": 45458461, "body": "You have a &lt;&gt;  and = and need to change the And to an Or :) Also to check for a blank cell, you don&#39;t want a space in those quotes."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1424223503, "creation_date": 1424223503, "answer_id": 28574498, "question_id": 28574399, "link": "https://stackoverflow.com/questions/28574399/how-to-get-excel-spreadsheet-to-auto-populate-date-time-using-vba/28574498#28574498", "title": "How to get Excel Spreadsheet to auto populate date &amp; time using VBA?", "body": "<p>Couple of small changes:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  Dim i As Integer\n  Application.EnableEvents = False\n    If Target.Column = 2 Or Target.Column = 3 Then\n      For i = 2 To 100\n        If Cells(i, \"B\").Value &lt;&gt; \" \" And Cells(i, \"C\").Value = \" \" Then\n          Cells(i, \"F\").Value = Date &amp; \" \" &amp; Time\n          Cells(i, \"F\").NumberFormat = \"m/d/yyyy h:mm AM/PM\"\n        End If\n      Next\n    End If\n  Range(\"F:F\").EntireColumn.AutoFit\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Turn the even off so you don't fire it when your code makes a modification and test the target column to see if it is B or C and only fire if it is</p>\n\n<p>Also, you know your code will update rows 2 to 100 regardless of which row was changed right? If you only want the row that was changed you can get that with target.row</p>\n"}, {"comments": [{"owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "edited": false, "score": 0, "creation_date": 1424274053, "post_id": 28574698, "comment_id": 45482078, "body": "Good job realizing for realizing EnableEvents was needed, and for realizing that multiple values could change. I missed those:)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1424224688, "creation_date": 1424224688, "answer_id": 28574698, "question_id": 28574399, "link": "https://stackoverflow.com/questions/28574399/how-to-get-excel-spreadsheet-to-auto-populate-date-time-using-vba/28574698#28574698", "title": "How to get Excel Spreadsheet to auto populate date &amp; time using VBA?", "body": "<p>You don't want to run through all of that everytime anything on the worksheet changes; only when something that affects the validity of the timestamp changes. Typically, we would use <code>Intersect</code> to determine if one of the values that changed should receive a new timestamp. You also do not want the routine to attempt to run on top of itself so turning event handling off before changing a value (i.e. adding the time stamp) is recommended.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"B:C\")) Is Nothing Then\n        On Error GoTo SafeExit\n        Application.EnableEvents = False\n        Dim bc As Range   'no sense in declaring something until we actually need it\n        For Each bc In Intersect(Target, Range(\"B:C\")) 'deal with every cell that intersects. This is how to handle pastes into more than one cell\n            If Not IsEmpty(Cells(bc.Row, \"B\")) And Not IsEmpty(Cells(bc.Row, \"C\")) Then\n                Cells(bc.Row, \"F\").Value = Now 'Now is the equivalent of Date + Time\n                Cells(bc.Row, \"F\").NumberFormat = \"m/d/yyyy h:mm AM/PM\"\n            End If\n        Next bc\n        'Range(\"F:F\").EntireColumn.AutoFit 'this slows things down. you may want to comment this out and just set an apprpriate column width that will handle everything\n    End If\nSafeExit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>That is my take on this old problem. There are many examples. Look toward the <em>Related</em> section down the right-hand side of this page for links to a few.</p>\n"}], "owner": {"reputation": 1, "user_id": 4577742, "user_type": "registered", "profile_image": "https://graph.facebook.com/518157808325545/picture?type=large", "display_name": "Erica Fran Mateo", "link": "https://stackoverflow.com/users/4577742/erica-fran-mateo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3301, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1424273949, "creation_date": 1424222929, "last_edit_date": 1531164843, "question_id": 28574399, "link": "https://stackoverflow.com/questions/28574399/how-to-get-excel-spreadsheet-to-auto-populate-date-time-using-vba", "title": "How to get Excel Spreadsheet to auto populate date &amp; time using VBA?", "body": "<p>Trying to get a macro enabled worksheet on Excel to auto populate date and time when any values are entered in column B or C. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  Dim i As Integer\n  For i = 2 To 100\n    If Cells(i, \"B\").Value &lt;&gt; \" \" And Cells(i, \"C\").Value = \" \" Then\n      Cells(i, \"F\").Value = Date &amp; \" \" &amp; Time\n      Cells(i, \"F\").NumberFormat = \"m/d/yyyy h:mm AM/PM\"\n    End If\n  Next\n  Range(\"F:F\").EntireColumn.AutoFit\nEnd Sub\n</code></pre>\n\n<p>is there anything wrong with the code I'm writing? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 1, "last_activity_date": 1424224556, "creation_date": 1424224556, "answer_id": 28574675, "question_id": 28574382, "link": "https://stackoverflow.com/questions/28574382/skipping-to-the-next-cell-in-vba-in-a-for-loop/28574675#28574675", "title": "Skipping to the next cell in VBA in a for loop", "body": "<p>Try this:</p>\n\n<pre><code>Sub PlotCircles()\n    Dim r As Range, c As Range, shp As Shape\n    Set r = Sheet1.Range(\"D7:D205\") 'change to suit\n    For Each c In r\n        With c\n            If .Value &lt;&gt; \"\" Then\n                Set shp = Sheet1.Shapes.AddShape _\n                    (msoShapeOval, .Left, .Top, .Value, .Value)\n            Else\n                .Value = .Value + 1\n            End If\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<p>I don't know why you hardcode your <code>Left</code> and <code>Top</code> argument for the <code>AddShape</code> method.<br>\nThat will draw all the circles in the same location.<br>\nAbove however draws the circles in the cell where you get your values from.<br>\nYou can adjust that to suit your needs. HTH.</p>\n"}], "owner": {"reputation": 51, "user_id": 1513202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41774eefc7ec20ac0f43fee8ec5efb9f?s=128&d=identicon&r=PG", "display_name": "user1513202", "link": "https://stackoverflow.com/users/1513202/user1513202"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 0, "accepted_answer_id": 28574675, "answer_count": 1, "score": 1, "last_activity_date": 1424224556, "creation_date": 1424222798, "last_edit_date": 1424224116, "question_id": 28574382, "link": "https://stackoverflow.com/questions/28574382/skipping-to-the-next-cell-in-vba-in-a-for-loop", "title": "Skipping to the next cell in VBA in a for loop", "body": "<p>I'm writing a macro that basically draws a circle for every value in a column with a size based on that value, however some of the cells are blank and I just need to skip over them. I run into an error when I hit the first blank cell. Here's the code I have so far: </p>\n\n<pre><code>Sub plotCircles()\n    Set R = Range(\"D7:D205\")\n    For Each Value In R\n        If Value = \"\" Then\n            Value = Value + 1\n        Else\n            Set shp = ActiveSheet.Shapes.AddShape(msoShapeOval, 10, 10, Value, Value)\n        End If\n    Next Value\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "hyperlink", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "edited": false, "score": 0, "creation_date": 1424223831, "post_id": 28574190, "comment_id": 45458502, "body": "Faster way I can do: <code>r = Split(Range(&quot;G8&quot;).Hyperlinks(1).SubAddress, &quot;!&quot;)(0)</code> ?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "edited": false, "score": 0, "creation_date": 1424226119, "post_id": 28574190, "comment_id": 45459120, "body": "@Ryflex That is just another way to get the sheet name. But the <code>SubAddress</code> from which you can pull the info you need solves the issue you described above."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "edited": false, "score": 0, "creation_date": 1424243925, "post_id": 28574190, "comment_id": 45464615, "body": "@Ryflex - if you use Split then you need to account for single quotes when the sheet name has spaces: e.g. <code>&#39;Shee    t1&#39;!A1</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 5, "last_activity_date": 1424221534, "creation_date": 1424221534, "answer_id": 28574190, "question_id": 28574065, "link": "https://stackoverflow.com/questions/28574065/vba-retrieve-hyperlink-target-sheet/28574190#28574190", "title": "VBA retrieve hyperlink target sheet?", "body": "<p><code>SubAddress</code> is what you want:</p>\n\n<pre><code>Sub Test()\n\n    Dim hl As Hyperlink, r As Range\n\n    Set hl = ActiveSheet.Hyperlinks(1)\n\n    Set r = Application.Evaluate(hl.SubAddress)\n\n    Debug.Print \"Sheet: '\" &amp; r.Parent.Name &amp; \"'\", \"Range:\" &amp; r.Address()\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4339, "user_id": 2487602, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/n8AjK.jpg?s=128&g=1", "display_name": "Ryflex", "link": "https://stackoverflow.com/users/2487602/ryflex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2071, "favorite_count": 0, "accepted_answer_id": 28574190, "answer_count": 1, "score": 2, "last_activity_date": 1424224924, "creation_date": 1424220714, "last_edit_date": 1424224924, "question_id": 28574065, "link": "https://stackoverflow.com/questions/28574065/vba-retrieve-hyperlink-target-sheet", "title": "VBA retrieve hyperlink target sheet?", "body": "<p>I'm trying to retrieve the sheet reference location from a hyperlink that's in a cell</p>\n\n<p>The following doesn't seem to work as <code>test</code> doesn't return anything, even though <code>G8</code> points to Sheet: <strong>KO</strong> in Cell <code>A19</code></p>\n\n<pre><code>test = Range(\"G8\").Hyperlinks(3).Address\n</code></pre>\n\n<p>Now if I run the following:</p>\n\n<pre><code>For Each hl In Sheets(\"LIST\").Hyperlinks\n    MsgBox \"Range \" &amp; hl.Range.Address &amp; \" addr \" &amp; _\n            hl.Address &amp; \" text \" &amp; hl.TextToDisplay\nNext hl\n</code></pre>\n\n<p>It cycles through and finds the correct address but I can't seem to work out how to detect the sheet it's pointing. Also the loop is a bit of a mess because it errors out once it has found the first and only hyperlink in this situation. And it's not always specific for G8. I guess I could just throw an if statement in and exit the for loop early.</p>\n\n<p>Regardless of that, I can't find anywhere in stackoverflow, google, microsofts \"hyperlinks\" docs a way to get the sheet name.</p>\n\n<p><strong>See below sample illustration:</strong>\n<img src=\"https://i.imgur.com/WYh3xRn.png\" alt=\"sample pic\"></p>\n"}, {"tags": ["vba", "excel", "olap", "powerpivot"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424221964, "post_id": 28573950, "comment_id": 45457931, "body": "Can you specify which statement raises the error? Is it <code>.Range(Cell).Select</code>?  What does the function <code>lastRow</code> do?"}, {"owner": {"reputation": 543, "user_id": 1800159, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e4cdffb8921e285fa2e51509fecfb2f9?s=128&d=identicon&r=PG", "display_name": "MarcinAu", "link": "https://stackoverflow.com/users/1800159/marcinau"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424334763, "post_id": 28573950, "comment_id": 45508721, "body": "It&#39;s <code>Worksheets(sheet).Range(Cell).Select</code> that causes the error."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424352750, "post_id": 28573950, "comment_id": 45519357, "body": "Can you try <i>without</i> using <code>Select</code>? I don&#39;t know why that would cause an error, but if the sheet is locked/protected, you may not be able to <code>Select</code> parts of it, etc. Or, use <a href=\"http://www.siddharthrout.com/2012/10/02/find-last-row-in-an-excel-sheetvbavb-net/\" rel=\"nofollow noreferrer\">THIS</a> method to find the last row.   Also, <b>What is the error message?</b> 1004? Method _Range failed? Etc."}], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 1540567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c79ebec62c5c3785fdaf5f914fcc68?s=128&d=identicon&r=PG", "display_name": "baldmosher", "link": "https://stackoverflow.com/users/1540567/baldmosher"}, "is_accepted": false, "score": 1, "last_activity_date": 1480331074, "last_edit_date": 1480331074, "creation_date": 1480010351, "answer_id": 40792389, "question_id": 28573950, "link": "https://stackoverflow.com/questions/28573950/force-vba-to-wait-until-power-pivot-finishes-refreshing/40792389#40792389", "title": "Force VBA to wait until power pivot finishes refreshing", "body": "<p>Holy mother of goodness, I've figured it out.</p>\n\n<p>It's not a perfect solution, it can be a little slow, but at least it works.</p>\n\n<p>Someone (I will eventually) should be able to improve this so it deals with multi-cell ranges.  Essentially it waits for each cell to finish calculating in turn.  It seems most PP lookup formulas we use will finish in batches, so it only needs one cell from each batch to be tested.  And it's fairly efficient, but it could definitely make use of optimisation.  I'll post back as I improve on it.</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\nFunction PP_Calcs_Finished() As Boolean\n'v9.00 2016-11-28 10:39 - added PP_Calcs_Finished\n'test for PowerPivot calculations to be completed\n\n'tests any range names starting with prefix \"PP_test_\" to look for #GETTING_DATA in cell text\n    Const cPPwait As String = \"#GETTING_DATA\"\n'choose various cells in workbook and label ranges with prefix \"PP_test_\" to be checked for completion\n    Const cPPprefix As String = \"PP_test_\"\n'runs itself once per sRepeat seconds until test completes, this allows calcs to run in background\n    Const sRepeat As Byte = 2\n'Result: True means OK, False means not OK\n\n\nApplication.StatusBar = \"PLEASE NOTE: readjusting lookups and formulas in the background, please be patient...\"\n\n'ensure calculations are automatic\nApplication.Calculation = xlCalculationAutomatic\nDim nm As Name, test_nm() As Name, n As Integer, nmax As Integer, ws As Worksheet\n\n'find all test ranges\nnmax = 0\n'workbook scope\nFor Each nm In ThisWorkbook.Names\n    If Left(nm.Name, 8) = cPPprefix Then\n        nmax = nmax + 1\n        ReDim Preserve test_nm(1 To nmax) As Name\n        Set test_nm(nmax) = nm\n    End If\nNext nm\n'worksheet scope\nFor Each ws In Worksheets\n    For Each nm In ws.Names\n        If Left(nm.Name, 8) = cPPprefix Then\n            nmax = nmax + 1\n            ReDim Preserve test_nm(1 To nmax) As Name\n            Set test_nm(nmax) = nm\n        End If\n    Next nm\nNext ws\n\n'now test all ranges\nDim sSheetName As String, sRangeName As String\nIf nmax &gt; 0 Then\n    For n = 1 To nmax\n        sSheetName = Mid(test_nm(n).RefersTo, 2, InStr(1, test_nm(n).RefersTo, \"!\") - 2)\n        sRangeName = Mid(test_nm(n).RefersTo, InStr(1, test_nm(n).RefersTo, \"!\") + 1, 500)\n        If Worksheets(sSheetName).Range(sRangeName).Cells(1).Text = cPPwait Then\n        'still waiting, quit and test again in sRepeat seconds\n            Application.OnTime Now + TimeSerial(0, 0, sRepeat), \"PP_Calcs_Finished\"\n            Exit Function\n        End If\n    Next n\nEnd If\nApplication.StatusBar = False\nPP_Calcs_Finished = True\n'Application.Calculate\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 543, "user_id": 1800159, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e4cdffb8921e285fa2e51509fecfb2f9?s=128&d=identicon&r=PG", "display_name": "MarcinAu", "link": "https://stackoverflow.com/users/1800159/marcinau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480331074, "creation_date": 1424220048, "question_id": 28573950, "link": "https://stackoverflow.com/questions/28573950/force-vba-to-wait-until-power-pivot-finishes-refreshing", "title": "Force VBA to wait until power pivot finishes refreshing", "body": "<p>I came across a very unusual error with VBA that I'm struggling with for two days now. I have a code that updates values to be shown in an Active-x dropdown list and then assigns them to the list using the <code>ListFillRange</code> property.\nUnfortunately every time I run it it generates an error. I presume the error is caused by running a piece of code on a power pivot that I'm refreshing before it completes the refresh. The error occurs in the 9th line of the lastRow function which selects a cell in the power pivot. The error no longer appears after I comment out the 5th line of the <code>Sub</code> which refreshes the pivot table.\nI guess the solution to this problem is forcing VBA to wait with going to the next step of the code until the refresh of the table is completed. I tried solving this problem by adding <code>DoEvents</code> and some other techniques that I've found online, but none of them worked. Any suggestions on tackling this problem would be highly appreciated. Thanks!</p>\n\n<pre><code>Sub updateList()\nDim listRangeEnd As Long\n\n'Refresh pivot with all Promotion Weeks\n'Clear all filters\nWorksheets(\"Lookup\").PivotTables(\"weeksList\").ClearAllFilters\n'Refresh pivot\nWorksheets(\"Lookup\").PivotTables(\"weeksList\").RefreshTable\n\n\n'Set listFillRange for the list\nlistRangeEnd = lastRow(\"Lookup\", \"D4\")\nWorksheets(\"Inputs\").list.ListFillRange = \"Lookup!D4:D\" &amp; listRangeEnd\nWorksheets(\"Inputs\").list.Value = Worksheets(\"Lookup\").Range(\"D4\").Value\n\nEnd Sub\n\n\nPublic Function lastRow(sheet As String, Cell As String)\nDim Row As Long\nDim currentSheet As String\n\n'Save the name of the currently selected sheet\ncurrentSheet = ActiveSheet.Name\n\n'Get the row number of the last non-empty cell in the column\nWorksheets(sheet).Select\nWorksheets(sheet).Range(Cell).Select\nIf Selection.Offset(1, 0).Value = \"\" Then\n    Row = ActiveCell.Row\nElse\n    Row = Worksheets(sheet).Range(Cell).End(xlDown).Row\nEnd If\n\n'Go back to the previous sheet\nWorksheets(inputSheet).Select\n\nlastRow = Row\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "copy", "range", "vba"], "answers": [{"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 1, "creation_date": 1424225918, "post_id": 28573869, "comment_id": 45459068, "body": "I noticed recently that there&#39;s even a <code>Range.Worksheet</code> property."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1424219573, "creation_date": 1424219573, "answer_id": 28573869, "question_id": 28573785, "link": "https://stackoverflow.com/questions/28573785/excel-vba-get-the-workbook-associated-with-a-range/28573869#28573869", "title": "Excel VBA: Get the Workbook associated with a range", "body": "<p>Once you have a <em>Range</em> it is easy to get the name of the <em>Sheet</em> the range is on and the name of the <em>Workbook</em> the sheet is on.:</p>\n\n<pre><code>Sub dural()\n    Dim r As Range\n    Set r = Application.InputBox(Prompt:=\"Pick a range\", Type:=8)\n    MsgBox r.Address &amp; vbCrLf &amp; r.Parent.Name &amp; vbCrLf &amp; r.Parent.Parent.Name\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4577623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5697ff380ac82082969f7759b623b8b8?s=128&d=identicon&r=PG&f=1", "display_name": "James Watson", "link": "https://stackoverflow.com/users/4577623/james-watson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 28573869, "answer_count": 1, "score": 2, "last_activity_date": 1424219573, "creation_date": 1424219071, "last_edit_date": 1531161705, "question_id": 28573785, "link": "https://stackoverflow.com/questions/28573785/excel-vba-get-the-workbook-associated-with-a-range", "title": "Excel VBA: Get the Workbook associated with a range", "body": "<p>This macro needs to start selecting data from various sheets on a user-selected workbook. In other words, I do not know the name of the workbook beforehand. I am asking the user to select a cell in another already open file, so that I can start grabbing data from that book.</p>\n\n<pre><code>Set bookRange = Application.InputBox(prompt:=\"Select a cell in the sheet from which you wish to import data\", Type:=8)\nbookName = bookRange.GET_WORKBOOK_NAME_SOMEHOW\n</code></pre>\n\n<p>Does something like <code>GET_WORKBOOK_NAME_SOMEHOW</code> exist?</p>\n"}, {"tags": ["sql-server", "vba", "ms-access", "dsn"], "comments": [{"owner": {"reputation": 1765, "user_id": 208465, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a9dcd74494c9684216ad2e1bb9d551?s=128&d=identicon&r=PG", "display_name": "Ben McIntyre", "link": "https://stackoverflow.com/users/208465/ben-mcintyre"}, "edited": false, "score": 0, "creation_date": 1424255107, "post_id": 28573288, "comment_id": 45470394, "body": "your best bet might be <code>Set dbCurrent = CurrentDb()</code>"}, {"owner": {"reputation": 254, "user_id": 3003304, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/12326275bdcc9e64e4cd9d69eb8637d3?s=128&d=identicon&r=PG&f=1", "display_name": "user3003304", "link": "https://stackoverflow.com/users/3003304/user3003304"}, "reply_to_user": {"reputation": 1765, "user_id": 208465, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a9dcd74494c9684216ad2e1bb9d551?s=128&d=identicon&r=PG", "display_name": "Ben McIntyre", "link": "https://stackoverflow.com/users/208465/ben-mcintyre"}, "edited": false, "score": 0, "creation_date": 1424274856, "post_id": 28573288, "comment_id": 45482667, "body": "I replaced Set dbCurrent = DBEngine.Workspaces(0).Databases(0) with Set dbCurrent = CurrentDb(), but I got &quot;Run-time error &#39;13&#39;: Type mismatch&#39; when I stepped through the code and did ?dbCurrent and ? CurrentDb in the Immediate window.  I also took out the parenthesis since <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221178(v=office.11).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a> has examples without them."}, {"owner": {"reputation": 254, "user_id": 3003304, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/12326275bdcc9e64e4cd9d69eb8637d3?s=128&d=identicon&r=PG&f=1", "display_name": "user3003304", "link": "https://stackoverflow.com/users/3003304/user3003304"}, "reply_to_user": {"reputation": 1765, "user_id": 208465, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a9dcd74494c9684216ad2e1bb9d551?s=128&d=identicon&r=PG", "display_name": "Ben McIntyre", "link": "https://stackoverflow.com/users/208465/ben-mcintyre"}, "edited": false, "score": 0, "creation_date": 1424274933, "post_id": 28573288, "comment_id": 45482713, "body": "Though also when I read that page it mentioned that this is for the currently open database in a microsoft access window.  I&#39;m attempting to make a DSN-less connection and link a MS Access front end with SQL server backend.  So I won&#39;t have a currently opened database in MS Access..."}], "answers": [{"comments": [{"owner": {"reputation": 254, "user_id": 3003304, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/12326275bdcc9e64e4cd9d69eb8637d3?s=128&d=identicon&r=PG&f=1", "display_name": "user3003304", "link": "https://stackoverflow.com/users/3003304/user3003304"}, "edited": false, "score": 0, "creation_date": 1424706992, "post_id": 28619939, "comment_id": 45648606, "body": "I did see that comment and I&#39;ve already attempted to comment it out.  When I go to run it with F5 I get no error messages or anything, but it doesn&#39;t make any table links.  When I used F8 to step through it I did get &quot;Run-time error &#39;13&#39;: Type mismatch&quot; when I entered ?dbCurrent on the Immediate window.  (For both DBEngine.Workspaces(0).Databases(0) and CurrentDb()."}, {"owner": {"reputation": 1765, "user_id": 208465, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a9dcd74494c9684216ad2e1bb9d551?s=128&d=identicon&r=PG", "display_name": "Ben McIntyre", "link": "https://stackoverflow.com/users/208465/ben-mcintyre"}, "reply_to_user": {"reputation": 254, "user_id": 3003304, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/12326275bdcc9e64e4cd9d69eb8637d3?s=128&d=identicon&r=PG&f=1", "display_name": "user3003304", "link": "https://stackoverflow.com/users/3003304/user3003304"}, "edited": false, "score": 0, "creation_date": 1424820584, "post_id": 28619939, "comment_id": 45706131, "body": "That error is because you can&#39;t print the database object. Try <code>?dbCurrent.Name</code>"}], "tags": [], "owner": {"reputation": 1765, "user_id": 208465, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a9dcd74494c9684216ad2e1bb9d551?s=128&d=identicon&r=PG", "display_name": "Ben McIntyre", "link": "https://stackoverflow.com/users/208465/ben-mcintyre"}, "is_accepted": false, "score": 0, "last_activity_date": 1424822694, "last_edit_date": 1424822694, "creation_date": 1424393883, "answer_id": 28619939, "question_id": 28573288, "link": "https://stackoverflow.com/questions/28573288/dsn-less-connection-ms-access-front-end-and-sql-server-backend/28619939#28619939", "title": "DSN-less Connection MS Access front end and SQL server backend", "body": "<p>Looking at DJ Steele's code, I got it working apart from the line</p>\n\n<pre><code>' Unfortunately, I'm current unable to test this code,\n' but I've been told trying this line of code is failing for most people...\n' If it doesn't work for you, just leave it out.\ntdfCurrent.Attributes = typNewTables(intLoop).Attributes\n</code></pre>\n\n<p>which I had to comment out.</p>\n\n<p>Using <code>Set dbCurrent = CurrentDb()</code> does essentially the same thing as <code>Set dbCurrent = DBEngine.Workspaces(0).Databases(0)</code> but the latter is meant to be a lot faster ... which these days means it takes 10 microseconds instead of 100 :-o</p>\n\n<p>You still need dbCurrent as a reference to the current Access front end which is where the linked table objects live, even if the data is coming from elsewhere.</p>\n\n<p>Edit: working for me</p>\n\n<p>I added a debug.print line to monitor what's going on</p>\n\n<pre><code>' Build a list of all of the connected TableDefs and\n' the tables to which they're connected.\n\nFor Each tdfCurrent In dbCurrent.TableDefs\n    Debug.Print tdfCurrent.Name, tdfCurrent.Connect\n    If Len(tdfCurrent.Connect) &gt; 0 Then\n      If UCase$(Left$(tdfCurrent.Connect, 5)) = \"ODBC;\" Then\n          ...\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>? currentdb().TableDefs(\"dbo_Person\").Connect\nODBC;DSN=TacsData;APP=Microsoft Office 2003;WSID=TESTXP;DATABASE=TacsData;Trusted_Connection=Yes;QuotedId=No\n\nFixConnections \"TESTXP\\SQLEXPRESS\", \"TacsData\"\n\nMSysAccessObjects           \nMSysAccessXML \n...     \nMSysRelationships           \nTable1        \ndbo_Person    ODBC;DSN=TacsData;APP=Microsoft Office 2003;WSID=TESTXP;DATABASE=TacsData;Trusted_Connection=Yes;QuotedId=No\n\n? currentdb().TableDefs(\"dbo_Person\").Connect\nODBC;DRIVER=sql server;SERVER=TESTXP\\SQLEXPRESS;APP=Microsoft Office 2003;WSID=TESTXP;DATABASE=TacsData;Trusted_Connection=Yes\n</code></pre>\n"}], "owner": {"reputation": 254, "user_id": 3003304, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/12326275bdcc9e64e4cd9d69eb8637d3?s=128&d=identicon&r=PG&f=1", "display_name": "user3003304", "link": "https://stackoverflow.com/users/3003304/user3003304"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4389, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1424822694, "creation_date": 1424216070, "last_edit_date": 1495535301, "question_id": 28573288, "link": "https://stackoverflow.com/questions/28573288/dsn-less-connection-ms-access-front-end-and-sql-server-backend", "title": "DSN-less Connection MS Access front end and SQL server backend", "body": "<p>I don't normally program in MS Access VBA so forgive my question if it's stupid.</p>\n\n<p>So I'm using MS Access 2010 as a front end and SQL Server 2014 as a backend.  (I don't have a choice in frontend interface so please no suggestions on alternate options).  </p>\n\n<p>I'd like to programatically link SQL server's backend to my MS Access frontend.  I read here at <a href=\"http://www.accessmvp.com/DJSteele/DSNLessLinks.html\" rel=\"nofollow noreferrer\">DJ Steele's DSN-less connection page</a> that I can use the code he provided here to make a DSN-less connection to SQL server as a backend.    </p>\n\n<p>So I copied that into a VBA Access module and opened another module and ran this code to run the DJ Steele code in an attempt to connect to a small SQL Server database I made:</p>\n\n<pre><code>Option Compare Database\nSub runThis()\nFixConnections \"AServerNameHere\", \"MS_Access_BackEnd_Test\"\nEnd Sub\n</code></pre>\n\n<p>As far as I can tell from the VBA debugger it gets to </p>\n\n<pre><code>Set dbCurrent = DBEngine.Workspaces(0).Databases(0)\n</code></pre>\n\n<p>then that value seems to be empty.  I'm not sure how else to proceed with this since as far as I was  able to find this is one of the few full examples of a DSN-less connection I could find.  </p>\n\n<p>I'd like to not use the DSN method of linking a SQL server to a database since that would require me to go visit people and their computers in order to make the links.  (And who'd want to to that? LOL)</p>\n\n<p>I've also looked at similar questions that were linked to me while writing this question and <a href=\"https://stackoverflow.com/questions/10302430/changing-sql-connection-information-for-dsn-less-access-frontend\">this</a> was close to what I wanted, but it kept giving me \"Compile error: Constant expression required\" for input of:  </p>\n\n<pre><code>LinkTable \"MS_Access_BackEnd_Test\", \"Table_1\"\n</code></pre>\n\n<p>and </p>\n\n<pre><code>LinkTable \"MS_Access_BackEnd_Test\", \"Table_1\", , \"AServerNameHere\"\n</code></pre>\n\n<p>Again I'm not familiar with MS Access VBA so forgive the question if it's lame.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424215689, "post_id": 28572415, "comment_id": 45455960, "body": "After opening and modifying each XLS workbook, do you want to save the modified version as XLSX (or even XLSB)? You sample shows only one keyword applied to each; do you want <i>every</i> keyword applied to teh removal of columns for each worksheet?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1424220497, "last_edit_date": 1424220497, "creation_date": 1424216195, "answer_id": 28573309, "question_id": 28572415, "link": "https://stackoverflow.com/questions/28572415/excel-vba-remove-columns-based-of-header-row-in-multiple-sheets/28573309#28573309", "title": "excel VBA remove columns based of header row in multiple sheets", "body": "<pre><code>'Process all workbooks in a given folder\n' - remove specified columns\nSub Tester()\n    Dim c As Collection, f, wb As Workbook\n\n    Set c = GetExcels(\"C:\\_Stuff\\test\") 'edit folder to suit\n    For Each f In c\n        Debug.Print f\n        Set wb = Workbooks.Open(f)\n        ProcessWorkbook wb\n        wb.Close True 'save changes\n    Next f\nEnd Sub\n\n'remove all unwanted columns from a workbook\nSub ProcessWorkbook(wb As Workbook)\n    RemoveColumn wb.Worksheets(\"Sheet7\"), \"RUA Hit Count\"\n    RemoveColumn wb.Worksheets(\"Sheet5\"), \"RUA Usage\"\n    RemoveColumn wb.Worksheets(\"Sheet1\"), \"RUA Start Date\"\n    RemoveColumn wb.Worksheets(\"Sheet2\"), \"RUA End Date\"\n    RemoveColumn wb.Worksheets(\"Sheet3\"), \"RUA Total Days\"\nEnd Sub\n\n'remove a column from a sheet if it exists\nSub RemoveColumn(sht As Worksheet, colName As String)\n    Dim f As Range\n    Set f = sht.Rows(1).Find(what:=colName, lookat:=xlWhole)\n    If Not f Is Nothing Then f.EntireColumn.Delete\nEnd Sub\n\n'get a collection of all Excel filenames (inc. path) in a folder\nFunction GetExcels(sDir As String) As Collection\n    Dim c As New Collection, f\n    If Right(sDir, 1) &lt;&gt; \"\\\" Then sDir = sDir &amp; \"\\\"\n    f = Dir(sDir &amp; \"*.xlsx\")\n    Do While Len(f) &gt; 0\n        c.Add sDir &amp; f\n        f = Dir()\n    Loop\n    Set GetExcels = c\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 531, "user_id": 4244864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/erHT8.jpg?s=128&g=1", "display_name": "bilbo_strikes_back", "link": "https://stackoverflow.com/users/4244864/bilbo-strikes-back"}, "is_accepted": false, "score": 0, "last_activity_date": 1424217055, "last_edit_date": 1424217055, "creation_date": 1424216524, "answer_id": 28573368, "question_id": 28572415, "link": "https://stackoverflow.com/questions/28572415/excel-vba-remove-columns-based-of-header-row-in-multiple-sheets/28573368#28573368", "title": "excel VBA remove columns based of header row in multiple sheets", "body": "<p>This procedure works for the ActiveWorkbook</p>\n\n<p>It could be edited to work on an array of workbooks</p>\n\n<p>It populates a dictionary with the search criteria for the column headers</p>\n\n<p>It then checks each column header and deletes the column if it finds a match</p>\n\n<pre><code>'Tools-&gt;References\n'Reference Microsoft Scripting Runtime\n\nDim intCount1 As Integer\nDim intCounter1 As Integer\nDim intColumnLast As Integer\nDim strHeader As String\nDim wsTemp As Worksheet\nDim dictColumnHeader As Dictionary\n\n'Populate dictionary\nSet dictColumnHeader = New Dictionary\nWith dictColumnHeader\n    .Add Key:=\"RUA Hit Count\", Item:=1\n    .Add Key:=\"RUA Usage\", Item:=2\n    .Add Key:=\"RUA Start Date\", Item:=3\n    .Add Key:=\"RUA End Date\", Item:=4\n    .Add Key:=\"RUA Total Days\", Item:=5\nEnd With\n\nFor Each wsTemp In ActiveWorkbook.Sheets\n    wsTemp.Activate\n    intColumnLast = Cells.Find(What:=\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n    intCount1 = 0\n    'Check each column header to see if it matches bogus column headers loaded into dictionary\n    For intCounter1 = intColumnLast To 1 Step -1\n        'Assuming the header row is on row 1\n        strHeader = Cells(1, intCounter1).Value\n        If dictColumnHeader.Exists(strHeader) = True Then\n            Cells(1, intCounter1).EntireColumn.Delete\n        End If\n    Next intCounter1\nNext wsTemp\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4577357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe07800c23ff3d1ed802bc0045d4f25?s=128&d=identicon&r=PG&f=1", "display_name": "Double", "link": "https://stackoverflow.com/users/4577357/double"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2002, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1424220497, "creation_date": 1424212322, "question_id": 28572415, "link": "https://stackoverflow.com/questions/28572415/excel-vba-remove-columns-based-of-header-row-in-multiple-sheets", "title": "excel VBA remove columns based of header row in multiple sheets", "body": "<p>Ok, so I'm trying to remove columns that contain a specific value in my header rows on multiple sheets. If I remove the Activate Worksheet procedure and place the code on the desired sheet it works fine but this won't be an option. I have ~100 of files which were created with a xls template that I need to remove certain columns.</p>\n\n<p>Below is what I'm trying to do with activating the sheet that contains the header value and the column to be removed.</p>\n\n<p>The value I'm looking for in the examples below are RUA Hit Count, RUA Usage, RUA Start Date, RUA End Date and RUA Total Days. There will be roughly 50 columns removed from each workbook when all said in done.</p>\n\n<pre><code>Sub remove_columns()\n\nDim i As Integer\n\nWorksheets(\"Sheet7\").Activate\nFor i = ActiveSheet.Columns.Count To 1 Step -1\n    If InStr(1, Cells(1, i), \"RUA Hit Count\") Then Columns(i).EntireColumn.Delete\nNext i\n\nWorksheets(\"Sheet5\").Activate\nFor i = ActiveSheet.Columns.Count To 1 Step -1\n    If InStr(1, Cells(1, i), \"RUA Usage\") Then Columns(i).EntireColumn.Delete\nNext i\n\nWorksheets(\"Sheet1\").Activate\nFor i = ActiveSheet.Columns.Count To 1 Step -1\n    If InStr(1, Cells(1, i), \"RUA Start Date\") Then Columns(i).EntireColumn.Delete\nNext i\n\nWorksheets(\"Sheet2\").Activate\nFor i = ActiveSheet.Columns.Count To 1 Step -1\n    If InStr(1, Cells(1, i), \"RUA End Date\") Then Columns(i).EntireColumn.Delete\nNext i\n\nWorksheets(\"Sheet3\").Activate\nFor i = ActiveSheet.Columns.Count To 1 Step -1\n    If InStr(1, Cells(1, i), \"RUA Total Days\") Then Columns(i).EntireColumn.Delete\nNext i\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1424210383, "post_id": 28571872, "comment_id": 45453590, "body": "Debugger stops, what does it <i>tell you</i>?  What is the line that it stops on? You didn&#39;t include any of that information, which we would need to help troubleshoot..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424210428, "post_id": 28571872, "comment_id": 45453618, "body": "What sort of value is in <code>rngRange</code> cell?  Is it just a date value? Or is it a full file path?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1424210502, "post_id": 28571872, "comment_id": 45453650, "body": "Please post the code that saves the word document, kind of hard to help you without seeing that. also post the value held in D95 or verify that is doesnt contain / \\ : * ? &quot; &lt; &gt; | characters"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1424210832, "post_id": 28571872, "comment_id": 45453809, "body": "Use the <code>SaveAs2</code> method of the <code>objDoc</code> document with the parameter 1 as the full path of the file (<code>&quot;C:\\Users\\...&quot; &amp; strFileName</code>) and the constant <code>16</code> as second parameter, which means the standard <code>docx</code> extension."}, {"owner": {"reputation": 23, "user_id": 4577227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f264bb18e7e608cf18a909c42708236?s=128&d=identicon&r=PG&f=1", "display_name": "Mary Anne", "link": "https://stackoverflow.com/users/4577227/mary-anne"}, "edited": false, "score": 0, "creation_date": 1424215277, "post_id": 28571872, "comment_id": 45455788, "body": "Thank you so much for the comments. I edited the original question to reflect that I tried the SaveAs2 fix, but apparently I have no idea what I&#39;m doing because it didn&#39;t work and gave me an error &#39;invalid or unqualified reference&#39;. What did I do wrong? Oh, the value in rngRange is a date value, not a file path. It works fine in another userform that I save as a .pdf file."}, {"owner": {"reputation": 23, "user_id": 4577227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f264bb18e7e608cf18a909c42708236?s=128&d=identicon&r=PG&f=1", "display_name": "Mary Anne", "link": "https://stackoverflow.com/users/4577227/mary-anne"}, "edited": false, "score": 0, "creation_date": 1424215504, "post_id": 28571872, "comment_id": 45455881, "body": "Also, the value of D95 in the filename is just 6 digits with no other characters from a cell formatted as &quot;general&quot;. Like I said, strFilename works fine on another userform that I save as a .pdf, but apparently saving as a word document is different."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4577227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f264bb18e7e608cf18a909c42708236?s=128&d=identicon&r=PG&f=1", "display_name": "Mary Anne", "link": "https://stackoverflow.com/users/4577227/mary-anne"}, "edited": false, "score": 0, "creation_date": 1424217539, "post_id": 28573194, "comment_id": 45456561, "body": "Thank you again for your response. I think I understand what you mean; however, I don&#39;t know how to modify my code to make it work. What should I add to my code to get it to work?"}, {"owner": {"reputation": 23, "user_id": 4577227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f264bb18e7e608cf18a909c42708236?s=128&d=identicon&r=PG&f=1", "display_name": "Mary Anne", "link": "https://stackoverflow.com/users/4577227/mary-anne"}, "edited": false, "score": 0, "creation_date": 1424222897, "post_id": 28573194, "comment_id": 45458242, "body": "Okay, so I just added objDoc. onto my original SaveAs2 line, but now it saves a blank Word document with my strFilename (closing it) and pastes my cell onto another Document1 and leaves it open. So it&#39;s basically creating two Word documents: one with my cell pasted onto it and the other with the filename I specified with nothing in it. I&#39;m missing something big time here."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 23, "user_id": 4577227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f264bb18e7e608cf18a909c42708236?s=128&d=identicon&r=PG&f=1", "display_name": "Mary Anne", "link": "https://stackoverflow.com/users/4577227/mary-anne"}, "edited": false, "score": 0, "creation_date": 1424223449, "post_id": 28573194, "comment_id": 45458404, "body": "@MaryAnne this is because <code>objDoc</code> is an empty Word document, you don&#39;t assign it as the one you add to your Word application. In your 5th line of code, replace <code>.Documents.Add</code> with <code>Set objDoc = .Documents.Add</code>: this will add your new document to the application and at the same time setting <code>objDoc</code> as the reference to it, so avoiding the problem you&#39;re talking about now."}, {"owner": {"reputation": 23, "user_id": 4577227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f264bb18e7e608cf18a909c42708236?s=128&d=identicon&r=PG&f=1", "display_name": "Mary Anne", "link": "https://stackoverflow.com/users/4577227/mary-anne"}, "edited": false, "score": 0, "creation_date": 1424396602, "post_id": 28573194, "comment_id": 45543148, "body": "I got it! Thank you so much."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1424215589, "creation_date": 1424215589, "answer_id": 28573194, "question_id": 28571872, "link": "https://stackoverflow.com/questions/28571872/vba-excel-save-as-word-document-not-working/28573194#28573194", "title": "VBA Excel - save as word document not working", "body": "<p>You need to reference the object you are using the method onto: </p>\n\n<pre><code>objDoc.SaveAs2 \"C:\\Users\\Mary Anne\\Google Drive\\\" &amp; strFilename, 16\n</code></pre>\n\n<p>Find more about the <code>SaveAs2</code> method in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836084.aspx\" rel=\"nofollow\">official doc</a></p>\n\n<p>What you're doing wrong, in fact, is calling the method on no object: </p>\n\n<pre><code>.SaveAs2 \n</code></pre>\n\n<p>I bet my hat you have copied this line of code from a <code>With</code> block like the following, so I will explain you what it means :) : </p>\n\n<pre><code>With objDoc '&lt;-- \"with the objDoc\", we will...\n'...        '&lt;-- \"do many stuffs, among them we will also...\"\n.SaveAs2    '&lt;-- \"save the objDoc as SaveAs2\"\n'...\nEnd With\n</code></pre>\n\n<p>The <code>.SaveAs2</code> means there's an object previously called in a <code>With</code> block, it cannot stand alone or you will get a compile error.</p>\n"}], "owner": {"reputation": 23, "user_id": 4577227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f264bb18e7e608cf18a909c42708236?s=128&d=identicon&r=PG&f=1", "display_name": "Mary Anne", "link": "https://stackoverflow.com/users/4577227/mary-anne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2579, "favorite_count": 0, "accepted_answer_id": 28573194, "answer_count": 1, "score": 1, "last_activity_date": 1424215589, "creation_date": 1424210178, "last_edit_date": 1424215206, "question_id": 28571872, "link": "https://stackoverflow.com/questions/28571872/vba-excel-save-as-word-document-not-working", "title": "VBA Excel - save as word document not working", "body": "<p>Somebody please help me before my laptop goes sailing out the window. I have created an Excel userform that, after everything is entered, copies text from one cell on the worksheet and pastes it into a new Word document. It works beautifully, and the Word document opens like it's supposed to and pastes the contents of the cell into it. I could manually save the open Word document at that point, but I want the document to save with a specific filename and into a specific folder, then close Word completely. The SaveAs didn't work for me; I don't know what I'm doing wrong. </p>\n\n<p>This is my first post btw - was hoping that I would find my answer by searching, but after hours of searching and trying different things, I gave in and posted. I apologize in advance if I break any question-asking etiquette rules! </p>\n\n<p>The following code is for a button click on my userform, snipped right after I copy the cell I want to paste into Word. \nEdit: I changed my original question to reflect that I tried the SaveAs2 fix suggested. I'm now getting the error \"Invalid or unqualified reference\". Help?</p>\n\n<pre><code>'copy to word\nDim objWord As New Word.Application\nDim objDoc As New Word.Document\n\n'Copy the range I want to paste in new Word document\nRange(\"M47\").Copy\n\n'Paste into the new Word document\nWith objWord\n    .Documents.Add\n    .Selection.Paste\n    .Visible = True\nEnd With\n\n'****************WORKS FINE UP UNTIL THIS POINT.\n\n'The document opens with the text I want in it.\n\n'Creating the special filename\nDim strFilename     As String\nDim rngRange        As Range\n\n'Cell in Excel Worksheet from where filename is to be picked (patient date    of birth)\nSet rngRange = Worksheets(\"Scores\").Range(\"D95\")\n\n'Create File name with DOB, 'PAI', &amp; today's date\nstrFilename = rngRange.Value &amp; \"PAI\" &amp; Format(Now(), \"mmddyyyy\")\n\n .SaveAs2 Filename:=(\"C:\\Users\\Mary Anne\\Google Drive\\\") &amp; strFilename, _\nFileFormat:=16\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "google-drive-api", "cloud", "vba"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1424222781, "post_id": 28571594, "comment_id": 45458202, "body": "You&#39;ll need to explain how you determine the URL to download from. - post the code you have so far. Also, the specific image you linked to has some hate speech in one of the later frames so maybe don&#39;t use that one as an example"}, {"owner": {"reputation": 18863, "user_id": 1000753, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/23634e7a38e353cca12bb72a4205615b?s=128&d=identicon&r=PG", "display_name": "pinoyyid", "link": "https://stackoverflow.com/users/1000753/pinoyyid"}, "edited": false, "score": 0, "creation_date": 1424259227, "post_id": 28571594, "comment_id": 45472846, "body": "SO isn&#39;t for asking for site recommendations."}, {"owner": {"reputation": 113, "user_id": 4167890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-CJdi_gTrKkM/AAAAAAAAAAI/AAAAAAAAABE/E-umwKcJ_mY/photo.jpg?sz=128", "display_name": "Alenn G&#39;Kar", "link": "https://stackoverflow.com/users/4167890/alenn-gkar"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1424283243, "post_id": 28571594, "comment_id": 45488192, "body": "@barrowc I&#39;m just copy URL from browser and pinning that on some place, so I need stable URL even if I&#39;ll edit that picture. (taht second link works like 2 minutes)"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4167890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-CJdi_gTrKkM/AAAAAAAAAAI/AAAAAAAAABE/E-umwKcJ_mY/photo.jpg?sz=128", "display_name": "Alenn G&#39;Kar", "link": "https://stackoverflow.com/users/4167890/alenn-gkar"}, "edited": false, "score": 0, "creation_date": 1424362804, "post_id": 28595594, "comment_id": 45526452, "body": "<a href=\"https://drive.google.com/file/d/0B5XnS38fU57wSlBHNm80VzVtNWM/3.jpg\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0B5XnS38fU57wSlBHNm80VzVtNWM/3.jpg</a> Nah still not get it"}], "tags": [], "owner": {"reputation": 126, "user_id": 1863942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a44431a02e7679465c47424af1945660?s=128&d=identicon&r=PG", "display_name": "Ian Weatherhogg", "link": "https://stackoverflow.com/users/1863942/ian-weatherhogg"}, "is_accepted": false, "score": 1, "last_activity_date": 1424300332, "creation_date": 1424300332, "answer_id": 28595594, "question_id": 28571594, "link": "https://stackoverflow.com/questions/28571594/refreshing-url-glitch-cloud-updating-rewriting/28595594#28595594", "title": "Refreshing URL glitch - cloud updating/rewriting", "body": "<p>You can either use the Drive SDK to get the file details including the latest temporary download link:\n<a href=\"https://developers.google.com/drive/v2/reference/files/get\" rel=\"nofollow\">https://developers.google.com/drive/v2/reference/files/get</a></p>\n\n<p>...or you can make a parent or grandparent folder public and work out a URL direct to the image using its filename, like this:\n<a href=\"http://gappstips.com/gmail/use-google-drive-to-host-your-gmail-signature/\" rel=\"nofollow\">http://gappstips.com/gmail/use-google-drive-to-host-your-gmail-signature/</a></p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 4167890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-CJdi_gTrKkM/AAAAAAAAAAI/AAAAAAAAABE/E-umwKcJ_mY/photo.jpg?sz=128", "display_name": "Alenn G&#39;Kar", "link": "https://stackoverflow.com/users/4167890/alenn-gkar"}, "is_accepted": true, "score": 0, "last_activity_date": 1424364159, "creation_date": 1424364159, "answer_id": 28611929, "question_id": 28571594, "link": "https://stackoverflow.com/questions/28571594/refreshing-url-glitch-cloud-updating-rewriting/28611929#28611929", "title": "Refreshing URL glitch - cloud updating/rewriting", "body": "<pre><code>http://drive.google.com/uc?export=view&amp;id= \"ID\"\n</code></pre>\n\n<p>If you change URL in view mode you can view that image dirrect.</p>\n\n<p><a href=\"http://blog.appsevents.com/2014/04/how-to-bypass-google-drive-viewer-and.html\" rel=\"nofollow\">There</a> are other files types.</p>\n"}], "owner": {"reputation": 113, "user_id": 4167890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-CJdi_gTrKkM/AAAAAAAAAAI/AAAAAAAAABE/E-umwKcJ_mY/photo.jpg?sz=128", "display_name": "Alenn G&#39;Kar", "link": "https://stackoverflow.com/users/4167890/alenn-gkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 28611929, "answer_count": 2, "score": 0, "last_activity_date": 1424364159, "creation_date": 1424209203, "last_edit_date": 1531164843, "question_id": 28571594, "link": "https://stackoverflow.com/questions/28571594/refreshing-url-glitch-cloud-updating-rewriting", "title": "Refreshing URL glitch - cloud updating/rewriting", "body": "<p>Hello I've created an VBA script which saves me jpg from excel and then gsync uploads it on gDrive, but here comes the thing. The URL for downloading is volatile and I need full resolution image.</p>\n\n<p>There is <a href=\"https://drive.google.com/file/d/0B5XnS38fU57wSlBHNm80VzVtNWM/view\" rel=\"nofollow\">link</a> so you can open in awful google UI\nand I would like to open <a href=\"https://lh6.googleusercontent.com/8cl0RPSOk8twcnrBUexBWSpaytO451WiqMQhICEZb4T0I6V252_W1RVOpCq_9rcIT0-zqA7ySKQ=w1153-h715\" rel=\"nofollow\">THIS</a> => volatile link :(</p>\n\n<p>Or can I use this VBA to upload image on some other Cloud directly from excel?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1424225619, "post_id": 28574309, "comment_id": 45458972, "body": "Thank you....getting closer.  It creates the query results in Access 2007, but does not transfer any data to the blank file &quot;Donation Data.xlsx.&quot;  so I changed the file to Donation Data.xlsm and the statement:"}, {"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1424225665, "post_id": 28574309, "comment_id": 45458984, "body": "DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, &quot;DonationDataQuery&quot;, &quot;C:\\Users\\dads\\Downloads\\Donation Data.xlsm&quot;, True          transfer message indicates a transfer, but no data in the file"}, {"owner": {"reputation": 734, "user_id": 4072870, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0ac60c8dfccd524dec0324413af2b6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dane I", "link": "https://stackoverflow.com/users/4072870/dane-i"}, "reply_to_user": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1424227140, "post_id": 28574309, "comment_id": 45459362, "body": "your inputbox line has an apostrophe infront of it, your SQL has no value for Pdate and thus your code is returning 0 records"}], "tags": [], "owner": {"reputation": 734, "user_id": 4072870, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0ac60c8dfccd524dec0324413af2b6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dane I", "link": "https://stackoverflow.com/users/4072870/dane-i"}, "is_accepted": true, "score": 1, "last_activity_date": 1424222322, "creation_date": 1424222322, "answer_id": 28574309, "question_id": 28571553, "link": "https://stackoverflow.com/questions/28571553/simple-click-query-and-export-not-so-simple/28574309#28574309", "title": "Simple Click, Query, and Export - not so simple", "body": "<p>Try this, replace the line in question with (UNTESTED):</p>\n\n<pre><code>qd.SQL = \"SELECT * FROM [Donation_Data] WHERE [Donation_Data].[Pickup Date] = Pdate\"\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 28574309, "answer_count": 1, "score": 0, "last_activity_date": 1594645390, "creation_date": 1424209019, "last_edit_date": 1594645390, "question_id": 28571553, "link": "https://stackoverflow.com/questions/28571553/simple-click-query-and-export-not-so-simple", "title": "Simple Click, Query, and Export - not so simple", "body": "<p>Can any one help me set up an Access 2007 VBA query where a visually impaired person could enter a date (Pdate) on a form and result in a query of my table [Donation_Data] to find all records with [Pickup Date] = Pdate and then automatically export the records as an EXCEL file. </p>\n\n<p>Here is what I have so far, but stops at </p>\n\n<p>qd.SQL = \"SELECT * FROM \" &amp; [Donation_Data] &amp; \" WHERE [Pickup Date] = Pdate\"</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Option Compare Database\r\nOption Explicit\r\n\r\nPrivate Sub Command1_Click()\r\n\r\nDim db As DAO.Database\r\nSet db = CurrentDb   ' use current database\r\n\r\n'On Error GoTo Pickup_OnClick_Err\r\n\r\nDim Pdate As Date\r\n\r\nPdate = InputBox(\"Please Enter the Desired Pickup Date\", \"\")\r\n\r\n\r\n'develop a query of all Donation_Data records where Pickup Date in Donation_Data table = Pdate\r\n\r\nDim qd As DAO.QueryDef\r\n\r\nSet qd = CurrentDb.CreateQueryDef(\"DonationDataQuery\")\r\n\r\nqd.SQL = \"SELECT * FROM \" &amp; [Donation_Data] &amp; \" WHERE [Pickup Date] = Pdate\"\r\n\r\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"DonationDataQuery\", \"C:\\Users\\dads\\Downloads\\Donation Data.xlsx\", True\r\n\r\nDebug.Print qd.SQL\r\n\r\nMsgBox \"transfered\"\r\n\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Based on comment recommendation below, code now looks like this.  Query develops beautifully, but no data transfers</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Dim db As DAO.Database\r\nSet db = CurrentDb   ' use current database\r\n\r\n'On Error GoTo Pickup_OnClick_Err\r\n\r\nDim Pdate As Date\r\n\r\n'Pdate = InputBox(\"Please Enter the Desired Pickup Date\", \"\")\r\n\r\n\r\n'develop a query of all Donation_Data records where Pickup Date in Donation_Data table = Pdate\r\n\r\nDim qd As DAO.QueryDef\r\n\r\nSet qd = CurrentDb.CreateQueryDef(\"DonationDataQuery\")\r\n\r\nqd.SQL = \"SELECT * FROM [Donation_Data] WHERE [Donation_Data].[Pickup Date] = Pdate\"\r\n\r\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"DonationDataQuery\", \"C:\\Users\\dads\\Downloads\\Donation Data.xlsm\", True\r\n\r\nDebug.Print qd.SQL\r\n\r\nMsgBox \"transfered\"\r\n\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4567919, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c8s3SXRQDO4/AAAAAAAAAAI/AAAAAAAAIYA/YfWAzhPHZyU/photo.jpg?sz=128", "display_name": "Isaac Kotlicky", "link": "https://stackoverflow.com/users/4567919/isaac-kotlicky"}, "edited": false, "score": 0, "creation_date": 1424211067, "post_id": 28571689, "comment_id": 45453917, "body": "No, the list isn&#39;t this short - there&#39;s over 500 chapters spread across multiple categories with dozens of books! This looks like something workable. I&#39;ve never used the MOD() function like that before. Hopefully I&#39;ll get to incorporating this later today! Thanks!"}], "tags": [], "owner": {"reputation": 344, "user_id": 4475014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yx5fq.jpg?s=128&g=1", "display_name": "Engineer Toast", "link": "https://stackoverflow.com/users/4475014/engineer-toast"}, "is_accepted": false, "score": 2, "last_activity_date": 1424209546, "creation_date": 1424209546, "answer_id": 28571689, "question_id": 28571363, "link": "https://stackoverflow.com/questions/28571363/list-based-modular-arithmetic-in-excel/28571689#28571689", "title": "List based modular arithmetic in excel", "body": "<p>It's easier if you keep track of how many chapters were in previous books. Here's the CSV of my setup:</p>\n\n<blockquote>\n  <p>Current Day of cycle:,16,<br> ,,<br> Book,Chapters,Prev. Chapters<br>\n  Book A,10,0<br> Book B,15,10<br> Book C,30,25<br> Book D,5,55<br></p>\n</blockquote>\n\n<p>I used a formula for Prev. Chapters but you don't really have to if your list is really this short.</p>\n\n<pre><code>=SUM($B$4:$B4)-B4\n</code></pre>\n\n<p>Now you have all you need. You can break it into 3 formulas to make it easier to follow: (mine are in the range <code>E1:E3</code>)</p>\n\n<pre><code>=IF(MOD(B1,60)=0,60,MOD(B1,60))\n=MATCH(E1,C4:C7)\n=\"Book \" &amp; INDEX(A4:A7,E2) &amp; \" Chapter \" &amp; E1-INDEX(C4:C7,E2)\n</code></pre>\n\n<p>... or you can have one big formula:</p>\n\n<pre><code>=\"Book \" &amp; INDEX(A4:A7,MATCH(IF(MOD(B1,60)=0,60,MOD(B1,60)),C4:C7)) &amp; \" Chapter \" &amp; IF(MOD(B1,60)=0,60,MOD(B1,60))-INDEX(C4:C7,MATCH(IF(MOD(B1,60)=0,60,MOD(B1,60)),C4:C7))\n</code></pre>\n\n<p>If you want just the book name and chapter number, it'd be these:</p>\n\n<pre><code>=INDEX(A4:A7,E2)\n=E1-INDEX(C4:C7,E2)\n</code></pre>\n\n<p>... or as standalones:</p>\n\n<pre><code>=INDEX(A4:A7,MATCH(IF(MOD(B1,60)=0,60,MOD(B1,60)),C4:C7))\n=IF(MOD(B1,60)=0,60,MOD(B1,60))-INDEX(C4:C7,MATCH(IF(MOD(B1,60)=0,60,MOD(B1,60)),C4:C7))\n</code></pre>\n\n<hr>\n\n<p>For your final application, I'd suggest the following:</p>\n\n<ul>\n<li>Make the total number of chapters dynamic instead of the hard-coded 60 shown in my examples</li>\n<li>Format the final output to look like whatever you need</li>\n<li>Keep the formulas separated so you can troubleshoot if something goes crazy. Big formulas give nice results but are hard to fix.</li>\n</ul>\n"}], "owner": {"reputation": 101, "user_id": 4567919, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c8s3SXRQDO4/AAAAAAAAAAI/AAAAAAAAIYA/YfWAzhPHZyU/photo.jpg?sz=128", "display_name": "Isaac Kotlicky", "link": "https://stackoverflow.com/users/4567919/isaac-kotlicky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1424209546, "creation_date": 1424208231, "question_id": 28571363, "link": "https://stackoverflow.com/questions/28571363/list-based-modular-arithmetic-in-excel", "title": "List based modular arithmetic in excel", "body": "<p>I am building a file to track my goals when reviewing material. Since the objective is to read one chapter a day, I want to display my progress based upon the start date. Since this is a cyclical review, it requires some form of modular arithmetic to properly account for restarting the list at the end of the previous completion. I can't wrap my head around a straightforward method to do this via excel formulas or VBA programming, and figured the gurus here would be helpful.</p>\n\n<p>Sample table:</p>\n\n<p>Current day of cycle: XXX</p>\n\n<p>Book  #_of_Chapters</p>\n\n<p>Book A 10</p>\n\n<p>Book B 15</p>\n\n<p>Book C 30</p>\n\n<p>Book D 5</p>\n\n<p>Total Chapters: 60</p>\n\n<p>Today: Book YYY Chapter ZZZ</p>\n\n<p>Expected result: If XXX is 40, YYY is Book C and ZZZ is Chapter 15 (40-10 for Book A and 15 for Book B). If XXX is 62, YYY is Book A (since we've restarted) and ZZZ is Chapter 2. </p>\n\n<p>I don't currently have the VBA code I started on to add to this post.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1424208984, "post_id": 28571104, "comment_id": 45452892, "body": "That does put the contents of one sheet onto another, but what I need to do is find cases where the data is called something different. Such as in doc 1 it&#39;s labeled &quot;requirements&quot; and in the new format the same data is labeled &quot;certifications&quot; so in that case, I would look for &quot;requirements&quot; and know that the data in there needs to be put under the new format &quot;certifications&quot; column."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 1, "creation_date": 1424209290, "post_id": 28571104, "comment_id": 45453045, "body": "@shagans - It sounds as if you need a cross-reference table that will translate the two. I suggest building a complete list of the available column header labels and assigning a new label value to each."}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1424209520, "post_id": 28571104, "comment_id": 45453154, "body": "Yes that does sound like a good idea. What I&#39;m trying to do is figure out how to dynamically build that complete list. Since I&#39;m dealing with sheets that just have values in the top cells as the &quot;headers&quot; my attempt above was to build the array of those values which I intended to treat like a list of the column header labels used in that document."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1424209750, "post_id": 28571104, "comment_id": 45453279, "body": "Use the code above and comment the part that actually copies anything, leaving only the part that constructs the header labels across the first row of the target worksheet. When it is done, copy it and paste special, transpose to put it into a column. Work down the column supplying a new (or the same) value in te cell next to it."}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1424357914, "post_id": 28571104, "comment_id": 45522875, "body": "well I was hoping to find a way to deal with all of the data manipulation in code, but I&#39;ll give this a shot and see if I can get it to work with what I&#39;m doing. Thanks!"}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1425997096, "post_id": 28571104, "comment_id": 46183854, "body": "I was able to get this method to work. It&#39;s not quite what I wanted, but it gets the job done. Thanks a lot for the help!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1424207150, "creation_date": 1424207150, "answer_id": 28571104, "question_id": 28570629, "link": "https://stackoverflow.com/questions/28570629/excel-vba-for-each-sheet-get-contents-of-a-row-and-put-in-an-array/28571104#28571104", "title": "Excel VBA For each sheet get contents of a row and put in an array", "body": "<p>I find when aggregating a number of worksheets with similar (but non-conforming) layouts to a common worksheet, the brick-by-brick approach takes a little longer but it the most thorough. In the following, each sequenced worksheet has each column heading label examined to see if it already exists in the target worksheet. If not, it is inserted at the right-most end of row 1 and the cycle continues.</p>\n\n<pre><code>Dim r As Long, c As Long, tr As Long, tc As Long, ws As Worksheet, wst As Worksheet\n\nSet wst = Sheets(\"All_of_Them\")\nFor Each ws In Worksheets\n    With ws\n        If .Name &lt;&gt; wst.Name Then\n            With .Cells(1, 1).CurrentRegion\n                tr = wst.Cells(1, 1).CurrentRegion.Rows.Count + 1\n                For c = 1 To .Cells(1, .Columns.Count).End(xlToLeft).Column\n                    If Not CBool(Application.CountIf(wst.Rows(1), .Cells(1, c).Value)) Then\n                        wst.Cells(1, .Columns.Count).End(xlToLeft).Offset(0, 1) = .Cells(1, c).Value\n                    End If\n                    tc = Application.Match(.Cells(1, c).Value, wst.Rows(1), 0)\n                    .Columns(c).Offset(1, 0).Copy Destination:=wst.Cells(tr, tc)\n                Next c\n            End With\n        End If\n    End With\nNext ws\n\nSet wst = Nothing\n</code></pre>\n\n<p>The above should be easily expanded to multiple workbooks in one or many folders. The target worksheet can start off as a blank worksheet and the aggregated column header labels will be constructed as new header labels are introduced with sequenced worksheets.</p>\n"}], "owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "accepted_answer_id": 28571104, "answer_count": 1, "score": 0, "last_activity_date": 1424207150, "creation_date": 1424205236, "question_id": 28570629, "link": "https://stackoverflow.com/questions/28570629/excel-vba-for-each-sheet-get-contents-of-a-row-and-put-in-an-array", "title": "Excel VBA For each sheet get contents of a row and put in an array", "body": "<p>I have a current project that requires me to open an excel doc, figure out what format the doc is in (what the \"headers\" are as A:A contents), then figure out if it adheres to a new document layout format, and convert necessary data to conform to the new format. </p>\n\n<p>I have to do this for thousands of files, so I want to automate as much of the discovery portion as possible, and plan to only need to write a few one-off solutions for some content types (docs with specific data which needs to be preserved as an exception to the new formatting). </p>\n\n<p>That's the context for what I'm trying to do. I've gotten to the point of trying to populate an array of the contents of row A:A in each sheet, but my ReDim statement is failing as I guarantee I'm doing something wrong with it. </p>\n\n<p>Here's what I've got from the point where I get into the sheet: </p>\n\n<pre><code>For Each Sht In SourceWorkbook.Sheets\n    Sht.Activate\nSourceHeaderCount = ActiveSheet.UsedRange.Columns.Count\nSet SourceHeaderRange = Sht.Range(\"A1:A\" &amp; SourceHeaderCount)\nReDim Preserve SourceHeaders(0 To UBound(SourceHeaders) + SourceHeaderCount)\nSourceHeaders(UBound(SourceHeaders)) = SourceHeaderRange\nNext Sht\n</code></pre>\n\n<p>Again, the idea is to grab the contents of A:A (used contents only), so that I have a list of what the file does have, then compare that list with what I need it to have, then from there I need to create sub functions to handle each type of conversion. First thing's first though, I need to know what the file has. Any ideas how I can make this work? I recognize that this approach has flaws when confronting non-standardized data (like what if a2 is unused but a3 is used?) but for the purposes of this context, assume all documents are easy to work with and there's no real strange data scheme to worry about. </p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["excel", "filenames", "vlookup", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424209107, "post_id": 28570499, "comment_id": 45452950, "body": "Start with <code>myRangeName2 = Range(&quot;B2:B2000&quot;).Address</code> to get the <i>B2:B2000</i> part out. If your worksheet name could conceivably contain a space then you will need to add wrapping ticks (aka apostrophes) like <code>=&#39;[Book1]Sheet 2&#39;!$F$8</code>."}, {"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1424209528, "post_id": 28570499, "comment_id": 45453161, "body": "Ok that got my range to populate, but how would I get the ticks in there without commenting out everything."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424210407, "post_id": 28571891, "comment_id": 45453605, "body": "Afterthought: the ticks can go in whether they are actually needed or not. They do no harm unless they are absent when actually needed."}, {"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1424210786, "post_id": 28571891, "comment_id": 45453787, "body": "Thanks for helping with all that syntax. However, now I am getting an &quot;application-defined or object defined error&quot;. Do have any thoughts on what would cause that in relation to the line."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1424212120, "post_id": 28571891, "comment_id": 45454419, "body": "@Tyler - Glad that worked out for you. If anyone else can see where I went wrong with my brick-by-brick approach, I would appreciate the error being pointed out so I can edit this &#39;answer&#39; and make any necessary correction(s)."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1424211368, "last_edit_date": 1424211368, "creation_date": 1424210242, "answer_id": 28571891, "question_id": 28570499, "link": "https://stackoverflow.com/questions/28570499/excel-vba-vlookup-with-varying-file-names/28571891#28571891", "title": "Excel VBA - VLookup with Varying File Names", "body": "<p>Start with <code>myRangeName2 = Range(\"B2:B2000\").Address</code> to get the B2:B2000 part out. If your worksheet name could conceivably contain a space then you will need to add wrapping ticks (aka apostrophes) like <code>'[Book1]Sheet 2'!$B$2:$B$2000</code>. Example:</p>\n\n<pre><code>Range(\"F2:F2000\").Formula = \"=VLOOKUP(E2, '[\" &amp; myFileName2 &amp; \"]\" &amp; mySheetName2 &amp; \"'!\" &amp; myRangeName2 &amp; \", 1, FALSE)\"\n</code></pre>\n\n<p>The <em>ticks</em> start before the first square bracket and end just before the exclamation mark that separates the workbook/worksheet from the actual cell range.</p>\n\n<p>You will note above that the formula can be applied in a relative <em>fill down</em> manner to all cells at once (replacing the separate <code>.FillDown</code> operation). <em>myRangeName2</em> needs to represent absolute cell addresses (e.g. $B$2:$B$2000) which is the default when used like <code>myRangeName2 = Range(\"B2:B2000\").Address</code>. see <a href=\"https://msdn.microsoft.com/en-us/library/office/aa174749(v=office.11).aspx\" rel=\"nofollow\">Address property</a> for more information.</p>\n\n<p><strong>Addendum: .Address with external:=True</strong></p>\n\n<p>While learning the proper string construction of a workbook/worksheet/cell range address is never a bad thing, the whole thing can be retrieved directly by adding the <code>, External:=True</code> parameter to the <code>.Address</code> retrieval.</p>\n\n<pre><code>myRangeName2 = ActiveWorkbook.ActiveSheet.Range(\"B2:B2000\").Address(RowAbsolute:=1, ColumnAbsolute:=1, external:=True)\nRange(\"F2:F2000\").Formula = \"=VLOOKUP(E2, \" &amp; myRangeName2 &amp; \", 1, FALSE)\"\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2861, "favorite_count": 0, "accepted_answer_id": 28571891, "answer_count": 1, "score": 0, "last_activity_date": 1424211368, "creation_date": 1424204787, "last_edit_date": 1531164843, "question_id": 28570499, "link": "https://stackoverflow.com/questions/28570499/excel-vba-vlookup-with-varying-file-names", "title": "Excel VBA - VLookup with Varying File Names", "body": "<p>I am trying to perform a vlookup on a file that will not have a constant name. The file name is determined by the file names that are displayed in the two TextBoxes. I have started to set up the vLookup equation, but I am not sure what in it is going wrong when I run the macro. I get a type mismatch error from the vlookup line and the range value seems to come up empty. Is there some other way to reference the range that would work for this situation? Thanks for any help.</p>\n\n<pre><code>'Populating the textbox\nPrivate Sub openDialog1()\n\nDim fd As Office.FileDialog\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\nWith fd\n  .AllowMultiSelect = False\n  .Title = \"Please select the report.\"\n  .Filters.Clear\n  .Filters.Add \"Excel 2003\", \"*.xls\"\n  .Filters.Add \"All Files\", \"*.*\"\n  If .Show = True Then\n    FilePath1 = .SelectedItems(1)'The full File path\n    ary = Split(.SelectedItems(1), \"\\\")'Splitting the file name from the file path\n    TextBox1.Value = ary(UBound(ary))'Displaying just the file name and extension\n\n  End If\nEnd With\nEnd Sub\n'The second textbox is filled the same way.\n\n\n'VLookup using a cell in File 1 vs. the column in File 2\nPrivate Sub Vlookup()\n\nWindows(TextBox2.Value).Activate\nmyFileName2 = ActiveWorkbook.Name\nmySheetName2 = ActiveSheet.Name\nmyRangeName2 = Range(\"B2:B2000\")\n\nWindows(TextBox1.Value).Activate\nColumns(\"F:F\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"F2\").Select\n\nRange(\"F2\").Formula = \"=VLOOKUP(E2,[\" &amp; myFileName2 &amp; \"]\" &amp; mySheetName2 &amp; \"!\" &amp; myRangeName2 &amp; \",1,0)\" ' Having issues with the syntax here.\n\nRange(\"F2\").Select\nSelection.AutoFill Destination:=Range(\"F2:F2000\")\nEnd sub\n</code></pre>\n"}, {"tags": ["excel", "copy", "autofilter", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424205088, "post_id": 28570180, "comment_id": 45450981, "body": "Try <code>MsgBox colnm</code> and <code>MsgBox cColNm</code>. The brackets are unnecessary. The auto-spacing inserted between <i>MsgBox</i> and <i>(</i> is trying to tell you that."}, {"owner": {"reputation": 45, "user_id": 2930371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63fe7f4c8abcd1ecad8b71185a584b60?s=128&d=identicon&r=PG&f=1", "display_name": "CodeKavi", "link": "https://stackoverflow.com/users/2930371/codekavi"}, "edited": false, "score": 0, "creation_date": 1424205776, "post_id": 28570180, "comment_id": 45451327, "body": "thanks Jeeped. i did that and even then it gave me an error... I got the root cause.  split function in the excel macro given an array of elements. i was trying to msgbox on an array without reference and hence it is failing...  i&#39;ve corrected the code.. it looks like below.//   colnm = Split(Cells(, ColNo).Address(True, False), &quot;$&quot;)(0)  &#39;Below section will filter the row 6 on GeneralInfo tab and copy only those marked Change or New from input build ID      Rows(&quot;6:6&quot;).Select     Selection.AutoFilter = True     MsgBox colnm     cColNm = colnm &amp; 6     MsgBox cColNm"}, {"owner": {"reputation": 45, "user_id": 2930371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63fe7f4c8abcd1ecad8b71185a584b60?s=128&d=identicon&r=PG&f=1", "display_name": "CodeKavi", "link": "https://stackoverflow.com/users/2930371/codekavi"}, "edited": false, "score": 0, "creation_date": 1424205990, "post_id": 28570180, "comment_id": 45451428, "body": "i have given the (0) which means the first element of that array  colnm = Split(Cells(, ColNo).Address(True, False), &quot;$&quot;)(0)  My bad i did not know split is an array.  thank you very much for the help..."}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 2930371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63fe7f4c8abcd1ecad8b71185a584b60?s=128&d=identicon&r=PG&f=1", "display_name": "CodeKavi", "link": "https://stackoverflow.com/users/2930371/codekavi"}, "is_accepted": true, "score": 1, "last_activity_date": 1424206680, "creation_date": 1424206680, "answer_id": 28570964, "question_id": 28570180, "link": "https://stackoverflow.com/questions/28570180/excel-macro-to-include-parameter-in-range/28570964#28570964", "title": "Excel macro to include parameter in Range", "body": "<p>thanks Jeeped. </p>\n\n<p>i did remove the brackets in msgbox and even then it gave me an error... \nThe root cuase for this is that i was trying to display an array using msgbox with no reference</p>\n\n<p>split function in the excel macro gives an array of elements. \ni was trying to msgbox on an array without reference and hence it is failing... </p>\n\n<p>i've corrected the code.. it looks like below.// </p>\n\n<p>colnm = Split(Cells(, ColNo).Address(True, False), \"$\")(0) </p>\n\n<p>'Below section will filter the row 6 on GeneralInfo tab and copy only those marked Change or New from input build ID </p>\n\n<p>Rows(\"6:6\").Select Selection.AutoFilter\nMsgBox colnm \ncColNm = colnm &amp; 6 \nMsgBox cColNm </p>\n\n<p>i have given the (0) which means the first element of that array </p>\n\n<p>colnm = Split(Cells(, ColNo).Address(True, False), \"$\")(0) </p>\n\n<p>My bad i did not know split is an array. thank you very much for the help.</p>\n"}], "owner": {"reputation": 45, "user_id": 2930371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63fe7f4c8abcd1ecad8b71185a584b60?s=128&d=identicon&r=PG&f=1", "display_name": "CodeKavi", "link": "https://stackoverflow.com/users/2930371/codekavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 28570964, "answer_count": 1, "score": 0, "last_activity_date": 1424206680, "creation_date": 1424203599, "last_edit_date": 1531161705, "question_id": 28570180, "link": "https://stackoverflow.com/questions/28570180/excel-macro-to-include-parameter-in-range", "title": "Excel macro to include parameter in Range", "body": "<p>i am trying to write an excel macro, here is brief on what it does\n1) open an excel file using input parameters, located on shared site.\n2) filter based on input parms.\n3) copies the filtered values to a new spreadsheet and sort them.</p>\n\n<p>I see issue while writing selecting the range.</p>\n\n<p>BuildID is input parameter</p>\n\n<p>'converts column number to column name</p>\n\n<pre><code>ColNo = BuildID + 2\ncolnm = Split(Cells(, ColNo).Address(True, False), \"$\")\n</code></pre>\n\n<p>'Below section will filter the row 6 on Info tab and copy only those marked Change or New from input build ID</p>\n\n<pre><code>Rows(\"6:6\").Select\nSelection.AutoFilter\nMsgBox (colnm)\ncColNm = \"colnm\" &amp; 6\nMsgBox (cColNm)\nRange(\"cColNm\").Select\nActiveSheet.Range(\"$A$6:$IR$46\").AutoFilter Field:=\"ColNo\", Criteria1:=\"&lt;&gt;\"\nRange(\"A7:B45\").Select\nSelection.Copy\n</code></pre>\n\n<p>I am getting a type mismatch error at first msgbox.\n(the colnm is working fine with the debug.print function which will print in immediate window but not store anywhere)\na similar msgbox worked in my earlier programs</p>\n\n<p>can someone help me pointing what is wrong in this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424201253, "post_id": 28569476, "comment_id": 45448937, "body": "The brute force method would be to identify some unique (or hierarchical) property of each distinct format and write a sub routine for each."}], "answers": [{"tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 0, "last_activity_date": 1424207782, "creation_date": 1424207782, "answer_id": 28571256, "question_id": 28569476, "link": "https://stackoverflow.com/questions/28569476/excel-vba-importing-data-from-word-documents-with-inconsistent-formattting/28571256#28571256", "title": "Excel VBA Importing data from Word Documents with inconsistent formattting", "body": "<p>I would start first with identifying the different unique formats available. Hopefully you only have a couple of formats. And use a RegEx within VBA. You should be able to write a pattern that will match all the different format variations</p>\n"}], "owner": {"reputation": 55, "user_id": 3937688, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8815f46d6c659bbeacca98349256a0ad?s=128&d=identicon&r=PG&f=1", "display_name": "leinadw2", "link": "https://stackoverflow.com/users/3937688/leinadw2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 28571256, "answer_count": 1, "score": 0, "last_activity_date": 1424207782, "creation_date": 1424201018, "question_id": 28569476, "link": "https://stackoverflow.com/questions/28569476/excel-vba-importing-data-from-word-documents-with-inconsistent-formattting", "title": "Excel VBA Importing data from Word Documents with inconsistent formattting", "body": "<p>I am trying to obtain values and tolerances from a bunch of specification sheets (word documents). The specification sheets are all very similar but the formatting within their tables is inconsistent.</p>\n\n<p>For instance, sometimes the values and tolerances for power will be listed in a certain format which Excel will import as:             +2%      339         kW [3] 4       -2%</p>\n\n<p>Other times, the values and tolerances for power will be listed in a different format which Excel will import as: 247\u00b12% kW [3]5</p>\n\n<p>Besides editing all of the documents to make the formatting consistent, is there any way that I can use VBA to extract the values and tolerances from a variety of different formats?</p>\n"}, {"tags": ["vba", "outlook", "rules", "outlook-2010"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "edited": false, "score": 0, "creation_date": 1424210677, "post_id": 28569894, "comment_id": 45453731, "body": "Could you please show the correct code? I simply cannot get this routine to cooperate. I would be in your debt."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1424202484, "creation_date": 1424202484, "answer_id": 28569894, "question_id": 28569187, "link": "https://stackoverflow.com/questions/28569187/outlook-2010-rule-running-a-vba-script-gives-script-doesnt-exist-or-is-in/28569894#28569894", "title": "Outlook 2010 - rule running a VBA script gives &quot;Script &quot;&quot; doesn&#39;t exist or is invalid&quot; error", "body": "<p>There is no need to get the item by using the EntryID values:</p>\n\n<pre><code> varEntryIDs = Split(EntryIDCollection, \",\")\n For i = 0 To UBound(varEntryIDs)\n     Set objItem = Application.Session.GetItemFromID(varEntryIDs(i))\n</code></pre>\n\n<p>You need to use the item passed as a parameter. The EntryID values are not passed any longer to the VBA sub.</p>\n"}], "owner": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593248584, "creation_date": 1424199999, "last_edit_date": 1593248584, "question_id": 28569187, "link": "https://stackoverflow.com/questions/28569187/outlook-2010-rule-running-a-vba-script-gives-script-doesnt-exist-or-is-in", "title": "Outlook 2010 - rule running a VBA script gives &quot;Script &quot;&quot; doesn&#39;t exist or is invalid&quot; error", "body": "<p>Windows 7, Outlook 2010 Exchange account. Intermediate Excel VBA programmer, newbie Outlook VBA coder.</p>\n\n<p>I need to ensure that all incoming emails are bcc'd to a gmail account. I modified an online macro to suit. It works flawlessly on all incoming emails, EXCEPT for those downloaded at first boot and Outlook startup. It resided in ThisOutlookSession.</p>\n\n<pre><code> Private Sub Application_NewMailEx(ByVal EntryIDCollection As String)\n     Dim varEntryIDs\n     Dim objItem\n     Dim myItem As MailItem\n     Dim i As Integer\n     varEntryIDs = Split(EntryIDCollection, \",\")\n     For i = 0 To UBound(varEntryIDs)\n         Set objItem = Application.Session.GetItemFromID(varEntryIDs(i))\n\n         If TypeOf objItem Is MailItem Then                     \n\n             Set myItem = objItem.Forward\n             myItem.Recipients.Add \"bcc.hwb@gmail.com\"\n\n             myItem.DeleteAfterSubmit = True                    \n             myItem.Send\n             Set myItem = Nothing\n         Else\n             Debug.Print \"Skipping \" &amp; TypeName(objItem)\n             Set myItem = Nothing\n         End If\n     Next\n End Sub\n</code></pre>\n\n<p>A question to the forum kindly educated me that the queued messages upon Outlook startup and folder update do not fire the NewMail and NewMailEx event routines. They recommended setting up a rule that runs a script for all incoming mail.</p>\n\n<p>I attempted to call the routine and the script was not \"visible.\" I searched a while and found that only scripts operating as MailItems are recognized, and they had to be in a module. I modified the script to pass this test and it was now visible.</p>\n\n<pre><code> Sub IncomingBCC(myItem As MailItem)\n\n     Dim EntryIDCollection As String\n     Dim varEntryIDs\n     Dim objItem\n   ' Dim myItem As MailItem\n     Dim i As Integer\n     varEntryIDs = Split(EntryIDCollection, \",\")\n     For i = 0 To UBound(varEntryIDs)\n         Set objItem = Application.Session.GetItemFromID(varEntryIDs(i))\n\n         If TypeOf objItem Is MailItem Then                     \n\n             Set myItem = objItem.Forward\n             myItem.Recipients.Add \"bcc.hwb@gmail.com\"\n\n             myItem.DeleteAfterSubmit = True                    \n             myItem.Send\n             Set myItem = Nothing\n         Else\n             Debug.Print \"Skipping \" &amp; TypeName(objItem)\n             Set myItem = Nothing\n         End If\n     Next\n\n End Sub\n</code></pre>\n\n<p>Now, Outlook rules \"see\" the script, and allow the rule to be created. When run, it generates an error as follows:\n\"The script \"\" doesn't exist or is invalid.\" \nI could find no pertinent online help on this error even after extensive searching.</p>\n\n<p>I would appreciate some guidance as how to proceed.\nThank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4576686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a14b0cdfa36759f145b6fa3fae95891?s=128&d=identicon&r=PG&f=1", "display_name": "Caminator", "link": "https://stackoverflow.com/users/4576686/caminator"}, "edited": false, "score": 0, "creation_date": 1424201781, "post_id": 28568807, "comment_id": 45449224, "body": "I get a compile error with this: Method or Data member not found"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1, "user_id": 4576686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a14b0cdfa36759f145b6fa3fae95891?s=128&d=identicon&r=PG&f=1", "display_name": "Caminator", "link": "https://stackoverflow.com/users/4576686/caminator"}, "edited": false, "score": 1, "creation_date": 1424207964, "post_id": 28568807, "comment_id": 45452455, "body": "@Caminator there was a typo/error in last line which would raise that error. Try the revised answer."}], "tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": false, "score": 2, "last_activity_date": 1424207821, "last_edit_date": 1424207821, "creation_date": 1424198629, "answer_id": 28568807, "question_id": 28568729, "link": "https://stackoverflow.com/questions/28568729/trouble-pasting-only-values-in-vba/28568807#28568807", "title": "Trouble pasting only values in VBA", "body": "<pre><code>Sub doIt()\n  Dim tCell As Range, sh As Worksheet\n  Sheets(\"Bundler\").Range(\"G20\").Copy\n  Set sh = Sheets(Range(\"G73\").Value)\n  Set tCell = freeCell(sh.Range(\"A3\"))\n  If tCell.Row &lt; 19 Then Set tCell = tCell.Offset(19 - tCell.Row)\n  tCell.PasteSpecial Paste:=xlPasteValues\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1424208204, "creation_date": 1424208204, "answer_id": 28571355, "question_id": 28568729, "link": "https://stackoverflow.com/questions/28568729/trouble-pasting-only-values-in-vba/28571355#28571355", "title": "Trouble pasting only values in VBA", "body": "<p>You can do this without a copy and paste:</p>\n\n<pre><code>Sub doIt()\n  Dim tCell As Range, sh As Worksheet\n  Set sh = Sheets(Range(\"G73\").Value)\n  Set tCell = freeCell(sh.Range(\"A3\"))\n  If tCell.Row &lt; 19 Then Set tCell = tCell.Offset(19 - tCell.Row)\n  tCell.Formula = Sheets(\"Bundler\").Range(\"G20\").Text\nEnd Sub\n</code></pre>\n\n<p>Change .text to .value if you want it as a value</p>\n"}], "owner": {"reputation": 1, "user_id": 4576686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a14b0cdfa36759f145b6fa3fae95891?s=128&d=identicon&r=PG&f=1", "display_name": "Caminator", "link": "https://stackoverflow.com/users/4576686/caminator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1424208204, "creation_date": 1424198380, "last_edit_date": 1424207853, "question_id": 28568729, "link": "https://stackoverflow.com/questions/28568729/trouble-pasting-only-values-in-vba", "title": "Trouble pasting only values in VBA", "body": "<p>I'm trying to paste only the values to the target cell instead of the formulas and haven't had any success after much googling.  This is my first real venture into VBA so I'm unsure of where to go next.  My current code is:</p>\n\n<pre><code>Function freeCell(r As Range) As Range\n' returns first free cell below r\n  Dim lc As Range, Tracking As Worksheet     ' last used cell on sheet\n  Set lc = r.Offset(40, 6).End(xlUp).Offset(1, 0)\n  Set freeCell = lc\nEnd Function\n\n\nSub doIt()\n  Dim tCell As Range, sh As Worksheet\n  Sheets(\"Bundler\").Range(\"G20\").Copy\n  Set sh = Sheets(Range(\"G73\").Value)\n  Set tCell = freeCell(sh.Range(\"A3\"))\n  If tCell.Row &lt; 19 Then Set tCell = tCell.Offset(19 - tCell.Row)\n  sh.Paste tCell\nEnd Sub\n</code></pre>\n\n<p>sh.Paste tCell pastes into the correct cell, but how can I convert that to only values?  I'm aware .PasteSpecial xlPasteValues needs to be used but I'm not sure how to format it.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424199667, "post_id": 28568550, "comment_id": 45448100, "body": "<code>Rows.Count</code> will return either 1,048,576 or 65,536 depending on the compatibility level of the worksheet it refers to. It shouldn&#39;t be too difficult to check if any cell in the bottom row (e.g. <code>IsEmpty(.Cells(Rows.Count, 1))</code>) is populated."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1424199868, "post_id": 28568550, "comment_id": 45448202, "body": "It might also be helpful to build in a counter variable into the output file/code. This way, you can preemptively add worksheets/switch to a worksheet once the limit has been reached."}], "answers": [{"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1550576222, "post_id": 28569184, "comment_id": 96310865, "body": "perfect way to do it"}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 1, "last_activity_date": 1424199976, "creation_date": 1424199976, "answer_id": 28569184, "question_id": 28568550, "link": "https://stackoverflow.com/questions/28568550/excel-2013-maximum-number-of-rows/28569184#28569184", "title": "Excel 2013 Maximum Number of Rows", "body": "<p>It's quite simple:</p>\n\n<pre><code>bEndOfSheet = (counter = Sheet1.Rows.Count)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28, "user_id": 4564510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a3b7fa3edb0fbc3522215132c7cd64a?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/4564510/fred"}, "is_accepted": true, "score": 0, "last_activity_date": 1424200999, "creation_date": 1424200999, "answer_id": 28569474, "question_id": 28568550, "link": "https://stackoverflow.com/questions/28568550/excel-2013-maximum-number-of-rows/28569474#28569474", "title": "Excel 2013 Maximum Number of Rows", "body": "<p>An approach you could combine with the suggestions is to use</p>\n\n<pre><code>ActiveWorkbook.Excel8CompatibilityMode\n</code></pre>\n\n<p>If this returns true, the active workbook is running on Excel 2003 or prior compatibility mode and limited to 65,536 rows. If false you have 1,048,576 rows available. Example air code:</p>\n\n<pre><code>If ActiveWorkbook.Excel8CompatibilityMode = False Then maxrows = 1048576 Else maxrows = 65536\n</code></pre>\n\n<p>Then check your output row against maxrows when writing to the sheet.</p>\n"}], "owner": {"reputation": 3, "user_id": 4548323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d297812ef9b676f5d46c54e46e39530?s=128&d=identicon&r=PG&f=1", "display_name": "chung.K", "link": "https://stackoverflow.com/users/4548323/chung-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3381, "favorite_count": 0, "accepted_answer_id": 28569474, "answer_count": 2, "score": 0, "last_activity_date": 1424200999, "creation_date": 1424197766, "last_edit_date": 1531164843, "question_id": 28568550, "link": "https://stackoverflow.com/questions/28568550/excel-2013-maximum-number-of-rows", "title": "Excel 2013 Maximum Number of Rows", "body": "<p>I understand that Excel 2013 has a limit of 1,048,576 rows (according to Microsoft). Is there a command that returns a Boolean value if the maximum number of rows has been reached? I am making a code that outputs data one row at a time to a worksheet and it may very well exceed the max row limit.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1424197522, "post_id": 28568048, "comment_id": 45446939, "body": "Because you&#39;re not checking to see whether or not you <i>should</i> open the file?"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "edited": false, "score": 0, "creation_date": 1424201521, "post_id": 28568471, "comment_id": 45449091, "body": "That was one of my attempts. But it just caused the code to not open a file either way.  Used  MyFile = &quot;&quot;  instead   Still failed to function."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1424197516, "creation_date": 1424197516, "answer_id": 28568471, "question_id": 28568048, "link": "https://stackoverflow.com/questions/28568048/excel-vba-continues-to-open-file-even-after-cancel/28568471#28568471", "title": "Excel VBA continues to &#39;Open File&#39; even after Cancel", "body": "<p>That would be a dirty hack, but if you had an <code>Else</code> branch here:</p>\n\n<pre><code>If .Show = 1 Then\n    MyFile = .SelectedItems(1)\nElse\n    MyFile = vbNullString\nEnd If\n</code></pre>\n\n<p>...the code that actually opens the file could verify whether <code>MyFile</code> is empty or not before trying:</p>\n\n<pre><code>On Error Resume Next\nIf MyFile &lt;&gt; vbNullString Then Set WB = Workbooks.Open(MyFile)\n</code></pre>\n\n<hr>\n\n<p>That said I think you should be handling <em>at least</em> error 53 (\"file not found\") here, instead of just shoving all errors under the carpet.</p>\n\n<p>Also the <code>WB</code> reference isn't used. Perhaps the <code>Sub</code> should be a <code>Function</code> that returns the opened workbook, or <code>Nothing</code> if opening fails?</p>\n"}, {"tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": false, "score": 1, "last_activity_date": 1424198415, "last_edit_date": 1424198415, "creation_date": 1424198090, "answer_id": 28568643, "question_id": 28568048, "link": "https://stackoverflow.com/questions/28568048/excel-vba-continues-to-open-file-even-after-cancel/28568643#28568643", "title": "Excel VBA continues to &#39;Open File&#39; even after Cancel", "body": "<p>This is what I use to select a directory. If the function returns an empty string, I don't try to open the file.</p>\n\n<pre><code>Private Function FolderPicker() As String\n'*******************************************\n' returns directory path to be printed to\n'   does not allow multiple selections,\n'   so returning the first item in selected\n'   items is sufficient.\n'\n' returns empty string On Error or if the\n'   user cancels\n'********************************************\nOn Error GoTo ErrHandler\n\nConst DefaultDirectory As String = \"C:Path\\to\\default\\directory\\\"\n\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .AllowMultiSelect = False\n        .Title = \"Choose Directory to Print to\"\n        .InitialFileName = DefaultDirectory\n        .InitialView = msoFileDialogViewSmallIcons\n\n        If .Show &lt;&gt; -1 Then\n            FolderPicker = vbNullString\n        Else\n            FolderPicker = .SelectedItems(1)\n        End If\n    End With\n\nExit Function\n\nErrExit:\n    FolderPicker = vbNullString\n    Exit Function\nErrHandler:\n    MsgBox \"Unexpected Error: \" &amp; Err.number &amp; vbCrLf &amp; \"Source: \" &amp; Err.Source &amp; _\n        \"Description: \" &amp; Err.Description, vbCritical, \"ERROR!\"\n    Resume ErrExit\nEnd Function\n</code></pre>\n\n<p>So, you would call it like this.</p>\n\n<pre><code>MyFile = FolderPicker\nIf MyFile &lt;&gt; vbNullString Then\n    Set WB = Workbooks.Open(MyFile)\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "is_accepted": true, "score": 0, "last_activity_date": 1424446196, "creation_date": 1424446196, "answer_id": 28632554, "question_id": 28568048, "link": "https://stackoverflow.com/questions/28568048/excel-vba-continues-to-open-file-even-after-cancel/28632554#28632554", "title": "Excel VBA continues to &#39;Open File&#39; even after Cancel", "body": "<p>Much blood, sweat and tears later (Serious web surfing, cobbling code together and retesting) I have found an answer that works without any problems for pressing 'Cancel' at any point.</p>\n\n<pre><code> Sub OpenAuditPartialName()\n\n '  Returns popup window with only filtered\n '  filenames matching input criteria.\n '  Filenames are saved from another code that uses 3 variables to generate a _\n '  filename 'Filename part1_Filename part2_Filename part3 Forms.xls'\n\n Dim WB As Workbook\n Dim Ans As String\n Dim MyFile As String\n Dim path As String\n\n '  Folder path for Forms\n path = (\"S:\\Forms Folder\\\")\n     Ans = InputBox(\"Enter any part of the filename to search by.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n     \"Full or Partial information is OK.\" &amp; vbCrLf &amp; vbCrLf &amp; \"Filename part1\" _\n     &amp; vbCrLf &amp; \"Filename part2\" &amp; vbCrLf &amp; \"Filename part3\", \"Enter Partial Filename Filter\")\n\n    '  Exits on 'Cancel' as it should\n    If Ans = \"\" Then\n       Exit Sub\n    End If\n\n    MyFile = Dir(path &amp; \"*\" &amp; Ans &amp; \"*.xls\")\n     MyFilter = path &amp; \"*\" &amp; Ans &amp; \"*.xls\"\n\n '*******************************************\n     With Application.FileDialog(msoFileDialogOpen)\n         .AllowMultiSelect = False\n         .InitialFileName = MyFilter\n\n   '  Now accepts the 'Cancel' instead of continuing to open the first file\n   '  in the filtered list when pressed\n   If .Show = 0 Then\n   ElseIf Len(Ans) Then\n        MyFile = .SelectedItems(1)\n        On Error Resume Next\n        Set WB = Workbooks.Open(MyFile)\n   Else\n       Exit Sub\n   End If\n '*******************************************\n     End With\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1598, "favorite_count": 0, "accepted_answer_id": 28632554, "answer_count": 3, "score": 2, "last_activity_date": 1424446196, "creation_date": 1424196225, "question_id": 28568048, "link": "https://stackoverflow.com/questions/28568048/excel-vba-continues-to-open-file-even-after-cancel", "title": "Excel VBA continues to &#39;Open File&#39; even after Cancel", "body": "<p>Okay here it is. I've done a bunch of coding in the last 3 or 4 months, learned a lot, BUT, I can't figure out why this code STILL opens a file when I hit cancel at the end once the popup window comes up showing my filtered  filenames.  Any advice would be highly appreciated.</p>\n\n<pre><code> Sub OpenByPartialName()\n\n '  Returns popup window with only filtered filenames matching\n '  Partial Filename input\n\n Dim WB As Workbook\n Dim Ans As String\n Dim MyFile As String\n Dim path As String\n\n '  Folder Path Name for Forms\n path = (\"S:\\Forms Folder\\\")\n\n     Ans = InputBox(\"Enter Partial filename Filter\", \"Open File With Partial Name Filter\")\n\n    MyFile = Dir(\"S:\\Forms Folder\\\" &amp; \"*\" &amp; Ans &amp; \"*.xls\")\n\n     MyFilter = path &amp; \"*\" &amp; Ans &amp; \"*.xls\"\n\n     With Application.FileDialog(msoFileDialogOpen)\n         .AllowMultiSelect = False\n         .InitialFileName = MyFilter\n\n         If .Show = 1 Then\n            MyFile = .SelectedItems(1)\n         End If\n     End With\n\n     On Error Resume Next\n     Set WB = Workbooks.Open(MyFile)\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "excel", "filtering"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1424206684, "last_edit_date": 1424206684, "creation_date": 1424198247, "answer_id": 28568692, "question_id": 28567971, "link": "https://stackoverflow.com/questions/28567971/in-randomly-organized-data-set-find-corresponding-value-in-other-spreadsheet-an/28568692#28568692", "title": "In randomly organized data set, find corresponding value in other spreadsheet and change colors", "body": "<p>MATCH() is usually better than nested loops:</p>\n\n<pre><code>Sub FindMatches()\n    Dim Nova As Workbook\n    Dim D0 As Worksheet\n    Dim D1 As Worksheet\n    Dim c As Range\n    Dim rngVals As Range, rngSrch As Range\n\n    Set Nova = ThisWorkbook 'Workbooks(\"Nova\")\n    Set D0 = Nova.Sheets(\"D0\")\n    Set D1 = Nova.Sheets(\"D-1\")\n\n    Set rngVals = D0.Range(D0.Range(\"A2\"), D0.Cells(Rows.Count, 1).End(xlUp))\n    Set rngSrch = D1.Range(D1.Range(\"A2\"), D1.Cells(Rows.Count, 1).End(xlUp))\n\n    Application.ScreenUpdating = False\n\n    For Each c In rngVals\n        'EDIT: hiliting matches, not non-matches\n        If Not IsError(Application.Match(c.Value, rngSrch, 0)) Then\n            c.Interior.Color = RGB(100, 0, 0)\n        End If\n\n    Next c\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 28568692, "answer_count": 1, "score": 0, "last_activity_date": 1424226900, "creation_date": 1424195902, "last_edit_date": 1531164843, "question_id": 28567971, "link": "https://stackoverflow.com/questions/28567971/in-randomly-organized-data-set-find-corresponding-value-in-other-spreadsheet-an", "title": "In randomly organized data set, find corresponding value in other spreadsheet and change colors", "body": "<p>I have two sheets. Both of them have over 11,000 rows of mutually exclusive data - with the exception of a few. I need to find what values within D1 are held within D0. I have the following Macro written for it. It keeps freezing and going very slow, so to be completely honest, I don't even know if it is working. Since they only have a tiny bit of data similar, and they're going to constantly change, I assume I can't organize it and filter it that way. Also, I need to avoid using vlookup. Thanks for any help!</p>\n\n<pre><code>Sub FindMatches()\nDim Nova As Workbook\nDim D0 As Worksheet\nDim D1 As Worksheet\nDim LastRow0 As Long\nDim LastRow1 As Long\n\nSet Nova = Workbooks(\"Nova\")\nSet D0 = Nova.Sheets(\"D0\")\nSet D1 = Nova.Sheets(\"D-1\")\n\nLastRow0 = D0.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRow1 = D1.Cells(Rows.Count, \"A\").End(xlUp).Row\nApplication.ScreenUpdating = False\n\nFor i = 2 To LastRow0\n    For Z = 2 To LastRow1\n        If D0.Range(\"A\" &amp; i) = D1.Range(\"A\" &amp; Z) Then\n        D0.Range(\"A\" &amp; i).Interior.Color = RGB(100, 0, 0)\n        Else: End If\n    Next Z\nNext i\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1424194021, "post_id": 28567341, "comment_id": 45444892, "body": "You haven&#39;t stated which property you want to access. Try actually using <code>.Name</code> on the end."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424194199, "post_id": 28567341, "comment_id": 45445012, "body": "<i>I think I&#39;m duplicating the msgbox command</i>  No, you&#39;re not :)"}, {"owner": {"reputation": 11, "user_id": 4375893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c3deec4754c6091e0c0c2babbfa11e?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/4375893/martin"}, "edited": false, "score": 0, "creation_date": 1424205798, "post_id": 28567341, "comment_id": 45451333, "body": "Ah. I was blinkered on the public vs Dim and missed the obvious error.  Thanks for the prompt replies."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1424195337, "creation_date": 1424195337, "answer_id": 28567774, "question_id": 28567341, "link": "https://stackoverflow.com/questions/28567341/excel-vba-why-do-i-get-run-time-error-438-using-public-variables-of-workbook-and/28567774#28567774", "title": "Excel/VBA Why do I get run time error 438 using public variables of workbook and worksheet", "body": "<pre><code>Sub Main()\nCall OpenCSV\nMsgBox \"Active WB is \" &amp; bankWB.Name\nMsgBox \" Active WS is \" &amp; bankWS.Name\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4375893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c3deec4754c6091e0c0c2babbfa11e?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/4375893/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1025, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424195337, "creation_date": 1424193907, "question_id": 28567341, "link": "https://stackoverflow.com/questions/28567341/excel-vba-why-do-i-get-run-time-error-438-using-public-variables-of-workbook-and", "title": "Excel/VBA Why do I get run time error 438 using public variables of workbook and worksheet", "body": "<p>I'm trying to learn some VBA and in my current project I wanted to learn about using different sub routines so I created a sub to open a CSV file. I wanted to be able to reference the workbook/worksheet in other sub routines so I defined the variables as public. This works fine on it's own and the message box shows the expected values for bankWS and bankWS</p>\n\n<pre><code>Public bankWB As Workbook \nPublic bankWS As Worksheet \n\nSub OpenCSV()\nfilepath = \"C:\\\" \ncsvfile = \"file.csv\" \nWorkbooks.Open Filename:=filepath &amp; csvfile \nSet bankWB = ActiveWorkbook \nSet bankWS = ActiveSheet \nMsgBox \"Active WB is \" &amp; bankWB.Name &amp; \" Active WS is \" &amp; bankWS.Name \nEnd Sub\n</code></pre>\n\n<p>But when I try to reference these variables from a different sub I get run time error 438 Object doesn't support this property or Method.</p>\n\n<pre><code>Sub Main()\nCall OpenCSV\nMsgBox \"Active WB is \" &amp; bankWB\nMsgBox \" Active WS is \" &amp; bankWS\nEnd Sub\n</code></pre>\n\n<p>I thought the whole point of defining the variable globally was that I would be able to use it outside of the subroutine.</p>\n\n<p>Reading around this error I see that often it occurs when the code is trying to use a particular object (eg worksheet.something) but I think I'm duplicating the msgbox command that worked fine within the sub.  I'm stuck now and can't find out what have I done wrong. I would like to understand, why this error occurs? </p>\n\n<p>Regards</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1424194012, "post_id": 28566918, "comment_id": 45444885, "body": "You need to use <b>Set</b>"}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1424203497, "creation_date": 1424203497, "answer_id": 28570154, "question_id": 28566918, "link": "https://stackoverflow.com/questions/28566918/subtract-two-ranges-to-add-formula-in-a-part-of-a-column-table/28570154#28570154", "title": "Subtract two ranges to add formula in a part of a column table", "body": "<p>As Gary's says, you need to set the range,\nFor example:</p>\n\n<pre><code> Dim rng1 As Range, rng2 As Range, rng3 As Range\n    set rng1 = Sheets(\"MySheet\").ListObjects(\"MyTable\").ListColumns(\"Column2\").DataBodyRange\n   set rng2 = Sheets(\"MySheet\").ListObjects(\"MyTable\").ListColumns(\"Column2\").DataBodyRange.Cells(1)\n    'rng3 = rng1 - rng2 'you have not indicate what rng3 range is\n    rng3.Formula = \"=SUM(D179;G179)\"'still no indication what rng3 is\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 4457272, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2b8207de8c61e586201e4e935b35ab59?s=128&d=identicon&r=PG&f=1", "display_name": "baboufight", "link": "https://stackoverflow.com/users/4457272/baboufight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424203497, "creation_date": 1424192643, "last_edit_date": 1531164843, "question_id": 28566918, "link": "https://stackoverflow.com/questions/28566918/subtract-two-ranges-to-add-formula-in-a-part-of-a-column-table", "title": "Subtract two ranges to add formula in a part of a column table", "body": "<p>I want to add formula into one table column, except the first row of this same column (whose value need to be fixed).\nSo I've try to subtract the column data range from his first cell :</p>\n\n<pre><code>Dim rng1 As Range, rng2 As Range, rng3 As Range\nrng1 = Sheets(\"MySheet\").ListObjects(\"MyTable\").ListColumns(\"Column2\").DataBodyRange\nrng2 = Sheets(\"MySheet\").ListObjects(\"MyTable\").ListColumns(\"Column2\").DataBodyRange.Cells(1)\nrng3 = rng1 - rng2\nrng3.Formula = \"=SUM(D179;G179)\"\n</code></pre>\n\n<p>But this return me an execution error '91'</p>\n"}, {"tags": ["vba", "excel", "data-structures"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1424192950, "post_id": 28566917, "comment_id": 45444168, "body": "Have you ever used a <code>Scripting.Dictionary</code>?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4576226"}, "edited": false, "score": 0, "creation_date": 1424193987, "post_id": 28567115, "comment_id": 45444868, "body": "Can I create a separate procedure that adds these names to the dictionary, then reference this dictionary in sequential procedures? (like maybe make a <code>Sub Create_Table()</code> that pulls from the dictionary to rename headers)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1424194013, "post_id": 28567115, "comment_id": 45444886, "body": "Absolutely - and you <i>should</i>! ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4576226"}, "edited": false, "score": 0, "creation_date": 1424194312, "post_id": 28567115, "comment_id": 45445097, "body": "Awesome! Trying it now"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 3, "creation_date": 1424194473, "post_id": 28567115, "comment_id": 45445211, "body": "You might want to note that a Reference to the Scripting Runtime library is required, or switch your example to late binding."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4576226"}, "edited": false, "score": 0, "creation_date": 1424200398, "post_id": 28567115, "comment_id": 45448493, "body": "<code>Application.VBE.ActiveVBProject.References.AddFromFile (&quot;C:\\Windows\\System32\\scrrun.dll&quot;)</code> is giving the error <code>Name conflicts with existing module, project, or object library</code> which is odd because nothing I wrote has any names conflicting with this code..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1424200541, "post_id": 28567115, "comment_id": 45448563, "body": "Try late binding then - <code>Set ColumnMap = CreateObject(&quot;Scripting.Dictionary&quot;)</code>... but you won&#39;t get intellisense then (<code>ColumnMap</code> would be of type <code>Object</code>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4576226"}, "edited": false, "score": 0, "creation_date": 1424203838, "post_id": 28567115, "comment_id": 45450282, "body": "I can&#39;t make global objects though, right? For instance, run a Sub to build the object, then run a separate Sub that references the Object and its contents? I ultimately want to separate my reference values from my actions so I don&#39;t have to go scavenging for every instance of the value in my code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1424204215, "post_id": 28567115, "comment_id": 45450503, "body": "Why couldn&#39;t you? I wouldn&#39;t say it&#39;s the best thing to do, but if you need a &quot;singleton&quot; or &quot;global static&quot; instance, nothing prevents you from declaring it <code>Public</code> in a standard code module - everything in your project will be able to access it."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1424193710, "last_edit_date": 1424193710, "creation_date": 1424193227, "answer_id": 28567115, "question_id": 28566917, "link": "https://stackoverflow.com/questions/28566917/vba-excel-ways-to-store-lists-in-vba/28567115#28567115", "title": "VBA Excel - ways to store lists in VBA?", "body": "<p>No matter what you do, you're going to need to have the mappping code <em>somewhere</em>.</p>\n\n<p>If a huge <code>If-Then-Else</code> block isn't very appealing, you can consider using a <code>Dictionary</code> object, from the <code>Scripting</code> library - using the \"before\" column name as your dictionary key, and the \"after\" column name as your dictionary value, the mapping code could look something like this:</p>\n\n<pre><code>Dim ColumnMap As New Scripting.Dictionary\nWith ColumnMap\n    .Add \"Employee\", \"Name\"\n    .Add \"Employer Name\", \"Company\"\n    '...\nEnd With\n</code></pre>\n\n<p>Then when you iterate the cells in the header row, you can verify that the name/key exists in your dictionary, and then proceed with the rename by fetching the mapped value. Just don't <em>assume</em> the column name exists in the dictionary, or you'll <em>eventually</em> run into \"Key does not exist\" runtime errors.</p>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 2, "last_activity_date": 1424194039, "creation_date": 1424194039, "answer_id": 28567382, "question_id": 28566917, "link": "https://stackoverflow.com/questions/28566917/vba-excel-ways-to-store-lists-in-vba/28567382#28567382", "title": "VBA Excel - ways to store lists in VBA?", "body": "<p>An alternative to dictionaries (although that might be be my preferred method, I would initialize them in a separate procedure) would be to split strings:</p>\n\n<pre><code>Sub DoStuff()\nConst RawList As String = \"Employee,Employer Name\"\nConst UpdateList as String = \"Name,Employer\"\nDim rawHeaders as Variant\nDim headers as Variant\n\nrawHeaders = Split(RawList, \",\")\nheaders = Split(UpdateList, \",\")\n\n    For Each cl In Range(\"Table1[#Headers]\")\n        If Not IsError(Application.Match(cl.Value, rawHeaders, False)) Then\n            cl.Value = headers(Application.Match(cl.Value, rawHeaders, False))\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>You can scope the arrays at the module level instead so they will be available for other procedure calls, etc.</p>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424221798, "post_id": 28572742, "comment_id": 45457877, "body": "+1 for another approach! This works for sure but some people don&#39;t prefer to use the <code>On Error Resume Next</code> even in trivial instances like this."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424241853, "post_id": 28572742, "comment_id": 45463783, "body": "@DavidZ thaks! And yes it is a little bit un-orthodox. So if one does not fear for <code>Resume Next</code> then this could be an easy lightweight alternative to <code>Scripting Dictionary</code>."}], "tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 2, "last_activity_date": 1424213667, "creation_date": 1424213667, "answer_id": 28572742, "question_id": 28566917, "link": "https://stackoverflow.com/questions/28566917/vba-excel-ways-to-store-lists-in-vba/28572742#28572742", "title": "VBA Excel - ways to store lists in VBA?", "body": "<p>Why not use the simple VBA Collection? No extra reference needed, no late binding needed, it is build directly into VBA.</p>\n\n<p><em>Note: if the item is not found in the map, then the original raw header value is not replaced but it is simply skipped.</em></p>\n\n<pre><code>Option Explicit\n\nPublic Sub Main()\n    Dim header As Range\n\n    Set header = Worksheets(\"RawData\").ListObjects(\"Table1\").HeaderRowRange\n\n    ReplaceInheaderRow headerRow:=header\n\n    ' header contains transformed values now\nEnd Sub\n\nPrivate Function ReplaceInheaderRow(ByVal headerRow As Range) As Range\n    Dim map As Collection\n    Set map = New Collection\n\n    map.Add \"Name\", \"Employee\"\n    map.Add \"Company\", \"Employer Name\"\n    map.Add \"ID\", \"ID Numbers\"\n    map.Add \"Income\", \"Wages\"\n    map.Add \"etc.\", \"Some next column name\"\n\n    On Error Resume Next\n\n    Dim rowHeaderCell As Range\n\n    For Each rowHeaderCell In headerRow\n        rowHeaderCell.Value = map(rowHeaderCell.Value)\n    Next rowHeaderCell\n\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4576226"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4526, "favorite_count": 1, "accepted_answer_id": 28567115, "answer_count": 3, "score": 3, "last_activity_date": 1424213667, "creation_date": 1424192640, "last_edit_date": 1424211732, "question_id": 28566917, "link": "https://stackoverflow.com/questions/28566917/vba-excel-ways-to-store-lists-in-vba", "title": "VBA Excel - ways to store lists in VBA?", "body": "<p>I didn't know where else to turn, and I tried finding a question like mine but with no luck. I have a raw ranged table and I want to copy the info over into a new sheet, then convert that copied info into a ListObject table. I've worked out 99% of it, but then I wanted to change the raw headers of the copied table into my own headers (because most of the raw headers are very lengthy).</p>\n\n<p>I built a loop to look at the [#Headers] cells, find values that matched a certain raw value, then replace it with my own value. E.g.</p>\n\n<pre><code>For Each cl In Range(\"Table1[#Headers]\")\n        If cl.Value = \"Employee\" Then\n            cl.Value = \"Name\"\n        ElseIf cl = \"Employer Name\" Then\n            cl.Value = \"Company\"\n'...\n        End If\nNext cl\n</code></pre>\n\n<p>Having a block of code that does this for 30+ instances is cumbersome, and if the raw information I receive somehow changes it's header values, I then have to hunt for this bit of code again and make the changes. I'm hoping there's a way to store a 2-columned list of before-and-after header names that any Sub can just reference, like a global Array (except global arrays are impossible). I looked into classes but again there are issues I'm having with globalizing the info.</p>\n\n<p>I'm thinking about making a hidden worksheet with a 2-columned list but I'm really hoping that's not necessary, don't want any more sheets than I have to have. Is there a way to store lists for global use in Excel VBA?</p>\n\n<p><a href=\"http://i.stack.imgur.com/Usd9v.jpg\" rel=\"nofollow\">Example image</a></p>\n\n<p>SOLUTION:</p>\n\n<p>Using <code>@Mat's Mug</code> advice, I'll show how I figured out how I added my Dictionary.</p>\n\n<p>I made a public variant called <code>DHeader</code> and created a Sub to Call from:</p>\n\n<pre><code>Public DHeader As Dictionary\n\nSub Load_Headers()\n\nIf Not DHeader Is Nothing Then Exit Sub\nSet DHeader = New Dictionary\n\nWith DHeader\n    .add \"Employee\", \"Name\"\n    .add \"Employer Name\", \"Company\"\n    '...\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Then within my action Sub I added this:</p>\n\n<pre><code>Call Load_Headers\nFor Each i_1 In Range(\"Table1[#Headers]\")\n    If DHeader.Exists(CStr(i_1.Value)) = True Then\n        i_1.Value = DHeader.Item(CStr(i_1.Value))\n    End If\nNext i_1\n</code></pre>\n\n<p>Now my values and actions are separated into different parts of my code. I think I have to add a way to clear the dictionary in my action sub still, but it works!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424193750, "post_id": 28566785, "comment_id": 45444721, "body": "Is the worksheet protected?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1424194375, "post_id": 28566785, "comment_id": 45445143, "body": "When you get the error, you have the option of choosing between &quot;Debug&quot; and &quot;End&quot;; click on the button &quot;Debug&quot;, you will be brought to the line of code that causes the error; it will help if you report it here. Moreover, please also report the Excel version you use: the code is very basic and seen like this, the only thing that can &quot;look&quot; wrong is the property <code>.Formula</code> (it can be that in the Excel version you use this property is obsolete/too recent)."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 4576960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9BDJ0.jpg?s=128&g=1", "display_name": "MattShef", "link": "https://stackoverflow.com/users/4576960/mattshef"}, "is_accepted": false, "score": 0, "last_activity_date": 1424204552, "creation_date": 1424204552, "answer_id": 28570430, "question_id": 28566785, "link": "https://stackoverflow.com/questions/28566785/run-time-error-1004-application-defined-or-object-defined-error/28570430#28570430", "title": "run time error - 1004 application defined or object defined error", "body": "<p>It worked when I tested it. I also changed the code to </p>\n\n<pre><code>Sub proFirst()\n    Range(\"A1\").Value = 34\n    Range(\"A2\").Value = 66\n    Range(\"A3\").Value = \"=A1+A2\"\n    Range(\"A1\").Select\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Which worked, also. It may be the version of excel you are using.</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1424824920, "creation_date": 1424824920, "answer_id": 28709148, "question_id": 28566785, "link": "https://stackoverflow.com/questions/28566785/run-time-error-1004-application-defined-or-object-defined-error/28709148#28709148", "title": "run time error - 1004 application defined or object defined error", "body": "<p>Go to Tools / References in the VBA Editor and see if anything that is ticked (up the top of the list) is listed as \"Missing\"</p>\n"}], "owner": {"reputation": 43, "user_id": 4049148, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9ae42e71d095c8651048c8ab02b4dad5?s=128&d=identicon&r=PG&f=1", "display_name": "PFR", "link": "https://stackoverflow.com/users/4049148/pfr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 515, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1424824920, "creation_date": 1424192252, "last_edit_date": 1424824774, "question_id": 28566785, "link": "https://stackoverflow.com/questions/28566785/run-time-error-1004-application-defined-or-object-defined-error", "title": "run time error - 1004 application defined or object defined error", "body": "<p>I went through a tutorial to learn the basics of Macros, and I tried out as given in the tutorial. When I run the Macro, I got the following error:</p>\n\n<p>run time error 1004 -application defined or object defined error</p>\n\n<p>The Macro I used was</p>\n\n<pre><code>Sub proFirst()\n        Range(\"A1\").Value = 34\n        Range(\"A2\").Value = 66\n        Range(\"A3\").Formula = \"=A1+A2\"\n        Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>How not to get this error? Help me out. Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1424192131, "post_id": 28566662, "comment_id": 45443642, "body": "Have you tried recording a macro and comparing the generated code with what you have?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1424192702, "post_id": 28566662, "comment_id": 45444012, "body": "Make sure the worksheet is not <i>Hidden</i> or protected from being <b>Select</b>ed"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424193709, "post_id": 28566662, "comment_id": 45444680, "body": "<code>Worksheets(Array(1, 2, 3, 4)).Select</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1981, "user_id": 3393520, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/d38d36d0144bb8606b1a9f0bbb112d5c?s=128&d=identicon&r=PG", "display_name": "Methodician", "link": "https://stackoverflow.com/users/3393520/methodician"}, "edited": false, "score": 0, "creation_date": 1424289584, "post_id": 28567349, "comment_id": 45492056, "body": "That&#39;s what I tried at first but got another weird error. Remember: I&#39;m getting the error when I try to select just one sheet, so I can&#39;t hope to select the array until I solve that."}, {"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "reply_to_user": {"reputation": 1981, "user_id": 3393520, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/d38d36d0144bb8606b1a9f0bbb112d5c?s=128&d=identicon&r=PG", "display_name": "Methodician", "link": "https://stackoverflow.com/users/3393520/methodician"}, "edited": false, "score": 0, "creation_date": 1424290636, "post_id": 28567349, "comment_id": 45492695, "body": "Do you have the first worksheet hidden? If you try and select a worksheet that is hidden or very hidden it will return that error. Try selecting them by name to test."}], "tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": false, "score": 0, "last_activity_date": 1424193938, "creation_date": 1424193938, "answer_id": 28567349, "question_id": 28566662, "link": "https://stackoverflow.com/questions/28566662/keep-getting-run-time-error-1004-select-method-of-worksheet-class-failed-whe/28567349#28567349", "title": "Keep getting &quot;Run-time error &#39;1004&#39;: Select method of Worksheet class failed when trying to select a worksheet", "body": "<p>You're entering the Array wrong:</p>\n\n<pre><code>Sub testselect2()\nSheets(Array(1, 2, 3, 4)).Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1981, "user_id": 3393520, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/d38d36d0144bb8606b1a9f0bbb112d5c?s=128&d=identicon&r=PG", "display_name": "Methodician", "link": "https://stackoverflow.com/users/3393520/methodician"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2771, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424193938, "creation_date": 1424191910, "question_id": 28566662, "link": "https://stackoverflow.com/questions/28566662/keep-getting-run-time-error-1004-select-method-of-worksheet-class-failed-whe", "title": "Keep getting &quot;Run-time error &#39;1004&#39;: Select method of Worksheet class failed when trying to select a worksheet", "body": "<p>What I really need is a way to select multiple worksheets in a workbook based on index and/or location in the tab lineup. However, even the simplest select-by-index code is returning this frustrating error.</p>\n\n<p>Here's the simplest code that still returns the error:</p>\n\n<pre><code>Sub testselect()\nWorksheets(1).Select\nEnd Sub\n</code></pre>\n\n<p>And here's the gist of what I'd like to make work, but probably won't even after I solve this frustrating error:</p>\n\n<pre><code>Sub testselect2()\nWorksheets(Array(Worksheets(1), Worksheets(2), Worksheets(3), Worksheets(4))).Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1424191427, "post_id": 28566293, "comment_id": 45443197, "body": "This code doesn&#39;t even compile. You can&#39;t start a procedure name with a numeric."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424191509, "post_id": 28566293, "comment_id": 45443244, "body": "Your <code>OnTime</code> statements also appear to be referencing procedure names which don&#39;t exist, i.e., <code>Call_8amSave</code> as opposed to <code>8amsave</code>.  Rename your procedures so that they match the calls in the <code>OnTime</code> statement, it should work.  E.g., <code>Sub Call_8amSave</code>, etc."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1424191722, "post_id": 28566293, "comment_id": 45443381, "body": "<code>Call</code> statement is completely unnecessary - if you want to execute <code>MyProcedure</code>, just say <code>MyProcedure</code>, that&#39;s a procedure call. <code>Call</code> statement is a relic from old, old versions of the language, that remained there for backward compatibility... along with <code>Let</code> keyword for value assignments and <code>Rem</code> keyword for... comments."}, {"owner": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "edited": false, "score": 0, "creation_date": 1424192314, "post_id": 28566293, "comment_id": 45443752, "body": "Thanks David. Apologies, my code does have letters before the numbers, I just removed them to shorten the code of above. I&#39;ve also amended my reference. I&#39;m still getting the same error. &quot; Cant run macro {file location} The macro may not be available in this workbook or all macros may be disabled&quot;. Any ideas?"}, {"owner": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "edited": false, "score": 0, "creation_date": 1424192526, "post_id": 28566293, "comment_id": 45443897, "body": "Hadn&#39;t seen the answers and comments. Ignore my last comment. I&#39;ll give the solution a whirl and report back."}], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "edited": false, "score": 0, "creation_date": 1424246687, "post_id": 28566660, "comment_id": 45465804, "body": "Thanks for the help David. I have included this code, but I&#39;m still getting the error. It seems its unable to find &quot;Sub Call_8amsave()&quot;"}, {"owner": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "edited": false, "score": 0, "creation_date": 1424246770, "post_id": 28566660, "comment_id": 45465849, "body": "Cannot run the macro &quot;Z:\\Test sheet new.xlsm&#39;!Call_8amsave&#39;. The macro may not be available in this workbook or all macros may be disabled."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "edited": false, "score": 0, "creation_date": 1424266680, "post_id": 28566660, "comment_id": 45477268, "body": "You need to include the module name like <code>z:\\my workbook.xlsm!Module_Name.Procedure_Name</code>"}, {"owner": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "edited": false, "score": 0, "creation_date": 1424271834, "post_id": 28566660, "comment_id": 45480587, "body": "I&#39;m a little lost. Where do I need to include the module name in your above code?. I&#39;ve had a look on google, but I&#39;m not getting anywhere. If my workbook is called &quot;test sheet&quot; for example. I would use....&quot;z:\\test sheet.xlsm!Dashboard.Call_9amsave&quot; ?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "edited": false, "score": 0, "creation_date": 1424272126, "post_id": 28566660, "comment_id": 45480787, "body": "You need to include the module name like <code>z:\\my workbook.xlsm!**Module_Name.**Procedure_Name</code> Is your module called <code>Dashboard</code>?"}, {"owner": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "edited": false, "score": 0, "creation_date": 1424273591, "post_id": 28566660, "comment_id": 45481742, "body": "So the macros are all in the same file. I have input the code you gave above into Sheet1(core). This is the sheet I have the button to set the code running, I then set the button. The actual date that i&#39;m copying is in Sheet2(dashboard) i.e VBA project &gt; Microsoft excel objects."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "edited": false, "score": 0, "creation_date": 1424273945, "post_id": 28566660, "comment_id": 45482004, "body": "the module is called <code>Sheet2</code>. The worksheet is called &quot;Dashboard&quot;, but the module name is still the worksheet&#39;s codename."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "edited": false, "score": 0, "creation_date": 1424274276, "post_id": 28566660, "comment_id": 45482237, "body": "Or, simply put the code in a <i>standard</i> module and you don&#39;t need to qualify it with the sheet name or the filename. You can just do <code>Application.OnTime TimeValue(&quot;08:10:00&quot;), &quot;Call_8amsave&quot;</code>."}, {"owner": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "edited": false, "score": 0, "creation_date": 1424274955, "post_id": 28566660, "comment_id": 45482731, "body": "Ahh problem solved. I moved it to a standard module. You have been a great help. Very much appreciated."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1424192285, "last_edit_date": 1424192285, "creation_date": 1424191906, "answer_id": 28566660, "question_id": 28566293, "link": "https://stackoverflow.com/questions/28566293/application-ontime-code-isnt-running/28566660#28566660", "title": "Application.ontime code isn&#39;t running", "body": "<p>Your <code>OnTime</code> statements also appear to be referencing procedure names which don't exist, i.e., <code>Call_8amSave</code> as opposed to <code>8amsave</code>.  Note also that procedure names cannot begin with numeric (e.g., <code>8amsave</code>) and this code should not even compile, let alone execute.</p>\n\n<p>Rename your procedures so that they match the calls in the <code>OnTime</code> statement, and are legally permissible procedure names, like: <code>Sub Call_8amSave</code>, etc.</p>\n\n<p>Also, the <code>OnTime</code> property can only have one procedure at a time, so you can't set 3 future times, you have to set them sequentially. So, set the <code>OnTime</code> for the 9am save during the 8am procedure, etc.</p>\n\n<pre><code>Option Explicit\n\nSub Call_save()\n\n    Application.OnTime TimeValue(\"08:10:00\"), \"Call_8amsave\"\n\nEnd Sub\nSub Call_8amsave()\n\n    With Worksheets(\"Dashboard\")\n        .Range(\"B33:E49\").Value = .Range(\"S6:V22\").Value\n    End With\n\n    Application.OnTime TimeValue(\"09:10:00\"), \"Call_9amsave\"\nEnd Sub\n\nSub Call_9amsave()\n\n    With Worksheets(\"Dashboard\")\n        .Range(\"B54:E70\").Value = .Range(\"S6:V22\").Value\n    End With\n\n    Application.OnTime TimeValue(\"10:10:00\"), \"Call_10amsave\"\nEnd Sub\n\nSub Call_10amsave()\n\n    With Worksheets(\"Dashboard\")\n        .Range(\"B75:E91\").Value = .Range(\"S6:V22\").Value\n    End With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 4576228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8992d8af3f3bca2b53d8cee8ade7b56b?s=128&d=identicon&r=PG&f=1", "display_name": "lordf", "link": "https://stackoverflow.com/users/4576228/lordf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2227, "favorite_count": 0, "accepted_answer_id": 28566660, "answer_count": 1, "score": 0, "last_activity_date": 1424192285, "creation_date": 1424190881, "last_edit_date": 1424191454, "question_id": 28566293, "link": "https://stackoverflow.com/questions/28566293/application-ontime-code-isnt-running", "title": "Application.ontime code isn&#39;t running", "body": "<p>I've done a fair bit of research on here to try and get this code to run, but I'm still having issues.</p>\n\n<p>I am trying to run a macro at a set time. In fact it is a number of macros as different times. This macro then copies a block of cells, into a different area on the sheet.</p>\n\n<p>I will not be able to use windows scheduler so I'm trying to do it this way. I gather without scheduler I will have to run the macro from a button. Therefore, my first sub is this (note button is on a separate sheet to the data)</p>\n\n<pre><code>Sub Call_save()\n\n    Call Sheets(\"Dashboard\").8amsave\n\n    Application.OnTime TimeValue(\"08:10:00\"), \"Call_8amsave\"\n\n    Call 9amsave\n\n    Application.OnTime TimeValue(\"09:10:00\"), \"Call_9amsave\"\n\n    Call 10amsave\n\n    Application.OnTime TimeValue(\"10:10:00\"), \"Call_10amsave\"\n\nEnd Sub\n</code></pre>\n\n<p>This button is designed to then run the subs at the predetermined time. The subs it calls are these: </p>\n\n<pre><code>Sub 8amsave()\nDim current_data As Variant\n\n    current_data = Worksheets(\"Dashboard\").Range(\"S6:V22\").Value\n    Worksheets(\"Dashboard\").Range(\"B33:E49\").Value = current_data\n\n\nEnd Sub\n\nSub 9amsave()\nDim current_data As Variant\n\n    current_data = Worksheets(\"Dashboard\").Range(\"S6:V22\").Value\n    Worksheets(\"Dashboard\").Range(\"B54:E70\").Value = current_data\n\n\nEnd Sub\n\nSub 10amsave()\nDim current_data As Variant\n\n    current_data = Worksheets(\"Dashboard\").Range(\"S6:V22\").Value\n    Worksheets(\"Dashboard\").Range(\"B75:E91\").Value = current_data\n\n\nEnd Sub\n</code></pre>\n\n<p>Now, when I run the initial button it runs all the subs at once and copies the sells into the correct places, straight away. This isnt really an issue for me. However, at the predetermined time I get an error saying unable to run the macro... can't find it or sheet unable to run macros... or something of that ilk.</p>\n\n<p>Is there anything blindingly obvious that i am missing? I have kind of been working this out as I go along so my VBA knowledge is fairly limited. A point in the right direction would be great.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424198519, "post_id": 28566217, "comment_id": 45447494, "body": "Hard to say without a screenshot or maybe you can copy-paste some text and shre the doc file?"}, {"owner": {"reputation": 388, "user_id": 1561777, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/XhulK.jpg?s=128&g=1", "display_name": "David.Warwick", "link": "https://stackoverflow.com/users/1561777/david-warwick"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424199213, "post_id": 28566217, "comment_id": 45447862, "body": "Hi Tim. I am not permitted to share the entire file. I wish I could. But, I did share a small screen shot that shows the highlight selected and the sizing handles."}], "answers": [{"tags": [], "owner": {"reputation": 388, "user_id": 1561777, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/XhulK.jpg?s=128&g=1", "display_name": "David.Warwick", "link": "https://stackoverflow.com/users/1561777/david-warwick"}, "is_accepted": false, "score": 0, "last_activity_date": 1424204304, "last_edit_date": 1495540622, "creation_date": 1424204304, "answer_id": 28570369, "question_id": 28566217, "link": "https://stackoverflow.com/questions/28566217/word-vba-get-selection-text-background-color-but-not-highlighted-or-shading/28570369#28570369", "title": "Word VBA Get Selection (Text) Background Color - But Not Highlighted or Shading", "body": "<p>Well, I figured out how to do it. I used another StackOverflow question to lead me to the answer <a href=\"https://stackoverflow.com/questions/7636645/how-do-you-select-an-image-that-was-just-pasted-to-ms-word-via-vba\">How do you select an image that was just pasted to MS Word via VBA</a></p>\n\n<p>I am running this code from Microsoft Access on a Microsoft Word object.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Public Sub ReadWord2(strPath As String)\r\n'Const wdColorRed = 255\r\nDim objWord As Object\r\nDim objDoc As Word.Document\r\nDim strParagraph As String\r\nDim intShapeCount As Integer\r\nDim Shape As Word.Shape\r\n\r\nSet objWord = CreateObject(\"Word.Application\")\r\nobjWord.Visible = True\r\n\r\nSet objDoc = objWord.Documents.Open(strPath)\r\nSet objSelection = objWord.Selection\r\n\r\nintShapeCount = objDoc.Shapes.Count\r\n'objDoc.Shapes.SelectAll\r\n\r\nFor Each Shape In objDoc.Shapes\r\n\r\n'If Shape.AutoShapeType = 1 Then\r\nShape.Select\r\n'Debug.Print Shape.Fill.BackColor\r\n'Debug.Print Shape.AutoShapeType, Shape.Name\r\n'Debug.Print Shape.TextFrame.TextRange.Text\r\nobjSelection.Expand wdParagraph\r\nDebug.Print objSelection.Text, Shape.Fill.BackColor\r\n'End If\r\nNext\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>There is actually more code in the sub, but I deleted the parts that are not relevant. Hopefully this will help someone else who runs into the same problem. The objSelection.Text will contain the paragraph text that the shape is part of. Now I just need to write code to handle the text and make sure that it is text that I want.</p>\n"}], "owner": {"reputation": 388, "user_id": 1561777, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/XhulK.jpg?s=128&g=1", "display_name": "David.Warwick", "link": "https://stackoverflow.com/users/1561777/david-warwick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1779, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424204304, "creation_date": 1424190574, "last_edit_date": 1424198991, "question_id": 28566217, "link": "https://stackoverflow.com/questions/28566217/word-vba-get-selection-text-background-color-but-not-highlighted-or-shading", "title": "Word VBA Get Selection (Text) Background Color - But Not Highlighted or Shading", "body": "<p><img src=\"https://i.stack.imgur.com/Dyb9j.png\" alt=\"enter image description here\">I have a Word Document that was created by saving a PDF document as a Word Document. The PDF document has some text that was highlighted in Yellow. I need to detect the highlighted text. I guess the conversion is not perfect. Some of the text in the Word Document is showing that it is highlighted, and some just has a Yellow background but is not showing as being highlighted. I can select some of the text and click on the highlight button on the menu and it shows a highlight color, and for some of the words, it shows No Color.</p>\n\n<p>Also in the VBA immediate window if I type </p>\n\n<p>?selection.formattedtext.highlightcolorindex, I get 7 for some selections, and 0 for others.</p>\n\n<p>For those selections that do not show up as highlighted, how can I detect them?</p>\n\n<p>Update: I selected a \"Highlighted\" word and executed call Selection.ClearFormatting and the font changed, but the yellow highlight remained. So that tells me that the yellow highlight is not a format. I also selected No Color with the text selected and the yellow highlight remained. I have verified that it is neither Highlight or Shading. Hmmm... What could be causing the highlight?</p>\n\n<p>Update: I discovered that if I delete the \"highlighted text\" that is not really highlighted, the text that is to the right of the deleted text moves over to the left and the highlight remains. So then I discovered that I can Select the highlight if there is no text under a portion of the highlight. Then I can drag the highlight to another portion of the page. So, this highlight is an object. If I right click on it, I have options such as Format Object. </p>\n\n<p>So now I know that these \"Highlights\" are actually like objects. If there is no text under the object, I can grab it and drag it around. How can I, using VBA, find these types of objects?</p>\n\n<p>What I really want is the entire paragraph under the highlight objects. Is that possible?</p>\n"}]