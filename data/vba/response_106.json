[{"tags": ["vba", "excel", "dns", "nslookup"], "comments": [{"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1484789070, "post_id": 41731416, "comment_id": 70658756, "body": "If I were you, I&#39;d check out this post:  <a href=\"http://jayteknews.blogspot.no/2011/08/excel-user-defined-function-nslookup.html\" rel=\"nofollow noreferrer\">jayteknews.blogspot.no/2011/08/&hellip;</a>"}, {"owner": {"reputation": 23, "user_id": 5627606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e070f27e3df619afcd574ca2374e292?s=128&d=identicon&r=PG&f=1", "display_name": "SkiBum", "link": "https://stackoverflow.com/users/5627606/skibum"}, "reply_to_user": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1484794660, "post_id": 41731416, "comment_id": 70660179, "body": "Thank you for the suggestion.  I have looked at that post previously. It uses a temporary file for each DNS lookup.  Because I will populate this spreadsheet daily with 10,000+ FQDN and will do that for several weeks, I really don&#39;t want to creaete/delete that many temporary files.  It is also a speed of execution issue.  VBA is not the fastest thing in the world when you execute a function that many times, adding in the overhead of a create/delete of a file, would make updating the spreadsheet too slow."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 5627606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e070f27e3df619afcd574ca2374e292?s=128&d=identicon&r=PG&f=1", "display_name": "SkiBum", "link": "https://stackoverflow.com/users/5627606/skibum"}, "is_accepted": true, "score": 0, "last_activity_date": 1486048278, "last_edit_date": 1486048278, "creation_date": 1486047739, "answer_id": 42005561, "question_id": 41731416, "link": "https://stackoverflow.com/questions/41731416/unable-to-look-up-ip-address-in-64-bit-vba/42005561#42005561", "title": "Unable to look up IP address in 64-bit VBA", "body": "<p>I have it working now as long as it is not moved to an add-in (.xlam).  If I move it to an add-in this exact same code crashes on the call to getaddrinfo.  I will continue to work on that.</p>\n\n<p>The procedure requires one argument (hostname passed as a string).  The second argument is the maximum number of IP addresses to return (passed as an integer), but is optional.  If the second argument is blank, all IP address are returned.  When set to a value other than zero, that value will be the maximum number of ip addresses for the host. </p>\n\n<pre><code>Private Const AF_UNSPEC As Long = 0\nPrivate Const AF_INET As Long = 2\nPrivate Const AF_INET6 As Long = 23\n\nPrivate Const SOCK_STREAM As Long = 1\nPrivate Const INADDR_ANY As Long = 0\nPrivate Const IPPROTO_TCP As Long = 6\n\n' Getaddrinfo return status codes\nPrivate Const WAS_NOT_ENOUGH_MEMORY = 8    '  Insufficient memory available.\nPrivate Const WASEINVAL = 10022    '  Invalid argument.\nPrivate Const WASESOCKTNOSUPPORT = 10044     '  Socket type not supported.\nPrivate Const WASEAFNOSUPPORT = 10047    '  Address family not supported by protocol family.\nPrivate Const WASNOTINITIALISED = 10093    '  Successful WSAStartup not yet performed.\nPrivate Const WASTYPE_NOT_FOUND = 10109    '  Class type not found.\nPrivate Const WASHOST_NOT_FOUND = 11001    '  Host not found.\nPrivate Const WASTRY_AGAIN = 11002    '  Nonauthoritative host not found.\nPrivate Const WASNO_RECOVERY = 11003    '  This is a nonrecoverable error.\nPrivate Const WASNO_DATA = 11004    '  Valid name, no data record of requested type.\n\n'AI_flags\nPrivate Const AI_PASSIVE As Long = &amp;H1\nPrivate Const ai_canonName As Long = &amp;H2\nPrivate Const AI_NUMERICHOST As Long = &amp;H4\nPrivate Const AI_ALL As Long = &amp;H100\nPrivate Const AI_ADDRCONFIG As Long = &amp;H400\nPrivate Const AI_V4MAPPED As Long = &amp;H800\nPrivate Const AI_NON_AUTHORITATIVE As Long = &amp;H4000\nPrivate Const AI_SECURE As Integer = &amp;H8000\nPrivate Const AI_RETURN_PREFERRED_NAMES As Long = &amp;H10000\nPrivate Const AI_FQDN As Long = &amp;H20000\nPrivate Const AI_FILESERVER As Long = &amp;H40000\n\nDim hSocket As Long\nDim sServer As String\n\n' To initialize Winsock.\nPrivate Type WSADATA\n   wVersion                               As Integer\n   wHighVersion                           As Integer\n   szDescription(256 + 1)                 As Byte\n   szSystemstatus(128 + 1)                As Byte\n   iMaxSockets                            As Integer\n   iMaxUpdDg                              As Integer\n   lpVendorInfo                           As Long\nEnd Type\n\nPrivate Type in_addr\n   s_addr   As LongPtr\nEnd Type\n\nPrivate Type sockaddr_in\n    sin_family          As Integer  '2 bytes\n    sin_port            As Integer  '2 bytes\n    sin_addr            As in_addr  '4 bytes or 8 bytes\n    sin_zero(7)         As Byte     '8 bytes\nEnd Type                            'Total 16 bytes or 24 bytes\n\nPrivate Type sockaddr\n    sa_family           As Integer  '2 bytes\n    sa_data(25)         As Byte     '26 bytes\nEnd Type                            'Total 28 bytes\n\nPrivate Type addrinfo\n    ai_flags As Long\n    ai_family As Long\n    ai_socktype As Long\n    ai_protocol As Long\n    ai_addrlen As Long\n    ai_canonName As LongPtr 'strptr\n    ai_addr As LongPtr 'p sockaddr\n    ai_next As LongPtr 'p addrinfo\nEnd Type\n\nPrivate Declare PtrSafe Function API_Socket Lib \"ws2_32.dll\" Alias \"socket\" (ByVal af As Long, ByVal stype As Long, ByVal Protocol As Long) As Long\nPrivate Declare PtrSafe Function API_GetAddrInfo Lib \"ws2_32.dll\" Alias \"getaddrinfo\" (ByVal NodeName As String, ByVal ServName As String, ByVal lpHints As LongPtr, lpResult As LongPtr) As Long\nPrivate Declare PtrSafe Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (Destination As Any, Source As Any, ByVal Length As Long)\nPrivate Declare PtrSafe Function ntohs Lib \"ws2_32.dll\" (ByVal netshort As Long) As Integer\n\n\nPublic Function NameToIPaddress(hostname As String, Optional MaxReturn As Integer = 0) As String\n    Dim sa_local As sockaddr_in\n    Dim sa_dest As sockaddr\n    Dim lRet As Long\n    Dim Hints As addrinfo\n    Dim ptrResult As LongPtr\n    Dim IPaddress As String\n    Dim AddressList As String\n    Dim AddressType As Long\n    Dim Cnt As Integer\n\n    AddressType = AF_INET\n\n    If hostname = \"\" Then\n        NameToIPaddress = \"\"\n        Exit Function\n    End If\n\n    'Create TCP socket\n    hSocket = API_Socket(AddressType, SOCK_STREAM, IPPROTO_TCP)\n    If hSocket = 0 Then\n        MsgBox (\"Failed to create socket!\")\n        Exit Function\n    End If\n\n    'Populate the local sockaddr\n    sa_local.sin_family = AddressType\n    sa_local.sin_port = ntohs(0&amp;)\n    sa_local.sin_addr.s_addr = INADDR_ANY\n\n    'Recover info about the destination.\n    'Hints.ai_flags = AI_NON_AUTHORITATIVE\n    Hints.ai_flags = 0\n    Hints.ai_family = AddressType\n    sServer = hostname &amp; vbNullChar 'Null terminated string\n    sServer = hostname\n    lRet = API_GetAddrInfo(sServer, 0, VarPtr(Hints), ptrResult)\n    If lRet &lt;&gt; 0 Then\n        If lRet = WASHOST_NOT_FOUND Then\n            NameToIPaddress = \"not found\"\n            Exit Function\n        End If\n        Dim errorText As String\n        Select Case lRet\n            Case WAS_NOT_ENOUGH_MEMORY\n                errorText = \"Insufficient memory available\"\n            Case WASEINVAL\n                errorText = \"Invalid argument\"\n            Case WASESOCKTNOSUPPORT\n                errorText = \"Socket type not supported\"\n            Case WASEAFNOSUPPOR\n                errorText = \"Address family not supported by protocol family\"\n            Case WASNOTINITIALISED\n                errorText = \"Successful WSAStartup not yet performed\"\n            Case WASTYPE_NOT_FOUND\n                errorText = \"Class type not found\"\n            Case WASHOST_NOT_FOUND\n                errorText = \"Host not found\"\n            Case WASTRY_AGAIN\n                errorText = \"Nonauthoritative host not found\"\n            Case WASNO_RECOVERY\n                errorText = \"This is a nonrecoverable error\"\n            Case WASNO_DATA\n                errorText = \"Valid name, no data record of requested type\"\n            Case Else\n                errorText = \"unknown error condition\"\n        End Select\n        'MsgBox (\"Error in GetAddrInfo:  \" &amp; lRet &amp; \" - \" &amp; errorText)\n        NameToIPaddress = \"#Error in lookup\"\n        Exit Function\n    End If\n\n    Cnt = 0\n    Hints.ai_next = ptrResult   'Pointer to first structure in linked list\n\n    Do While Hints.ai_next &gt; 0 And (Cnt &lt; MaxReturn Or MaxReturn = 0)\n       CopyMemory Hints, ByVal Hints.ai_next, LenB(Hints) 'Copy next address info to Hints\n       CopyMemory sa_dest, ByVal Hints.ai_addr, LenB(sa_dest)    'Save sockaddr portion\n       Select Case sa_dest.sa_family\n           Case AF_INET\n               IPaddress = sa_dest.sa_data(2) &amp; \".\" &amp; sa_dest.sa_data(3) &amp; \".\" &amp; sa_dest.sa_data(4) &amp; \".\" &amp; sa_dest.sa_data(5)\n           Case AF_INET6\n               IPaddress = sa_dest.sa_data(0) &amp; \":\" &amp; sa_dest.sa_data(1) &amp; \":\" &amp; sa_dest.sa_data(2) &amp; \"::\" &amp; sa_dest.sa_data(3) &amp; \":\" &amp; sa_dest.sa_data(4)\n           Case Else\n               IPaddress = \"\"\n       End Select\n       Cnt = Cnt + 1\n       If AddressList = \"\" Then\n           AddressList = IPaddress\n       Else\n          AddressList = AddressList &amp; \",\" &amp; IPaddress\n       End If\n    Loop\n    NameToIPaddress = AddressList\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5627606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e070f27e3df619afcd574ca2374e292?s=128&d=identicon&r=PG&f=1", "display_name": "SkiBum", "link": "https://stackoverflow.com/users/5627606/skibum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2708, "favorite_count": 0, "accepted_answer_id": 42005561, "answer_count": 1, "score": 1, "last_activity_date": 1486048278, "creation_date": 1484782994, "last_edit_date": 1495535370, "question_id": 41731416, "link": "https://stackoverflow.com/questions/41731416/unable-to-look-up-ip-address-in-64-bit-vba", "title": "Unable to look up IP address in 64-bit VBA", "body": "<p>My base problem is that I have a spreadsheet with 10's of thousands of FQDN (fully qualified domain name) entries that I need to check if the FQDN is a valid DNS entry on the public internet. I am doing a DNS lookup of each FQDN and would like to specify a public DNS server. If the call to the DNS returns an IP address, I will assume the FQDN is valid. I am working in excel 64-bit, but need a solution that will also compile and work in 32-bit, so I want the same source code to be able to be compiled in both.  Since there are so many rows in the spreadsheet, I don't want to use a function that creates a temporary file for each lookup.  (I am OCD about unneeded temporary files when a system call is available).</p>\n\n<p>I believe that the function \"getaddrinfoex\" provides the ability to specify what name server is queried, but I have not been able to find any VBA snippets that use getaddrinfoex or the lesser version of getaddrinfo (which does not allow specifying the DNS server). I have found several examples of calls to gethostbyname, but all are for 32-bit Excel.  Also, Microsoft has published that gethostbyname has been deprecated (<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms738524(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms738524(v=vs.85).aspx</a>), so I was trying to use the recommended replacement getaddrinfo</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1177492/how-can-i-make-a-network-connection-with-visual-basic-from-microsoft-access/41730492?noredirect=1#comment70655861_41730492\">How can I make a network connection with Visual Basic from Microsoft Access?</a></p>\n\n<p>The snippet posted in the answer by @david in the question I linked above looks to have the proper syntax to be both 32-bit and 64-bit compatible. But the example did not include the call to gethostbyname, it only provided the declaration of the function.</p>\n\n<p>Is getaddrinfoex available in VBA? Does someone have an example of using getaddrinfoex which will work in both 32-bit and 64-bit? </p>\n\n<p>I would appreciate any help. I have not coded in MANY years, so my skills are very dated. Thus I am doing a lot of searches to find what I need.</p>\n\n<p>Here is the code I have created from combining various searches on-line.</p>\n\n<pre><code>Private Type HOSTENT\n   hName As LongPtr\n   hAliases As LongPtr\n   hAddrType As Integer\n   hLen As Integer\n   hAddrList As LongPtr\nEnd Type\n\n#if Not VBA7 then\n   ' used by 32-bit compiler\n   Private Declare Function gethostbyname Lib \"wsock32.dll\" _\n       (ByVal HostName As String) As LongPtr\n\n   Private Declare Function getaddrinfo Lib \"wsock32.dll\" _\n       (ByVal HostName As String) As LongPtr\n\n   Public Declare Function WSAStartup Lib \"wsock32.dll\" _\n       (ByVal wVersionRequired As Long, lpWSADATA As WSADATA) As LongPtr\n#else\n' used by 64-bit compiler\n   Private Declare PtrSafe Function gethostbyname Lib \"wsock32.dll\" _\n       (ByVal HostName As String) As LongPtr\n\n   Private Declare PtrSafe Function getaddrinfo Lib \"wsock32.dll\" _\n       (ByVal HostName As String) As LongPtr\n\n   Public Declare PtrSafe Function WSAStartup Lib \"wsock32.dll\" _\n       (ByVal wVersionRequired As Long, lpWSADATA As WSADATA) As LongPtr\n\n#endif\n\nPublic Function GetIPAddressFromHostName(ByVal HostName As String) _\n               As LongPtr\n\n    Dim HostEntry As HOSTENT\n    Dim HostEntry2 as HOSTENT\n    Dim HostEntryPtr As LongPtr\n    Dim HostEntryPtr2 As LongPtr\n    Dim IPAddressesPtr As LongPtr\n    Dim Result As Long\n\n    If InitializeSockets Then\n        ' I added the call do getaddrinfo as an example\n        ' I have been able to get it to work at all\n        HostEntryPtr2 = getaddrinfo(HostName &amp; vbNullChar)\n\n        HostEntryPtr = gethostbyname(HostName &amp; vbNullChar)\n        If HostEntryPtr &gt; 0 Then\n                 CopyMemory HostEntry, ByVal HostEntryPtr, Len(HostEntryPtr)\n                 CopyMemory IPAddressesPtr, ByVal HostEntry.hAddrList, _\n                     Len(IPAddressesPtr)\n                 CopyMemory Result, ByVal IPAddressesPtr, Len(Result)\n                 GetIPAddressFromHostName = Result\n              End If\n           End If  \nEnd Function\n\nPublic Function InitializeSockets() As Boolean\n    ' Initialize Windows sockets. \n   Dim WinSockData As WSADATA\n   InitializeSockets = WSAStartup(WS_VERSION_REQD, WinSockData) = 0   \nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "function", "hyperlink", "scope"], "answers": [{"comments": [{"owner": {"reputation": 152, "user_id": 1265581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0592ebaa07cf3e44a397e8396a6741?s=128&d=identicon&r=PG", "display_name": "depwl9992", "link": "https://stackoverflow.com/users/1265581/depwl9992"}, "edited": false, "score": 0, "creation_date": 1484870757, "post_id": 41731590, "comment_id": 70700279, "body": "Perfect! Originally I had this in there, yet for whatever reason I was seeing the same error. May have just been a typo which may account for why I removed it during my testing."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1484784170, "creation_date": 1484784170, "answer_id": 41731590, "question_id": 41731275, "link": "https://stackoverflow.com/questions/41731275/excel-vba-plus-hyperlink/41731590#41731590", "title": "Excel VBA plus =hyperlink()", "body": "<p>Your <code>consolidateDuplicate</code> subroutine should be a <code>Function</code>, returning the address that the hyperlink should take you to.  The lack of a return value is what is causing the \"Reference is not valid\" error.</p>\n\n<p>The following code might work, effectively telling the hyperlink to take you to the cell in which the hyperlink was located:</p>\n\n<pre><code>Function consolidateDuplicate(PN, Quantity) As Range\n    Dim thisRow, prevQuant As Long\n    thisRow = Selection.Row\n    MsgBox (\"You clicked the hyperlink for \" &amp; thisRow &amp; \"Q: \" &amp; Quantity &amp; \", PN: \" &amp; PN)\n    Set consolidateDuplicate = Selection\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 152, "user_id": 1265581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0592ebaa07cf3e44a397e8396a6741?s=128&d=identicon&r=PG", "display_name": "depwl9992", "link": "https://stackoverflow.com/users/1265581/depwl9992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 41731590, "answer_count": 1, "score": 0, "last_activity_date": 1531324173, "creation_date": 1484782013, "last_edit_date": 1531324173, "question_id": 41731275, "link": "https://stackoverflow.com/questions/41731275/excel-vba-plus-hyperlink", "title": "Excel VBA plus =hyperlink()", "body": "<p>I'm attempting to write hyperlinks to cells via one button click from the ribbon in Excel 2007. These hyperlinks must, in turn, execute another routine that does stuff to the row on which they're located. However, the standard method of <code>Worksheet_FollowHyperlink()</code> will not work, as I need to execute this via an external xlam addin, and as far as I understand, this event triggers from hyperlink clicks located only in the same worksheet. </p>\n\n<p>As a result, I have found that using the <code>=HYPERLINK(\"#funName()\",\"Click me\")</code> method works, but a problem exists that I am still experiencing.</p>\n\n<p>The following is a trimmed down version of my already-working code:</p>\n\n<pre><code>Sub InsertLink() ' This is run directly by the callback for an IRibbonControl button click\n  With Sheet1\n    lastrow = Range(\"A\" &amp; Rows.count).End(xlUp).Row\n    While i &lt;= lastrow\n      Range(\"E\" &amp; i).Value = \"=HYPERLINK(\"\"#consolidateDuplicate(A\" &amp; i &amp; \",C\" &amp; i &amp; \")\"\",\"\"Copy this row to next\"\")\"\n    Wend\n    Call MsgBox (\"Finished inserting hyperlinks on each row.\", vbOKOnly)\n  End With\nEnd Sub\n\nSub consolidateDuplicate(PN, Quantity)\n  Dim thisRow, prevQuant As Long\n  thisRow = Selection.Row\n  MsgBox(\"You clicked the hyperlink for \" &amp; thisRow &amp; \"Q: \" &amp; Quantity &amp; \", PN: \" &amp; PN)\nEnd Sub\n</code></pre>\n\n<p>Clicking the ribbon button successfully writes all hyperlinks into their respective rows as expected. However, when I try to click any of these hyperlinks, thus executing <code>consolidateDuplicate()</code> in the same add-in module, I immediately receive a \"<strong>Reference is not valid</strong>\" warning followed by the <code>MsgBox</code> message.</p>\n\n<p>I have tried removing all code from the routine to no avail. I also tried the standard brute-force bypass method of adding <code>On Error Resume Next ... On Error Goto 0</code> as well as <code>Application.DisplayAlerts = False ... Application.DisplayAlerts = True</code>. Neither helps. I still receive the warning.</p>\n\n<p>So while my script works fine and does what I want it to in the end, I feel like there should be a way to suppress the warning, or fix whatever is causing it, which I have a feeling, like <code>Worksheet_FollowHyperlink()</code>, is from storing the routine in the scope of an add-in module (required for my application), rather than keeping it totally contained in the calling workbook/sheet itself.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1484786025, "creation_date": 1484786025, "answer_id": 41731864, "question_id": 41731200, "link": "https://stackoverflow.com/questions/41731200/vba-select-worksheet-issue/41731864#41731864", "title": "VBA select worksheet issue", "body": "<p>Something like this</p>\n\n<pre><code>Sub NouveauFournisseur() 'OK\n\n    Dim i As Integer, shtF As WorkSheet\n\n    Set shtF = ThisWorkbook.Worksheets(\"Fournisseurs\")\n\n    creation_fournisseur.Show 'affichage de l'userform\n\n    If OK Then\n        i = 0 'boucle pr trouver la ligne vide o\u00f9 copier les donn\u00e9es dans le formulaire\n        Do\n            i = i + 1\n        Loop Until shtF.Cells(i, 1) = \"\" 'jusqu'\u00e0 ce qu'une ligne soit vide\n        shtF.Cells(i, 1) = creation_fournisseur.zt_nom\n        shtF.Cells(i, 2) = creation_fournisseur.zt_adresse\n        shtF.Cells(i, 3) = Val(creation_fournisseur.zt_tel)\n        shtF.Cells(i, 4) = Val(creation_fournisseur.zt_fax)\n    End If\n\n    Unload creation_fournisseur 'fermer l'userform\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1156, "user_id": 7437143, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6e6a10d62061d1dd0ecb2d0b760eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "a.t.", "link": "https://stackoverflow.com/users/7437143/a-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1484788249, "last_edit_date": 1495541338, "creation_date": 1484788249, "answer_id": 41732149, "question_id": 41731200, "link": "https://stackoverflow.com/questions/41731200/vba-select-worksheet-issue/41732149#41732149", "title": "VBA select worksheet issue", "body": "<p>You could also add:\nSub NouveauFournisseur() 'OK</p>\n\n<pre><code>Dim i As Integer, shtF As WorkSheet\n\nSet shtF = ThisWorkbook.Worksheets(\"Fournisseurs\")\n\nWorksheets(\"Accueil\").activate\nWorksheets(\"Accueil\").Select\ncall moduleX.creation_fournisseur.Show\ncall formY.creation_fournisseur.Show\n\n'creation_fournisseur.Show 'affichage de l'userform\n\nIf OK Then\n    i = 0 'boucle pr trouver la ligne vide o\u00f9 copier les donn\u00e9es dans le formulaire\n    Do\n        i = i + 1\n    Loop Until shtF.Cells(i, 1) = \"\" 'jusqu'\u00e0 ce qu'une ligne soit vide\n    shtF.Cells(i, 1) = creation_fournisseur.zt_nom\n    shtF.Cells(i, 2) = creation_fournisseur.zt_adresse\n    shtF.Cells(i, 3) = Val(creation_fournisseur.zt_tel)\n    shtF.Cells(i, 4) = Val(creation_fournisseur.zt_fax)\nEnd If\n\nWorksheets(\"Accueil\").activate\nWorksheets(\"Accueil\").Select\n\nUnload creation_fournisseur 'fermer l'userform\n\nWorksheets(\"Accueil\").activate\nWorksheets(\"Accueil\").Select\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Where ModuleX or FormY contain the sub for creation_fournisseur respectively.</p>\n\n<p>So that you just directly call the form without opening another sheet, like they suggested here: <a href=\"https://stackoverflow.com/questions/2804327/call-a-subroutine-from-a-different-module-in-vba\">Call a Subroutine from a different Module in VBA</a></p>\n\n<p>(A little bit of overkill with all the activations and selecting, but you get the idea)</p>\n"}], "owner": {"reputation": 13, "user_id": 7326044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e450c14f9aa1b8e7ce30049abc18021?s=128&d=identicon&r=PG&f=1", "display_name": "zakaria", "link": "https://stackoverflow.com/users/7326044/zakaria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 41731864, "answer_count": 2, "score": 0, "last_activity_date": 1484788249, "creation_date": 1484781555, "last_edit_date": 1531164843, "question_id": 41731200, "link": "https://stackoverflow.com/questions/41731200/vba-select-worksheet-issue", "title": "VBA select worksheet issue", "body": "<p>I am trying to make an application which lets you add new Suppliers (Fournisseurs in french) to a Worksheets(\"Fournisseurs\") when I click on the button ''ADD Suppliers'' which is in Worksheets(\"Accueil\")</p>\n\n<p>I would like to add a new suppliers without opening Worksheets(\"Fournisseurs\").Select and staying just in Worksheets(\"Accueil\")</p>\n\n<p>Any idea? </p>\n\n<pre><code>Sub NouveauFournisseur() 'OK\nDim i As Integer\n\nWorksheets(\"Fournisseurs\").Select 's\u00e9lection de la feuille\ncreation_fournisseur.Show 'affichage de l'userform\n\nIf OK Then\n    i = 0 'boucle pr trouver la ligne vide o\u00f9 copier les donn\u00e9es dans le formulaire\n    Do\n        i = i + 1\n    Loop Until Cells(i, 1) = \"\" 'jusqu'\u00e0 ce qu'une ligne soit vide\n    Cells(i, 1) = creation_fournisseur.zt_nom\n    Cells(i, 2) = creation_fournisseur.zt_adresse\n    Cells(i, 3) = Val(creation_fournisseur.zt_tel)\n    Cells(i, 4) = Val(creation_fournisseur.zt_fax)\nEnd If\n\nUnload creation_fournisseur 'fermer l'userform\nWorksheets(\"Accueil\").Select 'retour page d'acceuil apr\u00e8s avoir rentr\u00e9 le fournisseur\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["arrays", "string", "vba"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1484780909, "post_id": 41731004, "comment_id": 70656475, "body": "Can you convert them to strings using CStr(variablename)? Im not sure this works BTW its just an idea"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1484781141, "post_id": 41731004, "comment_id": 70656549, "body": "1) We can&#39;t tell you why your code isn&#39;t working if we can&#39;t see the code. 2) <i>it ends up producing an error</i> is an absolutely useless problem description unless you tell us what <b>error</b> is produced. It&#39;s on your screen right in front of you, so there&#39;s no reason for you not to share that info with us. 3) See <a href=\"http://stackoverflow.com/q/588004/62576\">Is floating point math broken?</a> for the reasons you can&#39;t compare floating point numbers easily."}], "answers": [{"comments": [{"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1484844574, "post_id": 41732109, "comment_id": 70687287, "body": "I added the following lines:"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 1, "creation_date": 1484844594, "post_id": 41732109, "comment_id": 70687303, "body": "NewMsg(a) = Replace(NewMsg(a), Chr(10), &quot;&quot;) NewMsg(a) = Replace(NewMsg(a), Chr(13), &quot;&quot;)"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1484844643, "post_id": 41732109, "comment_id": 70687338, "body": "and that did the trick.  There was something that was attached to the NewMsg variable that was created by splitting some data that was extracted.  Thanks for the help......."}], "tags": [], "owner": {"reputation": 1156, "user_id": 7437143, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6e6a10d62061d1dd0ecb2d0b760eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "a.t.", "link": "https://stackoverflow.com/users/7437143/a-t"}, "is_accepted": true, "score": 1, "last_activity_date": 1484787827, "creation_date": 1484787827, "answer_id": 41732109, "question_id": 41731004, "link": "https://stackoverflow.com/questions/41731004/why-dont-these-variables-match/41732109#41732109", "title": "why dont these variables match", "body": "<p>Perhaps dimensioning them either as a string or variant (and not both) makes a difference.\nOn top of that if you absorb the \"string\" arrays from cells, you might want to (manually or programatically) check if the datatype of the cells are identical, on top of the content.</p>\n\n<p>(rmb>cell properties>type> select text or whatever suits your needs, just to ensure that is not the problem)</p>\n"}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 41732109, "answer_count": 1, "score": -1, "last_activity_date": 1484787827, "creation_date": 1484780546, "question_id": 41731004, "link": "https://stackoverflow.com/questions/41731004/why-dont-these-variables-match", "title": "why dont these variables match", "body": "<p>In my macro, I have 2 string arrays: NewMsg () and MyData().  Later in the code, I extract a table and split the data to build the NewMsg array.  Then in my code, I compare NewMsg (x) to MyData (Y) and do something if they match.  I element of each array is \"E-109988\".  I step through the code and find that the 2 elements appear to be the same.  However, the macro doesn't recognize it as a match so it ends up producing an error.  Is there some formatting or something on 1 of the elements that don't cause them to match?  thanks for the help........</p>\n"}, {"tags": ["regex", "vba", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 261, "user_id": 5549471, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8505355e3bc442c16206e91ded112a33?s=128&d=identicon&r=PG&f=1", "display_name": "BigBoyB", "link": "https://stackoverflow.com/users/5549471/bigboyb"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1484874729, "post_id": 41730984, "comment_id": 70701395, "body": "I am creating a new folder manually while copy pasting the name of the folder in outlook and then copying the contents from each Outlook folder."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1484914868, "post_id": 41730984, "comment_id": 70718500, "body": "What do you mean by &quot;contents&quot;?  Are you creating MSG files or are you just saving the attachments and bodies?  If MSG files, how are you naming them?  If you are saving attachments, how do you handle duplicate names?"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1506029466, "last_edit_date": 1506029466, "creation_date": 1485023731, "answer_id": 41782997, "question_id": 41730984, "link": "https://stackoverflow.com/questions/41730984/outlook-extract-folders-with-e-mails-inside-them-to-local-hard-drive/41782997#41782997", "title": "Outlook extract folders with e-mails inside them to local hard drive", "body": "<p>Use FileSystemObject to check or create folders locally from Outlook vba</p>\n\n<pre><code>    Path = \"C:\\Temp\\\"\n    If Not FSO.FolderExists(Path) Then\n        FSO.CreateFolder (Path)\n    End If\n</code></pre>\n\n<hr>\n\n<p>You can also loop through to get Outlook folders, <a href=\"https://msdn.microsoft.com/en-us/library/office/aa212014(v=office.11).aspx\" rel=\"nofollow noreferrer\">FolderPath</a> and all their contents count then use Mid and InStr to find position and folder name..</p>\n\n<p>Here is quick vba Example, I'm using Subject-line as save name and <a href=\"https://msdn.microsoft.com/en-us/library/844skk0h(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Regex.Replace</a> to strip Invalid Characters from Subject-line.</p>\n\n<hr>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim Folders As New Collection\n    Dim EntryID As New Collection\n    Dim StoreID As New Collection\n    Dim Inbox As Outlook.MAPIFolder\n    Dim SubFolder As MAPIFolder\n    Dim olNs As NameSpace\n    Dim Item As MailItem\n    Dim RegExp As Object\n    Dim FSO As Object\n\n    Dim FolderPath As String\n    Dim Subject As String\n    Dim FileName As String\n    Dim Fldr As String\n    Dim Path As String\n\n    Dim Pos As Long\n    Dim ii As Long\n    Dim i As Long\n\n\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set RegExp = CreateObject(\"vbscript.regexp\")\n\n    Path = \"C:\\Temp\\\"\n\n    Call GetFolder(Folders, EntryID, StoreID, Inbox)\n\n    For i = 1 To Folders.Count\n        DoEvents\n        Fldr = Folders(i)\n\n        Pos = InStr(3, Fldr, \"\\\") + 1\n            Fldr = Mid(Fldr, Pos)\n\n        FolderPath = Path &amp; Fldr &amp; \"\\\"\n        Debug.Print FolderPath\n\n        If Not FSO.FolderExists(FolderPath) Then\n            FSO.CreateFolder (FolderPath)\n        End If\n\n      Set SubFolder = Application.Session.GetFolderFromID(EntryID(i), StoreID(i))\n\n        For ii = 1 To SubFolder.Items.Count\n                DoEvents\n            Set Item = SubFolder.Items(ii)\n\n            ' Replace invalid characters with empty strings.\n            With RegExp\n                .Pattern = \"[^\\w\\.@-]\"\n                .IgnoreCase = True\n                .Global = True\n            End With\n\n            Subject = RegExp.Replace(Item.Subject, \" \")\n\n            FileName = FolderPath &amp; Subject &amp; \".msg\"\n            Item.SaveAs FileName, olMsg\n\n        Next ii\n    Next i\n\nEnd Sub\n\nPrivate Function GetFolder( _\n        Folders As Collection, _\n        EntryID As Collection, _\n        StoreID As Collection, _\n        Folder As MAPIFolder _\n)\n    Dim SubFolder As MAPIFolder\n        Folders.Add Folder.FolderPath\n        EntryID.Add Folder.EntryID\n        StoreID.Add Folder.StoreID\n\n        For Each SubFolder In Folder.Folders\n            GetFolder Folders, EntryID, StoreID, SubFolder\n            Debug.Print SubFolder.Name ' Immediate Window\n        Next SubFolder\n\n        Set SubFolder = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 5549471, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8505355e3bc442c16206e91ded112a33?s=128&d=identicon&r=PG&f=1", "display_name": "BigBoyB", "link": "https://stackoverflow.com/users/5549471/bigboyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 41782997, "answer_count": 1, "score": 0, "last_activity_date": 1593341939, "creation_date": 1484780389, "last_edit_date": 1593341939, "question_id": 41730984, "link": "https://stackoverflow.com/questions/41730984/outlook-extract-folders-with-e-mails-inside-them-to-local-hard-drive", "title": "Outlook extract folders with e-mails inside them to local hard drive", "body": "<p>Let's say I have a ton of folders which represent different categories of e-mails in Outlook. Each folder has at least one thousand e-mails. There's a high number of folders too. </p>\n\n<p>If I want to copy to the hard drive the folders with the exact names and files inside, it does not let me. </p>\n\n<p>I have to manually create a folder on the hard drive for each folder in Outlook and then copy all the e-mails within that folder. </p>\n\n<p>Any way to do this faster? Any VBA coding solution?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484781032, "post_id": 41730885, "comment_id": 70656518, "body": "How are you activating/using the workbooks/worksheets? Are you using <code>.Select</code> and <code>.Activate</code> to go between them? You can create workbook/worksheet variables to store that info...e.g. <code>Dim dataWB as Workbook</code> // <code>Dim mainDataWS as Worksheet</code> and go from there. What have you tried so far? The workbook name changing can be easily dealt with, but we&#39;d need a little more insight to how your macros work. If you can post the relevant parts of your code, it would help."}, {"owner": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484781920, "post_id": 41730885, "comment_id": 70656808, "body": "I am using <code>.Select</code> and <code>.Activate</code>  I am confused on if I can Dim workbooks and worksheets before they are opened.  And if I should place these codes in the Module or in the Worksheet of Workbook 1 where I have the Command Button sub.  <code>Dim wbk As Workbooks  Set wb2 = Active.wbk &#39;(Workbook 2) that is already open      &#39;~~&gt; Get the File MsgBox &quot;Locate MICROSTRATEGY REPORT&quot; Ret1 = Application.GetOpenFilename(&quot;Excel Files (*.xls*), *.xls*&quot;, _     , &quot;Please select file&quot;)          If Ret1 = False Then Exit Sub          wbk.Open (Ret1)   &#39;(workbook 3)&#39;           wb2.Activate</code>"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "edited": false, "score": 0, "creation_date": 1484782235, "post_id": 41731190, "comment_id": 70656897, "body": "Hi Pete. Thank you, I will certain give it a try. Should this be placed in the Command Button Click sub before it calls the macro, or does it have to be in the module itself?"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "edited": false, "score": 0, "creation_date": 1484783862, "post_id": 41731190, "comment_id": 70657409, "body": "I would place this in module itself, so each macro can be run indecently without using the button if required."}, {"owner": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "edited": false, "score": 0, "creation_date": 1484785986, "post_id": 41731190, "comment_id": 70657997, "body": "That worked beautifully.  I know these kind of things have been mentioned a zillion times, I just couldn&#39;t figure out how to apply it to my own needs. THANK YOU!"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "edited": false, "score": 0, "creation_date": 1484786234, "post_id": 41731190, "comment_id": 70658057, "body": "My pleasure Scott!"}], "tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": false, "score": 3, "last_activity_date": 1484781485, "creation_date": 1484781485, "answer_id": 41731190, "question_id": 41730885, "link": "https://stackoverflow.com/questions/41730885/working-between-multiple-active-workbooks/41731190#41731190", "title": "Working between multiple active workbooks", "body": "<p>You can for example do the following to dim books and sheets:</p>\n\n<p>First you need declares the workbooks:</p>\n\n<pre><code>Dim wbBook1 As Workbook\nDim wbBook2 As Workbook\n</code></pre>\n\n<p>Then you need to set each workbook (note that the second book is being opened while set:</p>\n\n<pre><code>Set wbBook1 = ThisWorkbook\nSet wbBook2 = Workbooks.Open(\"C:\\PERSONAL_FOLDER\\test.xlsm\")\n</code></pre>\n\n<p>In order to identify which sheets are you working with, you need to declare and set these as well:</p>\n\n<pre><code>Dim wsSheet1 As Worksheet\nDim wsSheet2 As Worksheet\nSet wsSheet1 = wbBook1.Worksheets(\"Sheet1\")\nSet wsSheet2 = wbBook2.Worksheets(\"Sheet1\")\n</code></pre>\n\n<p>Using wsSheet1 and wsSheet2 you can easily run macros that do something in your current workbook in sheet 1 and in workbook test in sheet 1. </p>\n\n<p>Once you are done using workbook test you can close it with the following command:</p>\n\n<pre><code>wbBook2.close \n</code></pre>\n\n<p>I hope this helps!</p>\n"}], "owner": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10793, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484867475, "creation_date": 1484779830, "last_edit_date": 1484867475, "question_id": 41730885, "link": "https://stackoverflow.com/questions/41730885/working-between-multiple-active-workbooks", "title": "Working between multiple active workbooks", "body": "<p>Macro 1 code is stored in Workbook 1. Command button 1 triggers opening a user selected workbook. Let's call that Workbook 2 (although the actual Workbook name is different each time). Macro 1 runs codes (mostly formatting commands) in Workbook 2.</p>\n\n<p>Macro 1 ends. Workbook 2 remains open. After some manual intervention by user on Workbook 2, user clicks Command button 2 in Workbook 1, which triggers Macro 2. </p>\n\n<p>Macro 2 starts by activating Workbook 2 again, running code. At one point, code says to Open another user selected Workbook. Let's call it Workbook 3 (again, filename can be different).  Then Macro 2 has codes that takes actions back in Workbook 2. Then goes back to Workbook 3.</p>\n\n<p>The problem I am having is I cannot figure out how to Dim each of these workbooks given the Workbook names/WorkSheet names change. Also, with new Workbooks being opened at different points, I am not sure which parts of which Modules I need to add code. </p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1484778217, "post_id": 41730481, "comment_id": 70655510, "body": "<code>row</code> and <code>column</code> should be <code>Long</code>."}, {"owner": {"reputation": 1624, "user_id": 2461854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47e730b86ab52e2857d82e1f3d9d6a43?s=128&d=identicon&r=PG", "display_name": "Tom Malkin", "link": "https://stackoverflow.com/users/2461854/tom-malkin"}, "edited": false, "score": 0, "creation_date": 1484793600, "post_id": 41730481, "comment_id": 70659910, "body": "I imagine Price could be equal to 0 at some point, blowing up stocks = money / price"}], "owner": {"reputation": 11, "user_id": 2267813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/982c0624397db14a08f645555c92fc8c?s=128&d=identicon&r=PG", "display_name": "federomano", "link": "https://stackoverflow.com/users/2267813/federomano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593679130, "creation_date": 1484778005, "last_edit_date": 1593679130, "question_id": 41730481, "link": "https://stackoverflow.com/questions/41730481/error-6-overflow-on-mac-vba", "title": "Error 6 Overflow on Mac VBA", "body": "<p>I'm receiving an Error 6: Overflow on Excel 2016 for Mac on this function. The error has something to do with the stocks variable, however the problem comes not when calculating stocks, but when y want to use it's value or show it with <code>Debug.Print()</code>. Any idea what could be happening?</p>\n\n<pre><code>Public row As Integer\nPublic column As Integer\nPublic price As Single\nPublic money As Single\nPublic stocks As Single\n\nSub simulateBuys()\n    stocks = 0\n    money = 100\n    ' I've reduced the function to be readable, the Call buy() agruments are calculated in other functions\n    Call buy(29, 6)\n    ' The problem appears here, when i want to use the result calculated in the buy() function\n    Worksheets(\"EMA 9 vs 26 Numeros\").Cells(4, 4).Value = stocks\nEnd Sub\n\nSub buy(ByRef row As Integer, ByRef column As Integer)\n    ' In this case, price happens to be 100\n    price = Worksheets(\"Price\").Cells(row, column).Value\n    ' The division is 100 / 100\n    stocks = money / price\n    Debug.Print \"done\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "forms", "ms-access"], "comments": [{"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "edited": false, "score": 0, "creation_date": 1484779332, "post_id": 41730356, "comment_id": 70655955, "body": "I figured out how to password protect it, but I assume this doesnt stop the user from actually editing the VB code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1484780867, "post_id": 41730356, "comment_id": 70656455, "body": "Rather than hard-coding a password in the VBA code, you could query Active Directory and determine whether the current authenticated user (you&#39;re on a network, right?) is in a user group that grants him access to the functionality. That way at least no password appears in plain text anywhere... but your user could always break execution and skip the procedure. Password-protecting the VBA code itself would alleviate that, but it&#39;s not impossible to crack either."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1484781034, "post_id": 41730356, "comment_id": 70656520, "body": "If querying AD is too cumbersome, just test if the user can access a folder that is access-controlled by AD, as a <i>proxy</i> for querying AD."}], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1484801677, "creation_date": 1484801677, "answer_id": 41734020, "question_id": 41730356, "link": "https://stackoverflow.com/questions/41730356/password-protecting-a-form/41734020#41734020", "title": "Password Protecting a Form", "body": "<p>Your Form_Open declaration is incorrect, it doesn't contain parameter. Should be like this:</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n</code></pre>\n"}], "owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593956828, "creation_date": 1484777471, "last_edit_date": 1593956828, "question_id": 41730356, "link": "https://stackoverflow.com/questions/41730356/password-protecting-a-form", "title": "Password Protecting a Form", "body": "<p>I am trying to password protect one of my forms but receive an error when launching the form. </p>\n\n<p>Here is the error I receive:</p>\n\n<p>The expression on Open you entered as the event property setting produced the following error: Procedure declaration does not much description of event or procedure having the same name.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Option Compare Database\n\n    Public Sub Form_Open()\n Cancel = (InputBox(\"Password?\") &lt;&gt; \"Cen\")\n\nEnd Sub\n\nPrivate Sub cmdImport_Click()\n\nOn Error GoTo Click_Err\n    If Nz(txtReportDate, \"\") = \"\" Then\n        MsgBox \"NOTICE! Please enter the Report Month you wish to Import.\"\n\n       Else\n\n   ' Dim rs As Recordset\n    'Dim sql As String\n\n    'Loop through recordset of all Contracts and import files\n   ' sql = \"SELECT DISTINCT FROM AAABBC_CE\"\n   ' Set rs = CurrentDb.OpenRecordset(sql)\n   ' rs.MoveLast\n  '  rs.MoveFirst\n   ' If rs.RecordCount &gt; 0 Then\n       ' Do While rs.EOF = False\n           ' ImportFile rs!DISTINCT\n           ' rs.MoveNext\n       ' Loop\n   ' End If\n\n    DoCmd.Hourglass True\n    DoCmd.SetWarnings False\n\n    DoCmd.Hourglass False\n    DoCmd.SetWarnings True\n    MsgBox \"Finished Importing!\"\n    DoCmd.OpenQuery \"query_Files_Loaded_CE\", acViewNormal, acReadOnly\n\nclick_Exit:\n    DoCmd.Hourglass False\n    DoCmd.SetWarnings True\n    Exit Sub\n\nClick_Err:\n    DoCmd.Hourglass False\n    MsgBox \"Error Detected: \" &amp; Err.Number &amp; \" - \" &amp; Err.Description, vbCritical, \"Error\"\n    Resume click_Exit\n\n       Exit Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1484777590, "post_id": 41730313, "comment_id": 70655246, "body": "What is &quot;do stuff&quot;?  It&#39;s pretty easy to get all the document text as a <code>String</code>, but whether that&#39;s useful depends on what you intend to do with it."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1484777875, "post_id": 41730313, "comment_id": 70655369, "body": "Use <code>For Each</code> loop instead of For loop"}, {"owner": {"reputation": 3838, "user_id": 1033684, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sKoNw.jpg?s=128&g=1", "display_name": "Rob Sedgwick", "link": "https://stackoverflow.com/users/1033684/rob-sedgwick"}, "edited": false, "score": 0, "creation_date": 1484779263, "post_id": 41730313, "comment_id": 70655923, "body": "Why do you need to load all these paragraphs into memory at one time? Do you need them all available at the same time? If you really have to, consider storing them in a database instead."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1484780490, "post_id": 41730313, "comment_id": 70656343, "body": "If that&#39;s your actual code then no wonder it doesn&#39;t work :) Please read how to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1484788080, "post_id": 41730313, "comment_id": 70658529, "body": "Most of the time stuff just loads into memory anyway without any explicit code to do so. Problem could be that you&#39;re <i>running out</i> of memory and it&#39;s doing the work on disk. If you go into task manager how much memory are you using?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7438030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54100719915c386c6e3b7f32a2001f05?s=128&d=identicon&r=PG&f=1", "display_name": "SDeGonge", "link": "https://stackoverflow.com/users/7438030/sdegonge"}, "edited": false, "score": 0, "creation_date": 1484782873, "post_id": 41731094, "comment_id": 70657092, "body": "Thanks.  I&#39;ll give it a shot.  Perhaps I wasn&#39;t clear enough with my request - 1st time posting here and half the pseudo code got lost.  Anyway, this sounds like what I was looking for so thanks for the suggestion."}, {"owner": {"reputation": 1, "user_id": 7438030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54100719915c386c6e3b7f32a2001f05?s=128&d=identicon&r=PG&f=1", "display_name": "SDeGonge", "link": "https://stackoverflow.com/users/7438030/sdegonge"}, "edited": false, "score": 0, "creation_date": 1484827946, "post_id": 41731094, "comment_id": 70675680, "body": "Outstanding!  Solved my problem. Looping on the collection is lightning fast...compared to the For/Next option. Thanks."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 3, "last_activity_date": 1484781007, "creation_date": 1484781007, "answer_id": 41731094, "question_id": 41730313, "link": "https://stackoverflow.com/questions/41730313/vba-slows-over-time-can-i-load-my-object-into-memory-to-speed-things-up/41731094#41731094", "title": "VBA slows over time - can I load my object into memory to speed things up?", "body": "<p>Word doesn't know the position of each paragraph, so when using <code>document.Paragraphs(1234)</code> it has to start searching from the first paragraph.\n That is why <code>For Each</code> would be much faster than <code>For</code>:</p>\n\n<pre><code>Dim p As Word.Paragraph\n\nFor Each p in document.Paragraphs\n    ' do stuff\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7438030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54100719915c386c6e3b7f32a2001f05?s=128&d=identicon&r=PG&f=1", "display_name": "SDeGonge", "link": "https://stackoverflow.com/users/7438030/sdegonge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1484784634, "creation_date": 1484777238, "last_edit_date": 1531164843, "question_id": 41730313, "link": "https://stackoverflow.com/questions/41730313/vba-slows-over-time-can-i-load-my-object-into-memory-to-speed-things-up", "title": "VBA slows over time - can I load my object into memory to speed things up?", "body": "<p>I'm running vba in excel to read paragraphs from a word document.  The code works fine, however, I'm reading 10000 paragraphs and by the time I get to the end the loop is crawling.  I wanted to try reading the word doc into memory then attempting the loop to see if it speeds up.  The thing is that I'm not sure how to do this. Any suggestions?</p>\n\n<p>Here is what I currently have</p>\n\n<pre><code>Set wdDoc = GetObject(wdFileName)\nSet myParas = wdDoc.Paragraphs\nParCount = myParas.Count\n\nFor X = 0 To ParCount  ' ParCount is 10,000\n    With myParas(X)\n        pLevel = .OutlineLevel\n    End With\nNext X\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19, "user_id": 7375251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c51493f8ba206a16b46bae0440b42f7?s=128&d=identicon&r=PG&f=1", "display_name": "BertG3", "link": "https://stackoverflow.com/users/7375251/bertg3"}, "reply_to_user": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1484777985, "post_id": 41730201, "comment_id": 70655416, "body": "I tried a lot of codes that I found on the internet but I don&#39;t succeed. I know that you expect more from me but I am not so comfortable with VBA. I saw this but this isn&#39;t time-based <a href=\"http://stackoverflow.com/questions/37037934/excel-macro-to-export-worksheet-as-csv-file-without-leaving-my-current-excel-sh\" title=\"excel macro to export worksheet as csv file without leaving my current excel sh\">stackoverflow.com/questions/37037934/&hellip;</a>"}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1484778101, "post_id": 41730201, "comment_id": 70655457, "body": "Please read the help center article on <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a question</a> on SO. SO is not here to do your work for you, only to help you with specific programming errors. A single line is not an appropriate question for SO."}, {"owner": {"reputation": 19, "user_id": 7375251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c51493f8ba206a16b46bae0440b42f7?s=128&d=identicon&r=PG&f=1", "display_name": "BertG3", "link": "https://stackoverflow.com/users/7375251/bertg3"}, "reply_to_user": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1484778255, "post_id": 41730201, "comment_id": 70655530, "body": "Okay I am very sorry. Thanks for your answer. I can program but not in VBA. I&#39;ll need fp hire someone to help me"}], "answers": [{"tags": [], "owner": {"reputation": 150, "user_id": 3980752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KzaOO.jpg?s=128&g=1", "display_name": "pylund", "link": "https://stackoverflow.com/users/3980752/pylund"}, "is_accepted": false, "score": 2, "last_activity_date": 1484825787, "last_edit_date": 1484825787, "creation_date": 1484825135, "answer_id": 41740628, "question_id": 41730201, "link": "https://stackoverflow.com/questions/41730201/code-to-automatically-save-data-from-excel-sheet-to-csv-file/41740628#41740628", "title": "Code to automatically save data from Excel sheet to CSV file", "body": "<p>Although this can be done in many different ways, this is what I'd do:</p>\n\n<p>1) Add the following sub to a new file. Let's call it \"auto.xlsb\"</p>\n\n<pre><code>Sub SaveRangeToCSV()\n\n    Dim rng As Range\n    Dim originWB As Workbook\n    Dim originWS As Worksheet\n    Dim newBook As Workbook\n    Dim newBookWS As Worksheet\n\n    'Open the file you want to copy the range from\n    Set originWB = Workbooks.Open(\"path_to_file_that_contains_the_range_you_want_to_copy.xlsx\")\n    Set originWS = ThisWorkbook.Sheets(\"name_of_the_sheet_where_the_range_is\")\n    Set rng = originWS.Range(\"A1:B10\")\n\n    'Add new workbook (csv file)\n    Workbooks.Add\n    Set newBook = ActiveWorkbook\n    Set newBookWS = newBook.Sheets(1)\n\n    'Copy range from origin to destination (csv file)\n    rng.Copy Destination:=newBookWS.Range(\"A1\")\n\n    'Save csv file\n    newBook.SaveAs Filename:=ThisWorkbook.Path &amp; \"\\output.csv\"\n\nEnd Sub\n</code></pre>\n\n<p>If you want to avoid the output.csv to be overwritten every 10 minutes, you could, for example, add current datetime to the filename like this:</p>\n\n<pre><code>'Save csv file\nnewBook.SaveAs Filename:=ThisWorkbook.Path &amp; \"\\output_\" &amp; Replace(Replace(Replace(Now, \"/\", \"\"), \":\", \"\"), \" \", \"\") &amp; \".csv\"\n</code></pre>\n\n<p>2) Add this code to Workbook_Open Sub (click ThisWorkbook sheet in VBA IDE, and select Workbook and Open from the dropdown) in auto.xlsb, and Save:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Call Module1.SaveRangeToCSV\n\nEnd Sub\n</code></pre>\n\n<p>Every time you doble-click to open the file, SaveRangeToCSV will be triggered and, hence, the csv created.</p>\n\n<p>3) Automating the execution of this file really depends on your preferences and the Operating System you are working on. I'm assuming your are on Windows, so the easiest way to do it would be creating a task in Windows' Task Scheduler which runs \"auto.xlsb\" every 10 minutes.</p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 19, "user_id": 7375251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c51493f8ba206a16b46bae0440b42f7?s=128&d=identicon&r=PG&f=1", "display_name": "BertG3", "link": "https://stackoverflow.com/users/7375251/bertg3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1965, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1484825787, "creation_date": 1484776640, "question_id": 41730201, "link": "https://stackoverflow.com/questions/41730201/code-to-automatically-save-data-from-excel-sheet-to-csv-file", "title": "Code to automatically save data from Excel sheet to CSV file", "body": "<p>Does there exist a code to for example save every hour the data from A1:B10 in sheet1 to a CSV file ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 1, "creation_date": 1484776618, "post_id": 41730137, "comment_id": 70654845, "body": "Does the formula work when you manually enter the formula into a cell?"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1484776766, "post_id": 41730137, "comment_id": 70654903, "body": "Try with <code>Range(&quot;L25&quot;).Formula = &quot;=SUM(IF(MOD(ROW(INDIRECT(L11:L &amp; ROW()-1)),2)=1,INDIRECT(L11:L &amp; ROW()-1),0))&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3839431, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bcc25b271cff62cd4bc5303849339afb?s=128&d=identicon&r=PG&f=1", "display_name": "duberry", "link": "https://stackoverflow.com/users/3839431/duberry"}, "edited": false, "score": 0, "creation_date": 1484843972, "post_id": 41730388, "comment_id": 70686874, "body": "Thank you. The original formula worked as an actual Excel formula, but I didn&#39;t know it needed to be edited a bit for VBA."}], "tags": [], "owner": {"reputation": 104, "user_id": 7214249, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/500d7f49fd67bb3abc3a42ea8187ba63?s=128&d=identicon&r=PG", "display_name": "Delete Me", "link": "https://stackoverflow.com/users/7214249/delete-me"}, "is_accepted": true, "score": 0, "last_activity_date": 1484777635, "creation_date": 1484777635, "answer_id": 41730388, "question_id": 41730137, "link": "https://stackoverflow.com/questions/41730137/excel-vba-formula-1004-object-or-application-defined-error/41730388#41730388", "title": "Excel VBA Formula - 1004 object or application defined error", "body": "<p>You need to get your quote marks &amp; brackets sorted, should be:</p>\n\n<pre><code>Range(\"L25\").Formula = \"=SUM(IF(MOD(ROW(INDIRECT(\"\"L11:L\"\"&amp;(ROW()-1))),2)=1,INDIRECT(\"\"L11:L\"\"&amp;(ROW()-1)),0))\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1484806896, "creation_date": 1484806896, "answer_id": 41735075, "question_id": 41730137, "link": "https://stackoverflow.com/questions/41730137/excel-vba-formula-1004-object-or-application-defined-error/41735075#41735075", "title": "Excel VBA Formula - 1004 object or application defined error", "body": "<p>When working with long complex formulas I like adding a FormulaString variable to help me debug (this way I can see better where the error is coming from).</p>\n\n<p>Also, there is no need to <code>Activate</code> the <code>Sheets(\"Totals\")</code>, and then placing the formula in Cell L25, you can do it directly with <code>Sheets(\"Totals\").Range(\"L25\").Formula</code>.</p>\n\n<p>My own preference, instead of starting to count how many <code>\"</code> , or <code>\"\"</code> , or maybe <code>\"\"\"\"</code> I need, I like working with <code>Chr(34)</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub OverrideCharge()\n\nDim FormStr As String\nTitle = \"Override Total Labor Cost\"\n\n'Ask user if they want to override\noverrideMsg = MsgBox(\"Override Total Labor Cost with 4-Hour Minimum Charge?\", vbYesNo, Title)\nIf overrideMsg = vbYes Then\n    ' use a String for Formula to help debug it (before trying to put it inside a cell)\n    FormStr = \"=SUM(IF(MOD(ROW(INDIRECT(\" &amp; Chr(34) &amp; \"L11:L\" &amp; Chr(34) &amp; \"&amp;ROW()-1)),2)=1,INDIRECT(\" &amp; Chr(34) &amp; \"L11:L\" &amp; Chr(34) &amp; \"&amp;ROW()-1),0))\"\n    Debug.Print FormStr '&lt;-- for debug only\n    Sheets(\"Totals\").Range(\"L25\").Formula = FormStr\nElse\n    overrideMsg = vbNo\n    Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 3839431, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bcc25b271cff62cd4bc5303849339afb?s=128&d=identicon&r=PG&f=1", "display_name": "duberry", "link": "https://stackoverflow.com/users/3839431/duberry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "accepted_answer_id": 41730388, "answer_count": 2, "score": 0, "last_activity_date": 1484806931, "creation_date": 1484776438, "last_edit_date": 1484806931, "question_id": 41730137, "link": "https://stackoverflow.com/questions/41730137/excel-vba-formula-1004-object-or-application-defined-error", "title": "Excel VBA Formula - 1004 object or application defined error", "body": "<p>I'm adding a macro to allow the user to change the formula in a cell.\nHere is the code that added to a module:</p>\n\n<pre><code>Sub OverrideCharge()\n\ntitle = \"Override Total Labor Cost\"\n\n'Ask user if they want to override\noverrideMsg = MsgBox(\"Override Total Labor Cost with 4-Hour Minimum Charge?\", vbYesNo, title)\nIf overrideMsg = vbYes Then\n    Sheets(\"Totals\").Activate\n    Range(\"L25\").Formula = \"=SUM(IF(MOD(ROW(INDIRECT(\"\"L11:L\"\"&amp;ROW()-1)),2)=1,INDIRECT(\"\"L11:L\"\"&amp;ROW()-1),0)))\"\nElse: overrideMsg = vbNo\n    Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I get the error when defining the <code>Range(\"L25\").Formula</code>. I don't know if it's a syntax error or if I'm referencing the sheet/cell incorrectly.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13883, "user_id": 6815131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c38385f9eb57b70176498fa5c3b4c99?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C", "link": "https://stackoverflow.com/users/6815131/joe-c"}, "edited": false, "score": 0, "creation_date": 1484777299, "post_id": 41729621, "comment_id": 70655132, "body": "Welcome to Stack Overflow! It looks like you need to learn to use a debugger.  Please help yourself to some <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">complementary debugging techniques</a>.  If you still have issues afterwards, please feel free to come back with more details."}, {"owner": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "reply_to_user": {"reputation": 13883, "user_id": 6815131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c38385f9eb57b70176498fa5c3b4c99?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C", "link": "https://stackoverflow.com/users/6815131/joe-c"}, "edited": false, "score": 0, "creation_date": 1484777695, "post_id": 41729621, "comment_id": 70655288, "body": "I don&#39;t want to be that new person that doesn&#39;t read and makes waves. I have read the debugging techniques article, and it is very informative. My code does not error out at any point, it is I guess, performing as expected. However, it is not doing what I have in mind."}, {"owner": {"reputation": 13883, "user_id": 6815131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c38385f9eb57b70176498fa5c3b4c99?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C", "link": "https://stackoverflow.com/users/6815131/joe-c"}, "edited": false, "score": 1, "creation_date": 1484777838, "post_id": 41729621, "comment_id": 70655356, "body": "I don&#39;t know if it&#39;s me being thick, but how can something be both &quot;performing as expected&quot; and &quot;not doing what I have in mind&quot;?"}, {"owner": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "reply_to_user": {"reputation": 13883, "user_id": 6815131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c38385f9eb57b70176498fa5c3b4c99?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C", "link": "https://stackoverflow.com/users/6815131/joe-c"}, "edited": false, "score": 0, "creation_date": 1484779182, "post_id": 41729621, "comment_id": 70655890, "body": "No, you&#39;re not at all. I&#39;m probably using the wrong terminology.  I certainly have zero ego in this world of programming. What I mean is, the code is doing exactly what it says to do. And I understand the logic it is using. So I&#39;m just obviously using the wrong code to begin with to do what I want.  Hopefully that makes sense?  Please don&#39;t hate me. I&#39;ve hesitated to sign up on the board until now because I&#39;ve been trying to find all the answers to all my issues on my own."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "edited": false, "score": 0, "creation_date": 1484776071, "post_id": 41729700, "comment_id": 70654579, "body": "So the problem I&#39;ve ran into using my current code but switching xlDown with xlUp, as well as trying what you suggested (thank you for the quick response)  is that it still highlights/colors from cell &quot;O2&quot; up to the header whether or not there are records found with the filter criteria. So I can&#39;t seem to block off the header"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "reply_to_user": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "edited": false, "score": 0, "creation_date": 1484831273, "post_id": 41729700, "comment_id": 70677871, "body": "You can&#39;t use your current code but switch xlDown to xlUp, that would always only give you O1:O2.  That&#39;s why I suggested checking that LastRow doesn&#39;t return the header."}], "tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 0, "last_activity_date": 1484774639, "creation_date": 1484774639, "answer_id": 41729700, "question_id": 41729621, "link": "https://stackoverflow.com/questions/41729621/vba-if-autofilter-returns-no-results-to-move-to-next/41729700#41729700", "title": "VBA - If autofilter returns no results to move to next", "body": "<p>You could change how you find the lastrow...instead of going down, start at the bottom and search up. </p>\n\n<pre><code>lastRow = Cells(Rows.Count, \"O\").End(xlUp).Row\n</code></pre>\n\n<p>You could add a check tho make sure it wasn't the header row if needed.</p>\n"}], "owner": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1248, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484774639, "creation_date": 1484774367, "last_edit_date": 1531164843, "question_id": 41729621, "link": "https://stackoverflow.com/questions/41729621/vba-if-autofilter-returns-no-results-to-move-to-next", "title": "VBA - If autofilter returns no results to move to next", "body": "<p>Sorry that this is a total noob post (there are more to come). Decided to take on some simple VBA projects at my work 2 weeks ago without any previous knowledge of VBA and this site has been a wealth of knowledge. I've built a successful macro or 2 but now I'm just fine tuning it.</p>\n\n<p>What I am trying to do:\nI have a Worksheet that varies in row count every time I receive it. I want to find (or possibly AutoFilter) a column for any cells that contains a certain word.  If that word exists, highlight the background color of that cell.</p>\n\n<p>The problem I am running into with my current code, is while it filters only to the lastRow of visible cells, if there are zero results, it selects and fills the cell after the last visible cell to the bottom of the sheet. So I wind up with a giant column of color.</p>\n\n<p>Been racking my brain on this for the past day.</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$AO$\" &amp; lastRow).AutoFilter Field:=15, Operator:= _\n    xlFilterValues, Criteria1:=(\"=*Repromotion*\")\n    lastRow = Range(\"O2\").End(xlDown).Row\n    Range(Range(\"O2\"), Range(\"O\" &amp; lastRow)).Select\n\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColor = 16777215\n    .Color = 16776960\n    .PatternTintAndShade = 0\nEnd With\n</code></pre>\n\n<p>Any help would be so greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484771879, "post_id": 41728961, "comment_id": 70652344, "body": "You can use <code>Debug.Print yourFunction()</code> to print the returned value in the immediate window.  Or simply <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).value = yourFunction()</code> to output it to A1 on Sheet1."}, {"owner": {"reputation": 2462, "user_id": 639580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/21b3041d664dd92d697bd3e0bca40fb7?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/639580/tony"}, "edited": false, "score": 0, "creation_date": 1484771886, "post_id": 41728961, "comment_id": 70652347, "body": "You can assign values to cells in VBA code.  What you&#39;re asking is a bit vague though."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6916838, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207261022554589/picture?type=large", "display_name": "Hanna Brooks", "link": "https://stackoverflow.com/users/6916838/hanna-brooks"}, "edited": false, "score": 1, "creation_date": 1484775611, "post_id": 41729308, "comment_id": 70654347, "body": "Thank you! The ActiveSheet.Range().Value was exactly what I was looking for"}], "tags": [], "owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "is_accepted": true, "score": 0, "last_activity_date": 1484773118, "creation_date": 1484773118, "answer_id": 41729308, "question_id": 41728961, "link": "https://stackoverflow.com/questions/41728961/assign-value-of-vba-functions-to-cells-in-excel/41729308#41729308", "title": "Assign value of VBA functions to cells in Excel", "body": "<p>You can do this in several different ways. Lets say \"SOMETHING\" represents your function or variable. </p>\n\n<p>-You can use a debug print to have it show in the in the bottom window of the VBA editor.</p>\n\n<pre><code>Debug.Print SOMETHING\n</code></pre>\n\n<p>-You could use a message box to have it pop up.</p>\n\n<pre><code>msgbox SOMETHING\n</code></pre>\n\n<p>-You could place it in a cell on your active sheet.</p>\n\n<pre><code>ActiveSheet.Range(\"A1\").Value = SOMETHING\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6916838, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207261022554589/picture?type=large", "display_name": "Hanna Brooks", "link": "https://stackoverflow.com/users/6916838/hanna-brooks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 0, "accepted_answer_id": 41729308, "answer_count": 1, "score": 0, "last_activity_date": 1484773118, "creation_date": 1484771720, "last_edit_date": 1531164843, "question_id": 41728961, "link": "https://stackoverflow.com/questions/41728961/assign-value-of-vba-functions-to-cells-in-excel", "title": "Assign value of VBA functions to cells in Excel", "body": "<p>I am trying to check that my VBA code is functioning properly. Is there a way to write the output of functions to cells so that I can see what values were calculated while the code ran? Looking through Google, it seems like this is not possible, or that it is very complicated.</p>\n"}, {"tags": ["vba", "excel", "save-as"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7390245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bc7984714a360471ead53376b2b283?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/7390245/bruce"}, "edited": false, "score": 0, "creation_date": 1484860457, "post_id": 41729201, "comment_id": 70696101, "body": "This works if you choose the desktop or documents as the save destination but trying to save to any other folder results in a &#39;file not found error&#39; at the &#39;Name TextFile As SaveName&#39; instruction. Any idea why this happens?"}], "tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 0, "last_activity_date": 1484772650, "creation_date": 1484772650, "answer_id": 41729201, "question_id": 41728937, "link": "https://stackoverflow.com/questions/41728937/save-as-box-for-excel-generated-text-files/41729201#41729201", "title": "Save As Box for Excel generated text files", "body": "<p>Doing this worked for me, no errors.</p>\n\n<pre><code>Sub testing()\nDim TextFile As String, PrintText As String\nDim SaveName As Variant\n\nTextFile = \"filename.txt\"\nPrintText = ActiveSheet.Range(\"A1\").Value\n\nOpen TextFile For Output As #1\n  Print #1, PrintText\n\nClose #1\n\nSaveName = Application.GetSaveAsFilename(, filefilter:=\"TXT (*.txt),*.txt\")\nIf SaveName &lt;&gt; False Then Name TextFile As SaveName\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7390245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bc7984714a360471ead53376b2b283?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/7390245/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 533, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484867558, "creation_date": 1484771626, "last_edit_date": 1484867558, "question_id": 41728937, "link": "https://stackoverflow.com/questions/41728937/save-as-box-for-excel-generated-text-files", "title": "Save As Box for Excel generated text files", "body": "<p>I'm trying to build a macro which takes text generated in a worksheet &amp; saves it to a text file. When run the user is prompted to save the text to a file using the Save As Dialog box. The problem is that if the user selects a location other than the default my documents folder, it does not actually save. If the macro is run a second time however before closing the workbook it works. I had to use <strong>On Error Resume Next</strong> to prevent an error box when the user does cancels the Save as box but if I comment this out the error when trying to save in a non-my docs location is <strong>error 53 file not found</strong>. Does anyone know whats going on here or how to fix this? Check my code below for simple illustration of error:</p>\n\n<pre><code>Sub saveFileAs()\nDim textFile, printText As String\n\ntextFile = \"filename.txt\"  'won't work without declaring something for textFile\n\nprintText = ActiveSheet.Range(\"A1\").Value\n\nOpen textFile For Output As #1\n    Print #1, printText\n\nClose #1\n\n\nOn Error Resume Next\n\nName textFile As Application.GetSaveAsFilename(, filefilter:=\"TXT (*.txt),*.txt\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 0, "creation_date": 1484772717, "post_id": 41728481, "comment_id": 70652835, "body": "Have you read the built-in help documentation (F1 key) or online version for the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196533.aspx\" rel=\"nofollow noreferrer\">Comment Object</a>?  If so, what is different between its example and your code?"}, {"owner": {"reputation": 11, "user_id": 7437522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb3cee2239fda5f610c2e0dedf057039?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7437522/alex"}, "reply_to_user": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 0, "creation_date": 1484819597, "post_id": 41728481, "comment_id": 70670500, "body": "I have read the documentation multiple times but it doesn&#39;t give any help with copying the comment. I think I may be missing something to do with objects. The error it pops up with is a Run-time error &#39;91&#39;: Object variable or With block variable not set."}], "owner": {"reputation": 11, "user_id": 7437522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb3cee2239fda5f610c2e0dedf057039?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7437522/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484784465, "creation_date": 1484769889, "last_edit_date": 1531161705, "question_id": 41728481, "link": "https://stackoverflow.com/questions/41728481/how-to-save-cell-comments-in-a-variable-and-apply-it-to-a-different-cell", "title": "How to Save Cell Comments in a variable and apply it to a different cell", "body": "<p>So I've been bashing my head against this problem for the past few days and can't find anything to help. I've been trying to copy cell comments from a varying range of cells. These comments would then be added to a new sheet.</p>\n\n<p>Below is a link to a picture of the data that will be captured (apparently I can't post images with a new account). The column on the far right is of interest. The code is supposed to only capture the cell to the left of the tickbox if the tickbox is checked. The entire process is carried out once the button is clicked. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Iogyq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Iogyq.png\" alt=\"http://i.imgur.com/ShixX3w.png\"></a></p>\n\n<p>The code that I think is the problem is below:</p>\n\n<pre><code>Dim start_tests As Long 'start of test selection\n    start_tests = 2\nDim end_tests As Long 'end of test selection\n    end_tests = 100\n\nDim tests_used(200) As Variant\nDim tests_indent(200) As Variant\nDim tests_font(200) As Variant\nDim tests_comments(20000) As Variant\n\n'Saving the selected tests to an array\nno_act_tests = 1\nFor i = start_tests To (end_tests)\n    If Range(\"N\" &amp; i) = True Then\n        tests_used(no_act_tests) = Range(\"M\" &amp; i)\n        tests_indent(no_act_tests) = Range(\"M\" &amp; i).IndentLevel\n        tests_font(no_act_tests) = Range(\"M\" &amp; i).Font.FontStyle\n        'Range(\"M\" &amp; i).Select\n        'tests_comments(no_act_tests) = Range(\"M\" &amp; i).SpecialCells(xlCellTypeComments).Select\n        tests_comments(no_act_tests) = Range(\"M\" &amp; i).Comment.Text '&lt;- Problem Code\n        no_act_tests = no_act_tests + 1\n    End If\nNext i\nno_act_tests = no_act_tests - 1\n</code></pre>\n\n<p>So all of that was done to hopefully save each cell's comment to an array for later use. Next a new sheet is created and the column can start being populated. The code below shows what I would use to populate the cell's comments:</p>\n\n<pre><code>'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Creating New Tab~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nWith ThisWorkbook\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = tab_name_desk\nEnd With\nEnd With\n\n '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Printing Template~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nWith Worksheets(tab_name_desk)\n\n  .Range(\"A1\").Value = \"Browser:\"\n  .Range(\"A2\").Value = \"Resolution:\"\n  .Range(\"A3\").Value = \"Page URL:\"\n  .Range(\"B3\").Value = url_name\n\n  'displaying all the tests to be done in the first column\n  For i = 1 To no_act_tests\n    .Range(\"A\" &amp; i + 3).Value = tests_used(i)\n    .Range(\"A\" &amp; i + 3).IndentLevel = tests_indent(i)\n    .Range(\"A\" &amp; i + 3).Font.FontStyle = tests_font(i)\n    'With .Range(\"A\" &amp; i + 3).AddComment\n        .Range(\"A\" &amp; i + 3).AddComment.Visible = False\n        .Range(\"A\" &amp; i + 3).AddComment = tests_comments(i)\n    'End With\n  Next i\n</code></pre>\n\n<p>The full code is below. It has all been tested and works fine except for the comment code. </p>\n\n<pre><code>Sub Create_Form()\nApplication.ScreenUpdating = False\n\nWith Worksheets(\"Setup\")\n\n'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Creating Variables~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nDim tab_name As String      'Creates tab_name as a variable\n    tab_name = Range(\"C1\").Value     'Stores the value from C1 in the tab_name variable\n    tab_name_mobile = tab_name + \" - Mobile\"\n    tab_name_desk = tab_name + \" - Desktop\"\nDim url_name As String      'Creates url_name as a variable\n    url_name = Range(\"C2\").Value     'Stores the value from C2 in the url_name variable\n\n\n'Indices\nDim start_browse_desk As Long 'start of desktop browser selection\n    start_browse_desk = 10\nDim end_browse_desk As Long 'end of desktop browser selection\n    end_browse_desk = 14\nDim start_res_desk As Long 'start of desktop resolutions selection\n    start_res_desk = 23\nDim end_res_desk As Long 'end of desktop resolutions selection\n    end_res_desk = 38\n\nDim start_browse_mobile As Long 'start of mobile browser selection\n    start_browse_mobile = 45\nDim end_browse_mobile As Long 'end of mobile browser selection\n    end_browse_mobile = 52\nDim start_res_mobile As Long 'start of mobile resolutions selection\n    start_res_mobile = 63\nDim end_res_mobile As Long 'end of mobile resolutions selection\n    end_res_mobile = 70\n\nDim start_tests As Long 'start of test selection\n    start_tests = 2\nDim end_tests As Long 'end of test selection\n    end_tests = 100\n\n'Arrays\nDim browsers_used_mobile(25) As Variant\nDim browsers_indent_mobile(25) As Variant\nDim browsers_font_mobile(25) As Variant\nDim res_used_mobile(25) As Variant\nDim res_indent_mobile(25) As Variant\nDim res_font_mobile(25) As Variant\n\nDim browsers_used_desk(25) As Variant\nDim browsers_indent_desk(25) As Variant\nDim browsers_font_desk(25) As Variant\nDim res_used_desk(25) As Variant\nDim res_indent_desk(25) As Variant\nDim res_font_desk(25) As Variant\n\nDim tests_used(200) As Variant\nDim tests_indent(200) As Variant\nDim tests_font(200) As Variant\nDim tests_comments(20000) As Variant\n\n '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Saving Selections~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n'Saving the selected desktop browsers to an array\nno_act_browsers_desk = 1\nFor i = start_browse_desk To (end_browse_desk)\n    If Range(\"B\" &amp; i) = True Then\n        browsers_used_desk(no_act_browsers_desk) = Range(\"A\" &amp; i)\n        browsers_indent_desk(no_act_browsers_desk) = Range(\"A\" &amp; i).IndentLevel\n        browsers_font_desk(no_act_browsers_desk) = Range(\"A\" &amp; i).Font.FontStyle\n        no_act_browsers_desk = no_act_browsers_desk + 1\n    End If\nNext i\nno_act_browsers_desk = no_act_browsers_desk - 1\n\n'Saving the selected desktop resolutions to an array\nno_act_res_desk = 1\nFor i = start_res_desk To (end_res_desk)\n    If Range(\"B\" &amp; i) = True Then\n        res_used_desk(no_act_res_desk) = Range(\"A\" &amp; i)\n        res_indent_desk(no_act_res_desk) = Range(\"A\" &amp; i).IndentLevel\n        res_font_desk(no_act_res_desk) = Range(\"A\" &amp; i).Font.FontStyle\n        no_act_res_desk = no_act_res_desk + 1\n    End If\nNext i\nno_act_res_desk = no_act_res_desk - 1\n\n'Saving the selected mobile browsers to an array\nno_act_browsers_mobile = 1\nFor i = start_browse_mobile To end_browse_mobile\n    If Range(\"B\" &amp; i) = True Then\n        browsers_used_mobile(no_act_browsers_mobile) = Range(\"A\" &amp; i)\n        browsers_indent_mobile(no_act_browsers_mobile) = Range(\"A\" &amp; i).IndentLevel\n        browsers_font_mobile(no_act_browsers_mobile) = Range(\"A\" &amp; i).Font.FontStyle\n        no_act_browsers_mobile = no_act_browsers_mobile + 1\n    End If\nNext i\nno_act_browsers_mobile = no_act_browsers_mobile - 1\n\n'Saving the selected mobile resolutions to an array\nno_act_res_mobile = 1\nFor i = start_res_mobile To (end_res_mobile)\n    If Range(\"B\" &amp; i) = True Then\n        res_used_mobile(no_act_res_mobile) = Range(\"A\" &amp; i)\n        res_indent_mobile(no_act_res_mobile) = Range(\"A\" &amp; i).IndentLevel\n        res_font_mobile(no_act_res_mobile) = Range(\"A\" &amp; i).Font.FontStyle\n        no_act_res_mobile = no_act_res_mobile + 1\n    End If\nNext i\nno_act_res_mobile = no_act_res_mobile - 1\n\n'Saving the selected tests to an array\nno_act_tests = 1\nFor i = start_tests To (end_tests)\n    If Range(\"N\" &amp; i) = True Then\n        tests_used(no_act_tests) = Range(\"M\" &amp; i)\n        tests_indent(no_act_tests) = Range(\"M\" &amp; i).IndentLevel\n        tests_font(no_act_tests) = Range(\"M\" &amp; i).Font.FontStyle\n        Range(\"M\" &amp; i).Select\n        'tests_comments(no_act_tests) = Range(\"M\" &amp; i).SpecialCells(xlCellTypeComments).Select\n        tests_comments(no_act_tests) = ActiveCell.Comment.Text\n        no_act_tests = no_act_tests + 1\n    End If\nNext i\nno_act_tests = no_act_tests - 1\n'ActiveCell.Value = browsers_used(1)\n\n\n'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Creating New Tab~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nWith ThisWorkbook\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = tab_name_desk\nEnd With\nEnd With\n\n '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Printing Template~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nWith Worksheets(tab_name_desk)\n\n.Range(\"A1\").Value = \"Browser:\"\n.Range(\"A2\").Value = \"Resolution:\"\n.Range(\"A3\").Value = \"Page URL:\"\n.Range(\"B3\").Value = url_name\n\n'displaying all the tests to be done in the first column\nFor i = 1 To no_act_tests\n    .Range(\"A\" &amp; i + 3).Value = tests_used(i)\n    .Range(\"A\" &amp; i + 3).IndentLevel = tests_indent(i)\n    .Range(\"A\" &amp; i + 3).Font.FontStyle = tests_font(i)\n    'With .Range(\"A\" &amp; i + 3).AddComment\n        .Range(\"A\" &amp; i + 3).AddComment.Visible = False\n        .Range(\"A\" &amp; i + 3).AddComment = tests_comments(i)\n    'End With\nNext i\n\nk = 1\nFor i = 1 To no_act_browsers_desk\n    .Cells(1, ((i - 1) * k) + 2).Value = browsers_used_desk(i) 'displaying the browsers\n    .Cells(1, ((i - 1) * k) + 2).IndentLevel = browsers_indent_desk(i)\n    .Cells(1, ((i - 1) * k) + 2).Font.FontStyle = browsers_font_desk(i)\n    .Range(.Cells(1, ((i - 1) * k) + 2), .Cells(1, ((i - 1) * k) + 1 + no_act_res_desk)).Merge\n    k = no_act_res_desk\n    For j = 1 To no_act_res_desk\n        .Cells(2, ((i - 1) * k) + 1 + j).Value = res_used_desk(j) 'displaying the resolutions\n        .Cells(2, ((i - 1) * k) + 1 + j).IndentLevel = res_indent_desk(j)\n        .Cells(2, ((i - 1) * k) + 1 + j).Font.FontStyle = res_font_desk(j)\n    Next j\nNext i\nEnd With\n\n'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Formatting~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nWith Sheets(Sheets.Count)\n\n  Cells.Select\n  Cells.EntireColumn.AutoFit\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_desk * no_act_res_desk + 1)).Select\n'------------------------------------Conditional Format 'n'------------------\n\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_desk * no_act_res_desk + 1)).FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _\n    Formula1:=\"=\"\"n\"\"\"\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_desk * no_act_res_desk + 1)).FormatConditions(Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_desk * no_act_res_desk + 1)).FormatConditions.Count).SetFirstPriority\n  With Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_desk * no_act_res_desk + 1)).FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 13551615\n    .TintAndShade = 0\n  End With\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_desk * no_act_res_desk + 1)).FormatConditions(1).StopIfTrue = False\n\n'------------------------------------Conditional Format 'y'------------------\n\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_desk * no_act_res_desk + 1)).FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _\n    Formula1:=\"=\"\"y\"\"\"\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_desk * no_act_res_desk + 1)).FormatConditions(Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_desk * no_act_res_desk + 1)).FormatConditions.Count).SetFirstPriority\n  With Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_desk * no_act_res_desk + 1)).FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 13561798\n    .TintAndShade = 0\n  End With\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_desk * no_act_res_desk + 1)).FormatConditions(1).StopIfTrue = False\n    '------------------------------------Freezing Panes-------------------------\n\n  With ActiveWindow\n    .SplitColumn = 1\n    .SplitRow = 3\n    .FreezePanes = True\n  End With\nEnd With\n'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Creating New Tab~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nWith ThisWorkbook\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = tab_name_mobile\nEnd With\n'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Printing Template~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nWith Worksheets(tab_name_mobile)\n\n  .Range(\"A1\").Value = \"Browser:\"\n  .Range(\"A2\").Value = \"Resolution:\"\n  .Range(\"A3\").Value = \"Page URL:\"\n  .Range(\"B3\").Value = url_name\n\n  'displaying all the tests to be done in the first column\n  For i = 1 To no_act_tests\n    .Range(\"A\" &amp; i + 3).Value = tests_used(i)\n    .Range(\"A\" &amp; i + 3).IndentLevel = tests_indent(i)\n    .Range(\"A\" &amp; i + 3).Font.FontStyle = tests_font(i)\n    '.Range(\"A\" &amp; i + 3).AddComment.Text = tests_comments(i)\n  Next i\n\n  k = 1\n  For i = 1 To no_act_browsers_mobile\n    .Cells(1, ((i - 1) * k) + 2).Value = browsers_used_mobile(i) 'displaying the browsers\n    .Cells(1, ((i - 1) * k) + 2).IndentLevel = browsers_indent_mobile(i)\n    .Cells(1, ((i - 1) * k) + 2).Font.FontStyle = browsers_font_mobile(i)\n    .Range(.Cells(1, ((i - 1) * k) + 2), .Cells(1, ((i - 1) * k) + 1 + no_act_res_mobile)).Merge\n    k = no_act_res_mobile\n    For j = 1 To no_act_res_mobile\n        .Cells(2, ((i - 1) * k) + 1 + j).Value = res_used_mobile(j) 'displaying the resolutions\n        .Cells(2, ((i - 1) * k) + 1 + j).IndentLevel = res_indent_mobile(j)\n        .Cells(2, ((i - 1) * k) + 1 + j).Font.FontStyle = res_font_mobile(j)\n    Next j\n  Next i\nEnd With\n\n'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Formatting~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nWith Sheets(Sheets.Count)\n\n  Cells.Select\n  Cells.EntireColumn.AutoFit\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_mobile * no_act_res_mobile + 1)).Select\n'------------------------------------Conditional Format 'n'------------------\n\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_mobile * no_act_res_mobile + 1)).FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _\n    Formula1:=\"=\"\"n\"\"\"\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_mobile * no_act_res_mobile + 1)).FormatConditions(Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_mobile * no_act_res_mobile + 1)).FormatConditions.Count).SetFirstPriority\n  With Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_mobile * no_act_res_mobile + 1)).FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 13551615\n    .TintAndShade = 0\n  End With\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_mobile * no_act_res_mobile + 1)).FormatConditions(1).StopIfTrue = False\n\n'------------------------------------Conditional Format 'y'------------------\n\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_mobile * no_act_res_mobile + 1)).FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _\n    Formula1:=\"=\"\"y\"\"\"\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_mobile * no_act_res_mobile + 1)).FormatConditions(Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_mobile * no_act_res_mobile + 1)).FormatConditions.Count).SetFirstPriority\n  With Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_mobile * no_act_res_mobile + 1)).FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 13561798\n    .TintAndShade = 0\n  End With\n  Range(\"B4\", .Cells(3 + no_act_tests, no_act_browsers_mobile * no_act_res_mobile + 1)).FormatConditions(1).StopIfTrue = False\n'------------------------------------Freezing Panes-------------------------\n\n  With ActiveWindow\n    .SplitColumn = 1\n    .SplitRow = 3\n    .FreezePanes = True\n  End With\n\n  Application.ScreenUpdating = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be much appreciated. Please let me know if there is anything else I should add. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1484770387, "post_id": 41728465, "comment_id": 70651622, "body": "thanks but how are you acquiring the workbook name in the first instance in order to capitalise it?"}, {"owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "reply_to_user": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1484771084, "post_id": 41728465, "comment_id": 70651973, "body": "@user7415328 I have implemented my code into your code. Please let me know if this is what you&#39;re looking for."}], "tags": [], "owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "is_accepted": false, "score": 0, "last_activity_date": 1484771004, "last_edit_date": 1484771004, "creation_date": 1484769834, "answer_id": 41728465, "question_id": 41728284, "link": "https://stackoverflow.com/questions/41728284/reference-workbook-where-it-contains-specific-text-in-filename/41728465#41728465", "title": "Reference workbook where it contains specific text in filename?", "body": "<p>Implement something like this into your code to uppercase your slave workbook name, and then checks to see if it contains \"DEPOT MEMO\".</p>\n\n<pre><code>    Sub Example()\n        Dim IncomingWBName As String\n        IncomingWBName = \"Drinks DEPOT Memo\" 'Set incoming name\n        IncomingWBName = UCase(IncomingWBName) 'Set all to uppercase\n        If InStr(IncomingWBName, \"DEPOT MEMO\") &gt; 0 Then 'In String?\n            MsgBox \"Contains DEPOT MEMO\"\n            'Do something\n        Else\n            MsgBox \"Doesn't contain DEPOT MEMO\"\n            'Do Something else\n        End If\n    End Sub\n</code></pre>\n\n<p>---Implemented into your code---</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim oCell As Range, targetCell As Range\n    Dim ws2 As Worksheet\n\n    If Not Intersect(Target, Range(\"I:I\")) Is Nothing Then ' &lt;-- run this code only if a value in column I has changed\n        If Not GetWb(ws2) Then Exit Sub\n\n        With ws2\n            For Each targetCell In Target\n                Set oCell = .Range(\"J1\", .Cells(.Rows.Count, \"J\").End(xlUp)).Find(what:=targetCell.Value, LookIn:=xlValues, lookat:=xlWhole)\n                If Not oCell Is Nothing Then\n                    Application.EnableEvents = False\n                    targetCell.Offset(0, 1).Value = oCell.Offset(0, -3)\n                     targetCell.Offset(0, 2).Value = oCell.Offset(0, 8)\n\n                    Application.EnableEvents = True\n                End If\n            Next\n        End With\n    End If\nEnd Sub\n\nFunction GetWb(ws As Worksheet) As Boolean\n    Dim wb As Workbook\n    For Each wb In Workbooks\n        If InStr(UCase(wb.Name), \"DEPOT MEMO\") &gt; 0 Then '&lt;-- check if workbook name contains \"DEPOT MEMO\"\n            Set ws = wb.Worksheets(1)\n            Exit For\n        End If\n    Next\n    GetWb = Not ws Is Nothing\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1484775545, "post_id": 41728763, "comment_id": 70654312, "body": "@ManishChristian it says i cannot until 2 days from now"}], "tags": [], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "is_accepted": false, "score": 1, "last_activity_date": 1484770900, "creation_date": 1484770900, "answer_id": 41728763, "question_id": 41728284, "link": "https://stackoverflow.com/questions/41728284/reference-workbook-where-it-contains-specific-text-in-filename/41728763#41728763", "title": "Reference workbook where it contains specific text in filename?", "body": "<p>I figured out the answer, and its relatively simple.</p>\n\n<p>All that needs to be added to the top of the module is:</p>\n\n<pre><code> Option Compare Text\n</code></pre>\n\n<p>This essentially removes the case sensitivity </p>\n\n<p>Full Code</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim oCell As Range, targetCell As Range\n    Dim ws2 As Worksheet\n\n    If Not Intersect(Target, Range(\"I:I\")) Is Nothing Then ' &lt;-- run this code only if a value in column I has changed\n        If Not GetWb(\"Depot Memo\", ws2) Then Exit Sub\n\n        With ws2\n            For Each targetCell In Target\n                Set oCell = .Range(\"J1\", .Cells(.Rows.Count, \"J\").End(xlUp)).Find(what:=targetCell.Value, LookIn:=xlValues, lookat:=xlWhole)\n                If Not oCell Is Nothing Then\n                    Application.EnableEvents = False\n                    targetCell.Offset(0, 1).Value = oCell.Offset(0, -3)\n                     targetCell.Offset(0, 2).Value = oCell.Offset(0, 8)\n\n                    Application.EnableEvents = True\n                End If\n            Next\n        End With\n    End If\nEnd Sub\n\nFunction GetWb(wbNameLike As String, ws As Worksheet) As Boolean\n    Dim wb As Workbook\n    For Each wb In Workbooks\n        If wb.Name Like \"*\" &amp; wbNameLike &amp; \"*\" Then '&lt;-- check if workbook name contains \"Depot Memo\"\n            Set ws = wb.Worksheets(1)\n            Exit For\n        End If\n    Next\n    GetWb = Not ws Is Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1602271668, "creation_date": 1484769200, "last_edit_date": 1602271668, "question_id": 41728284, "link": "https://stackoverflow.com/questions/41728284/reference-workbook-where-it-contains-specific-text-in-filename", "title": "Reference workbook where it contains specific text in filename?", "body": "<p>I have had help from @user3598756 with this code.</p>\n<p>I am trying to copy values from my slave workbook to my master workbook.</p>\n<p>My slave workbook can change name from time to time, but will always include 'depot memo' or 'Depot Memo' in the title.</p>\n<pre><code>Food Depot Memo\nDRINKS DEPOT MEMO\nBakery depot memo 123\n</code></pre>\n<p>So far I have the below code which works if the filename contains 'Depot Memo' with capital letters.</p>\n<p>However, this code doesn't work if the 'depot memo' is in lower case.</p>\n<p>Code:</p>\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim oCell As Range, targetCell As Range\n    Dim ws2 As Worksheet\n\n    If Not Intersect(Target, Range(&quot;I:I&quot;)) Is Nothing Then ' &lt;-- run this code only if a value in column I has changed\n        If Not GetWb(&quot;Depot Memo&quot;, ws2) Then Exit Sub\n\n        With ws2\n            For Each targetCell In Target\n                Set oCell = .Range(&quot;J1&quot;, .Cells(.Rows.Count, &quot;J&quot;).End(xlUp)).Find(what:=targetCell.Value, LookIn:=xlValues, lookat:=xlWhole)\n                If Not oCell Is Nothing Then\n                    Application.EnableEvents = False\n                    targetCell.Offset(0, 1).Value = oCell.Offset(0, -3)\n                     targetCell.Offset(0, 2).Value = oCell.Offset(0, 8)\n                   \n                    Application.EnableEvents = True\n                End If\n            Next\n        End With\n    End If\nEnd Sub\n\nFunction GetWb(wbNameLike As String, ws As Worksheet) As Boolean\n    Dim wb As Workbook\n    For Each wb In Workbooks\n        If wb.Name Like &quot;*&quot; &amp; wbNameLike &amp; &quot;*&quot; Then '&lt;-- check if workbook name contains &quot;Depot Memo&quot;\n            Set ws = wb.Worksheets(1)\n            Exit For\n        End If\n    Next\n    GetWb = Not ws Is Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1484769035, "post_id": 41728213, "comment_id": 70650852, "body": "that is not VB.NET code.  There is no <code>DoCmd</code>.  You probably want the <code>access-vba</code> tag"}, {"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1484769109, "post_id": 41728213, "comment_id": 70650881, "body": "@Plutonix fixed, thank you sir!"}, {"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 1, "creation_date": 1484772187, "post_id": 41728213, "comment_id": 70652496, "body": "You should consider using a ComboBox instead of a textbox. Build it to get it&#39;s values from the table containing your valid CN#s. In the ComboBox properties, set &#39;Limit To List&#39; to Yes."}, {"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "reply_to_user": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1484773655, "post_id": 41728213, "comment_id": 70653357, "body": "@tlemaster thank you for the response. Could you possible guide me or provide me with some sort of source so I can follow?"}, {"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "reply_to_user": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1484777984, "post_id": 41728213, "comment_id": 70655414, "body": "@tlemaster I Just setup the combo box and I really like it. How do I add restrictions to the combo box? Such as, user must enter something between 5 to 12 characters,"}, {"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 1, "creation_date": 1484777985, "post_id": 41728213, "comment_id": 70655417, "body": "This explains better than I could: <a href=\"https://support.office.com/en-us/article/Create-a-list-of-choices-by-using-a-list-box-or-combo-box-70abf4a9-0439-4885-9099-b9fa83517603#__toc356995226\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1484778675, "post_id": 41728213, "comment_id": 70655696, "body": "Look at adding a validation rule and validation text to your combo box."}], "answers": [{"tags": [], "owner": {"reputation": 273, "user_id": 6490191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/892b65d788a19cd018c74394494fc302?s=128&d=identicon&r=PG&f=1", "display_name": "Steve W", "link": "https://stackoverflow.com/users/6490191/steve-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1484864928, "creation_date": 1484864928, "answer_id": 41752895, "question_id": 41728213, "link": "https://stackoverflow.com/questions/41728213/vb-ms-access-validation-for-textbox/41752895#41752895", "title": "VB-MS Access Validation for textbox", "body": "<p>You can add a DCOUNT function to test the input text before proceeding with your code.  If the count returns 0 then you can assume there are no records that meet the criteria entered.</p>\n\n<pre><code>Private Sub cmdSearch_Click()\n    If Nz(txtCN, \"\") &lt;&gt; \"\" Then\n\n        If DCount(\"fldField\", \"tblTable\", \"fldField = \" &amp; txtCN) &gt; 0 Then\n             DoCmd.OpenQuery \"querySearchCN_CE\", acViewNormal, acReadOnly\n            'DoCmd.OpenQuery \"query_CO_CE\", acViewNormal, acReadOnly\n            'DoCmd.OpenQuery \"querySearchCN_2010_2015_CE\", acViewNormal, acReadOnly\n            'DoCmd.OpenQuery \"querySearchCN_2016_CE\", acViewNormal, acReadOnly\n        Else\n            MsgBox \"You have entered an invalid CN #\"\n        End If\n    Else\n       'If Nz(txtReportDate, \"\") = \"\" Then\n        MsgBox \"NOTICE! Please enter a CN #\"\n        Exit Sub\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594023013, "creation_date": 1484768969, "last_edit_date": 1594023013, "question_id": 41728213, "link": "https://stackoverflow.com/questions/41728213/vb-ms-access-validation-for-textbox", "title": "VB-MS Access Validation for textbox", "body": "<p>I have the following vb code setup on one of my forms. I setup a text box where a user can search by a CN number but I am running into an issue. If the user does not enter anything in the textbox and they click search, they are prompted to enter a CN# (Which is what I want). If the user enters a CN #, my query will find that CN# with its detail (Which is what I want). Where my issue lies is if the user types in a incorrect CN#, the query will still pop up, but the query table is empty. I am trying to setup a validation field that restricts what can be typed in or lets the user know that the CN# they typed is incorrect.</p>\n\n<pre><code>Private Sub cmdSearch_Click()\n    If Nz(txtCN, \"\") &lt;&gt; \"\" Then\n         DoCmd.OpenQuery \"querySearchCN_CE\", acViewNormal, acReadOnly\n        'DoCmd.OpenQuery \"query_CO_CE\", acViewNormal, acReadOnly\n        'DoCmd.OpenQuery \"querySearchCN_2010_2015_CE\", acViewNormal, acReadOnly\n        'DoCmd.OpenQuery \"querySearchCN_2016_CE\", acViewNormal, acReadOnly\n    Else\n       'If Nz(txtReportDate, \"\") = \"\" Then\n        MsgBox \"NOTICE! Please enter a CN #\"\n        Exit Sub\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1484768775, "post_id": 41728139, "comment_id": 70650712, "body": "VB.NET &lt;&gt; vba and doesnt do macros.  please remove the tag"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1484770482, "post_id": 41728139, "comment_id": 70651663, "body": "okay, what is wrong with you code?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484772214, "post_id": 41728139, "comment_id": 70652512, "body": "Take out the <code>On Error Resume Next</code> and let us know what (if any) error is thrown, and at what line."}, {"owner": {"reputation": 23, "user_id": 7421433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0843b12a5ca084c9d0530ffd39f8104?s=128&d=identicon&r=PG&f=1", "display_name": "Denny", "link": "https://stackoverflow.com/users/7421433/denny"}, "edited": false, "score": 0, "creation_date": 1484773806, "post_id": 41728139, "comment_id": 70653424, "body": "I try taking out On Error Resume Next , but nothing happens. No errors and no reaction."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1484775577, "post_id": 41728139, "comment_id": 70654327, "body": "Use &lt;kbd&gt;F8&lt;/kbd&gt; key to debug and see where is the issue."}, {"owner": {"reputation": 23, "user_id": 7421433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0843b12a5ca084c9d0530ffd39f8104?s=128&d=identicon&r=PG&f=1", "display_name": "Denny", "link": "https://stackoverflow.com/users/7421433/denny"}, "edited": false, "score": 0, "creation_date": 1484803983, "post_id": 41728139, "comment_id": 70662847, "body": "The issue lies in the following 3 lines of codes:                                                                                                                       &#39;If (Cells((i + 1), 3).Value) = &quot;yes&quot; Then                                                                                                            &#39;End If &#39;Next"}], "owner": {"reputation": 23, "user_id": 7421433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0843b12a5ca084c9d0530ffd39f8104?s=128&d=identicon&r=PG&f=1", "display_name": "Denny", "link": "https://stackoverflow.com/users/7421433/denny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484775380, "creation_date": 1484768710, "last_edit_date": 1484775380, "question_id": 41728139, "link": "https://stackoverflow.com/questions/41728139/need-to-copy-paste-to-another-workbook-if-each-row-in-specific-column-contains", "title": "Need to copy paste to another Workbook if each row in specific column contains &quot;yes&quot;", "body": "<p>I am trying to create a macro, which looks through column \"C\" and in each Row in column \"C\" that contains \"yes\", then the file with the link in \"B2\" should automatically be opened and the text in \"F2\" should be copied and pasted as values in the opened file in Range \"I2\" and afterwards the file should be saved with the new filename which it takes from \"H2\" and then the file should finally be closed.</p>\n\n<p>Below is the macro i tried, but unsuccessfully.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WhE2f.png\" rel=\"nofollow noreferrer\">Sample File</a></p>\n\n<pre><code>Sub Copy()\n\nDim SWB As Workbook\nDim TWB As Workbook\nDim NewFileName As String\nDim OldFileName As String\nDim rng As Range\nDim row As Range\n\nSet SWB = ThisWorkbook\nSet SWS = SWB.Sheets(\"Sheet1\")\n\nNewFileName = Range(\"H2\").Value\nOldFileName = Range(\"B2\").Value\n\nresponse = MsgBox(\"Have you reviewed the files? This is a     notification.\", vbYesNo, \"Confirmation\")\nIf response = vbNo Then\nExit Sub\nEnd If\n\nApplication.ScreenUpdating = 0\n\nSet rng = Range(\"A1:Q500\")\n\nFor Each row In rng.Rows\n\nIf (Cells((i + 1), 3).Value) = \"yes\" Then\n\nOn Error Resume Next\n\nWith SWS.Range(\"F2\").Copy\nEnd With\n\nSet TWB = Workbooks.Open(OldFileName)\nWith TWB.Sheets(\"CFF 12M\")\n.Range(\"I2\").PasteSpecial Paste:=xlPasteValues\nEnd With\n\n\nTWB.SaveAs filename:=NewFileName\n\nApplication.CutCopyMode = False\nTWB.Close Savechanges = True\n\nEnd If\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7437536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e58b1896895effbb6da4abd09424c33?s=128&d=identicon&r=PG&f=1", "display_name": "Nafferly", "link": "https://stackoverflow.com/users/7437536/nafferly"}, "edited": false, "score": 0, "creation_date": 1484843540, "post_id": 41730893, "comment_id": 70686598, "body": "Thank you! I implemented your code in mine, but I&#39;m still running into issues. &quot;Count5s&quot; is the text header at the top of my column, and is not defined in any other way. I need the code to find the number below that text header, determine if it&#39;s a StraightLiner or not, and then move on to the next cell below it and do the same thing. I have a relative range in which this needs to be done, starting from the Offset cell below &quot;Count5s&quot;. The first &quot;Set cellFound&quot; condition is throwing an &quot;Object required&quot; error. I&#39;m pretty new to VBA, so thank you for your help!"}, {"owner": {"reputation": 3838, "user_id": 1033684, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sKoNw.jpg?s=128&g=1", "display_name": "Rob Sedgwick", "link": "https://stackoverflow.com/users/1033684/rob-sedgwick"}, "reply_to_user": {"reputation": 3, "user_id": 7437536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e58b1896895effbb6da4abd09424c33?s=128&d=identicon&r=PG&f=1", "display_name": "Nafferly", "link": "https://stackoverflow.com/users/7437536/nafferly"}, "edited": false, "score": 0, "creation_date": 1484844792, "post_id": 41730893, "comment_id": 70687435, "body": "Have a look at a new version of the code I have posted up, You need to search for the header text and then move down matching cells until you hit an empty cell. You need to figure out how the Debugger works so you can fix this stuff."}], "tags": [], "owner": {"reputation": 3838, "user_id": 1033684, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sKoNw.jpg?s=128&g=1", "display_name": "Rob Sedgwick", "link": "https://stackoverflow.com/users/1033684/rob-sedgwick"}, "is_accepted": true, "score": 0, "last_activity_date": 1484844734, "last_edit_date": 1484844734, "creation_date": 1484779861, "answer_id": 41730893, "question_id": 41728072, "link": "https://stackoverflow.com/questions/41728072/how-to-apply-conditional-formatting-across-a-whole-column-in-vba/41730893#41730893", "title": "How to apply conditional formatting across a whole column in VBA", "body": "<p>You need to write a loop which does Find and then FindNext to keep the search going. I have not tested this code but I'd write something along these lines:</p>\n\n<pre><code>Dim TotalHooks As Integer\nDim StraightLiner As Integer\nDim row As Long\nDim curCell As Range\n\n\nCells.Find(What:=\"TotalHookCount\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Offset(1, 0).Activate\n\nTotalHooks = ActiveCell.Value\n\nStraightLiner = TotalHooks - 1\n\nDim cellFound As Range\nSet cellFound = Cells.Find(What:=\"Count5s\", After:=ActiveCell, LookIn:=xlFormulas, _\nLookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\nMatchCase:=False, SearchFormat:=False)\nrow = 1\nIf Not cellFound Is Nothing Then\n    Do While Not IsEmpty(cellFound.Offset(row, 0))\n        Set curCell = cellFound.Offset(row, 0)\n        If curCell = StraightLiner Then\n        With curCell.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .ThemeColor = xlThemeColorAccent4\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n        With curCell.Font\n            .ThemeColor = xlThemeColorDark1\n            .TintAndShade = 0\n        End With\n        End If\n        row = row + 1\n    Loop\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7437536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e58b1896895effbb6da4abd09424c33?s=128&d=identicon&r=PG&f=1", "display_name": "Nafferly", "link": "https://stackoverflow.com/users/7437536/nafferly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 41730893, "answer_count": 1, "score": 0, "last_activity_date": 1484844734, "creation_date": 1484768478, "question_id": 41728072, "link": "https://stackoverflow.com/questions/41728072/how-to-apply-conditional-formatting-across-a-whole-column-in-vba", "title": "How to apply conditional formatting across a whole column in VBA", "body": "<p>So, I am trying to code a macro that will allow me to find a value within a spreadsheet, store it as a variable called \"TotalHooks\", and then color the values purple in a different column, \"Count5s\", if they are equal to (TotalHooks - 1). I've gotten it to successfully locate and apply this conditioning to the first cell in the \"Count5s\" column, but don't know how to get that formula condition to apply correctly to the rest of the numbers in the column. Here's my code:</p>\n\n<pre><code>Dim TotalHooks As Integer\nDim StraightLiner As Integer\n\nCells.Find(What:=\"TotalHookCount\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Offset(1, 0).Activate\n\nTotalHooks = ActiveCell.Value\n\nStraightLiner = TotalHooks - 1\n\nCells.Find(What:=\"Count5s\", After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Offset(1, 0).Activate\n    If ActiveCell = StraightLiner Then\n        With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .ThemeColor = xlThemeColorAccent4\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n        With Selection.Font\n            .ThemeColor = xlThemeColorDark1\n            .TintAndShade = 0\n        End With\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel", "foreach"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1484767167, "post_id": 41727594, "comment_id": 70649822, "body": "<code>For Each</code> only goes in one direction. If you need to reverse, then use <code>For</code> with <code>Step -1</code>."}, {"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 1, "creation_date": 1484767232, "post_id": 41727594, "comment_id": 70649851, "body": "I would just say use <code>For i = Sheets.Count To 1 Step -1</code> and then just reference each sheet as <code>Sheets(i)</code>. This probably isn&#39;t what you&#39;re looking for but it&#39;s easier than reversing the order of the sheets to use a <code>For Each</code> loop."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1484768322, "post_id": 41727594, "comment_id": 70650446, "body": "Note, when iterating collection of objects, <code>For Each</code> performs better than <code>For...Next</code>. <code>Worksheets</code> is one such object collection."}], "answers": [{"comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1484767745, "post_id": 41727722, "comment_id": 70650112, "body": "A Reverse For Each would be easier, but this works just fine for what I need, thanks."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1484768368, "post_id": 41727722, "comment_id": 70650471, "body": "@Rdster I&#39;ve never seen a &quot;reverse for each&quot; loop in any language."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1484770972, "post_id": 41727722, "comment_id": 70651918, "body": "Me either, but that doesn&#39;t mean I wasn&#39;t being hopeful that I just didn&#39;t know about it.  I would think being able to go forward or backward through a collection would be handy enough that it would have been implemented somewhere....but I guess not."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 4, "last_activity_date": 1484767253, "creation_date": 1484767253, "answer_id": 41727722, "question_id": 41727594, "link": "https://stackoverflow.com/questions/41727594/for-each-sheet-in-workbook-sheets-but-in-reverse/41727722#41727722", "title": "For Each Sheet in Workbook.sheets - but in Reverse?", "body": "<p>Maybe something like this:</p>\n\n<pre><code>Sub LoopSheetsBackwards()\n\nDim i As Long\n\nFor i = ThisWorkbook.Sheets.Count To 1 Step -1\n    Debug.Print Sheets(i).Name ' &lt;--for debug - show sheet name\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1731, "favorite_count": 0, "accepted_answer_id": 41727722, "answer_count": 1, "score": 2, "last_activity_date": 1484767253, "creation_date": 1484766816, "last_edit_date": 1531164843, "question_id": 41727594, "link": "https://stackoverflow.com/questions/41727594/for-each-sheet-in-workbook-sheets-but-in-reverse", "title": "For Each Sheet in Workbook.sheets - but in Reverse?", "body": "<p>I was using <code>For Each sheet In .Worksheets</code> for automating a report...and finally realized why the numbers on the first couple of sheets were off...they pull from later sheets.</p>\n\n<p>However, the order the sheets are in needs to be preserved, or at least restored, because this is how management uses them.  If I could go in reverse order while entering data, there shouldn't be a problem with sheet references. </p>\n\n<p>Is there a way to do <code>For Each sheet in .Worksheets Step -1</code> ??</p>\n\n<p>Or would I need to move the sheets around...loop through, enter data, run calcs...then move sheets back?  Or use the Index and loop backwards?  Any suggestions?</p>\n"}, {"tags": ["arrays", "vba", "average", "standard-deviation"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484767327, "post_id": 41727583, "comment_id": 70649907, "body": "1 a function called from a worksheet cannot effect another cell, so this would be better as a sub not a function.  2. I do not believe you can use an array in a worksheetfunction, Just use <code>.Averageif(Worksheets(1).Range(Worksheets(1).Cells(3,Column_&zwnj;&#8203;In),Worksheets(1).Ce&zwnj;&#8203;lls(N_of_P,Column_In&zwnj;&#8203;)),&quot;&lt;&gt;0&quot;)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484767459, "post_id": 41727583, "comment_id": 70649982, "body": "3. no there is no StDevIf() function.  Use <code>Evaluate(&quot;STDEV(IF(&quot; &amp; Worksheets(1).Range(Worksheets(1).Cells(3,Column_\u200c\u200bIn),Works&zwnj;&#8203;heets(1).Ce\u200c\u200blls(N_o&zwnj;&#8203;f_P,Column_In\u200c\u200b)).Ad&zwnj;&#8203;dress(0,0) &amp; &quot;&lt;&gt;0,&quot; &amp; Worksheets(1).Range(Worksheets(1).Cells(3,Column_\u200c\u200bIn),Works&zwnj;&#8203;heets(1).Ce\u200c\u200blls(N_o&zwnj;&#8203;f_P,Column_In\u200c\u200b)).Ad&zwnj;&#8203;dress(0,0) &amp; &quot;))&quot;)</code>"}, {"owner": {"reputation": 11, "user_id": 7437434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8631fcb3581791719ebd5bec06ff897?s=128&d=identicon&r=PG&f=1", "display_name": "Hamid", "link": "https://stackoverflow.com/users/7437434/hamid"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484785408, "post_id": 41727583, "comment_id": 70657855, "body": "@ScottCraner the error is &quot;unable to get the average property of the worksheetfunction class vba runtime error 1004&quot; when I run the average code."}], "owner": {"reputation": 11, "user_id": 7437434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8631fcb3581791719ebd5bec06ff897?s=128&d=identicon&r=PG&f=1", "display_name": "Hamid", "link": "https://stackoverflow.com/users/7437434/hamid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484766751, "creation_date": 1484766751, "question_id": 41727583, "link": "https://stackoverflow.com/questions/41727583/average-of-non-zeros-for-arrays-in-visual-basics", "title": "Average of non zeros for arrays in visual basics", "body": "<p>I have an array with 2000 elements in that I would like to calculate the average and standard deviation of non zero elements.\nHere is my code:</p>\n\n<pre><code>Function CI(Column_In As Integer, Row_Out As Integer, Column_Out As String)\n\nDim Arr() As Integer\nN_of_P = 2000\nReDim Arr(N_of_P)\n\n   For i = 3 To N_of_P\n   Arr(i) = Worksheets(1).Cells(i, Column_In).Value\n   Next i\n\n   With Application.WorksheetFunction\n\n   DAverage = .Averageif(Arr, \"Arr &lt;&gt; \"0\") ' this causes the error!\n   dStdDev = .StDev(Arr) ' do we have standard deviation if function?\n\n   End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1484766578, "post_id": 41727512, "comment_id": 70649433, "body": "Please post your formulas() sub."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484767236, "post_id": 41727512, "comment_id": 70649853, "body": "Your <code>titles</code> subroutine never changes the active worksheet.  (Which is <b>good</b>!)  So how will your <code>Formulas</code> subroutine know which worksheet to use if you don&#39;t pass that as a parameter?  (This comment is predicated on the assumption that &quot;while sub2 only works on the active <b>workbook</b>&quot; really means &quot;while sub2 only works on the active <b>worksheet</b>&quot;.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484767836, "post_id": 41727512, "comment_id": 70650167, "body": "And the syntax to call a subroutine is just <code>Call Formulas</code>, or <code>Formulas</code>, (or <code>Call Formulas(parm1, parm2, etc)</code>, or <code>Formulas parm1, parm2, etc</code>) not <code>Call Sub Formulas()</code>."}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1484767886, "post_id": 41727512, "comment_id": 70650200, "body": "I realize that I would need to call back the sub titles() inside the sub formulas in order to go to the next active worksheet. Is that what you mean. I have tried that by putting Call titles at the end of my long formulas sub, but excel froze. please help"}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1484767962, "post_id": 41727512, "comment_id": 70650239, "body": "Yes, I tried Call Formulas and Formulas..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484767983, "post_id": 41727512, "comment_id": 70650253, "body": "No, at the end of <code>Formulas</code> control would automatically return to <code>titles</code> - you don&#39;t have to call it."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484768012, "post_id": 41727512, "comment_id": 70650270, "body": "Post your <code>Formulas</code> code and we can help you fix things.  (Or at least the top part of it if it is too long to post all of it.)"}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1484768051, "post_id": 41727512, "comment_id": 70650287, "body": "Both ways still not working to call the sub to do the formulas in all the worksheets. It only does works in the current one that is active."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484768138, "post_id": 41727512, "comment_id": 70650341, "body": "As I said in my first comment, you are never changing the &quot;active&quot; sheet, so if your <code>formulas</code> subroutine works on <code>ActiveSheet</code> then it will always be working on the same sheet."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484768220, "post_id": 41727512, "comment_id": 70650391, "body": "Or see Chris&#39; answer for a &quot;template&quot; of what you need."}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1484768348, "post_id": 41727512, "comment_id": 70650461, "body": "will post shortly, excel keeps crashing now"}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1484768688, "post_id": 41727512, "comment_id": 70650670, "body": "How do I stop excel from freezing? I have not saved my work, so I do not want to stop process at the task manager."}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1484768703, "post_id": 41727512, "comment_id": 70650679, "body": "at the time being, where is Chris&#39; answer"}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1484768896, "post_id": 41727512, "comment_id": 70650775, "body": "Ok, I see Chris&#39; code. Will try it later. I will wait for excel to operate normally first. I do not know how long it will take."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484769490, "post_id": 41727512, "comment_id": 70651111, "body": "If <code>Formulas</code> is calling <code>titles</code> which is calling <code>Formulas</code> which is calling <code>titles</code> ..., I think it may take some time."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1485319332, "post_id": 41727977, "comment_id": 70871674, "body": "I am running into other problems, which I think is related to the With ws loop. If I am calling another Sub3 within Sub2, do I have to change all Cells into .Cells formatting? The reason I ask is that in Sub1, I called Sub2 without any inputs. However, I have inputs when I call Sub3 within Sub2, so I do not know how to show that. Sub1 is titles(), Sub2 is formulas(ws as Worksheet), Sub3 is NextPeakRow(R As Long, DataCol As Long) As Long. So, do I have to change it to: NextPeakRow(R As Long, DataCol As Long, ws as Worksheet) As Long?"}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1485319781, "post_id": 41727977, "comment_id": 70871820, "body": "I tried the above: NextPeakRow(R As Long, DataCol As Long, ws as Worksheet) As Long with the .Cells and .Range formatting and With ws loop inside the Sub. It is not working, I am getting a Compile Error: Argument not optional"}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1485320114, "post_id": 41727977, "comment_id": 70871931, "body": "I am very confused on the syntax. When I call Sub2 within Sub1, I just wrote a line: &#39;formulas ws&#39;. However, when i call Sub3 within Sub2, it is in the form of a formula: &#39;PeakRow1 = NextPeakRow(R:=2, DataCol:=.Range(&quot;AY1&quot;).Column)&#39;. So, where would I put the ws? Please help me with this, I have been researching and I cannot find a way."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1485334213, "post_id": 41727977, "comment_id": 70878358, "body": "@Sarah if you are calling Sub3 like that it must actually be a Function.  Functions also can have parameters, so it&#39;s declaration would be something like <code>Function Sub3(ws As Worksheet) As SomeType</code> and would be called like <code>SomeVariable = Sub3(ws)</code>"}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1485366587, "post_id": 41727977, "comment_id": 70900370, "body": "Yes, the sub3 is a private function. Is this ok: &#39;Private Function NextPeakRow(R As Long, DataCol As Long, ws As Worksheet) As Long&#39;, which would be called like: &#39;PeakRow1 = NextPeakRow(R:=2, DataCol:=.Range(&quot;AY1&quot;).Column, ws)&#39;"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1485367789, "post_id": 41727977, "comment_id": 70901089, "body": "Try using <code>PeakRow1 = NextPeakRow(2, .Range(&quot;AY1&quot;).Column, ws)</code>"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 3, "last_activity_date": 1484768163, "creation_date": 1484768163, "answer_id": 41727977, "question_id": 41727512, "link": "https://stackoverflow.com/questions/41727512/calling-sub-to-all-worksheets/41727977#41727977", "title": "Calling Sub to all worksheets", "body": "<p>General structure you need is</p>\n\n<pre><code>Sub Sub1()\n    Dim ws As Worksheet\n    For Each ws In wb.Sheets\n        ' other code\n        Sub2 ws\n    Next\nEnd Sub\n\nSub Sub2(ws as Worksheet)\n    ' work with ws object\n    ' eg\n    With ws\n        .Cells(11, 1).Formula = \"=Sum(A1:A10)\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 41727977, "answer_count": 1, "score": 0, "last_activity_date": 1484777015, "creation_date": 1484766505, "last_edit_date": 1531164843, "question_id": 41727512, "link": "https://stackoverflow.com/questions/41727512/calling-sub-to-all-worksheets", "title": "Calling Sub to all worksheets", "body": "<p>I am new to VBA. I have been researching past codes to help me build my own.</p>\n\n<p>my problem is that sub1 and sub2 work perfectly on their own. Sub1 goes through all the worksheets in the workbook while sub2 only works on the active workbook. Therefore, as I loop through the worksheets in sub1, I want to call sub2. The two subs are not related and therefore I do not have any inputs to use from sub1 to sub2.</p>\n\n<pre><code>Sub titles()\nDim titles() As Variant\nDim ws As Worksheet\nDim wb As Workbook\nDim i As Long\n\nApplication.ScreenUpdating = False\n\nSet wb = ActiveWorkbook\n\n\ntitles() = Array(\"Distance\", \"Count\", \"Fe %\", \"Cr %\", \"Fe (Mean)\", \"Fe (std)\", \"Cr (Mean)\", \"Cr(std)\", \"x\", \"Fe\", \"x\", \"Cr\", \"x\", \"Fe\", \"x\", \"Cr\", \"Fe W\", \"Fe A\", \"Cr W\", \"Cr A\")\n\nFor Each ws In wb.Sheets\n\n    With ws\n    For i = 41 + LBound(titles()) To 41 + UBound(titles())\n\n        .Cells(1, 1 + i).Value = titles(i - 41)\n\n    Next i\n\n    End With\n\n **Formulas ws**\n\n\n\nNext ws\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n\n\n**Public Sub Formulas(ws As Worksheet)**\n\n**With ws**\n\n\n   Dim R As Long\n   Dim OutR1   As Long, OutR2 As Long, outRow As Long\n   Dim MaxRow1 As Long, MaxRow2 As Long\n   Dim SeriesFlag As Integer\n\n\n\n   Range(Cells(2, \"AX\"), Cells(ActiveSheet.UsedRange.Rows.Count, \"BE\")).ClearContents\n\n   R = 2\n\n   outRow = 2\n\n    Do Until Cells(R, \"AP\") = \"\"\n\n\n   MaxRow1 = NextMaximumRow(R:=R, DataCol:=Range(\"AR1\").Column, WMean:=Range(\"AT2\"), WSErr:=Range(\"AU2\"))\n\n\n   If MaxRow1 &gt; 0 Then\n\n   Cells(outRow, Range(\"AX1\").Column) = Cells(MaxRow1, \"AP\") ' x\n   Cells(outRow, Range(\"AY1\").Column) = Cells(MaxRow1, Range(\"AR1\").Column)       ' y\n\n   Cells(outRow, Range(\"AZ1\").Column) = Cells(MaxRow1, \"AP\") ' x\n   Cells(outRow, Range(\"BA1\").Column) = 0       ' y\n\n   R = R + 1\n\n   outRow = outRow + 1\n   End If\n\n\n\n  If MaxRow1 = 0 Then\n   R = R + 1\n  End If\n\n\n\n   R = R + 1\n\n   Loop\n\n\n   R = 2\n\n   Do Until Cells(R, \"AP\") = \"\"\n\n\n\n    MaxRow2 = NextMaximumRow(R:=R, DataCol:=Range(\"AS1\").Column, WMean:=Range(\"AV2\"), WSErr:=Range(\"AW2\"))\n\n\n    If MaxRow2 &gt; 0 Then\n\n\n   Cells(outRow, Range(\"AZ1\").Column) = Cells(MaxRow2, \"AP\") ' x\n   Cells(outRow, Range(\"BA1\").Column) = Cells(MaxRow2, Range(\"AS1\").Column)       ' y\n   Cells(outRow, Range(\"AX1\").Column) = Cells(MaxRow2, \"AP\") ' x\n   Cells(outRow, Range(\"AY1\").Column) = 0       ' y\n\n\n    R = R + 1\n\n   outRow = outRow + 1\n   End If\n\n\n  If MaxRow2 = 0 Then\n   R = R + 1\n  End If\n\n\n   R = R + 1\n\n   Loop\n\n Call Range(\"AX:BA\").Sort(Key1:=Range(\"AX1\"), Order1:=xlAscending, Header:=xlYes)\n\n\n R = 2\n OutR1 = 2\n OutR2 = 2\n\n Dim PeakRow1 As Long, PeakRow2 As Long\n\n  ' Which series has the first Peak?\n\n\n   PeakRow1 = NextPeakRow(R:=2, DataCol:=Range(\"AY1\").Column)\n\n   PeakRow2 = NextPeakRow(R:=2, DataCol:=Range(\"BA1\").Column)\n\n   If PeakRow1 &lt; PeakRow2 And PeakRow1 &gt; 0 Then\n      Cells(OutR1, Range(\"BB1\").Column) = Cells(PeakRow1, \"AX\") ' x\n      Cells(OutR1, Range(\"BC1\").Column) = Cells(PeakRow1, Range(\"AY1\").Column)         ' y\n      OutR1 = OutR1 + 1\n      SeriesFlag = 2 ' next series to check\n      R = PeakRow1\n\n   ElseIf PeakRow2 &gt; 0 Then\n      Cells(OutR2, Range(\"BD1\").Column) = Cells(PeakRow2, \"AX\") ' x\n      Cells(OutR2, Range(\"BE1\").Column) = Cells(PeakRow2, Range(\"BA1\").Column)         ' y\n      OutR2 = OutR2 + 1\n      SeriesFlag = 1 ' next series to check\n      R = PeakRow2\n\n    ElseIf PeakRow2 = 0 Then\n    SeriesFlag = 1\n    R = PeakRow2 + 1\n\n    ElseIf PeakRow1 = 0 Then\n    SeriesFlag = 2\n    R = PeakRow1 + 1\n\n   Else\n      MsgBox \"There is no Peak\"\n      Exit Sub\n   End If\n\n   R = R + 1\n\n   Do Until Cells(R, \"AP\") = \"\"\n\n      Select Case SeriesFlag\n\n         Case 1\n\n            PeakRow1 = NextPeakRow(R:=R, DataCol:=Range(\"AY1\").Column)\n            If PeakRow1 &gt; 0 Then\n      Cells(OutR1, Range(\"BB1\").Column) = Cells(PeakRow1, \"AX\") ' x\n      Cells(OutR1, Range(\"BC1\").Column) = Cells(PeakRow1, Range(\"AY1\").Column)         ' y\n      OutR1 = OutR1 + 1\n      SeriesFlag = 2\n      R = PeakRow1\n\n            End If\n\n         Case 2\n\n            PeakRow2 = NextPeakRow(R:=R, DataCol:=Range(\"BA1\").Column)\n           If PeakRow2 &gt; 0 Then\n      Cells(OutR2, Range(\"BD1\").Column) = Cells(PeakRow2, \"AX\") ' x\n      Cells(OutR2, Range(\"BE1\").Column) = Cells(PeakRow2, Range(\"BA1\").Column)         ' y\n      OutR2 = OutR2 + 1\n      SeriesFlag = 1 ' next series to check\n      R = PeakRow2\n\n            End If\n\n         Case Else\n            Stop\n\n      End Select\n\n      R = R + 1\n\n   Loop\n\n **End With**\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "function"], "owner": {"reputation": 318, "user_id": 6546590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ceebcf90fc76eabbf3e34f3723bede1?s=128&d=identicon&r=PG&f=1", "display_name": "mrwd", "link": "https://stackoverflow.com/users/6546590/mrwd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484867590, "creation_date": 1484765060, "last_edit_date": 1484867590, "question_id": 41727109, "link": "https://stackoverflow.com/questions/41727109/space-check-previous-page-and-insert-rows-there-excel", "title": "Space check previous page and insert rows there Excel", "body": "<p>I have block of text in (A795:O830). It is separated from other pages by Page Break and is always the last page of printed (xls, pdf) document. Sometimes there are a lot of free space on first pages and (A795:O830) could have fitted there. Now it is done by Page Break and is not changeble. In my situation 66 rows can fit on one page. </p>\n\n<p>Is there any macro that can automatically check if there is enough empty space on previous page to fit (A795:O830) and insert it there?</p>\n\n<p>Here is my current macro:</p>\n\n<pre><code>Sub Remove_color()\n    Dim myRange As Range\n    Dim cell As Range\n    Set myRange = Range(\"A24:O785\")\n        For Each cell In myRange\n        myRange.Interior.ColorIndex = 0\n    Next\nEnd Sub\nSub Hide_empty_cells()\n    Set rr = Range(\"A24:N832\")\n    For Each cell In rr\n    cell.Select\n        If cell.HasFormula = True And cell.Value = \"\" And cell.EntireRow.Hidden = False Then Rows(cell.Row).EntireRow.Hidden = True\n    Next cell\nEnd Sub\nSub Save_excel()\n    Dim iFileName$, iRow&amp;, iCol&amp;, iCell As Range, iArr\n    iFileName = ThisWorkbook.Path &amp; \"\\New_folder_\" &amp; [D5] &amp; \"_\" &amp; \".xls\"\n    iArr = Array(1, 3, 4): iCol = UBound(iArr) + 1\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.Calculation = xlManual\n\n    ThisWorkbook.Sheets(2).Copy\n    With ActiveWorkbook.ActiveSheet\n         .Buttons.Delete '.Shapes(\"Button 1\").Delete\n         .UsedRange.Value = .UsedRange.Value\n         .SaveAs iFileName, xlExcel8: .Parent.Close\n    End With\n\n    Application.Calculation = xlAutomatic\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd Sub\nSub Save_pdf()\n        ActiveWorkbook.Sheets(2).Select\n        ActiveSheet.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=ThisWorkbook.Path &amp; \"\\New_folder_\\\" &amp; [D5] &amp; \"_\" &amp; \".pdf\", _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=No, _\n        OpenAfterPublish:=False\n\nEnd Sub\nSub doitallplease()\nCall Remove_color\nCall Hide_empty_cells\nCall Save_excel\nCall Save_pdf\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1484763609, "post_id": 41726521, "comment_id": 70647840, "body": "<code>+</code> is two things, depending on context (&quot;addition&quot; operator, or &quot;concatenation&quot; operator). If you want to <i>concatenate strings</i>, use the <code>&amp;</code> operator instead. Yes, VBA is doing implicit conversions behind your back. All. The. Time. But JavaScript is even worse."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484763612, "post_id": 41726521, "comment_id": 70647841, "body": "Related: <a href=\"http://stackoverflow.com/questions/11595226/how-do-i-convert-an-integer-to-a-string-in-excel-vba\" title=\"how do i convert an integer to a string in excel vba\">stackoverflow.com/questions/11595226/&hellip;</a>"}], "owner": {"reputation": 85, "user_id": 7433793, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154646627867881/picture?type=large", "display_name": "user7433793", "link": "https://stackoverflow.com/users/7433793/user7433793"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "closed_date": 1484763883, "answer_count": 0, "score": 0, "last_activity_date": 1484763025, "creation_date": 1484763025, "last_edit_date": 1531164843, "question_id": 41726521, "link": "https://stackoverflow.com/questions/41726521/vba-basic-string-and-integer-manupilation", "closed_reason": "Duplicate", "title": "VBA basic string and integer manupilation", "body": "<p>I have a basic VBA question. See my code below, I would expect an error message for the first msgbox because you can't calculate an integer plus a string, but that's not the case. What is happening?  Why, VBA seems to be changing data type here? Thanks in advance.    </p>\n\n<pre><code>Sub calc1()\n  Dim x As String\n  x = 100\n  MsgBox 1 + x ' display 101\n  Msgbox \"1\" + x ' display 1100\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "shortcut"], "comments": [{"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1484769203, "post_id": 41726401, "comment_id": 70650935, "body": "try putting the Application.Onkey statement in the sub Workbook_Open() of the workbook. That should do the trick."}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "reply_to_user": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1484808701, "post_id": 41726401, "comment_id": 70664659, "body": "@NiH not really working.. i tried inside &quot;sheet1&quot; and&quot;thisWorkbook&quot; as well  can&#39;t make it work"}], "owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1839, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484867605, "creation_date": 1484762611, "last_edit_date": 1495540375, "question_id": 41726401, "link": "https://stackoverflow.com/questions/41726401/assign-keyboard-shortcut-to-macro-inside-the-code", "title": "Assign keyboard shortcut to macro inside the code", "body": "<p>I wrote a macro that change data in my excel, and I wrote other macro that \ninsert the first macro (I made) inside 1000+ different excels that don't have this macro. In regular situation I know how to assign keyboard shortcut to this macro: via \"option\" in Macro windows.</p>\n\n<p>but my goal is that the keyboard shortcut for Sub Single in Macro1 will remains also in all other excels, I think the best way is to do it in my code.\nI read the following articles but cant figure out where they want me to put the following code, so it will actually work?</p>\n\n<p>Thanks in advance for all helprs ..</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff197461.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff197461.aspx</a>\nand that one: \n<a href=\"https://stackoverflow.com/questions/9818047/excel-vba-assign-keyboard-shortcut-to-run-procedure\">Excel VBA: Assign keyboard shortcut to run procedure</a></p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nApplication.OnKey \"^b\", \"Macro1\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "web"], "comments": [{"owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1484765290, "post_id": 41726225, "comment_id": 70648771, "body": "You can use list objects, create a datatable from CSV and bind your csv to the list object. Or simply read and set the cell contents based on the csv file,"}, {"owner": {"reputation": 683, "user_id": 5651960, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bbf2c02f85628348dbfa1b62a722c9cc?s=128&d=identicon&r=PG&f=1", "display_name": "RageAgainstheMachine", "link": "https://stackoverflow.com/users/5651960/rageagainsthemachine"}, "reply_to_user": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1484765822, "post_id": 41726225, "comment_id": 70649065, "body": "Could you show me how to do that with code? Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 683, "user_id": 5651960, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bbf2c02f85628348dbfa1b62a722c9cc?s=128&d=identicon&r=PG&f=1", "display_name": "RageAgainstheMachine", "link": "https://stackoverflow.com/users/5651960/rageagainsthemachine"}, "edited": false, "score": 0, "creation_date": 1484778984, "post_id": 41729562, "comment_id": 70655807, "body": "this is fantastic! How would I go about making it update the same sheet instead of creating a brand new one (because I intend to make links and create graphs, would make it much easier)."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 683, "user_id": 5651960, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bbf2c02f85628348dbfa1b62a722c9cc?s=128&d=identicon&r=PG&f=1", "display_name": "RageAgainstheMachine", "link": "https://stackoverflow.com/users/5651960/rageagainsthemachine"}, "edited": false, "score": 0, "creation_date": 1484841867, "post_id": 41729562, "comment_id": 70685455, "body": "@RageAgainstheMachine I changed the code just to update the values on the <code>Sheet1</code>."}, {"owner": {"reputation": 683, "user_id": 5651960, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bbf2c02f85628348dbfa1b62a722c9cc?s=128&d=identicon&r=PG&f=1", "display_name": "RageAgainstheMachine", "link": "https://stackoverflow.com/users/5651960/rageagainsthemachine"}, "edited": false, "score": 0, "creation_date": 1486233799, "post_id": 41729562, "comment_id": 71261410, "body": "The code works great, one small thing: how would I go about making the code work accross multiple versions of excel (2007 &amp; 2013). It&#39;s excel 12.0 and 15.0 object library that is causing the issue. I&#39;ve researched &quot;late binding&quot; but I&#39;m not sure how to apply it to the code. Thanks in advance"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 683, "user_id": 5651960, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bbf2c02f85628348dbfa1b62a722c9cc?s=128&d=identicon&r=PG&f=1", "display_name": "RageAgainstheMachine", "link": "https://stackoverflow.com/users/5651960/rageagainsthemachine"}, "edited": false, "score": 0, "creation_date": 1488129584, "post_id": 41729562, "comment_id": 72083706, "body": "@RageAgainstheMachine there are alreay late bindings in the code, could you please describe what is the exact issue caused by Excel object library?"}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 4, "last_activity_date": 1484841840, "last_edit_date": 1484841840, "creation_date": 1484774136, "answer_id": 41729562, "question_id": 41726225, "link": "https://stackoverflow.com/questions/41726225/vba-how-to-download-xls-from-website-and-put-data-into-excel-file/41729562#41729562", "title": "VBA - How to download .xls from website and put data into excel file", "body": "<p>Try the below code:</p>\n\n<pre><code>Option Explicit\n\nSub ImportHistoricalDataSheet()\n\n    Const SXH_SERVER_CERT_IGNORE_ALL_SERVER_ERRORS = 13056\n    Const adSaveCreateOverWrite = 2\n\n    Dim aBody, sPath\n\n    ' Download Historical Data xls file via XHR\n    With CreateObject(\"MSXML2.XMLHTTP\")\n    'With CreateObject(\"MSXML2.ServerXMLHTTP\")\n        '.SetOption 2, SXH_SERVER_CERT_IGNORE_ALL_SERVER_ERRORS\n        .Open \"GET\", \"http://www.housepriceindex.ca/Excel2.aspx?langue=EN&amp;mail=abc%40abc.com\"\n        .Send\n        ' Get binary response content\n        aBody = .responseBody\n        ' Retrieve filename from headers and concatenate full path\n        sPath = ThisWorkbook.Path &amp; \"\\\" &amp; Replace(Split(Split(.GetAllResponseHeaders, \"filename=\", 2)(1), vbCrLf, 2)(0), \"/\", \"-\")\n    End With\n    ' Save binary content to the xls file\n    With CreateObject(\"ADODB.Stream\")\n        .Type = 1\n        .Open\n        .Write aBody\n        .SaveToFile sPath, adSaveCreateOverWrite\n        .Close\n    End With\n    ' Open saved workbook\n    With Workbooks.Open(sPath, , True)\n        ' Get 1st worksheet values to array\n        aBody = .Worksheets(1).UsedRange.Value\n        .Saved = True\n        .Close\n    End With\n    ' Delete saved workbook file\n    CreateObject(\"Scripting.FileSystemObject\").DeleteFile sPath, True\n    ' Insert array to target worksheet\n    ThisWorkbook.Sheets(\"Sheet1\").Cells(1, 1).Resize(UBound(aBody, 1), UBound(aBody, 2)).Value = aBody\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 683, "user_id": 5651960, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bbf2c02f85628348dbfa1b62a722c9cc?s=128&d=identicon&r=PG&f=1", "display_name": "RageAgainstheMachine", "link": "https://stackoverflow.com/users/5651960/rageagainsthemachine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3516, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1484841840, "creation_date": 1484762052, "question_id": 41726225, "link": "https://stackoverflow.com/questions/41726225/vba-how-to-download-xls-from-website-and-put-data-into-excel-file", "title": "VBA - How to download .xls from website and put data into excel file", "body": "<p>I managed to use VBA to get to the point where I'm ready to download an excel file from the web but I'm having trouble figuring out how to actually download that file and put its contents into an excel file I'm working in. Any suggestions? Thanks</p>\n\n<p>Here is the code so far:</p>\n\n<pre><code>Sub GetData()\n\nDim IE As InternetExplorer\nDim HTMLDoc As HTMLDocument\nDim objElement As HTMLObjectElement\n\nSet IE = New InternetExplorer\nWith IE\n    .Visible = True\n    .Navigate \"http://www.housepriceindex.ca/default.aspx\"\n    While .Busy Or .ReadyState &lt;&gt; READYSTATE_COMPLETE: Wend\n    .Document.getElementById(\"lnkTelecharger2\").Click\n    While .Busy Or .ReadyState &lt;&gt; READYSTATE_COMPLETE: Wend\n    Set HTMLDoc = .Document\n    Set objElement = HTMLDoc.getElementById(\"txtEmailDisclaimerEN\")\n    objElement.Value = \"abc@abc.com\"\n    Set objElement = HTMLDoc.getElementById(\"lnkAcceptDisclaimerEN\")\n    objElement.Click\n\n    ' ... Get CSV somehow ...\n\n    '.Quit\n\nEnd With\n\nSet IE = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpivot"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7437064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4299d4894123ee257ab779e395f33c37?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7437064/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1484774051, "creation_date": 1484774051, "answer_id": 41729533, "question_id": 41725967, "link": "https://stackoverflow.com/questions/41725967/vba-filtering-rows-in-power-pivot-table-based-on-an-array/41729533#41729533", "title": "VBA: Filtering Rows in Power Pivot Table based on an Array", "body": "<p>After driving myself inside, the fact that I had the dimensions in rows is why .Visible didn't work. To deal with the syntax in VisibleItemList.. you can just adjust your array... See code below</p>\n\n<pre><code>For i = 0 To pgCount - 1\n    peerGroup(i) = \"[CoTicker].[CompanyMask].&amp;[\" &amp; peerGroup(i) &amp; \"]\"\n    MsgBox peerGroup(i)\nNext\nActiveSheet.PivotTables(\"PGRRCPvt\").PivotFields(\"[CoTicker].[CompanyMask].[CompanyMask]\").VisibleItemsList = Array(peerGroup)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7437064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4299d4894123ee257ab779e395f33c37?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7437064/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 745, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543271756, "creation_date": 1484761125, "last_edit_date": 1484768396, "question_id": 41725967, "link": "https://stackoverflow.com/questions/41725967/vba-filtering-rows-in-power-pivot-table-based-on-an-array", "title": "VBA: Filtering Rows in Power Pivot Table based on an Array", "body": "<p>I have the following code where I am trying to filter my pivot table ROWS based on a certain list of companies.   I have already loaded those company names inside the array peerGroup, where I know the length of the array.  My If statement correctly identifies which companies in my array that are found in the pivot table but I can't figure out how to hide that value.</p>\n\n<p>I have looked at other threads and the most common answers I found was using .Visible, but when I try to adopt it to my code, I get a Run-time error.  \"Unable to set Visible property of the PivotItem class\".</p>\n\n<pre><code>Dim ct As Integer\nDim i As Integer\nDim PG_RRC_PVT As PivotTable\nDim pi As PivotItem\n\n\nSet PG_RRC_PVT = Worksheets(\"Pivot4Charts\").PivotTables(\"PGRRCPVT\")\n\nPG_RRC_PVT.PivotFields(\"[CoTicker].[CompanyMask].[CompanyMask]\").ClearAllFilters\n\n\nFor Each pi In PG_RRC_PVT.PivotFields(\"[CoTicker].[CompanyMask].[CompanyMask]\").PivotItems\n    For i = 0 To pgCount\n         If pi.Name = \"[CoTicker].[CompanyMask].&amp;[\" &amp; peerGroup(i) &amp; \"]\" Then\n            pi.Visible = False\n         End If\n    Next i\nNext pi\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1484762230, "post_id": 41725757, "comment_id": 70647020, "body": "Have you tried simply replacing &quot;*.com/&quot; with &quot;&quot;?  Unsure if you&#39;ve got a set column/row with that info, but you could loop through pages and possibly avoid the regexp2 error."}, {"owner": {"reputation": 658, "user_id": 5947891, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e533298ad0a3547aff0e03abf2d1ab8?s=128&d=identicon&r=PG&f=1", "display_name": "Just Rudy", "link": "https://stackoverflow.com/users/5947891/just-rudy"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1484765164, "post_id": 41725757, "comment_id": 70648706, "body": "Thanks, @Cyril. I could try that, but that would only take care of &quot;*.com/&quot;, and I&#39;m expecting other domains ending in &quot;.net&quot;, &quot;.org&quot;, etc. I need to make this general enough to remove all url roots, and leave the trailing &#39;path&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 658, "user_id": 5947891, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e533298ad0a3547aff0e03abf2d1ab8?s=128&d=identicon&r=PG&f=1", "display_name": "Just Rudy", "link": "https://stackoverflow.com/users/5947891/just-rudy"}, "edited": false, "score": 0, "creation_date": 1484771141, "post_id": 41728388, "comment_id": 70652004, "body": "Thanks again, @Cyril. However, in my initial example, I was focused on modifying the footer."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 658, "user_id": 5947891, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e533298ad0a3547aff0e03abf2d1ab8?s=128&d=identicon&r=PG&f=1", "display_name": "Just Rudy", "link": "https://stackoverflow.com/users/5947891/just-rudy"}, "edited": false, "score": 1, "creation_date": 1484773431, "post_id": 41728388, "comment_id": 70653229, "body": "Got;cha; sorry about that.  Glad you found your answer (saw you post below)."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1484769564, "creation_date": 1484769564, "answer_id": 41728388, "question_id": 41725757, "link": "https://stackoverflow.com/questions/41725757/regular-expressions-in-excel-macro-code-not-working/41728388#41728388", "title": "Regular expressions in Excel macro code not working", "body": "<p>Slightly more generic than replacing the .com (per comments)... Hopefully this gets you where you need to be:</p>\n\n<pre><code>Dim LR As Long\nLR = Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row\n\nFor i = 1 To LR\n\n    Cells(i, 1) = Replace(Cells(i, 1), \"https://\", \"\", , 1)\n    Cells(i, 1) = Replace(Cells(i, 1), \"http://\", \"\", , 1)\n    Cells(i, 1) = Replace(Cells(i, 1), \"/\", \"(error)\", , 1)\n\n    Next i\n\nRange(Cells(1, 1), Cells(LR, 1)).Replace What:=\"*(error)\", Replacement:=\"\"\n</code></pre>\n\n<p>My assumption is there is a column with the addresses in them.</p>\n"}, {"tags": [], "owner": {"reputation": 658, "user_id": 5947891, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e533298ad0a3547aff0e03abf2d1ab8?s=128&d=identicon&r=PG&f=1", "display_name": "Just Rudy", "link": "https://stackoverflow.com/users/5947891/just-rudy"}, "is_accepted": true, "score": 0, "last_activity_date": 1484771742, "last_edit_date": 1495539947, "creation_date": 1484771742, "answer_id": 41728965, "question_id": 41725757, "link": "https://stackoverflow.com/questions/41725757/regular-expressions-in-excel-macro-code-not-working/41728965#41728965", "title": "Regular expressions in Excel macro code not working", "body": "<p>I copied the regular expression from <a href=\"https://stackoverflow.com/a/6041965/5947891\">https://stackoverflow.com/a/6041965/5947891</a>, and the following is a final version that worked for me. Basically, this will scan through all sheets in the workbook, check for url pattern, truncate the URL base (<strong>http ://www.sample.com</strong>/subfolder/subfile.png) and leave the trailing part(s) (e.g., http ://www.sample.com**/subfolder/subfile.png**). I added spaces after http in the URL to invalidate the href.</p>\n\n<pre><code>Sub FixFooter()\n    Dim oSection As Word.Section\n    Dim oRange As Word.Range\n    Dim var\n    Dim wrksht As Worksheet\n    Dim pg As Page\n\n    Dim regEx As New RegExp 'New VBScript_RegExp_55.RegExp\n    Dim strPattern As String\n\n    strPattern1 = \"(http|ftp|https){0,1}(\\://){0,1}([\\w_-]+(?:(?:\\.[\\w_-]+)+))/\"\n\n    For Each wrksht In Worksheets\n        Set pg = wrksht.PageSetup.pages(1)\n\n        With regEx\n            .IgnoreCase = True\n            .Global = True\n            .MultiLine = True\n            .Pattern = strPattern1\n\n        End With\n\n        If regEx.Test(pg.CenterFooter.Text) Then\n            pg.CenterFooter.Text = \"/\" &amp; regEx.Replace(pg.CenterFooter.Text, \"\")\n        End If\n    Next wrksht\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 658, "user_id": 5947891, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e533298ad0a3547aff0e03abf2d1ab8?s=128&d=identicon&r=PG&f=1", "display_name": "Just Rudy", "link": "https://stackoverflow.com/users/5947891/just-rudy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 0, "accepted_answer_id": 41728965, "answer_count": 2, "score": 0, "last_activity_date": 1484867689, "creation_date": 1484760359, "last_edit_date": 1484867689, "question_id": 41725757, "link": "https://stackoverflow.com/questions/41725757/regular-expressions-in-excel-macro-code-not-working", "title": "Regular expressions in Excel macro code not working", "body": "<p>I have the following code, and it's not executing due to an error message that reads \"Method 'Execute' of object 'IRegExp2 failed\"</p>\n\n<pre><code>Dim wrksht As Worksheet\nDim pg As Page\nDim regEx As New VBScript_RegExp_55.RegExp\n\nFor Each wrksht In Worksheets\n    For Each pg In wrksht.PageSetup.pages\n        With regEx\n            .IgnoreCase = True\n            .Pattern = \"[(ftp|FTP|http|HTTP|s|S)]{3,5}*[\\:/]{3}*[a-zA-Z0-9\\s]{2,}[\\.]*[.A-Za-z0-9\\s]{2,}\"\n        End With\n\n        If regEx.Execute(pg.CenterFooter.Text) Then\n            pg.CenterFooter.Text = regEx.Replace(pg.CenterFooter.Text, \"\")\n        End If\n    Next pg\nNext wrksht\n</code></pre>\n\n<p>I'm looking to replace the beginning part of URLs (<strong><em>www.sampleurl.com</em></strong>/subfolder/testfile.pdf) and keeping only the trailing part (www.sampleurl.com <strong><em>/subfolder/testfile.pdf</em></strong>, minus the space after the .com part)</p>\n"}, {"tags": ["excel", "vba", "format"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1484760582, "post_id": 41725730, "comment_id": 70646155, "body": "<i>Paste Values</i> pastes, well, <i>the values</i>. If you want to keep the <i>formatting</i> you need to paste more than just the <i>values</i>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1484760710, "post_id": 41725730, "comment_id": 70646233, "body": "Try recording a macro while you manually perform the paste special operation, and see what parameters Excel is given for the <code>PasteSpecial</code> call."}, {"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1484763752, "post_id": 41725730, "comment_id": 70647920, "body": "Paste Values and Formats. Check this post: <a href=\"http://stackoverflow.com/questions/25461314/vba-copy-cells-value-and-format\" title=\"vba copy cells value and format\">stackoverflow.com/questions/25461314/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 6, "last_activity_date": 1484764284, "creation_date": 1484764284, "answer_id": 41726890, "question_id": 41725730, "link": "https://stackoverflow.com/questions/41725730/how-to-paste-values-and-keep-source-formatting/41726890#41726890", "title": "How to paste values and keep source formatting?", "body": "<p>There's a PasteSpecial option for this:</p>\n\n<pre><code>ActiveSheet.Range(\"H10\").PasteSpecial Paste:=xlPasteValuesAndNumberFormats, _\n                 Operation:= xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 7836662, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Opl-2ERtWZk/AAAAAAAAAAI/AAAAAAAACS8/u8BbyhdJA18/photo.jpg?sz=128", "display_name": "Prakhar Srivastava", "link": "https://stackoverflow.com/users/7836662/prakhar-srivastava"}, "is_accepted": false, "score": 0, "last_activity_date": 1566303298, "creation_date": 1566303298, "answer_id": 57573443, "question_id": 41725730, "link": "https://stackoverflow.com/questions/41725730/how-to-paste-values-and-keep-source-formatting/57573443#57573443", "title": "How to paste values and keep source formatting?", "body": "<p>Instead of  just try&lt; Paste:=xlPasteAll> once</p>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77765, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1593065616, "creation_date": 1484760289, "last_edit_date": 1593065616, "question_id": 41725730, "link": "https://stackoverflow.com/questions/41725730/how-to-paste-values-and-keep-source-formatting", "title": "How to paste values and keep source formatting?", "body": "<p>I am trying to copy some values from a column in one workbook to another:</p>\n<p>Workbook 1</p>\n<pre><code>Column A\n10/02/1990\n41\n11/01/2017\n52\n</code></pre>\n<p>Workbook 2</p>\n<pre><code>Column I\n10/02/1990\n41\n11/01/2017\n52\n</code></pre>\n<p>If I simply copy my values from column 1 in workbook A and paste them to column I in workbook 2 I get results like so:</p>\n<pre><code>Column I\n34331\n41\n121092\n52\n</code></pre>\n<p>The formatting is lost/confused by Excel.</p>\n<p>So I created a button where users can paste this data using VBA like so:</p>\n<pre><code>Sub Paste3()\nDim lastRow As Long\nOn Error GoTo ErrorHandler\n\nlastRow = ActiveSheet.Range(&quot;H&quot; &amp; Rows.Count).End(xlUp).Row\nActiveSheet.Range(&quot;H10&quot;).PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone, SkipBlanks:=False\n\nExit Sub\n\nErrorHandler:\nMsgBox &quot;Please Copy Values First.&quot;\nEnd Sub\n</code></pre>\n<p>The values keep their formatting. However, the cell format also changes.</p>\n<p>What I mean is, the cells on workbook 1 have a black border, and the font is also black and bold.</p>\n<p>I want to preserve workbook 2's font and cell border. This is:</p>\n<p>Grey border, RGB(191, 191, 191)<br />\nGrey Font (RGB 128, 128, 128)<br />\nFont Size: 11<br />\nFont: Calibri</p>\n<p>Essentially it needs to look like the column to the right.</p>\n<p><a href=\"https://i.stack.imgur.com/Qvslb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Qvslb.png\" alt=\"enter image description here\" /></a></p>\n<p>I tried this, but it adds borders to ranges in my spreadsheet it isn't supposed to.</p>\n<pre><code>Sub Paste3()\nDim lastRow As Long\nOn Error GoTo ErrorHandler\n\nlastRow = ActiveSheet.Range(&quot;H&quot; &amp; Rows.Count).End(xlUp).Row\nActiveSheet.Range(&quot;H10&quot;).PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone, SkipBlanks:=False\n\nDim rng As Range\nSet rng = Range(&quot;H10:H&quot; &amp; lastRow)\nWith rng.Borders\n    .LineStyle = xlContinuous\n    .Color = RGB(191, 191, 191)\n    .Weight = xlThin\n    .Font\nEnd With\n    \nWith rng.Font\n    .TextColor = RGB(128, 128, 128)\n    .Font.Name = &quot;Calibri&quot;\n    .Size = 11\n    .Bold = False\nEnd With\nExit Sub\n\nErrorHandler:\nMsgBox &quot;Please Copy Values First.&quot;\nEnd Sub\n</code></pre>\n<p>I would rather find an easier way of pasting these values and keeping their format without changing the cell format and font colour etc.</p>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1485070170, "post_id": 41725623, "comment_id": 70766204, "body": "Can you add an image example of your data"}, {"owner": {"reputation": 3, "user_id": 5662616, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/06cfaf034c796b4c06169c8e81696699?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Crane", "link": "https://stackoverflow.com/users/5662616/michael-crane"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1485302625, "post_id": 41725623, "comment_id": 70867483, "body": "@0m3r I have added a screenshot, Current Inventory. Also, I was running the debugger after removing all the code above &#39; Sets the variables for each field, and it seems to start hanging up and crashing when the first &quot;With&quot; statement occurs. It hangs for about 15 seconds at the start, then when it comes to the end of the with statement, it crashes. I hope my doc didn&#39;t become corrupt...."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5662616, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/06cfaf034c796b4c06169c8e81696699?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Crane", "link": "https://stackoverflow.com/users/5662616/michael-crane"}, "edited": false, "score": 1, "creation_date": 1484761936, "post_id": 41725666, "comment_id": 70646884, "body": "I do have Application.ScreenUpdating = False at the beginning, and True at the end. I will add the EnableEvents and DisplayAlerts to the code as well. Thanks for the tip! I will let you know how it goes."}, {"owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "reply_to_user": {"reputation": 3, "user_id": 5662616, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/06cfaf034c796b4c06169c8e81696699?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Crane", "link": "https://stackoverflow.com/users/5662616/michael-crane"}, "edited": false, "score": 0, "creation_date": 1484767710, "post_id": 41725666, "comment_id": 70650096, "body": "@MichaelCrane has this fixed your issue?"}, {"owner": {"reputation": 3, "user_id": 5662616, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/06cfaf034c796b4c06169c8e81696699?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Crane", "link": "https://stackoverflow.com/users/5662616/michael-crane"}, "edited": false, "score": 0, "creation_date": 1484775397, "post_id": 41725666, "comment_id": 70654227, "body": "Hi Brad, It did not improve the document. It was successful on the first try after adding the code, but the second try caused Excel and Outlook to become unresponsive and have that awesome sound bling when you try to click inside either applications. Had to kill in Task Manager."}], "tags": [], "owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "is_accepted": false, "score": 0, "last_activity_date": 1484760072, "creation_date": 1484760072, "answer_id": 41725666, "question_id": 41725623, "link": "https://stackoverflow.com/questions/41725623/excel-vba-code-will-crash-the-document-and-outlook-intermittently/41725666#41725666", "title": "Excel VBA code will crash the document and Outlook intermittently", "body": "<p>Have you tried adding</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.DisplayAlerts = False\n</code></pre>\n\n<p>at the beginning of your code, and</p>\n\n<pre><code>Application.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>at the end of your code? I see you have Screen updating toggled already.</p>\n\n<p>This will turn off screen updating, events, and alerts, causing faster run-time and less possibility of crashing.</p>\n"}], "owner": {"reputation": 3, "user_id": 5662616, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/06cfaf034c796b4c06169c8e81696699?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Crane", "link": "https://stackoverflow.com/users/5662616/michael-crane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 621, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485302574, "creation_date": 1484759961, "last_edit_date": 1485302574, "question_id": 41725623, "link": "https://stackoverflow.com/questions/41725623/excel-vba-code-will-crash-the-document-and-outlook-intermittently", "title": "Excel VBA code will crash the document and Outlook intermittently", "body": "<p>I have created an inventory tracking excel document that tracks current inventory as well as creating a history of each item on a separate sheet. I use some VBA code to copy the weekly inventory and move it to its history sheet. Everything works, but not the most efficiently as it will cause Excel and Outlook to crash and become unresponsive and eventually have to kill the process in task manager.</p>\n\n<p>I can't figure out how to upload attachments, but here is my below code I use. I am wondering if anyone can point out some issues, or ways to optimize it so it runs more efficiently.</p>\n\n<pre><code>Sub Submit_Email()\n\n\n'to stop flickering when running the macro, and to return back to the start sheet\n\n\nDim StartHere As Range\n\nSet StartHere = Selection\n\nApplication.ScreenUpdating = False\n\n\n\n'Copy info for 5440\n\nSheets(\"Current Inventory\").Range(\"B8:e8\").Copy\nSheets(\"History 5440\").Range(\"B1048576\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n\nSheets(\"Current Inventory\").Range(\"B3\").Copy\nSheets(\"History 5440\").Range(\"A1048576\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n\nSheets(\"History 5440\").Range(\"F5\").Copy Sheets(\"History 5440\").Range(\"F1048576\").End(xlUp).Offset(1, 0)\n\n'Copy info for 7450\n\nSheets(\"Current Inventory\").Range(\"B9:e9\").Copy\nSheets(\"History 7450\").Range(\"B1048576\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n\nSheets(\"Current Inventory\").Range(\"B3\").Copy\nSheets(\"History 7450\").Range(\"A1048576\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n\nSheets(\"History 7450\").Range(\"F5\").Copy Sheets(\"History 7450\").Range(\"F1048576\").End(xlUp).Offset(1, 0)\n\n\n\n'Copy info for 7470\n\n\nSheets(\"Current Inventory\").Range(\"B10:e10\").Copy\nSheets(\"History 7470\").Range(\"B1048576\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n\nSheets(\"Current Inventory\").Range(\"B3\").Copy\nSheets(\"History 7470\").Range(\"A1048576\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n\nSheets(\"History 7470\").Range(\"F5\").Copy Sheets(\"History 7470\").Range(\"F1048576\").End(xlUp).Offset(1, 0)\n\n\n\n'Copy info for MBP 15\n\n\nSheets(\"Current Inventory\").Range(\"B11:e11\").Copy\nSheets(\"History MBP 15 Retina\").Range(\"B1048576\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n\nSheets(\"Current Inventory\").Range(\"B3\").Copy\nSheets(\"History MBP 15 Retina\").Range(\"A1048576\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n\nSheets(\"History MBP 15 Retina\").Range(\"F5\").Copy Sheets(\"History MBP 15 Retina\").Range(\"F1048576\").End(xlUp).Offset(1, 0)\n\n\n\n'Copy info for MBP 13\n\n\nSheets(\"Current Inventory\").Range(\"B12:e12\").Copy\nSheets(\"History MBP 13 Retina\").Range(\"B1048576\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n\nSheets(\"Current Inventory\").Range(\"B3\").Copy\nSheets(\"History MBP 13 Retina\").Range(\"A1048576\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n\nSheets(\"History MBP 13 Retina\").Range(\"F5\").Copy Sheets(\"History MBP 13 Retina\").Range(\"F1048576\").End(xlUp).Offset(1, 0)\n\n\n\n\n\n\n\n\n\n\n' Sets the variables for each field\n\nDim TeamMember As String\nTeamMember = Sheets(\"Current Inventory\").Range(\"B4\")\n\n\nDim WeekOf As String\nWeekOf = Sheets(\"Current Inventory\").Range(\"B3\")\n\nDim Location As String\nLocation = Sheets(\"Current Inventory\").Range(\"A1\")\n\n\n\n   'if criteria is met, send email to the team\n\n If Sheets(\"Current Inventory\").Range(\"B10\") &lt;= Sheets(\"Current       Inventory\").Range(\"C10\") Or Sheets(\"Current Inventory\").Range(\"B11\") &lt;=   Sheets(\"Current Inventory\").Range(\"C11\") Then\n\n\n' Select the range of cells on the active worksheet.\n Sheets(\"Current Inventory\").Select Range(\"A1:E30\").Select\n\n' Show the envelope on the ActiveWorkbook.\n ActiveWorkbook.EnvelopeVisible = True\n\n ' Set the optional introduction field thats adds\n ' some header text to the email body. It also sets\n ' the To and Subject lines. Finally the message\n ' is sent.\n With ActiveSheet.MailEnvelope\n  .Introduction = Location &amp; \" is running low. Please review the below   inventory to see which items are running low so we can be prepared to assist with new hire needs if required.\"\n  .Item.To = \"x-inventory-alerts@proofpoint.com;\"\n  .Item.Subject = Location &amp; \" Running Low for the week of \" &amp; WeekOf\n  .Item.Send\n End With\n\n ActiveWorkbook.SendMail Recipients:=\"mcrane@proofpoint.com\",   Subject:=Location &amp; \" for the week of \" &amp; WeekOf &amp; \" By \" &amp; TeamMember\n\nElse\n\n'otherwise send it to terry only\n\n\n ActiveWorkbook.SendMail Recipients:=\"mcrane@proofpoint.com\", Subject:=Location &amp; \" for the week of \" &amp; WeekOf &amp; \" By \" &amp; TeamMember\n\n End If\n\n\n\n\n Application.ScreenUpdating = True\n\n Application.Goto StartHere\n\n ActiveWorkbook.Save\n\n\n'Clear inventory\nRange(\"B8:B18\").Select\nSelection.ClearContents\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/E65R2.png\" rel=\"nofollow noreferrer\">Current Inventory</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1484851503, "post_id": 41725364, "comment_id": 70691156, "body": "Can you provide some sample VBA code using the <code>LINEST</code> function, showing inputs and outputs? I keep getting <b>Unable to get the LinEst property of the WorksheetFunction class</b>. You should probably be able to store the results in a Variant variable, and after stepping through with the debugger, examining the variable."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 1, "creation_date": 1484856192, "post_id": 41725364, "comment_id": 70693764, "body": "In general, array access in VBA is done using <code>()</code> -- <code>Dim arr : arr = Array(1,2,3) : Debug.Print arr(1) &#39;prints 2</code>. Keep in mind that you don&#39;t need a variable of a specific array type in order to hold an array, or to access the values."}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 10533391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yvqFL.jpg?s=128&g=1", "display_name": "NigelH", "link": "https://stackoverflow.com/users/10533391/nigelh"}, "is_accepted": false, "score": 0, "last_activity_date": 1558562170, "creation_date": 1558562170, "answer_id": 56265528, "question_id": 41725364, "link": "https://stackoverflow.com/questions/41725364/accessing-linest-output-in-vba/56265528#56265528", "title": "Accessing LinEst output in VBA", "body": "<p>This solution may help someone, although I appreciate it is an old question.</p>\n\n<p>I found that the <code>WorksheetFunction.Linest</code> function returns the error message <code>Unable to get the LinEst property of the WorksheetFunction class</code>, for all manner of errors. So by trial and error(lots) I finally got to this solution:</p>\n\n<pre><code>Sub CalcTrend()\n'--------------\n' To Determine a simple linear trend of the form y = mx + b\n\n'First declare arrays for x and y data series\nDim x() As Double, y() As Double\n' Next declare a variant array for the Linest return values\nDim RtnArray() As Variant\n' Also declare simple variable for the individual parameters\nDim m As Double, b As Double, r2 As Double\n' Finally declare and index variable for For-Next loop\nDim i As Long\n\n' Both x() and y() arrays MUST be same size\n' and assuming the data is in a worksheet in columns x any y then,\n'  to populate the arrays, for example\n' With Worksheet\n'    RowsInDataSet = .Range(.Cells(firstrow, xCol), .Cells(lastRow, xCol)).Rows.Count\n' End With\nReDim x(0 To RowsInDataSet)\nReDim y(0 To RowsInDataSet)\n\nFor i = 0 To UBound(x)\n    x(i) = X_Range.Cells(i + 1, 1) 'Replace X_Range with worksheet range for x series\n    y(i) = Y_Range.Cells(i + 1, 1) 'Replace y_Range with worksheet range for y series\nNext i\n\n' Now run the Linest function ...\nDataArray = WorksheetFunction.LinEst(y, x, , True)\n' ... and the results can be found as follows\n' Slope\nm = DataArray(1, 1)\n' Y-intercept\nb = DataArray(1, 2)\n' Coefficient of determination (how well the data correlates to the line)\nr2 = DataArray(3, 1)\n\nEnd Sub\n</code></pre>\n\n<p>See the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.linest?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vbaxl10.chm137103)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv16)%26rd%3Dtrue#return-value\" rel=\"nofollow noreferrer\">Microsoft docs</a> for a full map of all the Return Array values.</p>\n\n<p>This solution is shown as a Sub to demonstrate obtaining the WorksheetFunction return values. For practical purpose using a Function with ByRef arguments for return array could be more useful.  </p>\n"}], "owner": {"reputation": 25, "user_id": 4852223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3be313c58d788f75e88b1b5972e8fda?s=128&d=identicon&r=PG&f=1", "display_name": "Lucy Clara", "link": "https://stackoverflow.com/users/4852223/lucy-clara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 797, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558562170, "creation_date": 1484759222, "last_edit_date": 1484849004, "question_id": 41725364, "link": "https://stackoverflow.com/questions/41725364/accessing-linest-output-in-vba", "title": "Accessing LinEst output in VBA", "body": "<p>I want to use the coefficient from LinEst but LinEst returns an array. What is the best way to access the parts of the array output? What data types will the parts of the array be? </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1484759899, "post_id": 41725519, "comment_id": 70645774, "body": "I was just starting to type an answer and saw another answer pop-up.  Looks about the same as where I was going, except I had added a filters to the spreadsheet, sorted by column(3), then found the first instance of a value &gt;=0 and inserted 5 rows above it.  Similar outcome."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1484760427, "post_id": 41725519, "comment_id": 70646072, "body": "Not a problem, glad to help."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484764505, "post_id": 41725519, "comment_id": 70648356, "body": "I suggest you change <code>LastRow</code> to be based on the last non-empty cell in column <code>C</code> rather than column <code>A</code>."}], "tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": true, "score": 2, "last_activity_date": 1484765756, "last_edit_date": 1484765756, "creation_date": 1484759684, "answer_id": 41725519, "question_id": 41725141, "link": "https://stackoverflow.com/questions/41725141/find-row-where-values-change-from-positive-to-negative-and-insert-blank-rows/41725519#41725519", "title": "Find row where values change from positive to negative and insert blank rows", "body": "<p>You can add something like the following loop to the end of your sub after your sorting code:</p>\n\n<pre><code>FirstRow = wsData.Range(\"C2\").Row\nLastRow = wsData.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\nFor lrow = FirstRow To LastRow\n    If wsData.Cells(lrow, 3).Value &gt;= 0 And wsData.Cells(lrow + 1, 3).Value &lt;= 0 Then\n        For x = 1 To 5\n        wsData.Rows(lrow + 1).Insert shift:=xlShiftDown\n        Next x\n    Exit For\n    End If\nNext lrow\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5683238, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76433a9de379d7215b51e41211ef26fb?s=128&d=identicon&r=PG&f=1", "display_name": "AlanB", "link": "https://stackoverflow.com/users/5683238/alanb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 41725519, "answer_count": 1, "score": 1, "last_activity_date": 1583443734, "creation_date": 1484758529, "last_edit_date": 1583443734, "question_id": 41725141, "link": "https://stackoverflow.com/questions/41725141/find-row-where-values-change-from-positive-to-negative-and-insert-blank-rows", "title": "Find row where values change from positive to negative and insert blank rows", "body": "<p>I have the code below which takes a table of data, removes most of the columns and any rows where the value in column C is zero, and finally sorts by column C.</p>\n\n<p>What I need to be able to do next is find the row where the values in column C change from positive to negative and insert 5 blank rows.</p>\n\n<p>I can find other code examples which loop through the values to perform a number of tasks but I just need insert rows where the values change from positive to negative.</p>\n\n<pre><code>Sub FormatData()\n\nDim wsData As Worksheet\nDim FirstRow As Integer\nDim LastRow As Integer\nDim LastRow2 As Integer\nDim lrow As Integer\n\nSet wsData = Worksheets(\"Data\")\n\nFirstRow = wsData.Range(\"C2\").Row\nLastRow = wsData.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nColumns(\"C:Y\").Select\nSelection.Delete Shift:=xlToLeft\nColumns(\"D:F\").Select\nSelection.Delete Shift:=xlToLeft\n\nwsData.Range(\"C2:C\" &amp; LastRow).Select\n\nFor lrow = LastRow To FirstRow Step -1\nSet workrange = Cells(lrow, 3)\nIf workrange.Value = \"0\" _\n    Then workrange.EntireRow.Delete\n\nNext lrow\n\nLastRow2 = wsData.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\nRange(\"A2:C\" &amp; LastRow2).Sort Key1:=Range(\"C2:C\" &amp; LastRow2), Order1:=xlDescending, Header:=xlNo\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484758923, "post_id": 41725107, "comment_id": 70645155, "body": "<code>=SUMPRODUCT(--(MID(A1,1,1)=MID(A1,ROW(INDIRECT(&quot;1:&quot; &amp; LEN(A1))),1)))=LEN(A1)</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484759993, "post_id": 41725107, "comment_id": 70645831, "body": "standing your &quot;specs&quot;, I&#39;d use <code>=SUBSTITUTE(A1,9,&quot;&quot;)=&quot;&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1484759270, "post_id": 41725254, "comment_id": 70645380, "body": "OP: <b><i>Outside of just using multiple OR statements</b>, I&#39;m wondering if there is a more &quot;elegant&quot; way to test this</i>"}], "tags": [], "owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "is_accepted": false, "score": -1, "last_activity_date": 1484758860, "creation_date": 1484758860, "answer_id": 41725254, "question_id": 41725107, "link": "https://stackoverflow.com/questions/41725107/vba-simple-test-if-an-integer-is-a-repeating-number/41725254#41725254", "title": "VBA simple test if an integer is a repeating number?", "body": "<p>Here is a short little example to help you get started. This vba code checks to see if it is one of your repeating numbers (999,9999,99999) and makes a message box if it is or not one of your repeating numbers.</p>\n\n<pre><code>Sub Test()\n\n    Dim MyVal As Long\n    MyVal = Range(\"A1\").Value\n\n    If MyVal = 999 Or MyVal = 9999 Or MyVal = 99999 Then\n        MsgBox \"Integer is a repeating number.\"\n    Else\n        MsgBox \"Integer is not a repeating number.\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484759222, "post_id": 41725333, "comment_id": 70645349, "body": "Shorter than mine and not an array type.  I like."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484759282, "post_id": 41725333, "comment_id": 70645393, "body": "there&#39;s also the <code>string(mid(a1,1,1),len(a1))=a1</code> route also"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484759366, "post_id": 41725333, "comment_id": 70645444, "body": "I think you want REPT not STRING, but yeah."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484759582, "post_id": 41725333, "comment_id": 70645562, "body": "Apologies, that was more of the pseudo VBA approach in my comment.  But formula wise, perfect, could be a million and 1 comments by tomorrow :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484759628, "post_id": 41725333, "comment_id": 70645600, "body": "vba the criteria are switched, the number comes first then the character."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484759689, "post_id": 41725333, "comment_id": 70645644, "body": "hence pseudo ;)"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1484759097, "creation_date": 1484759097, "answer_id": 41725333, "question_id": 41725107, "link": "https://stackoverflow.com/questions/41725107/vba-simple-test-if-an-integer-is-a-repeating-number/41725333#41725333", "title": "VBA simple test if an integer is a repeating number?", "body": "<p>Something like this <code>=(LEN(SUBSTITUTE(A1,MID(A1,1,1),\"\"))=0)</code></p>\n"}], "owner": {"reputation": 63, "user_id": 2970482, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f05b7332f836f8c6fdeaf85059838b71?s=128&d=identicon&r=PG&f=1", "display_name": "tincanfury", "link": "https://stackoverflow.com/users/2970482/tincanfury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484759097, "creation_date": 1484758429, "question_id": 41725107, "link": "https://stackoverflow.com/questions/41725107/vba-simple-test-if-an-integer-is-a-repeating-number", "title": "VBA simple test if an integer is a repeating number?", "body": "<p>I have an integer I'd like to test to see if it is a repeating number, ie<br>\n999<br>\n9999<br>\n99999<br></p>\n\n<p>the input value range for what the integer is being used for is any three to five digit number, and sometimes that number may be all 9's. Outside of just using multiple OR statements, I'm wondering if there is a more \"elegant\" way to test this?</p>\n"}, {"tags": ["excel", "vba", "performance"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1484758284, "post_id": 41724987, "comment_id": 70644702, "body": "Use arrays instead of constently access the sheet.  Load everything into two arrays and output the data to another array that you will post back one time.  That way you only access the sheets three times.  It cut the run time into the seconds."}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484758445, "post_id": 41724987, "comment_id": 70644832, "body": "I&#39;d load the data into arrays. you can then pull both sets of data off the sheet in one transaction each, then do any comparisons you want between the arrays. As it stands you&#39;re doing around 2.8 million transactions which would explain the speed problems. - @Scott Craner, posted same time but It&#39;s great you had the exact same logic :)"}, {"owner": {"reputation": 25, "user_id": 7178621, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48725d9f1c220f6561194f3e5b5e7a87?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser Al Fanek", "link": "https://stackoverflow.com/users/7178621/nasser-al-fanek"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484927743, "post_id": 41724987, "comment_id": 70726655, "body": "@ScottCraner  thank you , array work is a bit tricky but i am working on it , wish me luck :)"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7178621, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48725d9f1c220f6561194f3e5b5e7a87?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser Al Fanek", "link": "https://stackoverflow.com/users/7178621/nasser-al-fanek"}, "edited": false, "score": 0, "creation_date": 1484758746, "post_id": 41725095, "comment_id": 70645039, "body": "i did but the run time decreased by few seconds , can you please explain the loading and unloading arrays ??"}, {"owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "reply_to_user": {"reputation": 25, "user_id": 7178621, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48725d9f1c220f6561194f3e5b5e7a87?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser Al Fanek", "link": "https://stackoverflow.com/users/7178621/nasser-al-fanek"}, "edited": false, "score": 0, "creation_date": 1484759626, "post_id": 41725095, "comment_id": 70645597, "body": "@NasserAlFanek Please see my updated answer as I have provided an example."}, {"owner": {"reputation": 25, "user_id": 7178621, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48725d9f1c220f6561194f3e5b5e7a87?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser Al Fanek", "link": "https://stackoverflow.com/users/7178621/nasser-al-fanek"}, "edited": false, "score": 0, "creation_date": 1484915368, "post_id": 41725095, "comment_id": 70718821, "body": "thank you very much for clearing that , i will start with the array use , thanks ."}, {"owner": {"reputation": 25, "user_id": 7178621, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48725d9f1c220f6561194f3e5b5e7a87?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser Al Fanek", "link": "https://stackoverflow.com/users/7178621/nasser-al-fanek"}, "edited": false, "score": 0, "creation_date": 1484929501, "post_id": 41725095, "comment_id": 70727751, "body": "just two questions , how can i insert values only from certain columns that i assign , and can i have strings and integers in my array ??"}], "tags": [], "owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "is_accepted": true, "score": 1, "last_activity_date": 1484759580, "last_edit_date": 1484759580, "creation_date": 1484758403, "answer_id": 41725095, "question_id": 41724987, "link": "https://stackoverflow.com/questions/41724987/vba-excel-improve-performance-without-loops/41725095#41725095", "title": "VBA excel , improve performance without loops", "body": "<p>Have you tried adding</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.DisplayAlerts = False\n</code></pre>\n\n<p>at the beginning of your code, and </p>\n\n<pre><code>Application.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>at the end of your code? </p>\n\n<p>This will turn off screen updating, events, and alerts causing faster run-time.</p>\n\n<p>Also, loading and unloading arrays are the fastest way if you decide to take that route.</p>\n\n<p>An example of loading an array:</p>\n\n<pre><code>Dim arr() As Variant ' let brackets empty, not Dim arr(1) As Variant !\n\nFor Each a In Range.Cells\n    ' change / adjust the size of array\n    ReDim Preserve arr(1 To UBound(arr) + 1) As Variant\n\n    ' add value on the end of the array\n    arr(UBound(arr)) = a.Value\nNext\n</code></pre>\n\n<p>An example of iterating through the array to pull your data:</p>\n\n<pre><code>For Each element In arr 'Each array element\n    do_something (element)\nNext element\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7178621, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48725d9f1c220f6561194f3e5b5e7a87?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser Al Fanek", "link": "https://stackoverflow.com/users/7178621/nasser-al-fanek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 41725095, "answer_count": 1, "score": 1, "last_activity_date": 1484759580, "creation_date": 1484758127, "question_id": 41724987, "link": "https://stackoverflow.com/questions/41724987/vba-excel-improve-performance-without-loops", "title": "VBA excel , improve performance without loops", "body": "<p>I have two identical sheets that i want to take the rows of , that are identical in multiple columns (the sheets are 63 columns always and 504 rows and increasing) , i am using two for loops to increase the row in one and then comparing all the rows in the other with that row then increase the row again and compare all the rows of the other with that row ect. till the last row , then an if loop to see if they match my conditions . The problem is that it is taking too much time (about 8 mins) , i tried to use the lookup functions but it failed because it can only take one value . I added the false screenupdating , calculation , and enableevents and even changed the statusbar to something very basic to improve performance but non of them gave me the result I wanted .</p>\n\n<p>How can i improve performance in any way possible , a new function or anything ??</p>\n\n<p>PS some times some of the conditions are not important and it depends on the true or fasle values on some of the cells .</p>\n\n<pre><code>For Row_S = 2 To MAX_Row_S\n  SourceMonth = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, SOP).Value\n  SourceMonth = DatePart(\"m\", SourceMonth)\n  SourceYear = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, SOP).Value\n  SourceYear = DatePart(\"yyyy\", SourceYear)\n  SourceCarmaker = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, carmaker).Value\n  SourceProject = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, Project).Value\n  SourceFamily = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, Family).Value\n  SourceStatus = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, Status).Value\n  SourceShare = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, Share).Value\n  SourceCst = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, \"A\").Value\n  SourcePID = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, ProjectID).Value\n\n  ' Take the data from NBG_Data_Region sheet to be Compared with each row of the NBG_Data_Source_Region sheet\n  For Row_T = 2 To MAX_Row_T\n    If Row_T &gt;= MAX_Row_T Then\n        Exit For\n    End If\n\n    NBGMonth = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, SOP).Value\n    NBGMonth = DatePart(\"m\", NBGMonth)\n    NBGYear = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, SOP).Value\n    NBGYear = DatePart(\"yyyy\", NBGYear)\n    NBGCarmaker = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, carmaker).Value\n    NBGProject = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Project).Value\n    NBGFamily = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Family).Value\n    NBGStatus = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Status).Value\n    NBGShare = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Share).Value\n    NBGCst = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, \"A\").Value\n    NBGPID = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, ProjectID).Value\n\n    ' StatusBar Show\n    Application.StatusBar = \"Running\"\n    'Application.StatusBar = \"VerifyMultipleCustomerProjects. Progress: \" &amp; Row_S &amp; \" of \" &amp; MAX_Row_S\n    ' Check if any project in the NBG_Data_Region have multiple customers and add it ti the sheet Issue_MultipleCustomerProjects\n\n    ' NAF 20161208\n\n    'Test with Source of YEAR and MONTH\n     If ((NBGMonth = SourceMonth Or Worksheets(Issue_MultipleCustomerProjectsWorksheetName).Range(\"C21\") = True) And _\n        (NBGYear = SourceYear Or Worksheets(Issue_MultipleCustomerProjectsWorksheetName).Range(\"C25\") = True) And _\n        (SourceCarmaker = NBGCarmaker Or Worksheets(Issue_MultipleCustomerProjectsWorksheetName).Range(\"G25\") = True) And _\n        (SourceProject = NBGProject Or Worksheets(Issue_MultipleCustomerProjectsWorksheetName).Range(\"F25\") = True) And _\n        (SourceFamily = NBGFamily Or Worksheets(Issue_MultipleCustomerProjectsWorksheetName).Range(\"E25\") = True) And _\n        (SourceShare + NBGShare &lt;&gt; 1 Or Worksheets(Issue_MultipleCustomerProjectsWorksheetName).Range(\"H25\") = True) And NBGCst &lt;&gt; SourceCst) Then\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484757818, "post_id": 41724782, "comment_id": 70644339, "body": "What have you tried so far? What has/hasn&#39;t worked? Basically, you just want to take each worksheet and put it in its own workbook, saved as the name in <code>M4</code>?"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484757953, "post_id": 41724782, "comment_id": 70644451, "body": "@BruceWayne I recorded myself but all it does is says sheet name(&quot;Blank&quot;).select and move.  To answer your second question Yes, I want to move each sheet based on M4 and save the file based on the name in M4"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484759195, "post_id": 41724782, "comment_id": 70645333, "body": "Yeah, the macro to do this would not be too long. Post the code you&#39;ve tried so far. Also look up looping through worksheets. You&#39;ll just want to loop through each worksheet in your workbook, copy as new file, and save as value in M4."}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484759497, "post_id": 41724782, "comment_id": 70645507, "body": "@BruceWayne had do I group sheets that have the same salesmen?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484760092, "post_id": 41724782, "comment_id": 70645889, "body": "Create a two-dimensional array of the Value in M4. One dimension is that name, the second is the sheet name.  Then, just sort the array by the name, and save equivalent sheets from there in a new workbook.  But please show what you&#39;ve tried so far, as SO isn&#39;t a &quot;code for me&quot; site, but rather &quot;help me with my code&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1484759629, "post_id": 41725266, "comment_id": 70645601, "body": "Thanks but I don&#39;t think your understanding my question each Salesmen have multiple worksheets attributed to them.  Your current code is just saving every worksheet based on the value in M4.  I first want to create workbooks that have all worksheets with the same salesmen in them, than save it. @BYates"}, {"owner": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1484761544, "post_id": 41725266, "comment_id": 70646695, "body": "Check it out now. The workbook will have a blank sheet at the beginning but if you need to you can delete it at the end or something."}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1484771162, "post_id": 41725266, "comment_id": 70652014, "body": "Thanks @BYates you saved me so much time thanks a million."}, {"owner": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1484780110, "post_id": 41725266, "comment_id": 70656231, "body": "Glad to help. Though as BruceWayne mentioned, it&#39;s better if you provide code others can help you with rather than requesting code...but we can let this one slide :)"}], "tags": [], "owner": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "is_accepted": true, "score": 3, "last_activity_date": 1484761511, "last_edit_date": 1484761511, "creation_date": 1484758888, "answer_id": 41725266, "question_id": 41724782, "link": "https://stackoverflow.com/questions/41724782/vba-split-workbook-into-multiple-workbooks-based-on-cell-value/41725266#41725266", "title": "VBA Split Workbook into multiple workbooks based on cell value", "body": "<pre><code>Sub WayEatFresh()\n\nFor i = 1 To ThisWorkbook.Sheets.Count\n  NewWorkbookName = ThisWorkbook.Sheets(i).Cells(4, 13).Value\n  ThisWorkbook.Sheets(i).Copy\n  ActiveWorkbook.SaveAs \"C:\\YourFilePath\\\" &amp; NewWorkbookName &amp; \".xlsx\", FileFormat:=51\nNext\n\nEnd Sub\n</code></pre>\n\n<p>EDIT:</p>\n\n<pre><code>Sub WayEatFresh()\n\nSalesmen = \"\"\nFor i = 1 To ThisWorkbook.Sheets.Count\n   If InStr(Salesmen, ThisWorkbook.Sheets(i).Cells(4, 13).Value) = 0 Then\n    If Salesmen = \"\" Then\n      Salesmen = ThisWorkbook.Sheets(i).Cells(4, 13).Value\n    Else\n      Salesmen = Salesmen &amp; \"-&gt;\" &amp; ThisWorkbook.Sheets(i).Cells(4, 13).Value\n    End If\n  End If\nNext\n\nSalesmanArray = Split(Salesmen, \"-&gt;\")\n\nFor i = 0 To UBound(SalesmanArray)\n    NewWorkbookName = SalesmanArray(i)\n    Set NewWB = Workbooks.Add\n    For j = 1 To ThisWorkbook.Sheets.Count\n        If ThisWorkbook.Sheets(j).Cells(4, 13).Value = SalesmanArray(i) Then\n            ThisWorkbook.Sheets(j).Copy After:=NewWB.Sheets(1)\n        End If\n    Next\n\n    NewWB.SaveAs (\"C:\\YourLocation\\\" &amp; NewWorkbookName &amp; \".xlsx\")\n    NewWB.Close\n    Set NewWB = Nothing\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "accepted_answer_id": 41725266, "answer_count": 1, "score": -1, "last_activity_date": 1526372471, "creation_date": 1484757607, "last_edit_date": 1526372471, "question_id": 41724782, "link": "https://stackoverflow.com/questions/41724782/vba-split-workbook-into-multiple-workbooks-based-on-cell-value", "title": "VBA Split Workbook into multiple workbooks based on cell value", "body": "<p>I have a workbook with over 200 worksheets.  Each worksheet has salesmen name in cell M4.  I want to create a macro that loops through each worksheet and splits the master workbook into separate workbooks for each salesmen name based on the value in M4, so I can email it to them separately.  I figure it would be easier if I had an array with each salesmen name.  Can anyone assist me with a code that can do this process?   To further explain in my current workbook salesmen 1 has 5 worksheets with their name in M4, Salesmen 2 has 3 worksheets with their name in cell M4.  So for each Salesmen I want to move all worksheets into one file and than save it.</p>\n"}, {"tags": ["excel", "vba", "filter", "wildcard", "autofilter"], "comments": [{"owner": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "edited": false, "score": 0, "creation_date": 1484758023, "post_id": 41724693, "comment_id": 70644505, "body": "I didn&#39;t test this out and not sure how it would work, but what if you did <code>CStr(txt)</code>?"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1484758169, "post_id": 41724693, "comment_id": 70644622, "body": "I just test the codes. It is working fine. No error, it is catching 20... Do you formatted <code>Column A</code> as text? If not, then it will not catch ...20..."}, {"owner": {"reputation": 443, "user_id": 3108789, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/35d7cdf2d7765aef6a258d512e8ea2a3?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyW", "link": "https://stackoverflow.com/users/3108789/johnnyw"}, "reply_to_user": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "edited": false, "score": 0, "creation_date": 1484758228, "post_id": 41724693, "comment_id": 70644653, "body": "@BYates That would only cast the users text box entry to a string, not the cells being searched. I tried anyway and no change."}, {"owner": {"reputation": 443, "user_id": 3108789, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/35d7cdf2d7765aef6a258d512e8ea2a3?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyW", "link": "https://stackoverflow.com/users/3108789/johnnyw"}, "reply_to_user": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1484758393, "post_id": 41724693, "comment_id": 70644798, "body": "@harun24hr The first thing I tried was formatting the cells as text, but it does not work for me. If I use isNumeric(cell#), it returns true even though I changed the cell to text."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1484759579, "post_id": 41724693, "comment_id": 70645559, "body": "@JohnnyW for testing purpose, take a new sheet. Format <code>Column A</code> as text then entry data and run your code. I think it will work as it work to me."}, {"owner": {"reputation": 443, "user_id": 3108789, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/35d7cdf2d7765aef6a258d512e8ea2a3?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyW", "link": "https://stackoverflow.com/users/3108789/johnnyw"}, "reply_to_user": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1484770526, "post_id": 41724693, "comment_id": 70651686, "body": "@harun24hr Looks like you were sort of correct. It was a copy paste issue. I was not able to copy paste then change the cell formatting to text for some reason. I had to define the cell as text, then enter the data. Luckily the table is not that large yet so it wasn&#39;t too hard to fix. Thanks for your suggestion, it got me on the right track!"}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1616183350, "post_id": 41724693, "comment_id": 117932748, "body": "<code>Criteria1:=&quot;=*&quot; &amp; ThresholdOLFilterStr &amp; &quot;*&quot;</code>"}], "owner": {"reputation": 443, "user_id": 3108789, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/35d7cdf2d7765aef6a258d512e8ea2a3?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyW", "link": "https://stackoverflow.com/users/3108789/johnnyw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1839, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484757353, "creation_date": 1484757353, "question_id": 41724693, "link": "https://stackoverflow.com/questions/41724693/how-to-use-vba-autofilter-with-wildcards-on-both-strings-and-numbers", "title": "How to use VBA autofilter with wildcards on both strings and numbers?", "body": "<p>I am using the autofilter function in VBA to filter an excel sheet. Below is a picture of a piece of the table.</p>\n\n<p><a href=\"https://i.stack.imgur.com/16wmu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/16wmu.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The code below executes when a users makes a change to a text box on the same worksheet. The issue I am having is that any cell that contains only a number (such as 2084) is filtered out due to my use of wildcards in the filter. The filter works fine on cells that contain letters. How would I go about converting the numeric cells to strings such that my filter would catch 2084 if the users enters \"20\" in the text box?</p>\n\n<pre><code>Private Sub TextBox2_Change()\n    Dim Txt As String\n    Dim rng As Range\n\n    Txt = TextBox2.Text\n    Set rng = ActiveSheet.Range(\"a13:a1000\")\n    If Len(Txt) &gt; 0 Then\n        rng.AutoFilter Field:=1, Criteria1:=\"*\" &amp; Txt &amp; \"*\"\n    Else\n        rng.AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\" &amp; Txt\n    End If\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7436686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee4b980d6f4f96b6639103d4989f622?s=128&d=identicon&r=PG&f=1", "display_name": "randyvelour", "link": "https://stackoverflow.com/users/7436686/randyvelour"}, "edited": false, "score": 1, "creation_date": 1484771363, "post_id": 41724827, "comment_id": 70652093, "body": "Thank you for the links. I had looked at those previously but must have missed one of the solutions. The solution as described in one of the links is to append <code>OLEDB</code> to the connection string stored in the variable and it works for my purposes. Thanks again"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1484757712, "last_edit_date": 1495535363, "creation_date": 1484757712, "answer_id": 41724827, "question_id": 41724483, "link": "https://stackoverflow.com/questions/41724483/vba-macro-to-update-data-connection-connection-field-not-accepting-a-variable/41724827#41724827", "title": "VBA macro to update data connection. Connection field not accepting a variable", "body": "<p>Connection string and changing it seems to be a bit problematic with VBA. Check these posts:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/16695704/microsoft-excel-data-connections-alter-connection-string-through-vba\">Microsoft Excel Data Connections - Alter Connection String through VBA</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/2708086/excel-macro-to-change-external-data-query-connections-e-g-point-from-one-data\">Excel macro to change external data query connections - e.g. point from one database to another</a> </p>\n\n<p>Thus, probably it is better idea to follow the MS examples for connection:\n<a href=\"https://technet.microsoft.com/de-de/library/ee692882.aspx\" rel=\"nofollow noreferrer\">https://technet.microsoft.com/de-de/library/ee692882.aspx</a></p>\n"}], "owner": {"reputation": 11, "user_id": 7436686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee4b980d6f4f96b6639103d4989f622?s=128&d=identicon&r=PG&f=1", "display_name": "randyvelour", "link": "https://stackoverflow.com/users/7436686/randyvelour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1185, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1526372480, "creation_date": 1484756740, "last_edit_date": 1526372480, "question_id": 41724483, "link": "https://stackoverflow.com/questions/41724483/vba-macro-to-update-data-connection-connection-field-not-accepting-a-variable", "title": "VBA macro to update data connection. Connection field not accepting a variable", "body": "<p>I'm writing a macro that asks for user input to update the catalog and server fields within the connection string of an excel data connection. </p>\n\n<pre><code>Sub Connection_String()\n\nDim ConnectionString As String\nDim Catalog As String\nDim Server As String\n\nCatalog = InputBox(\"Catalog\", MsgTitle, \"\")\nServer = InputBox(\"Server\", MsgTitle, \"\")\nConnectionString = \"Provider=MSOLAP;Persist Security Info=True;Initial Catalog=\" &amp; Catalog &amp; _\n\";Data Source=\" &amp; Server &amp; \";Auto Synch Period=10000;Cache Ratio=1;MDX Compatibility=1;MDX Unique Name Style=2;\" &amp; _\n\"Safety Options=2;MDX Missing Member Mode=Error;Disable Prefetch Facts=True\"\n\nWith ActiveWorkbook.Connections(\"Example Connection\").OLEDBConnection\n    .CommandText = \"Example Command Text\"\n    .CommandType = xlCmdCube\n    .Connection = ConnectionString\n    .RefreshOnFileOpen = False\n    .SavePassword = False\n    .SourceConnectionFile = \"\"\n    .MaxDrillthroughRecords = 1000\n    .ServerCredentialsMethod = xlCredentialsMethodIntegrated\n    .AlwaysUseConnectionFile = False\n    .RetrieveInOfficeUILang = True\nEnd With\n</code></pre>\n\n<p>The problem I'm running into is that I get a \"Runtime Error 1004 Application Defined or Object Defined Error\" referencing the <code>.Connection = ConnectionString</code> line within the <code>with</code> statement. If I set <code>.Connection</code> to the full connection string itself rather than the ConnectionString variable it works. </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013", "ms-access-2016"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2872592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X1LjN.jpg?s=128&g=1", "display_name": "Barry Seymour", "link": "https://stackoverflow.com/users/2872592/barry-seymour"}, "edited": false, "score": 0, "creation_date": 1484855737, "post_id": 41725066, "comment_id": 70693469, "body": "Perfect! Exactly what I was looking for, works a treat. Thank you!"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 51, "user_id": 2872592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X1LjN.jpg?s=128&g=1", "display_name": "Barry Seymour", "link": "https://stackoverflow.com/users/2872592/barry-seymour"}, "edited": false, "score": 0, "creation_date": 1484860786, "post_id": 41725066, "comment_id": 70696290, "body": "If the answer solved your problem, you can <a href=\"http://stackoverflow.com/help/someone-answers\">accept</a> it, this also marks the question as resolved. @BarrySeymour"}, {"owner": {"reputation": 51, "user_id": 2872592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X1LjN.jpg?s=128&g=1", "display_name": "Barry Seymour", "link": "https://stackoverflow.com/users/2872592/barry-seymour"}, "edited": false, "score": 0, "creation_date": 1484951191, "post_id": 41725066, "comment_id": 70738163, "body": "Thanks. Wasn&#39;t sure where that option was, but I found it."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1484758335, "creation_date": 1484758335, "answer_id": 41725066, "question_id": 41724465, "link": "https://stackoverflow.com/questions/41724465/how-to-detect-if-your-microsoft-access-application-is-compiled-i-e-running-as/41725066#41725066", "title": "How to detect if your Microsoft Access application is compiled, i.e. running as an ACCDE", "body": "<p>Adapted from <a href=\"https://access-programmers.co.uk/forums/showthread.php?t=229474\" rel=\"nofollow noreferrer\">https://access-programmers.co.uk/forums/showthread.php?t=229474</a> and <a href=\"http://allenbrowne.com/ser-53.html\" rel=\"nofollow noreferrer\">http://allenbrowne.com/ser-53.html</a></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function IsACCDE() As Boolean\n\n    ' Init\n    IsACCDE = False\n\n    ' This property exists only in compiled DBs (.mde, .accde)!\n    ' Ignore error (and stay \"False\") if not.\n    On Error Resume Next\n    IsACCDE = (CurrentDb.Properties(\"MDE\") = \"T\")\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1563890189, "post_id": 57163207, "comment_id": 100845344, "body": "This answers a different question. <code>IsCompiled</code> will always be true in an .accde, it can be false only in an .accdb"}], "tags": [], "owner": {"reputation": 1, "user_id": 4747390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZgKTkAnOr28/AAAAAAAAAAI/AAAAAAAAAEA/NFQld7n4MQU/photo.jpg?sz=128", "display_name": "Tom Hamilton", "link": "https://stackoverflow.com/users/4747390/tom-hamilton"}, "is_accepted": false, "score": 0, "last_activity_date": 1563882670, "last_edit_date": 1563882670, "creation_date": 1563881407, "answer_id": 57163207, "question_id": 41724465, "link": "https://stackoverflow.com/questions/41724465/how-to-detect-if-your-microsoft-access-application-is-compiled-i-e-running-as/57163207#57163207", "title": "How to detect if your Microsoft Access application is compiled, i.e. running as an ACCDE", "body": "<p>I use this which is part of Access VBA:</p>\n\n<pre><code>If IsCompiled = False Then\n        DoCmd.RunCommand (acCmdCompileAndSaveAllModules)\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 523, "user_id": 1513027, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1a54b1b42729639cb26a13e7f0148062?s=128&d=identicon&r=PG", "display_name": "BWhite", "link": "https://stackoverflow.com/users/1513027/bwhite"}, "is_accepted": false, "score": 0, "last_activity_date": 1618521241, "creation_date": 1618521241, "answer_id": 67116126, "question_id": 41724465, "link": "https://stackoverflow.com/questions/41724465/how-to-detect-if-your-microsoft-access-application-is-compiled-i-e-running-as/67116126#67116126", "title": "How to detect if your Microsoft Access application is compiled, i.e. running as an ACCDE", "body": "<p>I couldn't find any properties that consistently gave me the correct answer. Then I realized that those approaches were all approximations to what I really wanted to know. Now I just ask directly if it is an accde.</p>\n<pre><code>Private Function InDevelopment() As Boolean\n\nOn Error Resume Next\n\n    InDevelopment = False\n    InDevelopment = (InStr(CurrentDb.Properties(&quot;Name&quot;), &quot;accde&quot;) = 0)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 2872592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X1LjN.jpg?s=128&g=1", "display_name": "Barry Seymour", "link": "https://stackoverflow.com/users/2872592/barry-seymour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1032, "favorite_count": 0, "accepted_answer_id": 41725066, "answer_count": 3, "score": 0, "last_activity_date": 1618521241, "creation_date": 1484756686, "last_edit_date": 1547649332, "question_id": 41724465, "link": "https://stackoverflow.com/questions/41724465/how-to-detect-if-your-microsoft-access-application-is-compiled-i-e-running-as", "title": "How to detect if your Microsoft Access application is compiled, i.e. running as an ACCDE", "body": "<p>Does anyone have any VBA to detect if your Microsoft Access 2013/2016 application is running as an ACCDE, i.e. is compiled?</p>\n\n<p>I would like my code to stop and break if an error happens and a) it's me running it (environ(\"username')) and if it's not an ACCDE. </p>\n\n<p>Anyone have any suggestions?</p>\n"}, {"tags": ["vba", "excel", "sendmail"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1484756730, "post_id": 41724452, "comment_id": 70643603, "body": "you may have a warning regarding access to outlook, in outlook. <a href=\"https://community.sophos.com/cfs-file/__key/telligent-evolution-components-attachments/00-03-00-00-00-00-69-59/outlook.png\" rel=\"nofollow noreferrer\">community.sophos.com/cfs-file/__key/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 949, "user_id": 2646929, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001164962766/picture?type=large", "display_name": "Bhanu Sinha", "link": "https://stackoverflow.com/users/2646929/bhanu-sinha"}, "edited": false, "score": 2, "creation_date": 1527506920, "post_id": 41724823, "comment_id": 88140809, "body": "SendKeys &quot;%S&quot; doesn&#39;t work when the system is locked. The workaround is to save the email to an email folder. On the add_item event of the folder write code to send it. So when an item gets added to that folder, the item will be sent automatically"}], "tags": [], "owner": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "is_accepted": false, "score": 1, "last_activity_date": 1484757706, "creation_date": 1484757706, "answer_id": 41724823, "question_id": 41724452, "link": "https://stackoverflow.com/questions/41724452/send-not-working-vba-but-display-is/41724823#41724823", "title": ".send not working vba but .display is", "body": "<p>As @Nathan_Sav mentioned, you can probably play around with your Outlook security features. As an alternative, you can experiment with the <code>.SendKeys</code> function...though please note that this is not a very reliable method, especially if you are going to need other people/other machines to try and use this macro.</p>\n\n<p>But if you replace</p>\n\n<pre><code>.Send\n</code></pre>\n\n<p>With</p>\n\n<pre><code>.SendKeys \"%S\"\n</code></pre>\n\n<p>It might work for you.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7436736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9de9a83893d64eee4d818307a3258e91?s=128&d=identicon&r=PG&f=1", "display_name": "HighwayDreamer", "link": "https://stackoverflow.com/users/7436736/highwaydreamer"}, "edited": false, "score": 0, "creation_date": 1484865049, "post_id": 41724957, "comment_id": 70698360, "body": "Thanks but your suggestion still doesn&#39;t seem to work. I get the following error message:  Run-time error &#39;287: Application-defined or object-defined error."}, {"owner": {"reputation": 31351, "user_id": 1447509, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AYREu.jpg?s=128&g=1", "display_name": "cssyphus", "link": "https://stackoverflow.com/users/1447509/cssyphus"}, "edited": false, "score": 0, "creation_date": 1532707213, "post_id": 41724957, "comment_id": 90090087, "body": "Thanks for this - gave me the clue I needed in order to discover that the emails were going into my junk folder. <i>(Who&#39;d a thunk that emails</i> <b><i>from</i></b> <i>me</i> <b><i>to</i></b> <i>me would be delivered into the junk folder - arghhhh.)</i>"}], "tags": [], "owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "is_accepted": false, "score": 0, "last_activity_date": 1484758057, "creation_date": 1484758057, "answer_id": 41724957, "question_id": 41724452, "link": "https://stackoverflow.com/questions/41724452/send-not-working-vba-but-display-is/41724957#41724957", "title": ".send not working vba but .display is", "body": "<p><code>.Display</code> will give you a view of the email. If this step works, then <code>.Send</code> will work efficiently. When using <code>.Send</code> you will receive a message box acknowledging that a 3rd party program is trying to access outlook (If everything is configured correctly). To fix this if it is not configured, open the workbook and then open the VBE (Alt+F11). From there goto Tools-->References and uncheck any that are marked \"Missing\". If possible, look for the appropriate Outlook Object library and check it.</p>\n\n<pre><code>Sub SendEmails()\n\nDim olApp As Outlook.Application\nDim olMail As Outlook.MailItem\n\nFor i = 8 To 10\n    Set olApp = New Outlook.Application\n    Set olMail = olApp.CreateItem(olMailItem)\n\n    With olMail\n    .BCC = Cells(i, 1).Value\n    .Subject = Cells(i, 2).Value\n    .Body = \"Hello \" &amp; Cells(i, 3).Value &amp; \",\" &amp; vbNewLine &amp; vbNewLine &amp; Cells(i, 4).Value &amp; vbNewLine &amp; vbNewLine &amp; Cells(i, 5).Value &amp; vbNewLine &amp; Cells(i, 6).Value\n    .Attachments.Add \"H:\\Shared\\Public\\Focus 6\\Private Equity\\Send Emails\\2017-01-18\\EY - Capitalizing on Opportunities (PE O&amp;G).pdf\"\n    .Display\n\n    End With\nNext\n\nSet olMail = Nothing\nSet olApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9742181, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9d1d46e03f405f06f1eb2fe37b3723fd?s=128&d=identicon&r=PG", "display_name": "Enver", "link": "https://stackoverflow.com/users/9742181/enver"}, "is_accepted": false, "score": 0, "last_activity_date": 1525448604, "creation_date": 1525448604, "answer_id": 50178669, "question_id": 41724452, "link": "https://stackoverflow.com/questions/41724452/send-not-working-vba-but-display-is/50178669#50178669", "title": ".send not working vba but .display is", "body": "<p>Most organizational emails have a  mandatory document/email labelling policy where you have to choose between options like public, restricted, confidential, etc. If your outlook is setup so that you must choose one of these options before sending the email, this might be the reason for getting an error. There aren't many solutions that I know of for this issue, other than deactivating the plugin that requires you to label emails before sending them. But maybe someone else may have other suggestions.</p>\n"}], "owner": {"reputation": 11, "user_id": 7436736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9de9a83893d64eee4d818307a3258e91?s=128&d=identicon&r=PG&f=1", "display_name": "HighwayDreamer", "link": "https://stackoverflow.com/users/7436736/highwaydreamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6555, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1525448604, "creation_date": 1484756661, "question_id": 41724452, "link": "https://stackoverflow.com/questions/41724452/send-not-working-vba-but-display-is", "title": ".send not working vba but .display is", "body": "<p>My \".send\" is not working however my \".display\" is? I keep getting an object defined error. and when I debug it highlights the \".send\". Any suggestions?</p>\n\n<pre><code>Sub SendEmails()\n\nDim olApp As Outlook.Application\nDim olMail As Outlook.MailItem\n\nFor i = 8 To 10\n    Set olApp = New Outlook.Application\n    Set olMail = olApp.CreateItem(olMailItem)\n\n    With olMail\n    .BCC = Cells(i, 1).Value\n    .Subject = Cells(i, 2).Value\n    .Body = \"Hello \" &amp; Cells(i, 3).Value &amp; \",\" &amp; vbNewLine &amp; vbNewLine &amp; Cells(i, 4).Value &amp; vbNewLine &amp; vbNewLine &amp; Cells(i, 5).Value &amp; vbNewLine &amp; Cells(i, 6).Value\n    .Attachments.Add \"H:\\Shared\\Public\\Focus 6\\Private Equity\\Send Emails\\2017-01-18\\EY - Capitalizing on Opportunities (PE O&amp;G).pdf\"\n    .Send\n\n    End With\nNext\n\nSet olMail = Nothing\nSet olApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5, "user_id": 7174373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/26e45a2364a1cffb286be65be5dcbc54?s=128&d=identicon&r=PG&f=1", "display_name": "InternGrant", "link": "https://stackoverflow.com/users/7174373/interngrant"}, "edited": false, "score": 0, "creation_date": 1484756712, "post_id": 41724358, "comment_id": 70643588, "body": "originally I had this in place for the copy over <code>results.Range(&quot;A&quot; &amp; j &amp; &quot;:W&quot; &amp; j) = info.Range(&quot;A&quot; &amp; i &amp; &quot;:W&quot; &amp; i).Value</code> but it resulted in the same error"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1484757476, "post_id": 41724358, "comment_id": 70644102, "body": "Unrelated, but <code>Dim i, j, k As Integer</code> - note only <code>k</code> is <code>As Integer</code>. <code>i</code> and <code>j</code> are both implicitly <code>Variant</code>. Also should probably be <code>As Long</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "reply_to_user": {"reputation": 5, "user_id": 7174373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/26e45a2364a1cffb286be65be5dcbc54?s=128&d=identicon&r=PG&f=1", "display_name": "InternGrant", "link": "https://stackoverflow.com/users/7174373/interngrant"}, "edited": false, "score": 0, "creation_date": 1484757310, "post_id": 41724501, "comment_id": 70643985, "body": "@InternGrant I&#39;m glad this worked for you. When you can, please mark this as the correct answer for others to reference from it as well. Thank you."}], "tags": [], "owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "is_accepted": true, "score": 1, "last_activity_date": 1484757412, "last_edit_date": 1484757412, "creation_date": 1484756782, "answer_id": 41724501, "question_id": 41724358, "link": "https://stackoverflow.com/questions/41724358/error-when-copying-row-to-another-sheet/41724501#41724501", "title": "Error when copying row to another sheet", "body": "<p>This is happening because your var <code>J</code> is declared as 0. <code>.Cells(0, 1)</code> is a invalid cell. Adjust <code>J</code>'s value to <code>1</code> to fix this.</p>\n\n<pre><code>Sub RoundedRectangle1_Click()\n\nDim info As Range\nDim filter As Range\nDim results As Range\n\nSet info = Worksheets(\"Info\").Cells(4, 5)\nSet filter = Worksheets(\"Filter\").Cells(2, 1)\nSet results = Worksheets(\"Results\").Cells(1, 1)\n\nDim i, j, k As Integer\n\ni = 0\nj = 1  'Error fixed here\nk = 0\n\nDo While info.Offset(i, 0) &lt;&gt; \"\"\n\nIf InStr(1, LCase(info.Offset(i, 0)), LCase(filter.Offset(k, 0))) &lt;&gt; 0 Then\ninfo.Offset(i, 0).EntireRow.Copy results.Cells(j, 1)\ni = i + 1\nj = j + 1\nk = 0\nElse\nIf filter.Offset(k, 0) = \"\" Then\ni = i + 1\nk = 0\nElse\nk = k + 1\nEnd If\nEnd If\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1484758023, "creation_date": 1484758023, "answer_id": 41724948, "question_id": 41724358, "link": "https://stackoverflow.com/questions/41724358/error-when-copying-row-to-another-sheet/41724948#41724948", "title": "Error when copying row to another sheet", "body": "<p>if you don't mind the order of rows pasted into \"Results\" sheet you may want to try this:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim resultWS As Worksheet\n    Dim subStrings As Variant, subString As Variant\n\n    With Worksheets(\"Filter\")\n        subStrings = Application.Transpose(.Range(\"A2\", .Cells(.Rows.count, 1).End(xlUp)))\n    End With\n\n    Set resultWS = Worksheets(\"Results\")\n\n    With Worksheets(\"Info\")\n        With .Range(\"E3\", .Cells(.Rows.count, \"E\").End(xlUp))\n            For Each subString In subStrings\n                .AutoFilter field:=1, Criteria1:=subString\n                If Application.WorksheetFunction.Subtotal(103, .Resize(, 1)) &gt; 1 Then Intersect(.Resize(.Rows.count - 1).Offset(1).SpecialCells(xlCellTypeVisible).EntireRow, .Parent.UsedRange).Copy resultWS.Cells(.Rows.count, 1).End(xlUp).Offset(1)\n            Next\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7174373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/26e45a2364a1cffb286be65be5dcbc54?s=128&d=identicon&r=PG&f=1", "display_name": "InternGrant", "link": "https://stackoverflow.com/users/7174373/interngrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 41724501, "answer_count": 2, "score": 0, "last_activity_date": 1484758023, "creation_date": 1484756448, "question_id": 41724358, "link": "https://stackoverflow.com/questions/41724358/error-when-copying-row-to-another-sheet", "title": "Error when copying row to another sheet", "body": "<p>The code below brings up an error when trying to copy row over to new sheet.\nThe excel sheet has 3 sheets, info (data export), filter(string names), results(blank sheet)</p>\n\n<p>The code is supposed to match substring from filter worksheet with main string on info worksheet. If the substring is contained in the main string, it will copy the entire row over to the results worksheet. The error comes up when it's trying to copy over. </p>\n\n<p>I could be overcomplicating the process, any help is greatly appreciated. Thanks in advance. </p>\n\n<p>Error: Run-time error '1004':\nApplication-defined or object-defined error</p>\n\n<pre><code>Sub RoundedRectangle1_Click()\n\nDim info As Range\nDim filter As Range\nDim results As Range\n\nSet info = Worksheets(\"Info\").Cells(4, 5)\nSet filter = Worksheets(\"Filter\").Cells(2, 1)\nSet results = Worksheets(\"Results\").Cells(1, 1)\n\nDim i, j, k As Integer\n\ni = 0\nj = 0\nk = 0\n\nDo While info.Offset(i, 0) &lt;&gt; \"\"\n\nIf InStr(1, LCase(info.Offset(i, 0)), LCase(filter.Offset(k, 0))) &lt;&gt; 0 Then\ninfo.Offset(i, 0).EntireRow.Copy results.Cells(j, 1)\ni = i + 1\nj = j + 1\nk = 0\nElse\nIf filter.Offset(k, 0) = \"\" Then\ni = i + 1\nk = 0\nElse\nk = k + 1\nEnd If\nEnd If\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "grouping", "collapse", "outline"], "answers": [{"comments": [{"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1572057135, "post_id": 41838574, "comment_id": 103453174, "body": "For those looking to show/hide columns, this answer is a bit misleading.  It&#39;s not good enough to just use <code>.EntireColumn</code>, you need to use the <code>.Columns</code> property, as in <code>.EntireColumn.Columns.ShowDetail = </code>"}], "tags": [], "owner": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "is_accepted": true, "score": 0, "last_activity_date": 1485290351, "creation_date": 1485290351, "answer_id": 41838574, "question_id": 41724275, "link": "https://stackoverflow.com/questions/41724275/collapse-some-groups-not-all-using-vba/41838574#41838574", "title": "Collapse Some Groups (Not All) Using VBA", "body": "<p>I was able to come up with a short macro to do this:</p>\n\n<pre><code>Application.ScreenUpdating = False\n\n    Dim row As Range\n\n    For i = 3 To getLastRow\n        Set row = shtOTP.Range(\"A\" &amp; i)\n\n        If row.EntireRow.Hidden = True Then                 \n            'Do nothing\n        ElseIf row.Value = \"SM\" Then                        'Minor Sub-model row, needs to be collapse\n            If shtOTP.Rows(i).EntireRow.ShowDetail = True Then\n                shtOTP.Rows(i).EntireRow.ShowDetail = False\n            End If\n        End If\n    Next\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>I placed \"SM\" in the A cell of the row for accessories to better identify them.</p>\n"}], "owner": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6369, "favorite_count": 0, "accepted_answer_id": 41838574, "answer_count": 1, "score": 0, "last_activity_date": 1485290351, "creation_date": 1484756244, "last_edit_date": 1484840433, "question_id": 41724275, "link": "https://stackoverflow.com/questions/41724275/collapse-some-groups-not-all-using-vba", "title": "Collapse Some Groups (Not All) Using VBA", "body": "<p>I'm hoping someone may be able to help get me here...</p>\n\n<p>I have a huge list and am using grouping to organize it:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mHQQH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mHQQH.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see I have a Major Group row that has a number of products grouped into it. Then, some products have accessories that are then grouped under that part. </p>\n\n<p>What I want, is to collapse ALL the accessories groups of ONLY the products showing. The below code will expand groups that are not expanded, I don't want that. </p>\n\n<pre><code>shtOTP.Outline.ShowLevels RowLevels:=4\nshtOTP.Outline.ShowLevels RowLevels:=3\nshtOTP.Outline.ShowLevels RowLevels:=2\nActiveWindow.ScrollRow = shtOTP.Range(\"A3\").row 'Go to top of sheet\n</code></pre>\n\n<p>I've tried looking into the <code>.Outline.Parent</code> <code>.Outline.SummaryRow</code> functions but as far as I can tell they don't identify a \"parent\" of the group. </p>\n\n<p>I can do a loop like the following:</p>\n\n<pre><code>For i = 3 To getLastRow\n    Dim nextRow As Integer\n    nextRow = shtOTP.Rows(i+1).row\n    If nextRow = ParentRow And i.EntireRow.Hidden = False Then\n        'Collapse the group below the product\n    End If\nNext\n</code></pre>\n\n<p>But... </p>\n\n<p><strong>HOW</strong> do I identify if the nextRow is a parentRow?</p>\n\n<p><strong>HOW</strong> do I collapse JUST THAT GROUP?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1484756015, "creation_date": 1484756015, "answer_id": 41724201, "question_id": 41724147, "link": "https://stackoverflow.com/questions/41724147/indirect-if-statments-keeps-giving-ref/41724201#41724201", "title": "INDIRECT If Statments keeps giving #REF", "body": "<p>Use index:</p>\n\n<pre><code>=IF(INDEX('Tracker Sheet'!C:C,27)=\"\",\"\",INDEX('Tracker Sheet'!C:C,27))\n</code></pre>\n\n<p>As long as you use the cell address directly when it is deleted it will return <code>#REF</code> as you are deleting the reference.</p>\n\n<p>This will always look at what is the current 27th row in column C.</p>\n"}], "owner": {"reputation": 670, "user_id": 7286051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bce9ea1a1327b531e720dbbcd01714a3?s=128&d=identicon&r=PG&f=1", "display_name": "adam Wadsworth", "link": "https://stackoverflow.com/users/7286051/adam-wadsworth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 41724201, "answer_count": 1, "score": 0, "last_activity_date": 1484756015, "creation_date": 1484755833, "question_id": 41724147, "link": "https://stackoverflow.com/questions/41724147/indirect-if-statments-keeps-giving-ref", "title": "INDIRECT If Statments keeps giving #REF", "body": "<p>I'm trying to change an if statement to an indirect one as the current one that works keeps changing from C27 to #REF! when I delete Row 27 in the Tracker sheet. </p>\n\n<pre><code>  =IF('Tracker Sheet'!C27=\"\",\"\",'Tracker Sheet'!C27)\n</code></pre>\n\n<p>This is the old if statement that works </p>\n\n<pre><code>  =IF(INDIRECT('Tracker Sheet'!C27)=\"\",\"\",INDIRECT('Tracker Sheet'!C27))\n</code></pre>\n\n<p>This is the if statement that I try to convert but gives me #REF!</p>\n\n<p>Any help would be greatly appreciated </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 2, "creation_date": 1484755343, "post_id": 41723815, "comment_id": 70642605, "body": "The Format function returns a string, not a date."}], "answers": [{"comments": [{"owner": {"reputation": 935, "user_id": 3501476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e105c5b8ca5254df01955c86dd500c5d?s=128&d=identicon&r=PG&f=1", "display_name": "user3501476", "link": "https://stackoverflow.com/users/3501476/user3501476"}, "edited": false, "score": 0, "creation_date": 1484766795, "post_id": 41723985, "comment_id": 70649565, "body": "Could I get away with simply doing this <code>currDt =DateAdd(&quot;d&quot;, 20, todDate)</code> and having <code>Dim currDt As string</code>? I will have to then use <code>DateAdd</code> with <code>currDt</code> and would therefore think that it would be easier to have it as a <code>Date</code> instead of a <code>String</code>"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 935, "user_id": 3501476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e105c5b8ca5254df01955c86dd500c5d?s=128&d=identicon&r=PG&f=1", "display_name": "user3501476", "link": "https://stackoverflow.com/users/3501476/user3501476"}, "edited": false, "score": 0, "creation_date": 1484815735, "post_id": 41723985, "comment_id": 70668064, "body": "@user3501476 well that depends on the purpose really, I would keep the date stored in a date format until i needed the user to see it, then every time you want to make a cell/messagebox equal to the date in the format mmddyyyy convert the date.  Does that make sense?  In short, keep it as a date (where the format doesn&#39;t matter) until you need to print it (where presentation is important)"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 935, "user_id": 3501476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e105c5b8ca5254df01955c86dd500c5d?s=128&d=identicon&r=PG&f=1", "display_name": "user3501476", "link": "https://stackoverflow.com/users/3501476/user3501476"}, "edited": false, "score": 0, "creation_date": 1484815815, "post_id": 41723985, "comment_id": 70668117, "body": "@user3501476 unless I&#39;ve misunderstood, are you trying to specify what format the date is already in with &quot;Format(...&quot;?"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 935, "user_id": 3501476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e105c5b8ca5254df01955c86dd500c5d?s=128&d=identicon&r=PG&f=1", "display_name": "user3501476", "link": "https://stackoverflow.com/users/3501476/user3501476"}, "edited": false, "score": 0, "creation_date": 1484816871, "post_id": 41723985, "comment_id": 70668730, "body": "@user3501476 if the latter is the case, Jean-Fran&#231;ois Corbett&#39;s answer here would make some interesting reading.  Essentially read in the variable correctly and store it as a date, then print it in the form that you like using format."}, {"owner": {"reputation": 935, "user_id": 3501476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e105c5b8ca5254df01955c86dd500c5d?s=128&d=identicon&r=PG&f=1", "display_name": "user3501476", "link": "https://stackoverflow.com/users/3501476/user3501476"}, "edited": false, "score": 0, "creation_date": 1484836661, "post_id": 41723985, "comment_id": 70681551, "body": "I see! So any idea as to why I am getting the runtime errors when I remove all of the formats and have every variable as a <code>Date</code>?"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 935, "user_id": 3501476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e105c5b8ca5254df01955c86dd500c5d?s=128&d=identicon&r=PG&f=1", "display_name": "user3501476", "link": "https://stackoverflow.com/users/3501476/user3501476"}, "edited": false, "score": 0, "creation_date": 1484840326, "post_id": 41723985, "comment_id": 70684337, "body": "@user3501476 that would be the problem of the Format function returning a string.  Remove this, or dim the variable as a string and youll be fine"}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 2, "last_activity_date": 1484755454, "creation_date": 1484755454, "answer_id": 41723985, "question_id": 41723815, "link": "https://stackoverflow.com/questions/41723815/overflow-or-division-by-zero-runtime-error-when-using-dateadd-in-vba/41723985#41723985", "title": "Overflow or Division by Zero runtime error when using DateAdd in VBa", "body": "<p>You need to pass a date to the dateadd function.  Format will return a string, you were also repeating the format needlessly.  Try the below.</p>\n\n<pre><code>Dim todDate As Date\nDim currDt As string\n\ntodDate = ActiveWorkbook.Sheets(\"Sheet1\").Range(\"B6\").Value\n\ncurrDt = Format(DateAdd(\"d\", 20, todDate), \"mm/dd/yyyy\")\n</code></pre>\n"}], "owner": {"reputation": 935, "user_id": 3501476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e105c5b8ca5254df01955c86dd500c5d?s=128&d=identicon&r=PG&f=1", "display_name": "user3501476", "link": "https://stackoverflow.com/users/3501476/user3501476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484755454, "creation_date": 1484754980, "question_id": 41723815, "link": "https://stackoverflow.com/questions/41723815/overflow-or-division-by-zero-runtime-error-when-using-dateadd-in-vba", "title": "Overflow or Division by Zero runtime error when using DateAdd in VBa", "body": "<p>I am getting the following error when using <code>DateAdd</code> in VBA.\n<code>Runtime error: 11 Division by Zero</code> or <code>Runtime error: 6 Overflow</code> (more often)</p>\n\n<pre><code>Dim todDate As Date\nDim currDt As Date\n\ntodDate = Format(ActiveWorkbook.Sheets(\"Sheet1\").Range(\"B6\").Value, \"mm/dd/yyyy\")\n\ncurrDt = Format(DateAdd(\"d\", 20, todDate), \"mm/dd/yyyy\")   ----&gt; Runtime Error HERE\n</code></pre>\n\n<p><code>todDate</code> is retrieved from a cell (\"B6\") whose format is the <code>short date format (mm/dd/yy)</code>. I have also dried using not including the <code>Format</code> function to compute currDt but no success either. Any idea why this may be?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 5610651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/45d84b1f3f17555f28ff7863915a5bc7?s=128&d=identicon&r=PG&f=1", "display_name": "RedLight GreenLight", "link": "https://stackoverflow.com/users/5610651/redlight-greenlight"}, "edited": false, "score": 0, "creation_date": 1484753511, "post_id": 41723185, "comment_id": 70641353, "body": "Excellent, thank you!  I was close - still need to enhance my VBA skills!"}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": true, "score": 2, "last_activity_date": 1484753152, "creation_date": 1484753152, "answer_id": 41723185, "question_id": 41723084, "link": "https://stackoverflow.com/questions/41723084/excel-vba-to-autofill-column/41723185#41723185", "title": "Excel VBA To AutoFill Column", "body": "<p><code>Selection.AutoFill Destination:=Range(\"B2:\" &amp; KCLR)</code> should be <code>Selection.AutoFill Destination:=Range(\"B2:B\" &amp; KCLR)</code> as <code>KCLR</code> is returning a number.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1484754723, "creation_date": 1484754723, "answer_id": 41723725, "question_id": 41723084, "link": "https://stackoverflow.com/questions/41723084/excel-vba-to-autofill-column/41723725#41723725", "title": "Excel VBA To AutoFill Column", "body": "<p>Following @harun24hr answer, for future better coding practice, avoid using <code>Select</code> , <code>ActiveCell</code> and <code>Selection</code>, and use fully qualified <code>Range</code>s.</p>\n\n<p>See example below:</p>\n\n<pre><code>Function AutoFill()\n\n  Dim KCLR As Long\n\n  KCLR = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n  Range(\"B2\").FormulaR1C1 = \"Team_1\"\n  Range(\"B2\").AutoFill Destination:=Range(\"B2:B\" &amp; KCLR)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 5610651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/45d84b1f3f17555f28ff7863915a5bc7?s=128&d=identicon&r=PG&f=1", "display_name": "RedLight GreenLight", "link": "https://stackoverflow.com/users/5610651/redlight-greenlight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2790, "favorite_count": 0, "accepted_answer_id": 41723185, "answer_count": 2, "score": 0, "last_activity_date": 1484754723, "creation_date": 1484752841, "question_id": 41723084, "link": "https://stackoverflow.com/questions/41723084/excel-vba-to-autofill-column", "title": "Excel VBA To AutoFill Column", "body": "<p>In Column A I have a list of 5 names - I am wanting to in column B create the different Teams and name them Team_1, Team_2 etc etc</p>\n\n<p>This is the syntax I have tried...</p>\n\n<pre><code>Function AutoFill()\n  Dim KCLR As Long\n  KCLR = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n  Range(\"B2\").Select\n  ActiveCell.FormulaR1C1 = \"Team_1\"\n  Selection.AutoFill Destination:=Range(\"B2:\" &amp; KCLR)\nEnd Function\n</code></pre>\n\n<p>However, on the line <code>Selection.AutoFill Destination:=Range(\"B2:\" &amp; KCLR)</code> I get an error of</p>\n\n<blockquote>\n  <p>Range(\"B2:\" &amp; KCLR) = Method 'Range' Of Object '_Global' failed</p>\n</blockquote>\n\n<p>What do I need to do in order for this to successfully  <code>AutoFill</code> as I need?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1484754552, "post_id": 41723110, "comment_id": 70642079, "body": "this doesnt seem to resolve anything. Do you know if it matters if the slave workbook is opened as read only?"}], "tags": [], "owner": {"reputation": 151, "user_id": 1399616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMsUc.jpg?s=128&g=1", "display_name": "Matt M", "link": "https://stackoverflow.com/users/1399616/matt-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1484753268, "last_edit_date": 1484753268, "creation_date": 1484752929, "answer_id": 41723110, "question_id": 41722975, "link": "https://stackoverflow.com/questions/41722975/vba-copy-value-from-one-workbook-to-another-if-value-matches/41723110#41723110", "title": "VBA copy value from one workbook to another if value matches?", "body": "<p>The wildcard in \"Depot Memo*\" name check should appear at the beginning AND the end of the text.  This would detect if a workbook name contains any text before and/or after \"Depot Memo\".</p>\n\n<pre><code>If Workbooks(wbInd).Name Like \"*Depot Memo*\" Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1484757846, "post_id": 41724152, "comment_id": 70644363, "body": "please see edit in question. This didn&#39;t seem to work exactly as i needed"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1484758365, "post_id": 41724152, "comment_id": 70644772, "body": "see edited answer: just added a loop through target cells"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1484768796, "post_id": 41724152, "comment_id": 70650725, "body": "is there a way to drop the case sensitivity on the work book name? For instance, as long as the workbook name contains Depot Memo with capital letters this code works. But if the workbook had the name depot memo spelt lower case this doesnt find the workbook. Is there a way around this?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1484779169, "post_id": 41724152, "comment_id": 70655888, "body": "Substitute &#39;If wb.name Like &quot;<i>&quot; &amp; wbNameLike &amp; &quot;</i>&quot; Then &#39; with &#39;If UCase(wb.name) Like &quot;<i>&quot; &amp; UCase(wbNameLike) &amp; &quot;</i>&quot; Then &#39;"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1484758341, "last_edit_date": 1484758341, "creation_date": 1484755857, "answer_id": 41724152, "question_id": 41722975, "link": "https://stackoverflow.com/questions/41722975/vba-copy-value-from-one-workbook-to-another-if-value-matches/41724152#41724152", "title": "VBA copy value from one workbook to another if value matches?", "body": "<p><strong>edited</strong> to handle multiple changed cells</p>\n\n<p>one thing that doesn't work as you'd expect is :</p>\n\n<pre><code>Like \"Depot Memo*\n</code></pre>\n\n<p>that would not detect neither \"Food Depot Memo\" nor \"Drinks Depot Memo 01-19\"</p>\n\n<p>while you have to use </p>\n\n<pre><code>Like \"*Depot Memo*\"\n</code></pre>\n\n<p>Furthermore:</p>\n\n<ul>\n<li><p>there's no need for any Dictionary object </p></li>\n<li><p>you don't need to iterate with <code>For Each oCell In w2.Range(\"J6:J\" &amp; i)</code></p></li>\n</ul>\n\n<p>so I'd go with the following refactoring of your code:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim oCell As Range, targetCell As Range\n    Dim ws2 As Worksheet\n\n    If Not Intersect(Target, Range(\"I:I\")) Is Nothing Then ' &lt;-- run this code only if a value in column I has changed\n        If Not GetWb(\"Depot Memo\", ws2) Then Exit Sub\n\n        With ws2\n            For Each targetCell In Target\n                Set oCell = .Range(\"J1\", .Cells(.Rows.count, \"J\").End(xlUp)).Find(what:=targetCell.Value, LookIn:=xlValues, lookat:=xlWhole)\n                If Not oCell Is Nothing Then\n                    Application.EnableEvents = False\n                    targetCell.Offset(0, 2).Value = oCell.Offset(0, 8)\n                    Application.EnableEvents = True\n                End If\n            Next\n        End With\n    End If\nEnd Sub\n\nFunction GetWb(wbNameLike As String, ws As Worksheet) As Boolean\n    Dim wb As Workbook\n    For Each wb In Workbooks\n        If wb.name Like \"*\" &amp; wbNameLike &amp; \"*\" Then '&lt;-- check if workbook name contains \"Depot Memo\"\n            Set ws = wb.Worksheets(1)\n            Exit For\n        End If\n    Next\n    GetWb = Not ws Is Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1030, "favorite_count": 0, "accepted_answer_id": 41724152, "answer_count": 2, "score": 0, "last_activity_date": 1526372529, "creation_date": 1484752533, "last_edit_date": 1526372529, "question_id": 41722975, "link": "https://stackoverflow.com/questions/41722975/vba-copy-value-from-one-workbook-to-another-if-value-matches", "title": "VBA copy value from one workbook to another if value matches?", "body": "<p>I have the following workbook called master:</p>\n\n<pre><code>Column I     Column K\n1234         \n1222         \n1111\n</code></pre>\n\n<p>I also have a workbook called slave:</p>\n\n<pre><code>Column J        Column R\n1234            Ambient\n1222            Ambient\n1111            Chiller\n</code></pre>\n\n<p>When the user enters/pastes the number in column I on my master workbook, i want to check if the same number exists in my slave workbook in column J.</p>\n\n<p>If it does, i want to copy the corresponding prodcut groups from column R over to my master workbook in column K.</p>\n\n<p>The other problem is my slave workbook changes name from time to time, but will always contain the word 'Depot memo' like so:</p>\n\n<pre><code>Food Depot Memo\nDrinks Depot Memo 01-19\netc.\n</code></pre>\n\n<p>I am trying to reference my slave workbook by checking if the file name contains 'depot memo'.</p>\n\n<p>For some reason this is not working. Please can someone show me where i am going wrong?</p>\n\n<p>Code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n Application.EnableEvents = True\nDim Dic As Object, key As Variant, oCell As Range, i As Long\nDim w1 As Worksheet, w2 As Worksheet\n\nIf Not Intersect(Target, Range(\"I:I\")) Is Nothing Then ' &lt;-- run this code only if a value in cell C5 has change\n\n    Application.EnableEvents = False\n    Set Dic = CreateObject(\"Scripting.Dictionary\")\n\n    If Not Dic.exists(Target.Value) Then\n        Dic.Add Target.Value, Target.Offset(1, 0).Value\n    End If\n\n    Dim wbInd   As Integer\n    Dim wb2 As Workbook\n\n    For wbInd = 1 To Workbooks.Count ' &lt;-- loop through all open workbooks\n        If Workbooks(wbInd).Name Like \"Depot Memo*\" Then '&lt;-- check if workbook name contains \"volumes\"\n            Set wb2 = Workbooks(wbInd)\n            Exit For\n        End If\n    Next wbInd\n\n     On Error GoTo message\n    Set w2 = wb2.Sheets(1)\n\n    With w2\n        i = .Cells(.Rows.Count, \"J\").End(xlUp).Row\n    End With\n\n    For Each oCell In w2.Range(\"J6:J\" &amp; i)\n        For Each key In Dic\n            If oCell.Value = key Then\n                Target.Offset(0, 2).Value = oCell.Offset(0, 8) '&lt;-- put the the value in column F (offset 1 column) to cell C6 (one row offset)\n            End If\n        Next\n    Next\nEnd If\n\nApplication.EnableEvents = True\nExit Sub\n\nmessage:\nExit Sub\nEnd Sub\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>With the suggested code from @user3598756 i encounter this problem:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LWW1V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LWW1V.png\" alt=\"enter image description here\"></a></p>\n\n<p>If the user copy and pastes these values, rather than typing them, the correct supplier number does not correspond with the item number in column I.</p>\n\n<p>This is obviously not correct, since it should have a different supplier number for each different item number.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484751851, "post_id": 41722659, "comment_id": 70640070, "body": "How do you want the return?  In a list, one per cell, or one cell with all the values not found delineated with a <code>,</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1484834652, "post_id": 41722903, "comment_id": 70680117, "body": "how can I modify this formula so it works with text?"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1484752320, "creation_date": 1484752320, "answer_id": 41722903, "question_id": 41722659, "link": "https://stackoverflow.com/questions/41722659/compare-two-columns-in-excel-and-find-the-differences-with-vba/41722903#41722903", "title": "Compare two columns in excel and find the differences with VBA", "body": "<p>You do not need vba.</p>\n\n<p>This formula will do what you are asking.</p>\n\n<pre><code>=IFERROR(AGGREGATE(15,6,$A$1:INDEX(A:A,MATCH(1E+99,A:A))/(ISERROR(MATCH($A$1:INDEX(A:A,MATCH(1E+99,A:A)),B:B,0))),ROW(1:1)),\"\")\n</code></pre>\n\n<p>Put it in the first cell of the desired output and copy down till it returns blanks.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lh2Fd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lh2Fd.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1238, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484752320, "creation_date": 1484751641, "question_id": 41722659, "link": "https://stackoverflow.com/questions/41722659/compare-two-columns-in-excel-and-find-the-differences-with-vba", "title": "Compare two columns in excel and find the differences with VBA", "body": "<p>Hello I am trying to write a macro that compares two columns and tells me if something from the first column does not exist in the second.</p>\n\n<pre><code>A   B\n1   55\n23  68\n55  97\n68  58\n97  90\n    14\n    25\n</code></pre>\n\n<p>So I need to take the values from A and check if they are present in B, if not it shopuld give back the value from A which was not found.\nCan you please help me on that</p>\n"}, {"tags": ["forms", "ms-access", "vba", "subform", "expandable"], "answers": [{"comments": [{"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1484864668, "post_id": 41722855, "comment_id": 70698200, "body": "to make it easier and to force the user to say Yes or No, you should use <code>strExpand =MsgBox (&quot;Expand subdatasheets?&quot;, vbYesNo)</code> rather"}], "tags": [], "owner": {"reputation": 65, "user_id": 3873483, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed34c82877b675cfb50bca55979c4882?s=128&d=identicon&r=PG&f=1", "display_name": "Abbas", "link": "https://stackoverflow.com/users/3873483/abbas"}, "is_accepted": false, "score": 1, "last_activity_date": 1511008731, "last_edit_date": 1511008731, "creation_date": 1484752164, "answer_id": 41722855, "question_id": 41722565, "link": "https://stackoverflow.com/questions/41722565/modify-split-form-datasheet-view-format/41722855#41722855", "title": "Modify split form datasheet view format", "body": "<p>Use VBA to automatically collapse the subform when it is loaded:</p>\n\n<pre><code>Dim strExpand As String\n\nWith Forms(\"Purchase Orders\")\n\nstrExpand = InputBox(\"Expand subdatasheets? Y/N\")\n\nSelect Case strExpand\n    Case \"Y\"\n        .SubdatasheetExpanded = True\n    Case \"N\"\n        .SubdatasheetExpanded = False\n    Case Else\n        MsgBox \"Can't determine subdatasheet expansion state.\"\nEnd Select\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 3873483, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed34c82877b675cfb50bca55979c4882?s=128&d=identicon&r=PG&f=1", "display_name": "Abbas", "link": "https://stackoverflow.com/users/3873483/abbas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511008731, "creation_date": 1484751370, "last_edit_date": 1510977400, "question_id": 41722565, "link": "https://stackoverflow.com/questions/41722565/modify-split-form-datasheet-view-format", "title": "Modify split form datasheet view format", "body": "<p>I have a split form with a subform. Each time the form is loaded, the subform data expands automatically.</p>\n\n<p>Is there a way to automatically collapse the datasheet view of the subform when the form loads?</p>\n\n<p><a href=\"https://i.stack.imgur.com/NReky.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NReky.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484751236, "post_id": 41722463, "comment_id": 70639650, "body": "When you are deleting a record are you deleting a whole row?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1484751759, "creation_date": 1484751759, "answer_id": 41722710, "question_id": 41722463, "link": "https://stackoverflow.com/questions/41722463/run-time-error-13-type-mismatch-when-deleting-records-in-excel-file/41722710#41722710", "title": "Run-time error &#39;13&#39;: Type Mismatch when deleting records in excel file", "body": "<p>When you are deleting you are changing more than one cell so the <code>Target.Value &lt;&gt; vbNullString</code> throws the error.</p>\n\n<p>You can not bulk compare a range with more than one cell at one time.</p>\n\n<p>Add a check to ensure that only Column A is changing and that there is only one Target cell not a whole range:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Column = 1 And Target.Count = 1 Then\n    If Target.Value &lt;&gt; vbNullString Then Target.Offset(, 1).Value = GetGUID\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6757725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b71924c19583761379a2587541edfab2?s=128&d=identicon&r=PG&f=1", "display_name": "shuru", "link": "https://stackoverflow.com/users/6757725/shuru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "accepted_answer_id": 41722710, "answer_count": 1, "score": 1, "last_activity_date": 1484751759, "creation_date": 1484751037, "last_edit_date": 1531164843, "question_id": 41722463, "link": "https://stackoverflow.com/questions/41722463/run-time-error-13-type-mismatch-when-deleting-records-in-excel-file", "title": "Run-time error &#39;13&#39;: Type Mismatch when deleting records in excel file", "body": "<p>I have the following code Which I got from this forum. This is working fine but throwing an error when I delete records in the excel file. The error which I get is \nRun-time error '13':\nType Mismatch.</p>\n\n<p>On clicking debug button, It highlights the folloing line in the code:</p>\n\n<pre><code>If Target.Value &lt;&gt; vbNullString Then Target.Offset(, 1).Value = GetGUID\n</code></pre>\n\n<p>I think I know what the problem is but don't know how to fix it. </p>\n\n<p>The full code is</p>\n\n<pre><code>Private RANGE_CELL As Range\n\n Public Function GetGUID() As String\n        GetGUID = Mid$(CreateObject(\"Scriptlet.TypeLib\").GUID, 2, 36)\n    End Function\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Column = 1 Then\nIf Target.Value &lt;&gt; vbNullString Then Target.Offset(, 1).Value = GetGUID\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 8600312, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/36c8921d358eb0c839774a5c74b12558?s=128&d=identicon&r=PG", "display_name": "Pavel K", "link": "https://stackoverflow.com/users/8600312/pavel-k"}, "is_accepted": false, "score": 3, "last_activity_date": 1505258078, "creation_date": 1505258078, "answer_id": 46186586, "question_id": 41722361, "link": "https://stackoverflow.com/questions/41722361/formatconditions-addtype-xltextstring-textoperator-xlcontains-string-myte/46186586#46186586", "title": "FormatConditions.Add(Type:=xlTextString, TextOperator:=xlContains, String:=&quot;myText&quot;)", "body": "<p>Just spent an hour figuring out the answer, almost surrendered but finally found it:</p>\n\n<pre><code>xlFC = xlApp.Columns(\"G:G\").FormatConditions.Add(xlTextString, None, None, None, u'\u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c -', xlContains, None, None)\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 3872253, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/punNG.jpg?s=128&g=1", "display_name": "HarryKane", "link": "https://stackoverflow.com/users/3872253/harrykane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1809, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1505258078, "creation_date": 1484750730, "last_edit_date": 1531164843, "question_id": 41722361, "link": "https://stackoverflow.com/questions/41722361/formatconditions-addtype-xltextstring-textoperator-xlcontains-string-myte", "title": "FormatConditions.Add(Type:=xlTextString, TextOperator:=xlContains, String:=&quot;myText&quot;)", "body": "<p>I have a VBA code, which I want to convert into my python script. </p>\n\n<pre><code>Sub formatStatus()\n\nDim ws As Worksheet\nDim fc_blocked As FormatCondition\n\nSet ws = ThisWorkbook.ActiveSheet()\n\nws.Columns(1).FormatConditions.Delete\n\nSet fc_blocked = ws.Columns(1).FormatConditions.Add(Type:=xlTextString, TextOperator:=xlContains, String:=\"blocked\")\nfc_blocked.Font.Color = RGB(100, 48, 160)\nfc_blocked.Interior.Color = RGB(180, 120, 250)\n\nEnd Sub\n</code></pre>\n\n<p>My python code looks like this:</p>\n\n<pre><code>import win32com.client as win32\n\nfcBlocked = ws.Columns(iCol).FormatConditions.Add(Type = win32.constants.xlTextString, TextOperator=win32.constants.xlContains, String='blocked')\nfcBlocked.Font.Color = int('%02x%02x%02x' % (100, 48, 160)[::-1],16)\nfcBlocked.Interior.Color = int('%02x%02x%02x' % (180, 120, 250)[::-1],16)\n</code></pre>\n\n<p>But I get an exception. </p>\n\n<p>I successfully tried</p>\n\n<pre><code>fcBlocked = ws.Columns(iCol).FormatConditions.Add(Type = win32.constants.xlCellValue, TextOperator=win32.constants.xlEqual Formula1='=\"blocked\"')\nfcBlocked.Font.Color = int('%02x%02x%02x' % (100, 48, 160)[::-1],16)\nfcBlocked.Interior.Color = int('%02x%02x%02x' % (180, 120, 250)[::-1],16)\n</code></pre>\n\n<p>but this checks if the text is equal, and not if the string contains 'blocked'. </p>\n\n<p>Can someone give me an advice? </p>\n\n<p>Thanks in advance and best regards!</p>\n"}, {"tags": ["xml", "vba", "email", "outlook", "ribbon"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7436176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dtyjo.jpg?s=128&g=1", "display_name": "Relo", "link": "https://stackoverflow.com/users/7436176/relo"}, "edited": false, "score": 0, "creation_date": 1484820198, "post_id": 41728296, "comment_id": 70670892, "body": "Many thanks for the reply. I&#39;ve found the XML file and had a look through it. Please forgive me I&#39;m pretty new with VBA and XML, do you know of some examples I can follow with using callbacks to the xml?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 7436176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dtyjo.jpg?s=128&g=1", "display_name": "Relo", "link": "https://stackoverflow.com/users/7436176/relo"}, "edited": false, "score": 0, "creation_date": 1484846059, "post_id": 41728296, "comment_id": 70688184, "body": "I have never done that in VBA, but I think the idea is the same - for a button, instead of specifying the label attribute, specify getLabel attribute and provide the name of the callback that will return the string. To foce Outlook refresh the button caption, call IRibbonUI.Invalidate."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1484769247, "creation_date": 1484769247, "answer_id": 41728296, "question_id": 41722347, "link": "https://stackoverflow.com/questions/41722347/vba-outlook-ribbon-customisation-button-name-and-icon-changes-to-reflect-sensi/41728296#41728296", "title": "VBA Outlook ribbon customisation - Button name and icon changes to reflect sensitivity state", "body": "<p>Your ribbon XML must specify callbacks (and implement them of course) that return the button caption and the image instead of hardcoding the values. You can force a refresh of your control by calling IRibbonUI.Invalidate. IRibbonUI can be retrieved from the OnLoad callback of your ribbon. </p>\n"}], "owner": {"reputation": 1, "user_id": 7436176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dtyjo.jpg?s=128&g=1", "display_name": "Relo", "link": "https://stackoverflow.com/users/7436176/relo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1484769247, "creation_date": 1484750708, "question_id": 41722347, "link": "https://stackoverflow.com/questions/41722347/vba-outlook-ribbon-customisation-button-name-and-icon-changes-to-reflect-sensi", "title": "VBA Outlook ribbon customisation - Button name and icon changes to reflect sensitivity state", "body": "<p>Company has asked for a custom ribbon button in outlook to set email sensitivity as 'private'.</p>\n\n<p>Created a new button in outlook ribbon with Outlook option, then assigned the macro below. However Boss wants a button that changes name and Icon to reflect the current privacy state, rather than a MsgBox output.</p>\n\n<p>I've read that I need to make changes with XML but not sure how to implement this with my VBA below. Am I approaching this the right way?</p>\n\n<p>Here is pic of custom button I made. <a href=\"https://i.stack.imgur.com/0TN31.png\" rel=\"nofollow noreferrer\">Button Pic</a></p>\n\n<p>Vba module</p>\n\n<pre><code>Sub TogglePrivateSensitivity()\nIf ActiveInspector.CurrentItem.Sensitivity = Outlook.OlSensitivity.olPrivate   Then\nActiveInspector.CurrentItem.Sensitivity = Outlook.OlSensitivity.olNormal\n\nMsgBox (\"This email is now public\")\nElse\nActiveInspector.CurrentItem.Sensitivity = Outlook.OlSensitivity.olPrivate\nMsgBox (\"This email is now private\")\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "gantt-chart"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484754006, "post_id": 41722332, "comment_id": 70641712, "body": "try giving feedback and give credit to previous answers you got on previous questions on SO. You gave <b>0</b> from 6 so far, this will not attract users to assist you"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484811878, "post_id": 41722332, "comment_id": 70666081, "body": "sorrt, im still new here. how do i do that?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484811968, "post_id": 41722332, "comment_id": 70666126, "body": "Go to those posts, and next to the good answers u got, mark the <b>V</b> next to them"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1484812054, "post_id": 41722332, "comment_id": 70666172, "body": "ok, will do!! thanks !!"}], "owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484757350, "creation_date": 1484750653, "last_edit_date": 1484757350, "question_id": 41722332, "link": "https://stackoverflow.com/questions/41722332/excel-vba-button-move-to-chosen-cell", "title": "excel vba button move to chosen cell", "body": "<p>I have a <strong>BIG</strong> Excel table (Daily Gantt Chart)\nand I need a button use which I can choose date.\nlike a Vlookup but instead of bringing the data to me, I want to go to the data.\nlike a <kbd>Ctrl</kbd> + <kbd>F</kbd> , but thats already installed.</p>\n\n<p>I looked everywhere for a VBA code for this so im sorry in advance that I don't have my own. </p>\n\n<p><a href=\"https://i.stack.imgur.com/lB3Gz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lB3Gz.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["regex", "vba", "ms-word"], "comments": [{"owner": {"reputation": 6167, "user_id": 244811, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xVPtR.jpg?s=128&g=1", "display_name": "Scott Weaver", "link": "https://stackoverflow.com/users/244811/scott-weaver"}, "edited": false, "score": 0, "creation_date": 1484750803, "post_id": 41722264, "comment_id": 70639342, "body": "the question you are asking is not clear...."}, {"owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "reply_to_user": {"reputation": 6167, "user_id": 244811, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xVPtR.jpg?s=128&g=1", "display_name": "Scott Weaver", "link": "https://stackoverflow.com/users/244811/scott-weaver"}, "edited": false, "score": 1, "creation_date": 1484753772, "post_id": 41722264, "comment_id": 70641539, "body": "well the question is how do I do a regex search in word without destroying the formatting.  The rest is just the code to how far I have got so far, and why it doesn&#39;t worl"}, {"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1484754899, "post_id": 41722264, "comment_id": 70642305, "body": "Very interesting question"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 2, "creation_date": 1484756375, "post_id": 41722264, "comment_id": 70643338, "body": "Two things to consider here: a) why use vbscript regex in Word VBA when Word Find methog accepts regexes (albeit occasionally slightly different to &quot;normal&quot; regex), and b) replacing words changes the range of course! What I would do is a) use Word&#39;s Find method and b) consider starting from the end of the document upwards so as to preserve range values."}, {"owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1484756875, "post_id": 41722264, "comment_id": 70643694, "body": "@LocEngineer Don&#39;t want this thread to turn into a long discussion as to exactly what the limitations and drawbacks of word&#39;s &quot;regex&quot; are vs. real regex, but happy to discuss it in Chat. Suffice to say word&#39;s regex won&#39;t do for various purposes."}, {"owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1484757677, "post_id": 41722264, "comment_id": 70644244, "body": "@LocEngineer as for point b) I already accounted for this (although working backwards would have made more sense than my offset variable). I&#39;ve updated the question so that that&#39;s a little clearer."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1484814918, "post_id": 41722264, "comment_id": 70667614, "body": "I think you should provide example when it is not workin as for simple text solution looks ok. Have you considered all hidden document marks, like paragraphs end, table row/cell end, soft space, etc...?"}, {"owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1484819427, "post_id": 41722264, "comment_id": 70670376, "body": "@KazimierzJawor Included sample document link in question now. I agree with you that things like tables, links, contents pages etc. are the problem. The find-text-return-index &amp; go-to-index parts of the code seem to handle these in different ways. Imho fixing on a case by case basis is bound to keep running into new exceptions and end up v. long and unwieldy, and ultimately still imperfect so I don&#39;t think it&#39;s the right approach. Problem isn&#39;t whether these chars are counted or not, it&#39;s that they are accounted for differently by the method which returns the index &amp; the one which goes to it."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1486671050, "post_id": 41722264, "comment_id": 71458185, "body": "Using index values for characters is simply not reliable and cannot be made reliable - it&#39;s the nature of the beast. Best recommendation I can make would be to compare the actual string with the index location&#39;s Text. If it doesn&#39;t match, try &quot;walking&quot; the start and end points until it does..."}, {"owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1486734119, "post_id": 41722264, "comment_id": 71486616, "body": "@CindyMeister I started doing that but it got to the point it was having to walk in both directions (sometimes for a very long distance) from the &quot;found&quot; point, for some documents the next match being closer than the targeted match, and so missing some matches altogether.  The way I solved it in the end was to just take the text of the found string, apply the regex on that string, then get the output and then pipe the found string and the regex&#39;d string into word&#39;s native find and replace. I&#39;ll tidy it up and post the solution over the next couple of days. Thanks for your interest :)"}], "answers": [{"comments": [{"owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "edited": false, "score": 0, "creation_date": 1525965751, "post_id": 50261184, "comment_id": 87569203, "body": "It&#39;s been a long time since I came up with this so my head&#39;s out of it.  I did also come up with a kludge that worked in the end (which I always planned to neaten up and post here some time).  I&#39;ll have a look at this and my old code (on a backup somewhere) some time this week and see if I have anything to add, but I think I actually may have done exactly what you did, used word&#39;s native find and replace on the string regex finds."}, {"owner": {"reputation": 362, "user_id": 2752308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574f9f2cb6733e7ebcdd340d6ec14b25?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Scofano Diniz", "link": "https://stackoverflow.com/users/2752308/marcelo-scofano-diniz"}, "edited": false, "score": 0, "creation_date": 1565966422, "post_id": 50261184, "comment_id": 101519581, "body": "Functioning, thanks. Just to add that usually we need a <code>.Multiline = True</code> on object regexp initialization"}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 4, "last_activity_date": 1525896155, "creation_date": 1525896155, "answer_id": 50261184, "question_id": 41722264, "link": "https://stackoverflow.com/questions/41722264/regex-microsoft-word-without-destroying-document-formatting/50261184#50261184", "title": "Regex Microsoft Word without destroying document formatting", "body": "<p>@Some_Guy: thanks for asking this question, I had a similar problem and your post saved me quite a bit of time.</p>\n\n<p>This is the kludge I came up with:</p>\n\n<pre><code>Sub RegEx(Before As String, After As String, _\n          Optional CaseSensitive As Boolean = False, _\n          Optional Location As Range = Nothing, _\n          Optional DebugMode As Boolean = False)\n\n    'can't declare activedocument.range in parameters\n    If Location Is Nothing Then Set Location = ActiveDocument.Range\n\n    Dim j As Long\n    Dim regexp As Object\n    Dim Foundmatches As Object\n    Dim Match As Object\n    Dim MatchRange As Range\n    Dim offset As Integer: offset = 0\n    Set regexp = CreateObject(\"vbscript.regexp\")\n\n    With regexp\n        .Pattern = Before\n        .IgnoreCase = Not CaseSensitive\n        .Global = True\n\n        'set foundmatches to collection of all regex matches\n        Set Foundmatches = .Execute(Location.Text)\n        For j = Foundmatches.Count - 1 To 0 Step -1\n\n            If DebugMode = True Then\n                'debugging\n                Debug.Print Foundmatches(j), .Replace(Foundmatches(j), After)\n            Else\n                'REAL LIFE\n\n                'run a plain old find/replace on the found string and eplace strings\n                With ActiveDocument.Range.Find\n                    .ClearFormatting\n                    .Replacement.ClearFormatting\n                    .Replacement.Font.Hidden = True\n                    .Text = Foundmatches(j)\n                    .Replacement.Text = regexp.Replace(Foundmatches(j), After)\n                    .Execute Replace:=wdReplaceAll\n                End With\n            End If\n        Next j\n    End With\nEnd Sub\n</code></pre>\n\n<p>Basically I use a simple find/replace with strings that match each item found (and would be replaced) with a regex, would decent support for it exist in Word). Note that any text replaced takes on the formatting of the first replaced character, so if the first word is in bold, then all the replaced text will be bold.</p>\n"}], "owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1559, "favorite_count": 3, "answer_count": 1, "score": 6, "last_activity_date": 1525896155, "creation_date": 1484750460, "last_edit_date": 1484819536, "question_id": 41722264, "link": "https://stackoverflow.com/questions/41722264/regex-microsoft-word-without-destroying-document-formatting", "title": "Regex Microsoft Word without destroying document formatting", "body": "<p>It's well known that word's find and replace \"wildcards\" features suffer some severe limitations.</p>\n\n<p>The following code implements true regex find and replace in a word document, and variations on it are found in other Stackoverflow and SuperUser questions.</p>\n\n<pre><code>Sub RegEx_PlainText(Before As String, After As String)\n\n    Dim regexp As Object\n    Set regexp = CreateObject(\"vbscript.regexp\")            \n\n    With regexp\n        .Pattern = Before\n        .IgnoreCase = True\n        .Global = True\n\n         'could be any Range , .Range.Text , or selection object\n         ActiveDocument.Range = .Replace(ActiveDocument.Range, After)\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>However, this wipes the document of all formatting.</p>\n\n<p>Word will not preserve formatting character by character even if the strings are of the same length or indeed the same string, so <code>ActiveDocument.Range = ActiveDocument.Range</code> or <code>Selection.Text=Selection.Text</code> will wipe all formatting (or more accurately, format the whole range the same as the first character in the range, and add a carriage return).  Upon reflection, this behavior isn't so surprising.</p>\n\n<p><strong>To solve this, the following code runs a regex find, then loops through the matches and runs <code>.replace</code> only on the range where the match is found.</strong>  This then, would only lose formatting if the match iself had a variety of formatting (for example an italicised word would be lost)</p>\n\n<p>Hopefully the code comments make this quite transparent.</p>\n\n<pre><code>Sub RegEx(Before As String, After As String, _\n          Optional CaseSensitive As Boolean = False, _\n          Optional Location As Range = Nothing, _\n          Optional DebugMode As Boolean = False)\n\n    'can't declare activedocument.range in parameters\n    If Location Is Nothing Then Set Location = ActiveDocument.Range\n\n    Dim regexp As Object\n    Dim Foundmatches As Object\n    Dim Match As Object\n    Dim MatchRange As Range\n    Dim offset As Integer: offset = 0\n    Set regexp = CreateObject(\"vbscript.regexp\")\n\n   With regexp\n        .Pattern = Before\n        .IgnoreCase = Not CaseSensitive\n        .Global = True\n\n        'set foundmatches to collection of all regex matches\n        Set Foundmatches = .Execute(Location.text)\n\n        For Each Match In Foundmatches\n\n            'set matchrange to location of found string in source doc.\n            'offset accounts for change in length of  document from already completed replacements\n            Set MatchRange = Location.Document _\n                   .Range(Match.FirstIndex + offset, _\n                          Match.FirstIndex + Match.Length + offset)\n\n            'debugging\n            If DebugMode Then\n                    Debug.Print \"strfound      = \" &amp; Match.Value\n                    Debug.Print \"matchpoint    = \" &amp; Match.FirstIndex\n                    Debug.Print \"origstrlength = \" &amp; Match.Length\n                    Debug.Print \"offset        = \" &amp; offset\n                    Debug.Print \"matchrange    = \" &amp; MatchRange.text\n                    MatchRange.Select\n                Stop\n\n            Else\n            'REAL LIFE\n                'run the regex replace just on the range containing the regex match\n                MatchRange = .Replace(MatchRange, After)\n\n                'increment offset to account for change in length of document\n                offset = offset + MatchRange.End - MatchRange.Start - Match.Length\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>This works on simple documents, but when I run it on a real document, <code>matchrange</code> ends up being at some point near the where the match was found, but not exactly right.</strong>  It's not predictably off, sometimes it is to the right, and sometimes to the left. Generally the more complex the document. (links, tables of context, formatting etc.) the more wrong it ends up being.</p>\n\n<p><strong>Does anyone know why this doesn't work, and how to fix it?</strong>  If I could understand why this isn't working, then I might be able to determine whether this approach can be fixed, or if I just need to try a different method.  </p>\n\n<p><strong>Code includes DebugMode param which means it will just loop through the doc and highlight all matches, performing no changes.</strong>  Also outputs a bunch of stuff to the console.  This should be helpful for anyone kind enough to tackle this problem with me.</p>\n\n<p><a href=\"https://calibre-ebook.com/downloads/demos/demo.docx\" rel=\"noreferrer\">https://calibre-ebook.com/downloads/demos/demo.docx</a> Here is a sample document (not produced by me) which may be useful.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1484750436, "post_id": 41722110, "comment_id": 70639048, "body": "You are telling to copy only what is selected, change <code>Selection.Copy</code> to <code>Sheets(1).Range(Sheets(1).Cells(1,Found.Column),Sheets(1).Ce&zwnj;&#8203;lls(LastRow,Found.Co&zwnj;&#8203;lumn)).Copy</code>"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1484750465, "post_id": 41722110, "comment_id": 70639070, "body": "you&#39;re copying selection but not selecting the last row. Are you wanting to copy the contents of the usedrange or copy the usedrange address as a value?"}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "reply_to_user": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1484750637, "post_id": 41722110, "comment_id": 70639222, "body": "@Zerk - I am wanting to find the text Full Name, and copy from cell (example) B2: LastRow"}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484750713, "post_id": 41722110, "comment_id": 70639284, "body": "@ScottCraner - that got it thank you"}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1484753869, "post_id": 41722110, "comment_id": 70641611, "body": "@ScottCraner - if you post as answer I will accept since that solved my issue."}], "owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484750030, "creation_date": 1484750030, "question_id": 41722110, "link": "https://stackoverflow.com/questions/41722110/search-for-text-and-select-used-range", "title": "Search For Text And Select Used Range", "body": "<p>I am needing to search Row 1 and find the text <code>Full Name</code> then find the used range in that column and copy it.  I have tried this syntax:</p>\n\n<pre><code>Sub Macro1()\n  Dim Found As Range, LastRow As Long\n\n  Sheets(1).Activate\n  Set Found = Rows(1).Find(what:=\"Full Name\", LookIn:=xlValues, lookat:=xlWhole)\n    If Found Is Nothing Then Exit Sub\n\n  LastRow = Cells(Rows.Count, Found.Column).End(xlUp).Row\n  Selection.Copy\nEnd Sub\n</code></pre>\n\n<p>However, that selects the data in the active cell.  For example, if cell A1 is selected it only copies the data from cell A1.  What must I change in order for the used range of the row with the text <code>Full Name</code> to be copied?</p>\n\n<p>--Yes the text <code>Full Name</code> exists on the worksheet on <code>Sheet(1)</code></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1484753862, "post_id": 41721003, "comment_id": 70641605, "body": "@Vityata, yeah there are a few ways to solve the question :)"}, {"owner": {"reputation": 21, "user_id": 7435848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac5be3b29be2ae86b41b55d599d4ab43?s=128&d=identicon&r=PG&f=1", "display_name": "Alberto", "link": "https://stackoverflow.com/users/7435848/alberto"}, "edited": false, "score": 0, "creation_date": 1484775286, "post_id": 41721003, "comment_id": 70654162, "body": "Thank you very much for looking into this !!!  I tried both solutions they work well in my PC.  I then asked my colleague to try them. The one provided by VBA Pete is working correcly !!!! However, the one provided by Vityata is shooting the same error we used to have. I am going to try to apply the solution in my code confirm that the whole macro works fine. I will keep you posted.  Thanks again. Alberto"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1484775381, "post_id": 41721003, "comment_id": 70654213, "body": "No worries Alberto, glad to help."}], "tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": false, "score": 2, "last_activity_date": 1484746913, "creation_date": 1484746913, "answer_id": 41721003, "question_id": 41720821, "link": "https://stackoverflow.com/questions/41720821/run-time-error-1004-in-copy-paste-as-picture/41721003#41721003", "title": "Run-time error &#39;1004&#39;. in copy/paste as picture", "body": "<p>You need to use a different copy to copy pictures:    </p>\n\n<pre><code>Sub Macro4()\n\nDim ws As Worksheet\n\nSet ws = Sheets(\"CS - Pivot Tables\")\n\n    With ws\n        .Activate\n        .Range(\"B2:D13\").CopyPicture Appearance:=xlScreen, Format:=xlPicture\n        .Range(\"B1\").Select\n        .Paste\n    End With\n\n\nRange(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1484746921, "creation_date": 1484746921, "answer_id": 41721006, "question_id": 41720821, "link": "https://stackoverflow.com/questions/41720821/run-time-error-1004-in-copy-paste-as-picture/41721006#41721006", "title": "Run-time error &#39;1004&#39;. in copy/paste as picture", "body": "<p>Can you try something like this:</p>\n\n<pre><code>Sub Macro4()\n\n    Dim ws      As Worksheet\n    dim pic     as picture\n\n    Set ws = Sheets(\"CS - Pivot Tables\")\n    With ws \n        .Activate \n        .Range(\"B2:D13\").Copy \n        .Range(\"L2\").Select \n        set pic = .pictures.paste\n    End With\n\n    Application.CutCopyMode = False\n\n    Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>(Your code is not formatted, but I am guessing I did it right).</p>\n"}], "owner": {"reputation": 21, "user_id": 7435848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac5be3b29be2ae86b41b55d599d4ab43?s=128&d=identicon&r=PG&f=1", "display_name": "Alberto", "link": "https://stackoverflow.com/users/7435848/alberto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2041, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1489249223, "creation_date": 1484746361, "last_edit_date": 1489249223, "question_id": 41720821, "link": "https://stackoverflow.com/questions/41720821/run-time-error-1004-in-copy-paste-as-picture", "title": "Run-time error &#39;1004&#39;. in copy/paste as picture", "body": "<p>I get Run-time error '1004' when trying to copy a range of cells and doing a paste as a picture.</p>\n\n<h2>Description of the Excel file:</h2>\n\n<p>I have 1 Excel file that has 2 sheets:</p>\n\n<ul>\n<li>Sheet1 - it has a table with data</li>\n<li>Sheet2 - it has a Pivot Table that reads the data from the table in Sheet1</li>\n</ul>\n\n<p>(I created this small Excel only for replication purposes as I have the issue in a much bigger Excel file.)</p>\n\n<h2>Description of the issue:</h2>\n\n<p>I have a macro to copy the range of cells that contains the Pivot Table and paste it as a picture.</p>\n\n<p>The macro is running correctly with no errors in my laptop and in other colleagues' laptops. Some colleagues are getting the error in their laptops.</p>\n\n<p>We all are using:</p>\n\n<ul>\n<li>Windows 7 Ultimate 64 bits </li>\n<li>Office 365 ProPlus (Excel 2016)</li>\n</ul>\n\n<h2>Macro created:</h2>\n\n<pre><code>Sub Macro4()\n\nDim ws As Worksheet\n\nSet ws = Sheets(\"CS - Pivot Tables\")\n\nWith ws\n    .Activate\n    .Range(\"B2:D13\").Copy\n    .Range(\"L2\").Select\n    .Pictures.Paste\nEnd With\n\nApplication.CutCopyMode = False\n\nRange(\"A1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>*****  the macro stops on <code>.Pictures.Paste</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1484746773, "post_id": 41720649, "comment_id": 70636427, "body": "Just wondering.. you realize<code>Range(&quot;xx1&quot;).Column</code> will return <code>.Cells(1,648).Column</code>. So, column 648."}, {"owner": {"reputation": 17, "user_id": 5934452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/78fc90163684cbfba956f748a40be8e1?s=128&d=identicon&r=PG&f=1", "display_name": "NG83", "link": "https://stackoverflow.com/users/5934452/ng83"}, "reply_to_user": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1484748090, "post_id": 41720649, "comment_id": 70637303, "body": "yes, I&#39;ve inserted a fake name for make the explanation simpler.If I type dict(pk)(1) + attr(1) on the Immediate window I receive the correct value. I don&#39;t understand why it can&#39;t pass the correct value to dict(pk)(1)"}], "answers": [{"comments": [{"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1484749096, "post_id": 41721671, "comment_id": 70637996, "body": "op: it&#39;s noteworthy that changing a value at <code>dictionary(Key)</code> automatically adds the key, if it doesnt exist. so, no need to <code>If Then Else</code>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1484756135, "post_id": 41721671, "comment_id": 70643151, "body": "@NG83, did you get through it?"}, {"owner": {"reputation": 17, "user_id": 5934452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/78fc90163684cbfba956f748a40be8e1?s=128&d=identicon&r=PG&f=1", "display_name": "NG83", "link": "https://stackoverflow.com/users/5934452/ng83"}, "edited": false, "score": 0, "creation_date": 1485162070, "post_id": 41721671, "comment_id": 70792450, "body": "Sorry, thanks for your help first. I&#39;m still working on it. I can&#39;t fit this solution with my problem and I&#39;m thinking of using a class first and then a dictionary on the class"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1484748719, "creation_date": 1484748719, "answer_id": 41721671, "question_id": 41720649, "link": "https://stackoverflow.com/questions/41720649/excel-vba-cant-sum-dictionary-items-in-a-loop/41721671#41721671", "title": "excel-vba - can&#39;t sum dictionary items in a loop", "body": "<p>I'd go like follows:</p>\n\n<pre><code>Option Explicit\n\nSub dict_sum()\n\n    Dim ObjO As Worksheet\n\n    Dim dict As New Dictionary\n    Dim i As Integer, start_range As Integer, end_range As Integer\n    Dim pkC As Integer, xx1C As Integer, xx2C As Integer, xx3C As Integer, xx4C As Integer\n    Dim attrSum As Double\n\n    set ObjO = Workbooks(\"MyWorkbookName\") '&lt;--| adjust it to your needs\n    start_range = 1 '&lt;--| adjust it to your needs\n    end_range = 100 '&lt;--| adjust it to your needs\n\n    With ObjO\n        pkC = .Range(\"primary_key\").Column\n        xx1C = .Range(\"xx1\").Column\n        xx2C = .Range(\"xx2\").Column\n        xx3C = .Range(\"xx3\").Column\n        xx4C = .Range(\"xx4\").Column\n        For i = start_range To end_range 'loop on the column range\n            attrSum = .Cells(i, xx1C) + .Cells(i, xx2C) + .Cells(i, xx3C) + .Cells(i, xx4C)\n            dict.Item(.Cells(i, pkC)) = dict(.Cells(i, pkC)) + attrSum\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5934452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/78fc90163684cbfba956f748a40be8e1?s=128&d=identicon&r=PG&f=1", "display_name": "NG83", "link": "https://stackoverflow.com/users/5934452/ng83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484748719, "creation_date": 1484745906, "last_edit_date": 1484745988, "question_id": 41720649, "link": "https://stackoverflow.com/questions/41720649/excel-vba-cant-sum-dictionary-items-in-a-loop", "title": "excel-vba - can&#39;t sum dictionary items in a loop", "body": "<p>I create a dictionary with some items and I need to sum the various items for every key. </p>\n\n<p>But I can't. I post the code with some comments. Let me know if I have to add more deta</p>\n\n<pre><code>Sub dict_sum()\n\nDim dict as New Dictionary\nDim i As Integer\nDim pk As Variant\ndim attr as variant\nDim attr_tmp As Variant\n\nFor i = start_range To end_range 'loop on the column range\n    pk = ObjO.Cells(i, ObjO.Range(\"primary_key\").Column)  'set the primary key for the dictionary \n    ReDim attr_tmp(1 To 4)  'read for the primary key cell the following for columns that contains numbers \n                            'and obviously are on the same row of the primary key  \n        attr_tmp(1) = ObjO.Cells(i, ObjO.Range(\"xx1\").Column)\n        attr_tmp(2) = ObjO.Cells(i, ObjO.Range(\"xx2\").Column)\n        attr_tmp(3) = ObjO.Cells(i, ObjO.Range(\"xx3\").Column)\n        attr_tmp(4) = ObjO.Cells(i, ObjO.Range(\"xx4\").Column)\n\n            ReDim attr(1 To 1)\n                'with the following passage i'm trying to pass the sum of the previously columns to one variable\n                'that will be the item of the dictionary dict.\n                attr(1) = attr_tmp(1) + attr_tmp(2) + attr_tmp(3) + attr_tmp(4)\n            'now if the key pk doesn't exists in the dictionary, it add the key(pk) and the item(attr(1)) to thedictionary \n            'with the else condition.\n            'If the key already exists, then add attr(1)to the key pk\n            'THE PROBLEMS IS IN THIS PASSAGE &gt;&gt; THE SUM DICT(PK)+ATTR(1) DOESN'T WORK AND EVERY TIME IT PASS ME THE VALUE OF ATTR(1)    \n            If dict.Exists(pk) Then\n                dict(pk)(1) = dict(pk)(1) + attr(1)\n            Else: dict.Add pk, attr\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "string-comparison", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1484745599, "post_id": 41720508, "comment_id": 70635571, "body": "try <code>If item Like prod Then</code>"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 1, "creation_date": 1484745766, "post_id": 41720508, "comment_id": 70635705, "body": "Have you tried <code>, CompareMethod.Text</code> or <code>Binary</code> after the <code>item, prod</code>? It might be that you just need to set the compare method. Also check if there are any additional spaces as they might cause it to return false"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 1, "creation_date": 1484746239, "post_id": 41720508, "comment_id": 70636064, "body": "have you tried the old but gold item = prod ?"}], "answers": [{"tags": [], "owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "is_accepted": false, "score": 0, "last_activity_date": 1484748555, "creation_date": 1484748555, "answer_id": 41721618, "question_id": 41720508, "link": "https://stackoverflow.com/questions/41720508/string-comparison-vba/41721618#41721618", "title": "String comparison VBA", "body": "<p>This seems to me that you are comparing a <code>item</code> as <code>String</code> with a <code>prod</code> as <code>Variant</code>, because you did a confusion in your variables declaration.</p>\n\n<p>Would you add</p>\n\n<pre><code>Option Explicit\n</code></pre>\n\n<p>at the top, would you see that your code requires </p>\n\n<pre><code>Dim search As Range, cell As Range\nDim prod As String, item As String\n</code></pre>\n\n<p>... This is Excel-VBA, not VB.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 85, "user_id": 3895584, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bc6f39c944fa8a15c5e66dc1b86b6678?s=128&d=identicon&r=PG&f=1", "display_name": "Lancealott92", "link": "https://stackoverflow.com/users/3895584/lancealott92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 546, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484748596, "creation_date": 1484745500, "last_edit_date": 1531164843, "question_id": 41720508, "link": "https://stackoverflow.com/questions/41720508/string-comparison-vba", "title": "String comparison VBA", "body": "<p>I am trying to complete a string comparison between a range and the cells to the left of it. So it goes through a range, looks at a cell, takes the value to the right and compares them. The end goal being to populate an array with all the values that match.</p>\n\n<p>The issue I am having is when I use debug.print, the string's do seem to match. However the StrComp evaluation i am using is evaluating to false. </p>\n\n<pre><code>Sub FilterProdType()\n'Get the product filter chosen and set to a variable\nDim bArray As Variant\nDim search, cell As Range\nDim prod, item As String\nSet search = Sheet2.Range(\"B2:B41\")\n\n\nFor Each cell In search\n    prod = Sheet1.Range(\"PRODTYPE\").Value\n    item = cell.Offset(0, 1).Value\n    Debug.Print (\"Value in range 'B2:B41':\" &amp; prod)\n    Debug.Print (\"Value in cell directly left one column:\" &amp; item)\n    MsgBox StrComp(item, prod) = 0\nNext cell\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["vba", "excel", "data-structures"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1484745006, "post_id": 41720284, "comment_id": 70635116, "body": "Maybe you mean Collection"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1484745126, "post_id": 41720284, "comment_id": 70635212, "body": "an array maybe? Or a collection? Or a class?"}, {"owner": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "edited": false, "score": 0, "creation_date": 1484745206, "post_id": 41720284, "comment_id": 70635269, "body": "I try to find duplicates. As far as I understand arrays and collections or not indexed, so I&#39;d have to traverse the whole thing to find out if a certain value is alread present."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1484745488, "post_id": 41720284, "comment_id": 70635497, "body": "Per definitonem a set cannot contain duplicates, right?"}, {"owner": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "edited": false, "score": 0, "creation_date": 1484745635, "post_id": 41720284, "comment_id": 70635600, "body": "Exactly and normally it has an efficient way of ensuring this and a method to check if a value is already present. This is what I want to use to find duplicate rows in a sheet."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1484745958, "post_id": 41720284, "comment_id": 70635846, "body": "Maybe you look here <a href=\"http://www.excelfunctions.net/find-duplicate-rows.html\" rel=\"nofollow noreferrer\">excelfunctions.net/find-duplicate-rows.html</a>"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 2, "creation_date": 1484746005, "post_id": 41720284, "comment_id": 70635877, "body": "<code>Scripting.Dictionary</code> keys are unique, <code>Exists</code> method allows to check if a key is already in the dictionary."}, {"owner": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1484746109, "post_id": 41720284, "comment_id": 70635954, "body": "@omegastripes Thats what I&#39;m trying to do now, thank you. As I only need the key and not the value, I thought the Dictionary might be overkill."}, {"owner": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1484746174, "post_id": 41720284, "comment_id": 70636018, "body": "@Storax Thank you, for the idea. I try do it programatically, so this doesn&#39;t work in my case."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1484747993, "post_id": 41720284, "comment_id": 70637242, "body": "@Sandro Do you want to highlight the duplicated cells in a column, or to retrieve a list of distinct (or a list of duplicated) values from a column?"}, {"owner": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1484750365, "post_id": 41720284, "comment_id": 70638994, "body": "@omegastripes I concatenate the cells of each row and want to find the ones that are the same. So far it&#39;s a programming problem, I don&#39;t know about presentation yet."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1484847830, "post_id": 41720284, "comment_id": 70689178, "body": "@Sandro Dictionary is actually pretty fast, and it&#39;s a hashtable which is the right implementation for a set. I personally would just write a wrapper for Dictionary that exposes the methods you need. I&#39;ll add an answer for you."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1484849273, "post_id": 41720284, "comment_id": 70689956, "body": "@Sandro I wrote a HashSet class from scratch, but it&#39;s probably overkill for your purposes. It uses a dynamic array which grows as items are added, with a default load factor of 75% to minimize collisions. Collisions are handled with linked lists. If you&#39;re interested let me know - in many cases it&#39;s faster than Scripting.Dictionary because it uses ASCII instead of Unicode - I use djb2 for string hashing."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1484849306, "post_id": 41720284, "comment_id": 70689974, "body": "<a href=\"http://stackoverflow.com/questions/32618635/how-can-i-get-a-unique-set-of-values/32618636#32618636\">Using a Dictionary or Collection for unique values in VBA</a>; and <a href=\"http://stackoverflow.com/a/32396594/111794\">using SQL against Excel</a>."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1484890824, "post_id": 41720284, "comment_id": 70705530, "body": "Answering the question - take a look at <a href=\"https://msdn.microsoft.com/en-us/library/system.collections.arraylist(v=vs.110).aspx\" rel=\"nofollow noreferrer\">.NET ArrayList</a>, you can instantiate the object within VBS and VBA environment <code>Set ArrayList = CreateObject(&quot;System.Collections.ArrayList&quot;)</code>, it has such methods as <code>Add</code>, <code>Contains</code> and <code>Sort</code>."}, {"owner": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1484900136, "post_id": 41720284, "comment_id": 70709393, "body": "@ZevSpitz Thank you, very informative! Especially the first one."}, {"owner": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1484900511, "post_id": 41720284, "comment_id": 70709593, "body": "@omegastripes Thank you for the suggestion. The problem is, there will be very many rows. ArrayList#contains is not efficient, from the doc: <code>This method performs a linear search; therefore, this method is an O(n) operation, where n is Count.</code> So if I use it to find all the duplicated rows I&#39;ll have O(n^2) as opposed O(n) when using a HashSet. Also, I guess this is only possible when .NET is installed."}], "answers": [{"comments": [{"owner": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "edited": false, "score": 0, "creation_date": 1484750818, "post_id": 41721991, "comment_id": 70639355, "body": "Thank you for the detailed answer! What is the difference/advantage to using <code>Scripting.Dictionary</code>. Using a dictionary seems more intuitive as it has the method <code>Exists</code>. I was looking for another datastructure because both collection and dictionary seem to be key-value structures, I only need the key."}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "reply_to_user": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "edited": false, "score": 1, "creation_date": 1484752969, "post_id": 41721991, "comment_id": 70640943, "body": "This is a good source of information for collections vs dictionary (<a href=\"https://www.experts-exchange.com/articles/3391/Using-the-Dictionary-Class-in-VBA.html\" rel=\"nofollow noreferrer\">experts-exchange.com/articles/3391/&hellip;</a>). In reality both work fine for this purpose so pick whichever is more comfortable."}], "tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": false, "score": 3, "last_activity_date": 1484749678, "creation_date": 1484749678, "answer_id": 41721991, "question_id": 41720284, "link": "https://stackoverflow.com/questions/41720284/set-data-structure-in-vba/41721991#41721991", "title": "Set data structure in VBA", "body": "<p>You could use a collection and do the following function, collections enforce unique key identifiers:</p>\n\n<pre><code>Public Function InCollection(Col As Collection, key As String) As Boolean\n  Dim var As Variant\n  Dim errNumber As Long\n\n  InCollection = False\n  Set var = Nothing\n\n  Err.clear\n  On Error Resume Next\n    var = Col.Item(key)\n    errNumber = CLng(Err.Number)\n  On Error GoTo 0\n\n  '5 is not in, 0 and 438 represent incollection\n  If errNumber = 5 Then ' it is 5 if not in collection\n    InCollection = False\n  Else\n    InCollection = True\n  End If\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "edited": false, "score": 1, "creation_date": 1484752779, "post_id": 41722739, "comment_id": 70640791, "body": "Wow, I didn&#39;t know it&#39;s possible to run SQL queries within Excel, nice! For my use case, it should work without saving too, as I use it for validation. Is this somehow possible with this method? I think I can not accept this answer as I&#39;m asking for a set data structure. It would be missleading for people looking for a data structure if this was the accepted answer."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "edited": false, "score": 0, "creation_date": 1484844507, "post_id": 41722739, "comment_id": 70687241, "body": "@Sandro could you please clarify what kind of validation do you need? How do valid and not-valid rows should be displayed?"}, {"owner": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "edited": false, "score": 0, "creation_date": 1484900031, "post_id": 41722739, "comment_id": 70709325, "body": "Your answer seems to do what I was trying to do except for needing to save first. So far it&#39;s only about validating, how the rows will be displayed is not decided yet. So far I resorted to using Scripting.Dictionary, it&#39;s not a Set, but it gets the job done."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 4, "last_activity_date": 1484901173, "last_edit_date": 1484901173, "creation_date": 1484751840, "answer_id": 41722739, "question_id": 41720284, "link": "https://stackoverflow.com/questions/41720284/set-data-structure-in-vba/41722739#41722739", "title": "Set data structure in VBA", "body": "<p>Take a look at <a href=\"https://msdn.microsoft.com/en-us/library/system.collections.arraylist(v=vs.110).aspx\" rel=\"nofollow noreferrer\">.NET ArrayList</a>, it has such methods as <code>Add</code>, <code>Contains</code>, <code>Sort</code> etc. You can instantiate the object within VBS and VBA environment:</p>\n\n<pre><code>Set ArrayList = CreateObject(\"System.Collections.ArrayList\")\n</code></pre>\n\n<p><code>Scripting.Dictionary</code> also may fit the needs, it has unique keys, <code>Exists</code> method allows to check if a key is already in the dictionary.</p>\n\n<p>However, SQL request via ADODB probably will be more efficient for that case. The below examples shows how to retrieve unique rows via SQL query to the worksheet:</p>\n\n<pre><code>Option Explicit\n\nSub GetDistinctRecords()\n\n    Dim strConnection As String\n    Dim strQuery As String\n    Dim objConnection As Object\n    Dim objRecordSet As Object\n\n    Select Case LCase(Mid(ThisWorkbook.Name, InStrRev(ThisWorkbook.Name, \".\")))\n        Case \".xls\"\n            strConnection = \"Provider=Microsoft.Jet.OLEDB.4.0;User ID=Admin;Data Source='\" &amp; ThisWorkbook.FullName &amp; \"';Mode=Read;Extended Properties=\"\"Excel 8.0;HDR=YES;\"\";\"\n        Case \".xlsm\", \".xlsb\"\n            strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source='\" &amp; ThisWorkbook.FullName &amp; \"';Mode=Read;Extended Properties=\"\"Excel 12.0 Macro;HDR=YES;\"\";\"\n    End Select\n\n    strQuery = \"SELECT DISTINCT * FROM [Sheet1$]\"\n    Set objConnection = CreateObject(\"ADODB.Connection\")\n    objConnection.Open strConnection\n    Set objRecordSet = objConnection.Execute(strQuery)\n    RecordSetToWorksheet Sheets(2), objRecordSet\n    objConnection.Close\n\nEnd Sub\n\nSub RecordSetToWorksheet(objSheet As Worksheet, objRecordSet As Object)\n\n    Dim i As Long\n\n    With objSheet\n        .Cells.Delete\n        For i = 1 To objRecordSet.Fields.Count\n            .Cells(1, i).Value = objRecordSet.Fields(i - 1).Name\n        Next\n        .Cells(2, 1).CopyFromRecordset objRecordSet\n        .Cells.Columns.AutoFit\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Source data should be placed on the <code>Sheet1</code>, the result is output to the <code>Sheet2</code>. The only limitation for that method is that ADODB connects to the Excel workbook on the drive, so any changes should be saved before query to get actual results.</p>\n\n<p>If you want to get only the set of non-distinct rows, then the query should be as follows (just an example, you have to put your set of fields into query):</p>\n\n<pre><code>    strQuery = \"SELECT CustomerID, CustomerName, ContactName, Address, City, PostalCode, Country FROM [Sheet1$] GROUP BY CustomerID, CustomerName, ContactName, Address, City, PostalCode, Country HAVING Count(*) &gt; 1\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "is_accepted": false, "score": 3, "last_activity_date": 1484848560, "creation_date": 1484848560, "answer_id": 41748548, "question_id": 41720284, "link": "https://stackoverflow.com/questions/41720284/set-data-structure-in-vba/41748548#41748548", "title": "Set data structure in VBA", "body": "<p>Simply write a wrapper for <code>Scripting.Dictionary</code> that exposes only set-like operations.</p>\n\n<p><strong>clsSet</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate d As Scripting.Dictionary\n\nPrivate Sub Class_Initialize()\n    Set d = New Scripting.Dictionary\nEnd Sub\n\nPublic Sub Add(var As Variant)\n    d.Add var, 0\nEnd Sub\n\nPublic Function Exists(var As Variant) As Boolean\n    Exists = d.Exists(var)\nEnd Function\n\nPublic Sub Remove(var As Variant)\n    d.Remove var\nEnd Sub\n</code></pre>\n\n<p>And then you can use it like so:</p>\n\n<p><strong>mdlMain</strong></p>\n\n<pre><code>Public Sub Main()\n    Dim s As clsSet\n    Set s = New clsSet\n\n    Dim obj As Object\n\n    s.Add \"A\"\n    s.Add 3\n    s.Add #1/19/2017#\n\n    Debug.Print s.Exists(\"A\")\n    Debug.Print s.Exists(\"B\")\n    s.Remove #1/19/2017#\n    Debug.Print s.Exists(#1/19/2017#)\nEnd Sub\n</code></pre>\n\n<p>Which prints True, False and False as expected.</p>\n"}], "owner": {"reputation": 1226, "user_id": 1207146, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8d4a0c857a00078e5b58ce6068283b50?s=128&d=identicon&r=PG", "display_name": "Sandro", "link": "https://stackoverflow.com/users/1207146/sandro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8403, "favorite_count": 0, "answer_count": 3, "score": 9, "last_activity_date": 1484901173, "creation_date": 1484744881, "last_edit_date": 1484746723, "question_id": 41720284, "link": "https://stackoverflow.com/questions/41720284/set-data-structure-in-vba", "title": "Set data structure in VBA", "body": "<p>I'm looking for a <a href=\"https://en.wikipedia.org/wiki/Set_(abstract_data_type)\" rel=\"noreferrer\">set</a> data structure to use in Excel VBA. What I found so far is Scripting.Dictionary which seems to be a <a href=\"https://en.wikipedia.org/wiki/Associative_array\" rel=\"noreferrer\">map</a>.</p>\n\n<p>Is there also something like a set in VBA?</p>\n\n<p>Basically I'm looking for a data structure that is efficient for finding out if a particular value has already been added.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5383, "user_id": 3664960, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fbcd9ff6662774ee78e2026b3671a4e1?s=128&d=identicon&r=PG&f=1", "display_name": "davejal", "link": "https://stackoverflow.com/users/3664960/davejal"}, "edited": false, "score": 0, "creation_date": 1484746472, "post_id": 41720281, "comment_id": 70636242, "body": "Your question is actually not pressing the enter key, but you want excel to recalculate (refresh) your table after a value is updated using vba. Is that correct?"}, {"owner": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "reply_to_user": {"reputation": 5383, "user_id": 3664960, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fbcd9ff6662774ee78e2026b3671a4e1?s=128&d=identicon&r=PG&f=1", "display_name": "davejal", "link": "https://stackoverflow.com/users/3664960/davejal"}, "edited": false, "score": 0, "creation_date": 1484746558, "post_id": 41720281, "comment_id": 70636292, "body": "@davejal Yes that is"}, {"owner": {"reputation": 5383, "user_id": 3664960, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fbcd9ff6662774ee78e2026b3671a4e1?s=128&d=identicon&r=PG&f=1", "display_name": "davejal", "link": "https://stackoverflow.com/users/3664960/davejal"}, "edited": false, "score": 0, "creation_date": 1484746686, "post_id": 41720281, "comment_id": 70636367, "body": "try <code>ActiveWorkbook.RefreshAll</code> as I edited in my answer"}], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484745211, "post_id": 41720337, "comment_id": 70635277, "body": "Hey thanks a lot for your answer can you give me a bit more context to where I hace to set that ? or instead of what ?"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "reply_to_user": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484745436, "post_id": 41720337, "comment_id": 70635458, "body": "Just replace your sendkey line with one of those :)"}, {"owner": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484745858, "post_id": 41720337, "comment_id": 70635788, "body": "like that  Application.Calculate (&quot;~&quot;)"}], "tags": [], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "is_accepted": false, "score": 0, "last_activity_date": 1484745960, "last_edit_date": 1484745960, "creation_date": 1484745038, "answer_id": 41720337, "question_id": 41720281, "link": "https://stackoverflow.com/questions/41720281/programmatically-press-enter-with-excel-vba/41720337#41720337", "title": "Programmatically press enter with Excel VBA", "body": "<p>What you do is: change the value, and then press \"enter\" , which has no effect.</p>\n\n<p>Use </p>\n\n<pre><code>calculate\n</code></pre>\n\n<p>or</p>\n\n<pre><code>activesheet.calculate\n</code></pre>\n\n<p>edited to make it clear:</p>\n\n<pre><code>Private Sub TextBox1_Change()\nIf TextBox1.Text = \"ALC Test\" Then\n    Range(\"$F$2\").Value = \"17\"\n    calculate\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484745823, "post_id": 41720482, "comment_id": 70635759, "body": "Thanks allot for your answer yes I did that but somehow the excel  refresh is not getting triggered to update my tabel"}, {"owner": {"reputation": 5383, "user_id": 3664960, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fbcd9ff6662774ee78e2026b3671a4e1?s=128&d=identicon&r=PG&f=1", "display_name": "davejal", "link": "https://stackoverflow.com/users/3664960/davejal"}, "reply_to_user": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484746179, "post_id": 41720482, "comment_id": 70636024, "body": "I edited my answer, depending on what you actually want to achieve there are more options"}, {"owner": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484746532, "post_id": 41720482, "comment_id": 70636278, "body": "I am sorry if that was not clear from original question: I type in my text box for example &quot;ALC Test&quot; then in the cell F2 the number 17 appears. The cell F2 has been set as a parameter field on witch my table is updating the part of updating the field is not working , i think that is not getting triggered since there is no enter input when I do it like that manually it works fine"}, {"owner": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484746872, "post_id": 41720482, "comment_id": 70636498, "body": "Thanks for you effort ! but I am sorry still nothing happens .. update my question code"}, {"owner": {"reputation": 5383, "user_id": 3664960, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fbcd9ff6662774ee78e2026b3671a4e1?s=128&d=identicon&r=PG&f=1", "display_name": "davejal", "link": "https://stackoverflow.com/users/3664960/davejal"}, "reply_to_user": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484747122, "post_id": 41720482, "comment_id": 70636668, "body": "could your provide some more details? How is the table refreshed when using the enter key? Using a filter or macro ?"}, {"owner": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484747273, "post_id": 41720482, "comment_id": 70636769, "body": "The tabel in question that should get refreshed is a tabel that was create with a MC Query calling a stored procedure with one parameter.  The parameter is getting update like this have a look at the screen shot"}, {"owner": {"reputation": 5383, "user_id": 3664960, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fbcd9ff6662774ee78e2026b3671a4e1?s=128&d=identicon&r=PG&f=1", "display_name": "davejal", "link": "https://stackoverflow.com/users/3664960/davejal"}, "reply_to_user": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484747343, "post_id": 41720482, "comment_id": 70636815, "body": "I think I know what the problem is, you need to select the cell one which you press enter to make it work"}, {"owner": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484747389, "post_id": 41720482, "comment_id": 70636847, "body": "hmm well that is more or less how you would do it manually, maybe could be ?"}, {"owner": {"reputation": 5383, "user_id": 3664960, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fbcd9ff6662774ee78e2026b3671a4e1?s=128&d=identicon&r=PG&f=1", "display_name": "davejal", "link": "https://stackoverflow.com/users/3664960/davejal"}, "reply_to_user": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "edited": false, "score": 0, "creation_date": 1484747544, "post_id": 41720482, "comment_id": 70636935, "body": "check my last edit <code>Range(&quot;$F$2&quot;).Select</code> before the sendkeys, not sure if the <code>$</code> are needed"}], "tags": [], "owner": {"reputation": 5383, "user_id": 3664960, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fbcd9ff6662774ee78e2026b3671a4e1?s=128&d=identicon&r=PG&f=1", "display_name": "davejal", "link": "https://stackoverflow.com/users/3664960/davejal"}, "is_accepted": true, "score": 2, "last_activity_date": 1484747864, "last_edit_date": 1484747864, "creation_date": 1484745422, "answer_id": 41720482, "question_id": 41720281, "link": "https://stackoverflow.com/questions/41720281/programmatically-press-enter-with-excel-vba/41720482#41720482", "title": "Programmatically press enter with Excel VBA", "body": "<p>Using <a href=\"http://www.contextures.com/excelvbasendkeys.html\" rel=\"nofollow noreferrer\">sendkeys</a> is correct.</p>\n\n<hr>\n\n<p>If you just want to recalculate (refresh) your table data, you could do the following:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n\nIf TextBox1.Text = \"ALC Test\" Then\n        Range(\"$F$2\").Value = \"17\"\n        Range(\"$F$2\").Select\n        Application.SendKeys(\"~\")\n</code></pre>\n\n<p>In your situation, you need to select the cell (that holds the parameters) before the enter command is send to excel.</p>\n"}], "owner": {"reputation": 277, "user_id": 6428983, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4f21b5191b320570a0fa7a4261494e2?s=128&d=identicon&r=PG&f=1", "display_name": "Niko.K", "link": "https://stackoverflow.com/users/6428983/niko-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4082, "favorite_count": 0, "accepted_answer_id": 41720482, "answer_count": 2, "score": 2, "last_activity_date": 1484747864, "creation_date": 1484744876, "last_edit_date": 1592644375, "question_id": 41720281, "link": "https://stackoverflow.com/questions/41720281/programmatically-press-enter-with-excel-vba", "title": "Programmatically press enter with Excel VBA", "body": "<p>I am trying to programmatic press the enter key once a value has been set to specific cell:</p>\n<pre><code>Private Sub TextBox1_Change()\n    If TextBox1.Text = &quot;ALC Test&quot; Then\n        Range(&quot;$F$2&quot;).Value = &quot;17&quot;\n        ActiveWorkbook.RefreshAll\n    End If\n    If TextBox1.Text = &quot;ALC Prod&quot; Then\n        Range(&quot;$F$2&quot;).Value = &quot;54&quot;\n        ActiveWorkbook.RefreshAll\n    End If\n    If TextBox1.Text = &quot;&quot; Then\n        Range(&quot;$F$2&quot;).Value = &quot;&quot;\n        ActiveWorkbook.RefreshAll\n    End If\nEnd Sub\n</code></pre>\n<p>So that I can trigger in excel the refresh of my table\nBut that does not to seam to work correctly</p>\n<p><a href=\"https://i.stack.imgur.com/LzflD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LzflD.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["vba", "excel", "add-in", "sendkeys"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1484744587, "post_id": 41720099, "comment_id": 70634823, "body": "Do you have access to the code of the AddIn? Can you change the code, showing the form to <code>UserForm1.Show vbModeless</code>?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1484744661, "post_id": 41720099, "comment_id": 70634870, "body": "@Vityata No, I wish :)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1484744895, "post_id": 41720099, "comment_id": 70635036, "body": "Does the addin have any public access, so <code>MyAddIn.</code> then after the dot  what does intellisense say, can it be set like <code>MyAddin.Value=ValueToSet</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1484745534, "post_id": 41720099, "comment_id": 70635531, "body": "@Nathan_Sav it seems not, when I loop thorugh all Add-Ins with <code>For Each ad In Application.AddIns</code> it&#39;s not there."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1484745825, "post_id": 41720099, "comment_id": 70635761, "body": "It may be a COM addin written o/s VBA."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1484747024, "post_id": 41720099, "comment_id": 70636598, "body": "You could take a look at the Application.ComAddins(addinname).connect property setting to false, to maybe stop."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1484748573, "post_id": 41720099, "comment_id": 70637632, "body": "In this question <a href=\"http://stackoverflow.com/q/34861395/4039286\">Handling the prompts of another Add-In</a>. Adding <code>SendKeys</code> <b>before</b> <code>.SaveAs</code> worked."}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1484745529, "post_id": 41720467, "comment_id": 70635527, "body": "I was thinking of the same (but my idea was a bit lamer, to make the script in a separate file and call it from the VBA)!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484745697, "post_id": 41720467, "comment_id": 70635655, "body": "@Pierre not sure I fully understand where to put it in a code, this section above is inside a <code>For</code> loop, I am saving multiple files for each Project Manager."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1484745761, "post_id": 41720467, "comment_id": 70635697, "body": "@Vityata : well mine is lame too, just &quot;clean&quot; in that you can remove the VBS after use"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484745815, "post_id": 41720467, "comment_id": 70635751, "body": "@ShaiRado : you create the VBS file once and for all. Each time you have to press &quot;enter&quot; on a form, before opening the form, you run the VBS. Then after the form is closed, you get into your VBA again"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484745901, "post_id": 41720467, "comment_id": 70635809, "body": "@Pierre I need to leave for home, will try it later at home (if my kids will let me)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1484746411, "post_id": 41720467, "comment_id": 70636207, "body": "@Pierre, my idea was manually to create the file somewhere and to refer it each time. In your solution, the vbs file does not exist on the harddrive."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1484746554, "post_id": 41720467, "comment_id": 70636290, "body": "@vitayata: it is created on the HDD and then removed again. That&#39;s why, only slightly less lame :D"}], "tags": [], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "is_accepted": false, "score": 2, "last_activity_date": 1484745909, "last_edit_date": 1484745909, "creation_date": 1484745377, "answer_id": 41720467, "question_id": 41720099, "link": "https://stackoverflow.com/questions/41720099/excel-vba-sendkeys-not-working-when-trying-to-send-to-excel-add-in/41720467#41720467", "title": "Excel VBA SendKeys not working when trying to Send to Excel Add-In", "body": "<p>The fact that you launched the  addin popup \"froze\" the code.\nI know no way to do this asynchroneously in VBA (now I began using VB.NET I feel sooooo much better about those things!).\nThe best i can come up with is:\n- save in a temparary file (temp.vbs for ex) some code and run it BEFORE launching the form:</p>\n\n<pre><code>Dim s$\ns = \"Set WshShell = WScript.CreateObject(\"\"WScript.Shell\"\")\" &amp; vbNewLine &amp; _\n    \"WScript.Sleep 6000\" &amp; vbNewLine &amp; _\n    \"WshShell.SendKeys \"\"+{TAB}\"\"\" &amp; vbNewLine &amp; _\n    \"WshShell.SendKeys \"\"~\"\"\"\nCreateObject(\"Scripting.FileSystemObject\").createtextfile(FileName).write s\nshell(filename)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484827660, "post_id": 41720575, "comment_id": 70675481, "body": "thanks for your help, I ended up using VBScript, but I like to know that I can loop through <code>AddIns</code> :)"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1484745686, "creation_date": 1484745686, "answer_id": 41720575, "question_id": 41720099, "link": "https://stackoverflow.com/questions/41720099/excel-vba-sendkeys-not-working-when-trying-to-send-to-excel-add-in/41720575#41720575", "title": "Excel VBA SendKeys not working when trying to Send to Excel Add-In", "body": "<p>It looks as if your addin is sinking the application workbook before save event, so a quick fix to allow saving, would be to sink it again, so in your code, have the following</p>\n\n<p>In a normal module have the following</p>\n\n<pre><code>Public cResink As clsResinkApplication\n</code></pre>\n\n<p>Have a class called clsResinkApplication and the code for that class will be as follows</p>\n\n<pre><code>Private WithEvents resinkApp As Excel.Application\n\nPublic Sub init2(appToResink As Excel.Application)\n    Set resinkApp = appToResink\nEnd Sub\nPrivate Sub resinkApp_WorkbookBeforeSave(ByVal Wb As Workbook, ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    ActiveWorkbook.SaveAs \"test.xlsx\"\nEnd Sub\n</code></pre>\n\n<p>And then in the workbook open you can have the following</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nSet cResink = New clsResinkApplication\ncResink.init2 Application\n\nEnd Sub\n</code></pre>\n\n<p>This should divert to your save sink before the addin's one.</p>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484827243, "post_id": 41730863, "comment_id": 70675195, "body": "Thanks, took your idea of actualy setting the contents of the VBS inside VBA, and most importatn to keep <code>vbNormalFocus</code>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1484779707, "creation_date": 1484779707, "answer_id": 41730863, "question_id": 41720099, "link": "https://stackoverflow.com/questions/41720099/excel-vba-sendkeys-not-working-when-trying-to-send-to-excel-add-in/41730863#41730863", "title": "Excel VBA SendKeys not working when trying to Send to Excel Add-In", "body": "<pre><code>Public Sub TryMe()\n\n    Dim s           As String\n    Dim sPath       As String\n    Dim sTitle      As String: sTitle = \"runme.vbs\"\n\n    s = \"Set WshShell = WScript.CreateObject(\"\"WScript.Shell\"\")\" &amp; vbNewLine &amp; _\n        \"WScript.Sleep 6000\" &amp; vbNewLine &amp; _\n        \"WshShell.SendKeys \"\"+{TAB}\"\"\" &amp; vbNewLine &amp; _\n        \"WshShell.SendKeys \"\"~\"\"\"\n\n    CreateObject(\"Scripting.FileSystemObject\").createtextfile(sTitle).write s\n    sPath = \"wscript \" &amp; ThisWorkbook.Path &amp; \"\\runme.vbs\"\n    Shell sPath, vbNormalFocus\n\nEnd Sub\n</code></pre>\n\n<p>@Pierre - your idea is to write something like this^^ ?</p>\n\n<p>Then to call it before calling the form and then to delete it somewhere later? Initially I thought that you do not create anywhere the file, but now I have tried it and I noticed. It should work.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1484827609, "creation_date": 1484827609, "answer_id": 41741417, "question_id": 41720099, "link": "https://stackoverflow.com/questions/41720099/excel-vba-sendkeys-not-working-when-trying-to-send-to-excel-add-in/41741417#41741417", "title": "Excel VBA SendKeys not working when trying to Send to Excel Add-In", "body": "<p>I would like to thank @Vityata , @Pierre for the idea to do it with VBScript, and also to write the contents of the VBScipt inside the VBA Code.</p>\n\n<p>What I ended up doing is :</p>\n\n<p><strong>1.</strong> Added the <code>Call WShellSendKeys</code> before calling my Save.</p>\n\n<pre><code>'========== Call the VBScript to run a Shell to send to Keys in the background ======\nCall WShellSendKeys        \nNewWB.SaveAs \"Budget usage - \" &amp; Year(Date) &amp; \"-\" &amp; Month(Date - 30) &amp; \" \" &amp; PMList(r)\n</code></pre>\n\n<p><strong>2.</strong> \nCheck if the VBSciprt already exists, if not create it.</p>\n\n<pre><code>Public Sub WShellSendKeys()\n\nDim wsh         As Object\nDim objFile     As Object\nDim objFSO      As Object\n\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\n\nIf Dir(VBScrPath) &lt;&gt; \"\" Then  ' &lt;-- VBS file name already exits in folder &gt;&gt; there's no need to re-create it, just run it\n    ' Run Shell\n    wsh.Run \"wscript \" &amp; Chr(34) &amp; VBScrPath &amp; Chr(34), vbNormalFocus\nElse ' VBS file name doesn't exits in folder &gt;&gt; create it\n    Call WriteToVBS\n    wsh.Run \"wscript \" &amp; Chr(34) &amp; VBScrPath &amp; Chr(34), vbNormalFocus\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>3.\nAnother Sub that creates the VBScript with the <code>SendKeys</code>.</p>\n\n<pre><code>Sub WriteToVBS()\n\nDim objFile     As Object\nDim objFSO      As Object\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFile = objFSO.OpenTextFile(VBScrPath, 8, True)\n\n' --- Text to write into the VBScript file ---\nobjFile.WriteLine (\"Option Explicit\")\nobjFile.WriteLine (\"\")\nobjFile.WriteLine (\"Dim WshShell\")\nobjFile.WriteLine (\"Dim i\")\nobjFile.WriteLine (\"\")\nobjFile.WriteLine (\"Set WshShell = CreateObject(\"\"WScript.Shell\"\")\")\nobjFile.WriteLine (\"WScript.Sleep(4000)\")\nobjFile.WriteLine (\"\")\nobjFile.WriteLine (\"WshShell.SendKeys \"\"{R}\"\",True\")\nobjFile.WriteLine (\"WScript.Sleep(1000)\")\nobjFile.WriteLine (\"For i = 1 To 2\")\nobjFile.WriteLine (\"WshShell.SendKeys \"\"{ENTER}\"\",True\")\nobjFile.WriteLine (\"WScript.Sleep(1000)\")\nobjFile.WriteLine (\"Next\")\n\nobjFile.Close\nSet objFile = Nothing\nSet objFSO = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1861, "favorite_count": 0, "accepted_answer_id": 41730863, "answer_count": 4, "score": 3, "last_activity_date": 1484827609, "creation_date": 1484744368, "last_edit_date": 1484745828, "question_id": 41720099, "link": "https://stackoverflow.com/questions/41720099/excel-vba-sendkeys-not-working-when-trying-to-send-to-excel-add-in", "title": "Excel VBA SendKeys not working when trying to Send to Excel Add-In", "body": "<p><strong>Intro.</strong>: In my company we have a security Add-In installed in Excel, preventing us to save a new Excel workbook without entering the parameters needed.</p>\n\n<p><strong>Challenge</strong>: use the <code>SendKeys</code> to send the keys needed to this Excel Add-In.</p>\n\n<p><strong>Problem</strong>: when the Add-In screen pops-up (as can be seen in the screen-shot below) the code doesn't seem to continue to this line: <code>SendKeys \" \", True</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AHBMM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AHBMM.png\" alt=\"Classification Add-In\"></a></p>\n\n<p><strong>My Code</strong> (relevant part)</p>\n\n<p><strong>Edit 1</strong>: The code below is inside a <code>For</code> loop, I am exporting a filterred DB for each user to that user. So everytime I try to save a file for one of the users I will encounter the Add-In (I need to <strong>\"by-pass\"</strong> it inside the <code>For</code> loop).</p>\n\n<pre><code>' sort the PM's workbook , hide source data    \nApplication.DisplayAlerts = False\nNewWB.Sheets(\"Combined\").Visible = False\nNewWB.Sheets(\"Sheet3\").Delete\nNewWB.SaveAs \"Budget usage - \" &amp; Year(Date) &amp; \"-\" &amp; Month(Date - 30) &amp; \" \" &amp; PMList(r)\n\nDim i    As Long\n\nSendKeys \" \", True ' &lt;-- it doesn't get to this line when the Excel Add-In pops up\nFor i = 1 To 3\n    SendKeys \"+{DOWN}\", True\nNext i\nSendKeys \"{ENTER}\", True\nFor i = 1 To 4\n    SendKeys \"+\", True\nNext i\nSendKeys \"{ENTER}\", True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "reply_to_user": {"reputation": 3184, "user_id": 6710751, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qmR1W.jpg?s=128&g=1", "display_name": "Striezel", "link": "https://stackoverflow.com/users/6710751/striezel"}, "edited": false, "score": 0, "creation_date": 1484744394, "post_id": 41719858, "comment_id": 70634699, "body": "I tried this one, but this one is used to sort the data in each of the name range  &lt;code&gt;Sub sortingdata()       Dim nRange As name     For Each nRange In ActiveWorkbook.Names         If UCase(nRange.name) Like (&quot;TEST*&quot;) Then             Range(nRange.name).Sort Key1:=Range(nRange.name).Cells(2, 3), _             Order1:=xlAscending, Header:=xlYes         End If     Next nRange End Sub &lt;code&gt;"}, {"owner": {"reputation": 3184, "user_id": 6710751, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qmR1W.jpg?s=128&g=1", "display_name": "Striezel", "link": "https://stackoverflow.com/users/6710751/striezel"}, "edited": false, "score": 0, "creation_date": 1484744542, "post_id": 41719858, "comment_id": 70634796, "body": "You can also edit your question to add the code there."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1484746122, "post_id": 41719858, "comment_id": 70635970, "body": "why would you ever want to do such a thing??? Maybe the answer is &quot;think again avout those named ranges things&quot;"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484756317, "post_id": 41719858, "comment_id": 70643293, "body": "may be you add some examples of a &quot;before&quot; and &quot;after&quot; scenarios"}, {"owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "reply_to_user": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1484819069, "post_id": 41719858, "comment_id": 70670121, "body": "because user will insert a set of data same as the image above @Pierre"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1484820269, "post_id": 41719858, "comment_id": 70670941, "body": "@mfo_28 : how does it imply you should use named ranges?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "edited": false, "score": 0, "creation_date": 1484819204, "post_id": 41720834, "comment_id": 70670223, "body": "I want to sort the named ranges. can we lock the data to the cell that I want to sort, so that it will move together? Please refer to the image above, I just attached"}, {"owner": {"reputation": 161, "user_id": 7416111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867203559b28816f0a7a5ff95adf2f6c?s=128&d=identicon&r=PG&f=1", "display_name": "mkinson", "link": "https://stackoverflow.com/users/7416111/mkinson"}, "reply_to_user": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "edited": false, "score": 0, "creation_date": 1484829235, "post_id": 41720834, "comment_id": 70676493, "body": "This might be easier with offset given your data. I would start by locating the row values of Data1 and Data2, and then set a row range of Data2 to be Data2 through (Data1-Data2)-2 to account for the blank space. For Data2 use find the last row or for your reference or if you have a Data3, Data4, etc. then make a loop function to calculate each iteration of &quot;Data[n]&quot;. Then you can offset the columns by 4 as well. That way the sort will be in reference to the Data1 and Data2 labels."}], "tags": [], "owner": {"reputation": 161, "user_id": 7416111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867203559b28816f0a7a5ff95adf2f6c?s=128&d=identicon&r=PG&f=1", "display_name": "mkinson", "link": "https://stackoverflow.com/users/7416111/mkinson"}, "is_accepted": false, "score": 1, "last_activity_date": 1484747101, "last_edit_date": 1484747101, "creation_date": 1484746421, "answer_id": 41720834, "question_id": 41719858, "link": "https://stackoverflow.com/questions/41719858/how-to-sort-multiple-named-ranges-based-on-one-column/41720834#41720834", "title": "How to sort multiple named ranges based on one column?", "body": "<p>Assuming what you want to sort on is a repeated string in several rows, such as Column A, Rows 24-50 all contain \"file1\" then you can use the following code to select all rows that contain that string in the specified column. From there you can apply your sort.</p>\n\n<pre><Code>\n    Private Sub Test1()\n\n    Dim c As Range\n    Dim d As Range\n    Dim Fitem As String \n    Dim FEndRange As Long\n    Dim FStartRange As Long\n\n'Search for the name of the header you want to base your range off of...\n\n    With Worksheets(\"Sheet1\").Range(\"A1\").EntireRow\n    Set c = .Find(\"HEADER\", LookIn:=xlValues)\n    End With\n\n    With Worksheets(\"Sheet1\").Range(c.Address).EntireColumn\n    Set d = .Find(\"file1\", LookIn:=xlValues)\n    Set c = Worksheets(\"Sheet1\").Cells(d.Row, c.Column)\n    Fitem = c.Value\n    End With\n\n    If (c.EntireColumn.Find(what:=Fitem, lookat:=xlWhole, After:=Cells(2, c.Column)).Row)  0 Then\n    FStartRange = c.EntireColumn.Find(what:=Fitem, After:=Cells(1, c.Column)).Row\n    FEndRange = c.EntireColumn.Find(what:=Fitem, After:=Cells(1, c.Column), searchdirection:=xlPrevious).Row\n\n    Worksheets(\"Sheet1\").Cells(FStartRange, d.Column).Activate\n    Worksheets(\"Sheet1\").Range(Worksheets(\"Sheet1\").Cells(FStartRange, d.Column), Worksheets(\"Sheet1\").Cells(FEndRange, d.Column)).EntireRow.Select\n\n        ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\n        ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=c, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortTextAsNumbers\n    With ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n\n'place your sort criteria here\n\n    End With\n    End If\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 7416111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867203559b28816f0a7a5ff95adf2f6c?s=128&d=identicon&r=PG&f=1", "display_name": "mkinson", "link": "https://stackoverflow.com/users/7416111/mkinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1484831861, "creation_date": 1484831861, "answer_id": 41742769, "question_id": 41719858, "link": "https://stackoverflow.com/questions/41719858/how-to-sort-multiple-named-ranges-based-on-one-column/41742769#41742769", "title": "How to sort multiple named ranges based on one column?", "body": "<p>Based on the new info from your picture and comments the following code should get you where you need to be. <br/><br/></p>\n\n<pre><code>\n    Option Explicit\n    Private Sub Test()\n\n    Dim x As Long\n    Dim y As Long\n    Dim s As Long\n    Dim t As Long\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim lastrow As Long\n\n    lastrow = ActiveWorkbook.Worksheets(\"Sheet1\").Cells(ActiveWorkbook.Worksheets(\"Sheet1\").Rows.Count, \"E\").End(xlUp).Row\n    Set ws = Worksheets(\"Sheet1\")\n\n    ws.Activate\n    y = WorksheetFunction.CountIf(Range(\"A:A\"), \"Data*\")\n    s = 1\n\n    For x = 1 To y\n    s = ws.Range(\"A:A\").Find(what:=\"Data*\", after:=Range(\"A\" & s)).Row\n\n    If x = y Then\n    t = lastrow + 2\n    Else\n    t = ws.Range(\"A:A\").Find(what:=\"Data*\", after:=Range(\"A\" & s)).Row\n    End If\n\n    ws.Range(ws.Cells(s, 5), ws.Cells(t - 2, 17)).Select\n\n'Add sort criteria here\n\n    Next x\n\n    End Sub\n</code></pre>\n\n<p>The letters I use are arbitrary and can be changed to anything.</p>\n"}], "owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1484831861, "creation_date": 1484743692, "last_edit_date": 1484818935, "question_id": 41719858, "link": "https://stackoverflow.com/questions/41719858/how-to-sort-multiple-named-ranges-based-on-one-column", "title": "How to sort multiple named ranges based on one column?", "body": "<p>I need to sort multiple named ranges in one excel sheet which already named by Data1, Data2,...</p>\n\n<p>In each named range, there is a cell that will be used for sorting. My problem is I want all the data in the named range to move accordingly to the sorted cell.</p>\n\n<p>Based on the picture, if column A is sorted, the data in the right side also move upward.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UAKYf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UAKYf.png\" alt=\"Example of my files\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "edited": false, "score": 0, "creation_date": 1484746367, "post_id": 41719990, "comment_id": 70636175, "body": "One last question please, if i want to copy two ranges at once ? as in: Set copyRange = Src.range(&quot;A3:H,O3:R&quot; &amp; lastRow)  - as in skipping certain columns from copy-paste how can i do it ?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "edited": false, "score": 0, "creation_date": 1484747640, "post_id": 41719990, "comment_id": 70636993, "body": "@mistera : I don&#39;t know, generally I use the macro recorder and then customise the code! But pasting it will probably be quite a mess, so maybe do it in 2 copy/paste! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1484744093, "creation_date": 1484744093, "answer_id": 41719990, "question_id": 41719850, "link": "https://stackoverflow.com/questions/41719850/paste-data-values-copied-a-sheet-to-another-sheet/41719990#41719990", "title": "Paste data values - copied a sheet to another sheet", "body": "<p>Your code didn't know which workbook or sheet you were refering to.</p>\n\n<p>See this :</p>\n\n<pre><code>Sub ExportRezAng()\n'\n' ExportRezAng Macro\n    Dim Src As Worksheet\n    Dim tgt As Worksheet\n    Dim filterRange As Range\n    Dim copyRange As Range\n    Dim lastRow As Long\n    Dim wB As Workbook\n\n    Set Src = ThisWorkbook.Sheets(\"- - REZULTAT ANAF - -\")\n\n    ' turn off any autofilters that are already set\n    Src.AutoFilterMode = False\n\n    ' find the last row with data in column A\n    lastRow = Src.Range(\"D\" &amp; Src.Rows.Count).End(xlUp).Row\n\n    ' the range that we are auto-filtering (all columns)\n    Set filterRange = Src.Range(\"A3:R\" &amp; lastRow)\n\n    ' the range we want to copy (only columns we want to copy)\n    ' in this case we are copying country from column A\n    ' we set the range to start in row 2 to prevent copying the header\n    Set copyRange = Src.Range(\"A3:N\" &amp; lastRow)\n\n    ' filter range based on column B\n    filterRange.AutoFilter Field:=9, Criteria1:=\"DA\", _\n        Operator:=xlOr, Criteria2:=\"=NU\"\n\n    ' copy the visible cells to our target range\n    ' note that you can easily find the last populated row on this sheet\n    ' if you don't want to over-write your previous results\n    copyRange.SpecialCells(xlCellTypeVisible).Copy\n\n    Set wB = Workbooks.Add\n    With wB.Sheets(1)\n        With .Range(\"A1\")\n            .PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n                SkipBlanks:=False, Transpose:=False\n            .PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n                SkipBlanks:=False, Transpose:=False\n            Application.CutCopyMode = False\n        End With '.Range(\"A1\")\n        .Columns(\"M:N\").NumberFormat = \"m/d/yyyy\"\n        .Name = \"CREDIT_DOSARE_EXECUTORI\"\n    End With 'wB.Sheets(1)\n\n    Src.AutoFilter.Sort.SortFields.Clear\n    Src.ShowAllData\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 41719990, "answer_count": 1, "score": 1, "last_activity_date": 1484744485, "creation_date": 1484743666, "last_edit_date": 1484744485, "question_id": 41719850, "link": "https://stackoverflow.com/questions/41719850/paste-data-values-copied-a-sheet-to-another-sheet", "title": "Paste data values - copied a sheet to another sheet", "body": "<p>I have a code that filters a table/range then copies the results and tries to create a new workbook and paste the data there (paste values &amp; keep formating).</p>\n\n<p>Also after it's done it tries to clear the filters from the source table.</p>\n\n<p><strong>I can't make it paste the data in the new workbook from A1 (hedears included). It gets stuck and says \"range not defined\".</strong> (it only pastes the formatting and gets stuck when trying to paste the values).</p>\n\n<p>Also I'm new to vba but i have the feeling that the code starting from <strong>Selection.Copy   ; Workbooks.Add</strong> lines is basic/flauded and prone to errors.</p>\n\n<p>Please help, this is the code: </p>\n\n<pre><code>Sub ExportRezAng()\n'\n' ExportRezAng Macro\n\n\n    Dim src As Worksheet\n    Dim tgt As Worksheet\n    Dim filterRange As range\n    Dim copyRange As range\n    Dim lastRow As Long\n\n    Set src = ThisWorkbook.Sheets(\"- - REZULTAT ANAF - -\")\n\n\n    ' turn off any autofilters that are already set\n    src.AutoFilterMode = False\n\n    ' find the last row with data in column A\n    lastRow = src.range(\"D\" &amp; src.Rows.Count).End(xlUp).Row\n\n    ' the range that we are auto-filtering (all columns)\n    Set filterRange = src.range(\"A3:R\" &amp; lastRow)\n\n    ' the range we want to copy (only columns we want to copy)\n    ' in this case we are copying country from column A\n    ' we set the range to start in row 2 to prevent copying the header\n    Set copyRange = src.range(\"A3:N\" &amp; lastRow)\n\n    ' filter range based on column B\n    filterRange.AutoFilter Field:=9, Criteria1:=\"DA\", _\n        Operator:=xlOr, Criteria2:=\"=NU\"\n\n    ' copy the visible cells to our target range\n    ' note that you can easily find the last populated row on this sheet\n    ' if you don't want to over-write your previous results\n    copyRange.SpecialCells(xlCellTypeVisible).Select\n</code></pre>\n\n<p><strong>' FROM HERE THE PROBLEMS START !!!</strong></p>\n\n<pre><code>    Selection.Copy\n    Workbooks.Add\n    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n\n    Columns(\"M:N\").Select\n    Application.CutCopyMode = False\n    Selection.NumberFormat = \"m/d/yyyy\"\n    Sheets(\"Sheet1\").Select\n    Sheets(\"Sheet1\").Name = \"CREDIT_DOSARE_EXECUTORI\"\n\n ThisWorkbook. _\n        Activate\n    Rows(\"3:3\").Select\n    Application.CutCopyMode = False\n    ThisWorkbook.Worksheets(\"- - REZULTAT ANAF - -\").AutoFilter.Sort.SortFields. _\n        Clear\n    ActiveSheet.ShowAllData\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484742771, "post_id": 41719435, "comment_id": 70633611, "body": "Welcome to StackOverflow. If you show us the code you have written we are more likely to be effective in helping you."}, {"owner": {"reputation": 1, "user_id": 7435568, "user_type": "registered", "profile_image": "https://graph.facebook.com/1361433410545387/picture?type=large", "display_name": "Jeff Boud", "link": "https://stackoverflow.com/users/7435568/jeff-boud"}, "reply_to_user": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484745355, "post_id": 41719435, "comment_id": 70635399, "body": "i already found a way to do it. first i delete the entry and i add it"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1484747174, "post_id": 41719435, "comment_id": 70636703, "body": "Without deleting, you can match() your value, determine cell row/column of the matched cell, in cells(row,column+1) you would insert the .value of your initial cell.  If you loop this through the list of cells, it would be relatively quick and doesn&#39;t require deleting/adding.  I will type this up in a little bit, if this is wanted.  Leaving a comment before dedicating effort, in case you don&#39;t need this."}, {"owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "edited": false, "score": 0, "creation_date": 1484747715, "post_id": 41719435, "comment_id": 70637050, "body": "@JeffBoud better to answer your own question than to edit a question to include the answerstackoverflow.com/help/self-answer"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1484749764, "post_id": 41719435, "comment_id": 70638523, "body": "Eh, thought about it and didn&#39;t have to write much.  Posted as answer."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7435568, "user_type": "registered", "profile_image": "https://graph.facebook.com/1361433410545387/picture?type=large", "display_name": "Jeff Boud", "link": "https://stackoverflow.com/users/7435568/jeff-boud"}, "edited": false, "score": 0, "creation_date": 1484813766, "post_id": 41721951, "comment_id": 70667020, "body": "Thanks, this helps a lot."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1484749561, "creation_date": 1484749561, "answer_id": 41721951, "question_id": 41719435, "link": "https://stackoverflow.com/questions/41719435/replace-row-in-excel-based-on-specific-value/41721951#41721951", "title": "Replace row in excel based on specific value", "body": "<pre><code>Sub Tickets()\n\nDim i As Variant\nDim LR As Long\nDim IDN As Variant\nDim IDV As Variant\nDim IDNR As Integer\nDim IDNC As Integer\n\nLR = Cells(Sheets(\"Overview\").Rows.Count, 1).End(xlUp).Row\nIDNR = ActiveCell.Row\nIDNC = ActiveCell.Column\n\nIDN = Cells(IDNR, IDNC).Value 'ID Name, you should highlight this cell when starting work\nIDV = Cells(IDNR, IDNC - 1).Value 'ID Value, e.g. your ID 5001, if it is the adjacent cell left\n\nIf IDN = Application.WorksheetFunction.Index(Sheets(\"Overview\").Range(Cells(1, 2), Cells(LR, 2)), Application.WorksheetFunction.Match(IDV, Sheets(\"Overview\").Range(Cells(1, 1), Cells(LR, 1)))).Value Then\n    MsgBox \"This matches!\"\n\n    Else:\n        For i = 1 To LR\n            If IDV = Sheets(\"Overview\").Cells(i, 1).Value Then\n                Sheets(\"Overview\").Cells(i, 2).Value = IDN\n                Else:\n                End If\n                Next i\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I have some specific sheet names utilized, so watch that (\"Overview\" because you talked about that in your narrative) and the ActiveCell should be the cell with the name you're looking to verify (Cells (1,1) reads \"ID 5001\" and Cells(1,2) reads \"Cage\").</p>\n\n<p>This will check through the list on Overview if \"ID 5001\" exists (matches your existing ID (adjacent to IDN) and would determine if the Name (\"Cage\") is in the adjacent cell.  If not, it will replace Cage with your prefered Name for that ID.</p>\n"}], "owner": {"reputation": 1, "user_id": 7435568, "user_type": "registered", "profile_image": "https://graph.facebook.com/1361433410545387/picture?type=large", "display_name": "Jeff Boud", "link": "https://stackoverflow.com/users/7435568/jeff-boud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1564, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1484749561, "creation_date": 1484742449, "last_edit_date": 1484745460, "question_id": 41719435, "link": "https://stackoverflow.com/questions/41719435/replace-row-in-excel-based-on-specific-value", "title": "Replace row in excel based on specific value", "body": "<p>I am pretty new to VBA and i got this difficult question.\nI am using a sheet where i enter the cells and press a button to either make a new row or make a change to that row in the overview sheet.</p>\n\n<p>The last one, i can not seem to get working.\nI want the macro to check if the ID is present in the overview sheet.</p>\n\n<p>Example</p>\n\n<p>I got one record with ID 5000 and name \"Luke\"\nAnd one record wtith ID 5001 and name \"Cage\"</p>\n\n<p>I change the name in the the record with ID 5000 to \"Xander\" in my form sheet</p>\n\n<p>I press the button \"Change record\" and the macro searches for the record with ID 5000 and changes the name into \"Xander\"</p>\n\n<p>Hope you guys can help or point me in the right direction.</p>\n\n<p>I found a way to do it, by first deleting and then adding it again.</p>\n\n<pre><code>    Dim lRow As Long\nDim iCntr As Long\nDim Ticketnumber As Long\n\nSheets(\"Form\").Select\n\nTicketnumber = Range(\"B1\")\n\nSheets(\"Tickets\").Select\n\nlRow = Cells(Rows.Count, 1).End(xlUp).Row\nFor iCntr = lRow To 1 Step -1\nIf Cells(iCntr, 1) = Ticketnumber Then\nRows(iCntr).Delete\nEnd If\nNext\n\nSheets(\"Form\").Select\n\n    Range(\"B1:B14\").Select\n    Selection.Copy\n    Sheets(\"Tickets\").Select\n    Worksheets(\"Tickets\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0).PasteSpecial Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\n\n    ActiveWorkbook.Worksheets(\"Tickets\").AutoFilter.Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Tickets\").AutoFilter.Sort.SortFields.Add Key:= _\n        Range(\"A2\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Tickets\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\nWorksheets(\"Form\").Range(\"B1:B14\").Clear\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": false, "score": 0, "last_activity_date": 1484812081, "creation_date": 1484812081, "answer_id": 41736421, "question_id": 41718876, "link": "https://stackoverflow.com/questions/41718876/ms-word-hiding-a-row-in-a-table-depending-on-content-control-value/41736421#41736421", "title": "MS Word - Hiding a Row in a Table depending on Content Control value", "body": "<p>Assuming that:</p>\n\n<ul>\n<li>each <code>ContentControl</code> covers the whole single row </li>\n<li>you do not use nested tables in document</li>\n</ul>\n\n<p>you can place this code inside your <code>if statement</code>:</p>\n\n<pre><code>CC.Range.Tables(1).Rows(CC.Range.Information(wdEndOfRangeRowNumber)).Delete\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7435451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c15a016d740e46168ffe12d1d35abc21?s=128&d=identicon&r=PG&f=1", "display_name": "Giacomo Napolitano", "link": "https://stackoverflow.com/users/7435451/giacomo-napolitano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 818, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1484812081, "creation_date": 1484740815, "last_edit_date": 1484740943, "question_id": 41718876, "link": "https://stackoverflow.com/questions/41718876/ms-word-hiding-a-row-in-a-table-depending-on-content-control-value", "title": "MS Word - Hiding a Row in a Table depending on Content Control value", "body": "<p>I have a very long word file, containing several tables.\nEach table contains a list of items that may or may not be applicable to the user.</p>\n\n<p>I am trying to find a way of hiding/masking rows that have not been filled by the user.</p>\n\n<p>To do so, I was thinking of writing a sub that go through the entire document lookinf for content controls, then checks if the contentcontrol.text=\"NULL\" and then deletes the table row (or hides it by setting the row height to 0).</p>\n\n<p>Any ideas?</p>\n\n<p>Below my partial attempt</p>\n\n<pre><code>Sub HideRows()\nDim d As Document\nSet d = ActiveDocument\nDim cc As ContentControl\n\nFor Each cc In d.ContentControls         \n    If cc.Range.Text = \"NULL\" Then\n\n        'Delete the table row where this content control is located\n\n\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1484740905, "post_id": 41718872, "comment_id": 70632359, "body": "Are you trying to add an ID number to an auto-gen ID number? i.e. agency ID when displaying vs addnew?"}, {"owner": {"reputation": 23, "user_id": 7435440, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154232346208302/picture?type=large", "display_name": "Amy", "link": "https://stackoverflow.com/users/7435440/amy"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1484741143, "post_id": 41718872, "comment_id": 70632502, "body": "@Nathan_Sav  it&#39;s loading an ID number already in the table into the textbox"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1484741240, "post_id": 41718872, "comment_id": 70632574, "body": "Yes, but what if it is bound to a table, then that wont be possible when a new record.  Try putting <code>if not Me.NewRecord then </code>"}, {"owner": {"reputation": 23, "user_id": 7435440, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154232346208302/picture?type=large", "display_name": "Amy", "link": "https://stackoverflow.com/users/7435440/amy"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1484741935, "post_id": 41718872, "comment_id": 70633020, "body": "I&#39;m still getting the same run time error with that change"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7435440, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154232346208302/picture?type=large", "display_name": "Amy", "link": "https://stackoverflow.com/users/7435440/amy"}, "edited": false, "score": 1, "creation_date": 1484745397, "post_id": 41719865, "comment_id": 70635422, "body": "Thanks - that&#39;s got rid of the run time error, but I now get &#39;Run-Time error 3031 - no current record&#39; instead occasionally, even though when I open the query, the record I&#39;m trying to open from the subform is there with an Agency ID number"}, {"owner": {"reputation": 23, "user_id": 7435440, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154232346208302/picture?type=large", "display_name": "Amy", "link": "https://stackoverflow.com/users/7435440/amy"}, "edited": false, "score": 0, "creation_date": 1484749620, "post_id": 41719865, "comment_id": 70638420, "body": "Thanks again - I&#39;ve gone back to the old run time error :(. Is it not possible to stop error messages from appearing? For the old code I had, once I ended it and re-ran the script it would work without the runtime error appearing"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1484748479, "last_edit_date": 1484748479, "creation_date": 1484743713, "answer_id": 41719865, "question_id": 41718872, "link": "https://stackoverflow.com/questions/41718872/access-run-time-error-2147352567-80020009-subform/41719865#41719865", "title": "Access Run time error - &#39;-2147352567 (80020009)&#39;: subform", "body": "<p>Try to exclude <em>Null</em> values:</p>\n\n<pre><code>If Not IsNull(.Fields(\"Agency ID\").Value) Then        \n    Me.txt_AgencyID.Value = .Fields(\"Agency ID\").Value\nEnd If\n</code></pre>\n\n<p>You may also try using the RecordsetClone:</p>\n\n<pre><code>Dim rs As DAO.Recordset\n\nSet rs = Me.qryAgencyWithoutMileagesub.Form.RecordsetClone\n\n        'get data to textbox control\n    With rs\n        If .RecordCount &gt; 0 Then\n            Me.txt_AgencyID = .Fields(\"Agency ID\")    \n            Me.txt_AgencyName = .Fields(\"Agency Name\")\n            Me.txt_Address1 = .Fields(\"Address 1\")\n            Me.txt_Address2 = .Fields(\"Address 2\")\n            Me.txt_City = .Fields(\"City\")\n            Me.txt_Postcode = .Fields(\"Postcode\")\n            Me.txt_AgencyMileage = .Fields(\"Mileage\")\n            Me.txt_AgencyID.Tag = .Fields(\"Agency ID\")\n        End If\n    End With\n\nSet rs = Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2516521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a59ec5257f0c04c5f6d0f6523defefa7?s=128&d=identicon&r=PG", "display_name": "user2516521", "link": "https://stackoverflow.com/users/2516521/user2516521"}, "is_accepted": false, "score": 1, "last_activity_date": 1504694956, "last_edit_date": 1504694956, "creation_date": 1504694439, "answer_id": 46073127, "question_id": 41718872, "link": "https://stackoverflow.com/questions/41718872/access-run-time-error-2147352567-80020009-subform/46073127#46073127", "title": "Access Run time error - &#39;-2147352567 (80020009)&#39;: subform", "body": "<pre><code>Dim rs As DAO.Recordset    \nSet rs = Me.qryAgencyWithoutMileagesub.Form.RecordsetClone\n    'get data to textbox control\nWith rs\n    If .RecordCount &gt; 0 Then\n        Me.txt_AgencyID = .Fields(\"Agency ID\")    \n        Me.txt_AgencyName = .Fields(\"Agency Name\")\n        Me.txt_Address1 = .Fields(\"Address 1\")\n        Me.txt_Address2 = .Fields(\"Address 2\")\n        Me.txt_City = .Fields(\"City\")\n        Me.txt_Postcode = .Fields(\"Postcode\")\n        Me.txt_AgencyMileage = .Fields(\"Mileage\")\n        Me.txt_AgencyID.Tag = .Fields(\"Agency ID\")\n    End If\nEnd With\n\nSet rs = Nothing\n\n\nDoCmd.RefreshRecord \n\nDoCmd.RunCommand acCmdUndo\n</code></pre>\n\n<p>'You can it try. That worked for me!</p>\n"}], "owner": {"reputation": 23, "user_id": 7435440, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154232346208302/picture?type=large", "display_name": "Amy", "link": "https://stackoverflow.com/users/7435440/amy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6937, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1593956025, "creation_date": 1484740804, "last_edit_date": 1593956025, "question_id": 41718872, "link": "https://stackoverflow.com/questions/41718872/access-run-time-error-2147352567-80020009-subform", "title": "Access Run time error - &#39;-2147352567 (80020009)&#39;: subform", "body": "<p>I've created a form where I can use a subform to load data from a query into textboxes so I can edit the data one at a time and update the database. This usually works fine except I have a run time error that randomly appears now and then - '-2147352567 (80020009)': The value you entered isn't valid for this field.' </p>\n\n<p>If I stop running it and try running it again it usually works fine until the same run-time error appears. It's very inconsistent.</p>\n\n<pre><code>    Private Sub btn_SelectAgency_Click()\n\nIf Not (Me.qryAgencyWithoutMileagesub.Form.Recordset.EOF And Me.qryAgencyWithoutMileagesub.Form.Recordset.BOF) Then\n\n'get data to textbox control\n    With Me.qryAgencyWithoutMileagesub.Form.Recordset\n        Me.txt_AgencyID = .Fields(\"Agency ID\")    \n        Me.txt_AgencyName = .Fields(\"Agency Name\")\n        Me.txt_Address1 = .Fields(\"Address 1\")\n        Me.txt_Address2 = .Fields(\"Address 2\")\n        Me.txt_City = .Fields(\"City\")\n        Me.txt_Postcode = .Fields(\"Postcode\")\n        Me.txt_AgencyMileage = .Fields(\"Mileage\")\n        Me.txt_AgencyID.Tag = .Fields(\"Agency ID\")\n\n    End With\nEnd If\n\nMe.txt_AgencyMileage = \"\"\n\nEnd Sub\n\n\nPrivate Sub btn_Update_Click()\n\nIf Me.txt_AgencyMileage = \"\" Then\n    MsgBox \"No mileage added, add now\"\n    Cancel = True\nElse\n    CurrentDb.Execute \"UPDATE EstateAgent_tbl SET EstateAgent_AgentMileage = '\" &amp; Me.txt_AgencyMileage &amp; \"' where EstateAgent_AgentID=\" &amp; Me.txt_AgencyID.Tag\n    Me.txt_AgencyID = \"\"\n    Me.txt_AgencyName = \"\"\n    Me.txt_Address1 = \"\"\n    Me.txt_Address2 = \"\"\n    Me.txt_City = \"\"\n    Me.txt_Postcode = \"\"\n    Me.txt_AgencyMileage = \"\"\nEnd If\n\nqryAgencyWithoutMileagesub.Form.Requery\n\n    If Me.qryAgencyWithoutMileagesub.Form.Recordset.RecordCount = 0 Then\n        MsgBox \"No agencies without mileage\"\n        DoCmd.Close\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The error is on this line</p>\n\n<pre><code>Me.txt_AgencyID = .Fields(\"Agency ID\")          \n</code></pre>\n\n<p>I would appreciate any help with this, thank you :)</p>\n"}, {"tags": ["excel", "vba", "outlook", "excel-2007", "outlook-2007"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 3, "creation_date": 1484741593, "post_id": 41718862, "comment_id": 70632795, "body": "Where are you at exactly? <b>What are you stuck on? Do you get errors? Where?</b> Please edit your question to include those answers! ;) <i>Also (just bitching), why so much spacing and no indenting in your first code??</i>"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1484749517, "post_id": 41718862, "comment_id": 70638336, "body": "Sorted out the spacing, I use the spacing to help read through and understand how it&#39;s working, forgot to go back to it. Also updated the question itself"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1484771897, "post_id": 41718862, "comment_id": 70652355, "body": "Can you add an image of your data on sheet1?"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1484825873, "post_id": 41718862, "comment_id": 70674397, "body": "@0m3r I&#39;ve added an outline of what the spreadsheet would look like and the data it would contain, note that the yes/no column is generated by a formula which isn&#39;t that relevant as up to that point it works fine."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1485126777, "post_id": 41718862, "comment_id": 70782635, "body": "Is it really necessary to load the worksheet for every email?  This seems very inefficient. The text of your reply suggests all you want to know is: (1) how to mark an email as read and (2) move it to another folder.  (1) Search for &quot; outlook mailitem unread&quot;.  (2) Search for &quot; outlook mailitem move&quot;."}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1485429434, "post_id": 41718862, "comment_id": 70926214, "body": "Yes its is,effectively the purpose of it is to cull hundreds of e-mails. The first script pulls the e-mails out, then I receive a load of case data that I put into the spreadsheet, I put a formula in that strips a reference from the subject if it&#39;s there, then the Yes/No column is a vlookup of the reference against the system data. Then from that point the second script I was trying to get it to move the e-mails and mark them read. It&#39;s not a problem to do that manually until you get towards triple digits  but when there&#39;s upwards of 700 e-mails this saves loads of time."}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1485429523, "post_id": 41718862, "comment_id": 70926253, "body": "I&#39;ve tried .move and it for some reason doesn&#39;t seem to work in the context of the script, I must be placing it in the wrong place.  MSDN suggests it should be used as ``` myItem.Move myDestFolder ``` you can see above that I&#39;ve tried tot use ``` .Move Session.Folders(&quot;No Response&quot;) ```  I&#39;m not experienced enough with outlook code to troubleshoot the issue so I thought I&#39;d ask for help :)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1488973969, "post_id": 41718862, "comment_id": 72465836, "body": "Might be worth recording the <code>EntryID</code> for each email - this is the unique email ID that a store (folder) assigns to an email when it is added to that store... note, moving the email to a different folder will change the <code>EntryID</code>.  I&#39;m pretty sure you can search for emails in VBA using it.  <a href=\"https://msdn.microsoft.com/en-us/library/office/aa211865(v=office.11).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1488976232, "post_id": 41718862, "comment_id": 72467467, "body": "I&#39;m at the point now where the script works to mark the e-mail as read or <code>.UnRead = False</code> but I can&#39;t get my head around quite how to get .move to work, I&#39;ve tried quite a different permutations, I think ultimately it&#39;s down to referencing the &quot;No Response&quot; folder that&#39;s the issue."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1489060322, "post_id": 41718862, "comment_id": 72511367, "body": "on outlook vba it should be  <code>.Move Application.Session.Folders(&quot;No Response&quot;)</code>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1489061765, "post_id": 41718862, "comment_id": 72512320, "body": "Has it worked for you?"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489065239, "post_id": 41718862, "comment_id": 72514542, "body": "Sorry, just back from lunch. The code marks it unread, sets the flag but doesn&#39;t move the mail item"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1488386418, "post_id": 41915568, "comment_id": 72210186, "body": "Hi Tony, I appreciate you taking the time to help, I understand the text but, quite clearly I&#39;m not proficient in outlook VB as I just can&#39;t get my head around the changes I need to make in order to get it working, placement of the suggested code especially. If I was going to continue to use Outlook VB regularly I&#39;d jump in and learn more but once I&#39;ve got this code up and running I won&#39;t need to use Outlook VBA.. My spare time&#39;s taken up learning android development."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488483742, "post_id": 41915568, "comment_id": 72262940, "body": "@JohnMurrey. You say you collected code from different websites but I do not understand why you have not made it consistent. I am reluctant to advise further because I fear I am missing something significant."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488483772, "post_id": 41915568, "comment_id": 72262965, "body": "@JohnMurrey.   In macro &quot;ExportToExcel&quot; you use <code>PickFolder</code> so the source Outlook folder could be ANY MailItem folder on your system. Do you need this flexibility? You open an existing workbook and start writing to row 1 of the first sheet. You do not delete any existing content nor add below existing content. Unless the source folder contains more mail items than were recorded last time, you will have a mixture of new and old mail items.  If you need to record emails from any folder, why don&#39;t you record the name of the source folder?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488483857, "post_id": 41915568, "comment_id": 72263018, "body": "@JohnMurrey.   Macro &quot;MailFilter&quot; calls macro &quot;MoveToFolder&quot; to process one user selected email.  Macro &quot;MoveToFolder&quot; calls macro &quot;xlFillArray&quot; to open the workbook and read Sheet1 (which is not necessarily the first sheet) one row at a time.  It then looks down Sheet1 for the selected email and if found checks for &quot;Yes&quot; against it.  Why?  I would read Sheet 1 in one go, scan for each email marked &quot;Yes&quot; and and then locate and move that email."}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1488881710, "post_id": 41915568, "comment_id": 72417634, "body": "Hi Tony, No I&#39;m using <code>PickFolder</code> as this will effectively run on a shared folder and I didn&#39;t know how to specify the folder. I&#39;ll be importing the e-mails into the same spreadsheet (on sheet 1) every time with all previous e-mail records cleared from the sheet. Frankly I don&#39;t know how to record the name of the source folder. OK so, the e-mail subject goes through several formulas to find a reference, then is looked up (vlookup) against data from another system, the yes/no field is a formula to see if we need to respond based on the data from the other sheet. Hope this helps :)"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488900539, "post_id": 41915568, "comment_id": 72430238, "body": "@JohnMurrey  I do not had access to a shared folder but my recollection is that they are accessed in the same way as any local folder.  See <a href=\"http://stackoverflow.com/documentation/outlook-vba/8874/introduction-part-3-stores-and-all-their-folders#t=201703071500404701433\">Introduction Part 3: Stores and all their folders</a>.  Part 3.1 contains a function that returns the name of a folder as an array. In later parts, I use <code>Join</code> to convert an array to a string for easy display.  Part 3.3 shows how to reference and display the name of any accessible store.  Try this technique on your shared folder."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488900976, "post_id": 41915568, "comment_id": 72430543, "body": "@JohnMurrey  You do not explain why the second part of your routine works as it does. You get the user to select an email then open the workbook to see if it is present and marked &quot;Yes&quot;.  To me, the obvious approach would be to open the workbook and scan down for emails marked &quot;Yes&quot;. Is there some significance to your chosen approach that I am missing?"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1488904866, "post_id": 41915568, "comment_id": 72433219, "body": "OK, Tony I&#39;ll have a look. In retrospect I agree, looking for the &#39;Yes&#39; rows and working back through the e-mail details would definitely save time, the main reason I haven&#39;t done that is that outlook VB is something I&#39;m not familiar with and for me isn&#39;t as easy to learn as Excel VBA. I got the code from this forum with the intent of manipulating it to work for my purposes. the web address I got it from is: <a href=\"http://www.vbaexpress.com/forum/showthread.php?52247-Macro-to-send-out-email-based-on-criteria-via-outlook/page2\" rel=\"nofollow noreferrer\">vbaexpress.com/forum/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1488974938, "post_id": 41915568, "comment_id": 72466545, "body": "Hi again Tony, I&#39;ve had a look at your post, I read up on recursion, interesting stuff, in my mind VLOOKUP in excel would be a good example, I&#39;ve now confirmed the structure of the folders in order to reference the &quot;No Response&quot; folder, it&#39;s a child only to the mailbox it&#39;s in alongside the inbox, the rest of the code works for a single mail item to mark it as unread now but I&#39;m struggling to understand how to use <code>. move</code> and reference the &quot;No Response&quot; folder."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 1, "last_activity_date": 1506308808, "last_edit_date": 1506308808, "creation_date": 1485642700, "answer_id": 41915568, "question_id": 41718862, "link": "https://stackoverflow.com/questions/41718862/how-to-move-mail-from-shared-mailbox-to-a-subfolder-based-on-calculated-entries/41915568#41915568", "title": "How to move mail from shared mailbox to a subfolder based on calculated entries in Excel sheet?", "body": "<p>I have many issues with your code.  With some issues, I am sure your code is faulty.  With other issues I am not so sure.  I will work down your code discussing my issues which I hope will help you address your problem.   </p>\n\n<p>Don\u2019t use <code>On Error GoTo ErrHandler</code> during development or after release if you can avoid it.  Your code will report the non-existence of the workbook but in the event of any other error it will just stop without giving no indication that it has failed to complete its task or the reason.</p>\n\n<p>Try this for the workbook problem and add code for any other problems as they are discovered:</p>\n\n<pre><code>  Set wkb = Nothing\n  On Error Resume Next\n  Set wkb = appExcel.Workbooks.Open(strSheet)\n  On Error GoTo 0\n  If wkb Is Nothing Then\n    Call MsgBox(\"I cannot open the workbook\", vbOKOnly)\n    Exit Sub\n  End If\n</code></pre>\n\n<p><code>Dim intRowCounter As Integer</code>.  We were told to stop using data type <code>Integer</code> with VBA because it declares a 16-bit variable and such variables required special \u2013 slow - processing on 32 and 64-bit computers.  When I got around to testing this claim, I was unable to detect any difference in processing speed.  My reason for not using <code>Integer</code> for a row number is that its maximum value is 32767.  I assume you will not have that many emails per folder but I will still suggest you get into the habit of declaring row numbers as <code>Long</code>.</p>\n\n<p>You do not initialise <code>intRowCounter</code>.  The default value is 0 and you add 1 before first use so it starts as 1.</p>\n\n<p><code>strSheet = \"OE.xlsx\"</code>.  Not very important but I hate anything that might cause confusion in the future. \"OE.xlsx\" is the name of a workbook and not the name of a worksheet.  The term \u201cspreadsheet\u201d dates back to when there was only one sheet per file and I consider it obsolete.</p>\n\n<p>You use <code>PickFolder</code> to select the folder which is fine if you want to be able run this macro against multiple folders.  I was concerned you were using <code>PickFolder</code> because you did not know how else to get a folder reference particularly as you are using Explorer in <code>MailFilter()</code>.</p>\n\n<p>Alternatively, since you are playing with Explorer, perhaps this technique will appeal.  The user selects the target folder and then starts your macro with this code at the beginning:</p>\n\n<pre><code>  Dim Exp As Outlook.Explorer\n  Dim Fldr As Folder\n\n  Set Exp = Outlook.Application.ActiveExplorer\n\n  If Exp.Selection.Count = 0 Then\n    Call MsgBox(\"No emails selected\", vbOKOnly)\n    Exit Sub\n  Else\n    Set Fldr = Exp.Selection(1).Parent\n  End If\n</code></pre>\n\n<p><code>Exp.Selection(1)</code> is the first or only selected email.</p>\n\n<p><code>Exp.Selection(1).Parent</code> is the folder containing the selected email.</p>\n\n<p>There is no need to activate the worksheet.</p>\n\n<p>I would never identify columns by number unless the nature of the task required it.  I would replace your code by:</p>\n\n<pre><code>Const ColEmSenderEmailAddress As Long = 1\nConst ColEmSubject As Long = 2\nConst ColEmReceivedTime As Long = 3\n\nwks.Cells(intRowCounter, ColEmSenderEmailAddress).Value = msg.SenderEmailAddress\nwks.Cells(intRowCounter, ColEmSubject).Value = msg.Subject\nwks.Cells(intRowCounter, ColEmReceivedTime).Value = msg.ReceivedTime\n</code></pre>\n\n<p>I think this is easier to read and, more importantly, if any of the columns move, you only need to update the constants.</p>\n\n<p>In your first macro you use <code>For Each itm In fld.Items</code> to access the mail items.  In the second you use Explorer to access the first or only selected email.  You must be consistent.</p>\n\n<p>I rarely use <code>For Each itm In fld.Items</code> and have never experimented with the sequence in which items are presented to the macro.  In the second macro, you will be removed items from the folder by moving them elsewhere.  Again I have never experimented so do not know how this might affect the items returned by <code>For Each itm In fld.Items</code>.  I doubt there will be an effect but you will need to check if you want to use <code>For Each itm In fld.Items</code> in both macros.</p>\n\n<p>I would use something like this for the first macro:</p>\n\n<pre><code>  Dim InxMi As Long\n  Dim itm As MailItem\n\n  For InxMi = 1 To Fldr.Items.Count\n    Set itm = Fldr.Items(InxMi)\n    Output macro to worksheet\n  Next\n</code></pre>\n\n<p>Since you start at row 1 in the worksheet, this would mean the item number <code>InxMi</code> and the row number <code>intRowCounter</code> would be the same make matching rows and mail items in the second macro easier.  If there is no change to the folder between creating the worksheet and running the second macro, there will be an exact match.  If you allow additions and deletion between the two macros, it will be more complicated but rows and the mail items will be in the same sequence so not too complicated.</p>\n\n<p>In the second macro, you need to start at the bottom row of the worksheet and read the folder up from the bottom: </p>\n\n<pre><code>  For InxMi = Fldr.Items.Count To 1 Step -1\n    Set itm = Fldr.Items(InxMi)\n    If appropriate Move item\n  Next\n</code></pre>\n\n<p>Mail items within a folder are like rows within worksheets, if you delete one then all the one below move up.  If you move up the worksheet and the folder, the row and mail items will continue to match because the moved mail items will below the current position.</p>\n\n<p>You do not give enough detail for me to be more specific but I hope the above helps you progress.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488386290, "post_id": 42500586, "comment_id": 72210089, "body": "I&#39;ll give this a go, the other answer below I understand the text but, quite clearly I&#39;m not proficient in outlook VB as I just can&#39;t get my head around the changes I need to make in order to get it working, placement of the suggested code especially. If I was going to continue to use Outlook VB regularly I&#39;d jump in and learn more but once I&#39;ve got this code up and running I won&#39;t need to use Outlook VBA.. My spare time&#39;s taken up learning android development."}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1488387146, "post_id": 42500586, "comment_id": 72210725, "body": "OK, I&#39;ve tried the above code and it fails when it gets to the &#39;No Response Folder. The mailbox I&#39;m trying to run this on is a shared mailbox not the main mailbox I use, also it&#39;s not a folder inside the Inbox of that mailbox it&#39;s on the same level as Sent Items and Inbox, not quite sure how this affects the code, could definitely use some advice please"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488405303, "post_id": 42500586, "comment_id": 72221489, "body": "@JohnMurrey See revised Code, run it on your inbox first - test it - once you got it working let me know then I will show you how to run it on share Inbox"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1488452331, "post_id": 42500586, "comment_id": 72241745, "body": "I&#39;ve just tried the code on my inbox and it doesn&#39;t recognize    Outlook.Application    yet both Outlook 12.0 and Excel 12.0 are ticked in VBA references"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488489469, "post_id": 42500586, "comment_id": 72266204, "body": "@JohnMurrey see the Late Binding code, that does not require Outlook references-"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1488698442, "post_id": 42500586, "comment_id": 72341087, "body": "@JohnMurrey for share Inbox see <a href=\"http://stackoverflow.com/a/39459407/4539709\">stackoverflow.com/a/39459407/4539709</a>"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1488879962, "post_id": 42500586, "comment_id": 72416516, "body": "This hasn&#39;t worked on my inbox, it gets to <code>Item.Move olNs.GetDefaultFolder(6) _                                         .Folders(&quot;No Response&quot;)</code> and can&#39;t find the object (which I&#39;m assuming is the folder as the mail item is still in my inbox. The folder &#39;No Response is at the same level as my inbox (not a sub folder), I did try this<code>Item.Move olNs..Folders(&quot;No Response&quot;)</code>.  if that makes a difference, also using office 2007 (not through choice)"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488927848, "post_id": 42500586, "comment_id": 72445964, "body": "@JohnMurrey Okay I didn&#39;t know you ware on 2007- Try this, Change this <code>Set Inbox = olNs.GetDefaultFolder(6)</code> to this <code>Set CaseFolders = Outlook.Session.Folders(&quot;0m3r@email.com&quot;).Folders(&quot;Inbox&quot;)</code>"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1488972060, "post_id": 42500586, "comment_id": 72464407, "body": "OK, I&#39;ve tried that and it errored as CaseFolders wasn&#39;t declared, so I declared it and set it to nothing at the end of the script and I got an error &quot;The operation failed. An object could not be found. I replaced the e-mail with the correct one for that shared mailbox. The outlook VBA is now at a point where it will mark the e-mail as unread, but I just can&#39;t figure out what the right code is to use to move the mail item to the folder. I thik for the sake of time it would be easier to finish the Outlook code rather than keep iterating the Excel VBA to a point where it will work. Thanks :)"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488972718, "post_id": 42500586, "comment_id": 72464903, "body": "@JohnMurrey sorry it was supposed to be <code>Set Inbox = Outlook.Session.Folders(&quot;correct email address here&quot;).Folders(&quot;Inbox&quot;)</code> now on the Item.Move do the same"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488972829, "post_id": 42500586, "comment_id": 72464967, "body": "<code>Item.Move Outlook.Session.Folders(&quot;correct email address here&quot;).Folders(&quot;Inbox&quot;).Folders(&quot;No Response&quot;)</code>"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1488975600, "post_id": 42500586, "comment_id": 72467003, "body": "OK, I&#39;ve done that and I still get the same error, am I supposed to be trying this with my inbox or the shared inbox it&#39;s intended for? the e-mail I&#39;m using in the code is not my e-mail."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1488995515, "post_id": 42500586, "comment_id": 72481264, "body": "Share inbox- make sure your subfolder name is correct- no response ?"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489050386, "post_id": 42500586, "comment_id": 72504564, "body": "I was testing it on the share inbox, the folder is called No Response. to be as clear as I can be No Response is not a child of the Inbox it&#39;s on the same level meaning that it&#39;s a child of the same mailbox as the inbox. I get the feeling that might be the issue??"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489050559, "post_id": 42500586, "comment_id": 72504678, "body": "How about this-      Item.Move Outlook.Session.Folders(&quot;correct email address here&quot;).Folders(&quot;No Response&quot;)"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489050629, "post_id": 42500586, "comment_id": 72504731, "body": "Or Item.Move Outlook.Session.Folders(&quot;No Response&quot;)"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489052352, "post_id": 42500586, "comment_id": 72505851, "body": "Nope, it doesn&#39;t get that far, it gets to <code>Outlook.Session.Folders(&quot;correct email address here&quot;).Folders(&quot;Inbox&quot;)</code>. I still get the error <code>The operation failed. An object could not be found.</code> I&#39;ve checked the smtp address on a mail item in that mailbox so I&#39;m definitely using the correct address. I have tried both of the above."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489054782, "post_id": 42500586, "comment_id": 72507577, "body": "can you share an image of your outlook folders view? you can hide all the personal staff"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1489057856, "post_id": 42500586, "comment_id": 72509755, "body": "Okay it Should be <code>Set Inbox = olNs.Session.Folders(&quot;Mailbox - John Murrey&quot;).Folders(&quot;Inbox&quot;)</code> make sure to replace <code>John Murrey</code> with the correct name of the mailbox"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489058372, "post_id": 42500586, "comment_id": 72510111, "body": "And <code>Item.Move olNs.Session.Folders(&quot;Mailbox - John Murrey&quot;).Folders(&quot;No Response&quot;)</code> make sure to replace John Murrey with the correct name of the mailbox"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489058882, "post_id": 42500586, "comment_id": 72510429, "body": "I&#39;ve tried that with both bits altered and entered the mailbox name as it shows in outlook, still the same error. I&#39;ve got the outlook VBA code to a point where it will set a flag on one e-mail at a time. just trying to get it to get it to run through them all but still building the array once."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1488489409, "last_edit_date": 1488489409, "creation_date": 1488258232, "answer_id": 42500586, "question_id": 41718862, "link": "https://stackoverflow.com/questions/41718862/how-to-move-mail-from-shared-mailbox-to-a-subfolder-based-on-calculated-entries/42500586#42500586", "title": "How to move mail from shared mailbox to a subfolder based on calculated entries in Excel sheet?", "body": "<p>Hey why not run it from your Excel file and keep it simple - </p>\n\n<p>Basic Example</p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim App As Outlook.Application\n    Dim olNs As Outlook.Namespace\n    Dim Inbox  As Outlook.MAPIFolder\n    Dim SubFolder As Outlook.MAPIFolder\n    Dim Items As Outlook.Items\n    Dim Item As Object\n\n    Dim iRow As Long\n    Dim i As Long\n\n    Dim RevdTime As String\n    Dim Subject As String\n    Dim Email As String\n\n    Set App = New Outlook.Application\n    Set olNs = App.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox) ' Inbox\n    Set Items = Inbox.Items\n\n    iRow = 1 ' Row Count\n    With Worksheets(\"Sheet1\") ' Update with Correct Sheet Name\n\n        Do Until IsEmpty(.Cells(iRow, 4))\n            DoEvents\n\n            If Cells(iRow, 4).Value = \"Yes\" Then\n                RevdTime = .Cells(iRow, 3).Value ' Email ReceivedTime\n                Subject = .Cells(iRow, 2).Value ' Email Subject\n                Email = .Cells(iRow, 1).Value ' Email Sender Name\n\n                For i = Items.Count To 1 Step -1\n                    Set Item = Items(i)\n\n                    If Item.Class = olMail And _\n                       Item.Subject = Subject And _\n                       Item.ReceivedTime = RevdTime And _\n                       Item.SenderEmailAddress = Email Then\n\n                       Debug.Print Item.Subject ' Immediate Window\n                       Debug.Print Item.ReceivedTime ' Immediate Window\n                       Debug.Print Item.SenderEmailAddress ' Immediate Window\n\n                       Item.UnRead = False\n                       Item.Save\n                       Item.Move olNs.GetDefaultFolder(olFolderInbox) _\n                                              .Folders(\"No Response\")\n                    End If\n\n                Next\n            End If\n            iRow = iRow + 1 ' Go to Next Row\n        Loop\n    End With\n\n    Set App = Nothing\n    Set olNs = Nothing\n    Set Inbox = Nothing\n    Set SubFolder = Nothing\n    Set Items = Nothing\n    Set Item = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><strong>for Late Binding see</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim App As Object ' Outlook.Application\n    Dim olNs As Object ' Outlook.Namespace\n    Dim Inbox  As Object ' Outlook.MAPIFolder\n    Dim SubFolder As Object ' Outlook.MAPIFolder\n    Dim Items As Object ' Outlook.Items\n    Dim Item As Object\n\n    Dim iRow As Long\n    Dim i As Long\n\n    Dim RevdTime As String\n    Dim Subject As String\n    Dim Email As String\n\n    Set App = CreateObject(\"Outlook.Application\")\n    Set olNs = App.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(6) '  olFolderInbox = 6\n    Set Items = Inbox.Items\n\n    iRow = 1 ' Row Count\n    With Worksheets(\"Sheet1\") ' Update with Correct Sheet Name\n\n        Do Until IsEmpty(.Cells(iRow, 4))\n            DoEvents\n\n            If Cells(iRow, 4).Value = \"Yes\" Then\n                RevdTime = .Cells(iRow, 3).Value ' Email ReceivedTime\n                Subject = .Cells(iRow, 2).Value ' Email Subject\n                Email = .Cells(iRow, 1).Value ' Email Sender Name\n\n                For i = Items.Count To 1 Step -1\n                    Set Item = Items(i)\n\n                    ' olMail - 43 = A MailItem object.\n                    If Item.Class = 43 And _\n                       Item.Subject = Subject And _\n                       Item.ReceivedTime = RevdTime And _\n                       Item.SenderEmailAddress = Email Then\n\n                       Debug.Print Item.Subject ' Immediate Window\n                       Debug.Print Item.ReceivedTime ' Immediate Window\n                       Debug.Print Item.SenderEmailAddress ' Immediate Window\n\n                       Item.UnRead = False\n                       Item.Save\n                       Item.Move olNs.GetDefaultFolder(6) _\n                                        .Folders(\"No Response\")\n                    End If\n\n                Next\n            End If\n            iRow = iRow + 1 ' Go to Next Row\n        Loop\n    End With\n\n    Set App = Nothing\n    Set olNs = Nothing\n    Set Inbox = Nothing\n    Set SubFolder = Nothing\n    Set Items = Nothing\n    Set Item = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>If you want to run it from Outlook let me know it shouldn't be hard-</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489489517, "post_id": 42707860, "comment_id": 72682582, "body": "so at the point of <code>Set Fldr = GetFolderRef(&quot;outlook data file&quot;)</code> is `&quot;outlook data file&quot; to be replaced by the mailbox name in question?"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489489895, "post_id": 42707860, "comment_id": 72682847, "body": "For example in my case it would be <code>Set Fldr = GetFolderRef(&quot;sourcefolder&quot;, &quot;No Response&quot;)</code> ? if not which part of the code allows me to find the folder ref? I&#39;ve looked at <code>GetFldrNames</code>, firstly that won&#39;t run (presumably because it&#39;s a function not a subroutine) and secondly it outputs the result to a variable (which I&#39;m also guessing that is referenced further in the process.)"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489490476, "post_id": 42707860, "comment_id": 72683243, "body": "I tried a run through Part 1, it errored at <code>Set GetFolderRef = (&quot;outlook data file&quot;)</code> so I added <code>Dim GetFolderRef As String</code> and it errors as <code>object required</code>"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1489513185, "post_id": 42707860, "comment_id": 72700371, "body": "@JohnMurrey  <code>GetFldrRef</code> is a function within the code I supplied. At the top of the function are instructions on its use although I have just notices those instructions use its old name, <code>GetFolderRef</code>; sorry.  &quot;outlook data file&quot; is Outlook&#39;s name for its default Store.  A Store is a file on disc in which Outlook store&#39;s all its information.  I have no access to a shared folder these days but my recollection from my days in a large organisation is that they appeared in my Folder Pane just like all my local and server Stores.  A Store can contain folders in which you can store, ..."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1489513229, "post_id": 42707860, "comment_id": 72700402, "body": "... for example, mail items. A folder of mail items can hold sub-folders and sub-sub-folders to any depth.  The parameters to a call of <code>GetFldrRef</code> start with the name of the Store followed by the name of a folder within that Store followed by the name of a sub-folder and so on down to whatever depth is necessary. If this is not clear, I need to see an image of your Folder Pane so I can be more specific.  You could include an image in your question or you could email it to me."}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489569622, "post_id": 42707860, "comment_id": 72723752, "body": "OK, I&#39;m familiar with .pst files, I take it the &#39;store&#39; your referring to will effectively be the .pst file that outlook stores it&#39;s data (up until now I only thought local data) and therefor the name of the store will be the name of the.pst file? I understand the parent, child, grandchild relationship hierarchy I&#39;ll see if I can get it working this morning. Thanks :)"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489574117, "post_id": 42707860, "comment_id": 72726945, "body": "it looks like I&#39;ve got a further with it this time, I&#39;ve updated the code to reflect the changes I&#39;ve made. it runs up until <code>FldrNameCrnt = FldrCrnt.Name</code> then produces the error:  Run-time error &#39;91&#39;:  Object variable or With block variable not set"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489590284, "post_id": 42707860, "comment_id": 72739171, "body": "I have been stepping through the code to try and debug. I&#39;ve noticed it gets to Debug.Print  FolderNamesDenested(0) and if I hover over for the value it shows FolderNamesDenested(0) = &quot;test folders&quot;. being that I don&#39;t have any folders with that name it looks like that needs to be replaced in Part 1() in order for it to work. What would I need to replace it with?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489678949, "post_id": 42707860, "comment_id": 72786368, "body": "@JohnMurrey &quot;test folders&quot; in the name of a Store on my system that I used to test my code. You must change my store and folder names for your names. Since I do not know the nature of your shared folders I tried to show what was possible. On line 46 I have <code>For Each FldrSrcNameArr In ... </code> where <code>...</code> is an array of arrays. So each loop sets <code>FldrSrcNameArr</code> to an array which I use as the parameters for <code>GetFldrRef</code>. I have tried to show how you could access two different sub-folders within a shared folder.  Do you need this level of functionality?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1489679131, "post_id": 42707860, "comment_id": 72786538, "body": "@JohnMurrey If you go to [3.4 Listing the names of every folder within every accessible store]( <a href=\"http://stackoverflow.com/documentation/outlook-vba/8874/introduction-part-3-stores-and-all-their-folders/27632/3-4-listing-the-names-of-every-folder-within-every-accessible-store#t=201703161530007625024\">stackoverflow.com/documentation/outlook-vba/8874/&hellip;</a>), you will find <code>ListStoresAndAllFolders()</code>:  This routine will create a file on your desktop containing a list of every store and folder it can reach.  If my explanation above is not enough I suggest you copy this routine to a new Outlook VBA module and run it.  ..."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 1, "creation_date": 1489679154, "post_id": 42707860, "comment_id": 72786565, "body": "...  If you update your question with the section that includes your shared folder and the sub-folder or folders within in it you want to access, I can provide you with just the code you need and not something over complicated that you have to update."}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489680240, "post_id": 42707860, "comment_id": 72787428, "body": "Apologies Tony, I&#39;ve had a read through the first 2 guides you put up and with a bit of fiddling, the store macros  and common sense I&#39;ve debugged part 1 so part 1 is fully up and operational now. Thank you! I&#39;m now looking at part 2 and from a quick skim through I can only see a couple of lines that need the folders added <code>FldrSrcNamePrev = </code> do I need to use <code>GetFldrRef</code> there? presumably so.<code>Set FldrDest = GetFldrRef(&quot;</code> which Input the store and folder. OPart 2 currently errors on <code>Sub DeNestParamArray(Denested() As Variant, ParamArray Original() As Variant)</code>"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489689551, "post_id": 42707860, "comment_id": 72793555, "body": "@JohnMurrey There is no need for you to do anything with <code>FldrSrcNamePrev</code>.  Part2 allows for multiple source folder names in the workbook. <code>FldrSrcNamePrev</code> is used to detect folder name changes since there is code that is only obeyed when the folder name changes."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1489689635, "post_id": 42707860, "comment_id": 72793600, "body": "@JohnMurrey What error are you getting with Sub <code>DeNestParamArray</code>?"}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1490093228, "post_id": 42707860, "comment_id": 72947056, "body": "Hi Tony, the error is as follows &quot;Run-time error&#39;9&#39;: Subscript out of range&quot;, when I click debug it&#39;s stuck at this line of code <code>ReDim Denested(0 To UBound(DenestedCrnt(Bounds(1)(0))) - LBound(DenestedCrnt(Bounds(1)(0))))</code>. Thanks!"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1490100372, "post_id": 42707860, "comment_id": 72952350, "body": "@JohnMurrey  Neither <code>Part1</code> not <code>Part2</code> call <code>DeNestParamArray</code> directly.  It is called by <code>GetFldrRef</code> to ensure its parameters are in the format expected.  Please describe the call of <code>GetFldrRef</code> that led to this error."}, {"owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "edited": false, "score": 0, "creation_date": 1490107495, "post_id": 42707860, "comment_id": 72958059, "body": "I&#39;ve sent you an e-mail, I&#39;m not sure why it errors because <code>GetFldrRef</code> as far as I can see from ListStoresAndAllFolders is getting a valid store and folder name."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 1, "last_activity_date": 1489104327, "creation_date": 1489104327, "answer_id": 42707860, "question_id": 41718862, "link": "https://stackoverflow.com/questions/41718862/how-to-move-mail-from-shared-mailbox-to-a-subfolder-based-on-calculated-entries/42707860#42707860", "title": "How to move mail from shared mailbox to a subfolder based on calculated entries in Excel sheet?", "body": "<p>I did not know where to start with fixing your code so I have started from scratch based on my best guesses regarding your requirement.</p>\n\n<p>I created a file named OE.xlsx with a single worksheet named \u201cEmails\u201d since I avoid using the default worksheet names.  I created a header line with values: \u201cSender\u201d, \u201cSubject\u201d, \u201cReceived\u201d, \u201cYes/No\u201d and \u201cFolder\u201d.  I have maintained your sequence although I have added \u201cFolder\u201d.</p>\n\n<p>I have named the main macros as \u201cPart1\u201d and \u201cPart2\u201d so there is no confusion with the other macros.  All the other macros are from my library.  They are more complicated than you need but I did not want to spend time coding something simpler.  I suggest you accept these routines do what the comments say and not worry about how.</p>\n\n<p>You have not said if the source of the emails is always the same shared folder. I added the folder column to allow for multiple shared folders.  It means macro \u201cPart2\u201d does not need to ask about the source folder since it gets this information from the workbook although it would need to be told about the destination folder.</p>\n\n<p>You do not say how you create the formulae that sets the value in the \u201cYes/No\u201d column. I would get macro \u201cPart1\u201d to create them and I have included an example which sets \u201cYes\u201d or \u201cNo\u201d depending on the length of the subject.</p>\n\n<p>In macro \u201cPart1\u201d, I use \u201cFor Each FldrSrcNameArr \u2026 \u201d to get details of emails from two folders.  If you have fixed source folders, you can use something similar.  If your requirement is more complicated, you will need to provide more detail.</p>\n\n<p>Macro \u201cPart1\u201d adds new emails below any existing rows.  In macro \u201cPart2\u201d, I clear the rows for emails that are moved and then write the remaining rows back to the worksheet.  I know your macros do not work like this but I wanted to show what is possible.  You can easily delete the redundant code if you do not require it.</p>\n\n<p>I believe you should find it easy to adjust the following code to your requirements. Come back questions if necessary.</p>\n\n<pre><code>Option Explicit\n  ' Requires references to \"Microsoft Excel nn.0 Object Library\", \"Microsoft Office\n  ' nn.0 Object Library\" and \"Microsoft Scripting Runtime\" Value of \"nn\" depends\n  ' on version of Office being used.\n\n  ' Technique for locating desktop from answer by Kyle:\n  ' http://stackoverflow.com/a/17551579/973283\n\n  Const ColEmailSender As Long = 1\n  Const ColEmailSubject As Long = 2\n  Const ColEmailReceived As Long = 3\n  Const ColEmailYesNo As Long = 4\n  Const ColEmailFolderName As Long = 5\n  Const RowEmailDataFirst As Long = 2\n\nSub Part1()\n\n  Dim ColEmailLast As Long\n  Dim FldrSrc As Folder\n  Dim FldrSrcName As String\n  Dim FldrSrcNameArr As Variant\n  Dim ItemCrnt As MailItem\n  Dim ItemsSrc As Items\n  Dim Path As String\n  Dim RowEmailCrnt As Long\n  Dim WbkEmail As Excel.Workbook\n  Dim WshtEmail As Excel.Worksheet\n  Dim xlApp As Excel.Application\n\n  Path = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\") &amp; \"\\\"\n\n  Set xlApp = Application.CreateObject(\"Excel.Application\")\n  xlApp.Visible = True         ' This slows your macro but helps during debugging\n  With xlApp\n    Set WbkEmail = .Workbooks.Open(Path &amp; \"OE.xlsx\")\n  End With\n\n  With WbkEmail\n    Set WshtEmail = .Worksheets(\"Emails\")\n  End With\n  Call FindLastRowCol(WshtEmail, RowEmailCrnt, ColEmailLast)\n\n  ' Output first new row under any existing rows.\n  RowEmailCrnt = RowEmailCrnt + 1\n\n  For Each FldrSrcNameArr In VBA.Array(VBA.Array(\"test folders\", \"Test emails 1\"), _\n                                       VBA.Array(\"test folders\", \"Test emails 2\"))\n\n    Set FldrSrc = GetFldrRef(FldrSrcNameArr)\n    FldrSrcName = Join(GetFldrNames(FldrSrc), \"|\")\n\n    Set ItemsSrc = FldrSrc.Items\n    ' This shows how to sort the emails by a property should this be helpful.\n    ItemsSrc.Sort \"[ReceivedTime]\"        ' Ascending sort. Add \", False\" for descending\n\n    For Each ItemCrnt In ItemsSrc\n      With ItemCrnt\n        WshtEmail.Range(WshtEmail.Cells(RowEmailCrnt, 1), _\n                        WshtEmail.Cells(RowEmailCrnt, 5)).Value = _\n               VBA.Array(.SenderEmailAddress, .Subject, .ReceivedTime, _\n                         \"=IF(MOD(LEN(\" &amp; ColCode(ColEmailSubject) &amp; RowEmailCrnt &amp; \"),2)=0,\"\"Yes\"\",\"\"No\"\")\", _\n                         FldrSrcName)\n      End With\n      RowEmailCrnt = RowEmailCrnt + 1\n    Next\n\n    Set ItemCrnt = Nothing\n    Set ItemsSrc = Nothing\n    Set FldrSrc = Nothing\n\n  Next\n\n  WbkEmail.Close SaveChanges:=True\n\n  Set WshtEmail = Nothing\n  Set WbkEmail = Nothing\n  xlApp.Quit\n  Set xlApp = Nothing\n\nEnd Sub\nSub Part2()\n\n  Dim ColEmailCrnt As Long\n  Dim ColEmailLast As Long\n  Dim FldrDest As Folder\n  Dim FldrSrc As Folder\n  Dim FldrSrcNameCrnt As String\n  Dim FldrSrcNamePrev As String\n  Dim InxIS As Long\n  Dim ItemsSrc As Items\n  Dim ItemsToMove As New Collection\n  Dim Path As String\n  Dim RngSortF As Range\n  Dim RngSortR As Range\n  Dim RngWsht As Range\n  Dim RowEmailCrnt As Long\n  Dim RowEmailLast As Long\n  Dim WbkEmail As Excel.Workbook\n  Dim WshtEmail As Excel.Worksheet\n  Dim WshtEmailValues As Variant\n  Dim xlApp As Excel.Application\n\n  Path = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\") &amp; \"\\\"\n\n  Set xlApp = Application.CreateObject(\"Excel.Application\")\n  xlApp.Visible = True         ' This slows your macro but helps during debugging\n  With xlApp\n    Set WbkEmail = .Workbooks.Open(Path &amp; \"OE.xlsx\")\n  End With\n\n  With WbkEmail\n    Set WshtEmail = .Worksheets(\"Emails\")\n  End With\n  Call FindLastRowCol(WshtEmail, RowEmailLast, ColEmailLast)\n\n  With WshtEmail\n\n    Set RngWsht = .Range(.Cells(1, 1), .Cells(RowEmailLast, ColEmailLast))\n    Set RngSortF = .Range(.Cells(2, ColEmailFolderName), .Cells(RowEmailLast, ColEmailFolderName))\n    Set RngSortR = .Range(.Cells(2, ColEmailReceived), .Cells(RowEmailLast, ColEmailReceived))\n\n    ' Ensure rows are sequecnced by Folder name then Received\n    ' For each folder, the items are sorted by ReceivedTime.  THis means the two lists\n    ' are in the same sequence.\n    With .Sort\n      .SortFields.Clear\n      .SortFields.Add Key:=RngSortF, SortOn:=xlSortOnValues, _\n                         Order:=xlAscending, DataOption:=xlSortNormal\n      .SortFields.Add Key:=RngSortR, SortOn:=xlSortOnValues, _\n                         Order:=xlAscending, DataOption:=xlSortNormal\n      .SetRange RngWsht\n      .Header = xlYes\n      .MatchCase = False\n      .Orientation = xlTopToBottom\n      .SortMethod = xlPinYin\n      .Apply\n    End With\n\n    WshtEmailValues = RngWsht.Value\n\n  End With\n\n  FldrSrcNamePrev = \"\"\n  Set FldrDest = GetFldrRef(\"test folders\", \"No response\")\n\n  For RowEmailCrnt = RowEmailDataFirst To RowEmailLast\n    If WshtEmailValues(RowEmailCrnt, ColEmailYesNo) = \"Yes\" Then\n      ' This row identifies an email that is to be moved\n      FldrSrcNameCrnt = WshtEmailValues(RowEmailCrnt, ColEmailFolderName)\n      If FldrSrcNamePrev &lt;&gt; FldrSrcNameCrnt Then\n        ' New source folder\n        Set FldrSrc = Nothing\n        Set FldrSrc = GetFldrRef(Split(FldrSrcNameCrnt, \"|\"))\n        FldrSrcNamePrev = FldrSrcNameCrnt\n        Set ItemsSrc = FldrSrc.Items\n        ItemsSrc.Sort \"[ReceivedTime]\"\n        InxIS = 1\n      End If\n      ' Scan down mail items within sorted folder until reach or are past current email\n      Do While InxIS &lt;= ItemsSrc.Count\n        If ItemsSrc(InxIS).ReceivedTime &gt;= WshtEmailValues(RowEmailCrnt, ColEmailReceived) Then\n          Exit Do\n        End If\n        InxIS = InxIS + 1\n      Loop\n      If InxIS &lt;= ItemsSrc.Count Then\n        If ItemsSrc(InxIS).ReceivedTime = WshtEmailValues(RowEmailCrnt, ColEmailReceived) And _\n           ItemsSrc(InxIS).SenderEmailAddress = WshtEmailValues(RowEmailCrnt, ColEmailSender) And _\n           ItemsSrc(InxIS).Subject = WshtEmailValues(RowEmailCrnt, ColEmailSubject) Then\n          ' Have found email to be moved\n          ' ItemsSrc is what VBA calls a Collection but most languages call a List.\n          ' Moving a mail item to another folder removes an item from the Collection and\n          ' upsets the index. Better to save a reference to the mail item and move it later.\n          ItemsToMove.Add ItemsSrc(InxIS)\n          ' Clear row in WshtEmailValues to indicate email moved\n          For ColEmailCrnt = 1 To ColEmailLast\n            WshtEmailValues(RowEmailCrnt, ColEmailCrnt) = \"\"\n          Next\n          InxIS = InxIS + 1\n        ' Else  there is no mail item matching email row\n        End If\n      ' Else  no more emails in folder\n      End If\n    ' Else email row marled \"No\"\n    End If\n  Next\n\n  ' Move mail items marked \"Yes\"\n  Do While ItemsToMove.Count &gt; 0\n    ItemsToMove(1).Move FldrDest\n    ItemsToMove.Remove 1\n  Loop\n\n  ' Upload worksheet values with rows for moved files cleared\n  RngWsht.Value = WshtEmailValues\n\n  ' Sort blank lines to bottom\n  With WshtEmail\n    With .Sort\n      .Apply\n    End With\n  End With\n\n  WbkEmail.Close SaveChanges:=True\n  Set WshtEmail = Nothing\n  Set WbkEmail = Nothing\n  xlApp.Quit\n  Set xlApp = Nothing\n  'Set ItemCrnt = Nothing\n  'Set ItemsSrc = Nothing\n  'Set FldrSrc = Nothing\n\nEnd Sub\n' =================== Standard Outlook VBA routines ===================\nFunction GetFldrNames(ByRef Fldr As Folder) As String()\n\n  ' * Fldr is a folder. It could be a store, the child of a store,\n  '   the grandchild of a store or more deeply nested.\n  ' * Return the name of that folder as a string array in the sequence:\n  '    (0)=StoreName (1)=Level1FolderName (2)=Level2FolderName  ...\n\n  ' 12Oct16  Coded\n  ' 20Oct16  Renamed from GetFldrNameStr and amended to return a string array\n  '          rather than a string\n\n  Dim FldrCrnt As Folder\n  Dim FldrNameCrnt As String\n  Dim FldrNames() As String\n  Dim FldrNamesRev() As String\n  Dim FldrPrnt As Folder\n  Dim InxFN As Long\n  Dim InxFnR As Long\n\n  Set FldrCrnt = Fldr\n  FldrNameCrnt = FldrCrnt.Name\n  ReDim FldrNamesRev(0 To 0)\n  FldrNamesRev(0) = Fldr.Name\n  ' Loop getting parents until FldrCrnt has no parent.\n  ' Add names of Fldr and all its parents to FldrName as they are found\n  Do While True\n    Set FldrPrnt = Nothing\n    On Error Resume Next\n    Set FldrPrnt = Nothing   ' Ensure value is Nothing if following statement fails\n    Set FldrPrnt = FldrCrnt.Parent\n    On Error GoTo 0\n    If FldrPrnt Is Nothing Then\n      ' FldrCrnt has no parent\n      Exit Do\n    End If\n    ReDim Preserve FldrNamesRev(0 To UBound(FldrNamesRev) + 1)\n    FldrNamesRev(UBound(FldrNamesRev)) = FldrPrnt.Name\n    Set FldrCrnt = FldrPrnt\n  Loop\n\n  ' Copy names to FldrNames in reverse sequence so they end up in the correct sequence\n  ReDim FldrNames(0 To UBound(FldrNamesRev))\n  InxFN = 0\n  For InxFnR = UBound(FldrNamesRev) To 0 Step -1\n    FldrNames(InxFN) = FldrNamesRev(InxFnR)\n    InxFN = InxFN + 1\n  Next\n\n  GetFldrNames = FldrNames\n\nEnd Function\nFunction GetFldrRef(ParamArray FolderNames() As Variant) As Folder\n\n  ' FolderNames can be used as a conventional ParamArray: a list of values. Those\n  ' Values must all be strings.\n  ' Alternatively, its parameter can be a preloaded one-dimensional array of type\n  ' Variant or String. If of type Variant, the values must all be strings.\n  ' The first, compulsory, entry in FolderNames is the name of a Store.\n  ' Each subsequent, optional, entry  in FolderNames is the name of a folder\n  ' within the folder identified by the previous names.  Example calls:\n  '  1) Set Fldr = GetFolderRef(\"outlook data file\")\n  '  2) Set Fldr = GetFolderRef(\"outlook data file\", \"Inbox\", \"Processed\")\n  '  3) MyArray = Array(\"outlook data file\", \"Inbox\", \"Processed\")\n  '     Set Fldr = GetFolderRef(MyArray)\n  ' Return a reference to the folder identified by the names or Nothing if it\n  ' does not exist\n\n  Dim FolderNamesDenested() As Variant\n  Dim ErrNum As Long\n  Dim FldrChld As Folder\n  Dim FldrCrnt As Folder\n  Dim InxP As Long\n\n  Call DeNestParamArray(FolderNamesDenested, FolderNames)\n\n  If LBound(FolderNamesDenested) &gt; UBound(FolderNamesDenested) Then\n    ' No names specified\n    Set GetFolderRef = Nothing\n    Exit Function\n  End If\n\n  For InxP = 0 To UBound(FolderNamesDenested)\n    If VarType(FolderNamesDenested(InxP)) &lt;&gt; vbString Then\n      ' Value is not a string\n      Debug.Assert False     ' Fatal error\n      Set GetFolderRef = Nothing\n      Exit Function\n    End If\n  Next\n\n  Set FldrCrnt = Nothing\n  On Error Resume Next\n  Set FldrCrnt = Session.Folders(FolderNamesDenested(0))\n  On Error GoTo 0\n  If FldrCrnt Is Nothing Then\n    ' Store name not recognised\n    Debug.Print FolderNamesDenested(0) &amp; \" is not recognised as a store\"\n    Debug.Assert False     ' Fatal error\n    Set GetFldrRef = Nothing\n    Exit Function\n  End If\n\n  For InxP = 1 To UBound(FolderNamesDenested)\n  Set FldrChld = Nothing\n    On Error Resume Next\n    Set FldrChld = FldrCrnt.Folders(FolderNamesDenested(InxP))\n    On Error GoTo 0\n    If FldrChld Is Nothing Then\n      ' Folder name not recognised\n      Debug.Print FolderNamesDenested(InxP) &amp; \" is not recognised as a folder within \" &amp; _\n                  Join(GetFldrNames(FldrCrnt), \"-&gt;\")\n      Debug.Assert False    ' Fatal error\n      Set GetFldrRef = Nothing\n      Exit Function\n    End If\n    Set FldrCrnt = FldrChld\n    Set FldrChld = Nothing\n  Next\n\n  Set GetFldrRef = FldrCrnt\n\nEnd Function\n' =================== Standard VBA routines ===================\nSub DeNestParamArray(Denested() As Variant, ParamArray Original() As Variant)\n\n  ' Each time a ParamArray is passed to a sub-routine, it is nested in a one\n  ' element Variant array.  This routine finds the bottom level of the nesting and\n  ' sets RetnValue to the values in the original parameter array so that other routines\n  ' need not be concerned with this complication.\n\n    '   Nov10  Coded\n    '  6Aug16  Minor correction to documentation\n    '  6Aug16  The previous version did not correctly handle an empty ParamArray.\n    ' 15Oct16  replaced call of NumDim by call of NumberOfDimensions\n    '          Tested that routine could denest a ParamArray that started as a reloaded\n    '          array rather than a list of values in a call.\n\n  Dim Bounds         As Collection\n  Dim Inx1           As Long\n  Dim Inx2           As Long\n  Dim DenestedCrnt() As Variant\n  Dim DenestedTemp() As Variant\n\n  DenestedCrnt = Original\n  ' Find bottom level of nesting\n  Do While True\n    If VarType(DenestedCrnt) &lt; vbArray Then\n      ' Have found a non-array element so must have reached the bottom level\n      Debug.Assert False   ' Should have exited loop at previous level\n      Exit Do\n    End If\n    Call NumberOfDimensions(Bounds, DenestedCrnt)\n    ' There is one entry in Bounds per dimension in NestedCrnt\n    ' Each entry is an array: Bounds(N)(0) = Lower bound of dimension N\n    ' and Bounds(N)(1) = Upper bound of dimenssion N\n    If Bounds.Count = 1 Then\n      If Bounds(1)(0) &gt; Bounds(1)(1) Then\n        ' The original ParamArray was empty\n        Denested = DenestedCrnt\n        Exit Sub\n      ElseIf Bounds(1)(0) = Bounds(1)(1) Then\n        ' This is a one element array\n        If VarType(DenestedCrnt(Bounds(1)(0))) &lt; vbArray Then\n          ' But it does not contain an array so the user only specified\n          ' one value (a literal or a non-array variable)\n          ' This is a valid exit from this loop\n            'Debug.Assert False\n            Exit Do\n        End If\n        ' The following sometimes crashed Outlook\n        'DenestedCrnt = DenestedCrnt(Bounds(1)(0))\n        If VarType(DenestedCrnt(Bounds(1)(0))) = vbArray + vbString Then\n          ' DenestedCrnt(Bounds(1)(0))) is an array of strings.\n          ' This is the array sought but it must be converted to an array\n          ' of variants with lower bound = 0 before it can be returned.\n          ReDim Denested(0 To UBound(DenestedCrnt(Bounds(1)(0))) - LBound(DenestedCrnt(Bounds(1)(0))))\n          Inx2 = LBound(DenestedCrnt)\n          For Inx1 = 0 To UBound(Denested)\n            Denested(Inx1) = DenestedCrnt(Bounds(1)(0))(Inx2)\n            Inx2 = Inx2 + 1\n          Next\n          Exit Sub\n        End If\n        DenestedTemp = DenestedCrnt(Bounds(1)(0))\n        DenestedCrnt = DenestedTemp\n      Else\n        ' This is a one-dimensional, non-nested array\n        ' This is the usual exit from this loop\n        Exit Do\n      End If\n    Else\n      ' This is an array but not a one-dimensional array\n      ' There is no code for this situation\n      Debug.Assert False\n      Exit Do\n    End If\n  Loop\n\n  ' Have found bottom level array.  Save contents in Return array.\n  If LBound(DenestedCrnt) &lt;&gt; 0 Then\n    ' A ParamArray should have a lower bound of 0.  Assume the ParamArray\n    ' was loaded with a 1D array that did not have a lower bound of 0.\n    ' Build Denested so it has standard lbound\n    ReDim Denested(0 To UBound(DenestedCrnt) - LBound(DenestedCrnt))\n    Inx2 = LBound(DenestedCrnt)\n    For Inx1 = 0 To UBound(Denested)\n      Denested(Inx1) = DenestedCrnt(Inx2)\n      Inx2 = Inx2 + 1\n    Next\n  Else\n    Denested = DenestedCrnt\n  End If\n\nEnd Sub\nFunction NumberOfDimensions(ByRef Bounds As Collection, _\n                                   ParamArray Params() As Variant) As Long\n\n  ' Example calls of this routine are:\n  '    NumDim = NumberOfDimensions(Bounds, MyArray)\n  ' or NumDim = NumberOfDimensions(Bounds, Worksheets(\"Sheet1\").Range(\"D4:E20\"))\n\n  ' * Returns the number of dimensions of Params(LBound(Params)).  Param is a ParamArray.\n  '   MyArray, in the example call, is held as the first element of array Params.  That is\n  '   it is held as Params(LBound(Params)) or Params(LBdP) where LBdP = LBound(Params).\n  ' * If the array to test is a regular array, then, in exit, for each dimension, the lower\n  '   and upper bounds are recorded in Bounds. Entries in Bounds are zero-based arrays\n  '   with two entries: lower bound and upper bound.\n  ' * If the array is a worksheet range, the lower bound values in Bounds are 1 and the\n  '   upper bound values are the number of rows (first entry in Bounds) or columns (second\n  '   entry in Bounds)\n  ' * The collection Bounds is of most value to routines that can be pased an array as\n  '   a parameter but does not know if that array is a regular array or a range. The values\n  '   returned in Bounds means that whether the test array is a regular array or a range,\n  '   its elements can be accessed so:\n  '      For InxDim1 = Bounds(0)(0) to Bounds(0)(1)\n  '        For InxDim2 = Bounds(1)(0) to Bounds(1)(1)\n  '          :  :  :\n  '        Next\n  '      Next\n\n  ' If there is an official way of determining the number of dimensions, I cannot find it.\n\n  ' This routine tests for dimension 1, 2, 3 and so on until it get a failure.\n  ' By trapping that failure it can determine the last test that did not fail.\n\n  ' *  Params() is a ParamArray because it allows the passing of arrays of any type.\n  ' *  The array to be tested in not Params but Params(LBound(Params)).\n  ' *  The routine does not check for more than one parameter.  If the call was\n  '    NumDim(Bounds, MyArray1, MyArray2), it would ignore MyArray2.\n\n  '   Jun10  Coded\n  '   Jul10  Documentation added\n  ' 13Aug16  Return type changed from Integer\n  ' 14Aug16  Upgraded to handle ranges. VarType reports a worksheet range as an\n  '          array but LBound and UBound do not recognise a range as an array.\n  '          Added Bounds to report bounds of both regular arrays and ranges.\n  ' 14Aug16  Renamed from NumDim.\n  ' 14Aug16  Switched between different approaches as built up understanding of\n  '          bounds of ranges as documented elsewhere in macro.\n  ' 15Aug16  Switched back to use of TestArray.\n\n  Dim InxDim As Long\n  Dim Lbd As Long\n  Dim LBdC As Long\n  Dim LBdP As Long\n  Dim LBdR As Long\n  Dim NumDim As Long\n  Dim TestArray As Variant\n  'Dim TestResult As Long\n  Dim UBdC As Long\n  Dim UBdR As Long\n\n  Set Bounds = New Collection\n\n  If VarType(Params(LBound(Params))) &lt; vbArray Then\n    ' Variable to test is not an array\n    NumberOfDimensions = 0\n    Exit Function\n  End If\n\n  On Error Resume Next\n\n  LBdP = LBound(Params)\n\n  TestArray = Params(LBdP)\n\n  NumDim = 1\n  Do While True\n    Lbd = LBound(TestArray, NumDim)\n    'Lbd = LBound(Params(LBdP), NumDim)\n    If Err.Number &lt;&gt; 0 Then\n      If NumDim &gt; 1 Then\n        ' Only known reason for failing is because array\n        ' does not have NumDim dimensions\n        NumberOfDimensions = NumDim - 1\n        On Error GoTo 0\n        For InxDim = 1 To NumberOfDimensions\n          Bounds.Add VBA.Array(LBound(TestArray, InxDim), UBound(TestArray, InxDim))\n          'Bounds.Add VBA.Array(LBound(Params(LBdP), InxDim), _\n                               UBound(Params(LBdP), InxDim))\n        Next\n        Exit Function\n      Else\n        Err.Clear\n        Bounds.Add VBA.Array(TestArray.Row, TestArray.Rows.Count - TestArray.Row + 1)\n        Bounds.Add VBA.Array(TestArray.Column, TestArray.Columns.Count - TestArray.Column + 1)\n        If Err.Number &lt;&gt; 0 Then\n          NumberOfDimensions = 0\n          Exit Function\n        End If\n        On Error GoTo 0\n        NumberOfDimensions = 2\n        Exit Function\n      End If\n\n    End If\n    NumDim = NumDim + 1\n  Loop\n\nEnd Function\n' =================== Standard Excel routines ===================\nFunction ColCode(ByVal ColNum As Long) As String\n\n  ' Convert column number to column code\n  ' For example: 1 -&gt; A, 2 -&gt; B, 26 -&gt; Z and 27 -&gt; AA\n\n  Dim PartNum As Long\n\n  '  3Feb12  Adapted to handle three character codes.\n  ' 28Oct16  Renamed ColCode to match ColNum.\n\n  If ColNum = 0 Then\n    Debug.Assert False\n    ColCode = \"0\"\n  Else\n    ColCode = \"\"\n    Do While ColNum &gt; 0\n      PartNum = (ColNum - 1) Mod 26\n      ColCode = Chr(65 + PartNum) &amp; ColCode\n      ColNum = (ColNum - PartNum - 1) \\ 26\n    Loop\n  End If\n\nEnd Function\nSub FindLastRowCol(ByRef Wsht As Worksheet, ByRef RowLast As Long, _\n                   ByRef ColLast As Long)\n\n  ' Sets RowLast and ColLast to the last row and column with a value\n  ' in worksheet Wsht\n\n  ' The motivation for coding this routine was the discovery that Find by\n  ' previous row found a cell formatted as Merge and Center but Find by\n  ' previous column did not.\n  ' I had known the Find would missed merged cells but this was new to me.\n\n  '   Dec16  Coded\n  ' 31Dec16  Corrected handling of UsedRange\n  ' 15Feb17  SpecialCells was giving a higher row number than Find for\n  '          no reason I could determine.  Added code to check for a\n  '          value on rows and columns above those returned by Find\n\n  Dim ColCrnt As Long\n  Dim ColLastFind As Long\n  Dim ColLastOther As Long\n  Dim ColLastTemp As Long\n  Dim ColLeft As Long\n  Dim ColRight As Long\n  Dim Rng As Range\n  Dim RowIncludesMerged As Boolean\n  Dim RowBot As Long\n  Dim RowCrnt As Long\n  Dim RowLastFind As Long\n  Dim RowLastOther As Long\n  Dim RowLastTemp As Long\n  Dim RowTop As Long\n\n  With Wsht\n\n    Set Rng = .Cells.Find(\"*\", .Range(\"A1\"), xlFormulas, , xlByRows, xlPrevious)\n    If Rng Is Nothing Then\n      RowLastFind = 0\n      ColLastFind = 0\n    Else\n      RowLastFind = Rng.Row\n      ColLastFind = Rng.Column\n    End If\n\n    Set Rng = .Cells.Find(\"*\", .Range(\"A1\"), xlValues, , xlByColumns, xlPrevious)\n    If not Rng Is Nothing Then\n      If RowLastFind &lt; Rng.Row Then\n        RowLastFind = Rng.Row\n      End If\n      If ColLastFind &lt; Rng.Column Then\n        ColLastFind = Rng.Column\n      End If\n    End If\n\n    Set Rng = .Range(\"A1\").SpecialCells(xlCellTypeLastCell)\n    If Rng Is Nothing Then\n      RowLastOther = 0\n      ColLastOther = 0\n    Else\n      RowLastOther = Rng.Row\n      ColLastOther = Rng.Column\n    End If\n\n    Set Rng = .UsedRange\n    If not Rng Is Nothing Then\n      If RowLastOther &lt; Rng.Row + Rng.Rows.Count - 1 Then\n        RowLastOther = Rng.Row + Rng.Rows.Count - 1\n      End If\n      If ColLastOther &lt; Rng.Column + Rng.Columns.Count - 1 Then\n        ColLastOther = Rng.Column + Rng.Columns.Count - 1\n      End If\n    End If\n\n    If RowLastFind &lt; RowLastOther Then\n      ' Higher row found by SpecialCells or UserRange\n      Do While RowLastOther &gt; RowLastFind\n        ColLastTemp = .Cells(RowLastOther, .Columns.Count).End(xlToLeft).Column\n        If ColLastTemp &gt; 1 Or .Cells(RowLastOther, 1).Value &lt;&gt; \"\" Then\n          ' Row after RowLastFind has value\n          RowLastFind = RowLastOther\n          Exit Do\n        End If\n        RowLastOther = RowLastOther - 1\n      Loop\n    ElseIf RowLastFind &gt; RowLastOther Then\n      Debug.Assert False\n      ' Is this possible\n    End If\n    RowLast = RowLastFind\n\n    If ColLastFind &lt; ColLastOther Then\n      ' Higher column found by SpecialCells or UserRange\n      Do While ColLastOther &gt; ColLastFind\n        RowLastTemp = .Cells(.Rows.Count, ColLastOther).End(xlUp).Row\n        If RowLastTemp &gt; 1 Or .Cells(1, ColLastOther).Value &lt;&gt; \"\" Then\n          Debug.Assert False\n          ' Column after ColLastFind has value\n          ColLastFind = ColLastOther\n          Exit Do\n        End If\n        ColLastOther = ColLastOther - 1\n      Loop\n    ElseIf ColLastFind &gt; ColLastOther Then\n      Debug.Assert False\n      ' Is this possible\n    End If\n    ColLast = ColLastFind\n\n  End With\n\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7429757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H8Ou9cD3p7s/AAAAAAAAAAI/AAAAAAAAKkg/ZTA8Pmoc5xo/photo.jpg?sz=128", "display_name": "John Murrey", "link": "https://stackoverflow.com/users/7429757/john-murrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2241, "favorite_count": 2, "answer_count": 3, "score": 2, "last_activity_date": 1610432739, "creation_date": 1484740780, "last_edit_date": 1610432739, "question_id": 41718862, "link": "https://stackoverflow.com/questions/41718862/how-to-move-mail-from-shared-mailbox-to-a-subfolder-based-on-calculated-entries", "title": "How to move mail from shared mailbox to a subfolder based on calculated entries in Excel sheet?", "body": "<p>I export e-mail details from an Outlook 2007 shared inbox folder into an Excel 2007 sheet (Sender, Subject, Date &amp; time received).</p>\n<p>I then use formulas in Excel 2007 to attempt to extract a reference from the subject. Then lookup the reference against some data exported from our computer system.</p>\n<ul>\n<li>If the reference matches with a file reference then set criteria from a formula will populate an answer in column D (so that's Sender, Subject, Date &amp; time received, Yes/No).</li>\n<li>If the reference can't be found or the data from the file doesn't meet the criteria to merit a response column D will then show &quot;Yes&quot; (meaning it needs to be marked as read and moved to the folder &quot;No Response&quot; which is part of the same shared mailbox on the same level as the inbox) otherwise will show &quot;No&quot; (in which case nothing needs to be done to that e-mail). The Yes/No Column formula criteria will be a continuous work in progress.</li>\n</ul>\n<p>Exporting the e-mail details into an Excel sheet works and so do all of the formulas.</p>\n<p>I've not managed to get Outlook to take the appropriate action from the details in the Excel sheet.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ExportToExcel()\n    \n    ' Fully working, will export Sender, Subject &amp; Date Received from e-mails into spreadsheet *** Except For Non-Mail Items ***\n    ' If getting &quot;spreadsheet user-defined type not defined&quot; go to Visual Basic &gt; Tools &gt; References and tick 'Microsoft Excel 12.0 Object Library'\n    On Error GoTo ErrHandler\n    Dim appExcel As Excel.Application\n    Dim wkb As Excel.Workbook\n    Dim wks As Excel.Worksheet\n    Dim rng As Excel.Range\n    Dim strSheet As String\n    Dim strPath As String\n    Dim intRowCounter As Integer\n    Dim intColumnCounter As Integer\n    Dim msg As Outlook.MailItem\n    Dim nms As Outlook.NameSpace\n    Dim fld As Outlook.MAPIFolder\n    Dim itm As Object\n    \n    'Set path for spreadsheet\n    strSheet = &quot;OE.xlsx&quot;\n    strPath = &quot;C:\\Users\\JM\\Desktop\\&quot;\n    strSheet = strPath &amp; strSheet\n    Debug.Print strSheet\n    \n    'Select export folder\n    Set nms = Application.GetNamespace(&quot;MAPI&quot;)\n    Set fld = nms.PickFolder\n        \n    'Handle potential errors with Select Folder dialog box.\n    If fld Is Nothing Then\n        MsgBox &quot;There are no mail messages to export&quot;, vbOKOnly, &quot;Error&quot;\n    Exit Sub\n    \n    ElseIf fld.DefaultItemType &lt;&gt; olMailItem Then\n        MsgBox &quot;There are no mail messages to export&quot;, vbOKOnly, &quot;Error&quot;\n    Exit Sub\n    \n    ElseIf fld.Items.Count = 0 Then\n        MsgBox &quot;There are no mail messages to export&quot;, vbOKOnly, &quot;Error&quot;\n    Exit Sub\n    \n    End If\n    \n    'Open and activate Excel workbook.\n    Set appExcel = CreateObject(&quot;Excel.Application&quot;)\n    appExcel.Workbooks.Open (strSheet)\n    Set wkb = appExcel.ActiveWorkbook\n    Set wks = wkb.Sheets(1)\n    wks.Activate\n    appExcel.Application.Visible = True\n       \n    'Copy field items in mail folder.\n    For Each itm In fld.Items\n        intColumnCounter = 1\n        Set msg = itm\n        intRowCounter = intRowCounter + 1\n        Set rng = wks.Cells(intRowCounter, intColumnCounter)\n        intColumnCounter = intColumnCounter\n        Set rng = wks.Cells(intRowCounter, intColumnCounter)\n        'rng.Value = msg.SenderEmailAddress\n        rng.Value = msg.SenderEmailAddress\n        intColumnCounter = intColumnCounter + 1\n        Set rng = wks.Cells(intRowCounter, intColumnCounter)\n        rng.Value = msg.Subject\n        intColumnCounter = intColumnCounter\n        intColumnCounter = intColumnCounter + 1\n        Set rng = wks.Cells(intRowCounter, intColumnCounter)\n        rng.Value = msg.ReceivedTime\n    Next itm\n                \n    MsgBox &quot;Export Complete&quot;, vbOKOnly, &quot;Information&quot;\n    Set appExcel = Nothing\n    Set wkb = Nothing\n    Set wks = Nothing\n    Set rng = Nothing\n    Set msg = Nothing\n    Set nms = Nothing\n    Set fld = Nothing\n    Set itm = Nothing\n    Exit Sub\n    \nErrHandler:\n    If Err.Number = 1004 Then\n        MsgBox strSheet &amp; &quot; doesn't exist&quot;, vbOKOnly, &quot;Error&quot;\n    Else\n    End If\n    Set appExcel = Nothing\n    Set wkb = Nothing\n    Set wks = Nothing\n    Set rng = Nothing\n    Set msg = Nothing\n    Set nms = Nothing\n    Set fld = Nothing\n    Set itm = Nothing\n    MsgBox &quot;Export Completed&quot;, vbOKOnly\nEnd Sub\n</code></pre>\n<p>This is what the spreadsheet would look like, I can't show the original because of data protection.<br />\n<a href=\"https://i.stack.imgur.com/BxBeH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BxBeH.jpg\" alt=\"enter image description here\" /></a></p>\n<p>Most of the code has been put together from a few different websites.</p>\n<p>The predominant source of the code was this site\n<a href=\"http://www.vbaexpress.com/forum/showthread.php?52247-Macro-to-send-out-email-based-on-criteria-via-outlook/page3&amp;s=11b5bf88fb5e89d06f7c8b43f6f92d2e\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/forum/showthread.php?52247-Macro-to-send-out-email-based-on-criteria-via-outlook/page3&amp;s=11b5bf88fb5e89d06f7c8b43f6f92d2e</a></p>\n<p>I want the following code to:</p>\n<ul>\n<li>Mark the &quot;Yes&quot; e-mails as read and move them into the shared &quot;No Response&quot; folder in Outlook (in the same shared mailbox as the inbox the e-mail details were exported from).</li>\n</ul>\n<p>This is where I am so far. The code will recognise an e-mail, mark it as unread, flag it as complete but it won't move the items into the folder or process the whole folder.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nConst strWorkbook As String = &quot;C:\\Users\\jmurrey\\Desktop\\OE.xlsm&quot; 'The path of the workbook\nConst strSheet As String = &quot;Sheet1&quot; 'The name of the worksheet\nSub ProcessFolder()\n    Dim olItem As Object\n    Dim olFolder As Folder\n    Set olFolder = Session.PickFolder 'select the folder\n    For Each olItem In olFolder.Items 'loop through the items\n        If TypeName(olItem) = &quot;MailItem&quot; Then\n            MoveToFolder olItem 'run the macro\n        End If\n        Exit For\n    Next olItem\n    Set olItem = Nothing\nlbl_Exit:\n    Exit Sub\nEnd Sub\n\nSub MailFilter()\n    Dim olMsg As MailItem\n    On Error Resume Next\n    Set olMsg = ActiveExplorer.Selection.Item(1)\n    MoveToFolder olMsg\nlbl_Exit:\n    Exit Sub\nEnd Sub\n     \nSub MoveToFolder(olMail As Outlook.MailItem)\n    Dim olReply As Outlook.MailItem\n    Dim olInsp As Outlook.Inspector\n    Dim wdDoc As Object\n    Dim oRng As Object\n    Dim Arr() As Variant\n    Dim iCols As Long\n    Dim iRows As Long\n    Dim strName As String\n    'load the worksheet into an array\n    Arr = xlFillArray(strWorkbook, strSheet)\n    With olMail\n        For iRows = 0 To UBound(Arr, 2) 'Check each row of the array\n            'If column 2 (starting at column 0) contains the e-mail address of the message\n            If .SenderEmailAddress = Arr(0, iRows) Then\n                'If the subject value is in the message subject\n                If InStr(1, .Subject, Arr(1, iRows)) &gt; 0 Then\n                    If InStr(1, .ReceivedTime, Arr(2, iRows)) &gt; 0 Then\n                    'If the received time is in the message subject\n                        If InStr(1, &quot;Yes&quot;, Arr(3, iRows)) &gt; 0 Then\n                        'If The string above matches then mark the email as unread and move to 'No Response' folder\n                            'MsgBox &quot;Match Found&quot;, vbOKOnly, &quot;Match&quot;\n                            .FlagStatus = olFlagComplete\n                            .UnRead = False\n                            .Save\n                            .Move Application.Session.Folders(&quot;No Response&quot;)\n                            Exit For\n                        End If\n                    End If\n                End If\n            End If\n        Next iRows\n    End With\nlbl_Exit:\n    Set olReply = Nothing\n    Set olInsp = Nothing\n    Set wdDoc = Nothing\n    Set oRng = Nothing\n    Exit Sub\nEnd Sub\n     \nPrivate Function xlFillArray(strWorkbook As String, _\n    strWorksheetName As String) As Variant\n    Dim RS As Object\n    Dim CN As Object\n    Dim iRows As Long\n         \n    strWorksheetName = strWorksheetName &amp; &quot;$]&quot;\n    Set CN = CreateObject(&quot;ADODB.Connection&quot;)\n    CN.Open ConnectionString:=&quot;Provider=Microsoft.ACE.OLEDB.12.0;&quot; &amp; _\n      &quot;Data Source=&quot; &amp; strWorkbook &amp; &quot;;&quot; &amp; _\n      &quot;Extended Properties=&quot;&quot;Excel 12.0 Xml;HDR=YES&quot;&quot;;&quot;\n         \n    Set RS = CreateObject(&quot;ADODB.Recordset&quot;)\n    RS.Open &quot;SELECT * FROM [&quot; &amp; strWorksheetName, CN, 2, 1\n         \n    With RS\n        .MoveLast\n        iRows = .RecordCount\n        .MoveFirst\n    End With\n    xlFillArray = RS.GetRows(iRows)\n    If RS.State = 1 Then RS.Close\n        Set RS = Nothing\n        If CN.State = 1 Then CN.Close\n        Set CN = Nothing\nlbl_Exit:\n    Exit Function\nEnd Function\n</code></pre>\n<p>How do I move e-mails to the folder &quot;No Response&quot; which is in the same shared mailbox as the inbox the data has been exported from and also run through all of the e-mails in the Excel sheet rather than just one.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 7434894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafb72087536decf0eb5b671a948a31d?s=128&d=identicon&r=PG&f=1", "display_name": "Leroy vd Linden", "link": "https://stackoverflow.com/users/7434894/leroy-vd-linden"}, "is_accepted": true, "score": 0, "last_activity_date": 1572957088, "last_edit_date": 1572957088, "creation_date": 1485785065, "answer_id": 41937826, "question_id": 41718543, "link": "https://stackoverflow.com/questions/41718543/get-multiple-cells-as-input-for-table-connection/41937826#41937826", "title": "Get multiple cells as input for Table connection", "body": "<p>Found the following solution:</p>\n\n<pre><code>Set pt_I = ActiveWorkbook.Worksheets(\"Sheetname\").ListObjects(\"Table_name\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7434894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafb72087536decf0eb5b671a948a31d?s=128&d=identicon&r=PG&f=1", "display_name": "Leroy vd Linden", "link": "https://stackoverflow.com/users/7434894/leroy-vd-linden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 41937826, "answer_count": 1, "score": 0, "last_activity_date": 1576124614, "creation_date": 1484739764, "last_edit_date": 1576124614, "question_id": 41718543, "link": "https://stackoverflow.com/questions/41718543/get-multiple-cells-as-input-for-table-connection", "title": "Get multiple cells as input for Table connection", "body": "<p>I want to get input from multiple cells and sheets to create a Query and then use that query for the connection.</p>\n\n<p>I copied a Module that is used in a different Excel file and does the same job for a PivotTable, but I would like to have it work with a normal Table.</p>\n\n<p><strong>Overview excel file:</strong></p>\n\n<p>Sheet \"Settings\" with a list of names that have to be used to filter.</p>\n\n<p>Sheet \"All Incidents 2014\" with a Table that has the connection and has to be refreshed with the new query.</p>\n\n<p>Sheet \"SQL\" that has the Query I would like to use without WHERE statement. Also the Connection String has been put down here.</p>\n\n<p>I've a feeling that the row underneath is wrong normally you would use .PivotTable if it is a PivotTable, but this time it's a Table. I would like to know what I have to use to get this to work with a Table.</p>\n\n<pre><code>Set tab_I = ActiveWorkbook.Worksheets(\"All Incidents 2014\").Range(\"A1\").TableObject\n\nModule:\n--------------------------------------\n\nFunction Update_2014()\n\n'-----------------------------------------------------------------\n\nDim in_sql As String\n\nDim sql_I1 As String\n\nDim tab_I As TableObject\n\nDim connection As String\n\n'-----------------------------------------------------------------\n\nin_sql = \"\"\n\nsql_I1 = ActiveWorkbook.Worksheets(\"SQL\").Range(\"A1\").Value\n\nSet tab_I = ActiveWorkbook.Worksheets(\"All Incidents 2014\").Range(\"A1\").PivotTable\n\nconnection = ActiveWorkbook.Worksheets(\"SQL\").Range(\"B1\")\n\n'-----------------------------------------------------------------\n\nFor Each s In ActiveWorkbook.Worksheets(\"Settings\").Range(\"C5:C500\")\n\n    If s.Value = \"\" Then\n        in_sql = in_sql\n    Else\n        in_sql = in_sql &amp; \"'%\" &amp; s.Value &amp; \"%',\" '&amp; vbCrLf\n    End If\n\nNext s\n\nin_sql = Left(in_sql, Len(in_sql) - 1)\n\n'-----------------------------------------------------------------\n\ntab_I.PivotCache.connection = \"OLEDB;\"\n\nsql_I1 = sql_I1 &amp; \", table (sys.odcivarchar2list (\" &amp; in_sql &amp; \")) Where SERVICE like column_value\"\n\ntab_I.PivotCache.CommandText = sql_I1\n\ntab_I.PivotCache.connection = connection\n\n'-----------------------------------------------------------------\n\ntab_I.Refresh\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 3, "creation_date": 1484738838, "post_id": 41718207, "comment_id": 70630940, "body": "where is <code>shtWorkSpace</code> defined and set ?"}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1484738959, "post_id": 41718207, "comment_id": 70631017, "body": "Look up Run-time error &#39;91&#39;.  - object variable not set. Which of the objects in your code is not set?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7435315, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SR7YThNFUwQ/AAAAAAAAAAI/AAAAAAAAACI/T5txHKdhfYA/photo.jpg?sz=128", "display_name": "Christian Jasper Cabotaje", "link": "https://stackoverflow.com/users/7435315/christian-jasper-cabotaje"}, "edited": false, "score": 0, "creation_date": 1484740160, "post_id": 41718429, "comment_id": 70631822, "body": "Yeah, thank you for noticing. I&#39;ve used the Activate worksheet function since the macro kinda looks through several sheets and finds the sheet that is appropriate for the data to be written in a cell or range of cells. So when the macro finds the appropriate sheet, it then activates it and so on."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1, "user_id": 7435315, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SR7YThNFUwQ/AAAAAAAAAAI/AAAAAAAAACI/T5txHKdhfYA/photo.jpg?sz=128", "display_name": "Christian Jasper Cabotaje", "link": "https://stackoverflow.com/users/7435315/christian-jasper-cabotaje"}, "edited": false, "score": 0, "creation_date": 1484740208, "post_id": 41718429, "comment_id": 70631849, "body": "@ChristianJasperCabotaje did the code above worked like you needed ?"}, {"owner": {"reputation": 1, "user_id": 7435315, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SR7YThNFUwQ/AAAAAAAAAAI/AAAAAAAAACI/T5txHKdhfYA/photo.jpg?sz=128", "display_name": "Christian Jasper Cabotaje", "link": "https://stackoverflow.com/users/7435315/christian-jasper-cabotaje"}, "edited": false, "score": 0, "creation_date": 1484741045, "post_id": 41718429, "comment_id": 70632448, "body": "Unfortunately, it still comes up with the same error."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1, "user_id": 7435315, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SR7YThNFUwQ/AAAAAAAAAAI/AAAAAAAAACI/T5txHKdhfYA/photo.jpg?sz=128", "display_name": "Christian Jasper Cabotaje", "link": "https://stackoverflow.com/users/7435315/christian-jasper-cabotaje"}, "edited": false, "score": 0, "creation_date": 1484741259, "post_id": 41718429, "comment_id": 70632586, "body": "@ChristianJasperCabotaje when you run it in debug mode (F8) at what line are you getting the error ?"}, {"owner": {"reputation": 1, "user_id": 7435315, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SR7YThNFUwQ/AAAAAAAAAAI/AAAAAAAAACI/T5txHKdhfYA/photo.jpg?sz=128", "display_name": "Christian Jasper Cabotaje", "link": "https://stackoverflow.com/users/7435315/christian-jasper-cabotaje"}, "edited": false, "score": 0, "creation_date": 1484746587, "post_id": 41718429, "comment_id": 70636306, "body": "At start of the While loop"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1484739416, "creation_date": 1484739416, "answer_id": 41718429, "question_id": 41718207, "link": "https://stackoverflow.com/questions/41718207/run-time-error-91-cant-run-through-the-second-line/41718429#41718429", "title": "Run-Time Error 91: Can&#39;t run through the second line", "body": "<p>I've added an answer, not to provide how to define and <code>Set</code> both worksheets (<code>shtData</code> and <code>shtWorkSpace</code>).</p>\n\n<p>But also to provide a better coding practice, there is no need to <code>Activate</code> worksheets, or use <code>Select</code> and <code>ActiveCell</code>. Instead use fully qualified <code>Range</code>s and <code>Worksheets</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub Test()\n\nDim shtData As Worksheet\nDim shtWorkSpace As Worksheet\nDim r As Integer\nDim strassured As String\n\nSet shtData = Worksheets(\"Data\") '&lt;-- modify \"Data\" to your sheet name\nSet shtWorkSpace = Worksheets(\"Workspace\") '&lt;-- modify \"Workspace\" to your sheet name\n\nr = 1\nWhile shtData.Cells(r, 1) &lt;&gt; \"\"\n    strassured = shtData.Cells(r, 1).Value\n\n    If shtWorkSpace.Range(\"B3\").Value = strassured Then\n        If shtWorkSpace.Range(\"A60\").Value = \"Pending\" Then\n            DataHandling.OverwriteDataTab (strassured)\n            Exit Sub\n        Else\n            MsgBox \"This assured name is already in the database. Assured Names must be unique!\", vbCritical\n            shtWorkSpace.Activate\n            ActiveSheet.Range(\"A1\").Select '&lt;-- not sure why you need to select the sheet and Range(\"A1\")\n            Exit Sub\n        End If\n    Else\n        r = r + 1\n    End If\nWend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7435315, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SR7YThNFUwQ/AAAAAAAAAAI/AAAAAAAAACI/T5txHKdhfYA/photo.jpg?sz=128", "display_name": "Christian Jasper Cabotaje", "link": "https://stackoverflow.com/users/7435315/christian-jasper-cabotaje"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484739584, "creation_date": 1484738738, "last_edit_date": 1484739584, "question_id": 41718207, "link": "https://stackoverflow.com/questions/41718207/run-time-error-91-cant-run-through-the-second-line", "title": "Run-Time Error 91: Can&#39;t run through the second line", "body": "<p>Here is part of the code I am working on which is a part of a macro.</p>\n\n<p>This is also the same on another file which is basically the same also. </p>\n\n<p>The macro works on the other file while on the other, it doesn't and comes with the Run-time error '91'. </p>\n\n<p>Attached is the code:</p>\n\n<pre><code>shtData.Activate\nDim r As Integer\nDim strassured As String\n\nr = 1\nWhile ActiveSheet.Cells(r, 1) &lt;&gt; \"\"\n    ActiveSheet.Cells(r, 1).Select\n\n    strassured = ActiveCell.Value\n    If shtWorkSpace.Range(\"B3\").Value = strassured Then\n        If shtWorkSpace.Range(\"A60\").Value = \"Pending\" Then\n            DataHandling.OverwriteDataTab (strassured)\n            Exit Sub\n        Else\n            MsgBox \"This assured name is already in the database. Assured Names must be unique!\", vbCritical\n            shtWorkSpace.Activate\n            ActiveSheet.Range(\"A1\").Select\n            Exit Sub\n        End If\n    Else\n        r = r + 1\n    End If\nWend\n</code></pre>\n"}, {"tags": ["vba", "excel", "passwords"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1484738650, "post_id": 41718145, "comment_id": 70630818, "body": "I&#39;m pretty sure that you can&#39;t do this in an <code>InputBox</code>, but you can in the TextBox in an UserForm! ;)"}, {"owner": {"reputation": 37, "user_id": 7404113, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/78cbc08fe1ac12be6905263939b1f564?s=128&d=identicon&r=PG&f=1", "display_name": "Maxe1984", "link": "https://stackoverflow.com/users/7404113/maxe1984"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1484741927, "post_id": 41718145, "comment_id": 70633011, "body": "Okay, i have created a user from, managed to get it to display text as ****, but i cannot figure out how to link in my macro to it. the current code on the user form is:                                                                            Private Sub TextBox1_Change() End Sub  Private Sub UserForm_Click() End Sub"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1484742100, "post_id": 41718145, "comment_id": 70633133, "body": "This link should help you : <a href=\"https://gregmaxey.com/word_tip_pages/userform_pass_data.html\" rel=\"nofollow noreferrer\">gregmaxey.com/word_tip_pages/userform_pass_data.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 3, "last_activity_date": 1484741281, "creation_date": 1484741281, "answer_id": 41719026, "question_id": 41718145, "link": "https://stackoverflow.com/questions/41718145/hide-characters-in-macro-for-password-control/41719026#41719026", "title": "Hide characters in macro for password control", "body": "<p>This work for me in Excel 2010 32bit.</p>\n\n<p>Create new Module and Paste this code:</p>\n\n<pre><code>Private Declare Function CallNextHookEx Lib \"user32\" (ByVal hHook As Long, _\nByVal ncode As Long, ByVal wParam As Long, lParam As Any) As Long\n\nPrivate Declare Function GetModuleHandle Lib \"kernel32\" Alias _\n\"GetModuleHandleA\" (ByVal lpModuleName As String) As Long\n\nPrivate Declare Function SetWindowsHookEx Lib \"user32\" Alias \"SetWindowsHookExA\" _\n(ByVal idHook As Long, ByVal lpfn As Long, ByVal hmod As Long, _\nByVal dwThreadId As Long) As Long\n\nPrivate Declare Function UnhookWindowsHookEx Lib \"user32\" (ByVal hHook As Long) As Long\n\nPrivate Declare Function SendDlgItemMessage Lib \"user32\" Alias \"SendDlgItemMessageA\" _\n(ByVal hDlg As Long, ByVal nIDDlgItem As Long, ByVal wMsg As Long, _\nByVal wParam As Long, ByVal lParam As Long) As Long\n\nPrivate Declare Function GetClassName Lib \"user32\" Alias \"GetClassNameA\" _\n(ByVal hwnd As Long, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long\n\nPrivate Declare Function GetCurrentThreadId Lib \"kernel32\" () As Long\n\n'~~&gt; Constants to be used in our API functions\nPrivate Const EM_SETPASSWORDCHAR = &amp;HCC\nPrivate Const WH_CBT = 5\nPrivate Const HCBT_ACTIVATE = 5\nPrivate Const HC_ACTION = 0\n\nPrivate hHook As Long\n\nPublic Function NewProc(ByVal lngCode As Long, ByVal wParam As Long, _\nByVal lParam As Long) As Long\n    Dim RetVal\n    Dim strClassName As String, lngBuffer As Long\n\n    If lngCode &lt; HC_ACTION Then\n        NewProc = CallNextHookEx(hHook, lngCode, wParam, lParam)\n        Exit Function\n    End If\n\n    strClassName = String$(256, \" \")\n    lngBuffer = 255\n\n    If lngCode = HCBT_ACTIVATE Then\n        RetVal = GetClassName(wParam, strClassName, lngBuffer)\n        '~~&gt; Class name of the Inputbox\n        If Left$(strClassName, RetVal) = \"#32770\" Then\n            '~~&gt; This changes the edit control so that it display the password character *.\n            '~~&gt; You can change the Asc(\"*\") as you please.\n            SendDlgItemMessage wParam, &amp;H1324, EM_SETPASSWORDCHAR, Asc(\"*\"), &amp;H0\n        End If\n    End If\n\n    '~~&gt; This line will ensure that any other hooks that may be in place are\n    '~~&gt; called correctly.\n    CallNextHookEx hHook, lngCode, wParam, lParam\n\nEnd Function\n\nPublic Function InputBoxDK(Prompt, Optional Title, Optional Default, Optional XPos, _\nOptional YPos, Optional HelpFile, Optional Context) As String\n    Dim lngModHwnd As Long, lngThreadID As Long\n    lngThreadID = GetCurrentThreadId\n    lngModHwnd = GetModuleHandle(vbNullString)\n    hHook = SetWindowsHookEx(WH_CBT, AddressOf NewProc, lngModHwnd, lngThreadID)\n    InputBoxDK = InputBox(Prompt, Title, Default, XPos, YPos, HelpFile, Context)\n    UnhookWindowsHookEx hHook\nEnd Function\n</code></pre>\n\n<p>Then in your code replace <code>InputBox</code> with <code>InputBoxDK</code></p>\n\n<p>I found this code in other site in the net and as I remember it was by @Siddharth Rout.</p>\n"}], "owner": {"reputation": 37, "user_id": 7404113, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/78cbc08fe1ac12be6905263939b1f564?s=128&d=identicon&r=PG&f=1", "display_name": "Maxe1984", "link": "https://stackoverflow.com/users/7404113/maxe1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1549, "favorite_count": 0, "accepted_answer_id": 41719026, "answer_count": 1, "score": 2, "last_activity_date": 1486116038, "creation_date": 1484738555, "last_edit_date": 1484738588, "question_id": 41718145, "link": "https://stackoverflow.com/questions/41718145/hide-characters-in-macro-for-password-control", "title": "Hide characters in macro for password control", "body": "<p>I have created a macro to insert an image, when an individual presses a button on the spreadsheet the below macro will run and a message box will appear for the individual to input a password, if correct the image will be inserted. This works fine but i would like the message box to hide the password with stars e.g. ********</p>\n\n<p>Here is the current Macro:</p>\n\n<pre><code>Sub M_Reeve()\n\n'Create the password message box\n\nDim Answer As String\n    Answer = InputBox(\"Input Operator Stamp Password\", \"Password\")\n\n    If Answer = \"Martin\" Then\n\n       'Run the copy and paste \"Stamp1\" macro from module 2\n\n    Stamp1\n\n        'return an error if wrong password\n\n    Else: MsgBox \"Wrong password\", vbCritical + vbOKCancel, \"Incorrect Password\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c#", "excel", "com", "vba"], "answers": [{"tags": [], "owner": {"reputation": 694, "user_id": 2295754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5BSYt.jpg?s=128&g=1", "display_name": "ashbygeek", "link": "https://stackoverflow.com/users/2295754/ashbygeek"}, "is_accepted": false, "score": 0, "last_activity_date": 1484741135, "last_edit_date": 1495542275, "creation_date": 1484741135, "answer_id": 41718987, "question_id": 41718047, "link": "https://stackoverflow.com/questions/41718047/is-there-way-to-track-source-of-call-in-c-com-object/41718987#41718987", "title": "is there way to track source of call in C# com object?", "body": "<p>You could try using introspection to learn about the calling method. I'm not sure that this will work in this case because it's being called through the COM system and that might hide the origin. Here's how you could try it anyway:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3095696/how-do-i-get-the-calling-method-name-and-type-using-reflection\">How do I get the calling method name and type using reflection?</a></p>\n"}, {"tags": [], "owner": {"reputation": 694, "user_id": 2295754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5BSYt.jpg?s=128&g=1", "display_name": "ashbygeek", "link": "https://stackoverflow.com/users/2295754/ashbygeek"}, "is_accepted": false, "score": 0, "last_activity_date": 1484741343, "creation_date": 1484741343, "answer_id": 41719055, "question_id": 41718047, "link": "https://stackoverflow.com/questions/41718047/is-there-way-to-track-source-of-call-in-c-com-object/41719055#41719055", "title": "is there way to track source of call in C# com object?", "body": "<p>If you have control over both the VBA code and the C# code, you could simply add an extra parameter that will be logged as the 'name' of the calling COM object. You can then customize that parameter in each item that calls it.</p>\n\n<p>For instance.\nc#</p>\n\n<pre><code>[comvisible(true)]\npublic void doStuff(string callingName, object otherarg, object anotherarg)\n{\n    Console.writeline(\"Called by \" + callingName);\n    //blah blah blah\n}\n</code></pre>\n\n<p>vba 1</p>\n\n<pre><code>set tmp = ReferenceToCSharpComObject\ncall tmp.doStuff(\"Example VBA Script\", null, null)\n</code></pre>\n\n<p>vba 2</p>\n\n<pre><code>set tmp = ReferenceToCSharpComObject\ncall tmp.doStuff(\"Second VBA Example\", null, null)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2796782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f81ff0a4e5b8caa383fd3bdf39d5641?s=128&d=identicon&r=PG&f=1", "display_name": "user2796782", "link": "https://stackoverflow.com/users/2796782/user2796782"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484741343, "creation_date": 1484738307, "last_edit_date": 1531164843, "question_id": 41718047, "link": "https://stackoverflow.com/questions/41718047/is-there-way-to-track-source-of-call-in-c-com-object", "title": "is there way to track source of call in C# com object?", "body": "<p>we have a c# com object which is called from vba codes in various spreadsheets, is there a way to log the source that invoke the com object? i.e. excel file name, workbook etc?   </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484739384, "post_id": 41717631, "comment_id": 70631272, "body": "why would you have to close and open that workbook again and again instead of having it process as many order numbers output as the user needs?"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 1, "creation_date": 1484739577, "post_id": 41717631, "comment_id": 70631422, "body": "There is no question in this question."}, {"owner": {"reputation": 11, "user_id": 7435112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210378300685336/picture?type=large", "display_name": "Shuaib Ismail", "link": "https://stackoverflow.com/users/7435112/shuaib-ismail"}, "edited": false, "score": 0, "creation_date": 1484740972, "post_id": 41717631, "comment_id": 70632403, "body": "its not necessary to close and open the workbook, but my aim is to get the user to complete the required information first before getting an order number and  prevent any duplication of order numbers between users."}], "owner": {"reputation": 11, "user_id": 7435112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210378300685336/picture?type=large", "display_name": "Shuaib Ismail", "link": "https://stackoverflow.com/users/7435112/shuaib-ismail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484824483, "creation_date": 1484737175, "last_edit_date": 1484824483, "question_id": 41717631, "link": "https://stackoverflow.com/questions/41717631/vba-input-box-excel-requests-iinformation-upon-spreadsheet-being-opened", "title": "VBA INPUT BOX - EXCEL REQUESTS IINFORMATION UPON SPREADSHEET BEING OPENED", "body": "<p>I am working on an excel spreadsheet (route book),<a href=\"https://i.stack.imgur.com/TQBAm.png\" rel=\"nofollow noreferrer\">enter image description here</a> see attached.\nI require excel to request information via a popup input box upon the spreadsheet being opened, which will reflect on b2,c2,d2,e2,f2,g2,h2 respectively, once all information is filled in then a2 becomes available(this can be done via formula) and then should move on to the next line.\nSo basically every time a user opens the spreadsheet, excel requests information via a pop up screen, once this information is filled in the order number becomes available the cycle starts again on a new line.\nSomething like below<a href=\"https://i.stack.imgur.com/szRgp.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Then once this is completed then automatically another pop up, until all information is captured and order number becomes available.\nI cannot get the pop ups  to follow up one after the other until the end</p>\n\n<pre><code>Sub inputbox1()\nDim adddata As Range\nDim addinput As String\nSet adddata = Cells(Rows.Count, 2).End(xlUp).Offset(1, 0)\naddinput = InputBox(\"Enter date here\", \"Date\")\nIf addinput = Empty Then Exit Sub\nadddata.Value = addinput\nEnd Sub\nSub inputbox2()\nDim adddata As Range\nDim addinput As String\nSet adddata = Cells(Rows.Count, 3).End(xlUp).Offset(1, 0)\naddinput = InputBox(\"Enter Transporter here\", \"Transporter\")\nIf addinput = Empty Then Exit Sub\nadddata.Value = addinput\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484738804, "post_id": 41717466, "comment_id": 70630914, "body": "what do you mean with  <i>&quot;but I want that the macro takes automatically the address.&quot;</i>?"}], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1484737359, "post_id": 41717603, "comment_id": 70629975, "body": "The problem is with the first macro I select also other file for other macros"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1484737706, "post_id": 41717603, "comment_id": 70630213, "body": "@AntonPetrov : Can be a bit more clear about this? You use the same &quot;Open Dialog&quot; for multiple procedures on different sub-selections? If it is for the same selection, you just have to add them where I marked it! ;)"}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1484737962, "post_id": 41717603, "comment_id": 70630378, "body": "I use the Open Dialog to also open completly excel files that I use in another macros."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1485352971, "post_id": 41717603, "comment_id": 70890797, "body": "@AntonPetrov : You just have to other lines after <code>ISIN strPath</code>, like <code>NewProcedure strPath</code> that I commented! So does it fix your initial problem?"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1484737747, "last_edit_date": 1484737747, "creation_date": 1484737122, "answer_id": 41717603, "question_id": 41717466, "link": "https://stackoverflow.com/questions/41717466/vba-browse-file-and-make-operations/41717603#41717603", "title": "VBA browse file and make operations", "body": "<p>You should simply use an argument in <code>ISIN</code>, try this! ;)</p>\n\n<pre><code>Option Explicit\n\nSub SelctFile()\n    Dim intChoice As Integer\n    Dim strPath As String\n    Dim i As Integer\n\n    'allow the user to select multiple files\n    Application.FileDialog(msoFileDialogOpen).AllowMultiSelect = True\n    'make the file dialog visible to the user\n    intChoice = Application.FileDialog(msoFileDialogOpen).Show\n    'determine what choice the user made\n    If intChoice &lt;&gt; 0 Then\n        'get the file path selected by the user\n        For i = 1 To Application.FileDialog(msoFileDialogOpen).SelectedItems.Count\n            strPath = Application.FileDialog(msoFileDialogOpen).SelectedItems(i)\n            ISIN strPath\n            ''Add other procedures there!\n            'NewProcedure strPath\n        Next i\n    End If\nEnd Sub\n\n\nSub ISIN(ByVal FilePath As String)\n    Dim MSReport As Excel.Workbook\n    Set MSReport = Workbooks.Open(Filename:=FilePath)\n\n    MSReport.Sheets(\"SheetName\").Range(\"W3:W2500\").Formula = _\n            \"=IF(G3=\"\"\"\",\"\"\"\",BDP(G3&amp;\"\" Equity\"\",\"\"ID_ISIN\"\"))\"\n\n    MSReport.Save\n    MSReport.Close False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3991, "favorite_count": 0, "accepted_answer_id": 41717603, "answer_count": 1, "score": 1, "last_activity_date": 1484737747, "creation_date": 1484736775, "last_edit_date": 1484736852, "question_id": 41717466, "link": "https://stackoverflow.com/questions/41717466/vba-browse-file-and-make-operations", "title": "VBA browse file and make operations", "body": "<p>Hello I am trying to write a VBA macro, which browses excel files and then makes operation in the files. The code I wrote is as follows:</p>\n\n<pre><code>Option Explicit\n\nSub SelctFile()\nDim intChoice As Integer\nDim strPath As String\nDim i As Integer\n\n'allow the user to select multiple files\nApplication.FileDialog(msoFileDialogOpen).AllowMultiSelect = True\n'make the file dialog visible to the user\nintChoice = Application.FileDialog(msoFileDialogOpen).Show\n'determine what choice the user made\nIf intChoice &lt;&gt; 0 Then\n    'get the file path selected by the user\n    For i = 1 To Application.FileDialog(msoFileDialogOpen _\n        ).SelectedItems.Count\n        strPath = Application.FileDialog(msoFileDialogOpen _\n        ).SelectedItems(i)\n        'print the file path to sheet 1\n        Cells(i + 1, 2) = strPath\n    Next i\nEnd If    \nEnd Sub\n\n\nSub ISIN()\n\nDim MSReport As Variant\n\nMSReport = Range(\"B2\").Value\n\nSet MSReport = Workbooks.Open(Filename:=\"MSReport\")\nRange(\"W3:W2500\").Formula = \"=IF(G3=\"\"\"\",\"\"\"\",BDP(G3&amp;\"\" Equity\"\",\"\"ID_ISIN\"\"))\"\n\nEnd Sub\n</code></pre>\n\n<p>The first Sub SelectFile chooses the files and I have the file path in cell B2. So I want to use the path from cell B2 in Sub ISIN. </p>\n\n<p>If I write the address it works, but I want that the macro takes automatically the address.</p>\n\n<p>Also is it possible that the changes are mada without opening the another worksheet.</p>\n"}, {"tags": ["vba", "ms-access", "createoleobject"], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1489179893, "last_edit_date": 1489179893, "creation_date": 1489172180, "answer_id": 42725794, "question_id": 41716961, "link": "https://stackoverflow.com/questions/41716961/add-view-oleobjects-using-ms-access-vba/42725794#42725794", "title": "Add/View OLEObjects using MS Access VBA", "body": "<p>Review this reference for method to import OLEObject <a href=\"https://access-programmers.co.uk/forums/showthread.php?t=186617\" rel=\"nofollow noreferrer\">Import OLEObject</a>. Quite a bit of code involved. Download the sample db and start with review of this proc:</p>\n\n<pre><code>Sub SaveFileToBlob(OLEPath, OLEName)\nDim Tbl As New ADODB.Recordset\n\n    Set Tbl = New ADODB.Recordset\n    With Tbl\n        .Open \"TblEmbeddedObjects\", MasterDbConn, adOpenKeyset, adLockOptimistic, adCmdTable\n        .AddNew\n        .Fields(\"fldDocumentName\").Value = OLEName\n         FileToBlob OLEPath &amp; OLEName, .Fields(\"fldDocument\")\n        .Fields(\"fldDocumentDate\") = Date\n        .Fields(\"fldDestinationPath\") = Replace(OLEPath, \"\\\\\", \"\\\")\n        .Update\n        .Close\n    End With\n    Set Tbl = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Uses methods AppendChunk and GetChunk. Review <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822448.aspx\" rel=\"nofollow noreferrer\">Manage OLEObject</a></p>\n"}], "owner": {"reputation": 1, "user_id": 2906435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Th9p5.jpg?s=128&g=1", "display_name": "Metal", "link": "https://stackoverflow.com/users/2906435/metal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 497, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489179893, "creation_date": 1484735401, "last_edit_date": 1495535401, "question_id": 41716961, "link": "https://stackoverflow.com/questions/41716961/add-view-oleobjects-using-ms-access-vba", "title": "Add/View OLEObjects using MS Access VBA", "body": "<p>Based on <a href=\"https://stackoverflow.com/questions/18237180/add-view-attachments-using-ms-access-vba\">Add/view attachments using MS Access VBA</a> is there a way to act the same way but this time for OLEObjects? How can we replace the <code>AddAttachment</code> method?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1484735587, "post_id": 41716830, "comment_id": 70628753, "body": "It should probably be <code>For Each c In Selection.Cells</code> (and you should avoid using <code>Select</code> as much as possible. Also, see this doc : <a href=\"http://stackoverflow.com/documentation/vba/7363/passing-arguments-byref-or-byval#t=201701181030371271291\">stackoverflow.com/documentation/vba/7363/&hellip;</a>"}, {"owner": {"reputation": 701, "user_id": 2083341, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4c88f9cf40f2e217cd9c3016f6eab528?s=128&d=identicon&r=PG", "display_name": "Wilhelm Sorban", "link": "https://stackoverflow.com/users/2083341/wilhelm-sorban"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1484735706, "post_id": 41716830, "comment_id": 70628837, "body": "Thanks, but unfortunately that didn&#39;t solve the issue."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1484736112, "post_id": 41716830, "comment_id": 70629125, "body": "Do you alter the cells in <code>ProcessCells</code>? Because you can&#39;t change the value of an element in a <code>For Each</code> loop (I know, it is a pain...)"}, {"owner": {"reputation": 701, "user_id": 2083341, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4c88f9cf40f2e217cd9c3016f6eab528?s=128&d=identicon&r=PG", "display_name": "Wilhelm Sorban", "link": "https://stackoverflow.com/users/2083341/wilhelm-sorban"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1484736192, "post_id": 41716830, "comment_id": 70629184, "body": "Nope, and even if the ProcessCells procedure is empty, I get the same error."}], "answers": [{"comments": [{"owner": {"reputation": 701, "user_id": 2083341, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4c88f9cf40f2e217cd9c3016f6eab528?s=128&d=identicon&r=PG", "display_name": "Wilhelm Sorban", "link": "https://stackoverflow.com/users/2083341/wilhelm-sorban"}, "edited": false, "score": 2, "creation_date": 1484736467, "post_id": 41717240, "comment_id": 70629376, "body": "Thanks, using &#39;Call&#39; fixed it. But you are mentioning that I need to use &#39;Call&#39; because I have an argument in parenthesis. Isn&#39;t it the same case, in the While loop?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 701, "user_id": 2083341, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4c88f9cf40f2e217cd9c3016f6eab528?s=128&d=identicon&r=PG", "display_name": "Wilhelm Sorban", "link": "https://stackoverflow.com/users/2083341/wilhelm-sorban"}, "edited": false, "score": 0, "creation_date": 1484736943, "post_id": 41717240, "comment_id": 70629683, "body": "No. In the while loop you are using an XL built in function - IsEmpty(). It takes arguments in parenthesis. Here is a good reference about it - <a href=\"http://stackoverflow.com/questions/1072075/how-do-i-call-a-vba-function-into-a-sub-procedure\" title=\"how do i call a vba function into a sub procedure\">stackoverflow.com/questions/1072075/&hellip;</a>"}, {"owner": {"reputation": 701, "user_id": 2083341, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4c88f9cf40f2e217cd9c3016f6eab528?s=128&d=identicon&r=PG", "display_name": "Wilhelm Sorban", "link": "https://stackoverflow.com/users/2083341/wilhelm-sorban"}, "edited": false, "score": 0, "creation_date": 1484737512, "post_id": 41717240, "comment_id": 70630085, "body": "Nono, I meant I am calling the same procedure, that I also call in the For loop: &#39;ProcessCells&#39; But instead of the looped cell, I am passing the built in &#39;Cells&#39; parameter."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 701, "user_id": 2083341, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4c88f9cf40f2e217cd9c3016f6eab528?s=128&d=identicon&r=PG", "display_name": "Wilhelm Sorban", "link": "https://stackoverflow.com/users/2083341/wilhelm-sorban"}, "edited": false, "score": 1, "creation_date": 1484738303, "post_id": 41717240, "comment_id": 70630613, "body": "I see now. I suppose <code>Cell</code> is an object <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221403(v=office.11).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a> , thus the VBA treats it with more respect (first-class citizen, etc.), and concerning the <code>c</code> range, it is part of iEnumerable, thus the VBA realizes later about it (although it is declared in the top)."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1484737211, "last_edit_date": 1495539946, "creation_date": 1484736183, "answer_id": 41717240, "question_id": 41716830, "link": "https://stackoverflow.com/questions/41716830/object-required-error-when-looping-through-cells-in-selection/41717240#41717240", "title": "Object required error when looping through cells in selection", "body": "<p>Here is how you should do it:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim c   As Range\n\n    For Each c In Selection\n        Call ProcessCells(c)\n    Next c\nEnd Sub\n\n\nSub ProcessCells(ce As Range)\nEnd Sub\n</code></pre>\n\n<p>You should refer with <code>call</code>, because you have an argument in parenthesis.\nOr like this, if you do not like the <code>call</code>:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim c   As Range\n\n    For Each c In Selection\n         ProcessCells c\n    Next c\nEnd Sub\n\n\nSub ProcessCells(ce As Range)\nEnd Sub\n</code></pre>\n\n<p>Plus a small edition of your code. Make your declarations like this:</p>\n\n<pre><code>Dim X as Long, Y As long\n</code></pre>\n\n<p>In your code X is declared as a variant, and integer is slower and smaller than long - <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\">Why Use Integer Instead of Long?</a></p>\n\n<p>Here is some good explanation when to put the argument in parenthesis and when to use the <code>call</code> - <a href=\"https://stackoverflow.com/questions/1072075/how-do-i-call-a-vba-function-into-a-sub-procedure\">How do I call a VBA Function into a Sub Procedure</a></p>\n"}], "owner": {"reputation": 701, "user_id": 2083341, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4c88f9cf40f2e217cd9c3016f6eab528?s=128&d=identicon&r=PG", "display_name": "Wilhelm Sorban", "link": "https://stackoverflow.com/users/2083341/wilhelm-sorban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 41717240, "answer_count": 1, "score": 2, "last_activity_date": 1484737211, "creation_date": 1484735121, "last_edit_date": 1484735642, "question_id": 41716830, "link": "https://stackoverflow.com/questions/41716830/object-required-error-when-looping-through-cells-in-selection", "title": "Object required error when looping through cells in selection", "body": "<p>I am looping through some cells, in a vertical selection, in Excel, and then passing that cell as a parameter to a procedure.</p>\n\n<p>I have done it this way, so I don't have the contents of ProcessCells twice, in the code, once for the while loop, and the second time in the For loop.</p>\n\n<p>If I try and get the value of the cell written out, in the for loop, it works.\nIf I put the contents of the ProcessCells procedure in the for loop, it also works.</p>\n\n<p>But if I try to pass it as a parameter, into ProcessCells, I am getting an error</p>\n\n<blockquote>\n  <p>'Object Required'</p>\n</blockquote>\n\n<p>Here is the code, if you want to check it out:</p>\n\n<pre><code>Sub loopThroughCells()\n\nDim c As Range\nDim autoSelect As String\nDim X, Y As Integer\n\nautoSelect = Cells(3, 2).Value\n\nIf StrComp(autoSelect, \"Y\") = 0 Then\n    Y = 5\n    X = 4\n    While Not IsEmpty(Cells(Y, X).Value)\n        ProcessCells (Cells(Y, X))\n        Y = Y + 1\n    Wend\nElse\n    For Each c In Selection\n        ProcessCells (c)\n    Next c\nEnd If\nEnd Sub\n\nSub ProcessCells(ce As Range)\nEnd Sub\n</code></pre>\n\n<p>How is </p>\n\n<blockquote>\n  <p>Cells(n,m)</p>\n</blockquote>\n\n<p>different from </p>\n\n<blockquote>\n  <p>c In Selection</p>\n</blockquote>\n\n<p>?</p>\n\n<p>The error happens in the For loop, but it doesn't happen in the while loop.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1484734957, "post_id": 41716693, "comment_id": 70628348, "body": "Try with writing full path of excel file in line: Set wb = objApp.Workbooks(&quot;Workbook1.xlsx&quot;). e.g. Set wb = objApp.Workbooks(&quot;D:\\my file\\Workbook1.xlsx&quot;)"}, {"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1484736394, "post_id": 41716693, "comment_id": 70629318, "body": "AFAIK, Using an Excel application object to access a work book needs your workbook to be closed, But I think you can access it using an OleDB connection string - HTH ;)."}, {"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1484757776, "post_id": 41716693, "comment_id": 70644316, "body": "Thanks, I have it working for an open workbook but it sometimes fails. I need the workbook to be open because i have formulas which to not otherwise load fast enough if i am opening-closing. I have tried a direct file reference too but i think if the excel instance does not contain the workbook, then even an explicit filepath reference will not work.."}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1484756554, "post_id": 41716951, "comment_id": 70643456, "body": "Hihi, Thanks for your input. I just tried this but i couldnt get it to work. I looked at the objApp object in the debugger, the workbook count is set to zero. Som though we specified a specific workbook, it did not find any workbook at all."}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1484757145, "post_id": 41716951, "comment_id": 70643882, "body": "Is the extension correct? E.g. is &quot;.xlsx&quot; correct or is it &quot;.xlsm&quot; or another variation?"}, {"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1484757357, "post_id": 41716951, "comment_id": 70644011, "body": "yes, the name is fine. Sometimes the macro works, and sometimes not... the error occurs, if at all, on the line where i reference the wb. the out of bounds error"}], "tags": [], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1484735386, "creation_date": 1484735386, "answer_id": 41716951, "question_id": 41716693, "link": "https://stackoverflow.com/questions/41716693/finding-a-workbook-in-one-of-multiple-excel-instances/41716951#41716951", "title": "Finding a workbook in one of multiple Excel instances", "body": "<p>I suspect that changing the file name to add in the full file path would work, so try changing the line:</p>\n\n<pre><code>Set wb = objApp.Workbooks(\"Workbook1.xlsx\")\n</code></pre>\n\n<p>To something like:</p>\n\n<pre><code>Set wb = objApp.Workbooks(\"C:\\Users\\Documents\\Workbook1.xlsx\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1484756586, "post_id": 41717327, "comment_id": 70643476, "body": "Hello, I tried using the line you gave to specify which instance objApp should be assigned to but I got the error: Automation error Invalid Syntax.                                                                                                            Set objApp = GetObject(&quot;FundRFQ.xlsx&quot;).Application"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1485163598, "post_id": 41717327, "comment_id": 70793391, "body": "@Freelancer : I&#39;ve decomposed the command line so that you know where is the error coming from. Let me know what it says! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1485163388, "last_edit_date": 1485163388, "creation_date": 1484736410, "answer_id": 41717327, "question_id": 41716693, "link": "https://stackoverflow.com/questions/41716693/finding-a-workbook-in-one-of-multiple-excel-instances/41717327#41717327", "title": "Finding a workbook in one of multiple Excel instances", "body": "<p>If you want to set the <code>objApp</code> to a particular instance of Excel,</p>\n\n<p>you can do so using the name of an open workbook in that instance:</p>\n\n<pre><code>Dim objApp As Excel.Application\nDim objWbk As Excel.Workbook\nDim wB As Excel.Workbook\nSet objWbk = GetObject(\"Workbook1.xlsx\")\nSet objApp = objWb.Application\nSet wB = objApp.Workbooks(\"Workbook1.xlsx\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 3, "last_activity_date": 1534271122, "last_edit_date": 1534271122, "creation_date": 1485155922, "answer_id": 41801050, "question_id": 41716693, "link": "https://stackoverflow.com/questions/41716693/finding-a-workbook-in-one-of-multiple-excel-instances/41801050#41801050", "title": "Finding a workbook in one of multiple Excel instances", "body": "<p>Try This </p>\n\n<hr>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim xlApp As Excel.Application\n    Dim Book As Workbook\n\n    Set xlApp = New Excel.Application\n    Set Book = xlApp.Workbooks.Open(Environ( _\n                        \"USERPROFILE\") &amp; \"\\Documents\\Temp\\Temp.xlsm\")\n\n    ' Do something\n\n    Set xlApp = Nothing\n    Set Book = Nothing\nEnd Sub\n</code></pre>\n\n<p>Or This which works for me.</p>\n\n<hr>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim xlApp As Excel.Application\n    Dim Book As Excel.Workbook\n    Dim Sht As Excel.Worksheet\n    Dim xlStarted As Boolean\n    Dim FilePath As String\n    Dim Cell As Range\n    Dim Rng As Range\n\n'   // File Path\n    FilePath = \"C:\\Temp\\Temp.xlsx\"\n    Debug.Print FilePath\n\n'   // If Error get Excel Application\n    On Error Resume Next\n    Set xlApp = GetObject(, \"Excel.Application\")\n\n    If Err &lt;&gt; 0 Then\n        Application.StatusBar = \"Please wait while Excel source is opened ... \"\n        Set xlApp = CreateObject(\"Excel.Application\")\n        xlStarted = True\n    End If\n    On Error GoTo 0\n\n'   // Open Workbook, Sheet1 to get data\n    Set Book = xlApp.Workbooks.Open(FilePath)\n    Set Sht = Book.Sheets(\"Sheet1\")\n\n'   // Set range variable\n    Set Rng = Sht.Range(\"A1\")\n\n    For Each Cell In Rng\n        Debug.Print Cell.Value\n    Next\n\n\n    '// Close &amp; SaveChanges\n    Book.Close SaveChanges:=True\n    If xlStarted Then\n        xlApp.Quit\n    End If\n\n    Set xlApp = Nothing\n    Set Book = Nothing\n    Set Sht = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1449, "favorite_count": 1, "accepted_answer_id": 41801050, "answer_count": 3, "score": 1, "last_activity_date": 1592700180, "creation_date": 1484734702, "last_edit_date": 1592700180, "question_id": 41716693, "link": "https://stackoverflow.com/questions/41716693/finding-a-workbook-in-one-of-multiple-excel-instances", "title": "Finding a workbook in one of multiple Excel instances", "body": "<p>I have a macro in Outlook VBA to grab data from an open Excel workbook (\"Workbook1\"). </p>\n\n<p>I reference the workbook as follows:</p>\n\n<pre><code>Dim objApp As Excel.Application\nSet objApp = GetObject(, \"Excel.Application\")\nSet wb = objApp.Workbooks(\"Workbook1.xlsx\")\n</code></pre>\n\n<p>I often get <strong>runtime error 9</strong>, that VBA cannot find the workbook.</p>\n\n<p>I think since I have more than one Excel instance open, <strong>VBA is looking for my workbook in the wrong instance</strong>.</p>\n\n<p>How do I <strong>reference my workbook when running more than one Excel instance</strong>?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1484734657, "post_id": 41716237, "comment_id": 70628146, "body": "I would rather use VBA Autofilter feature to filter my records, copy visible rows and paste them in other sheet. That will be more faster and will do the job with less lines of code."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1484734046, "last_edit_date": 1495539946, "creation_date": 1484734046, "answer_id": 41716483, "question_id": 41716237, "link": "https://stackoverflow.com/questions/41716237/how-to-find-multiple-strings-from-excel-and-copy-into-another-spreadsheet-using/41716483#41716483", "title": "How to find multiple strings from Excel and copy into another spreadsheet using VBA", "body": "<p>Here is a possible solution for your request:</p>\n\n<pre><code>   Dim LSearchRow As Integer\n   Dim LCopyToRow As Integer\n    dim lCounter        as long \n   On Error GoTo Err_Execute\n   LSearchRow = 4\n   LCopyToRow = 2\n\n    dim varValues(3)        as variant\n    varValues(0) = \"tran1\"\n    varValues(1) = \"tran2\"\n    varValues(2) = \"tran3\"\n\n   for lCounter = lbound(varValues) to ubound(varValues)\n\n       While Len(Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n            If InStr(1, Range(\"A\" &amp; CStr(LSearchRow)).Value, varValues(0)) &gt; 0 Then\n\n             'Select row in Sheet2 to copy\n             Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n             Selection.Copy\n\n             'Paste row into Sheet3 in next row\n             Sheet3.Select\n             Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n             ActiveSheet.Paste\n\n             'Move counter to next row\n             LCopyToRow = LCopyToRow + 1\n\n             'Go back to Sheet2 to continue searching\n             Sheet2.Select\n\n          End If\n          LSearchRow = LSearchRow + 1\n       Wend\n   next\n\n   'Position on cell A3\n   Application.CutCopyMode = False\n   Range(\"A3\").Select\n\n   MsgBox \"All matching data has been copied.\"\n\n   Exit Sub\nErr_Execute:\n   MsgBox \"An error occurred.\"\n</code></pre>\n\n<p><code>lCounter</code> and <code>varValues</code> are further declared. <code>varValues</code> gets 2 more values, <code>tran1</code>, <code>tran2</code> and <code>tran3</code>. Thus, I have created a for loop, that loops all over them. The logic in the While loop is left.</p>\n\n<p>In general, your code uses <code>Select</code>, which is a bad practise in VBA, but as far as it works it is ok. Here is how to avoid the selection - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a></p>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1484734062, "creation_date": 1484734062, "answer_id": 41716484, "question_id": 41716237, "link": "https://stackoverflow.com/questions/41716237/how-to-find-multiple-strings-from-excel-and-copy-into-another-spreadsheet-using/41716484#41716484", "title": "How to find multiple strings from Excel and copy into another spreadsheet using VBA", "body": "<p>A simple use of <code>And</code> in you <code>If</code> statement will do the trick!</p>\n\n<p>(I've tested the column B for \"app\", I'll let you tune it to the right column ;) )</p>\n\n<pre><code>    Dim LSearchRow As Integer\n    Dim LCopyToRow As Integer\n\n    On Error GoTo Err_Execute\n    LSearchRow = 4\n    LCopyToRow = 2\n\n    While Len(Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n         If InStr(1, Sheet2.Range(\"A\" &amp; CStr(LSearchRow)).Value, \"tran1\") &gt; 0 And _\n             InStr(1, Sheet2.Range(\"B\" &amp; CStr(LSearchRow)).Value, \"app\") &gt; 0 Then\n\n          'Select row in Sheet2 to copy\n          Sheet2.Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Copy\n\n          'Paste row into Sheet3 in next row\n          Sheet3.Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Paste\n\n          'Move counter to next row\n          LCopyToRow = LCopyToRow + 1\n       End If\n       LSearchRow = LSearchRow + 1\n    Wend\n\n    'Position on cell A3\n    Application.CutCopyMode = False\n    Sheet2.Range(\"A3\").Select\n\n    MsgBox \"All matching data has been copied.\"\n\n    Exit Sub\nErr_Execute:\n    MsgBox \"An error occurred.\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1484737659, "creation_date": 1484737659, "answer_id": 41717807, "question_id": 41716237, "link": "https://stackoverflow.com/questions/41716237/how-to-find-multiple-strings-from-excel-and-copy-into-another-spreadsheet-using/41717807#41717807", "title": "How to find multiple strings from Excel and copy into another spreadsheet using VBA", "body": "<p><code>AutoFilter()</code> gets things quite easy and short:</p>\n\n<pre><code>Sub Main()\n    With Sheets(\"Sheet2\") '&lt;--| reference \"data\" sheet\n        With .Range(\"C1\", .Cells(.Rows.count, \"A\").End(xlUp)) '&lt;--| reference its columns A:C range from row 1 (headers) down to column A last not empty row\n            .AutoFilter field:=1, Criteria1:=Array(\"tran1\", \"app\"), Operator:=xlFilterValues '&lt;--| filter referenced range on its 1st column (i.e. \"Name\") with \"tran\" and \"app\"\n            If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then .Resize(.Rows.count - 1).Offset(1).SpecialCells(xlCellTypeVisible).Copy Sheets(\"Sheet3\").Cells(2, 1) '&lt;--| if any filterd cells other than header then copy them and paste to Sheets(\"Sheet3\") from its row 2\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7407900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ed2045027121849a2aca05909f1761?s=128&d=identicon&r=PG&f=1", "display_name": "Naman", "link": "https://stackoverflow.com/users/7407900/naman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 761, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1484737659, "creation_date": 1484733394, "last_edit_date": 1484733704, "question_id": 41716237, "link": "https://stackoverflow.com/questions/41716237/how-to-find-multiple-strings-from-excel-and-copy-into-another-spreadsheet-using", "title": "How to find multiple strings from Excel and copy into another spreadsheet using VBA", "body": "<p>Example </p>\n\n<p>I have spreadsheet(Sheet2) like</p>\n\n<p><img src=\"https://i.stack.imgur.com/rz5zd.jpg\" alt=\"Spreadsheet\"></p>\n\n<p>I need to search \"Tran1\" and \"app\" full row data from my excel-sheet and after searching the record I need to copy the rows into Sheet3.</p>\n\n<p>Currently I am able to do it only for 1 record \"Tran1\" but i need to do it with multiple values.</p>\n\n<p>Here is my code snippet:</p>\n\n<pre><code>   Dim LSearchRow As Integer\n   Dim LCopyToRow As Integer\n\n   On Error GoTo Err_Execute\n   LSearchRow = 4\n   LCopyToRow = 2\n\n   While Len(Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n        If InStr(1, Range(\"A\" &amp; CStr(LSearchRow)).Value, \"tran1\") &gt; 0 Then\n\n         'Select row in Sheet2 to copy\n         Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n         Selection.Copy\n\n         'Paste row into Sheet3 in next row\n         Sheet3.Select\n         Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n         ActiveSheet.Paste\n\n         'Move counter to next row\n         LCopyToRow = LCopyToRow + 1\n\n         'Go back to Sheet2 to continue searching\n         Sheet2.Select\n\n      End If\n      LSearchRow = LSearchRow + 1\n   Wend\n\n   'Position on cell A3\n   Application.CutCopyMode = False\n   Range(\"A3\").Select\n\n   MsgBox \"All matching data has been copied.\"\n\n   Exit Sub\nErr_Execute:\n   MsgBox \"An error occurred.\"\n</code></pre>\n\n<p>Can anyone let me tell how to do with multiple search.?</p>\n"}, {"tags": ["ms-access", "random", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1484747066, "post_id": 41715782, "comment_id": 70636623, "body": "There are 100,000 five-digit numeric sequences from <code>00000</code> to <code>99999</code>. If you generate them using random numbers you have no guarantee of uniqueness."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1484743151, "creation_date": 1484743151, "answer_id": 41719675, "question_id": 41715782, "link": "https://stackoverflow.com/questions/41715782/how-do-i-create-a-unique-random-numeric-string-in-vba-code-for-ms-access/41719675#41719675", "title": "How do I create a unique random numeric string in VBA code for MS Access", "body": "<p>You can use:</p>\n\n<pre><code>Dim Number As Long\n\nRandomize\nNumber = Int(Rnd * 10 ^ 5)\n</code></pre>\n\n<p>To have leading zeroes and a string</p>\n\n<pre><code>Dim Number As Long\n\nRandomize\nNumber = Format(Int(Rnd * 10 ^ 5), \"00000\")\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6634980, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2LgwW.jpg?s=128&g=1", "display_name": "Thabang Ronin", "link": "https://stackoverflow.com/users/6634980/thabang-ronin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 682, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594640638, "creation_date": 1484732097, "last_edit_date": 1594640638, "question_id": 41715782, "link": "https://stackoverflow.com/questions/41715782/how-do-i-create-a-unique-random-numeric-string-in-vba-code-for-ms-access", "title": "How do I create a unique random numeric string in VBA code for MS Access", "body": "<p>There are some solutions to the predicament I have now but non ive found so far are sufficient to how I want to apply it.\nI am creating an application that should have the unique random NUMERIC string concatenated into a Reference number. Here is one of the solutions I found:</p>\n\n<pre><code>Sub test()\n\nDim s As String * 8 'fixed length string with 8 characters\nDim n As Integer\nDim ch As Integer 'the character\nFor n = 1 To Len(s) 'don't hardcode the length twice\n    Do\n        ch = Rnd() * 127 'This could be more efficient.\n        '48 is '0', 57 is '9', 65 is 'A', 90 is 'Z', 97 is 'a', 122 is 'z'.\n    Loop While ch &lt; 48 Or ch &gt; 57 And ch &lt; 65 Or ch &gt; 90 And ch &lt; 97 Or ch &gt; 122\n    Mid(s, n, 1) = Chr(ch) 'bit more efficient than concatenation\nNext\n\nDebug.Print s\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Unfortunately it just creates one string and it is an alphabetic one. Im having difficulty converting VB.net code to VBA and thus I need to get a MS Access VBA solution that creates a unique numeric string of 5 characters every time the procedure is run.</p>\n"}, {"tags": ["database", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 3413386, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/32518dd6e56b2ef5b9291dbfea43ec1d?s=128&d=identicon&r=PG&f=1", "display_name": "ezybusy", "link": "https://stackoverflow.com/users/3413386/ezybusy"}, "edited": false, "score": 0, "creation_date": 1484734351, "post_id": 41716107, "comment_id": 70627967, "body": "Thanks Seb, but your suggestion isn&#39;t actually going to work for me. Actually I want to deliver a demo application, so I want to add an expiration date on the only login account stored in TblLogin. The logic I want to used is the following : we auto record the first login date in the TblLogin the first time we login into the db application (done). The loginName used has a maximum of 7 days to use the db application, after that 7 days grace period the system should display a warning message and exit access when we try to use that login Name to access the db application."}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 29, "user_id": 3413386, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/32518dd6e56b2ef5b9291dbfea43ec1d?s=128&d=identicon&r=PG&f=1", "display_name": "ezybusy", "link": "https://stackoverflow.com/users/3413386/ezybusy"}, "edited": false, "score": 0, "creation_date": 1484736148, "post_id": 41716107, "comment_id": 70629152, "body": "Ok I see, well in this case you could try using <code>DoCmd.GotoRecord</code> or <code>DoCmd.FindRecord</code> to get its value and then compare it. OR if make it a form, you can use <code>DLookup</code> to return the value (really easy since there is only one record) and then again. I hope this will solve your problem"}], "tags": [], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "is_accepted": false, "score": 1, "last_activity_date": 1484733031, "creation_date": 1484733031, "answer_id": 41716107, "question_id": 41715405, "link": "https://stackoverflow.com/questions/41715405/how-to-compare-todays-date-and-date-stored-in-table/41716107#41716107", "title": "How to Compare today&#39;s date and date stored in table", "body": "<p>Use <strong>conditional formatting</strong> on a form to do this. I had the same kind of task to do and this is the way I solved it.</p>\n\n<ol>\n<li>Create a datasheet/tabular form from your table.</li>\n<li>Go in Design View of your form</li>\n<li>Select your field (here <em>firstlogindate</em>)</li>\n<li>Click conditional formatting</li>\n<li>Add a new rule using DateDiff(\"d\",[firstlogindate],Date()) and apply the formatting you want.</li>\n</ol>\n\n<p>This method allows you to spot the records with more than 7 days difference by <strong>highlighting</strong> them, it won't display a MsgBox though.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 3413386, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/32518dd6e56b2ef5b9291dbfea43ec1d?s=128&d=identicon&r=PG&f=1", "display_name": "ezybusy", "link": "https://stackoverflow.com/users/3413386/ezybusy"}, "edited": false, "score": 0, "creation_date": 1484745429, "post_id": 41717557, "comment_id": 70635451, "body": "Thank you very much Gustav. Works like a charm."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1484737007, "creation_date": 1484737007, "answer_id": 41717557, "question_id": 41715405, "link": "https://stackoverflow.com/questions/41715405/how-to-compare-todays-date-and-date-stored-in-table/41717557#41717557", "title": "How to Compare today&#39;s date and date stored in table", "body": "<p>You can do:</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n\n    If DateDiff(\"d\", DLookup(\"[FirstLoginDate]\", \"TblLogin\", \"[LoginName] ='test'\"), Date) &gt; 7 Then\n        MsgBox \"You are late.\", vbInformation + vbOkOnly, \"Loging Date\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3413386, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/32518dd6e56b2ef5b9291dbfea43ec1d?s=128&d=identicon&r=PG&f=1", "display_name": "ezybusy", "link": "https://stackoverflow.com/users/3413386/ezybusy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 41717557, "answer_count": 2, "score": 1, "last_activity_date": 1484737007, "creation_date": 1484731082, "last_edit_date": 1484732328, "question_id": 41715405, "link": "https://stackoverflow.com/questions/41715405/how-to-compare-todays-date-and-date-stored-in-table", "title": "How to Compare today&#39;s date and date stored in table", "body": "<p>I have a table called TblLogin with 3 columns and only one record:</p>\n\n<pre><code>LoginID  LoginName  firstlogindate\n-----------     ------------------   ---------------------\n   1       test       10-Jan-17\n</code></pre>\n\n<p>Now i want to display a message If today's date is greater than the [date stored in column firstlogindate + 7 days].</p>\n\n<p>I used the <code>DATEADD</code> function of MS Access in the following code to add 7 days on the date recorded in the column firstlogindate. </p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\nDim DateAddition As String\nDateAddition = \"SELECT DateAdd('d',7,[FirstLoginDate]) \" &amp; _\n        \"FROM TblLogin \" &amp; _\n        \"where TblLogin.[LoginName] ='test';\"\nEnd Sub\n</code></pre>\n\n<p>But i have no clue as to how to perform the checking to find out wether today's date is greater than <code>[firstlogindate+7days]</code>.</p>\n\n<p>Please Can someone help me out? \nOr is there a better way to achieve the above?</p>\n"}, {"tags": ["vba", "excel", "for-loop", "sum"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 2375460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9175f21d119357feb4e838b404de72?s=128&d=identicon&r=PG", "display_name": "andhisbrother", "link": "https://stackoverflow.com/users/2375460/andhisbrother"}, "edited": false, "score": 0, "creation_date": 1484732558, "post_id": 41715474, "comment_id": 70626696, "body": "Thank you for the answer @shai. Not yet working though. It gets stuck on this line: <code>SumSht.Range(&quot;A&quot; &amp; i).Value = WorksheetFunction.Sum(Workbooks(&quot;wb&quot;).Worksheets(&quot;Analysis&quot;)&zwnj;&#8203;.Range(&quot;M:M&quot;))</code>  I guess that the <i>wb</i> is not implemented correctly. WorksheetFunction.Sum worked fine without <i>Workbooks(&quot;wb&quot;)</i>"}, {"owner": {"reputation": 23, "user_id": 2375460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9175f21d119357feb4e838b404de72?s=128&d=identicon&r=PG", "display_name": "andhisbrother", "link": "https://stackoverflow.com/users/2375460/andhisbrother"}, "edited": false, "score": 0, "creation_date": 1484735457, "post_id": 41715474, "comment_id": 70628662, "body": "Works as well. Thank you!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23, "user_id": 2375460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9175f21d119357feb4e838b404de72?s=128&d=identicon&r=PG", "display_name": "andhisbrother", "link": "https://stackoverflow.com/users/2375460/andhisbrother"}, "edited": false, "score": 0, "creation_date": 1484847979, "post_id": 41715474, "comment_id": 70689269, "body": "@andhisbrother  why did u remove the answer ? You can also upvote u know ?"}, {"owner": {"reputation": 23, "user_id": 2375460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9175f21d119357feb4e838b404de72?s=128&d=identicon&r=PG", "display_name": "andhisbrother", "link": "https://stackoverflow.com/users/2375460/andhisbrother"}, "edited": false, "score": 0, "creation_date": 1484863797, "post_id": 41715474, "comment_id": 70697790, "body": "I can only mark one answer as the one that solved the problem. and the R3uK was faster with the final solution by a minute maybe. I&#39;ve upvoted now so maybe you get some points, but it won&#39;t show publicly, because I don&#39;t have enough points they say."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1484732613, "last_edit_date": 1484732613, "creation_date": 1484731286, "answer_id": 41715474, "question_id": 41715284, "link": "https://stackoverflow.com/questions/41715284/summing-column-excel-vba-multiple-external-files-iteration/41715474#41715474", "title": "summing column excel vba multiple external files iteration", "body": "<p>You need to add the code below to the Loop where you are calculating the Sum from Column M (you need to raise <code>i</code> by 1 to raise the row index by 1).</p>\n\n<p>The code below is without <code>Activate</code>, <code>Select</code> and <code>ActiveCell</code>, but uses qualified <code>Range</code>s and <code>Worksheets</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Dim SumSht  As Worksheet\nDim i As Long\n\nSet SumSht = Workbooks(\"Book1.xlsx\").Sheets(\"Sheet1\")\ni = 1\n\n' loop here every time to raise the row index (of i)\nSumSht.Range(\"A\" &amp; i).Value = WorksheetFunction.Sum(wb.Worksheets(\"Analysis\").Range(\"M:M\"))\ni = i + 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1484731477, "creation_date": 1484731477, "answer_id": 41715548, "question_id": 41715284, "link": "https://stackoverflow.com/questions/41715284/summing-column-excel-vba-multiple-external-files-iteration/41715548#41715548", "title": "summing column excel vba multiple external files iteration", "body": "<p>Here is how you show use your <code>wB</code> reference to the opened workbook :</p>\n\n<pre><code>Sub refresh_OGSC_data_files()\nApplication.ScreenUpdating = False\n\n    Dim wB As Workbook\n    Dim SumResult As Double\n    Dim OutPutRange As Range\n\n    Set FileSystemObj = CreateObject(\"Scripting.FileSystemObject\")\n    Set FolderObj = FileSystemObj.GetFolder(\"C:\\ARBEIT\\Projects\\ONEGSC impact     simulation\\Part 2\\Data\\EE\")\n    Set OutPutRange = Workbooks(\"Book1.xlsx\").Sheets(\"Sheet1\").Range(\"A3\")\n\n    For Each fileobj In FolderObj.Files\n\n        Set wB = Workbooks.Open(fileobj.Path)\n\n        wB.Sheets(\"AUX\").Range(\"B2\") = \"12\"\n        Application.Run \"XL3RefreshGrid\", \"Analysis!A13\"\n\n        SumResult = WorksheetFunction.Sum(wB.Sheets(\"Analysis\").Range(\"M:M\"))\n        OutPutRange.Value = SumResult\n        Set OutPutRange = OutPutRange.Offset(1, 0)\n        TotalSum = TotalSum + SumResult\n\n        wB.Save\n        wB.Close\n    Next fileobj\n\n    Workbooks(\"Book1.xlsx\").Sheets(\"Sheet1\").Range(\"A1\").Value = TotalSum\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 2375460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9175f21d119357feb4e838b404de72?s=128&d=identicon&r=PG", "display_name": "andhisbrother", "link": "https://stackoverflow.com/users/2375460/andhisbrother"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 0, "accepted_answer_id": 41715548, "answer_count": 2, "score": 2, "last_activity_date": 1484732786, "creation_date": 1484730742, "last_edit_date": 1484732786, "question_id": 41715284, "link": "https://stackoverflow.com/questions/41715284/summing-column-excel-vba-multiple-external-files-iteration", "title": "summing column excel vba multiple external files iteration", "body": "<p>I have a VBA code that I use for refreshing all the Excel data files (worksheet <em>Analysis</em> in each file) in a specified folder (refreshing is done via XL3 add-in in Excel). It works perfectly.</p>\n\n<pre><code>Sub refresh_OGSC_data_files()\n\nApplication.ScreenUpdating = False\n\nDim wb As Workbook\n\nSet FileSystemObj = CreateObject(\"Scripting.FileSystemObject\")\nSet FolderObj = FileSystemObj.GetFolder(\"C:\\ARBEIT\\Projects\\ONEGSC impact     simulation\\Part 2\\Data\\EE\")\n\nFor Each fileobj In FolderObj.Files\n    Set wb = Workbooks.Open(fileobj.Path)\n\n    ActiveWorkbook.Sheets(\"AUX\").Range(\"B2\") = \"12\"\n    Application.Run \"XL3RefreshGrid\", \"Analysis!A13\"\n\n    ActiveWorkbook.Save\n    ActiveWorkbook.Close\nNext fileobj\n\nEnd Sub\n</code></pre>\n\n<p><strong>What I'm trying to add into it, is a funcionality, which would sum column M in each of these files and \"record\" this value into a cell in external workbook -  e.g. Book1, Sheet1, Cell A1.</strong> (For second refreshed file it would be cell A2. for third file cell A3, and so on, until the last file)</p>\n\n<p>I was trying to insert this into the same code (before saving the refreshed file: <em>ActiveWorkbook.Save</em>):</p>\n\n<pre><code>Workbooks(\"Book1.xlsx\").Sheets(\"Sheet1\").Activate\nWorkbooks(\"Book1.xlsx\").Sheets(\"Sheet1\").Range(\"A1\").Select\nActiveCell = WorksheetFunction.Sum(Workbooks(\"wb\").Worksheets(\"Analysis\").Range(\"m:m\"))\nActiveCell.Offset(1, 0).Range(\"A1\").Select\n</code></pre>\n\n<p>However it doesn't work and is probably completely wrong. Please help.</p>\n\n<p>If anything is unclear I will try to elaborate.</p>\n"}, {"tags": ["vba", "excel", "api", "xmlhttprequest"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1484731682, "post_id": 41714769, "comment_id": 70626042, "body": "Do you define &quot;grant_type&quot; ?"}, {"owner": {"reputation": 101, "user_id": 7046688, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5d7cf16b9321d6a77f08cf9baa5e136?s=128&d=identicon&r=PG&f=1", "display_name": "Tan Stanley", "link": "https://stackoverflow.com/users/7046688/tan-stanley"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1484732377, "post_id": 41714769, "comment_id": 70626571, "body": "you mean in my code or backend? i have directly input the grant type into my code."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1484733601, "post_id": 41714769, "comment_id": 70627464, "body": "I just saw user and password defined but no grant_type, sorry if I misunderstood."}, {"owner": {"reputation": 101, "user_id": 7046688, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5d7cf16b9321d6a77f08cf9baa5e136?s=128&d=identicon&r=PG&f=1", "display_name": "Tan Stanley", "link": "https://stackoverflow.com/users/7046688/tan-stanley"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1484734316, "post_id": 41714769, "comment_id": 70627945, "body": "the grand_type is password, and i placed it in the code. apparently the code is working, i borrowed another user account to try. Will approach the administrator regarding user rights. Thank you though @Solar Mike"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10102194, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gfrFfItkJlU/AAAAAAAAAAI/AAAAAAAACek/4V4Ttb9dBTk/photo.jpg?sz=128", "display_name": "Thiago Bento", "link": "https://stackoverflow.com/users/10102194/thiago-bento"}, "is_accepted": false, "score": 0, "last_activity_date": 1540308226, "creation_date": 1540308226, "answer_id": 52952664, "question_id": 41714769, "link": "https://stackoverflow.com/questions/41714769/error-unsupported-grant-type/52952664#52952664", "title": "Error Unsupported Grant Type", "body": "<p>Try:</p>\n\n<p>Headers:\n- Content-Type: application/x-www-form-urlencoded\n- Accept-Charset: UTF-8\n- Authorization: [Your Authorization Code]</p>\n\n<p>Body:\nusername=[username]&amp;password=[password]&amp;grant_type=password</p>\n"}], "owner": {"reputation": 101, "user_id": 7046688, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5d7cf16b9321d6a77f08cf9baa5e136?s=128&d=identicon&r=PG&f=1", "display_name": "Tan Stanley", "link": "https://stackoverflow.com/users/7046688/tan-stanley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 648, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540308226, "creation_date": 1484729040, "last_edit_date": 1531164843, "question_id": 41714769, "link": "https://stackoverflow.com/questions/41714769/error-unsupported-grant-type", "title": "Error Unsupported Grant Type", "body": "<p>I am trying to connect to an API, using MS Excel VBA. The parameters needed for login are grant type, username, and password.</p>\n\n<p>I have came up with the code below, however i am getting the error :</p>\n\n<blockquote>\n  <p>{\"error\":\"unsupported_grant_type\"}</p>\n</blockquote>\n\n<p>Can anyone enlighten me where i am doing it wrongly? </p>\n\n<pre><code>Sub test()\n\nDim objHttp As Object\nDim json As String\nDim user, password As String\n\nuser = \"user1\"\npassword = \"password1\"\njson = \"{\"\"grant_type\"\":\"\"password\"\",\"\"username\"\":\"\"\" &amp; user &amp; \"\"\",\"\"password\"\":\"\"\" &amp; password &amp; \"\"\"}\"\n\nMsgBox json\n\nDim result As String\n\nSet objHttp = CreateObject(\"MSXML2.XMLHTTP\")\nurl = \"http://dummywebsite.com\"\nobjHttp.Open \"POST\", url, False\n\nobjHttp.SetRequestHeader \"Content-type\", \"application/json\"\nobjHttp.Send (json)\nresult = objHttp.ResponseText\n\nMsgBox result\n\nEnd Sub\n</code></pre>\n\n<p>The code is actually working, and it is due to user rights after testing with another user account. </p>\n"}, {"tags": ["vba", "ms-access", "report", "expression", "conditional-formatting"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1484728712, "post_id": 41714288, "comment_id": 70624187, "body": "AFAIK, you cannot make conditional formatting on rows, only on individual controls, so you will have to repeat the same process on each control you want the conditional formatting to apply."}, {"owner": {"reputation": 21, "user_id": 2393306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YP0wf.gif?s=128&g=1", "display_name": "linnah", "link": "https://stackoverflow.com/users/2393306/linnah"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1484728916, "post_id": 41714288, "comment_id": 70624319, "body": "According to Microsoft, you can: <a href=\"https://msdn.microsoft.com/en-us/library/office/gg508986(v=office.14).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a> However on my DB I can&#39;t get any expression to work - even if it is for a single field."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1484729358, "post_id": 41714288, "comment_id": 70624602, "body": "yes, you&#39;re right. I was testing on a database where one of the fields cannot be formated."}, {"owner": {"reputation": 21, "user_id": 2393306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YP0wf.gif?s=128&g=1", "display_name": "linnah", "link": "https://stackoverflow.com/users/2393306/linnah"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1484730631, "post_id": 41714288, "comment_id": 70625363, "body": "in what cases does that happen, i.e. a field cannot be formatted?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1484733619, "post_id": 41714288, "comment_id": 70627480, "body": "I used an old database with an OLE object."}, {"owner": {"reputation": 21, "user_id": 2393306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YP0wf.gif?s=128&g=1", "display_name": "linnah", "link": "https://stackoverflow.com/users/2393306/linnah"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1484738484, "post_id": 41714288, "comment_id": 70630729, "body": "Solved the problem by changing the system locale on my workstation to Bulgarian which is apparently a necessity when some of your DB objects have names in Bulgarian (Cyrillic)..."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 2393306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YP0wf.gif?s=128&g=1", "display_name": "linnah", "link": "https://stackoverflow.com/users/2393306/linnah"}, "is_accepted": false, "score": 0, "last_activity_date": 1484738530, "creation_date": 1484738530, "answer_id": 41718130, "question_id": 41714288, "link": "https://stackoverflow.com/questions/41714288/conditional-formatting-in-access-wont-work-using-expression/41718130#41718130", "title": "Conditional formatting in Access won&#39;t work using Expression", "body": "<p>Solved the problem by changing the system locale on my workstation to Bulgarian which is apparently a necessity when some of your DB objects have names in Bulgarian (Cyrillic)...</p>\n"}], "owner": {"reputation": 21, "user_id": 2393306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YP0wf.gif?s=128&g=1", "display_name": "linnah", "link": "https://stackoverflow.com/users/2393306/linnah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593956833, "creation_date": 1484727273, "last_edit_date": 1593956833, "question_id": 41714288, "link": "https://stackoverflow.com/questions/41714288/conditional-formatting-in-access-wont-work-using-expression", "title": "Conditional formatting in Access won&#39;t work using Expression", "body": "<p>I have a report based on a query which is a simple select statement. I am trying to create conditional formatting so that if <code>(Date()-[Datefield]) &gt;= 5</code>, the entire row will be highlighted in red.</p>\n\n<p>I am doing it using the Gui as I'm not that familiar with VBA. I am following the documentation to the letter but nothing happens when I apply the rule.</p>\n\n<p>The only way I managed to get conditional formatting to work was on cell level using the \"Field Value is\" option. </p>\n\n<p>If I try using an expression on a single field <code>(IsNull([Telephone])</code>, nothing happens. I've tried deleting both the query and the report and also re-installing MS Office but nothing changes. </p>\n\n<p>Any ideas what could be wrong? It sort of worked at some point yesterday and then stopped but since then I've tried reinstalling Office and also creating a new DB from scratch. Nothing seems to make any difference.</p>\n\n<p>I'm willing to try configuring it via VBA so I can at least debug it but I'd need somewhere to start...</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "edited": false, "score": 0, "creation_date": 1484726940, "post_id": 41714007, "comment_id": 70623130, "body": "It works. Didn&#39;t even know that was possible with excel formula. Thank you."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1484726263, "creation_date": 1484726263, "answer_id": 41714007, "question_id": 41713772, "link": "https://stackoverflow.com/questions/41713772/vba-function-that-concatenates-only-visible-cells/41714007#41714007", "title": "vba: Function that concatenates only visible cells", "body": "<p>I'm using a different sheet name, but this works for me:</p>\n\n<pre><code>=IF(AND(SUBTOTAL(103,Sheet2!I4),OR(ISNUMBER(SEARCH({\"DA\",\"NU\"},Sheet2!I4)))),\n    CONCATENATE(Sheet2!B4,\"\"),\n    \"\")\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 41714007, "answer_count": 1, "score": 0, "last_activity_date": 1484726263, "creation_date": 1484725271, "last_edit_date": 1484725615, "question_id": 41713772, "link": "https://stackoverflow.com/questions/41713772/vba-function-that-concatenates-only-visible-cells", "title": "vba: Function that concatenates only visible cells", "body": "<p>I have an excel formula:</p>\n\n<pre><code>=IF(OR(ISNUMBER(SEARCH({\"DA\",\"NU\"},'- - REZULTAT ANAF - -'!I4))),CONCATENATE('- - REZULTAT ANAF - -'!B4,\"\"),\"\")\n</code></pre>\n\n<p>and it goes down to row 17000.</p>\n\n<p>It concatenates cell B4 from sheet - - REZULTAT ANAF - -' to another sheet if I4 from sheet - - REZULTAT ANAF - -' =\"DA\" or \"NU\".</p>\n\n<p><strong>I need a function that will do the same thing BUT it also determines if cell is visible (filtered) and concatenate only if it is visible (not filtered out).</strong> (i managed to do this with a range but i need to do it cell by cell)</p>\n\n<p>I could do the same thing by making it do: autofilter on the whole table and then just copy the whole results on the other sheet but being a table of 17000 full of formulas and macros that slows the excel alot.</p>\n"}, {"tags": ["vba", "excel", "intersect"], "comments": [{"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 1, "creation_date": 1484726734, "post_id": 41713675, "comment_id": 70623022, "body": "Looks like &quot;another ActiveSheet problem&quot;, if you try to intersect two or more ranges from a different worksheets - here&#39;s your error. Try to get rid of <code>ActiveSheet</code> if possible. BTW, I think problem occured when fresh copy of sheet became ActiveSheet. From this point you can try to compare <code>if ActiveSheet is Target.Worksheet</code> and if not - just <code>Target.Worksheet.Activate</code> (don&#39;t do this)."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484727275, "post_id": 41713675, "comment_id": 70623329, "body": "where do you put your <code>Private Sub Worksheet_Change(ByVal Target As Range)</code> sub?"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1484728632, "creation_date": 1484728632, "answer_id": 41714669, "question_id": 41713675, "link": "https://stackoverflow.com/questions/41713675/method-intersect-of-object-global-failed-inside-a-sheets-module-actives/41714669#41714669", "title": "Method &#39;Intersect&#39; of object &#39;_Global&#39; failed inside a Sheet&#39;s module -- ActiveSheet not recognised", "body": "<p>You can't use <code>ActiveSheet</code> inside of a Sheet's module, you have to reference that Sheet with <code>Me</code> (like you would do in a UserForm) :</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'Stamp Date\n    Dim WorkRng As Range\n    Dim Rng As Range\n\n    Set WorkRng = Intersect(Me.Range(\"B:B\"), Target)\n\n    If Not WorkRng Is Nothing Then\n        Application.EnableEvents = False\n        For Each Rng In WorkRng\n            If Not VBA.IsEmpty(Rng.Value) Then\n                If Rng.Offset(-1, 0).Value = \"Start\" Then\n                    Rng.Offset(0, 1).Value = Rng.Offset(-1, 1)\n                    Else: Rng.Offset(0, 1).Value = Now\n                    Rng.Offset(0, 1).NumberFormat = \"H:MM AM/PM\"\n                End If\n            Else\n                Rng.Offset(0, 1).ClearContents\n            End If\n        Next\n        Application.EnableEvents = True\n    End If\n\n    'Time Format\n    If Target.Cells.Count &gt; 1 Or Target.HasFormula Then GoTo errHandler\n\n    On Error Resume Next\n        If Not Intersect(Target, Me.Range(\"C3:C33\")) Is Nothing Then\n            Application.EnableEvents = False\n            Target.NumberFormat = \"H:MM AM/PM\"\n            Application.EnableEvents = True\n        End If\n    On Error GoTo errHandler\n\n    If WorkRng.Offset(0, 1) &gt; 0 Then\n        WorkRng.Offset(1, 0).Select\n    End If\nExit Sub\n\nerrHandler\n    Me.ActiveCell.Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 3193160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/GrsLp.jpg?s=128&g=1", "display_name": "kitarika", "link": "https://stackoverflow.com/users/3193160/kitarika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 463, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484728683, "creation_date": 1484724841, "last_edit_date": 1484728683, "question_id": 41713675, "link": "https://stackoverflow.com/questions/41713675/method-intersect-of-object-global-failed-inside-a-sheets-module-actives", "title": "Method &#39;Intersect&#39; of object &#39;_Global&#39; failed inside a Sheet&#39;s module -- ActiveSheet not recognised", "body": "<p>I currently use a self made spreadsheet to clock my day. Every time I insert a new activity, it should calculate the time taken me on the last activity.</p>\n\n<p>It works fine as is when I create a new spreadsheet everyday, however now I'm thinking to consolidate the spreadsheet into a monthly file.</p>\n\n<p>I have a macro button on the same spreadsheet that refreshes my pivot table which summarizes my tasks.</p>\n\n<p>Unfortunately, once I make a copy of the worksheet and tries to refresh the pivot table, it gives me an error message: <code>Method 'Intersect' of object '_Global' failed</code></p>\n\n<p>My current coding is as follows:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n'Stamp Date\n\nDim WorkRng As Range\nDim Rng As Range\n\nSet WorkRng = Intersect(ActiveSheet.Range(\"B:B\"), Target)\n\nIf Not WorkRng Is Nothing Then\n    Application.EnableEvents = False\n    For Each Rng In WorkRng\n        If Not VBA.IsEmpty(Rng.Value) Then\n            If Rng.Offset(-1, 0).Value = \"Start\" Then\n                Rng.Offset(0, 1).Value = Rng.Offset(-1, 1)\n                Else: Rng.Offset(0, 1).Value = Now\n                Rng.Offset(0, 1).NumberFormat = \"h:mm AM/PM\"\n            End If\n        Else\n            Rng.Offset(0, 1).ClearContents\n        End If\n    Next\n    Application.EnableEvents = True\nEnd If\n\n'Time Format\n\nIf Target.Cells.Count &gt; 1 Or Target.HasFormula Then GoTo errHandler\n    On Error Resume Next\n        If Not Intersect(Target, Range(\"C3:C33\")) Is Nothing Then\n            Application.EnableEvents = False\n            Target.NumberFormat = \"H:MM AM/PM\"\n            Application.EnableEvents = True\n        End If\n\nOn Error GoTo errHandler\n\n    If WorkRng.Offset(0, 1) &gt; 0 Then\n        WorkRng.Offset(1, 0).Select\n    End If\nExit Sub\n\nerrHandler:     ActiveCell.Select\n\nEnd Sub\n</code></pre>\n\n<p>The debug highlights: <code>Set WorkRng = Intersect(ActiveSheet.Range(\"B:B\"), Target)</code></p>\n\n<p>Being a beginner at VBA, these codes are mostly copied from different places. As a result, I don't even know what went wrong. Any assistance would be very greatly appreciated!</p>\n"}, {"tags": ["excel", "sorting", "vba"], "answers": [{"comments": [{"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484739735, "post_id": 41715275, "comment_id": 70631540, "body": "<code>lastRow</code> is 17 (data begins at 14) and<code>Col</code> is 10 (when selecting column J)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484740269, "post_id": 41715275, "comment_id": 70631889, "body": "Then what do you expect from this thing here <code>Range(Col &amp; &quot;14:&quot; &amp; Col &amp; lastRow)</code> E.g., if you go to the immediate window and you write <code>?Col &amp; &quot;14:&quot; &amp; Col &amp; lastRow</code> what should it give you? I suppose that you have somewhere <code>On Error Resume Next</code>?"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484740514, "post_id": 41715275, "comment_id": 70632070, "body": "<code>On Error Resume Next</code> has been removed, but still the issue is present. from the <code>Range(...)</code> I expect to act as <code>Range(&quot;J14:J17&quot;)</code>"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484740932, "post_id": 41715275, "comment_id": 70632376, "body": "Writing what you asked in the immediate window returns <code>1014:1017</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484741014, "post_id": 41715275, "comment_id": 70632427, "body": "Then I suppose you can start fixing your error yourself. You should find a way to parse <code>Range(Col &amp; &quot;14:&quot; &amp; Col &amp; lastRow)</code> to <code>Range(&quot;J14:J17&quot;)</code>. Here is how to start - <a href=\"http://stackoverflow.com/questions/12199318/vba-selecting-range-by-variables\" title=\"vba selecting range by variables\">stackoverflow.com/questions/12199318/&hellip;</a>"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1484741689, "post_id": 41715275, "comment_id": 70632843, "body": "<code>Range(&quot;A14:CE&quot; &amp; lastRow).Sort key1:=Range(Cells(14, Col), Cells(lastRow, Col)), Order1:=xlAscending, Header:=xlNo, key2:=Range(&quot;C14:C&quot; &amp; lastRow), Order2:=xlAscending, Header:=xlNo</code> indeed solved the issue"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1484730704, "creation_date": 1484730704, "answer_id": 41715275, "question_id": 41713183, "link": "https://stackoverflow.com/questions/41713183/sorting-with-vba-giving-wrong-result/41715275#41715275", "title": "Sorting with VBA giving wrong result", "body": "<p>Excel's sort works quite well, e.g. select a range and run the following:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Selection.Sort key1:=Selection, Order1:=xlDescending\n\nEnd Sub\n</code></pre>\n\n<p>In your code, you should check the variables, that define the range. E.g. <code>lastRow</code> and <code>Col</code>. Write something like this on the top of the code:</p>\n\n<pre><code>debug.print lastRow\ndebug.print Col\n</code></pre>\n"}], "owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 41715275, "answer_count": 1, "score": 1, "last_activity_date": 1484743741, "creation_date": 1484722860, "last_edit_date": 1592644375, "question_id": 41713183, "link": "https://stackoverflow.com/questions/41713183/sorting-with-vba-giving-wrong-result", "title": "Sorting with VBA giving wrong result", "body": "<p>I have this code to sort an Excel sheet</p>\n<pre><code>'for the ascending order\nRange(&quot;A14:CB&quot; &amp; lastRow).Sort key1:=Range(Col &amp; &quot;14:&quot; &amp; Col &amp; lastRow), Order1:=xlAscending, Header:=xlNo, key2:=Range(&quot;C14:C&quot; &amp; lastRow), Order2:=xlAscending, Header:=xlNo\n'for the descending order\nRange(&quot;A14:CB&quot; &amp; lastRow).Sort key1:=Range(Col &amp; &quot;14:&quot; &amp; Col &amp; lastRow), Order1:=xlDescending, Header:=xlNo, key2:=Range(&quot;C14:C&quot; &amp; lastRow), Order2:=xlAscending, Header:=xlNo\n</code></pre>\n<p>This is what I get when I do ascending sort on <code>Col=J</code></p>\n<p><a href=\"https://i.stack.imgur.com/fLdZN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fLdZN.png\" alt=\"enter image description here\" /></a></p>\n<p>and this is what I get when I do descending sort on <code>Col=J</code></p>\n<p><a href=\"https://i.stack.imgur.com/Smky9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Smky9.png\" alt=\"enter image description here\" /></a></p>\n<p>Both are obviously wrong. Is there any error I am not seeing in the VBA code?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1484718379, "post_id": 41712108, "comment_id": 70619472, "body": "You need to be more precise. Post a minimal and complete problem statement and code you tried. Don&#39;t ask the SO community to debug the code for you"}, {"owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "reply_to_user": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1484719010, "post_id": 41712108, "comment_id": 70619693, "body": "The code are just for references about what i am doing, i just need some advice and some tips guidance for this problem. That&#39;s all."}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "is_accepted": true, "score": 0, "last_activity_date": 1484726278, "creation_date": 1484726278, "answer_id": 41714012, "question_id": 41712108, "link": "https://stackoverflow.com/questions/41712108/numeric-format-problems-as-the-number-ran-to-the-2nd-digit/41714012#41714012", "title": "Numeric format problems as the number ran to the 2nd digit", "body": "<p>Finally i did it, i found the solution for this, Simple as this</p>\n\n<pre><code>field8 = 0 &amp; 0 &amp; Left(Cells(vRow, 8).Value, 6) &amp; CleanString(myVal) &amp; Format(Right((Cells(vRow, 8).Value), 5), \"00000\")\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 41714012, "answer_count": 1, "score": -2, "last_activity_date": 1484726278, "creation_date": 1484717833, "last_edit_date": 1531161705, "question_id": 41712108, "link": "https://stackoverflow.com/questions/41712108/numeric-format-problems-as-the-number-ran-to-the-2nd-digit", "title": "Numeric format problems as the number ran to the 2nd digit", "body": "<p>i have a problem\nThe numbers supposed to be generate in a format \ni've attached the link here as for reference\n<a href=\"https://stackoverflow.com/questions/41709701/condition-as-to-cater-with-preset-value-in-a-format/41710822#41710822\">Condition as to cater with preset value in a format</a>     </p>\n\n<p>The solutions given by A.S.H is    </p>\n\n<pre><code>Dim s As String: s = CleanString(myVal)\nfield8 = Left(oldstring, 6) &amp; s &amp; Format(Cells(vRow, 8).Value, String(7 - Len(s), \"0\"))\n</code></pre>\n\n<p>Before using the Solutions provided by A.S.H, i am using this code, it's working, due to some changes in requirement i have to change the code.</p>\n\n<pre><code>field3 = 0 &amp; 0 &amp; Format(Date, \"YYYYMM\") &amp; CleanString(myVal) &amp; Format(Cells(vRow, 3).Value, \"00000\")\n</code></pre>\n\n<p>Yes indeed it work out for the code provided by A.S.H, but the problem is the output when i generate the numbers from the statement above.</p>\n\n<p>The current output which is wrong as the numbers 01 is in the first two digits, the 01 is a passing value from myVal.<br>\n<strong>01</strong>2017010000001 </p>\n\n<p>The correct output should be<br>\n00201701<strong>01</strong>00001</p>\n\n<p>The original CleanString code is in the same form module as the part i am having problem is( The code are just for reference to shows what i am doing) </p>\n\n<pre><code>Function CleanString(strIn As String) As String\nDim objRegex\nSet objRegex = CreateObject(\"vbscript.regexp\")\nWith objRegex\n .Global = True\n .Pattern = \"[^\\d]+\"\nCleanString = .Replace(strIn, vbNullString)\nEnd With\n End Function\n</code></pre>\n\n<p>The myVal code is as below which is on other module which generate increment numbers</p>\n\n<pre><code>Public myVal As String\nSub test()\nDim fn As String, txt As String, temp\nfn = ThisWorkbook.Path + \"\\PaymentFile01.txt\"\nIf fn = \"False\" Then Exit Sub\ntxt = CreateObject(\"Scripting.FileSystemObject\").OpenTextFile(fn).ReadAll\nWith CreateObject(\"VBScript.RegExp\")\n    .Global = True\n    .Pattern = \"_(\\d+)(?=\\|)\"\n    myVal = Format$(.Execute(txt)(0).submatches(0) + 1, \"_00\")\n    txt = .Replace(txt, myVal)\n    .Pattern = \"(\\r\\n)+$\"\n    Open Replace(fn, \".txt\", \".txt\") For Output As #1\n        Print #1, txt;\n        MsgBox \"This is bathch No\" &amp; myVal\n    Close #1\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Not Sure which part went wrong. In my opinion, the Solutions Given by A.S.H requires some modifications to cater with my requirement.</p>\n\n<p>Thank you in advance first.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 1, "creation_date": 1484718325, "post_id": 41711770, "comment_id": 70619454, "body": "Hello and welcome to SO. So you basically want to<code>Loop</code> through the cells in Column B from Row 2 to the end of Column B?"}], "answers": [{"comments": [{"owner": {"reputation": 6598, "user_id": 3795219, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/tjE9g.jpg?s=128&g=1", "display_name": "Austin D", "link": "https://stackoverflow.com/users/3795219/austin-d"}, "edited": false, "score": 2, "creation_date": 1484718791, "post_id": 41712202, "comment_id": 70619616, "body": "Nice one @A.S.H ! I&#39;ve never heard of <code>xlCellTypeConstants</code> until now... after a quick google search, I came across an article on ozgrid.com that explains the special cells method: <a href=\"http://www.ozgrid.com/VBA/special-cells.htm\" rel=\"nofollow noreferrer\">ozgrid.com/VBA/special-cells.htm</a>   ... learn something new every day!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 6598, "user_id": 3795219, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/tjE9g.jpg?s=128&g=1", "display_name": "Austin D", "link": "https://stackoverflow.com/users/3795219/austin-d"}, "edited": false, "score": 1, "creation_date": 1484718843, "post_id": 41712202, "comment_id": 70619637, "body": "@AustinD yeah, we all do! :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1484718370, "creation_date": 1484718370, "answer_id": 41712202, "question_id": 41711770, "link": "https://stackoverflow.com/questions/41711770/create-a-loop-until-all-cells-have-been-used-by-script/41712202#41712202", "title": "Create a loop until all cells have been used by script", "body": "<p>For a quick action, Try this:</p>\n\n<p>Change this line:</p>\n\n<blockquote>\n  <p><code>filePath = Worksheets(\"Sheet2\").Range(\"B2\").Value</code></p>\n</blockquote>\n\n<p>Into a loop</p>\n\n<pre><code>Dim v As Variant, filepath As String\nFor Each v In Worksheets(\"Sheet2\").Columns(\"B\").SpecialCells(xlCellTypeConstants)\n    filepath = v.Value\n    debug.Print filePath\n   .... ' remainder of your code\n</code></pre>\n\n<p>.. then go to the <code>Next</code> line and write another <code>Next</code> line after it.</p>\n"}, {"tags": [], "owner": {"reputation": 6598, "user_id": 3795219, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/tjE9g.jpg?s=128&g=1", "display_name": "Austin D", "link": "https://stackoverflow.com/users/3795219/austin-d"}, "is_accepted": false, "score": 3, "last_activity_date": 1484718449, "creation_date": 1484718449, "answer_id": 41712216, "question_id": 41711770, "link": "https://stackoverflow.com/questions/41711770/create-a-loop-until-all-cells-have-been-used-by-script/41712216#41712216", "title": "Create a loop until all cells have been used by script", "body": "<p>You can add a <code>for... each</code> loop, looping through all cells in your current selection. Here's the pattern:</p>\n\n<pre><code>Dim cCell as Range\nFor Each cCell in Selection\n    'do stuff\nNext cCell\n</code></pre>\n\n<p>Now, since you change selections throughout your code, you have to store the selection at the onset into another variable, e.g. <code>originalSelection</code> and then loop through the cells in <code>originalSelection</code>. Otherwise, your selection will change during execution.</p>\n\n<p>Adapting it to your code, we end up with the following... Please note: I broke your code into two methods---<code>ReadTxtFiles</code> and <code>copyTo</code>; the <code>ReadTxtFile()</code> sub was getting way too long.</p>\n\n<pre><code>Option Explicit\n\nSub ReadTxtFiles()\n    Dim start As Date\n    start = Now\n\n    Dim oFS As Object\n    Dim inputFilePath As String\n    Dim outputFilePath As String\n    Dim outputDirectory As String\n    outputDirectory = \"C:\\Users\\nfraser\\Documents\\test\\\"\n\n    '''''Assign the Workbook File Name along with its Path\n    Dim originalSelection As Range\n    Dim cCell As Range\n    Dim i As Integer\n\n    Set originalSelection = Selection\n\n    For Each cCell In originalSelection\n        inputFilePath = cCell.Value\n        outputFilePath = outputDirectory &amp; i &amp; \".txt\"\n        copyTo inputFilePath, outputFilePath\n    Next cCell\n\n    Debug.Print DateDiff(\"s\", start, Now)\n\nEnd Sub\n\n\nSub copyTo(inputPath As String, outputPath As String)\n    Dim arr(100000) As String\n    Dim i As Long\n    Dim oFSO As Object\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\") 'late binding\n    Dim oFS As Object\n    i = 0\n\n    If oFSO.FileExists(inputPath) Then\n        On Error GoTo Err 'ensure oFS gets closed\n\n        Set oFS = oFSO.OpenTextFile(inputPath)\n\n        'read file contents into array\n        Do While Not oFS.AtEndOfStream\n            arr(i) = oFS.ReadLine\n            i = i + 1\n        Loop\n\n        'close\n        oFS.Close\n    Else 'file didn't exist\n        MsgBox \"The file path is invalid.\", vbCritical, vbNullString\n        Exit Sub\n    End If\n\n    For i = LBound(arr) To UBound(arr)\n\n        If InStr(1, arr(i), \"Transmission\", vbTextCompare) Then\n\n            'Declare variables for the new output file\n            Dim FN As Integer\n            FN = FreeFile\n\n            'Open new output file\n            Open outputPath For Output As #FN\n\n            'While 'end of report' has not been found,\n            'keep looping to print out contents starting from 'report'\n            Do While InStr(1, arr(i), \"Ancillary\", vbTextCompare) = 0\n\n                Debug.Print i + 1, arr(i)\n                Range(\"A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1) = i + 1\n                Range(\"B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1) = arr(i)\n\n                'Print into new output file\n                Print #FN, i + 1 &amp; \" \" &amp; arr(i)\n\n                'increment count\n                i = i + 1\n\n            Loop\n\n            'Print out the 'end of report' line as well\n            Debug.Print i + 1, arr(i)\n            Range(\"A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1) = i + 1\n            Range(\"B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1) = arr(i)\n\n            'Print 'end of report' line into new output file as well\n            Print #FN, i + 1 &amp; \" \" &amp; arr(i)\n\n            'close the new output file\n            Close #FN\n\n            'exit the 'For..Next' structure since 'end of report' has been found\n            Exit For\n        End If\n    Next\n    Exit Sub\n\nErr:\n    MsgBox \"Error while reading the file.\", vbCritical, vbNullString\n    oFS.Close\n    Exit Sub\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 106, "user_id": 7433828, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/11b535d4ca7e1921ee6e70d80411a35b?s=128&d=identicon&r=PG&f=1", "display_name": "user7433828", "link": "https://stackoverflow.com/users/7433828/user7433828"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 41712202, "answer_count": 2, "score": 3, "last_activity_date": 1484722771, "creation_date": 1484716182, "last_edit_date": 1484722771, "question_id": 41711770, "link": "https://stackoverflow.com/questions/41711770/create-a-loop-until-all-cells-have-been-used-by-script", "title": "Create a loop until all cells have been used by script", "body": "<p>I don't really know how to program but I have compiled a few scripts to achieve nearly what I want, but I have failed at the last step. </p>\n\n<p>The script opens a .txt file from a file directory in, cell B2, sheet 2, and copies its contents into excel (as well as a notepad which I don't care about). </p>\n\n<p>However, I have 120 file directories I want to do this for. At the moment my script just takes the directory from cell B2, I have the rest of the 119 directories below it in the B column, I run the script and delete the row and repeat, which is a bit painstaking. </p>\n\n<p>I would just like the script to run through all 120 files in the B column automatically. Any help appreciated!</p>\n\n<pre><code>    Option Explicit\n\nSub ReadTxtFile()\n    Dim start As Date\n    start = Now\n\n    Dim oFSO As Object\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    Dim oFS As Object\n\n   Dim filePath As String\n\n\n    '''''Assign the Workbook File Name along with its Path\n\n    filePath = Worksheets(\"Sheet2\").Range(\"B2\").Value\n MsgBox Worksheets(\"Sheet2\").Range(\"B2\").Value\n    Dim arr(100000) As String\n    Dim i As Long\n    i = 0\n\n    If oFSO.FileExists(filePath) Then\n        On Error GoTo Err\n\n        Set oFS = oFSO.OpenTextFile(filePath)\n        Do While Not oFS.AtEndOfStream\n            arr(i) = oFS.ReadLine\n            i = i + 1\n        Loop\n        oFS.Close\n    Else\n        MsgBox \"The file path is invalid.\", vbCritical, vbNullString\n        Exit Sub\n    End If\n\n   For i = LBound(arr) To UBound(arr)\n    If InStr(1, arr(i), \"Transmission\", vbTextCompare) Then\n\n        'Declare variables for the new output file\n        Dim sOutputFileNameAndPath As String\n        Dim FN As Integer\n        sOutputFileNameAndPath = \"C:\\Users\\nfraser\\Documents\\test\\second.txt\"\n        FN = FreeFile\n\n        'Open new output file\n        Open sOutputFileNameAndPath For Output As #FN\n\n\n        'While 'end of report' has not been found,\n        'keep looping to print out contents starting from 'report'\n        Do While InStr(1, arr(i), \"Ancillary\", vbTextCompare) = 0\n\n            Debug.Print i + 1, arr(i)\n            Range(\"A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1) = i + 1\n            Range(\"B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1) = arr(i)\n\n            'Print into new output file\n            Print #FN, i + 1 &amp; \" \" &amp; arr(i)\n\n            'increment count\n            i = i + 1\n\n        Loop\n\n        'Print out the 'end of report' line as well\n        Debug.Print i + 1, arr(i)\n        Range(\"A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1) = i + 1\n        Range(\"B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1) = arr(i)\n\n        'Print 'end of report' line into new output file as well\n        Print #FN, i + 1 &amp; \" \" &amp; arr(i)\n\n        'close the new output file\n        Close #FN\n\n        'exit the 'For..Next' structure since 'end of report' has been found\n        Exit For\n\n\n    End If\n\nNext\n\n    Debug.Print DateDiff(\"s\", start, Now)\n\nExit Sub\n\n\n\nErr:\n    MsgBox \"Error while reading the file.\", vbCritical, vbNullString\n    oFS.Close\n    Exit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1484716920, "post_id": 41711666, "comment_id": 70618946, "body": "You could just iterate on Sheet2 A1:A[lastrow] and find the correct staff_name and then use that row to copy the rest"}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 7239826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3b721f013eab9cabe0cd020113c707a?s=128&d=identicon&r=PG&f=1", "display_name": "jsv", "link": "https://stackoverflow.com/users/7239826/jsv"}, "is_accepted": true, "score": 1, "last_activity_date": 1484760510, "creation_date": 1484760510, "answer_id": 41725791, "question_id": 41711666, "link": "https://stackoverflow.com/questions/41711666/copy-cells-from-one-sheet-paste-into-a-second-sheet-in-the-correct-place-based/41725791#41725791", "title": "Copy cells from one sheet, paste into a second sheet in the correct place based on a VLOOKUP", "body": "<p>Please modify to suit your requirement</p>\n\n<pre><code>Sub copyrange()\n\nDim sheet2_row As Integer\n\nsheet1_name = Sheets(\"Sheet1\").Cells(2, 2).Value\nsheet2_row=WorksheetFunction.Match(sheet1_name,Sheets(\"Sheet2\").Range(\"A1:A10\"), 0)\n\nSheets(\"Sheet1\").Range(\"C2:AG2\").Copy\nSheets(\"Sheet2\").Range(\"B\" &amp; sheet2_row &amp; \" : AF\" &amp; sheet2_row).PasteSpecial xlPasteValues\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 674, "user_id": 1504362, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/969613543e8712748953817bbd6616de?s=128&d=identicon&r=PG", "display_name": "gisol", "link": "https://stackoverflow.com/users/1504362/gisol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 41725791, "answer_count": 1, "score": -1, "last_activity_date": 1484760510, "creation_date": 1484715603, "last_edit_date": 1531161705, "question_id": 41711666, "link": "https://stackoverflow.com/questions/41711666/copy-cells-from-one-sheet-paste-into-a-second-sheet-in-the-correct-place-based", "title": "Copy cells from one sheet, paste into a second sheet in the correct place based on a VLOOKUP", "body": "<p>I have a submission form, Sheet1, and a datasheet that does calculations, Sheet2. Sheet2 contains a list of Names and Dates and empty cells ready to be filled.</p>\n\n<p>On Sheet1, the user selects a Name from a list in A2 (using data validation, with the source being a 3rd reference sheet), then enters values in C1, D1, E1, F1, etc. The user then clicks a button that prints the form sheet, Sheet1.</p>\n\n<p>I also want to also transfer the data from C1, D1, E1 etc into Sheet2, and slot them into the correct row, which is which ever row has the corresponding Name  entered in Sheet1!B1 in Sheet2!A1.</p>\n\n<p>I'm comfortable with VBA copying defined cells to other defined cells, but am unsure of how to combine that with finding the correct position in Sheet2 based on the value in A. Below are Sheet1 and Sheet2.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7bPqI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7bPqI.png\" alt=\"Sheet1\"></a>\n<a href=\"https://i.stack.imgur.com/zhvK9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zhvK9.png\" alt=\"Sheet 2\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 7433793, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154646627867881/picture?type=large", "display_name": "user7433793", "link": "https://stackoverflow.com/users/7433793/user7433793"}, "edited": false, "score": 0, "creation_date": 1484716886, "post_id": 41711632, "comment_id": 70618937, "body": "Thanks a lot Mitch!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 85, "user_id": 7433793, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154646627867881/picture?type=large", "display_name": "user7433793", "link": "https://stackoverflow.com/users/7433793/user7433793"}, "edited": false, "score": 0, "creation_date": 1484718705, "post_id": 41711632, "comment_id": 70619582, "body": "@user7433793 please click the <code>Thanks</code> button located on the top-left of the answer and has the shape like <code>v</code>, colored in green :P"}], "tags": [], "owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "is_accepted": false, "score": 1, "last_activity_date": 1484718878, "last_edit_date": 1484718878, "creation_date": 1484715357, "answer_id": 41711632, "question_id": 41711592, "link": "https://stackoverflow.com/questions/41711592/excel-vba-for-next/41711632#41711632", "title": "Excel VBA For...Next", "body": "<p>For loops increment the loop variable at the end of the loop.</p>\n\n<p>In the second code snippet, the for loop increments x from 10 to 11, and then you display it. </p>\n\n<p>Whereas the first code snippets increments x AFTER you display it. This is not something specific to VBA.</p>\n\n<p>To see this, run:</p>\n\n<pre><code>Sub sum1_1()\n  Dim x As Integer\n\n  x = 0\n  For x = 5 To 5\n      x = x + x\n      MsgBox x\n  Next \n\n  MsgBox x\nEnd Sub\n</code></pre>\n\n<p>As an aside: It's not best practice to modify loop counters from inside a loop. It can lead to code that is hard to understand.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 7433793, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154646627867881/picture?type=large", "display_name": "user7433793", "link": "https://stackoverflow.com/users/7433793/user7433793"}, "edited": false, "score": 0, "creation_date": 1484716872, "post_id": 41711839, "comment_id": 70618933, "body": "Thanks a lot Austin, it&#39;s very helpful!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 85, "user_id": 7433793, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154646627867881/picture?type=large", "display_name": "user7433793", "link": "https://stackoverflow.com/users/7433793/user7433793"}, "edited": false, "score": 1, "creation_date": 1484719209, "post_id": 41711839, "comment_id": 70619759, "body": "@user7433793 by <code>accepting</code> an answer to your question, the one that works best for you, people will be <i>happier</i> to answer your future questions."}], "tags": [], "owner": {"reputation": 6598, "user_id": 3795219, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/tjE9g.jpg?s=128&g=1", "display_name": "Austin D", "link": "https://stackoverflow.com/users/3795219/austin-d"}, "is_accepted": true, "score": 4, "last_activity_date": 1484716464, "creation_date": 1484716464, "answer_id": 41711839, "question_id": 41711592, "link": "https://stackoverflow.com/questions/41711592/excel-vba-for-next/41711839#41711839", "title": "Excel VBA For...Next", "body": "<p>A vba <code>for</code>-loop increments the index variable at the end of each iteration. That is what the <code>Next</code> keyword does. In <code>sum1()</code> You get:</p>\n\n<pre><code>Sub sum1()\n  Dim x As Integer\n  x = 0 ' x is 0\n  For x = 5 To 5 ' x  set to 5\n     x = x + x 'x gets 5+5=10\n  Next 'x gets 10+1=11\n  MsgBox x 'display x=11\nEnd Sub\n</code></pre>\n\n<p>but in <code>sum2()</code> you get:</p>\n\n<pre><code>Sub sum2()\n  Dim x As Integer\n  x = 0 ' x is 0\n  For x = 5 To 5 ' x  is 5\n     x = x + x 'x gets 5+5=10\n     MsgBox x 'display x=10\n  Next 'x gets 10+1 and is now 11\nEnd Sub\n</code></pre>\n\n<p>I agree with @MitchWheat, it usually not good practice to modify your index variable while inside a loop. A better approach would be this:</p>\n\n<pre><code>Sub sum3()\n    Dim x as Integer\n    Dim i as Integer\n    x= 1\n    For i = 5 To 5\n      x = x + x\n    Next\n    MsgBox x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 7433793, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154646627867881/picture?type=large", "display_name": "user7433793", "link": "https://stackoverflow.com/users/7433793/user7433793"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 41711839, "answer_count": 2, "score": 3, "last_activity_date": 1484721506, "creation_date": 1484715141, "last_edit_date": 1531164843, "question_id": 41711592, "link": "https://stackoverflow.com/questions/41711592/excel-vba-for-next", "title": "Excel VBA For...Next", "body": "<p>I'm a VBA newcomer. I wonder why does sum1() show 10 while sum2() show 11? Thanks in advance.</p>\n\n<pre><code>Sub sum1()\n  Dim x As Integer\n  x = 0\n  For x = 5 To 5\n      x = x + x\n      MsgBox x\n  Next \nEnd Sub\n\nSub sum2()\n  Dim x As Integer\n  x = 0\n  For x = 5 To 5\n      x = x + x\n  Next\n  MsgBox x\nEnd Sub\n</code></pre>\n"}, {"tags": ["macos", "excel", "terminal", "vba"], "comments": [{"owner": {"reputation": 86437, "user_id": 981049, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AYKWV.jpg?s=128&g=1", "display_name": "Michael Dautermann", "link": "https://stackoverflow.com/users/981049/michael-dautermann"}, "edited": false, "score": 0, "creation_date": 1484717008, "post_id": 41711541, "comment_id": 70618984, "body": "This is a horrendously broad question that could use some additional info.  For example, are each of these 50,000 files the same kind of table (same number of columns?), or do you want the 50,000 files all merged into the Excel worksheet as different tabs/pages?"}, {"owner": {"reputation": 3, "user_id": 7433562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cbb8bfa1491ca48ccf723aec4bd866c?s=128&d=identicon&r=PG&f=1", "display_name": "Meredith ", "link": "https://stackoverflow.com/users/7433562/meredith"}, "reply_to_user": {"reputation": 86437, "user_id": 981049, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AYKWV.jpg?s=128&g=1", "display_name": "Michael Dautermann", "link": "https://stackoverflow.com/users/981049/michael-dautermann"}, "edited": false, "score": 0, "creation_date": 1484717773, "post_id": 41711541, "comment_id": 70619252, "body": "@MichaelDautermann thanks. I have updated my question."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7433562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cbb8bfa1491ca48ccf723aec4bd866c?s=128&d=identicon&r=PG&f=1", "display_name": "Meredith ", "link": "https://stackoverflow.com/users/7433562/meredith"}, "edited": false, "score": 0, "creation_date": 1484747208, "post_id": 41715197, "comment_id": 70636722, "body": "Yes, <code>awk -F, &#39;FNR&gt;=45 &amp;&amp; FNR&lt;=145{print $2}&#39; *.csv   &gt; BigBoy.csv</code> doesn&#39;t work with 50000 files. But  <code>find . -name \\*.csv -print0 | xargs -0 -L 256 awk -F, &#39;FNR&gt;=45 &amp;&amp; FNR&lt;=145{print $2}&#39; &gt; BigBoy.csv</code>  perfectly solved my question. Thanks for suggestion."}], "tags": [], "owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "is_accepted": true, "score": 0, "last_activity_date": 1484731091, "last_edit_date": 1484731091, "creation_date": 1484730457, "answer_id": 41715197, "question_id": 41711541, "link": "https://stackoverflow.com/questions/41711541/os-x-how-to-merge-bulk-csv-files-into-an-excel-worksheet/41715197#41715197", "title": "OS X , how to merge bulk csv files into an excel worksheet?", "body": "<p>Please try the following command with a single CSV file to see if it extracts the fields you want:</p>\n\n<pre><code>awk -F, 'FNR&gt;=45 &amp;&amp; FNR&lt;=145{print $2}'   AnySingleFile.csv\n</code></pre>\n\n<p>It prints the second field (<code>$2</code>) of all lines with line number greater than or equal 45 and less than or equal 145. The <code>-F,</code> sets the field separator to a comma.</p>\n\n<p>If that works, the next command to try would be this, but I doubt it will work with 50,000 files:</p>\n\n<pre><code>awk -F, 'FNR&gt;=45 &amp;&amp; FNR&lt;=145{print $2}' *.csv   &gt; BigBoy.csv\n</code></pre>\n\n<p>So, I would suggest you use <code>find</code> and <code>xargs</code> to process, say 256 files, at a time:</p>\n\n<pre><code>find . -name \\*.csv -print0 | xargs -0 -L 256 awk -F, 'FNR&gt;=45 &amp;&amp; FNR&lt;=145{print $2}' &gt; BigBoy.csv\n</code></pre>\n\n<p>That command works like this...<em>'Find all files ending in <code>.csv</code> and print their names separated with nul characters passing that list to <code>xargs</code>. It will then split the list and pass 256 files at a time to <code>awk</code> which will do exactly what the initial <code>awk</code> did.\"</em> </p>\n\n<p>The idea of passing 256 files to <code>awk</code> is to save having to execute a new process for every single one of your 50,000 CSV files. You may get away with a bigger number, depending on the length of your filenames. See Note at end.</p>\n\n<p>Your results should be in <code>BigBoy.csv</code>.</p>\n\n<p><strong>Note 1:</strong> If your CSV files have many hundreds of lines, you will get a performance increase if you change the <code>awk</code> code to:</p>\n\n<p>'FNR>=45 &amp;&amp; FNR&lt;=145{print $2} FNR==145{exit}'</p>\n\n<p><strong>Note 2:</strong> The limit (in characters) for the length of the arguments passed to <code>awk</code> (and any other program) can be found with:</p>\n\n<pre><code>sysctl kern.argmax\n</code></pre>\n\n<p>and on OSX, it is 262,144 characters. So if your CSV filenames are 8-10 characters long on average, you could probably pass over 26,000 filenames. If they are 260 characters long on average, you should not pass more than around 1,000 filenames.</p>\n"}], "owner": {"reputation": 3, "user_id": 7433562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cbb8bfa1491ca48ccf723aec4bd866c?s=128&d=identicon&r=PG&f=1", "display_name": "Meredith ", "link": "https://stackoverflow.com/users/7433562/meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 1, "accepted_answer_id": 41715197, "answer_count": 1, "score": 0, "last_activity_date": 1484747367, "creation_date": 1484714804, "last_edit_date": 1531164843, "question_id": 41711541, "link": "https://stackoverflow.com/questions/41711541/os-x-how-to-merge-bulk-csv-files-into-an-excel-worksheet", "title": "OS X , how to merge bulk csv files into an excel worksheet?", "body": "<p>OS X ,I have 50000 csv files in a folder. How to merge a specified range of all these csv files into a excel worksheet ? </p>\n\n<p>ps. All of these csv files are in the same form. Each of them has two columns. What I want is the middle part of the second column, B45: B145. And in the new excel worksheet\uff0cI want the data from each csv file pasted next to each other. The result is in one worksheet. </p>\n\n<p>Thanks for the following suggestions. I have found a solution to this problem.</p>\n\n<p><code>find . -name \\*.csv -print0 | xargs -0 -L 256 awk -F, 'FNR&gt;=45 &amp;&amp; FNR&lt;=145{print $2}' &gt; BigBoy.csv</code></p>\n"}, {"tags": ["javascript", "excel", "vba", "drop-down-menu", "google-sheets-api"], "comments": [{"owner": {"reputation": 12076, "user_id": 5832311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t6jqn.jpg?s=128&g=1", "display_name": "abielita", "link": "https://stackoverflow.com/users/5832311/abielita"}, "edited": false, "score": 0, "creation_date": 1484755184, "post_id": 41711493, "comment_id": 70642491, "body": "What have you tried so far? Can you add any details like: code used, error problem encountered? <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>, <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6877091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b115c7663f485b0758a7ed3f6ab83eb3?s=128&d=identicon&r=PG&f=1", "display_name": "Shazzad Kabir", "link": "https://stackoverflow.com/users/6877091/shazzad-kabir"}, "edited": false, "score": 0, "creation_date": 1502749276, "post_id": 45664562, "comment_id": 78325801, "body": "Thanks a lot for getting back. can we contact over social media with you?"}, {"owner": {"reputation": 5, "user_id": 6877091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b115c7663f485b0758a7ed3f6ab83eb3?s=128&d=identicon&r=PG&f=1", "display_name": "Shazzad Kabir", "link": "https://stackoverflow.com/users/6877091/shazzad-kabir"}, "edited": false, "score": 0, "creation_date": 1502750378, "post_id": 45664562, "comment_id": 78326139, "body": "its quite ok. Can you pls tell me the wrongness of my last post so that i can rectify ?"}], "tags": [], "owner": {"reputation": 34507, "user_id": 7215091, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/2pNI4.jpg?s=128&g=1", "display_name": "MetaMan", "link": "https://stackoverflow.com/users/7215091/metaman"}, "is_accepted": false, "score": 0, "last_activity_date": 1502655503, "creation_date": 1502655503, "answer_id": 45664562, "question_id": 41711493, "link": "https://stackoverflow.com/questions/41711493/how-to-create-a-sub-group-under-a-main-head/45664562#45664562", "title": "How to create a sub group under a main head?", "body": "<p>Here's an example right out of the documentation <a href=\"https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app#getUi()\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>function onOpen(e) {\n   SpreadsheetApp.getUi()\n       .createMenu('My Menu')\n       .addItem('My menu item', 'myFunction')\n       .addSeparator()\n       .addSubMenu(SpreadsheetApp.getUi().createMenu('My sub-menu')\n           .addItem('One sub-menu item', 'mySecondFunction')\n           .addItem('Another sub-menu item', 'myThirdFunction'))\n       .addToUi();\n }\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6877091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b115c7663f485b0758a7ed3f6ab83eb3?s=128&d=identicon&r=PG&f=1", "display_name": "Shazzad Kabir", "link": "https://stackoverflow.com/users/6877091/shazzad-kabir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531325578, "creation_date": 1484714579, "last_edit_date": 1531325578, "question_id": 41711493, "link": "https://stackoverflow.com/questions/41711493/how-to-create-a-sub-group-under-a-main-head", "title": "How to create a sub group under a main head?", "body": "<p>i want to include some points under a main head. There will be plus sign in a box beside the main head. And when i click the plus sign beside the main head, sub points will be opened as drop down. </p>\n\n<p>I want to do it on excel 2016 and google spreadsheet. But unfortunately i can't. Can you please help me figuring this problem???</p>\n\n<p>Regards\nShazzad</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484712219, "post_id": 41711145, "comment_id": 70617589, "body": "try conditional formatting: <a href=\"https://support.office.com/en-ie/article/Use-a-formula-to-apply-conditional-formatting-fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f\" rel=\"nofollow noreferrer\">support.office.com/en-ie/article/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 3, "last_activity_date": 1484717419, "creation_date": 1484717419, "answer_id": 41712031, "question_id": 41711145, "link": "https://stackoverflow.com/questions/41711145/highlight-cells-when-a-cell-changes-via-formula/41712031#41712031", "title": "Highlight cells when a cell changes via formula", "body": "<p>If what you want to detect is just one cell, the solution is perhaps easy. Put a <code>Worksheet_Calculate</code> event in the worksheet that contains this cell:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n     Static oldVal As Variant\n     If Me.Range(\"A1\").Value &lt;&gt; oldVal Then\n        Me.Range(\"A2:C4\").Interior.ColorIndex = 6\n    End If\n    oldVal = Me.Range(\"A1\").Value\nEnd Sub\n</code></pre>\n\n<p>This supposes you want to detect the change in cell <code>A1</code> and the range you want to highlight is <code>A2:C4</code>. Adjust these ranges to your need.</p>\n"}], "owner": {"reputation": 1, "user_id": 7433631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc35a36acbe7f1b01817f9e1b2260bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Ping Woo", "link": "https://stackoverflow.com/users/7433631/ping-woo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496043460, "creation_date": 1484712084, "last_edit_date": 1496043460, "question_id": 41711145, "link": "https://stackoverflow.com/questions/41711145/highlight-cells-when-a-cell-changes-via-formula", "title": "Highlight cells when a cell changes via formula", "body": "<p>I'd like to create a macro on Excel to highlight a range of cells when the date in a particular cell changes. The cell draws the date information from Bloomberg (BDP formula), and the workbook refreshes daily.</p>\n\n<p>I've tried this solution: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n</code></pre>\n\n<p>(<a href=\"https://www.thespreadsheetguru.com/blog/trigger-your-vba-macros-to-run-based-on-specific-cell-value-change\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/trigger-your-vba-macros-to-run-based-on-specific-cell-value-change</a>). </p>\n\n<p>However, it only works when the formula in the cell changes, and not when the cell automatically updates the date information when refreshed.</p>\n\n<p>Is there a simple solution to my problem?</p>\n"}, {"tags": ["excel", "forms", "vba"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484721899, "post_id": 41710972, "comment_id": 70620804, "body": "Since your &quot;on the fly&quot; userform uses no running variable you should turn it into a &quot;normal &quot; userform hard coded in your project"}, {"owner": {"reputation": 1, "user_id": 7433521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098b477ddb3c6d4757c7a9ef277eec23?s=128&d=identicon&r=PG&f=1", "display_name": "Jet238", "link": "https://stackoverflow.com/users/7433521/jet238"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484761885, "post_id": 41710972, "comment_id": 70646857, "body": "Thanks for your comment, I totally agree. Actually, I wanted to first make sure that the basic code was working before introducing variables."}], "owner": {"reputation": 1, "user_id": 7433521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098b477ddb3c6d4757c7a9ef277eec23?s=128&d=identicon&r=PG&f=1", "display_name": "Jet238", "link": "https://stackoverflow.com/users/7433521/jet238"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484711547, "creation_date": 1484710874, "question_id": 41710972, "link": "https://stackoverflow.com/questions/41710972/vba-userform-refuses-to-unload", "title": "VBA - UserForm refuses to unload", "body": "<p>I am new on this forum. I have some experience in VBA but I am new to UserForms. This seems simple enough but I just want to close a userform created with the code below. I've been looking for answers everywhere and nothing seems to work. \"Unload me\" or \"Unload Userform\" have no effect. I simply want the form to close when the button is clicked. I've also tried deleting all shapes in workbook but I'm still stuck with that form, so any help would be greatly appreciated. Here's the code I'm working with:</p>\n\n<pre><code>    Sub TypeForm()\nDim DocForm As Object\nDim NewFrame As MSForms.Frame\nDim NewButton As MSForms.CommandButton\nDim NewListBox As MSForms.ListBox\nDim x As Integer\nDim Line As Integer\n\nApplication.VBE.MainWindow.Visible = False\n\nSet DocForm = ThisWorkbook.VBProject.VBComponents.Add(3)\n\n\nWith DocForm\n    .Properties(\"Caption\") = \"Document type\"\n    .Properties(\"Width\") = 300\n    .Properties(\"Height\") = 270\nEnd With\n\n\nSet NewListBox = DocForm.Designer.Controls.Add(\"Forms.listbox.1\")\nWith NewListBox\n    .Name = \"lst_1\"\n    .Top = 10\n    .Left = 10\n    .Width = 150\n    .Height = 230\n    .Font.Size = 8\n    .Font.Name = \"Tahoma\"\n    .BorderStyle = fmBorderStyleOpaque\n    .SpecialEffect = fmSpecialEffectSunken\nEnd With\n\n\nSet NewButton = DocForm.Designer.Controls.Add(\"Forms.commandbutton.1\")\nWith NewButton\n    .Name = \"cmd_1\"\n    .Caption = \"Accept\"\n    .Accelerator = \"M\"\n    .Top = 10\n    .Left = 200\n    .Width = 80\n    .Height = 20\n    .Font.Size = 8\n    .Font.Name = \"Tahoma\"\n    .BackStyle = fmBackStyleOpaque\nEnd With\n\nlstBoxData = \"Data 1,Data 2,Data 3,Data 4,Data 5,Data 6,Data 7,Data 8,Data 9,Data 10\"\nDocForm.CodeModule.InsertLines 1, \"Private Sub UserForm_Initialize()\"\nDocForm.CodeModule.InsertLines 2, \"   me.lst_1.addItem \"\"Type 1\"\" \"\nDocForm.CodeModule.InsertLines 3, \"   me.lst_1.addItem \"\"Type 2\"\" \"\nDocForm.CodeModule.InsertLines 4, \"   me.lst_1.addItem \"\"Type 3\"\" \"\nDocForm.CodeModule.InsertLines 5, \"   me.lst_1.addItem \"\"Type 4\"\" \"\nDocForm.CodeModule.InsertLines 6, \"   me.lst_1.addItem \"\"Type 5\"\" \"\nDocForm.CodeModule.InsertLines 7, \"   me.lst_1.addItem \"\"Type 6\"\" \"\nDocForm.CodeModule.InsertLines 8, \"   me.lst_1.addItem \"\"Type 7\"\" \"\nDocForm.CodeModule.InsertLines 9, \"   me.lst_1.addItem \"\"Type 8\"\" \"\nDocForm.CodeModule.InsertLines 10, \"   me.lst_1.addItem \"\"Type 9\"\" \"\nDocForm.CodeModule.InsertLines 11, \"   me.lst_1.addItem \"\"Type 10\"\" \"\nDocForm.CodeModule.InsertLines 12, \"End Sub\"\nDocForm.CodeModule.InsertLines 13, \"Private Sub cmd_1_Click()\"\nDocForm.CodeModule.InsertLines 14, \"   If me.lst_1.text &lt;&gt;\"\"\"\" Then\"\nDocForm.CodeModule.InsertLines 15, \"      Activecell.Offset(0, 2).value = me.lst_1.text\"\nDocForm.CodeModule.InsertLines 16, \"      Unload me\"\nDocForm.CodeModule.InsertLines 17, \"      Exit Sub\"\nDocForm.CodeModule.InsertLines 18, \"   End If\"\nDocForm.CodeModule.InsertLines 19, \"End Sub\"\n\nVBA.UserForms.Add(DocForm.Name).Show\n\nThisWorkbook.VBProject.VBComponents.Remove VBComponent:=DocForm\nEnd Sub \n</code></pre>\n\n<p>This code is within a self contained .xlsm file, whether it matters or not. Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1484707974, "post_id": 41710336, "comment_id": 70616593, "body": "you a missing a trailing <code>\\ </code> from your paths.  As is you are doing <code>Dir(&quot;C:\\Users\\Desktop\\ALL*.xml&quot;)</code>"}, {"owner": {"reputation": 29, "user_id": 7188028, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4e378d0450420fce43ce3b7f396aa053?s=128&d=identicon&r=PG&f=1", "display_name": "zzaewon", "link": "https://stackoverflow.com/users/7188028/zzaewon"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1484711072, "post_id": 41710336, "comment_id": 70617340, "body": "Oh wow! I didn&#39;t realize this until you look at this! Thank you so much Chris! It works now as good as gold! :)"}], "owner": {"reputation": 29, "user_id": 7188028, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4e378d0450420fce43ce3b7f396aa053?s=128&d=identicon&r=PG&f=1", "display_name": "zzaewon", "link": "https://stackoverflow.com/users/7188028/zzaewon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484710111, "creation_date": 1484706021, "last_edit_date": 1531161705, "question_id": 41710336, "link": "https://stackoverflow.com/questions/41710336/excel-vba-read-output-troubleshooting", "title": "Excel VBA - Read &amp; Output Troubleshooting", "body": "<p>I wrote this simple code to move files from Folder \"ALL\" to \"MPD41\" with the list as excel spreadsheet. Code will read a list, gets matching files and moves those files to the other folder. I think logically this should work but it doesn't read file &amp; doesn't work. Could you look at this code and point what I did wrong? Thanks! </p>\n\n<pre><code>Option Explicit\nSub Move_Files()\n\n    Dim FSO As Object\n    Dim sFromDir As String\n    Dim sToDir As String\n    Dim sFile As String\n    Dim rSearch As Range\n    Dim rFound As Range\n\n    sFromDir = \"C:\\Users\\Desktop\\ALL\"\n    sToDir = \"C:\\Users\\Desktop\\MPD41\"\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n    Workbooks.Open \"C:\\Users\\Desktop\\Book1.xlsx\"\n\n    Set rSearch = Range(\"A2:A\" &amp; Range(\"A1048576\").End(xlUp).Row)\n    sFile = Dir(sFromDir &amp; \"*.xml\")\n\n    While sFile &gt; \"\"\n        Set rFound = rSearch.Find(What:=Left(sFile, Len(sFile) - 4), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n        If Not rFound Is Nothing Then FSO.CopyFile Source:=sFromDir &amp; sFile, Destination:=sToDir &amp; sFile\n        sFile = Dir\n    Wend\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1484701920, "post_id": 41709701, "comment_id": 70614963, "body": "<code>Format(Date, &quot;000000&quot;)</code> - does that really work ?"}, {"owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484702318, "post_id": 41709701, "comment_id": 70615075, "body": "oops, that&#39;s the wrong part, my code should be Format(Date, &quot;YYYYMM&quot;), i paste in the wrong thing just now. sorry"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1484703460, "post_id": 41709701, "comment_id": 70615406, "body": "What? do you mean you cannot simply change <code>YYYYMM</code> to <code>YYYYMMDD</code>? Why is that?"}, {"owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "edited": false, "score": 0, "creation_date": 1484703819, "post_id": 41709701, "comment_id": 70615505, "body": "no, i do not need the DD, the YYYYMM is a preset value in a text file, i need to maintain it. 002017010100006. the 01&quot;01&quot;00006 , the &quot;01&quot; is from my CleanString(myVal) variable, if i used my current field 9 variable, it will causes something like this 00201701012017010000006. instead of 002017010100006"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1484706449, "post_id": 41709701, "comment_id": 70616213, "body": "Stil not clear, well, does it solve your problem if I give you a way to transform a string in the form <code>002017010000006</code> into another string in the form <code>002017010100006</code>, where the last <code>01</code> can be any two digits number?"}, {"owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "edited": false, "score": 0, "creation_date": 1484707148, "post_id": 41709701, "comment_id": 70616377, "body": "i need solution in maintaining &quot;201701&quot; from my text files instead of using Format(Date, &quot;YYYYMM&quot;) from my current solutions( this is the previous solution in replacing the 000000 with YYYYMM, if i din maintain the 201701 from my text file and use  this Format(Date, &quot;YYYYMM&quot;) in my current code, it will be something like this 00201701012017010000006. it&#39;s more than 15 digits, i just need to maintain this format 002017010100006"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1484708282, "post_id": 41709701, "comment_id": 70616687, "body": "ok, i can give you a statement that keeps the first 8 digits (say <code>00201701</code>, then puts after them a two digits of your choice (say <code>01</code>), then keeps the remaining 5 digits (say <code>00006</code>)). Does that do it?"}, {"owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "edited": false, "score": 0, "creation_date": 1484708450, "post_id": 41709701, "comment_id": 70616740, "body": "yes it can do, the 01 have to be from my CleanString(myVal) and the 00006 is from Format(Cells(vRow, 8).Value, &quot;00000&quot;)."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "edited": false, "score": 0, "creation_date": 1484712509, "post_id": 41710822, "comment_id": 70617665, "body": "yes, that&#39;s what i need, but after apply this thing, i&#39;ve met another problem. i will post another thread for that problem."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1484710026, "last_edit_date": 1484710026, "creation_date": 1484709564, "answer_id": 41710822, "question_id": 41709701, "link": "https://stackoverflow.com/questions/41709701/condition-as-to-cater-with-preset-value-in-a-format/41710822#41710822", "title": "Condition as to cater with preset value in a format", "body": "<p>Try this:</p>\n\n<pre><code>Function Transform(initial As String) As String\n    Transform = Left(initial, 8) &amp; CleanString(myVal) &amp; Format(Cells(vRow, 8).Value, \"00000\")\nEnd Function\n</code></pre>\n\n<p>or simply assign it to a variable...</p>\n\n<pre><code>newString = Left(oldString, 8) &amp; CleanString(myVal) &amp; Format(Cells(vRow, 8).Value, \"00000\")\n</code></pre>\n\n<p>Be aware that your <code>CleanString(myVal)</code> has to be a string of length 2. If it has <em>any</em> length, it still needs some modification (i.e. with a 3 digits value, the final number will be on 16 digits)</p>\n\n<p>So if you want to allow that <code>CleanString</code> have more than two digits, do this to keep always a 15 digits length:</p>\n\n<pre><code>    Dim s As String: s = CleanString(myVal)\n    newString= Left(oldString, 8) &amp; s &amp; Format(Cells(vRow, 8).Value, String(7 - Len(s), \"0\"))\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 41710822, "answer_count": 1, "score": -1, "last_activity_date": 1484710495, "creation_date": 1484700932, "last_edit_date": 1484710495, "question_id": 41709701, "link": "https://stackoverflow.com/questions/41709701/condition-as-to-cater-with-preset-value-in-a-format", "title": "Condition as to cater with preset value in a format", "body": "<p>My previous VBA code is like this</p>\n\n<pre><code>field9 = 00 &amp; Format(Date, \"YYYYMM\") &amp; CleanString(myVal) &amp; _\n         Format(Cells(vRow, 8).Value, \"00000\")\n</code></pre>\n\n<p>This field9 variable will be used to convert my excel numbers in a field\nfrom 000000000000006(preset value) to 02017010100006 (from what i've set in field 9). The <code>CleanString(myVal)</code> i use to pass autogenerate sequence number from other module.</p>\n\n<p>Currently i need to modify this thing in order to cater with my new requirement which  is \n002017010000006( preset value) to 002017010100006. I need to remain the preset value as i can't use my current code because it will have more digits. I need assistance for this. </p>\n\n<p>i will further explain what the problem is.\nThe first part is what my variable are meant to do</p>\n\n<pre><code>000000000000006(pulled this from text file) to 002017010100006(vba code processed)\n</code></pre>\n\n<p>\"00\"\"201701\"\"01\"\"00006\"<br>\n   1. preset 00 in my code<br>\n   2. 201701 is YYYYMM<br>\n   3. myval is my running sequence number 01-99<br>\n   4. i format my cell into 00000 let say if this field having 1 then it will be\n   00001 \n5. i can do this using my current formula</p>\n\n<p>The problem now is</p>\n\n<pre><code>002017010000006(pulled this from text file) to 002017010100006(vba code processed) \n</code></pre>\n\n<p>1. This 002017010000006 is from a text file too<br>\n2. if i am going to use my current formula, i will having this kind of issues\n   as it will be more than 15 digits 00201701012017010013676 </p>\n\n<p>i need solution in maintaining \"201701\" from my text files instead of using <code>Format(Date, \"YYYYMM\")</code> from my current solutions</p>\n\n<p>This is the outcome i need <code>002017010100006</code> just 15 digits</p>\n\n<p>p/s: i have edited my info for further understanding, as i have not cleared with my question and there's some wrong info in this too. i am sorry for the inconvenience</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["xml", "vba", "svg", "xml-namespaces"], "answers": [{"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1484750089, "post_id": 41712921, "comment_id": 70638786, "body": "Sadly, given the link I edited into question this looks correct but I&#39;m not happy about introducing a fake namespace."}, {"owner": {"reputation": 6109, "user_id": 2346420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f566bd36c0a3b85e6a3af8aa7a2ad58?s=128&d=identicon&r=PG", "display_name": "Holger Will", "link": "https://stackoverflow.com/users/2346420/holger-will"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1484750332, "post_id": 41712921, "comment_id": 70638968, "body": "it&#39;s not a fake namespace, ist just a prefix which you use to tell xPath wich namespace you are talking about.   the namespace is the <code>http:&#47;&#47;www.w3.org&#47;2000&#47;svg</code>-part.   I think what you want is to tell xPath that the svg namespace should be treated as the default namespace. I don&#39;t think that&#39;s possible..."}], "tags": [], "owner": {"reputation": 6109, "user_id": 2346420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f566bd36c0a3b85e6a3af8aa7a2ad58?s=128&d=identicon&r=PG", "display_name": "Holger Will", "link": "https://stackoverflow.com/users/2346420/holger-will"}, "is_accepted": true, "score": 3, "last_activity_date": 1484721688, "creation_date": 1484721688, "answer_id": 41712921, "question_id": 41709599, "link": "https://stackoverflow.com/questions/41709599/vba-xml-selection-namespace-issue/41712921#41712921", "title": "VBA XML Selection Namespace issue", "body": "<p>as far as i remember, selectionNamespace is a list of namspaces/prefixes for use in the selection language (xPath). It is used to switch between namespaces in xPath. Try it like this:</p>\n\n<pre><code> dom.setProperty \"SelectionNamespaces\", \"xmlns:svg=\"\"http://www.w3.org/2000/svg\"\"\"\n\n    Dim xmlSVG As MSXML2.IXMLDOMElement\n    Set xmlSVG = dom.SelectSingleNode(\"svg:svg\")\n    Debug.Assert Not dom.SelectSingleNode(\"svg:svg\") Is Nothing\n    Debug.Assert Not dom.SelectSingleNode(\"/svg:svg\") Is Nothing\n</code></pre>\n\n<p>P.S.: It's been a while since i last used Windows, so i can not garantee anything :-(</p>\n"}], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2993, "favorite_count": 2, "accepted_answer_id": 41712921, "answer_count": 1, "score": 2, "last_activity_date": 1484748443, "creation_date": 1484700269, "last_edit_date": 1484748443, "question_id": 41709599, "link": "https://stackoverflow.com/questions/41709599/vba-xml-selection-namespace-issue", "title": "VBA XML Selection Namespace issue", "body": "<p>So I'm sure this is solvable, but it's just I don't normally have to deal with XML namespaces in VBA XML code.  So, we have a file which is in fact an SVG file called <code>Flag_of_the_United_Kingdom.svg</code> and here is the file contents</p>\n\n<pre><code>&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 60 30\" width=\"1200\" height=\"600\"&gt;\n  &lt;clipPath id=\"t\"&gt;\n    &lt;path d=\"M30,15 h30 v15 z v15 h-30 z h-30 v-15 z v-15 h30 z\"/&gt;\n  &lt;/clipPath&gt;\n  &lt;path d=\"M0,0 v30 h60 v-30 z\" fill=\"#00247d\"/&gt;\n  &lt;path d=\"M0,0 L60,30 M60,0 L0,30\" stroke=\"#fff\" stroke-width=\"6\"/&gt;\n  &lt;path d=\"M0,0 L60,30 M60,0 L0,30\" clip-path=\"url(#t)\" stroke=\"#cf142b\" stroke-width=\"4\"/&gt;\n  &lt;path d=\"M30,0 v30 M0,15 h60\" stroke=\"#fff\" stroke-width=\"10\"/&gt;\n  &lt;path d=\"M30,0 v30 M0,15 h60\" stroke=\"#cf142b\" stroke-width=\"6\"/&gt;\n&lt;/svg&gt;\n</code></pre>\n\n<p>This is just an example SVG file, but it holds for other SVG files, for Internet Explorer to render the file it needs the namespace attribute on the root element.   </p>\n\n<p>However, I want to open an SVG file in VBA and start manipulating it and my code is tripping on the namespace issue.  Here is my code which is housed in a standard module in a workbook in same directory ...</p>\n\n<pre><code>Option Explicit\n\nSub LoadSVGFile()\n    '* Tools-&gt;References-&gt;Microsoft Xml, v6.0\n\n    Dim fso As Object\n    Set fso = VBA.CreateObject(\"Scripting.FileSystemObject\")\n\n    Dim sSVGPath As String\n    sSVGPath = fso.BuildPath(ThisWorkbook.Path, \"Flag_of_the_United_Kingdom.svg\")\n    If fso.FileExists(sSVGPath) Then\n\n        Dim dom As MSXML2.DOMDocument60\n        Set dom = New MSXML2.DOMDocument60\n\n        dom.Load sSVGPath\n\n        Debug.Assert dom.parseError = 0\n\n        'xmlns=\"http://www.w3.org/2000/svg\n        'dom.namespaces.Add \"http://www.w3.org/2000/svg\", \"xmlns\"\n\n        dom.setProperty \"SelectionNamespaces\", \"xmlns=\"\"http://www.w3.org/2000/svg\"\"\"\n        'Call dom.setProperty(\"SelectionLanguage\", \"XPath\")\n\n        Dim xmlSVG As MSXML2.IXMLDOMElement\n        Set xmlSVG = dom.SelectSingleNode(\"svg\")\n        Debug.Assert Not dom.SelectSingleNode(\"svg\") Is Nothing\n        Debug.Assert Not dom.SelectSingleNode(\"/svg\") Is Nothing\n\n        If xmlSVG Is Nothing Then End\n\n        '* rest of code follows here but is not shown\n        Debug.Print \"'* rest of code follows here but is not shown\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The above code works when I have removed the namespace attribute from the root element, but that is no good because these files get generated by Inkscape etc.</p>\n\n<p>I'm sure it is a <code>SelectionNamespaces</code> property issue, but I cannot get it to work, I'm sure someone could solve this easily.</p>\n\n<p>UPDATE: Googling around on this looks like this is the expected behaviour re <a href=\"https://support.microsoft.com/en-gb/kb/288147\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-gb/kb/288147</a></p>\n"}, {"tags": ["sql-server", "vba", "ms-access", "stored-procedures"], "comments": [{"owner": {"reputation": 51, "user_id": 2872592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X1LjN.jpg?s=128&g=1", "display_name": "Barry Seymour", "link": "https://stackoverflow.com/users/2872592/barry-seymour"}, "edited": false, "score": 0, "creation_date": 1484754039, "post_id": 41709498, "comment_id": 70641733, "body": "Where is the duplicate? I have searched Stack Overflow and found other similar questions, but those solutions don&#39;t work either."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 1, "creation_date": 1484756110, "post_id": 41709498, "comment_id": 70643134, "body": "The &quot;duplicate&quot; banner at the top of the question contains the <a href=\"http://stackoverflow.com/questions/40530836/invalid-sql-statement-error-when-trying-to-execute-sql-server-stored-procedure\">link</a>."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1484758627, "post_id": 41709498, "comment_id": 70644967, "body": "Just a note, you can&#39;t do <code>Set Rs = CurrentDb.OpenRecordset(SQL, dbOpenSnapshot, dbSQLPassThrough)</code> - where would the ODBC connect string come from? You need a PassThrough query."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2872592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X1LjN.jpg?s=128&g=1", "display_name": "Barry Seymour", "link": "https://stackoverflow.com/users/2872592/barry-seymour"}, "edited": false, "score": 0, "creation_date": 1484755591, "post_id": 41712446, "comment_id": 70642779, "body": "sReplaceDevice performs an update AND returns a value. The procedure works, the SQL I was assembling was correct, but still it threw errors in Access.    I then tried to execute a separate query to get the ID of the newly created record. Since I was querying a table with an identity column it told me I had to use &#39;dbSeeChanges&#39;, even though I WAS.   In the end my solution was to use a query with the MAX aggregate function in order to get the ID of the new record created in the relevant table. At that point it stopped complaining about an identity column and returned the value I wanted."}, {"owner": {"reputation": 51, "user_id": 2872592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X1LjN.jpg?s=128&g=1", "display_name": "Barry Seymour", "link": "https://stackoverflow.com/users/2872592/barry-seymour"}, "edited": false, "score": 0, "creation_date": 1484755861, "post_id": 41712446, "comment_id": 70642970, "body": "DUH. I missed the link to the duplicate question above. My apologies."}], "tags": [], "owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "is_accepted": false, "score": 0, "last_activity_date": 1484719503, "last_edit_date": 1495542275, "creation_date": 1484719503, "answer_id": 41712446, "question_id": 41709498, "link": "https://stackoverflow.com/questions/41709498/microsoft-access-execute-a-stored-procedure-and-return-results-using-dao-erro/41712446#41712446", "title": "Microsoft Access: Execute a Stored Procedure and return results using DAO - Errors", "body": "<p>Does sReplaceDevice return a value? Or just update data? If it's just performing an update, then the problem is likely that you're trying to open it as a record set, whereas you should just be doing ExecuteNonQuery. Like <a href=\"https://stackoverflow.com/questions/17729200/executenonquery-for-insert\">this</a></p>\n"}], "owner": {"reputation": 51, "user_id": 2872592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X1LjN.jpg?s=128&g=1", "display_name": "Barry Seymour", "link": "https://stackoverflow.com/users/2872592/barry-seymour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1132, "favorite_count": 0, "closed_date": 1484744536, "answer_count": 1, "score": 1, "last_activity_date": 1484754106, "creation_date": 1484699735, "last_edit_date": 1484754106, "question_id": 41709498, "link": "https://stackoverflow.com/questions/41709498/microsoft-access-execute-a-stored-procedure-and-return-results-using-dao-erro", "closed_reason": "Duplicate", "title": "Microsoft Access: Execute a Stored Procedure and return results using DAO - Errors", "body": "<p>I am trying to execute a stored procedure in Access 2013 using VBA. On 64-bit Windows 10 with 32-bit Access 2013 (corporate standard, can't change that).</p>\n\n<p>Connecting to a SQL Server 2008.</p>\n\n<p>Not sure why this is so hard, but I just can't make it work!</p>\n\n<p>I have a generic function named SQLExec:</p>\n\n<pre><code>Public Function SQLExec(SQL as String) As DAO.Recordset\n    Dim Rs As DAO.Recordset\n    Dim MyDB As DAO.DATABASE\n\n    Debug.Print SQL\n\n    On Error GoTo SQLExecErr\n\n    Set MyDB = CurrentDb\n    Set Rs = MyDB.OpenRecordset(SQL, dbOpenSnapshot, dbSQLPassThrough)\n\n    Set SQLExec = Rs\n\nCleanUp:\n    Set Rs = Nothing\n    Set MyDB = Nothing\n\nExit Function\n\nSQLExecErr:\n    Debug.Print Err.Number, Err.Description\n    MsgBox \"Error \" &amp; Err.Number &amp; \" in SQLExec: '\" &amp; Err.Description &amp; \".'\", vbOKOnly + vbCritical, \"Error in SQLExec\"\n\n    If IsDeveloper() Then\n        Stop\n        Resume\n    Else\n        Resume CleanUp\n    End If\n\nEnd Function\n</code></pre>\n\n<p>I try to pass in a procedure name with parameters, but it always fails.</p>\n\n<pre><code>sReplaceDevice 'AA000000', 1000, 'AA000000', 'AA000001', 19\"\n</code></pre>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>Error 3129 in SQLExec: 'Invalid SQL statement; expected 'DELETE', 'INSERT',  'PROCEDURE', 'SELECT', or 'UPDATE'..'</p>\n</blockquote>\n\n<p>I tried prepending <code>EXECUTE</code> and <code>PROCEDURE</code> - same result. I tried adding the parameter IDs to the query (@param1 ='test', for example.) - still same result.</p>\n\n<p>Does anyone have any suggestions? I'm dumbfounded that this should be so hard.</p>\n\n<p>EDIT: This question has been marked as a duplicate of another question. Firstly, it would be nice if a link to that other question were provided. Secondly, I have searched and searched on this question and have come up with several solutions, some from StackOverflow, NONE OF WHICH WORK. Any input would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 7402499, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/72f85ba88e22f99c290824f654397da8?s=128&d=identicon&r=PG&f=1", "display_name": "hardish", "link": "https://stackoverflow.com/users/7402499/hardish"}, "edited": false, "score": 1, "creation_date": 1484784891, "post_id": 41709577, "comment_id": 70657714, "body": "the first line worked with my activeX checkbox. Thanks!"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1484710663, "last_edit_date": 1484710663, "creation_date": 1484700154, "answer_id": 41709577, "question_id": 41709261, "link": "https://stackoverflow.com/questions/41709261/get-activex-checkbox-status-checked-or-not-checked/41709577#41709577", "title": "Get ActiveX checkbox status (checked or not checked)", "body": "<p>I guess you're not using an <code>ActiveX</code> checkbox, this one <em>has</em> a <code>.value</code> but if you access it directly as an object variable, i.e. </p>\n\n<pre><code> Debug.Print Worksheets(\"Summary\").chkbxRunLocally.Value\n</code></pre>\n\n<p>If you are using a normal Excel shape (non ActiveX), Try this:</p>\n\n<pre><code>Debug.Print Worksheets(\"Summary\").Shapes(\"chkbxRunLocally\").ControlFormat.Value = 1\n</code></pre>\n\n<p>or also</p>\n\n<pre><code>Debug.Print Worksheets(\"Summary\").CheckBoxes(\"chkbxRunLocally\").Value = 1\n</code></pre>\n\n<p>Notice the <code>=1</code> which is True if the shape is checked, False if unchecked. When it is unchecked, the returned <code>.Value</code> is <code>-4146</code> which is also true if converted directly to a Boolean. The test <code>=1</code> decides (as Boolean) whether the control is actually checked or not.</p>\n"}], "owner": {"reputation": 145, "user_id": 7402499, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/72f85ba88e22f99c290824f654397da8?s=128&d=identicon&r=PG&f=1", "display_name": "hardish", "link": "https://stackoverflow.com/users/7402499/hardish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1108, "favorite_count": 0, "accepted_answer_id": 41709577, "answer_count": 1, "score": 0, "last_activity_date": 1484710663, "creation_date": 1484698064, "last_edit_date": 1531164843, "question_id": 41709261, "link": "https://stackoverflow.com/questions/41709261/get-activex-checkbox-status-checked-or-not-checked", "title": "Get ActiveX checkbox status (checked or not checked)", "body": "<p>How do you access the value of a checkbox' status. I was expecting to see something like a Value property which would be True if the checkbox is checked. However, the following does not work:</p>\n\n<pre><code>Worksheets(\"Summary\").Shapes(\"chkbxRunLocally\").controlform.Value\n</code></pre>\n\n<p>It throws:</p>\n\n<pre><code>Object does not support this property or method\n</code></pre>\n\n<p>If this is not where the property stored, where then?</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 5958813, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GWzPq3my4X0/AAAAAAAAAAI/AAAAAAAAER4/tGRs3HWt76c/photo.jpg?sz=128", "display_name": "Ma chete", "link": "https://stackoverflow.com/users/5958813/ma-chete"}, "is_accepted": false, "score": 0, "last_activity_date": 1484818516, "last_edit_date": 1495540392, "creation_date": 1484818516, "answer_id": 41738279, "question_id": 41708924, "link": "https://stackoverflow.com/questions/41708924/vba-runtime-error-70-under-mac-office-2015/41738279#41738279", "title": "VBA Runtime Error 70 under Mac Office 2015", "body": "<p>Ok finally i found the solution to the problem with the Mac office 2016. The problem is that in the new Version you cannot access files just by default. So added following to my Code:</p>\n\n<pre><code>'Declare Variables?\nDim fileAccessGranted As Boolean\nDim filePermissionCandidates\n\n'Create an array with file paths for which permissions are needed?\nfilePermissionCandidates = Array(path, ActiveWorkbook.path)\n\n'Request Access from User?\nfileAccessGranted = GrantAccessToMultipleFiles(filePermissionCandidates)       \n'returns true if access granted, false otherwise?\n</code></pre>\n\n<p>Simpy this thread helped me a lot:\n<a href=\"https://stackoverflow.com/questions/30971616/vb-macros-for-office-2016-for-mac-require-permissions-every-time-they-try-to-acc\">VB Macros for Office 2016 for Mac require Permissions every time they try to access a file! Is there any way to get around this behavior?</a></p>\n\n<p>Best Regards\nMachete</p>\n\n<p>PS. needed to Unprotect the Worksheet too!</p>\n"}], "owner": {"reputation": 33, "user_id": 5958813, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GWzPq3my4X0/AAAAAAAAAAI/AAAAAAAAER4/tGRs3HWt76c/photo.jpg?sz=128", "display_name": "Ma chete", "link": "https://stackoverflow.com/users/5958813/ma-chete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 546, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593679150, "creation_date": 1484696005, "last_edit_date": 1593679150, "question_id": 41708924, "link": "https://stackoverflow.com/questions/41708924/vba-runtime-error-70-under-mac-office-2015", "title": "VBA Runtime Error 70 under Mac Office 2015", "body": "<p>Hello Guys i have this simple script where i apply a chart template on 2 Charts in my Spreadsheet. Obviously this works great under Windows 10, Mac Office 2011 but not on Mac Office 2015.</p>\n\n<p>Im gettin an Error, Runtime Error 70 - Permission Denied\nBoth Files are located in the Same folder, and the Names are correct. </p>\n\n<pre><code> Sub Makro_Setup()\n'\n' Makro_Setup Makro\n    '\n' Tastenkombination: Strg+Umschalt+B\n'\nWorksheets(\"Auswertung\").Activate\n\nDim path As String   \nDim TheOS As String\n\nTheOS = Application.OperatingSystem\n\nIf MAC_OFFICE_VERSION &gt;= 15 Then\nMsgBox \"Not Good\"\nElse\nMsgBox \"Good\"\nEnd If\n\npath = ActiveWorkbook.path + \"/Diagramm1.crtx\"\n\nMsgBox TheOS\nMsgBox path\n\nActiveSheet.ChartObjects(\"Diagramm 2\").Activate\nActiveChart.PlotArea.Select\n\n' Here comes the error 70 -START\nActiveChart.ApplyChartTemplate path\n' Here comes the error 70 -END\n\nActiveSheet.ChartObjects(\"Diagramm 5\").Activate\nActiveChart.PlotArea.Select\nActiveChart.ApplyChartTemplate path\n\nEnd Sub\n</code></pre>\n\n<p>Maybe Somebody can help me with this :(</p>\n\n<p>Ps.: the path ist correct: /users/....</p>\n\n<p>Best Regards \nMachete</p>\n"}, {"tags": ["vba", "performance", "multidimensional-array"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 3, "creation_date": 1484696144, "post_id": 41708876, "comment_id": 70613316, "body": "YES it is feasible in VBA, go for it."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1484704170, "last_edit_date": 1484704170, "creation_date": 1484702478, "answer_id": 41709907, "question_id": 41708876, "link": "https://stackoverflow.com/questions/41708876/vba-simulations-and-arrays/41709907#41709907", "title": "vba, simulations and arrays", "body": "<p>Yes, this is quite feasible. I do such things all the time.</p>\n\n<p>When I first started using VBA 15-20 years ago, performance was often an issue, and it is still an issue for certain things. But by the magic of <a href=\"https://en.wikipedia.org/wiki/Moore&#39;s_law\" rel=\"nofollow noreferrer\">Moore's law</a>, VBA on my 2+ year old laptop matches the speed of compiled C 20 years ago:</p>\n\n<pre><code>Sub quick()\n    Dim i As Long, sum As Long\n    Dim start As Double, elapsed As Double\n    start = Timer\n    For i = 1 To 100000000\n        sum = sum + 1\n    Next i\n    elapsed = Timer - start\n    Debug.Print \"Sum of \" &amp; sum &amp; \" computed in \" &amp; elapsed &amp; \" seconds\"\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Sum of 100000000 computed in 0.765625 seconds\n</code></pre>\n\n<p>100 million passes through a loop in less than a second. Even if a simulation requires in the low billions of floating point operations, it might run in less than a minute. Unless each of those 5000 individual simulation steps of yours require hundreds of millions of computations, you should be fine.</p>\n\n<p>So -- start coding. If you get stuck, post another question.</p>\n\n<p>A word of warning: VBA is fast. Excel itself is fast. The bridge that links the two (the Excel Object Model) is slow. To get acceptable speed you should minimize transfer of data between the worksheet and VBA. A common beginner mistake is to use the spreadsheet itself as a data structure. Write the simulation itself in pure VBA with interaction with the spreadsheet largely confined to reading initial values at the beginning of the simulation and writing the output to the spreadsheet at the end.</p>\n"}], "owner": {"reputation": 41, "user_id": 7432945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28334a9616348b9dfdb1eeb4c9c695a0?s=128&d=identicon&r=PG&f=1", "display_name": "Ski bum", "link": "https://stackoverflow.com/users/7432945/ski-bum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "closed_date": 1484724784, "answer_count": 1, "score": 2, "last_activity_date": 1484704170, "creation_date": 1484695742, "question_id": 41708876, "link": "https://stackoverflow.com/questions/41708876/vba-simulations-and-arrays", "closed_reason": "Opinion-based", "title": "vba, simulations and arrays", "body": "<p>I'm rather new to programming, and I am trying to determine if the following simulation is feasible in VBA:  A monte carlo simulation that involves 36 time periods, 20 simulation variables per period, and up to 5000 simulations per period.  The results of the simulations are then aggregated for each period to create 36 distributions (one per period).  This appears to be a 3d array that has to store variables, requires looping...etc.  I'm worried about computation time. Seems like this may be too much for vba to handle, so I wanted to get some feedback.  Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484722568, "post_id": 41708630, "comment_id": 70621064, "body": "you&#39;d better add data examples (&quot;before&quot; and &quot;after&quot; scenarios) and some code of yours, even if not functioning"}, {"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486054319, "post_id": 41708630, "comment_id": 71191541, "body": "Hi user3598756, I have attached &quot;before&#39; and &quot;after&quot; scenarios of my problem. In regards to the code, I do not know even where to start. I appreciate any guidance you can provide for me."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1484716814, "post_id": 41709256, "comment_id": 70618912, "body": "Hi ClintB, thank you for taking the time out to reply. Apologies for the confusion, please see my edits above. I have rewritten the question."}, {"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1486054419, "post_id": 41709256, "comment_id": 71191611, "body": "Hi ClintB, I have attached &quot;before&quot; and &quot;after&quot; images to my question. Please let me know if I can offer any supporting evidence to my problem. I am at a complete standstill on my automation project with this. Thank you."}], "tags": [], "owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "is_accepted": false, "score": -1, "last_activity_date": 1484698046, "creation_date": 1484698046, "answer_id": 41709256, "question_id": 41708630, "link": "https://stackoverflow.com/questions/41708630/using-a-reference-range-to-randomly-highlight-cells-in-adjacent-range/41709256#41709256", "title": "Using A Reference Range to Randomly Highlight Cells In Adjacent Range", "body": "<p>You can use conditional formatting to highlight a column based upon another one. Or you could write a macro to change the colors.</p>\n\n<p>Your description doesn't really explain properly what you are trying to do.</p>\n\n<p>In order to choose your random rows you need some sort of event to fire. This could be a button, a mouseover, data entry, etc. Also when you say random do you mean you want to get a random no between the lowest row and the highest row and randomly highlight this. Or do you mean you want to randomly pick a name and highlight all occurrences of this name. </p>\n\n<p>There are so many different variables and ways you could go about this that with the little information you have provided its unlikely anyone will be able to help you.</p>\n"}], "owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1486054245, "creation_date": 1484694342, "last_edit_date": 1531164843, "question_id": 41708630, "link": "https://stackoverflow.com/questions/41708630/using-a-reference-range-to-randomly-highlight-cells-in-adjacent-range", "title": "Using A Reference Range to Randomly Highlight Cells In Adjacent Range", "body": "<p>I am attempting to highlight rows on a data table (Table 1), at random, based on two criteria from Table 2. I have spent hours searching for a solution to this problem but have not found it. </p>\n\n<p>I have two tables of data. Table 1 contains two columns, Column A which will have a \"Check\" word coded to be populated automatically based on criteria in table 2, and Column B which has different names down the rows, some of which can be duplicated. (ex: Jane, Rich, Rick, Janna, Jane, Jane, Jane, etc.)</p>\n\n<p>Table 2 Column A will have all the names de-duplicated from Table 1 Column B, and Table 2 Column B will have a number which indicates the number of rows to be highlighted in Table 1.</p>\n\n<p><a href=\"https://i.stack.imgur.com/v9Vtm.jpg\" rel=\"nofollow noreferrer\">Table 1 &amp; Table 2</a></p>\n\n<p>I would like to write a code in which the number of rows in Table 2 Column B will be randomly selected in Table 1 based on the matching name from Table 2, and Table 1 Column A will automatically be populated with the word \"Check\" and highlight the entire row as well.</p>\n\n<p><a href=\"https://i.stack.imgur.com/atXkj.jpg\" rel=\"nofollow noreferrer\">Finished Table 1</a></p>\n\n<p>Thank you in advance for any guidance that can be given.</p>\n"}, {"tags": ["windows", "vba", "excel", "shell"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484692309, "post_id": 41708088, "comment_id": 70611900, "body": "If you&#39;re not tied to paping: <a href=\"http://stackoverflow.com/questions/34682073/unable-to-change-ping-timeout-in-excel-vba-ip-list-ping\" title=\"unable to change ping timeout in excel vba ip list ping\">stackoverflow.com/questions/34682073/&hellip;</a>"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1484695471, "post_id": 41708088, "comment_id": 70613095, "body": "I&#39;m not familiar with <code>paping.exe</code>, but it looks like the code to do this in WMI would be shorter anyhow: <a href=\"http://stackoverflow.com/questions/31680992/quickest-way-to-determine-if-a-remote-pc-is-online\" title=\"quickest way to determine if a remote pc is online\">stackoverflow.com/questions/31680992/&hellip;</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1484696248, "post_id": 41708088, "comment_id": 70613354, "body": "If you&#39;re not tied to synchronous processing: <a href=\"http://stackoverflow.com/a/29869308/4088852\">stackoverflow.com/a/29869308/4088852</a>"}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484750234, "post_id": 41708088, "comment_id": 70638893, "body": "@Comintern I love the idea in the link, however, it is a bit advanced given my skills.  If you have a more simplified understanding of asynchronous pings, please let me know."}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484764171, "post_id": 41708088, "comment_id": 70648151, "body": "@Comintern At a second glance, I notice that the solution is actually yours.  Would love to connect and try to gain a bit more and see if it is a viable solution for what I am doing."}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1485559834, "creation_date": 1485559834, "answer_id": 41904692, "question_id": 41708088, "link": "https://stackoverflow.com/questions/41708088/move-macro-forward-when-caught-stuck-in-process/41904692#41904692", "title": "Move macro forward when caught/stuck in process", "body": "<p>I could not get <code>paping.exe</code> to run on my machine so I wrote some code using <code>ping.exe</code> instead.</p>\n\n<p>In principle one can shell out and redirect output to file and then pick up the file later when finished.  We use Windows API calls to wait for a process to finish.</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function OpenProcess Lib \"kernel32\" (ByVal dwDesiredAccess As Long, ByVal bInheritHandle As Long, ByVal dwProcessId As Long) As Long\nPrivate Declare Function CloseHandle Lib \"kernel32\" (ByVal hObject As Long) As Long\nPrivate Declare Function WaitForSingleObject Lib \"kernel32.dll\" (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long\n\nPrivate Const INFINITE = &amp;HFFFF\nPrivate Const PROCESS_ALL_ACCESS = &amp;H1F0FFF\n\nSub TestShellAndRedirectPingToFile()\n\n    Dim vIPAddresses As Variant\n    vIPAddresses = Array(\"bbc.co.uk\", \"wikipedia.org\", \"cnn.com\")\n\n    Dim dicFilesToPickUp As Scripting.Dictionary\n    Set dicFilesToPickUp = ShellAndRedirectPingToFile(vIPAddresses)\n\n    Dim vKeyLoop As Variant\n    For Each vKeyLoop In dicFilesToPickUp.Keys\n        Dim lPID As Long\n        lPID = dicFilesToPickUp.Item(vKeyLoop)\n\n        Dim hProc As Long\n        hProc = OpenProcess(PROCESS_ALL_ACCESS, 0&amp;, lPID)\n\n\n        Debug.Print \"Waiting on \" &amp; vKeyLoop &amp; \" (\" &amp; lPID &amp; \")\"\n        WaitForSingleObject hProc, INFINITE\n        CloseHandle hProc '* be nice and close handles\n    Next\n    Debug.Print \"Done! Files ready to read.\"\n\n\nEnd Sub\n\nFunction ShellAndRedirectPingToFile(ByVal vIPAddresses As Variant) As Scripting.Dictionary\n\n    Dim dicFilesToPickUp As Scripting.Dictionary\n    Set dicFilesToPickUp = New Scripting.Dictionary\n\n    Dim sTempFolder As String\n    sTempFolder = Environ$(\"TEMP\")\n    If Right$(sTempFolder, 1) &lt;&gt; \"\\\" Then sTempFolder = sTempFolder &amp; \"\\\"\n\n    Dim vAddressLoop As Variant\n    For Each vAddressLoop In vIPAddresses\n        Dim sTempFile As String\n        sTempFile = sTempFolder &amp; vAddressLoop &amp; \".txt\"\n\n        Dim sCmd As String\n        sCmd = Environ$(\"comspec\") &amp; \" /S /C ping.exe \" &amp; vAddressLoop &amp; \" &gt; \" &amp; sTempFile\n\n        Dim lPID As Long\n        lPID = VBA.Shell(sCmd)\n        dicFilesToPickUp.Add sTempFile, lPID\n    Next\n\n    Set ShellAndRedirectPingToFile = dicFilesToPickUp\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1485559834, "creation_date": 1484691804, "last_edit_date": 1531164843, "question_id": 41708088, "link": "https://stackoverflow.com/questions/41708088/move-macro-forward-when-caught-stuck-in-process", "title": "Move macro forward when caught/stuck in process", "body": "<p>I have written a macro that uses the <code>paping.exe</code> program to cycle through a list of device IP addresses by sending pings and recording their return values. While the macro works as intended for the majority of the time, there are spare moments when the <code>ping</code> command appears to be stuck or caught up and stops moving forward.  This causes me to have to manually break the execution and start the process over.</p>\n\n<p>From a more broad perspective, is there a way to handle this <code>runtime</code> error.  My thought was to break the list of devices into groupings, and if the program becomes stuck, I could tell the macro to move forward to the next grouping.  While just an idle idea, I wanted to reach out to the community for advice, tips and ideas on ways I could more eloquently handle this issue.  The list of devices that I am pinging is set to grow in time as well.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub getPingStatusCode(IPvalue As String, portValue As String)\n\nret = WshShell.Run(\"C:\\Users\\*******\\paping.exe \" &amp; IPvalue &amp; \" -p \" &amp; portValue &amp; \" -c \" &amp; pingCount &amp; \" -t \" &amp; pingTime, 0, True)  'CHANGEEEEEEE\ntotalCounter = totalCounter + 1\n\nSelect Case ret\n    Case 0: strResult = \"Connected\"\n    Case 1: strResult = \"Fail\"\n    Case 11001: strResult = \"Buffer too small\"\n    Case 11002: strResult = \"Destination net unreachable\"\n    Case 11003: strResult = \"Destination host unreachable\"\n    Case 11004: strResult = \"Destination protocol unreachable\"\n    Case 11005: strResult = \"Destination port unreachable\"\n    Case 11006: strResult = \"No resources\"\n    Case 11007: strResult = \"Bad option\"\n    Case 11008: strResult = \"Hardware error\"\n    Case 11009: strResult = \"Packet too big\"\n    Case 11010: strResult = \"Request timed out\"\n    Case 11011: strResult = \"Bad request\"\n    Case 11012: strResult = \"Bad route\"\n    Case 11013: strResult = \"TTL expired transit\"\n    Case 11014: strResult = \"TTL expired reassembly\"\n    Case 11015: strResult = \"Parameter problem\"\n    Case 11016: strResult = \"Source quench\"\n    Case 11017: strResult = \"Option too big\"\n    Case 11018: strResult = \"Bad destination\"\n    Case 11032: strResult = \"Negotiating IPSEC\"\n    Case 11050: strResult = \"General failure\"\n    Case Else: strResult = \"Unknown host\"\nEnd Select\n\n'if statement on return value for bolding and font color\n'and counters\nIf ret = 0 Then 'CONNECTED\n\n    With pingSheet.Cells(i, 4)\n        .Value = strResult\n    End With\n    totalOn = totalOn + 1\n    onOff = 1\n\n    'set the rawDataSheet value to connected status...assumes that the sheet starts with all rawdata values as \"connected\"\n    rawDataSheet.Cells(4, i).Value = strResult\n\nElseIf ret = 1 Then 'FAILED\n\n    With pingSheet.Cells(i, 4)\n        .Value = strResult\n        .Font.Color = vbRed\n        .Font.bold = True\n    End With\n    failCounter = failCounter + 1\n    onOff = 0\n\n    'give RawData sheet a \"down since\" date value\n    If rawDataSheet.Cells(4, i).Value = \"Connected\" Then\n        rawDataSheet.Cells(4, i).Value = Now\n    End If\n\n    ''''''''''''''\n    pdfDeviceDump\n\nElse\n\n    With pingSheet.Cells(i, 4)\n        .Value = strResult\n        .Font.Color = vbRed\n        .Font.bold = True\n    End With\n    failCounter = failCounter + 1\n    onOff = 0\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}]