[{"tags": ["sql", "excel", "powerquery", "vba"], "comments": [{"owner": {"reputation": 2692, "user_id": 7163813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0315985ad9ac587ff4d9466a998fe607?s=128&d=identicon&r=PG", "display_name": "MarcelBeug", "link": "https://stackoverflow.com/users/7163813/marcelbeug"}, "edited": false, "score": 0, "creation_date": 1512624073, "post_id": 47685272, "comment_id": 82335440, "body": "Cross posted on TechNet: <a href=\"https://social.technet.microsoft.com/Forums/en-US/31c42f25-af7a-4c98-a6dd-b0781ffdce4f/using-one-or-two-or-both-parameters-for-query-in-power-query-where-statement?forum=powerquery\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/Forums/en-US/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9064539, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155372350386523/picture?type=large", "display_name": "Eugene Kwok Kit Ho", "link": "https://stackoverflow.com/users/9064539/eugene-kwok-kit-ho"}, "edited": false, "score": 0, "creation_date": 1512946706, "post_id": 47685376, "comment_id": 82448857, "body": "Thanks for your response! However i did try it and it didnt quite work, it game me something about not able to convert a varchar into int. What i found was that you made a.SerialNumber Null which is the table itself and what i am hoping to get is that sometimes we dont know what serial number to query for rather than the serial number field being empt."}, {"owner": {"reputation": 11, "user_id": 9064539, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155372350386523/picture?type=large", "display_name": "Eugene Kwok Kit Ho", "link": "https://stackoverflow.com/users/9064539/eugene-kwok-kit-ho"}, "edited": false, "score": 0, "creation_date": 1512947594, "post_id": 47685376, "comment_id": 82449073, "body": "Think of it as me having say 7 serial numbers between 3 work, and i know what work orders i want to search for but not which serial numbers. Therefore i simply put the 2 work orders in and it gives me 5 of the serial numbers. But when i know which specific serial numbers i put it in as well as an added layer of filter which gives me the specific serial numbers"}], "tags": [], "owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "is_accepted": false, "score": 0, "last_activity_date": 1512603992, "creation_date": 1512603992, "answer_id": 47685376, "question_id": 47685272, "link": "https://stackoverflow.com/questions/47685272/if-statements-in-where-condition-with-possible-empty-or-null-parameters-power-qu/47685376#47685376", "title": "If statements in Where Condition with possible empty or Null parameters Power Query Excel SQL", "body": "<p>Give this a try:</p>\n\n<pre><code>Where\n(a.SerialNumber Is Null Or a.SerialNumber in ('\"&amp; SerialNumberP &amp;\"')) and\n(b.WorkOrderNumber Is Null Or b.WorkOrderNumber in ('\"&amp; WorkOrderNumberP &amp;\"'))\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9064539, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155372350386523/picture?type=large", "display_name": "Eugene Kwok Kit Ho", "link": "https://stackoverflow.com/users/9064539/eugene-kwok-kit-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 670, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512603992, "creation_date": 1512603363, "last_edit_date": 1531164843, "question_id": 47685272, "link": "https://stackoverflow.com/questions/47685272/if-statements-in-where-condition-with-possible-empty-or-null-parameters-power-qu", "title": "If statements in Where Condition with possible empty or Null parameters Power Query Excel SQL", "body": "<p>I have a parameter in an Excel spreadsheet for serial number and work order number. Lets say the Cell itself is named SerialNumber and WorkOrderNumber</p>\n\n<p>Note that sometimes we know a value for serial and or work order but sometimes we don't</p>\n\n<p>Using a Get Parameter function in PowerQuery</p>\n\n<pre><code>    let GetValue=(rangeName) =&gt; \n        let\n          name = Excel.CurrentWorkbook(){[Name=rangeName]}[Content],\n          value = name{0}[Column1]\n        in\n          value\n        in GetValue\n</code></pre>\n\n<p>I was able to get the SerialNumber and WorkOrderNumber as a parameter named SerialNumberP and WorkOrderNumberP in the let statement below:</p>\n\n<pre><code>    Let\n\n      SerialNumberP = GetParamater(\"SerialNumber\"),\n      WorkOrderNumberP = GetParameter(\"WorkOrderNumber\")\n</code></pre>\n\n<p>Then I have an SQL Select statement as such:</p>\n\n<pre><code>    Select\n       a.SerialNumber,\n       b.WorkOrderNumber,\n       a.PartNumber,\n       a.BatchNumber,\n       a.CreateDate,\n       b.CreatedBy,\n       b.ComponentSerialNumber,\n</code></pre>\n\n<p>Our database is in an SQL Database in the network therefore my From statement is:</p>\n\n<pre><code>    From [Database].[Category].[Table1] as a \n    inner join [Database].[Category].[Table2] as b \n    on a.WorkOrderNumber = b.WorkOrderNumber\n</code></pre>\n\n<p>Now I want to use a where statement where I can search for Either a known SerialNumber Or a WorkOrderNumber, Or both if applicable. However when I use the following code:</p>\n\n<pre><code>    Where\n    a.SerialNumber in ('\"&amp; SerialNumberP &amp;\"') \n    and b.WorkOrderNumber in ('\"&amp; WorkOrderNumberP &amp;\"')\n</code></pre>\n\n<p>It picks up that when one field is empty (Either SerialNumber or WorkOrderNumber), that the empty field is null and the query does not pass.</p>\n\n<p>The error i get is :DataSource.Error: Microsoft SQL: This database function doesn't support the query option 'Query' with value 'null'. Whereas if i fill in both fields it works</p>\n\n<p>What would be the best way around this?</p>\n\n<p>Thanks in advance</p>\n\n<p>Edit: I have tried using If statements in the Where conditions and it doesn't seem to work</p>\n\n<p>e.g.</p>\n\n<pre><code>    Where\n    If SerialNumberP Is Not Null Then a.SerialNumber In ('\"&amp; SerialNumberP &amp;\"')\n    If WorkOrderNumberP Is Not Null Then b.WorkOrderNumber In ('\"&amp; WorkOrderNumberP &amp;\"')\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1512604002, "post_id": 47685257, "comment_id": 82330463, "body": "Always helps to indent your code when posting - it&#39;s much easier for us to see what&#39;s going on then."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512604009, "post_id": 47685257, "comment_id": 82330466, "body": "On which line do you get the &quot;Subscript out of range&quot; error?"}, {"owner": {"reputation": 33, "user_id": 9042271, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155030429454818/picture?type=large", "display_name": "Jamie Smith", "link": "https://stackoverflow.com/users/9042271/jamie-smith"}, "edited": false, "score": 0, "creation_date": 1512604070, "post_id": 47685257, "comment_id": 82330488, "body": "If strFName(intItems - 1) &lt;&gt; &quot;&quot; Then"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1512604136, "post_id": 47685257, "comment_id": 82330526, "body": "You didn&#39;t resize <code>strLName</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512604167, "post_id": 47685257, "comment_id": 82330537, "body": "What is the value of <code>intItems</code> when it crashes?  Is it zero?"}, {"owner": {"reputation": 33, "user_id": 9042271, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155030429454818/picture?type=large", "display_name": "Jamie Smith", "link": "https://stackoverflow.com/users/9042271/jamie-smith"}, "edited": false, "score": 0, "creation_date": 1512604454, "post_id": 47685257, "comment_id": 82330631, "body": "How do I resize still keeping the value of intItems?"}, {"owner": {"reputation": 162, "user_id": 7407449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kfqAS.png?s=128&g=1", "display_name": "Akami Kurai", "link": "https://stackoverflow.com/users/7407449/akami-kurai"}, "edited": false, "score": 0, "creation_date": 1512604477, "post_id": 47685257, "comment_id": 82330642, "body": "ReDim strFName(intItems - 1) as String : ReDim strLName(intItems - 1) as String"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512604543, "post_id": 47685257, "comment_id": 82330662, "body": "What do you mean &quot;still keeping the value of intItems&quot;?  A <code>ReDim</code> won&#39;t alter <code>intItems</code> - it will retain its value."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512605863, "post_id": 47685257, "comment_id": 82331057, "body": "FWIW - I ran your code without getting an error on the <code>If strFName(intItems - 1) &lt;&gt; &quot;&quot;</code> line.  (i.e. it didn&#39;t crash until it tried to access the undimensioned <code>strLName</code> array.)  Are you <b>sure</b> it is crashing on the line you say it is crashing on??"}, {"owner": {"reputation": 33, "user_id": 9042271, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155030429454818/picture?type=large", "display_name": "Jamie Smith", "link": "https://stackoverflow.com/users/9042271/jamie-smith"}, "edited": false, "score": 0, "creation_date": 1512608514, "post_id": 47685257, "comment_id": 82331648, "body": "Once I changed---\t ReDim strFName(intItems - 1) as String : ReDim strLName(intItems - 1) as String-- it began working, but it&#39;s not pulling the strLName down to the list. I will try to fix that for a couple more hours without asking for help."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512604681, "post_id": 47685443, "comment_id": 82330709, "body": "But the error is occurring <b>before</b> <code>strLName</code> is accessed.  (So that may need to be fixed, but it isn&#39;t the cause of the problem in the question.)"}, {"owner": {"reputation": 162, "user_id": 7407449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kfqAS.png?s=128&g=1", "display_name": "Akami Kurai", "link": "https://stackoverflow.com/users/7407449/akami-kurai"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1512605003, "post_id": 47685443, "comment_id": 82330798, "body": "just change the line ReDim strFName(intItems - 1) to \t ReDim strFName(intItems - 1) as String : ReDim strLName(intItems - 1) as String"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512605285, "post_id": 47685443, "comment_id": 82330873, "body": "FWIW, the <code>As String</code> part of a <code>ReDim</code> is optional.  A <code>ReDim</code> cannot change the data type, so VBA makes no attempt to enforce advising the data type again - it uses the data type as per the original <code>Dim</code>."}], "tags": [], "owner": {"reputation": 162, "user_id": 7407449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kfqAS.png?s=128&g=1", "display_name": "Akami Kurai", "link": "https://stackoverflow.com/users/7407449/akami-kurai"}, "is_accepted": false, "score": 0, "last_activity_date": 1512604577, "creation_date": 1512604577, "answer_id": 47685443, "question_id": 47685257, "link": "https://stackoverflow.com/questions/47685257/keep-getting-runtime-error-script-out-of-range-on-access-vba/47685443#47685443", "title": "Keep getting runtime error - Script out of range- on Access VBA", "body": "<p>you forgot to reDim the other array and reset the data type of the array</p>\n"}], "owner": {"reputation": 33, "user_id": 9042271, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155030429454818/picture?type=large", "display_name": "Jamie Smith", "link": "https://stackoverflow.com/users/9042271/jamie-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512604577, "creation_date": 1512603236, "last_edit_date": 1512604149, "question_id": 47685257, "link": "https://stackoverflow.com/questions/47685257/keep-getting-runtime-error-script-out-of-range-on-access-vba", "title": "Keep getting runtime error - Script out of range- on Access VBA", "body": "<p>Trying to pull input from two text boxes using an array and build a message box with the list. Upon opening the form asks \"how many names\" to add to the list, then holds that number. You then click \"Add name\" up until the name count hits 5. Then it should have a message box pop up saying the list is full. </p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nDim intItems As Integer\n\nDim strFName() As String, strLName() As String\n\n\n\nPrivate Sub Form_Load()\nintItems = Val(InputBox(\"How many names?\", \"Name  Count\"))\nDo While intItems &lt;= 0\nMsgBox \"Please provide a number greater than 0\", vbCritical, \"Correct Value \nRequired\"\nintItems = Val(InputBox(\"How many names do you have?\", \"Name List\"))\nLoop\nReDim strFName(intItems - 1)\nEnd Sub\n\n\nPrivate Sub cmdAddName_Click()\nDim intI As Integer\nIf IsNull(Me.txtFirstName.Value) Or IsNull(Me.txtLastName.Value) = True Then\nMsgBox \"There must be values for both First and Last names\", vbCritical, \n\"Data Entry Error\"\nElse\nIf strFName(intItems - 1) &lt;&gt; \"\" Then\nMsgBox \"Sorry, the list is full!\"\nMe.txtFirstName.Value = Null\nMe.txtLastName.Value = Null\nElse\nFor intI = 0 To intItems - 1\nIf strFName(intI) = \"\" Then\nstrFName(intI) = Me.txtFirstName.Value\nstrLName(intI) = Me.txtLastName.Value\nMe.txtFirstName.Value = Null\nMe.txtLastName.Value = Null\nExit For\nEnd If\nNext\nEnd If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I get a runtime error \"Script out of range\" on 'If strFName(intItems - 1) &lt;> \"\" Then anyone have any ideas as to why?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 4439563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2d3a7462cfde9fb73869c40db702f4cb?s=128&d=identicon&r=PG&f=1", "display_name": "bigbucky", "link": "https://stackoverflow.com/users/4439563/bigbucky"}, "edited": false, "score": 0, "creation_date": 1512601510, "post_id": 47684880, "comment_id": 82329517, "body": "I get a type mismatch error on the Set arr line.  I tried to Dim arr as Variant but still get the error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 399, "user_id": 4439563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2d3a7462cfde9fb73869c40db702f4cb?s=128&d=identicon&r=PG&f=1", "display_name": "bigbucky", "link": "https://stackoverflow.com/users/4439563/bigbucky"}, "edited": false, "score": 0, "creation_date": 1512601699, "post_id": 47684880, "comment_id": 82329593, "body": "Sorry typo on my part - there&#39;s no Set required for that assignment"}, {"owner": {"reputation": 399, "user_id": 4439563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2d3a7462cfde9fb73869c40db702f4cb?s=128&d=identicon&r=PG&f=1", "display_name": "bigbucky", "link": "https://stackoverflow.com/users/4439563/bigbucky"}, "edited": false, "score": 0, "creation_date": 1512602411, "post_id": 47684880, "comment_id": 82329855, "body": "Thank you that works great!  So at this point does it even make sense to use a Collection?  I could probably just loop through the array to assign the Class."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 399, "user_id": 4439563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2d3a7462cfde9fb73869c40db702f4cb?s=128&d=identicon&r=PG&f=1", "display_name": "bigbucky", "link": "https://stackoverflow.com/users/4439563/bigbucky"}, "edited": false, "score": 1, "creation_date": 1512603950, "post_id": 47684880, "comment_id": 82330441, "body": "You need the class instances to stay &quot;live&quot; once your Initialize method ends: the global collection is a just a storage location for the objects so they don&#39;t go out of scope."}, {"owner": {"reputation": 399, "user_id": 4439563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2d3a7462cfde9fb73869c40db702f4cb?s=128&d=identicon&r=PG&f=1", "display_name": "bigbucky", "link": "https://stackoverflow.com/users/4439563/bigbucky"}, "edited": false, "score": 0, "creation_date": 1512604563, "post_id": 47684880, "comment_id": 82330670, "body": "Ah, ok I think I understand."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1512601675, "last_edit_date": 1512601675, "creation_date": 1512600969, "answer_id": 47684880, "question_id": 47684598, "link": "https://stackoverflow.com/questions/47684598/how-to-use-a-class-with-a-collection-of-controls/47684880#47684880", "title": "How to use a Class with a Collection of Controls", "body": "<p>You need to put the obj objects in the collection, not the controls themselves</p>\n\n<p>Untested:</p>\n\n<pre><code>Dim tbCollection As Collection\n\nPrivate Sub UserForm_Initialize()\n    Dim obj As clsTextBox\n    Dim arr\n    Dim ctrl\n\n    Set tbCollection = New Collection\n\n    arr = Array(Me.tbAC, Me.tbCR, Me.tbHP) '&lt;&lt; edit: no Set\n\n    For Each ctrl in arr\n        Set obj = New clsTextBox\n        Set obj.Control = ctrl\n        tbCollection.Add obj\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 457, "user_id": 2084052, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/gfPpc.jpg?s=128&g=1", "display_name": "Zephyr Mays", "link": "https://stackoverflow.com/users/2084052/zephyr-mays"}, "is_accepted": false, "score": 0, "last_activity_date": 1555552309, "last_edit_date": 1555552309, "creation_date": 1555550953, "answer_id": 55737972, "question_id": 47684598, "link": "https://stackoverflow.com/questions/47684598/how-to-use-a-class-with-a-collection-of-controls/55737972#55737972", "title": "How to use a Class with a Collection of Controls", "body": "<p>Can you listen for a TextBox exit event? Similarly to how a normal TextBox event would work? E.g.</p>\n\n<pre><code>  Private Sub TextBox1_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n        'Update a certain label based on the value of the TextBox\n  End Sub\n</code></pre>\n\n<p>The following doesn't catch the exit event. Moreover, while I can see the .Name property of the TextBox which generated the event for MyTextBox in the locals window, I cannot access that info to determine which label to act on.</p>\n\n<p>This class technique does catch some of the change events. </p>\n\n<p>Class clsTextBox:</p>\n\n<pre><code>Private WithEvents MyTextBox As MSForms.TextBox\n\nPublic Property Set Control(tb As MSForms.TextBox)\n    Set MyTextBox = tb\nEnd Property\n\n' Want to handle this event, but it's not caught when exiting the TextBox control\nPrivate Sub MyTextBox_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n    'Debug.Print me.Control.name\n    'Update a certain label based on the value of the TextBox\n    Stop\nEnd Sub\n\n' Catching this event but can't identify the control which triggered it\nPrivate Sub MyTextBox_Change()\n    Debug.Print MyTextBox.Value ' &lt;--- This prints the correct value\n    Debug.Print Me.Control.Name ' &lt;--- ERROR here on any variation of Me or MyTextBox\n    'Update a certain label based on the value of the TextBox\n    Stop\nEnd Sub\n</code></pre>\n\n<p>I have a series of dynamically created controls which need listeners. Code follows:</p>\n\n<pre><code>  Option Explicit\n  Dim tbCollection As Collection\n\n  Private Sub TextBox1_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n  'Stop\n  End Sub\n\n  Private Sub UserForm_Initialize()\n        Dim ctrl As MSForms.Control\n        Dim obj As clsTextBox\n        Dim acftNumber As Long\n        Dim mPage As MSForms.MultiPage ' Control\n        Dim lbl_acftName As MSForms.Label\n        Dim lbl_currentHrs As MSForms.Label\n        Dim lbl_hrsDUE As MSForms.Label\n        Dim lbl_dateXFRIn As MSForms.Label\n        Dim lbl_dateXFROut As MSForms.Label\n        Dim lbl_hrsOnXFROut As MSForms.Label\n        Dim txb_currentHrs As MSForms.TextBox\n        Dim txb_hrsDUE As MSForms.TextBox\n        Dim txb_dateXFRIn As MSForms.TextBox\n        Dim txb_dateXFROut As MSForms.TextBox\n        Dim txb_hrsOnXFROut As MSForms.TextBox\n        Dim i As Double\n        Dim pgName As String\n        Dim acftName As String\n        'Dim ctrl As MSForms.Control\n\n        ' Correct for border size calculations bug in Excel 2016\n        Me.Height = 249.75\n        Me.Width = 350.25\n\n        acftNumber = Range(\"aircraft\").Count ' Some unknown value betweet 3 and 10\n        Set mPage = Me.multipage_file_week 'set Multipage variable\n\n        For i = 1 To acftNumber\n              'set name/title for new page\n              pgName = \"pg_acft_\" &amp; i\n              acftName = Range(\"aircraft\").Cells(i, 1).Value\n\n              'mPage.Pages.Add pgName, pgTitle\n\n              With mPage 'add acft tab\n                    ' add the aircraft page to the multipage\n                    .Pages.Add pgName, acftName\n\n                    ' Aircraft Name Label\n                    Set lbl_acftName = .Pages(i).Controls.Add(\"Forms.Label.1\", \"lbl_acftName_\" &amp; i, True)\n                    With lbl_acftName\n                          .Caption = acftName\n                          .Font = \"Arial\"\n                          .Font.Size = 12\n                          .Font.Bold = True\n                          .Left = 10\n                          .Width = 55\n                          .Top = 0\n                    End With\n\n                    ' Current Hours Label and TextBox\n                    Set lbl_currentHrs = .Pages(i).Controls.Add(\"Forms.Label.1\", \"lbl_currentHrs_\" &amp; i, True)\n                    With lbl_currentHrs\n                          .Caption = \"Current Asset Hours:\"\n                          .TextAlign = fmTextAlignRight\n                          .Font = \"Arial\"\n                          .Font.Size = 10\n                          .Font.Bold = False\n                          .Left = 20\n                          .Width = 120\n                          .Top = 25\n                    End With\n                    Set txb_currentHrs = .Pages(i).Controls.Add(\"Forms.TextBox.1\", \"txb_currentHrs_\" &amp; i, True)\n                    With txb_currentHrs\n                          .Value = \"16004.5\"\n                          .Text = \"16004.5\"\n                          .Font = \"Arial\"\n                          .Font.Size = 10\n                          .Font.Bold = False\n                          .Left = 150\n                          .Width = 70\n                          .Top = 25\n                    End With\n\n\n                    ' Hours DUE Label and TextBox\n                    Set lbl_hrsDUE = .Pages(i).Controls.Add(\"Forms.Label.1\", \"lbl_hrsDUE_\" &amp; i, True)\n                    With lbl_hrsDUE\n                          .Caption = \"Hours next HMC DUE:\"\n                          .TextAlign = fmTextAlignRight\n                          .Font = \"Arial\"\n                          .Font.Size = 10\n                          .Font.Bold = False\n                          .Left = 20\n                          .Width = 120\n                          .Top = 50\n                    End With\n                    Set txb_hrsDUE = .Pages(i).Controls.Add(\"Forms.TextBox.1\", \"txb_hrsDUE_\" &amp; i, True)\n                    With txb_hrsDUE\n                          .Value = \"16004.5\"\n                          .Text = \"16004.5\"\n                          .Font = \"Arial\"\n                          .Font.Size = 10\n                          .Font.Bold = False\n                          .Left = 150\n                          .Width = 70\n                          .Top = 50\n                    End With\n\n                    ' Date XFR In Label and TextBox\n                    Set lbl_dateXFRIn = .Pages(i).Controls.Add(\"Forms.Label.1\", \"lbl_dateXFRIn_\" &amp; i, True)\n                    With lbl_dateXFRIn\n                          .Caption = \"Estimated arrival date:\"\n                          .TextAlign = fmTextAlignRight\n                          .Font = \"Arial\"\n                          .Font.Size = 10\n                          .Font.Bold = False\n                          .Left = 20\n                          .Width = 120\n                          .Top = 75\n                    End With\n\n                    Set txb_dateXFRIn = .Pages(i).Controls.Add(\"Forms.TextBox.1\", \"txb_hrsDUE_\" &amp; i, True)\n                    With txb_dateXFRIn\n                          .Value = \"4/16/2019\"\n                          .Text = \"4/16/2019\"\n                          .Font = \"Arial\"\n                          .Font.Size = 10\n                          .Font.Bold = False\n                          .Left = 150\n                          .Width = 70\n                          .Top = 75\n                    End With\n\n\n                    ' Date XFR Out Label and TextBox\n                    Set lbl_dateXFROut = .Pages(i).Controls.Add(\"Forms.Label.1\", \"lbl_dateXFROut_\" &amp; i, True)\n                    With lbl_dateXFROut\n                          .Caption = \"Estimated departure date:\"\n                          .TextAlign = fmTextAlignRight\n                          .Font = \"Arial\"\n                          .Font.Size = 10\n                          .Font.Bold = False\n                          .Left = 20\n                          .Width = 120\n                          .Top = 100\n                    End With\n                    Set txb_dateXFROut = .Pages(i).Controls.Add(\"Forms.TextBox.1\", \"txb_hrsDUE_\" &amp; i, True)\n                    With txb_dateXFROut\n                          .Value = \"4/16/2019\"\n                          .Text = \"4/16/2019\"\n                          .Font = \"Arial\"\n                          .Font.Size = 10\n                          .Font.Bold = False\n                          .Left = 150\n                          .Width = 70\n                          .Top = 100\n                    End With\n\n                    ' Hours on XFR Out Label and TextBox\n                    Set lbl_hrsOnXFROut = .Pages(i).Controls.Add(\"Forms.Label.1\", \"lbl_hrsOnXFROut_\" &amp; i, True)\n                    With lbl_hrsOnXFROut\n                          .Caption = \"Desired hours remaining on departure:\"\n                          .TextAlign = fmTextAlignLeft\n                          .Font = \"Arial\"\n                          .Font.Size = 10\n                          .Font.Bold = False\n                          .Left = 20\n                          .Width = 170\n                          .Top = 125\n                    End With\n                    Set txb_hrsOnXFROut = .Pages(i).Controls.Add(\"Forms.TextBox.1\", \"txb_hrsDUE_\" &amp; i, True)\n                    With txb_hrsOnXFROut\n                          .Value = \"35\"\n                          .Text = \"35\"\n                          .Font = \"Arial\"\n                          .Font.Size = 10\n                          .Font.Bold = False\n                          .Left = 200\n                          .Width = 35\n                          .Top = 125\n                    End With\n              End With\n\n              'Debug\n              Debug.Print Me.multipage_file_week.Pages(i).Name &amp; \":\"\n              For Each ctrl In Me.multipage_file_week.Pages(i).Controls\n                    Debug.Print \"  - \" &amp; ctrl.Name\n              Next ctrl\n\n        Next i\n        mPage.Value = 0\n        Me.Caption = FILE_WEEK_FORM_TITLE\n\n        Set tbCollection = New Collection\n        For Each ctrl In Me.Controls\n              If TypeOf ctrl Is MSForms.TextBox Then\n                    Set obj = New clsTextBox\n                    Set obj.Control = ctrl\n                    tbCollection.Add obj\n              End If\n        Next ctrl\n        Set obj = Nothing\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 399, "user_id": 4439563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2d3a7462cfde9fb73869c40db702f4cb?s=128&d=identicon&r=PG&f=1", "display_name": "bigbucky", "link": "https://stackoverflow.com/users/4439563/bigbucky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1006, "favorite_count": 0, "accepted_answer_id": 47684880, "answer_count": 2, "score": 0, "last_activity_date": 1555552309, "creation_date": 1512599555, "question_id": 47684598, "link": "https://stackoverflow.com/questions/47684598/how-to-use-a-class-with-a-collection-of-controls", "title": "How to use a Class with a Collection of Controls", "body": "<p>I tried adapting the solution in the link below to make a collection of text boxes allow numbers only.  I get no error but the class just doesn't apply to the textboxes.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5940596/excel-vba-userform-execute-sub-when-something-changes\">Excel VBA Userform - Execute Sub when something changes</a></p>\n\n<p>Class Module</p>\n\n<pre><code>Public WithEvents TextGroup As MSForms.TextBox\n\nPublic Property Set Control(tb As MSForms.TextBox)\n    Set TextGroup = tb\nEnd Property\n\nPrivate Sub TextGroup_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)\nSelect Case KeyAscii\n\nCase 48 To 57\nCase Else\nKeyAscii = 0\nEnd Select\nEnd Sub\n</code></pre>\n\n<p>UserForm</p>\n\n<pre><code>Dim tbCollection As Collection\n\nPrivate Sub UserForm_Initialize()\n    Dim obj As clsTextBox\n    Dim ctrl As Control\n\n    Set tbCollection = New Collection\n        tbCollection.Add Me.tbAC\n        tbCollection.Add Me.tbCR\n        tbCollection.Add Me.tbHP\n\n    For Each ctrl In tbCollection\n        Set obj = New clsTextBox\n        Set obj.Control = ctrl\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1512599905, "post_id": 47684651, "comment_id": 82328899, "body": "He has cells that end in <code>\\n</code>, not contain just <code>\\n</code>."}, {"owner": {"reputation": 45, "user_id": 7864549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff929277189f4dc612c703c2595886d?s=128&d=identicon&r=PG&f=1", "display_name": "BN_pdx", "link": "https://stackoverflow.com/users/7864549/bn-pdx"}, "edited": false, "score": 0, "creation_date": 1512601010, "post_id": 47684651, "comment_id": 82329324, "body": "Correct, \\n is a line feed here, it&#39;s not an actual string &quot;\\n&quot;."}, {"owner": {"reputation": 45, "user_id": 7864549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff929277189f4dc612c703c2595886d?s=128&d=identicon&r=PG&f=1", "display_name": "BN_pdx", "link": "https://stackoverflow.com/users/7864549/bn-pdx"}, "edited": false, "score": 0, "creation_date": 1513029032, "post_id": 47684651, "comment_id": 82485442, "body": "@Xabier - can I maybe ask you a quick follow-up question? This works as expected, but not in cells with multiple line breaks/feeds. I only want this macro to check the last line feed (no content/characters after such line feed) and disregard any preceding ones since I have multi-line text (with line feeds separating each line) within the very same cell."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1513030493, "post_id": 47684651, "comment_id": 82486091, "body": "Updated my answer to reflect your comments... Now it should only look at the last line feed..."}, {"owner": {"reputation": 45, "user_id": 7864549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff929277189f4dc612c703c2595886d?s=128&d=identicon&r=PG&f=1", "display_name": "BN_pdx", "link": "https://stackoverflow.com/users/7864549/bn-pdx"}, "edited": false, "score": 0, "creation_date": 1513031114, "post_id": 47684651, "comment_id": 82486324, "body": "@Xabier - Thank you! I really appreciate it."}, {"owner": {"reputation": 45, "user_id": 7864549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff929277189f4dc612c703c2595886d?s=128&d=identicon&r=PG&f=1", "display_name": "BN_pdx", "link": "https://stackoverflow.com/users/7864549/bn-pdx"}, "edited": false, "score": 0, "creation_date": 1513033225, "post_id": 47684651, "comment_id": 82487073, "body": "@Xabier - I&#39;m getting an error on this when I try to run it.  <b>Compile error: Argument not optional</b>  It seems to pertain to this: <b>Str =</b>"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 45, "user_id": 7864549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff929277189f4dc612c703c2595886d?s=128&d=identicon&r=PG&f=1", "display_name": "BN_pdx", "link": "https://stackoverflow.com/users/7864549/bn-pdx"}, "edited": false, "score": 1, "creation_date": 1513073583, "post_id": 47684651, "comment_id": 82501057, "body": "@BN_pdx I have now tried and tested the updated code and it works as expected, your error is because you have to declare Str as a variable, please check my updated answer once more..."}, {"owner": {"reputation": 45, "user_id": 7864549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff929277189f4dc612c703c2595886d?s=128&d=identicon&r=PG&f=1", "display_name": "BN_pdx", "link": "https://stackoverflow.com/users/7864549/bn-pdx"}, "edited": false, "score": 0, "creation_date": 1513101215, "post_id": 47684651, "comment_id": 82518522, "body": "@Xabier - Works perfectly, thank you very very much!"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1513033781, "last_edit_date": 1513033781, "creation_date": 1512599863, "answer_id": 47684651, "question_id": 47684572, "link": "https://stackoverflow.com/questions/47684572/compare-end-punctuation-in-columns-a-and-b-in-excel-vba/47684651#47684651", "title": "Compare end punctuation in columns A and B in Excel (VBA?)", "body": "<p>This would look for at whether there is a line feed in the cell and if there is it will add it to column B too.</p>\n\n<pre><code>Sub foo2()\nFindString = \"/n\"\nLastRow = Sheet1.Cells(Rows.Count, \"A\").End(xlUp).Row 'find the last row in column A with data\nFor i = 1 To LastRow\nSet Rng = Sheet1.Cells(i, 1).Find(What:=FindString) 'look for the line feed at in this cell\n            If Not Rng Is Nothing Then 'if found\n                Sheet1.Cells(i, 2).Value = Sheet1.Cells(i, 2).Value &amp; \"/n\" 'add line feed to column B\n            End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>Or if you are not looking for the string \"/n\" and you are looking for the line feed then I believe something like this would do it:</p>\n\n<pre><code>Sub foo2()\nLastRow = Sheet1.Cells(Rows.Count, \"A\").End(xlUp).Row 'find the last row in column A with data\nFor i = 1 To LastRow\nSet Rng = Sheet1.Cells(i, 1).Find(What:= vbLf) 'look for the line feed at in this cell\n            If Not Rng Is Nothing Then 'if found\n                Sheet1.Cells(i, 2).Value = Sheet1.Cells(i, 2).Value &amp; vbLf 'add line feed to column B\n            End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>UPDATE:</p>\n\n<pre><code>Sub foo2()\nDim Str as Variant\n    LastRow = Sheet1.Cells(Rows.Count, \"A\").End(xlUp).Row 'find the last row in column A with data\n    For i = 1 To LastRow\n        Str = Sheet1.Cells(i, 1).Value\n        If Right(Str, 1) = vbLf Then 'if found\n                Sheet1.Cells(i, 2).Value = Sheet1.Cells(i, 2).Value &amp; vbLf 'add line feed to column B\n            End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": false, "score": 1, "last_activity_date": 1512599981, "creation_date": 1512599981, "answer_id": 47684678, "question_id": 47684572, "link": "https://stackoverflow.com/questions/47684572/compare-end-punctuation-in-columns-a-and-b-in-excel-vba/47684678#47684678", "title": "Compare end punctuation in columns A and B in Excel (VBA?)", "body": "<p>Use column C to find line termination mismatches:</p>\n\n<pre><code>=(CODE(RIGHT(A1,1))=10)&lt;&gt;(CODE(RIGHT(B1,1))=10)\n</code></pre>\n\n<p>Copy the formula down to all rows and filter on <code>TRUE</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "is_accepted": false, "score": 0, "last_activity_date": 1512602232, "creation_date": 1512602232, "answer_id": 47685106, "question_id": 47684572, "link": "https://stackoverflow.com/questions/47684572/compare-end-punctuation-in-columns-a-and-b-in-excel-vba/47685106#47685106", "title": "Compare end punctuation in columns A and B in Excel (VBA?)", "body": "<p>Depending on whether the newline spaces are inside of the cell or lead onto the next cell I would do one of two things:</p>\n\n<p>If the newline is inside of the cell, like: <code>CELL A1 = \"Text X \\n\"</code>,\nA simple solution to this could be to insert an extra column and use the <code>=TRIM()</code> formula. The <code>TRIM()</code> formula gets rid of leading and trailing spaces, you can see the Excel documentation <a href=\"https://support.office.com/en-us/article/TRIM-function-410388fa-c5df-49c6-b16c-9e5630b479f9\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>If the newline is on the next cell, like <code>CELL A1 = \"Text X\"</code>, <code>CELL A2 = \"\\n\"</code>,\nThen you could just use the <code>LEN()</code> formula on the cell, and filter by \"0\". You can see the Excel documentation for <code>LEN()</code> <a href=\"https://support.office.com/en-us/article/LEN-LENB-functions-29236f94-cedc-429d-affd-b5e33d2c67cb\" rel=\"nofollow noreferrer\">here.</a></p>\n"}], "owner": {"reputation": 45, "user_id": 7864549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff929277189f4dc612c703c2595886d?s=128&d=identicon&r=PG&f=1", "display_name": "BN_pdx", "link": "https://stackoverflow.com/users/7864549/bn-pdx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 47684651, "answer_count": 3, "score": -1, "last_activity_date": 1513033781, "creation_date": 1512599431, "question_id": 47684572, "link": "https://stackoverflow.com/questions/47684572/compare-end-punctuation-in-columns-a-and-b-in-excel-vba", "title": "Compare end punctuation in columns A and B in Excel (VBA?)", "body": "<p>I'm trying to catch and resolve instances in Excel where the end punctuation (in my case an empty line) in cells in column B doesn't match the end punctuation in cells in column A. For background, column A contains English text and column B contains translated version of the very same content. The problem is - in some cases the source text has empty/blank lines at the end of text in cells, while some translated text doesn't and I need to find and fix those instances. </p>\n\n<p>So, I'm trying to: </p>\n\n<p>1) Compare the last line of each cell in column A to the adjacent cell in the same row in column B. </p>\n\n<p>2) If the cell in column A has a blank line at the end and corresponding cell in column B doesn't, add such blank line to the end of cell in column B. </p>\n\n<p>Example:</p>\n\n<pre><code>         **Column A**    **Column B** \nRow 1       Text X          Text Y \n            \\n\nRow 2       Text X          Text Y \nRow 3       Text X          Text Y \n            \\n\nRow 4       Text X          Text Y \n            \\n              \\n\n</code></pre>\n\n<p>So, in the example above, I need to flag cells B1 and B3 because they don't have a line feed (\\n) at the end, similar to their counterparts in cells A1 and A3.</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["vba", "email", "ms-access"], "comments": [{"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1512604940, "post_id": 47684528, "comment_id": 82330780, "body": "I think that you need to change SETOBJOUTLOOKATTACH to Set ObjOutlookAttach."}, {"owner": {"reputation": 11, "user_id": 9064293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d1aeb51d32d8ee9a7ff656a00842d5?s=128&d=identicon&r=PG&f=1", "display_name": "Sylvester Bryce", "link": "https://stackoverflow.com/users/9064293/sylvester-bryce"}, "reply_to_user": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1512611702, "post_id": 47684528, "comment_id": 82332331, "body": "I corrected that issue, but it is still attaching as an email."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1512798279, "post_id": 47684528, "comment_id": 82412059, "body": "Why not <code>.Attachment.Add = &quot;...&quot;</code> and <code>.To = rst1!Email</code>? Do you want to send multiple emails each to single address or one email to multiple addresses?"}], "answers": [{"tags": [], "owner": {"reputation": 244, "user_id": 7936123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf162f9353483edfa62c3443929f733?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7936123/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1513782602, "creation_date": 1513782602, "answer_id": 47909070, "question_id": 47684528, "link": "https://stackoverflow.com/questions/47684528/ms-access-vba-sending-email-with-pdf-attachement/47909070#47909070", "title": "MS Access VBA Sending Email with PDF attachement", "body": "<p>Functions are procedures used to calculate something and return a result. The function you have above is not returning anything.</p>\n\n<p>A subroutine is a procedure to run through steps in a process and not return a result.</p>\n\n<p>the code provided below should satisfy what you are trying to accomplish:</p>\n\n<pre><code>Public Sub EmailNotification()\nDim olApp                           As Object\nDim olMail                          As Object\nDim strExport, strList              As String\nDim rst1                            As DAO.Recordset\n\nConst TERMINAL_QUERY = \"SELECT EMail \" &amp; _\n                       \"FROM [EmailList] \" &amp; _\n                       \"ORDER BY Email;\"\n\nOn Error GoTo ErrorH\n'Varibale to update one location for entire code\nstrExport = \"Q:\\2017\\Big E Transportation\\Accounting\\Advanced Auto\\Projects Summary Report.PDF\"\n'Ensures strList is empty for below check\nstrList = Empty\n'Outputs the report to PDF using strExport variable\nDoCmd.OutputTo acOutputReport, \"CarryIn_Email\", \"PDFFormat(*.pdf)\", strExport, False, \" , acExportQualityPrint\"\n'Opens the recordset containing email addresses within const query above\nSet rst1 = CurrentDb.OpenRecordset(TERMINAL_QUERY)\n'ensure the recordset is fully loaded\nrst1.MoveLast\nrst1.MoveFirst\n'loop to acquire email addresses from query statement, adding \";\" to separate each email address\nDo While Not rst1.EOF\n    If strList = Empty Then\n        strList = rst1![Email]\n    Else\n        strList = strList &amp; \"; \"\n    End If\n    rst1.MoveNext\nLoop\n'Closes recordset and frees object in memory\nrst.Close\nSet rst = Nothing\n'Creates the memory for email objects\nSet olApp = CreateObject(\"Outlook.Application\")\nSet olMail = olApp.CreateItem(olMailItem)\n'Generates email information\nWith olMail\n    'olFormatPlain is easier to type in an email with, my opinion only, this line is not needed\n    .BodyFormat = olFormatPlain\n    'Who the email is going to, using the strList created during loop above\n    .To = strList\n    .CC = \"\" 'Change if you want a CC\n    .BCC = \"\" 'Change is you want a BCC\n    .Subject = \"Carry Ins\"\n    .Body = \"\" 'Change to what ever you want the body of the email to say\n    'Attaches the exported file using the variable created at beginning\n    .Attachments.Add = strExport\n    .Display 'Use for testing purposes only, note out for live runs\n    '.Send 'Use for live purposes only, note out for test runs\nEnd With\n\n'Frees email objects stored in memory\nSet olMail = Nothing\nSet olApp = Nothing\n\nEndCode:\n'Ensures all objects are free from memory\nIf Not rst1 Is Nothing Then\n    rst1.Close\n    Set rst1 = Nothing\nEnd If\nIf Not olApp Is Nothing Then\n    Set olMail = Nothing\n    Set olApp = Nothing\nEnd If\nExit Sub\n\n'Error handler to display error infor in message box, resumes end code\n'Change is you want/need this to handle specific error numbers\nErrorH:\nMsgBox Err.Number &amp; \" - \" &amp; Err.Description\nResume EndCode\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9064293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d1aeb51d32d8ee9a7ff656a00842d5?s=128&d=identicon&r=PG&f=1", "display_name": "Sylvester Bryce", "link": "https://stackoverflow.com/users/9064293/sylvester-bryce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4010, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513782602, "creation_date": 1512599278, "last_edit_date": 1512599800, "question_id": 47684528, "link": "https://stackoverflow.com/questions/47684528/ms-access-vba-sending-email-with-pdf-attachement", "title": "MS Access VBA Sending Email with PDF attachement", "body": "<p>I am trying to export a report in an from an Access database to multiple email address using a table and a report I have produced. Below is the code I have been using to accomplish this. </p>\n\n<pre><code>Function EmailNotification()\nOn Error GoTo Err_EmailNotification\n    Dim olApp As Object\n    Dim olMail As Object\n    Set olApp = CreateObject(\"Outlook.Application\")\n    Set olMail = olApp.CreateItem(olMailItem)\n    Dim EmailList As String\n    Dim EmailList2 As String\n    Dim objOutlookRecip As Object\n    Dim objOutlookRecip2 As Object\n    Dim objOutlookAttach As Object\n    Const TERMINAL_QUERY = \"SELECT EMail \" &amp; _\n                          \" FROM [EmailList] \" &amp; _\n                          \" ORDER BY Email;\"\n\n    Dim dbs As DAO.Database\n    Dim rst1 As DAO.Recordset\n    DoCmd.OutputTo acOutputReport, \"CarryIn_Email\", \"PDFFormat(*.pdf)\", \"Q:\\2017\\Big E Transportation\\Accounting\\Advanced Auto\\Projects Summary Report.PDF\", False, \" , acExportQualityPrint\"\n        Set dbs = CurrentDb()\n        Set rst1 = dbs.OpenRecordset(TERMINAL_QUERY)\n        With rst1\n            .MoveFirst\n            .MoveLast\n            .MoveFirst\n            rstX = rst1.RecordCount\n            If Not (.EOF And .BOF) Then\n                .MoveFirst\n                Do Until .EOF\n                    Set olApp = CreateObject(\"Outlook.Application\")\n                    Set olMail = olApp.CreateItem(olMailItem)\n                    With olMail\n                        Set objOutlookRecip = .Recipients.Add(rst1!Email)\n                        objOutlookRecip.Type = olTo\n                        .Subject = \"Carry Ins\"\n                        SETOBJOUTLOOKATTACH = .Attachments.Add(\"Q:\\2017\\Big E Transportation\\Accounting\\Advanced Auto\\Projects Summary Report.PDF\")\n                        .Send\n                    End With\n                    .MoveNext\n                Loop\n            End If\n        End With\n\nExit_EmailNotification:\n    Exit Function\n\nErr_EmailNotification:\n    MsgBox Error$\n    Resume Exit_EmailNotification\n\nEnd Function\n</code></pre>\n\n<p>My problem is that this code is not exporting an email with a PDF attached to it, but instead is exporting an email with an email as the attachment. </p>\n\n<p>I want this code to export an email with a PDF attachment, not an email with an email as the attachment.</p>\n"}, {"tags": ["excel", "excel-2010", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "edited": false, "score": 1, "creation_date": 1512597833, "post_id": 47684065, "comment_id": 82328025, "body": "It may be wiser instead to simply make sure that the image you insert is of a certain size by resizing it after you insert it"}, {"owner": {"reputation": 223, "user_id": 9034503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02c66f7770f15210d90759f2681092b2?s=128&d=identicon&r=PG&f=1", "display_name": "aragornii", "link": "https://stackoverflow.com/users/9034503/aragornii"}, "reply_to_user": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "edited": false, "score": 0, "creation_date": 1512600876, "post_id": 47684065, "comment_id": 82329273, "body": "Thanks, you&#39;re right. I&#39;ll try to assign the picture size in pixel with <code>.ShapeRange.Width = xxx</code> and <code>.ShapeRange.Height = xxx</code>. My question is: is not the same thing I&#39;m doing with <code>.ShapeRange.ScaleWidth</code>? My picture is (see the URL) 390x280 px, I don&#39;t understand why in Excel 2010 everything is fine with a scale factor of 1.00 while in Excel 2016 I need a scale factor of 0.80."}, {"owner": {"reputation": 223, "user_id": 9034503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02c66f7770f15210d90759f2681092b2?s=128&d=identicon&r=PG&f=1", "display_name": "aragornii", "link": "https://stackoverflow.com/users/9034503/aragornii"}, "reply_to_user": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "edited": false, "score": 1, "creation_date": 1512664429, "post_id": 47684065, "comment_id": 82359224, "body": "I tried the fix suggested by @rlb.usa but i got a very similar result: in Excel 2016 the picture is larger than the one in Excel 2010, even using <code>.ShapeRange.Height = xxx</code>. I also just realized that it might depend on the the screen resolution. I checked both laptops and the one with Excel 2010 is 1920x1080 (factor scale 113%) and the one with Excel 2016 is 1920x1080 (factor scale 125%) I will perform some additional test."}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1518974626, "creation_date": 1518974626, "answer_id": 48854493, "question_id": 47684065, "link": "https://stackoverflow.com/questions/47684065/insert-a-picture-using-vba-different-size-between-excel-2010-and-excel-2016/48854493#48854493", "title": "Insert a picture using VBA, different size between Excel 2010 and Excel 2016", "body": "<p>Microsoft introduced new picture resolution and compression handling processes beginning with Excel 2010, and then tweaking the defaults as technology quickly improved over the next few years.  This could be responsible for your issue.</p>\n\n<p>Your varying monitor sizes/resolution between your machines will also affect the default (and available) settings.</p>\n\n<blockquote>\n  <p>Even though the monitors are different sizes, it would be helpful to try to set your Windows <em>Display Resolution</em> to the same value on both, at least temporarily.</p>\n  \n  <p>The steps vary slightly depending on which version of Windows you're running, but they're not hard to Google.  (For example, <strong><a href=\"https://support.microsoft.com/en-ca/help/14108/windows-7-change-screen-resolution\" rel=\"nofollow noreferrer\">here</a></strong> are instructions for Windows 7 installations.)</p>\n</blockquote>\n\n<p>Check the following settings on <em>both</em> computers to <strong><em>see which options are available</em></strong> (not greyed-out) <strong>before</strong> changing anything, because you'll need to decide on a setting that is available on both.</p>\n\n<hr>\n\n<h2>Default Resolution Settings</h2>\n\n<ul>\n<li>In Excel, click <code>File</code> \u2192 <code>Options</code></li>\n<li>On the left side of the dialog, choose <code>Advanced</code></li>\n<li>On the right side of the dialog, scroll down to <code>Image Size &amp; Quality</code></li>\n<li><p>Take note of which settings are <strong>selected</strong> and which are <strong>available</strong>:</p>\n\n<p><code>\u2611 Do not compress images in file</code> (checkbox)</p>\n\n<p><code>Default Resolution</code> (drop-down)</p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/onTxk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/onTxk.png\" alt=\"options 1\"></a></p>\n\n<p>For the next step you'll need to have a picture on a worksheet, so you may as well use the \"problem images\" from your example.</p>\n\n<ul>\n<li><p>Single-click the image to select it. This should make the <code>Picture Tools / Format</code> menu appear.</p></li>\n<li><p>Click <code>Compress Pictures</code></p></li>\n<li><p>In the dialog that opens, under <code>Resolution</code>, take note of which settings are <strong>selected</strong> and which are <strong>available.</strong></p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/MPFSs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MPFSs.png\" alt=\"options 2\"></a></p>\n\n<p>Hopefully there's a combination that is available on both machines.  Once you've set them both the same, reboot both machines, and try inserting the pictures again.</p>\n\n<p>As I mentioned, there could be a number of factors affecting it. The only way to ensure graphics behave identically on two separate machines is if they have identical software <em>and</em> graphics hardware.</p>\n\n<hr>\n\n<p>If all else fails and you want to try one more long-shot, there is a <strong>Registry Setting</strong> that may be affecting one or both machines.</p>\n\n<p>It's tough to find documentation on Office's thousands of registry settings (many not used by default, such as this one) - and one <strong><a href=\"https://support.microsoft.com/en-ca/help/2713852/image-resolution-and-size-change-from-a-webpage-in-excel-2007-2010\" rel=\"nofollow noreferrer\">source</a></strong> implies that this only affects resolution of images in Office documents that are converted to web pages.  </p>\n\n<p>However, I believe that if you've <em>ever</em> saved an Excel document as a web page, this registry key (and it's related \"known issue\") could have been affected as well, so you could double-check.</p>\n\n<hr>\n\n<h2>Registry \"Hack\"</h2>\n\n<p>To work around this problem, add the following registry key to prevent the size change of the image.</p>\n\n<blockquote>\n  <p><strong><em>Standard Registry Warning:</strong>  Serious problems might occur if you modify the registry incorrectly by using Registry Editor or by using\n  another method. These problems might require that you reinstall your\n  operating system. Microsoft cannot guarantee that these problems can\n  be solved. <strong>Modify the registry at your own risk.</em></strong></p>\n  \n  <ol>\n  <li><p>Exit all programs.</p></li>\n  <li><p>Hit the <kbd><img src=\"https://i.stack.imgur.com/T0oPO.png\" alt=\"Windows Key\"></kbd> Windows Key, type <code>regedit</code>, and then hit <kbd>Enter</kbd>.</p></li>\n  <li><p>Locate and then select the following registry subkey: </p>\n  \n  <p><strong><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\Common</code></strong></p></li>\n  <li><p>After you select the subkey, click the <code>Edit</code> menu, click <code>New</code> and choose <code>DWORD Value</code>.</p></li>\n  <li><p>Type <code>DownRevRasterizationDPI</code>, and then press <kbd>Enter</kbd>.</p></li>\n  <li><p>Right-click <code>DownRevRasterizationDPI</code>, and then click <code>Modify</code>.</p></li>\n  <li><p>In the <strong><code>Value</code></strong> data box, type a value in the range of <code>1</code> to <code>300</code> and then click <code>OK</code>.</p></li>\n  </ol>\n  \n  <blockquote>\n    <p>In the <strong><code>Value</code></strong> data box, set a value of the resolution that you want to specify for the image. For example, if you set <code>96</code>, which is a\n    default screen resolution value for Windows, and insert a screenshot\n    into Excel, the image resolution of the screenshot becomes <code>96 dpi</code>.</p>\n  </blockquote>\n  \n  <ol start=\"8\">\n  <li>On the <code>File</code> menu, click <code>Exit</code> to exit Registry Editor.</li>\n  </ol>\n</blockquote>\n\n<p>Normally I like to include links to \"More Information\" in my answers, but I'm afraid <em>there just isn't much out there</em> besides the source link (above).</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 223, "user_id": 9034503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02c66f7770f15210d90759f2681092b2?s=128&d=identicon&r=PG&f=1", "display_name": "aragornii", "link": "https://stackoverflow.com/users/9034503/aragornii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1170, "favorite_count": 1, "accepted_answer_id": 48854493, "answer_count": 1, "score": 1, "last_activity_date": 1518974626, "creation_date": 1512597228, "last_edit_date": 1531161705, "question_id": 47684065, "link": "https://stackoverflow.com/questions/47684065/insert-a-picture-using-vba-different-size-between-excel-2010-and-excel-2016", "title": "Insert a picture using VBA, different size between Excel 2010 and Excel 2016", "body": "<p>I'm writing because I'm struggling in trying to understand why I get 2 different results when importing a picture using VBA.</p>\n\n<p>The image source is:\n<code>https://maps.googleapis.com/maps/api/staticmap?size=390x280&amp;zoom=8&amp;maptype=terrain&amp;markers=color:red%7Clabel:A%7C18.510516,-72.287768&amp;key=mykey</code></p>\n\n<p>And I'm using this VBA code to insert the picture in cell <code>Z8</code>:   </p>\n\n<pre><code>Range(\"Z8\").Select\nActiveSheet.Pictures.Insert(URL).Select\nWith Selection\n.ShapeRange.ScaleWidth 0.999, msoTrue\nEnd With\n</code></pre>\n\n<p>*the <code>.ShapeRange.ScaleWidth 0.999</code> is not need in this specific case but even if I remove the <code>With Selection</code> instruction, I get the same output.</p>\n\n<p>If I run the VBA code in Excel 2010, which I used to build the worksheet, everything is looking great, as shown below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oLBve.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oLBve.jpg\" alt=\"Excel_2010\"></a></p>\n\n<p>but when I run the VBA code in Excel 2016, I get something different:</p>\n\n<p><a href=\"https://i.stack.imgur.com/R3Ike.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R3Ike.jpg\" alt=\"Excel_2016\"></a></p>\n\n<p>The picture in this case is larger and off the page limits. The same is happening also for the QR code you can see on the top left. Also the vertical (and horizontal) page breaks have moved (and I cannot explain myself why) but I'll keep this question for another message.</p>\n\n<p>In general the picture in Excel 2016 is 1.25 larger than the picture in Excel 2010. Excel 2016 is installed on another laptop with a <strong>different screen resolution</strong>. Could be this the reason for the issue I'm facing? If so, do you know a way to fix it in a way that is screen-resolution independent?</p>\n\n<p>Thanks, Stefano</p>\n"}, {"tags": ["vba", "excel", "axis"], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 3, "last_activity_date": 1512598274, "creation_date": 1512598274, "answer_id": 47684298, "question_id": 47683803, "link": "https://stackoverflow.com/questions/47683803/creating-a-combo-chart-in-excel-with-vba-code/47684298#47684298", "title": "Creating a combo chart in Excel with VBA code", "body": "<p>How about this:</p>\n\n<pre><code>Sub foo()\n    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n    ActiveChart.SetSourceData Source:=Range(\"Sheet1!$C$1:$D$6\") 'make sure the range is correct here\n    ActiveChart.FullSeriesCollection(1).ChartType = xlColumnClustered 'select which column should be the Line or the Column\n    ActiveChart.FullSeriesCollection(1).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(2).ChartType = xlLine\n    ActiveChart.FullSeriesCollection(2).AxisGroup = 1\n    ActiveChart.ChartTitle.Text = \"Average Price and Dollar Volume of Sales\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9064214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b162464d3039eda669cb04b5743f0d4?s=128&d=identicon&r=PG&f=1", "display_name": "K.R.", "link": "https://stackoverflow.com/users/9064214/k-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6260, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512598274, "creation_date": 1512596060, "last_edit_date": 1512597256, "question_id": 47683803, "link": "https://stackoverflow.com/questions/47683803/creating-a-combo-chart-in-excel-with-vba-code", "title": "Creating a combo chart in Excel with VBA code", "body": "<p>How do I adjust the code below to create a combo chart with a bar for the primary axis and line for the secondary axis? </p>\n\n<p>I have two columns of data. </p>\n\n<pre><code>Sub CreateChart()\n    Dim rng As Range\n    Dim cht As Object\n\n    Set rng = ActiveSheet.Range(\"C1:D6\")\n    Set cht = ActiveSheet.Shapes.AddChart2\n\n    cht.Chart.SetSourceData Source:=rng\n\n    cht.Chart.ChartType = xlColumnClustered\n\n    cht.Chart.HasTitle = True\n    cht.Chart.ChartTitle.Text = \"Average Price and Dollar Volume of Sales\"\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciated! Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1512595637, "post_id": 47683563, "comment_id": 82326952, "body": "By A2 ranges from x to y, do you mean as a column or a row? Have you tried the macro recorder in excel to try to come up with some sort of code?"}, {"owner": {"reputation": 1, "user_id": 9064115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cc0337b1e7972a393f1c1c20de1f64?s=128&d=identicon&r=PG&f=1", "display_name": "David Zawierucha", "link": "https://stackoverflow.com/users/9064115/david-zawierucha"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1512596130, "post_id": 47683563, "comment_id": 82327185, "body": "Thank for the reply. I believe as a column. If A2, B2, C2 range from 1 to 3...output would look like..  Row 1 - 1 1 1 , 1...... Row 2 - 1 1 2 , 2....Row 3 - 1 1 3 , 3 and ect  Each one of those would be in its own column"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1512598971, "last_edit_date": 1512598971, "creation_date": 1512597357, "answer_id": 47684090, "question_id": 47683563, "link": "https://stackoverflow.com/questions/47683563/excel-vba-output-cell-formula-list-based-on-input-cells-that-range-from-x-to/47684090#47684090", "title": "Excel VBA - Output cell formula (list) based on input cells that range from x to y", "body": "<p>I think the following code will help you:</p>\n\n<pre><code>Sub foo2()\nDim A2(), B2(), C2() As Variant 'Declare the variables as Variant arrays\nDim LastRowA, LastRowB, LastRowC As Long\n\nLastRowA = Sheet1.Cells(Rows.Count, \"A\").End(xlUp).Row 'find the last row with data on column A\nLastRowB = Sheet1.Cells(Rows.Count, \"B\").End(xlUp).Row 'find the last row with data on column B\nLastRowC = Sheet1.Cells(Rows.Count, \"C\").End(xlUp).Row 'find the last row with data on column C\n\nA2 = Sheet1.Range(\"A1:A\" &amp; LastRowA) 'take all values form A1 to the last row in that column into the A2 array\nB2 = Sheet1.Range(\"B1:B\" &amp; LastRowB)\nC2 = Sheet1.Range(\"C1:C\" &amp; LastRowC)\n\nFor x = LBound(A2) To UBound(A2) 'loop from the begining of the array until the end\n    Sheet1.Cells(x, 6).Value = A2(x, 1) 'enter the values of A2 into the column F which is the number 6\n    Sheet1.Cells(x, 7).Value = B2(x, 1) 'edit this values to \"paste\" the values wherever you wish\n    Sheet1.Cells(x, 8).Value = C2(x, 1)\n    Sheet1.Cells(x, 9).FormulaR1C1 = \"=RC[-3]*RC[-2]*RC[-1]\" 'this will enter the formula in those cells\nNext x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9064115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cc0337b1e7972a393f1c1c20de1f64?s=128&d=identicon&r=PG&f=1", "display_name": "David Zawierucha", "link": "https://stackoverflow.com/users/9064115/david-zawierucha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1512598971, "creation_date": 1512594918, "last_edit_date": 1512596833, "question_id": 47683563, "link": "https://stackoverflow.com/questions/47683563/excel-vba-output-cell-formula-list-based-on-input-cells-that-range-from-x-to", "title": "Excel VBA - Output cell formula (list) based on input cells that range from x to y", "body": "<p>I am trying to accomplish the below in excel and believe I need to use VBA. Any help would be greatly appreciated!</p>\n\n<p>\nExcel input</p>\n\n<pre><code>Cell A1 = A2*B2*C2\nA2 ranges from x to y\nB2 ranges from x to y\nC2 ranges from x to y\n</code></pre>\n\n<p>\nExcel Output</p>\n\n<pre><code>Original Inputs, Formula Calculation (vertical list)\n\nA2 B2 C2 , A1\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1375, "user_id": 8817027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rJxo8.jpg?s=128&g=1", "display_name": "Emilio Lucas Ceroleni", "link": "https://stackoverflow.com/users/8817027/emilio-lucas-ceroleni"}, "is_accepted": false, "score": 2, "last_activity_date": 1512595239, "creation_date": 1512595239, "answer_id": 47683630, "question_id": 47683556, "link": "https://stackoverflow.com/questions/47683556/loop-with-vba-vlookup-with-dynamic-cell-value/47683630#47683630", "title": "Loop with VBA Vlookup, with dynamic cell value", "body": "<p>Maybe you should change <code>\"=VLOOKUP(nr(2),Tabel80[[Kolom1]:[Inschrijver]],2)\"</code> into <code>\"=VLOOKUP(\" &amp; nr(2) &amp; \",Tabel80[[Kolom1]:[Inschrijver]],2)\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 8951937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd566d829510c6f6d2c193f8ebc0841a?s=128&d=identicon&r=PG&f=1", "display_name": "Milena", "link": "https://stackoverflow.com/users/8951937/milena"}, "edited": false, "score": 0, "creation_date": 1512633908, "post_id": 47683640, "comment_id": 82339526, "body": "Thankyou, I am really new to this so I can use every tip! what else would you change about the code?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 17, "user_id": 8951937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd566d829510c6f6d2c193f8ebc0841a?s=128&d=identicon&r=PG&f=1", "display_name": "Milena", "link": "https://stackoverflow.com/users/8951937/milena"}, "edited": false, "score": 0, "creation_date": 1512638008, "post_id": 47683640, "comment_id": 82341761, "body": "@MilenavanderVelde Updated my answer to reflect your comments."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 17, "user_id": 8951937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd566d829510c6f6d2c193f8ebc0841a?s=128&d=identicon&r=PG&f=1", "display_name": "Milena", "link": "https://stackoverflow.com/users/8951937/milena"}, "edited": false, "score": 0, "creation_date": 1512638108, "post_id": 47683640, "comment_id": 82341817, "body": "You could also make the loop from 2 to 31 dynamic, if it applies, do you only need it to go to 31? or are you trying to get the formula into the rows until the last row with data?"}, {"owner": {"reputation": 17, "user_id": 8951937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd566d829510c6f6d2c193f8ebc0841a?s=128&d=identicon&r=PG&f=1", "display_name": "Milena", "link": "https://stackoverflow.com/users/8951937/milena"}, "edited": false, "score": 0, "creation_date": 1512726926, "post_id": 47683640, "comment_id": 82383419, "body": "It only needs to go 31. Do you also have a tip for dynamic cell, so in my sheet I have tables who differ from size everytime. However I want to fill these headers and because everytime the header is in a different place, it is really hard to make a code to say where I have to place the header"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 17, "user_id": 8951937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd566d829510c6f6d2c193f8ebc0841a?s=128&d=identicon&r=PG&f=1", "display_name": "Milena", "link": "https://stackoverflow.com/users/8951937/milena"}, "edited": false, "score": 0, "creation_date": 1512727882, "post_id": 47683640, "comment_id": 82383997, "body": "Its quite hard to try to suggest something without having a look at how your data is laid out, if you can add a <b>sample</b> spreadsheet to something like Dropbox or Google Drive and add the link in your comments, then I will have a look at it, and try to make some suggestions for improvements..."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 3, "last_activity_date": 1512637980, "last_edit_date": 1512637980, "creation_date": 1512595284, "answer_id": 47683640, "question_id": 47683556, "link": "https://stackoverflow.com/questions/47683556/loop-with-vba-vlookup-with-dynamic-cell-value/47683640#47683640", "title": "Loop with VBA Vlookup, with dynamic cell value", "body": "<p>I'm pretty sure there are other things that could be improved in your code, but you should change:</p>\n\n<pre><code>\"=VLOOKUP(nr(2),Tabel80[[Kolom1]:[Inschrijver]],2)\"\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>\"=VLOOKUP(\" &amp; nr(2) &amp; \",Tabel80[[Kolom1]:[Inschrijver]],2)\"\n</code></pre>\n\n<p>Well it looks like you are wanting to enter the Vlookup on a range until nr(2) = Range(\"AN\" &amp; i).value = 0, so I don't know why you would use an array at all, if I knew what you were trying with more detail, could probably make it even better, but with what I know, this could do:</p>\n\n<pre><code>Sub tabelvul()\nFor i = 2 To 31\n    If Range(\"AN\" &amp; i).Value = 0 Then\n        ' do nothing\n    Else\n        Range(\"AA\" &amp; i).FormulaR1C1 = _\n            \"=VLOOKUP(\" &amp; Range(\"AN\" &amp; i).Value &amp; \",Tabel80[[Kolom1]:[Inschrijver]],2)\"\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8951937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd566d829510c6f6d2c193f8ebc0841a?s=128&d=identicon&r=PG&f=1", "display_name": "Milena", "link": "https://stackoverflow.com/users/8951937/milena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 47683640, "answer_count": 2, "score": 0, "last_activity_date": 1512637980, "creation_date": 1512594881, "last_edit_date": 1512629212, "question_id": 47683556, "link": "https://stackoverflow.com/questions/47683556/loop-with-vba-vlookup-with-dynamic-cell-value", "title": "Loop with VBA Vlookup, with dynamic cell value", "body": "<pre><code>Sub tabelvul()\n\nDim nr(2)\n\nFor i = 2 To 31\n    nr(1) = Range(\"AA\" &amp; i).Value\n    nr(2) = Range(\"AN\" &amp; i).Value\n    If nr(2) = 0 Then\n        ' do nothing\n    Else\n        Range(nr(1)).Select\n        ActiveCell.FormulaR1C1 = _\n            \"=VLOOKUP(nr(2),Tabel80[[Kolom1]:[Inschrijver]],2)\"\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>The first value <code>nr(1)</code> has is B4, so i do get the formula of Vlookup in B4, however he is searching for <code>nr(2)</code> and not the corresponding value of <code>nr(2)</code>, which is 1, so I want the formula to look for 1 in the table. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1512594361, "post_id": 47683398, "comment_id": 82326304, "body": "No vba needed, use the second answer here: <a href=\"https://stackoverflow.com/questions/20541905/convert-matrix-to-3-column-table-reverse-pivot-unpivot-flatten-normal\" title=\"convert matrix to 3 column table reverse pivot unpivot flatten normal\">stackoverflow.com/questions/20541905/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 9064068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5f83de7017b24d1cb32092fa8ae95e8?s=128&d=identicon&r=PG&f=1", "display_name": "abc", "link": "https://stackoverflow.com/users/9064068/abc"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512594559, "post_id": 47683398, "comment_id": 82326408, "body": "Thank you its exactly what I was looking for"}], "owner": {"reputation": 1, "user_id": 9064068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5f83de7017b24d1cb32092fa8ae95e8?s=128&d=identicon&r=PG&f=1", "display_name": "abc", "link": "https://stackoverflow.com/users/9064068/abc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 1, "closed_date": 1512594594, "answer_count": 0, "score": 0, "last_activity_date": 1512594144, "creation_date": 1512594144, "question_id": 47683398, "link": "https://stackoverflow.com/questions/47683398/how-to-convert-cross-tables-to-lists-in-vba", "closed_reason": "Duplicate", "title": "How to convert cross tables to lists in vba?", "body": "<p>I would like to know how we can use vba to convert the table on the range \"A1:C4\" to the one on \"F1:H6\" as shown in the following picture</p>\n\n<p><a href=\"https://i.stack.imgur.com/TCpWE.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/TCpWE.png</a></p>\n\n<p>Thanks</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1512596817, "post_id": 47683225, "comment_id": 82327537, "body": "There is an unnecessary apostrophe in your Execute expression. Do you have a table for each year? Should be 1 table."}, {"owner": {"reputation": 3, "user_id": 9057762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205940078375478/picture?type=large", "display_name": "Luca Agostoni", "link": "https://stackoverflow.com/users/9057762/luca-agostoni"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1512602210, "post_id": 47683225, "comment_id": 82329776, "body": "The database only collects data starting from January 1 2017. I\u2019m using that particular table to store the line items listed in the purchase orders table. The purpose of this form is to let the users assign many items to one sample."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1512722405, "post_id": 47683225, "comment_id": 82380766, "body": "What do you mean by &#39;add those records to the same row&#39;? A WHERE clause makes no sense for an INSERT action. What tables are the form and subform bound to? Why do you even need INSERT actions?"}, {"owner": {"reputation": 3, "user_id": 9057762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205940078375478/picture?type=large", "display_name": "Luca Agostoni", "link": "https://stackoverflow.com/users/9057762/luca-agostoni"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1512899761, "post_id": 47683225, "comment_id": 82435507, "body": "So, in the end the answer was absolutely correct. I posed the question in a wrong way, though. What I actually needed was to copy an information (the Sample Number) from the main form and paste it to a related record located in the subform. After you suggested the &quot;parent&quot; method, I realized it was actually much easier to work just within the form. I will paste the code later. Your answer was great, it helped me understand I was on an unnecessarily complicated path! Thanks a lot!"}, {"owner": {"reputation": 3, "user_id": 9057762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205940078375478/picture?type=large", "display_name": "Luca Agostoni", "link": "https://stackoverflow.com/users/9057762/luca-agostoni"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1512899765, "post_id": 47683225, "comment_id": 82435509, "body": "At first, I thought that the best way to achieve that goal was to use a temporary variable, store it on when clicking on the checkbox, and insert that value straight in the database."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1512902345, "post_id": 47683225, "comment_id": 82436090, "body": "If you have a form/subform arrangement and the main form and subform records are related, why do you need to copy SampleNumber to subform record?"}, {"owner": {"reputation": 3, "user_id": 9057762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205940078375478/picture?type=large", "display_name": "Luca Agostoni", "link": "https://stackoverflow.com/users/9057762/luca-agostoni"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1513031484, "post_id": 47683225, "comment_id": 82486446, "body": "The goal is to let different class of users (e.g. lab technicians) to flag each activity related to a sample. In this particular form, each form received by the lab administrative personnel is first recorded in the database, and then assigned a purchase order number. The lab technician will open a similar form, and flag (assign) all the activities that are needed to be done on the sample. The sample value is then stored on the Activities table and used in other queries. The entire process right now is done by hand and is quite effective though not as efficient."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9057762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205940078375478/picture?type=large", "display_name": "Luca Agostoni", "link": "https://stackoverflow.com/users/9057762/luca-agostoni"}, "edited": false, "score": 0, "creation_date": 1512640119, "post_id": 47683967, "comment_id": 82343131, "body": "First of all, thanks for your answer! Yes, the code is assigned to a checkbox named &quot;AssegnatoCampione&quot;. The control source is a YES/NO field named in the same way (&quot;AssegnatoCampione&quot;), located in the table named DB_Offerte2017. I tried the solution you proposed but it gives me the same error message. I think there&#39;s something wrong with my TempVar instruction."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 3, "user_id": 9057762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205940078375478/picture?type=large", "display_name": "Luca Agostoni", "link": "https://stackoverflow.com/users/9057762/luca-agostoni"}, "edited": false, "score": 0, "creation_date": 1512722482, "post_id": 47683967, "comment_id": 82380809, "body": "I see you got the code to work with an adjustment for text delimiters."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1512597094, "last_edit_date": 1512597094, "creation_date": 1512596761, "answer_id": 47683967, "question_id": 47683225, "link": "https://stackoverflow.com/questions/47683225/locate-a-tempvar-in-a-ms-access-main-form-and-write-it-to-a-table-connected-to-t/47683967#47683967", "title": "Locate a TempVar in a MS Access main form and write it to a table connected to the subform", "body": "<p>Why not just a normal VBA variable or just reference the control? Code is behind subform and field/control on main form? Try:</p>\n\n<p><code>CurrentDb.Execute \"INSERT INTO DB_Offerte2017([NumeroCampione]) VALUES (\" &amp; Me.Parent.SampleNo &amp; \")\", dbFailOnError</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 9057762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205940078375478/picture?type=large", "display_name": "Luca Agostoni", "link": "https://stackoverflow.com/users/9057762/luca-agostoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 687, "favorite_count": 0, "accepted_answer_id": 47683967, "answer_count": 1, "score": 0, "last_activity_date": 1512642919, "creation_date": 1512593399, "last_edit_date": 1512642919, "question_id": 47683225, "link": "https://stackoverflow.com/questions/47683225/locate-a-tempvar-in-a-ms-access-main-form-and-write-it-to-a-table-connected-to-t", "title": "Locate a TempVar in a MS Access main form and write it to a table connected to the subform", "body": "<p>I need to add some VBA code to a checkbox located on a subform of my front end Access 2016 database. </p>\n\n<p>The goal is to insert to a table the value contained in a textbox located in the main form.</p>\n\n<p>So far, the steps I took are:</p>\n\n<ol>\n<li>Click on the checkbox located on the subform;</li>\n<li>Create a temporary variable;</li>\n<li>Insert the temporary variable into the related table;</li>\n<li>Move on to the next item.</li>\n</ol>\n\n<p>The code is the following:</p>\n\n<pre><code>    Option Compare Database\n\n    Private Sub AssegnatoCampione_Click()\n\n        'Create temporary variable and store the selected value\n        TempVars(\"NumeroCampione\").Value = Forms!FormCampioni2.SampleNo.Value\n\n        'Write the value in the database\n        CurrentDb.Execute \" INSERT INTO DB_Offerte2017 \" _\n                        &amp; \"([NumeroCampione]) VALUES \" _\n                        &amp; \"(\" &amp; TempVars![NumeroCampione] &amp; \")\" ', dbFailOnError\n    End Sub\n</code></pre>\n\n<p>The error I get is: .</p>\n\n<p><a href=\"https://i.stack.imgur.com/cZjK1.jpg\" rel=\"nofollow noreferrer\">\"Too few parameters. Expected 1.\"</a></p>\n\n<p>Is there a way to know whether the variable is stored correctly or not?</p>\n\n<p>Thank you so much for your help. </p>\n\n<p><strong>Edit 1:</strong></p>\n\n<p>Ok, so i guess that the error was due to DB_Offerte2017([NumeroCampione]) being a text field. I corrected the code in this way:         </p>\n\n<pre><code>CurrentDb.Execute \"INSERT INTO DB_Offerte2017 ( NumeroCampione ) VALUES ('\" &amp; Me.Parent.SampleNo &amp; \"')\", dbFailOnError\n</code></pre>\n\n<p>This way, every time I click on the check box, a new record is added in the table \"DB_Offerte2017\", under the field \"NumeroCampione\". </p>\n\n<p>However, I need to add those records to the same row where the checkboxes is located (e.g. Click on checkbox where ID = 2438 -> Add \"SampleNo\" value on DB_Offerte2017.NumeroCampione where ID = 2438).</p>\n\n<p>Is it possible to add a where statement in the code? </p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 2153, "user_id": 3687725, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/1We1W.jpg?s=128&g=1", "display_name": "Preston Martin", "link": "https://stackoverflow.com/users/3687725/preston-martin"}, "edited": false, "score": 1, "creation_date": 1512592170, "post_id": 47682908, "comment_id": 82325141, "body": "Can you post the code that you have thus far?"}, {"owner": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "reply_to_user": {"reputation": 2153, "user_id": 3687725, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/1We1W.jpg?s=128&g=1", "display_name": "Preston Martin", "link": "https://stackoverflow.com/users/3687725/preston-martin"}, "edited": false, "score": 0, "creation_date": 1512592592, "post_id": 47682908, "comment_id": 82325384, "body": "Sorry, I don&#39;t know how to start this, I see a Setfocus command, but no IsItFocused. And I see a DblClick and MouseDown private sub for textbox1 but I don&#39;t see any subs for Focused or SingleClick. any suggestions would be great"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "edited": false, "score": 0, "creation_date": 1512593120, "post_id": 47683052, "comment_id": 82325660, "body": "Pretty good, lolz can&#39;t believe that was only two lines; however, it doesn&#39;t deselect if I double click. it will deselect if I double click on the last character in the textbox, but won&#39;t deselect if I double click in the middle. is there a work-around for that?"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "edited": false, "score": 0, "creation_date": 1512593913, "post_id": 47683052, "comment_id": 82326085, "body": "just use arrow key to move to desire spot in text."}, {"owner": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "edited": false, "score": 0, "creation_date": 1512594236, "post_id": 47683052, "comment_id": 82326247, "body": "@pokemin_Man ikr, makes sense to you and me but it won&#39;t it to make sense to others. you end up getting other people yelling at you for making them work anything more than the initial mouse click. I don&#39;t even know if excel is able to do these kinda things. thanks."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "edited": false, "score": 0, "creation_date": 1512594449, "post_id": 47683052, "comment_id": 82326347, "body": "@benmazor tell them either use this or you will have to double click the text in the textbox to override/delete it ect."}, {"owner": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "edited": false, "score": 0, "creation_date": 1512595801, "post_id": 47683052, "comment_id": 82327024, "body": "sorry, it&#39;s only a partial solution. I did say in my question that I don&#39;t want the text box to stay constantly selected after the first click. ill give you a check I guess until something better comes."}], "tags": [], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1512596813, "last_edit_date": 1512596813, "creation_date": 1512592608, "answer_id": 47683052, "question_id": 47682908, "link": "https://stackoverflow.com/questions/47682908/excel-vba-userform-if-focus-changes-trigger/47683052#47683052", "title": "Excel VBA Userform If Focus Changes Trigger", "body": "<p>put this in your textbox event</p>\n\n<pre><code>Dim checked As Boolean\n\nPrivate Sub TextBox1_Change()\n    If checked = True Then\n        TextBox1.SelStart = 0\n        TextBox1.SelLength = 0\n    checked = True\n    End If\nEnd Sub\n\n\nPrivate Sub TextBox1_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n    checked = False\nEnd Sub\n\nPrivate Sub TextBox1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    If checked = False Then\n        TextBox1.SelStart = 0\n        TextBox1.SelLength = Len(TextBox1)\n        checked = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>once you click your textbox, it will hightlight the text, if you click the text, it will unhightlight and allow you to modified the text. if you click outside that textbox and click back inside that will rehighlight the whole text.</p>\n"}], "owner": {"reputation": 39, "user_id": 8870287, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BzBlU.jpg?s=128&g=1", "display_name": "ben mazor", "link": "https://stackoverflow.com/users/8870287/ben-mazor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1088, "favorite_count": 0, "accepted_answer_id": 47683052, "answer_count": 1, "score": -3, "last_activity_date": 1512596813, "creation_date": 1512591960, "question_id": 47682908, "link": "https://stackoverflow.com/questions/47682908/excel-vba-userform-if-focus-changes-trigger", "title": "Excel VBA Userform If Focus Changes Trigger", "body": "<p>I have a couple user forms in VBA, id like to add a feature that when a user first clicks on a textbox (changes the focus to it), any text inside gets selected. I've seen this feature in some accounting applications and in your web browser when you first click the URL bar. Its essentially meant so that users can immediately overwrite a text field. Was wondering how I might do the same in VBA, but I'm still a novice. I looked through a couple sub triggers(dont know the correct term) but haven't seen any. I found one for when you click the text box but I don't want the text constantly being selected every time I click the field. \nThanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512592060, "post_id": 47682890, "comment_id": 82325077, "body": "What is the problem you are encountering and on what line?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512592245, "post_id": 47682890, "comment_id": 82325190, "body": "As a side note, you could omit <code>ActiveSheet</code> prefix before <code>Cells</code> for the sake of readability, because when you use just <code>Cells</code> you automatically refer to active sheet."}, {"owner": {"reputation": 23, "user_id": 8895366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd98fc29d8478ee3118a79404f6ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "coffee123", "link": "https://stackoverflow.com/users/8895366/coffee123"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512592272, "post_id": 47682890, "comment_id": 82325203, "body": "@ScottCraner &quot;Object Required&quot; on the line  &quot;If Not ActiveSheet.Cells(i, ColA).Value.Find(&quot;4&quot;, lookat:=xlPart) Then&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 3, "creation_date": 1512592292, "post_id": 47682890, "comment_id": 82325215, "body": "@JohnyL for the love of pete that is terrible advice.  One should always set the parent sheet regardless."}, {"owner": {"reputation": 23, "user_id": 8895366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd98fc29d8478ee3118a79404f6ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "coffee123", "link": "https://stackoverflow.com/users/8895366/coffee123"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512592320, "post_id": 47682890, "comment_id": 82325234, "body": "@ScottCraner Counter point noted as well!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512592472, "post_id": 47682890, "comment_id": 82325313, "body": "Add <code>Is Nothing</code> before the <code>Then</code> on that statement"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512592725, "post_id": 47682890, "comment_id": 82325463, "body": "@ScottCraner Perhaps, this is terrible for you, but I prefer simplicity. The polluted code is a nighmare to read. If you write in C#, I hope you don&#39;t write <code>System.Data.SqlClient.SqlConnection</code> <b>every time</b> you use SqlConnection? Or <code>System.Text.RegularExpression.Regex</code>?"}, {"owner": {"reputation": 23, "user_id": 8895366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd98fc29d8478ee3118a79404f6ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "coffee123", "link": "https://stackoverflow.com/users/8895366/coffee123"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512592817, "post_id": 47682890, "comment_id": 82325511, "body": "@ScottCraner Same error"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 2, "creation_date": 1512592824, "post_id": 47682890, "comment_id": 82325516, "body": "I am talking about vba, When using vba in Excel one should <b><i>Always</i></b> declare the parent of all Range Objects.  If you want clean looking, use <code>With</code> Blocks and worksheet variables. @JohnyL"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512592917, "post_id": 47682890, "comment_id": 82325555, "body": "Change it to <code>If ActiveSheet.Cells(i, ColA).Value &lt;&gt; 4 then</code>"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1512593093, "post_id": 47682890, "comment_id": 82325640, "body": "Maybe change it to Activesheet.Cells(i,ColA).Find(&quot;4&quot;, LookIn:=xlValues,.LookAt:=xlPart)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512593115, "post_id": 47682890, "comment_id": 82325656, "body": "@JohnyL the issue comes when the code get longer and more complicated with multiple sheets, many times the user by switching sheets can screw up the execution.  If you are the only one using the code, because you understand what needs to be active during the run, or if the code is on the worksheet code sheet and not a module leaving it off would not cause problems."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512593202, "post_id": 47682890, "comment_id": 82325717, "body": "@ScottCraner You say <b>always</b>, but it&#39;s not clear why OP <b>must</b> follow your <b>not so good</b> advice. The readability of code is worse with senseless prefixing with ActiveSheet. This just distracts reader (and writer too) from code. I ain&#39;t gonna assure you why your advice is bad, so I think this is the spot to stop."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 2, "creation_date": 1512594118, "post_id": 47682890, "comment_id": 82326192, "body": "@JohnyL implicit activesheet references are the cause of the bug behind about one in three VBA questions asked on this site every day. Readability means code that says what it does, and does what it says. Unqualified <code>Cells</code> property accessor calls do different things depending on whether you&#39;re in a worksheet module or a standard or class module. This isn&#39;t about qualifying the namespace, it&#39;s about qualifying the parent object, which is an implicit hidden <code>_Global</code> module if omitted. Scott is correct."}, {"owner": {"reputation": 23, "user_id": 8895366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd98fc29d8478ee3118a79404f6ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "coffee123", "link": "https://stackoverflow.com/users/8895366/coffee123"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512601806, "post_id": 47682890, "comment_id": 82329636, "body": "@ScottCraner It may have other codes in the Codes column i.e (1,3,5,4) and therefore I don&#39;t think &lt;&gt;4 will work. It could be (4,3,2) and your code would add 4 again to that no?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512603609, "post_id": 47682890, "comment_id": 82330322, "body": "Okay <code>IF Instr(ActiveSheet.Cells(i, ColA).Value,&quot;4&quot;)=0 then</code>"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1512624652, "post_id": 47682890, "comment_id": 82335631, "body": "@Mat&#39;sMug So, when I use Cells in sheet module, I do understand that it refers to sheet <i>in question</i>, but when you use ActiveSheet, then you really mean active sheet - whichever happens to be active. As for Scott Craner&#39;s offering to use With construction - this, too, adds complexity to code as you should track what empty dot means. That&#39;s why, I guess, it was left out in JavaScript in ES6+ and is not implemented in C#."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512624960, "post_id": 47682890, "comment_id": 82335740, "body": "@JohnyL <i>You</i> understand it. Many, <i>many</i> rookies don&#39;t. The specific quirks and implementation details of a given API/object model add to the cognitive load of the code - hence explicit code that <i>does what it says and says what it does</i> is preferable."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1512627127, "post_id": 47682890, "comment_id": 82336516, "body": "@Mat&#39;sMug I will disappoint you, but ActiveSheet.Cells is <b>NOT enough</b>, too! Guess, why!"}], "owner": {"reputation": 23, "user_id": 8895366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd98fc29d8478ee3118a79404f6ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "coffee123", "link": "https://stackoverflow.com/users/8895366/coffee123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513266631, "creation_date": 1512591878, "last_edit_date": 1513266631, "question_id": 47682890, "link": "https://stackoverflow.com/questions/47682890/how-can-i-verify-if-a-string-exists-in-a-cell-and-if-not-add-it-as-part-of-a", "title": "How can I verify if a string exists in a cell, and if not, add it, as part of a larger loop?", "body": "<p>I am trying to loop through a sheet and add a number to the column \"Codes\", if it isn't already there,(along with highlighting all 3 cells in the row in red) given a certain condition holds (Column C/Column B > .8). (Given the below, I'd want to add the Code \"4\" anywhere that C/B > .80 and '4' isn't already in Codes.)</p>\n\n<pre><code>   Codes    B          C\n    1       100       90\n    2       100       95\n            100       82\n    6       100       70\n    4       100       85\n</code></pre>\n\n<p>I have tried the following:</p>\n\n<pre><code>Public Sub Testing()\nDim ValA    As Range\nDim ValB    As Range\nDim ValC    As Range\nDim ColA    As Long\nDim ColB    As Long\nDim ColC    As Long\nDim i       As Long\nDim LastRow As Long\n\n'Set Variables\nSet ValA = ActiveSheet.Rows(1).Find(\"Codes\", lookat:=xlWhole)\nIf Not ValA Is Nothing Then\n    ColA = ValA.Column\nEnd If\n\nSet ValB = ActiveSheet.Rows(1).Find(\"B\", lookat:=xlWhole)\nIf Not ValB Is Nothing Then\n    ColB = ValB.Column\nEnd If\n\nSet ValC = ActiveSheet.Rows(1).Find(\"C\", lookat:=xlWhole)\nIf Not ValC Is Nothing Then\n    ColC = ValC.Column\nEnd If\n\nLastRow = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row\n\n'loop\n'Since you cant have any 0's in a division calc:\nIf ColC &gt; 0 And ColB &gt; 0 Then\n    For i = 2 To LastRow\n        If ActiveSheet.Cells(i, ColB).Value &lt; 1 Or ActiveSheet.Cells(i, ColB) = \"N/A\" Then\n            ActiveSheet.Cells(i, ColB).Interior.ColorIndex = 3\n            ActiveSheet.Cells(i, ColC).Interior.ColorIndex = 3\n\n        ElseIf ActiveSheet.Cells(i, ColC).Value &gt; ActiveSheet.Cells(i, ColB).Value * 0.8 Then\n            If Not ActiveSheet.Cells(i, ColA).Value.Find(\"4\", lookat:=xlPart) Then\n                ActiveSheet.Cells(i, ColC).Interior.ColorIndex = 3\n                ActiveSheet.Cells(i, ColB).Interior.ColorIndex = 3\n                ActiveSheet.Cells(i, ColA).Interior.ColorIndex = 3\n                ActiveSheet.Cells(i, ColA).Value = ActiveSheet.Cells(i, ColA).Value &amp; \" 4\"\n\n            End If\n        End If\n    Next i\nElse: MsgBox \"Matches werent found for B and C\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512591202, "post_id": 47682685, "comment_id": 82324626, "body": "Are you sure the userid of the other user is <code>&quot;mjackson&quot;</code>, and not perhaps <code>&quot;MJackson&quot;</code>?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512591332, "post_id": 47682685, "comment_id": 82324698, "body": "Change <code>Select Case strUser</code> to <code>Select Case LCase(strUser)</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1512591499, "post_id": 47682685, "comment_id": 82324774, "body": "FWIW - The simplest thing to cater for &quot;anyone else&quot; is to use <code>Case Else</code> for the second case."}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512591673, "post_id": 47682685, "comment_id": 82324868, "body": "@YowE3K I wasn&#39;t aware the user name could be case sensitive. Unfortunately though, all user names are lower case."}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512591758, "post_id": 47682685, "comment_id": 82324913, "body": "@JohnyL I tried your suggestion and nothing happens still. For my knowledge, your solution would have made all usernames lower case, yes?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512591864, "post_id": 47682685, "comment_id": 82324977, "body": "No, not all usernames are lowercase.  Mine isn&#39;t."}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512591890, "post_id": 47682685, "comment_id": 82324996, "body": "@YowE3K I replaced my Case Is = &quot;mjackson&quot; with your case else option but I still have nothing happen when the case else should be firing the message box. I tried your suggestion with and without johnyl&#39;s suggestion."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1512592020, "post_id": 47682685, "comment_id": 82325064, "body": "Why are you turning off <code>Application.ScreenUpdating</code>?  Are you under the impression that&#39;s a security option?  Why are you checking if the workbook is opened as <code>Read Only</code>?  Are you sure it <i>is</i> Read Only?  You do realize that there are very simple ways around &quot;security&quot; like this?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512592074, "post_id": 47682685, "comment_id": 82325086, "body": "You shouldn&#39;t guess which case a user&#39;s account can be - that&#39;s why you convert all characters into lower case. Thus, you can safely make a comparison."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512592171, "post_id": 47682685, "comment_id": 82325143, "body": "Did you try his other suggestion too?  You have more than one thing that could be going wrong, so the next step of  troubleshooting is to start removing lines until your message box is working, and then add your code back in one thing at a time until you find the problem.  Please check out: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512592386, "post_id": 47682685, "comment_id": 82325270, "body": "It&#39;s unclear what you&#39;re trying to do.  Can you explain step by step?  Maybe some screen shots?  Also, if you&#39;re not logged in as the user who&#39;s &quot;security&quot; you&#39;re setting up, there&#39;s not much point in trying to troubleshoot why &quot;his&quot; msgbox isn&#39;t opening."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512592493, "post_id": 47682685, "comment_id": 82325322, "body": "It seems strange that you are opening a file when two specific users run the macro from a read-only workbook, but you want to give a message to other users only if the macro is run from a <b>non</b> read-only workbook.  You have four scenarios - (1) valid users from read-only workbook (2) valid users from non read-only (3) invalid users from read-only (4) invalid users from non read-only.  What do you want to do in each of those four situations?"}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1512593206, "creation_date": 1512593206, "answer_id": 47683187, "question_id": 47682685, "link": "https://stackoverflow.com/questions/47682685/msgbox-within-an-if-statement-not-working/47683187#47683187", "title": "MsgBox within an If statement not working", "body": "<p>Your use of <code>IS</code> here may be the culprit. At best it's superfluous, at worse it's masking this issue. Instead try:</p>\n\n<pre><code>Sub Button1_Click()\n\nDim wb As Workbook\nDim strUser As String\nstrUser = Environ(\"USERNAME\")\n\n  Application.ScreenUpdating = False\n\n  Select Case strUser\n\n    ' Full Workbook Access\n    Case \"bhope\", \"jdean\"\n       If ActiveWorkbook.ReadOnly Then _\n          Set wb = Workbooks.Open(Filename:=\"M:\\...\", Password:=\"TEST\")\n\n    ' Limit Access\n    Case \"mjackson\" \n       If Not ActiveWorkbook.ReadOnly Then _\n          MsgBox (\"This button is reserved for SAMs\")\n  End Select\n\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Also consider changing that second CASE to <code>CASE ELSE</code>.</p>\n\n<p>The other thing is that your msgbox is inside of your <code>IF</code> condition. <code>strUser</code> must be uqual to <code>mjackson</code> AND the ActiveWorkbook (whatever that might be at the time this code executes) must NOT be ReadOnly for that msgbox to fire. </p>\n\n<ol>\n<li><p>Consider changing \"ActiveWorkbook\" to be more specific. Perhaps <code>ThisWorkbook.ReadOnly</code>?</p></li>\n<li><p>Consider an <code>Else</code> for your if statement to see if the <code>mjackson</code> is hitting but the <code>readonly</code> is not:</p>\n\n<pre><code>Case \"mjackson\" \n   If Not ActiveWorkbook.ReadOnly Then \n      MsgBox (\"This button is reserved for SAMs\")\n   Else\n      MsgBox (\"ActiveWorkbook is not Read Only so yo get this message\")\n   End If\n</code></pre></li>\n</ol>\n\n<p>Lastly, put a breakpoint (F9) on <code>SELECT</code> and see what your value of <code>strUser</code> as while the code is running (hover over <code>strUSer</code> on that line or check your Locals pane). You may also want to see what <code>ActiveWorkbook</code> is at this point of time too, just in case. The answer will, again, be in your Locals pane, so make sure that is turned on in the <code>view</code> drop down of VBE.</p>\n"}, {"tags": [], "owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "is_accepted": false, "score": 0, "last_activity_date": 1512596283, "creation_date": 1512596283, "answer_id": 47683860, "question_id": 47682685, "link": "https://stackoverflow.com/questions/47682685/msgbox-within-an-if-statement-not-working/47683860#47683860", "title": "MsgBox within an If statement not working", "body": "<p>I figured out the solution. Apparently the \"case else\" I said I tried earlier was actually done to another test file with similar code as I usually have several open when I'm testing to compare behaviors. I also had to delete the line below \"case else\" so that only the msg box line would run after that. Below is the code I used should anyone need it in the future:</p>\n\n<pre><code>Sub Button1_Click()\n\nDim wb As Workbook\nDim strUser As String\nstrUser = Environ(\"USERNAME\")\n\nApplication.ScreenUpdating = False\n\nSelect Case LCase(strUser)\n' Full Workbook Access\nCase Is = \"bhope\", \"jdean\"\nIf ThisWorkbook.ReadOnly Then _\nSet wb = Workbooks.Open(Filename:=\"M:...\", Password:=\"TEST\")\n' Limit Access\nCase Else\nMsgBox (\"This button is reserved for SAMs\")\nEnd Select\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>To answer earlier questions: my understanding of screen update is that if it's turned off, the application will run non-visually so as not to cause concern for the users who will be using this file. Also, this code makes it run faster, does it not?</p>\n\n<p>As far as the purpose of the workbook and security concerns... the button will be used on a read only workbook that houses many portions of our company's metrics. The file is made read only so that users cannot save over it. Since the file is kind of big and a lot of data is expected to go into it, my thought process was to load the \"Shell\" of the main file then have buttons that determine who should be allowed to add info to certain sheets. By having both files read only and password-protected, I'm able to open the 2nd sheet when the appropriate user clicks the button, then have data transfer back and forth between the workbooks. I still intend on password protecting the VBA code so I don't see how their could be a security concern. Also, @ashleedog, I meant that everyone in our company has lower case user names.</p>\n"}], "owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 384, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512596283, "creation_date": 1512591054, "last_edit_date": 1531164843, "question_id": 47682685, "link": "https://stackoverflow.com/questions/47682685/msgbox-within-an-if-statement-not-working", "title": "MsgBox within an If statement not working", "body": "<p>I'm trying to use the following code to open a password protected file if the Windows user is \"bhope\" or \"jdean\" and display a message box if the user is anyone else. It opens the file as needed when the user is \"bhope\" or \"jdean\" but if another user clicks the button, nothing happens/no error. What am I missing?</p>\n\n<pre><code>Sub Button1_Click()\n\nDim wb As Workbook\nDim strUser As String\nstrUser = Environ(\"USERNAME\")\n\n  Application.ScreenUpdating = False\n\n  Select Case strUser\n\n    ' Full Workbook Access\n    Case Is = \"bhope\", \"jdean\"\n       If ActiveWorkbook.ReadOnly Then _\n          Set wb = Workbooks.Open(Filename:=\"M:\\...\", Password:=\"TEST\")\n\n    ' Limit Access\n    Case Is = \"mjackson\" 'also tried \"Case Is &lt;&gt; \"bhope\", \"jdean\"\n       If Not ActiveWorkbook.ReadOnly Then _\n          MsgBox (\"This button is reserved for SAMs\")\n  End Select\n\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>If it helps, I used <a href=\"https://www.mrexcel.com/forum/excel-questions/80796-how-set-readonly-vba.html\" rel=\"nofollow noreferrer\">this link</a> to start the base of the code and tried to modify it from there. Thanks and cheers!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1512591140, "post_id": 47682672, "comment_id": 82324591, "body": "Are there any worksheet error codes (e.g. #DIV/0!, #N/A, etc) in columns H or K?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512591150, "post_id": 47682672, "comment_id": 82324596, "body": "not your problem but, <code>With sh.Cells</code> is not doing anything as you never reference it inside the block."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512591266, "post_id": 47682672, "comment_id": 82324659, "body": "What does error say?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1512591573, "post_id": 47682672, "comment_id": 82324809, "body": "<code>Loop Until nRows &gt; LastRow</code> would be safer.  Are you sure your LastRow is getting set correctly?  You don&#39;t specify a sheet here LastRow = <code>Cells(Rows.Count, 1).End(xlUp).Row</code> so are you sure the value isn&#39;t 1, in which case your loop goes off the bottom of the sheet?  A <code>For Next</code> would be more appropriate for this use case.  And as @ScottCraner points out you seem to have an issue with your <code>With</code> blocks."}], "owner": {"reputation": 21, "user_id": 9063810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829d0696b2273560589fe8f25bdbe04a?s=128&d=identicon&r=PG&f=1", "display_name": "DChev", "link": "https://stackoverflow.com/users/9063810/dchev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1513266711, "creation_date": 1512591014, "last_edit_date": 1531161705, "question_id": 47682672, "link": "https://stackoverflow.com/questions/47682672/vbaruntime-error-1004", "title": "VBARuntime error 1004", "body": "<p>I\u2019m attempting to write a macro that will filter a set of data by two criteria and then copy and paste that data into a new sheet. I have it working so that it creates the new sheet and adds the header row but I keep getting a runtime error for the following If statement and I can\u2019t for the life of me figure out why. </p>\n\n<pre><code>If sh.Cells(nRows, 8).Value = \"PS\" And sh.Cells(nRows, 11).Value = \"Key Player\" Then\n</code></pre>\n\n<p>Can anyone help? I\u2019ve copied the full code below.</p>\n\n<pre><code>Option Explicit\nSub CopyPSStakeholders()\nDim sh      As Worksheet\nDim DestSh  As Worksheet\nDim StartRow As Long\nDim i       As Integer\nDim headers() As Variant\nDim nRows   As Long\n\nDim LastRow As Long\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n'Delete the PS Stakeholders sheet if it exists.\nApplication.DisplayAlerts = False\nOn Error Resume Next\n\nActiveWorkbook.Worksheets(\"PS Stakeholders\").Delete\nOn Error GoTo 0\nApplication.DisplayAlerts = True\n\n'Add a new PS Stakeholders worksheet.\nSet DestSh = ActiveWorkbook.Worksheets.Add\nDestSh.Name = \"PS Stakeholders\"\n\nSet sh = ActiveWorkbook.Worksheets(\"Stakeholders\")\n\n'Insert header row.\nheaders() = Array(\"Key Player - Post\", \"Key Player - UID\", \"Actively Involve - Post\", \"Actively Involve - UID\", \"Keep Informed - Post\", \"Keep Informed - UID\")\n\nWith DestSh.Cells\n    .Rows(1).Value = \"\"      'This will clear out row 1\n    For i = LBound(headers()) To UBound(headers())\n        .Cells(1, 1 + i).Value = headers(i)\n    Next i\n    .Rows(1).Font.Bold = True\nEnd With\n\n'Count the last used row of data\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n'Set the first row of data\nnRows = 2\n\n'Filter and copy/paste\nWith sh.Cells\n    Do\n        If sh.Cells(nRows, 8).Value = \"PS\" And sh.Cells(nRows, 11).Value = \"Key Player\" Then\n            DestSh.Cells(nRows, 1).Value = sh.Cells(nRows, 3).Value\n        End If\n        nRows = nRows + 1\n    Loop Until nRows = LastRow\nEnd With\n\nExitTheSub:\nApplication.Goto DestSh.Cells(1)\n\n' AutoFit the column width in the summary sheet.\nDestSh.Columns.AutoFit\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\n\nWith Sheets(\"Active\")\n    .Visible = True\n    .Activate\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 634, "user_id": 7225652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D85eE.jpg?s=128&g=1", "display_name": "Peter Pesch", "link": "https://stackoverflow.com/users/7225652/peter-pesch"}, "edited": false, "score": 0, "creation_date": 1512590665, "post_id": 47682509, "comment_id": 82324321, "body": "The first argument of VLookup should be a single value. Probably <code>csatSum.Cells(i, 1)</code>."}, {"owner": {"reputation": 634, "user_id": 7225652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D85eE.jpg?s=128&g=1", "display_name": "Peter Pesch", "link": "https://stackoverflow.com/users/7225652/peter-pesch"}, "edited": false, "score": 0, "creation_date": 1512590751, "post_id": 47682509, "comment_id": 82324378, "body": "I think it should be <code>rngLastRow = Comments.Range(&quot;B1:B&quot; &amp; lastRow)</code>; The second parameter of VLookup should be the lookup table."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1512590766, "post_id": 47682509, "comment_id": 82324393, "body": "<code>rngLastRow = Comments.Range(&quot;B2:B&quot; &amp; lastRow)</code> will return an array and as such <code>Comments.Range(rngLastRow)</code> will not work.  You need to set that as a range then just call it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1512590776, "post_id": 47682509, "comment_id": 82324398, "body": "Your lookup table (even if it were correctly coded) only has a single column, yet you want to return a value from the second column.  Your lookup table should include any columns from which you want to return a value."}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1512590872, "post_id": 47682627, "comment_id": 82324462, "body": "<code>rngLastRow</code> here is a 2D array (unless lastRow=1) - you cannot pass that to <code>Range()</code>  Adding <code>Set</code> to the assignment would make it a range (and so it wouldn&#39;t need wrapping in Range() )"}, {"owner": {"reputation": 634, "user_id": 7225652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D85eE.jpg?s=128&g=1", "display_name": "Peter Pesch", "link": "https://stackoverflow.com/users/7225652/peter-pesch"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1512591449, "post_id": 47682627, "comment_id": 82324746, "body": "OK, I see. Added the Set now."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1512649941, "post_id": 47682627, "comment_id": 82349746, "body": "Yes! This worked.  Thank you to all for the assistance!"}], "tags": [], "owner": {"reputation": 634, "user_id": 7225652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D85eE.jpg?s=128&g=1", "display_name": "Peter Pesch", "link": "https://stackoverflow.com/users/7225652/peter-pesch"}, "is_accepted": true, "score": 3, "last_activity_date": 1512591343, "last_edit_date": 1512591343, "creation_date": 1512590809, "answer_id": 47682627, "question_id": 47682509, "link": "https://stackoverflow.com/questions/47682509/excel-vba-vlookup-not-copying-data/47682627#47682627", "title": "Excel VBA - VLookup not copying data", "body": "<p>I think it should be:</p>\n\n<pre><code>scores.UsedRange.Columns.Copy\ncsatSum.Range(\"A1\").Insert\n'csatSum.Activate\n'Set rng = csatSum.Range(\"A2:A\" &amp; lastRow)\nSet rngLastRow = Comments.Range(\"A2:B\" &amp; lastRow)\nFor i = 2 To lastRow\n    On Error Resume Next\n    csatSum.Cells(i, 5) = WorksheetFunction.VLookup(csatSum.Cells(i, 1), rngLastRow, 2, False)\n    On Error GoTo 0\nNext i\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 47682627, "answer_count": 1, "score": 0, "last_activity_date": 1512591343, "creation_date": 1512590338, "question_id": 47682509, "link": "https://stackoverflow.com/questions/47682509/excel-vba-vlookup-not-copying-data", "title": "Excel VBA - VLookup not copying data", "body": "<p>I have done my best to read every thread imaginable to rewrite my overall code to get this to work.</p>\n\n<p>Situation: I have data in sheet2 (Scores) and data in sheet3 (Comments).  In each sheet, column A has a ticket number.  The Scores sheet includes every possible ticket number; the Comments sheets only includes a subset of that total (approx 50%).  The Scores sheet includes 4 populated columns while the Comments sheet has 2.  I need the lookup to match the common existing rows (ticket numbers), and then take the value in Comments column B (2) and paste it in Column E (5) of sheet1, which is the CSAT Summary sheet, and has the contents of Col A-D from the Scores sheet.</p>\n\n<p>Below is the current code.  If I remove the VLookup and just put a variable (such as \"A\"), it does paste A in the correct column, albeit on every single line...</p>\n\n<pre><code>scores.UsedRange.Columns.Copy\ncsatSum.Range(\"A1\").Insert\ncsatSum.Activate\nSet rng = csatSum.Range(\"A2:A\" &amp; lastRow)\nrngLastRow = Comments.Range(\"B2:B\" &amp; lastRow)\nFor i = 2 To lastRow\n    On Error Resume Next\n    csatSum.Cells(i, 5) = WorksheetFunction.VLookup(rng, Comments.Range(rngLastRow), 2, False)\n    On Error GoTo 0\nNext i\n</code></pre>\n\n<p>Not sure what I am missing.  Obviously it is something in the VLookup itself.  But I am at a loss.</p>\n"}, {"tags": ["c#", "excel", "vba", "excel-formula", "office-interop"], "comments": [{"owner": {"reputation": 2583, "user_id": 2908576, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/yhWY7.jpg?s=128&g=1", "display_name": "HaveSpacesuit", "link": "https://stackoverflow.com/users/2908576/havespacesuit"}, "edited": false, "score": 0, "creation_date": 1512589488, "post_id": 47682240, "comment_id": 82323696, "body": "I&#39;m not sure how German excel formulas work, but in English <code>=SUM(B1; C1)</code> is invalid. You can use <code>,</code> for a list or <code>:</code> for a range."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2583, "user_id": 2908576, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/yhWY7.jpg?s=128&g=1", "display_name": "HaveSpacesuit", "link": "https://stackoverflow.com/users/2908576/havespacesuit"}, "edited": false, "score": 0, "creation_date": 1512589744, "post_id": 47682240, "comment_id": 82323833, "body": "@HaveSpacesuit not in all English.  Some use <code>;</code> instead of <code>,</code>."}, {"owner": {"reputation": 12289, "user_id": 3764804, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/fZQON.png?s=128&g=1", "display_name": "BullyWiiPlaza", "link": "https://stackoverflow.com/users/3764804/bullywiiplaza"}, "reply_to_user": {"reputation": 2583, "user_id": 2908576, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/yhWY7.jpg?s=128&g=1", "display_name": "HaveSpacesuit", "link": "https://stackoverflow.com/users/2908576/havespacesuit"}, "edited": false, "score": 0, "creation_date": 1512589746, "post_id": 47682240, "comment_id": 82323836, "body": "@HaveSpacesuit: Yes, in German it would be exactly the following: <code>=SUMME(B1; C1)</code>. In English US it&#39;s <code>=SUM(B1, C1)</code>, my bad: <a href=\"https://support.office.com/en-us/article/SUM-function-043e1c7d-7726-4e80-8f32-07b23e057f89\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 634, "user_id": 7225652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D85eE.jpg?s=128&g=1", "display_name": "Peter Pesch", "link": "https://stackoverflow.com/users/7225652/peter-pesch"}, "edited": false, "score": 0, "creation_date": 1512590008, "post_id": 47682240, "comment_id": 82323972, "body": "Have a look at this: <a href=\"https://superuser.com/questions/955662/switch-calc-or-excel-formulas-to-english-language\" title=\"switch calc or excel formulas to english language\">superuser.com/questions/955662/&hellip;</a>"}, {"owner": {"reputation": 634, "user_id": 7225652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D85eE.jpg?s=128&g=1", "display_name": "Peter Pesch", "link": "https://stackoverflow.com/users/7225652/peter-pesch"}, "edited": false, "score": 0, "creation_date": 1512590149, "post_id": 47682240, "comment_id": 82324037, "body": "I think the easiest workaround is to use one computer in German and one computer in English. And make sure that you are using excel formulas i\\on both systems. After a couple of months, you&#39;ll find that it becomes easier to translate the functions yourself."}, {"owner": {"reputation": 634, "user_id": 7225652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D85eE.jpg?s=128&g=1", "display_name": "Peter Pesch", "link": "https://stackoverflow.com/users/7225652/peter-pesch"}, "edited": false, "score": 0, "creation_date": 1512590300, "post_id": 47682240, "comment_id": 82324120, "body": "And whenever you&#39;ve got a formula problem for which you cannot google an answer in German: Simply send the excel file (minus all sensitive data, of course) to the other computer, solve the problem there (using English formulas), and send the excel file back to the german computer. That&#39;s how I finally managed to learn the dutch excel formulas ..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1512590390, "post_id": 47682240, "comment_id": 82324177, "body": "fwiw, VBA is very en-us-centric and any range.formula must be in en-us regional language. In fact, in order to use a different regional system&#39;s native functions, you assign to the range.formulalocal property instead."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1512590412, "post_id": 47682240, "comment_id": 82324188, "body": "If you use VBA to create your formulas then you would use the english version and on the sheet it would appear as the current locale version.  Edit - @Jeeped beat me to it..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1512590738, "post_id": 47682240, "comment_id": 82324370, "body": "fwiw&#178;, VBA also requires a comma as the list or parameter separator character regardless of whether the system&#39;s regional setting is a comma or a semi-colon."}], "owner": {"reputation": 12289, "user_id": 3764804, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/fZQON.png?s=128&g=1", "display_name": "BullyWiiPlaza", "link": "https://stackoverflow.com/users/3764804/bullywiiplaza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 649, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1512589826, "creation_date": 1512589289, "last_edit_date": 1512589826, "question_id": 47682240, "link": "https://stackoverflow.com/questions/47682240/converting-excel-formula-to-different-locale-language", "title": "Converting Excel formula to different locale/language", "body": "<p>Let's say I have a <code>string</code> representing a formula which is valid in a German <code>Excel</code> (only):</p>\n\n<pre><code>=SUMME(B1; C1)\n</code></pre>\n\n<p>Is there a way I can translate formulas like this one to the current locale of Excel (or any language of choice) assuming the input formula is in a clearly defined language like e.g. German using C# code? The expected output for English would be:</p>\n\n<pre><code>=SUM(B1, C1)\n</code></pre>\n\n<p>As you can see, it mostly comes down to replacing the function names/keywords with their translated counterparts but this probably requires some formula parsing to be perfect.</p>\n\n<p>Note that under the hood Excel stores formulas language independently already. The same Excel sheet can be opened and edited in any language. The catch is, inputting formulas has to be in the current language or it will be invalid (!). There is no such thing as a universal formula which can be pasted into any language Excel and it will work exactly the same. Not even when they're written in English.</p>\n\n<p>I do not need something like an \"Excel formula to C# code converter\" but a means of taking the current formula language, target language and formula as input and produces the valid target language formula.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/13247771/excel-macro-inserting-internationally-valid-formula-during-run-time\">Here</a> is a similar question but using VBA code.</p>\n"}, {"tags": ["vba", "ms-access", "mkdir", "file-copying", "filedialog"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1512590505, "post_id": 47682186, "comment_id": 82324239, "body": "Get rid of that trailing space in <code>Path</code>.  (Theoretically <code>Path</code> shouldn&#39;t even have the trailing backslash either, and then you should use <code>Path &amp; &quot;\\&quot; &amp; Foldername</code> everywhere you currently use just <code>Path &amp; Foldername</code>.)"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1512592514, "post_id": 47682186, "comment_id": 82325338, "body": "I have never seen a double slash in the <i>middle</i> of a Windows file path, only at the <b>beginning</b> of a <a href=\"https://msdn.microsoft.com/en-us/library/gg465305.aspx\" rel=\"nofollow noreferrer\">UNC</a> path."}, {"owner": {"reputation": 45, "user_id": 7420131, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-VRKQCgi4liM/AAAAAAAAAAI/AAAAAAAAESI/IXES2D66lrk/photo.jpg?sz=128", "display_name": "EbayBill", "link": "https://stackoverflow.com/users/7420131/ebaybill"}, "edited": false, "score": 0, "creation_date": 1512596602, "post_id": 47682186, "comment_id": 82327431, "body": "I figured it out.  My row Current Year (Me.CntYr) was Null except for the first record..."}], "owner": {"reputation": 45, "user_id": 7420131, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-VRKQCgi4liM/AAAAAAAAAAI/AAAAAAAAESI/IXES2D66lrk/photo.jpg?sz=128", "display_name": "EbayBill", "link": "https://stackoverflow.com/users/7420131/ebaybill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594638686, "creation_date": 1512589108, "last_edit_date": 1594638686, "question_id": 47682186, "link": "https://stackoverflow.com/questions/47682186/ms-access-mkdir-filecopy-works-on-first-record-only", "title": "Ms Access MkDir FileCopy works on first record only", "body": "<p>Access 2016- Code works perfect on the first Record in the Recordset. I get Run-time 76 error \"path not found\" for any record after the first on this line. </p>\n\n<pre><code>objFSO.CopyFile myfile, Path &amp; Foldername &amp; \"\\\"\n</code></pre>\n\n<p>Not sure if this is the problem - The Path is correct but has \\ \\ on the back end (C:\\xxx\\ \\ ), but <code>'&amp; \"\\\"</code> causes it to write the folder name as a file. </p>\n\n<p>I've changed the Paths, Folders and everything else and got the same results. </p>\n\n<p>Full Code:</p>\n\n<pre><code>Private Sub CreatePath_Click()\nDim objFSO As Object\nDim objFile As Object\nDim openDialog As FileDialog\nDim Foldername As String\nDim Path As String\nDim i As Integer\n\nFoldername = DLookup(\"CustomLabelCombine\", \"[Inventory]\", \"\n[CustomLabelCombine]= Forms![Items to List]!SKU2\")\nPath = \"Z:\\Ebay\\Suppliers Inventory\\\" &amp; Me.CntYr &amp; \"\\ \"\n\nSet openDialog = Application.FileDialog(msoFileDialogFilePicker)\nopenDialog.AllowMultiSelect = True\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n If openDialog.Show = -1 Then\n\nIf Dir(Path, vbDirectory) = vbNullString Then\n   MkDir Path\n   MkDir Path &amp; Foldername\nEnd If\nFor i = 1 To openDialog.SelectedItems.Count\n    myfile = openDialog.SelectedItems.Item(i)\n    objFSO.CopyFile myfile, Path &amp; Foldername &amp; \"\\\"\nNext\nMsgBox \"Files were successfully copied\"\nEnd If\nSet objFSO = Nothing\nSet openDialog = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 2, "last_activity_date": 1512587917, "creation_date": 1512587917, "answer_id": 47681914, "question_id": 47681883, "link": "https://stackoverflow.com/questions/47681883/copy-cells-formula-result-as-value-into-same-cell/47681914#47681914", "title": "Copy Cell&#39;s Formula result as Value into same Cell", "body": "<p>Instead of using copy/paste, just do it like this:</p>\n\n<pre><code>Worksheets(\"sheet1\").Cells(i, 3).Value = Worksheets(\"sheet1\").Cells(i, 3).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1512588570, "last_edit_date": 1512588570, "creation_date": 1512588262, "answer_id": 47681997, "question_id": 47681883, "link": "https://stackoverflow.com/questions/47681883/copy-cells-formula-result-as-value-into-same-cell/47681997#47681997", "title": "Copy Cell&#39;s Formula result as Value into same Cell", "body": "<p>Use a with block to limit the amount of repetitive typing</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nWith Worksheets(\"Sheet1\")\n    a = .Cells(Rows.Count, 3).End(xlUp).Row\n    For i = 4 To a\n        With .Cells(i, 3)\n            If .Value &gt; 0 Then .Value = .Value\n        End With\n    Next\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9063660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f55224895df0ce5687ff12f24bfdcc?s=128&d=identicon&r=PG&f=1", "display_name": "bmorales24", "link": "https://stackoverflow.com/users/9063660/bmorales24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512591848, "creation_date": 1512587786, "last_edit_date": 1512591848, "question_id": 47681883, "link": "https://stackoverflow.com/questions/47681883/copy-cells-formula-result-as-value-into-same-cell", "title": "Copy Cell&#39;s Formula result as Value into same Cell", "body": "<p>I have this code I have written to find values over 0 in a particular column:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    a = Worksheets(\"Sheet1\").Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = 4 To a\n        If Worksheets(\"sheet1\").Cells(i, 3).Value &gt; 0 Then\n            Worksheets(\"sheet1\").Cells(i, 3).Copy\n            Worksheets(\"sheet1\").Cells(1, 3).PasteSpecial xlPasteValues\n        End If\n    Next\n\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>My problem is in the copy and paste value.  I need to just copy the cell and paste value in that same cell.  for example, if the macro reads in cell c5 that the total is greater then 0, then it copies cell c5 and paste value in c5.  </p>\n\n<p>How do I fix the paste value line to paste the value in the same cell it copied?</p>\n"}, {"tags": ["vba", "excel", "function"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1512587244, "post_id": 47681714, "comment_id": 82322470, "body": "Do While x &lt; PartitionCount.... where do use x in your code?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512587696, "post_id": 47681714, "comment_id": 82322721, "body": "What goes wrong and where?"}, {"owner": {"reputation": 7, "user_id": 9021758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ab1966bb25b51c12e3172b6aca58cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/9021758/jessica"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1512587847, "post_id": 47681714, "comment_id": 82322795, "body": "@mooseman I let x = 0 in the beginning of the loop."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512587900, "post_id": 47681714, "comment_id": 82322831, "body": "<code>Application.CountIf(ActiveSheet.Range(&quot;B16:B25&quot;), &quot;*&quot;)</code>"}, {"owner": {"reputation": 7, "user_id": 9021758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ab1966bb25b51c12e3172b6aca58cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/9021758/jessica"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512587959, "post_id": 47681714, "comment_id": 82322861, "body": "@ScottCraner I get a &#39;Type Mismatch&#39; error and it seems to be when I set PartitionCount = Application.CountIf(&quot;B16:B25&quot;, &quot;*&quot;)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512587990, "post_id": 47681714, "comment_id": 82322877, "body": "You also need to put some error control.  If the vlookup does not find a match"}, {"owner": {"reputation": 7, "user_id": 9021758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ab1966bb25b51c12e3172b6aca58cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/9021758/jessica"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512588135, "post_id": 47681714, "comment_id": 82322976, "body": "@ScottCraner I just made the change and the Type Mismatch error went away! I ran it again and now there seems to be an object error during the VLOOKUP line."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1512588172, "post_id": 47681714, "comment_id": 82323007, "body": "Vlookup expects the value being looked up to be in the left-most column of the lookup table."}, {"owner": {"reputation": 7, "user_id": 9021758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ab1966bb25b51c12e3172b6aca58cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/9021758/jessica"}, "edited": false, "score": 0, "creation_date": 1512588249, "post_id": 47681714, "comment_id": 82323055, "body": "I&#39;ve made the user input table to be a dropdown menu which references the same table that the vlookup function references, so someone would not be able to enter a value that was not already there."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512589570, "post_id": 47681714, "comment_id": 82323743, "body": "Just an FYI the following Array formula will work if you have Office365: <code>=TEXTJOIN(&quot;_&quot;,TRUE,IFERROR(INDEX(Info!C2:C20,N(IF({1},MODE.M&zwnj;&#8203;ULT(IF(ISNUMBER(MATC&zwnj;&#8203;H(B16:B25,Info!D2:D2&zwnj;&#8203;0,0)),MATCH(B16:B25,&zwnj;&#8203;Info!D2:D20,0)*{1,1}&zwnj;&#8203;))))) &amp; C16:C25,&quot;&quot;))</code>.  Confirmed with Ctrl-Shift-enter to array enter the formula."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9021758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ab1966bb25b51c12e3172b6aca58cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/9021758/jessica"}, "edited": false, "score": 0, "creation_date": 1512589014, "post_id": 47681959, "comment_id": 82323457, "body": "I&#39;ve made the changes but now I&#39;m getting an &quot;Unable to get the VLookup property of the WorksheetFunction class&quot;  Edit: I added the worksheet name of where the vlookup function was referencing, and it works perfectly now. Thank you!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 7, "user_id": 9021758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ab1966bb25b51c12e3172b6aca58cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/9021758/jessica"}, "edited": false, "score": 0, "creation_date": 1512589113, "post_id": 47681959, "comment_id": 82323501, "body": "@Jessica See Tim&#39;s comment above.  You will need to reorganize the table to put the result to the right of the lookup value or use something else other than VLOOKUP."}, {"owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "edited": false, "score": 0, "creation_date": 1512589445, "post_id": 47681959, "comment_id": 82323672, "body": "Ok I fixed the errors though the code is a bit messy, it works now with data as it."}], "tags": [], "owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1512589417, "last_edit_date": 1512589417, "creation_date": 1512588086, "answer_id": 47681959, "question_id": 47681714, "link": "https://stackoverflow.com/questions/47681714/vlookup-to-condense-data-into-one-cell/47681959#47681959", "title": "VLOOKUP to condense data into one cell", "body": "<p>After modifying your code a bit it now works, its a bit messy but error handling is also present in this code. Your data needs to be in <code>C2</code> &amp; <code>B16</code>. </p>\n\n<pre><code>Sub Abbreviated_Code()\n\n'Counts number of partitions\nDim PartitionCount As Integer\nPartitionCount = Application.WorksheetFunction.CountIf(Range(\"B16:B25\"), \"*\")\n\nRange(\"E16\") = \"\"\n' VLOOKUP loop for as many times there are partition layers\n    Let x = 0\n    Let materialnum = 16 'First material listed at B16\n    Do While x &lt; PartitionCount\n\n    If Not IsError(Application.Match(Range(\"B\" &amp; materialnum).Value, Range(\"D2:D10\"), 0)) Then\n        abbrev = Application.WorksheetFunction.Index(Range(\"C2:C10\"), Application.WorksheetFunction.Match(Range(\"B\" &amp; materialnum).Value, Range(\"D2:D10\"), 0))\n    Else:\n        GoTo skip:\n    End If\n\n    newCode = abbrev &amp; Range(\"C\" &amp; materialnum)\n\n    If Range(\"E16\") = \"\" Then\n        Range(\"E16\") = newCode\n    Else:\n        Range(\"E16\") = Range(\"E16\") &amp; \"_\" &amp; newCode 'Output string of text into cell E16\n    End If\nskip:\n    x = x + 1\n    materialnum = materialnum + 1\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1512589624, "creation_date": 1512589624, "answer_id": 47682332, "question_id": 47681714, "link": "https://stackoverflow.com/questions/47681714/vlookup-to-condense-data-into-one-cell/47682332#47682332", "title": "VLOOKUP to condense data into one cell", "body": "<pre><code>Sub InputToAbbreviation()\n    Dim References As Range, Materials As Range\n    Dim reference, material As Range, code As String\n\n    Set References = Range(\"C2:D20\")\n    Set Materials = Range(\"B16:B\" &amp; Range(\"B16\").End(xlDown).Row)\n\n    For Each material In Materials\n        code = code &amp; Application.VLookup(material, References, 2, False) &amp; material.Offset(0, 1) &amp; \"_\"\n    Next\n\n    Debug.Print Left$(code, Len(code) - 1) //Remove trailing '_'\nEnd Sub\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li>Re-order your code table to description is in the first column, code the second</li>\n<li>Assumes code descriptions in range C2:D20</li>\n<li>Assumes user inputs material and thickness in row 16 (as your code suggests)</li>\n</ul>\n"}], "owner": {"reputation": 7, "user_id": 9021758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ab1966bb25b51c12e3172b6aca58cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/9021758/jessica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 47681959, "answer_count": 2, "score": 0, "last_activity_date": 1512589624, "creation_date": 1512587128, "last_edit_date": 1512587681, "question_id": 47681714, "link": "https://stackoverflow.com/questions/47681714/vlookup-to-condense-data-into-one-cell", "title": "VLOOKUP to condense data into one cell", "body": "<p>I'm trying to create a macro that takes a user's input and shortens it into an abbreviated code. Say a user has inputted the data into the table:<br>\n<img src=\"https://i.stack.imgur.com/tLcoI.png\" alt=\"\"></p>\n\n<p>The macro would run and output the abbreviated code based on this table (in this case, outputting \"BLK190_G16_WFUR12\"):</p>\n\n<p><img src=\"https://i.stack.imgur.com/DXU9k.png\" alt=\"\"></p>\n\n<pre><code>Sub Abbreviated_Code()\n\n'Counts number of partitions\nDim PartitionCount As Integer\nPartitionCount = Application.CountIf(\"B16:B25\", \"*\")\n\n' VLOOKUP loop for as many times there are partition layers\n    Let x = 0\n    Let materialnum = 16 'First material listed at B16\n    Do While x &lt; PartitionCount\n    abbrev = Application.VLookup(Range(\"B\" &amp; materialnum), info.Range(\"C2:D20\"), 1, False)\n    newCode = abbrev &amp; Range(\"C\" &amp; materialnum)\n\n    x = x + 1\n    materialnum = materialnum + 1\n\n    Range(\"E16\") = Range(\"E16\") &amp; newCode &amp; \"_\" 'Output string of text into cell E16\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>If anyone could please help me out, I'd really appreciate it. </p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4521790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/241484380269c81611345be567335c4b?s=128&d=identicon&r=PG&f=1", "display_name": "mrfixit1170", "link": "https://stackoverflow.com/users/4521790/mrfixit1170"}, "edited": false, "score": 0, "creation_date": 1512657360, "post_id": 47682133, "comment_id": 82354502, "body": "Sam, Thank you for your suggestion, however the issue that the dates do change. I am having trouble creating a solution to overcome the changing date fields and switching them to a record entry for example:"}, {"owner": {"reputation": 1, "user_id": 4521790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/241484380269c81611345be567335c4b?s=128&d=identicon&r=PG&f=1", "display_name": "mrfixit1170", "link": "https://stackoverflow.com/users/4521790/mrfixit1170"}, "edited": false, "score": 0, "creation_date": 1512658130, "post_id": 47682133, "comment_id": 82355034, "body": "12345, em3345,1/1/21018,15,2.5, is the record entry I am attempting to achieve. but the &quot;1/1/2018&quot; is a column header."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1512588862, "creation_date": 1512588862, "answer_id": 47682133, "question_id": 47681678, "link": "https://stackoverflow.com/questions/47681678/ms-access-update-query-with-date-columns/47682133#47682133", "title": "MS Access Update Query with Date columns", "body": "<p>If you always have exactly five columns, you can use</p>\n\n<pre><code>INSERT INTO Labor2 ( ChargeNumber, e_ID, dateworked, p_Code, hoursworked ) \nselect * \nfrom tbl_Import\n</code></pre>\n\n<p>and then filter in the next step instead. A bit dirty, but simple.</p>\n"}], "owner": {"reputation": 1, "user_id": 4521790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/241484380269c81611345be567335c4b?s=128&d=identicon&r=PG&f=1", "display_name": "mrfixit1170", "link": "https://stackoverflow.com/users/4521790/mrfixit1170"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512588862, "creation_date": 1512587012, "last_edit_date": 1531164843, "question_id": 47681678, "link": "https://stackoverflow.com/questions/47681678/ms-access-update-query-with-date-columns", "title": "MS Access Update Query with Date columns", "body": "<p>I am using a staging table in ms access to catch an excel report with daily labor information. Its just a bulk upload form and a button with a click event. With every upload the staging table gets deleted and recreated. The first 3 headers are the same for every report. The date fields store hours worked for the day, but since this is a weekly report the fields for the dates change. </p>\n\n<p>ChargeNumber,p_code,e_ID,date1,date2,date3,date4,date5</p>\n\n<p>I've managed to write an update query in ms access to update a labor table from a staging table, but I have to manually change the columns for the dates. I've considered capturing the header information into an array and parsing out the information, but my coding strengths are limited to TSQL and my TSQL skills are still improving....I am sure there is a better way to dynamically handle this....I am just not seeing it. </p>\n\n<p><code>\nINSERT INTO Labor2 ( ChargeNumber, e_ID, dateworked, p_Code, hoursworked )\nSELECT I.ChargeNumber, I.e_ID, \"2017-11-07\" AS dateworked, I.p_code, I.[2017-11-07]\nFROM tbl_Import AS I\nWHERE (((I.[2017-11-07]) Is Not Null));\n</code>\nI am not looking for anyone to answer my question with a solution. I am looking for a path to traverse so I can figure out my own problem. Any help will be greatly appreciated. Hope this makes sense. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512587116, "post_id": 47681665, "comment_id": 82322400, "body": "Are you expecting only one row returned?  as you have it if you expect multiples it is being over written each time as you do not iterate off <code>lastrow</code>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512589870, "post_id": 47681665, "comment_id": 82323901, "body": "are you getting an error?  What is this code supposed to do, and what exactly is happening?  Is there data on the worksheet?  If so, please share a sample of that too.  Also, Welcome! Check out the <a href=\"https://stackoverflow.com/tour\">tour</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "edited": false, "score": 0, "creation_date": 1512592506, "post_id": 47681665, "comment_id": 82325330, "body": "It looks for range R and E, and then copies the values between them. right now the code is just finding the first case and thats it, i need the other 5 with the E variable as &quot;totals for:&quot; at the end of it to be copied also"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "edited": false, "score": 0, "creation_date": 1512592408, "post_id": 47682911, "comment_id": 82325279, "body": "here is the original code.. it looks for the values between R and E and copies them. The above code found the next string but the the values between the new R and E ranges..   Dim s As Range, e As Range With Sheet1 &#39;or this can be any other sheet where you search     Set r = .Range(&quot;B:B&quot;).Find(&quot;LIFEC - Supp Life - Ch&quot;)     If Not r Is Nothing Then         Set e = .Range(&quot;B:B&quot;).Find(&quot;Totals for:&quot;, r)         If Not e Is Nothing Then             .Range(r, e).EntireRow.Copy Sheet2.Range(&quot;A1&quot;) &#39;or to whatever sheet         End If     End If End With   End Sub"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "edited": false, "score": 0, "creation_date": 1512593610, "post_id": 47682911, "comment_id": 82325933, "body": "@ChristopherPieper Updated my answer to reflect your comments."}, {"owner": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "edited": false, "score": 0, "creation_date": 1512665641, "post_id": 47682911, "comment_id": 82359871, "body": "it is more like this sir  LIFES - Sup Life - Sps  123 123 321 Totals for:  Something else - d 123 123 123 Totals For:  VSTD  - Vol STD MOO 123  123 Totals for:  And I am trying to copy the data between the two ranges to a new sheet"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "edited": false, "score": 0, "creation_date": 1512665879, "post_id": 47682911, "comment_id": 82360016, "body": "What is the 123 123 321? is that in the same cell as the &quot;Totals for:&quot;? If this is the case then I&#39;ve updated my answer to find &quot;Totals For: LIFES - Sup Life - Sps&quot; and any other value after that..."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "edited": false, "score": 0, "creation_date": 1512666161, "post_id": 47682911, "comment_id": 82360204, "body": "I&#39;m pretty sure, actually I&#39;ve tested it too, this should work, unless there are other things at play, such as the contents of the cells might not match your search criteria, but apart from a little tweaking, this should do what you wanted, please could you mark my response as an answer?"}, {"owner": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "edited": false, "score": 0, "creation_date": 1512692125, "post_id": 47682911, "comment_id": 82371876, "body": "it doesn&#39;t, but I appreciate your time, I ended up running it as different functions. This code works fine for one, i just needed it for the other 5 cases.  Dim s As Range, e As Range lastrow = Worksheets(&quot;MOO_filtered&quot;).Range(&quot;B&quot; &amp; Rows.Count).End(xlUp).Row With Worksheets(&quot;MOO Data&quot;)     Set r = .Range(&quot;B:B&quot;).Find(&quot;VSTD  - Vol STD MOO&quot;)     If Not r Is Nothing Then         Set e = .Range(&quot;B:E&quot;).Find(&quot;Totals for:&quot;, r)         If Not e Is Nothing Then             .Range(r, e).EntireRow.Copy Worksheets(&quot;MOO_filtered&quot;).Range(&quot;A&quot; &amp; lastrow)         End If     End If End With .."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1512665939, "last_edit_date": 1512665939, "creation_date": 1512591978, "answer_id": 47682911, "question_id": 47681665, "link": "https://stackoverflow.com/questions/47681665/using-array-to-pass-through-a-find-loop/47682911#47682911", "title": "Using array to pass through a find loop", "body": "<p>I've tested the code below and I believe it does what you want it to do:</p>\n\n<pre><code>Sub findEG()\nDim rng, s As Range\nDim rws As Long, w As Long\nDim vWHATs As Variant\nlastrow = Worksheets(\"MOO_filtered\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\nvWHATs = Array(\"LIFES - Sup Life - Sps\", \"LIFEE - Sup Life - Emp\", \"LIFEC - Supp Life - Ch\", _\n               \"VLTD  - Vol LTD MOO\", \"VSTD  - Vol STD MOO\")\n\nWith Worksheets(\"MOO Data\")\nFor w = LBound(vWHATs) To UBound(vWHATs)\nSet r = .Range(\"B:B\").Find(vWHATs(w)) 'included the (w) so the array values go in sequence in the For Loop\n      If Not r Is Nothing Then\n        Set e = .Range(\"B:B\").Find(\"Totals for:\" &amp; r.Value &amp; \"*\") ' here are you sure you are looking for the possible string: \"Totals for:LIFES - Sup Life - Sps\" without the space between the :?\n        If Not e Is Nothing Then\n            .Rows(r.Row &amp; \":\" &amp; e.Row).EntireRow.Copy Worksheets(\"MOO_filtered\").Range(\"A\" &amp; lastrow +1)\n        End If\n\n      End If\nNext w\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 47682911, "answer_count": 1, "score": -1, "last_activity_date": 1512665939, "creation_date": 1512586971, "last_edit_date": 1531161705, "question_id": 47681665, "link": "https://stackoverflow.com/questions/47681665/using-array-to-pass-through-a-find-loop", "title": "Using array to pass through a find loop", "body": "<p>here is my code, its almost working but only passes the first part of the array. I think its the second end if, but if i remove it. It says no next without for even though for for part is at the beginning of the loop. Can someone tell me what I did wrong please.</p>\n\n<pre><code>Sub findEG()\nDim rng, s, e As Range\nDim rws As Long, w As Long\nDim vWHATs As Variant\n\nlastrow = Worksheets(\"MOO_filtered\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\nvWHATs = Array(\"LIFES - Sup Life - Sps\", \"LIFEE - Sup Life - Emp\", \"LIFEC - Supp Life - Ch\", _\n               \"VLTD  - Vol LTD MOO\", \"VSTD  - Vol STD MOO\")\n\nWith Worksheets(\"MOO Data\")   \nFor w = LBound(vWHATs) To UBound(vWHATs)\nSet r = .Range(\"B:B\").Find(vWHATs)\n\n      If Not r Is Nothing Then\n        Set e = .Range(\"B:B\").Find(\"Totals for:\", r)\n        If Not e Is Nothing Then\n            .Range(r, e).EntireRow.Copy Worksheets(\"MOO_filtered\").Range(\"A\" &amp; lastrow) \n        End If\n\n      End If\nNext w\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1512586745, "creation_date": 1512586745, "answer_id": 47681604, "question_id": 47681457, "link": "https://stackoverflow.com/questions/47681457/access-query-invalid-operation-when-using-order-by-clause/47681604#47681604", "title": "Access Query - Invalid Operation when using Order By clause", "body": "<p>You haven't given an alias name to your outermost query block, and you are trying to order by dbo_Jobs.JobId instead of alias_name.JobId</p>\n\n<p>(Either that, or your bracket between the group by and order by clauses is not needed - I lost count of the brackets!)</p>\n"}, {"tags": [], "owner": {"reputation": 4945, "user_id": 1169697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8076bb688cf139206f4a4e121dc1b08c?s=128&d=identicon&r=PG", "display_name": "digital.aaron", "link": "https://stackoverflow.com/users/1169697/digital-aaron"}, "is_accepted": false, "score": 0, "last_activity_date": 1512594138, "last_edit_date": 1512594138, "creation_date": 1512593829, "answer_id": 47683334, "question_id": 47681457, "link": "https://stackoverflow.com/questions/47681457/access-query-invalid-operation-when-using-order-by-clause/47683334#47683334", "title": "Access Query - Invalid Operation when using Order By clause", "body": "<p>Holy extraneous parenthesis, Batman! This should work. Looks like you needed the outer table alias of <code>AllJobs</code> applied to the columns of the outer select statement. I also cleaned up all the unnecessary parenthesis. </p>\n\n<pre><code>SELECT\n    AllJobs.jobid\n    ,AllJobs.jobrefno\n    ,AllJobs.createdon\n    ,AllJobs.archived\n    ,AllJobs.published\n    ,AllJobs.jobtitle\n    ,AllJobs.statusid\n    ,AllJobs.clientid\n    ,AllJobs.company\n    ,AllJobs.clientcontactid\n    ,AllJobs.employmenttypeid\n    ,AllJobs.description\n    ,AllJobs.description\n    ,AllJobs.clientname\n    ,AllJobs.natureofcase\n    ,AllJobs.timescaletodeadline\n    ,AllJobs.notes\n    ,AllJobs.status\n    ,AllJobs.contactpersonid\n    ,AllJobs.vat\n    ,AllJobs.postcode\n    ,AllJobs.additionalinfo\n    ,AllJobs.solicitorref\n    ,AllJobs.userid\n    ,AllJobs.loginname\n    ,AllJobs.positionattributeid\n    ,AllJobs.consultancyservice\n    ,AllJobs.ClientCon\n    ,AllJobs.personname\n    ,AllJobs.surname\n    ,AllJobs.description\n    ,AllJobs.priority\n    ,RevListCount.CountOfRevIDs\n    ,CVCount.CVSentCount\nFROM(\n        SELECT\n            dbo_jobs.jobid\n            ,dbo_jobs.jobrefno\n            ,dbo_jobs.createdon\n            ,dbo_jobs.archived\n            ,dbo_jobs.published\n            ,dbo_jobs.jobtitle\n            ,dbo_jobs.statusid\n            ,dbo_jobs.clientid\n            ,dbo_clients.company\n            ,dbo_clientcontacts.clientcontactid\n            ,dbo_employmenttypes.employmenttypeid\n            ,dbo_employmenttypes.description\n            ,dbo_locations.description\n            ,dbo_jobsectordefinedcolumns.clientname\n            ,dbo_jobsectordefinedcolumns.natureofcase\n            ,dbo_jobsectordefinedcolumns.timescaletodeadline\n            ,dbo_jobs.notes\n            ,dbo_jobsectordefinedcolumns.status\n            ,dbo_clientcontacts.contactpersonid\n            ,dbo_jobsectordefinedcolumns.vat\n            ,dbo_jobsectordefinedcolumns.postcode\n            ,dbo_jobsectordefinedcolumns.additionalinfo\n            ,dbo_jobsectordefinedcolumns.solicitorref\n            ,dbo_jobconsultants.userid\n            ,dbo_users.loginname\n            ,dbo_jobs.positionattributeid\n            ,dbo_jobsectordefinedcolumns.consultancyservice\n            ,[dbo_person].[personname] &amp; ' ' &amp; [dbo_person].[surname] AS ClientCon\n            ,dbo_person.personname\n            ,dbo_person.surname\n            ,dbo_jobstatus.description\n            ,dbo_jobsectordefinedcolumns.priority\n        FROM dbo_employmenttypes\n        INNER JOIN dbo_jobs ON dbo_employmenttypes.employmenttypeid = dbo_jobs.employmenttypeid\n        INNER JOIN dbo_clients ON dbo_jobs.clientid = dbo_clients.clientid\n        INNER JOIN dbo_clientcontacts ON dbo_jobs.clientcontactid = dbo_clientcontacts.clientcontactid\n        LEFT JOIN dbo_jobsectordefinedcolumns ON dbo_jobs.jobid = dbo_jobsectordefinedcolumns.jobid\n        INNER JOIN dbo_person ON dbo_clientcontacts.contactpersonid = dbo_person.personid\n        LEFT JOIN dbo_jobconsultants ON dbo_jobs.jobid = dbo_jobconsultants.jobid\n        LEFT JOIN dbo_users ON dbo_jobconsultants.userid = dbo_users.userid\n        LEFT JOIN dbo_jobstatus ON dbo_jobs.statusid = dbo_jobstatus.jobstatusid\n        LEFT JOIN dbo_locations ON dbo_jobs.locationid = dbo_locations.locationid\n        WHERE dbo_jobs.archived = 'N'\n            AND dbo_employmenttypes.employmenttypeid &lt;&gt; 12\n            AND dbo_jobconsultants.userrelationshipid = 9\n            AND (\n                    dbo_jobstatus.description &lt;&gt; 'Filled'\n                    AND dbo_jobstatus.description &lt;&gt; 'Filled - Ongoing'\n                )\n    )      AS AllJobs\nLEFT JOIN(\n             SELECT\n                 dbo_reviewlists.jobid\n                 ,COUNT(dbo_reviewlistapplicants.reviewlistid) AS CountOfRevIDs\n             FROM dbo_reviewlists\n             LEFT JOIN dbo_reviewlistapplicants ON dbo_reviewlists.reviewlistid = dbo_reviewlistapplicants.reviewlistid\n             GROUP BY dbo_reviewlists.jobid\n         ) AS RevListCount ON AllJobs.jobid = RevListCount.jobid\nLEFT JOIN(\n             SELECT\n                 dbo_applicantactions.jobid\n                 ,COUNT(dbo_applicantactions.statusid) AS CVSentCount\n             FROM dbo_applicantactions\n             WHERE dbo_applicantactions.statusid = 29\n             GROUP BY dbo_applicantactions.jobid\n         ) AS CVCount ON AllJobs.jobid = CVCount.jobid\nORDER BY AllJobs.jobid DESC;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3549623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d908a3681ec880963acc2337e1b2973f?s=128&d=identicon&r=PG&f=1", "display_name": "user3549623", "link": "https://stackoverflow.com/users/3549623/user3549623"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512594138, "creation_date": 1512586154, "last_edit_date": 1512592955, "question_id": 47681457, "link": "https://stackoverflow.com/questions/47681457/access-query-invalid-operation-when-using-order-by-clause", "title": "Access Query - Invalid Operation when using Order By clause", "body": "<p>The following query works fine but as soon as I add the <code>Order By</code> clause, I get an </p>\n\n<blockquote>\n  <p>error - \"invalid operation\"</p>\n</blockquote>\n\n<p>Can any one help me please?</p>\n\n<pre><code>SELECT dbo_jobs.jobid,\n       dbo_jobs.jobrefno,\n       dbo_jobs.createdon,\n       dbo_jobs.archived,\n       dbo_jobs.published,\n       dbo_jobs.jobtitle,\n       dbo_jobs.statusid,\n       dbo_jobs.clientid,\n       dbo_clients.company,\n       dbo_clientcontacts.clientcontactid,\n       dbo_employmenttypes.employmenttypeid,\n       dbo_employmenttypes.description,\n       dbo_locations.description,\n       dbo_jobsectordefinedcolumns.clientname,\n       dbo_jobsectordefinedcolumns.natureofcase,\n       dbo_jobsectordefinedcolumns.timescaletodeadline,\n       dbo_jobs.notes,\n       dbo_jobsectordefinedcolumns.status,\n       dbo_clientcontacts.contactpersonid,\n       dbo_jobsectordefinedcolumns.vat,\n       dbo_jobsectordefinedcolumns.postcode,\n       dbo_jobsectordefinedcolumns.additionalinfo,\n       dbo_jobsectordefinedcolumns.solicitorref,\n       dbo_jobconsultants.userid,\n       dbo_users.loginname,\n       dbo_jobs.positionattributeid,\n       dbo_jobsectordefinedcolumns.consultancyservice,\n       [dbo_person].[PersonName] &amp; ' ' &amp; [dbo_person].[Surname] AS ClientCon,\n       dbo_person.personname,\n       dbo_person.surname,\n       dbo_jobstatus.description,\n       dbo_jobsectordefinedcolumns.priority,\n       RevListCount.countofrevids,\n       CVCount.cvsentcount\nFROM   (((SELECT dbo_jobs.jobid,\n                dbo_jobs.jobrefno,\n                dbo_jobs.createdon,\n                dbo_jobs.archived,\n                dbo_jobs.published,\n                dbo_jobs.jobtitle,\n                dbo_jobs.statusid,\n                dbo_jobs.clientid,\n                dbo_clients.company,\n                dbo_clientcontacts.clientcontactid,\n                dbo_employmenttypes.employmenttypeid,\n                dbo_employmenttypes.description,\n                dbo_locations.description,\n                dbo_jobsectordefinedcolumns.clientname,\n                dbo_jobsectordefinedcolumns.natureofcase,\n                dbo_jobsectordefinedcolumns.timescaletodeadline,\n                dbo_jobs.notes,\n                dbo_jobsectordefinedcolumns.status,\n                dbo_clientcontacts.contactpersonid,\n                dbo_jobsectordefinedcolumns.vat,\n                dbo_jobsectordefinedcolumns.postcode,\n                dbo_jobsectordefinedcolumns.additionalinfo,\n                dbo_jobsectordefinedcolumns.solicitorref,\n                dbo_jobconsultants.userid,\n                dbo_users.loginname,\n                dbo_jobs.positionattributeid,\n                dbo_jobsectordefinedcolumns.consultancyservice,\n                [dbo_person].[personname] &amp; ' ' &amp; [dbo_person].[surname] AS\n                 ClientCon,\n                dbo_person.personname,\n                dbo_person.surname,\n                dbo_jobstatus.description,\n                dbo_jobsectordefinedcolumns.priority\n         FROM   ((((((((dbo_employmenttypes\n                        INNER JOIN dbo_jobs\n                                ON dbo_employmenttypes.employmenttypeid =\n                                  dbo_jobs.employmenttypeid)\n                       INNER JOIN dbo_clients\n                               ON dbo_jobs.clientid = dbo_clients.clientid)\n                      INNER JOIN dbo_clientcontacts\n                              ON dbo_jobs.clientcontactid =\n                                 dbo_clientcontacts.clientcontactid)\n                     LEFT JOIN dbo_jobsectordefinedcolumns\n                            ON dbo_jobs.jobid =\ndbo_jobsectordefinedcolumns.jobid)\n                    INNER JOIN dbo_person\n                            ON dbo_clientcontacts.contactpersonid =\n                   dbo_person.personid)\n                   LEFT JOIN dbo_jobconsultants\n                          ON dbo_jobs.jobid = dbo_jobconsultants.jobid)\n                  LEFT JOIN dbo_users\n                         ON dbo_jobconsultants.userid = dbo_users.userid)\n                 LEFT JOIN dbo_jobstatus\n                        ON dbo_jobs.statusid = dbo_jobstatus.jobstatusid)\n                LEFT JOIN dbo_locations\n                       ON dbo_jobs.locationid = dbo_locations.locationid\n         WHERE  ( ( ( dbo_jobs.archived ) = 'N' )\n                  AND ( ( dbo_employmenttypes.employmenttypeid ) &lt;&gt; 12 )\n                  AND ( ( dbo_jobconsultants.userrelationshipid ) = 9 )\n                  AND\n         ( ( dbo_jobstatus.description ) &lt;&gt; 'Filled'\n           AND ( dbo_jobstatus.description ) &lt;&gt; 'Filled - Ongoing' ) )) AS\n        AllJobs\n         LEFT JOIN (SELECT dbo_reviewlists.jobid,\n                           Count(dbo_reviewlistapplicants.reviewlistid) AS\n                           CountOfRevIDs\n                    FROM   dbo_reviewlists\n                           LEFT JOIN dbo_reviewlistapplicants\n                                  ON dbo_reviewlists.reviewlistid =\n                                     dbo_reviewlistapplicants.reviewlistid\n                    GROUP  BY dbo_reviewlists.jobid) AS RevListCount\n                ON AllJobs.jobid = RevListCount.jobid)\n        LEFT JOIN (SELECT dbo_applicantactions.jobid,\n                          Count(dbo_applicantactions.statusid) AS CVSentCount\n                   FROM   dbo_applicantactions\n                   WHERE  (( ( dbo_applicantactions.statusid ) = 29 ))\n                   GROUP  BY dbo_applicantactions.jobid) AS CVCount\n               ON AllJobs.jobid = CVCount.jobid)\nORDER  BY dbo_jobs.jobid DESC  \n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "edited": false, "score": 0, "creation_date": 1512671968, "post_id": 47681509, "comment_id": 82363219, "body": "Hello mooseman, i&#39;ve tried your code and it&#39;ve worked perfecty. I&#39;m so sorry for not posting my code, that&#39;s why i&#39;m a little bit new at VBA and i don&#39;t know how to do that procedure. Thanks for your quick answer! It&#39;s very appreciated."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 0, "last_activity_date": 1512586770, "last_edit_date": 1512586770, "creation_date": 1512586371, "answer_id": 47681509, "question_id": 47681421, "link": "https://stackoverflow.com/questions/47681421/copy-cells-and-paste-them-in-all-those-that-are-empty/47681509#47681509", "title": "Copy cells and paste them in all those that are empty", "body": "<p>While you should be posting code you need help with, I already have this code written.  Just select your range and then run this macro.</p>\n\n<pre><code> Sub Fill_from_above()\n\n For Each c In Selection.Cells  \n     If c.Value = \"\" Then\n         c.Value = c.Offset(-1, 0).Value  \n     End If \n Next c\n End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1512587212, "creation_date": 1512587212, "answer_id": 47681734, "question_id": 47681421, "link": "https://stackoverflow.com/questions/47681421/copy-cells-and-paste-them-in-all-those-that-are-empty/47681734#47681734", "title": "Copy cells and paste them in all those that are empty", "body": "<p>use a basic formula on the blank cells. convert the formula results to values if you wish.</p>\n\n<pre><code>with worksheets(\"sheet1\")\n    with intersect(.columns(\"a:b\"), .usedrange)\n        .specialcells(xlcelltypeblanks).formular1c1 = \"=r[-1]c\"\n        .value = .value2\n    end with\nend with\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "closed_date": 1512591599, "accepted_answer_id": 47681509, "answer_count": 2, "score": -5, "last_activity_date": 1512587212, "creation_date": 1512586008, "question_id": 47681421, "link": "https://stackoverflow.com/questions/47681421/copy-cells-and-paste-them-in-all-those-that-are-empty", "closed_reason": "Needs more focus", "title": "Copy cells and paste them in all those that are empty", "body": "<p>I need a macro that, (at it says in the title) copy the <strong>two last cells</strong>, in this case <strong>A419</strong> and <strong>B419</strong>, and paste their value until it find others that contain information.</p>\n\n<p>In example:</p>\n\n<p>As you can see in the image, there's the Value <strong>1004-004</strong> and <strong>36300025</strong> and a lot of empty cells below. And more below theres <strong>1004-005</strong> and <strong>36300026</strong> Something like from 420 to 434. And then select 1004-005 and 36300026 and repeat the process.</p>\n\n<p>This:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cu47a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cu47a.png\" alt=\"This\"></a></p>\n\n<p>To this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oXRDc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oXRDc.png\" alt=\"to this\"></a></p>\n\n<p>Well, that's all, i don't really know how to do it, so i'll be very grateful if you can help me out guys.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1512584806, "post_id": 47680919, "comment_id": 82321279, "body": "Assume people are too busy to fully read all of this. You should also say what &quot;doesn&#39;t work&quot;. i.e., what do you want to do, what have you tried, and what results did you get."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9062963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79c7d1485d6438f7d55250181518747f?s=128&d=identicon&r=PG&f=1", "display_name": "Quadra", "link": "https://stackoverflow.com/users/9062963/quadra"}, "edited": false, "score": 0, "creation_date": 1513331620, "post_id": 47681071, "comment_id": 82622016, "body": "Hi Scott, many thanks for your help. this is exactly what I was looking for, a way to work with relative notation but using some variables as well. You made my life easier today.. many many many thanks!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1512584731, "creation_date": 1512584731, "answer_id": 47681071, "question_id": 47680919, "link": "https://stackoverflow.com/questions/47680919/excel-vba-cell-referencing/47681071#47681071", "title": "Excel VBA: cell referencing", "body": "<p>Use:</p>\n\n<pre><code>With ActiveSheet\n    .Range(.Cells(5,5),.Cells(10005,5)).FormulaR1C1 = \"=R[\" &amp; RowL &amp; \"]C[\" &amp; col &amp; \"]\"\nEnd With \n</code></pre>\n\n<p>no need for autofill</p>\n\n<p>So</p>\n\n<pre><code>Sub problemsolved ()\n\nDim lastrow as Long\nDim RowL as Long\nDim CoL as Long\n\nlastrow = activesheet.cells(rows.count, 1).End(xlUp).row\n\n\n\nRowl = lastrow - 5\nCol = 3 -5\n\n\nWith ActiveSheet\n    .Range(.Cells(5,5),.Cells(10005,5)).FormulaR1C1 = \"=R[\" &amp; RowL &amp; \"]C[\" &amp; col &amp; \"]\"\nEnd With \n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9062963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79c7d1485d6438f7d55250181518747f?s=128&d=identicon&r=PG&f=1", "display_name": "Quadra", "link": "https://stackoverflow.com/users/9062963/quadra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512584731, "creation_date": 1512584154, "last_edit_date": 1531164843, "question_id": 47680919, "link": "https://stackoverflow.com/questions/47680919/excel-vba-cell-referencing", "title": "Excel VBA: cell referencing", "body": "<p>I have a problem with cell referencing and I don't know if a solution exists.</p>\n\n<p>Using VBA code I'm writing into a cell the reference to a different cell using the syntax:</p>\n\n<pre><code>activecell.formula = \"=\" &amp; Cells(A1).address\n</code></pre>\n\n<p>Now I need to copy this formula for thousands of cells. Each cell should refer to a sequential <code>cell (A1,A2,A3....A120..)</code>.</p>\n\n<p>The problem I have is that using</p>\n\n<p><code>Cells(A1).address</code> </p>\n\n<p>it fixes the <code>Cells(A1)</code>. When I use the autofill function, I have thousands of cells all referencing the same <code>cells(A1)</code>, while I would need the reference to be dynamic and every time referencing the next <code>cell (A2,A3,A4..)</code>. And I need to use the autofill function because if I write the formula on each cell using a <code>loop</code> and fixed reference, it would take hours for the code to run (there are thousands of cells as explained before)</p>\n\n<p>I should then use the relative reference format:</p>\n\n<pre><code>activecell.formulaR1C1 = ...\n</code></pre>\n\n<p>but the cells(A1)  are not always at the same distance from my activecell.</p>\n\n<p>via VBA I can calculate how far each time it is from my <code>activecell</code>, but how can I use this data with <code>R1C1</code> notation?</p>\n\n<p>so, lets say that using</p>\n\n<pre><code>row.count\n</code></pre>\n\n<p>function I can calculate the first cell to which I want to refer to,(this time) is on row 100 and column 3. So, I have: lastrow = 100, column = 3. Please note, the row 100 vary every time I run the macro. My <code>activecell</code> is <code>cells(5,5)</code></p>\n\n<p>this is what I would like to use:</p>\n\n<pre><code>Sub problemsolved ()\n\nDim lastrow as string\nDim RowL as string\nDim CoL as string\n\nlastrow = activesheet.cells(rows.count, 1).End(xlUp).row\n\n\ncells(5,5).select\n\nRol = lastrow - 5\nCol = 3 -5\n\n\nactivecell.formulaR1C1 = \"=R[Rol]C[Col]\"\n\nselection.autofill Destination:=Range(cells(5, 5), cells(10005, 5))\n\nend sub\n</code></pre>\n\n<p>assuming lastrow is = 100\nI need to have the following result:</p>\n\n<pre><code>cell(5,5): =cells(100,3)\ncell(6,5): =cells(101,3)\ncell(7,5): = cells(102,3)\n.....\ncell(10005,5): = cells(10100,3)\n</code></pre>\n\n<p>of course, I've tried the syntax:</p>\n\n<pre><code>activecell.formulaR1C1 = \"=R[lastrow]C[3]\"\n</code></pre>\n\n<p>but it doesn't work, so how can I do it?\nanybody has an idea?</p>\n\n<p>thanks</p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1512583181, "post_id": 47680602, "comment_id": 82320466, "body": "Instead of a screenshot of the code, can you copy/paste it (and format as code with the <code>{}</code> tags)?  Thanks!"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1512583387, "post_id": 47680602, "comment_id": 82320574, "body": "You probably do not have the right tags either...VB.NET doesnt do macros.  Hover over the tags for guidance"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1512584785, "post_id": 47680602, "comment_id": 82321270, "body": "Fully qualify your references and don&#39;t rely on Selection to be where you think it is."}], "owner": {"reputation": 11, "user_id": 8133765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e6967f405f321453fe401ea8228cc51?s=128&d=identicon&r=PG&f=1", "display_name": "CPIERCE", "link": "https://stackoverflow.com/users/8133765/cpierce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "closed_date": 1512591907, "answer_count": 0, "score": 1, "last_activity_date": 1512585421, "creation_date": 1512582947, "last_edit_date": 1512585421, "question_id": 47680602, "link": "https://stackoverflow.com/questions/47680602/excel-macro-vb-run-time-error-automation-error", "closed_reason": "Duplicate", "title": "Excel Macro VB Run-time error: Automation Error", "body": "<p>I have a user who is trying to run this macro in Excel 2016.  It works sometimes, but other times it gives a debug error and locks her spreadsheet up.  I took a look at some of the other folks who had this issue, and a non-excel expert, I think I just don't quite get how VB coding works.  Any help would be appreciated.</p>\n\n<p>Getting a VB </p>\n\n<blockquote>\n  <p>Run-time error '-2147417848 (80010108)':Automation error</p>\n  \n  <h2>> The object invoked has disconnected from its clients.</h2>\n</blockquote>\n\n<p>When you debug, this is what you get:</p>\n\n<p><img src=\"https://i.stack.imgur.com/DVJlh.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512582808, "post_id": 47680505, "comment_id": 82320272, "body": "<code>labelled the cells</code> does this mean you made them named ranges?  and if so are their scope worksheet or workbook?"}, {"owner": {"reputation": 57, "user_id": 8958702, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fdea540cc968d87f407c3e059637035b?s=128&d=identicon&r=PG&f=1", "display_name": "user8958702", "link": "https://stackoverflow.com/users/8958702/user8958702"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512587165, "post_id": 47680505, "comment_id": 82322425, "body": "I went to the cell&#39;s location i.e. B2 and changed the title of it to &quot;Year&quot; so that when you click on B2, it displays &quot;2017&quot; and title is &quot;Year&quot; instead of B2."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512587262, "post_id": 47680505, "comment_id": 82322477, "body": "The nomenclature is <code>Named</code> not <code>Titled</code>."}, {"owner": {"reputation": 57, "user_id": 8958702, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fdea540cc968d87f407c3e059637035b?s=128&d=identicon&r=PG&f=1", "display_name": "user8958702", "link": "https://stackoverflow.com/users/8958702/user8958702"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512587482, "post_id": 47680505, "comment_id": 82322592, "body": "Thanks. I appreciate the help. I&#39;m new to most of this. Any tips to improve the case above?"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 57, "user_id": 8958702, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fdea540cc968d87f407c3e059637035b?s=128&d=identicon&r=PG&f=1", "display_name": "user8958702", "link": "https://stackoverflow.com/users/8958702/user8958702"}, "edited": false, "score": 0, "creation_date": 1512591573, "post_id": 47681804, "comment_id": 82324810, "body": "@user8958702 please mark as correct by clicking the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1512587492, "creation_date": 1512587492, "answer_id": 47681804, "question_id": 47680505, "link": "https://stackoverflow.com/questions/47680505/enable-user-to-fill-in-data/47681804#47681804", "title": "Enable user to fill in data", "body": "<p>Use <code>Range</code> not <code>Cells()</code></p>\n\n<p>And all vba variables need to be outside the quotes and concatenated with <code>&amp;</code></p>\n\n<pre><code>Dim wkb As Workbook\nDim wks As Worksheet\nDim Y As String\nDim Z As String\nY = ThisWorkbook.Sheets(\"Parameters\").Range(\"Year\")\nZ = ThisWorkbook.Sheets(\"Parameters\").Range(\"Month\")\nSet wkb = Workbooks.Open(\"W:\\01-Forecasts\\\" &amp; Y &amp; \" \\Monthly Forecast\\\" &amp; Z &amp; \"\\File.xlsm\")\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 8958702, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fdea540cc968d87f407c3e059637035b?s=128&d=identicon&r=PG&f=1", "display_name": "user8958702", "link": "https://stackoverflow.com/users/8958702/user8958702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 47681804, "answer_count": 1, "score": 0, "last_activity_date": 1512587492, "creation_date": 1512582626, "last_edit_date": 1531164843, "question_id": 47680505, "link": "https://stackoverflow.com/questions/47680505/enable-user-to-fill-in-data", "title": "Enable user to fill in data", "body": "<p>I would like to enable user to pick up a file from a given year/ month etc. and bring data into the file I'm working on.</p>\n\n<p>For this, I've created a \"Parameters\" sheet where I've labelled the cells \"Year\" and \"Month\". When I put these variables in the code, it triggers error.\nI believe I'm declaring Y and Z incorrectly, and also concatenating it poorly into the last line. I tested the code without Y/Z variables and actual file location and it works.</p>\n\n<pre><code>Dim wkb As Workbook\nDim wks As Worksheet\nDim Y As String\nDim Z As String\nY = ThisWorkbook.Sheets(\"Parameters\").Cells(\"Year\")\nZ = ThisWorkbook.Sheets(\"Parameters\").Cells(\"Month\")\nSet wkb = Workbooks.Open(\"W:\\01-Forecasts\\&amp;Y&amp;\\Monthly Forecast\\&amp;Z&amp;\\File.xlsm\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9055841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99697744de6a43a89274eac611c71663?s=128&d=identicon&r=PG&f=1", "display_name": "sagar bhandari", "link": "https://stackoverflow.com/users/9055841/sagar-bhandari"}, "edited": false, "score": 0, "creation_date": 1512627509, "post_id": 47683246, "comment_id": 82336663, "body": "Thanks a bunch, worked like a charm. Double thumbs up!"}], "tags": [], "owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1512601000, "last_edit_date": 1512601000, "creation_date": 1512593487, "answer_id": 47683246, "question_id": 47680332, "link": "https://stackoverflow.com/questions/47680332/replace-a-cell-value-if-criteria-is-fulfilled/47683246#47683246", "title": "Replace a cell value if criteria is fulfilled", "body": "<p>You use </p>\n\n<pre><code>For m = 5 To 29\n   ...\n   m = m + 6 'here you increase counter by 6 \nNext 'here you increase counter by 1 \n</code></pre>\n\n<p>So before your last expected loop the counter (m) is already = 32 so its > then 29 so the loop ends. Thats why last days are excluded.  <BR> \nYou must change your loop a little. <BR> \nIf row with day name is always 30 you could use something like this <BR> </p>\n\n<pre><code>Private Sub cmd_Submit_Click()\n   'select worksheet\n   Dim iRow As Long\n   Dim ws As Worksheet \n   Set ws = Worksheets(\"RawData\") \n   Dim i As Integer \n   Dim m As Integer \n   Dim n As Integer\n\n   Dim Mon As Boolean, Tue As Boolean, Wed As Boolean, Thu As Boolean\n   DIM Fri As Boolean, Sat As Boolean, Sun As Boolean\n   DIM aCell as Range\n\n   'find first empty row in database \n   iRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, \n   SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\n   Application.ScreenUpdating = False\n   Application.Calculation = xlCalculationManual\n\n   'copy the data to the database\n\n   For i = 5 To 36 \n      ws.Cells(iRow, 1).Value = Me.txt_EN.Value \n      ws.Cells(iRow, i).Value = Me.cmb_S.Value \n      ws.Cells(iRow, 37).Value = Me.cmb_M.Value \n   Next i\n\n   If Me.cmb_mon.Value = \"WO\" Then Mon = True\n   If Me.cmb_Tue.Value = \"WO\" Then Tue = True\n   If Me.cmb_Wed.Value = \"WO\" Then Wed = True\n   If Me.cmb_thu.Value = \"WO\" Then Thu = True\n   If Me.cmb_Fri.Value = \"WO\" Then Fri = True\n   If Me.cmb_Sat.Value = \"WO\" Then Sat = True\n   If Me.cmb_Sun.Value = \"WO\" Then Sun = True\n\n   For Each aCell In ws.Range(\"E30:AI30\")\n      If aCell = \"Mon\" And Mon Then ws.Cells(iRow, aCell.Column).Value = \"WO\"\n      If aCell = \"Tue\" And Tue Then ws.Cells(iRow, aCell.Column).Value = \"WO\"\n      If aCell = \"Wed\" And Wed Then ws.Cells(iRow, aCell.Column).Value = \"WO\"\n      If aCell = \"Thu\" And Thu Then ws.Cells(iRow, aCell.Column).Value = \"WO\"\n      If aCell = \"Fri\" And Fri Then ws.Cells(iRow, aCell.Column).Value = \"WO\"\n      If aCell = \"Sat\" And Sat Then ws.Cells(iRow, aCell.Column).Value = \"WO\"\n      If aCell = \"Sun\" And Sun Then ws.Cells(iRow, aCell.Column).Value = \"WO\"\n   Next\n\n   MsgBox \"Data added\", vbOKOnly + vbInformation, \"Data Added\"\n   Unload Me\n   UserForm1.Show\n\n   application.screenupdating = true \n   application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p><BR> \nDidn't tested it so it might need some adjustments</p>\n"}], "owner": {"reputation": 21, "user_id": 9055841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99697744de6a43a89274eac611c71663?s=128&d=identicon&r=PG&f=1", "display_name": "sagar bhandari", "link": "https://stackoverflow.com/users/9055841/sagar-bhandari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1512601000, "creation_date": 1512581991, "last_edit_date": 1531164843, "question_id": 47680332, "link": "https://stackoverflow.com/questions/47680332/replace-a-cell-value-if-criteria-is-fulfilled", "title": "Replace a cell value if criteria is fulfilled", "body": "<p>Hope this question finds you well. I am trying to do some testing in excel using VBA however i ran into a problem.\nBelow is the code i wrote but it is not working as per my expectations.</p>\n\n<p>Details:</p>\n\n<pre><code>Me.txt_EN.Value is Employee Name\n\nMe.cmb_S.Value is Shift\n\nMe.cmb_M.Value is Month\n\nWorksheet Name = Test\n\nUserform Name is Userform1\n</code></pre>\n\n<p>Above Values would be added via userform in excel.</p>\n\n<p>Here is what below code is supposed to do: Once i click on submit button in my userform1, it should first paste the value specified in Shift (Me.cmb_S.Value) in a range (It does fine until here) then if i enter \"WO\" as a entry (Look at the first screen shot1), the code should change the cell value with \"WO\".\nExample: If i select \"WO\" for Tuesday (Tue) and Wednesday (Wed) and my shift as Evening (E), it should first fill all cells (range E32:AI32)with E and then replaces \"E\" with \"WO\" for all Tuesdays and Wednesdays.<a href=\"https://i.stack.imgur.com/kHffm.png\" rel=\"nofollow noreferrer\">Screenshot1</a>\n<a href=\"https://i.stack.imgur.com/2swnV.png\" rel=\"nofollow noreferrer\">Screenshot2</a></p>\n\n<p>Below code is a bit slow and it gives me results as shown in screen shot 2, it always excludes last Tuesdays and Wednesdays (Look at 1/30/18 and 1/3/18, they should be changed as \"WO\")</p>\n\n<p>Any help to fix this would be appreciated and also is there a way i could add a rule so the same user cannot fill this form more than once?</p>\n\n<pre><code>Private Sub cmd_Submit_Click()\n'select worksheet\nDim iRow As Long\nDim ws As Worksheet \nSet ws = Worksheets(\"RawData\") \nDim i As Integer \nDim m As Integer \nDim n As Integer\n\n'find first empty row in database \niRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, \nSearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\n'copy the data to the database\n\nFor i = 5 To 36 \nws.Cells(iRow, 1).Value = Me.txt_EN.Value \nws.Cells(iRow, i).Value = Me.cmb_S.Value \nws.Cells(iRow, 37).Value = Me.cmb_M.Value \nNext i\n\nFor m = 5 To 29\nIf Me.cmb_mon.Value = \"WO\" Then ws.Cells(iRow, m).Value = \"WO\"\nIf Me.cmb_Tue.Value = \"WO\" Then ws.Cells(iRow, m + 1).Value = \"WO\"\nIf Me.cmb_Wed.Value = \"WO\" Then ws.Cells(iRow, m + 2).Value = \"WO\"\nIf Me.cmb_thu.Value = \"WO\" Then ws.Cells(iRow, m + 3).Value = \"WO\"\nIf Me.cmb_Fri.Value = \"WO\" Then ws.Cells(iRow, m + 4).Value = \"WO\"\nIf Me.cmb_Sat.Value = \"WO\" Then ws.Cells(iRow, m + 5).Value = \"WO\"\nIf Me.cmb_Sun.Value = \"WO\" Then ws.Cells(iRow, m + 6).Value = \"WO\"\n\nm = m + 6\nIf m &gt; 35 Then Exit For Else\nNext\n\nMsgBox \"Data added\", vbOKOnly + vbInformation, \"Data Added\"\nUnload Me\nUserForm1.Show\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "onedrive"], "comments": [{"owner": {"reputation": 1843, "user_id": 18128, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a7b923bb47743d9df074f597642ef12e?s=128&d=identicon&r=PG", "display_name": "Rob Nicholson", "link": "https://stackoverflow.com/users/18128/rob-nicholson"}, "edited": false, "score": 0, "creation_date": 1512582540, "post_id": 47680275, "comment_id": 82320133, "body": "A fudge (spawning Office apps is always a fudge) is to add ExcelApp.Visible = True which brings the spawned Excel into view so the user can see the error. Not ideal but okay for now. Still like to know how to test if the document exists first"}, {"owner": {"reputation": 1411, "user_id": 4121863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43e77d8245591671b702eda73a4f3a2a?s=128&d=identicon&r=PG", "display_name": "AdamsTips", "link": "https://stackoverflow.com/users/4121863/adamstips"}, "edited": false, "score": 1, "creation_date": 1512585788, "post_id": 47680275, "comment_id": 82321723, "body": "You might check <a href=\"https://stackoverflow.com/questions/25428611/vba-check-if-file-from-website-exists\" title=\"vba check if file from website exists\">stackoverflow.com/questions/25428611/&hellip;</a> to see if that would work in your scenario..."}, {"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "reply_to_user": {"reputation": 1411, "user_id": 4121863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43e77d8245591671b702eda73a4f3a2a?s=128&d=identicon&r=PG", "display_name": "AdamsTips", "link": "https://stackoverflow.com/users/4121863/adamstips"}, "edited": false, "score": 0, "creation_date": 1585496951, "post_id": 47680275, "comment_id": 107773768, "body": "@AdamsTips it does not work, using OneDrive a (default) file ist created/returned even if the file does not exist in OneDrive"}, {"owner": {"reputation": 1843, "user_id": 18128, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a7b923bb47743d9df074f597642ef12e?s=128&d=identicon&r=PG", "display_name": "Rob Nicholson", "link": "https://stackoverflow.com/users/18128/rob-nicholson"}, "edited": false, "score": 0, "creation_date": 1586091161, "post_id": 47680275, "comment_id": 107992344, "body": "Hmm, my experience with OneDrive is that it can cause more problems than it fixes.."}], "owner": {"reputation": 1843, "user_id": 18128, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a7b923bb47743d9df074f597642ef12e?s=128&d=identicon&r=PG", "display_name": "Rob Nicholson", "link": "https://stackoverflow.com/users/18128/rob-nicholson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 849, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1512582769, "creation_date": 1512581802, "last_edit_date": 1512582309, "question_id": 47680275, "link": "https://stackoverflow.com/questions/47680275/how-to-test-if-a-document-exists-in-onedrive-before-attempting-to-open", "title": "How to test if a document exists in OneDrive before attempting to open", "body": "<p>I'm writing some VBA in PowerPoint saved in Office 365 OneDrive which is opening an Excel workbook. This is the example code:</p>\n\n<pre><code>Sub TestOpen()\nDim FilePath As String\nFilePath = \"https://mytenant-my.sharepoint.com/personal/user_name_mytenant_com/Documents/Workbook.xlsx\"\nDim ExcelApp As New Excel.Application\nDim ExcelWorkbook As Excel.Workbook\nSet ExcelWorkbook = ExcelApp.Workbooks.Open(FilePath, UpdateLinks:=False, ReadOnly:=True)\nMsgBox \"Workbook opened and contains \" &amp; ExcelWorkbook.Sheets.Count &amp; \" sheets\", vbInformation\nExcelWorkbook.Close False\nSet ExcelWorkbook = Nothing\nExcelApp.Quit\nSet ExcelApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>This works fine. </p>\n\n<p>However, if the file doesn't exist, the <code>ExcelApp.Workbooks.Open</code> call hangs. You can get control back by ending the spawned excel.exe task at which point an error is thrown.</p>\n\n<p>I suspect there isn't much one can do to make the Open method return if the file exist - it's possible that there is a prompt being displayed that the user can't see.</p>\n\n<p>Another way to tackle this would be to see if the document at least existed before trying the Open method. So another question is how do you test from VBA that a file exists in OneDrive? I'm thinking along the lines of a web request as this is done via HTTP but haven't a clue what request to fire off?</p>\n\n<p>UPDATE:</p>\n\n<p>I've just run similar code in Excel itself as that allows one to see any error message and it indeed does throw an untrappable error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gs0lF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gs0lF.png\" alt=\"enter image description here\"></a></p>\n\n<p>So yes, my question is how can you check a document exists in OneDrive before attempting to open it.</p>\n"}, {"tags": ["excel", "vba", "list"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1512581838, "post_id": 47680250, "comment_id": 82319759, "body": "Shouldn&#39;t your keycells only be A1:A10?  Why are columns B and C included?  Also don&#39;t use <code>Selection.Validation</code>, use <code>Target.Offset(, 1).Validation</code> if you want to modify the drop-down contents of the cell to the right of the changed cell."}, {"owner": {"reputation": 19, "user_id": 3456612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53465d568615052029f9e7ca218bd173?s=128&d=identicon&r=PG&f=1", "display_name": "user3456612", "link": "https://stackoverflow.com/users/3456612/user3456612"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1512667403, "post_id": 47680250, "comment_id": 82360940, "body": "@tigeravatar first off, yes the keycells should only be the a column, i pulled it from another of my programs and forgot to change it, secondly your solution worked great however, what if i paste a list in to column A? currently it throws me an error if i try to paste more than one item in the column. any ideas? thanks"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1512668813, "post_id": 47680250, "comment_id": 82361652, "body": "Would need to implement a for each loop to go through each cell of <code>Target</code>.   Something like: <code>For Each TargetCell in Target.Cells</code> and then work with <code>TargetCell</code> in the loop instead of <code>Target</code>"}, {"owner": {"reputation": 19, "user_id": 3456612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53465d568615052029f9e7ca218bd173?s=128&d=identicon&r=PG&f=1", "display_name": "user3456612", "link": "https://stackoverflow.com/users/3456612/user3456612"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1512669299, "post_id": 47680250, "comment_id": 82361895, "body": "I figured out that if i put in a second range variable and check for each of the second range in the first rage it works just fine changes as follows:                 For Each key In Target                If key.Value = &quot;&quot; Then                     key.Offset(, 1).Clear                     GoTo blank                     End If                With key.Offset(, 1).Validation"}], "owner": {"reputation": 19, "user_id": 3456612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53465d568615052029f9e7ca218bd173?s=128&d=identicon&r=PG&f=1", "display_name": "user3456612", "link": "https://stackoverflow.com/users/3456612/user3456612"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512581680, "creation_date": 1512581680, "question_id": 47680250, "link": "https://stackoverflow.com/questions/47680250/making-a-dropdown-list-in-excel-if-cell-changes", "title": "making a dropdown list in excel if cell changes", "body": "<p>I am having some trouble with my code. what i am trying to do is populate a cell with a dropdown list named holdCodes if a cell in the same row is selected.</p>\n\n<p>It works however my problem is, if i fill in a cell with any value or character, it changes the next cell i go into to a dropdown list (if i fill \"A2\" then go to cell \"E5\" \"E5\" then has the dropdown). overall what i want to do is fill cell \"A2\" with a number and populate \"B2\" with the dropdown box.</p>\n\n<p>my code is as follows:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n\n    Set KeyCells = Range(\"A1:C10\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n           Is Nothing Then\n    With Selection.Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n        xlBetween, Formula1:=\"=holdCodes\"\n        .ShowInput = True\n        .ShowError = True\n    End With\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1512581312, "post_id": 47680058, "comment_id": 82319488, "body": "filename = OFrm.Range(&quot;D3&quot;).value"}, {"owner": {"reputation": 81, "user_id": 9012265, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f6a4cec085eccaf803fff8a510ecedb0?s=128&d=identicon&r=PG&f=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/9012265/eric-k"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1512582035, "post_id": 47680058, "comment_id": 82319861, "body": "Stijll getting a syntax error for line beginning with OFrm.SaveAs..."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1512585554, "post_id": 47680058, "comment_id": 82321626, "body": "You may need to check the value of D3 and how that path+filename+.pdf looks after it is built.  Could be problems with too many \\&#39;s or not enough."}], "answers": [{"tags": [], "owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "is_accepted": false, "score": 0, "last_activity_date": 1512583452, "creation_date": 1512583452, "answer_id": 47680737, "question_id": 47680058, "link": "https://stackoverflow.com/questions/47680058/how-to-save-excel-worksheet-as-pdf-with-command-button/47680737#47680737", "title": "How to Save Excel Worksheet as PDF with Command Button?", "body": "<p>I think that your variable \"filename\" is conflicting with the method keyword \"Filename\". Call your variable something else...</p>\n\n<pre><code>OFRrm.SaveAs Filename:= Path &amp; myFile &amp; \".pdf\", FileFormat:=xlTypePDF\n</code></pre>\n\n<p>or just eliminate the keywords in the arguments altogether:</p>\n\n<pre><code>OFRrm.SaveAs Path &amp; myFile &amp; \".pdf\", xlTypePDF\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "is_accepted": false, "score": 1, "last_activity_date": 1512585526, "creation_date": 1512585526, "answer_id": 47681284, "question_id": 47680058, "link": "https://stackoverflow.com/questions/47680058/how-to-save-excel-worksheet-as-pdf-with-command-button/47681284#47681284", "title": "How to Save Excel Worksheet as PDF with Command Button?", "body": "<p>The SaveAs line is redundant. You just need to fix the ExportAsFixedFormat to work properly. When using named parameters, you need to use := instead of just =. I recommend creating a new Sub for the PDF save.</p>\n\n<pre><code>Sub SaveOrderAsPDF()\n    Dim PDFName As String\n    PDFName = Worksheets(\"Order Form 1\").Range(\"D3\").Value\n    ChDir \"C:\\PDF\"\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"C:\\PDF\\\" &amp; PDFName, Quality:=xlQualityStandard, IncludeDocProperties:= _\n    True, IgnorePrintAreas:=False, OpenAfterPublish:=False\nEnd Sub\n</code></pre>\n\n<p>With that working, just add SaveOrderAsPDF to your existing sub. </p>\n"}], "owner": {"reputation": 81, "user_id": 9012265, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f6a4cec085eccaf803fff8a510ecedb0?s=128&d=identicon&r=PG&f=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/9012265/eric-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1607, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512585526, "creation_date": 1512580961, "last_edit_date": 1512581291, "question_id": 47680058, "link": "https://stackoverflow.com/questions/47680058/how-to-save-excel-worksheet-as-pdf-with-command-button", "title": "How to Save Excel Worksheet as PDF with Command Button?", "body": "<p>I am getting a 'Syntax Error' with the coding beneath the Next R line toward the bottom below.  I am trying to save the open worksheet as a PDF file referencing the order number found in cell D3.  Thanks for your help!</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim OrderDate As String, PONumber As String, Vendor As String, ShipTo As String, SKU As String, Path As String, filename As String\nDim R As Long, LastSKURow As Long, NextDBRow As Long, OFrm As Worksheet, DB As Worksheet\nSet OFrm = Worksheets(\"Order Form 1\")\nSet DB = Worksheets(\"Database\")\nOrderDate = OFrm.Range(\"B3\")\nPONumber = OFrm.Range(\"D3\")\nVendor = OFrm.Range(\"B7\")\nShipTo = OFrm.Range(\"D7\")\nLastSKURow = OFrm.Cells(OFrm.Rows.Count, \"F\").End(xlUp).Row\nFor R = 3 To LastSKURow\n    SKU = OFrm.Range(\"F\" &amp; R).Value\n    NextDBRow = DB.Cells(DB.Rows.Count, \"A\").End(xlUp).Row + 1\n    DB.Range(\"A\" &amp; NextDBRow).Value = OrderDate\n    DB.Range(\"B\" &amp; NextDBRow).Value = PONumber\n    DB.Range(\"C\" &amp; NextDBRow).Value = Vendor\n    DB.Range(\"D\" &amp; NextDBRow).Value = ShipTo\n    DB.Range(\"E\" &amp; NextDBRow).Value = SKU\nNext R\nApplication.ScreenUpdating = False\nOFrm.ExportAsFixedFormat Type:=xlTypePDF, _\n        Path =\"C:\\PDF\\\"\n        filename = OFrm.Range(\"D3\")\n        OpenAfterPublish = False\nOFRrm.SaveAs filename:=Path &amp; filename &amp; \".pdf\", FileFormat:=xlTypePDF\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1512581718, "post_id": 47680032, "comment_id": 82319705, "body": "The &quot;Formula&quot; you are using is not a viable worksheet formula.  Worksheet formulas do not use IF/THEN/ELSE verbiage."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1512581862, "post_id": 47680032, "comment_id": 82319771, "body": "And <code>Range(&quot;A2:BN74&quot;).Formula = &quot;=A2&quot;</code> will fill those cells with a circular reference."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1512582046, "post_id": 47680032, "comment_id": 82319866, "body": "Have you written a working If formula directly in an Excel cell? If so, copy paste that formula into your code and adjust for the quotes.  If not, you will need to learn to write a working If formula.  What you have now, as @ScottCraner has already pointed out, is invalid."}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1512585829, "post_id": 47680032, "comment_id": 82321741, "body": "@tigeravatar I copy/pasted it in and adjusted for the quotes to no avail before realizing the issue. I&#39;ve updated the code and it fills, though not as a formula.  Here is an example of how the array looks now (using simple code to see if I can&#39;t get it to work):  Dim cell As Range TestFormulas() = Array(&quot;If cell.Value &lt;&gt; 1 Then cell.Value = 2 Else cell.Value = 4&quot;)"}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512586279, "post_id": 47680032, "comment_id": 82321963, "body": "@ScottCraner The If function now works outside of the array, though, for some reason, it does not function inside. Even setting the loop to .Cells(2, 1 + i).Formula = TestFormulas(i) results in a string being passed through to the respective cell."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512586377, "post_id": 47680032, "comment_id": 82322002, "body": "No that still is not in a format acceptable to a worksheet formula.  <code>IF(,,)</code>  there is no THEN/ELSE in excel worksheet formulas."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512586475, "post_id": 47680032, "comment_id": 82322059, "body": "Write the formula in the worksheet, get it working in the worksheet not vba code.  Then copy and paste that formula into vba."}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512749137, "post_id": 47680032, "comment_id": 82396277, "body": "@ScottCraner I was under the impression I would have to use the VBA code for the IF/THEN statement, rather than just filling it with the Excel If statement formula and doubling up on the quotes."}], "answers": [{"tags": [], "owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "is_accepted": true, "score": 1, "last_activity_date": 1512590352, "creation_date": 1512590352, "answer_id": 47682514, "question_id": 47680032, "link": "https://stackoverflow.com/questions/47680032/dynamically-populating-range-with-chained-if-statements-in-vba/47682514#47682514", "title": "Dynamically populating Range with chained IF statements in VBA?", "body": "<p>You say you've adjusted for quotes, but you have changed them to single quotes instead of leaving them as double quotes</p>\n\n<p>The formula should be adjusted like this....</p>\n\n<pre><code>=If 'Sheet1'!P2 = \"\"Redundant\"\" Then ...\n</code></pre>\n\n<p>Note the doubling of the double quotes.</p>\n\n<p>Also, the Excel spreadsheet does not understand vba code, so your formula should look something like this:</p>\n\n<pre><code>=IF('Sheet1'!P2 = \"\"Redundant\"\",\"\"\"\",IF(...\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 47682514, "answer_count": 1, "score": 0, "last_activity_date": 1512590352, "creation_date": 1512580870, "last_edit_date": 1512586081, "question_id": 47680032, "link": "https://stackoverflow.com/questions/47680032/dynamically-populating-range-with-chained-if-statements-in-vba", "title": "Dynamically populating Range with chained IF statements in VBA?", "body": "<p>\nI am automating a workbook that uses chained IF statements (non-VBA) across 4 worksheets to generate an output file for upload. </p>\n\n<p>Here is a quick rundown of the code to give context:</p>\n\n<ol>\n<li><p>Create new worksheet and populate first row from array (works)</p></li>\n<li><p>Populate second row with IF formulas from array</p></li>\n<li><p>Populate rest of table with dynamic IF functions used above (seems to work though rather rudimentary)</p></li>\n</ol>\n\n<h2>[Updated Code below]</h2>\n\n<pre><code>Dim WS As Worksheet\nDim cell As Range\n\nTestFormulas() = Array(\"=If 'Sheet1'!P2 = 'Redundant' Then cell.Value = ''\nElseIf 'Sheet1'!P2 = 'Peripheral' Then cell.Value = '' Else cell.Value = 1\")\n\n    With WS\n        For i = LBound(TestFormulas()) To UBound(TestFormulas())\n          .Cells(2, 1 + i).Formula = TestFormulas(i)\n        Next i\n    End With\n\n    Range(\"A3:BN74\").Formula = \"=A2\"\n</code></pre>\n\n<p>The result I am looking to achieve is that the array fills all the rows across with the correct IF statements and then the Range completes the dynamic fill of the relevant cells.</p>\n\n<p>Error I am receiving is </p>\n\n<blockquote>\n  <p>'1004: Application-Defined or Object-Defined error'</p>\n</blockquote>\n\n<p>and the line <code>.Cells(2, 1 + i).Formula = TestFormulas(i)</code> is highlighted yellow.</p>\n"}, {"tags": ["vba", "pdf", "adobe"], "answers": [{"comments": [{"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1512601611, "post_id": 47681543, "comment_id": 82329560, "body": "Minor tweak should be newPDF.GetNumPages and it works perfectly!"}, {"owner": {"reputation": 3835, "user_id": 4254700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5225a3969314fb32ff3192e48c752c1?s=128&d=identicon&r=PG", "display_name": "joelgeraci", "link": "https://stackoverflow.com/users/4254700/joelgeraci"}, "reply_to_user": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1512662241, "post_id": 47681543, "comment_id": 82357803, "body": "Yes - that&#39;s correct. I updated my answer. Sorry for any confusion. I was using the JavaScript property by mistake."}], "tags": [], "owner": {"reputation": 3835, "user_id": 4254700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5225a3969314fb32ff3192e48c752c1?s=128&d=identicon&r=PG", "display_name": "joelgeraci", "link": "https://stackoverflow.com/users/4254700/joelgeraci"}, "is_accepted": true, "score": 1, "last_activity_date": 1512662165, "last_edit_date": 1512662165, "creation_date": 1512586476, "answer_id": 47681543, "question_id": 47679989, "link": "https://stackoverflow.com/questions/47679989/control-where-pages-are-inserted/47681543#47681543", "title": "Control Where Pages Are Inserted", "body": "<p>In the first parameter (-1) you are telling Acrobat to insert your new pages before page 1. Acrobat page numbers are zero based so the line should read...</p>\n\n<pre><code>newPDF.InsertPages newPDF.GetNumPages-1, PDDoc, i, 4, 0 \n</code></pre>\n\n<p>... to insert new pages at the end of the new PDF document.</p>\n"}], "owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 47681543, "answer_count": 1, "score": 0, "last_activity_date": 1512662165, "creation_date": 1512580715, "question_id": 47679989, "link": "https://stackoverflow.com/questions/47679989/control-where-pages-are-inserted", "title": "Control Where Pages Are Inserted", "body": "<p>I am using the below syntax to split a master pdf into multiple sub pdfs.  My issue is that the pages are inserted in reverse order, so instead of going 1, 2, 3, 4 the input goes 4, 3, 2, 1.</p>\n\n<p>What would I need to change so that the order of pages in the new workbook goes 1, 2, 3 4?</p>\n\n<pre><code>    For i = 1 To PNum\n        Set newPDF = CreateObject(\"AcroExch.pdDoc\")\n        newPDF.Create\n        NewName = \"R:\" &amp; i &amp; \".pdf\"\n        newPDF.InsertPages -1, PDDoc, i, 4, 0\n        newPDF.Save 1, NewName\n        newPDF.Close\n        Set newPDF = Nothing\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel-2016", "appointment", "outlook-2016"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1512580808, "post_id": 47679827, "comment_id": 82319179, "body": "It&#39;s the <i>same</i>  - appointment you just modify it multiple times in your loop.  You need to create a new appointment each time through."}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 8370017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df8436a149272ffa90ed97977aa62101?s=128&d=identicon&r=PG&f=1", "display_name": "kroy2008", "link": "https://stackoverflow.com/users/8370017/kroy2008"}, "edited": false, "score": 0, "creation_date": 1512663920, "post_id": 47680043, "comment_id": 82358920, "body": "Tim - many thanks - all the 600+ items are now created, thanks for the help! I am still having trouble with not creating duplicates. Someone provided the Private Function - but I don&#39;t understand how to set the PF&#39;s subjectFilter   so next time I run the SetAppt macro, only new rows of data create appointments. Any ideas?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 165, "user_id": 8370017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df8436a149272ffa90ed97977aa62101?s=128&d=identicon&r=PG&f=1", "display_name": "kroy2008", "link": "https://stackoverflow.com/users/8370017/kroy2008"}, "edited": false, "score": 0, "creation_date": 1512666537, "post_id": 47680043, "comment_id": 82360462, "body": "Is the subject of each appt unique?  You&#39;d need some way to match each row of your data against the existing calendar item to see whether they match.  Another approach might be to add a flag column in your data sheet which you populate with a value after creating the Outlook item: then only process rows where this flag is empty."}, {"owner": {"reputation": 165, "user_id": 8370017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df8436a149272ffa90ed97977aa62101?s=128&d=identicon&r=PG&f=1", "display_name": "kroy2008", "link": "https://stackoverflow.com/users/8370017/kroy2008"}, "edited": false, "score": 0, "creation_date": 1512669196, "post_id": 47680043, "comment_id": 82361844, "body": "Yep, the subjects will all be unique. Subject is generated via the cells values in column 9, 13 and 14, resulting in a string of a Name + ID number + a 2nd ID number. Not sure I follow the flag method - can you elaborate on the VBA code I would have to add?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 165, "user_id": 8370017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df8436a149272ffa90ed97977aa62101?s=128&d=identicon&r=PG&f=1", "display_name": "kroy2008", "link": "https://stackoverflow.com/users/8370017/kroy2008"}, "edited": false, "score": 0, "creation_date": 1512671542, "post_id": 47680043, "comment_id": 82363011, "body": "See my edit for suggestions on using a &quot;flag&quot; column."}, {"owner": {"reputation": 165, "user_id": 8370017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df8436a149272ffa90ed97977aa62101?s=128&d=identicon&r=PG&f=1", "display_name": "kroy2008", "link": "https://stackoverflow.com/users/8370017/kroy2008"}, "edited": false, "score": 0, "creation_date": 1512678069, "post_id": 47680043, "comment_id": 82366396, "body": "Tim - thank you, I&#39;ve got it working now. I may modify this to create meeting invitations instead of appointment items, but I think I can figure that out. Thanks for your time!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1512671517, "last_edit_date": 1512671517, "creation_date": 1512580898, "answer_id": 47680043, "question_id": 47679827, "link": "https://stackoverflow.com/questions/47679827/600-rows-of-excel-data-to-create-outlook-appointment-but-only-creates-a-sing/47680043#47680043", "title": "600 + rows of Excel data to create Outlook Appointment...but only creates a single appointment", "body": "<p>Use a new appointment object for each row - otherwise you're just creating a single appointment and then updating it repeatedly</p>\n\n<pre><code>Const COL_FLAG As Long = 20 '&lt;&lt; \"flag\" column\n'...\n'...\nFor r = 2 To Cells(Rows.Count, 1).End(xlUp).Row\n    'Only create an appointment if not already created....\n    If Len(Cells(r, COL_FLAG ).Value)= 0 Then \n    With olApp.CreateItem(olAppointmentItem) '&lt;&lt;&lt; use a new object for each iteration\n           .Start = Cells(r, 2).Value + TimeValue(\"10:30\")\n           .Duration = \"1\"\n           .Subject = Cells(r, 9).Value &amp; \" (\" &amp; Cells(r, 13).Value &amp; _\n                      \" \" &amp; Cells(r, 14).Value &amp; \")\"\n           .Location = Cells(r, 5).Value\n           .Body = \"Follow up with task lead\"\n           .BusyStatus = olBusy\n           .ReminderMinutesBeforeStart = 60\n           .Categories = \"Task Reminder\"\n           .ReminderSet = True\n           .Save \n           Cells(r, COL_FLAG ).Value = \"Created\"\n    End With\n    End If '&lt;&lt; appt not already created\nNext\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 8370017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df8436a149272ffa90ed97977aa62101?s=128&d=identicon&r=PG&f=1", "display_name": "kroy2008", "link": "https://stackoverflow.com/users/8370017/kroy2008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1512671517, "creation_date": 1512580191, "last_edit_date": 1592644375, "question_id": 47679827, "link": "https://stackoverflow.com/questions/47679827/600-rows-of-excel-data-to-create-outlook-appointment-but-only-creates-a-sing", "title": "600 + rows of Excel data to create Outlook Appointment...but only creates a single appointment", "body": "<h2>Background:</h2>\n<p>I have a task tracking spread sheet and would like to create a calendar &quot;appointment&quot; everytime a new row is added to the table. There are many instances of different versions of this code floating around out there, so I pieced this together with little true knowledge of VBA.</p>\n<h2>The Data:</h2>\n<p>Data is stored in a table (Table1) in Sheet1, which I have renamed &quot;Tracker&quot;. It's currently ~600 rows, and ~16 columns. The table is constantly updated with new rows of data.</p>\n<h2>The Problem:</h2>\n<p>The macro runs, and loops through the 600+ rows of data, creating an appointment for a row, then overwriting that appointment with the data from the next row. I know it's creating + overwriting b/c I set my calendar view to &quot;list view&quot;, and ran the macro...and I can see it cycling through all the different rows, so I know it's looping. So I THINK I need assistance modifying the Private Function's subjectFilter. That said, if I remove the Private Function, it does the same thing.</p>\n<p>Right now, the .Subject code is this:</p>\n<pre><code>.Subject = Cells(r, 9).Value &amp; &quot; (&quot; &amp; Cells(r, 13).Value &amp; &quot; &quot; &amp; Cells(r, 14).Value &amp; &quot;)&quot;\n</code></pre>\n<p>Although I could simplify it to this if it makes it easier to incorp into the subjectFilter:</p>\n<pre><code>.Subject = Cells(r, 9).Value\n</code></pre>\n<h2>Questions:</h2>\n<ol>\n<li>How can I adjust the code so it creates all 600+ appointments?</li>\n<li>How do I incorporate my .Subject string into the Private Function's\nsubjectFilter?</li>\n</ol>\n<h2>Current Code:</h2>\n<pre><code>Sub SetAppt()\n\nDim olApp As Outlook.Application \nDim olApt As AppointmentItem\nDim MySheet As Worksheet\n\nSet MySheet = Worksheets(&quot;Tracker&quot;)\nSet olApp = New Outlook.Application\nSet olApt = olApp.CreateItem(olAppointmentItem)\n\nFor r = 2 To Cells(Rows.Count,1).End(xlUp).Row\n\nWith olApt\n       .Start = Cells(r, 2).Value + TimeValue(&quot;10:30&quot;)\n       .Duration = &quot;1&quot;\n       .Subject = Cells(r, 9).Value &amp; &quot; (&quot; &amp; Cells(r, 13).Value &amp; &quot; &quot; &amp; Cells(r, 14).Value &amp; &quot;)&quot;\n       .Location = Cells(r, 5).Value\n       .Body = &quot;Follow up with task lead&quot;\n       .BusyStatus = olBusy\n       .ReminderMinutesBeforeStart = 60\n       .Categories = &quot;Task Reminder&quot;\n       .ReminderSet = True\n       .Save \n\nEnd With\nNext\n\nSet olApt = Nothing \nSet olApp = Nothing\n\nEnd Sub\n\n\nPrivate Function Get_Appointment(subject As String) As Outlook.AppointmentItem\n'Private Function grabbed from here https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwis6IGw7vXXAhXBneAKHWJ9A7kQFggpMAA&amp;url=https%3A%2F%2Fwww.mrexcel.com%2Fforum%2Fexcel-questions%2F686519-using-vba-macro-post-new-appointments-outlook-but-dont-want-duplicates.html&amp;usg=AOvVaw0vUdR7HN9USe52hrOU2M1V\n\nDim olCalendarItems As Outlook.Items\nDim subjectFilter As String\n\n'Get calendar items with the specified subject\n    \nsubjectFilter = &quot;[Subject] = '&quot; &amp; subject &amp; &quot;'&quot;\nSet olCalendarItems = olCalendarFolder.Items.Restrict(subjectFilter)\n\nIf olCalendarItems.Count &gt; 0 Then\n    Set Get_Appointment = olCalendarItems.Item(1)\nElse\n    Set Get_Appointment = Nothing\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop", "runtime-error"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512579214, "post_id": 47679370, "comment_id": 82318168, "body": "use <code>.PasteSpecial</code>"}, {"owner": {"reputation": 34, "user_id": 7037336, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7638cd8df78004ed3b825244d80aca2e?s=128&d=identicon&r=PG&f=1", "display_name": "LillyBran", "link": "https://stackoverflow.com/users/7037336/lillybran"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512579556, "post_id": 47679370, "comment_id": 82318376, "body": "Using .PasteSpecial doesn&#39;t change the error"}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 1, "last_activity_date": 1512579339, "creation_date": 1512579339, "answer_id": 47679574, "question_id": 47679370, "link": "https://stackoverflow.com/questions/47679370/vba-error-subscript-out-of-range-in-for-loop-used-to-copy-paste/47679574#47679574", "title": "VBA Error Subscript out of range in for loop used to copy/paste", "body": "<p>Once you've opened a workbook it's name is just the filename it was saved under, not the path. So you would do</p>\n\n<pre><code>  Workbooks.open(destinationWorkbook) \n</code></pre>\n\n<p>But then refer to it as </p>\n\n<pre><code>  Workbooks(\"Book1.xlsm\")\n</code></pre>\n\n<p>But I wonder if you are trying to copy to a new workbook that isn't on your hard drive? In which case you would write</p>\n\n<pre><code>     Workbooks.add\n     WorkBooks(\"book1\")\n</code></pre>\n\n<p>There wouldn't be a file extension because you haven't saved it yet.\nYou can avoid all these problems by using an object variable</p>\n\n<pre><code> Dim wb as workbook\nSet wb = workbooks.open(destinationworkbook)\nor\nSet wb = workbooks.add\n</code></pre>\n\n<p>and then just wb to refer to the workbook</p>\n"}], "owner": {"reputation": 34, "user_id": 7037336, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7638cd8df78004ed3b825244d80aca2e?s=128&d=identicon&r=PG&f=1", "display_name": "LillyBran", "link": "https://stackoverflow.com/users/7037336/lillybran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 47679574, "answer_count": 1, "score": 0, "last_activity_date": 1512579339, "creation_date": 1512578698, "question_id": 47679370, "link": "https://stackoverflow.com/questions/47679370/vba-error-subscript-out-of-range-in-for-loop-used-to-copy-paste", "title": "VBA Error Subscript out of range in for loop used to copy/paste", "body": "<p>I keep getting an error message for my for loop. What it is supposed to do is compare a variable to the first column for every row for a given worksheet and copy it if it matches, then paste it to a worksheet in a different workbook but for some reason I keep getting \"Run-time error '9': Subscript out of Range\" for the line referencing the new workbook/worksheet.</p>\n\n<p>My for loop so far:</p>\n\n<pre><code>For i = 1 To Sheets(1).UsedRange.Rows.Count\n\n    If Sheets(1).Cells(i, 1).Value Like dateRange &amp; \"*\" Then\n       Sheets(1).Rows(i).Copy\n       Workbooks(destinationWorkbook).Worksheets(\"Sheet2\").Rows(i).Paste 'Debug shows the error is here\n    End If\n\nNext i\n</code></pre>\n\n<p>In the previous code I define the variable as:</p>\n\n<pre><code>destinationWorkbook = \"C:\\Users\\lbran\\Desktop\\Book1.xlsm\"\n</code></pre>\n\n<p>I have also tried using Workbooks(destinationWorkbook).Worksheets(\"Sheet2\").Cells(i, 1).Paste </p>\n\n<p>I'm very new to VBA so I'm not sure if I'm referencing the pasting to worksheet correctly but I know it does exist as a new, empty sheet in the workbook</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 3472143, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1732611863/picture?type=large", "display_name": "user3472143", "link": "https://stackoverflow.com/users/3472143/user3472143"}, "edited": false, "score": 0, "creation_date": 1512601027, "post_id": 47679451, "comment_id": 82329335, "body": "Thank you for your reply and add the comment that make me easier to understand."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1512578921, "creation_date": 1512578921, "answer_id": 47679451, "question_id": 47679234, "link": "https://stackoverflow.com/questions/47679234/excel-vba-macro-copy-and-paste-the-specific-column-to-another-workbook/47679451#47679451", "title": "excel vba macro: copy and paste the specific column to another workbook", "body": "<p>I will use a portion of your code.\nVBA code made while you record a macro is not the best option to use, but this time I will use the code in order to don't do things complicated to you.</p>\n\n<p>Original code:</p>\n\n<pre><code>Windows(\"report.xls\").Activate\nRange(\"B2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nWindows(\"AT.xlsm\").Activate\nActiveSheet.Paste\n</code></pre>\n\n<p>Modify like:</p>\n\n<pre><code>Windows(\"report.xls\").Activate    'This activate the report\nRange(\"B2\").Select    'This selects B2 cell\nRange(Selection, Selection.End(xlDown)).Select    'This expands the selection down\nSelection.Copy    'This copy the selection.\nWindows(\"AT.xlsm\").Activate    'This activate the AT file\nRange(\"B2\").Select    '**** Here you should modify to select the Paste destination cell\nActiveSheet.Paste    'This Paste the values\n</code></pre>\n\n<p>Hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 3472143, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1732611863/picture?type=large", "display_name": "user3472143", "link": "https://stackoverflow.com/users/3472143/user3472143"}, "edited": false, "score": 0, "creation_date": 1512601208, "post_id": 47680028, "comment_id": 82329407, "body": "Thank you for your reply, may I know that how to change the cells(5380) to the cells in any row of column A?"}, {"owner": {"reputation": 79, "user_id": 3472143, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1732611863/picture?type=large", "display_name": "user3472143", "link": "https://stackoverflow.com/users/3472143/user3472143"}, "edited": false, "score": 0, "creation_date": 1512604128, "post_id": 47680028, "comment_id": 82330522, "body": "I don&#39;t always want cell 5380. I want to paste my data then go to last row + 1.  the cell would change with each copy and paste,  what i need to change in the code?  Thanks"}, {"owner": {"reputation": 79, "user_id": 3472143, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1732611863/picture?type=large", "display_name": "user3472143", "link": "https://stackoverflow.com/users/3472143/user3472143"}, "edited": false, "score": 0, "creation_date": 1512662010, "post_id": 47680028, "comment_id": 82357637, "body": "Thank you very much for your help. I will try it."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 1, "last_activity_date": 1512657027, "last_edit_date": 1512657027, "creation_date": 1512580846, "answer_id": 47680028, "question_id": 47679234, "link": "https://stackoverflow.com/questions/47679234/excel-vba-macro-copy-and-paste-the-specific-column-to-another-workbook/47680028#47680028", "title": "excel vba macro: copy and paste the specific column to another workbook", "body": "<p>You should not be activating and selecting anything to copy over to another worksheet.  wss and wsw are explicit references to your worksheets.</p>\n\n<pre><code>Sub Tester546()\nSet wb = Workbook(\"report.xls\")\nSet wb2 = Workbook(\"AT.xlsm\")\nSet wss = wb.Sheets(\"Service\")\nSet wsw = wb.Sheets(\"Worksheet\")\nwss.Range(wss.Cells(2, 2), wss.Cells(wss.Range(\"B\" &amp; wss.Rows.Count).End(xlUp).Row, 2)).Copy wsw.Cells(1, 1)\nwss.Range(wss.Cells(2, 3), wss.Cells(wss.Range(\"C\" &amp; wss.Rows.Count).End(xlUp).Row, 3)).Copy wsw.Cells(5380, 3)\nwss.Range(wss.Cells(2, 6), wss.Cells(wss.Range(\"F\" &amp; ws.Rows.Count).End(xlUp).Row, 6)).Copy wsw.Cells(5380, 4)\nwss.Range(wss.Cells(2, 10), wss.Cells(wss.Range(\"J\" &amp; wss.Rows.Count).End(xlUp).Row, 10)).Copy wsw.Cells(5380, 5)\nwss.Range(wss.Cells(2, 5), wss.Cells(wss.Range(\"E\" &amp; wss.Rows.Count).End(xlUp).Row, 5)).Copy wsw.Cells(5380, 6)\nwss.Range(wss.Cells(2, 4), wss.Cells(wss.Range(\"D\" &amp; wss.Rows.Count).End(xlUp).Row, 4)).Copy wsw.Cells(5380, 8)\nwsw.Range(wsw.Cells(5380, 6), wsw.Cells(wsw.Range(\"F\" &amp; wsw.Rows.Count).End(xlUp).Row, 6)).Replace What:=\"[S]\", Replacement:=\"\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\nEnd Sub\n</code></pre>\n\n<p>You should be able to replace the 5380 on the destination worksheet (wsw) with </p>\n\n<pre><code>wsW.Range(\"D\" &amp; wss.Rows.Count).End(xlUp).Row +1\n</code></pre>\n\n<p>Changing the Column (here it's \"D\", to the columns you need.</p>\n"}], "owner": {"reputation": 79, "user_id": 3472143, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1732611863/picture?type=large", "display_name": "user3472143", "link": "https://stackoverflow.com/users/3472143/user3472143"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3322, "favorite_count": 1, "accepted_answer_id": 47680028, "answer_count": 2, "score": 1, "last_activity_date": 1512657027, "creation_date": 1512578264, "question_id": 47679234, "link": "https://stackoverflow.com/questions/47679234/excel-vba-macro-copy-and-paste-the-specific-column-to-another-workbook", "title": "excel vba macro: copy and paste the specific column to another workbook", "body": "<p>i am new in macro and VBA coding.<p>I have two workbooks. one is report.xls, another one is AT.xlsm.</P></p>\n\n<p>In report.xls, there has the sheet called \"Service\".</p>\n\n<p><p>In AT.xlsm, there has the sheet called \"Worksheet\".</P></p>\n\n<p>I want to auto copy the column B,C,F,J,E,D expect first row of report to the column A,C,D,E,F,H of AT.\nSo, i try to record a macro and revise the code, it can copy and paste but it saved to same location.</p>\n\n<p>Would you please tell me how to paste to new row?</p>\n\n<p>Thank you very much.</p>\n\n<p>Code:</p>\n\n<pre><code>Sub Module1()\n'Hot key: Ctrl+Shift+G\n\nWindows(\"report.xls\").Activate\nRange(\"B2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nWindows(\"AT.xlsm\").Activate\nActiveSheet.Paste\nWindows(\"report.xls\").Activate\nRange(\"C2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"AT.xlsm\").Activate\nRange(\"C5380\").Select\nActiveSheet.Paste\nWindows(\"report.xls\").Activate\nRange(\"F2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"AT.xlsm\").Activate\nRange(\"D5380\").Select\nActiveSheet.Paste\nWindows(\"report.xls\").Activate\nRange(\"J2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"AT.xlsm\").Activate\nRange(\"E5380\").Select\nActiveSheet.Paste\nWindows(\"report.xls\").Activate\nRange(\"E2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"AT.xlsm\").Activate\nRange(\"F5380\").Select\nActiveSheet.Paste\nWindows(\"report.xls\").Activate\nRange(\"D2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"AT.xlsm\").Activate\nRange(\"H5380\").Select\nActiveSheet.Paste\nWindows(\"report.xls\").Activate\nRange(\"G2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"AT.xlsm\").Activate\nRange(\"J5380\").Select\nActiveSheet.Paste\nRange(\"F5380\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Replace What:=\"[S]\", Replacement:=\"\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "edited": false, "score": 0, "creation_date": 1512578772, "post_id": 47679273, "comment_id": 82317876, "body": "This worked wonderfully. I will accept the answer as soon as it will allow me to."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 1, "last_activity_date": 1512578372, "creation_date": 1512578372, "answer_id": 47679273, "question_id": 47679148, "link": "https://stackoverflow.com/questions/47679148/if-a-cells-are-selected-from-more-than-one-sheet-then-show-message-box/47679273#47679273", "title": "If a cells are selected (from more than one sheet) then show message box", "body": "<p>Worksheet_SelectionChange has to be in the private module of a worksheet. However it can then call another routine in a public module</p>\n\n<p>So if you put </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n   CheckSelection target\nEnd Sub\n</code></pre>\n\n<p>Into each of your three sheets, you can then put your code in a public module </p>\n\n<pre><code>    Public Sub CheckSelection(Target as range)\n        etc\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1512579303, "creation_date": 1512579303, "answer_id": 47679562, "question_id": 47679148, "link": "https://stackoverflow.com/questions/47679148/if-a-cells-are-selected-from-more-than-one-sheet-then-show-message-box/47679562#47679562", "title": "If a cells are selected (from more than one sheet) then show message box", "body": "<p>For a different approach, this only needs to be entered once, inside the <code>ThisWorkbook</code> object.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n\n    Select Case Sh.Name\n\n        Case Is = \"Sheet3\", \"Sheet4\", \"Sheet5\"\n\n            If Target.Address = \"$A$10\" Then\n\n                    MsgBox Worksheets(\"Sheet6\").Range(\"A1\").Value\n\n            End If\n\n    End Select\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "edited": false, "score": 0, "creation_date": 1512584701, "post_id": 47679877, "comment_id": 82321224, "body": "Wow, this is very interesting. It is a bit out of my capabilities currently but I just ordered a few books to expand my VBA knowledge as I am completely unfamiliar with wrapper class objects. Thank you for this! I am going to save this to my desktop for later! :)"}], "tags": [], "owner": {"reputation": 1411, "user_id": 4121863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43e77d8245591671b702eda73a4f3a2a?s=128&d=identicon&r=PG", "display_name": "AdamsTips", "link": "https://stackoverflow.com/users/4121863/adamstips"}, "is_accepted": false, "score": 1, "last_activity_date": 1512580321, "creation_date": 1512580321, "answer_id": 47679877, "question_id": 47679148, "link": "https://stackoverflow.com/questions/47679148/if-a-cells-are-selected-from-more-than-one-sheet-then-show-message-box/47679877#47679877", "title": "If a cells are selected (from more than one sheet) then show message box", "body": "<p>Sounds like a fun project! To expand a little more on the answer, when you use the <code>Worksheet_SelectionChange</code> event, this is an event that happens to a specific object. That's why it only works for the one sheet that has the code behind it. To have this work in multiple sheets, you could take one of the three following approaches.</p>\n\n<p><strong>Option 1</strong>: Copy the code to each worksheet object. This is the simplest approach, in one sense, but it can be messy to maintain copies of the same code in multiple locations.</p>\n\n<p><strong>Option 2</strong>: Put your code in a public function in a standard module. This way you can maintain your code routine in one location, and use the minimal necessary code to call this from each worksheet.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    MySpecialFunction Target\nEnd Sub\n</code></pre>\n\n<p>For most cases, you will probably find this to be the most efficient way to handle the need.</p>\n\n<p><strong>Option 3</strong>: Another more advanced way to do this is to use a wrapper class object. This allows you to dynamically apply your function to any active sheet, without having to add the (option 2) code to each worksheet. While this is more complex, it allows you to apply your event-driven code to any worksheet, even new ones created by your users.</p>\n\n<p>To do this, create a Class Module in your project, and name it <code>clsMyClass</code>. Then paste in the following code:</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents MySheet As Worksheet\n\nPrivate Sub MySheet_SelectionChange(ByVal Target As Range)\n    ' Do neat stuff here...\nEnd Sub\n</code></pre>\n\n<p>The key thing here is that <code>WithEvents</code> declaration. This is what allows you to tap into an <strong><em>event</em></strong> from an object variable. (But you can only do this from a class object, not a standard module.)</p>\n\n<p>Then in your <code>Workbook_Open()</code> event, or somewhere else in your project, you can add the function that adds all current worksheets to a collection, allowing you to harness the <code>SelectionChange</code> event for all of these worksheets <em>without needing to add code to each one.</em></p>\n\n<pre><code>Option Explicit\n\nPrivate mcolSheets As Collection\n\nPublic Sub ActivateCodeForAllWorksheets()\n\n    Dim wks As Worksheet\n    Dim cSheet As clsMyClass\n\n    ' Initialize module-level collection\n    Set mcolSheets = New Collection\n\n    For Each wks In ActiveWorkbook.Worksheets\n        ' Create new instance of class\n        Set cSheet = New clsMyClass\n        ' Set to the current worksheet in our loop,\n        ' and add to the collection so the sheet object\n        ' reference perists after this sub finishes.\n        Set cSheet.MySheet = wks\n        mcolSheets.Add cSheet\n    Next wks\n\nEnd Sub\n</code></pre>\n\n<p>In real life this can be very useful for things like applying special formatting to a text box when it has the focus, and having this behavior consistent across a large number of objects without needing hundreds of lines of repeated code.</p>\n\n<p>I hope this is helpful!</p>\n"}], "owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 47679273, "answer_count": 3, "score": 0, "last_activity_date": 1512580321, "creation_date": 1512577985, "question_id": 47679148, "link": "https://stackoverflow.com/questions/47679148/if-a-cells-are-selected-from-more-than-one-sheet-then-show-message-box", "title": "If a cells are selected (from more than one sheet) then show message box", "body": "<p>For starters, I am self taught and still learning (I learn a great deal from this website). That being said, please do not assume something is obvious. I will need help altering the code if your solution is too complex.</p>\n\n<p>What I want to accomplish is; if you select cell A10 on \"Sheet3\", \"Sheet4\", and \"Sheet5\" then I want a message box to appear with the information from Sheets(\"Sheet6\").Range(\"A1\"). </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Selection.Count = 1 Then\n        If Not Intersect(Target, Range(\"A10\")) Is Nothing Then ' this range is where you click to get the msgbox\n                Dim rng As Range, s As String, x As String\n                Set rng = Sheets(\"Sheet6\").Range(\"A1\") ' this defines x\n                 s = \"Define: \" ' s is what appears first\n                 x = s &amp; rng.Value ' x is what appears after s\n\n                 MsgBox x\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>What I would like to happen; if you are in \"Sheet3\", \"Sheet4\", and \"Sheet5\" and select A10 in any of those three sheets, it will appear with the message box that is defined in the code. </p>\n\n<p>What is working; currently this is a private sub that is directly in \"Sheet5\". When it is here, if cell A10 (in \"Sheet5\") is selected the information from \"Sheet6\" A1 appears in the message box as I want. </p>\n\n<p>What is not working; because this is a private sub and is inside \"Sheet5\" I am struggling to get it to work with A10 from \"Sheet3\" and \"Sheet4\".</p>\n\n<p>I attempted to alter the code by moving it and declaring it a public sub to work for all sheets but so far am unsuccessful.</p>\n"}, {"tags": ["sql", "ms-access", "join", "vba", "ms-access-forms"], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 8200639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6ee84f5b5e28ba153bcbd247c618e3?s=128&d=identicon&r=PG&f=1", "display_name": "metadata", "link": "https://stackoverflow.com/users/8200639/metadata"}, "is_accepted": true, "score": 1, "last_activity_date": 1512578679, "last_edit_date": 1512578679, "creation_date": 1512578205, "answer_id": 47679214, "question_id": 47679134, "link": "https://stackoverflow.com/questions/47679134/report-pulling-duplicate-values-with-join-access/47679214#47679214", "title": "Report pulling duplicate values with JOIN access", "body": "<p>Did you try putting the keyword \"Distinct\" after SELECT</p>\n\n<pre><code> ReCrt1 = \"SELECT DISTINCT TeamDetails_v1.vName FROM TeamDetails_v1 LEFT JOIN Attendance ON TeamDetails_v1.vName = Attendance.Name \n    WHERE ([Attendance!Team] In ('\" &amp; Mylist &amp; \"')) And ([Attendance!Dates]&gt;Forms!AttendanceSummary!DTPicker0) And \n    ([Attendance!Dates]&lt;Forms!AttendanceSummary!DTPicker6) And ([TeamDetails_v1.vEmployment_Status]='Active')\"\n\n        DoCmd.OpenReport \"Monthly Report\", acViewReport, , , , ReCrt1\n</code></pre>\n"}], "owner": {"reputation": 451, "user_id": 2768400, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f830ed8684c7b41049f87564670eeb8d?s=128&d=identicon&r=PG&f=1", "display_name": "srt", "link": "https://stackoverflow.com/users/2768400/srt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 47679214, "answer_count": 1, "score": 0, "last_activity_date": 1512580633, "creation_date": 1512577909, "last_edit_date": 1512580633, "question_id": 47679134, "link": "https://stackoverflow.com/questions/47679134/report-pulling-duplicate-values-with-join-access", "title": "Report pulling duplicate values with JOIN access", "body": "<p>I am pulling a report in access by writing a query in VBA and it has joining of tables.\nThe problem is the report is now pulling duplicates values in the report.</p>\n\n<pre><code>ReCrt1 = \"SELECT TeamDetails_v1.vName \n            FROM TeamDetails_v1 \n            LEFT JOIN Attendance ON TeamDetails_v1.vName = Attendance.Name \n            WHERE ([Attendance!Team] In ('\" &amp; Mylist &amp; \"')) \n                AND ([Attendance!Dates]&gt;Forms!AttendanceSummary!DTPicker0) \n                AND ([Attendance!Dates]&lt;Forms!AttendanceSummary!DTPicker6) \n                AND ([TeamDetails_v1.vEmployment_Status]='Active')\"\nDoCmd.OpenReport \"Monthly Report\", acViewReport, , , , ReCrt1\n</code></pre>\n\n<p>The line breaks in SQL statement is not in code. I put it there for your ease.</p>\n\n<p>I need the report to pull names from \"TeamDetails_v1\" table which has only unique name records and are 'active' in \"vEmployment_Status\". And their respective number of records(count formula is used in the Report) in \"Attendance\" table where dates should be in between the dates from date picker controls.\"Mylist\" is a array containing certain teams filtered based on a list box in the form.</p>\n\n<p>Here, instead of pulling single name records from TeamDetails_v1, the report pulls n number of same data if there is n number of dates.\nI have provided only a single textbox in report and its control source is given as \"TeamDetails_v1.vName\".\nIs there any issues with JOIN I used or is it the textbox field control source?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1512578119, "post_id": 47678956, "comment_id": 82317474, "body": "So, are you wanting to search Col. A for a word (<code>A</code>), and copy all instances of that into column B, starting row 2 and going down as more are found?  Can you clarify your question?"}, {"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1512578777, "post_id": 47678956, "comment_id": 82317879, "body": "Not quite, I am wanting to search Column A for all mentions of (A). For each mention of A take the value of the Cell in Column B that corrosponds to that row location of (A) then paste the value found Column B into C1.              For example if (A) is found in Row 1,4,7,10 etc then copy the contents of B1, B4, B7, B10 etc into C1,C2,C3,C4. etc Hope this helps, been stuck on this for ages."}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1512579961, "post_id": 47679604, "comment_id": 82318622, "body": "This works great on the test. I now have a few question, so I can modify it to work with the main macro mainly about syntax and naming conventions . 1st - What does &quot;ReDim&quot; mean? 2- What does &quot;ReDim Preserve&quot; do? - Is that keeping whats in the ReDim variable? 3 - Ubound? No idea what this could means or does? Thanks"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1512580698, "post_id": 47679604, "comment_id": 82319113, "body": "@CptGoodar  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1512635081, "post_id": 47679604, "comment_id": 82340089, "body": "This works great and is ealisly modded and upgraded to suit the main needs. Thanks again :)"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1512580665, "last_edit_date": 1512580665, "creation_date": 1512579439, "answer_id": 47679604, "question_id": 47678956, "link": "https://stackoverflow.com/questions/47678956/search-a-dynamic-number-of-rows-in-column-a-for-a-specific-string-in-vba/47679604#47679604", "title": "Search a Dynamic Number of rows in Column A for a specific string in VBA", "body": "<p>Consider:</p>\n\n<pre><code>Sub LookingForA()\n    Dim s As String, rng As Range, WhichRows() As Long\n    Dim rFound As Range\n\n    ReDim WhichRows(1)\n\n    s = \"A\"\n    Set rng = Range(\"A:A\")\n    Set rFound = rng.Find(What:=s, After:=rng(1))\n    WhichRows(1) = rFound.Row\n    Cells(1, 3) = Cells(rFound.Row, 2)\n\n    Do\n        Set rFound = rng.FindNext(After:=rFound)\n        If rFound.Row = WhichRows(1) Then Exit Do\n        ReDim Preserve WhichRows(UBound(WhichRows) + 1)\n        WhichRows(UBound(WhichRows)) = rFound.Row\n        Cells(Cells(Rows.Count, \"C\").End(xlUp).Row + 1, 3) = Cells(rFound.Row, 2)\n    Loop\nEnd Sub\n</code></pre>\n\n<p>This code builds column <strong>C</strong>.  It also builds an internal array of the row numbers in the event they are needed later.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gH4Bs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gH4Bs.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>To read about dynamic arrays:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/aa716275%28v=vs.60%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Dynamic Arrays</a></p>\n\n<p>or Google:</p>\n\n<p><em>Excel VBA dynamic array</em></p>\n"}, {"comments": [{"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1512635037, "post_id": 47679738, "comment_id": 82340068, "body": "This is great works like a treat :) Thank you so much"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1512579878, "creation_date": 1512579878, "answer_id": 47679738, "question_id": 47678956, "link": "https://stackoverflow.com/questions/47678956/search-a-dynamic-number-of-rows-in-column-a-for-a-specific-string-in-vba/47679738#47679738", "title": "Search a Dynamic Number of rows in Column A for a specific string in VBA", "body": "<p>This will look for a string in Column A, and add to Column C the same row's B Column Value.</p>\n\n<pre><code>Sub find_move()\nDim foundCel As Range\nDim findStr As String, firstAddress As String\nDim i As Long\ni = 1\nfindStr = \"A\"\nSet foundCel = Range(\"A:A\").Find(what:=findStr)\nIf Not foundCel Is Nothing Then\n    firstAddress = foundCel.Address\n    Do\n        Range(\"C\" &amp; i).Value = foundCel.Offset(0, 1).Value\n        Set foundCel = Range(\"A:A\").FindNext(foundCel)\n        i = i + 1\n    Loop While Not foundCel Is Nothing And foundCel.Address &lt;&gt; firstAddress\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Note: You should add the worksheet in front of all the range values, i.e. <code>Sheets(\"Sheet1\").Range(\"A:A\").Find(...</code> </p>\n"}], "owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 603, "favorite_count": 0, "accepted_answer_id": 47679738, "answer_count": 2, "score": 1, "last_activity_date": 1512580665, "creation_date": 1512577379, "question_id": 47678956, "link": "https://stackoverflow.com/questions/47678956/search-a-dynamic-number-of-rows-in-column-a-for-a-specific-string-in-vba", "title": "Search a Dynamic Number of rows in Column A for a specific string in VBA", "body": "<p>I have a worksheet that contains a varying amount of Rows of data in Column A , within this worksheet I need to search for a specific string then copy the data contained in the Cell adjacent to it and paste into Column C, i.e if data was found in A2 then i need to copy the data from B2 and paste into C1. I can easily find and copy when the string appears once but the string will appear more than once 100% of time. here is when i run into issues. </p>\n\n<p>The temporary code I have written for ease of understanding, searches the spreadsheet for the last Mention of A, get the row number, copy the B cell for that row number then pastes the value into C1. </p>\n\n<p>I guess you need to use range variables for this but not 100% sure how to do it. </p>\n\n<p>i have found no way to copy all mentions of A into a column, or ideally sum up the contents of the B cells. (I can do this, just long winded)</p>\n\n<p>Ive placed my code below. </p>\n\n<pre><code>Sub ValueFinder()\nDim LastALocation As String\nDim ValueContent As String\n\nLastALocation = Range(\"A:A\").Find(What:=\"A\", after:=Range(\"A1\"), searchdirection:=xlPrevious).Row\nValueContent = Cells(LastALocation, 2)\nCells(1, 3) = ValueContent\n\n\nEnd Sub\n</code></pre>\n\n<p>The spreadsheet that its using for more information, contains A,B,C on a loop in Column A and the odd numbers in Column B. </p>\n\n<p>Thanks for any help your able to provide. </p>\n\n<p>Mark  </p>\n"}, {"tags": ["python", "vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1512577468, "post_id": 47678775, "comment_id": 82317041, "body": "make sure that <code>March</code> is indeed on <code>Macro</code> sheet in cell <code>G10</code>. Or, try wrapping <code>sheet[&#39;G10&#39;].value</code> in python <code>str</code>?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1512577705, "post_id": 47678775, "comment_id": 82317209, "body": "Are there any leading/trailing spaces in <code>G10</code>?"}, {"owner": {"reputation": 27, "user_id": 5893513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ea90cf394ba3b8fbf6acd220190fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Satwant", "link": "https://stackoverflow.com/users/5893513/satwant"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1512579356, "post_id": 47678775, "comment_id": 82318256, "body": "@BruceWayne what are those ? I&#39;m sorry i&#39;m new at this."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1512580002, "post_id": 47678775, "comment_id": 82318659, "body": "Meaning, make sure your cell is literally <code>March</code> or whatever month, and not say `    March`  or <code>March     </code> (there are spaces either before or after &quot;March&quot; which can throw off the matching in Python)."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1512580090, "post_id": 47678775, "comment_id": 82318729, "body": "This could be an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>.  Why are you trying to call a python script from VBA? Why not just do everything you need with VBA or Python?"}, {"owner": {"reputation": 27, "user_id": 5893513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ea90cf394ba3b8fbf6acd220190fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Satwant", "link": "https://stackoverflow.com/users/5893513/satwant"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1512580466, "post_id": 47678775, "comment_id": 82318977, "body": "@BruceWayne It&#39;s the way it was written. I am just taking over somebody.The person who wrote this code quit. I think it&#39;s because we use Google Analytics."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5893513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ea90cf394ba3b8fbf6acd220190fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Satwant", "link": "https://stackoverflow.com/users/5893513/satwant"}, "edited": false, "score": 0, "creation_date": 1512577474, "post_id": 47678906, "comment_id": 82317049, "body": "I do get March when i run the code.What should i do now ?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 27, "user_id": 5893513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ea90cf394ba3b8fbf6acd220190fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Satwant", "link": "https://stackoverflow.com/users/5893513/satwant"}, "edited": false, "score": 0, "creation_date": 1512577575, "post_id": 47678906, "comment_id": 82317124, "body": "@Satwant - save the excel file as <code>xlsx</code> and give it a try again. <b>Saving as <code>xlsx</code> would delete the code, thus make sure to make a copy!</b>"}, {"owner": {"reputation": 27, "user_id": 5893513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ea90cf394ba3b8fbf6acd220190fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Satwant", "link": "https://stackoverflow.com/users/5893513/satwant"}, "edited": false, "score": 0, "creation_date": 1512578884, "post_id": 47678906, "comment_id": 82317945, "body": "I did save it as xlsx but since it deleted the code the macro did not run. So i just changed the month to something other than January and ran the python script manually but it made no difference."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 27, "user_id": 5893513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ea90cf394ba3b8fbf6acd220190fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Satwant", "link": "https://stackoverflow.com/users/5893513/satwant"}, "edited": false, "score": 0, "creation_date": 1512579030, "post_id": 47678906, "comment_id": 82318043, "body": "@Satwant - yes, the <code>xlsx</code> deletes the code in the worksheet. I though that you run the code from Python?"}, {"owner": {"reputation": 27, "user_id": 5893513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ea90cf394ba3b8fbf6acd220190fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Satwant", "link": "https://stackoverflow.com/users/5893513/satwant"}, "edited": false, "score": 0, "creation_date": 1512579221, "post_id": 47678906, "comment_id": 82318171, "body": "No i run it from VBA. My VBA calls the python script."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1512577481, "last_edit_date": 1512577481, "creation_date": 1512577192, "answer_id": 47678906, "question_id": 47678775, "link": "https://stackoverflow.com/questions/47678775/python-script-not-picking-up-the-correct-date-selected-in-the-excel-macro/47678906#47678906", "title": "Python script not picking up the correct date selected in the excel Macro", "body": "<p>Run this code in the Excel spreadsheet:</p>\n\n<pre><code>Sub TestMe()\n    MsgBox Worksheets(\"Macro\").Range(\"G10\")\nEnd Sub\n</code></pre>\n\n<p>If you do not get \"March\", then you are most probably not referencing to <code>G10</code> but to something else.\nFurthermore, you are openning the excel file through <code>Python</code> with enabled VBA. Are you sure, that whenever you open it, it does not reset back to <code>January</code>? This is called <code>Event()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 5893513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ea90cf394ba3b8fbf6acd220190fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Satwant", "link": "https://stackoverflow.com/users/5893513/satwant"}, "edited": false, "score": 0, "creation_date": 1512592542, "post_id": 47682586, "comment_id": 82325350, "body": "Thank you for taking the time to look at my problem but the solution is a bit embarrassing but i&#39;ll post it.All i had to do was whenever i change the month in macro, i need to save the .xlsm and then run it. I know it&#39;s very stupid on my part."}, {"owner": {"reputation": 482, "user_id": 4962106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9d8e7d9811144e13db1817c6a3515daf?s=128&d=identicon&r=PG&f=1", "display_name": "rvictordelta", "link": "https://stackoverflow.com/users/4962106/rvictordelta"}, "reply_to_user": {"reputation": 27, "user_id": 5893513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ea90cf394ba3b8fbf6acd220190fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Satwant", "link": "https://stackoverflow.com/users/5893513/satwant"}, "edited": false, "score": 0, "creation_date": 1512593554, "post_id": 47682586, "comment_id": 82325906, "body": "Yes, my second suggestion!  You wouldn&#39;t have the save the sheet each time if you pass the python function the month and date as arguments instead."}], "tags": [], "owner": {"reputation": 482, "user_id": 4962106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9d8e7d9811144e13db1817c6a3515daf?s=128&d=identicon&r=PG&f=1", "display_name": "rvictordelta", "link": "https://stackoverflow.com/users/4962106/rvictordelta"}, "is_accepted": false, "score": 0, "last_activity_date": 1512590618, "creation_date": 1512590618, "answer_id": 47682586, "question_id": 47678775, "link": "https://stackoverflow.com/questions/47678775/python-script-not-picking-up-the-correct-date-selected-in-the-excel-macro/47682586#47682586", "title": "Python script not picking up the correct date selected in the excel Macro", "body": "<p>It looks it's a caching / stale data issue.  If I am understanding you correctly, you run a VBA macro inside your workbook that calls a python script that then looks at a cell inside that same workbook?  Not an ideal structure!</p>\n\n<p>When your python script calls the Excel sheet, here:</p>\n\n<pre><code>wb = openpyxl.load_workbook(pathOfMonthlyReportFile, keep_vba=True)\n</code></pre>\n\n<p>I think it's looking at the value of G10 when you last saved the file.  Perhaps the month was January on the last save?</p>\n\n<p>I would either:</p>\n\n<ol>\n<li><p>Restructure your python function so that it takes month and date arguments and pass those values when you call the function from VBA</p></li>\n<li><p>Try having VBA save your sheet just before VBA calls the python script, thus preserving any changes made to the month and date dropdown.</p></li>\n</ol>\n\n<p>Note that 1. is much more robust and professional than 2., but may be slightly more complicated to implement.  </p>\n"}], "owner": {"reputation": 27, "user_id": 5893513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ea90cf394ba3b8fbf6acd220190fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Satwant", "link": "https://stackoverflow.com/users/5893513/satwant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1512590618, "creation_date": 1512576783, "last_edit_date": 1512587407, "question_id": 47678775, "link": "https://stackoverflow.com/questions/47678775/python-script-not-picking-up-the-correct-date-selected-in-the-excel-macro", "title": "Python script not picking up the correct date selected in the excel Macro", "body": "<p>I am trying to run a macro in excel that generates monthly reports.The macro calls the python script without any problems. However no matter the month i choose in the macro the python script always runs for January.</p>\n\n<p>This is where i select the month:\n<img src=\"https://i.stack.imgur.com/WWykL.jpg\" alt=\"This is where i select the month.\"></p>\n\n<p>When the python script runs it is always January:\n<img src=\"https://i.stack.imgur.com/27wYo.jpg\" alt=\"When the python script runs it is always January.\"></p>\n\n<p>Here is the code in python script.</p>\n\n<pre><code>#Read the month and year selected in the Monthly Report\npathOfMonthlyReportFile = os.sep.join((os.path.expanduser(\"~\"), \n'Desktop'))+'\\Monthly Activity Report - Template.xlsm'\nwb = openpyxl.load_workbook(pathOfMonthlyReportFile, keep_vba=True)\nsheet = wb.get_sheet_by_name('Macro')\nMonthOfMonthlyReport = sheet['G10'].value\nYearOfMonthlyReport = sheet['J10'].value\nprint(MonthOfMonthlyReport)\n\nif MonthOfMonthlyReport == \"January\":\n MonthNumber = 1\nelif MonthOfMonthlyReport == \"February\":\n MonthNumber = 2\nelif MonthOfMonthlyReport == \"March\":\n MonthNumber = 3\nelif MonthOfMonthlyReport == \"April\":\n MonthNumber = 4\nelif MonthOfMonthlyReport == \"May\":\n MonthNumber = 5\nelif MonthOfMonthlyReport == \"June\":\n MonthNumber = 6\nelif MonthOfMonthlyReport == \"July\":\n MonthNumber = 7\nelif MonthOfMonthlyReport == \"August\":\n MonthNumber = 8\nelif MonthOfMonthlyReport == \"September\":\n MonthNumber = 9\nelif MonthOfMonthlyReport == \"October\":\n MonthNumber = 10\nelif MonthOfMonthlyReport == \"November\":\n MonthNumber = 11\nelif MonthOfMonthlyReport == \"December\":\n MonthNumber = 12\n\nMonthlyReportDate = \nnow.replace(month=MonthNumber,year=int(YearOfMonthlyReport))\nif MonthNumber == 12:\nlast_day_of_month = MonthlyReportDate.replace(day = 31, month=MonthNumber, \nyear=int(YearOfMonthlyReport))\nelse:\nlast_day_of_month = MonthlyReportDate.replace(day=1, month=MonthNumber+1, \nyear=int(YearOfMonthlyReport)) - datetime.timedelta(days=1)\n\nif MonthNumber &gt;= 10:\n    stringenddate = \"%s-%s-%s\" % (MonthlyReportDate.year, \nMonthlyReportDate.month,last_day_of_month.day)\n    stringstartdate = \"%s-%s-01\" % (MonthlyReportDate.year, \nMonthlyReportDate.month)\nelse:\n    stringenddate = \"%s-0%s-%s\" % (MonthlyReportDate.year, \nMonthlyReportDate.month,last_day_of_month.day)\n    stringstartdate = \"%s-0%s-01\" % (MonthlyReportDate.year, \nMonthlyReportDate.month)\n\nprint(stringenddate)\n\nMonthRange = [1,2,3,4,5,6,7,8,9,10,11,12]\nThreeMonthsAgo = 0\n\nfor i in range(len(MonthRange)):\n   if MonthRange[i] == MonthNumber:\n    ThreeMonthsAgo = MonthRange[i-2] #**************\nprint(ThreeMonthsAgo)\n\nif ThreeMonthsAgo&lt;MonthNumber:\nif ThreeMonthsAgo &gt;=10:\n    stringthreemonthsagodate = \"%s-%s-01\"%(MonthlyReportDate.year, \nThreeMonthsAgo)\nelse:\n    stringthreemonthsagodate = \"%s-0%s-01\"%(MonthlyReportDate.year, \nThreeMonthsAgo)\n\nif ThreeMonthsAgo &gt; MonthNumber:\nif ThreeMonthsAgo &gt;=10:\n    stringthreemonthsagodate = \"%s-%s-01\"%(MonthlyReportDate.year - 1, \nThreeMonthsAgo)\nelse:\n    stringthreemonthsagodate = \"%s-0%s-01\"%(MonthlyReportDate.year - 1, \nThreeMonthsAgo)\n\ndate_ranges = [(stringstartdate,\n                stringenddate)]\ndata_ranges_for_three_months = [(stringthreemonthsagodate, stringenddate)]\n</code></pre>\n\n<p>It should run for the selected month but it runs only for the month of January.\nI don't really get an error message but it is just not the right month.</p>\n\n<hr>\n\n<p>It's been fixed. The solution is a bit embarrassing but i'll post it.All i had to do was whenever i change the month in macro, i need to save the .xlsm and then run it.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1512575525, "post_id": 47678279, "comment_id": 82315711, "body": "You need to create a inner loop that move 4 sheets or create a single instruction to move 4 sheets."}, {"owner": {"reputation": 331, "user_id": 7963473, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3fd1e96bc3defa52696fd50fad2fdc27?s=128&d=identicon&r=PG&f=1", "display_name": "Smith Stanley", "link": "https://stackoverflow.com/users/7963473/smith-stanley"}, "edited": false, "score": 0, "creation_date": 1512575581, "post_id": 47678279, "comment_id": 82315743, "body": "@DavidG. - I obviously do not have a firm a grasp on this concept as I thought I did then."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1512575760, "post_id": 47678279, "comment_id": 82315869, "body": "What is the instruction you are using that creates 1 workbook for each worksheet?"}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 1, "last_activity_date": 1512576472, "creation_date": 1512576472, "answer_id": 47678684, "question_id": 47678279, "link": "https://stackoverflow.com/questions/47678279/excel-vba-to-split-workbook-every-4-worksheets/47678684#47678684", "title": "Excel VBA To Split Workbook Every 4 Worksheets", "body": "<pre><code>Sub SplitPages()\n   Dim i As Integer\n\n   Dim wb As Workbook\n\n   For i = 1 To ThisWorkbook.Worksheets.Count\n        If i Mod 4 = 1 Then\n           Set wb = Workbooks.Add\n        End If\n       ThisWorkbook.Worksheets(i).Copy wb.Worksheets(1)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>You have to copy to avoid messing up the count, and the new workbooks have an extra sheet - but a quick </p>\n\n<pre><code>  for each wb in workbooks:wb.sheets(\"sheet1\").delete:next wb\n</code></pre>\n\n<p>will fix that</p>\n"}], "owner": {"reputation": 331, "user_id": 7963473, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3fd1e96bc3defa52696fd50fad2fdc27?s=128&d=identicon&r=PG&f=1", "display_name": "Smith Stanley", "link": "https://stackoverflow.com/users/7963473/smith-stanley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 47678684, "answer_count": 1, "score": 0, "last_activity_date": 1512576472, "creation_date": 1512575281, "last_edit_date": 1512575292, "question_id": 47678279, "link": "https://stackoverflow.com/questions/47678279/excel-vba-to-split-workbook-every-4-worksheets", "title": "Excel VBA To Split Workbook Every 4 Worksheets", "body": "<p>I have a workbook that contains about 100 worksheets.  I want to create 25 individual workbooks that contain 4 sheets each.  I am trying to write an Excel VBA <code>foor loop</code> that will do such - but it is generating a workbook for every 1 page.</p>\n\n<pre><code>totalPages = PDDoc.GetNumPages\n\nFor i = 1 To totalPages - 4 \n    'This is where you would add the workbook and transfer the page\nNext i\n</code></pre>\n"}, {"tags": ["excel", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1512575717, "post_id": 47678133, "comment_id": 82315833, "body": "Well this looks like it should work,... If you come across any specific issues then let us know... I would change the way you calculate your Max to something like Max = wsWtB.Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row"}, {"owner": {"reputation": 7, "user_id": 8375828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5efaace6c9086d706ad4561f5fb50e?s=128&d=identicon&r=PG&f=1", "display_name": "koen van tiel", "link": "https://stackoverflow.com/users/8375828/koen-van-tiel"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1512636283, "post_id": 47678133, "comment_id": 82340746, "body": "Hey, the End(xlup) also find the cells with formulas. I opted using range.find(find &quot;*&quot; &amp; xlvalues) but the users are forced to use successive numbers in this sheet (there is a lot of COUNTA() and MAX(A) to make sure they do. Its making the code run whenever someone enters 120 or more in column G that&#39;s giving me a headache. EDIT; there was actually a random formula at the last row :P"}, {"owner": {"reputation": 7, "user_id": 8375828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5efaace6c9086d706ad4561f5fb50e?s=128&d=identicon&r=PG&f=1", "display_name": "koen van tiel", "link": "https://stackoverflow.com/users/8375828/koen-van-tiel"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1512638629, "post_id": 47678133, "comment_id": 82342158, "body": "To late to edit; I&#39;ve added the other options to find the last row and why they didn&#39;t work. Maybe someone stumbles upon them and finds it useful.      I&#39;m going to try it with;  &quot;ws_change() &amp; Intersect(Target, Range())&quot; found on Extended office; <a href=\"https://www.extendoffice.com/documents/excel/4423-excel-run-macro-on-cell-change.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a> .  Was thinking to complicated i think."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8375828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5efaace6c9086d706ad4561f5fb50e?s=128&d=identicon&r=PG&f=1", "display_name": "koen van tiel", "link": "https://stackoverflow.com/users/8375828/koen-van-tiel"}, "edited": false, "score": 0, "creation_date": 1512640086, "post_id": 47678586, "comment_id": 82343104, "body": "I could give the first cell in the column a defined name or even the entire range could be named. But there&#39;s code that checks all named ranges and determines if it need to be copied to Word. So i try and use as little as possible. When they change the headers they are going to run into trouble indeed. I&#39;m adding Find.range() to find the last row and then count backwards from there; Last row - max = first cell after header. I&#39;ve made a Google sheets to make it more visual; <a href=\"https://docs.google.com/spreadsheets/d/1I5qLeOS0DWcwncs_ium_J0Vp6b4nzTsiE0ndbKtpsC0/edit?usp=sharing\" rel=\"nofollow noreferrer\">docs.google.com/spreadsheets/d/&hellip;</a> @Xabier rying now :)."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 7, "user_id": 8375828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5efaace6c9086d706ad4561f5fb50e?s=128&d=identicon&r=PG&f=1", "display_name": "koen van tiel", "link": "https://stackoverflow.com/users/8375828/koen-van-tiel"}, "edited": false, "score": 0, "creation_date": 1512640816, "post_id": 47678586, "comment_id": 82343627, "body": "@koenvantiel please have a look at my updated answer, I think it will do as you expect."}, {"owner": {"reputation": 7, "user_id": 8375828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5efaace6c9086d706ad4561f5fb50e?s=128&d=identicon&r=PG&f=1", "display_name": "koen van tiel", "link": "https://stackoverflow.com/users/8375828/koen-van-tiel"}, "edited": false, "score": 0, "creation_date": 1512641616, "post_id": 47678586, "comment_id": 82344196, "body": "@ Xabier It neatly adds the data at the next empty row, which is 1601 :P I can get this working. I&#39;m going to use the max value or range.find() instead of NextFreeRow if i can&#39;t find a way to have it only look at column B to E. Thanks a lot!!!"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 7, "user_id": 8375828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5efaace6c9086d706ad4561f5fb50e?s=128&d=identicon&r=PG&f=1", "display_name": "koen van tiel", "link": "https://stackoverflow.com/users/8375828/koen-van-tiel"}, "edited": false, "score": 0, "creation_date": 1512641769, "post_id": 47678586, "comment_id": 82344302, "body": "@koenvantiel please could you mark my response as an answer if it has helped you? Thanks."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1512640539, "last_edit_date": 1512640539, "creation_date": 1512576181, "answer_id": 47678586, "question_id": 47678133, "link": "https://stackoverflow.com/questions/47678133/vba-clear-and-copy-without-blank-rows-to-another-sheet-on-entering-value-greater/47678586#47678586", "title": "VBA Clear and Copy without blank rows to another sheet on entering value greater than", "body": "<p>You could use something like the following, but make sure you place the code in the Sheet where the values might be changing (Sheets(\"WTB\")):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Column = 7 Then 'If something changed in column G\n        If Target.Value &gt; 119 Then 'and if the value is higher than 119\n        NextFreeRow = Sheets(\"J_03\").Cells(.Rows.Count, \"B\").End(xlUp).Row + 1\n        'Or Do your copying stuff, you can use Target.column or Target.row to find the address of the cell that got a value higher than 119\n            Sheets(\"J_03\").Cells(NextFreeRow, \"B\").Value = Chr(39) &amp; Sheets(\"WTB\").Cells(Target.Row, \"B\").Value 'At a  '\n            Sheets(\"J_03\").Cells(NextFreeRow, \"C\").Value = Chr(39) &amp; Sheets(\"WTB\").Cells(Target.Row, \"C\").Value 'at the start\n            Sheets(\"J_03\").Cells(NextFreeRow, \"D\").Value = Chr(39) &amp; Sheets(\"WTB\").Cells(Target.Row, \"D\").Value 'so a zero is\n            Sheets(\"J_03\").Cells(NextFreeRow, \"E\").Value = Chr(39) &amp; Sheets(\"WTB\").Cells(Target.Row, \"E\").Value 'displayed\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 8375828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5efaace6c9086d706ad4561f5fb50e?s=128&d=identicon&r=PG&f=1", "display_name": "koen van tiel", "link": "https://stackoverflow.com/users/8375828/koen-van-tiel"}, "is_accepted": false, "score": 0, "last_activity_date": 1517551915, "last_edit_date": 1517551915, "creation_date": 1517551572, "answer_id": 48576622, "question_id": 47678133, "link": "https://stackoverflow.com/questions/47678133/vba-clear-and-copy-without-blank-rows-to-another-sheet-on-entering-value-greater/48576622#48576622", "title": "VBA Clear and Copy without blank rows to another sheet on entering value greater than", "body": "<p>2 months later, thought i'd show my final work;</p>\n\n<p>The Union() functions lets you (or me in this case), improve the speed of the sheets:</p>\n\n<pre><code>For i = 1 to LastRow\n  If Ws1.Cells(i, 1).Value &gt; 119 Then\n    Union(Ws2.Cells(i, 4), Ws2.Cells(i, 5), Ws2.Cells(i, 6)).Value = \n    Union(Ws1.Cells(y, 1), Ws1.Cells(y, 2), Ws1.Cells(y, 3)).Value: y = y + 1\n  end if\nNext\n</code></pre>\n\n<p>It's about 30% faster then using    cel1, 2, 3.value = cel5, 6, 7.value    when it's simply copying all rows without the If.  </p>\n\n<p>When my workbook needs to fill 50 sheets like this and has 25 rows of data it took 4,5 seconds on average, with the Union() it's 1,6.  When there are 1000 rows its goes from ~23 to 9 seconds but the variations is very high. Depending on the If's;</p>\n\n<p>For some sheets it's not \"If > 119 then\";</p>\n\n<pre><code>If cellAL.Value = \"x\" Then     'if the cell exactly \"x\" Then do stuf\nIf Not cellAL.Value &lt;&gt; vbNullString Then   'if the cell = NotEmpty \n                                            vbNullString \n                  is faster then \"\" because it's actually less ones and zeros\nIf InStr(cellAll, \"x\") Then     'looks for all x's in the cell.\n</code></pre>\n\n<p>To find the last row without beein affected by format, formulas and other stuff;</p>\n\n<pre><code>myLastRow = .Columns(\"A\").Find(What:=\"*\", LookIn:=xlValues, _\n             SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row\n\n\"*\" 'is something like \"any/all characters\". A Space or Alt + Enter can make \n                                             a big mess\n</code></pre>\n\n<p>try the direct window to see what it does:</p>\n\n<pre><code>?activesheet.Columns(\"A\").Find(What:=\"*\", LookIn:=xlValues, _ \n                               SearchDirection:=xlPrevious).Row\n</code></pre>\n\n<p>Ps for my CanaDerp buddy; Hope you can get it working with this!</p>\n"}], "owner": {"reputation": 7, "user_id": 8375828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5efaace6c9086d706ad4561f5fb50e?s=128&d=identicon&r=PG&f=1", "display_name": "koen van tiel", "link": "https://stackoverflow.com/users/8375828/koen-van-tiel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "accepted_answer_id": 47678586, "answer_count": 2, "score": 0, "last_activity_date": 1517551915, "creation_date": 1512574913, "last_edit_date": 1531164843, "question_id": 47678133, "link": "https://stackoverflow.com/questions/47678133/vba-clear-and-copy-without-blank-rows-to-another-sheet-on-entering-value-greater", "title": "VBA Clear and Copy without blank rows to another sheet on entering value greater than", "body": "<p>My 2010 macro updates on opening a sheet. Does 2016 work the same when when they have the target sheet opened in a new 'instance'? It has to be idiot proof (I don't know why they asked me to do it :P). So the macro has to run once when opening the sheet; if the sheet is opened on the second monitor run every time a value is inserted over 119 in the source sheet; Don't run unnecessary because of the potentially very large sheets and meh laptops.       </p>\n\n<p>I've made this macro so the sheets my colleges are using don't need 'complex' formulas or macros to clear blank rows before it's exported to Word. I've made it in 2010, but I can't test it on 2016 til next week.     </p>\n\n<p>The macro that on the target sheet (J03);</p>\n\n<pre><code>Private Sub worksheet_activate()\n</code></pre>\n\n<p>And on the source sheet (WTB); </p>\n\n<pre><code> Private Sub Run_When_Value_Greather_Than_119_Is_Entered_In_Column_G()\n</code></pre>\n\n<p>Google is clogged with answers and results about blank rows, copying, blank rows, running on other activation ways and non blank rows. I probably don't know what to look for either.     </p>\n\n<p>The full code;</p>\n\n<pre><code>Private Sub worksheet_activate()\n  Dim Max As Long, MaxD As Long       'Determine the amount of filled rows\n  Dim wsWtB As Worksheet, wsJ03 As Worksheet\n  Dim wb As Workbook\n  Dim i As Integer, j As Integer      'i and j for the row numbers\n\n  Application.ScreenUpdating = False  'screenupdating of for max speeds\n\n  Set wb = ThisWorkbook\n  Set wsJ03 = Sheets(\"J_03\")\n  Set wsWtB = Sheets(\"WTB\")\n\n  Max = WorksheetFunction.Max(wsWtB.Range(\"A3:A1600\"))  'Amount of rows with data\n  Max = Max + 3                                         'Ignore the headers\n  MaxD = WorksheetFunction.Max(wsJ03.Range(\"A3:A1600\"))\n  MaxD = MaxD + 2\n  j = 9                   'The rownumber where the copying needs to start\n    wsJ03.Range(\"B9\", Cells(MaxD, 5)).ClearContents  'Clear the old values\n      For i = 3 To Max    'The copying loop has to start after the headers at row 3\n        If wsWtB.Cells(i, 7).Value &gt; 119 Then   'Do stuff if...\n          wsJ03.Cells(j, \"B\").Value = Chr(39) &amp; wsWtB.Cells(i, \"B\").Value 'At a  '\n          wsJ03.Cells(j, \"C\").Value = Chr(39) &amp; wsWtB.Cells(i, \"C\").Value 'at the start\n          wsJ03.Cells(j, \"D\").Value = Chr(39) &amp; wsWtB.Cells(i, \"D\").Value 'so a zero is\n          wsJ03.Cells(j, \"E\").Value = Chr(39) &amp; wsWtB.Cells(i, \"E\").Value 'displayed\n          j = j + 1       'Set the next row for the target sheet\n        Else\n      End If\n    Next i\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>It's the first piece of code that I got working without hiccups :-) Feel free to comment and ad the propper tags.</p>\n\n<p>Koen. </p>\n\n<p>Edit; (Alternative ways to look for the last cell)</p>\n\n<pre><code>?thisworkbook.sheets(\"WTB\").cells(rows.Count,\"A\").end(xlup).row\n  1047 '&lt;- Rownumber of the last cell with a Formula to create/force \n        successive \n        numbers\n?thisworkbook.sheets(\"WTB\").columns(\"A\").Find(What:=\"*\", LookIn:=xlValues, \n SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row\n  5    '&lt;- Rownumber of the last cell with a value. Includes the header \n        rows\n?WorksheetFunction.Max(thisworkbook.sheets(\"WTB\").Range(\"A3:A1600\"))\n  3    '&lt;- Highest number in A3:A1600 and also the amount units/rows that \n        need to be copied to \"J_03\"\n</code></pre>\n\n<p>I needed a function that gave me the amount of 'things' on the sheet. In this case it's 3, but it could go up to 1600. </p>\n\n<p>Edit 2; (google sheet so you can see what i'm working on)\n<a href=\"https://docs.google.com/spreadsheets/d/1I5qLeOS0DWcwncs_ium_J0Vp6b4nzTsiE0ndbKtpsC0/edit?usp=sharing\" rel=\"nofollow noreferrer\">https://docs.google.com/spreadsheets/d/1I5qLeOS0DWcwncs_ium_J0Vp6b4nzTsiE0ndbKtpsC0/edit?usp=sharing</a></p>\n\n<p>Edit 3; there was an error in the clear range part.\n wsJ03.Range(\"B9\", <strong>Cells(MaxD, 5))</strong>.ClearContents  'Clear the old values</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "is_accepted": true, "score": 1, "last_activity_date": 1512575662, "creation_date": 1512575662, "answer_id": 47678406, "question_id": 47678119, "link": "https://stackoverflow.com/questions/47678119/finding-an-existing-file-with-access-vba/47678406#47678406", "title": "Finding an existing file with access vba", "body": "<p>I would get rid of the FileExistsbol variable and then just do something like:</p>\n\n<pre><code>If Dir(stFileName) &lt;&gt; \"\" Then\n    Kill stFileName\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 47678406, "answer_count": 1, "score": 0, "last_activity_date": 1512575662, "creation_date": 1512574879, "question_id": 47678119, "link": "https://stackoverflow.com/questions/47678119/finding-an-existing-file-with-access-vba", "title": "Finding an existing file with access vba", "body": "<p>I am trying to find an existing file in a folder location</p>\n\n<p><strong>Current Code:</strong></p>\n\n<pre><code>Dim FileExistsbol As Boolean\nDim stFileName As String\nstFileName = \"H:\\Test File.txt\"\nstFileName = Trim(stFileName)\nFileExistsbol = dir(stFileName) &lt;&gt; vbNullString\nIf FileExistsbol Then Kill stFileName\n</code></pre>\n\n<p><strong>Error:</strong></p>\n\n<p>The error message is: Type Mismatch\nVBA debugs on this line:</p>\n\n<pre><code>FileExistsbol = dir(stFileName) &lt;&gt; vbNullString\n</code></pre>\n\n<p>The file does exist so unsure how to resolve this - Any ideas? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1512577085, "post_id": 47678027, "comment_id": 82316815, "body": "Looks like you have one too many closing brackets near the end - it should be: <code>&quot;[Modules],0))),&quot;&quot;Did not exist previously&quot;&quot;)&quot;</code> and not <code>&quot;[Modules],0)))),&quot;&quot;Did not exist previously&quot;&quot;)&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1512575379, "creation_date": 1512575379, "answer_id": 47678313, "question_id": 47678027, "link": "https://stackoverflow.com/questions/47678027/can-vba-attempt-to-assign-to-a-cell-a-formula-that-is-too-long/47678313#47678313", "title": "Can VBA attempt to assign to a cell a formula that is too long?", "body": "<p>The long formulas work in Excel VBA quite well. Take a look at this 24 nested <code>IF()</code>:</p>\n\n<pre><code>Sub TestMe()\n\n    Range(\"A1\").Formula = \"=IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,\" &amp; _\n            \"IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,\" &amp; _\n            \"IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,\" &amp; _\n            \"IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,\" &amp; _\n            \"IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,IF(1=1,\" &amp; _\n            \"IF(1=1,2))))))))))))))))))))))))))))))))))))))))))))))\"\n\nEnd Sub\n</code></pre>\n\n<p>It is translated really well into Excel. Thus, take a good look at your formula, the problem should be there.</p>\n"}], "owner": {"reputation": 147, "user_id": 8142622, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Ot5_dLJ2mg4/AAAAAAAAAAI/AAAAAAAAAZw/qRz2CgT3a6Q/photo.jpg?sz=128", "display_name": "Bogdan Ionic\u0103", "link": "https://stackoverflow.com/users/8142622/bogdan-ionic%c4%83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 47678313, "answer_count": 1, "score": 0, "last_activity_date": 1512575379, "creation_date": 1512574622, "question_id": 47678027, "link": "https://stackoverflow.com/questions/47678027/can-vba-attempt-to-assign-to-a-cell-a-formula-that-is-too-long", "title": "Can VBA attempt to assign to a cell a formula that is too long?", "body": "<p>I am on Windows, if that matters. This code seems to attempt to assign a formula that is too long:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"SegmentValues_1\").ListColumns(\"Change\").DataBodyRange.Formula = \"=IFERROR(IF(INDEX(SegmentValues_\" &amp; (ActiveWorkbook.Sheets.count - 2) &amp; \"[CODE_ZONE],MATCH([@Modules],SegmentValues_\" &amp; (ActiveWorkbook.Sheets.count - 2) &amp; \"[Modules],0))=0,\"\"Last total was ZERO\"\",([@CODE_ZONE]-INDEX(SegmentValues_\" &amp; (ActiveWorkbook.Sheets.count - 2) &amp; \"[CODE_ZONE],MATCH([@Modules],SegmentValues_\" &amp; (ActiveWorkbook.Sheets.count - 2) &amp; \"[Modules],0)))/INDEX(SegmentValues_\" &amp; (ActiveWorkbook.Sheets.count - 2) &amp; \"[CODE_ZONE],MATCH([@Modules],SegmentValues_\" &amp; (ActiveWorkbook.Sheets.count - 2) &amp; \"[Modules],0)))),\"\"Did not exist previously\"\")\"\n</code></pre>\n\n<p>Is such a thing possible? If so, how to solve it? </p>\n"}, {"tags": ["ms-access", "combobox", "vba", "reset", "default-value"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8606370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a097fd0f13eaeb634621b97e7bba0d36?s=128&d=identicon&r=PG&f=1", "display_name": "JSRambal", "link": "https://stackoverflow.com/users/8606370/jsrambal"}, "edited": false, "score": 0, "creation_date": 1594089511, "post_id": 47679452, "comment_id": 110996986, "body": "Sorry never thanked you for your help. Much appreciated!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1512578935, "creation_date": 1512578935, "answer_id": 47679452, "question_id": 47678022, "link": "https://stackoverflow.com/questions/47678022/microsoft-access-2016-resetting-default-value-of-combo-box-that-uses-equation/47679452#47679452", "title": "Microsoft Access 2016: Resetting Default Value of Combo Box (that uses equation) with Button?", "body": "<p>The behavior is expected, since <code>ctl.DefaultValue</code> returns the string default value property, not the actual calculated default value.</p>\n\n<p>A possible approach is to use <code>Eval</code> to calculate the actual default value. Note, however, that numerous problems can arise when doing this, since the default value is not VBA, but an Access expression, so it has a different scope, and is sensitive to locale settings such as the list separator setting.</p>\n\n<p>You can use the following line:</p>\n\n<pre><code>ctl.Value = Eval(Right(ctl.DefaultValue, Len(ctl.DefaultValue) -1))\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8606370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a097fd0f13eaeb634621b97e7bba0d36?s=128&d=identicon&r=PG&f=1", "display_name": "JSRambal", "link": "https://stackoverflow.com/users/8606370/jsrambal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 775, "favorite_count": 0, "accepted_answer_id": 47679452, "answer_count": 1, "score": 1, "last_activity_date": 1512578935, "creation_date": 1512574609, "last_edit_date": 1512578409, "question_id": 47678022, "link": "https://stackoverflow.com/questions/47678022/microsoft-access-2016-resetting-default-value-of-combo-box-that-uses-equation", "title": "Microsoft Access 2016: Resetting Default Value of Combo Box (that uses equation) with Button?", "body": "<p>I have the following code on the Reset button:</p>\n\n<pre><code>Private Sub cmdReset_Click()\n    Dim ctl As Control\n\n    For Each ctl In Me.Controls\n\n        Select Case ctl.ControlType\n            Case acComboBox\n                ctl.Value = ctl.DefaultValue\n        End Select\n    Next\n    Me.Requery\nEnd Sub\n</code></pre>\n\n<p>This is what my Default Value for the combo boxes look like:</p>\n\n<pre><code>=DLookUp(\"FieldName\",\"TableName\",\"strCriteria\")\n</code></pre>\n\n<p>When I click the Reset button the combo box just displays the equation as a string <code>=DLookUp(\"FieldName\",\"TableName\",\"strCriteria\")</code> instead of actually running the function. I tried using a different Default Value <code>=[cboName].[ItemData](#)</code> and it's the same issue. The Form works perfectly otherwise.</p>\n\n<p>I appreciate your help.</p>\n"}, {"tags": ["c#", "excel", "vba", "oledb", "oledbconnection"], "answers": [{"comments": [{"owner": {"reputation": 339, "user_id": 1477360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29abed045f0478683b2fe33201717a11?s=128&d=identicon&r=PG&f=1", "display_name": "Nkole Evans", "link": "https://stackoverflow.com/users/1477360/nkole-evans"}, "edited": false, "score": 0, "creation_date": 1512573415, "post_id": 47677514, "comment_id": 82314253, "body": "Plus 1 for using EPPlus. Using Oledb requires installation of drivers on 64-bit client computers and and the behavior is very unpredictable and error prone."}, {"owner": {"reputation": 69, "user_id": 7442264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a2b72c5d4bb0a3802832d799a9a06acd?s=128&d=identicon&r=PG&f=1", "display_name": "Str8UpRippin", "link": "https://stackoverflow.com/users/7442264/str8uprippin"}, "edited": false, "score": 0, "creation_date": 1512575180, "post_id": 47677514, "comment_id": 82315488, "body": "After removing IMEX=1, the error still persists, and for using EPPlus I have never used it before, can you recommend where to start? I have installed EPPlus through NuGet Manager"}, {"owner": {"reputation": 46070, "user_id": 1410664, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/vGygm.gif?s=128&g=1", "display_name": "Caius Jard", "link": "https://stackoverflow.com/users/1410664/caius-jard"}, "edited": false, "score": 0, "creation_date": 1512579329, "post_id": 47677514, "comment_id": 82318239, "body": "Something like this would be a good starting point: <a href=\"https://github.com/JanKallman/EPPlus/wiki/Getting-Started\" rel=\"nofollow noreferrer\">github.com/JanKallman/EPPlus/wiki/Getting-Started</a> (it&#39;s the wiki/tutorial for eppluss, written by the author of epplus)"}, {"owner": {"reputation": 69, "user_id": 7442264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a2b72c5d4bb0a3802832d799a9a06acd?s=128&d=identicon&r=PG&f=1", "display_name": "Str8UpRippin", "link": "https://stackoverflow.com/users/7442264/str8uprippin"}, "edited": false, "score": 0, "creation_date": 1512591841, "post_id": 47677514, "comment_id": 82324961, "body": "I think I found the issue, I was able to insert data using epplus, but when I was looking at the original issue, I believe the issue arises because I am reading data from the Excel file to do certain tasks, then once completed write back to that excel file. I think the error occurs because  the Excel file is still open or being read from and can&#39;t be updated or inserted into while that happens. Would you know of a work around?"}, {"owner": {"reputation": 46070, "user_id": 1410664, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/vGygm.gif?s=128&g=1", "display_name": "Caius Jard", "link": "https://stackoverflow.com/users/1410664/caius-jard"}, "edited": false, "score": 0, "creation_date": 1512601402, "post_id": 47677514, "comment_id": 82329470, "body": "Doesn&#39;t seem logical if you used the access driver to do both readi and writing, and didn&#39;t have multiple connections open to it.. you&#39;re free to do as you wish with your code, but access driver is a shortcut to headaches"}], "tags": [], "owner": {"reputation": 46070, "user_id": 1410664, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/vGygm.gif?s=128&g=1", "display_name": "Caius Jard", "link": "https://stackoverflow.com/users/1410664/caius-jard"}, "is_accepted": true, "score": 4, "last_activity_date": 1512573042, "creation_date": 1512573042, "answer_id": 47677514, "question_id": 47677372, "link": "https://stackoverflow.com/questions/47677372/excel-insert-query-throws-error-message-operation-must-use-an-updateable-query/47677514#47677514", "title": "Excel: Insert query throws error message &quot;Operation must use an updateable query&quot;", "body": "<p>Remove the IMEX=1 from the connectionstring. Also make sure the file is not readonly and not currently open in Excel</p>\n\n<p>For what it's worth, I recommend reading and writing the xlsx file with something like the EPPlus library, rather than the Access db driver</p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 7442264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a2b72c5d4bb0a3802832d799a9a06acd?s=128&d=identicon&r=PG&f=1", "display_name": "Str8UpRippin", "link": "https://stackoverflow.com/users/7442264/str8uprippin"}, "edited": false, "score": 0, "creation_date": 1512573769, "post_id": 47677526, "comment_id": 82314499, "body": "For the User, they have full Modify and Write permission and the error still occurs"}], "tags": [], "owner": {"reputation": 339, "user_id": 1477360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29abed045f0478683b2fe33201717a11?s=128&d=identicon&r=PG&f=1", "display_name": "Nkole Evans", "link": "https://stackoverflow.com/users/1477360/nkole-evans"}, "is_accepted": false, "score": 1, "last_activity_date": 1512573068, "creation_date": 1512573068, "answer_id": 47677526, "question_id": 47677372, "link": "https://stackoverflow.com/questions/47677372/excel-insert-query-throws-error-message-operation-must-use-an-updateable-query/47677526#47677526", "title": "Excel: Insert query throws error message &quot;Operation must use an updateable query&quot;", "body": "<p>This error occurs when an access database or excel document is stored in folder were you do not have write write access. You can read the file but you wont be able to make changes to it.</p>\n\n<p>Please ensure you have access to this folder or run your program as an administrator.</p>\n\n<p>You can confirm the write permissions on Windows by checking that you have access under the security tab on file properties.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JQ2l0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JQ2l0.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 69, "user_id": 7442264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a2b72c5d4bb0a3802832d799a9a06acd?s=128&d=identicon&r=PG&f=1", "display_name": "Str8UpRippin", "link": "https://stackoverflow.com/users/7442264/str8uprippin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1124, "favorite_count": 0, "accepted_answer_id": 47677514, "answer_count": 2, "score": 1, "last_activity_date": 1512588877, "creation_date": 1512572585, "last_edit_date": 1512588877, "question_id": 47677372, "link": "https://stackoverflow.com/questions/47677372/excel-insert-query-throws-error-message-operation-must-use-an-updateable-query", "title": "Excel: Insert query throws error message &quot;Operation must use an updateable query&quot;", "body": "<p>I am running into an error when trying to insert into an Excel worksheet</p>\n\n<p>This is the layout of my Excel worksheet named Sheet1:</p>\n\n<pre><code>     id    name\n     1     test \n     2     apple\n     3     pear \n</code></pre>\n\n<p>I want to insert this data into the Excel worksheet:</p>\n\n<pre><code>     4     pineapple\n</code></pre>\n\n<p>This is my code below:</p>\n\n<pre><code>try{\n            string srcExcel = \"C:\\\\Users\\\\Desktop\\\\insertTest.xlsx\";\n            System.Data.OleDb.OleDbConnection MyConnection;\n            System.Data.OleDb.OleDbCommand myCommand = new System.Data.OleDb.OleDbCommand();\n            string sql = null;\n            MyConnection = new OleDbConnection(\"Provider = Microsoft.ACE.OLEDB.12.0; Data Source = \" + srcExcel + \"; Extended Properties = 'Excel 8.0;HDR=Yes;IMEX=1'\");\n            MyConnection.Open();\n            myCommand.Connection = MyConnection;\n            sql = \"Insert Into [Sheet1$] (id,name) Values('4','pineapple')\";\n            myCommand.CommandText = sql;\n            myCommand.ExecuteNonQuery();\n            MessageBox.Show(\"Insert Success!\");\n            MyConnection.Close();\n}\n        catch (Exception eInnerData)\n        {\n            MessageBox.Show(\"Method: getInnerData \" + eInnerData.ToString());\n        }\n</code></pre>\n\n<p>After running this code an exception is thrown and caught with this error message: </p>\n\n<blockquote>\n  <p>Operation must use an updateable query</p>\n</blockquote>\n\n<p>I am using Microsoft Excel 2010  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1512572372, "post_id": 47677270, "comment_id": 82313474, "body": "Stack Overflow is not a teach me to code site.  If you have code that does not work then please post it in you original post using <a href=\"https://stackoverflow.com/posts/47677270/edit\">edit</a> and explain exactly where the error is occurring."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512573264, "post_id": 47677270, "comment_id": 82314164, "body": "If you are using Windows.  PowerShell may be a better fit to do this: <a href=\"https://blogs.technet.microsoft.com/heyscriptingguy/2008/01/17/hey-scripting-guy-how-can-i-use-windows-powershell-to-replace-characters-in-a-text-file/\" rel=\"nofollow noreferrer\">blogs.technet.microsoft.com/heyscriptingguy/2008/01/17/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8972033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/759b0cf42d8002a1614c93e33c4ed154?s=128&d=identicon&r=PG&f=1", "display_name": "chandrashekar", "link": "https://stackoverflow.com/users/8972033/chandrashekar"}, "edited": false, "score": 0, "creation_date": 1512616673, "post_id": 47678028, "comment_id": 82333647, "body": "Thanks a lot Xabier. it is working."}, {"owner": {"reputation": 1, "user_id": 8972033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/759b0cf42d8002a1614c93e33c4ed154?s=128&d=identicon&r=PG&f=1", "display_name": "chandrashekar", "link": "https://stackoverflow.com/users/8972033/chandrashekar"}, "edited": false, "score": 0, "creation_date": 1512616816, "post_id": 47678028, "comment_id": 82333677, "body": "If the data is in multiple lines in text file, how to arrange it in a single line. for ex:  &quot;Datastart 19A 56 1 0x1112 0x1314 0x1516 0x1718 0x1920 0x2122 0x2324 0x2526 0x2728 0x2930                    0x3132 0x3334 0x3536 0x3738 0x3940 0x4142 0x4344 0x4546 0x4748 0x4950                    0x5152 0x5354 0x5556 0x5758 0x5960 0x6162 0x6364 0x6566&quot;  . How we can arrange this text in single line."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 1, "user_id": 8972033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/759b0cf42d8002a1614c93e33c4ed154?s=128&d=identicon&r=PG&f=1", "display_name": "chandrashekar", "link": "https://stackoverflow.com/users/8972033/chandrashekar"}, "edited": false, "score": 0, "creation_date": 1512642300, "post_id": 47678028, "comment_id": 82344674, "body": "@chandrashekar I&#39;ve updated my answer to put all the lines into a single line.."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1512642261, "last_edit_date": 1512642261, "creation_date": 1512574625, "answer_id": 47678028, "question_id": 47677270, "link": "https://stackoverflow.com/questions/47677270/how-to-replace-comma-with-space-in-text-file-using-vba/47678028#47678028", "title": "How to replace comma with space in text file using VBA", "body": "<p>This should do the trick:</p>\n\n<pre><code>Sub foo()\nDim objFSO\nConst ForReading = 1\nConst ForWriting = 2\nDim objTS 'define a TextStream object\nDim strContents As String\nDim fileSpec As String\n\nfileSpec = \"C:\\Test.txt\" 'change the path to whatever yours ought to be\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objTS = objFSO.OpenTextFile(fileSpec, ForReading)\n\nDo While Not objTS.AtEndOfStream\n    strContents = strContents &amp; \" \" &amp; objTS.ReadLine 'Read line by line and store all lines in strContents\nLoop\n\nstrContents = Replace(strContents, \",\", \" \")\nobjTS.Close\n\nSet objTS = objFSO.OpenTextFile(fileSpec, ForWriting)\nobjTS.Write strContents\nobjTS.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8972033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/759b0cf42d8002a1614c93e33c4ed154?s=128&d=identicon&r=PG&f=1", "display_name": "chandrashekar", "link": "https://stackoverflow.com/users/8972033/chandrashekar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1354, "favorite_count": 0, "closed_date": 1512580973, "accepted_answer_id": 47678028, "answer_count": 1, "score": -5, "last_activity_date": 1512642261, "creation_date": 1512572274, "last_edit_date": 1531164843, "question_id": 47677270, "link": "https://stackoverflow.com/questions/47677270/how-to-replace-comma-with-space-in-text-file-using-vba", "closed_reason": "Needs more focus", "title": "How to replace comma with space in text file using VBA", "body": "<p>I have data in a text file (input.jpg). I want to replace the comma with the space and align the data in one line.Please see the output text file (output.jpg).</p>\n\n<p>how to do this in VBA. \nPlease help me.</p>\n\n<p>[input data]\n<img src=\"https://i.stack.imgur.com/TTHDb.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "copy-paste", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1512572360, "post_id": 47677258, "comment_id": 82313465, "body": "Did you already search at SO??? There are several questions in this site similar than yours."}, {"owner": {"reputation": 15, "user_id": 8818916, "user_type": "registered", "profile_image": "https://graph.facebook.com/1880323835627028/picture?type=large", "display_name": "KaBi", "link": "https://stackoverflow.com/users/8818916/kabi"}, "edited": false, "score": 0, "creation_date": 1512572696, "post_id": 47677258, "comment_id": 82313731, "body": "Yes, but adding Workbook(&quot;bla.xls&quot;).Worksheet(&quot;bla&quot;) - does not work :/ or I am doing a mistake. And I still don&#39;t know how to deal with pasting first copied row into 4th row in target sheet."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8818916, "user_type": "registered", "profile_image": "https://graph.facebook.com/1880323835627028/picture?type=large", "display_name": "KaBi", "link": "https://stackoverflow.com/users/8818916/kabi"}, "edited": false, "score": 0, "creation_date": 1512574797, "post_id": 47677760, "comment_id": 82315189, "body": "It looks GREAT but where should I specify that VALUES should be pasted because now it copies only formulas :)"}, {"owner": {"reputation": 15, "user_id": 8818916, "user_type": "registered", "profile_image": "https://graph.facebook.com/1880323835627028/picture?type=large", "display_name": "KaBi", "link": "https://stackoverflow.com/users/8818916/kabi"}, "edited": false, "score": 0, "creation_date": 1512645932, "post_id": 47677760, "comment_id": 82347164, "body": "As I&#39;ve implement pastValues I can see that this code copies B column from source into all mentioned InStr columns :/ and not next mentioned column. Sorry for being such a nuisance."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1512575431, "last_edit_date": 1512575431, "creation_date": 1512573775, "answer_id": 47677760, "question_id": 47677258, "link": "https://stackoverflow.com/questions/47677258/how-to-copy-paste-selected-columns-from-one-xls-to-another/47677760#47677760", "title": "How to copy/paste selected columns from one xls to another", "body": "<p>Use meaningful variable names - particularly when you are learning:</p>\n\n<pre><code>Sub Example()\nDim wbSource As Workbook\nDim wbDestination As Workbook\nDim wsSource As Worksheet\nDim wsDestination As Worksheet\nDim rSource As Range\nDim rDestination As Range\nSet wbSource = Workbooks(\"Pres.xls\")\nSet wsSource = wbSource.Worksheets(\"Paste_tab\")\n\nSet wbDestination = Workbooks(\"Bench.xlsm\")\nSet wsDestination = wbDestination.Worksheets(\"Test-Sheet\")\n\nSet rSource = wsSource.Range(\"b2:b\" &amp; wsSource.Range(\"b\" &amp; wsSource.Rows.Count).End(xlUp).Row)\nFor Each rDestination In wsDestination.Range(\"B4:W4\")\n    If InStr(\"BCDEHIMOQSVW\", Left(rDestination.AddressLocal(False, False), 1)) &gt; 0 Then\n\n       ' rSource.Copy rDestination\n  '=============if only values wanted ===========\n        rsource.copy\n        rdestination.pastespecial xlpastevalues\n'==================\n    End If\nNext rDestination\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 8818916, "user_type": "registered", "profile_image": "https://graph.facebook.com/1880323835627028/picture?type=large", "display_name": "KaBi", "link": "https://stackoverflow.com/users/8818916/kabi"}, "is_accepted": true, "score": 0, "last_activity_date": 1513093632, "creation_date": 1513093632, "answer_id": 47776479, "question_id": 47677258, "link": "https://stackoverflow.com/questions/47677258/how-to-copy-paste-selected-columns-from-one-xls-to-another/47776479#47776479", "title": "How to copy/paste selected columns from one xls to another", "body": "<p>Finally I've did something like this and it works properly. Thanks to the @Harassed Dad - I've used some of your code. I think it could be more universal but for me it's OK now.</p>\n\n<pre><code>Sub PasteToTemplate()\n\nDim xD As Workbook\nDim xS As Workbook\nDim wsSource As Worksheet\nDim x As Worksheet\nDim tempN As Worksheet\nDim tN As String\nDim sN As String\n\nWith Sheets(\"Source_sample_size\")\n    sN = .Range(\"PresName\").Value\nEnd With\n\nSet xS = Workbooks(sN)\nSet wsSource = xS.Worksheets(\"Paste_tab\")\n\nSet tempN = xS.Worksheets(\"Source_sample_size\")\n\nWith tempN\n    tN = .Range(\"tempName\").Value\n  End With\n\nSet xD = Workbooks.Open(tN)\nSet x = xD.Worksheets(\"Test-Sheet\")\n\n\n        wsSource.Range(\"A2:F\" &amp; wsSource.Range(\"A\" &amp; wsSource.Rows.Count).End(xlUp).Row).Copy\n        x.Range(\"B4\").PasteSpecial (xlPasteValues)\n\n        wsSource.Range(\"H2:I\" &amp; wsSource.Range(\"A\" &amp; wsSource.Rows.Count).End(xlUp).Row).Copy\n        x.Range(\"H4\").PasteSpecial (xlPasteValues)\n\n        wsSource.Range(\"J2:J\" &amp; wsSource.Range(\"A\" &amp; wsSource.Rows.Count).End(xlUp).Row).Copy\n        x.Range(\"M4\").PasteSpecial (xlPasteValues)\n\n        wsSource.Range(\"K2:K\" &amp; wsSource.Range(\"A\" &amp; wsSource.Rows.Count).End(xlUp).Row).Copy\n        x.Range(\"O4\").PasteSpecial (xlPasteValues)\n\n        wsSource.Range(\"L2:L\" &amp; wsSource.Range(\"A\" &amp; wsSource.Rows.Count).End(xlUp).Row).Copy\n        x.Range(\"AI4\").PasteSpecial (xlPasteValues)\n\n        wsSource.Range(\"M2:M\" &amp; wsSource.Range(\"A\" &amp; wsSource.Rows.Count).End(xlUp).Row).Copy\n        x.Range(\"AK4\").PasteSpecial (xlPasteValues)\n\n        wsSource.Range(\"P2:P\" &amp; wsSource.Range(\"A\" &amp; wsSource.Rows.Count).End(xlUp).Row).Copy\n        x.Range(\"AM4\").PasteSpecial (xlPasteValues)\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8818916, "user_type": "registered", "profile_image": "https://graph.facebook.com/1880323835627028/picture?type=large", "display_name": "KaBi", "link": "https://stackoverflow.com/users/8818916/kabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "accepted_answer_id": 47776479, "answer_count": 2, "score": 0, "last_activity_date": 1513093632, "creation_date": 1512572231, "last_edit_date": 1531164843, "question_id": 47677258, "link": "https://stackoverflow.com/questions/47677258/how-to-copy-paste-selected-columns-from-one-xls-to-another", "title": "How to copy/paste selected columns from one xls to another", "body": "<p>I would like to copy/paste some columns (always the same) from one Workbook to another. I can't make my code to do this between workbooks.\nAnd one more small thing I want paste values to the 4th row in target sheet and all I could do by myself is to paste it into second one :/</p>\n\n<p>Something like this code but this one works only pasting values from one sheet to another in the same xls file:</p>\n\n<p>EDIT: code with my attempt of copy/paste between xls files. What do I do wrong, because it doesn't work.</p>\n\n<pre><code>    Sub Paste_columns()\n\nDim x As Worksheet, r As Long, y As Worksheet\n\nSet x = Workbooks(\"Bench.xlsm\").Worksheets(\"Test-Sheet\")\nSet y = Workbooks(\"Pres.xls\").Worksheets(\"Paste_tab\")\nWith y\n   For r = 2 To y.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n        If y.Cells(r, 2).Value &gt; 0 Then\n        x.Range(\"B\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 2)\n        x.Range(\"C\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 3)\n        x.Range(\"D\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 4)\n        x.Range(\"E\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 5)\n        x.Range(\"H\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 8)\n        x.Range(\"I\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 9)\n        x.Range(\"M\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 13)\n        x.Range(\"O\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 15)\n        x.Range(\"Q\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 17)\n        x.Range(\"S\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 19)\n        x.Range(\"V\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 22)\n        x.Range(\"W\" &amp; Rows.Count).End(xlUp)(2).Value = .Cells(r, 23)\n            Else: End\n        End If\n\n    Next r\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512572105, "post_id": 47677128, "comment_id": 82313273, "body": "The above code is working fine and proper? I think there is another workbook activated?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1512572231, "post_id": 47677128, "comment_id": 82313369, "body": "1. makes sure that you are refering to the correct sheet: <code>Sheets(1)</code> refers to the first tab whether it be a worksheet, code sheet or chart sheet.  May be better to refer to it by name: <code>Worksheets(&quot;Sheet1&quot;)</code>  2.  Get rid of the activate; Use : <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;)</code> to fully qualify your range."}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1512572070, "creation_date": 1512572070, "answer_id": 47677195, "question_id": 47677128, "link": "https://stackoverflow.com/questions/47677128/range-value-not-working-for-assigning-cell-contents-to-variable-in-vba/47677195#47677195", "title": "Range.Value not working for assigning cell contents to variable in VBA", "body": "<p>I think this should do the trick:</p>\n\n<pre><code>Sub copyworksheet()\n\nDim sourceWorkbook As String \nDim destinationWorkbook As String \nDim folderName As String\n\ndestinationWorkbook = ActiveWorkbook.Name\n\nMsgBox Sheets(1).Range(\"A1\").Value      'reference the Sheet absolutely when using Range  \nfolderName = Sheets(1).Range(\"A1\").Value\nMsgBox \"Here is \" &amp; folderName  \n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1512572290, "creation_date": 1512572290, "answer_id": 47677274, "question_id": 47677128, "link": "https://stackoverflow.com/questions/47677128/range-value-not-working-for-assigning-cell-contents-to-variable-in-vba/47677274#47677274", "title": "Range.Value not working for assigning cell contents to variable in VBA", "body": "<p>Alternate way is using <code>Cells</code>.</p>\n\n<pre><code>MsgBox Cells(1, 1).Value\nfolderName = Cells(1, 1).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1512573045, "creation_date": 1512573045, "answer_id": 47677515, "question_id": 47677128, "link": "https://stackoverflow.com/questions/47677128/range-value-not-working-for-assigning-cell-contents-to-variable-in-vba/47677515#47677515", "title": "Range.Value not working for assigning cell contents to variable in VBA", "body": "<blockquote>\n  <p><code>Sheets(1)</code></p>\n</blockquote>\n\n<p>refers to the first tab in the active workbook.  That tab can be a worksheet, code sheet or chart sheet.</p>\n\n<p>It is better to use <code>WorkSheets()</code> to reference worksheets. To ensure that you always get the correct sheet, regardless of order, use the name:</p>\n\n<pre><code>WorkSheets(\"Sheet1\")\n</code></pre>\n\n<p>The best method would be to use the <code>CodeName</code>.  This is the name of the sheet that the user cannot change.  It is found in the sheet list in VBA:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TOTs4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TOTs4.png\" alt=\"enter image description here\"></a></p>\n\n<p>The part before the <code>()</code> is the <code>Codename</code>.  So <code>Worksheets(\"Sheet1\")</code> Code Name is <code>Sheet1</code>.  Using the code name we reference the sheet simply by typing it:</p>\n\n<pre><code>Sheet1\n</code></pre>\n\n<p>This cannot be easily changed by the user, as the name of the sheet can.  This will always refer to the proper sheet regardless of tab position and name of the sheet.</p>\n\n<p>Next:</p>\n\n<p>Do not use <code>.Activate</code> or <code>.Select</code>  They just slow down the code.  Just append the ranges with the correct sheet references:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"A1\")\n</code></pre>\n\n<p>Or better with the <code>CodeName</code>:</p>\n\n<pre><code>Sheet1.Range(\"A1\")\n</code></pre>\n"}], "owner": {"reputation": 34, "user_id": 7037336, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7638cd8df78004ed3b825244d80aca2e?s=128&d=identicon&r=PG&f=1", "display_name": "LillyBran", "link": "https://stackoverflow.com/users/7037336/lillybran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4046, "favorite_count": 0, "accepted_answer_id": 47677195, "answer_count": 3, "score": 0, "last_activity_date": 1512573045, "creation_date": 1512571835, "question_id": 47677128, "link": "https://stackoverflow.com/questions/47677128/range-value-not-working-for-assigning-cell-contents-to-variable-in-vba", "title": "Range.Value not working for assigning cell contents to variable in VBA", "body": "<p>I am writing my first script with VBA and I am having a hard time assigning the value entered into a cell to a String variable, I used Message Boxes to test where the issue is and it showed me I'm in the right workbook and the right sheet but then shows a blank for the value in \"A1\" even though I have a text value there and made sure I saved the workbook, what I have is below:</p>\n\n<pre><code>Sub copyworksheet()\n\nDim sourceWorkbook As String \nDim destinationWorkbook As String \n\nDim folderName As String\n\ndestinationWorkbook = ActiveWorkbook.Name\nSheets(1).Activate\n\nMsgBox Range(\"A1\").Value        ' Shows blank when debugging\nfolderName = Range(\"A1\").Value\nMsgBox \"Here is \" &amp; folderName  ' Shows \"Here is \" when debugging\n\nEnd Sub\n</code></pre>\n\n<p>** As an additional note, the A1 cell contains 02Nov, and I have tried changing the format of this cell and it hasn't fixed the issue, currently the cell format is Text</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 2, "creation_date": 1512568199, "post_id": 47675870, "comment_id": 82310594, "body": "Welcome to SO, I could not find a clear question, can you modify your post and define a question to solve? Please read&gt; <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 21, "user_id": 9062080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafe722fb9f76796b7a9d14ee9793252?s=128&d=identicon&r=PG&f=1", "display_name": "user824565", "link": "https://stackoverflow.com/users/9062080/user824565"}, "edited": false, "score": 0, "creation_date": 1512569276, "post_id": 47675870, "comment_id": 82311279, "body": "I have created a userform of login page ... once user is logged in I have anothe userform to connect to database. .....Now I want to generate a log file having user activity ..who has loggedin to userform what changes have been done."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 1, "creation_date": 1512569723, "post_id": 47675870, "comment_id": 82311580, "body": "Thanks for the clarification. What is your question?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1512570370, "post_id": 47675870, "comment_id": 82312052, "body": "I believe his question is &quot;Why am I not getting any records in logs folder?&quot;"}, {"owner": {"reputation": 21, "user_id": 9062080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafe722fb9f76796b7a9d14ee9793252?s=128&d=identicon&r=PG&f=1", "display_name": "user824565", "link": "https://stackoverflow.com/users/9062080/user824565"}, "edited": false, "score": 0, "creation_date": 1512570553, "post_id": 47675870, "comment_id": 82312169, "body": "yes,or if you can suggest your code that is working"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1512571310, "post_id": 47675870, "comment_id": 82312694, "body": "if you run the workbook.open event using F8 what value does the statement   ThisWorkbook.Name &amp;amp; &quot; opened by &quot; &amp;amp; _      Application.UserName &amp;amp; &quot; &quot; &amp;amp; Format(Now, &quot;yyyy-mm-dd hh:mm&quot;)  have?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1512572717, "post_id": 47675870, "comment_id": 82313751, "body": "I just tested your code as is (assuming the <code>amp;</code> is just mark-up, i removed that) and it worked perfect. Appended the text to the log file each time I ran it. Are you sure <code>&quot;D:\\FOLDERNAME\\TEXTFILE.LOG&quot;</code> is a valid <b>shared drive</b>? (D:\\ is typically used for a person&#39;s local folder (in my experience)."}], "owner": {"reputation": 21, "user_id": 9062080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafe722fb9f76796b7a9d14ee9793252?s=128&d=identicon&r=PG&f=1", "display_name": "user824565", "link": "https://stackoverflow.com/users/9062080/user824565"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 735, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533569335, "creation_date": 1512568048, "last_edit_date": 1531164843, "question_id": 47675870, "link": "https://stackoverflow.com/questions/47675870/logs-for-user-activity-in-vba-userform", "title": "logs for user activity in vba userform", "body": "<p>I am trying to work on a code that will give me the user activity on the userform that I have created. I want to keep this logs file in shared drive if possible.\n below is my code, not getting any records in logs folder</p>\n\n<pre><code>Sub LogInformation(LogMessage As String)\n\n    Const LogFileName As String = \"D:\\FOLDERNAME\\TEXTFILE.LOG\"\n\n    Dim FileNum As Integer\n\n    FileNum = FreeFile ' next file number\n\n    Open LogFileName For Append As #FileNum ' creates the file if it doesn't exist\n\n    Print #FileNum, LogMessage ' write information at the end of the text file\n\n    Close #FileNum ' close the file\n\nEnd Sub\n\n\nPublic Sub DisplayLastLogInformation()\n\n    Const LogFileName As String = \"D:\\FOLDERNAME\\TEXTFILE.LOG\"\n\n    Dim FileNum As Integer, tLine As String\n\n    FileNum = FreeFile ' next file number\n\n    Open LogFileName For Input Access Read Shared As #f ' open the file for reading\n\n    Do While Not EOF(FileNum)\n\n        Line Input #FileNum, tLine ' read a line from the text file\n\n    Loop ' until the last line is read\n\n    Close #FileNum ' close the file\n\n    MsgBox tLine, vbInformation, \"Last log information:\"\n\nEnd Sub\n\n\nSub DeleteLogFile(FullFileName As String)\n\n    On Error Resume Next ' ignore possible errors\n\n    Kill FullFileName ' delete the file if it exists and it is possible\n\n    On Error GoTo 0 ' break on errors\n\nEnd Sub\n\nPrivate Sub Workbook_Open()\n\n    LogInformation ThisWorkbook.Name &amp;amp; \" opened by \" &amp;amp; _\n\n    Application.UserName &amp;amp; \" \" &amp;amp; Format(Now, \"yyyy-mm-dd hh:mm\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512567487, "post_id": 47675546, "comment_id": 82310097, "body": "Could you please debug this and provide the line which is giving you the error. Thanks"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1512567566, "post_id": 47675546, "comment_id": 82310156, "body": "Put the parent sheet in front and do not select just do the action: <code>XlSheet.Rows(&quot;1:1&quot;).Replace What:...</code>"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512568046, "post_id": 47675546, "comment_id": 82310505, "body": "Just and FYI.. try to avoid the use of <code>Select</code> or <code>Activate</code>, they just restrain on the Macro. Instead use the Name reference"}, {"owner": {"reputation": 49, "user_id": 3920529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3124c4b4feff2d2e41dc4336c812a3d?s=128&d=identicon&r=PG&f=1", "display_name": "adidashawn6", "link": "https://stackoverflow.com/users/3920529/adidashawn6"}, "edited": false, "score": 0, "creation_date": 1512569565, "post_id": 47675546, "comment_id": 82311478, "body": "Thanks Scott Craner, that did it! Also, thanks for the insight nishit dey, i will definitely keep that in mind."}], "owner": {"reputation": 49, "user_id": 3920529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3124c4b4feff2d2e41dc4336c812a3d?s=128&d=identicon&r=PG&f=1", "display_name": "adidashawn6", "link": "https://stackoverflow.com/users/3920529/adidashawn6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522691832, "creation_date": 1512567016, "last_edit_date": 1522691832, "question_id": 47675546, "link": "https://stackoverflow.com/questions/47675546/runtime-error-1004-method-rows-of-object-global-failed", "title": "Runtime error &#39;1004&#39; Method &#39;Rows&#39; of object &#39;_Global&#39; failed", "body": "<p>I'm running into a problem with some VBA code. i keep getting </p>\n\n<blockquote>\n<pre><code>  Run-time error '1004'  Method 'Rows' of object '_Global' failed \n</code></pre>\n</blockquote>\n\n<p>I have been running this tool for a few months now, and have had no issues until this morning. The code where the error is occurring is below, commented at the error point.</p>\n\n<pre><code> Function ExcelProcess()\n 'Variables to refer to Excel and Objects\n Dim MySheetPath As String\n Dim Xl As Excel.Application\n Dim XlBook As Excel.Workbook\n Dim XlSheet As Excel.Worksheet\n Dim MyFile As Variant\n Dim MySheet As Variant\n Dim wBook As Variant\n Dim wSheet As Variant\n Dim wDate As Variant\n\n Dim rng As Range\n Dim cel As Range\n\n\n MyFile = Array(\"w1.xlsx\", \"w2.xlsx\", \"w3.xlsx\")\n MySheet = Array(\"APPR_IND\", \"SLG_IND\", \"C2_IND\", \"C3_IND\", \"C4_IND\", \"T2_IND\", \"T3_IND\", \"T4_IND\", \"SLG_APPR_IND\")\n\n For Each wBook In MyFile\n     ' Tell it location of actual Excel file\n     MySheetPath = \"\\\\fs1\\Training\\CSC_Training_Ops\\Training Only\\Buzzard\\Pulled Data\\\" &amp; wBook\n\n     'Open Excel and the workbook\n     'Set Xl = CreateObject(\"Excel.Application\")\n     Set XlBook = GetObject(MySheetPath)\n\n     'Make sure excel is visible on the screen\n     'Xl.Visible = True\n     XlBook.Windows(1).Visible = True\n\n     'Windows(wBook).Activate\n\n     For Each wSheet In MySheet\n         'Define the sheet in the Workbook as XlSheet\n         Set XlSheet = XlBook.Worksheets(wSheet)\n         wDate = Mid(XlSheet.Range(\"B4\").Value, 13, Len(XlSheet.Range(\"B4\").Value))\n\n         XlSheet.Range(\"A15\").FormulaR1C1 = \"WE_Date\"\n         If XlSheet.Range(\"A16\").Value &lt;&gt; \"No data found\" Then\n             Set rng = XlSheet.Range(XlSheet.Range(\"A16\"), XlSheet.Range(\"A16\").End(xlDown).Offset(-1))\n\n             For Each cel In rng.Cells\n                 With cel\n                     .FormulaR1C1 = wDate\n                     .NumberFormat = \"m/d/yyyy\"\n                 End With\n             Next cel\n         End If\n         XlSheet.Rows(\"1:14\").Delete Shift:=xlUp\n         XlSheet.Range(\"A1\").End(xlDown).EntireRow.Delete Shift:=xlUp\n         Rows(\"1:1\").Select\n         Selection.Replace What:=\"act\", Replacement:=\"aht\", LookAt:=xlPart, _\n         SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n         ReplaceFormat:=False\n     Next\n     XlBook.Close SaveChanges:=True\n Next\n\n 'Clean up and end with worksheet visible on the screen\n Set Xl = Nothing\n Set XlBook = Nothing\n Set XlSheet = Nothing\n End Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 1, "creation_date": 1512567376, "post_id": 47675514, "comment_id": 82310010, "body": "This question is duplicate, I just answered the exact same question a week ago."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1512567382, "post_id": 47675514, "comment_id": 82310015, "body": "If you click debug, what pat of your code is highlighted?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1512567617, "post_id": 47675514, "comment_id": 82310194, "body": "There is no <code>Worksheets.Cell</code> I guess you mean <code>Worksheets.Range</code>. And declaring <code>Dim dblPower, dblMass As Double</code> will only declare the last one as <code>Double</code> but the first will remain <code>Variant</code> instead declare a type for <b>every</b> variable like <code>Dim dblPower As Double, dblMass As Double, \u2026</code>"}, {"owner": {"reputation": 97, "user_id": 7581412, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10209961107717574/picture?type=large", "display_name": "Keiron Morris", "link": "https://stackoverflow.com/users/7581412/keiron-morris"}, "reply_to_user": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1512569077, "post_id": 47675514, "comment_id": 82311170, "body": "@SilentRevolution  I have amended how i have declared the dblMass etc and that is fine..  The code that is giving me the problem now is:  dblPower = Worksheets(&quot;TestUserGuidance&quot;).Range(&quot;B6&quot;).Value ??"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1512573445, "post_id": 47675514, "comment_id": 82314289, "body": "I think Dave Thornton&#39;s answer is the right solution. There should be no reason for the error with the code you&#39;ve provided. It is however recommended to avoid things as <code>selection</code> and <code>active</code>. <code>Worksheets(&quot;TestUserGuidance&quot;)</code> is the same as <code>ActiveWorkbook.Worksheets(&quot;TestUserGuidance&quot;)</code> but may not necessarily be the same as <code>ThisWorkbook.Worksheets(&quot;TestUserGuidance&quot;)</code> especially when you have multiple workbooks open."}], "answers": [{"comments": [{"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 2, "creation_date": 1512567543, "post_id": 47675618, "comment_id": 82310137, "body": "I thought of that, but would it generate an error since the variables are declared as variant which can hold anything?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1512567753, "post_id": 47675618, "comment_id": 82310296, "body": "@SilentRevolution In this specific case, <code>Variant</code> variables will not cause any error, but it can cause some run time errors if you try to compare some variables or you pass this variable to a function or procedure that needs an specific variable type."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 1, "creation_date": 1512567945, "post_id": 47675618, "comment_id": 82310417, "body": "I was just referring to this particular question. But it is best practice to always declare all variable and use <code>Option Explicit</code>"}, {"owner": {"reputation": 97, "user_id": 7581412, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10209961107717574/picture?type=large", "display_name": "Keiron Morris", "link": "https://stackoverflow.com/users/7581412/keiron-morris"}, "edited": false, "score": 0, "creation_date": 1512569305, "post_id": 47675618, "comment_id": 82311295, "body": "@DavidG. I have also tried the method you have given. However, it is now highlighting that line is causing the problem??"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 97, "user_id": 7581412, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10209961107717574/picture?type=large", "display_name": "Keiron Morris", "link": "https://stackoverflow.com/users/7581412/keiron-morris"}, "edited": false, "score": 0, "creation_date": 1512569612, "post_id": 47675618, "comment_id": 82311509, "body": "@KeironMorris, I&#39;m at work and not able to see images, not sure what are you trying to achieve. Can you provide more information? Also, what Office version and OS are you using? I tested the line in my machine and works like a charm!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1512567192, "creation_date": 1512567192, "answer_id": 47675618, "question_id": 47675514, "link": "https://stackoverflow.com/questions/47675514/excel-vba-subscript-out-of-range-run-error-9/47675618#47675618", "title": "Excel VBA &quot;Subscript out of range&quot; Run Error &#39;9&#39;", "body": "<p>Only <code>dblRoadSpeed</code> is declared as double.\nTo fix it, declare all your variables as individual, in vba you can do in 2 ways.</p>\n\n<pre><code>Dim dblPower As Double, dblMass As Double\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Dim dblPower As Double\nDim dblMass As Double\n</code></pre>\n\n<p>Also, you don't need to declare any variable to do what you are doing.\nYou can copy the value in one step.</p>\n\n<pre><code>Worksheets(\"TestUserGuidance\").Range(\"E1\").Value = Worksheets(\"TestUserGuidance\").Range(\"B1\").Value \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1512567818, "post_id": 47675771, "comment_id": 82310340, "body": "But with <code>Dim dblPower, dblEngineSpeed, dblRoadSpeed As Double</code> only <code>dblRoadSpeed</code> is of type <code>Double</code> the first 2 are <code>Variant</code> but they start with <code>dbl</code> so I guess all of them should be <code>Double</code> like:  <code>Dim dblPower As Double, dblEngineSpeed As Double, dblRoadSpeed As Double</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1512568124, "post_id": 47675771, "comment_id": 82310548, "body": "Uhm, I see no comment of the OP (Keiron Morris) in this whole question and answers. But anyway your comment made it clear :)  It&#39;s just I always see these wrong declarations and most people would think all of them will be double then."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1512568130, "post_id": 47675771, "comment_id": 82310557, "body": "<code>Worksheets(1)</code> will not necessary refer to <code>TestUserGuidance</code> sheet."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1512568198, "post_id": 47675771, "comment_id": 82310592, "body": "@DavidG. - of course not. But it is easier for me this way to replicate."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1512568263, "post_id": 47675771, "comment_id": 82310627, "body": "Then you should put a comment about it. You can get the OP more confused."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1512568311, "last_edit_date": 1512568311, "creation_date": 1512567710, "answer_id": 47675771, "question_id": 47675514, "link": "https://stackoverflow.com/questions/47675514/excel-vba-subscript-out-of-range-run-error-9/47675771#47675771", "title": "Excel VBA &quot;Subscript out of range&quot; Run Error &#39;9&#39;", "body": "<p>This is the way to make your code working:</p>\n\n<pre><code>Sub GuideTest()\n    Dim dblPower, dblEngineSpeed, dblRoadSpeed As Double ' first two are of variant type\n    Dim dblPMR As Double\n\n    dblPower = Worksheets(1).Range(\"B1\").Value\n    Worksheets(1).Range(\"E1\") = dblPower\nEnd Sub\n</code></pre>\n\n<p>When you use \"E1\" or \"B1\" you should use <code>Range</code>, not Cells. In my answer <code>Worksheets(1)</code> refers to <code>Worksheets(\"TestUserGuidance\")</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 551, "user_id": 1475916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb025b6e7d0824fc04113b0aa737d0?s=128&d=identicon&r=PG", "display_name": "Dave Thornton", "link": "https://stackoverflow.com/users/1475916/dave-thornton"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1512571555, "post_id": 47676846, "comment_id": 82312871, "body": "What I mean is that another workbook could be active. If the worksheet existed (in scope that is), the op should have gotten a different error. Subscript out of range occurs when you&#39;re trying to access something from an array or collection that does not exist. I don&#39;t see anything else in his code that could produce that error."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1512571962, "post_id": 47676846, "comment_id": 82313145, "body": "Makes sense, indeed. Although <code>Awot Model</code> is the name of both the VBEditor and the Excel file."}, {"owner": {"reputation": 551, "user_id": 1475916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb025b6e7d0824fc04113b0aa737d0?s=128&d=identicon&r=PG", "display_name": "Dave Thornton", "link": "https://stackoverflow.com/users/1475916/dave-thornton"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1512572553, "post_id": 47676846, "comment_id": 82313617, "body": "Unfortunately, we&#39;re working with limited info here. Maybe put a break point on that line where dblPower  is being set. Then when the break point is hit, run ?activeworkbook.name or ?Worksheets(&quot;TestUserGuidance&quot;).name in the immediate window."}, {"owner": {"reputation": 97, "user_id": 7581412, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10209961107717574/picture?type=large", "display_name": "Keiron Morris", "link": "https://stackoverflow.com/users/7581412/keiron-morris"}, "edited": false, "score": 0, "creation_date": 1512577863, "post_id": 47676846, "comment_id": 82317310, "body": "@DaveThornton I have now tried the code in a blank Excel file and it has worked perfectly but do not understand why it wont work in my existing file?"}, {"owner": {"reputation": 551, "user_id": 1475916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb025b6e7d0824fc04113b0aa737d0?s=128&d=identicon&r=PG", "display_name": "Dave Thornton", "link": "https://stackoverflow.com/users/1475916/dave-thornton"}, "edited": false, "score": 0, "creation_date": 1512582878, "post_id": 47676846, "comment_id": 82320303, "body": "I added some troubleshooting steps to my answer that might help you."}], "tags": [], "owner": {"reputation": 551, "user_id": 1475916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb025b6e7d0824fc04113b0aa737d0?s=128&d=identicon&r=PG", "display_name": "Dave Thornton", "link": "https://stackoverflow.com/users/1475916/dave-thornton"}, "is_accepted": false, "score": 2, "last_activity_date": 1512582836, "last_edit_date": 1512582836, "creation_date": 1512570998, "answer_id": 47676846, "question_id": 47675514, "link": "https://stackoverflow.com/questions/47675514/excel-vba-subscript-out-of-range-run-error-9/47676846#47676846", "title": "Excel VBA &quot;Subscript out of range&quot; Run Error &#39;9&#39;", "body": "<p>I think vba can't find  the TestUserGuidance sheet. If I run the following in the immediate window I get an \"Object doesn't support this property or method\" error:</p>\n\n<pre><code>?worksheets(1).cell(\"A1\")\n</code></pre>\n\n<p>If I run this, I get the error you mention \"Subscript out of range\":</p>\n\n<pre><code>?worksheets(\"non-existent sheet\").cell(\"A1\")\n</code></pre>\n\n<p>This suggests to me that the active workbook is incorrect since you would have gotten the other error if vba was able to find the worksheet. Can you try adding ThisWorkbook (and also use range)?</p>\n\n<pre><code>dblPower = ThisWorkbook.Worksheets(\"TestUserGuidance\").Range(\"B1\").Value\nThisWorkbook.Worksheets(\"TestUserGuidance\").Range(\"E1\") = dblPower\n</code></pre>\n\n<p>Another option would be to rename your worksheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YmkB4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YmkB4.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then you won't have to worry about the active workbook (and also get intellisence):</p>\n\n<pre><code>shtTestUserGuidance.Range(\"E1\") = shtTestUserGuidance.Range(\"B1\")\n</code></pre>\n\n<p>Also, I would suggest you make all the corrections suggested by others. You will likely have other issues moving forward otherwise.</p>\n\n<p>Lastly, if the worksheet is like a template and the structure won't change, you'd be better off just using a formula (i.e. E1's formula: =B1). Even if there's conditional logic, it might be easier to maintain as a formula rather than vba code.</p>\n\n<p>Here are some troubleshooting steps:</p>\n\n<p>Toggle a break point on the line where dblPower is set by clicking on the grey area to the left:\n<a href=\"https://i.stack.imgur.com/73Ull.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/73Ull.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Also open the Immediate window if it's not already there by pressing ctrl+g:\n<a href=\"https://i.stack.imgur.com/NVxnP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NVxnP.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>When you run the code, it should pause at the break point. Now you can inspect what's in scope. Try typing the following into the Immediate window and press enter:</p>\n\n<pre><code>?Worksheets(\"TestUserGuidance\").Name\n</code></pre>\n\n<p>or</p>\n\n<pre><code>?ActiveWorkbook.Name\n</code></pre>\n\n<p>Note that you can also step through the code line by line by pressing F8 while the cursor is somewhere within the subroutine. Bottom line is that you may need to examine the code line by line in order to figure this out. </p>\n"}], "owner": {"reputation": 97, "user_id": 7581412, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10209961107717574/picture?type=large", "display_name": "Keiron Morris", "link": "https://stackoverflow.com/users/7581412/keiron-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1512582836, "creation_date": 1512566901, "last_edit_date": 1512567516, "question_id": 47675514, "link": "https://stackoverflow.com/questions/47675514/excel-vba-subscript-out-of-range-run-error-9", "title": "Excel VBA &quot;Subscript out of range&quot; Run Error &#39;9&#39;", "body": "<p>I have tried to implement the following code so that I can read a cell value and then places this value into another cell on the same Worksheet.</p>\n\n<p>The worksheet has the following name: TestUserGuidance (Has no spaces)\nThe code is as follows:</p>\n\n<pre><code>Sub GuideTest()\n    Dim dblPower, dblMass, dblRatedSpeed, dblRefLength, dblAwot, dblEngineSpeed, dblRoadSpeed As Double\n    Dim dblPMR As Double\n\n    dblPower = Worksheets(\"TestUserGuidance\").Cell(\"B1\").Value\n    Worksheets(\"TestUserGuidance\").Cell(\"E1\") = dblPower\nEnd Sub \n</code></pre>\n\n<p>Could anyone please advise where I'm going wrong? </p>\n\n<p>Thanks </p>\n\n<p><a href=\"https://i.stack.imgur.com/YiY3R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YiY3R.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["html", "vba", "internet-explorer"], "answers": [{"tags": [], "owner": {"reputation": 12392, "user_id": 847383, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68523f1367c67bffa7b9dc33d442f7d?s=128&d=identicon&r=PG", "display_name": "PhonicUK", "link": "https://stackoverflow.com/users/847383/phonicuk"}, "is_accepted": true, "score": 0, "last_activity_date": 1512578397, "creation_date": 1512578397, "answer_id": 47679287, "question_id": 47675503, "link": "https://stackoverflow.com/questions/47675503/calling-a-vba-script-in-a-html5-page/47679287#47679287", "title": "Calling a Vba script in a HTML5 page", "body": "<p>VBScript can only be used in Internet Explorer. And even then it won't work by default, you have to enable \"Enterprise Mode\" to enable backwards compatibility and various other flags to allow the browser access to the file system. You also can't work with a Word document like this without some extra legwork since <code>Word</code> won't be defined here.</p>\n\n<p>There is a new Javascript API that you might be able to leverage instead but again this isn't for use in the context of a browser. But it would let you add some functionality to word itself.</p>\n\n<p><a href=\"https://dev.office.com/reference/add-ins/javascript-api-for-office\" rel=\"nofollow noreferrer\">https://dev.office.com/reference/add-ins/javascript-api-for-office</a></p>\n"}], "owner": {"reputation": 629, "user_id": 4098175, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d30fca6f7d19e2a3fbde02792c38c388?s=128&d=identicon&r=PG&f=1", "display_name": "coeurdange57", "link": "https://stackoverflow.com/users/4098175/coeurdange57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 47679287, "answer_count": 1, "score": 0, "last_activity_date": 1512578397, "creation_date": 1512566874, "question_id": 47675503, "link": "https://stackoverflow.com/questions/47675503/calling-a-vba-script-in-a-html5-page", "title": "Calling a Vba script in a HTML5 page", "body": "<p>I create a script in Vba allowing to compare reports in Word and I would like to create a page in HTML allowing to launch the Vba script after clicking a button.</p>\n\n<p>When I try to do that, I obtain the message \"<em>ReferenceError: myFunction is not defined</em>\" in Firefox and Chrome. If I try the same on IE, I obtain the error \"'myFunction' is undefined\".</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;Reports Comparison&lt;/title&gt;\n    &lt;script type=\"text/vbscript\" src=\"myScript.vbs\"&gt;&lt;/script&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;input type=\"button\" value=\"Test\" onClick=\"myFunction()\"&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>myFunction is correctly defined in the file myScript.vbs :</p>\n\n<pre><code>Sub myFunction ()\n    Dim strFolderA As String\n    Dim strFolderB As String\n    Dim strFolderC As String\n    Dim strFileSpec As String\n    Dim strFileName As String\n    Dim objDocA As Word.Document\n    Dim objDocB As Word.Document\n    Dim objDocC As Word.Document\n    strFolderA = InputBox(\"Enter path to base documents:\")\n    strFolderB = InputBox(\"Enter path to new documents:\")\n    strFolderC = InputBox(\"Enter path for document comparisons to be saved:\")\n    strFileSpec = \"*.docx\"\n    strFileName = Dir(strFolderA &amp; strFileSpec)\n    Do While strFileName &lt;&gt; vbNullString\n        Set objDocA = Documents.Open(strFolderA &amp; strFileName)\n        Set objDocB = Documents.Open(strFolderB &amp; strFileName)\n        Application.CompareDocuments _\n            OriginalDocument:=objDocA, _\n            RevisedDocument:=objDocB, _\n            Destination:=wdCompareDestinationNew\n        objDocA.Close\n        objDocB.Close\n        Set objDocC = ActiveDocument\n        objDocC.SaveAs FileName:=strFolderC &amp; strFileName\n        objDocC.Close SaveChanges:=False\n        strFileName = Dir\n    Loop\n    Set objDocA = Nothing\n    Set objDocB = Nothing\nEnd Sub\n</code></pre>\n\n<p>Could you please help me to do that?</p>\n\n<p>Regards</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 185, "user_id": 8224420, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8d53f6c9226fbd86d9b159a2b9d1658e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Phi", "link": "https://stackoverflow.com/users/8224420/joe-phi"}, "is_accepted": false, "score": 0, "last_activity_date": 1512566556, "creation_date": 1512566556, "answer_id": 47675399, "question_id": 47675398, "link": "https://stackoverflow.com/questions/47675398/stepping-into-application-run-doesnt-show-code-to-step-through/47675399#47675399", "title": "stepping into application.run(...) doesn&#39;t show code to step through", "body": "<p>After spending a good number of hours I found a solution (or rather a workaround):\nI changed the code in fileA:</p>\n\n<ul>\n<li>open file<strong>B</strong>.xlsb from the source folder</li>\n<li>modify something in file<strong>B</strong></li>\n<li>save file<strong>B</strong>.xlsb to another folder (target folder)</li>\n<li><strong>close fileB.xlsb</strong></li>\n<li><strong>re-open fileB.xlsb from it's target (!) folder</strong></li>\n<li><p>call Application.Run \"'\" &amp; file<strong>B</strong>name &amp; \"'\" &amp; \"!func<strong>B</strong>\", </p>\n\n<p>=> stepping in with F8 works nicely as expected</p></li>\n<li><p>save &amp; close file<strong>B</strong>.xlsb</p></li>\n</ul>\n"}], "owner": {"reputation": 185, "user_id": 8224420, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8d53f6c9226fbd86d9b159a2b9d1658e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Phi", "link": "https://stackoverflow.com/users/8224420/joe-phi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512566556, "creation_date": 1512566556, "last_edit_date": 1531164843, "question_id": 47675398, "link": "https://stackoverflow.com/questions/47675398/stepping-into-application-run-doesnt-show-code-to-step-through", "title": "stepping into application.run(...) doesn&#39;t show code to step through", "body": "<p>I want to share an experience here so you don't spend too much time...\nI use Excel within Microsoft Office Professional Plus 2016.</p>\n\n<p>I have an Excel file file<strong>A</strong>.xlsb which does</p>\n\n<ul>\n<li>open file<strong>B</strong>.xlsb from a source folder </li>\n<li>modify something in file<strong>B</strong></li>\n<li>save file<strong>B</strong>.xlsb to another folder (target folder)</li>\n<li>call function <strong>funcB</strong> in file<strong>B</strong>.xlsb with Application.Run \"'\" &amp; file<strong>B</strong>name &amp; \"'\" &amp; \"!<strong>funcB</strong>\", [parameter...]</li>\n<li><p>save &amp; close file<strong>B</strong>.xlsb</p>\n\n<pre><code>            Set appO = Application()\n            udfTmp = appO.Run(\"'\" &amp; strFullTgtFilename &amp; \"'\" &amp; \"!reCalc_npFB\", _\n                                dummyColl, _\n                                colVarsAv_dtMtrx_TotEff, _\n                                colVarsAv_dtMtrx_iFlag, _\n                                PPlistsSheetName, _\n                                LRC_logFilename, _\n                                algID, _\n                                varErrMsg)\n</code></pre></li>\n</ul>\n\n<p>When I step through the code in file<strong>A</strong> everything's fine until Application.Run...\nPressing F8 doesn't show the code in file<strong>B</strong>/<strong>funcB</strong> but keeps the Application.Run statement highlighted. I can keep on pressing F8 or press F5 until funcB ended and stepping through file<strong>A</strong> continues as usual. And: <strong>funcB</strong> is executed correctly.</p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1512567039, "post_id": 47675253, "comment_id": 82309765, "body": "I think your range is at fault here: .SeriesCollection(1).XValues = Range(&quot;B6&quot;, Range(&quot;B6&quot;).End(xlDown)), have you got another 5 rows below B6? if so then that&#39;s where your extra data is coming from..."}, {"owner": {"reputation": 31, "user_id": 8884209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/480991e5c03000e1499bddb7a473299c?s=128&d=identicon&r=PG&f=1", "display_name": "pariscraigm", "link": "https://stackoverflow.com/users/8884209/pariscraigm"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1512567358, "post_id": 47675253, "comment_id": 82309998, "body": "I do actually (about 6,000 rows). Since posting I have actually changed it to .SeriesCollection(1).XValues = Range(&quot;B6&quot;, Cells(UsedRange.Rows.Count, 2)). I still run into the same issue. It seems as though excel is &quot;suggesting&quot; data (like it does if you manually add a chart). Any idea on how I might fix this? I&#39;m considering just manually doing a for loop at the end to delete any series after SeriesCollection(1) but I would like to find a solution that prevents it from happening in the first place if that&#39;s possible. thanks for your help"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1512568236, "post_id": 47675253, "comment_id": 82310615, "body": "Well where is the actual data you would like to chart, why not reference that range as an absolute reference?"}, {"owner": {"reputation": 31, "user_id": 8884209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/480991e5c03000e1499bddb7a473299c?s=128&d=identicon&r=PG&f=1", "display_name": "pariscraigm", "link": "https://stackoverflow.com/users/8884209/pariscraigm"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1512568664, "post_id": 47675253, "comment_id": 82310891, "body": "Unfortunately this is data from a chemistry analytical instrument. the data is not always the same length so I am forced to use a dynamic range. To clarify: the series I create does not seem to have an issue. There however seems to be an issue with more series being created that I never instructed excel to create."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1512569247, "post_id": 47675253, "comment_id": 82311266, "body": "Well it still seems to me that the UsedRange.Rows.Count, 2 might be the culprit.."}], "answers": [{"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": true, "score": 0, "last_activity_date": 1513053693, "creation_date": 1513053693, "answer_id": 47765476, "question_id": 47675253, "link": "https://stackoverflow.com/questions/47675253/how-can-i-prevent-excel-from-automatically-creating-series-in-my-vba-generated-c/47765476#47765476", "title": "How can I prevent excel from automatically creating series in my vba generated chart?", "body": "<p>You need to clear data out of the chart before you add the data you want. At the beginning of your With/End With block, insert this:</p>\n\n<pre><code>With c\n    Do Until c.SeriesCollection.Count = 0\n        c.SeriesCollection(1).Delete\n    Loop\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8884209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/480991e5c03000e1499bddb7a473299c?s=128&d=identicon&r=PG&f=1", "display_name": "pariscraigm", "link": "https://stackoverflow.com/users/8884209/pariscraigm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 47765476, "answer_count": 1, "score": 0, "last_activity_date": 1513053693, "creation_date": 1512566236, "question_id": 47675253, "link": "https://stackoverflow.com/questions/47675253/how-can-i-prevent-excel-from-automatically-creating-series-in-my-vba-generated-c", "title": "How can I prevent excel from automatically creating series in my vba generated chart?", "body": "<p>I am trying to create a very basic scatterplot of an x column and a y column. </p>\n\n<pre><code>Dim c As Chart\nSet c = sht.Shapes.AddChart.Chart\nWith c\n\n    .ChartType = xlXYScatter\n    .SeriesCollection.NewSeries\n    .SeriesCollection(1).Name = \"GPC Plot\"\n    .SeriesCollection(1).XValues = Range(\"B6\", Range(\"B6\").End(xlDown))\n    .SeriesCollection(1).Values = Range(\"C6\", Range(\"C6\").End(xlDown))\n    .HasTitle = True\n    .ChartTitle.Characters.Text = sheetname\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Molecular Weight\"\n    .Axes(xlCategory).MaximumScale = 10000\n    .Axes(xlCategory).MinimumScale = 10\n    .Axes(xlCategory).ScaleType = xlLogarithmic\n    .Axes(xlValue).MaximumScale = 225\n    .Axes(xlValue).MinimumScale = 0\n\n\nEnd With\n</code></pre>\n\n\n\n<p>I just want the chart with the one data series, but Excel keeps generating a chart with 5 other series using random data from the sheet that I am creating the chart on. Is there a way I can prevent excel from automatically doing this?</p>\n\n\n"}, {"tags": ["excel", "ms-word", "worksheet", "vba"], "answers": [{"comments": [{"owner": {"reputation": 629, "user_id": 4098175, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d30fca6f7d19e2a3fbde02792c38c388?s=128&d=identicon&r=PG&f=1", "display_name": "coeurdange57", "link": "https://stackoverflow.com/users/4098175/coeurdange57"}, "edited": false, "score": 0, "creation_date": 1512573338, "post_id": 47675789, "comment_id": 82314215, "body": "Hi,Thanks for the response but it doesn&#39;t work. I have the error &quot;Invalid qualifier&quot;."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512590057, "post_id": 47675789, "comment_id": 82323994, "body": "If <code>sheetName</code> is a <code>String</code>, then you will need to use <code>sheetName = ws.Name</code> instead of <code>sheetName.Text = ws.Name</code>.  (Or simply use <code>newobj.ActiveWindow.TypeText ws.Name</code>.)"}, {"owner": {"reputation": 629, "user_id": 4098175, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d30fca6f7d19e2a3fbde02792c38c388?s=128&d=identicon&r=PG&f=1", "display_name": "coeurdange57", "link": "https://stackoverflow.com/users/4098175/coeurdange57"}, "edited": false, "score": 0, "creation_date": 1512631217, "post_id": 47675789, "comment_id": 82338236, "body": "I don&#39;t know where I have to put that. If I put that juste before the Next I obtain an error. Could you please help me?"}, {"owner": {"reputation": 127, "user_id": 8819666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cd5f1f28ef4fc25aa993981452f16f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Basso", "link": "https://stackoverflow.com/users/8819666/sam-basso"}, "edited": false, "score": 0, "creation_date": 1512648082, "post_id": 47675789, "comment_id": 82348587, "body": "Edited answer per YowE3K. What error do you get from newobj.ActiveWindow.TypeText ws.Name running in the For Each?"}, {"owner": {"reputation": 127, "user_id": 8819666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cd5f1f28ef4fc25aa993981452f16f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Basso", "link": "https://stackoverflow.com/users/8819666/sam-basso"}, "edited": false, "score": 0, "creation_date": 1512655559, "post_id": 47675789, "comment_id": 82353313, "body": "From MSDN, <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/selection-typetext-method-word\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/word-vba/articles/&hellip;</a> , the syntax for .TypeText is  expression.TypeText (Text) so try newobj.ActiveWindow.TypeText (ws.Name) . Another example from that page is .TypeText Text:=&quot;Hello&quot;"}], "tags": [], "owner": {"reputation": 127, "user_id": 8819666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cd5f1f28ef4fc25aa993981452f16f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Basso", "link": "https://stackoverflow.com/users/8819666/sam-basso"}, "is_accepted": false, "score": 0, "last_activity_date": 1512648030, "last_edit_date": 1512648030, "creation_date": 1512567776, "answer_id": 47675789, "question_id": 47675201, "link": "https://stackoverflow.com/questions/47675201/vba-macro-export-table-data-from-excel-file-to-word-and-create-a-section-for-e/47675789#47675789", "title": "VBA Macro - Export table data from Excel file to Word and create a section for each worksheet", "body": "<p>Try adding this to declarations:</p>\n\n<pre><code>    Dim sheetName as String\n</code></pre>\n\n<p>And this below the For Each statement</p>\n\n<pre><code>    sheetName = ws.Name\n    newobj.ActiveWindow.TypeText (sheetName)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 629, "user_id": 4098175, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d30fca6f7d19e2a3fbde02792c38c388?s=128&d=identicon&r=PG&f=1", "display_name": "coeurdange57", "link": "https://stackoverflow.com/users/4098175/coeurdange57"}, "is_accepted": true, "score": 0, "last_activity_date": 1513179542, "creation_date": 1513179542, "answer_id": 47796943, "question_id": 47675201, "link": "https://stackoverflow.com/questions/47675201/vba-macro-export-table-data-from-excel-file-to-word-and-create-a-section-for-e/47796943#47796943", "title": "VBA Macro - Export table data from Excel file to Word and create a section for each worksheet", "body": "<p>In fact The line</p>\n\n<pre><code>newobj.ActiveWindow.Selection.InsertBreak Type:=7\n</code></pre>\n\n<p>inserts a page break: 7 corresponds to wdPageBreak. I inserted a next page section break by changing 7 to 2 (corresponding to wdSectionBreakNextPage).</p>\n\n<p>Sections in Word don't have names. I insert the name of the worksheet above the table:</p>\n\n<pre><code>    newobj.ActiveWindow.Selection.TypeText sheetName\n    newobj.ActiveWindow.Selection.Style = ActiveDocument.Styles(-2)\n    newobj.ActiveWindow.Selection.TypeParagraph\n</code></pre>\n"}], "owner": {"reputation": 629, "user_id": 4098175, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d30fca6f7d19e2a3fbde02792c38c388?s=128&d=identicon&r=PG&f=1", "display_name": "coeurdange57", "link": "https://stackoverflow.com/users/4098175/coeurdange57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 0, "accepted_answer_id": 47796943, "answer_count": 2, "score": 0, "last_activity_date": 1513179542, "creation_date": 1512566061, "last_edit_date": 1531161705, "question_id": 47675201, "link": "https://stackoverflow.com/questions/47675201/vba-macro-export-table-data-from-excel-file-to-word-and-create-a-section-for-e", "title": "VBA Macro - Export table data from Excel file to Word and create a section for each worksheet", "body": "<p>I use a macro in VBA for exporting data coming from Excel into Word.</p>\n\n<pre><code>Sub ExportToWord()\n    Set obj = CreateObject(\"Word.Application\")\n    obj.Visible = True\n    Set newobj = obj.Documents.Add\n\n    For Each ws In ActiveWorkbook.Sheets\n        ws.UsedRange.Copy\n        newobj.ActiveWindow.Selection.PasteExcelTable False, False, False\n        newobj.ActiveWindow.Selection.InsertBreak Type:=7\n    Next\n        newobj.ActiveWindow.Selection.TypeBackspace\n        newobj.ActiveWindow.Selection.TypeBackspace\n\n    obj.Activate\n    newobj.SaveAs Filename:=Application.ActiveWorkbook.Path &amp; \"\\OLD\\\" &amp; Split(ActiveWorkbook.Name, \".\")(0)\nEnd Sub\n</code></pre>\n\n<p>All data and table layout are retrieved in Word. The Procedure will copy usedRange of each Worksheet to Word and page break by each Worksheet.</p>\n\n<p><strong>I would like to update this script by putting the name of the worksheet just before the copy/paste data for each worksheet.</strong></p>\n\n<p>Could you tell me how to do that?</p>\n\n<hr>\n\n<p>After updated the code:</p>\n\n<pre><code>Sub export_workbook_to_word()\n    Dim sheetName As String\n    Set obj = CreateObject(\"Word.Application\")\n    obj.Visible = True\n    Set newobj = obj.Documents.Add\n\n    For Each ws In ActiveWorkbook.Sheets\n        sheetName = ws.Name\n        ws.UsedRange.Copy\n        newobj.ActiveWindow.TypeText ws.Name\n        newobj.ActiveWindow.Selection.PasteExcelTable False, False, False\n        newobj.ActiveWindow.Selection.InsertBreak Type:=7\n\n    Next\n        newobj.ActiveWindow.Selection.TypeBackspace\n        newobj.ActiveWindow.Selection.TypeBackspace\n\n    obj.Activate\n    newobj.SaveAs Filename:=Application.ActiveWorkbook.Path &amp; \"\\\" &amp; Split(ActiveWorkbook.Name, \".\")(0)\n\nEnd Sub\n</code></pre>\n\n<p>I obtain the error <code>Object doesn't support this property or method</code> on the line <code>newobj.ActiveWindow.TypeText ws.Name</code></p>\n\n<p>Could you please help me?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 0, "creation_date": 1512567607, "post_id": 47675149, "comment_id": 82310186, "body": "Do your files contain <code>Group 1</code> <code>Group 2</code> etc. in the file name or tab or wherever?"}, {"owner": {"reputation": 159, "user_id": 5363515, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/988955301154818/picture?type=large", "display_name": "Calin Lencar", "link": "https://stackoverflow.com/users/5363515/calin-lencar"}, "reply_to_user": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 0, "creation_date": 1512567755, "post_id": 47675149, "comment_id": 82310299, "body": "Yes, they are named exactly &quot;Group 1 5.12.2017&quot; ; &quot;Group 2 5.12.2017&quot; ; &quot;Group 3 5.12.2017&quot;... &quot;Group 15 5.12.2017&quot;."}, {"owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 0, "creation_date": 1512567823, "post_id": 47675149, "comment_id": 82310344, "body": "Then why don&#39;t you just extract it from the file name instead of using a counter."}, {"owner": {"reputation": 159, "user_id": 5363515, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/988955301154818/picture?type=large", "display_name": "Calin Lencar", "link": "https://stackoverflow.com/users/5363515/calin-lencar"}, "reply_to_user": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 0, "creation_date": 1512567917, "post_id": 47675149, "comment_id": 82310403, "body": "Yes I was looking into this as well, just made a function with regEx that seems to work, i&#39;ll post as an answer to see if it&#39;s concrete."}, {"owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 0, "creation_date": 1512568098, "post_id": 47675149, "comment_id": 82310536, "body": "Instead of using regEx just split the string using the space as the delimeter and use the first two parts of the array."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1512571534, "post_id": 47675149, "comment_id": 82312857, "body": "Why not Trim(Left(filename,8))  ?"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 5363515, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/988955301154818/picture?type=large", "display_name": "Calin Lencar", "link": "https://stackoverflow.com/users/5363515/calin-lencar"}, "edited": false, "score": 0, "creation_date": 1512567455, "post_id": 47675646, "comment_id": 82310073, "body": "yes that could be a workaround, thanks I haven&#39;t thought about that xD"}], "tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 1, "last_activity_date": 1512567308, "creation_date": 1512567308, "answer_id": 47675646, "question_id": 47675149, "link": "https://stackoverflow.com/questions/47675149/how-to-add-a-specific-number-at-the-end-of-merging-workbooks/47675646#47675646", "title": "How to Add a specific number at the end of merging workbooks", "body": "<p>That's because Dir() just goes to the next alphabetical file in the directory. You could try putting a leading zero into the filenames like \"Group 01, Group 02, ...\"</p>\n"}, {"comments": [{"owner": {"reputation": 159, "user_id": 5363515, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/988955301154818/picture?type=large", "display_name": "Calin Lencar", "link": "https://stackoverflow.com/users/5363515/calin-lencar"}, "edited": false, "score": 1, "creation_date": 1512567680, "post_id": 47675680, "comment_id": 82310247, "body": "Thank you I will test it."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1512567419, "creation_date": 1512567419, "answer_id": 47675680, "question_id": 47675149, "link": "https://stackoverflow.com/questions/47675149/how-to-add-a-specific-number-at-the-end-of-merging-workbooks/47675680#47675680", "title": "How to Add a specific number at the end of merging workbooks", "body": "<p>This is how it <code>Dir()</code> works - it takes the next file alphabetically. Many programs and functions follow this logic actually. <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/dir-function\" rel=\"nofollow noreferrer\">Dir() MSDN.</a> </p>\n\n<p>However, if you have all the files from 1 to 15 and they are with the same names, you may try this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim firstPart   As String\n    Dim i           As Long\n\n    firstPart = \"Group \"\n\n    For i = 1 To 15\n        Debug.Print firstPart &amp; i &amp; \".xlsx\"\n        'now open this file\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>It will work. Consider checking whether the file <code>Group 7.xlsx</code> exists, before openning it.</p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 5363515, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/988955301154818/picture?type=large", "display_name": "Calin Lencar", "link": "https://stackoverflow.com/users/5363515/calin-lencar"}, "is_accepted": false, "score": 0, "last_activity_date": 1512568092, "creation_date": 1512568092, "answer_id": 47675883, "question_id": 47675149, "link": "https://stackoverflow.com/questions/47675149/how-to-add-a-specific-number-at-the-end-of-merging-workbooks/47675883#47675883", "title": "How to Add a specific number at the end of merging workbooks", "body": "<p>I tried using a function to get the first number(first 1 or 2 digits) and add them in the column that I needed.</p>\n\n<pre><code>Function Number(txt As String) As String\nWith CreateObject(\"VBScript.RegExp\")\n .Pattern = \"\\d{1,2}\"\nNumber = .Execute(txt)(0)\nEnd With\nEnd Function\n\nSub MergeFiles()\nDim Path, Filename As String\nPath = \"C:\\Users\\calin.lencar\\Desktop\\DT Project\\Project Holiday Group Raw \nData\\\"\nFilename = Dir(Path &amp; \"*.csv\")\n\nDo While Filename &lt;&gt; \"\" And Filename &lt;&gt; \"Digital Tracking Panel KPIs v1\"\n  Workbooks.Open Filename:=Path &amp; Filename, ReadOnly:=True\n  LastRow = Range(\"A65536\").End(xlUp).Row\n  Range(\"O2\", Cells(LastRow, \"O\")).Value = Number(Filename)\n  Range(\"A2:X\" &amp; Range(\"A65536\").End(xlUp).Row).Copy\n\nThisWorkbook.Worksheets(21).Activate\n  Range(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial\n  Application.CutCopyMode = False\n  Workbooks(Filename).Close\n  Filename = Dir()\nLoop\n\nMsgBox \"Files have been copied successfully\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 5363515, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/988955301154818/picture?type=large", "display_name": "Calin Lencar", "link": "https://stackoverflow.com/users/5363515/calin-lencar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1512568092, "creation_date": 1512565903, "question_id": 47675149, "link": "https://stackoverflow.com/questions/47675149/how-to-add-a-specific-number-at-the-end-of-merging-workbooks", "title": "How to Add a specific number at the end of merging workbooks", "body": "<p>I have an excel file that use to merge all the raw data's found in the same folder(Group 1, Group 2, ... Group 15, Group 16), using the code below : </p>\n\n<pre><code>Sub MergeFiles()\nDim Path, Filename As String, group As Long\ngroup = 1\nPath = \"C:\\Users\\calin.lencar\\Desktop\\DT Project\\Project Holiday Group Raw \nData\\\"\nFilename = Dir(Path &amp; \"*.csv\")\n\nDo While Filename &lt;&gt; \"\" And Filename &lt;&gt; \"Digital Tracking Panel KPIs v1\"\n  Workbooks.Open Filename:=Path &amp; Filename, ReadOnly:=True\n  LastRow = Range(\"A65536\").End(xlUp).Row\n  Range(\"O2\", Cells(LastRow, \"O\")).Value = group\n  Range(\"A2:X\" &amp; Range(\"A65536\").End(xlUp).Row).Copy\n\nThisWorkbook.Worksheets(21).Activate\n  Range(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial\n  Application.CutCopyMode = False\n  Workbooks(Filename).Close\n\nFilename = Dir()\ngroup = group + 1\nLoop\n\nMsgBox \"Files have been copied successfully\"\nEnd Sub\n</code></pre>\n\n<p>I am trying to add in the column \"O:O\" of each file the group number. The problem is that it opens them alphabetically: \"Group 1, Group 10, Group 11... Group 2, Group 3...\" but the group counter still goes : 1, 2, 3...</p>\n\n<p>Could you please help me, I need the group counter to match the number in the file's name(maybe populate O:O with the first number it encounters?) or make excel open the files after explorer name.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1348, "user_id": 8096817, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tfvYbFFghR8/AAAAAAAAAAI/AAAAAAAAABE/AhKI7LLZyGg/photo.jpg?sz=128", "display_name": "jasinth premkumar", "link": "https://stackoverflow.com/users/8096817/jasinth-premkumar"}, "reply_to_user": {"reputation": 1, "user_id": 5961509, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ZxFbdAvvtis/AAAAAAAAAAI/AAAAAAAAAGA/2EBoGPnPTd8/photo.jpg?sz=128", "display_name": "musthafa muhammed", "link": "https://stackoverflow.com/users/5961509/musthafa-muhammed"}, "edited": false, "score": 0, "creation_date": 1512572640, "post_id": 47675307, "comment_id": 82313693, "body": "may i know what it  does"}, {"owner": {"reputation": 1, "user_id": 5961509, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ZxFbdAvvtis/AAAAAAAAAAI/AAAAAAAAAGA/2EBoGPnPTd8/photo.jpg?sz=128", "display_name": "musthafa muhammed", "link": "https://stackoverflow.com/users/5961509/musthafa-muhammed"}, "edited": false, "score": 0, "creation_date": 1512573076, "post_id": 47675307, "comment_id": 82314018, "body": "after changing the code , list box items not even moving from one to another, previously on double click its used to move single column!!"}, {"owner": {"reputation": 1348, "user_id": 8096817, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tfvYbFFghR8/AAAAAAAAAAI/AAAAAAAAABE/AhKI7LLZyGg/photo.jpg?sz=128", "display_name": "jasinth premkumar", "link": "https://stackoverflow.com/users/8096817/jasinth-premkumar"}, "reply_to_user": {"reputation": 1, "user_id": 5961509, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ZxFbdAvvtis/AAAAAAAAAAI/AAAAAAAAAGA/2EBoGPnPTd8/photo.jpg?sz=128", "display_name": "musthafa muhammed", "link": "https://stackoverflow.com/users/5961509/musthafa-muhammed"}, "edited": false, "score": 0, "creation_date": 1512573122, "post_id": 47675307, "comment_id": 82314051, "body": "wait i am looking for another solution ..thank you FYI"}, {"owner": {"reputation": 1, "user_id": 5961509, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ZxFbdAvvtis/AAAAAAAAAAI/AAAAAAAAAGA/2EBoGPnPTd8/photo.jpg?sz=128", "display_name": "musthafa muhammed", "link": "https://stackoverflow.com/users/5961509/musthafa-muhammed"}, "edited": false, "score": 0, "creation_date": 1512582980, "post_id": 47675307, "comment_id": 82320359, "body": "its coming error in this line,                          count=ListBoxProSlt.Items.Count after ListBoxProSlt . items option is not coming in VBA"}], "tags": [], "owner": {"reputation": 1348, "user_id": 8096817, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tfvYbFFghR8/AAAAAAAAAAI/AAAAAAAAABE/AhKI7LLZyGg/photo.jpg?sz=128", "display_name": "jasinth premkumar", "link": "https://stackoverflow.com/users/8096817/jasinth-premkumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1512740616, "last_edit_date": 1512740616, "creation_date": 1512566359, "answer_id": 47675307, "question_id": 47675141, "link": "https://stackoverflow.com/questions/47675141/how-to-move-multi-column-list-line-items-to-another-list-box-along-with-multi-co/47675307#47675307", "title": "How to move Multi Column List line items to another list box along with multi column value excel vba", "body": "<p>using  loop you can add more item from one list  to another\nhere </p>\n\n<pre><code> Private Sub ListBoxProSlt_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n Dim ProList As String\n count=0\ncolumnIndex = 0\n\nFor rowIndex  = 0 To ListBoxProSit.ListCount - 1\n  count = count + ListBox1.List(rowIndex , columnIndex )\nNext\n i=0\n do until i &gt; count  \n    ProList = ListBoxProSlt.List(i)\n    ListBoxProRec.AddItem ProList\n i=i+1\nloop\n\nEnd Sub\n</code></pre>\n\n<p>i hope it solve's your problem</p>\n"}], "owner": {"reputation": 1, "user_id": 5961509, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ZxFbdAvvtis/AAAAAAAAAAI/AAAAAAAAAGA/2EBoGPnPTd8/photo.jpg?sz=128", "display_name": "musthafa muhammed", "link": "https://stackoverflow.com/users/5961509/musthafa-muhammed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 563, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512740616, "creation_date": 1512565879, "last_edit_date": 1531164843, "question_id": 47675141, "link": "https://stackoverflow.com/questions/47675141/how-to-move-multi-column-list-line-items-to-another-list-box-along-with-multi-co", "title": "How to move Multi Column List line items to another list box along with multi column value excel vba", "body": "<p>Try to move listbox items with the below code.\nits working, but its coming only one column value, there are total 6 columns in the list box</p>\n\n<pre><code> Private Sub ListBoxProSlt_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n Dim ProList As String\n    ProList = ListBoxProSlt.List(ListBoxProSlt.ListIndex)\n    ListBoxProRec.AddItem ProList\n\nEnd Sub\n</code></pre>\n\n<p>Any suggestion to move all columns value to next list box!! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1512566985, "post_id": 47675100, "comment_id": 82309734, "body": "Am I correct to understand that instead exiting the sub as the code shows now, you want evaluate the offending cell on the fly and then retest it?"}, {"owner": {"reputation": 1, "user_id": 9061915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84b651e1551745243ec6ba3eb311a9b1?s=128&d=identicon&r=PG&f=1", "display_name": "B. Harmsen", "link": "https://stackoverflow.com/users/9061915/b-harmsen"}, "edited": false, "score": 0, "creation_date": 1512597620, "post_id": 47675100, "comment_id": 82327914, "body": "I would like the code to refresh my data no matter what is happening in my workbook if I click on the refresh button"}, {"owner": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1512689027, "post_id": 47675100, "comment_id": 82371031, "body": "so @pnuts ? Do You get it? :D"}], "owner": {"reputation": 1, "user_id": 9061915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84b651e1551745243ec6ba3eb311a9b1?s=128&d=identicon&r=PG&f=1", "display_name": "B. Harmsen", "link": "https://stackoverflow.com/users/9061915/b-harmsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512565756, "creation_date": 1512565756, "question_id": 47675100, "link": "https://stackoverflow.com/questions/47675100/so-function-do-i-use-it", "title": "So Function? Do I use it?", "body": "<p>I have a refresh button that has this code on it. I would like my spreadsheets to refresh no matter what when I click on the refresh button even if there is an error of =REF! which in my code I say to evaluate some of my sheets and if there is a =REF! to be done and if there is no =REF! then to record the i3 and i4 into my data sheet. </p>\n\n<pre><code>Sub logs()\n\nDim Sht As Worksheet\nDim checkRange As Range, CheckCell As Range\n\nFor Each Sht In ThisWorkbook.Sheets\nWith Sht\n    Select Case .Name\n        Case \"Final Four\", \"Top Left\", \"Bottom Left\", \"Top Right\", \"Bottom Right\"\n            Set checkRange = .Range(\"A1:Z100\") ' set the range for the current sheet\n\n            For Each CheckCell In checkRange\n                If IsError(CheckCell) Then If CheckCell = CVErr(2023) Then Exit Sub\n                Next CheckCell\n\n        Case Else\n            ' do nothing\n\n    End Select\nEnd With\nNext Sht\n\nActiveSheet.EnableCalculation = True\n\nlst = Sheets(\"data\").UsedRange.Rows.Count\nx = lst + 1\n\n    ' Display a message when one of the designated cells has been\n    ' changed.\n    ' Place your code here.\n    Sheets(\"data\").Range(\"A\" &amp; x) = ActiveSheet.Range(\"I3\")\n    Sheets(\"data\").Range(\"B\" &amp; x) = ActiveSheet.Range(\"I4\")\n\n\nEnd Sub\n</code></pre>\n\n\n\n\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1512565876, "post_id": 47674966, "comment_id": 82309005, "body": "Please specify why the workaround is not possible for you. The amount of prints is irrelevant."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512567016, "post_id": 47674966, "comment_id": 82309751, "body": "Try this <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/sheets-printout-method-excel\" rel=\"nofollow noreferrer\">example</a> <code>DoCMD.PrintOut From:=2, To:=3, Copies:=3</code>"}, {"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512568431, "post_id": 47674966, "comment_id": 82310740, "body": "That did not work @nishitdey :("}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512568596, "post_id": 47674966, "comment_id": 82310845, "body": "Then it is out of my reach :(. Sorry. Did you go to the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/sheets-printout-method-excel\" rel=\"nofollow noreferrer\">MSDN</a> link"}, {"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1512568802, "post_id": 47674966, "comment_id": 82310988, "body": "yes i&#39;ve been there but nothing usefull found...  thanks for your help"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1512570767, "post_id": 47676557, "comment_id": 82312315, "body": "yes copys is a variable  It does the same if I just type in 12 (the variant is correct all the time i checked that with a msgbox)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1512572132, "post_id": 47676557, "comment_id": 82313301, "body": "I mean... <code>copys</code> variable type is <code>Variant</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1512575643, "post_id": 47676557, "comment_id": 82315783, "body": "<code>Dim Copyes As String</code> should be <code>Dim Copyes As Variant</code>"}, {"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1512630248, "post_id": 47676557, "comment_id": 82337803, "body": "oh okay i&#39;ll try that. what is the difference? just so i understand the code              ;-)"}, {"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1512631254, "post_id": 47676557, "comment_id": 82338256, "body": "hey @David G.  thanks for the help with the variant that works now with the 100 copys but i get an error at the end when i close my report... can&#39;t tell why... any ideas there?"}, {"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1512631771, "post_id": 47676557, "comment_id": 82338493, "body": "okay I made a stupid mistake^^ thanks for the help @all it works now."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1512653785, "post_id": 47676557, "comment_id": 82352183, "body": "Updated my answer trying to answer your question."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 0, "last_activity_date": 1512653760, "last_edit_date": 1512653760, "creation_date": 1512570197, "answer_id": 47676557, "question_id": 47674966, "link": "https://stackoverflow.com/questions/47674966/docmd-printout-does-only-print-one-copy/47676557#47676557", "title": "DoCmd.PrintOut does only Print one copy", "body": "<p>Did you declared <code>copyes</code> as Variant?</p>\n\n<p>Reading <code>PrintOut</code> documentation, I found the following:</p>\n\n<p><strong>Name</strong>    Copies  </p>\n\n<p><strong>Required/Optional</strong>   Optional</p>\n\n<p><strong>Data Type</strong>   Variant </p>\n\n<p><strong>Description</strong>  The number of copies to print. If you leave this argument blank, the default (1) is assumed.</p>\n\n<blockquote>\n  <p><a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-printout-method-access\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-printout-method-access</a></p>\n</blockquote>\n\n<p>Also, try using a value instead of a variable just for testing.</p>\n\n<hr>\n\n<p>When you use functions is really important to read the function documentation, to know what kind of variables this function (or procedure) expects.\nIn this case, this function uses a <code>Variant</code> variable (Don't know why), then you should provide a <code>Variant</code> object.\nLet me give you an example.</p>\n\n<p>You have a drink machine.\nLet's think about money in terms of variants. <code>paper</code> and <code>metal</code>.\nYour drink machine only accepts <code>paper</code> as money. If you try to insert <code>metal</code> (coins), your machine will give an error. \nIn this case you need to provide the specific kind of money that your drink machine accepts.</p>\n\n<p>Hope this clarifications let you understand better the issue and help you to read the documentation of the functions or procedure you are using.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1512572059, "post_id": 47677029, "comment_id": 82313238, "body": "thanks for the awnser. Im sorry but i had to correct my question. I used you&#39;r first option... but thats the one that does not work... it does only print one copy..."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1512572130, "post_id": 47677029, "comment_id": 82313299, "body": "I think you should show us a bit more of the code so we can see where you declare copys and update its value"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "edited": false, "score": 0, "creation_date": 1512577843, "post_id": 47677029, "comment_id": 82317298, "body": "Have you tried  &quot;Dim Copyes As Variant&quot; like David suggested?"}], "tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1512571592, "creation_date": 1512571592, "answer_id": 47677029, "question_id": 47674966, "link": "https://stackoverflow.com/questions/47674966/docmd-printout-does-only-print-one-copy/47677029#47677029", "title": "DoCmd.PrintOut does only Print one copy", "body": "<p>I don't think I understand why you have \"Copies\" right after \"PrintOut\". All you want is to print a certain number of copies, right? You can simply put</p>\n\n<pre><code>DoCmd.PrintOut , , , , copys 'Print report\n</code></pre>\n\n<p>Alternatively, you should also be able to just write</p>\n\n<pre><code>DoCmd.PrintOut Copies:=copys 'Print report\n</code></pre>\n\n<p>You don't need to write acHigh as that is the default value</p>\n"}], "owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "accepted_answer_id": 47676557, "answer_count": 2, "score": -1, "last_activity_date": 1524948629, "creation_date": 1512565341, "last_edit_date": 1522931132, "question_id": 47674966, "link": "https://stackoverflow.com/questions/47674966/docmd-printout-does-only-print-one-copy", "title": "DoCmd.PrintOut does only Print one copy", "body": "<p>I saw that there is a <a href=\"https://stackoverflow.com/questions/4305363/ms-access-2010-docmd-printout-not-printing-specified-number-of-copies\">similar question</a> as mine but the workaround that is given there is not a possible way for me.\nI have to print up to 1000 or more.</p>\n\n<pre><code> DoCmd.OpenReport Report, acViewReport 'Open report\n DoCmd.PrintOut , , , acHigh, copys' Print report\n</code></pre>\n\n<p>(As copys I have specified the amount of copys.)</p>\n\n<p>Did I do something wrong?</p>\n\n<p>Is there an other way to print the Report out?</p>\n\n<p>Thanks for any help.</p>\n\n<p>complete Code:</p>\n\n<pre><code>Private Sub cmd_openreport_Click()\n\n'Set Variables\nDim Report\nDim Etikette\nDim Copyes As String\nDim SQLString\nDim SQLString2\n\n\nDoCmd.SetWarnings False 'Turns Off Warnings\n\nEtikette = comb_etiketten_auswahl 'Etikette Equals the             comb_etiketten_auswahl value\nReport = comb_etiketten_layout 'Report equals the value in the dropdown list\nCopyes = Forms!frm_Hauptmenu!comb_etiketten_auswahl.Column(1)\n\n\n'If The Etiketten Dropdown is empty message to client\nIf Etikette &lt;&gt; \"\" Then\n\n'Do Nothing/Continue\n\nElse\nMsgBox \"Bitte w\u00e4hlen Sie einen Datensatz aus\"\nExit Sub\n\nEnd If\n\n\n'If The Report Dropdown is empty message to client\nIf Report &lt;&gt; \"\" Then\n\n'Do Nothing (because dropdown is mot empty)\n\nElse\nMsgBox \"Bitte w\u00e4hlen Sie ein Etikettenlayout aus\"\nExit Sub\n\nEnd If\n\nMsgBox anzahl\n'If Amount of copies is less than 1 message to client\nIf anzahl &gt; 0 Then\n\n\nOn Error GoTo Error_MayCauseAnError\n    DoCmd.OpenReport Report, acViewReport 'Open report\n    DoCmd.PrintOut , , , , Copyes\n    DoCmd.Close Report ' Close the Report\n</code></pre>\n\n<p><strong>EDIT :</strong></p>\n\n<p><strong>This question is Irelevant and does not have a purpose anymore!\nit was an internal script mistake!</strong></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 1, "last_activity_date": 1512570156, "creation_date": 1512570156, "answer_id": 47676548, "question_id": 47674882, "link": "https://stackoverflow.com/questions/47674882/loop-through-an-array-and-then-move-some-elements/47676548#47676548", "title": "Loop through an array and then move some elements", "body": "<p>The problem you're having is with </p>\n\n<pre><code>Cells(i, 4) = partVal\n</code></pre>\n\n<p>This will always put the item it finds into column D, overwriting the previous value each time it finds something new. You can solve this by making a counter variable.</p>\n\n<pre><code>Dim count As Integer\n\nFor i = 2 To maxRow\n    fullVal = dataSheet.Cells(i, 3).Value\n    splitArray() = Split(fullVal, \"|\")\n    count = 4\n    For j = 0 To UBound(splitArray)\n        partVal = splitArray(j)\n        If isInArray(partVal, List_Array) = False Then\n            Cells(i, count) = partVal\n            count = count + 1 \n        End If\n\n    Next j\nNext i\n</code></pre>\n\n<p>This should increase the column number any time that it finds a match and reset it back to the start when you begin checking with a new word</p>\n"}], "owner": {"reputation": 43, "user_id": 7598809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4ab0a2cf0c9f59823a6fa4e2a5c7f5e0?s=128&d=identicon&r=PG&f=1", "display_name": "eM_Sk", "link": "https://stackoverflow.com/users/7598809/em-sk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 47676548, "answer_count": 1, "score": 0, "last_activity_date": 1512570156, "creation_date": 1512565102, "last_edit_date": 1531164843, "question_id": 47674882, "link": "https://stackoverflow.com/questions/47674882/loop-through-an-array-and-then-move-some-elements", "title": "Loop through an array and then move some elements", "body": "<p>So, im trying to write a code that will loop through an array and find if that element is in another array, then I'm trying to play with them, as I'm newbie to VBA, some of the code I wrote myself, and some of it I borrow from here (like this fuction below)</p>\n\n<p>To be more clear (as you can see below - link to a screenshot), im looping through column data and looking if each element (in each cell) is on my list to the left. If yes it should extract it next to the data column. But what I wrote so far it is extracting only one of element. I'm not sure where I should add some condition which would work like on the screen below.</p>\n\n<p><a href=\"https://ibb.co/kn70jb\" rel=\"nofollow noreferrer\">https://ibb.co/kn70jb</a></p>\n\n<pre><code>Sub Find_other()\n\nDim i, j, As Integer\nDim splitArray() As String\n\n\n\nSet dataSheet = Worksheets(\"Data\")\nmaxRow = dataSheet.UsedRange.Rows(dataSheet.UsedRange.Rows.Count).Row\n\n\n\nRange(\"A2\").Select\nList_Array = Range(Selection, Selection.End(xlDown)).Value\n\n\n\nFor i = 2 To maxRow\n    fullVal = dataSheet.Cells(i, 3).Value\n    splitArray() = Split(fullVal, \"|\")\n    For j = 0 To UBound(splitArray)\n        partVal = splitArray(j)\n        If isInArray(partVal, List_Array) = False Then\n        Cells(i, 4) = partVal\n        End If\n\n    Next j\nNext i\n\nEnd Sub\n\n\nFunction isInArray(ByVal stringToBeFound As String, ByVal arr As Variant) As Boolean\nFor Each element In arr\n    If element = stringToBeFound Then\n        isInArray = True\n        Exit Function\n    End If\nNext element\nEnd Function\n</code></pre>\n\n<p>Thanks for any suggestions.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "edited": false, "score": 0, "creation_date": 1512564734, "post_id": 47674659, "comment_id": 82308238, "body": "i suggest you add examples and snapshots to better explain what you&#39;re trying to do"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512564897, "post_id": 47674659, "comment_id": 82308344, "body": "Also provide some more code to this, to get help much more better then a dyanamic code. Thanks"}, {"owner": {"reputation": 175, "user_id": 7812800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1536b86a12e611c36ffa45f9a00ee31d?s=128&d=identicon&r=PG&f=1", "display_name": "Neal Mc Beal", "link": "https://stackoverflow.com/users/7812800/neal-mc-beal"}, "edited": false, "score": 0, "creation_date": 1512565460, "post_id": 47674659, "comment_id": 82308765, "body": "Hey you 2. I have not more code. I&#39;m a completly beginner in vba so i just use if else statements to get the result."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 7812800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1536b86a12e611c36ffa45f9a00ee31d?s=128&d=identicon&r=PG&f=1", "display_name": "Neal Mc Beal", "link": "https://stackoverflow.com/users/7812800/neal-mc-beal"}, "edited": false, "score": 0, "creation_date": 1512565382, "post_id": 47674833, "comment_id": 82308715, "body": "Hey ty for your answer :) I will try it. My idea was, that i have a counter cell for example A1 = 0 and every time i press on &quot;Insert&quot; the counter variable gets incremented. And the Range is the variable. I.e. in pseudo code: counter_variable = 5 Range(&quot;H&quot;, counter_variable).... but i don&#39;t know how to write something like this. With this solution, i think i can save, close and reopen the file to continue with my work."}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 1, "last_activity_date": 1512564924, "creation_date": 1512564924, "answer_id": 47674833, "question_id": 47674659, "link": "https://stackoverflow.com/questions/47674659/dynamic-range-in-excel-vba/47674833#47674833", "title": "Dynamic Range in Excel VBA", "body": "<p>just:</p>\n\n<pre><code>Range(\"E\" &amp; Rows.Count).End(xlUp).Offset(1).Value= \"Yes\"\n</code></pre>\n\n<p>But mine as well as your code has one significant weakness - they may give unexpected results when you switch between workbooks and worksheets. But it is answer for your question.  </p>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 7812800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1536b86a12e611c36ffa45f9a00ee31d?s=128&d=identicon&r=PG&f=1", "display_name": "Neal Mc Beal", "link": "https://stackoverflow.com/users/7812800/neal-mc-beal"}, "edited": false, "score": 0, "creation_date": 1512568376, "post_id": 47675443, "comment_id": 82310702, "body": "Hey ty for the reply. I found an answer. A very simple answer for me, a vba noob :) i&#39;ll post it"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 175, "user_id": 7812800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1536b86a12e611c36ffa45f9a00ee31d?s=128&d=identicon&r=PG&f=1", "display_name": "Neal Mc Beal", "link": "https://stackoverflow.com/users/7812800/neal-mc-beal"}, "edited": false, "score": 0, "creation_date": 1512568585, "post_id": 47675443, "comment_id": 82310836, "body": "@NealMcBeal Good...............please update your original question with the best answer you have found."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1512566696, "creation_date": 1512566696, "answer_id": 47675443, "question_id": 47674659, "link": "https://stackoverflow.com/questions/47674659/dynamic-range-in-excel-vba/47675443#47675443", "title": "Dynamic Range in Excel VBA", "body": "<p>Something like:</p>\n\n<pre><code>Sub ButtonCode()\n    Dim E2 As Range, n As Long\n\n    Set E2 = Range(\"E2\")\n\n    If E2 = \"\" Then\n        E2 = \"yes\"\n    Else\n        n = Cells(Rows.Count, \"E\").End(xlUp).Row + 1\n        Range(\"E2:E\" &amp; n) = \"yes\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 7812800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1536b86a12e611c36ffa45f9a00ee31d?s=128&d=identicon&r=PG&f=1", "display_name": "Neal Mc Beal", "link": "https://stackoverflow.com/users/7812800/neal-mc-beal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 47674833, "answer_count": 2, "score": -1, "last_activity_date": 1512568533, "creation_date": 1512564429, "last_edit_date": 1531164843, "question_id": 47674659, "link": "https://stackoverflow.com/questions/47674659/dynamic-range-in-excel-vba", "title": "Dynamic Range in Excel VBA", "body": "<p>I have a UserForm with some Checkboxes and TextFields and when I press on the \"Insert\" button the inputs are pasted in row 1 column A - 7. </p>\n\n<p>I have the following problem:</p>\n\n<p>After I press the button, I want to fill out the UserForm again and paste the data in row 2 and then 3, 4, 5, 6 and so on. Can someone tell me how I can jump dynamically to the next row and insert there the data?</p>\n\n<p>My codesnippet for a checkbox is the following: </p>\n\n<pre><code>If UserForm1.eig_hand.Value = True Then\n    Range(\"E3\").Value = \"Yes\"\nEnd If\n</code></pre>\n\n<p>This snippet will be executed after I press the \"Insert button\" and it would be very helpful, when I can close and reopen the Excel file and continue in the row where I closed the file. I know that I have a static expression in the Code snippet but I'm a completly beginner in VBA</p>\n\n<p>Edit:</p>\n\n<p>I found a solution for my problem.\nI have a counter variable in a cell for example cell(5,1) and my code looks like this:</p>\n\n<pre><code>Dim counter_var As Integer\ncounter_var = Cells(5, 1)\nIf UserForm1.eig_hand.Value = True Then\nCells(counter_var, 4).Value = \"Ja\"\nEnd If\nIf UserForm1.eig_kmu.Value = True Then\nCells(counter_var, 5).Value = \"Ja\"\nEnd If\n</code></pre>\n\n<p>And at the end of my code i set the counter_var += 1.\nTy for all the replies :)</p>\n"}, {"tags": ["excel", "vba", "oracle11g", "adodb"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512562548, "post_id": 47674077, "comment_id": 82306910, "body": "What happens if you remove those lines"}], "answers": [{"comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512563790, "post_id": 47674198, "comment_id": 82307618, "body": "Please put the path where the database is stored in the <code>conStr</code> and close the Database and try again. Thanks."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512563992, "post_id": 47674198, "comment_id": 82307756, "body": "Please check the modified solution. Thanks"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9061522"}, "edited": false, "score": 0, "creation_date": 1512564834, "post_id": 47674198, "comment_id": 82308303, "body": "Thank you. I have tried the modified solution and now it return the previous error again &quot;Runtime error &#39;-2147418113 (8000ffff)&#39;: Catastrophic failure&quot; perhaps this is something to do the the DB settings? Should I maybe contact a DBA to restart to DB or otherwise?"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512565127, "post_id": 47674198, "comment_id": 82308514, "body": "Take the OraClient12 and oraClient11 references (4 in all) out of the Path environment variable and replaced it with a reference to the SysWow64 folder, as a 32bit version of the oraClient11 is stored there. (If this does not help. Then it is out of my range :("}, {"owner": {"user_type": "does_not_exist", "display_name": "user9061522"}, "edited": false, "score": 0, "creation_date": 1512565813, "post_id": 47674198, "comment_id": 82308971, "body": "I will try that and if it works I will report back and let you know. Thank you for you help!!"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512566677, "post_id": 47674198, "comment_id": 82309515, "body": "Your Welcome. And sorry, if i am not that much of a help"}], "tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": false, "score": 0, "last_activity_date": 1512563915, "last_edit_date": 1512563915, "creation_date": 1512562897, "answer_id": 47674198, "question_id": 47674077, "link": "https://stackoverflow.com/questions/47674077/vba-adodb-connect-to-remote-oracle-db/47674198#47674198", "title": "VBA - ADODB connect to remote Oracle db", "body": "<p>Can you try to access the ADODB as below</p>\n\n<pre><code>Dim strSQL  As String, conStr as String\nDim cnn As New ADODB.Connection\nDim rs As New ADODB.Recordset\n\n\nconStr = \"Provider=OraOLEDB.Oracle;Data Source=(DESCRIPTION=(CID=GTU_APP)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=xxxxxxx)(PORT=xxxx)))(CONNECT_DATA=(SID=xxxxx)(SERVER=DEDICATED)));User Id=xxxxxx;Password=xxxxxxx;\"\n\nDim SQLQuery As String\nSQLQuery = \"SELECT User_Id, Prof_Id FROM user_profile ORDER BY User_Id ASC\"\n\ncnn.open conStr   \nrs.Open SQLQuery, cnn, adOpenStatic, adLockOptimistic, adCmdText\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9061522"}, "is_accepted": true, "score": 0, "last_activity_date": 1512843307, "creation_date": 1512843307, "answer_id": 47731672, "question_id": 47674077, "link": "https://stackoverflow.com/questions/47674077/vba-adodb-connect-to-remote-oracle-db/47731672#47731672", "title": "VBA - ADODB connect to remote Oracle db", "body": "<p>I fixed the error so I though I would update for anyone  with the same issue who finds this thread. </p>\n\n<p>It turns out that the 'Catastrophic Failure' error was due to my Oracle ODBC driver (oraOLEDB.oracle) becoming somehow corrupted, I couldn't even reinstall it properly, the error only occurred on my machine.</p>\n\n<p>In the end I did a system restore to a point from before the issue and all was fixed. Not the most elegant solution but it worked. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9061522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2717, "favorite_count": 0, "accepted_answer_id": 47731672, "answer_count": 2, "score": 1, "last_activity_date": 1512843307, "creation_date": 1512562432, "last_edit_date": 1512563391, "question_id": 47674077, "link": "https://stackoverflow.com/questions/47674077/vba-adodb-connect-to-remote-oracle-db", "title": "VBA - ADODB connect to remote Oracle db", "body": "<p>I am developing an Excel VBA program that I want to connect to a remote Oracle 11g database, run a query, and return the data to Excel.</p>\n\n<p>Connection strings and drivers are all OK as far as I know. (see below)</p>\n\n<p>It was working perfectly for a while yesterday, connecting to db and returning with correct data. Then I saved and closed the workbook, opened it 20 minutes later (no changes made!) and when I ran the macro I got the following error: </p>\n\n<blockquote>\n  <p>Runtime error '-2147418113 (8000ffff)': Catastrophic failure</p>\n</blockquote>\n\n<p>any ideas what could be causing the error?\nCould it be something on the DB's side? </p>\n\n<p>Thanks</p>\n\n<pre><code>Sub ExtractFromOracle(environment As String)\n\nDim cn As ADODB.connection\nDim recordSet As ADODB.recordSet\nSet cn = CreateObject(\"ADODB.Connection\")\nSet recordSet = CreateObject(\"ADODB.recordset\")\n\nDim SQLQuery As String\nSQLQuery = \"SELECT User_Id, Prof_Id FROM user_profile ORDER BY User_Id ASC\"\n\nDim returnData As Variant\nDim returnedRowsCount As Integer\n\nDim connectionString As String\nconnectionString = ReturnConnectionString(environment)\n\n\ncn.Open (connectionString) ------------&gt; ERROR OCCURS HERE\n\n\nSet recordSet = cn.Execute(SQLQuery)\nreturnData = Application.Transpose(recordSet.GetRows)\nreturnedRowsCount = UBound(returnData)\n\nIf Not SheetExist(environment) Then\nCreateTab (environment)\nEnd If\n\nWorksheets(environment).Activate\nActiveSheet.Range(\"A1:B\" &amp; returnedRowsCount) = returnData\n\nSet rs = Nothing\nSet cn = Nothing\n\nConsolidateUsers (environment)\n\n\nEnd Sub\n</code></pre>\n\n<p>CONNECTION STRING : </p>\n\n<pre><code>\"Provider=OraOLEDB.Oracle;Data Source=(DESCRIPTION=(CID=GTU_APP)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=xxxxxxx)(PORT=xxxx)))(CONNECT_DATA=(SID=xxxxx)(SERVER=DEDICATED)));User Id=xxxxxx;Password=xxxxxxx;\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512561652, "post_id": 47673764, "comment_id": 82306388, "body": "Can you Try the debug mode and the value for <code>wB.Name</code>. I think Workbook name also contains the extension. Thanks"}, {"owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "edited": false, "score": 0, "creation_date": 1512562244, "post_id": 47673764, "comment_id": 82306733, "body": "@Bluesector I checked there is nothing error in this code"}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512562333, "post_id": 47673942, "comment_id": 82306786, "body": "Now he is highlighting me With wb2.Sheets(&quot;AAA&quot;) - starting to get insane :-D"}, {"owner": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512562416, "post_id": 47673942, "comment_id": 82306828, "body": "Weird ^^ What is the error? You need to make sure, that the workbook you are starting the macro from does contain a sheet called &quot;AAA&quot;."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512562524, "post_id": 47673942, "comment_id": 82306896, "body": "Run-time error 91: Object variable or With block variable not set. Unfortunately, the workbook contains the sheet."}, {"owner": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512562792, "post_id": 47673942, "comment_id": 82307041, "body": "Do you have stored the macro in the workbook, which contains the sheet &quot;AAA&quot;? If it&#39;s stored in your PERSONAL.XLSB, the error might be caused by this. In that case you need to adapt this line of code: <code>Set wb2 = ThisWorkbook</code>"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512563039, "post_id": 47673942, "comment_id": 82307181, "body": "the macro is stored in the same workbook. I changed the position of the &quot;End if&quot; and I don&#39;t get an error anymore. But I still can&#39;t get the file name in the cell. Nothing."}, {"owner": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512563292, "post_id": 47673942, "comment_id": 82307317, "body": "Step through the code with F8 and check the variables wb1 and wb2 during runtime. The code still works for me with the changes though."}], "tags": [], "owner": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "is_accepted": false, "score": 0, "last_activity_date": 1512562030, "creation_date": 1512562030, "answer_id": 47673942, "question_id": 47673764, "link": "https://stackoverflow.com/questions/47673764/copy-workbook-name-to-a-cell-in-another-workbook/47673942#47673942", "title": "Copy workbook name to a cell in another workbook", "body": "<p>What do you want to achieve with </p>\n\n<pre><code>Dir(Wb1.FullName)\n</code></pre>\n\n<p>That is the source of your problem. Just delete the <code>Dir</code> and the <code>()</code> and its running: <code>.Range(\"A1\").Value = Wb1.FullName</code></p>\n"}, {"comments": [{"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512562645, "post_id": 47674118, "comment_id": 82306964, "body": "Run-time error 91: Object variable or With block variable not set. Hm :-/"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512563036, "post_id": 47674118, "comment_id": 82307177, "body": "@bluesector: Remove <code>WIth</code> and <code>End With</code>"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512563128, "post_id": 47674118, "comment_id": 82307230, "body": "Had to change the position of the &quot;End if&quot;. Now I don&#39;t get an error anymore. Unfortunately, still doesn&#39;t copy any file name in the cell."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512563338, "post_id": 47674118, "comment_id": 82307351, "body": "Hey thank you. No Error - but also no File Name :-(. What could cause this."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512564366, "post_id": 47674118, "comment_id": 82308004, "body": "OTIF File is open. Macro is stored in the workbook that has the sheet &#39;AAA&#39; - Still nothing in A1..."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512564454, "post_id": 47674118, "comment_id": 82308054, "body": "@Bluesector try edited code, added some DEBUG options"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512565292, "post_id": 47674118, "comment_id": 82308648, "body": "Nothing happens. Not even a message :/"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512565375, "post_id": 47674118, "comment_id": 82308705, "body": "@Bluesector  so you are not passing the If criteria"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512566757, "post_id": 47674118, "comment_id": 82309583, "body": "I only have one xlsm file open. This file contains the &quot;AAA&quot; sheet. The other XLS file is the OTIF one"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1512564439, "last_edit_date": 1512564439, "creation_date": 1512562597, "answer_id": 47674118, "question_id": 47673764, "link": "https://stackoverflow.com/questions/47673764/copy-workbook-name-to-a-cell-in-another-workbook/47674118#47674118", "title": "Copy workbook name to a cell in another workbook", "body": "<p><strong><em>Full Edited code:</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub Filename()\n\nDim Wb1 As Workbook, wb2 As Workbook, wB As Workbook\nDim ws As Worksheet\n\nSet wb2 = ThisWorkbook\n\nOn Error Resume Next\nSet ws = wb2.Worksheets(\"AAA\")\nOn Error GoTo 0\nIf ws Is Nothing Then ' make sure \"AAA\" sheet exists\n    MsgBox \"AAA sheet does not exist, or has been renamed\", vbCritical\n    Exit Sub\nEnd If\n\nFor Each wB In Application.Workbooks\n    If Left(wB.Name, 4) = \"OTIF\" Then\n        ' for DEBUG ONLY\n        ws.Range(\"A1\").Value = wB.Sheets.Count\n\n        ' 2nd Debug option\n        ws.Range(\"A1\").Value = \"Test\"\n\n       ' ws.Range(\"A1\").Value = wB.Name\n\n        MsgBox \"DONE!\"\n        Exit For\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512563761, "post_id": 47674424, "comment_id": 82307601, "body": "No filename in A1 :-("}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512564032, "post_id": 47674424, "comment_id": 82307787, "body": "@Bluesector Did you check AAA sheet, cell A1? I have tested this code by using dummies."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512564103, "post_id": 47674424, "comment_id": 82307830, "body": "The Macro is stored in the same file as sheet &quot;AAA&quot;. The &quot;OTIF&quot; File is open. Still nothing in A1."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512564323, "post_id": 47674424, "comment_id": 82307976, "body": "Can you step through the code and see if it is entering <code>If....Loop</code> and executing this line <code>ThisWorkbook.Sheets(&quot;AAA&quot;).Range(&quot;A1&quot;).Value = wB.FullName</code>."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512564478, "post_id": 47674424, "comment_id": 82308068, "body": "the code skips ThisWorkbook.Sheets(&quot;AAA&quot;).Range(&quot;A1&quot;).Value = wB.FullName... Why? The file is open."}, {"owner": {"reputation": 551, "user_id": 1475916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb025b6e7d0824fc04113b0aa737d0?s=128&d=identicon&r=PG", "display_name": "Dave Thornton", "link": "https://stackoverflow.com/users/1475916/dave-thornton"}, "edited": false, "score": 0, "creation_date": 1512573651, "post_id": 47674424, "comment_id": 82314434, "body": "By skipping the line do you mean that the if statement never meets a true condition? Might sound silly, but are you certain the filename pattern is correct and the files are all caps? Maybe convert to all uppercase in the if statement to be safe? UCase(Left(wB.Name, 4))"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512626181, "post_id": 47674424, "comment_id": 82336174, "body": "Somehow not the macro works... I think this was an excel error."}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": true, "score": 0, "last_activity_date": 1512563648, "creation_date": 1512563648, "answer_id": 47674424, "question_id": 47673764, "link": "https://stackoverflow.com/questions/47673764/copy-workbook-name-to-a-cell-in-another-workbook/47674424#47674424", "title": "Copy workbook name to a cell in another workbook", "body": "<p>I looked at your code and it can be simplified like below.</p>\n\n<pre><code>Sub Filename()\nDim wB As Workbook\nFor Each wB In Application.Workbooks\n    If Left(wB.Name, 4) = \"OTIF\" Then\n        ThisWorkbook.Sheets(\"AAA\").Range(\"A1\").Value = wB.FullName\n        Exit For\n    End If\nNext\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nMsgBox \"DONE!\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1865, "favorite_count": 0, "accepted_answer_id": 47674424, "answer_count": 3, "score": -1, "last_activity_date": 1578835106, "creation_date": 1512561464, "last_edit_date": 1578835106, "question_id": 47673764, "link": "https://stackoverflow.com/questions/47673764/copy-workbook-name-to-a-cell-in-another-workbook", "title": "Copy workbook name to a cell in another workbook", "body": "<p>I want to search for an open file named \"OTIF\"[...].</p>\n\n<p>When the macro finds the workbook, it should paste the file name into \"sheet1\" Cell A1 in another workbook (wb2).</p>\n\n<pre><code>Sub Filename()\n\nDim Wb1 As Workbook, wb2 As Workbook, wB As Workbook\n\nFor Each wB In Application.Workbooks\n    If Left(wB.Name, 4) = \"OTIF\" Then\n        Set Wb1 = wB\n        Exit For\n    End If\nNext\n\nIf Not Wb1 Is Nothing Then\n    Set wb2 = ThisWorkbook\nEnd If\n\nWith wb2.Sheets(\"AAA\")\n    .Range(\"A1\").Value = Dir(Wb1.FullName)\nEnd With\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nMsgBox \"DONE!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "excel", "vba"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512560799, "post_id": 47673443, "comment_id": 82305861, "body": "Is it your homework?"}, {"owner": {"reputation": 5, "user_id": 9045296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057ef16ee976b3af98acbd15f5a39bf?s=128&d=identicon&r=PG&f=1", "display_name": "Awsg", "link": "https://stackoverflow.com/users/9045296/awsg"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512560864, "post_id": 47673443, "comment_id": 82305905, "body": "helping my brother &#39;s vba , but my knowledge is pretty limited"}, {"owner": {"reputation": 5, "user_id": 9045296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057ef16ee976b3af98acbd15f5a39bf?s=128&d=identicon&r=PG&f=1", "display_name": "Awsg", "link": "https://stackoverflow.com/users/9045296/awsg"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512560934, "post_id": 47673443, "comment_id": 82305958, "body": "having my term break , since i am free wanted to do sth and learn sth"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512560967, "post_id": 47673443, "comment_id": 82305974, "body": "Can&#39;t see your efforts..."}, {"owner": {"reputation": 5, "user_id": 9045296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057ef16ee976b3af98acbd15f5a39bf?s=128&d=identicon&r=PG&f=1", "display_name": "Awsg", "link": "https://stackoverflow.com/users/9045296/awsg"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512561172, "post_id": 47673443, "comment_id": 82306103, "body": "hmm , give me 10 mins let me try again , i do have some code but fail to produce"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9045296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057ef16ee976b3af98acbd15f5a39bf?s=128&d=identicon&r=PG&f=1", "display_name": "Awsg", "link": "https://stackoverflow.com/users/9045296/awsg"}, "edited": false, "score": 0, "creation_date": 1512562001, "post_id": 47673784, "comment_id": 82306595, "body": "hi  prextor ,  i will try out. apparently my brother wants that part of the code so just following what he wants hahaha"}], "tags": [], "owner": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "is_accepted": true, "score": 0, "last_activity_date": 1512561508, "creation_date": 1512561508, "answer_id": 47673784, "question_id": 47673443, "link": "https://stackoverflow.com/questions/47673443/string-in-string-by-searching-each-occurrence-of-specific-text-and-filter-to-o/47673784#47673784", "title": "String in String , by searching each occurrence of specific text and filter to other cells", "body": "<p>Try this:</p>\n\n<pre><code>Sub StringExtract()\n\nDim iLength As Integer, iLoopCounter As Integer, iInnerLoopCounter As Integer\nDim sRemString As String\nDim iLastRow As Integer\n\niLength = Len(Range(\"A1\"))\n\nFor iLoopCounter = 1 To iLength\n\n    If (Mid(Range(\"A1\"), iLoopCounter, 4) = \"&lt;li&gt;\") Then\n\n        For iInnerLoopCounter = iInnerLoopCounter + 4 To iLength\n\n            If (Mid(Range(\"A1\"), iInnerLoopCounter, 5) = \"&lt;/li&gt;\") Then\n\n                sRemString = Mid(Range(\"A1\"), iLoopCounter + 5, iInnerLoopCounter - iLoopCounter - 6)\n\n                iLastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\n                Cells(iLastRow, \"A\").Value = sRemString\n\n                Exit For\n\n            End If\n\n        Next iInnerLoopCounter\n\n    End If\n\nNext iLoopCounter\nEnd Sub\n</code></pre>\n\n<p>might not be the fastest way, but in this case it should work. I cant figure out, why the <code>&lt;/a&gt;</code> should be excluded as well. If you need to, increase the integer from -6 to your needs in this line:</p>\n\n<pre><code>sRemString = Mid(Range(\"A1\"), iLoopCounter + 5, iInnerLoopCounter - iLoopCounter - 6)\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9045296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1057ef16ee976b3af98acbd15f5a39bf?s=128&d=identicon&r=PG&f=1", "display_name": "Awsg", "link": "https://stackoverflow.com/users/9045296/awsg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 47673784, "answer_count": 1, "score": 0, "last_activity_date": 1512562991, "creation_date": 1512560502, "last_edit_date": 1531161705, "question_id": 47673443, "link": "https://stackoverflow.com/questions/47673443/string-in-string-by-searching-each-occurrence-of-specific-text-and-filter-to-o", "title": "String in String , by searching each occurrence of specific text and filter to other cells", "body": "<pre><code>Summary : Using vba-excel Looping through a single cell of text , finding \nand taking  out  each nth occurrence of &lt;li&gt; to &lt;/li &gt; into each individual \ncell \n</code></pre>\n\n<p><strong>Before</strong> </p>\n\n<p>Single excel cell (e.g A1 ) contains</p>\n\n<pre><code>&lt;li&gt;\n  &lt;ahref=\"xxxx\"&gt;\n  &lt;imgsrc=\"\"yyy\"&gt;\n  &lt;/a&gt;\n&lt;/li&gt;\n\n&lt;li&gt;\n  &lt;ahref=\"xxxx\"&gt;\n  &lt;imgsrc=\"\"yyy\"&gt;\n  &lt;/a&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p><strong>Result ( after ) :</strong> </p>\n\n<p><em>cell A2</em> </p>\n\n<pre><code>&lt;ahref=\"xxxx\"&gt;\n&lt;imgsrc=\"\"yyy\"&gt;\n</code></pre>\n\n<p><em>cell A3</em> </p>\n\n<pre><code>&lt;ahref=\"xxxx\"&gt;\n&lt;imgsrc=\"\"yyy\"&gt;\n</code></pre>\n\n<p>much appreciated ; D  </p>\n\n<p>what i have done so far </p>\n\n<pre><code>'myrow is already pre-define previous , basically row number fetch during \n loopping\n\nDim newi As String\nDim texti as string \n</code></pre>\n\n<p>i = MyRow\n    texi = cell (i , 1) </p>\n\n<pre><code>'not sure if this is correct , trying to find each\nFor Each item In Texti \nCells(i, 13) = item(\"&lt;a href=\")\nCells(i, 14) = item(\"&lt;img src=\")\nnewi = Cells(i, 13).Value + \"  \" + Cells(i, 14).Value\nNext\n</code></pre>\n\n<p>Thanks again in advance for helping me , was stuck with this ~ ! </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 1, "creation_date": 1512561376, "post_id": 47673439, "comment_id": 82306214, "body": "can you please share the code, which you have tried till now. Possibly this might be duplicate. Please search this forum. Thanks"}, {"owner": {"reputation": 1, "user_id": 9061481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/354b34f98ab1365f5f6cefd4988a221e?s=128&d=identicon&r=PG&f=1", "display_name": "Drumguy", "link": "https://stackoverflow.com/users/9061481/drumguy"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512561899, "post_id": 47673439, "comment_id": 82306534, "body": "Hi, I have not used code yet - as I say complete novice."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9061481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/354b34f98ab1365f5f6cefd4988a221e?s=128&d=identicon&r=PG&f=1", "display_name": "Drumguy", "link": "https://stackoverflow.com/users/9061481/drumguy"}, "edited": false, "score": 0, "creation_date": 1512569140, "post_id": 47674049, "comment_id": 82311203, "body": "Hi, yes. One thing, if I only wanted to select a range from the source file what other code would I require?"}], "tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": false, "score": 1, "last_activity_date": 1512569447, "last_edit_date": 1512569447, "creation_date": 1512562363, "answer_id": 47674049, "question_id": 47673439, "link": "https://stackoverflow.com/questions/47673439/copying-worksheets-from-one-file-to-another-using-vba-macro/47674049#47674049", "title": "Copying worksheets from one file to another using VBA macro", "body": "<p>Try this: (You are lucky that i had a template for this :)) Cheers</p>\n\n<p>Below is the code:</p>\n\n<pre><code>Dim wkb1 As Workbook\nDim sht1 As Worksheet\nDim wkb2 As Workbook\nDim sht2 As Worksheet\n\nApplication.ScreenUpdating = False\n\nSet wkb1 = ThisWorkbook\nSet wkb2 = Workbooks.Open(\"B.xlsx\")\nSet sht1 = wkb1.Sheets(\"Roll Out Summary\")\nSet sht2 = wkb2.Sheets(\"Roll Out Summary\")\n\nsht1.Cells.Copy\nsht2.Range(\"A1\").PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\nwkb2.Close True\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>For just range:</p>\n\n<pre><code>Set sht1 = wkb1.Sheets(\"Roll Out Summary\").Range(\"A1:B10\") ' Define the range\nSet sht2 = wkb2.Sheets(\"Roll Out Summary\")\n\nsht1.Cells.Copy\nsht2.Range(\"A1\").PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\nwkb2.Close True\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9061481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/354b34f98ab1365f5f6cefd4988a221e?s=128&d=identicon&r=PG&f=1", "display_name": "Drumguy", "link": "https://stackoverflow.com/users/9061481/drumguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1512569447, "creation_date": 1512560487, "question_id": 47673439, "link": "https://stackoverflow.com/questions/47673439/copying-worksheets-from-one-file-to-another-using-vba-macro", "title": "Copying worksheets from one file to another using VBA macro", "body": "<p>I'm new to VBA and just to want create a macro  that copies a worksheet (or sheets) from one file to another file using a simple vba macro each period.</p>\n\n<p>Im sure its easy but as I say, I am new to this world!</p>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512560684, "post_id": 47673422, "comment_id": 82305791, "body": "Is <code>newSnameQ</code> some constant or it&#39;s calculated somehow?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1512561039, "post_id": 47673422, "comment_id": 82306016, "body": "Are you mixing .xls and .xlsx workbooks?"}, {"owner": {"reputation": 11, "user_id": 9061470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2055ad64c6333f92d52abe61ba7a691b?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh kumar", "link": "https://stackoverflow.com/users/9061470/saurabh-kumar"}, "edited": false, "score": 0, "creation_date": 1512561106, "post_id": 47673422, "comment_id": 82306062, "body": "newSnameQ = ActiveWorkbook.Name &#39;Capturing the saved workbook name     Workbooks(newSnameQ).Sheets(1).Select"}, {"owner": {"reputation": 11, "user_id": 9061470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2055ad64c6333f92d52abe61ba7a691b?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh kumar", "link": "https://stackoverflow.com/users/9061470/saurabh-kumar"}, "edited": false, "score": 0, "creation_date": 1512561347, "post_id": 47673422, "comment_id": 82306203, "body": "@Jeeped yes.. I am  mixing .xls and .xlsx workbooks"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512561489, "post_id": 47673422, "comment_id": 82306284, "body": "What is the eror that you got?"}, {"owner": {"reputation": 11, "user_id": 9061470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2055ad64c6333f92d52abe61ba7a691b?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh kumar", "link": "https://stackoverflow.com/users/9061470/saurabh-kumar"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1512561628, "post_id": 47673422, "comment_id": 82306375, "body": "@nishitdey runtime error 9 . subscript out of range.  this is the line which is highlghted while debugging -   Set destSheet = Workbooks(newSnameQ).Sheets(2) ."}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1512563299, "post_id": 47673422, "comment_id": 82307321, "body": "can you let us know what is the value in newSnameQ? Is it the full file name? is the file open? Is it only the filename, excluding the folderpath?"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1512563521, "post_id": 47673422, "comment_id": 82307459, "body": "Can you try activating the book first, then setting the sheet? I know it does not answer your question, but looks like the workbook is causing the error."}, {"owner": {"reputation": 11, "user_id": 9061470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2055ad64c6333f92d52abe61ba7a691b?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh kumar", "link": "https://stackoverflow.com/users/9061470/saurabh-kumar"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1512563610, "post_id": 47673422, "comment_id": 82307509, "body": "@Lowpar  newSnameQ = Left(Sheet1.Range(&quot;AE20&quot;), 7) &amp; &quot;-&quot; &amp; &quot;SDU-Quality sheet&quot; &amp; &quot;-&quot; &amp; Format(Now(), &quot;ddmmyy hhmmss&quot;)  &#39;Capture the short name of the Quality file         newNameQ = thisPath &amp; &quot;\\&quot; &amp; Left(Sheet1.Range(&quot;AE20&quot;), 7) &amp; &quot;-&quot; &amp; &quot;SDU-Quality sheet&quot; &amp; &quot;-&quot; &amp; Format(Now(), &quot;ddmmyy hhmmss&quot;) &#39;Long name of the quality file"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 2, "creation_date": 1512564164, "post_id": 47673422, "comment_id": 82307875, "body": "Default setup of Excel 2016 tends to have just one sheet unless manually added which was three sheets in Excel 2010 (and I have not used 2013). Are you creating the workbook on the fly?"}, {"owner": {"reputation": 11, "user_id": 9061470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2055ad64c6333f92d52abe61ba7a691b?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh kumar", "link": "https://stackoverflow.com/users/9061470/saurabh-kumar"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 1, "creation_date": 1512565299, "post_id": 47673422, "comment_id": 82308652, "body": "@ShrivallabhaRedij i changed the default setting to 3 and it worked. Thanks a lot..."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1512628718, "post_id": 47673422, "comment_id": 82337167, "body": "@saurabhkumar Great! I&#39;d suggest adding a small function for checking and adding the sheet rather than changing settings. It will be good especially if you intend the code to be deployed and used on several computers."}], "owner": {"reputation": 11, "user_id": 9061470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2055ad64c6333f92d52abe61ba7a691b?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh kumar", "link": "https://stackoverflow.com/users/9061470/saurabh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1512562991, "creation_date": 1512560420, "last_edit_date": 1512562991, "question_id": 47673422, "link": "https://stackoverflow.com/questions/47673422/runtime-error-9-subscript-out-of-range-while-running-in-2016", "title": "runtime error 9 subscript out of range while running in 2016", "body": "<p>I am getting this error in excel 2016 but it working fine in 2013\nat line </p>\n\n<p><code>Set destSheet = Workbooks(newSnameQ).Sheets(2)</code> </p>\n\n<p>Code:</p>\n\n<pre><code>  For i = 1 To lastRowSh1\n    If destSheet.Range(\"C\" &amp; i) &lt;&gt; \"\" Then\n        destSheet.Range(\"D\" &amp; i) = \"Auto Match\"\n    End If\nNext i\n\n'Transfer the LGA processed data from sheet \"LGA_Data\"\nSheet3.Select\n   Set destSheet = Workbooks(newSnameQ).Sheets(2) \n   lastRowSh1 = Sheet3.Cells(Rows.count, \"I\").End(xlUp).Row\nIf lastRowSh1 &lt; 25 Then\n</code></pre>\n"}, {"tags": ["excel", "vba", "authentication", "sharepoint"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512560558, "post_id": 47673401, "comment_id": 82305741, "body": "what is the value of <code>SharepointAdress</code>?  (And I assume you realize it&#39;s misspelled?)"}, {"owner": {"reputation": 1, "user_id": 4952667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7a424bb37664d1d55d7412ac54a8795?s=128&d=identicon&r=PG&f=1", "display_name": "Leanhope", "link": "https://stackoverflow.com/users/4952667/leanhope"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512560675, "post_id": 47673401, "comment_id": 82305785, "body": "Its &quot;\\\\teamshare.organisation.org\\team\\12345\\Projectarea\\&quot;, with information about the company removed"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512560875, "post_id": 47673401, "comment_id": 82305908, "body": "Do you have <code>Option Explicit</code> the top of the module?  If not, add that as the first line and <b>compile</b> the code ( <b>[Alt]**+**[D]</b>  <b>[Alt]**+**[L]</b>  ) to make sure your variables are declared and that spelling matches, etc.  (If you get &amp; fix an issue, re-compile, to check again, etc, until all issues are taken care of.)"}, {"owner": {"reputation": 1, "user_id": 4952667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7a424bb37664d1d55d7412ac54a8795?s=128&d=identicon&r=PG&f=1", "display_name": "Leanhope", "link": "https://stackoverflow.com/users/4952667/leanhope"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512561164, "post_id": 47673401, "comment_id": 82306098, "body": "Option Explicit is on top of module. Compiling the code gets me as far as as the FSO creation. Thank you for helping already!"}], "owner": {"reputation": 1, "user_id": 4952667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7a424bb37664d1d55d7412ac54a8795?s=128&d=identicon&r=PG&f=1", "display_name": "Leanhope", "link": "https://stackoverflow.com/users/4952667/leanhope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 302, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1512561187, "creation_date": 1512560338, "last_edit_date": 1512561187, "question_id": 47673401, "link": "https://stackoverflow.com/questions/47673401/accessing-sharepoint-subfolders-using-vba", "title": "Accessing Sharepoint Subfolders using VBA", "body": "<p>sorry, if this question has been asked before, but I did not find anything really relatable.</p>\n\n<p>On a Sharepoint which requires authentication, an excel file is stored which is supposed to import files stored in a subfolder of the Sharepoint. While I have no experience with this, using Trial and Error I got to the point, that I map the sharepoint to a new Network drive and try to access it that way. The storing works, but when I access the new drive to create a File System Object I get an Error message telling me that the path is not found. I guess this is a problem with missing authentication. When I navigate to the drive and the folder I want to access in the explorer beforehand, everything problematic works fine. So I'm guessing the authentication somehow... gets missing in the process? I feel like I'm lacking some basic understanding of the whole authentication process of NetworkObjects and I hope, someone could point me in the right direction</p>\n\n<pre><code>    Set NetworkObject = CreateObject(\"WScript.Network\")\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    On Error GoTo Label1:\n    NetworkObject.RemoveNetworkDrive \"X:\" ', bForce:=True\nLabel1:\n    On Error GoTo Label2:\n    NetworkObject.MapNetworkDrive \"X:\", SharepointAdress, False, UserName,\n    Password\nLabel2:\n    Set Directory = FSO.GetFolder(SharepointAdress &amp; \n    \"Subfolder\\subsubfolder\\\")\n</code></pre>\n\n<p>\nThis is the problematic code, the error handers are simply to catch, if the drive has already been created before / doesn't exist yet. The drive gets removed and added again, I thought it would make sense to \"authenticate\" the drive in every iteration, but obviously that was not the problem. </p>\n\n<p>Grateful for any help!\n</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 0, "creation_date": 1512562925, "post_id": 47673305, "comment_id": 82307111, "body": "What do you mean by <code>Source Object</code>?"}, {"owner": {"reputation": 37, "user_id": 6682180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a0b8f85eeb18f6e8f54cfcaa0b3133?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Kowalski", "link": "https://stackoverflow.com/users/6682180/jan-kowalski"}, "reply_to_user": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 0, "creation_date": 1512563407, "post_id": 47673305, "comment_id": 82307387, "body": "<a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/source-object-word\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/word-vba/articles/&hellip;</a>"}, {"owner": {"reputation": 37, "user_id": 6682180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a0b8f85eeb18f6e8f54cfcaa0b3133?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Kowalski", "link": "https://stackoverflow.com/users/6682180/jan-kowalski"}, "reply_to_user": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 0, "creation_date": 1512635609, "post_id": 47673305, "comment_id": 82340369, "body": "No one has an answer?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1512650556, "post_id": 47673305, "comment_id": 82350154, "body": "Simply speaking your problem is a bit difficult to reproduce. I think that is the reason you don&#39;t get the answer."}, {"owner": {"reputation": 37, "user_id": 6682180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a0b8f85eeb18f6e8f54cfcaa0b3133?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Kowalski", "link": "https://stackoverflow.com/users/6682180/jan-kowalski"}, "edited": false, "score": 0, "creation_date": 1512652606, "post_id": 47673305, "comment_id": 82351436, "body": "So, maybe somebody can tell me how to  retrieve &quot;Source object&quot; from &quot;Footnote object? That&#39;s my main question and issue."}, {"owner": {"reputation": 37, "user_id": 6682180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a0b8f85eeb18f6e8f54cfcaa0b3133?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Kowalski", "link": "https://stackoverflow.com/users/6682180/jan-kowalski"}, "edited": false, "score": 0, "creation_date": 1512653480, "post_id": 47673305, "comment_id": 82351996, "body": "And to clarify. I want to extract &quot;Source object&quot; from Citation that is in footnote."}], "owner": {"reputation": 37, "user_id": 6682180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a0b8f85eeb18f6e8f54cfcaa0b3133?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Kowalski", "link": "https://stackoverflow.com/users/6682180/jan-kowalski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512560041, "creation_date": 1512560041, "question_id": 47673305, "link": "https://stackoverflow.com/questions/47673305/ms-word-vba-getting-source-object-from-footnote-field", "title": "MS Word VBA. Getting Source object from Footnote field", "body": "<p>In my document I must add footnotes to every formula i used. For example, I have some text with added Bibliography source </p>\n\n<pre><code>(something like  \"some very smart text [WrittenBySb]\") \n</code></pre>\n\n<p>and I have formula </p>\n\n<pre><code>(for examle : E = mc2) \n</code></pre>\n\n<p>And after that formula I must add footnote contains source. I decided to write a macro that add footnote to formula with selected bibliography source:</p>\n\n<pre><code>Sub addFootnoteFromSelection()\nSelection.MoveRight Unit:=wdCell 'my formula is in table - first row \n                                 'is null. second is actual formula and \n                                 'third contains actual formula's number \nSelection.MoveRight Unit:=wdCell\nSelection.MoveRight Unit:=wdCell\nWith Selection                   'i want footnote mark to be in current \n                                 'formula's number\n   With .FootnoteOptions\n        .Location = wdBottomOfPage\n        .NumberingRule = wdRestartContinuous\n        .StartingNumber = 1\n        .NumberStyle = wdNoteNumberStyleArabic\n   End With\n .Footnotes.Add Range:=Selection.Range, Reference:=\"\"\nEnd With\nSelection.PasteAndFormat (wdFormatOriginalFormatting)\nSelection.Style = ActiveDocument.Styles(\"Numer wzoru\")\nSelection.ParagraphFormat.Alignment = wdAlignParagraphJustify\nEnd Sub\n</code></pre>\n\n<p>And that works, but I want to have full source name (like in bibliography field), not a citation mark.\nI write a function in vba that returns proper looking and formatted string from Source field:</p>\n\n<pre><code>Function stringFromSource(curField As Source) As String\nSet xmlDoc = CreateObject(\"MSXML2.DOMDocument\")\nxmlDoc.LoadXML curField.XML\nauthors = \"\":  title = \"\": publish = \"\": city = \"\": year = \"\": periodic = \n\"\"\n'authors\nSet surname = xmlDoc.getElementsByTagName(\"b:Last\")\nSet name = xmlDoc.getElementsByTagName(\"b:First\")\nDim l As Integer\nl = 0\nFor Each el In surname\n    If el.Text = \"\" Then Exit For\n    authors = authors + (el.Text &amp; \" \" &amp; name(l).Text &amp; \"  \")\n    l = l + 1\nNext el\n'title\nSet titlex = xmlDoc.getElementsByTagName(\"b:Title\")\nFor Each el In titlex\n    If el.Text = \"\" Then Exit For\n    title = title + (el.Text &amp; \" \")\nNext el\n'publisher\nSet pubx = xmlDoc.getElementsByTagName(\"b:Publisher\")\nFor Each el In pubx\n    publish = publish + (el.Text &amp; \" \")\nNext el\n'city\nSet cityx = xmlDoc.getElementsByTagName(\"b:City\")\nIf cityx.Length = 0 Then city = city + (\"(brak miasta)\" &amp; \" \")\nFor Each el In cityx\n    city = city + (el.Text &amp; \" \")\nNext el\n'year\nSet yearx = xmlDoc.getElementsByTagName(\"b:Year\")\nIf yearx.Length = 0 Then year = year + (\"(brak roku wydania)\" &amp; \" \")\nFor Each el In yearx\n    year = year + (el.Text &amp; \" \")\nNext el\n'periodical title\nSet periodx = xmlDoc.getElementsByTagName(\"b:PeriodicalTitle\")\nFor Each el In period\n    periodic = periodic + (el.Text &amp; \" \")\nNext el\n\nDim outputString As String\noutputString = author &amp; \"- \" &amp; title &amp; \", \" &amp; publish &amp; periodic &amp; \", \" &amp; \nyear\nstringFromSource = outputString\nEnd Function\n</code></pre>\n\n<p>This function works as expected. But I want to loop through all footnotes and convert it to string using my function:</p>\n\n<pre><code>Sub convertAllFootnotes()\nDim ftn As Footnote\nDim oRng As Range\n For Each ftn In ActiveDocument.Footnotes\n    Set oRng = Selection.Range\n    oRng.Start = oRng.Start - 1\n    oRng.End = oRng.End + 1\n    oRng.Select\n    oRng.Text = stringFromSource(ftn) 'i don't know how to get source object \n                                      'from footnote\n Next ftn\nEnd Sub\n</code></pre>\n\n<p>And that is my problem. I don't know how to get Source object from footnote (that has Source object in it, this is not a static string but copied proper Source field)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 305, "user_id": 7445342, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eh0s6.jpg?s=128&g=1", "display_name": "SiGe", "link": "https://stackoverflow.com/users/7445342/sige"}, "edited": false, "score": 0, "creation_date": 1512558976, "post_id": 47672989, "comment_id": 82304850, "body": "What is your question exactly? :)"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1512560004, "post_id": 47672989, "comment_id": 82305415, "body": "Do you wish to make it shorter or?.."}, {"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 2, "creation_date": 1512563617, "post_id": 47672989, "comment_id": 82307519, "body": "In your code, a string <code>ABC</code> will turn into <code>NBC</code> then <code>NOC</code>, <code>NOP</code>, <code>AOP</code>, <code>ABP</code> and finally <code>ABC</code>. Try scanning thru the string, operate each character one by one."}, {"owner": {"reputation": 129, "user_id": 7115397, "user_type": "registered", "profile_image": "https://graph.facebook.com/916330975165474/picture?type=large", "display_name": "Yassine Zagliz", "link": "https://stackoverflow.com/users/7115397/yassine-zagliz"}, "edited": false, "score": 0, "creation_date": 1512566719, "post_id": 47672989, "comment_id": 82309553, "body": "I want to return for example : MY NAME =&gt; ZL ANZR, and to decrypts in the same sens."}, {"owner": {"reputation": 129, "user_id": 7115397, "user_type": "registered", "profile_image": "https://graph.facebook.com/916330975165474/picture?type=large", "display_name": "Yassine Zagliz", "link": "https://stackoverflow.com/users/7115397/yassine-zagliz"}, "edited": false, "score": 0, "creation_date": 1512566771, "post_id": 47672989, "comment_id": 82309593, "body": "when crypting or decrypts i want to substitute: A&gt;N, B&gt;O, C&gt;P,...M&gt;Z, and vice versa! it s about splitting alphabet into 13 character and it s like mirror like what you see in the example, hope that its clear"}, {"owner": {"reputation": 129, "user_id": 7115397, "user_type": "registered", "profile_image": "https://graph.facebook.com/916330975165474/picture?type=large", "display_name": "Yassine Zagliz", "link": "https://stackoverflow.com/users/7115397/yassine-zagliz"}, "edited": false, "score": 0, "creation_date": 1512569726, "post_id": 47672989, "comment_id": 82311583, "body": "I tried this but it returns the same result"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 7115397, "user_type": "registered", "profile_image": "https://graph.facebook.com/916330975165474/picture?type=large", "display_name": "Yassine Zagliz", "link": "https://stackoverflow.com/users/7115397/yassine-zagliz"}, "edited": false, "score": 0, "creation_date": 1512587175, "post_id": 47677470, "comment_id": 82322430, "body": "thanks for your help, but I don&#39;t know how to implement this ! it will be with a button ..?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 129, "user_id": 7115397, "user_type": "registered", "profile_image": "https://graph.facebook.com/916330975165474/picture?type=large", "display_name": "Yassine Zagliz", "link": "https://stackoverflow.com/users/7115397/yassine-zagliz"}, "edited": false, "score": 0, "creation_date": 1513003029, "post_id": 47677470, "comment_id": 82471053, "body": "No, the code creates a new function you can use in your spreadsheet like SUM or COUNT. Enter the text you want to change in a cell (say A1) and then in another cell enter =cypher(a1)"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1600693441, "last_edit_date": 1600693441, "creation_date": 1512572909, "answer_id": 47677470, "question_id": 47672989, "link": "https://stackoverflow.com/questions/47672989/how-to-use-substitute-function-to-decrypt-and-encrypt-messages/47677470#47677470", "title": "How to use substitute function to decrypt and encrypt messages", "body": "<p>Your immediate problem is that your solution only applies to two specified cells. You should write it as a function that accepts the original text and returns the coded string</p>\n<p>What you are looking at is ROT13. The simplest way to implement this is to use the ASCII values of the characters. In VBA you can use the ASC() function to return the ascii value of a char, then add 13 and then use the CHR() function to turn that value back into a character. This version only works on upper case text - characters 65 to 90. Lower case run 97 to 122 so you could add a test for that if you wanted</p>\n<pre><code>Public Function Cypher(origtext as string) as string\ndim s as string\ndim answer as string\ndim x as integer\ndim myvar as integer\nfor x = 1 to len(origtext)\n     s = mid(origtext,x,1)\n     myvar = asc(s)+13\n     if myvar &gt; 90 then myvar = 65 + (myvar-91) ' 91 maps to 65, etc. Could instead just use myvar = myvar - 26\n     s = chr(myvar)\n     answer = answer &amp; s\nnext x\nCypher = answer\nEnd Function\n</code></pre>\n<p>To use this, in the spreadsheet enter =Cypher(cell ref) where cell ref contains the text you want to cypher</p>\n"}], "owner": {"reputation": 129, "user_id": 7115397, "user_type": "registered", "profile_image": "https://graph.facebook.com/916330975165474/picture?type=large", "display_name": "Yassine Zagliz", "link": "https://stackoverflow.com/users/7115397/yassine-zagliz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "closed_date": 1512597321, "accepted_answer_id": 47677470, "answer_count": 1, "score": -1, "last_activity_date": 1600693441, "creation_date": 1512558868, "last_edit_date": 1531161705, "question_id": 47672989, "link": "https://stackoverflow.com/questions/47672989/how-to-use-substitute-function-to-decrypt-and-encrypt-messages", "closed_reason": "Not suitable for this site", "title": "How to use substitute function to decrypt and encrypt messages", "body": "<p>I want to encrypt and decrypt messages by changing the character A to N, and B to O ..like you see in my code. I need some help to to that, thanks!!</p>\n\n<pre><code>Sub MacroCryptage()\nDim ws1 As Worksheet\nSet ws1 = Worksheets(\"Feuil1\")\nDim rng As Range, cell As Range\nSet rng = ws1.Range(\"G\" &amp; 6)\nSet cell = ws1.Range(\"G\" &amp; 5)\n\n    rng = WorksheetFunction.Substitute(cell, \"A\", \"N\")\n    rng = WorksheetFunction.Substitute(cell, \"B\", \"O\")\n    rng = WorksheetFunction.Substitute(cell, \"C\", \"P\")\n    rng = WorksheetFunction.Substitute(cell, \"D\", \"Q\")\n    rng = WorksheetFunction.Substitute(cell, \"E\", \"R\")\n    rng = WorksheetFunction.Substitute(cell, \"F\", \"S\")\n    rng = WorksheetFunction.Substitute(cell, \"G\", \"T\")\n    rng = WorksheetFunction.Substitute(cell, \"H\", \"U\")\n    rng = WorksheetFunction.Substitute(cell, \"I\", \"V\")\n    rng = WorksheetFunction.Substitute(cell, \"J\", \"W\")\n    rng = WorksheetFunction.Substitute(cell, \"K\", \"X\")\n    rng = WorksheetFunction.Substitute(cell, \"L\", \"Y\")\n    rng = WorksheetFunction.Substitute(cell, \"M\", \"Z\")\n    rng = WorksheetFunction.Substitute(cell, \"N\", \"A\")\n    rng = WorksheetFunction.Substitute(cell, \"O\", \"B\")\n    rng = WorksheetFunction.Substitute(cell, \"P\", \"C\")\n    rng = WorksheetFunction.Substitute(cell, \"Q\", \"D\")\n    rng = WorksheetFunction.Substitute(cell, \"R\", \"E\")\n    rng = WorksheetFunction.Substitute(cell, \"S\", \"F\")\n    rng = WorksheetFunction.Substitute(cell, \"T\", \"G\")\n    rng = WorksheetFunction.Substitute(cell, \"U\", \"H\")\n    rng = WorksheetFunction.Substitute(cell, \"V\", \"I\")\n    rng = WorksheetFunction.Substitute(cell, \"W\", \"J\")\n    rng = WorksheetFunction.Substitute(cell, \"X\", \"K\")\n    rng = WorksheetFunction.Substitute(cell, \"Y\", \"L\")\n    rng = WorksheetFunction.Substitute(cell, \"Z\", \"M\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "forms", "excel", "commandbutton"], "answers": [{"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1512560031, "creation_date": 1512560031, "answer_id": 47673299, "question_id": 47672987, "link": "https://stackoverflow.com/questions/47672987/setting-a-vba-form-object-using-a-string/47673299#47673299", "title": "Setting a VBA form object using a string", "body": "<p>Here's code which iterates over ActiveX controls on active sheet:</p>\n\n<pre><code>Sub IterateOverActiveXControlsByName()\n    Dim x As Integer\n    Dim oleObjs As OLEObjects\n    Dim ctrl As MSForms.CommandButton\n    Set oleObjs = ActiveSheet.OLEObjects\n    For x = 1 To 10\n        Set ctrl = oleObjs(\"CommandButton\" &amp; x).Object\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 1, "last_activity_date": 1512560492, "creation_date": 1512560492, "answer_id": 47673440, "question_id": 47672987, "link": "https://stackoverflow.com/questions/47672987/setting-a-vba-form-object-using-a-string/47673440#47673440", "title": "Setting a VBA form object using a string", "body": "<p>You can loop through all controls of the form. Try</p>\n\n<pre><code>Sub LoopButtons()\nDim it As Object\n\nFor Each it In NewDate.Controls\n    Debug.Print it.Name\nNext it\n\nEnd Sub\n</code></pre>\n\n<p>Then you can put conditional expression (if ... then) in place of Debug.Print or whatever. For example </p>\n\n<pre><code>If Instr(it.Name, \"CommandButton\") Then\n'do your code\nend if \n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8500782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rR2vM.png?s=128&g=1", "display_name": "the_big_goat", "link": "https://stackoverflow.com/users/8500782/the-big-goat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 47673440, "answer_count": 2, "score": 0, "last_activity_date": 1512560492, "creation_date": 1512558865, "question_id": 47672987, "link": "https://stackoverflow.com/questions/47672987/setting-a-vba-form-object-using-a-string", "title": "Setting a VBA form object using a string", "body": "<p>\nHello,</p>\n\n<p>I am trying to set up a form which is a calendar from which the user can select a date (by default the current month appears). The form consists of 42 command buttons (I have left the default name ie. CommandButton1) which I am setting the day number.</p>\n\n<p>At the moment I have a long-winded section of code for each button (I used Excel to generate this rather than type it all out) which locks and hides the button if it is outside of the month in question which looks like this:</p>\n\n<pre><code>NewDate.CommandButton1.Caption = Format(DATlngFirstMonth - DATintDayNumFirst + DATintX, \"dd\")\nIf DATintX &lt; DATintDayNumFirst Then\n    With NewDate.CommandButton1\n        .Locked = True\n        .Visible = DATbooShowExtraDays\n        .ForeColor = RGB(150, 150, 150)\n    End With\nElse\n    With NewDate.CommandButton1\n        .Locked = False\n        .Visible = True\n        .ForeColor = RGB(0, 0, 0)\n    End With\nEnd If\n</code></pre>\n\n<p>I know that I can refer to a command button by:</p>\n\n<pre><code>Dim objCommandButton As Object\nSet objCommandButton = NewDate.CommandButton1\n</code></pre>\n\n<p>..which neatens the code up somewhat. But what I would like to do is refer to the command button as a string so I can loop through all 42, ie.</p>\n\n<pre><code>Dim n as integer\nn = 1   \n\nDo Until n &gt; 42\nSet objCommandButton = NewDate.CommandButton &amp; n\n'Some operations\nn = n + 1\nLoop\n</code></pre>\n\n<p>Many thanks in advance for assistance.</p>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 3943192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36743426fe71eaeb6789e6341d5dbd16?s=128&d=identicon&r=PG&f=1", "display_name": "Naaiif", "link": "https://stackoverflow.com/users/3943192/naaiif"}, "is_accepted": true, "score": 0, "last_activity_date": 1512560576, "creation_date": 1512560576, "answer_id": 47673465, "question_id": 47672674, "link": "https://stackoverflow.com/questions/47672674/error-287-on-send-command-after-upgrade-to-windows-10/47673465#47673465", "title": "Error 287 on Send command after upgrade to Windows 10", "body": "<p>sorry about this, i think I have fixed it. I posted this earlier after looking through for hours last night but I seem to have got it. Instead of .Send i used Application.SendKeys \"%s\" which is a shortcut. This seems to send the e-mail properly. </p>\n"}], "owner": {"reputation": 3, "user_id": 3943192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36743426fe71eaeb6789e6341d5dbd16?s=128&d=identicon&r=PG&f=1", "display_name": "Naaiif", "link": "https://stackoverflow.com/users/3943192/naaiif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 925, "favorite_count": 0, "accepted_answer_id": 47673465, "answer_count": 1, "score": 0, "last_activity_date": 1512645387, "creation_date": 1512557946, "last_edit_date": 1512645387, "question_id": 47672674, "link": "https://stackoverflow.com/questions/47672674/error-287-on-send-command-after-upgrade-to-windows-10", "title": "Error 287 on Send command after upgrade to Windows 10", "body": "<p>I have Excel VBA code that generates an Outlook e-mail with an attachment.</p>\n\n<p>This worked in Windows 8.1 but does not work in Windows 10. I have stepped through the macro, and it gets all the way to the end, generates the e-mail, then fails on the OutMail.Send command. The error is </p>\n\n<blockquote>\n  <p>Runtime error 287 - Application-defined or object-defined error</p>\n</blockquote>\n\n<p>Here is the code.</p>\n\n<pre><code>Sub batchallocationemail()\n\n'define email &amp; pdf\nDim IsCreated As Boolean\nDim PdfFile As String, Title As String\nDim OutlApp As Object\nDim OutMail As Object\n\n'\n' print allocation Macro\n\n'define worksheets\nDim ws As Worksheet\nSet ws = Sheets(\"Caseworkers\")\nDim ws2 As Worksheet\nSet ws2 = Sheets(\"Allocation Sheet\")\n'define range\nDim NameRange As Range\nDim NameRange2 As Range\nDim x As Range\nDim z As Range\nSet z = ws2.Range(\"B1\")\n\nSet NameRange = ws.Range(\"A1:C69\")\nSet NameRange2 = ws.Range(\"A2:A69\")\nSet NameRange3 = ws.Range(\"C2:C69\")\n\n'Selects name from list and pastes into allocation\nws.Select\nNameRange.AutoFilter Field:=2, Criteria1:=\"In\"\nFor Each x In NameRange2.SpecialCells(xlCellTypeVisible)\n        x.Copy\n        ws2.Select\n        Range(\"B1\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n        ws2.Select\n'CONVERTS ACTIVE SHEET TO PDF AND EMAILS IT\n        ' Define Title\n        Title = Range(\"B1\").Value\n        ' Define PDF filename\n        Title = \"Allocation Sheet for \" &amp; Range(\"B1\").Value\n        PdfFile = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\") &amp; \"\\\" &amp; Title &amp; \".pdf\"\n  ' Export activesheet as PDF\n        With ActiveSheet\n            .ExportAsFixedFormat Type:=xlTypePDF, Filename:=PdfFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n        End With\n' Use already open Outlook if possible\n        On Error Resume Next\n        Set OutlApp = GetObject(, \"Outlook.Application\")\n        If Err Then\n            Set OutlApp = CreateObject(\"Outlook.Application\")\n            IsCreated = True\n        End If\n        OutlApp.Visible = True\n        On Error GoTo 0\n\n' Prepare e-mail with PDF attachment\n        Set OutMail = OutlApp.CreateItem(0)\n        With OutMail\n\n' Prepare e-mail\n            OutMail.Subject = Title\n            OutMail.To = x.Offset(0, 2).Value ' &lt;-- Put email of the recipient here\n            OutMail.CC = x.Offset(0, 3).Value ' &lt;-- Put email of 'copy to' recipient here\n            OutMail.Body = \"Hello,\" &amp; vbLf &amp; vbLf _\n            &amp; \"Please see your attached allocation sheet in PDF format.\" &amp; vbLf &amp; vbLf _\n            &amp; \"Kind Regards,\" &amp; vbLf _\n            &amp; Application.UserName &amp; vbLf &amp; vbLf\n            OutMail.Attachments.Add PdfFile\n        ' Try to send\n            Application.Visible = True\n            OutMail.Display\n            OutMail.Send\n        End With\n\n    ' Quit Outlook if it was not already open\n        If IsCreated Then OutlApp.Quit\n\n    ' Release the memory of object variable\n        Set OutMail = Nothing\n        Set OutlApp = Nothing\n    Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "named-ranges"], "comments": [{"owner": {"reputation": 551, "user_id": 1475916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb025b6e7d0824fc04113b0aa737d0?s=128&d=identicon&r=PG", "display_name": "Dave Thornton", "link": "https://stackoverflow.com/users/1475916/dave-thornton"}, "edited": false, "score": 0, "creation_date": 1512575905, "post_id": 47672599, "comment_id": 82315971, "body": "What run-time error are you getting?"}, {"owner": {"reputation": 45, "user_id": 8354114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10052bcafec59839afe5a5446c267aab?s=128&d=identicon&r=PG&f=1", "display_name": "UncouthScientist", "link": "https://stackoverflow.com/users/8354114/uncouthscientist"}, "reply_to_user": {"reputation": 551, "user_id": 1475916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb025b6e7d0824fc04113b0aa737d0?s=128&d=identicon&r=PG", "display_name": "Dave Thornton", "link": "https://stackoverflow.com/users/1475916/dave-thornton"}, "edited": false, "score": 0, "creation_date": 1512647252, "post_id": 47672599, "comment_id": 82348033, "body": "Run-time error 1004 - the formula you typed contains an error."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8354114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10052bcafec59839afe5a5446c267aab?s=128&d=identicon&r=PG&f=1", "display_name": "UncouthScientist", "link": "https://stackoverflow.com/users/8354114/uncouthscientist"}, "edited": false, "score": 0, "creation_date": 1515681350, "post_id": 47698940, "comment_id": 83399952, "body": "Apologies for taking so long to reply. I got pulled onto a different project and haven&#39;t had time to play with this model in a while! The code runs :) But, unfortunately, it selects all of the rows in the sheet."}], "tags": [], "owner": {"reputation": 551, "user_id": 1475916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb025b6e7d0824fc04113b0aa737d0?s=128&d=identicon&r=PG", "display_name": "Dave Thornton", "link": "https://stackoverflow.com/users/1475916/dave-thornton"}, "is_accepted": false, "score": 0, "last_activity_date": 1512662256, "creation_date": 1512662256, "answer_id": 47698940, "question_id": 47672599, "link": "https://stackoverflow.com/questions/47672599/error-setting-dynamic-range-name-using-row-count-column-count/47698940#47698940", "title": "Error setting dynamic range name using row.count/column.count", "body": "<p>When trying to set RefersTo, it looks like the ending range is not actually a range but an integer value. Also it seems like FinalRow always refers to the bottom cell of column B. Was that the intention?</p>\n\n<p>Not knowing how your sheet is setup I can't say for certain how you should approach changing this, but based on your code spinet I would modify by doing something like:</p>\n\n<pre><code>Dim sht As Worksheet\nDim rngEnd As Range\n\nStartCell = \"$B$5\"\nSet sht = wb.Sheets(\"Pivot Data 3 - To Use\")\n\nSet rngEnd = sht.Range(sht.Cells(5, Columns.Count).End(xlToLeft).Offset(0, -1), sht.Cells(Rows.Count, \"B\").End(xlDown))\nWith wb.Names(\"Variance\")\n    .RefersTo = \"='\" &amp; sht.Name &amp; \"'!\" &amp; StartCell &amp; \":\" &amp; rngEnd.Address\n    .Visible = True\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8354114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10052bcafec59839afe5a5446c267aab?s=128&d=identicon&r=PG&f=1", "display_name": "UncouthScientist", "link": "https://stackoverflow.com/users/8354114/uncouthscientist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512662256, "creation_date": 1512557751, "question_id": 47672599, "link": "https://stackoverflow.com/questions/47672599/error-setting-dynamic-range-name-using-row-count-column-count", "title": "Error setting dynamic range name using row.count/column.count", "body": "<p>This is a problem linked to the following original question: <a href=\"https://stackoverflow.com/questions/47475699/cannot-vlookup-range-after-name-change-in-vba\">Cannot vlookup range after name change in VBA</a></p>\n\n<p>My code is now successfully naming my ranges except in one case:</p>\n\n<pre><code>'Set range for Variance calculation\n        StartCell = \"$B$5\"\n        FinalColumn = wb.Sheets(\"Pivot Data 3 - To Use\").Cells(5, Columns.Count).End(xlToLeft).Column - 1\n        FinalRow = wb.Sheets(\"Pivot Data 3 - To Use\").Cells(Rows.Count, \"B\").End(xlDown).Column\n\n        With wb.Names(\"Variance\")\n                .RefersTo = \"='Pivot Data 3 - To Use'!\" &amp; StartCell &amp; \":\" &amp; FinalRow &amp; FinalColumn\n                .Visible = True\n        End With\n</code></pre>\n\n<p>All VBA is telling me is that there is a run time error. When I step through, the code resolves itself to an answer of:</p>\n\n<pre><code>.RefersTo=\"='Pivot Data 3 - To Use'!$B$5:$Z$47\"\n</code></pre>\n\n<p>but won't apply it to the named range. The code is identical (I copied and pasted) in form to all of the completed assignations so I'm stumped as to why the code falls over here e.g.</p>\n\n<pre><code>    'Set range name for Key analysis\n        With wb.Names(\"KeyData\")\n            .RefersTo = \"='Pivot Data 3 - To Use'!$A$5\" &amp; \":$CM$\" &amp; LearnerNumbers + 5\n            .Visible = True\n        End With\n</code></pre>\n\n<p>This code works fine.</p>\n\n<p>Any help in wrangling this is greatly appreciated!</p>\n\n<p>Thanks, \nSteph</p>\n"}, {"tags": ["vba", "excel", "loops", "commandbutton"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9056460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa566396417c3381abd8b41d2ea5f6e9?s=128&d=identicon&r=PG&f=1", "display_name": "CharlieBea", "link": "https://stackoverflow.com/users/9056460/charliebea"}, "edited": false, "score": 0, "creation_date": 1512560155, "post_id": 47672625, "comment_id": 82305511, "body": "I altered very slightly &#39;sht2.Range(&quot;A2&quot; &amp; sht2.Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues &#39;sht2.Range(&quot;A1&quot;).PasteSpecial xlPasteValues&#39; still getting 1004 error &quot;Method &#39;Range&#39; of object_&#39;worksheet&#39; failed&quot;"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 11, "user_id": 9056460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa566396417c3381abd8b41d2ea5f6e9?s=128&d=identicon&r=PG&f=1", "display_name": "CharlieBea", "link": "https://stackoverflow.com/users/9056460/charliebea"}, "edited": false, "score": 0, "creation_date": 1512570899, "post_id": 47672625, "comment_id": 82312397, "body": "No that won&#39;t work. What we are doing is starting at the very bottom of the spreadsheet (at row 1million) with range(&quot;A&quot; &amp; total number of row) and then we come up to the first occupied cell with .end(xlup) and then down 1 row with .offset(1,0)  Adding a random A2 makes no sense.  You need to replace your line with the one I gave"}, {"owner": {"reputation": 11, "user_id": 9056460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa566396417c3381abd8b41d2ea5f6e9?s=128&d=identicon&r=PG&f=1", "display_name": "CharlieBea", "link": "https://stackoverflow.com/users/9056460/charliebea"}, "edited": false, "score": 0, "creation_date": 1512575224, "post_id": 47672625, "comment_id": 82315517, "body": "I tried the code you suggested but it&#39;s kicking back an error 1004 &quot;Application-defined or object-defined error&quot; and I can&#39;t figure out why or how to fix it..?!"}, {"owner": {"reputation": 11, "user_id": 9056460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa566396417c3381abd8b41d2ea5f6e9?s=128&d=identicon&r=PG&f=1", "display_name": "CharlieBea", "link": "https://stackoverflow.com/users/9056460/charliebea"}, "edited": false, "score": 0, "creation_date": 1512583188, "post_id": 47672625, "comment_id": 82320469, "body": "I think this should work but now im getting an error saying there isnt enough memory????!! and then an error that says &quot;pastespecial method of range class failed&quot;....i&#39;m just about ready to give up now and am completely grateful for your patience!!!"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1512575829, "last_edit_date": 1512575829, "creation_date": 1512557813, "answer_id": 47672625, "question_id": 47672517, "link": "https://stackoverflow.com/questions/47672517/copy-merge-data-from-2-workbooks-to-one-master-workbook/47672625#47672625", "title": "Copy/merge data from 2 workbooks to one master workbook", "body": "<p>Your line </p>\n\n<pre><code> sht2.Range(\"A1\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Always pastes into range A1, overwriting anything there. To append the data below existing data use</p>\n\n<pre><code>  sht2.Range(\"A\" &amp; sht2.rows.count).End(xlup).offset(1,0).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Ahh - but you can't copy all the cells in a sheet except into A1 - so we need to only copy the used cells. Changing </p>\n\n<pre><code>  sht1.Cells.Copy \n</code></pre>\n\n<p>into </p>\n\n<pre><code>  sht1.UsedRange.Cells.Copy\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9056460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa566396417c3381abd8b41d2ea5f6e9?s=128&d=identicon&r=PG&f=1", "display_name": "CharlieBea", "link": "https://stackoverflow.com/users/9056460/charliebea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512575829, "creation_date": 1512557525, "question_id": 47672517, "link": "https://stackoverflow.com/questions/47672517/copy-merge-data-from-2-workbooks-to-one-master-workbook", "title": "Copy/merge data from 2 workbooks to one master workbook", "body": "<p>I have 2 spreadsheets that are identical being filled out by different people. I tried to then get their separate data to copy into a mater spreadsheet that is the same as the first but hopefully with the 2 sets of data combined. \nI've managed to set up a command button \"submit\" into my sheet that will copy rows from one spreadsheet but when the other person presses \"submit\" it just overrides the others data...\nI know I need to write a loop and if but I can't get it work. </p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\nApplication.ScreenUpdating = False\n\nDim wkb1 As Workbook\nDim sht1 As Worksheet\nDim wkb2 As Workbook\nDim sht2 As Worksheet\n\nSet wkb1 = ThisWorkbook\nSet wkb2 = Workbooks.Open(\"X:\\TA Info\\MASTER.xlsx\")\nSet sht1 = wkb1.Sheets(\"Sheet1\")\nSet sht2 = wkb2.Sheets(\"Sheet1\")\n\nsht1.Cells.Copy\nsht2.Range(\"A1\").PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\nwkb2.Close True\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I understand this is a very unique question but I will appreciate any guidance anyone has the time to offer. </p>\n\n<p>Thank you. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "edited": false, "score": 0, "creation_date": 1512558892, "post_id": 47672944, "comment_id": 82304790, "body": "I know this, however I want VBA to do the same in the middle of a macro. It would be really inefficient if I had to stop and do this manually then start another macro to carry on with the process."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "edited": false, "score": 0, "creation_date": 1512559407, "post_id": 47672944, "comment_id": 82305093, "body": "Updated an answer"}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 1, "last_activity_date": 1512559365, "last_edit_date": 1512559365, "creation_date": 1512558705, "answer_id": 47672944, "question_id": 47672484, "link": "https://stackoverflow.com/questions/47672484/how-to-delete-every-row-in-a-range-that-contains-data/47672944#47672944", "title": "How to delete every row in a range that contains data?", "body": "<ol>\n<li>Select a range you need</li>\n<li>Press <code>F5</code></li>\n<li>Press <code>Special...</code> button</li>\n<li>Select <code>Constants</code> or <code>Formulas</code> (with other selections, if needed)</li>\n<li>Press <code>OK</code></li>\n<li>Now go to: <code>Home</code> -> <code>Cells</code> -> <code>Delete</code> (arrow) -> <code>Delete Sheet Rows</code></li>\n</ol>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Macros:</p>\n\n<pre><code>Sub DeleteRowsWithData()\n\n    Dim rng As Range\n\n    ' Change to the range you need\n    Set rng = Range(\"A1\").CurrentRegion\n\n    ' Change field to the one you need\n    rng.AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\", Operator:=xlFilterValues\n\n    With rng\n        With .Offset(1).Resize(.Rows.Count - 1) 'Exclude header\n            Application.DisplayAlerts = False\n            .Rows.Delete\n            Application.DisplayAlerts = True\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "edited": false, "score": 0, "creation_date": 1512559001, "post_id": 47672952, "comment_id": 82304867, "body": "Thanks, this looks great, can you please explain what &quot;i&quot; stands for in this coding?"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "reply_to_user": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "edited": false, "score": 0, "creation_date": 1512570490, "post_id": 47672952, "comment_id": 82312122, "body": "It&#39;s just an integer... You could use any other expression... I usually use &quot;i&quot;, I don&#39;t know why... :D"}], "tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 0, "last_activity_date": 1512558726, "creation_date": 1512558726, "answer_id": 47672952, "question_id": 47672484, "link": "https://stackoverflow.com/questions/47672484/how-to-delete-every-row-in-a-range-that-contains-data/47672952#47672952", "title": "How to delete every row in a range that contains data?", "body": "<p>This simple code will do the trick:</p>\n\n<pre><code>For i = Cells(Rows.Count, 10).End(xlUp).Row To 1 Step -1\n    If Cells(i, 10).Value &lt;&gt; \"\" Then\n        Cells(i, 10).EntireRow.Delete\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": false, "score": 1, "last_activity_date": 1512559677, "creation_date": 1512559677, "answer_id": 47673216, "question_id": 47672484, "link": "https://stackoverflow.com/questions/47672484/how-to-delete-every-row-in-a-range-that-contains-data/47673216#47673216", "title": "How to delete every row in a range that contains data?", "body": "<p>Several moments:</p>\n\n<p>You test <code>Range</code> against being <code>Nothing</code> - it will always return <code>True</code> because it actually refers to an <strong>object.</strong> To test the contents of the cell, use <code>IsEmpty()</code>.</p>\n\n<p>If you are deleting rows, then run the loop <strong>backwards.</strong></p>\n\n<pre><code>Sub Test()\n    Dim Rng As Range\n    Dim I As Integer\n\n'You need only non-empty cells, thus the intersection of needed column and used range of your worksheet\n    Set Rng = Intersect(ActiveSheet.UsedRange, Columns(\"J\"))\n\n'Loop the cells backwards, from the last row to the first\n    For I = Rng.Rows.Count To 1 Step -1\n'If the cell is not empty, the delete that row and continue upwards\n        If Not IsEmpty(Rng.Cells(I)) Then\n            Rng.Cells(I).EntireRow.Delete\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 47672944, "answer_count": 3, "score": 0, "last_activity_date": 1512559677, "creation_date": 1512557442, "last_edit_date": 1531161705, "question_id": 47672484, "link": "https://stackoverflow.com/questions/47672484/how-to-delete-every-row-in-a-range-that-contains-data", "title": "How to delete every row in a range that contains data?", "body": "<p>In a big data set I am trying to find each cell in column J that contains any data so \"is not blank\", then delete that row that  contains data. My code however won't work for it:</p>\n\n<pre><code>Dim rng3 As Range\n\nDo\n    Set rng3 = Columns(\"J:J\")\n    If Not rng3 Is Nothing Then\n        rng.EntireRow.Delete\n    Else\n        Exit Do\n    End If\nLoop\n</code></pre>\n\n<p>I was hoping somebody can help me with this.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 16336, "user_id": 6356278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9cb6527e3af8a89177b809385400437b?s=128&d=identicon&r=PG&f=1", "display_name": "Wimpel", "link": "https://stackoverflow.com/users/6356278/wimpel"}, "edited": false, "score": 0, "creation_date": 1512556665, "post_id": 47672165, "comment_id": 82303249, "body": "in Criteria1:=Array(&quot;&lt;&gt;&quot; &amp; Data) you are trying to pass an array (Data is the result of Split(), which returns an array of strings).. This results in a type mismatch... try passing Data(i), which should be a string."}, {"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "edited": false, "score": 0, "creation_date": 1512557153, "post_id": 47672165, "comment_id": 82303581, "body": "@Jeeped Your answers shows &quot;How to make it visible&quot;. But i need to make invisible (Hide) what user enters"}, {"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "reply_to_user": {"reputation": 16336, "user_id": 6356278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9cb6527e3af8a89177b809385400437b?s=128&d=identicon&r=PG&f=1", "display_name": "Wimpel", "link": "https://stackoverflow.com/users/6356278/wimpel"}, "edited": false, "score": 0, "creation_date": 1512557264, "post_id": 47672165, "comment_id": 82303661, "body": "@Wimpel I already tried. Its not working"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1512557554, "post_id": 47672165, "comment_id": 82303862, "body": "you need to build a dictionary of keys for every country that should be shown (i.e. <b>not</b> on your list) and use that as the criteria. That is <b>exactly</b> what my linked answer does. Go back and read it again."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512557631, "post_id": 47672165, "comment_id": 82303925, "body": "You need to create an array which won&#39;t have the excluded countries and pass it to array: <code>Criteria1:=ArrayWithExcludedCountries, Operator:=xlFilterValues</code>"}], "owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 1, "closed_date": 1512589697, "answer_count": 0, "score": 1, "last_activity_date": 1512556513, "creation_date": 1512556513, "question_id": 47672165, "link": "https://stackoverflow.com/questions/47672165/how-to-make-multiple-filter-values-invisible-in-excel-vba", "closed_reason": "Duplicate", "title": "How to make multiple filter values invisible in Excel Vba", "body": "<p>I have a table with 15 columns (A:O).In 12th column (L) which contain 200 countries. I want to remove (Making invisible) more than 1 countries from that filter using InputBox. I used the code below and it is not working. It is showing error \"Type mismatch\".</p>\n\n<p>If i am not using &lt;> , then it is selecting only user entered data. But i want to deselect the user entered data. How to use \"not equal to\" inside an Array. Help me</p>\n\n<pre><code>Sub Removecountries()\n\nDim str1 As Variant\nDim Data As Variant\n\nstr1 = Application.InputBox(\"Enter the Country - comma separated \")\n\nSheet2.ListObjects(\"DataTable\").Range.AutoFilter Field:=12\n\nIf InStr(1, str1, \",\") &gt; 0 Then\nData = Split(str1, \",\")\nFor i = LBound(Data) To UBound(Data)\n\nSheet2.ListObjects(\"DataTable\").Range.AutoFilter Field:=12, Criteria1:=Array(\"&lt;&gt;\" &amp; Data), Operator:=xlFilterValues 'error\n\nNext i\nElse\n\nSheet2.ListObjects(\"DataTable\").Range.AutoFilter Field:=12, Criteria1:=(\"&lt;&gt;\" &amp; str1), Operator:=xlFilterValues\n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1512556557, "post_id": 47672119, "comment_id": 82303172, "body": "This could be accomplished easier with a Pivot Table, or Pivot Query."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1512556643, "post_id": 47672119, "comment_id": 82303237, "body": "A few screenshots of what you need to achieve can help a lot of your question."}, {"owner": {"reputation": 65, "user_id": 3235546, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000935886222/picture?type=large", "display_name": "xLokos", "link": "https://stackoverflow.com/users/3235546/xlokos"}, "edited": false, "score": 0, "creation_date": 1512558012, "post_id": 47672119, "comment_id": 82304186, "body": "Added a screenshot"}, {"owner": {"reputation": 65, "user_id": 3235546, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000935886222/picture?type=large", "display_name": "xLokos", "link": "https://stackoverflow.com/users/3235546/xlokos"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512560751, "post_id": 47672119, "comment_id": 82305836, "body": "@ashleedawg - can you please elaborate?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512561472, "post_id": 47672119, "comment_id": 82306269, "body": "...before I elaborate, it would be helpful if you could provide an <b>Excel</b> screenshot of your sample data (or, is the image of an non-Excel data source that you need to pull the data from?)  Can you also show an example of what the data should look like <i>after</i> processing?"}, {"owner": {"reputation": 65, "user_id": 3235546, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000935886222/picture?type=large", "display_name": "xLokos", "link": "https://stackoverflow.com/users/3235546/xlokos"}, "edited": false, "score": 0, "creation_date": 1512565039, "post_id": 47672119, "comment_id": 82308455, "body": "the screenshot I added is from Excel. It would be best if the processed data looked like: - rows with account number &quot;1234567&quot; in column B - rows with account number &quot;1234567&quot; in column I - blank row - rows with account number &quot;7654321&quot; in column B - rows with account number &quot;7654321&quot; in column I - blank row, etc."}, {"owner": {"reputation": 65, "user_id": 3235546, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000935886222/picture?type=large", "display_name": "xLokos", "link": "https://stackoverflow.com/users/3235546/xlokos"}, "edited": false, "score": 0, "creation_date": 1512565288, "post_id": 47672119, "comment_id": 82308641, "body": "also there are multiple account numbers and I need to treat column &quot;B&quot; as the &quot;database&quot; and looping through the database find those account numbers in column &quot;I&quot; and then group them together as described above."}], "owner": {"reputation": 65, "user_id": 3235546, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000935886222/picture?type=large", "display_name": "xLokos", "link": "https://stackoverflow.com/users/3235546/xlokos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 520, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512567194, "creation_date": 1512556365, "last_edit_date": 1512567194, "question_id": 47672119, "link": "https://stackoverflow.com/questions/47672119/excel-vba-macro-to-loop-thorugh-values-and-group-them", "title": "Excel VBA macro to loop thorugh values and group them", "body": "<p>EDITED TO MAKE IT MORE CLEAR</p>\n\n<p>Let's say I have rows with an account number in column B and non relevant data in column I and then I have rows with non relevant data in column B and a string containing account number and other info in column I. I want to group rows with the same account number and preferably paste them (grouped) to another sheet.</p>\n\n<p>In short, I need to pull up accounts from column B and put them into a \"database\".  Then I need to loop through the sheet looking for those values in column B and in column I (column I contains more than just the accounts, hence InStr) and group the rows that contain the same account number.</p>\n\n<p>By group I mean to put them in adjacent rows (order is not relevant) and separate different accounts by a blank row. Moving to another spreadsheet is a nice bonus, but not mandatory.</p>\n\n<p>Here's an \n<a href=\"https://i.stack.imgur.com/EfdrX.png\" rel=\"nofollow noreferrer\">example</a> of a database</p>\n\n<p>Btw same accounts may occur multiple times in both columns and I need to group all of them.</p>\n\n<p>Here's what I have to start, but obviously it does not work.</p>\n\n<pre><code>Sub Group_Accounts()\n\nDim strConcatList As String\nDim cell As Range\nDim K As Long, r As Range\nK = 1\nDim w1 As Worksheet, w2 As Worksheet\nSet w1 = Sheets(\"Sheet1\")\nSet w2 = Sheets(\"Sheet5\")\n\nFor Each r In Intersect(Range(\"B:B\"), ActiveSheet.UsedRange)\n    If r.Value &lt;&gt; \"\" Then\n        strConcatList = strConcatList &amp; r.Value &amp; \"|\"\n    End If\nNext r\n\n\nFor Each r In Intersect(Range(\"I:I\"), ActiveSheet.UsedRange)\n\n    If InStr(strConcatList, r.Value) &gt; 0 Then\n        r.EntireRow.Copy Destination:=w2.Cells(K, 1)\n        K = K + 1\n    End If\nNext r\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "concatenation", "unpivot"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1512556757, "post_id": 47672099, "comment_id": 82303318, "body": "This can be accomplished much easier <b>without</b> VBA unless there is a specific reason you <i>need</i> to use VBA rather than a built-in feature?  <code>Unpivot</code>comes to mind, although simple formulas using relative vs. absolute $cell $references would get the same thing done."}, {"owner": {"reputation": 13, "user_id": 9061043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f3a2d6dccb3346984bc3a6f7a5a26bd?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ling", "link": "https://stackoverflow.com/users/9061043/adam-ling"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1512562331, "post_id": 47672099, "comment_id": 82306785, "body": "Thanks for your reply I have no preference to VBA just thought that would have been easiest to have it complete the task."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9061043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f3a2d6dccb3346984bc3a6f7a5a26bd?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ling", "link": "https://stackoverflow.com/users/9061043/adam-ling"}, "edited": false, "score": 1, "creation_date": 1512568869, "post_id": 47676083, "comment_id": 82311036, "body": "Wow thank you that looks perfect and a lot more simpler than the route I was heading down thank you"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 13, "user_id": 9061043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f3a2d6dccb3346984bc3a6f7a5a26bd?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ling", "link": "https://stackoverflow.com/users/9061043/adam-ling"}, "edited": false, "score": 0, "creation_date": 1512569168, "post_id": 47676083, "comment_id": 82311224, "body": "You&#39;re welcome.  Excel has tons of handy features &quot;hidden away&quot; that go unused in exchange for more complicated methods, since people simply don&#39;t know about them...  Also, &quot;Go Canada&quot;.  (the <code>GST</code> field was a giveaway!)"}, {"owner": {"reputation": 13, "user_id": 9061043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f3a2d6dccb3346984bc3a6f7a5a26bd?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ling", "link": "https://stackoverflow.com/users/9061043/adam-ling"}, "edited": false, "score": 0, "creation_date": 1512595468, "post_id": 47676083, "comment_id": 82326874, "body": "Hi ashleedawg. That answer worked perfectly and i have added my figures beside the names and anttributes. I found the setting so that the table updates by inserting a new row so all figures to the right shift down, Im just wondering since it is along the same line of query editor how to make it delete the whole row if table updates."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 13, "user_id": 9061043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f3a2d6dccb3346984bc3a6f7a5a26bd?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ling", "link": "https://stackoverflow.com/users/9061043/adam-ling"}, "edited": false, "score": 0, "creation_date": 1512595912, "post_id": 47676083, "comment_id": 82327072, "body": "Right-click the row, choose <code>Delete</code> and <code>Table Rows</code>.   Check this out, too: [Overview of Excel tables]( <a href=\"https://support.office.com/en-us/article/Overview-of-Excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>)"}, {"owner": {"reputation": 13, "user_id": 9061043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f3a2d6dccb3346984bc3a6f7a5a26bd?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ling", "link": "https://stackoverflow.com/users/9061043/adam-ling"}, "edited": false, "score": 0, "creation_date": 1512686138, "post_id": 47676083, "comment_id": 82370044, "body": "Oh thanks for that, I must have accidentally posted that comment but thank you for the answer"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 3, "last_activity_date": 1535738478, "last_edit_date": 1535738478, "creation_date": 1512568697, "answer_id": 47676083, "question_id": 47672099, "link": "https://stackoverflow.com/questions/47672099/user-defined-concatenate/47676083#47676083", "title": "User defined concatenate", "body": "<h2>If your goal is to get from <em>this</em>:</h2>\n\n<p><a href=\"https://i.stack.imgur.com/gJ5tp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gJ5tp.png\" alt=\"unpivot1\"></a></p>\n\n<h2>...to <em>this</em> (or <em>that</em>):</h2>\n\n<p><a href=\"https://i.stack.imgur.com/KcQRB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KcQRB.png\" alt=\"unpivot2\"></a></p>\n\n<h2>...then what you want to do is called an <strong>Unpivot</strong>.</h2>\n\n<hr>\n\n<h1>How to Unpivot \"crosstab-style\" data:</h1>\n\n<p><a href=\"https://i.stack.imgur.com/BcytV.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BcytV.gif\" alt=\"UnPivot demo\"></a></p>\n\n<p>You can find the steps written out on <a href=\"https://stackoverflow.com/a/47505880/8112776\">a question I answered a week ago</a>, and there's a more <a href=\"https://www.excel-university.com/unpivot-excel-data/\" rel=\"nofollow noreferrer\">detailed explanation and steps over here</a>.</p>\n\n<p>Let me know if you have any questions!</p>\n\n<p><sub>Yeah, maybe I used this as an excuse to practice using <a href=\"http://www.screentogif.com/\" rel=\"nofollow noreferrer\">Screen2Gif</a>, but it sure helps demo a point!</sub>  <strong>:-)</strong></p>\n\n<h1><sub><sub>\ud83c\udde8\ud83c\udde6</sub></sub></h1>\n"}], "owner": {"reputation": 13, "user_id": 9061043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f3a2d6dccb3346984bc3a6f7a5a26bd?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ling", "link": "https://stackoverflow.com/users/9061043/adam-ling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 47676083, "answer_count": 1, "score": 1, "last_activity_date": 1537113781, "creation_date": 1512556305, "last_edit_date": 1537113781, "question_id": 47672099, "link": "https://stackoverflow.com/questions/47672099/user-defined-concatenate", "title": "User defined concatenate", "body": "<p>I am trying to expand my annual planning document to give me more information. Currently however I am stuck.</p>\n\n<p>My current Sheet is laid out as follows:\n<img src=\"https://i.stack.imgur.com/iJEGH.png\" alt=\"Client Example image\"></p>\n\n<p>I need to create a second sheet that concatenates the client name with each column heading there is a \"yes\" value in, as its own separate line.</p>\n\n<p><strong>Example 1</strong> in the new sheet would become:</p>\n\n<blockquote>\n<pre><code>Example 1 - Annuals\nExample 1 - Xero Fee\n</code></pre>\n</blockquote>\n\n<p>I had tried a copy and paste Macro, based on a quantity column counting the rows that include text. This gave the desired amount of client names in a new sheet but I was unable to work out how to include the \"concatenate\" part of this problem to it.</p>\n\n<pre><code>Public Sub CopyData()\n\n    ' This routing will copy rows based on the quantity to a new sheet.\n    Dim rngSinglecell As Range\n    Dim rngQuantityCells As Range\n    Dim intCount As Integer\n\n    ' Set this for the range where the Quantity column exists. This works only if there are no empty cells\n    Set rngQuantityCells = Range(\"G1\", Range(\"G1\").End(xlDown))\n\n    For Each rngSinglecell In rngQuantityCells\n        ' Check if this cell actually contains a number\n        If IsNumeric(rngSinglecell.Value) Then\n            ' Check if the number is greater than 0\n            If rngSinglecell.Value &gt; 0 Then\n                ' Copy this row as many times as .value\n                For intCount = 1 To rngSinglecell.Value\n                    ' Copy the row into the next emtpy row in sheet2\n                    Range(rngSinglecell.Address).EntireRow.Copy Destination:=Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n                    ' The above line finds the next empty row.\n\n                Next\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 521425, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/58f4e72c995fe9fb7fb93e74f86ac392?s=128&d=identicon&r=PG", "display_name": "CaBieberach", "link": "https://stackoverflow.com/users/521425/cabieberach"}, "edited": false, "score": 0, "creation_date": 1512556610, "post_id": 47671986, "comment_id": 82303208, "body": "Use the &quot;OnAction&quot; Property of the shape"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9061097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40fcdd9d5c9c14112a614b03c1493ce?s=128&d=identicon&r=PG&f=1", "display_name": "A.Eason", "link": "https://stackoverflow.com/users/9061097/a-eason"}, "edited": false, "score": 0, "creation_date": 1512558891, "post_id": 47672210, "comment_id": 82304788, "body": "This was a very speedy response. Many thanks, works perfectly!"}, {"owner": {"reputation": 4604, "user_id": 711006, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/332d86b71d1ba573668d6620e2121a37?s=128&d=identicon&r=PG", "display_name": "Melebius", "link": "https://stackoverflow.com/users/711006/melebius"}, "edited": false, "score": 0, "creation_date": 1512563416, "post_id": 47672210, "comment_id": 82307393, "body": "Thank you for this code snippet, which might provide some limited, immediate help. A <a href=\"https://meta.stackexchange.com/q/114762\">proper explanation</a> would greatly improve its long-term value by showing why this is a good solution to the problem and would make it more useful to future readers with other, similar questions. Please edit your answer to add some explanation, including the assumptions you&#39;ve made."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1512556687, "creation_date": 1512556687, "answer_id": 47672210, "question_id": 47671986, "link": "https://stackoverflow.com/questions/47671986/macro-name-from-shape-click/47672210#47672210", "title": "Macro name from shape click", "body": "<pre><code>Sub LoopandExamine()\nDim ws As Worksheet\nDim s As Shape\nFor Each ws In Worksheets\n    For Each s In ws.Shapes\n        If s.OnAction &lt;&gt; \"\" Then\n            Debug.Print s.Name &amp; \";\" &amp; s.OnAction\n        End If\n    Next s\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9061097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40fcdd9d5c9c14112a614b03c1493ce?s=128&d=identicon&r=PG&f=1", "display_name": "A.Eason", "link": "https://stackoverflow.com/users/9061097/a-eason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512556687, "creation_date": 1512555951, "last_edit_date": 1531164843, "question_id": 47671986, "link": "https://stackoverflow.com/questions/47671986/macro-name-from-shape-click", "title": "Macro name from shape click", "body": "<p>I have numerous sheets, all with a button which activates a macro. </p>\n\n<p>With VBA, how can I pick up the name of the macro attached to the shape on each sheet? </p>\n\n<p>I have the code to look at each sheet, but can't see how to get the macro name from the shape properties.</p>\n"}, {"tags": ["arrays", "excel", "vba", "split"], "comments": [{"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "edited": false, "score": 0, "creation_date": 1512555945, "post_id": 47671900, "comment_id": 82302801, "body": "Worth pointing out that I am viewing the values within my array using &#39;add watch&#39; in the excel VBA debug menu. Is it possible that my data is actually fine, but being displayed in an odd way by the debug console?"}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1512570196, "post_id": 47671900, "comment_id": 82311924, "body": "That doesn&#39;t work, I get the type mismatch error."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 1, "creation_date": 1512570667, "post_id": 47671900, "comment_id": 82312248, "body": "Let me guess: your text file is UTF-16 encoded. Your &quot;Contact&quot; is actually &quot;C[NULL]O[NULL]...&quot;. Then you need to read the file using FileSystemObject and setting TriState=True..."}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1512576279, "post_id": 47671900, "comment_id": 82316262, "body": "@LocEngineer Yes! Thank you. On my workstation here I don&#39;t have Notepad++ so wasn&#39;t able to check had the thought even occurred to me. But I tried removing the ASCII null character from each array entry and that solved the issue."}], "answers": [{"tags": [], "owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "is_accepted": true, "score": 1, "last_activity_date": 1512649346, "creation_date": 1512649346, "answer_id": 47695081, "question_id": 47671900, "link": "https://stackoverflow.com/questions/47671900/split-command-in-excel-vba-adding-a-space-between-every-character-in-array/47695081#47695081", "title": "Split command in Excel VBA adding a space between every character in array", "body": "<p>As @LocEngineer pointed out in the comments, during the update of the external software that produces the text file I was reading, the text encoding had been changed to UTF-16 and the additional characters between my data were chr(0) Null values from the ASCII table, not spaces (chr(32) in ASCII). </p>\n\n<pre><code>For i = 0 To UBound(sl)\n     sl(i) = Replace(sl(i), Chr(0), \"\")\nNext\n</code></pre>\n\n<p>This snippet solved the problem. </p>\n"}], "owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "accepted_answer_id": 47695081, "answer_count": 1, "score": 0, "last_activity_date": 1528994312, "creation_date": 1512555649, "last_edit_date": 1528994312, "question_id": 47671900, "link": "https://stackoverflow.com/questions/47671900/split-command-in-excel-vba-adding-a-space-between-every-character-in-array", "title": "Split command in Excel VBA adding a space between every character in array", "body": "<p>I am reading a text file and splitting the data string at each space using the following code. </p>\n\n<pre><code> L = f.ReadLine\n        If L = \"\" Then GoTo errorpoint:\n            On Error GoTo errorpoint:\n            sl = Split(L, \" \", -1)\n</code></pre>\n\n<p>However, the array I get back takes, for example, the word \"Contact\" in the text file and turns it into \" C o n t a c t \" in a single cell of my array (see below) and I'm not sure why. </p>\n\n<p><strong>Data Output in VBA Watch Window:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/2WTiQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2WTiQ.png\" alt=\"Data Output in VBA Watch Window\"></a></p>\n\n<p>I have tried using </p>\n\n<pre><code>For i = 0 To UBound(sl)\n     sl(i) = Replace(sl(i), \" \", \"\")\nNext\n</code></pre>\n\n<p>Afterwards to remove the spaces, but that doesn't appear to be removing the spaces from my data. Any ideas how I can prevent the code from adding a space between every character in the first place? </p>\n\n<p>I then need to check whether <code>sl(1)</code> and <code>sl(2)</code> contain the words \"Contact\" and \"Stress\" respectively, but that condition cannot be met currently, the cells contain \" C o n t a c t \" and \" S t r e s s \", so I changed the if loop to reflect that, but the condition is still not met.</p>\n\n<p>In addition, I cannot convert my data from String > Double because of the unusual formatting, it seems. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512555387, "post_id": 47671756, "comment_id": 82302400, "body": "I was nearly there at the moment. Somehow it takes very long."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512555511, "post_id": 47671756, "comment_id": 82302492, "body": "I added a safety when there are no blank cells."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512555787, "post_id": 47671756, "comment_id": 82302710, "body": "Thank you! Is there a way to speed up the process?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512556200, "post_id": 47671756, "comment_id": 82302961, "body": "Since they are deleted all at once, suspending calculation will not matter much but you can disable event handling and screen updating. See what happens with all three application environments temporarily halted."}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1512556300, "post_id": 47671756, "comment_id": 82303016, "body": "Ok, I already disabled the screen updating and handling. Maybe my laptop is to slow. Thank you!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1512555477, "last_edit_date": 1512555477, "creation_date": 1512555236, "answer_id": 47671756, "question_id": 47671447, "link": "https://stackoverflow.com/questions/47671447/excel-vba-find-and-delete-blank-cells-in-a-row-range/47671756#47671756", "title": "Excel VBA - find and delete blank cells in a row-range", "body": "<p>Locate the blank cells in column D and then create a union of the other adjoining columns.</p>\n\n<pre><code>Dim blnks As Range\nWith ThisWorkbook.Sheets(\"getDATA\")\n    On Error Resume Next\n    Set blnks = .Columns(\"D\").SpecialCells(xlCellTypeBlanks)\n    On Error GoTo 0\n    If Not blnks Is Nothing Then\n        Set blnks = Union(blnks.Offset(0, -2), blnks.Offset(0, -1), _\n                          blnks, blnks.Offset(0, 1))\n        blnks.Delete shift:=xlUp\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 47671756, "answer_count": 1, "score": 1, "last_activity_date": 1512555477, "creation_date": 1512554359, "last_edit_date": 1512554848, "question_id": 47671447, "link": "https://stackoverflow.com/questions/47671447/excel-vba-find-and-delete-blank-cells-in-a-row-range", "title": "Excel VBA - find and delete blank cells in a row-range", "body": "<p>I want to make a macro that finds every blank cell in column D. For example: If D4 has a blank cell, the cells B4, C4, D4, E4 should be deleted and shifted up so that there are now more blank cells.</p>\n\n<p>Somehow the macro doesn't delete anything.</p>\n\n<pre><code>Dim delREASON As Variant\nDim findReason As Range\nDim DelRng As Range\n\n    With ThisWorkbook.Sheets(\"getDATA\")\n        delREASON = Null\n        For Each findReason In .Range(.Range(\"D8\"), .Range(\"D8\").End(xlDown))\n            If Not (IsError(Application.Match(findReason.Value, delREASON, 0))) Then\n                If Not DelRng Is Nothing Then\n            Set DelRng = Application.Union(DelRng, .Range(.Cells(findReason.Row, \"B\"), .Cells(findReason.Row, \"E\")))\n        Else\n            Set DelRng = .Range(.Cells(findReason.Row, \"B\"), .Cells(findReason.Row, \"E\"))\n        End If\n    End If\nNext\n    End With\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1512553620, "post_id": 47671050, "comment_id": 82301197, "body": "If it is about Excel, please tag it so"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1512553783, "post_id": 47671050, "comment_id": 82301309, "body": "I think you will have all your answers here: <a href=\"https://stackoverflow.com/a/11267603/78522\">stackoverflow.com/a/11267603/78522</a>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1512553991, "post_id": 47671050, "comment_id": 82301443, "body": "@DumitruDaniel first, find the time to give credit to previous posts you had here. You have given 0 feedbacks so far."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 2, "creation_date": 1512554138, "post_id": 47671050, "comment_id": 82301553, "body": "16 questions and no accepted answers so I guess we can assume you will not make the effort to accept any answers this time either."}, {"owner": {"reputation": 399, "user_id": 7251685, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-cjqIiIyHfBQ/AAAAAAAAAAI/AAAAAAAANac/Wi8QkjBn3YQ/photo.jpg?sz=128", "display_name": "Dumitru Daniel", "link": "https://stackoverflow.com/users/7251685/dumitru-daniel"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1512578601, "post_id": 47671050, "comment_id": 82317766, "body": "Hi @Patrick Honorez, thank you, but i need to load the data in an object, not just copy it in my sheet."}, {"owner": {"reputation": 399, "user_id": 7251685, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-cjqIiIyHfBQ/AAAAAAAAAAI/AAAAAAAANac/Wi8QkjBn3YQ/photo.jpg?sz=128", "display_name": "Dumitru Daniel", "link": "https://stackoverflow.com/users/7251685/dumitru-daniel"}, "edited": false, "score": 0, "creation_date": 1515065536, "post_id": 47671050, "comment_id": 83163133, "body": "Hi  Nick.McDermaid. I did not know where the accept answer checkbox was untill recently. The checkbox was not very intuitive, as i have an older flat screen monitor, and i could barely see it. Now I know, I will start checking them out. There is no need to down-vote this post, it has nothing to do with it."}], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 7251685, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-cjqIiIyHfBQ/AAAAAAAAAAI/AAAAAAAANac/Wi8QkjBn3YQ/photo.jpg?sz=128", "display_name": "Dumitru Daniel", "link": "https://stackoverflow.com/users/7251685/dumitru-daniel"}, "edited": false, "score": 0, "creation_date": 1512578153, "post_id": 47671571, "comment_id": 82317498, "body": "Hi Johny, Thank you for response, but it&#39;s not splitting the data correctly. Please keep in mind that my CSV file is split by &quot;;&quot;"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 399, "user_id": 7251685, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-cjqIiIyHfBQ/AAAAAAAAAAI/AAAAAAAANac/Wi8QkjBn3YQ/photo.jpg?sz=128", "display_name": "Dumitru Daniel", "link": "https://stackoverflow.com/users/7251685/dumitru-daniel"}, "edited": false, "score": 0, "creation_date": 1512587304, "post_id": 47671571, "comment_id": 82322503, "body": "Please, see <a href=\"https://www.connectionstrings.com/textfile/\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://www.codeproject.com/Articles/26822/Read-Text-File-txt-csv-log-tab-fixed-length\" rel=\"nofollow noreferrer\">this</a> for delimiter paramaters."}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 2, "last_activity_date": 1512554698, "creation_date": 1512554698, "answer_id": 47671571, "question_id": 47671050, "link": "https://stackoverflow.com/questions/47671050/vba-import-csv-split-by-to-sheet/47671571#47671571", "title": "VBA, Import CSV split by &quot;;&quot; to sheet", "body": "<p>Here's example:</p>\n\n<pre><code>Public Sub QueryTextFile()\n\n    Dim rsData As ADODB.Recordset\n    Dim sConnect As String\n    Dim sSQL As String\n\n    ' Create the connection string.\n    sConnect = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n               \"Data Source=C:\\Files\\;\" &amp; _\n               \"Extended Properties=Text;\"\n\n    ' Create the SQL statement.\n    sSQL = \"SELECT * FROM Sales.csv;\"\n    Set rsData = New ADODB.Recordset\n    rsData.Open sSQL, sConnect, adOpenForwardOnly, _\n                adLockReadOnly, adCmdText\n\n    ' Check to make sure we received data.\n    If Not rsData.EOF Then\n        ' Dump the returned data onto Sheet1.\n        Sheet1.Range(\"A1\").CopyFromRecordset rsData\n    Else\n        MsgBox \"No records returned.\", vbCritical\n    End If\n\n    ' Clean up our Recordset object.\n    rsData.Close\n    Set rsData = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 399, "user_id": 7251685, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-cjqIiIyHfBQ/AAAAAAAAAAI/AAAAAAAANac/Wi8QkjBn3YQ/photo.jpg?sz=128", "display_name": "Dumitru Daniel", "link": "https://stackoverflow.com/users/7251685/dumitru-daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1515066061, "creation_date": 1515066061, "answer_id": 48094504, "question_id": 47671050, "link": "https://stackoverflow.com/questions/47671050/vba-import-csv-split-by-to-sheet/48094504#48094504", "title": "VBA, Import CSV split by &quot;;&quot; to sheet", "body": "<p>The only answer I found that was usable was to create an ini file in the current folder, and enter the delimiter in the ini file.</p>\n\n<pre><code>iniPath = activeworkbook.path &amp; \"\\\"\niniName = \"schema.ini\"\niniPathName = iniPath &amp; iniName\nIf Not fso.FileExists(iniPathName) Then\n    fso.CreateTextFile (iniPathName)\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 399, "user_id": 7251685, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-cjqIiIyHfBQ/AAAAAAAAAAI/AAAAAAAANac/Wi8QkjBn3YQ/photo.jpg?sz=128", "display_name": "Dumitru Daniel", "link": "https://stackoverflow.com/users/7251685/dumitru-daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553423036, "creation_date": 1512553115, "last_edit_date": 1553423036, "question_id": 47671050, "link": "https://stackoverflow.com/questions/47671050/vba-import-csv-split-by-to-sheet", "title": "VBA, Import CSV split by &quot;;&quot; to sheet", "body": "<p>I am trying to import a CSV file split by semicolon \";\" into an excel object so I can use it later on.</p>\n\n<p>Ideally i would like to use ADO, DAO or ADODB so I can also run SQL queries on the object, and get sum of specific fields, or total number of fields and so on.</p>\n\n<p>So far i've gotten the code below, but it does not split the data by \";\", so it all comes back as 1 field instead of multiple fields that can be handled.</p>\n\n<pre><code>Sub Import()\n   Dim conn As New ADODB.Connection\n   Dim rs As New ADODB.Recordset\n   Dim f As ADODB.Field\n\n   Dim csvName, csvPath\n\n    csvPath = ActiveWorkbook.path\n    csvName = \"fileName.csv\"\n\n   conn.Open \"DRIVER={Microsoft Text Driver (*.txt; *.csv)};DBQ=\" &amp; csvPath &amp; \";\"\n   rs.Open \"SELECT * FROM \" &amp; csvName, conn, adOpenStatic, adLockReadOnly, adCmdText\n\n   Debug.Print rs.Fields\n\n   While Not rs.EOF\n      For Each f In rs.Fields\n         Debug.Print f.Name &amp; \"=\" &amp; f.Value\n      Next\n   Wend\nEnd Sub\n</code></pre>\n\n<p>Can anyone give me an idea how I can also split the data by \";\" and query it using SQL query? Or a different object that I could load a CSV into and query certain columns.</p>\n"}, {"tags": ["vba", "powerpoint", "strikethrough"], "comments": [{"owner": {"reputation": 21, "user_id": 5696709, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/78e0d885b340e98be14ab15dd1451998?s=128&d=identicon&r=PG&f=1", "display_name": "Menno", "link": "https://stackoverflow.com/users/5696709/menno"}, "edited": false, "score": 0, "creation_date": 1512551808, "post_id": 47670604, "comment_id": 82299969, "body": "Sorry, The  strikethrough does not work in this editor."}, {"owner": {"reputation": 21, "user_id": 5696709, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/78e0d885b340e98be14ab15dd1451998?s=128&d=identicon&r=PG&f=1", "display_name": "Menno", "link": "https://stackoverflow.com/users/5696709/menno"}, "edited": false, "score": 0, "creation_date": 1512551866, "post_id": 47670604, "comment_id": 82300006, "body": "Hallo jaja : The function works (Now Hallo is strikedthroug). Hallo jaja : function does not work (Now jaja is strikedthroug)"}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1512555529, "creation_date": 1512555529, "answer_id": 47671852, "question_id": 47670604, "link": "https://stackoverflow.com/questions/47670604/vba-powerpoint-strikethrough-of-a-single-word/47671852#47671852", "title": "VBA powerpoint Strikethrough of a single word", "body": "<p><strong>Try <code>.TextRange2</code> instead of <code>.TextRange</code></strong> with <strong>Font.<del>Strikethrough</del></strong> :</p>\n\n<p>Example:</p>\n\n<pre><code>Sub ST() \n    With ActiveWindow.Selection \n        .TextRange2.Font.Strikethrough = msoTrue \n        .TextRange2.Font.Fill.ForeColor.RGB = vbRed \n    End With \nEnd Sub \n</code></pre>\n\n<p>Below is an (incomplete) list of differences in handling of the two property types:</p>\n\n<pre><code>| \ufeffTextRange Property    | TextRange Return Type | TextRange2 Property                        | TextRange2 Return Type |\n|-----------------------|-----------------------|--------------------------------------------|------------------------|\n| ActionSettings        | ActionSettings        | \uff0d                                         | \uff0d                     |\n| Application           | Application           | Application                                | Application            |\n| BoundHeight           | Single                | BoundHeight                                | Single                 |\n| BoundLeft             | Single                | BoundLeft                                  | Single                 |\n| BoundTop              | Single                | BoundTop                                   | Single                 |\n| BoundWidth            | Single                | BoundWidth                                 | Single                 |\n| \uff08Characters method\uff09   | \uff08TextRange\uff09           | Characters                                 | TextRange2             |\n| Count                 | Long                  | Count                                      | Long                   |\n| \uff0d                    | \uff0d                    | Creator                                    | Long                   |\n| Font                  | Font                  | Font                                       | Font2                  |\n| IndentLevel           | Long                  | \uff08Paragraph Format2 .IndentLevel propety\uff09   | \uff08Long)                |\n| LanguageID            | Mso LanguageID        | LanguageID                                 | Mso LanguageID         |\n| Length                | Long                  | Length                                     | Long                   |\n| \uff08Lines method\uff09        | \uff08TextRange\uff09           | Lines                                      | TextRange2             |\n| \uff0d                    | \uff0d                    | MathZones                                  | TextRange2             |\n| Paragraph Format      | Paragraph Format      | Paragraph Format                           | Paragraph Format2      |\n| \uff08Paragraphs method\uff09   | \uff08TextRange\uff09           | Paragraphs                                 | TextRange2             |\n| Parent                | Object                | Parent                                     | Object                 |\n| \uff08Runs method\uff09         | \uff08TextRange\uff09           | Runs                                       | TextRange2             |\n| \uff08Sentences method\uff09    | \uff08TextRange\uff09           | Sentences                                  | TextRange2             |\n| Start                 | Long                  | Start                                      | Long                   |\n| Text                  | String                | Text                                       | String                 |\n| \uff08Words method\uff09        | \uff08TextRange\uff09           | Words                                      | TextRange2             |\n|                       |                       |                                            |                        |\n</code></pre>\n\n<p>More information:</p>\n\n<ul>\n<li><p><a href=\"http://vba.relief.jp/powerpoint-vba-textrange-textrange2-properties-methods-list/\" rel=\"nofollow noreferrer\">PowerPoint VBA: TextRange and TextRange2 Properties and Methods List</a></p></li>\n<li><p><a href=\"https://www.pcreview.co.uk/threads/powerpoint-text-link-strikethrough-or-black-out.3863983/\" rel=\"nofollow noreferrer\">Powerpoint text/link strikethrough or black out</a></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1512582246, "creation_date": 1512582246, "answer_id": 47680409, "question_id": 47670604, "link": "https://stackoverflow.com/questions/47670604/vba-powerpoint-strikethrough-of-a-single-word/47680409#47680409", "title": "VBA powerpoint Strikethrough of a single word", "body": "<p>Since only SOME text within a text box may be underlined, you need to look at the .Runs collection for each shape that has text in order to extract just the struck-out text. Here's a start:</p>\n\n<pre><code>Sub ListStrikeThroughText()\n' This will list the struck-through text from Slide 1\n' Adapt as needed to collect all of the text from all slides\n\nDim sTextList As String\nDim oShp As Shape\nDim oRng As TextRange2\nDim x As Long\n\nWith ActivePresentation.Slides(1)\n    For Each oShp In .Shapes\n        If oShp.HasTextFrame And oShp.TextFrame2.HasText Then\n            With oShp.TextFrame2.TextRange\n                For x = 1 To .Runs.Count\n                    If .Runs(x).Font.Strikethrough Then\n                        sTextList = sTextList &amp; .Runs(x).Text &amp; vbCrLf\n                    End If\n                Next\n            End With\n\n        End If\n    Next\nEnd With\n\nMsgBox sTextList\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5696709, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/78e0d885b340e98be14ab15dd1451998?s=128&d=identicon&r=PG&f=1", "display_name": "Menno", "link": "https://stackoverflow.com/users/5696709/menno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 478, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512582246, "creation_date": 1512551722, "last_edit_date": 1512563985, "question_id": 47670604, "link": "https://stackoverflow.com/questions/47670604/vba-powerpoint-strikethrough-of-a-single-word", "title": "VBA powerpoint Strikethrough of a single word", "body": "<p>I have a powerpoint file with several sheets. On this sheets are text fields with texts. Some of the words are strikethrough. I would like to make a list of all the slides where a word exists which is strike through.\nI tried to use the function:\nIf  objShape.TextFrame2.TextRange.Font.Strikethrough = True Then</p>\n\n<p>Problem is that is only get true when the first word is strike through. So \n<del>Hallo jaja the function works</del>.\nHallo jaja  \uf0e0function does not work\nDoes anybody have a solution for this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2884, "user_id": 6060083, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10153430563728202/picture?type=large", "display_name": "sudonym", "link": "https://stackoverflow.com/users/6060083/sudonym"}, "edited": false, "score": 0, "creation_date": 1512551536, "post_id": 47670364, "comment_id": 82299808, "body": "thanks. question: is VBA similar to python in this context where loops take more ressources than vectorized functions? in this case the other solution is a bit more lean"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1512550828, "creation_date": 1512550828, "answer_id": 47670364, "question_id": 47670247, "link": "https://stackoverflow.com/questions/47670247/how-to-shift-an-excel-usedrange-to-begin-at-cell-a1-its-worksheet-i-e-delete-a/47670364#47670364", "title": "How to shift an excel UsedRange to begin at cell A1 its worksheet (i.e. delete all blank rows and columns outside UsedRange)?", "body": "<p>Just keep deleting row 1 and column A while they are blank.</p>\n\n<pre><code>with worksheets(\"sheet1\")\n    do while not cbool(application.counta(.rows(1).cells))\n        .rows(1).entirerow.delete\n    loop\n    do while not cbool(application.counta(.columns(1).cells))\n        .columns(1).entirecolumn.delete\n    loop\nend with\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 1, "creation_date": 1512551188, "post_id": 47670383, "comment_id": 82299618, "body": "Or in one line <code>ActiveSheet.UsedRange.Cut Range(&quot;A1&quot;)</code>"}], "tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": true, "score": 2, "last_activity_date": 1512551270, "last_edit_date": 1512551270, "creation_date": 1512550902, "answer_id": 47670383, "question_id": 47670247, "link": "https://stackoverflow.com/questions/47670247/how-to-shift-an-excel-usedrange-to-begin-at-cell-a1-its-worksheet-i-e-delete-a/47670383#47670383", "title": "How to shift an excel UsedRange to begin at cell A1 its worksheet (i.e. delete all blank rows and columns outside UsedRange)?", "body": "<p>What about <code>Cut &gt;&gt; Paste</code>:</p>\n\n<pre><code>ActiveSheet.UsedRange.Cut\nActiveSheet.Paste Range(\"A1\")\n</code></pre>\n\n<p>or, as @JohnyL suggested in comment, use short version:</p>\n\n<pre><code>ActiveSheet.UsedRange.Cut Range(\"A1\")\n</code></pre>\n"}], "owner": {"reputation": 2884, "user_id": 6060083, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10153430563728202/picture?type=large", "display_name": "sudonym", "link": "https://stackoverflow.com/users/6060083/sudonym"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 47670383, "answer_count": 2, "score": 1, "last_activity_date": 1512551270, "creation_date": 1512550453, "question_id": 47670247, "link": "https://stackoverflow.com/questions/47670247/how-to-shift-an-excel-usedrange-to-begin-at-cell-a1-its-worksheet-i-e-delete-a", "title": "How to shift an excel UsedRange to begin at cell A1 its worksheet (i.e. delete all blank rows and columns outside UsedRange)?", "body": "<p>I am new to VBA and have not yet been able to figure out how to select and delete the \"non-UsedRange\" from a sheet at once (i.e. shift the UsedRange to begin at cell A1).</p>\n\n<p>In other words, I need a dynamic solution to move a UsedRange of variable size from its variable location to the very top left of its worksheet (i.e. all empty columns/rows on the left/top side of the UsededRange should disapear).</p>\n\n<p>I have (probably) found a one-liner to do this (only) row-wise for (only) one specific column:</p>\n\n<pre><code>ActiveSheet.Columns(\"A:A\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n\n<p><strong>How to shift an excel UsedRange to begin at cell A1 its worksheet (i.e. delete all blank rows and columns outside UsedRange)?</strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 1, "creation_date": 1512548891, "post_id": 47669775, "comment_id": 82298383, "body": "can you try <code>UCase</code> to search the items. for eg: <code>InStr(Ucase(items), &quot;HARMO&quot;) Or InStr(Ucase(items), &quot;POINTT&quot;)</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1512550686, "post_id": 47669775, "comment_id": 82299351, "body": "@Jonathan read my answer and code below, you should switch to array of counters, and to <code>Select Case</code>."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1512557069, "post_id": 47669775, "comment_id": 82303539, "body": "Incidently, in your original code as structured Excel will look up which cell is the Activecell for every line. If you must use Activecell then using a With/End With structure would reduce the work it&#39;s doing considerably"}], "answers": [{"comments": [{"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "edited": false, "score": 0, "creation_date": 1512549410, "post_id": 47669889, "comment_id": 82298668, "body": "Found it. thank you. I missed that part. Need to change my keywords now for searching. Thanks again."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 5, "last_activity_date": 1512549392, "last_edit_date": 1512549392, "creation_date": 1512549020, "answer_id": 47669889, "question_id": 47669775, "link": "https://stackoverflow.com/questions/47669775/vba-instr-or-issue/47669889#47669889", "title": "VBA: InStr &quot;OR&quot; issue", "body": "<p>In an entire <code>If/ElseIf</code> statement, each branch can only execute if all preceding branches did not.</p>\n\n<p>The cell circled in blue triggered the <code>Harmo</code> branch and it cannot trigger any other branches.</p>\n\n<p>If you don't want that to happen, make each branch a separate <code>If/End If</code> statement.</p>\n\n<p>On a side note, you should consider explicitly comparing the result of <code>InStr</code> to zero in all cases. It works currently because you are only using <code>Or</code>, but if you decide to make the condition more complex it might <a href=\"https://stackoverflow.com/q/24684955/11683\">stop working</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1512550371, "creation_date": 1512550371, "answer_id": 47670228, "question_id": 47669775, "link": "https://stackoverflow.com/questions/47669775/vba-instr-or-issue/47670228#47670228", "title": "VBA: InStr &quot;OR&quot; issue", "body": "<p>Looking at your code, there is a much more efficient and shorter (code wise) to go.</p>\n\n<p>Switch your multiple <code>ElseIf</code> with <code>Select Case</code>, and instead of having 14 counters, why not use an array of counters <code>CountofArr</code> ?</p>\n\n<p>See sample code below, you can continue the implementation easily :</p>\n\n<pre><code>Option Compare Text\n\nPublic Sub Keywords_Outlook()\n\nDim row_number As Long, LastRow As Long\n\n' use an array that will have multiple counters\nDim CountofArr() As Long\n\nReDim CountofArr(0 To 14)\n\nDim items As Variant\nDim cursht As String 'for the macro to run in any sheet\n\ncursht = ActiveSheet.Name ' for the macro to run in any sheet\n\nWith Sheets(cursht)\n    LastRow = .Cells(.Rows.Count, \"N\").End(xlUp).Row ' get last row with data in column \"N\"\n\n    For row_number = 1 To LastRow\n        items = .Range(\"N\" &amp; row_number).Value2\n\n        Select Case True\n            Case items Like \"*harmo*\", items Like \"*pointt*\"\n                CountofArr(0) = CountofArr(0) + 1\n\n            Case items Like \"*room*\"\n                CountofArr(1) = CountofArr(1) + 1\n\n            ' add the rest of your cases below\n\n\n        End Select\n    Next row_number\n\n    ' read the array direclty to the cells\n    For row_number = 4 To 18\n        .Range(\"O\" &amp; row_number).Value = CountofArr(row_number - 4)\n    Next row_number\n\n    ' rest of your code\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 47669889, "answer_count": 2, "score": 1, "last_activity_date": 1512550371, "creation_date": 1512548533, "last_edit_date": 1531164843, "question_id": 47669775, "link": "https://stackoverflow.com/questions/47669775/vba-instr-or-issue", "title": "VBA: InStr &quot;OR&quot; issue", "body": "<p>I am having issue with my InStr \"OR\" code. This code: <code>If InStr(items, \"harmo\") Or InStr(items, \"pointt\") Then count_of_Harmo = count_of_Harmo + 1</code> \nis able to execute well (Highlighted in red below) but this one doesn't <code>ElseIf InStr(items, \"addi\") Or InStr(items, \"add-i\") Or InStr(items, \"plug\") Then count_of_Addi = count_of_Addi + 1</code>(Highlighted in blue below). Please don't mind the other results/counts on the image below as i was not able to capture the whole page as it I think it is relevant to the case. Please see the full code below too. Thank you.\n<a href=\"https://i.stack.imgur.com/EqIIF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EqIIF.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Compare Text\n\nPublic Sub Keywords_Outlook()\n\nDim row_number As Long\nDim count_of_Harmo As Long\nDim count_of_Room As Long\nDim count_of_Skyp As Long\nDim count_of_Detach As Long\nDim count_of_Wire As Long\nDim count_of_Addi As Long\nDim count_of_crash As Long\nDim count_of_share As Long\nDim count_of_signa As Long\nDim count_of_passw As Long\nDim count_of_follo_and_ops As Long\nDim count_of_follo_and_req As Long\nDim count_of_others As Long\nDim items As Variant\nDim cursht As String 'for the macro to run in any sheet\ncursht = ActiveSheet.Name 'for the macro to run in any sheet\n\nrow_number = 1\ncount_of_Harmo = 0\ncount_of_Room = 0\ncount_of_Skyp = 0\ncount_of_Detach = 0\ncount_of_Wire = 0\ncount_of_Addi = 0\ncount_of_crash = 0\ncount_of_share = 0\ncount_of_signa = 0\ncount_of_passw = 0\ncount_of_follo_and_ops = 0\ncount_of_follo_and_req = 0\ncount_of_others = 0\ncount_of_all = 0\n\nDo\n\nrow_number = row_number + 1\nitems = Sheets(cursht).Range(\"N\" &amp; row_number)\n\n    If InStr(items, \"harmo\") Or InStr(items, \"pointt\") Then\n        count_of_Harmo = count_of_Harmo + 1\n    ElseIf InStr(items, \"room\") Then\n        count_of_Room = count_of_Room + 1\n    ElseIf InStr(items, \"skyp\") Then\n        count_of_Skyp = count_of_Skyp + 1\n    ElseIf InStr(items, \"detach\") Then\n        count_of_Detach = count_of_Detach + 1\n    ElseIf InStr(items, \"wire\") Then\n        count_of_Wire = count_of_Wire + 1\n    ElseIf InStr(items, \"addi\") Or InStr(items, \"add-i\") Or InStr(items, \"plug\") Then\n        count_of_Addi = count_of_Addi + 1\n    ElseIf InStr(items, \"crash\") Or InStr(items, \"car\") Then\n        count_of_crash = count_of_crash + 1\n    ElseIf InStr(items, \"share\") Then\n        count_of_share = count_of_share + 1\n    ElseIf InStr(items, \"signa\") Then\n        count_of_signa = count_of_signa + 1\n    ElseIf InStr(items, \"passw\") Then\n        count_of_passw = count_of_passw + 1\n    ElseIf Trim(items) Like \"*followu*\" And Trim(items) Like \"*ops*\" Then\n        count_of_follo_and_ops = count_of_follo_and_ops + 1\n    ElseIf Trim(items) Like \"*followu*\" And Trim(items) Like \"*req*\" Then\n        count_of_follo_and_req = count_of_follo_and_req + 1\n\n    ElseIf items &lt;&gt; \"\" Then\n        count_of_others = count_of_others + 1\n    End If\n\nLoop Until items = \"\"\n\ncount_of_all = count_of_Harmo + count_of_Room + count_of_Skyp + count_of_Detach + count_of_Wire + count_of_Addi + count_of_crash + count_of_signa + count_of_passw + count_of_follo_and_ops + count_of_follo_and_req + count_of_others\n\nRange(\"N2\").Select\n\n\nSelection.End(xlDown).Select\nlastCell = ActiveCell.Address\n\nActiveCell.Offset(3, 0).Value = \"Count\"\nActiveCell.Offset(4, 0).Value = count_of_Harmo\nActiveCell.Offset(5, 0).Value = count_of_Room\nActiveCell.Offset(6, 0).Value = count_of_Skyp\nActiveCell.Offset(7, 0).Value = count_of_Detach\nActiveCell.Offset(8, 0).Value = count_of_Wire\nActiveCell.Offset(9, 0).Value = count_of_Addi\nActiveCell.Offset(10, 0).Value = count_of_crash\nActiveCell.Offset(11, 0).Value = count_of_share\nActiveCell.Offset(12, 0).Value = count_of_signa\nActiveCell.Offset(13, 0).Value = count_of_passw\nActiveCell.Offset(14, 0).Value = count_of_follo_and_ops\nActiveCell.Offset(15, 0).Value = count_of_follo_and_req\nActiveCell.Offset(16, 0).Value = count_of_others\nActiveCell.Offset(18, 0).Value = count_of_all\nActiveCell.Offset(3, 1).Value = \"Outlook Keywords\"\nActiveCell.Offset(4, 1).Value = \"Harmo\"\nActiveCell.Offset(5, 1).Value = \"Room\"\nActiveCell.Offset(6, 1).Value = \"Skyp\"\nActiveCell.Offset(7, 1).Value = \"Detach\"\nActiveCell.Offset(8, 1).Value = \"Wire\"\nActiveCell.Offset(9, 1).Value = \"Addi or add-i or plug\"\nActiveCell.Offset(10, 1).Value = \"Crash\"\nActiveCell.Offset(11, 1).Value = \"Share\"\nActiveCell.Offset(12, 1).Value = \"Signa\"\nActiveCell.Offset(13, 1).Value = \"passw\"\nActiveCell.Offset(14, 1).Value = \"FollowU and ops\"\nActiveCell.Offset(15, 1).Value = \"FollowU and req\"\nActiveCell.Offset(16, 1).Value = \"Others\"\nActiveCell.Offset(18, 1).Value = \"Total\"\nActiveCell.Offset(3, -1).Value = \"Percent\"\nActiveCell.Offset(4, -1).Value = count_of_Harmo / count_of_all\nActiveCell.Offset(5, -1).Value = count_of_Room / count_of_all\nActiveCell.Offset(6, -1).Value = count_of_Skyp / count_of_all\nActiveCell.Offset(7, -1).Value = count_of_Detach / count_of_all\nActiveCell.Offset(8, -1).Value = count_of_Wire / count_of_all\nActiveCell.Offset(9, -1).Value = count_of_Addi / count_of_all\nActiveCell.Offset(10, -1).Value = count_of_crash / count_of_all\nActiveCell.Offset(11, -1).Value = count_of_share / count_of_all\nActiveCell.Offset(12, -1).Value = count_of_signa / count_of_all\nActiveCell.Offset(13, -1).Value = count_of_passw / count_of_all\nActiveCell.Offset(14, -1).Value = count_of_follo_and_ops / count_of_all\nActiveCell.Offset(15, -1).Value = count_of_follo_and_req / count_of_all\nActiveCell.Offset(16, -1).Value = count_of_others / count_of_all\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "edited": false, "score": 0, "creation_date": 1512548938, "post_id": 47669701, "comment_id": 82298411, "body": "Thank you very much! Just the code I&#39;ve been looking for"}], "tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": true, "score": 2, "last_activity_date": 1512548209, "creation_date": 1512548209, "answer_id": 47669701, "question_id": 47669619, "link": "https://stackoverflow.com/questions/47669619/wdpastetext-pasting-as-image-on-word/47669701#47669701", "title": "wdPasteText pasting as image on Word", "body": "<p>The solution here is to use this code:</p>\n\n<pre><code>.Selection.PasteSpecial Link:=False, DataType:=2, _\n    Placement:=wdInLine, DisplayAsIcon:=False\n</code></pre>\n\n<p><strong>Short explanation...:</strong></p>\n\n<p>You are working with Late Bindings and without <code>Option Explicit</code> statement. Therefore all <code>MS Word constants</code> like <code>wdPasteText</code>, <code>wdInLine</code> are considered as variables with not declared values. Therefore you have <code>0</code> for both constants. Solutions:</p>\n\n<ol>\n<li>use <code>early binding</code> to keep <code>text constants</code></li>\n<li>always use <code>Option Explicit</code> to avoid such problems</li>\n<li>for <code>late binding</code> always use numeric values instead of text constants.</li>\n</ol>\n"}], "owner": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 47669701, "answer_count": 1, "score": 0, "last_activity_date": 1512548233, "creation_date": 1512547901, "last_edit_date": 1512548233, "question_id": 47669619, "link": "https://stackoverflow.com/questions/47669619/wdpastetext-pasting-as-image-on-word", "title": "wdPasteText pasting as image on Word", "body": "<p>I am very close to finally completing this code I have been working on but I have hit a bit of a snag. I  need the selected to be pasted as plain text onto a word document, however, with my current code, it pastes the selected as an image.</p>\n\n<pre><code>Sub CopyRangeToWord()\n Dim objWord\n Dim objDoc\n\nSet objWord = CreateObject(\"Word.Application\")\nSet objDoc = objWord.Documents.Add\n\nSheets(\"Executive Outline\").Range(\"B5:B220\").Select\nSelection.Copy\n\nWith objWord\n    .Selection.PasteSpecial Link:=False, DataType:=wdPasteText, _\n    Placement:=wdInLine, DisplayAsIcon:=False\nEnd With\nobjWord.Visible = True\nEnd Sub\n</code></pre>\n\n<p>Can someone please let me know where I am going wrong? I would greatly appreciate it. </p>\n"}, {"tags": ["excel", "conditional-formatting", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9060340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ba4e2f6e84f13aed8faa03046e9e9fe?s=128&d=identicon&r=PG&f=1", "display_name": "Azlan O.", "link": "https://stackoverflow.com/users/9060340/azlan-o"}, "edited": false, "score": 0, "creation_date": 1512616149, "post_id": 47674052, "comment_id": 82333525, "body": "Wow!..Thanks a lot. It functioning like as i want.. Gracias"}, {"owner": {"reputation": 3, "user_id": 9060340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ba4e2f6e84f13aed8faa03046e9e9fe?s=128&d=identicon&r=PG&f=1", "display_name": "Azlan O.", "link": "https://stackoverflow.com/users/9060340/azlan-o"}, "edited": false, "score": 0, "creation_date": 1512701525, "post_id": 47674052, "comment_id": 82374038, "body": "Hi..I&#39;m encounter another issue which is when i want to add the formula using VBA, it does not auto detect like before. Can you please assist? Code: With Range(&quot;$A:$A&quot;).FormatConditions.Add(Type:=xlExpression, Formula1:=&quot;your given code&quot;)"}, {"owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "reply_to_user": {"reputation": 3, "user_id": 9060340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ba4e2f6e84f13aed8faa03046e9e9fe?s=128&d=identicon&r=PG&f=1", "display_name": "Azlan O.", "link": "https://stackoverflow.com/users/9060340/azlan-o"}, "edited": false, "score": 0, "creation_date": 1512721287, "post_id": 47674052, "comment_id": 82380282, "body": "@Azlan Sorry, I don\u2019t know what would cause that - did you double up the quotes in the formula?"}, {"owner": {"reputation": 3, "user_id": 9060340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ba4e2f6e84f13aed8faa03046e9e9fe?s=128&d=identicon&r=PG&f=1", "display_name": "Azlan O.", "link": "https://stackoverflow.com/users/9060340/azlan-o"}, "edited": false, "score": 0, "creation_date": 1512721624, "post_id": 47674052, "comment_id": 82380430, "body": "Yes. I have double up the quotes in the formula. But I found that I need to save and close and reopen back then the formula works. I also found that the formula works when I click apply in the condtional formula box."}, {"owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "reply_to_user": {"reputation": 3, "user_id": 9060340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ba4e2f6e84f13aed8faa03046e9e9fe?s=128&d=identicon&r=PG&f=1", "display_name": "Azlan O.", "link": "https://stackoverflow.com/users/9060340/azlan-o"}, "edited": false, "score": 0, "creation_date": 1512726952, "post_id": 47674052, "comment_id": 82383434, "body": "In conditional formatting there&#39;s no distinction between formulas that require &quot;array entry&quot; and those that don&#39;t, but I wonder if that&#39;s an issue - try replacing &#39;SUM&#39; with &#39;SUMPRODUCT&#39;"}, {"owner": {"reputation": 3, "user_id": 9060340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ba4e2f6e84f13aed8faa03046e9e9fe?s=128&d=identicon&r=PG&f=1", "display_name": "Azlan O.", "link": "https://stackoverflow.com/users/9060340/azlan-o"}, "edited": false, "score": 0, "creation_date": 1512953112, "post_id": 47674052, "comment_id": 82450177, "body": "still not working..humm maybe I need to figured out another way."}], "tags": [], "owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "is_accepted": true, "score": 0, "last_activity_date": 1512562373, "creation_date": 1512562373, "answer_id": 47674052, "question_id": 47669213, "link": "https://stackoverflow.com/questions/47669213/excel-conditional-formatting-not-detecting-string-with-html-tags-at-the-beginn/47674052#47674052", "title": "Excel - Conditional Formatting not detecting String with html tags at the beginning", "body": "<p>I think you'll need to avoid <code>COUNTIFS</code>, try this version</p>\n\n<p><code>=AND($A1&lt;&gt;\"\",SUM(0+($A$1:$A$100&amp;\"-\"&amp;$B$1:$B$100&amp;\"-\"&amp;$C$1:$C$100&amp;\"-\"&amp;D$1:$D$100&amp;\"-\"&amp;$E$1:$E$100=$A1&amp;\"-\"&amp;$B1&amp;\"-\"&amp;$C1&amp;\"-\"&amp;$D1&amp;\"-\"&amp;$E1))&gt;1)</code></p>\n\n<p>I recommend a restricted range for efficiency - I used 100 rows, expand as required</p>\n"}], "owner": {"reputation": 3, "user_id": 9060340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ba4e2f6e84f13aed8faa03046e9e9fe?s=128&d=identicon&r=PG&f=1", "display_name": "Azlan O.", "link": "https://stackoverflow.com/users/9060340/azlan-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 47674052, "answer_count": 1, "score": 0, "last_activity_date": 1512562373, "creation_date": 1512546082, "last_edit_date": 1531161705, "question_id": 47669213, "link": "https://stackoverflow.com/questions/47669213/excel-conditional-formatting-not-detecting-string-with-html-tags-at-the-beginn", "title": "Excel - Conditional Formatting not detecting String with html tags at the beginning", "body": "<p>Good day, I'm running this conditional formatting code in excel to find duplicate value. Row with same value will be highlighted with Red in column 1</p>\n\n<pre><code>=COUNTIFS($A:$A,$A1,$B:$B,$B1,$C:$C,$C1,$D:$D,$D1,$E:$E,$E1)&gt;1\n</code></pre>\n\n<p>and it is correct with below result</p>\n\n<p><a href=\"https://i.stack.imgur.com/VsTJp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VsTJp.png\" alt=\"Correct\"></a></p>\n\n<p>But, with data that consist html tag, it is not functioning very well. Refer image below. Row 8 should be not indicate as duplicate as the value in column E is differ</p>\n\n<p><a href=\"https://i.stack.imgur.com/VsTJp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OIlID.png\" alt=\"Row 8 should be not indicate as duplicate as the value in column E is differ\"></a></p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1512554873, "post_id": 47671530, "comment_id": 82302053, "body": "Quite cool answer, but the op is copying the picture to Word."}, {"owner": {"reputation": 185, "user_id": 8224420, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8d53f6c9226fbd86d9b159a2b9d1658e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Phi", "link": "https://stackoverflow.com/users/8224420/joe-phi"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1512555229, "post_id": 47671530, "comment_id": 82302293, "body": "yep, true. But if the code can grab the picture object after pasting it and knows the frame size of word, then..."}, {"owner": {"reputation": 279, "user_id": 6506784, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/36e8dca1e3e5544488b9a819a4339d13?s=128&d=identicon&r=PG&f=1", "display_name": "Vito", "link": "https://stackoverflow.com/users/6506784/vito"}, "edited": false, "score": 0, "creation_date": 1512620204, "post_id": 47671530, "comment_id": 82334393, "body": "or is it more convenient to extract the table  into table format from excel and  and best fit the size in word doc later?"}], "tags": [], "owner": {"reputation": 185, "user_id": 8224420, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8d53f6c9226fbd86d9b159a2b9d1658e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Phi", "link": "https://stackoverflow.com/users/8224420/joe-phi"}, "is_accepted": false, "score": 0, "last_activity_date": 1512557038, "last_edit_date": 1512557038, "creation_date": 1512554563, "answer_id": 47671530, "question_id": 47669053, "link": "https://stackoverflow.com/questions/47669053/how-to-enlarge-and-widen-the-photo-as-it-can-in-ms-word/47671530#47671530", "title": "How to enlarge and widen the photo as it can in ms word?", "body": "<p>Although I don't fiddle with Word but Excel only it might give you an idea...</p>\n\n<p>The code of my XmasPrep excel sucks in a bunch of pictures in order to produce a catalog, listing the pictures to select from.</p>\n\n<p><a href=\"https://i.stack.imgur.com/snvS3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/snvS3.png\" alt=\"enter image description here\"></a></p>\n\n<p>For each line, i.e. each picture, the code </p>\n\n<ul>\n<li>assigns an Excel cell range and then resizes the range ROW height and width\nas well as the range height itself</li>\n<li><p>assigns the picture object thisPic = .Parent.Pictures.Insert(picFileName) and then resizes that according to the cell range's coordinates and size:</p>\n\n<pre><code>thisPic.Top = .Top + 1\nthisPic.Left = .Left + 1\nthisPic.Width = .Width - 2\nthisPic.Height = .Height - 2\n</code></pre></li>\n</ul>\n\n<p>So, if you're able to grab the picture object (thisPic) in Word you might be able to resize it to your needs as well. Hope it helps.</p>\n\n<pre><code>    :\n    Const MaxHeight = 50\n    Const MaxWidth = 14\n    Dim picFileName         As String\n    Dim i, j, k             As Long\n    Dim col_Filenames       As Long\n    Dim col_Pictures        As Long\n    Dim range_PicCell       As Range\n    Dim thisPic             As Picture\n    :\n\n    picFileName = filesPath &amp; select2order.Cells(i, col_Filenames).Value\n    Set range_PicCell = select2order.Cells(i, col_Pictures)\n    range_PicCell.RowHeight = MaxHeight\n    range_PicCell.ColumnWidth = MaxWidth\n    With range_PicCell\n        .Height = MaxHeight\n        Set thisPic = .Parent.Pictures.Insert(picFileName)\n        thisPic.Top = .Top + 1\n        thisPic.Left = .Left + 1\n        thisPic.Width = .Width - 2\n        thisPic.Height = .Height - 2\n    End With\n    :\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 6506784, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/36e8dca1e3e5544488b9a819a4339d13?s=128&d=identicon&r=PG&f=1", "display_name": "Vito", "link": "https://stackoverflow.com/users/6506784/vito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512557038, "creation_date": 1512545412, "question_id": 47669053, "link": "https://stackoverflow.com/questions/47669053/how-to-enlarge-and-widen-the-photo-as-it-can-in-ms-word", "title": "How to enlarge and widen the photo as it can in ms word?", "body": "<p>my program :</p>\n\n<p>produce a picture that is extracting data from excel .</p>\n\n<p>Paste it in word and make the page setting as Landscape .</p>\n\n<p>However ,the picture generated is small and the setting of page become custom.</p>\n\n<p>the photo is so wide .I don't want to enlarge by myself everytimes. </p>\n\n<p>How can I add this setting in vba ?Make it as large and wide as it can .</p>\n\n<p>Secondly , it is pleasure that the data extracted can be pasted as table format. </p>\n\n<p>my codes :</p>\n\n<pre><code>   Private Sub CommandButton1_Click()\n\n    Dim tbl0 As Excel.RANGE\n    Dim Tbl As Excel.RANGE\n    Dim tbl2 As Excel.RANGE\n\n    Dim wordApp As Word.Application\n    Dim myDoc As Word.Document\n    Dim WordTable As Word.Table\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"17-18\")             ' Change e.g. sheet9.Name\n    'Optimize Code\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\nValue1 = Me.TextBox1.Value\nValue2 = Me.TextBox2.Value\n    ws.Rows(\"84:89\").EntireRow.Hidden = True 'ADJUST AS APPROPRIATE\n\n    'Copy Range from Excel\n    'Set tbl0 = ws.RANGE(\"A78:I83\")\n    Set Tbl = ws.RANGE(\"A78:I92\")\n\n\n    ' Set tbl2 = ws.Range(\"A90:I92\")\n\n    'Create an Instance of MS Word\n    On Error Resume Next\n\n    'Is MS Word already opened?\n    Set wordApp = GetObject(Class:=\"Word.Application\")\n\n    'Clear the error between errors\n    Err.Clear\n\n    'If MS Word is not already open then open MS Word\n    If wordApp Is Nothing Then Set wordApp = CreateObject(Class:=\"Word.Application\")\n\n    'Handle if the Word Application is not found\n    If Err.Number = 429 Then\n        MsgBox \"Microsoft Word could not be found, aborting.\"\n        GoTo EndRoutine\n    End If\n\n    On Error GoTo 0\n\n    'Make MS Word Visible and Active\n    wordApp.Visible = True\n    wordApp.Activate\n\n    'Create a New Document\n    Set myDoc = wordApp.Documents.Add\n\n    'Trigger copy separately for each table + paste for each table\n\n    Tbl.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n\n    wordApp.Selection.Paste\n    wordApp.Selection.TypeParagraph\n\n    wordApp.Selection.PageSetup.Orientation = wdOrientLandscape\n\n    resize_all_images_to_page_width myDoc\n\nEndRoutine:\n    'Optimize Code\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n    'Clear The Clipboard\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1512547753, "post_id": 47668892, "comment_id": 82297842, "body": "your code won&#39;t complie, since you are not closing your <code>Do While rws &lt;&gt; 0</code>"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1512559599, "post_id": 47668892, "comment_id": 82305200, "body": "Oops missed that"}], "tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": false, "score": 0, "last_activity_date": 1512559587, "last_edit_date": 1512559587, "creation_date": 1512544814, "answer_id": 47668892, "question_id": 47668636, "link": "https://stackoverflow.com/questions/47668636/do-loop-and-if-statement-in-excel/47668892#47668892", "title": "Do Loop and If Statement in Excel", "body": "<p>The error comes from your ' in the code. (Easily visible already here in grey). If I understood your code correctly then you should correct it by entering real sheets and range as below (not tested):</p>\n\n<pre><code>Sub Test2()\n\nDim rws As Integer\nDim counter As Integer\n\nrws = 6\ncounter = 2\n\nDo While rws &lt;&gt; 0\n\nIf Sheets(\"Data Sheet with Space\").Range(\"J\" &amp; counter).Value = Cells(1, 10).Value Then\n\n\nSheets(\"WorkSheet\").Range(\"A\" &amp; counter).Value = Sheets(\"Data Sheet with Space\").Range(\"A\" &amp; counter).Value\n\nEnd If\n\ncounter = counter + 1\nrws = rws - 1\nLoop \n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 634, "user_id": 7225652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D85eE.jpg?s=128&g=1", "display_name": "Peter Pesch", "link": "https://stackoverflow.com/users/7225652/peter-pesch"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1512550111, "post_id": 47669283, "comment_id": 82299038, "body": "@jsheeran: In this cae, that would be: [&#39;Data Sheet with Space&#39;!B6]. But I agree, that is probably the most readable way."}], "tags": [], "owner": {"reputation": 634, "user_id": 7225652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D85eE.jpg?s=128&g=1", "display_name": "Peter Pesch", "link": "https://stackoverflow.com/users/7225652/peter-pesch"}, "is_accepted": true, "score": 2, "last_activity_date": 1512549237, "last_edit_date": 1512549237, "creation_date": 1512546429, "answer_id": 47669283, "question_id": 47668636, "link": "https://stackoverflow.com/questions/47668636/do-loop-and-if-statement-in-excel/47669283#47669283", "title": "Do Loop and If Statement in Excel", "body": "<p>The problem lies in the way in which you address the cells.</p>\n\n<p>If you want to refer to cell \"B6\" on the first sheet, there are basically 3 ways to refer to the sheet:</p>\n\n<ol>\n<li><p>By CodeName (If you happen to know the codename of the sheet)</p>\n\n<pre><code>Sheet1.[B6]\n</code></pre></li>\n<li><p>By Name (That is the name you see on the tab of the sheet)</p>\n\n<pre><code>Sheets(\"Data Sheet with Space\").[B6]\n</code></pre></li>\n<li><p>By Number (If you happen to know the order of the sheets)</p>\n\n<pre><code>Sheets(1).[B6]\n</code></pre></li>\n</ol>\n\n<p>It is your code, you are going to maintain it, so use whichever looks best to you.\nYou might prefer to use a variable: <code>wsData = Sheets(\"Data Sheet with Space\")</code>, so you could simply write <code>wsOther.[A1]=wsData.[B6]</code>.</p>\n\n<hr>\n\n<p>There are also several ways to refer to the cells on the sheet. Some usefull ones:</p>\n\n<ol>\n<li><p>Directly using the Address:</p>\n\n<pre><code>Sheets(\"Data Sheet with Space\").[B6]\n</code></pre></li>\n<li><p>By using <code>.Range</code> (using the Address)</p>\n\n<pre><code>Sheets(\"Data Sheet with Space\").Range(\"B6\")\n</code></pre></li>\n<li><p>By using <code>.Cell</code> (using the Coordinates)</p>\n\n<pre><code>Sheets(\"Data Sheet with Space\").Cells(6, 2)\n</code></pre></li>\n<li><p>A more reeadable way of using <code>.Cell</code> (as sugessted by YowE3K)</p>\n\n<pre><code>Sheets(\"Data Sheet with Space\").Cells(6, \"B\")\n</code></pre></li>\n</ol>\n\n<p>In your code, you are already using coordinates. So you might prefer to use <code>.Cells(rws, counter)</code>. But it's up to you.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2881181"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 47669283, "answer_count": 2, "score": 0, "last_activity_date": 1512561226, "creation_date": 1512543746, "last_edit_date": 1512561226, "question_id": 47668636, "link": "https://stackoverflow.com/questions/47668636/do-loop-and-if-statement-in-excel", "title": "Do Loop and If Statement in Excel", "body": "<p>In the WorkSheet, I'm trying to create the following logic in Excel Macro.</p>\n\n<p>Logic:</p>\n\n<pre><code>Dub Test()\n\nDim rws as integer\nDim counter as integer\n\nrws = 6   \ncounter = 2\n\nDo while rws &lt;&gt; 0\n    IF 'Data Sheet with Space'!J`counter` = \"Sample Data Row 1 Col 10\" Then\n        WorkSheet!A`counter` = 'Data Sheet with Space'!A`counter`\n    end IF\n\n    counter = counter + 1\n    rws = rws - 1\n</code></pre>\n\n<p>The Excel sheets are:</p>\n\n<p><code>Data Sheet with Space</code></p>\n\n<pre><code>---------------------------------------------\nHeader 1                 Header 2                 Header 3                 Header 4                 Header 5                 Header 6                 Header 7                 Header 8                 Header 9                 Header 10                \nSample Data Row 1 Col 1  Sample Data Row 1 Col 2  Sample Data Row 1 Col 3  Sample Data Row 1 Col 4  Sample Data Row 1 Col 5  Sample Data Row 1 Col 6  Sample Data Row 1 Col 7  Sample Data Row 1 Col 8  Sample Data Row 1 Col 9  Sample Data Row 1 Col 10 \nSample Data Row 2 Col 1  Sample Data Row 2 Col 2  Sample Data Row 2 Col 3  Sample Data Row 2 Col 4  Sample Data Row 2 Col 5  Sample Data Row 2 Col 6  Sample Data Row 2 Col 7  Sample Data Row 2 Col 8  Sample Data Row 2 Col 9  Sample Data Row 2 Col 10 \nSample Data Row 3 Col 1  Sample Data Row 3 Col 2  Sample Data Row 3 Col 3  Sample Data Row 3 Col 4  Sample Data Row 3 Col 5  Sample Data Row 3 Col 6  Sample Data Row 3 Col 7  Sample Data Row 3 Col 8  Sample Data Row 3 Col 9  Sample Data Row 3 Col 10 \nSample Data Row 4 Col 1  Sample Data Row 4 Col 2  Sample Data Row 4 Col 3  Sample Data Row 4 Col 4  Sample Data Row 4 Col 5  Sample Data Row 4 Col 6  Sample Data Row 4 Col 7  Sample Data Row 4 Col 8  Sample Data Row 4 Col 9  Sample Data Row 4 Col 10 \nSample Data Row 5 Col 1  Sample Data Row 5 Col 2  Sample Data Row 5 Col 3  Sample Data Row 5 Col 4  Sample Data Row 5 Col 5  Sample Data Row 5 Col 6  Sample Data Row 5 Col 7  Sample Data Row 5 Col 8  Sample Data Row 5 Col 9  Sample Data Row 5 Col 10 \n---------------------------------------------\n</code></pre>\n\n<p>and the other Excel sheet called <code>WorkSheet</code></p>\n\n<p>When trying to run the macro I get an error the <code>'</code> in the <code>Data Sheet with Space</code> name causes an error.</p>\n\n<p>Secondly, I an having an error when trying to change the input and output cell number dynamically using the <code>counter</code> variable. </p>\n\n<p>Any help is appreciate it. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1512542559, "post_id": 47668331, "comment_id": 82295276, "body": "You only have one <code>For</code> statement, but four <code>Next</code> statements.  Remove three of the <code>Next</code> statements."}, {"owner": {"reputation": 1, "user_id": 9060078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d4cb9464e3bbd529c1f06dab090fc?s=128&d=identicon&r=PG&f=1", "display_name": "B. Harm", "link": "https://stackoverflow.com/users/9060078/b-harm"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512542605, "post_id": 47668331, "comment_id": 82295297, "body": "Okay, how do I do this?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512542647, "post_id": 47668331, "comment_id": 82295321, "body": "@YowE3K wow you&#39;re fast this morning"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512542671, "post_id": 47668331, "comment_id": 82295335, "body": "Actually, you don&#39;t even seem to be using the loop.  So just remove one <code>For</code> statement and four <code>Next</code> statements."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512542757, "post_id": 47668331, "comment_id": 82295386, "body": "What is <code>CheckCell</code>, and where do you set it?"}, {"owner": {"reputation": 1, "user_id": 9060078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d4cb9464e3bbd529c1f06dab090fc?s=128&d=identicon&r=PG&f=1", "display_name": "B. Harm", "link": "https://stackoverflow.com/users/9060078/b-harm"}, "edited": false, "score": 0, "creation_date": 1512543049, "post_id": 47668331, "comment_id": 82295541, "body": "When I get rid of the next statements and for statement. The code doesn&#39;t recognize the =REF! error in my workbook and still records the I3 and I4 into my data sheet"}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 1, "creation_date": 1512561863, "post_id": 47668331, "comment_id": 82306513, "body": "Please read <a href=\"//meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512543335, "post_id": 47668500, "comment_id": 82295699, "body": "@YowE3K tru that, just tested it again with a different scenario"}, {"owner": {"reputation": 1, "user_id": 9060078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d4cb9464e3bbd529c1f06dab090fc?s=128&d=identicon&r=PG&f=1", "display_name": "B. Harm", "link": "https://stackoverflow.com/users/9060078/b-harm"}, "edited": false, "score": 0, "creation_date": 1512543342, "post_id": 47668500, "comment_id": 82295701, "body": "it says there is anerror on thisIf IsError(CheckCell) And CVErr(CheckCell) = CVErr(2023) Then"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512543557, "post_id": 47668500, "comment_id": 82295804, "body": "@YowE3K I love a lot of lines, I charge by quantity(amout of lines) not quality"}, {"owner": {"reputation": 1, "user_id": 9060078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d4cb9464e3bbd529c1f06dab090fc?s=128&d=identicon&r=PG&f=1", "display_name": "B. Harm", "link": "https://stackoverflow.com/users/9060078/b-harm"}, "edited": false, "score": 0, "creation_date": 1512543652, "post_id": 47668500, "comment_id": 82295852, "body": "What if I want all my sheets to refresh so then sometimes there isn&#39;t a =REF! and then my code works? Because right now I have all my code on a refresh button and I want my data to refresh each time no matter what when I press the refresh button but if the data has a =REF! then to not input my i3 and i4 into my data sheet"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1, "user_id": 9060078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d4cb9464e3bbd529c1f06dab090fc?s=128&d=identicon&r=PG&f=1", "display_name": "B. Harm", "link": "https://stackoverflow.com/users/9060078/b-harm"}, "edited": false, "score": 0, "creation_date": 1512543723, "post_id": 47668500, "comment_id": 82295889, "body": "@B.Harm this sound like a great New Post for <b>SO</b>. As for now, I think my answer has answered your current post."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1512543855, "post_id": 47668500, "comment_id": 82295952, "body": "@YowE3K i prefer to use <code>If CheckCell.Value = CVErr(xlErrRef)</code>"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1512543668, "last_edit_date": 1512543668, "creation_date": 1512543128, "answer_id": 47668500, "question_id": 47668331, "link": "https://stackoverflow.com/questions/47668331/fix-compile-error-next-without-for-error-in-vba/47668500#47668500", "title": "Fix \u201ccompile error: next without for\u201d error in VBA?", "body": "<p>I think you are looking for something like the <code>For</code> loop below to implement in your code:</p>\n\n<pre><code>Sub logs()\n\nDim Sht As Worksheet\nDim checkRange As Range, CheckCell As Range\n\nFor Each Sht In ThisWorkbook.Sheets ' loop through your worksheets\n    With Sht\n        Select Case .Name  ' check for the sheet.Name\n            Case \"Final Four\", \"Top Left\", \"Bottom Left\", \"Top Right\", \"Bottom Right\"\n                Set checkRange = .Range(\"A1:Z100\") ' set the range for the current sheet\n\n                For Each CheckCell In checkRange\n                    If IsError(CheckCell) Then\n                        If CheckCell.Value = CVErr(2023) Then Exit Sub\n\n                        ' you can use the following syntax as well\n                        If CheckCell.Value = CVErr(xlErrRef) Then Exit Sub\n                    End If\n                Next CheckCell\n                Set checkRange = Nothing\n            Case Else\n                ' do nothing\n\n        End Select\n    End With\nNext Sht\n\n' rest of your code\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9060078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d4cb9464e3bbd529c1f06dab090fc?s=128&d=identicon&r=PG&f=1", "display_name": "B. Harm", "link": "https://stackoverflow.com/users/9060078/b-harm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1512561851, "creation_date": 1512542445, "last_edit_date": 1512561851, "question_id": 47668331, "link": "https://stackoverflow.com/questions/47668331/fix-compile-error-next-without-for-error-in-vba", "title": "Fix \u201ccompile error: next without for\u201d error in VBA?", "body": "<p>I cant seem to figure out this. I would like to search my worksheets to see if there is a \"=REF!\" and if there is a error to not run my code. The problem with it is that when I run it the error in the code is revolved around the next part </p>\n\n<pre><code>Sub logs()\n\nDim numberofsheets As Integer\n\nFor numberofsheets = 1 To 5\n\nSet checkRange = Sheets(\"Final Four\").Range(\"A1:Z100\")\n If IsError(CheckCell) And _\n       CVErr(CheckCell) = CVErr(2023) Then\nExit Sub\nEnd If\n\nNext\n\nSet checkRange = Sheets(\"Top Left\").Range(\"A1:Z100\")\n If IsError(CheckCell) And _\n       CVErr(CheckCell) = CVErr(2023) Then\nExit Sub\nEnd If\n\nNext\n\nSet checkRange = Sheets(\"Bottom Left\").Range(\"A1:Z100\")\n If IsError(CheckCell) And _\n        CVErr(CheckCell) = CVErr(2023) Then\nExit Sub\nEnd If\n\nNext\n\nSet checkRange = Sheets(\"Top Right\").Range(\"A1:Z100\")\n If IsError(CheckCell) And _\n       CVErr(CheckCell) = CVErr(2023) Then\nExit Sub\nEnd If\n\nNext\n\nSet checkRange = Sheets(\"Bottom Right\").Range(\"A1:Z100\")\n If IsError(CheckCell) And _\n       CVErr(CheckCell) = CVErr(2023) Then\nExit Sub\nEnd If\n\nActiveSheet.EnableCalculation = True\n\nlst = Sheets(\"data\").UsedRange.Rows.Count\nx = lst + 1\n\n        ' Display a message when one of the designated cells has been\n        ' changed.\n        ' Place your code here.\n        Sheets(\"data\").Range(\"A\" &amp; x) = ActiveSheet.Range(\"I3\")\n        Sheets(\"data\").Range(\"B\" &amp; x) = ActiveSheet.Range(\"I4\")\n\n\nEnd Sub\n</code></pre>\n\n<p>Not sure how to do this. I'm very new at it. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1512541675, "post_id": 47668099, "comment_id": 82294900, "body": "&quot;I want a macro&quot;  - and a pony?  Typically here you&#39;re expected to show some effort toward solving your own problem first."}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1512541779, "post_id": 47668099, "comment_id": 82294941, "body": "I have tried but that code is not relatable enough my code gives save as pop up and if you read my question carefully then I am also asking the approach"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1512541785, "post_id": 47668099, "comment_id": 82294942, "body": "@TimWilliams pricelss :)"}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1512541965, "post_id": 47668099, "comment_id": 82295001, "body": "If you can&#39;t give suggestion then its ok but stop criticizing and also trying to understand the perspective of someone else  @Tim Williams"}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1512541988, "post_id": 47668099, "comment_id": 82295011, "body": "If you can&#39;t give suggestion then its ok but stop criticizing and also trying to understand the perspective of someone else @Shai Rado"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1512542065, "post_id": 47668099, "comment_id": 82295045, "body": "@yashikavaish i wasn&#39;t critizing, Tim just made a funny comment with &quot; - and a pony&quot;. To be straight to the point, it&#39;s impossible to help you without seeing your code, where are you struggeling, etc..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1512542280, "post_id": 47668099, "comment_id": 82295144, "body": "What <i>specific</i> part of your requirement is giving you problems?  We need a little bit more here than just a specification for some functionality...  How to get the users login on windows?  Answer right here on SO: <a href=\"https://stackoverflow.com/questions/13412418/how-can-i-display-my-windows-user-name-in-excel-spread-sheet-using-macros\" title=\"how can i display my windows user name in excel spread sheet using macros\">stackoverflow.com/questions/13412418/&hellip;</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512542389, "post_id": 47668099, "comment_id": 82295189, "body": "You might also like to look at another question asked just 4 hours ago - <a href=\"https://stackoverflow.com/q/47665588/6535336\">stackoverflow.com/q/47665588/6535336</a> (currently 9th newest [excel-vba] question - so on the first page when sorted)"}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1512543649, "post_id": 47668099, "comment_id": 82295848, "body": "Kindly look the edits"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1512543793, "post_id": 47668099, "comment_id": 82295920, "body": "If you copy a worksheet to no destination, you end up with a new workbook with one worksheet (a copy of the original). Also lookup <code>environ</code> function to get user info."}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1512544287, "post_id": 47668099, "comment_id": 82296176, "body": "Yes , I want file is being saved in any user&#39;s system in any location."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1512544843, "post_id": 47668765, "comment_id": 82296462, "body": "Thanks, It works"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1512544260, "creation_date": 1512544260, "answer_id": 47668765, "question_id": 47668099, "link": "https://stackoverflow.com/questions/47668099/vba-save-newly-workbook-with-name-in-any-users-system-location/47668765#47668765", "title": "Vba save newly workbook with name in any user&#39;s system location", "body": "<p>If you copy a worksheet to no destination, you end up with a new workbook with one worksheet (a copy of the original). Also lookup <code>environ</code> function to get user info.</p>\n\n<pre><code>activesheet.copy\nactiveworkbook.saveas filename:=environ(\"TEMP\") &amp; \"\\test\", fileformat:=xlOpenXMLWorkbook\nactiveworkbook.close savechanges:=false\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "closed_date": 1512590650, "accepted_answer_id": 47668765, "answer_count": 1, "score": -1, "last_activity_date": 1512544260, "creation_date": 1512541592, "last_edit_date": 1512543624, "question_id": 47668099, "link": "https://stackoverflow.com/questions/47668099/vba-save-newly-workbook-with-name-in-any-users-system-location", "closed_reason": "Needs more focus", "title": "Vba save newly workbook with name in any user&#39;s system location", "body": "<p>I want a new workbook creation that automatically saves at user's system but the path is not fixed so is there any way to do the same. I don't want that  User manually gives name ins ave as dialogue box. I want a macro that handles at runtime and saves the workbook in user's specific location.(Users are different)\nKindly suggest the code and approach for the same.\nI have tried some variants:</p>\n\n<pre><code>Sub sb_Copy_Save_ActiveSheet_As_Workbook()\nSet wb = Workbooks.Add\nThisWorkbook.Activate\nActiveSheet.Copy Before:=wb.Sheets(1)\nwb.Activate\nwb.SaveAs \"C:\\temp\\test3.xlsx\"\nEnd Sub \n</code></pre>\n\n<p>This gives me an error and I want the path that allows any user to save the file in their location without user's input(Save As Dialogue). Macro is able to save the file in any user's system.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512539874, "post_id": 47667521, "comment_id": 82294306, "body": "1. Format your code with <code>code</code> markdown.  2. Which line errors out?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1512540842, "post_id": 47667521, "comment_id": 82294595, "body": "@Shai Rado I did the same formatting, but SO didn&#39;t want to save changes saying &quot;the changes mostly affect the code&quot;. How did you do that?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512540880, "post_id": 47667521, "comment_id": 82294608, "body": "@JohnyL just edited it"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1512542738, "post_id": 47667521, "comment_id": 82295371, "body": "@ShaiRado Doesn&#39;t work for me for some reason :("}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1512542779, "post_id": 47667521, "comment_id": 82295403, "body": "@PriyadharsiniStalin So, which line errors out?"}, {"owner": {"reputation": 11, "user_id": 2614082, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002519383626/picture?type=large", "display_name": "Priyadharsini Stalin", "link": "https://stackoverflow.com/users/2614082/priyadharsini-stalin"}, "edited": false, "score": 0, "creation_date": 1512544132, "post_id": 47667521, "comment_id": 82296091, "body": "Hi Johny, I am getting error in Do while IF busy step. I think I am answering in correct window. Please correct me If I am wrong"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1512546405, "post_id": 47667521, "comment_id": 82297216, "body": "If you\u2019re trying to navigate an intranet, try to replace \u2018Set IE = CreateObject(&quot;InternetExplorer.Application&quot;)\u2019 with \u2018Set IE = CreateObject(&quot;InternetExplorerMedium.Application&quot;)\u2019 and dun the same code."}, {"owner": {"reputation": 11, "user_id": 2614082, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002519383626/picture?type=large", "display_name": "Priyadharsini Stalin", "link": "https://stackoverflow.com/users/2614082/priyadharsini-stalin"}, "edited": false, "score": 0, "creation_date": 1512555779, "post_id": 47667521, "comment_id": 82302702, "body": "I am getting &quot;ActiveX component can&#39;t create object&quot; error :("}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1512556354, "post_id": 47667521, "comment_id": 82303060, "body": "I normally use <a href=\"https://stackoverflow.com/questions/33808000/run-time-error-91-object-variable-or-with-block-variable-not-set\">This Function to wait</a> and refer to <a href=\"https://stackoverflow.com/a/47333783/7690982\">this example on how to use it</a>"}, {"owner": {"reputation": 11, "user_id": 2614082, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002519383626/picture?type=large", "display_name": "Priyadharsini Stalin", "link": "https://stackoverflow.com/users/2614082/priyadharsini-stalin"}, "edited": false, "score": 0, "creation_date": 1512567059, "post_id": 47667521, "comment_id": 82309774, "body": "Now I am getting interface error in step : For Each a In IE.Document.GetElementsByTagName(&quot;A&quot;)"}, {"owner": {"reputation": 11, "user_id": 2614082, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002519383626/picture?type=large", "display_name": "Priyadharsini Stalin", "link": "https://stackoverflow.com/users/2614082/priyadharsini-stalin"}, "edited": false, "score": 0, "creation_date": 1512567090, "post_id": 47667521, "comment_id": 82309797, "body": "i use code to click link: LinkHref = &quot;http:link&quot; For Each a In IE.Document.GetElementsByTagName(&quot;A&quot;)   If LCase(a.GetAttribute(&quot;href&quot;)) = LCase(LinkHref) Then     a.Click     Exit For  &#39;&#39;# to stop after the first hit   End If pls help"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1512568576, "post_id": 47667521, "comment_id": 82310830, "body": "@PriyadharsiniStalin Can you provide the link?"}, {"owner": {"reputation": 11, "user_id": 2614082, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002519383626/picture?type=large", "display_name": "Priyadharsini Stalin", "link": "https://stackoverflow.com/users/2614082/priyadharsini-stalin"}, "edited": false, "score": 0, "creation_date": 1512624467, "post_id": 47667521, "comment_id": 82335565, "body": "&lt;A href=&quot;<a href=\"http://syasds/hxx/test.html\" rel=\"nofollow noreferrer\">syasds/hxx/test.html</a>&quot; target=_blank&gt;DDD (XH) Test/QA/UAT Sys&lt;/A&gt; I have modified the https and inner text."}], "owner": {"reputation": 11, "user_id": 2614082, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002519383626/picture?type=large", "display_name": "Priyadharsini Stalin", "link": "https://stackoverflow.com/users/2614082/priyadharsini-stalin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512549950, "creation_date": 1512538737, "last_edit_date": 1531164843, "question_id": 47667521, "link": "https://stackoverflow.com/questions/47667521/interface-is-unknown-error-on-executing-the-below-vb-script", "title": "Interface is unknown error on executing the below vb script", "body": "<p>i need to open IE and url. After that I need to click a link text with  tag.</p>\n\n<pre><code>Private Sub CommandButton_Click() \n\nDim IE As Object\nDim NewURL As String\nDim sURL As String\nDim strCountBody As String\nDim lStartPos As Long\nDim lEndPos As Long\nDim TextIWant As String\nApplication.ScreenUpdating = False\nSet IE = CreateObject(\"Internetexplorer.Application\")\n\nsURL = \"My Link\" 'hidden for security reasons.\nWith IE\n    .navigate sURL\n    ' uncomment the line below if you want to watch the code execute, or for debugging\n    .Visible = True\nEnd With\n' loop until the page finishes loading\nDo While IE.Busy\nLoop    \n\n' click a text link on the page after that\nSet ElementCol = IE.document.getElementsByTagName(\"a\")\nFor Each link In ElementCol\n    If link.innerHTML = \"Link Text\" Then\n        NewURL = link.GetAttribute(\"href\")\n        Exit For\n    End If\nNext link\nWith IE\n    .navigate NewURL\n    ' uncomment the line below if you want to watch the code execute, or for debugging\n    .Visible = True\nEnd With\n' loop until the page finishes loading\nDo While IE.Busy\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512535483, "post_id": 47666879, "comment_id": 82292893, "body": "Might be email security stopping excel links working. Can you right click on the excel link and copy out the URL? Does right click do anything?"}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512535673, "post_id": 47666879, "comment_id": 82292944, "body": "When I right click, it opens up a context-menu with options <code>Select HyperLink</code>, <code>Open HyperLink</code> and <code>Copy HyperLink</code>. When I click on <code>Open Hyperlink</code>, it still doesn&#39;t open up any thing. On copying the hyperlink, the full hyperlink saved in that excel cell, gets copied to clipboard as <code>%5bC:&#47;Users&#47;Gurman&#47;Work&#47;Misc&#47;Excel Hyperlink in Outlook&#47;EXLFile.xlsx%5dSheet1!A1</code>. But in my dashboard excel, the formula is seen as <code>=HYPERLINK(&quot;[C:\\Users\\Gurman\\Work\\Misc\\Excel Hyperlink in Outlook\\EXLFile.xlsx]Sheet1!A1&quot;,&quot;EXLLINK&quot;)</code>"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512536892, "post_id": 47666879, "comment_id": 82293332, "body": "So does your functioning MHT link look the same? What I don&#39;t understand is: I don&#39;t see any code in your VBScript that puts the words <code>Link_To_Excel</code> into a message body. Where does that come from?"}, {"owner": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1512539768, "post_id": 47666879, "comment_id": 82294270, "body": "Please post the source for your email. (what you see what you see when you click the &quot;view source&quot; menu item.)"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1512540421, "post_id": 47666879, "comment_id": 82294456, "body": "Is it <code>Sheet1!A1</code> or <code>B1</code>? in <code>&quot;=HYPERLINK(&quot;&quot;[&quot;&amp;strExcelLink&amp;&quot;]Sheet1!A1&quot;&quot;,&quot;&quot;EXLLINK&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512542047, "post_id": 47666879, "comment_id": 82295036, "body": "@Nick.McDermaid As mentioned in the Background Info, the dashboard excel is actually a template which already contains the column headers. My script just updated the column values. So the texts <code>Link_to_MHT</code> and <code>Link_to_Excel</code> are already written in those templates at cells(1,1) and cells(1,2) respectively."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512542242, "post_id": 47666879, "comment_id": 82295121, "body": "I suggest that you just do a standard HTML body in your script as you have more control."}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1512542307, "post_id": 47666879, "comment_id": 82295154, "body": "@garbb I have added the Email body&#39;s source in the question"}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512542538, "post_id": 47666879, "comment_id": 82295261, "body": "@Nick.McDermaid Actually this is just a very small part of my dashboard. My actual dashboard has a lot more info including graphs and images which I need to keep in excel file only. I just wanted to have all the excel dashboard contents getting displayed in the email body directly. Hence, I followed this approach."}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1512542763, "post_id": 47666879, "comment_id": 82295391, "body": "@0m3r Either <code>A1</code> or <code>B1</code> doesn&#39;t make any difference. If I mention <code>A1</code>, the cell <code>A1</code> gets selected. For now, it is <code>A1</code>."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512542798, "post_id": 47666879, "comment_id": 82295413, "body": "Ok. So does the functioning mht link look the same or different?"}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512543608, "post_id": 47666879, "comment_id": 82295835, "body": "@Nick.McDermaid Please see the update 2. I have mentioned all the link values and formulas"}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512547627, "post_id": 47666879, "comment_id": 82297778, "body": "@Nick.McDermaid I have tried to remove all the confusion in Update 3. Could you please check it and tell me if it makes some sense? I really want to get this issue solved :("}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512552475, "post_id": 47666879, "comment_id": 82300440, "body": "Yes that&#39;s much clearer. The hex values are URL encoding. I&#39;m not sure why it is double URL encoding your Excel link but not your MHT link.  According to this: <a href=\"https://en.wikipedia.org/wiki/File_URI_scheme\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/File_URI_scheme</a> , a file URI can only point at a file. Not a piece in the file (like a worksheet). I&#39;d be curious to see what the URI directly in the excel sheet looks like"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512553097, "post_id": 47666879, "comment_id": 82300860, "body": "For example %5b = [, %5d = ]. I just think it doesn&#39;t know how to convert your link to a HTML link, because there is no way to do that kind of link in a webpage for example"}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1512564825, "post_id": 47666879, "comment_id": 82308296, "body": "@Nick.McDermaid I guess you are correct. Will update this post if I get a solution. Thanks for your help."}, {"owner": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 1, "creation_date": 1512585731, "post_id": 47666879, "comment_id": 82321701, "body": "I would be very surprised if outlook would allow a link to a file to function in an email. Isn&#39;t that potentially a security issue?"}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1512615092, "post_id": 47666879, "comment_id": 82333214, "body": "@garbb I think, If we can have a link to an excel workbook in outlook, then I don&#39;t see any reason why we can&#39;t have a link to a Sheet of that workbook. May be someone can correct me, if I am wrong."}, {"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 1, "creation_date": 1513353408, "post_id": 47666879, "comment_id": 82635099, "body": "@Gurman, yes, you&#39;re wrong. <code>HYPERLINK</code> function applies only to Excel, hence things like <code>=HYPERLINK(&quot;[http:&#47;&#47;example.microsoft.com&#47;report&#47;budget report.xlsx]Annual!F10&quot;, D1)</code> can exist (and work) only in Excel. In Outlook your so-called &quot;hyperlinks&quot; are converted to the real URL links (<a href=\"https://tools.ietf.org/html/rfc8089\" rel=\"nofollow noreferrer\">`file:\\` URI</a>), which were created for a different purpose without a such option. Microsoft even came up with <a href=\"https://msdn.microsoft.com/en-us/library/office/dn906146.aspx\" rel=\"nofollow noreferrer\">their own URI schemes</a> for Office, which also do not cover (AFAIK) your tasks."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513412940, "post_id": 47666879, "comment_id": 82651773, "body": "are you sending this to people? If so, will they have access to the location where the document is stored? Or will the excel file also be sent with the e-mail? Would the file need to be saved to a specific location e.g. user&#39;s desktop first?"}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 0, "creation_date": 1513413109, "post_id": 47666879, "comment_id": 82651803, "body": "@CommonSense Thanks for your inputs. Even I have come to believe that it is not possible to have links to a specific sheet of an excel in Outlook email."}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513413282, "post_id": 47666879, "comment_id": 82651833, "body": "@QHarr Yes. The file is actually placed on network. The person who will receive the email has the access to that location. Just for making this issue less complex here, I provided the &quot;local&quot; paths."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513413476, "post_id": 47666879, "comment_id": 82651871, "body": "then @ashleedawg&#39;s answer looks promising"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513413760, "post_id": 47666879, "comment_id": 82651936, "body": "@QHarr -- I&#39;m just not sure how one would include spaces in a link like that."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513414490, "post_id": 47666879, "comment_id": 82652111, "body": "I was going to say replace spaces with %20"}], "answers": [{"comments": [{"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1513414120, "post_id": 47843827, "comment_id": 82652018, "body": "Thanks for your inputs. I will see how I can change my script to include your solution in that. Actually, the problem is that my script is not writing anything directly in outlook email. It writes everything in a excel file(dashboard) which is then transformed to an outlook email(using mail envelope). So the formula written in the excel <code>=HYPERLINK(&quot;[C:\\Users\\Gurman\\Work\\Misc\\Excel Hyperlink in Outlook\\EXLFile.xlsx]Sheet1!A1&quot;,&quot;EXLLINK&quot;)</code> gets automatically converted to <code>&lt;a href=&quot;%5bC:&#47;Users&#47;Gurman&#47;Work&#47;Misc&#47;Excel%20Hyperlink%20in%20&zwnj;&#8203;Outlook&#47;EXLFile.xlsx&zwnj;&#8203;%5dSheet1!A1&quot;&gt;EXLLIN&zwnj;&#8203;K&lt;&#47;a&gt;</code>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 2, "creation_date": 1513414605, "post_id": 47843827, "comment_id": 82652147, "body": "Perhaps, don&#39;t use the <code>HYPERLINK</code> function at all."}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1513706499, "post_id": 47843827, "comment_id": 82751949, "body": "The hyperlink format which you specified was correct. But I was just not sure how to make changes to my excel formula to get the hyperlink mentioned in your answer. When I implemented the answer provided by SBF in my script, the resulting hyperlink which I got in the final email was the same as mentioned by you. I, thank you, for your answer but I believe that I should accept SBF&#39;s answer. I just wish If it was possible to split the bounty. Thanks for your help, again."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1513769286, "post_id": 47843827, "comment_id": 82776599, "body": "Of course, <i>after</i> I wrote my edit, I realized you found a solution, haha!  But, I believe my edit (although not much of an answer) is relevant nonetheless.  Good Luck :-)"}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1513780831, "post_id": 47843827, "comment_id": 82784179, "body": "I agree with most of the points made by you especially sharing the location once with the end users and adding/removing permissions. But, the things are the way they are because the end-users/client want it this way. Also, about the point you made on redundant things(excel reports, in this case). So, these are our daily regression/sanity testing reports which get generated daily. We can&#39;t just overwrite them everyday as we need to keep them for investigation purposes(in future, if required). Thanks again for your help :)"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 6, "last_activity_date": 1513769149, "last_edit_date": 1513769149, "creation_date": 1513412150, "answer_id": 47843827, "question_id": 47666879, "link": "https://stackoverflow.com/questions/47666879/vbscript-not-able-to-open-hyperlinks-to-an-excel-sheetnot-whole-workbook-from/47843827#47843827", "title": "VBScript_Not able to open Hyperlinks to an excel SHEET(not whole workbook) from outlook&#39;s email body directly", "body": "<h2>Hyperlink to a specific Excel worksheet:</h2>\n\n<p><a href=\"http://file///c:%5CyourPath%5CyourFileName.xlsm#yourSheetName!A1\" rel=\"nofollow noreferrer\">File:///c:\\yourPath\\yourFileName.xlsm#yourSheetName!A1</a></p>\n\n<p>This can be used in an Outlook email.  Clicking the link will open <code>c:\\yourPath\\yourFileName.xlsm</code> on worksheet <code>yourSheetName</code> and select cell <code>A1</code>.</p>\n\n<p><sub>(<a href=\"https://www.ablebits.com/office-addins-blog/2014/05/15/excel-insert-hyperlink/\" rel=\"nofollow noreferrer\">Source</a>)</sub></p>\n\n<hr>\n\n<h2>Hyperlink to a UNC (Network) path:</h2>\n\n<p>(I'm not able to test these but one or both of these methods should work.)</p>\n\n<blockquote>\n  <p>file://///server/path/to/file.txt</p>\n</blockquote>\n\n<p><sup>(that's <strong>five</strong> slashes!)</sup></p>\n\n<p>or</p>\n\n<blockquote>\n  <p>file://server/path/to/file.txt</p>\n</blockquote>\n\n<p><sub>(<a href=\"https://blogs.msdn.microsoft.com/ie/2006/12/06/file-uris-in-windows/\" rel=\"nofollow noreferrer\">Source</a>)</sub></p>\n\n<hr>\n\n<h2>Hyperlink in HTML Mail:</h2>\n\n<p>Another possibility, if the email is in HTML format, would be something like this (which could include fancier formatting like a <strong>ToolTip</strong>, etc):</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>  &lt;style&gt; a.tooltips {position: relative; display: inline;} a.tooltips span { position: absolute;  width:240px;  color: #FFFFFF;  background: #000000;  height: 30px;  line-height: 30px;  text-align: center;  visibility: hidden;  border-radius: 6px; } a.tooltips span:after {  content: '';  position: absolute;  top: 100%;  left: 50%;  margin-left: -8px;  width: 0; height: 0;  border-top: 8px solid #000000;  border-right: 8px solid transparent;  border-left: 8px solid transparent; } a:hover.tooltips span {  visibility: visible;  opacity: 0.8;  bottom: 30px;  left: 50%;  margin-left: -76px;  z-index: 999; } &lt;/style&gt;\r\n&lt;br&gt;&lt;br&gt;\r\n  &lt;a class=\"tooltips\" href=\"#\"&gt;\\\\server\\share\\docs&lt;span&gt;This is a ToolTip!&lt;/span&gt;&lt;/a&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><sub>(<a href=\"https://stackoverflow.com/questions/1369147/linking-a-unc-network-drive-on-an-html-page\">Source</a>)</sub></p>\n\n<hr>\n\n<h2>Edit:</h2>\n\n<p><em>Okay</em>, you did a good job of gathering information so far, <em>so</em> I had hoped that with a couple days you'd do some more research and figure it out... :)</p>\n\n<p>Honestly, I'm not sure of the exact correct method to do the steps that you need to do, but I know the steps that <em>I</em> would take <strong>to find out</strong> -- and based on my experience, it's tough to predict how much time the process will take, regardless of simple or complex the problem seems to be.</p>\n\n<p>Thus, based on Stack Overflow's \"<em>help you with specific issues; not do the work for you</em>\" principal, I'll share the steps I would take next, give us updates on what you learn, ask specific questions on what you encounter, and definitely post the working solution once it's all figure out, to help others who encounter the same specific problem.  :-) </p>\n\n<blockquote>\n  <p>A beautiful thing with coding (especially with Office) is that there's\n  almost always multiple (completely different) ways of accomplishing\n  the same end result.  Some of the ways will be better suited to\n  specific tasks than others, others could be completely\n  interchangeable.  </p>\n  \n  <p>The decision of which method to use can be affected by many things\n  (some obvious, some unforeseen) such as scale of the project, security\n  requirements, knowledge level of both the developer &amp; the end-user,\n  deadlines, how often it will be used and/or will need fundamental\n  changes, and so on.  Therefore the best person to decide is you, the\n  developer.</p>\n</blockquote>\n\n<p>Any tips or code provided by others (including me) on a site like this are going to be based on assumptions that we might not even realize we are making, since nobody knows the \"whole situation\" better than you.  (<em>Askers</em> &amp; <em>Answerers</em> often won't realize the disconnect caused by the <strong><a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem/66378#66378\">XY Problem</a></strong>.)</p>\n\n<p><strong><em>My point:</em></strong>  <strong>A common step in developing a section of code to perform a task is to trash what you have and start over.</strong>  <em>(Surely I'm not the only one that does that, right?!)</em></p>\n\n<hr>\n\n<h2>Emailing a static Daily Report to multiple recipients as an attachment is <em>'sooo 1997'!</em></h2>\n\n<p>...and there are many reasons that it's a bad practice.  For starters, it's a waste of bandwidth <em>and</em> storage space (a little like making separate VHS copies of <em>Home Alone 3</em> for each TV in your house) but you can probably think of other reasons too (a big one being that <strong><em>it's not working</em></strong>.)</p>\n\n<p>If I understand properly, you're opening a file, putting two links into cells in that file, closing it, putting the same links in the body of the email, and sending it to a bunch of people?</p>\n\n<p>A major purpose of coding is to remove repetitive/redundant tasks or \"things\" <em>completely</em>, not just to automate <em>your handling</em> of them.</p>\n\n<p><sub><strong><em>Oh man</em></strong>, tell me nobody's saving each one in a folder with the date as the filename, for historical records.  And omg, I hope each user isn't doing that separately.  And some people printing each day's report too?  Surely not...  <em>(I'm having a flashback to a former government job!)</em></sub></p>\n\n<p>Based on what I <em>think</em> your end goal is, you should <strong>forget about emailing altogether</strong>, post the file(s) to a shared location and share a link.  This could be an shared location on the internal network, or if everyone's doesn't have access to the network, then a public file sharing location (OneDrive is one of many free options). </p>\n\n<h2>This way:</h2>\n\n<ul>\n<li><p>You only have to share a <strong><em>link</em></strong> (only once!) with whomever needs access.</p></li>\n<li><p>You know for sure that everyone is looking at the same version.</p></li>\n<li><p>You could update as often or little as needed, even erratically, or take down the file instantly if necessary.  <em>(\"Oops there was a major mistake on the one we sent out this morning!  Everybody stop looking at it now!\")</em></p></li>\n<li><p>You can add/remove permissions when needed. Perhaps some users could benefit from the ability to modify the file, while others shouldn't be allowed to.  (Lean towards the 2nd option unless the 1st is beneficial.)</p></li>\n<li><p>If anyone's printing the file, make them stop!  There are reasons that society as a whole is close to being paperless.  Besides saving trees, some of the same reasons apply as why <em>not to</em> have multiple copies of the same file, only worse since incorrect paper copies are <em>even harder</em> to remove.</p></li>\n</ul>\n\n<p>There's lots of other benefits... but that's just one option.  You gave your distribution method idea a good shot &amp; tried to get it working (as did others for you), but sometimes the right answer to a different question.  </p>\n\n<p>Get some more ideas by spending some time Googling variations of:</p>\n\n<ul>\n<li><p>How to share a chart with others</p></li>\n<li><p>Security on shared files</p></li>\n<li><p>How does similar company xyz distribute reports?</p></li>\n<li><p>Sharing confidential Excel data on public networks</p></li>\n<li><p>Why is it bad to email daily reports</p></li>\n<li><p>Business email etiquette</p></li>\n<li><p>How to avoid overloading your recipients</p></li>\n<li><p>Create &amp; distribute reports people will <em>want</em> to read</p></li>\n</ul>\n\n<p><em>...etc...</em></p>\n\n<p>.</p>\n\n<p><sub>Or, I could be on the totally wrong track with the why/when/how/where/who's, but that's all I've got with what I've understood of your issue.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1513706110, "post_id": 47891546, "comment_id": 82751770, "body": "Thanks a ton, man. This actually worked. I have just tested this. The link which I get in the email is also fine and is opening the specific sheet, exactly what I wanted. :)"}], "tags": [], "owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "is_accepted": true, "score": 3, "last_activity_date": 1513702013, "creation_date": 1513702013, "answer_id": 47891546, "question_id": 47666879, "link": "https://stackoverflow.com/questions/47666879/vbscript-not-able-to-open-hyperlinks-to-an-excel-sheetnot-whole-workbook-from/47891546#47891546", "title": "VBScript_Not able to open Hyperlinks to an excel SHEET(not whole workbook) from outlook&#39;s email body directly", "body": "<p>Instead of using <code>HYPERLINK</code> which is actually a formula, just add a real hyperlink to the cell:</p>\n\n<pre><code>objXs.Cells(2,2).Hyperlinks.Add objXs.cells(2,2), strExcelLink, \"Sheet1!A1\", \"My Screentip\", \"EXLLINK\"\n</code></pre>\n"}], "owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1095, "favorite_count": 0, "accepted_answer_id": 47891546, "answer_count": 2, "score": 8, "last_activity_date": 1592870820, "creation_date": 1512535151, "last_edit_date": 1592870820, "question_id": 47666879, "link": "https://stackoverflow.com/questions/47666879/vbscript-not-able-to-open-hyperlinks-to-an-excel-sheetnot-whole-workbook-from", "title": "VBScript_Not able to open Hyperlinks to an excel SHEET(not whole workbook) from outlook&#39;s email body directly", "body": "<p><strong>Background:</strong></p>\n\n<p>I am supposed to create a dashboard(in excel) using vbscript and send it over an email(outlook) to someone. I already have a template for the Dashboard(excel). My script opens up that template excel, updates the Excel with today's results and some hyperlinks to some new files, creates an excel mail envelope and sends it to someone.</p>\n\n<p><strong>ISSUE:</strong></p>\n\n<p>My script adds 2 hyperlinks in the dashboard excel. 1st link points to a mht File and 2nd link points to another excel File. I sent the mail to myself and opened it. After opening the email, when I click on the 1st link(to mht file), it works fine and opens up IE for displaying mht file contents. Issue is with the 2nd hyperlink which points to an excel file. It is not Opening the excel file(I have made sure that the link is correct). </p>\n\n<p>Is there something I need to change in my code or Is there any outlook setting which will allow me to open up the link to an excel file directly?</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code>Option Explicit\nDim objXL, objXb, objXs, strXlPath, strMHTLink, strExcelLink\n\n'Dashboard Excel template\nstrXlPath = \"C:\\Users\\Gurman\\Work\\Misc\\Excel Hyperlink in Outlook\\test.xlsx\"\n\n'Link to MHT file\nstrMHTLink = \"C:\\Users\\Gurman\\Work\\Misc\\Excel Hyperlink in Outlook\\MHTFile.mht\"\n\n'Link to another Excel File\nstrExcelLink = \"C:\\Users\\Gurman\\Work\\Misc\\Excel Hyperlink in Outlook\\EXLFile.xlsx\"\n\n'Opening an excel(strXlPath) and updating it's Sheet1. In Sheet1, I will be adding 2 hyperlinks. \n'1st link for the MHT file(strMHTLink)\n'2nd link for another Excel File(strExcelLink)\n\nset objXl = CreateObject(\"excel.application\")\nobjXl.visible = true\nobjXl.displayAlerts = false\nset objXb = objXl.Workbooks.Open(strXlPath)\nset objXs = objXb.Sheets(\"Sheet1\")\n\nobjXs.Cells(2,1) = \"=HYPERLINK(\"\"\"&amp;strMHTLink&amp;\"\"\",\"\"MHTLINK\"\")\"                 'When clicked, it should open IE to display mht file contents\nobjXs.Cells(2,2) = \"=HYPERLINK(\"\"[\"&amp;strExcelLink&amp;\"]Sheet1!A1\"\",\"\"EXLLINK\"\")\"    'When clicked, it should open Sheet1 of EXLFile.xlsx\n\n'Saving the Workbook\nobjXb.save\n\n'Mailing this excels contents using Mail Envelope\nobjXb.EnvelopeVisible = true\nWith objXs.MailEnvelope.Item\n    .to = \"xxxxxxxx@xxxxxx.xxx\"         'contains an email address\n    .subject = \"Today's Hyperlinks\"\n    .attachments.add strXlPath          'attaches the saved dashboard in email\n    .send\nEnd With\n\nobjXb.Close\nobjXl.Quit\nset objXs = Nothing\nset objXb = Nothing\nset objXl = Nothing\n</code></pre>\n\n<p><strong>Screenshots:</strong></p>\n\n<p>This is the email which I get. You can see, it has 2 links and an excel file as attachment(This attached excel is my dashboard(test.xlsx). It's contents are same the contents of this email body)</p>\n\n<p><a href=\"https://i.stack.imgur.com/EiDrX.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/EiDrX.png\" alt=\"enter image description here\"></a></p>\n\n<p>In email body, when I click on mht link, it opens up the IE as expected:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VKJsq.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/VKJsq.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>But when I click on the Excel's link, nothing opens up. Even the link color doesn't change on clicking:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/H9SQt.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/H9SQt.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>How I made sure that excel hyperlink is correct?</strong></p>\n\n<p>This email has an excel attached which has the same contents as email body. I opened up that excel and then clicked on the hyperlink. Both hyper links works as shown below. But I want to open both the links from the outlook's email body directly(not this way).</p>\n\n<p><a href=\"https://i.stack.imgur.com/mZYw6.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/mZYw6.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried to provide as much information as I could. Please let me know if any other information is required.</p>\n\n<p><strong>UPDATE 1:</strong></p>\n\n<blockquote>\n  <p>Here is the Email body source code as requested by @garbb</p>\n\n<pre><code>&lt;html xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"&gt;\n\n&lt;head&gt;\n&lt;meta http-equiv=Content-Type content=\"text/html; charset=us-ascii\"&gt;\n&lt;meta name=ProgId content=Excel.Sheet&gt;\n&lt;meta name=Generator content=\"Microsoft Excel 14\"&gt;\n&lt;link rel=File-List href=\"cid:filelist.xml@01D36E74.B4504EE0\"&gt;\n&lt;link rel=OLE-Object-Data href=\"cid:oledata.mso\"&gt;\n&lt;style&gt;\n&lt;!--table\n  {mso-displayed-decimal-separator:\"\\.\";\n  mso-displayed-thousand-separator:\"\\,\";}\n.xl15\n  {padding-top:1px;\n  padding-right:1px;\n  padding-left:1px;\n  mso-ignore:padding;\n  color:black;\n  font-size:11.0pt;\n  font-weight:400;\n  font-style:normal;\n  text-decoration:none;\n  font-family:Calibri, sans-serif;\n  mso-font-charset:0;\n  mso-number-format:General;\n  text-align:general;\n  vertical-align:bottom;\n  mso-background-source:auto;\n  mso-pattern:auto;\n  white-space:nowrap;}\n.xl65\n  {padding-top:1px;\n  padding-right:1px;\n  padding-left:1px;\n  mso-ignore:padding;\n  color:blue;\n  font-size:11.0pt;\n  font-weight:400;\n  font-style:normal;\n  text-decoration:underline;\n  text-underline-style:single;\n  font-family:Calibri, sans-serif;\n  mso-font-charset:0;\n  mso-number-format:General;\n  text-align:general;\n  vertical-align:bottom;\n  mso-background-source:auto;\n  mso-pattern:auto;\n  white-space:nowrap;}\n--&gt;\n&lt;/style&gt;\n&lt;!--[if gte mso 9]&gt;&lt;xml&gt;\n &lt;x:ExcelWorkbook&gt;\n  &lt;x:ExcelWorksheets&gt;\n   &lt;x:ExcelWorksheet&gt;\n    &lt;x:Name&gt;Sheet1&lt;/x:Name&gt;\n    &lt;x:WorksheetOptions&gt;\n     &lt;x:DefaultRowHeight&gt;300&lt;/x:DefaultRowHeight&gt;\n     &lt;x:Selected/&gt;\n     &lt;x:Panes&gt;\n      &lt;x:Pane&gt;\n       &lt;x:Number&gt;3&lt;/x:Number&gt;\n       &lt;x:ActiveRow&gt;8&lt;/x:ActiveRow&gt;\n       &lt;x:ActiveCol&gt;4&lt;/x:ActiveCol&gt;\n      &lt;/x:Pane&gt;\n     &lt;/x:Panes&gt;\n     &lt;x:ProtectContents&gt;False&lt;/x:ProtectContents&gt;\n     &lt;x:ProtectObjects&gt;False&lt;/x:ProtectObjects&gt;\n     &lt;x:ProtectScenarios&gt;False&lt;/x:ProtectScenarios&gt;\n    &lt;/x:WorksheetOptions&gt;\n   &lt;/x:ExcelWorksheet&gt;\n  &lt;/x:ExcelWorksheets&gt;\n  &lt;x:WindowHeight&gt;8010&lt;/x:WindowHeight&gt;\n  &lt;x:WindowWidth&gt;14805&lt;/x:WindowWidth&gt;\n  &lt;x:WindowTopX&gt;240&lt;/x:WindowTopX&gt;\n  &lt;x:WindowTopY&gt;105&lt;/x:WindowTopY&gt;\n  &lt;x:HasEnvelope/&gt;\n  &lt;x:ProtectStructure&gt;False&lt;/x:ProtectStructure&gt;\n  &lt;x:ProtectWindows&gt;False&lt;/x:ProtectWindows&gt;\n &lt;/x:ExcelWorkbook&gt;\n&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;\n &lt;o:shapedefaults v:ext=\"edit\" spidmax=\"3073\" /&gt;\n&lt;/xml&gt;&lt;![endif]--&gt;\n&lt;/head&gt;\n\n&lt;body link=blue vlink=purple&gt;\n\n&lt;table border=0 cellpadding=0 cellspacing=0 width=183 style='border-collapse:\n collapse;table-layout:fixed;width:138pt'&gt;\n &lt;col width=89 style='mso-width-source:userset;mso-width-alt:3254;width:67pt'&gt;\n &lt;col width=94 style='mso-width-source:userset;mso-width-alt:3437;width:71pt'&gt;\n &lt;tr height=20 style='height:15.0pt'&gt;\n  &lt;td height=20 class=xl15 width=89 style='height:15.0pt;width:67pt'&gt;Link_To_MHT&lt;/td&gt;\n  &lt;td class=xl15 width=94 style='width:71pt'&gt;Link_To_Excel&lt;/td&gt;\n &lt;/tr&gt;\n &lt;tr height=20 style='height:15.0pt'&gt;\n  &lt;td height=20 class=xl65 style='height:15.0pt'&gt;&lt;a\n  href=\"file:///C:\\Users\\Gurman\\Work\\Misc\\Excel%20Hyperlink%20in%20Outlook\\MHTFile.mht\"&gt;MHTLINK&lt;/a&gt;&lt;/td&gt;\n  &lt;td class=xl65&gt;&lt;a\n  href=\"%5bC:/Users/Gurman/Work/Misc/Excel%20Hyperlink%20in%20Outlook/EXLFile.xlsx%5dSheet1!A1\"&gt;EXLLINK&lt;/a&gt;&lt;/td&gt;\n &lt;/tr&gt;\n &lt;![if supportMisalignedColumns]&gt;\n &lt;tr height=0 style='display:none'&gt;\n  &lt;td width=89 style='width:67pt'&gt;&lt;/td&gt;\n  &lt;td width=94 style='width:71pt'&gt;&lt;/td&gt;\n &lt;/tr&gt;\n &lt;![endif]&gt;\n&lt;/table&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n</blockquote>\n\n<p><strong>UPDATE 2</strong></p>\n\n<blockquote>\n  <p>This is how both the HyperLink formulas are displayed in Dashboard\n  Excel cells:</p>\n  \n  <p><strong>MHTLINK(working from within dashboard excel):</strong></p>\n\n<pre><code>=HYPERLINK(\"C:\\Users\\Gurman\\Work\\Misc\\Excel Hyperlink in Outlook\\MHTFile.mht\",\"MHTLINK\")\n</code></pre>\n  \n  <p><strong>EXLLINK(working from within the dashboard excel):</strong></p>\n\n<pre><code>=HYPERLINK(\"[C:\\Users\\Gurman\\Work\\Misc\\Excel Hyperlink in Outlook\\EXLFile.xlsx]Sheet1!A1\",\"EXLLINK\")\n</code></pre>\n  \n  <p>In Outlook, as shown in the email source in Update 1, the links are:</p>\n  \n  <p><strong>MHTLINK(working from email body):</strong></p>\n\n<pre><code>&lt;a href=\"file:///C:\\Users\\Gurman\\Work\\Misc\\Excel%20Hyperlink%20in%20Outlook\\MHTFile.mht\"&gt;MHTLINK&lt;/a&gt;\n</code></pre>\n  \n  <p><strong>EXLLINK(NOT Working from email body):</strong></p>\n\n<pre><code>&lt;a href=\"%5bC:/Users/Gurman/Work/Misc/Excel%20Hyperlink%20in%20Outlook/EXLFile.xlsx%5dSheet1!A1\"&gt;EXLLINK&lt;/a&gt;\n</code></pre>\n</blockquote>\n\n<p><strong>UPDATE 3(ISSUE ROOT CAUSE)</strong></p>\n\n<p>In my vbscript code, I have the line:</p>\n\n<pre><code>objXs.Cells(2,2) = \"=HYPERLINK(\"\"[\"&amp;strExcelLink&amp;\"]Sheet1!A1\"\",\"\"EXLLINK\"\")\"\n</code></pre>\n\n<p>This actually creates a hyperlink to <strong>Sheet1</strong> of an Excel Book. The formula which gets written within this cell is also correct which is <code>=HYPERLINK(\"[C:\\Users\\Gurman\\Work\\Misc\\Excel Hyperlink in Outlook\\EXLFile.xlsx]Sheet1!A1\",\"EXLLINK\")</code>. It is important for me to add <code>Sheet1!A1</code> in this formula as I want the hyperlink to point to a particular sheet(Sheet1 in this case) of the workbook</p>\n\n<p>THE ISSUE COMES WHEN THIS EXCEL FORMULA IS TRANSFORMED TO A LINK IN THE OUTLOOK MAIL, its value becomes:</p>\n\n<pre><code>&lt;a href=\"%5bC:/Users/Gurman/Work/Misc/Excel%20Hyperlink%20in%20Outlook/EXLFile.xlsx%5dSheet1!A1\"&gt;EXLLINK&lt;/a&gt;\n</code></pre>\n\n<p>The above link seems to be Incorrect as it has some HEX values like <code>%5b</code>, <code>%5d</code> etc. Hence, it is not working directly.</p>\n\n<p>If I change my VBScript code to create a hyperlink to the Excel Workbook only rather than creating a hyperlink to its \"Sheet1\", it works fine and I can also open the excel workbook link directly from the email.</p>\n\n<p>Updated line in VBscript:</p>\n\n<pre><code>objXs.Cells(2,2) = \"=HYPERLINK(\"\"\"&amp;strExcelLink&amp;\"\"\",\"\"EXLLINK\"\")\"\n</code></pre>\n\n<p>In Email source, it got transformed to:</p>\n\n<pre><code>&lt;a href=\"file:///C:\\Users\\Gurman\\Work\\Misc\\Excel%20Hyperlink%20in%20Outlook\\EXLFile.xlsx\"&gt;EXLLINK&lt;/a&gt;\n</code></pre>\n\n<p>I am able to open the excel workbook using this link directly from the email. But the flaw with this approach is that it may or may not open up Sheet1 in this case. As soon as someone clicks on the hyperlink, may be, Sheet2 opens up instead of Sheet1. Hence, I wanted to handle this thing in my code itself.</p>\n\n<p>So, my question/issue still remains unsolved:</p>\n\n<p><strong>Is it possible to have a hyperlink in Outlook's email body which opens up a particular sheet of an excel workbook?</strong></p>\n"}, {"tags": ["azure", "ms-access", "vba", "virtual-machine"], "comments": [{"owner": {"reputation": 113, "user_id": 480066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1aa6f4276b61f5711f2dcfc97f71a66?s=128&d=identicon&r=PG", "display_name": "Cam", "link": "https://stackoverflow.com/users/480066/cam"}, "edited": false, "score": 1, "creation_date": 1512540232, "post_id": 47666593, "comment_id": 82294396, "body": "Can you provide some more information in the path used in strUseDB? I&#39;m thinking this might have something to do with permissions or trust back to a location on C drive?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1512545643, "post_id": 47666593, "comment_id": 82296878, "body": "What is the value of <code>strUseDB</code>?"}, {"owner": {"reputation": 3, "user_id": 9059677, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcKlz.jpg?s=128&g=1", "display_name": "R. Bowmaker", "link": "https://stackoverflow.com/users/9059677/r-bowmaker"}, "edited": false, "score": 0, "creation_date": 1512594374, "post_id": 47666593, "comment_id": 82326311, "body": "strUseDB = &quot;C:\\WEMSIM\\Model\\TestModel.mdb&quot; (The quotes are not part of the string)"}, {"owner": {"reputation": 113, "user_id": 480066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1aa6f4276b61f5711f2dcfc97f71a66?s=128&d=identicon&r=PG", "display_name": "Cam", "link": "https://stackoverflow.com/users/480066/cam"}, "edited": false, "score": 0, "creation_date": 1512599848, "post_id": 47666593, "comment_id": 82328879, "body": "Can you right click on the database file and make sure it&#39;s not set to read-only or locked."}], "owner": {"reputation": 3, "user_id": 9059677, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcKlz.jpg?s=128&g=1", "display_name": "R. Bowmaker", "link": "https://stackoverflow.com/users/9059677/r-bowmaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594654281, "creation_date": 1512533043, "last_edit_date": 1594654281, "question_id": 47666593, "link": "https://stackoverflow.com/questions/47666593/access-vba-app-fails-on-azure-vm", "title": "Access VBA App Fails on Azure VM", "body": "<p>I have a legacy application written in MS Access VBA that I'm trying to port to an Azure Windows VM. I am running the application interactively via remote desktop.</p>\n\n<p>It fails on a VBA statement that has always worked when run on a local physical machine.</p>\n\n<p>The statement is:</p>\n\n<pre><code>        With tdf\n            .connect = \";DATABASE=\" &amp; strUseDB\n</code></pre>\n\n<p>where tdf is a TableDef object and strUseDB is the filename of an access database on a local drive.</p>\n\n<p>Running this on an Azure VM results in an \"Invalid Operation\" error 3219 being raised.</p>\n\n<p>I've tried this on both Windows Server 2016 and Windows 10 VMs with the same result.</p>\n\n<p>Any Ideas?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9059557, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-w-xPQ1s72ic/AAAAAAAAAAI/AAAAAAAAAGg/oRiDkQKjjLw/photo.jpg?sz=128", "display_name": "Gemerson Bagtas", "link": "https://stackoverflow.com/users/9059557/gemerson-bagtas"}, "edited": false, "score": 0, "creation_date": 1512531990, "post_id": 47666389, "comment_id": 82292043, "body": "Thank you YowE3k. Your answer was spot on!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1512531324, "creation_date": 1512531324, "answer_id": 47666389, "question_id": 47666264, "link": "https://stackoverflow.com/questions/47666264/new-to-excel-vba-run-time-error-91-object-variable-or-with-block-variable-no/47666389#47666389", "title": "New to Excel-VBA: Run Time Error &quot;91&quot;: Object Variable or With block variable not set", "body": "<p>Your <code>On Error Resume Next</code> statement is masking the error you are getting on the line saying </p>\n\n<pre><code>Set wsUserSel = ListBox1.Value\n</code></pre>\n\n<p>That line will fail because <code>ListBox1.Value</code> will not be a <code>Worksheet</code> object.  I assume it is a <code>String</code> that specifies which worksheet you want to use.</p>\n\n<hr>\n\n<p>So change the section saying:</p>\n\n<pre><code>On Error Resume Next\nSet wsUserSel = ListBox1.Value\nSet ws = Sheets.Add(after:=Sheets(Sheets.Count))\nOn Error GoTo 0\n</code></pre>\n\n<p>to be:</p>\n\n<pre><code>Set wsUserSel = Worksheets(ListBox1.Value)\nSet ws = Sheets.Add(after:=Sheets(Sheets.Count))\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9059557, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-w-xPQ1s72ic/AAAAAAAAAAI/AAAAAAAAAGg/oRiDkQKjjLw/photo.jpg?sz=128", "display_name": "Gemerson Bagtas", "link": "https://stackoverflow.com/users/9059557/gemerson-bagtas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 47666389, "answer_count": 1, "score": 1, "last_activity_date": 1512531324, "creation_date": 1512530328, "last_edit_date": 1512531060, "question_id": 47666264, "link": "https://stackoverflow.com/questions/47666264/new-to-excel-vba-run-time-error-91-object-variable-or-with-block-variable-no", "title": "New to Excel-VBA: Run Time Error &quot;91&quot;: Object Variable or With block variable not set", "body": "<p>I'm new to Excel-VBA so please excuse my ignorance. ;)</p>\n\n<p>I'm actually trying to run a program on the selected sheet from a UserForm.\nThe program would then get a value from the selected sheet which would import it to a newly created sheet. Sheet18 is a sheet template it will be copied to the new sheet.</p>\n\n<p>This are the codes:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nUserForm1.Hide\n  Dim wsUserSel As Worksheet\n  Dim ws As Worksheet\n  Dim ExFund As Variant\n\n    On Error Resume Next\n    Set wsUserSel = ListBox1.Value\n    Set ws = Sheets.Add(after:=Sheets(Sheets.Count))\n    On Error GoTo 0\n        With wsUserSel\n            ExFund = .Cells(107, 4).Value\n        End With\n        Sheet18.Range(\"A1:K126\").Copy\n        ws.Name = InputBox(\"Please input the name of new worksheet.\", ThisWorkbook.Name)\n        ws.Activate\n        Range(\"A1\").Select\n        ActiveSheet.Paste\n        ActiveSheet.Cells(29, 2) = ExFund\n        ActiveSheet.Cells.EntireColumn.AutoFit\n        Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>This code returns an error </p>\n\n<blockquote>\n  <p>Run Time Error \"91\": Object Variable or With block variable not set</p>\n</blockquote>\n\n<p>because of this part of the code:</p>\n\n<pre><code>    With wsUserSel\n        ExFund = .Cells(107, 4).Value\n    End With\n</code></pre>\n\n<p>I have tried putting it inside With or using wsUserSel directly but I can't seem to get it working.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "is_accepted": false, "score": 0, "last_activity_date": 1512540813, "creation_date": 1512540813, "answer_id": 47667911, "question_id": 47666243, "link": "https://stackoverflow.com/questions/47666243/adding-image-control-box-into-excel-cells-as-template/47667911#47667911", "title": "Adding image control box into excel cells as template", "body": "<p>You can go with this code:</p>\n\n<pre><code>With Application.FileDialog(msoFileDialogFilePicker)\n    .AllowMultiSelect = False\n    .ButtonName = \"Submit\"\n    .Title = \"Select an image file\"\n    .Filters.Clear\n    .Filters.Add \"JPG\", \"*.JPG\"\n    .Filters.Add \"JPEG File Interchange Format\", \"*.JPEG\"\n    .Filters.Add \"Graphics Interchange Format\", \"*.GIF\"\n    .Filters.Add \"Portable Network Graphics\", \"*.PNG\"\n    .Filters.Add \"Tag Image File Format\", \"*.TIFF\"\n    .Filters.Add \"All Pictures\", \"*.*\"\n\n    If .Show = -1 Then\n        Dim img As Object\n        Set img = ActiveSheet.Pictures.Insert(.SelectedItems(1))\n\n    End If\nEnd With\n</code></pre>\n\n<p>Embed the code onto a click event for an object in your worksheet (e.g. ActiveX / Form).\nPlease Note: The solution is from the user Portland Runner: <a href=\"https://stackoverflow.com/questions/22355537/excel-vba-insert-image-using-dialog-box-into-a-certain-cell\">Excel VBA - Insert image (using dialog box) into a certain cell</a>.</p>\n\n<p>After all, the add value is rather low. You need to save the file as an .xlsm in order to keep the code working.</p>\n"}], "owner": {"reputation": 13, "user_id": 8317848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/548860bcb842c0db7820a588dfd1d07c?s=128&d=identicon&r=PG&f=1", "display_name": "sim tong", "link": "https://stackoverflow.com/users/8317848/sim-tong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512540813, "creation_date": 1512530178, "last_edit_date": 1531161705, "question_id": 47666243, "link": "https://stackoverflow.com/questions/47666243/adding-image-control-box-into-excel-cells-as-template", "title": "Adding image control box into excel cells as template", "body": "<p>Is it possible to add picture box into the excel cells, so the user could click the box on the cell and insert image instead of clicking the add picture tool at the top of excel?</p>\n\n<p>example of outcome: \n<a href=\"https://i.stack.imgur.com/X93nL.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1512527269, "post_id": 47665840, "comment_id": 82290856, "body": "So you never bothered to explore the efficiency increases derived by suspending calculation and event handling. What is the point of improving code that was handed to you when you never understood it in the first place?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1512532322, "post_id": 47665840, "comment_id": 82292126, "body": "same as your previous question .... describe what is happening in detail.  ....  what does this mean ? <code>I need to remove any duplicate information</code>  how do you decide when you have a duplicate?   ... we are getting tired of guessing."}, {"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1512537021, "post_id": 47665840, "comment_id": 82293375, "body": "@Jeeped i tried and tested the code but it takes a while. I used screen updating, calculations off etc but it still takes a while. While the code is great, I need a faster way since the data set is large. I understood the code, and tried to play around with it, but couldnt get it to work"}, {"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1512537110, "post_id": 47665840, "comment_id": 82293410, "body": "@jsotola  I wanted the code to  look at cells values in column A, and if it finds a duplicate, delete the one that is in a lower row number. I will give an example above"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1512537823, "post_id": 47665840, "comment_id": 82293614, "body": "Is data in two columns only or there are more columns? You can use an empty column to work out duplicates in one go and then delete it."}, {"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1512537900, "post_id": 47665840, "comment_id": 82293635, "body": "There are around 30-35 columns also, and when duplictae is found, I want the entire row to be deleted"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1512542128, "post_id": 47665840, "comment_id": 82295076, "body": "<code>ActiveSheet.Range(&quot;A1&quot;).CurrentRegion.RemoveDuplicates Columns:=1, Header:=xlYes</code>"}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1512590753, "post_id": 47665840, "comment_id": 82324382, "body": "sort appropriately, then delete duplicates. That should run faster than your current code. recording a macro should help with the code needed"}, {"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1512602787, "post_id": 47665840, "comment_id": 82329990, "body": "Tried, but doesnt work."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1512834678, "post_id": 47665840, "comment_id": 82421111, "body": "As you mention a <i>huge set of data</i> - could you define the number of data rows as well as an roughly approximated percentage of duplicates?"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1512576869, "post_id": 47669856, "comment_id": 82316662, "body": "Thanks for this. this eems to eb working a lot faster, i am still etsting it, and will keep u posted. Didn&#39;t even know about this functionality"}, {"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1512591021, "post_id": 47669856, "comment_id": 82324542, "body": "Hi, this eems to be working however deletes the higher row of data. i need it to delete the lower row, so for example if row 2 and row 4 are duplicates, it should remove row 2"}, {"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1512601908, "post_id": 47669856, "comment_id": 82329679, "body": "The code is removing data when it finds duplicate row, I just need to loop through column A to find duplicates and delete the row which is in a lower row number. As demonstrated above I want the A values from Row 4 instead of Row 1"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1512617195, "post_id": 47669856, "comment_id": 82333759, "body": "@SM123 ok, try edited code (need to loop backwards if you wan to keep the value from the highest row)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 4, "last_activity_date": 1512617152, "last_edit_date": 1512617152, "creation_date": 1512548902, "answer_id": 47669856, "question_id": 47665840, "link": "https://stackoverflow.com/questions/47665840/vba-delete-duplicates-code-faster/47669856#47669856", "title": "VBA Delete Duplicates code faster", "body": "<p>Another fast method, is to use the <code>Dictionary</code> object. You can check if any of the values in Column A already exists in the <code>Dictionary</code>. If they do (meaning it's a duplicate), then don't delete them every time, this adds a long time for code's run-time. Instead, you can use a <code>DelRng</code> object, which is a <code>Range</code> that uses <code>Union</code> to merge multiple rows that are duplicates.</p>\n\n<p>Later on, you can delete the entire ducplicates range at once by using <code>DelRng.Delete</code>.</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub RemoveDuplicatesUsingDict()\n\nDim wb_DST As Workbook\nDim sWs_DST As String\n\n'  Dictionary variables\nDim Dict As Object\nDim DictIndex As Long, ExistIndex As Long\n\nDim DelRng As Range\nDim LastRow As Long, i As Long\n\n' --- parameters for my internal testing ---\nSet wb_DST = ThisWorkbook\nsWs_DST = \"Sheet1\"\n\nApplication.ScreenUpdating = False\n\nSet Dict = CreateObject(\"Scripting.Dictionary\")\n\nWith wb_DST.Sheets(sWs_DST)\n     LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row ' get last row with data in column \"A\"\n\n     For i = LastRow To 2 Step -1\n        If Not Dict.exists(.Range(\"A\" &amp; i).Value) Then ' value doesn't exists yet in Dictionary &gt;&gt; add this Key\n            Dict.Add .Range(\"A\" &amp; i).Value, .Range(\"A\" &amp; i).Value\n        Else ' value already exists in Dictionary &gt;&gt; add it to DelRng (later will delete the entire range)\n            If Not DelRng Is Nothing Then\n                Set DelRng = Application.Union(DelRng, .Rows(i)) ' add current row to existing DelRng\n            Else\n                Set DelRng = .Rows(i)\n            End If\n        End If\n     Next i\nEnd With\n\n' delete the entire range at 1-shot\nIf Not DelRng Is Nothing Then DelRng.Delete\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1512576886, "post_id": 47674569, "comment_id": 82316670, "body": "Thanks for this. i am testing it and will keep u posted"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1512581730, "post_id": 47674569, "comment_id": 82319712, "body": "@T.M, string concatenation is expensive. You&#39;ll never beat a solution relying on a dictionary/hashtable given that your code has a complexity superior to <code>O(n^2)</code>."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1512582422, "post_id": 47674569, "comment_id": 82320074, "body": "I added a 2nd version removing duplicate rows physically and hope this to be helpful. Using data field arrays is fast, but of course there are limits in concatenation (appreciate  @Florent-B &#39;s hint), so I would like to know how many data rows you are using."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1512583103, "post_id": 47674569, "comment_id": 82320427, "body": "It&#39;s worth mentioning that @Florent-B recently posted a high level method showing a hash search over 4 million keys  at <a href=\"https://stackoverflow.com/questions/47584647/how-to-reduce-the-time-cost-while-looping-in-a-4-million-array-in-vba/47599207#47599207\" title=\"how to reduce the time cost while looping in a 4 million array in vba\">stackoverflow.com/questions/47584647/&hellip;</a>. - There are many ways leading to Rome (arrays, dictionary, even xmldom), depends on the actual situation."}, {"owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1512601815, "post_id": 47674569, "comment_id": 82329638, "body": "a = ws.Range(&quot;A1:A&quot; &amp; ws.Cells(ws.Rows.Count, &quot;A&quot;).End(xlUp).Row) this line gives an error saying Object required"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1512640862, "post_id": 47674569, "comment_id": 82343660, "body": "This indicates that you didn&#39;t set the <code>ws</code> worksheet object correctly, e.g. <code>Set ws = ThisWorkbook.Worksheets(&quot;Sheet1&quot;)</code>. (I tested code again and it worked without Problems)"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "edited": false, "score": 0, "creation_date": 1512835119, "post_id": 47674569, "comment_id": 82421265, "body": "@SM123, did you find where you set the worksheet object? Maybe it&#39;s nested within a condition that isn&#39;t executed."}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1512581993, "last_edit_date": 1512581993, "creation_date": 1512564130, "answer_id": 47674569, "question_id": 47665840, "link": "https://stackoverflow.com/questions/47665840/vba-delete-duplicates-code-faster/47674569#47674569", "title": "VBA Delete Duplicates code faster", "body": "<p><strong>Fast use of data field array</strong></p>\n\n<p>Looping through a range isn't that fast - you can <strong>speed it up considerably</strong> if you create a data field array with your search data (array = needed range in column \"A\" - <em>see 1)</em> and loop therein. If your data set grows, this gets even faster in comparison to the above shown dictionary approach, though it rests a good and reliable method.</p>\n\n<p><strong>Search Method</strong></p>\n\n<ul>\n<li>Any array value is checked against a concatenated search string with already found unique values and added if not yet included - <em>see 2)</em></li>\n<li>The completed string is transformed to an array and written back to a given target column (e.g. \"H\") - <em>see 3) and 4)</em> </li>\n</ul>\n\n<p>I even added a second column with the corresponding row numbers, so you should be in the position to use them for further action. You could write results to another sheet, too.</p>\n\n<p><strong>Code - method demo</strong></p>\n\n<pre><code>Sub RemoveDuplicates()\nDim t    As Double: t = Timer   ' stop watch\nDim ws   As Worksheet           ' source sheet (object)\nDim i    As Long                ' row index\nDim a, arr, arr2                ' variant\nDim s    As String, si As String\nConst SEP = \"|\"                 ' delimiter\ns = SEP: si = SEP\n' 0) fully qualified range reference to source sheet\n  Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n' 1) write column A data to one based 2-dim data field array\n  a = ws.Range(\"A1:A\" &amp; ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row)\n' 2) loop through data and check for duplicates in concatenated string s\n  For i = 2 To UBound(a)\n     If InStr(s, SEP &amp; a(i, 1) &amp; SEP) = 0 Then\n        If Len(a(i, 1)) &gt; 0 Then\n           s = s &amp; a(i, 1) &amp; SEP\n           si = si &amp; i &amp; SEP\n        End If\n     End If\n  Next i\n' 3) transform unique values to zero based 1-dim array\n  arr = Split(Mid(s, 2), SEP)          ' duplicates string to array\n  arr2 = Split(Mid(si, 2), SEP)        ' found row numbers\n' 4) write result to column H2:H...      ' &lt;&lt;&lt; change target to wanted column\n  ws.Range(\"H:H\").ClearContents         '\n  ws.Range(\"H2:H\" &amp; (2 + UBound(arr))).Value = Application.Transpose(arr)\n  ws.Range(\"I2:I\" &amp; (2 + UBound(arr2))).Value = Application.Transpose(arr2)\n  Debug.Print UBound(arr) + 0 &amp; \" unique items found\", Format(Timer - t, \"0.00 seconds needed\")\n\nEnd Sub\n</code></pre>\n\n<p>=================================================================</p>\n\n<p><strong>EDIT</strong></p>\n\n<p><strong>Version 2 -- includes overwriting original data with unique values</strong></p>\n\n<p>Here you find a slightly modified version overwriting the original data in 35 columns (A2:AI..) with unique values.</p>\n\n<pre><code>Sub RemoveDuplicates2()\n' Edit: overwrite original data A2:AI{..} with unique values\nDim t    As Double: t = Timer   ' stop watch\nDim ws   As Worksheet           ' source sheet (object)\nDim i    As Long                ' row index\nDim a, arr, arr2                ' variant\nDim s    As String, si As String\nConst SEP = \"|\"                 ' delimiter\nConst MyLastColumn = \"AI\"       ' letter of last column (no 35) = \"AI\"\ns = SEP: si = SEP\n' fully qualified range reference to source sheet\n  Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n' write column A data to one based 2-dim data field array\n  a = ws.Range(\"A1:A\" &amp; ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row)\n' loop through data and check for duplicates in concatenated string s\n  For i = 2 To UBound(a)        '  For i = UBound(a) To 2 Step -1\n     If InStr(s, SEP &amp; a(i, 1) &amp; SEP) = 0 Then\n        If Len(Trim(a(i, 1))) &gt; 0 Then\n           s = s &amp; a(i, 1) &amp; SEP\n           si = si &amp; i &amp; SEP\n        End If\n     End If\n  Next i\n' write unique values to zero based 1-dim array (starts with index 0; last delimiter removed in this version)\n  arr2 = Split(Mid(si, 2, Len(si) - 2), SEP)     ' found row numbers\n' overwrite original data      \n  For i = LBound(arr2) To UBound(arr2)  ' starts with index 0!\n      s = \"A\" &amp; arr2(i) &amp; \":\" &amp; MyLastColumn &amp; arr2(i)\n      arr = ws.Range(s)        ' create 1-based 1-line (2-dim) array\n      s = \"A\" &amp; i + 2 &amp; \":\" &amp; MyLastColumn &amp; i + 2   ' 0 + 2 = +2 ... start in row 2\n      ws.Range(s) = arr        ' write back unique row values\n  Next i\n  s = \"A\" &amp; UBound(arr2) + 3 &amp; \":\" &amp; MyLastColumn &amp; UBound(a) + 1\n  ws.Range(s).ClearContents     ' clear rest of original data\n  Debug.Print UBound(arr2) + 1 &amp; \" unique items found\", Format(Timer - t, \"0.00 seconds needed\")          ' result\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 8696931, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/426bb0ad8ca055ff789882d273d98d4f?s=128&d=identicon&r=PG&f=1", "display_name": "SM123", "link": "https://stackoverflow.com/users/8696931/sm123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1512617152, "creation_date": 1512526994, "last_edit_date": 1512548014, "question_id": 47665840, "link": "https://stackoverflow.com/questions/47665840/vba-delete-duplicates-code-faster", "title": "VBA Delete Duplicates code faster", "body": "<p>Currently using this code, however, I have a huge set of data, and this runs really slow for that. I need to remove any duplicate information, and keep the highest row of information. </p>\n\n<pre><code>dim dup as variant, r as long, lncheckduplicatescolumn as long\nWith wb_DST.Sheets(sWs_DST)\n     lncheckduplicatescolumn = .Cells(.Rows.Count, \"A\").End(xlUp).row\n     for r = lncheckduplicatescolumn  to 2 step -1\n         dup = application.match(.cells(r, \"A\").value, .columns(1), 0)\n             if dup &lt; r then .rows(dup).delete\n     next r\nend with\n</code></pre>\n\n<p>Data:</p>\n\n<pre><code>       Column A              Column B\n          A                      1\n          B                      2\n          C                      3\n          A                      3\n</code></pre>\n\n<p>Result should be:</p>\n\n<pre><code>           B                     2\n           C                     3\n           A                     3\n</code></pre>\n\n<p>The order of data in column A doesnt matter as long as it is unique, and retains the information that is in the higher row number. While the code I shared works, it is too slow for a large data set. </p>\n"}, {"tags": ["vba", "excel", "pdf"], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 7516811, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8768e969344909b18a071f91b753eedd?s=128&d=identicon&r=PG&f=1", "display_name": "GrandeurH", "link": "https://stackoverflow.com/users/7516811/grandeurh"}, "is_accepted": false, "score": 0, "last_activity_date": 1512525799, "creation_date": 1512525799, "answer_id": 47665673, "question_id": 47665588, "link": "https://stackoverflow.com/questions/47665588/macro-to-export-excel-doc-as-pdf-for-all-users/47665673#47665673", "title": "Macro to export Excel Doc as PDF for all Users", "body": "<p>I have not tested this but based on what you gave try :</p>\n\n<pre><code>Dim url As String\nurl = Application.DefaultFilePath &amp; \"\\\" &amp; ActiveWorkbook.Name &amp; \".xls\"\n</code></pre>\n\n<p>in your export part of your code replace filename:= blah blah to Filename:=url</p>\n"}, {"comments": [{"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1517376240, "post_id": 47665790, "comment_id": 84065338, "body": "This works but could you please tell me that how to give file name in the above line"}, {"owner": {"reputation": 1132, "user_id": 6670570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EP3bp.jpg?s=128&g=1", "display_name": "Matts", "link": "https://stackoverflow.com/users/6670570/matts"}, "reply_to_user": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1517389960, "post_id": 47665790, "comment_id": 84071740, "body": "just add it to the path as you would normally. E.g. &quot;\\Desktop\\your_file.pdf&quot;"}], "tags": [], "owner": {"reputation": 1132, "user_id": 6670570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EP3bp.jpg?s=128&g=1", "display_name": "Matts", "link": "https://stackoverflow.com/users/6670570/matts"}, "is_accepted": false, "score": 1, "last_activity_date": 1512526603, "creation_date": 1512526603, "answer_id": 47665790, "question_id": 47665588, "link": "https://stackoverflow.com/questions/47665588/macro-to-export-excel-doc-as-pdf-for-all-users/47665790#47665790", "title": "Macro to export Excel Doc as PDF for all Users", "body": "<p>You can use environment variables.  <code>%USERPROFILE%\\Desktop</code> should work in this instance.</p>\n\n<p>Here's a list of environment variables. <a href=\"https://en.wikipedia.org/wiki/Environment_variable#Default_Values\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Environment_variable#Default_Values</a></p>\n\n<p>Accessing environment variables with VBA: <a href=\"https://stackoverflow.com/questions/935160/environ-function-code-samples-for-vba\">Environ Function code samples for VBA</a></p>\n\n<p>In VBA you could translate it to <code>Environ(\"USERPROFILE\") &amp; \"\\Desktop\"</code> This is untested as I'm not using Windows.</p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 3, "last_activity_date": 1600715615, "last_edit_date": 1600715615, "creation_date": 1512538159, "answer_id": 47667406, "question_id": 47665588, "link": "https://stackoverflow.com/questions/47665588/macro-to-export-excel-doc-as-pdf-for-all-users/47667406#47667406", "title": "Macro to export Excel Doc as PDF for all Users", "body": "<p><em>Use <code>.specialfolders(&quot;Desktop&quot;)</code> to save to the desktop. Set to a string variable and add the path separator</em></p>\n<p><em>Example</em></p>\n<pre><code>Option Explicit\nSub CreatePDF()\n    Dim FilePath As String\n            \n    FilePath = CreateObject(&quot;WScript.Shell&quot;).specialfolders(&quot;Desktop&quot;)\n    \n    Debug.Print FilePath\n    \n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\n                    FileName:=FilePath &amp; &quot;\\&quot; &amp; &quot;QuickView Update Dec_2017.pdf&quot;, _\n                    Quality:=xlQualityStandard, _\n                    IncludeDocProperties:=True, _\n                    IgnorePrintAreas:=False, _\n                    OpenAfterPublish:=True\n                    \nEnd Sub\n</code></pre>\n<blockquote>\n<p><a href=\"https://msdn.microsoft.com/en-us/library/0ea7b5xe(v=vs.84).aspx\" rel=\"nofollow noreferrer\">The following special folders are available:</a></p>\n</blockquote>\n<blockquote>\n<ul>\n<li>AllUsersDesktop</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>AllUsersStartMenu</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>AllUsersPrograms</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>AllUsersStartup</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>Desktop</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>Favorites</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>Fonts</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>MyDocuments</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>NetHood</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>PrintHood</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>Programs</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>Recent</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>SendTo</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>StartMenu</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>Startup</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>Templates</li>\n</ul>\n</blockquote>\n<hr />\n<blockquote>\n<p><em><sub>The SpecialFolders property returns an empty string if the requested folder (strFolderName) is not available. For example, Windows 95 does not have an AllUsersDesktop folder and returns an empty string if strFolderNameis AllUsersDesktop.</em></sub></p>\n</blockquote>\n<hr />\n<p><em>Here is another example</em>\n<em><a href=\"https://stackoverflow.com/a/31694603/4539709\">https://stackoverflow.com/a/31694603/4539709</a></em></p>\n"}], "owner": {"reputation": 61, "user_id": 7381147, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e129d0f0cbacf221b59c982417722307?s=128&d=identicon&r=PG&f=1", "display_name": "PFost", "link": "https://stackoverflow.com/users/7381147/pfost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1203, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1600715615, "creation_date": 1512525156, "last_edit_date": 1512536307, "question_id": 47665588, "link": "https://stackoverflow.com/questions/47665588/macro-to-export-excel-doc-as-pdf-for-all-users", "title": "Macro to export Excel Doc as PDF for all Users", "body": "<p>I need to create a macro that will save an excel document as a PDF file to any user's desktop (i.e. multiple people will be using this document/macro). </p>\n\n<p>Here is VBA code I have so far:</p>\n\n<pre><code>Sub CreatePDF()\n'\n' CreatePDF Macro\n'\n\n'\n    ChDir \"C:\\Users\\Public\\Desktop\"\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        \"C:\\Users\\Public\\Desktop\\QuickView Update Dec_2017.pdf\", Quality:= _\n        xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\n        OpenAfterPublish:=True\nEnd Sub\n</code></pre>\n\n<p>I think the issue is with the directory it's saving to (in the instances where this code says \"Public\" in the file path, I had changed that from my username which was initially populated).</p>\n\n<p>Does anyone know a way to specify a generic path to save this document as a PDF to any users' desktop?</p>\n"}, {"tags": ["vba", "excel", "copy-paste", "autofilter"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1512524778, "post_id": 47665470, "comment_id": 82290268, "body": "How are dealing with the first <code>.AutoFilterMode = False</code> when no .AutoFilter is current?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1512524968, "post_id": 47665470, "comment_id": 82290321, "body": "Try changing <code>.Row.Select</code> from <code>.Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row.Select.PasteSpecial xlPasteValues</code> to <code>.Offset(1, 0)</code>. It makes no sense in this context the way you have it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1512525065, "post_id": 47665470, "comment_id": 82290347, "body": "(and stop using <code>On Error Resume Next</code> until you get the programming correct)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1512526178, "post_id": 47665470, "comment_id": 82290598, "body": "Are you trying to copy the data to column A on the worksheet or column K? When you are inside a <code>With .Range(&quot;k1&quot;, .Range(&quot;k&quot; &amp; .Rows.Count).End(xlUp))</code> block, <code>.Cells(.Rows.Count, &quot;A&quot;)...</code> refers to column K and rows.count is only the rows in column K; <b>not</b> the parent worksheet."}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1512542050, "creation_date": 1512542050, "answer_id": 47668223, "question_id": 47665470, "link": "https://stackoverflow.com/questions/47665470/autofilter-then-copy-and-paste-range/47668223#47668223", "title": "Autofilter then Copy and Paste Range", "body": "<p>Try this version</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub DepreciationToZero()\n\n    Const FIND_VAL = \"*HotDog*\"\n\n    Dim ws As Worksheet, lr As Long, result As String\n\n    Set ws = Worksheets(\"Restaurant\")\n    Application.ScreenUpdating = False\n    ws.AutoFilterMode = False\n    lr = ws.Cells(ws.Rows.Count, \"K\").End(xlUp).Row\n    result = FIND_VAL &amp; \" not found\"\n\n    With ws.UsedRange\n        ws.Range(\"K1:K\" &amp; lr).AutoFilter Field:=1, Criteria1:=FIND_VAL\n        If ws.Range(\"K1:K\" &amp; lr).SpecialCells(xlCellTypeVisible).CountLarge &gt; 1 Then\n            .Offset(1).Resize(lr - 1).SpecialCells(xlCellTypeVisible).Copy\n            .Offset(lr).Cells(1).PasteSpecial xlPasteValues\n            .Offset(lr).Cells(1).Select\n            Application.CutCopyMode = False\n            result = \"All \" &amp; FIND_VAL &amp; \" rows copied\"\n        End If\n    End With\n\n    ws.AutoFilterMode = False\n    Application.ScreenUpdating = True\n    MsgBox result\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9036993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c6fc85fb2d2b049c84f780b685ea06?s=128&d=identicon&r=PG&f=1", "display_name": "R.Kim", "link": "https://stackoverflow.com/users/9036993/r-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 505, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512542050, "creation_date": 1512524357, "question_id": 47665470, "link": "https://stackoverflow.com/questions/47665470/autofilter-then-copy-and-paste-range", "title": "Autofilter then Copy and Paste Range", "body": "<p>I wrote a code below.\nIntention is to autofilter column K with criteria, copy data and paste it at the bottom of the sheet on the same page, just below the last row.</p>\n\n<p>I am not getting any error, but code is not working as intended.\nIt works up to autofilter and copy, but it won't paste the data to the last row.\nCan I please get some assistance.</p>\n\n<pre><code>Sub Depreciation_to_Zero()\nWith Sheets(\"Restaurant\")\n.AutoFilterMode = False\nWith .Range(\"k1\", .Range(\"k\" &amp; .Rows.Count).End(xlUp))\n    .AutoFilter Field:=1, Criteria1:=\"*HotDog*\"\n    On Error Resume Next\n    .Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Copy\n    .Cells(.Rows.Count, \"A\").End(xlUp).Row.Select.PasteSpecial xlPasteValues\n    On Error GoTo 0\nEnd With\n\n.AutoFilterMode = False\nEnd With\nMsgBox (\"Complete\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "sharepoint", "connection", "mapping", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1512525060, "post_id": 47665431, "comment_id": 82290345, "body": "cross posted <a href=\"https://sharepoint.stackexchange.com/questions/231389/unable-to-locate-a-sharepoint-folder-on-mapped-drive\" title=\"unable to locate a sharepoint folder on mapped drive\">sharepoint.stackexchange.com/questions/231389/&hellip;</a>"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1512525083, "post_id": 47665431, "comment_id": 82290353, "body": "Please don&#39;t post the same question in more than one sites on the Stack Exchange network."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1512525301, "creation_date": 1512525301, "answer_id": 47665607, "question_id": 47665431, "link": "https://stackoverflow.com/questions/47665431/unable-to-locate-new-folder-on-mapped-drive/47665607#47665607", "title": "Unable to locate new folder on mapped drive", "body": "<p>Change </p>\n\n<pre><code>If Dir(spPath) = \"\" Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If Dir(spPath, vbDirectory) = \"\" Then\n</code></pre>\n\n<hr>\n\n<p>Until someone puts a file into the directory (perhaps a day after the directory is created), your code is not seeing any files there (because there aren't any).  By adding <code>vbDirectory</code> it will look for the directory itself.</p>\n"}], "owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 47665607, "answer_count": 1, "score": 0, "last_activity_date": 1512525301, "creation_date": 1512524091, "last_edit_date": 1531161705, "question_id": 47665431, "link": "https://stackoverflow.com/questions/47665431/unable-to-locate-new-folder-on-mapped-drive", "title": "Unable to locate new folder on mapped drive", "body": "<p>I had create a macro that auto upload the current workbook to sharepoint apon triggering the macro.\nThe macro was successful, uploading the file to sharepoint folder that was mapped to the drive.</p>\n\n<p>However, the macro only success if the SharePoint folder is created way before time. Eg. maybe 1 day in advanced.</p>\n\n<p>If the folder is newly created, it would not be able to upload to the folder as <code>Sorry there's no such folder</code>. </p>\n\n<p>If I go to the drive on window explorer, I would be able to see the newly created folder.\nI also tried copy the file path shown on the msg box and type in window explorer, it directs me to the folder with no issues.</p>\n\n<p>Is there a way I can speed up the process and why does this happens?</p>\n\n<p><strong>Macro IF statement</strong></p>\n\n<pre><code>If Dir(spPath) = \"\" Then\n    MsgBox \"Sorry there's no such folder. Folder Path: \" &amp; vbNewLine &amp; vbNewLine &amp; spPath &amp; \"\"\n    Call UnMapDrive(drive)\n    Exit Sub\n    ElseIf Not Dir(spPath &amp; fileName) = \"\" Then\n    MsgBox(\"File Already Exist!!!\")\n    ElseIf Dir(spPath &amp; fileName) = \"\" Then\n    FolderCreate (path)\n    ThisWorkbook.SaveCopyAs copyPath &amp; fileName\n    Call FileCopy(path &amp; fileName, spPath &amp; fileName)\n    MsgBox \"File Successfully uploaded to SharePoint.\"\n    Kill (path) &amp; \"*.*\"\n    RmDir path\n    Call UnMapDrive(drive)\nEnd If\n</code></pre>\n"}]