[{"tags": ["excel", "vba", "combobox", "userform"], "comments": [{"owner": {"reputation": 33, "user_id": 7487825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4b48e7327bab0ec73acb53e0dcc140?s=128&d=identicon&r=PG&f=1", "display_name": "MCircular", "link": "https://stackoverflow.com/users/7487825/mcircular"}, "edited": false, "score": 0, "creation_date": 1529546210, "post_id": 50958370, "comment_id": 88915823, "body": "Alright: I move the msgbox inside the <code>If isempty()= false then...</code> and it is appearing. that prove teh Cbtxt isn&#39;t empty but the variable is like <code>Cbtxt = &quot;      &quot;</code>"}, {"owner": {"reputation": 600, "user_id": 8923830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MbJogn0Ac18/AAAAAAAAAAI/AAAAAAAAAGY/Xh76EIIP2vI/photo.jpg?sz=128", "display_name": "Badda_Bing", "link": "https://stackoverflow.com/users/8923830/badda-bing"}, "edited": false, "score": 0, "creation_date": 1529568635, "post_id": 50958370, "comment_id": 88923618, "body": "Would it help grouping your comboboxes inside a frame, then refering to the frame.controls instead of ALL of the controls...?"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1529577770, "post_id": 50958370, "comment_id": 88929310, "body": "which combobox gets highlighted: UserForm1.Controls(&quot;Cbo_A&quot; &amp; i).BackColor = RGB(255, 255, 0) ? (I=1)"}, {"owner": {"reputation": 33, "user_id": 7487825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4b48e7327bab0ec73acb53e0dcc140?s=128&d=identicon&r=PG&f=1", "display_name": "MCircular", "link": "https://stackoverflow.com/users/7487825/mcircular"}, "reply_to_user": {"reputation": 600, "user_id": 8923830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MbJogn0Ac18/AAAAAAAAAAI/AAAAAAAAAGY/Xh76EIIP2vI/photo.jpg?sz=128", "display_name": "Badda_Bing", "link": "https://stackoverflow.com/users/8923830/badda-bing"}, "edited": false, "score": 0, "creation_date": 1529623687, "post_id": 50958370, "comment_id": 88953290, "body": "@Badda_Bing I want to get the value of EACH combobox. In the screenshot they are the same but in reality they won&#39;t be. every combobox will have its own value. That is why I named them with a number with a previous` For...Next` loop. The left one is &#39;Cbo_A &amp; i&#39; the right one is &#39;Cbo_B &amp; i&#39; with &quot;i&quot; as integer."}, {"owner": {"reputation": 33, "user_id": 7487825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4b48e7327bab0ec73acb53e0dcc140?s=128&d=identicon&r=PG&f=1", "display_name": "MCircular", "link": "https://stackoverflow.com/users/7487825/mcircular"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1529623938, "post_id": 50958370, "comment_id": 88953332, "body": "@EvR The one in the message box (CBo_A1) is the second from the top in the &quot;Equipment&quot; column. They are numbered from 0 to... until needed. But it doesn&#39;t matter: All of them return nothing from the variable."}, {"owner": {"reputation": 33, "user_id": 7487825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4b48e7327bab0ec73acb53e0dcc140?s=128&d=identicon&r=PG&f=1", "display_name": "MCircular", "link": "https://stackoverflow.com/users/7487825/mcircular"}, "edited": false, "score": 0, "creation_date": 1529624639, "post_id": 50958370, "comment_id": 88953450, "body": "I tried to code the userform with this: <code>Cbtxt = me.Controls(&quot;&quot;CBo_A&quot;&quot; &amp; i).value</code> but i have the same problem. In the standard module i tried <code>Cbtxt = Userform1.Controls(&quot;CBo_A&quot; &amp; i).value</code>, and <code>Cbtxt = VBA.Userforms(&quot;Userform1&quot;).Controls(&quot;Cbo_A&quot; &amp; i).value</code>. I also alternate <code>.value</code> with <code>.text</code> but same results."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1529657074, "post_id": 50958370, "comment_id": 88962953, "body": "you refer to Userform1, there are no other instances of the Userform?"}, {"owner": {"reputation": 33, "user_id": 7487825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4b48e7327bab0ec73acb53e0dcc140?s=128&d=identicon&r=PG&f=1", "display_name": "MCircular", "link": "https://stackoverflow.com/users/7487825/mcircular"}, "edited": false, "score": 0, "creation_date": 1529955862, "post_id": 50958370, "comment_id": 89053847, "body": "None. It is the only userform created and used. I used <code>Set Userface = ThisWorkbook.VBProject.VBComponents.Add(3)</code> to create it."}, {"owner": {"reputation": 33, "user_id": 7487825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4b48e7327bab0ec73acb53e0dcc140?s=128&d=identicon&r=PG&f=1", "display_name": "MCircular", "link": "https://stackoverflow.com/users/7487825/mcircular"}, "edited": false, "score": 0, "creation_date": 1530073191, "post_id": 50958370, "comment_id": 89099710, "body": "I am in the procedure module and I want the value from the userform. Because I have a variable number of cbox is something like something like <code>Application.VBE.Userforms(Userform1&quot;).controls(Controls(&quot;CBo&zwnj;&#8203;_A&quot; &amp; i).value</code> will help (it doesn&#39;t work: I tried)"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 7487825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4b48e7327bab0ec73acb53e0dcc140?s=128&d=identicon&r=PG&f=1", "display_name": "MCircular", "link": "https://stackoverflow.com/users/7487825/mcircular"}, "is_accepted": false, "score": 0, "last_activity_date": 1531081643, "creation_date": 1531081643, "answer_id": 51235740, "question_id": 50958370, "link": "https://stackoverflow.com/questions/50958370/vba-excel-collecting-data-in-userform-from-program-in-module/51235740#51235740", "title": "VBA Excel - collecting data in userform from program in module", "body": "<p>Right... I tried many things but it seems nothing else than the following is working. I wrote the code into the userform code module</p>\n\n<pre><code>With Userface.CodeModule\n        .insertlines 1, \"end sub\"\n        .insertlines 1, \"\"\n        .insertlines 1, \"call Cansub\"\n        .insertlines 1, \"MsgBox \"\"Entries fulfilled\"\"\"\n        .insertlines 1, \"    Next i\"\n        .insertlines 1, \"        End If\"\n        .insertlines 1, \"            Addentr.Cells(i + 1, 11).Value = Cbtxt\"\n        .insertlines 1, \"        If IsEmpty(Cbtxt) = False Then\"\n        .insertlines 1, \"        Cbtxt = me.Controls(\"\"Cbo_B\"\" &amp; i).Value\"\n\n        .insertlines 1, \"        End If\"\n        .insertlines 1, \"           Addentr.Cells(i + 1, 10).Value = Cbtxt\"\n        .insertlines 1, \"        If IsEmpty(Cbtxt) = False Then\"\n        .insertlines 1, \"        Cbtxt = me.Controls(\"\"Cbo_A\"\" &amp; i).Value\"\n\n        .insertlines 1, \"   For i = 0 To Line - 1\"\n        .insertlines 1, \"Line = Range(Range(\"\"J1\"\").End(xlDown).Offset(1, 0), Range(\"\"A1\"\").End(xlDown)).Rows.Count\"\n        .insertlines 1, \"Set Addentr = ActiveWorkbook.Sheets(\"\"Combined\"\").Range(Range(\"\"J1\"\").End(xlDown).Offset(1, 0), Range(\"\"A1\"\").End(xlDown))\"\n        .insertlines 1, \"Line = 0\"\n        .insertlines 1, \"Dim Addentr As Range\"\n        .insertlines 1, \"Dim Line As Long\"\n        .insertlines 1, \"Dim Cbtxt As String\"\n        .insertlines 1, \"Public Sub Okbt_Click()\"\nEnd With\n</code></pre>\n\n<p>`</p>\n\n<p>NB: You have to read the program from bottom to top. I hate using .insertlines because it takes too much time to allocate the lines everytime. But I discovered than if you do like this you just copy/paste and it write the code upsidedown.</p>\n\n<p>Thank you for those who tried to help.</p>\n"}], "owner": {"reputation": 33, "user_id": 7487825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4b48e7327bab0ec73acb53e0dcc140?s=128&d=identicon&r=PG&f=1", "display_name": "MCircular", "link": "https://stackoverflow.com/users/7487825/mcircular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594207196, "creation_date": 1529537032, "last_edit_date": 1594207196, "question_id": 50958370, "link": "https://stackoverflow.com/questions/50958370/vba-excel-collecting-data-in-userform-from-program-in-module", "title": "VBA Excel - collecting data in userform from program in module", "body": "<p>I am creating by code a userform that contain labels, textboxes and comboboxes per lines (see picture below). The number of line is variable (so is the number of comboboxes). I also create 3 buttons: OK, Cancel, Add.\n\"Cancel\" unload the form, \"Add\" opens another Userform to update the source of the comboboxes and \"OK\" put the infos, the user selected in the combobox, into a cell in the worksheet. All the buttons Call another Sub to execute:</p>\n\n<pre><code>With Userface.codemodule\n        .insertlines 1, \"end sub\"\n        .insertlines 1, \"call Cansub\"\n        .insertlines 1, \"Private Sub Canbt_Click()\"\nEnd With\n\n'Validate  and register\nWith Userface.codemodule\n        .insertlines 1, \"end sub\"\n        .insertlines 1, \"Call Oksub\"\n        .insertlines 1, \"\"\n        .insertlines 1, \"Public Sub Okbt_Click()\"\nEnd With\n\n'add another category and/or reason\nWith Userface.codemodule\n        .insertlines 1, \"end sub\"\n        .insertlines 1, \"call Addsub\"\n        .insertlines 1, \"Private Sub Addbt_Click()\"\nEnd With\n\nApplication.VBE.MainWindow.Visible = True\nVBA.UserForms.Add(Userface.Name).Show\n</code></pre>\n\n<p>Everything is working but the \"OK\" button.\nI don't want to use with <code>userface.codemodule.insertlines 1,\"\"</code> To write the whole thing. that is why I am calling a sub.</p>\n\n<p>Here is the Public OKsub() the button calls:</p>\n\n<pre><code>Dim Addentr As Range\nDim Line As Long\nDim Cbtxt As String\n\nLine = 0\nLine = Range(Range(\"J1\").End(xlDown).Offset(1, 0), Range(\"A1\").End(xlDown)).Rows.Count\nSet Addentr = ActiveWorkbook.Sheets(\"Combined\").Range(Range(\"J1\").End(xlDown).Offset(1, 0), Range(\"A1\").End(xlDown))\n\nFor i = 0 To Line - 1\n    Cbtxt = UserForm1.Controls(\"Cbo_A\" &amp; i).Value\n    MsgBox \"Combobox CBo_A\" &amp; i &amp; \" = \" &amp; Cbtxt\n\n    If IsEmpty(Cbtxt) = False Then\n        Addentr.Cells(i + 1, 10).Value = Cbtxt\n    End If\n\n    Cbtxt = UserForm1.Controls(\"Cbo_B\" &amp; i).Text\n\n    If IsEmpty(Cbtxt) = False Then\n        Addentr.Cells(i + 1, 11).Value = Cbtxt\n    End If\n\nNext i\n\nMsgBox \"Entries fulfilled\"\n</code></pre>\n\n<p>The code runs without error BUT the \"Cbtxt\" value is empty as the msgbox shows here\n<a href=\"https://i.stack.imgur.com/Jb1zW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jb1zW.jpg\" alt=\"Screenshot userface\"></a>\nMost of the \"solutions\" I found speak of doing this once by giving the value to a public variable before moving to the worksheet. But, in my case, the number of input is changing so I have to include that into a loop. I cannot dedicated one variable per combobox (or can I?... or not).</p>\n\n<p>I hope you will understand me guys. Thanks for the support!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1529535953, "post_id": 50958212, "comment_id": 88913739, "body": "put <code>If Target.Cells.Count &gt; 1 Then Exit Sub</code> at the top."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529537171, "post_id": 50958212, "comment_id": 88914000, "body": "Also needs <code>Application.EnableEvents = False</code> before you update the sheet, or you&#39;ll again trigger the event needlessly.  Set back to <code>True</code> when done."}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1529536490, "post_id": 50958250, "comment_id": 88913863, "body": "I would go with <code>for each cell in target</code> since why create a new range (or area) when one is already created, although I don&#39;t think OP wants to loop through cells when multiple ones are selected."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1529536651, "post_id": 50958250, "comment_id": 88913899, "body": "I didn&#39;t actually realise it was <code>Worksheet_Change</code> so yes indeed. Target it is"}], "tags": [], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "is_accepted": false, "score": 0, "last_activity_date": 1529536663, "last_edit_date": 1529536663, "creation_date": 1529536003, "answer_id": 50958250, "question_id": 50958212, "link": "https://stackoverflow.com/questions/50958212/how-to-deal-with-multiple-active-cells-when-replacing-text/50958250#50958250", "title": "How to deal with multiple active cells when replacing text", "body": "<p>Use Areas:</p>\n\n<pre><code>Dim area,cell as range\nFor each area in target.areas\n    For each cell in area.cells\n        OriginalText = cell.value\n    next\nnext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1529537619, "creation_date": 1529537619, "answer_id": 50958446, "question_id": 50958212, "link": "https://stackoverflow.com/questions/50958212/how-to-deal-with-multiple-active-cells-when-replacing-text/50958446#50958446", "title": "How to deal with multiple active cells when replacing text", "body": "<p>Something like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim c As Range, newText As String, v\n\n    'exit if too many cells (eg whole column)\n    If Target.CountLarge &gt; 1000 Then Exit Sub\n\n    For Each c In Target.Cells\n        v = c.Value\n        Select Case v\n            Case \"r\", \"R\", \"replace\": newText = \"Replace\"\n            Case \"a\", \"A\", \"acceptable\": newText = \"Acceptable\"\n            Case \"n\", \"N\", \"new\": newText = \"New\"\n            Case Else: newText = v\n        End Select\n        If newText &lt;&gt; v Then\n            Application.EnableEvents = False\n                c.Value = newText\n            Application.EnableEvents = True\n        End If\n    Next c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9970092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d94982160f58917df794290781227c78?s=128&d=identicon&r=PG&f=1", "display_name": "LibGuy", "link": "https://stackoverflow.com/users/9970092/libguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1529592609, "creation_date": 1529535722, "last_edit_date": 1529592609, "question_id": 50958212, "link": "https://stackoverflow.com/questions/50958212/how-to-deal-with-multiple-active-cells-when-replacing-text", "title": "How to deal with multiple active cells when replacing text", "body": "<p>I'm looking to modify the text of my cells on the fly. \nex: \"n\", \"N\" or \"new\" ---> \"New\"</p>\n\n<p>I've got it working, however I'm having issues when I select multiple cells to delete the text.</p>\n\n<p>Can someone help identify how I could accomplish this goal and still be able to modify multiple excel cell values (deleting is my only concern unless you can think of other limitations my code may cause).</p>\n\n<p>--Just to clarify, my code will change the text the way I want it to, however, when I select multiple cells and press the delete key (to delete the cells' values) I get a type mismatch for Range(Target.Address).Value</p>\n\n<p>Thanks everyone for your time,\nAl</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim OriginalText As String\n    Dim CorrectedText As String\n        OriginalText = Range(Target.Address).Value\n        If OriginalText = \"r\" Or OriginalText = \"R\" Or OriginalText = \"replace\" Then\n           CorrectedText = \"Replace\"\n           Range(Target.Address).Value = CorrectedText\n        ElseIf OriginalText = \"a\" Or OriginalText = \"A\" Or OriginalText = \"acceptable\" Then\n            CorrectedText = \"Acceptable\"\n           Range(Target.Address).Value = CorrectedText\n        ElseIf OriginalText = \"n\" Or OriginalText = \"N\" Or OriginalText = \"new\" Then\n            CorrectedText = \"New\"\n           Range(Target.Address).Value = CorrectedText\n        End If\n\nEnd Sub\n</code></pre>\n\n<p>Update:\nI can't tell you how much I appreciate everyone's generosity! Thank you for your help. I hope this can assist others in need as well.\nCheers, Al</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 9873038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7307104004465b1d5fafe0de28e894a?s=128&d=identicon&r=PG&f=1", "display_name": "Cullen", "link": "https://stackoverflow.com/users/9873038/cullen"}, "is_accepted": false, "score": 1, "last_activity_date": 1529556027, "last_edit_date": 1529556027, "creation_date": 1529534494, "answer_id": 50958043, "question_id": 50957947, "link": "https://stackoverflow.com/questions/50957947/sending-emails-in-excel-using-vba-when-a-specific-value-of-a-cell-is-selected/50958043#50958043", "title": "Sending Emails in Excel using VBA when a specific value of a cell is selected", "body": "<p>You can use <code>Cells([row],[col])</code> to reference other cells in the active worksheet.</p>\n\n<p>On the other hand, if the worksheet is not active you can use <code>Sheets([sheetname]).Cells([row],[col])</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "is_accepted": false, "score": 0, "last_activity_date": 1529535614, "creation_date": 1529535614, "answer_id": 50958192, "question_id": 50957947, "link": "https://stackoverflow.com/questions/50957947/sending-emails-in-excel-using-vba-when-a-specific-value-of-a-cell-is-selected/50958192#50958192", "title": "Sending Emails in Excel using VBA when a specific value of a cell is selected", "body": "<p>@Cullen gave a good answer, also you can use:</p>\n\n<pre><code>SomeSheet.Range(&lt;&lt;cellreference)\n</code></pre>\n\n<p>e.g.</p>\n\n<pre><code>Sheets(\"CoolSheet\").Range(\"A6\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9970019, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158844586155006/picture?type=large", "display_name": "Anthony Herbert", "link": "https://stackoverflow.com/users/9970019/anthony-herbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593629541, "creation_date": 1529533796, "last_edit_date": 1593629541, "question_id": 50957947, "link": "https://stackoverflow.com/questions/50957947/sending-emails-in-excel-using-vba-when-a-specific-value-of-a-cell-is-selected", "title": "Sending Emails in Excel using VBA when a specific value of a cell is selected", "body": "<p>I'm trying to send an email to recipients when a specific value of a cell is selected. If the value is 'new' then it gets sent to a predefined email. if the value is 'pending' or otherwise then it gets sent to a user entered email in another cell. I'm using this currently but i'm not sure how to modify it to look at the other cell.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim myToAdd As String\nIf Target.Column = 6 Then\n    If Target.Value = \"New \" Then\n        myToAdd = \"email@hotmail.com;\"\n    ElseIf Target.Value = \"Pending review\" Then\n        myToAdd = 'I want this to look at another cell for the email\n    End If\n\n    With CreateObject(\"Outlook.Application\").createitem(0) '0 will create a new email item\n        .To = myToAdd\n        .Subject = \"A change request/project support has been request\"\n        .Body = \"Dear User,\" &amp; vbNewLine &amp; vbNewLine &amp; \"This is my email body \"\n        .Display\n    End With\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "parameter-passing", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 7998675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48d72035271c4c2fac240ec9976a5d9?s=128&d=identicon&r=PG&f=1", "display_name": "LiCarroll", "link": "https://stackoverflow.com/users/7998675/licarroll"}, "edited": false, "score": 0, "creation_date": 1529534921, "post_id": 50958017, "comment_id": 88913526, "body": "Works perfectly as intended. Thank you! I will read more into the .OnAction method and Application.Caller."}, {"owner": {"reputation": 7, "user_id": 7998675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48d72035271c4c2fac240ec9976a5d9?s=128&d=identicon&r=PG&f=1", "display_name": "LiCarroll", "link": "https://stackoverflow.com/users/7998675/licarroll"}, "edited": false, "score": 0, "creation_date": 1529536771, "post_id": 50958017, "comment_id": 88913924, "body": "Is there a way to screen the shapes and only add shapes of the rectangle variety to my <code>&quot;get_text&quot;</code> action. What property would I access?"}], "tags": [], "owner": {"reputation": 586, "user_id": 9633414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17a4ec5f0dbe53ee0a2153b37138b17?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/9633414/j-doe"}, "is_accepted": true, "score": 1, "last_activity_date": 1529537150, "last_edit_date": 1529537150, "creation_date": 1529534328, "answer_id": 50958017, "question_id": 50957815, "link": "https://stackoverflow.com/questions/50957815/passing-shape-properties-to-click-sub/50958017#50958017", "title": "Passing Shape Properties to _Click() Sub", "body": "<p>You could use first code below to link every shapes in a specific sheet to the <code>get_text</code> code:</p>\n\n<pre><code>Sub apply_script()\n\nDim sh As Shape\n\nFor Each sh In ActiveSheet.Shapes\n    sh.OnAction = \"get_text\"\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Then use this code to get the text of the shape:</p>\n\n<pre><code>Sub get_text()\n    MsgBox ActiveSheet.Shapes(Application.Caller).TextFrame.Characters.Caption\nEnd Sub\n</code></pre>\n\n<p>Edit for rectangles only :</p>\n\n<pre><code>Sub apply_script()\n\nDim sh As Shape\n\nFor Each sh In ActiveSheet.Shapes\n    If sh.AutoShapeType = 1 Then\n        sh.OnAction = \"get_text\"\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 7998675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48d72035271c4c2fac240ec9976a5d9?s=128&d=identicon&r=PG&f=1", "display_name": "LiCarroll", "link": "https://stackoverflow.com/users/7998675/licarroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 50958017, "answer_count": 1, "score": 0, "last_activity_date": 1529704786, "creation_date": 1529532866, "last_edit_date": 1531161705, "question_id": 50957815, "link": "https://stackoverflow.com/questions/50957815/passing-shape-properties-to-click-sub", "title": "Passing Shape Properties to _Click() Sub", "body": "<p>I am struggling to even figure out where to start here, so any push in the right direction will be of great help.</p>\n\n<p>I have a map spreadsheet with many different rectangle objects that contain text. When I click on a Rectangle I want to run a macro and I want that macro to receive the text in the rectangle as a parameter. The goal is to get this to display a <code>userform</code> complete with a <code>listbox</code> table that would be custom created based off of the text in the rectangle. I know how to do the latter, but I'm blanking on how to get this property from a shape object. I figured it would be something like this?</p>\n\n<pre><code>Sub Rectangle205_Click()\n    facilityName = Me.Text\nEnd Sub\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Sub AMacro(By Ref Target)\n    facilityName = Target.Text\nEnd Sub\n</code></pre>\n\n<p>I am pretty clueless on this one, so your help is appreciated.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529533095, "post_id": 50957682, "comment_id": 88913064, "body": "Will it create multiple separate emails?"}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529533543, "post_id": 50957682, "comment_id": 88913184, "body": "Also where would I implement that loop because I keep getting &quot;Compile error: Wrong number of arguments or invalid property assignment&quot;?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1529535025, "post_id": 50957682, "comment_id": 88913554, "body": "you&#39;ll need to clean up and merge the line below <code>Set = OutMail</code>"}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529536943, "post_id": 50957682, "comment_id": 88913957, "body": "What do you mean &quot;clean up and merge&quot;? I&#39;m new to VBA so if you could explain in more detail that would be great."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1529532100, "creation_date": 1529532100, "answer_id": 50957682, "question_id": 50957566, "link": "https://stackoverflow.com/questions/50957566/pulling-multiple-emails-from-data-table-making-separate-emails-based-on-the-sa/50957682#50957682", "title": "Pulling multiple emails from data table &amp; making separate emails based on the same template", "body": "<p>You should just slightly refactor your code. The macro sending the email should take (at least) the email adress and the subject in parameter: </p>\n\n<pre><code>Sub Mail_experiment(ByVal address As String, ByVal subject As String)\n   Dim OutApp As Outlook.Application\n   Dim OutMail As Outlook.Mailtem\n   Set OutApp = CreateObject(\"Outlook.Application\")\n   Set = OutMail\n   OutApp.CreatItemFromTemplate(\"C:\\Users\\Name\\Documents\\Project\\PO Accrual Support Email Template.oft\")\n   On Error Resume Next\n   With OutMail\n   .To = address '&lt;-- use the input here\n   .CC = \"\"\n   .BC = \"\"\n   .Subject = subject '&lt;-- use the input here\n   .Save\n   End With\n   On Error GoTo 0\n   Set OutMail = Nothing\n   Set OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>Hence, supposing you have the email addresses in the column A and the subjects in the column B (from 1 to 10, for example), you'd just need to call the macro in a loop:</p>\n\n<pre><code>For j = 1 To 10\n    Mail_experiment Range(\"A\" &amp; j), Range(\"B\" &amp; j)\nNext j\n</code></pre>\n\n<p>The above will call the <code>Mail_experiment</code> macro 10 times, each time passing a new parameter (A1 - B1, then A2 - B2 etc.)</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529538060, "post_id": 50958322, "comment_id": 88914205, "body": "what is the sections [ecEmailAdressess = 1] and [ecSubject = 3] achieving?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 1, "creation_date": 1529538502, "post_id": 50958322, "comment_id": 88914300, "body": "You should read <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/enum-statement\" rel=\"nofollow noreferrer\">MSDN Enum Statement</a>.  An enumeration is a way of grouping const integer values.  In the above example <code>ecEmailAdressess </code> would be used to refer to column 1.  <code>Cells(r, ecEmailAdressess )</code> is more descriptive then <code>Cells(r, 1)</code> or  <code>Cells(r, &quot;A&quot;)</code> but all three examples are equivalent."}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529539247, "post_id": 50958322, "comment_id": 88914486, "body": "Oh ok. Will it adapt when more data is added to the table?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 1, "creation_date": 1529539371, "post_id": 50958322, "comment_id": 88914513, "body": "The code loops from 2 to the last used cells in column <code>ecEmailAdressess </code>."}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529540024, "post_id": 50958322, "comment_id": 88914658, "body": "Where should I put this code? The sheet with the table or a module?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529540226, "post_id": 50958322, "comment_id": 88914691, "body": "I prefer using <code>Public Modules</code> over worksheet modules but it will work from either one."}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529540482, "post_id": 50958322, "comment_id": 88914744, "body": "I am receiving a runtime error at [code](getPOAccrualTemplate(MailTo:=.Cells(r, ecEmailAdresses), Subject:=.Cells(r, ecEmailAdresses)).Save). Is it running for you?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529542378, "post_id": 50958322, "comment_id": 88915058, "body": "I tested and updated my answer.  I used two typos from your code to write my answer <code>CreatItemFromTemplate</code> and <code>.BC</code>."}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529593624, "post_id": 50958322, "comment_id": 88940144, "body": "Do you think you could add comments to the code to help me understand what each line does? Just in case I or someone else would need to edit it. Thank you."}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529614845, "post_id": 50958322, "comment_id": 88950718, "body": "Wow! Thank you @TinMan! This helps me a lot."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529614926, "post_id": 50958322, "comment_id": 88950748, "body": "@FinanceGuy :) Happy coding!"}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1533065711, "post_id": 50958322, "comment_id": 90207085, "body": "what is the section <code>Set getPOAccrualTemplate = OutMail</code> doing?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1533071219, "post_id": 50958322, "comment_id": 90209596, "body": "<code>OutMail</code> is the newly created mail item.  <code>Set getPOAccrualTemplate = OutMail</code> is returning the <code>OutMail</code> object as the value of the <code>getPOAccrualTemplate </code> function."}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1533082878, "post_id": 50958322, "comment_id": 90212572, "body": "So it&#39;s not necessarily sending it to Drafts when I run the macro. Do the emails just go to Drafts because when you create an email and don&#39;t send it Outlook defaults the email to Drafts?"}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1533082934, "post_id": 50958322, "comment_id": 90212585, "body": "I am trying to understand it for I want to send the emails to a specific draft folder but I am having a hard time understanding the process. \\"}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 1, "last_activity_date": 1529609903, "last_edit_date": 1529609903, "creation_date": 1529536616, "answer_id": 50958322, "question_id": 50957566, "link": "https://stackoverflow.com/questions/50957566/pulling-multiple-emails-from-data-table-making-separate-emails-based-on-the-sa/50958322#50958322", "title": "Pulling multiple emails from data table &amp; making separate emails based on the same template", "body": "<p>You should create a function that returns a new <code>MailItem</code> based on your template.  In this way, you will be able to test the new <code>MailItem</code> separately without having to run the complete code.</p>\n\n<p>I like to enumerate my excel columns.  This makes it both easier to refer to the correct column and to update the code if the column order is changed.</p>\n\n<pre><code>Option Explicit\n'Enumeration is by defination the action of establishing the number of something\n'I Enumerate my Worksheet Columns to give them a meaningful name that is easy to recognize\nPublic Enum EmailColumns\n    ecEmailAdresses = 1\n    ecSubject = 3\nEnd Enum\n\nPublic Sub SaveEmails()\n    Dim r As Long\n    'The With Statement allows you to \"perform a series of statements on a specified object without specifying the name of the object multiple times\"\n    '.Cells(.Rows.Count, ecEmailAdresses).End(xlUp).Row actually refers to ThisWorkbook.Worksheets(\"Support Emails\").Cells(.Rows.Count, ecEmailAdresses).End(xlUp).Row\n    With ThisWorkbook.Worksheets(\"Support Emails\")\n        '.Cells(): references a cell or range of cells on Worksheets(\"Support Emails\")\n        '.Cells(.Rows.Count, ecEmailAdresses): Refrences the last cell in column 1 of the worksheet\n        '.End(xlUp): Changes the refererence from the last cell to the first used cell above the last cell in column 3\n        '.Cells(.Rows.Count, ecEmailAdresses).End(xlUp).Row: returns the Row number of the last used cell in column 3\n        For r = 2 To .Cells(.Rows.Count, ecEmailAdresses).End(xlUp).Row\n            getPOAccrualTemplate(MailTo:=.Cells(r, ecEmailAdresses), Subject:=.Cells(r, ecEmailAdresses)).Save\n        Next\n    End With\nEnd Sub\n\nPublic Function getPOAccrualTemplate(MailTo As String, Optional CC As String, Optional BCC As String, Optional Subject As String) As Object\n    Const TEMPLATE_PATH As String = \"C:\\Users\\Name\\Documents\\Project\\PO Accrual Support Email Template.oft\"\n    Dim OutApp As Object, OutMail As Object\n    ' CreateObject(\"Outlook.Application\"): Creates an instance of an Outlook Application.\n    ' Outlook.Application.CreateItemFromTemplate returns a new MailItem Based on a saved email template\n    Set OutMail = CreateObject(\"Outlook.Application\").CreateItemFromTemplate(TEMPLATE_PATH)\n\n    With OutMail\n        .To = MailTo\n        .CC = CC\n        .BCC = BCC\n        .Subject = Subject\n    End With\n    'Returns the new MailItem to the caller of the function\n    Set getPOAccrualTemplate = OutMail\n\nEnd Function\n</code></pre>\n\n<h2>Immediate Window Tests</h2>\n\n<pre><code>'Test getPOAccrualTemplate\n' Assign Values to Varaible\nMailTo   = \"ti@stackoverflow.com\"\nCC       = \"efrenreyes@youdontwantnoneson.com\"\nBCC      = \"alexp@gmail.com\"\nSubject  = \"Who is going to the tournament tonight?\"\n'Test Variables using \",\" to insert Tabs between values\n?MailTo, CC, BCC, Subject\n?MailTo;\"-\";CC;\"-\";BCC;\"-\";Subject\n'Pass variables into getPOAccrualTemplate and return a new MailItem based on the template\n'variables created in the immediate window are Variant Type\n'CStr is used to cast the values to Strings\nset OutMail = getPOAccrualTemplate(CStr(MailTo), CStr(CC), CStr(BCC), CStr(Subject))\n'Find out what type of object was returned \n?TypeName(OutMail)\n'Display the Mail Item\nOutMail.Display\n'Test Enumerate Columns\nColumns(EmailColumns.ecEmailAdresses).Select\nColumns(ecSubject).Select\nMailTo   = Cells(2, ecEmailAdresses)\nCC       = \"\"\nBCC      = \"\"\nSubject  = Cells(2, ecSubject)\n'Test the function directly\ngetPOAccrualTemplate(CStr(MailTo), CStr(CC), CStr(BCC), CStr(Subject)).Display\n'Test SaveEmails() Make sure and add a breakpoint \nSaveEmails\n?.Cells(.Rows.Count, ecEmailAdresses).End(xlUp).Row\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tKV6X.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tKV6X.gif\" alt=\"Immediate Window Demo\"></a></p>\n\n<h2>Video Tutorials</h2>\n\n<p>These are two videos from my favorite VBA tutorial series that are relevant:</p>\n\n<ul>\n<li><a href=\"https://www.youtube.com//watch?v=c8reU-H1PKQ&amp;index=5&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 5 - Selecting Cells (Range, Cells, Activecell, End, Offset)</a></li>\n<li><a href=\"https://www.youtube.com//watch?v=d8cfrdUjcuw&amp;index=29&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 26 - Constants and Enumerations (Const, Enum)</a></li>\n</ul>\n"}], "owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 50958322, "answer_count": 2, "score": 0, "last_activity_date": 1592985945, "creation_date": 1529531333, "last_edit_date": 1592985945, "question_id": 50957566, "link": "https://stackoverflow.com/questions/50957566/pulling-multiple-emails-from-data-table-making-separate-emails-based-on-the-sa", "title": "Pulling multiple emails from data table &amp; making separate emails based on the same template", "body": "<p>I am trying to pull email addresses from a column in an Excel Data table and have those email addresses be the receiver of email based on a template.</p>\n\n<p>Code I made below.</p>\n\n<pre><code>Sub Mail_experiment()\n   Dim OutApp As Outlook.Application\n   Dim OutMail As Outlook.Mailtem\n   Set OutApp = CreateObject(\"Outlook.Application\")\n   Set = OutMail\nOutApp.CreatItemFromTemplate(\"C:\\Users\\Name\\Documents\\Project\\PO Accrual Support Email Template.oft\")\nOn Error Resume Next\nWith OutMail\n   .To = \"J.Doe@gmail.com\"\n   .CC = \"\"\n   .BC = \"\"\n   .Subject = \"\"\n   .Save\n\n\nEnd With\nOn Error GoTo 0\nSet OutMail = Nothing\nSet OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>All separate emails will be sent later, hence <code>.Save</code>. Also, I am attempting to pull what would be the subject line of the email from another column in the data table.</p>\n\n<p>How would I achieve both concepts with what I have so far?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529537698, "post_id": 50957667, "comment_id": 88914116, "body": "That&#39;s not Word though?"}, {"owner": {"reputation": 221, "user_id": 9986139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3GfJY.jpg?s=128&g=1", "display_name": "Louie Lee", "link": "https://stackoverflow.com/users/9986139/louie-lee"}, "edited": false, "score": 0, "creation_date": 1573624368, "post_id": 50957667, "comment_id": 103937644, "body": "This will say &quot;Variable not found&quot;"}], "tags": [], "owner": {"reputation": 71, "user_id": 3739820, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001556277133/picture?type=large", "display_name": "user222213", "link": "https://stackoverflow.com/users/3739820/user222213"}, "is_accepted": true, "score": 0, "last_activity_date": 1529541392, "last_edit_date": 1529541392, "creation_date": 1529531995, "answer_id": 50957667, "question_id": 50957565, "link": "https://stackoverflow.com/questions/50957565/there-is-no-wait-method-associated-with-application-in-visualbasic-word/50957667#50957667", "title": "There is no Wait Method associated with Application in VisualBasic Word", "body": "<p>I tried <code>Excel.Application.Wait(Now + TimeValue(\"00:00:03\"))</code> and it worked like a charm!</p>\n"}, {"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 5, "last_activity_date": 1529535048, "creation_date": 1529535048, "answer_id": 50958119, "question_id": 50957565, "link": "https://stackoverflow.com/questions/50957565/there-is-no-wait-method-associated-with-application-in-visualbasic-word/50958119#50958119", "title": "There is no Wait Method associated with Application in VisualBasic Word", "body": "<p>It is best to use External Library references (Early Binding) while developing your code.  Early Binding has the advantages of both intellisense and Help documentation.  A major disadvantage of Early Binding is that it requires the reference to be updated if a different version of the library is installed.  This is way it is best to remove the external references and convert code to Late Binding before distributing it.</p>\n\n<p>Late binding uses <code>CreateObject</code> to import and instantiate a class object. </p>\n\n<pre><code>CreateObject(\"Excel.Application\").Wait (Now + TimeValue(\"00:00:05\"))  \n</code></pre>\n\n<p>Alternatively, you could reference the WinApi <code>Sleep</code> function. </p>\n\n<pre><code>Private Declare Sub Sleep Lib \"kernel32.dll\" (ByVal dwMilliseconds As Long) \n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code> Sleep 3000 '3000 Milliseconds = 3 second delay\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6089190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb5d386ffe3936c1551de98def14f1b?s=128&d=identicon&r=PG&f=1", "display_name": "Pavlo", "link": "https://stackoverflow.com/users/6089190/pavlo"}, "reply_to_user": {"reputation": 1844, "user_id": 10858631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec3bda6220c2c94bad630f8299e5e8af?s=128&d=identicon&r=PG&f=1", "display_name": "Mikev", "link": "https://stackoverflow.com/users/10858631/mikev"}, "edited": false, "score": 0, "creation_date": 1554387886, "post_id": 55517106, "comment_id": 97741389, "body": "explanation has been added"}], "tags": [], "owner": {"reputation": 1, "user_id": 6089190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb5d386ffe3936c1551de98def14f1b?s=128&d=identicon&r=PG&f=1", "display_name": "Pavlo", "link": "https://stackoverflow.com/users/6089190/pavlo"}, "is_accepted": false, "score": 0, "last_activity_date": 1554461969, "last_edit_date": 1554461969, "creation_date": 1554384223, "answer_id": 55517106, "question_id": 50957565, "link": "https://stackoverflow.com/questions/50957565/there-is-no-wait-method-associated-with-application-in-visualbasic-word/55517106#55517106", "title": "There is no Wait Method associated with Application in VisualBasic Word", "body": "<p>This works for me:</p>\n\n<pre><code>Set wsh = VBA.CreateObject(\"WScript.Shell\")\n   Dim waitOnReturn As Boolean: waitOnReturn = True\n   Dim windowStyle As Integer: windowStyle = 0\n   Dim errorCode As Integer\n\n   errorCode = wsh.Run(\"timeout 5\", windowStyle, waitOnReturn)\n</code></pre>\n\n<p>this code allows to run cmd command and wait until execution is finished, in this particular case I am running command \"timeout 5\" which simly wait 5 seconds. \nI've found documentation <a href=\"https://www.vbsedit.com/html/6f28899c-d653-4555-8a59-49640b0e32ea.asp\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 15369909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0QYpz.jpg?s=128&g=1", "display_name": "GlowstickGuy", "link": "https://stackoverflow.com/users/15369909/glowstickguy"}, "is_accepted": false, "score": 1, "last_activity_date": 1615395111, "last_edit_date": 1615395111, "creation_date": 1615394724, "answer_id": 66569208, "question_id": 50957565, "link": "https://stackoverflow.com/questions/50957565/there-is-no-wait-method-associated-with-application-in-visualbasic-word/66569208#66569208", "title": "There is no Wait Method associated with Application in VisualBasic Word", "body": "<p>I use this function in all of my macros that require a paste operation (sometimes paste is too quick and the pc can't copy the selection in time resulting in an error):</p>\n<pre><code>Function Wait(ByVal Seconds As Single)\n    Dim CurrentTimer As Variant\n    CurrentTimer = Timer\n    Do While Timer &lt; CurrentTimer + Seconds\n    Loop\nEnd Function\n</code></pre>\n<p>Then apply the following right before any &quot;Selection.Paste&quot; or &quot;Selection.PasteSpecial&quot;:</p>\n<pre><code>Application.Excel.Wait (Now + TimeValue(&quot;00:00:01&quot;))\n</code></pre>\n<p>You may also have to enable the &quot;ExcelPlugInShell 1.0 Type Library&quot; found in Tools &gt; References to get this to function properly as this uses language not available in MS Word by default.</p>\n"}], "owner": {"reputation": 71, "user_id": 3739820, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001556277133/picture?type=large", "display_name": "user222213", "link": "https://stackoverflow.com/users/3739820/user222213"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5584, "favorite_count": 0, "accepted_answer_id": 50957667, "answer_count": 4, "score": 1, "last_activity_date": 1615395111, "creation_date": 1529531328, "last_edit_date": 1529537887, "question_id": 50957565, "link": "https://stackoverflow.com/questions/50957565/there-is-no-wait-method-associated-with-application-in-visualbasic-word", "title": "There is no Wait Method associated with Application in VisualBasic Word", "body": "<p>I have VBA code to run a particular code and I am trying to pause the next execution by giving it a wait time of 3 seconds using the following line:</p>\n\n<pre><code>Application.Wait (Now + TimeValue(\"00:00:03\"))\n</code></pre>\n\n<p>But I get the following error:</p>\n\n<blockquote>\n  <p>Error: Method or data variable not found</p>\n</blockquote>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9969816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd44818845d90e5b14f67a5dc245e55f?s=128&d=identicon&r=PG&f=1", "display_name": "TLS", "link": "https://stackoverflow.com/users/9969816/tls"}, "edited": false, "score": 0, "creation_date": 1529613664, "post_id": 50969696, "comment_id": 88950236, "body": "Thanks so much for the response! So the VBA definitely works to give me the X of Y ... but I need the result to then show up in my string ... I tried to find a way that I could make it &quot;PageNumber =&quot; and then the VBA so I could insert &quot;PageNumber&quot; into the VBA that I supplied, but couldn&#39;t get it to work. I tried inserting { PAGE } and {NUMPAGES} into my VBA but got an error"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 23, "user_id": 9969816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd44818845d90e5b14f67a5dc245e55f?s=128&d=identicon&r=PG&f=1", "display_name": "TLS", "link": "https://stackoverflow.com/users/9969816/tls"}, "edited": false, "score": 0, "creation_date": 1529653933, "post_id": 50969696, "comment_id": 88961305, "body": "@TLS You can&#39;t make it part of your string. The field codes must be inserted separately. Just put your string &quot;parts&quot; where <code>.TypeText</code> is in the suggestion. There&#39;s no way to make them part of the string so that the field codes are inserted into the Header. If you don&#39;t insert field codes, the page information won&#39;t dynamically update. It is possible to insert some kind of placeholder into your string, write that to the document, then use code <i>after the fact</i> to Find the placeholder and replace it with a field code, but that would make no sense if you&#39;re using VBA anyway..."}, {"owner": {"reputation": 23, "user_id": 9969816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd44818845d90e5b14f67a5dc245e55f?s=128&d=identicon&r=PG&f=1", "display_name": "TLS", "link": "https://stackoverflow.com/users/9969816/tls"}, "edited": false, "score": 0, "creation_date": 1529675161, "post_id": 50969696, "comment_id": 88973281, "body": "Thank you so much!!!! Your comment helped me get it to work. I was looking at it all backwards. Once I moved my string into the page numbering formula, it was perfect!"}], "tags": [], "owner": {"reputation": 107, "user_id": 4548485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nySfS.png?s=128&g=1", "display_name": "Amanda Maring", "link": "https://stackoverflow.com/users/4548485/amanda-maring"}, "is_accepted": true, "score": 1, "last_activity_date": 1529587437, "creation_date": 1529587437, "answer_id": 50969696, "question_id": 50957093, "link": "https://stackoverflow.com/questions/50957093/vba-page-number-in-word-within-text-string/50969696#50969696", "title": "VBA Page Number in Word within text string", "body": "<p>Maybe try this?</p>\n\n<pre><code>ActiveDocument.Sections(ActiveDocument.Sections.Count).Headers(wdHeaderFooterPrimary).Range.Select\n        With Selection\n            .TypeText Text:=\"Page \"\n            .Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:=\"PAGE \", PreserveFormatting:=True\n            .TypeText Text:=\" of \"\n            .Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:=\"NUMPAGES \", PreserveFormatting:=True\n        End With\n</code></pre>\n\n<p>Lines 4 and 6 are inserting the values for you.</p>\n\n<p>You could also try plugging in <code>{ PAGE }</code> and <code>{NUMPAGES}</code> to see if that works. PAGE is the current page; NUMPAGES is the total in the document.</p>\n"}], "owner": {"reputation": 23, "user_id": 9969816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd44818845d90e5b14f67a5dc245e55f?s=128&d=identicon&r=PG&f=1", "display_name": "TLS", "link": "https://stackoverflow.com/users/9969816/tls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 886, "favorite_count": 0, "accepted_answer_id": 50969696, "answer_count": 1, "score": 2, "last_activity_date": 1529653949, "creation_date": 1529529124, "last_edit_date": 1529653949, "question_id": 50957093, "link": "https://stackoverflow.com/questions/50957093/vba-page-number-in-word-within-text-string", "title": "VBA Page Number in Word within text string", "body": "<p>I have never used a question board like this before, so I apologize if I get this wrong ..</p>\n\n<p>I have a word document that I need to insert \"Page X of Y\" with VBA ...but I need to insert it into a string of text. The catch is I need it to be a field, so that it updates if they add more pages to the document</p>\n\n<p>My header looks like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/nKKi7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nKKi7.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>For j = 1 To ActiveDocument.Sections.Count\n    With ActiveDocument.Sections(j)\n       .Headers(wdHeaderFooterPrimary).Range.Text = strfirstline &amp; Chr(9) &amp; \"Section \" &amp; strfileLeft &amp; Chr(13) _\n       &amp; strsecondline &amp; Chr(9) &amp; \"Page \" &amp; \"WHAT DO I PUT HERE\" &amp; \" of \" &amp; \"WHAT DO I PUT HERE\" &amp; Chr(13) _\n       &amp; strthirdline &amp; Chr(9) &amp; strthirddate &amp; Chr(13) _\n    &amp; strfourthline &amp; Chr(9) &amp; \"Issued for \" &amp; strissuedfor &amp; Chr(13) &amp; Chr(13)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1529530335, "post_id": 50957087, "comment_id": 88912081, "body": "Looks like <code>.Count</code> is worth <code>2</code> when you resize <code>Range(&quot;D14&quot;)</code>. While we&#39;re at it, why are you resizing <code>Range(&quot;D14&quot;)</code>?"}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1529530583, "post_id": 50957087, "comment_id": 88912163, "body": "To be honest I am not quiet sure -  I got the code sample from here and have tried to adapt it to my needs with limited success.  I just took that piece out and like magic it works as intended.  Thank you :)"}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "is_accepted": false, "score": 1, "last_activity_date": 1529530801, "creation_date": 1529530801, "answer_id": 50957447, "question_id": 50957087, "link": "https://stackoverflow.com/questions/50957087/ranged14-is-pasting-twice-into-d14-and-d15/50957447#50957447", "title": "Range(&quot;D14&quot;) is pasting twice, into D14 and D15.", "body": "<p>The end solution, for me in this instance, was  cybernetic.nomad's comment. </p>\n\n<p>I changed </p>\n\n<pre><code>wbTo.Sheets(\"Sheet1\").Range(\"D14\").Resize(.Count).Value = lAnswer3  'D14 and D15 get populated\n</code></pre>\n\n<p>to</p>\n\n<pre><code>wbTo.Sheets(\"Sheet1\").Range(\"D14\").Value = lAnswer3  'D14 and D15 get populated\n</code></pre>\n\n<p>and my duplication issue was resolved. </p>\n"}], "owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529530801, "creation_date": 1529529104, "question_id": 50957087, "link": "https://stackoverflow.com/questions/50957087/ranged14-is-pasting-twice-into-d14-and-d15", "title": "Range(&quot;D14&quot;) is pasting twice, into D14 and D15.", "body": "<p>For some reason this is being inserted into two cells when it should be only one. </p>\n\n<p>Instead of it just pasting a value into D14, it also pastes the same value in D15.</p>\n\n<p>My end goal here is to read an entire column and get all unique values within that column, minus the header, and get the speed.  So it may have 1 Gpbs, or 200 Mbps.  If it is 1 Gig, I want to strip off the 'gbps' and turn the 1 into 1000.  The data is basically a bunch of empty rows with an alphanumeric speed value. In this instance only one row value exists. so the data below is how it is in the sheet. </p>\n\n<pre><code>Dim Clb As Range\nDim lAnswer3 As Variant\nWith CreateObject(\"scripting.dictionary\")\n    For Each Clb In wbFrom.Sheets(\"Sheet0\").Range(\"Z9\", Range(\"Z\" &amp; Rows.Count).End(xlUp))\n\n        Clb.Value = Replace(Clb.Value, \" Mbps\", \"\")\n        Clb.Value = Replace(Clb.Value, \" Gbps\", \"\")\n\n       If Clb.Value = 1 Then\n            Clb = Clb * 1000\n        End If\n\n\n        If Not .exists(Clb.Value) Then\n        .Add Clb.Value, Nothing\n        End If\n    Next Clb\n\n lAnswer3 = wbFrom.Sheets(\"Sheet0\").Evaluate(\"SUMPRODUCT(--z9:z50000)\")\n\n wbTo.Sheets(\"Sheet1\").Range(\"D14\").Resize(.Count).Value = lAnswer3  'D14 and D15 get populated\n\nEnd With\n</code></pre>\n\n<p>Data:</p>\n\n<pre><code>NetSpeed\n&lt;blank row&gt;\n&lt;blank row&gt;\n&lt;blank row&gt;\n&lt;blank row&gt;\n&lt;blank row&gt;\n1 Gbps\n&lt;blank row&gt;\n&lt;blank row&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1529529058, "post_id": 50957038, "comment_id": 88911556, "body": "<code>&amp;</code> isn&#39;t <code>And</code> --  it is for string concatenation, not logical conjunction."}, {"owner": {"reputation": 3, "user_id": 9969738, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PwQOTxH-hUA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UgGA5h5Hlc2D3HHA2Fd3BwtI6Hg/mo/photo.jpg?sz=128", "display_name": "Caleb Griffie", "link": "https://stackoverflow.com/users/9969738/caleb-griffie"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1529529818, "post_id": 50957038, "comment_id": 88911868, "body": "Perfect. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "is_accepted": true, "score": 0, "last_activity_date": 1529529390, "creation_date": 1529529390, "answer_id": 50957146, "question_id": 50957038, "link": "https://stackoverflow.com/questions/50957038/vba-error-type-mismatch-using-booleans/50957146#50957146", "title": "vba error: type mismatch using booleans", "body": "<p>You logical AND instead of &amp; which is used for string concatenation.</p>\n\n<pre><code>If blActive AND _\n    blNA AND _\n    (blSeason1 Or blSeason2 Or blSeason3 Or blSeason4 Or blSeason5 Or blSeason6) AND _\n    blDrop AND blSMUDrop AND blPromoDrop AND blPromoNBR AND _\n    (blUSWS Or blUSMSRP Or blFOB) _\nThen\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9969738, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PwQOTxH-hUA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2UgGA5h5Hlc2D3HHA2Fd3BwtI6Hg/mo/photo.jpg?sz=128", "display_name": "Caleb Griffie", "link": "https://stackoverflow.com/users/9969738/caleb-griffie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 50957146, "answer_count": 1, "score": 0, "last_activity_date": 1529529390, "creation_date": 1529528829, "last_edit_date": 1531164843, "question_id": 50957038, "link": "https://stackoverflow.com/questions/50957038/vba-error-type-mismatch-using-booleans", "title": "vba error: type mismatch using booleans", "body": "<p>I am copying over rows that match a criteria from one sheet to another. I set up a bunch of Boolean statements in my for loop to make my if statement a little cleaner and because I will be doing a couple elseif's. I am getting a Type mismatch error in my if statement. Any ideas?</p>\n\n<p>VBA Code:</p>\n\n<pre><code>Dim blActive As Boolean\nDim blSeason1 As Boolean\nDim blSeason2 As Boolean\nDim blSeason3 As Boolean\nDim blSeason4 As Boolean\nDim blSeason5 As Boolean\nDim blSeason6 As Boolean\nDim blNA As Boolean\nDim blInter As Boolean\nDim blGlobal As Boolean\nDim blDrop As Boolean\nDim blSMUDrop As Boolean\nDim blPromoDrop As Boolean\nDim blPromoNBR As Boolean\nDim blUSWS As Boolean\nDim blUSMSRP As Boolean\nDim blCanWS As Boolean\nDim blCanMSRP As Boolean\nDim blFOB As Boolean\n\nFor i = 2 To lRow_Spec\n\n'Check if Forecast Season = \"ACTIVE\",\nblActive = (Worksheets(\"Item_Spec_Data\").Cells(i, 1).Value = \"ACTIVE\")\n'Check for All 6 seasons Seasons(based on \"Buy Ready missing info Seasons\"\nblSeason1 = (Worksheets(\"Item_Spec_Data\").Cells(i, 2).Value = Worksheets(mySheet).Cells(35, 2).Value)\nblSeason2 = (Worksheets(\"Item_Spec_Data\").Cells(i, 2).Value = Worksheets(mySheet).Cells(35, 3).Value)\nblSeason3 = (Worksheets(\"Item_Spec_Data\").Cells(i, 2).Value = Worksheets(mySheet).Cells(35, 4).Value)\nblSeason4 = (Worksheets(\"Item_Spec_Data\").Cells(i, 2).Value = Worksheets(mySheet).Cells(35, 5).Value)\nblSeason5 = (Worksheets(\"Item_Spec_Data\").Cells(i, 2).Value = Worksheets(mySheet).Cells(35, 6).Value)\nblSeason6 = (Worksheets(\"Item_Spec_Data\").Cells(i, 2).Value = Worksheets(mySheet).Cells(35, 7).Value)\n'Check which Distribution it is (NA, Global,International) Have to break this out b/c each area has different blank checks\nblNA = (Worksheets(\"Item_Spec_Data\").Cells(i, 5).Value = Worksheets(mySheet).Cells(24, 9).Value)\nblInter = (Worksheets(\"Item_Spec_Data\").Cells(i, 5).Value = Worksheets(mySheet).Cells(24, 11).Value)\nblGlobal = (Worksheets(\"Item_Spec_Data\").Cells(i, 5).Value = Worksheets(mySheet).Cells(24, 13).Value)\n'Checking that status is not irrelevant\nblDrop = (Worksheets(\"Item_Spec_Data\").Cells(i, 3).Value = \"Drop\")\nblSMUDrop = (Worksheets(\"Item_Spec_Data\").Cells(i, 3).Value = \"SMU Drop\")\nblPromoDrop = (Worksheets(\"Item_Spec_Data\").Cells(i, 3).Value = \"Promo Drop\")\nblPromoNBR = (Worksheets(\"Item_Spec_Data\").Cells(i, 3).Value = \"Promo-NBR\")\n'Checking for Blanks US WS, US MSRP, Can WS, Can MSRP, FOB\nblUSWS = (Worksheets(\"Item_Spec_Data\").Cells(i, 22).Value = \" \")\nblUSMSRP = (Worksheets(\"Item_Spec_Data\").Cells(i, 23).Value = \" \")\nblCanWS = (Worksheets(\"Item_Spec_Data\").Cells(i, 24).Value = \" \")\nblCanMSRP = (Worksheets(\"Item_Spec_Data\").Cells(i, 25).Value = \" \")\nblFOB = (Worksheets(\"Item_Spec_Data\").Cells(i, 26).Value = \" \")\n\nIf blActive &amp; _\n    blNA &amp; _\n    (blSeason1 Or blSeason2 Or blSeason3 Or blSeason4 Or blSeason5 Or blSeason6) &amp; _\n    blDrop &amp; blSMUDrop &amp; blPromoDrop &amp; blPromoNBR &amp; _\n    (blUSWS Or blUSMSRP Or blFOB) _\nThen\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1529529800, "post_id": 50957011, "comment_id": 88911859, "body": "You don&#39;t need to <code>Select</code>. Try <code>Range(&quot;B9&quot;).EntireRow.Resize(Range(&quot;B4&quot;).Value).Insert CopyOrigin:=xlFormatFromRightOrBelow</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1529539276, "creation_date": 1529539276, "answer_id": 50958622, "question_id": 50957011, "link": "https://stackoverflow.com/questions/50957011/vba-insert-number-of-rows-based-on-cell-value/50958622#50958622", "title": "VBA: Insert number of rows based on cell value", "body": "<p>You can use <code>Resize</code> to do that, and you don't need to <code>Select</code> at all. </p>\n\n<pre><code>Range(\"B9\").EntireRow.Resize(Range(\"B4\").Value).Insert CopyOrigin:=xlFormatFromRightOrBelow\n</code></pre>\n\n<p>Also, you should avoid <code>ActiveSheet</code> \u2014 instead, fully qualify the sheet using <code>Sheets(\"YourSheetName\")</code> or a variable referencing the sheet in question.</p>\n"}], "owner": {"reputation": 33, "user_id": 9882821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7be3b40a026d688717013c8cb027b6a?s=128&d=identicon&r=PG&f=1", "display_name": "arobNYC", "link": "https://stackoverflow.com/users/9882821/arobnyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "accepted_answer_id": 50958622, "answer_count": 1, "score": 0, "last_activity_date": 1529539276, "creation_date": 1529528727, "question_id": 50957011, "link": "https://stackoverflow.com/questions/50957011/vba-insert-number-of-rows-based-on-cell-value", "title": "VBA: Insert number of rows based on cell value", "body": "<p>Looking for a way to insert X rows above cell B9 in my workbook. The value of X will change and can be found in cell B4. This seems very simple, but I can't get this portion of my code to work. </p>\n\n<pre><code>ActiveSheet.Range(\"B9\").Select\nSelection.EntireRow.Insert.Cells(\"B4\"), CopyOrigin:=xlFormatFromRightOrBelow\n</code></pre>\n\n<p></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9926434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EZURYcCnAWY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3wmsmPs022bWcK5-YFCl2eE9FszQ/mo/photo.jpg?sz=128", "display_name": "AnneMarie Margaret Minniti", "link": "https://stackoverflow.com/users/9926434/annemarie-margaret-minniti"}, "edited": false, "score": 0, "creation_date": 1529530594, "post_id": 50957077, "comment_id": 88912169, "body": "When I try to run the code with this addition I am getting a compile error for an &quot;invalid qualifier&quot; in regards to Cells(Rows.Count,Col(i)) in the calculation for lastRow. Any suggestions as to why this is occurring?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 9926434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EZURYcCnAWY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3wmsmPs022bWcK5-YFCl2eE9FszQ/mo/photo.jpg?sz=128", "display_name": "AnneMarie Margaret Minniti", "link": "https://stackoverflow.com/users/9926434/annemarie-margaret-minniti"}, "edited": false, "score": 0, "creation_date": 1529533308, "post_id": 50957077, "comment_id": 88913115, "body": "@AnneMarieMargaretMinniti the parens are off: <code>Set DataRange = Worksheet(12).Range(Cells(2,Col(i)),Cells(lastRow,Col(i))</code>"}, {"owner": {"reputation": 281, "user_id": 2857338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5e21d7f25573f28a85b386a3befa29?s=128&d=identicon&r=PG&f=1", "display_name": "BLitE.exe", "link": "https://stackoverflow.com/users/2857338/blite-exe"}, "edited": false, "score": 0, "creation_date": 1529576828, "post_id": 50957077, "comment_id": 88928733, "body": "I edited my answer.   Try to add an additional &quot;)&quot;  after the first cell.   Set DataRange = Worksheet(12).Range(Cells(2,Col(i)),Cells(lastRow,Col(i)))"}, {"owner": {"reputation": 13, "user_id": 9926434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EZURYcCnAWY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3wmsmPs022bWcK5-YFCl2eE9FszQ/mo/photo.jpg?sz=128", "display_name": "AnneMarie Margaret Minniti", "link": "https://stackoverflow.com/users/9926434/annemarie-margaret-minniti"}, "edited": false, "score": 0, "creation_date": 1529589224, "post_id": 50957077, "comment_id": 88936842, "body": "I have added the parentheses but am still getting the invalid qualifier error for lastRow."}, {"owner": {"reputation": 281, "user_id": 2857338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5e21d7f25573f28a85b386a3befa29?s=128&d=identicon&r=PG&f=1", "display_name": "BLitE.exe", "link": "https://stackoverflow.com/users/2857338/blite-exe"}, "edited": false, "score": 0, "creation_date": 1529589356, "post_id": 50957077, "comment_id": 88936937, "body": "Did you try to add a Dim lastRow as Integer on the initial part of your sub?"}, {"owner": {"reputation": 13, "user_id": 9926434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EZURYcCnAWY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3wmsmPs022bWcK5-YFCl2eE9FszQ/mo/photo.jpg?sz=128", "display_name": "AnneMarie Margaret Minniti", "link": "https://stackoverflow.com/users/9926434/annemarie-margaret-minniti"}, "edited": false, "score": 0, "creation_date": 1529591116, "post_id": 50957077, "comment_id": 88938343, "body": "I did and unfortunately that did not help. The error is for &quot;Rows&quot; specifically in the code"}, {"owner": {"reputation": 281, "user_id": 2857338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5e21d7f25573f28a85b386a3befa29?s=128&d=identicon&r=PG&f=1", "display_name": "BLitE.exe", "link": "https://stackoverflow.com/users/2857338/blite-exe"}, "edited": false, "score": 0, "creation_date": 1529592230, "post_id": 50957077, "comment_id": 88939143, "body": "You need to add &quot;s&quot; on you worksheet.    Set DataRange = Worksheets(12).Range(Cells(2,Col(i)),Cells(lastRow,Col(i)))"}, {"owner": {"reputation": 13, "user_id": 9926434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EZURYcCnAWY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3wmsmPs022bWcK5-YFCl2eE9FszQ/mo/photo.jpg?sz=128", "display_name": "AnneMarie Margaret Minniti", "link": "https://stackoverflow.com/users/9926434/annemarie-margaret-minniti"}, "edited": false, "score": 0, "creation_date": 1529600912, "post_id": 50957077, "comment_id": 88944372, "body": "I added the additional if statement and that did what I needed! Thank you - I appreciate the help."}], "tags": [], "owner": {"reputation": 281, "user_id": 2857338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5e21d7f25573f28a85b386a3befa29?s=128&d=identicon&r=PG&f=1", "display_name": "BLitE.exe", "link": "https://stackoverflow.com/users/2857338/blite-exe"}, "is_accepted": true, "score": 0, "last_activity_date": 1529592266, "last_edit_date": 1529592266, "creation_date": 1529529079, "answer_id": 50957077, "question_id": 50956950, "link": "https://stackoverflow.com/questions/50956950/vba-used-range-for-specific-columns-minus-the-header/50957077#50957077", "title": "VBA used range for specific columns minus the header", "body": "<p>What you need to do is don't use the Usedrange in initializing your DataRange to except the Header Row. </p>\n\n<p>You can do something like this. </p>\n\n<pre><code>For i = 1 To 11\n    lastRow = Worksheets(12).Cells(Rows.Count, col(i)).End(xlup).Row 'This is to find the last used row for the certain column. \n\n    Set DataRange = Worksheets(12).Range(Cells(2,Col(i)),Cells(lastRow,Col(i)))\nNext i \n</code></pre>\n\n<p>Now you will have the specific range that you want.</p>\n\n<p>Another thing that you can do to achieve your goal is to add an additional if statement for your range to check if the cell's row is the header. </p>\n\n<pre><code>For i = 1 To 11\n\nSet DataRange = Worksheets(12).UsedRange.Columns(Col(i))\n\n    For Each cell In DataRange.Cells\n        If cell.Row &gt; 1 then\n            ReDim Preserve myArray(x)\n            myArray(x) = cell.Value\n            x = x + 1\n        End if\n   Next cell\n\n Next i\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9926434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EZURYcCnAWY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3wmsmPs022bWcK5-YFCl2eE9FszQ/mo/photo.jpg?sz=128", "display_name": "AnneMarie Margaret Minniti", "link": "https://stackoverflow.com/users/9926434/annemarie-margaret-minniti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1423, "favorite_count": 0, "accepted_answer_id": 50957077, "answer_count": 1, "score": 0, "last_activity_date": 1529592266, "creation_date": 1529528458, "question_id": 50956950, "link": "https://stackoverflow.com/questions/50956950/vba-used-range-for-specific-columns-minus-the-header", "title": "VBA used range for specific columns minus the header", "body": "<p>I am trying to create an array using a loop and the used range function in vba. However, I only want the used range for specific columns and without the headers (1st row of each column). The code I have is below - I am not certain how to find everything except for the 1st row. </p>\n\n<p>Thanks.</p>\n\n<pre><code>Col(1) = 9\nCol(2) = 11\nCol(3) = 13\nCol(4) = 15\nCol(5) = 17\nCol(6) = 19\nCol(7) = 21\nCol(8) = 23\nCol(9) = 25\nCol(10) = 27\nCol(11) = 29\n\nDim myArray() As Variant, myArray2() As Variant\nDim DataRange As Range\nDim cell As Range\nDim x As Long\n\nFor i = 1 To 11\n\n    Set DataRange = Worksheets(12).UsedRange.Columns(Col(i))\n\n        For Each cell In DataRange.Cells\n            ReDim Preserve myArray(x)\n            myArray(x) = cell.Value\n            x = x + 1\n       Next cell\n\nNext i\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1529528492, "post_id": 50956934, "comment_id": 88911353, "body": "<code>Range(&quot;E2&quot;).value = Left(Range(&quot;D2&quot;),3)</code>"}, {"owner": {"reputation": 1, "user_id": 9969748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14308f280e3dc7e9efcbf3f959395b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/9969748/raj"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1529531321, "post_id": 50956934, "comment_id": 88912459, "body": "Scott, how do I make the statement if column D has a cell range value from D2 through D whatever, since the data is going to be dynamic on a daily basis, the cell range of column D could vary from 200 to 2000."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1529531404, "post_id": 50956934, "comment_id": 88912492, "body": "google how to find the last row and loop through the cells in a column."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1529533604, "post_id": 50956934, "comment_id": 88913200, "body": "<a href=\"https://stackoverflow.com/a/42103873/6706419\">Find last row and loop through range</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1529758347, "last_edit_date": 1529758347, "creation_date": 1529560483, "answer_id": 50961267, "question_id": 50956934, "link": "https://stackoverflow.com/questions/50956934/vba-left-function/50961267#50961267", "title": "VBA =Left() Function", "body": "<p>Maybe something like this. Code is untested (written on mobile).</p>\n\n<pre><code>Option Explicit\n\nSub extractCountries()\n    Dim arrayOfValues() as variant\n    Dim lastRow as long\n    Dim rowIndex as long\n    'Change these four lines as needed ' \n    Const SOURCE_COLUMN as string = \"D\"\n    Const DESTINATION_COLUMN as string = \"E\"\n    Const ROW_TO_START_FROM as long = 1\n    With thisworkbook.worksheets(\"Sheet1\")\n        lastRow = .cells(.rows.count, SOURCE_COLUMN).end(xlup).row\n        arrayOfValues = .range(SOURCE_COLUMN &amp; ROW_TO_START_FROM \":\" &amp; SOURCE_COLUMN &amp; lastRow).value2\n        For rowIndex = lbound(arrayOfValues,1) to ubound(arrayOfValues,1)\n            arrayOfValues(rowIndex,1) = vba.strings.left$(arrayOfValues(rowIndex,1),3)\n            'If the logic should be \"everything before the comma\", use instr() function above.'\n        Next rowIndex\n        .range(DESTINATION_COLUMN &amp; ROW_TO_START_FROM \":\" &amp; DESTINATION_COLUMN &amp; lastRow).value2 = arrayOfValues\n    End with\nEnd sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 8696548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70d3d95f34169c965799259986fb1958?s=128&d=identicon&r=PG&f=1", "display_name": "ARN", "link": "https://stackoverflow.com/users/8696548/arn"}, "is_accepted": false, "score": 0, "last_activity_date": 1562399905, "creation_date": 1562399905, "answer_id": 56912282, "question_id": 50956934, "link": "https://stackoverflow.com/questions/50956934/vba-left-function/56912282#56912282", "title": "VBA =Left() Function", "body": "<p>Use like this</p>\n\n<pre><code>Dim s As String = \"USA, TX\"\ns = Strings.Left(s, 3)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9969748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14308f280e3dc7e9efcbf3f959395b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/9969748/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 297, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562399905, "creation_date": 1529528374, "last_edit_date": 1529528425, "question_id": 50956934, "link": "https://stackoverflow.com/questions/50956934/vba-left-function", "title": "VBA =Left() Function", "body": "<p>Lets keep it simple and avoid computer talk</p>\n\n<p>Here's my data</p>\n\n<pre><code>Source location is Column D = \"USA, TX\"\nDestination Location is Column E.\n</code></pre>\n\n<p>I need to get the country \"USA\" into Column E from Column D. In simple basic formula it would be </p>\n\n<pre><code>=Left(D,3)\n</code></pre>\n\n<p>But what is this in VBA?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1529589553, "post_id": 50956746, "comment_id": 88937097, "body": "Is scraping allowed for this site? Also, there is an API <a href=\"https://www.census.gov/data/developers/data-sets/acs-5year.html\" rel=\"nofollow noreferrer\">census.gov/data/developers/data-sets/acs-5year.html</a>"}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1529600212, "post_id": 50956746, "comment_id": 88944006, "body": "What is the problem you are trying to solve?"}, {"owner": {"reputation": 39, "user_id": 9969556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea01a120f70769b881010175c5c6643?s=128&d=identicon&r=PG&f=1", "display_name": "Slayerxx128", "link": "https://stackoverflow.com/users/9969556/slayerxx128"}, "edited": false, "score": 0, "creation_date": 1529604783, "post_id": 50956746, "comment_id": 88946331, "body": "Trying to click the go button, I haven&#39;t been able to get it to work."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9969556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea01a120f70769b881010175c5c6643?s=128&d=identicon&r=PG&f=1", "display_name": "Slayerxx128", "link": "https://stackoverflow.com/users/9969556/slayerxx128"}, "edited": false, "score": 0, "creation_date": 1529529169, "post_id": 50956883, "comment_id": 88911603, "body": "Thank you for the answer. I have linked the website Im trying to use. I hope this can help you out. I tried running the code and it did not work. It looks like the span repeats a few times through out the code I counted 4 times so I put a 3 instead of the 0 and ran that with no luck. <a href=\"https://factfinder.census.gov/faces/nav/jsf/pages/community_facts.xhtml\" rel=\"nofollow noreferrer\">factfinder.census.gov/faces/nav/jsf/pages/community_facts.xh&zwnj;&#8203;tml</a>"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 39, "user_id": 9969556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea01a120f70769b881010175c5c6643?s=128&d=identicon&r=PG&f=1", "display_name": "Slayerxx128", "link": "https://stackoverflow.com/users/9969556/slayerxx128"}, "edited": false, "score": 0, "creation_date": 1529588466, "post_id": 50956883, "comment_id": 88936336, "body": "Your provided html do not match with the one connected to the <code>GO</code> button in that webpage @Slayerxx128."}, {"owner": {"reputation": 281, "user_id": 2857338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5e21d7f25573f28a85b386a3befa29?s=128&d=identicon&r=PG&f=1", "display_name": "BLitE.exe", "link": "https://stackoverflow.com/users/2857338/blite-exe"}, "edited": false, "score": 0, "creation_date": 1529588790, "post_id": 50956883, "comment_id": 88936552, "body": "You must know what is the index of that specific span.   To help you what index is that span. You can try to use Debug.print spanElement(indexNumber).innerText.   Now it can help you out if you are targeting that specific class."}, {"owner": {"reputation": 39, "user_id": 9969556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea01a120f70769b881010175c5c6643?s=128&d=identicon&r=PG&f=1", "display_name": "Slayerxx128", "link": "https://stackoverflow.com/users/9969556/slayerxx128"}, "edited": false, "score": 0, "creation_date": 1529590227, "post_id": 50956883, "comment_id": 88937618, "body": "Ill try this out. I understand what your saying. Just trying to figure out how to add it into the code. I&#39;m a noob at this stuff so its a learning curve for me. @BLitE.exe"}], "tags": [], "owner": {"reputation": 281, "user_id": 2857338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5e21d7f25573f28a85b386a3befa29?s=128&d=identicon&r=PG&f=1", "display_name": "BLitE.exe", "link": "https://stackoverflow.com/users/2857338/blite-exe"}, "is_accepted": false, "score": 0, "last_activity_date": 1529528089, "creation_date": 1529528089, "answer_id": 50956883, "question_id": 50956746, "link": "https://stackoverflow.com/questions/50956746/trying-to-get-vba-to-click-a-button-on-a-web-page/50956883#50956883", "title": "Trying to get VBA to click a button on a web page", "body": "<p>One thing that you need to do here.</p>\n\n<p>Is to traverse into the HTML Element itself. </p>\n\n<p>You have two options depending in the structure of the site. </p>\n\n<p>But based on the given Screen shot. I will assume that this is the hierarchy or the structure of the site. </p>\n\n<p>One thing that you need to do here is to go the inner class of the span tag which is \"button-g\" then to the AutoCompleteGoButton class. </p>\n\n<pre><code>Dim spanElement as Object, buttonElement as Object\n\nSet spanElement = IE.document.getElementsByClassName(\"button-g\")\nSet buttonElement = spanElement(0).getElementsByClassName(\"AutoCompleteGoButton\")\n\nbuttonElement(0).Click\n</code></pre>\n\n<p>Please take note that (0) is the index number of that element. Assuming that these elements are the only HTML Elements having these class names on the webpage.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 9969556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea01a120f70769b881010175c5c6643?s=128&d=identicon&r=PG&f=1", "display_name": "Slayerxx128", "link": "https://stackoverflow.com/users/9969556/slayerxx128"}, "edited": false, "score": 0, "creation_date": 1529588662, "post_id": 50957585, "comment_id": 88936467, "body": "Thank you for the information. I tried what you recommended and it still did not work. I do have the wait time in my code. I keep getting a run error 424."}, {"owner": {"reputation": 39, "user_id": 9969556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea01a120f70769b881010175c5c6643?s=128&d=identicon&r=PG&f=1", "display_name": "Slayerxx128", "link": "https://stackoverflow.com/users/9969556/slayerxx128"}, "edited": false, "score": 0, "creation_date": 1529589464, "post_id": 50957585, "comment_id": 88937029, "body": "No I cannot. When I go onto the website the HTML is different. I also added the code above maybe that will help."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39, "user_id": 9969556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea01a120f70769b881010175c5c6643?s=128&d=identicon&r=PG&f=1", "display_name": "Slayerxx128", "link": "https://stackoverflow.com/users/9969556/slayerxx128"}, "edited": false, "score": 0, "creation_date": 1529589521, "post_id": 50957585, "comment_id": 88937069, "body": "The HTML also changed for me. And then later, access was denied."}, {"owner": {"reputation": 39, "user_id": 9969556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea01a120f70769b881010175c5c6643?s=128&d=identicon&r=PG&f=1", "display_name": "Slayerxx128", "link": "https://stackoverflow.com/users/9969556/slayerxx128"}, "edited": false, "score": 1, "creation_date": 1529682215, "post_id": 50957585, "comment_id": 88977482, "body": "Thank you so much! I just ran your code and it worked perfectly! @QHarr"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1529599912, "last_edit_date": 1529599912, "creation_date": 1529531450, "answer_id": 50957585, "question_id": 50956746, "link": "https://stackoverflow.com/questions/50956746/trying-to-get-vba-to-click-a-button-on-a-web-page/50957585#50957585", "title": "Trying to get VBA to click a button on a web page", "body": "<p>Try</p>\n\n<pre><code>IE.document.getElementById(\"communityfactssubmit\").Click\n</code></pre>\n\n<p>As there appears to be an id you can use:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FJmzi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FJmzi.png\" alt=\"HTML\"></a></p>\n\n<p>This is using the <a href=\"https://factfinder.census.gov/faces/nav/jsf/pages/community_facts.xhtml\" rel=\"nofollow noreferrer\">link</a> you provided, which unlike the HTML you show, does have an Id for this button.</p>\n\n<p>If the element is not immediately found make sure you are waiting until page has loaded with:</p>\n\n<pre><code>While IE.Busy Or IE.readyState &lt; 4: DoEvents: Wend\n</code></pre>\n\n<p>Before attempting the click.</p>\n\n<p>You can add additional wait time with </p>\n\n<pre><code>Application.Wait Now + TimeSerial(0,0,2) '&lt;==replace 2 with number of seconds to wait\n</code></pre>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>I just tested the following full script successfully:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    With IE\n        .Visible = True\n        .navigate \"https://factfinder.census.gov/faces/nav/jsf/pages/index.xhtml\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend '&lt;== Loop until loaded\n\n         .document.querySelector(\"#cfmainsearchform &gt; a\").Click\n\n         STOP '&lt;== Delete me later\n        'Quit '&lt;== Remember to quit application\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Better option: Use the free API</strong></p>\n\n<p>I would also highly recommend first using the Fact Finder to explore data of interest and note specific variables/datatables of interest and then moving to using the API to handle these requests. It will be faster and cleaner.</p>\n\n<p>There are a series of tutorials on how to use this API <a href=\"https://github.com/uscensusbureau/Census_Academy/tree/master/Courses/01_API_Introduction\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Dataset info <a href=\"https://www.census.gov/data/developers/data-sets/acs-5year.html\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 39, "user_id": 9969556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea01a120f70769b881010175c5c6643?s=128&d=identicon&r=PG&f=1", "display_name": "Slayerxx128", "link": "https://stackoverflow.com/users/9969556/slayerxx128"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1025, "favorite_count": 0, "accepted_answer_id": 50957585, "answer_count": 2, "score": 0, "last_activity_date": 1529600196, "creation_date": 1529527420, "last_edit_date": 1531164843, "question_id": 50956746, "link": "https://stackoverflow.com/questions/50956746/trying-to-get-vba-to-click-a-button-on-a-web-page", "title": "Trying to get VBA to click a button on a web page", "body": "<p>Im looking for assistance completing this code for clicking a 'GO' button on a web page. </p>\n\n<p>Here is the code from the website</p>\n\n<pre><code>&lt;span class=\"button-g\"&gt;\n   &lt;a href=\"class=\" autoCompleteGoButton\" Style=\"margin:0 0 0 10px;\"onclick=\"javascript:cfMainFormSubmit();\"&gt;go&lt;/a&gt;\n&lt;/span&gt;\n</code></pre>\n\n<p>Here is the code that I have been trying work with.</p>\n\n<pre><code>'click the 'go' button\nSet objInputs = IE.document.getElementsByTagName(\"a\")\nFor Each ele In objInputs\nIf ele.Class Like \"autoCompleteGoButton\" Then\n    ele.Click\nEnd If\nNext\n</code></pre>\n\n<p>Here is the code that I'm using maybe this will help.</p>\n\n<pre><code>'start a new subroutine called SearchBot\nSub SearchBot()\n\n    'dimension (declare or set aside memory for) our variables\n    Dim objIE As InternetExplorer 'special object variable representing the IE browser\n    Dim aEle As HTMLLinkElement 'special object variable for an &lt;a&gt; (link) element\n    Dim y As Integer 'integer variable we'll use as a counter\n    Dim result As String 'string variable that will hold our result link\n\n    'initiating a new instance of Internet Explorer and asigning it to objIE\n    Set objIE = New InternetExplorer\n\n    'make IE browser visible (False would allow IE to run in the background)\n    objIE.Visible = True\n\n    'navigate IE to this web page (a pretty neat search engine really)\n    objIE.navigate \"https://factfinder.census.gov/faces/nav/jsf/pages/index.xhtml\"\n\n    'wait here a few seconds while the browser is busy\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n    'in the search box put cell \"A2\" value, the word \"in\" and cell \"C1\" value\n    objIE.document.getElementById(\"cfsearchtextboxmain\").Value = _\n      Sheets(\"Sheet1\").Range(\"B3\").Value &amp; \", \" &amp; Sheets(\"Sheet1\").Range(\"B4\").Value\n\n    'click the 'go' button\n     IE.document.getElementById(\"communityfactssubmit\").Click\n\n    'wait again for the browser\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8809948, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214995769515744/picture?type=large", "display_name": "Yash Shah", "link": "https://stackoverflow.com/users/8809948/yash-shah"}, "edited": false, "score": 0, "creation_date": 1529527559, "post_id": 50956594, "comment_id": 88910928, "body": "The var rate = time/24 is used for some other function.. And I can&#39;t change this logic because it is applied to a very large Program. Can we do something like if the time is between 1-59 min it displays/give us the output as 1 hour"}, {"owner": {"reputation": 1, "user_id": 8809948, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214995769515744/picture?type=large", "display_name": "Yash Shah", "link": "https://stackoverflow.com/users/8809948/yash-shah"}, "edited": false, "score": 0, "creation_date": 1529586882, "post_id": 50956594, "comment_id": 88935224, "body": "Thank you @Randomness Slayer.  I haven&#39;t coded this, My company&#39;s coder has and I am just debugging the errors. :p. I&quot;ll try and look into this logic, whether it will apply on the code or no. and thanks again"}], "tags": [], "owner": {"reputation": 471, "user_id": 5065400, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PD5k4jwEt9M/AAAAAAAAAAI/AAAAAAAABaA/zOdqGlINULo/photo.jpg?sz=128", "display_name": "Randomness Slayer", "link": "https://stackoverflow.com/users/5065400/randomness-slayer"}, "is_accepted": false, "score": 0, "last_activity_date": 1529530607, "last_edit_date": 1592644375, "creation_date": 1529526729, "answer_id": 50956594, "question_id": 50956208, "link": "https://stackoverflow.com/questions/50956208/how-should-i-get-time-in-minutes-in-vba/50956594#50956594", "title": "How should I get time in minutes in VBA", "body": "<p>First off, <code>TIMEDIFF</code> is a function I did not immediately find documentation for.</p>\n<p>Also, time/dates are usually represented in terms of days.</p>\n<p>To get hours from that you would <strong>multiply</strong> by 24 to get hours (then 60 for minutes, etc., etc.), not divide.</p>\n<h3>Using an Existing Function</h3>\n<p>A simple way to calculate time differences using a built in function is with <code>DateDiff</code>which has a signature of:</p>\n<pre><code>DateDiff( interval, date1, date2, [firstdayofweek], [firstweekofyear] )\n</code></pre>\n<p>There are plenty of intervals for you to choose from, ranging from year to second. Minutes is &quot;n&quot;.</p>\n<p>Ex:</p>\n<pre><code>DateDiff(&quot;n&quot;, &quot;00:00&quot;, &quot;12:00&quot;) '-&gt; Result: 0.5\n</code></pre>\n<p>Documentation: <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/datediff-function\" rel=\"nofollow noreferrer\">msdn.microsoft.com/.../datediff-function</a></p>\n<h3>Simple Math Version</h3>\n<p>Even simpler is to just subtract:</p>\n<pre><code>abs(time2 - time1)\n</code></pre>\n<p>Where the result will be in days.</p>\n<p><strong>EDIT:</strong></p>\n<p>I would encourage you to make sure your functions do exactly what you expect them to do and not just hack something together that works but upon further changes breaks. It's poor coding practice and you learn nothing from it.</p>\n<p>However, in an effort to give a response, a simple roundabout way to get a minimum cutoff of one hour would be to simply take the smallest value you would like to have, compare it to your value and choose the larger of the two.</p>\n<pre><code>calculatedValue &lt;- SomeNumber\ncutoffValue &lt;- 1/24\nchosenValue &lt;- MAX(calculatedValue, cutoffValue)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8809948, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214995769515744/picture?type=large", "display_name": "Yash Shah", "link": "https://stackoverflow.com/users/8809948/yash-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1594633558, "creation_date": 1529525008, "last_edit_date": 1594633558, "question_id": 50956208, "link": "https://stackoverflow.com/questions/50956208/how-should-i-get-time-in-minutes-in-vba", "title": "How should I get time in minutes in VBA", "body": "<p>I am storing large amount of data in VBA and later on exporting that file in excel.\nI am able to collect the time if it is greater than an hour, but if it is less than 59 minutes I am not able to collect it.\nI am using similar function for calculating time difference</p>\n\n<ol>\n<li>// get the time diff 00:00  </li>\n<li>var time = TIMEDIFF('00:00', $inspection_time);</li>\n<li>// for example, the inspection time is 12:00pm, the result should be 0.5  </li>\n<li>var rate = time/24;</li>\n<li>SETRESULT(rate);</li>\n</ol>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5904457, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a49f687b68eaee418fe6fbb7db5a5ec7?s=128&d=identicon&r=PG&f=1", "display_name": "nameishi", "link": "https://stackoverflow.com/users/5904457/nameishi"}, "edited": false, "score": 0, "creation_date": 1529545685, "post_id": 50956625, "comment_id": 88915716, "body": "in the image i provided what is on the first sheet and what the newly created sheet should look like."}, {"owner": {"reputation": 281, "user_id": 2857338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5e21d7f25573f28a85b386a3befa29?s=128&d=identicon&r=PG&f=1", "display_name": "BLitE.exe", "link": "https://stackoverflow.com/users/2857338/blite-exe"}, "reply_to_user": {"reputation": 43, "user_id": 5904457, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a49f687b68eaee418fe6fbb7db5a5ec7?s=128&d=identicon&r=PG&f=1", "display_name": "nameishi", "link": "https://stackoverflow.com/users/5904457/nameishi"}, "edited": false, "score": 0, "creation_date": 1529588558, "post_id": 50956625, "comment_id": 88936388, "body": "Why for the down vote? I provided where you can start and this is what i get? Very nice."}, {"owner": {"reputation": 43, "user_id": 5904457, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a49f687b68eaee418fe6fbb7db5a5ec7?s=128&d=identicon&r=PG&f=1", "display_name": "nameishi", "link": "https://stackoverflow.com/users/5904457/nameishi"}, "edited": false, "score": 0, "creation_date": 1529679054, "post_id": 50956625, "comment_id": 88975705, "body": "I DID NOT DOWN VOTE Anything, you realize other people have that ability..."}], "tags": [], "owner": {"reputation": 281, "user_id": 2857338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5e21d7f25573f28a85b386a3befa29?s=128&d=identicon&r=PG&f=1", "display_name": "BLitE.exe", "link": "https://stackoverflow.com/users/2857338/blite-exe"}, "is_accepted": false, "score": -1, "last_activity_date": 1529526881, "creation_date": 1529526881, "answer_id": 50956625, "question_id": 50956199, "link": "https://stackoverflow.com/questions/50956199/create-new-sheet-from-button-cell-that-pulls-data-into-new-sheet/50956625#50956625", "title": "Create new sheet from button cell that pulls data into new sheet", "body": "<p>So first thing first, maybe I didn't get the question right. </p>\n\n<p>Just to clarify the question. Do you want to have some kind of Table of Contents on the First Sheet?</p>\n\n<p>To do this, you need to have an Event Handler for this certain sheet or specifically for this certain ranges. You can either choose Worksheet_SelectionChange or Worksheet_Change Event depending on your desired result. </p>\n\n<p>As for the Routine to create new Sheet and renaming it. You can use this reference </p>\n\n<p><a href=\"https://stackoverflow.com/questions/3840628/creating-and-naming-worksheet-in-excel-vba\">Creating and Naming Worksheet in Excel VBA</a></p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5904457, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a49f687b68eaee418fe6fbb7db5a5ec7?s=128&d=identicon&r=PG&f=1", "display_name": "nameishi", "link": "https://stackoverflow.com/users/5904457/nameishi"}, "edited": false, "score": 0, "creation_date": 1529545640, "post_id": 50956965, "comment_id": 88915703, "body": "Thanks this is what i wanted, a framework for the best way to build this."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1529528820, "last_edit_date": 1529528820, "creation_date": 1529528517, "answer_id": 50956965, "question_id": 50956199, "link": "https://stackoverflow.com/questions/50956199/create-new-sheet-from-button-cell-that-pulls-data-into-new-sheet/50956965#50956965", "title": "Create new sheet from button cell that pulls data into new sheet", "body": "<p>Since you did not show an attempt, I will just give you the bare bones required to get you started on your problem. This needs to be pasted on the sheet where your data will originate from<br>\n<code>(VBE &gt; Sheet X &gt; Paste code here)</code>  </p>\n\n<p>Every time you <strong>double click</strong> on a cell (<code>Target</code>), a new sheet will be created. Having this fire on a single click or selection change is too unpredictable.<br>\nThe sheet name will = the value in the <code>Target</code> cell<br>\nThe sheet will always be the furthest right sheet on your tab selection</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nDim ws As Worksheet\nSet ws = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\nws.Name = Target.Value\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Things you may want to account for while completing your project:</p>\n\n<ol>\n<li>Limit the target range to the cells where you want this to work. To implement this, research the <code>Intersect</code> method (or see #5 instead)</li>\n<li>If your cell value that is double clicked has a value that is not compliant with sheet name limitations, this will error out. Research <code>Error Handling</code> to account for this (Or make sure every cell that you want this to apply to has a value that fits sheet name rules)</li>\n<li>If you double click on the same cell twice, you will get an error (cannot have multiple sheets with the same name). <code>Error Handling</code> will help you here</li>\n<li>This does not place any data on your worksheet. The amount of questions in regaurds to Copy/Paste on this site is <strong>beyond plentiful</strong>. <code>Offset</code> from your <code>Target</code> cell may help here. Also, you can loop through the selected column (<code>Target.Column</code>) and move to your new sheet if the cell has <code>x</code></li>\n<li>This can be be amended to check the <code>Target</code> cells format if you really want this to only fire when a 'green' cell is clicked</li>\n</ol>\n"}], "owner": {"reputation": 43, "user_id": 5904457, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a49f687b68eaee418fe6fbb7db5a5ec7?s=128&d=identicon&r=PG&f=1", "display_name": "nameishi", "link": "https://stackoverflow.com/users/5904457/nameishi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 50956965, "answer_count": 2, "score": 0, "last_activity_date": 1529567339, "creation_date": 1529524977, "last_edit_date": 1529567339, "question_id": 50956199, "link": "https://stackoverflow.com/questions/50956199/create-new-sheet-from-button-cell-that-pulls-data-into-new-sheet", "title": "Create new sheet from button cell that pulls data into new sheet", "body": "<p>When you click a green cell, a new sheet with new sheet name matching the green cell's name. The green cells are parents and the 'x' represents a child.  So In the newly created sheet there will be two columns. One for the Parent which will contain the parents Id and the second column which will display the child Id.(image below to demonstrate).  What is the best way to do this?  </p>\n\n<p><a href=\"https://i.stack.imgur.com/rpDYM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rpDYM.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/X3z95.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X3z95.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1529529415, "post_id": 50956186, "comment_id": 88911687, "body": "There are several possible ways to accomplish such a thing. It&#39;s all a matter of the reason to do so. For instance, if you&#39;re running a back-end attached to the Access Database as a front-end, simply disseminating copies of an Access Database to the end-user would successfully accomplish this goal, as long as there was no direct way for them to modifiy anything on the back-end that you did not allow. If the purpose is to only read data, it can accomplish that with forms, etc. The basic idea, is its too much to answer here, but if you have a more specific question, we can help with that."}, {"owner": {"reputation": 1, "user_id": 6927694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7slFnHGa3GM/AAAAAAAAAAI/AAAAAAAADw8/eoXxslg5DJE/photo.jpg?sz=128", "display_name": "Jenny", "link": "https://stackoverflow.com/users/6927694/jenny"}, "reply_to_user": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1529530230, "post_id": 50956186, "comment_id": 88912031, "body": "@Jiggles32 The purpose is for most users to be able to read the data, but only a good handful can log in as a planner and add in and/or edit some event information."}, {"owner": {"reputation": 573, "user_id": 506017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jnsvp.png?s=128&g=1", "display_name": "Eliot K", "link": "https://stackoverflow.com/users/506017/eliot-k"}, "edited": false, "score": 0, "creation_date": 1529531580, "post_id": 50956186, "comment_id": 88912551, "body": "You may want to check out the answer to this question: <a href=\"https://stackoverflow.com/questions/1672077/setting-up-an-ms-access-db-for-multi-user-access\" title=\"setting up an ms access db for multi user access\">stackoverflow.com/questions/1672077/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 6927694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7slFnHGa3GM/AAAAAAAAAAI/AAAAAAAADw8/eoXxslg5DJE/photo.jpg?sz=128", "display_name": "Jenny", "link": "https://stackoverflow.com/users/6927694/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529524936, "creation_date": 1529524936, "question_id": 50956186, "link": "https://stackoverflow.com/questions/50956186/microsoft-access-cant-create-a-database-web-app-client-still-wants-us-to-use", "title": "Microsoft Access: Can&#39;t create a database web app, client still wants us to use it", "body": "<p>I'm a college senior in CS and I am currently part of a new intern project where there's only me and one other intern so it's a fairly small scale project with just two programmers. So we just realized today that we cannot create a web application as originally intended, but then after our project manager discussed with our 'client' of what she expects, she still wants it to be done in Access, even with this new limitation. To their knowledge, it is still doable to just continue creating what we have so far, (we've just done random features so far, only just finalized the task board, it's all very messy) and then later just share the read-only version as an .accdr file into a shared folder drive. There will be limited permissions and such, but I am still unsure. I will definitely continue my research and do what we can, but I'd like to know what other people think. Is it still possible to just create a shared read-only version of a database? What kind of limitations would you expect as opposed to a web application?</p>\n\n<p>It's an event planner where it should contain all the tables of data, a search interface, a planning interface (which will also prompt for a planner sign in for those who should have rights to do so), and a results page.</p>\n\n<p>Prior to this position, I've never worked with Access before considering that my school is mostly about programming languages and then all the other fields of Networking, Linux, OS, etc.</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["vba", "ms-access", "with-statement", "subreports"], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1529525482, "creation_date": 1529525482, "answer_id": 50956315, "question_id": 50956059, "link": "https://stackoverflow.com/questions/50956059/ms-access-vba-referring-to-controls-on-a-sub-report-using-with/50956315#50956315", "title": "MS Access VBA Referring to controls on a sub report using &#39;with&#39;", "body": "<p>Consider the <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/reports-object-access\" rel=\"nofollow noreferrer\">Reports</a> collection and <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/report-controls-property-access\" rel=\"nofollow noreferrer\">Report.Controls</a> property which allow string references of object names:</p>\n\n<pre><code>With Reports(\"PARENT_REPORT_NAME\")                \n   .Controls(\"CHILD_REPORT_NAME\").Report.Label1.Caption = \"Yes\"\n   ...\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 2514675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/jiLwU.jpg?s=128&g=1", "display_name": "lmorse", "link": "https://stackoverflow.com/users/2514675/lmorse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 50956315, "answer_count": 1, "score": 0, "last_activity_date": 1529525482, "creation_date": 1529524360, "question_id": 50956059, "link": "https://stackoverflow.com/questions/50956059/ms-access-vba-referring-to-controls-on-a-sub-report-using-with", "title": "MS Access VBA Referring to controls on a sub report using &#39;with&#39;", "body": "<p>Using MS Access VBA the following code works for me:</p>\n\n<pre><code>Reports.PARENT_REPORT_NAME.CHILD_REPORT_NAME.Report.Label1.Caption = \"Yes\"\n</code></pre>\n\n<p>However this does not:</p>\n\n<pre><code>With Reports(PARENT_REPORT_NAME)\n.CHILD_REPORT_NAME.Report.Label1.Caption = \"Yes\"\n</code></pre>\n\n<p>Does anyone have any insight for me please?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9969479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wZT38vn0dI8/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3Y1GwXXRrSB4hb5PFO2UaLZ0PBmg/mo/photo.jpg?sz=128", "display_name": "user9969479", "link": "https://stackoverflow.com/users/9969479/user9969479"}, "edited": false, "score": 0, "creation_date": 1529616922, "post_id": 50956341, "comment_id": 88951412, "body": "Thank you for your help. I pasted the above code in both worksheets and got Run-time error &#39;9&#39; Script out of range. :-("}, {"owner": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "reply_to_user": {"reputation": 11, "user_id": 9969479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wZT38vn0dI8/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3Y1GwXXRrSB4hb5PFO2UaLZ0PBmg/mo/photo.jpg?sz=128", "display_name": "user9969479", "link": "https://stackoverflow.com/users/9969479/user9969479"}, "edited": false, "score": 0, "creation_date": 1529669106, "post_id": 50956341, "comment_id": 88969601, "body": "@user9969479 Change <code>Sheets(&quot;This Sheet&quot;)</code> and <code>Sheets(&quot;That Sheet&quot;)</code> to the names of the sheets in your workbook."}, {"owner": {"reputation": 11, "user_id": 9969479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wZT38vn0dI8/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3Y1GwXXRrSB4hb5PFO2UaLZ0PBmg/mo/photo.jpg?sz=128", "display_name": "user9969479", "link": "https://stackoverflow.com/users/9969479/user9969479"}, "edited": false, "score": 0, "creation_date": 1530129375, "post_id": 50956341, "comment_id": 89130785, "body": "Tried that and still the same error. It only works on one sheet and when I remove And _        Sheets(&quot;That Sheet&quot;).Range(&quot;J27&quot;).Value &lt; 0 Then"}], "tags": [], "owner": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "is_accepted": false, "score": 0, "last_activity_date": 1529525616, "creation_date": 1529525616, "answer_id": 50956341, "question_id": 50955952, "link": "https://stackoverflow.com/questions/50955952/vba-program-to-run-automatically/50956341#50956341", "title": "VBA program to run automatically", "body": "<p>The <code>Worksheet_Calculate</code> subroutine is only going to be triggered when the worksheet that you created it in is recalculated. <code>Range(\"J27\")</code> is only looking at the cell in that worksheet, so your loop only iterates one time.</p>\n\n<p>To get the value in cell J27 from both worksheets, you need to specify the sheet and the range for each one.</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    If Sheets(\"This Sheet\").Range(\"J27\").Value &lt; 0 And _\n       Sheets(\"That Sheet\").Range(\"J27\").Value &lt; 0 Then \n        MsgBox (\"NPV negative! Please enter future Savings!\"), , \"Invalid Entry\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Put that in both worksheets to get it to run when either worksheet is recalculated. (Or, better yet, save it in a separate Module and call it from both <code>Worksheet_Calculate</code> subroutines.)</p>\n"}], "owner": {"reputation": 11, "user_id": 9969479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wZT38vn0dI8/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3Y1GwXXRrSB4hb5PFO2UaLZ0PBmg/mo/photo.jpg?sz=128", "display_name": "user9969479", "link": "https://stackoverflow.com/users/9969479/user9969479"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529525616, "creation_date": 1529523913, "last_edit_date": 1531164843, "question_id": 50955952, "link": "https://stackoverflow.com/questions/50955952/vba-program-to-run-automatically", "title": "VBA program to run automatically", "body": "<p>I have a worksheet with two tabs and wanted to have a VBA to run automatically and pop up a window message saying \"NPV negative! Please enter future Savings!\" anytime cell J27 (in both tabs) calculates negative value. \nI have the below code in the Module and when I test and click run it does what I wanted to do but in reality when I change information and cell J27 is a negative number nothing happens. I'm very new with VBA so any help is appreciated.</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nFor Each cell In Range(\"J27\")\n    If cell.Value &lt; 0 Then MsgBox (\"NPV negative! Please enter future Savings!\"), , \"Invalid Entry\"\nNext cell\nEnd Sub\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9899503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ee9428ce45273c58419a087c27941f?s=128&d=identicon&r=PG&f=1", "display_name": "FlexOff", "link": "https://stackoverflow.com/users/9899503/flexoff"}, "edited": false, "score": 0, "creation_date": 1529524687, "post_id": 50956019, "comment_id": 88909716, "body": "I replaced my line of code with the one you said and still got the same error. I tried it with both of my examples above.The error is Run-time error 1004. Application defined or object defined error. Also occurring at the same spot."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 9899503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ee9428ce45273c58419a087c27941f?s=128&d=identicon&r=PG&f=1", "display_name": "FlexOff", "link": "https://stackoverflow.com/users/9899503/flexoff"}, "edited": false, "score": 0, "creation_date": 1529525390, "post_id": 50956019, "comment_id": 88910023, "body": "What&#39;s the value of <code>LastRow</code> when it fails?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 9899503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ee9428ce45273c58419a087c27941f?s=128&d=identicon&r=PG&f=1", "display_name": "FlexOff", "link": "https://stackoverflow.com/users/9899503/flexoff"}, "edited": false, "score": 0, "creation_date": 1529525542, "post_id": 50956019, "comment_id": 88910091, "body": "Your code works fine for me (even without the Array() edit)"}, {"owner": {"reputation": 5, "user_id": 9899503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ee9428ce45273c58419a087c27941f?s=128&d=identicon&r=PG&f=1", "display_name": "FlexOff", "link": "https://stackoverflow.com/users/9899503/flexoff"}, "edited": false, "score": 0, "creation_date": 1529525694, "post_id": 50956019, "comment_id": 88910147, "body": "I added a msgbox to print LastRow. It returns 138"}, {"owner": {"reputation": 5, "user_id": 9899503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ee9428ce45273c58419a087c27941f?s=128&d=identicon&r=PG&f=1", "display_name": "FlexOff", "link": "https://stackoverflow.com/users/9899503/flexoff"}, "edited": false, "score": 0, "creation_date": 1529526934, "post_id": 50956019, "comment_id": 88910677, "body": "There was a blank row. A2 was a blank row. I changed the code from set rng = ActiveSheet.Range(&quot;A1:K&quot; &amp; LastRow) to set rng = ActiveSheet.Range(&quot;A2:K&quot; &amp; LastRow) and it worked. Thanks Tim!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1529524184, "creation_date": 1529524184, "answer_id": 50956019, "question_id": 50955862, "link": "https://stackoverflow.com/questions/50955862/vba-remove-duplicates-error/50956019#50956019", "title": "VBA Remove Duplicates Error", "body": "<pre><code>rng.RemoveDuplicates Columns:=Array(1),  Header:=xlYes\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-removeduplicates-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-removeduplicates-method-excel</a></p>\n\n<blockquote>\n  <p>Columns: Array of indexes of the columns that contain the duplicate\n  information.</p>\n</blockquote>\n"}], "owner": {"reputation": 5, "user_id": 9899503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ee9428ce45273c58419a087c27941f?s=128&d=identicon&r=PG&f=1", "display_name": "FlexOff", "link": "https://stackoverflow.com/users/9899503/flexoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529524184, "creation_date": 1529523488, "last_edit_date": 1531164843, "question_id": 50955862, "link": "https://stackoverflow.com/questions/50955862/vba-remove-duplicates-error", "title": "VBA Remove Duplicates Error", "body": "<p>So, I am trying to delete any rows that have duplicate data in column A. I thought this was pretty elegant compared to some of the loops I saw people asking about. However, I get an error on the line rng.RemoveDuplicates Columns:=1, Header:=xlYes. The error is Run-time error 1004. Application defined or object defined error. </p>\n\n<p>Ideally, we can get the error to go away while also removing duplicates rows. Any help would be appreciated! Thanks! </p>\n\n<pre><code>Private Sub RemoveDuplicate_Click()\n\n  Dim LastRow As Long\n  Dim rng As Range\n  Dim ws As Worksheet\n  Set ws = Worksheets(\"Scorecard\")\n\n  LastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n  Set rng = ws.Range(\"A1:K\" &amp; LastRow)\n  rng.RemoveDuplicates Columns:=1, Header:=xlYes\nEnd Sub\n</code></pre>\n\n<p>Also, I tried this code as well and got the same error.</p>\n\n<pre><code>Private Sub RemoveDuplicate_Click()\n\n Dim LastRow As Long\n Dim rng As Range\n Worksheets(\"Scorecard\").Activate\n LastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n Set rng = ActiveSheet.Range(\"A1:K\" &amp; LastRow)\n rng.RemoveDuplicates Columns:=1, Header:=xlYes\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 626, "user_id": 6575856, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QBxNnVp8qBE/AAAAAAAAAAI/AAAAAAAAAGg/AGkLGS7o1JM/photo.jpg?sz=128", "display_name": "Matthew Goheen", "link": "https://stackoverflow.com/users/6575856/matthew-goheen"}, "edited": false, "score": 0, "creation_date": 1529523765, "post_id": 50955600, "comment_id": 88909360, "body": "It looks like your a tag does not have a title attribute. The Image tag does, but you&#39;re not looking for Image tags in your code."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9968827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a16bc9d1520a720772993096d1a509c3?s=128&d=identicon&r=PG&f=1", "display_name": "Nolan C", "link": "https://stackoverflow.com/users/9968827/nolan-c"}, "edited": false, "score": 0, "creation_date": 1529524392, "post_id": 50955978, "comment_id": 88909584, "body": "I had not tried this. Trying this code now, I get Run-time error &#39;91&#39;: Object variable or With block variable not set. However, when I hit debug and then continue running the Macro it then works."}, {"owner": {"reputation": 3, "user_id": 9968827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a16bc9d1520a720772993096d1a509c3?s=128&d=identicon&r=PG&f=1", "display_name": "Nolan C", "link": "https://stackoverflow.com/users/9968827/nolan-c"}, "edited": false, "score": 1, "creation_date": 1529524883, "post_id": 50955978, "comment_id": 88909802, "body": "This works, so I guess the webpage had not fully loaded yet. Thank you very much"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1529524899, "last_edit_date": 1529524899, "creation_date": 1529524010, "answer_id": 50955978, "question_id": 50955600, "link": "https://stackoverflow.com/questions/50955600/vba-to-click-object-in-internet-explorer/50955978#50955978", "title": "VBA to click object in Internet Explorer", "body": "<p>For what you have shown did you try</p>\n\n<pre><code>Application.Wait Now + TimeSerial(0,0,2) '&lt;== you can adjust the 2 which is number of seconds to wait\nHTMLDoc.getElementById(\"apexir_dl_CSV\").Click\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>While IE.Busy = True Or IE.readyState &lt; 4: DoEvents: Wend\nDim b As Object\nDo: DoEvents: On Error Resume Next: Set b = IE.document.getElementById(\"apexir_dl_CSV\"): On Error GoTo 0: Loop While b Is Nothing    '&lt;== Loops until object found (should include a timeout to prevent infinite looping)\nIE.document.getElementById(\"apexir_dl_CSV\").Click\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 626, "user_id": 6575856, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QBxNnVp8qBE/AAAAAAAAAAI/AAAAAAAAAGg/AGkLGS7o1JM/photo.jpg?sz=128", "display_name": "Matthew Goheen", "link": "https://stackoverflow.com/users/6575856/matthew-goheen"}, "is_accepted": false, "score": 0, "last_activity_date": 1529524282, "creation_date": 1529524282, "answer_id": 50956048, "question_id": 50955600, "link": "https://stackoverflow.com/questions/50955600/vba-to-click-object-in-internet-explorer/50956048#50956048", "title": "VBA to click object in Internet Explorer", "body": "<p>Your anchor tag doesn't have a title attribute so you can't find that anchor to click it. Instead find the anchor tag by looking for it by its id attribute.</p>\n\n<p>This is what worked for me. </p>\n\n<pre><code> For Each oHTML_Element In HTMLDoc.getElementsByTagName(\"a\")\n    If oHTML_Element.ID = \"apexir_dl_CSV\" Then\n        oHTML_Element.Click: Exit For\n    End If\nNext oHTML_Element\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 9968827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a16bc9d1520a720772993096d1a509c3?s=128&d=identicon&r=PG&f=1", "display_name": "Nolan C", "link": "https://stackoverflow.com/users/9968827/nolan-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 50955978, "answer_count": 2, "score": 0, "last_activity_date": 1529524899, "creation_date": 1529522493, "question_id": 50955600, "link": "https://stackoverflow.com/questions/50955600/vba-to-click-object-in-internet-explorer", "title": "VBA to click object in Internet Explorer", "body": "<p>I would like to click on an object in Internet Explorer using VBA to automatically navigate through a webpage. </p>\n\n<pre><code>For Each oHTML_Element In HTMLDoc.getElementsByTagName(\"a\")\n    If oHTML_Element.Title = \"CSV\" Then\n        oHTML_Element.Click: Exit For\n    End If\nNext oHTML_Element\n</code></pre>\n\n<p>This is the code I am trying to use, and have used successfully before in my Excel Macro, but it is not working for this object, and I am not sure why.</p>\n\n<p>This is the HTML code for the object I am trying to click:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;a id=\"apexir_dl_CSV\" href=\",DanaInfo=web1.us.industry.somecompany.net,SSL+f?p=103:5:1156695844453492:CSV::::\"&gt;\r\n &lt;img title=\"CSV\" alt=\"CSV\" src=\"/i41/ws/,DanaInfo=web1.us.industry.somecompany.net,SSL+download_csv_64x64.gif\"&gt;\u200b</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1529522626, "post_id": 50955514, "comment_id": 88908834, "body": "rcell is one cell in the Selection.  I assume that you want <code>rCell.Value = Selection(0).Value</code>  But for this to work the Header value needs to be in the cell directly above the cells selected."}, {"owner": {"reputation": 499, "user_id": 1322172, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4137ae965370267f125ca7021ad10216?s=128&d=identicon&r=PG", "display_name": "jjamesjohnson", "link": "https://stackoverflow.com/users/1322172/jjamesjohnson"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1529523080, "post_id": 50955514, "comment_id": 88909043, "body": "Thanks, so I get it now. Since the previous Cell had already been filled from the field before it everything would work fine until something wasn&#39;t filled with lime green. The subsequent sections wouldn&#39;t fill with a value even though they were matched because I wasn&#39;t really referencing the header in the first place."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1529523385, "post_id": 50955514, "comment_id": 88909173, "body": "You may also want to add a test that the first row in the sheet is not part of the selection as <code>Selection(0).Value</code> will throw an error."}, {"owner": {"reputation": 499, "user_id": 1322172, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4137ae965370267f125ca7021ad10216?s=128&d=identicon&r=PG", "display_name": "jjamesjohnson", "link": "https://stackoverflow.com/users/1322172/jjamesjohnson"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1529523464, "post_id": 50955514, "comment_id": 88909220, "body": "It was a part of the selection but I&#39;ve modified the sub to not select the header and used your method anyhow."}], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 1322172, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4137ae965370267f125ca7021ad10216?s=128&d=identicon&r=PG", "display_name": "jjamesjohnson", "link": "https://stackoverflow.com/users/1322172/jjamesjohnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1529523402, "creation_date": 1529523402, "answer_id": 50955837, "question_id": 50955514, "link": "https://stackoverflow.com/questions/50955514/sub-range-selection-behavior-confusing-when-evaluating-for-each/50955837#50955837", "title": "Sub range selection behavior confusing when evaluating For Each", "body": "<p>The line <code>rCell.Value = rCell(0).Value</code> wasn't referencing the header value as thought, it was referencing the cell above the the current location within the evaluation of the range. As Scott Craner notes above I want to reference the value before the selection by using <code>rCell.Value = Selection(0).Value</code>.</p>\n"}], "owner": {"reputation": 499, "user_id": 1322172, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4137ae965370267f125ca7021ad10216?s=128&d=identicon&r=PG", "display_name": "jjamesjohnson", "link": "https://stackoverflow.com/users/1322172/jjamesjohnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529523402, "creation_date": 1529522182, "last_edit_date": 1531164843, "question_id": 50955514, "link": "https://stackoverflow.com/questions/50955514/sub-range-selection-behavior-confusing-when-evaluating-for-each", "title": "Sub range selection behavior confusing when evaluating For Each", "body": "<p>Using the code below I'm trying to set those fields that are lime green to the value of the column header. The confusing behavior is that once it fills the first several fields that are filled with lime green it will never again fill a lime green field with the value of rCell(0). What is causing the evaluation of rCell to change? I would expect it to remain static as the selection doesn't change. I've confirmed the sub correctly matches the subsequent lime green fields (as the color is replaced) but the code just doesn't write the header value at that point. For now I've worked around the behavior by setting the header value to a separate string before the for each loop but I'd like to understand where I'm getting lost &amp; losing the selection of the range.</p>\n\n<pre><code>Sub ChangeColor()\n    Dim rCell As Range\n    If Selection.Cells.Count = 1 Then\n        MsgBox \"Select the range to be processed.\"\n        Exit Sub\n    End If\n    For Each rCell In Selection\n        If rCell.Interior.Color = RGB(146, 208, 80) Then  'lime green\n            rCell.Interior.Color = RGB(255, 255, 255)      'white\n            rCell.Value = rCell(0).Value\n        End If\n    Next rCell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word", "word-contentcontrol"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1529519119, "post_id": 50954688, "comment_id": 88907210, "body": "Use <code>Range(&quot;G:G&quot;)</code> instead. Or to stick with <code>Columns</code>, <code>Columns(7)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1529528048, "creation_date": 1529528048, "answer_id": 50956870, "question_id": 50954688, "link": "https://stackoverflow.com/questions/50954688/return-excel-row-in-word-macro/50956870#50956870", "title": "Return Excel Row in Word Macro", "body": "<p>While using more than one MS Office application it is a good idea to specify which application you are targeting:</p>\n\n<pre><code> Excel.Application.ThisWorkbook.Sheets(1).Range(\"A1\").Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7747900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49083acaf9504b5e8a8ecaf01048efcd?s=128&d=identicon&r=PG&f=1", "display_name": "folds", "link": "https://stackoverflow.com/users/7747900/folds"}, "is_accepted": false, "score": 0, "last_activity_date": 1529654471, "last_edit_date": 1529654471, "creation_date": 1529587536, "answer_id": 50969737, "question_id": 50954688, "link": "https://stackoverflow.com/questions/50954688/return-excel-row-in-word-macro/50969737#50969737", "title": "Return Excel Row in Word Macro", "body": "<p>this is what ended up working. you set me on the right track with referencing Excel.</p>\n\n<pre><code>Sub findsomething(curRow)\nDim rng As Long\nDim rownumber As Long\n\ncurPath = ActiveDocument.path &amp; \"\\\"\nCall Set_Variable(curPath)\nStrWkShtNm = \"Chapters\"\nMsgBox \"curRow = \" &amp; curRow\n\nIf Dir(StrWkBkNm) = \"\" Then\n  MsgBox \"Cannot find the designated workbook: \" &amp; StrWkBkNm, vbExclamation\n  Exit Sub\nEnd If\n\nWith xlApp\n  .Visible = False\n  Set xlWkBk = .Workbooks.Open(FileName:=StrWkBkNm, ReadOnly:=True, AddToMRU:=False)\n  With xlWkBk\n    With .Worksheets(StrWkShtNm)\n        rng = .Range(\"G:G\").Find(what:=curRow)\n        MsgBox rng\n    End With\n    .Close False\n  End With\n  .Quit\nEnd With\n\n\n' Release Excel object memory\nSet xlWkBk = Nothing: Set xlApp = Nothing\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7747900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49083acaf9504b5e8a8ecaf01048efcd?s=128&d=identicon&r=PG&f=1", "display_name": "folds", "link": "https://stackoverflow.com/users/7747900/folds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545419521, "creation_date": 1529518607, "last_edit_date": 1545419521, "question_id": 50954688, "link": "https://stackoverflow.com/questions/50954688/return-excel-row-in-word-macro", "title": "Return Excel Row in Word Macro", "body": "<p>I have ContentControl drop down box in Word. Once I select an item from a Drop Down list I want to search for that in an Excel document and set the row number equal to a variable.\nThe code below is what I tried but the Columns(\"G:G\").Find part says its not defined.</p>\n\n<pre><code>Sub findsomething(curRow) \n    Dim rng As Range\n    Dim rownumber As Long\n\n    curPath = ActiveDocument.path &amp; \"\\\" \n    Call Set_Variable(curPath) \n    StrWkShtNm = \"Chapters\"\n\n    If Dir(StrWkBkNm) = \"\" Then   \n        MsgBox \"Cannot find the designated workbook: \" &amp; StrWkBkNm, vbExclamation\n        Exit Sub \n    End If\n\n    Set rng = Columns(\"G:G\").Find(what:=curRow)\n    rownumber = rng.Row\n    MsgBox rownumber\n    ' Release Excel object memory \n    Set xlWkBk = Nothing\n    Set xlApp = Nothing \n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "finance", "quantitative-finance", "quantlib", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1529539870, "post_id": 50954518, "comment_id": 88914636, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/50952720/fddividendamericanengine-function-in-quantlib\">FDDividendAmericanEngine Function in QuantLib</a>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1529539925, "post_id": 50954518, "comment_id": 88914647, "body": "Why are so many people asking essentially the same question, using almost the same wording,  within 24 hours?"}, {"owner": {"reputation": 9, "user_id": 9150122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2M0cI.jpg?s=128&g=1", "display_name": "Elizabeth", "link": "https://stackoverflow.com/users/9150122/elizabeth"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1529540852, "post_id": 50954518, "comment_id": 88914822, "body": "@JohnColeman I don&#39;t know I took it from a Forum."}, {"owner": {"reputation": 9, "user_id": 9150122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2M0cI.jpg?s=128&g=1", "display_name": "Elizabeth", "link": "https://stackoverflow.com/users/9150122/elizabeth"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1529540886, "post_id": 50954518, "comment_id": 88914826, "body": "@JohnColeman Sir, Kindly let me know How to Call this Function in the Answers Section. Thanks"}], "owner": {"reputation": 9, "user_id": 9150122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2M0cI.jpg?s=128&g=1", "display_name": "Elizabeth", "link": "https://stackoverflow.com/users/9150122/elizabeth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529861959, "creation_date": 1529517964, "last_edit_date": 1531161705, "question_id": 50954518, "link": "https://stackoverflow.com/questions/50954518/quantlib-function-calling", "title": "Quantlib Function Calling", "body": "<p>How can I call a function in Excel VBA Programming that is not present in Quantlib library?</p>\n\n<p>I got the list of functions from <a href=\"https://www.quantlib.org/quantlibxl/allfunctions.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I tried to call other Functions like this:</p>\n\n<pre><code>\u201cqlBlackConstantVol\u201d with \"blackConstantVol\",\n\u00a0\u00a0\u00a0\u00a0blackVolId =\u00a0Application.Run(\"qlBlackConstantVol\", _\n        \"blackConstantVol\", 35932, \"Target\", 0.2, \"Actual/365 (Fixed)\")\n</code></pre>\n\n<p>I'm trying to Call <code>FDDividendAmericanEngine</code> function but couldn't find any way to call it. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": true, "score": 2, "last_activity_date": 1529520946, "last_edit_date": 1529520946, "creation_date": 1529518351, "answer_id": 50954626, "question_id": 50954438, "link": "https://stackoverflow.com/questions/50954438/sort-method-of-range-class-failed-run-time-error-1004/50954626#50954626", "title": "Sort method of range class failed run time error 1004", "body": "<p>You need to specify Key1 before specifying Key2 and Key3. E.G.:</p>\n\n<pre><code>Private Sub sortSheet(ByRef sh As Excel.Worksheet, ByVal rc As String)\n  Dim lastRow As Long\n  lastRow = sh.Cells(sh.rows.count, \"A\").End(xlUp).row\n  With sh.Range(\"A1:\" + rc + CStr(lastRow))\n    .Sort Key1:=sh.Range(\"B1\"), Order1:=xlAscending, _\n        Key2:=sh.Range(\"A1\"), Order2:=xlAscending, _\n        Header:=xlYes, _\n        MatchCase:=False, _\n        Orientation:=xlTopToBottom\n  End With\nEnd Sub\n</code></pre>\n\n<p>Also, <code>Header</code> and <code>MatchCase</code> should be specified only once. </p>\n"}], "owner": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 1, "accepted_answer_id": 50954626, "answer_count": 1, "score": 0, "last_activity_date": 1529520946, "creation_date": 1529517598, "question_id": 50954438, "link": "https://stackoverflow.com/questions/50954438/sort-method-of-range-class-failed-run-time-error-1004", "title": "Sort method of range class failed run time error 1004", "body": "<p>When i try and sort columns in my script it returns the error Sort method of range class failed run time error 1004. Below I have included the script where this error is debugged as well as the declarations used in the script.</p>\n\n<pre><code>Set SbA = Worksheets(\"SumByAddress\")\nSet SbM = Worksheets(\"SumByMeterSize\")\nSet SFD = Worksheets(\"ShortFormData\")\nCounter = 2\npremiseID = \"\"\nRowNew = 2\nTotalRows = SFD.Cells(1, 1).End(xlDown).Row\nApplication.Calculation = xlCalculationManual\nTimeStart = Now\nPrevUpdate = Now\nSFD.Range(\"M15\") = \"Creating summation by address\"\nApplication.ScreenUpdating = False\n\nSFD.Range(\"A:I\").Sort , _\nkey2:=Range(\"A2\"), order2:=xlAscending, Header:=xlYes, MatchCase:=True, _\nkey3:=Range(\"D2\"), order3:=xlAscending, Header:=xlYes, MatchCase:=True\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1529518794, "last_edit_date": 1529518794, "creation_date": 1529518490, "answer_id": 50954665, "question_id": 50954336, "link": "https://stackoverflow.com/questions/50954336/how-to-delete-every-line-in-word-that-starts-with-a-certain-word/50954665#50954665", "title": "How to delete every line in word that starts with a certain word?", "body": "<p>You can use wildcard characters in <strong>Find and Replace</strong>. Expand the dialog by clicking on <strong>More >></strong>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/x5e9J.png\" alt=\"Find and Replace dialog\"></p>\n\n<hr>\n\n<p>If you really want to do this programmatically:</p>\n\n<pre><code>Dim doc As Word.Document\nSet doc = ... 'determine the document you want to act on, and fill it here\n\nDim p As Paragraph\nFor Each p In doc.Paragraphs\n    If InStr(p.Range.Text, \"Answer\") = 1 Then p.Range.Delete\nNext\n</code></pre>\n"}], "owner": {"reputation": 216, "user_id": 7650635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f02e52effc14d043a5f51a5dd8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Lauren Leder", "link": "https://stackoverflow.com/users/7650635/lauren-leder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1529518794, "creation_date": 1529517252, "last_edit_date": 1529517365, "question_id": 50954336, "link": "https://stackoverflow.com/questions/50954336/how-to-delete-every-line-in-word-that-starts-with-a-certain-word", "title": "How to delete every line in word that starts with a certain word?", "body": "<p>I have an 150 page document in word and want to delete every word line that starts with the word \"Answer: .....\" after answer each line says something different, so I wouldn't be able to do a find all for answer to delete it </p>\n\n<p>it would take hours to go through the entire document and find all the instances, can anyone share a vba that would do it for me?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1529519629, "post_id": 50954218, "comment_id": 88907468, "body": "Text concatenation uses <code>&amp;</code>, not <code>And</code>  Plus you need some more logic to determine where to place commas and &quot;and&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9730838, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Barry Lewis", "link": "https://stackoverflow.com/users/9730838/barry-lewis"}, "edited": false, "score": 0, "creation_date": 1529526271, "post_id": 50954953, "comment_id": 88910409, "body": "That explains it. I had no idea that &amp; was different than &quot;And&quot;.  Thanks!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1529519690, "creation_date": 1529519690, "answer_id": 50954953, "question_id": 50954218, "link": "https://stackoverflow.com/questions/50954218/userform-checkboxes-to-populate-word-doc-and-determine-next-form-opened/50954953#50954953", "title": "Userform Checkboxes to populate word doc and determine next form opened", "body": "<blockquote>\n<pre><code>Then strAnimal = strAnimal And \"Elephants, \"\n</code></pre>\n</blockquote>\n\n<p>The <code>And</code> operator can't be used that way. <code>And</code> is a logical/bitwise operator used in <code>Boolean</code> expressions or bitwise <code>And</code> operations.</p>\n\n<p>To concatenate strings, use the <code>&amp;</code> operator. The <code>+</code> operator can also be used, but it's better to use <code>&amp;</code> since <code>+</code> also serves as the \"addition\" operator, while <code>&amp;</code> is only ever used for string concatenations.</p>\n"}], "owner": {"reputation": 5, "user_id": 9730838, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Barry Lewis", "link": "https://stackoverflow.com/users/9730838/barry-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 50954953, "answer_count": 1, "score": 0, "last_activity_date": 1529519690, "creation_date": 1529516804, "last_edit_date": 1529519526, "question_id": 50954218, "link": "https://stackoverflow.com/questions/50954218/userform-checkboxes-to-populate-word-doc-and-determine-next-form-opened", "title": "Userform Checkboxes to populate word doc and determine next form opened", "body": "<p>So I\u2019ve been trying to use some userforms with checkboxes to populate a word document and have hit a snag.  Let\u2019s say I am letting the user select their favorite animals from a checkbox list:</p>\n\n<ul>\n<li>[ ] Monkeys</li>\n<li>[ ] Elephants</li>\n<li>[ ] Cats</li>\n</ul>\n\n<p>From that, if the user selects them it would populate on a line.  If they select more than one, it should have the proper format (Monkeys, Elephants, and Cats or Monkeys and Cats ect.)</p>\n\n<p>In addition to that I would want an additional form to pop up (or forms?) based on which boxes that were checked.  So, if someone checked Monkeys and Cats a box would pop up with something like this (or one form after another if this can\u2019t happen)</p>\n\n<p>What is your favorite thing about </p>\n\n<p>Monkeys</p>\n\n<p>They eat bananas</p>\n\n<p>They make funny noises</p>\n\n<p>They swing in trees</p>\n\n<p>Cats<br>\nThey are jerks<br>\nThey meow<br>\nThey sleep a lot  </p>\n\n<p>From there, it would populate using the same logic as above with commas and \u201cand\u201d.</p>\n\n<p>I\u2019ve tried a couple different codes to populate the date from the checkboxes and keep getting errors.  Either I can\u2019t select more than 2 or if I do only the last one selected is inserted.  I\u2019m using a bookmark to insert the data if that matters.</p>\n\n<pre><code>Private Sub cmdFavAnimalNext_Click()\nDim strAnimal As String\nIf cbxMonkey = True Then strAnimal = \"Monkeys, \"\nIf cbxElephants = True Then strAnimal = strAnimal And \"Elephants, \"\nIf cbxCats = True Then strAnimal = strAnimal And \"Cats, \"\n\n\n'Clean up formatting\n\nWith ActiveDocument\n    .Bookmarks(\"Animal\").Range.Text = strAnimal\nEnd With\nApplication.ScreenUpdating = True\nUnload Me\n\n\n'Next Userform based on checks\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 0, "creation_date": 1529516723, "post_id": 50954117, "comment_id": 88906091, "body": "What kind of errors are you getting? Also show us the IF statements you&#39;re using."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1529522793, "post_id": 50954117, "comment_id": 88908910, "body": "If you&#39;re checking cell F187, your syntax should be <code>If Sheets(&quot;YourSheetName&quot;).Range(&quot;F187&quot;)...</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1529524826, "post_id": 50954117, "comment_id": 88909776, "body": "Also, if you&#39;re going to use <code>MailEnvelope</code>, the only way I&#39;ve found to send 2 ranges side by side is to send the entire range, hiding Column B (which could be unhidden by the email recipients)."}], "answers": [{"tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": false, "score": 0, "last_activity_date": 1529530183, "creation_date": 1529530183, "answer_id": 50957305, "question_id": 50954117, "link": "https://stackoverflow.com/questions/50954117/send-two-excel-ranges-in-email-based-on-cell-value/50957305#50957305", "title": "Send two Excel ranges in email based on cell value", "body": "<p>See this, it shows how to copy a range into an email. It might be what you need: <a href=\"https://stackoverflow.com/questions/29092999/pasting-an-excel-range-into-an-email-as-a-picture\">Pasting an Excel range into an email as a picture</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9968957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6916246b23ed215dbe48c2e62ccb2f69?s=128&d=identicon&r=PG&f=1", "display_name": "R.Shackleford", "link": "https://stackoverflow.com/users/9968957/r-shackleford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1606306567, "creation_date": 1529516458, "last_edit_date": 1606306567, "question_id": 50954117, "link": "https://stackoverflow.com/questions/50954117/send-two-excel-ranges-in-email-based-on-cell-value", "title": "Send two Excel ranges in email based on cell value", "body": "<p>I found the following macro on a MicroSoft forum that does almost what I want.</p>\n<p>I want to send two ranges of cells (A1:A20) and C1:F20) side by side in an email to a specific set of individuals based on whether a specific cell in the spreadsheet is less than 0.</p>\n<p>I tried using different if statements. I get error messages.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Send_Range()\n       \n    If (F187 &lt; 0) Then\n          \n        ' Select the range of cells on the active worksheet.\n        ActiveSheet.Range(&quot;A1:A20&quot;).Select\n       \n        ' Show the envelope on the ActiveWorkbook.\n        ActiveWorkbook.EnvelopeVisible = True\n       \n       ' Set the optional introduction field thats adds\n       ' some header text to the email body. It also sets\n       ' the To and Subject lines. Finally the message\n       ' is sent.\n       With ActiveSheet.MailEnvelope\n          .Introduction = &quot;xxxxxxxxxx&quot;\n          .Item.To = &quot;James@gmail.com&quot;\n          .Item.CC = &quot;Alison@gmail.com&quot;\n          .Item.Subject = &quot;Subject&quot;\n          .Item.Send\n       End With\n    \n    End If\n    \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1529515892, "post_id": 50953874, "comment_id": 88905663, "body": "<code>Range(Rows(7), Rows(47)).Value</code> looks wrong to me. But is there a reason you are not using formulas for this?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9968857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63ddc4453604ee8412dadba6fff2216?s=128&d=identicon&r=PG&f=1", "display_name": "GVJenn", "link": "https://stackoverflow.com/users/9968857/gvjenn"}, "edited": false, "score": 0, "creation_date": 1529518333, "post_id": 50953972, "comment_id": 88906827, "body": "You are the best! Thanks sooo much!"}], "tags": [], "owner": {"reputation": 47, "user_id": 9542263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/av9ZD.png?s=128&g=1", "display_name": "Customizer", "link": "https://stackoverflow.com/users/9542263/customizer"}, "is_accepted": true, "score": 0, "last_activity_date": 1529515909, "creation_date": 1529515909, "answer_id": 50953972, "question_id": 50953874, "link": "https://stackoverflow.com/questions/50953874/vba-value-changes-multiple-values/50953972#50953972", "title": "vba value changes multiple values", "body": "<p>What is happening is that your Worksheet_Change event is being fired each time that your code is making a change which will be causing further recursion.  In your code, tell Excel not to fire the Worksheet_Change event while you make your updates:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Range(\"D2\").Value = \"Small\" Then\n        Application.EnableEvents = False\n        Range(\"A7\").Value = \"Yes\"\n        Range(\"A8\").Value = \"No\"\n        Range(\"A11\").Value = \"No\"       \n    '\n    ' the rest of your update code\n    '\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "is_accepted": false, "score": 1, "last_activity_date": 1529515987, "creation_date": 1529515987, "answer_id": 50953987, "question_id": 50953874, "link": "https://stackoverflow.com/questions/50953874/vba-value-changes-multiple-values/50953987#50953987", "title": "vba value changes multiple values", "body": "<p>Your Worksheet_Change routine is recursively triggering itself.</p>\n\n<p>Here's the simplest fix to that:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Static IsActive as boolean\n    If IsActive then Exit Sub\n    IsActive = True\n    If Range(\"D2\").Value = \"Small\" Then\n        Range(\"A7\").Value = \"Yes\"\n        Range(\"A8\").Value = \"No\"\n        Range(\"A11\").Value = \"No\"\n        Range(\"A14\").Value = \"No\"\n        Range(\"A15\").Value = \"No\"\n        Range(\"A16\").Value = \"No\"\n        Range(\"A17\").Value = \"Yes\"\n        Range(\"A18\").Value = \"Yes\"\n        Range(\"A19\").Value = \"No\"\n        Range(\"A20\").Value = \"No\"\n        Range(\"A21\").Value = \"No\"\n        Range(\"A22\").Value = \"No\"\n        Range(\"A23\").Value = \"Yes\"\n        Range(\"A24\").Value = \"Yes\"\n        Range(\"A25\").Value = \"Yes\"\n        Range(\"A26\").Value = \"Yes\"\n        Range(\"A27\").Value = \"Yes\"\n        Range(\"A28\").Value = \"Yes\"\n        Range(\"A29\").Value = \"Yes\"\n        Range(\"A30\").Value = \"Yes\"\n        Range(\"A33\").Value = \"No\"\n        Range(\"A34\").Value = \"No\"\n        Range(\"A35\").Value = \"Yes\"\n        Range(\"A36\").Value = \"Yes\"\n        Range(\"A39\").Value = \"Yes\"\n        Range(\"A40\").Value = \"No\"\n        Range(\"A41\").Value = \"No\"\n        Range(\"A42\").Value = \"No\"\n        Range(\"A43\").Value = \"No\"\n        Range(\"A44\").Value = \"No\"\n        Range(\"A45\").Value = \"No\"\n        Range(\"A46\").Value = \"No\"\n        Range(\"A47\").Value = \"No\"\n\n'Repeated ElseIf Statements for \"Medium\" &amp; \"Large\" with different yes/no values\n\n    ElseIf Range(\"D2\").Value = \"&lt;Select&gt;\" Then\n        Range(Rows(7), Rows(47)).Value = \"Yes\"\n   End If\n\n    '(absolutely MUST execute this line before exiting)\n    IsActive = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9968857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63ddc4453604ee8412dadba6fff2216?s=128&d=identicon&r=PG&f=1", "display_name": "GVJenn", "link": "https://stackoverflow.com/users/9968857/gvjenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 50953972, "answer_count": 2, "score": 1, "last_activity_date": 1529515987, "creation_date": 1529515546, "question_id": 50953874, "link": "https://stackoverflow.com/questions/50953874/vba-value-changes-multiple-values", "title": "vba value changes multiple values", "body": "<p>Completely lost newbie here.</p>\n\n<p>I am trying to get multiple, specific field values to change based on input from another field. I keep getting Out of Stack Space errors. Here is the code I have:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Range(\"D2\").Value = \"Small\" Then\n        Range(\"A7\").Value = \"Yes\"\n        Range(\"A8\").Value = \"No\"\n        Range(\"A11\").Value = \"No\"\n        Range(\"A14\").Value = \"No\"\n        Range(\"A15\").Value = \"No\"\n        Range(\"A16\").Value = \"No\"\n        Range(\"A17\").Value = \"Yes\"\n        Range(\"A18\").Value = \"Yes\"\n        Range(\"A19\").Value = \"No\"\n        Range(\"A20\").Value = \"No\"\n        Range(\"A21\").Value = \"No\"\n        Range(\"A22\").Value = \"No\"\n        Range(\"A23\").Value = \"Yes\"\n        Range(\"A24\").Value = \"Yes\"\n        Range(\"A25\").Value = \"Yes\"\n        Range(\"A26\").Value = \"Yes\"\n        Range(\"A27\").Value = \"Yes\"\n        Range(\"A28\").Value = \"Yes\"\n        Range(\"A29\").Value = \"Yes\"\n        Range(\"A30\").Value = \"Yes\"\n        Range(\"A33\").Value = \"No\"\n        Range(\"A34\").Value = \"No\"\n        Range(\"A35\").Value = \"Yes\"\n        Range(\"A36\").Value = \"Yes\"\n        Range(\"A39\").Value = \"Yes\"\n        Range(\"A40\").Value = \"No\"\n        Range(\"A41\").Value = \"No\"\n        Range(\"A42\").Value = \"No\"\n        Range(\"A43\").Value = \"No\"\n        Range(\"A44\").Value = \"No\"\n        Range(\"A45\").Value = \"No\"\n        Range(\"A46\").Value = \"No\"\n        Range(\"A47\").Value = \"No\"\n\n'Repeated ElseIf Statements for \"Medium\" &amp; \"Large\" with different yes/no values\n\n    ElseIf Range(\"D2\").Value = \"&lt;Select&gt;\" Then\n        Range(Rows(7), Rows(47)).Value = \"Yes\"\n   End If\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated. Thank you in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 2, "creation_date": 1529515655, "post_id": 50953783, "comment_id": 88905527, "body": "If they&#39;re all 2 digit numbers then I don&#39;t think there&#39;d be any problem just saying <code>Cl.Value = Left$(Cl.Value, 2)</code>. I&#39;d say it mostly depends on what different variations there are in your data"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1529515728, "post_id": 50953783, "comment_id": 88905563, "body": "This all depends on what other values might be in the range.  You need detail this more for us.  Do all of the values follow a specific format(s)?  If so, what are they?"}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "edited": false, "score": 0, "creation_date": 1529516184, "post_id": 50953783, "comment_id": 88905816, "body": "I&#39;ve updated my post - but yes, all the months fields will be in a &#39;XX Months&#39; format, and should always be a 2 digit month amount, followed by a space and the word Months"}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1529516391, "post_id": 50953783, "comment_id": 88905921, "body": "@Marcucciboy2 - Thank you!  This worked when I found the right place to put it.  (Thats what she said!)"}], "answers": [{"comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1529515841, "post_id": 50953915, "comment_id": 88905636, "body": "Oh, that&#39;s probably what the OP trying to do. I&#39;ll delete my answer."}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "edited": false, "score": 0, "creation_date": 1529516252, "post_id": 50953915, "comment_id": 88905846, "body": "Am getting an Invalid Procedure call or argument error with  <code>v = Left(Cl, Len(Cl) - 5)</code>  even after assigning it to a Dim."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1529515699, "creation_date": 1529515699, "answer_id": 50953915, "question_id": 50953783, "link": "https://stackoverflow.com/questions/50953783/trim-a-string-while-it-is-being-copied-to-new-cell/50953915#50953915", "title": "Trim a string while it is being copied to new cell", "body": "<p>Untested:</p>\n\n<pre><code>For Each Cl In wbFrom.Sheets(\"Sheet0\").Range(\"X9\", Range(\"X\" &amp; Rows.Count).End(xlUp))\n            v = Left(Cl, Len(Cl) - 5)\n            If Not .exists(v) Then\n                .Add v, Nothing\n            End If\nNext Cl\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "is_accepted": false, "score": 1, "last_activity_date": 1529517748, "last_edit_date": 1529517748, "creation_date": 1529516455, "answer_id": 50954116, "question_id": 50953783, "link": "https://stackoverflow.com/questions/50953783/trim-a-string-while-it-is-being-copied-to-new-cell/50954116#50954116", "title": "Trim a string while it is being copied to new cell", "body": "<p>This is a solution for those with the same issue, wanted to post it here.  </p>\n\n<pre><code>Dim Cl As Range\nWith CreateObject(\"scripting.dictionary\")\n    For Each Cl In wbFrom.Sheets(\"Sheet0\").Range(\"X9\", Range(\"X\" &amp; Rows.Count).End(xlUp))\n\n        Cl.Value = Left$(Cl.Value, 2)  '&lt;--- Magic spot\n\n        If Not .exists(Cl.Value) Then\n        .Add Cl.Value, Nothing\n        End If\n    Next Cl\n    wbTo.Sheets(\"Sheet1\").Range(\"D11\").Resize(.Count).Value = Application.Transpose(.keys)\nEnd With\n</code></pre>\n\n<p>This also seemed to work for me: </p>\n\n<pre><code>           Cla.Value = Replace(Cla.Value, \" Months\", \"\")\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529517748, "creation_date": 1529515176, "last_edit_date": 1529516139, "question_id": 50953783, "link": "https://stackoverflow.com/questions/50953783/trim-a-string-while-it-is-being-copied-to-new-cell", "title": "Trim a string while it is being copied to new cell", "body": "<p>I am currently using this to get the unique values from a column.  I am trying to modify that unique value and trim out characters before it pastes to the destination.</p>\n\n<pre><code>Dim Cl As Range\n\n    With CreateObject(\"scripting.dictionary\")\n        For Each Cl In wbFrom.Sheets(\"Sheet0\").Range(\"X9\", Range(\"X\" &amp; Rows.Count).End(xlUp))\n            If Not .exists(Cl.Value) Then\n            .Add Cl.Value, Nothing\n            'Cl.Value = Left(Cl, Len(Cl) - 5)\n            End If\n        Next Cl\n        wbTo.Sheets(\"Sheet1\").Range(\"F12\").Resize(.Count).Value = Application.Transpose(.keys)\n    End With\n</code></pre>\n\n<p>I am not sure where or how to implement the line: <code>Cl.Value = Left(Cl, Len(Cl) - 7)</code> or if this is even the best route. </p>\n\n<p>The source data is '36 Months' and I am trying to trim out anything except the numbers themselves, resulting in just '36' being paste into my field.  All of the values will be in an 'XX Months' format, and should always be 2 digits.  </p>\n\n<p>EDIT:  I also just noticed that the code above pastes into cell F13 instead of F12 - Any ideas why it is adding a row before being paste?  I suspect the 'transpose' aspect, but can't see any other reason.  </p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 9966787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42431947b3796adb38514522b8a2c38?s=128&d=identicon&r=PG&f=1", "display_name": "Th3FluffyAsian", "link": "https://stackoverflow.com/users/9966787/th3fluffyasian"}, "is_accepted": true, "score": 0, "last_activity_date": 1529515034, "creation_date": 1529515034, "answer_id": 50953747, "question_id": 50953521, "link": "https://stackoverflow.com/questions/50953521/pull-excel-data-table-entries-into-recipients-for-outlook-email-template/50953747#50953747", "title": "Pull Excel Data Table entries into recipients for Outlook email template", "body": "<p>Find the last row of your table and for loop through recipients. Check this out:</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/s1/outlook/mail.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s1/outlook/mail.htm</a></p>\n"}], "owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 50953747, "answer_count": 1, "score": 0, "last_activity_date": 1592985959, "creation_date": 1529514180, "last_edit_date": 1592985959, "question_id": 50953521, "link": "https://stackoverflow.com/questions/50953521/pull-excel-data-table-entries-into-recipients-for-outlook-email-template", "title": "Pull Excel Data Table entries into recipients for Outlook email template", "body": "<p>The goal is to connect an Excel data table/pivot table to an Outlook email template. </p>\n\n<p>Is there a way to pull the original entry creator out of a pivot table or table field into the recipient section to send an email? I'm trying to automate emailing multiple users from this data table. The information on who to email is in the table. </p>\n\n<p>This what I have so far:</p>\n\n<pre><code>Sub SendMail()\n    Dim olApp As Outlook.Application \n    Dim olMail As Outlook.MailItem \n    Dim  blRunning As Boolean\n\n    blRunning = True \n    on Error Resume Next \n    Set olApp = GetObject (,\"Outlook.Application\") \n    If olApp Is Nothing Then \n        Set olApp = New Outlook.Application \n        blRunning = False \n    End If  \n    On Error GoTo 0 \n\n    Set olMail = olApp.CreateItem(olMailItem) \n    With olMail \n        .Subject = \"Automatic Entry Support\" \n        .Recipients.Add \"J.Doe@gmail.com\"  \n        .Attachments.Add \"C:\\Users\\J.Doe\\Documents\\Project\\Template draft.xlsx\"  \n        .Body = \"Support message\" \n        .Display (\"Spell check, data attached?, SEND\")\n    End With\n    If Not blRunning Then olApp.Quit\n\n    Set olApp = Nothing\n    Set olMail = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sap-gui"], "comments": [{"owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "edited": false, "score": 0, "creation_date": 1530119140, "post_id": 50953510, "comment_id": 89126018, "body": "Does anyone know where the object &quot;SAPGUI&quot; is being pulled from? My only thought at this point is that the file/ program no longer exists in that location so I am trying to determine where to check for that."}], "answers": [{"tags": [], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "is_accepted": false, "score": 1, "last_activity_date": 1530544246, "creation_date": 1530544246, "answer_id": 51139173, "question_id": 50953510, "link": "https://stackoverflow.com/questions/50953510/after-sap-gui-update-to-7-40-vba-cant-connect-any-more/51139173#51139173", "title": "After SAP GUI Update to 7.40, VBA can&#39;t connect any more", "body": "<p>Okay upon reinstalling SAP I was given both the standard SAP logon pad and the newer SAP business client. The interface looked different in the business client but still contained script recording. I recorded and noticed that</p>\n\n<pre><code>Set SapGuiAuto = GetObject(\"SAPGUI\")\n</code></pre>\n\n<p>was now </p>\n\n<pre><code>Set SapGuiAuto = GetObject(\"SAPGUISERVER\")\n</code></pre>\n\n<p>This reconnected me to SAP correctly as it did before I upgraded from 7.3 to 7.4. It still will not connect if I use the logon pad for some reason but this is better than nothing. Basically the same, just a different look. </p>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1661, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1610052201, "creation_date": 1529514141, "last_edit_date": 1610052201, "question_id": 50953510, "link": "https://stackoverflow.com/questions/50953510/after-sap-gui-update-to-7-40-vba-cant-connect-any-more", "title": "After SAP GUI Update to 7.40, VBA can&#39;t connect any more", "body": "<p>so I made a handful of macros on SAP GUI 7.30 a few months ago, but my company recently required everyone to update to SAP GUI 7.40. None of my macros working anymore as it is having some sort of issue connecting to the SAPGUI.</p>\n<p>Up until now I have used this code to connect excel to SAP</p>\n<pre><code>Set SapGuiAuto = GetObject(&quot;SAPGUI&quot;)  'Get the SAP GUI Scripting object\n  Set SAPApp = SapGuiAuto.GetScriptingEngine 'Get the currently running SAP GUI\n  Set SAPCon = SAPApp.Children(0) 'Get the first system that is currently connected\n  Set session = SAPCon.Children(0) 'Get the first session (window) on that connection\n</code></pre>\n<p>But now I am receiving error : '-2147221020 (800401e4)' after the first line\nWhich is an Automation error and invalid syntax.</p>\n<p>Does anyone know how I can update my sheets to fix this issue?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1529514077, "post_id": 50953085, "comment_id": 88904661, "body": "if it works but is too big, couldnt you just keep decreasing the <code>7.5</code> until you get a size you want?"}, {"owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1529575675, "post_id": 50953085, "comment_id": 88927990, "body": "@Marcucciboy2, If I decrease it to a point where it works with one text string, then it won&#39;t work with text strings which contain bigger or smaller letters. eg &#39;X&#39; takes up more space than &#39;i&#39;. 7.5 seems to be the lowest value where don&#39;t loose letters."}], "answers": [{"comments": [{"owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "edited": false, "score": 0, "creation_date": 1529674487, "post_id": 50955067, "comment_id": 88972814, "body": "Cheers! It worked very well at zoom 100% but not when zoomed in or out. However I solved the issue by setting zoom to 100 then changing the ActiveX label then zooming back to the original."}, {"owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "edited": false, "score": 0, "creation_date": 1529674538, "post_id": 50955067, "comment_id": 88972850, "body": "Here&#39;s the new code: <code>Sub LabelLength()  Dim XYLabel As Shape Dim XYDataSheet As Worksheet Dim OrigZoom As Integer  Set XYDataSheet = ThisWorkbook.Sheets(1) Set XYLabel = XYDataSheet.Shapes(1)  OrigZoom = ActiveWindow.Zoom ActiveWindow.Zoom = 100  XYLabel.OLEFormat.Object.Object.Caption = XYDataSheet.Cells(1, 1).Value XYLabel.OLEFormat.Object.Object.WordWrap = False XYLabel.OLEFormat.Object.Object.AutoSize = True  ActiveWindow.Zoom = OrigZoom  End Sub</code>"}], "tags": [], "owner": {"reputation": 350, "user_id": 9686485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8549235061a10c547739aa876210ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Chip R.", "link": "https://stackoverflow.com/users/9686485/chip-r"}, "is_accepted": true, "score": 3, "last_activity_date": 1529520262, "creation_date": 1529520262, "answer_id": 50955067, "question_id": 50953085, "link": "https://stackoverflow.com/questions/50953085/change-excel-forms-label-length-to-match-the-length-of-its-text-using-vba/50955067#50955067", "title": "Change Excel forms Label Length to match the length of it&#39;s text using VBA", "body": "<p>I don't think this can be done with a Form control, at least not directly. If you want to stick with a Form control, I think you're on the right track with scaling its .width property based on the text size. To do it better than that, you'd probably have to build a dictionary object or something and sum the width of all characters in the string based on the width you had listed in the dictionary object.</p>\n\n<p>However, if you can switch your label to an ActiveX control, then you can solve this by using:</p>\n\n<pre><code>.WordWrap = False\n.AutoSize = True\n</code></pre>\n\n<p>I think people in general prefer to use Form controls because they're a bit more simple. But I also think, in general, ActiveX controls have more flexibility and you can customize them to your needs more. You can read a bit more on Form controls vs. ActiveX controls <a href=\"https://stackoverflow.com/questions/15455179/what-is-the-difference-between-form-controls-and-activex-control-in-excel-20\">here</a>.</p>\n"}], "owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 0, "accepted_answer_id": 50955067, "answer_count": 1, "score": 1, "last_activity_date": 1611312859, "creation_date": 1529512332, "last_edit_date": 1611312859, "question_id": 50953085, "link": "https://stackoverflow.com/questions/50953085/change-excel-forms-label-length-to-match-the-length-of-its-text-using-vba", "title": "Change Excel forms Label Length to match the length of it&#39;s text using VBA", "body": "<p>How can I get an Excel Form Control Label which is on a worksheet to change it's length to match the length of the sting of characters in it's caption. Importantly it must work irrispective of what screen the file is viewed on or what the zoom setting is on the sheet.</p>\n\n<p>So far I've got:</p>\n\n<pre><code>Sub LabelLength()\n\nDim XYLabel As Shape\nDim XYDataSheet As Worksheet\n\nSet XYDataSheet = ThisWorkbook.Sheets(1)\nSet XYLabel = XYDataSheet.Shapes(1) 'This is the Forms Label\n\nXYLabel.OLEFormat.Object.Caption = Trim(XYDataSheet.Cells(1, 1).Value)\nXYLabel.Width = Len(Trim(XYDataSheet.Cells(1, 1).Value)) * 7.5\n\n\nEnd Sub\n</code></pre>\n\n<p>Which works, but does leave quite a lot of space after some captions.</p>\n"}, {"tags": ["vba", "excel", "insert"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1529511997, "post_id": 50952856, "comment_id": 88903560, "body": "Some <a href=\"https://stackoverflow.com/search?q=vba+load+csv\">similar Q&amp;A&#39;s</a>. (Process would be the same for as loading a CSV to a specific location.)"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1529512071, "post_id": 50952856, "comment_id": 88903602, "body": "Take a look at <a href=\"https://stackoverflow.com/a/16668538/4717755\">this answer</a> for help in reading delimted data from a text file"}], "owner": {"reputation": 51, "user_id": 3908082, "user_type": "registered", "profile_image": "https://graph.facebook.com/615314568/picture?type=large", "display_name": "user25002", "link": "https://stackoverflow.com/users/3908082/user25002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529511522, "creation_date": 1529511522, "question_id": 50952856, "link": "https://stackoverflow.com/questions/50952856/vba-insert-specific-file-into-predetermined-location-on-worksheet", "title": "VBA: Insert specific file into predetermined location on worksheet", "body": "<p>New to VBA and trying to teach myself some simple macros to speed up some data tasks. I have a series of .txt files containing 2 tab delimited columns for time and observation (although these are recorded by our detectors as Filename and Label, respectively). I wish to create a macro to button choosing a file, and then inserting this file into a premade table. Once they are in this table I have other sheets that self populate and convert things into useful units (\"time\" is in the detector format, so it currently looks like R9061824.02#, hence the array). Basically this workbook would function as an analysis template.</p>\n\n<p>So far I have compiled a very basic code to open a given file by modifying a recording, but this creates a new workbook. </p>\n\n<pre><code>ChDir \"C:\\\"\nfName = Application.GetOpenFilename()\n\nWorkbooks.OpenText Filename:= _\n    fName, Origin:=1257, _\n    StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _\n    ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=False _\n    , Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 1)), _\n    TrailingMinusNumbers:=True\n</code></pre>\n\n<p>Would somebody be able to help me insert this into the active workbook? The sheet I want is called Input.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1529511652, "post_id": 50952808, "comment_id": 88903354, "body": "What have you tried so far? If this works for <code>CheckBox1</code>, can&#39;t you figure out how to make it work for <code>CheckBox2</code>, etc?  Also, you could do all your copy/past within an <code>If</code> block. there&#39;s no need to redundantly do the boolean <code>If Checkbox1.Value = True</code> four times :)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1529512061, "post_id": 50952808, "comment_id": 88903596, "body": "You&#39;re only referring to one checkbox."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1529512246, "creation_date": 1529512246, "answer_id": 50953061, "question_id": 50952808, "link": "https://stackoverflow.com/questions/50952808/excel-vba-using-checkboxes-to-select-row-and-paste-to-different-sheet/50953061#50953061", "title": "Excel VBA: Using Checkboxes to select row and paste to different sheet", "body": "<p>This works for Form control checkboxes:  </p>\n\n<p>Loop through each checkbox on your sheet and see if it's ticked.  If it is then look at the <code>TopLeftCell</code> to get the location of the checkbox and add the <code>EntireRow</code> to a range that you will eventually copy and paste onto the second sheet.</p>\n\n<pre><code>Sub Test()\n\n    Dim chkBx As Shape\n    Dim rngToCopy As Range\n\n    For Each chkBx In ThisWorkbook.Worksheets(\"Sheet1\").Shapes\n        If chkBx.Type = 8 Then\n            If chkBx.OLEFormat.Object.Value = 1 Then\n                If rngToCopy Is Nothing Then\n                    Set rngToCopy = chkBx.TopLeftCell.EntireRow\n                Else\n                    Set rngToCopy = Union(rngToCopy, chkBx.TopLeftCell.EntireRow)\n                End If\n            End If\n        End If\n    Next chkBx\n\n    rngToCopy.Copy Destination:=ThisWorkbook.Worksheets(\"Sheet2\").Range(\"A1\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9968513, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-22ufv-QW7KM/AAAAAAAAAAI/AAAAAAAAACo/E8ELboIazWg/photo.jpg?sz=128", "display_name": "Erik Ode", "link": "https://stackoverflow.com/users/9968513/erik-ode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 560, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1529512246, "creation_date": 1529511365, "last_edit_date": 1531164843, "question_id": 50952808, "link": "https://stackoverflow.com/questions/50952808/excel-vba-using-checkboxes-to-select-row-and-paste-to-different-sheet", "title": "Excel VBA: Using Checkboxes to select row and paste to different sheet", "body": "<p>I am trying to be able to select a checkbox next to a row of information and then click a button to paste to another sheet.  What I have here works but I want to be able to select multiple boxes and paste them to the other sheet with clicking the button once.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'TO Bid Numbers\n\n    'BID DATE\n    If CheckBox1.Value = True Then Sheets(\"Bidding\").Range(\"B3\").Copy Sheets(\"Bid Numbers\").Range(\"A1048576\").End(xlUp).Offset(1, 0)\n\n    'PROJECT NAME\n    If CheckBox1.Value = True Then Sheets(\"Bidding\").Range(\"C3\").Copy Sheets(\"Bid Numbers\").Range(\"B1048576\").End(xlUp).Offset(1, 0)\n\n    'ESTIMATOR\n    If CheckBox1.Value = True Then Sheets(\"Bidding\").Range(\"D3\").Copy Sheets(\"Bid Numbers\").Range(\"C1048576\").End(xlUp).Offset(1, 0)\n\n    'OUR PRICE\n    If CheckBox1.Value = True Then Sheets(\"Bidding\").Range(\"E3\").Copy Sheets(\"Bid Numbers\").Range(\"D1048576\").End(xlUp).Offset(1, 0)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "quantlib", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1529512565, "post_id": 50952720, "comment_id": 88903876, "body": "@ashleedawg and that question has been deleted.  This is at least the third incarnation of this question.  All under different names."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1529512652, "post_id": 50952720, "comment_id": 88903916, "body": "@ScottCraner - thanks for saving me the research. I&#39;ve re-answered."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1529512754, "post_id": 50952720, "comment_id": 88903961, "body": "@ashleedawg actually it is still active: <a href=\"https://stackoverflow.com/questions/50937338/how-do-i-call-a-function-not-present-in-the-list\" title=\"how do i call a function not present in the list\">stackoverflow.com/questions/50937338/&hellip;</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1529512880, "post_id": 50952720, "comment_id": 88904024, "body": "@ScottCraner - Frustrating.  And there was a third?  I&#39;ll FFM."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1529513064, "post_id": 50952720, "comment_id": 88904131, "body": "@ScottCraner possibly this one too: <a href=\"https://stackoverflow.com/questions/50938805/file-not-found-error-at-the-compilation-stage\" title=\"file not found error at the compilation stage\">stackoverflow.com/questions/50938805/&hellip;</a> ?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1529513270, "post_id": 50952720, "comment_id": 88904242, "body": "@Bhai - I&#39;d suggest you read about how <a href=\"https://meta.stackexchange.com/a/10844/370758\">Duplicate Questions</a> and <a href=\"https://meta.stackexchange.com/q/35593/370758\">multiple accounts</a> can get you a <a href=\"https://stackoverflow.com/help/question-bans\">Question Ban</a>.  It&#39;s a waste of time for others on the site."}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 2, "last_activity_date": 1529512615, "creation_date": 1529512615, "answer_id": 50953151, "question_id": 50952720, "link": "https://stackoverflow.com/questions/50952720/fddividendamericanengine-function-in-quantlib/50953151#50953151", "title": "FDDividendAmericanEngine Function in QuantLib", "body": "<p>It says clearly in the instructions in the link you provided:</p>\n\n<blockquote>\n  <p>Within Excel, the function is named - <code>CT.ENG.FDDividendAmericanEngine</code></p>\n</blockquote>\n\n<p>This means, in Excel, <strong>you should not use</strong>:</p>\n\n<pre><code>FDDividendAmericanEngine\n</code></pre>\n\n<p>...you <strong>should instead use</strong>:</p>\n\n<pre><code>CT.ENG.FDDividendAmericanEngine\n</code></pre>\n\n<hr>\n\n<p>To find out how to use functions from a third-party add-in, you need to consult the products documentation (as I just did), or Google for examples of others using the product, or else contact the add-in's developer. </p>\n"}], "owner": {"reputation": 1, "user_id": 9203810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2b496a17d1c6b5688953246ebba683a?s=128&d=identicon&r=PG&f=1", "display_name": "Bhai", "link": "https://stackoverflow.com/users/9203810/bhai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 50953151, "answer_count": 1, "score": -3, "last_activity_date": 1529512615, "creation_date": 1529511037, "last_edit_date": 1531164843, "question_id": 50952720, "link": "https://stackoverflow.com/questions/50952720/fddividendamericanengine-function-in-quantlib", "title": "FDDividendAmericanEngine Function in QuantLib", "body": "<p>How do I call Following Function:</p>\n\n<p>Function:\u00a0**</p>\n\n<ul>\n<li><strong>FDDividendAmericanEngine</strong></li>\n</ul>\n\n<p>**</p>\n\n<p>I was able to call Another function like this</p>\n\n<pre><code>blackScholesId = Application.Run( _\n\n\"qlGeneralizedBlackScholesProcess\", \"blackScholes\", _\n\nblackVolId, 36, \"Actual/365 (Fixed)\", 35932, 0.06, 0)\n</code></pre>\n\n<p>FDDividendAmericanEngine Function is not in the list of functions of QuantLib</p>\n\n<p><a href=\"https://www.quantlib.org/quantlibxl/allfunctions.html\" rel=\"nofollow noreferrer\"><strong>https://www.quantlib.org/quantlibxl/allfunctions.html</strong></a></p>\n\n<p>But the following link seems to indicate that one can call it:</p>\n\n<p><a href=\"http://www.quanttools.com/HTMLHelp/html/CT.06069.htm\" rel=\"nofollow noreferrer\"><strong>http://www.quanttools.com/HTMLHelp/html/CT.06069.htm</strong></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1529510568, "post_id": 50952517, "comment_id": 88902719, "body": "on which line?  Please indicate the line on which the error is thrown."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 5, "creation_date": 1529510804, "post_id": 50952517, "comment_id": 88902854, "body": "I can almost guarantee your error is related to all of those ugly mis-nested <code>With</code>&#39;s. I&#39;d suggested simplifying your code as per &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;.  I cleaned up the code&#39;s indentation and spacing.  Maybe take another look and see if those are all nested the way that you intended.  Better yet, remove <b>all</b> the <code>With</code>&#39;s and see if you still have the problem."}, {"owner": {"reputation": 1, "user_id": 6104672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9fb937787d5d4b26b256fcd78e0752?s=128&d=identicon&r=PG&f=1", "display_name": "s.amason", "link": "https://stackoverflow.com/users/6104672/s-amason"}, "edited": false, "score": 0, "creation_date": 1529511187, "post_id": 50952517, "comment_id": 88903056, "body": "You guys are right. can you help organize it better. cant find where am missing it"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1529511584, "post_id": 50952517, "comment_id": 88903305, "body": "Get rid of <code>With ThisWorkbook.Sheets(&quot;SHIFT PERFORMANCE DAYS&quot;)</code> and the nested WITH in there. There is no reason for all these <code>WITH</code> clauses. They are adding nothing to the code. Just do <code>sht2.Range(&quot;B&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = ThisWorkbook.Sheets(&quot;SHIFT PERFORMANCE DAYS&quot;).Range(&quot;AM1&quot;).value</code> for instance."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 1, "creation_date": 1529512306, "post_id": 50952517, "comment_id": 88903736, "body": "You should probably qualify more of your ranges and activity. Example is that you have <code>lastRow2 = Range(&quot;i&quot; &amp; Rows.Count).End(xlUp).Row</code> but you aren&#39;t specifying the sheet. This would explain why sometimes it works and sometimes it doesn&#39;t, it&#39;s looking at the activesheet. There are several instances of this which could be an issue for you. And yes... ditch the WITH statements. Use a variable instead to help keep track."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6104672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9fb937787d5d4b26b256fcd78e0752?s=128&d=identicon&r=PG&f=1", "display_name": "s.amason", "link": "https://stackoverflow.com/users/6104672/s-amason"}, "edited": false, "score": 0, "creation_date": 1529514707, "post_id": 50953397, "comment_id": 88905028, "body": "This is so much better. Thank you. is it possible to autofill column B and C to the last cell on column D or E."}, {"owner": {"reputation": 1, "user_id": 6104672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9fb937787d5d4b26b256fcd78e0752?s=128&d=identicon&r=PG&f=1", "display_name": "s.amason", "link": "https://stackoverflow.com/users/6104672/s-amason"}, "edited": false, "score": 0, "creation_date": 1529523288, "post_id": 50953397, "comment_id": 88909138, "body": "Not really. it copied both the formatting and formulas. However, am trying to run away from &quot;.copy statement&quot; but with less &quot;with statements&quot;"}], "tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 2, "last_activity_date": 1529519440, "last_edit_date": 1529519440, "creation_date": 1529513686, "answer_id": 50953397, "question_id": 50952517, "link": "https://stackoverflow.com/questions/50952517/cant-figure-why-theres-an-error/50953397#50953397", "title": "Cant figure why theres an error", "body": "<p>Okay it took A LOT of deciphering, but I think that I've straightened out what you were doing into a way that doesn't use a ton of <code>With</code> statements.</p>\n\n<pre><code>Sub movedata3()\n\n    Dim sheetLog As Worksheet\n    Dim sheetDays As Worksheet\n    Dim sheetNights As Worksheet\n\n    Set sheetLog = Workbooks.Open(\"\\\\NMFPLPCLB130010\\Public\\PACKAGING\\tracker.xlsm\").Sheets(\"log\") 'set destination sheet as sheet 1 of the opened workbook\n    Set sheetDays = ThisWorkbook.Sheets(\"SHIFT PERFORMANCE DAYS\")\n    Set sheetNights = ThisWorkbook.Sheets(\"PKG Avail nights\")\n\n\n    'getting the last non-empty row in \"PKG Avail nights\"\n    Dim lastRow As Long\n    lastRow = sheetNights.Range(\"D5:O37\").Find(\"*\", SearchDirection:=xlPrevious).row\n\n    'copying from \"PKG Avail nights\" into the next open cell in \"log\"\n    sheetNights.Range(\"D5:F\" &amp; lastRow).Copy _\n        Destination:=sheetLog.Range(\"D\" &amp; sheetLog.Rows.count).End(xlUp).Offset(1, 0)\n\n    sheetNights.Range(\"K5:O\" &amp; lastRow).Copy _\n        Destination:=sheetLog.Range(\"G\" &amp; sheetLog.Rows.count).End(xlUp).Offset(1, 0)\n\n\n    'copying from \"SHIFT PERFORMANCE DAYS\" into the next open cell in \"log\"\n    Dim lastRowD As Long\n    lastRowD = sheetLog.Range(\"D\" &amp; sheetLog.Rows.count).End(xlUp).Offset(1, 0)\n\n    sheetDays.Range(\"AM1\").Copy _\n        Destination:=sheetLog.Range(\"B\" &amp; lastRowD)\n\n\n    Dim lastRowE As Long\n    lastRowE = sheetLog.Range(\"E\" &amp; sheetLog.Rows.count).End(xlUp).Offset(1, 0)\n\n    sheetDays.Range(\"J1\").Copy _\n        Destination:=sheetLog.Range(\"C\" &amp; lastRowE)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6104672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff9fb937787d5d4b26b256fcd78e0752?s=128&d=identicon&r=PG&f=1", "display_name": "s.amason", "link": "https://stackoverflow.com/users/6104672/s-amason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1529519440, "creation_date": 1529510442, "last_edit_date": 1531164843, "question_id": 50952517, "link": "https://stackoverflow.com/questions/50952517/cant-figure-why-theres-an-error", "title": "Cant figure why theres an error", "body": "<p>When I run the code below sometimes it runs good and most of the time it give me an error message, run-time '91' error (Object Variable or with block variable not set). is there something am missing. please I need your help</p>\n\n<pre><code>Sub movedata3()\n    Dim lastRow As Long\n    Dim sht2 As Worksheet\n    Dim lastRow2 As Long\n    Set sht2 = Workbooks.Open(\"\\\\NMFPLPCLB130010\\Public\\PACKAGING\\tracker.xlsm\").Sheets(\"log\") 'set destination sheet as sheet 1 of the opened workbook\n    lastRow2 = Range(\"i\" &amp; Rows.Count).End(xlUp).Row\n    lngLast = Range(\"b\" &amp; Rows.Count).End(xlUp).Row\n    With ThisWorkbook.Sheets(\"PKG Avail nights\") ' reference \"source\" sheet\n        lastRow = .Range(\"D5:O37\").Find(\"*\", SearchDirection:=xlPrevious).Row\n        With .Range(\"D:F\").Rows(\"5:\" &amp; lastRow) ' reference referenced sheet columns D to F cells from row 5 down to 'LastRow'\n            sht2.Range(\"D\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Resize(.Rows.Count, .Columns.Count).Value = .Value ' paste referenced range values to \"destination\" sheet form column D first empty cell after last not empty one\n        End With\n        With .Range(\"K:O\").Rows(\"5:\" &amp; lastRow)\n            sht2.Range(\"G\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Resize(.Rows.Count, .Columns.Count).Value = .Value\n            With ThisWorkbook.Sheets(\"SHIFT PERFORMANCE DAYS\")\n                With .Range(\"AM1\")\n                    sht2.Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = .Value\n                End With\n                With .Range(\"J1\")\n                    sht2.Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = .Value\n                End With\n            End With\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "debugging"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1529510644, "post_id": 50952483, "comment_id": 88902773, "body": "<a href=\"http://stackoverflow.com/questions/418960/managing-and-debugging-sql-queries-in-ms-access/1099570#1099570\">How to debug dynamic SQL in VBA</a>"}], "answers": [{"comments": [{"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1529511387, "post_id": 50952781, "comment_id": 88903179, "body": "Thank you. I realized it later on."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 1, "creation_date": 1529511478, "post_id": 50952781, "comment_id": 88903241, "body": "Or use my <i>CSql</i> function <a href=\"https://stackoverflow.com/questions/43589800/syntax-error-in-insert-into-statement-whats-the-error/43591778#43591778\">here</a>."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1529511258, "creation_date": 1529511258, "answer_id": 50952781, "question_id": 50952483, "link": "https://stackoverflow.com/questions/50952483/debugging-access-vba-currentdb-execute/50952781#50952781", "title": "Debugging Access VBA Currentdb.Execute", "body": "<p>As a start, provide valid string expressions for the values - not everything is text - and respect reserved words:</p>\n\n<pre><code>CurrentDb.Execute \"insert into invoices (Stateid, companyid, PaymentYear, InvoiceDate, [Type], MethodofPayment, [date], amount) \" &amp; _\n\"Values('\" &amp; Me.StateID &amp; \"','cOOKIE',\" &amp; Me.PaymentYear &amp; \", #\" &amp; Format(Me.InvoiceDate, \"yyyy\\/mm\\/dd\") &amp; \"#, \" &amp; _\n\"'\" &amp; Me.Type &amp; \"','\" &amp; Me.MethodofPayment &amp; \"',#\" &amp; Format(Me.Date, \"yyyy\\/mm\\/dd\") &amp; \"#,\" &amp; Str(Me.Amount) &amp; \");\"\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 50952781, "answer_count": 1, "score": 0, "last_activity_date": 1594022597, "creation_date": 1529510340, "last_edit_date": 1594022597, "question_id": 50952483, "link": "https://stackoverflow.com/questions/50952483/debugging-access-vba-currentdb-execute", "title": "Debugging Access VBA Currentdb.Execute", "body": "<p>It says invalid insert statement when I run this code.    </p>\n\n<pre><code>CurrentDb.Execute \"insert into invoices (Stateid, companyid, PaymentYear,InvoiceDate,Type,MethodofPayment,date,amount) \" &amp; _\n\"values('\" &amp; Me.StateID &amp; \"','cOOKIE','\" &amp; Me.PaymentYear &amp; \"', '\" &amp; Me.InvoiceDate &amp; \"',\" _\n&amp; \"'\" &amp; Me.Type &amp; \"','\" &amp; Me.MethodofPayment &amp; \"','\" &amp; Me.Date &amp; \"','\" &amp; Me.Amount &amp; \"');\"\n</code></pre>\n"}, {"tags": ["vba", "factory"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 4, "creation_date": 1529512267, "post_id": 50952482, "comment_id": 88903710, "body": "You need to read some discussions on classes in VBA, specifically about Factories. See the <a href=\"https://rubberduckvba.wordpress.com/2016/01/11/oop-in-vba-immutability-the-factory-pattern/\" rel=\"nofollow noreferrer\">Rubberduck Blog</a> and <a href=\"https://hammondmason.wordpress.com/2015/07/09/object-oriented-vba-design-patterns-simple-factory/\" rel=\"nofollow noreferrer\">these ramblings</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1529513136, "post_id": 50952482, "comment_id": 88904175, "body": "@PeterT beat me to it! :D"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 9836176, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Lucius Matos", "link": "https://stackoverflow.com/users/9836176/lucius-matos"}, "is_accepted": false, "score": 1, "last_activity_date": 1529585349, "creation_date": 1529585349, "answer_id": 50968991, "question_id": 50952482, "link": "https://stackoverflow.com/questions/50952482/how-to-implement-the-factory-project-pattern-in-vba/50968991#50968991", "title": "How to implement the Factory project pattern in VBA?", "body": "<p><a href=\"https://i.stack.imgur.com/oWxTc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oWxTc.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>In the default module create: </p>\n\n<p>modEnumPizza</p>\n\n\n\n<pre><code>Public Enum enumTypePizza\n\n    Pepperoni\n    Cheese\n\nEnd Enum\n</code></pre>\n\n<p>modMain</p>\n\n\n\n<pre><code>Sub Main()\n\n    Dim objPizza As IPizza\n    Dim objFactory As Factory\n\n    Set objFactory = New Factory\n\n    Set objPizza = objFactory.CreatingPizza(Cheese, \"Cheese Pizza\", \"mozzarella, oregano, olive, simple sauce\", 25.99)\n\n    Debug.Print \"Name: \" &amp; objPizza.getName\n    Debug.Print \"Ingredients: \" &amp; objPizza.getIngredients\n    Debug.Print \"Price: \" &amp; objPizza.getPrice\n\n    Set objPizza = objFactory.CreatingPizza(Pepperoni, \"Pepperoni Pizza\",     \"Calabresa, onion, olive, oregano\", 30.99)\n\n    Debug.Print \"Name: \" &amp; objPizza.getName\n    Debug.Print \"Ingredients: \" &amp; objPizza.getIngredients\n    Debug.Print \"Price: \" &amp; objPizza.getPrice\n\nEnd Sub    \n</code></pre>\n\n<p>In the class module create:</p>\n\n<p>IPizza</p>\n\n\n\n<pre><code>Sub create(ByVal name As String, ByVal ingredients As String, ByVal price As Double): End Sub\nProperty Get getName() As String: End Property\nProperty Get getIngredients() As String: End Property\nProperty Get getPrice() As Long: End Property\n</code></pre>\n\n<p>clsCheese</p>\n\n\n\n<pre><code>Implements IPizza\nImplements ICreate\n\nPrivate Type TType\n    name As String\n    ingredients As String\n    price As Double    \nEnd Type\n\nPrivate this As TType\n\nPrivate Sub IPizza_create(ByVal name As String, ByVal ingredients As String, ByVal price As Double)\n\n    With this\n        .name = name\n        .ingredients = ingredients\n        .price = price\n    End With\n\nEnd Sub\n\nPrivate Property Get IPizza_getIngredients() As String\n    IPizza_getIngredients = this.ingredients\nEnd Property\n\nPrivate Property Get IPizza_getName() As String\n    IPizza_getName = this.name\nEnd Property\n\nPrivate Property Get IPizza_getPrice() As Long\n    IPizza_getPrice = this.price\nEnd Property\n</code></pre>\n\n<p>clsPepperoni</p>\n\n\n\n<pre><code>Implements IPizza\n\nPrivate Type TType\n    name As String\n    ingredients As String\n    price As Double    \nEnd Type\n\nPrivate this As TType\n\nPrivate Sub IPizza_create(ByVal name As String, ByVal ingredients As String, ByVal price As Double)\n\n    With this\n        .name = name\n        .ingredients = ingredients\n        .price = price\n    End With\n\nEnd Sub\n\nPrivate Property Get IPizza_getIngredients() As String\n    IPizza_getIngredients = this.ingredients\nEnd Property\n\nPrivate Property Get IPizza_getName() As String\n    IPizza_getName = this.name\nEnd Property\n\nPrivate Property Get IPizza_getPrice() As Long\n    IPizza_getPrice = this.price\nEnd Property\n</code></pre>\n\n<p>Factory</p>\n\n\n\n<pre><code>Function CreatingPizza(ByVal enumPizza As enumTypePizza, ByVal name As String, ByVal ingredients As String, ByVal price As Double) As IPizza\n\n    Dim objPizza As IPizza\n\n    If enumPizza = Cheese Then\n\n        Set objPizza = New clsCheese\n\n    ElseIf enumPizza = Pepperoni Then\n\n        Set objPizza = New clsPepperoni\n\n    End If\n\n    objPizza.create name, ingredients, price\n\n    Set CreatingPizza = objPizza\n\nEnd Function\n</code></pre>\n\n<p>For details on the Factory default, you can refer to the \"Use Head - Design Patterns\" book.</p>\n\n<p>Run Main from the modMain module and see the Verification window (CTRL + G).</p>\n\n<p>Note that in the 'Factory' class we have the 'CreatingPizza' function, where we select the type of pizza being created, by means of Enum type (enumPizza). If we have dozens of different pizzas to create we will have dozens of IF's. If we have to get flavors from the module modEnumPizza, we will have to change 'CreatingPizza'.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gWpsy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gWpsy.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>In addition, the 'create' method is visible in IntelliSense. If this and fact that we have many IFs does not please you, one solution, which is what I use is this:</p>\n\n<p>Create an interface responsible for the 'create' method:</p>\n\n<p>ICreateCheese\n</p>\n\n<pre><code>Function create(ByVal name As String, ByVal ingredients As String, ByVal price As Double) As IPizza: End Function\n</code></pre>\n\n<p>ICreatePepperoni \n</p>\n\n<pre><code>Function create(ByVal name As String, ByVal ingredients As String, ByVal price As Double) As IPizza: End Function\n</code></pre>\n\n<p>Now remove the 'crete' method from IPizza:</p>\n\n<p>IPizza\n</p>\n\n<pre><code>Property Get getName() As String: End Property\nProperty Get getIngredients() As String: End Property\nProperty Get getPrice() As Long: End Property\n</code></pre>\n\n<p>Now clsChesse and clsPepperoni respectively implement ICreateChesse and ICreatePepperoni.</p>\n\n<p>clsCheese \n</p>\n\n<pre><code>Implements IPizza\nImplements ICreateChesse\n\nPrivate Type TType\n    name As String\n    ingredients As String\n    price As Double\n\nEnd Type\n\nPrivate this As TType\n\nPrivate Function ICreateChesse_create(ByVal name As String, ByVal ingredients As String, ByVal price As Double) As IPizza\n\n    With this\n        .name = name\n        .ingredients = ingredients\n        .price = price\n    End With\n\n    Set ICreateChesse_create = Me\n\nEnd Function\n\nPrivate Property Get IPizza_getIngredients() As String\n    IPizza_getIngredients = this.ingredients\nEnd Property\n\nPrivate Property Get IPizza_getName() As String\n    IPizza_getName = this.name\nEnd Property\n\nPrivate Property Get IPizza_getPrice() As Long\n    IPizza_getPrice = this.price\nEnd Property\n</code></pre>\n\n<p>clsPepperoni \n</p>\n\n<pre><code>Implements IPizza\nImplements ICreatePepperoni\n\nPrivate Type TType\n    name As String\n    ingredients As String\n    price As Double\n\nEnd Type\n\nPrivate this As TType\n\nPrivate Function ICreatePepperoni_create(ByVal name As String, ByVal ingredients As String, ByVal price As Double) As IPizza\n\n    With this\n        .name = name\n        .ingredients = ingredients\n        .price = price\n    End With\n\n    Set ICreatePepperoni_create = Me\n\nEnd Function\n\nPrivate Property Get IPizza_getIngredients() As String\n    IPizza_getIngredients = this.ingredients\nEnd Property\n\nPrivate Property Get IPizza_getName() As String\n    IPizza_getName = this.name\nEnd Property\n\nPrivate Property Get IPizza_getPrice() As Long\n    IPizza_getPrice = this.price\nEnd Property\n</code></pre>\n\n<p>Factory\n</p>\n\n<pre><code>Implements ICreateChesse\nImplements ICreatePepperoni\n\nPrivate Type TType\n    'Could be a Dictionary References =&gt; Microsoft Scripting Runtime\n    objCollection As Collection\n    objPizza As IPizza\n\nEnd Type\n\nPrivate this As TType\n\nPrivate Sub Class_Initialize()\n\n    Dim objInterfaceChesse As ICreateChesse\n    Dim objInterfacePepperoni As ICreatePepperoni\n\n    Set objInterfaceChesse = Me\n    Set objInterfacePepperoni = Me\n\n    Set this.objCollection = New Collection\n\n\n    'We now have a collection of instance variables pointing to ICreateChesse_create and\n    'ICreatePepperoni_create\n    With this.objCollection\n\n        .Add objInterfaceChesse, CStr(enumTypePizza.Cheese)\n        .Add objInterfacePepperoni, CStr(enumTypePizza.Pepperoni)\n\n    End With\n\n\nEnd Sub\n\n\nFunction CreatingPizza(ByVal enumPizza As enumTypePizza, ByVal name As String, ByVal ingredients As String, ByVal price As Double) As IPizza\n\n    Dim objInterface As Object\n\n                       'we return the corresponding instance variable\n    Set objInterface = this.objCollection(CStr(enumPizza))\n\n                        'method call by late binding\n    Set CreatingPizza = objInterface.create(name, ingredients, price)\n\nEnd Function\n\n\nPrivate Function ICreateChesse_create(ByVal name As String, ByVal ingredients As String, ByVal price As Double) As IPizza\n\n    Dim objPizza As clsCheese\n    Dim objInterfaceChesse As ICreateChesse\n\n    'We create an instance of clsPizza\n    Set objPizza = New clsCheese\n\n    'We point to the interface address in clsChesse\n    Set objInterfaceChesse = objPizza\n\n    'I call the 'create' method of the instance of clsPizza, which returns the interface I`Pizza\n    Set ICreateChesse_create = objInterfaceChesse.create(name, ingredients, price)\n\n    Set objPizza = Nothing\n    Set objInterfaceChesse = Nothing\n\nEnd Function\n\nPrivate Function ICreatePepperoni_create(ByVal name As String, ByVal ingredients As String, ByVal price As Double) As IPizza\n\n    Dim objPizza As clsPepperoni\n    Dim objInterfacePepperoni As ICreatePepperoni\n\n    Set objPizza = New clsPepperoni\n\n    Set objInterfacePepperoni = objPizza\n\n    Set ICreatePepperoni_create = objInterfacePepperoni.create(name, ingredients, price)\n\n    Set objPizza = Nothing\n    Set objInterfacePepperoni = Nothing\n\nEnd Function\n</code></pre>\n\n<p>ModMain does not change.</p>\n\n<p>And the project looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2dd3y.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2dd3y.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Another alternative that avoids the use of a Factory class data structure would be this:\nCreate an interface called ISelectCreator, where we can return by intelliSense which interface to use: ICreateChesse or ICreatePepperoni.</p>\n\n<p>With this we can exclude the module modEnumPizza. In addition, the modMain module will also be modified, as the Factory class will change.</p>\n\n<p>Here's the new refactoring in the Factory class and the creation of the ISelectCreator interface:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FP52o.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FP52o.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>ISelectCreator \n</p>\n\n<pre><code>Property Get getCreateChesse() As ICreateChesse: End Property\nProperty Get getCreatePepperoni() As ICreatePepperoni: End Property\n</code></pre>\n\n<p>Factory\n</p>\n\n<pre><code>Implements ISelectCreator\n\nFunction CreatingPizza() As ISelectCreator\n\n    'with this intelliSense will show: getCreateChesse and getCreatePepperoni\n    Set CreatingPizza = Me\n\nEnd Function\n\nPrivate Property Get ISelectCreator_getCreateChesse() As ICreateChesse\n\n    Dim objPizza As clsCheese\n\n    Set objPizza = New clsCheese\n\n    Set ISelectCreator_getCreateChesse = objPizza\n\nEnd Property\n\nPrivate Property Get ISelectCreator_getCreatePepperoni() As ICreatePepperoni\n\n    Dim objPizza As clsPepperoni\n\n    Set objPizza = New clsPepperoni\n\n    Set ISelectCreator_getCreatePepperoni = objPizza\n\nEnd Property\n</code></pre>\n\n<p>The Factory class is much simpler.</p>\n\n<p>modMain: Main\n</p>\n\n<pre><code>Sub Main()\n\n    Dim objPizza As IPizza\n    Dim objFactory As Factory\n\n    Set objFactory = New Factory\n\n    Set objPizza = objFactory.CreatingPizza.getCreateChesse.create(\"Cheese Pizza\", \"mozzarella, oregano, olive, simple sauce\", 25.99)\n\n    Debug.Print \"Name: \" &amp; objPizza.getName\n    Debug.Print \"Ingredients: \" &amp; objPizza.getIngredients\n    Debug.Print \"Price: \" &amp; objPizza.getPrice\n\n    Set objPizza = objFactory.CreatingPizza.getCreatePepperoni.create(\"Pepperoni     Pizza\", \"Calabresa, onion, olive, oregano\", 30.99)\n\n    Debug.Print \"Name: \" &amp; objPizza.getName\n    Debug.Print \"Ingredients: \" &amp; objPizza.getIngredients\n    Debug.Print \"Price: \" &amp; objPizza.getPrice\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/0v8GF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0v8GF.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/y28oA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y28oA.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Actually this is the way I currently use it. So that's it, Factory Method is possible yes.</p>\n"}], "owner": {"reputation": 11, "user_id": 9968518, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oD9x3kxsmMY/AAAAAAAAAAI/AAAAAAAAB7M/2tywE1Exg7w/photo.jpg?sz=128", "display_name": "Soledade", "link": "https://stackoverflow.com/users/9968518/soledade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1071, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529585349, "creation_date": 1529510335, "question_id": 50952482, "link": "https://stackoverflow.com/questions/50952482/how-to-implement-the-factory-project-pattern-in-vba", "title": "How to implement the Factory project pattern in VBA?", "body": "<p>I would like to know if it is possible to apply to the Factory Method project pattern within the limitations of VBA. If it is possible, would you have an example?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1529513569, "post_id": 50952295, "comment_id": 88904407, "body": "Do you have <code>option explicit</code> at the top of your code modules? Is <code>ActiveUserForm</code> a global variable you&#39;re referencing?"}, {"owner": {"reputation": 36, "user_id": 9766571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ting Fung Li", "link": "https://stackoverflow.com/users/9766571/ting-fung-li"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1529538910, "post_id": 50952295, "comment_id": 88914400, "body": "Yes, I put option explicit at the top of module1 and frmAddRecord2. ActiveUserForm is global variable in module1; txtMaxLv is a global variable in frmAddRecord2. And while the function is using, the userform is still showing on the screen."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1529540619, "post_id": 50952295, "comment_id": 88914772, "body": "What type of variable do you have <code>ActiveUserForm</code> as? I think it may need to be <code>Variant</code> for the userform properties to be accessible."}, {"owner": {"reputation": 36, "user_id": 9766571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ting Fung Li", "link": "https://stackoverflow.com/users/9766571/ting-fung-li"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1529550807, "post_id": 50952295, "comment_id": 88916716, "body": "I set ActiveUserForm as userform"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1529585622, "post_id": 50952295, "comment_id": 88934372, "body": "Try changing <code>Dim ActiveUserForm as Userform</code> to <code>Dim ActiveUserForm as Object</code>."}, {"owner": {"reputation": 36, "user_id": 9766571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ting Fung Li", "link": "https://stackoverflow.com/users/9766571/ting-fung-li"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1529596941, "post_id": 50952295, "comment_id": 88942254, "body": "Mistella, Thank you very much for your guidance, after you remind me about &quot;varient&quot;, I have tried when I go back home after work. And it really works. However, I am curious why &quot;userform&quot; is not the key to the type. So I go a step further to find out the reason. And in a website I learnt a new function &quot;typename()&quot;, to check frmAddRecord2, and it returns me frmAddRecord2 as well. I finally understand it is a class. I think this is a very good learningexperience to me. Thank you very much."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1529599935, "post_id": 50952295, "comment_id": 88943854, "body": "I&#39;m glad you were able to learn more from this experience. I added the information as an answer, so if someone else has a similar issue, they won&#39;t have to dig through the comments."}], "answers": [{"tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": true, "score": 0, "last_activity_date": 1529599836, "creation_date": 1529599836, "answer_id": 50973785, "question_id": 50952295, "link": "https://stackoverflow.com/questions/50952295/replacing-userform-name-with-variable/50973785#50973785", "title": "Replacing userform name with variable", "body": "<p>The Global variable <code>ActiveUserForm</code> was given the type of <code>Userform</code>. However, to access UserForm properties from a Userform variable, it actually needs to be of type <code>Object</code> or <code>Variant</code>.</p>\n"}], "owner": {"reputation": 36, "user_id": 9766571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ting Fung Li", "link": "https://stackoverflow.com/users/9766571/ting-fung-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50973785, "answer_count": 1, "score": 0, "last_activity_date": 1529599836, "creation_date": 1529509741, "last_edit_date": 1531164843, "question_id": 50952295, "link": "https://stackoverflow.com/questions/50952295/replacing-userform-name-with-variable", "title": "Replacing userform name with variable", "body": "<p>I have the following function put in \"Module1\" determine the maximum value of a text box in user form, named \"frmAddRecord2\", that can be input.</p>\n\n<p>txtLV and txtMaxLV are textboxes under \"frmAddRecord2\".</p>\n\n<p>And txtMaxLV_Pass is a boolean variable put under frmAddRecord2 as well. At this stage, this function works fine.</p>\n\n<pre><code>Public Function txtLV_Max() As Long\n\n    With frmAddRecord2\n        If .txtLV.Value &gt;= 99 Or Not .txtMaxLV_Pass Then\n            txtLV_Max = 109\n        Else\n            txtLV_Max = .txtMaxLV.Value - 1\n        End If\n    End With\n\nEnd Function\n</code></pre>\n\n<p>As I will have \"frmAddRecord1\", \"frmAddRecord2\", \"frmAddRecord3\" ... etc, so I would like to call the following sub when frmAddRecord1 or frmAddRecord2 \n is activated.</p>\n\n<pre><code>Public Sub SetActiveUserForm(Optional UserFormName As String)\n\n    If UserFormName = \"frmAddRecord1\" Then\n        Set ActiveUserForm = frmAddRecord1\n        UserFormShown = True\n    ElseIf UserFormName = \"frmAddRecord2\" Then\n        Set ActiveUserForm = frmAddRecord2\n        UserFormShown = True\n    Else\n        Set ActiveUserForm = Nothing\n        UserFormShown = False\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>And I would like to restructure the function as:</p>\n\n<pre><code>Public Function txtLV_Max() As Long\n\n    With activeuserform\n        If .txtLV.Value &gt;= 99 Or Not .txtMaxLV_Pass Then\n            txtLV_Max = 109\n        Else\n            txtLV_Max = .txtMaxLV.Value - 1\n        End If\n    End With\n\nEnd Function\n</code></pre>\n\n<p>However, error occur at the Line \"If .txtLV.Value >= 99 Or Not <strong><em>.txtMaxLV_Pass</em></strong> Then\" . After testing, the txtMaxLV_Pass is found failed to be call after I restructured the function. And it work fine again if I moved txtMaxLV_Pass to be public under Module1.</p>\n\n<p>But I would like to ask, if I want to keep the txtMaxLV_Pass under the userform, what should I changed in declare the userform variable. Please advice, I have studied this in web site and books, but still not able to tackle. Thank you for all your help.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1529510430, "post_id": 50952266, "comment_id": 88902628, "body": "That&#39;s an odd behavior for a button. Are you sure you didn&#39;t use a toggle button by accident? If yes, please provide the <code>_Click()</code> event procedure code (a minimal example that shows the behavior)."}, {"owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1529510697, "post_id": 50952266, "comment_id": 88902805, "body": "Haha. You&#39;re right. Turns out it is a toggle button!  Thanks for your help! If you want to post it as an answer I&#39;ll accept it!"}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 3, "last_activity_date": 1529514102, "creation_date": 1529514102, "answer_id": 50953498, "question_id": 50952266, "link": "https://stackoverflow.com/questions/50952266/button-on-form-looks-like-it-is-being-constantly-pressed-after-being-clicked/50953498#50953498", "title": "Button on form looks like it is being constantly pressed after being clicked", "body": "<p>A regular button can stay depressed for a short while, while its <code>_Click()</code> event procedure is running.</p>\n\n<p>But once that finishes, it always returns to its normal state.</p>\n\n<p>So the assumption was, that a <strong>toggle button</strong> was used instead, which turned out to be correct.</p>\n"}], "owner": {"reputation": 341, "user_id": 8183516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c68736dde5eadf868d276a2b1b65b76a?s=128&d=identicon&r=PG&f=1", "display_name": "budekatude", "link": "https://stackoverflow.com/users/8183516/budekatude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 50953498, "answer_count": 1, "score": 0, "last_activity_date": 1529514102, "creation_date": 1529509630, "last_edit_date": 1529510311, "question_id": 50952266, "link": "https://stackoverflow.com/questions/50952266/button-on-form-looks-like-it-is-being-constantly-pressed-after-being-clicked", "title": "Button on form looks like it is being constantly pressed after being clicked", "body": "<p>I have a form in Access 2013 that uses a button to jump to another form.\nHowever when the button is clicked certain requirements have to be met in order for the jump process to actually be executed. If the requirements are not met the user is forced to stay on the current form (with the button).</p>\n\n<p>When this happens the button stays in the clicked (i.e. pressed down) state on the form, making it look like it's being constantly pressed.\n(Note: If the button is clicked again and the requirements again aren't met it pops back out...)</p>\n\n<p><a href=\"https://i.stack.imgur.com/PIjX0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PIjX0.png\" alt=\"Button in unclicked state (left), and button that stays in clicked state (right)\"></a></p>\n\n<p>Is there any way to change the appearance of the button back to the unclicked appearance after every click when the user is forced to stay on the current form?</p>\n\n<p>Many thanks in advance for any kind of help!</p>\n"}, {"tags": ["excel", "vba", "range", "copy-paste"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1529510501, "post_id": 50951870, "comment_id": 88902677, "body": "A quick note - when you use <code>Cells()</code> you must also make sure you specify the worksheet.  You have <code>With wsDest &#47;&#47; .Range(Cells(), Cells()).Copy</code>  but you don&#39;t link to the worksheet for <code>Cells()</code>.  Make sure to link those to <code>wsDest</code> with the <code>.</code> &quot;anchor&quot;."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1529567312, "post_id": 50951870, "comment_id": 88922886, "body": "Keep <code>ScreenUpdating</code> True to see what happens. (You can turn it off later when you finished testing.) I would check if the &quot;hangup&quot; happens at the 9th file or at that specific file. Have you tried removing/replacing the 9th file or running the macro solely for that file?"}, {"owner": {"reputation": 1, "user_id": 9968292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b2669b0b63f4c3a1feb2cac51ac028b?s=128&d=identicon&r=PG&f=1", "display_name": "Excelling Slowly", "link": "https://stackoverflow.com/users/9968292/excelling-slowly"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1529582767, "post_id": 50951870, "comment_id": 88932553, "body": "@BruceWayne the wsDest variable is defined in the line above as the specific sheet that is part of the variable workbook wbDest defined in the previous line. This seems to be ok, but I am curious if defining the wbDest =workbooks.open() approach is causing excel to try to reopen that workbook everytime wsDest and by reference wbDest is used, or if once it is open, it already recognizes that variable as that workbook now?"}, {"owner": {"reputation": 1, "user_id": 9968292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b2669b0b63f4c3a1feb2cac51ac028b?s=128&d=identicon&r=PG&f=1", "display_name": "Excelling Slowly", "link": "https://stackoverflow.com/users/9968292/excelling-slowly"}, "reply_to_user": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1529582915, "post_id": 50951870, "comment_id": 88932650, "body": "@AcsErno I am looking into that 9th file, but can&#39;t find anything just yet. Is there any issue with the tab name having the ( ) characters in it? I know I have had issues in macros before because of spaces or different characters, but it works for the first few files."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9968292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b2669b0b63f4c3a1feb2cac51ac028b?s=128&d=identicon&r=PG&f=1", "display_name": "Excelling Slowly", "link": "https://stackoverflow.com/users/9968292/excelling-slowly"}, "is_accepted": false, "score": 0, "last_activity_date": 1529665880, "creation_date": 1529665880, "answer_id": 50986660, "question_id": 50951870, "link": "https://stackoverflow.com/questions/50951870/excel-vba-copy-paste-between-range-of-workbooks/50986660#50986660", "title": "Excel VBA Copy/Paste Between Range of Workbooks", "body": "<p>Ok, finally figured this one out. Cleaned the code up to make it clearer, but I believe my issue was not in the code specifically, but rather in the fact that I did not have files created yet for some of the date based information I was trying to pull, i.e. I had dates for files to be created in the future and no error checking to see if those files existed. I haven't added the error checking, rather I just deleted the future date references for now as that was faster.</p>\n\n<pre><code>Sub copy_rng()\nDim wb As Workbook, wbToOpen As Workbook, ws As Worksheet, wsSource As Worksheet\nDim wbNames() As Variant\nDim filePath As String\nDim outputrow As Variant, i As Byte\nDim srcOneRange As Range, srcTwoRange As Range, srcThreeRange As Range\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Casing\")\nwbNames = ws.Range(\"b5:b\" &amp; lrow(2, ws))\n\nfilePath = \"C:\\Users\\...\\Daily Reports\\\" 'set path to your path\noutputrow = 5\n\nFor i = 1 To UBound(wbNames, 1)\n    Application.ScreenUpdating = False\n\n    Set wbToOpen = Workbooks.Open(filePath &amp; wbNames(i, 1))\n    Set wsSource = wbToOpen.Sheets(\"Field Report (Internal)\")\n\n    Set srcOneRange = wsSource.Range(\"q27:s27\")\n    Set srcTwoRange = wsSource.Range(\"q28:s28\")\n    Set srcThreeRange = wsSource.Range(\"q29:s29\")\n\n    ws.Activate\n\n    With ws\n        .Range(Cells(outputrow, 10), Cells(outputrow, 12)).Value = srcOneRange.Cells.Value\n        .Range(Cells(outputrow, 13), Cells(outputrow, 15)).Value = srcTwoRange.Cells.Value\n        .Range(Cells(outputrow, 16), Cells(outputrow, 18)).Value = srcThreeRange.Cells.Value\n    End With\n\n\n    wbToOpen.Close False\n\n    outputrow = outputrow + 1\n\n    Application.ScreenUpdating = True\n\n    DoEvents\n    ActiveWindow.SmallScroll down:=1\n\n    Application.WindowState = Application.WindowState\n\nNext i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9968292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b2669b0b63f4c3a1feb2cac51ac028b?s=128&d=identicon&r=PG&f=1", "display_name": "Excelling Slowly", "link": "https://stackoverflow.com/users/9968292/excelling-slowly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529665880, "creation_date": 1529508487, "question_id": 50951870, "link": "https://stackoverflow.com/questions/50951870/excel-vba-copy-paste-between-range-of-workbooks", "title": "Excel VBA Copy/Paste Between Range of Workbooks", "body": "<p>I used to code in VBA frequently, but its been a few years and I am stumped. Have an issue with the following code that seems to work fine (although very slowly) for the first 9 files it is opening / copying from, then I get a macro error and it results in an excel hang-up requiring restart. I borrowed / modified heavily an earlier post from luke_t on this forum to get this far. As far as I can tell, there is no difference in the 9th file as they are all based on a standard template, but the error could be there?</p>\n\n<pre><code>    Sub copy_rng()\nDim wb As Workbook, wbDest As Workbook, ws As Worksheet, wsDest As Worksheet, wsSrc As Worksheet\nDim wbNames() As Variant\nDim destPath As String\nDim fullpath As String\nDim outputrow As Variant, i As Byte\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Casing\")\nSet wsSrc = wb.Sheets(\"Casing\")\nwbNames = ws.Range(\"b5:b\" &amp; lrow(2, ws))\n\ndestPath = \"C:\\Users\\...\\Daily Reports\\\"\noutputrow = 5\n\nApplication.ScreenUpdating = False\n\nFor i = 1 To UBound(wbNames, 1)\n\n    fullpath = destPath &amp; wbNames(i, 1)\n    MsgBox i &amp; \" \" &amp; fullpath\n    'Stop\n\n    Set wbDest = Workbooks.Open(destPath &amp; wbNames(i, 1))\n    Set wsDest = wbDest.Sheets(\"Field Report (Internal)\")\n\n    With wsDest\n        .Range(Cells(27, 17), Cells(27, 19)).Copy\n    End With\n    wsSrc.Cells(outputrow, 10).PasteSpecial xlPasteValues\n\n    With wsDest\n        .Range(Cells(28, 17), Cells(28, 19)).Copy\n    End With\n    wsSrc.Cells(outputrow, 13).PasteSpecial xlPasteValues\n\n    With wsDest\n        .Range(Cells(29, 17), Cells(29, 19)).Copy\n    End With\n    wsSrc.Cells(outputrow, 16).PasteSpecial xlPasteValues\n\n    Application.CutCopyMode = False\n\n    wbDest.Close False\n\n    outputrow = outputrow + 1\n\nNext i\n\nApplication.ScreenUpdating = True\n    End Sub\n\n    Function lrow(ByVal col_num As Integer, sheet_name As Worksheet) As Long\nlrow = sheet_name.Cells(Rows.Count, col_num).End(xlUp).Row\n    End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1529512555, "post_id": 50951828, "comment_id": 88903870, "body": "If in <code>sheet1</code>, &quot;Item 1&quot; appears twice and has two different colours, how do yo decide which colour should be used in <code>sheet2</code>? It might be a good idea to post sample data and expected outcome."}, {"owner": {"reputation": 1, "user_id": 9968201, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1uKHv8i1bCY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FEjG7laKBYS2oy0QjED2XEEN31Q/mo/photo.jpg?sz=128", "display_name": "Sim", "link": "https://stackoverflow.com/users/9968201/sim"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1529527939, "post_id": 50951828, "comment_id": 88911115, "body": "While working through an example I wanted to post, I confirmed that the scenario I was given to work with did not foresee that &quot;Item 1&quot; could have multiple states."}, {"owner": {"reputation": 1, "user_id": 9968201, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1uKHv8i1bCY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FEjG7laKBYS2oy0QjED2XEEN31Q/mo/photo.jpg?sz=128", "display_name": "Sim", "link": "https://stackoverflow.com/users/9968201/sim"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1529528010, "post_id": 50951828, "comment_id": 88911140, "body": "I will post a workbook now that contains the examples and scenario."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9968201, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1uKHv8i1bCY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FEjG7laKBYS2oy0QjED2XEEN31Q/mo/photo.jpg?sz=128", "display_name": "Sim", "link": "https://stackoverflow.com/users/9968201/sim"}, "edited": false, "score": 0, "creation_date": 1529528937, "post_id": 50954174, "comment_id": 88911506, "body": "Does this example workbook help? I have amended my framework to accommodate the scenario that @cybernetic.nomad posed. <a href=\"https://www.dropbox.com/s/lh3jgyuxxomea9s/Example.xlsx?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/lh3jgyuxxomea9s/Example.xlsx?dl=0</a>"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 1, "user_id": 9968201, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1uKHv8i1bCY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FEjG7laKBYS2oy0QjED2XEEN31Q/mo/photo.jpg?sz=128", "display_name": "Sim", "link": "https://stackoverflow.com/users/9968201/sim"}, "edited": false, "score": 0, "creation_date": 1529587236, "post_id": 50954174, "comment_id": 88935477, "body": "SIm, I&#39;m at work so i can&#39;t get to the example, i will try to look at it when i have time this weekend."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1529516672, "creation_date": 1529516672, "answer_id": 50954174, "question_id": 50951828, "link": "https://stackoverflow.com/questions/50951828/mirror-fill-colour-after-text-match-of-cells-between-2-sheets/50954174#50954174", "title": "mirror fill colour after text match of cells between 2 sheets", "body": "<p>Below is basic code to mirror the current color in a cell if the cells values match. You can modify it to fit your needs.</p>\n\n<pre><code>Dim ws1 As Worksheet\nSet ws1 = ThisWorkbook.Worksheets(1)\nDim ws2 As Worksheet\nSet ws2 = ThisWorkbook.Worksheets(2)\n\n    If ws2.Range(\"A2\").Value = ws1.Range(\"A2\").Value Then\n        ws2.Range(\"A2\").Interior.Color = ws1.Range(\"A2\").DisplayFormat.Interior.Color\n    End If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9968201, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1uKHv8i1bCY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2FEjG7laKBYS2oy0QjED2XEEN31Q/mo/photo.jpg?sz=128", "display_name": "Sim", "link": "https://stackoverflow.com/users/9968201/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529516672, "creation_date": 1529508311, "last_edit_date": 1531161705, "question_id": 50951828, "link": "https://stackoverflow.com/questions/50951828/mirror-fill-colour-after-text-match-of-cells-between-2-sheets", "title": "mirror fill colour after text match of cells between 2 sheets", "body": "<p>I have the following problem which I've spent a lot of time researching with no luck. From the forums on this site, I have come to learn that half of my problem can only be solved by VB. I am not proficient so I will need assistance in tacking together the complete solution.</p>\n\n<p>Sheet 1 column A contains a list of items. These items have conditional formatting applied to them, and their fill colours change according to selections in column B, also on sheet 1.</p>\n\n<p>Sheet 2 also contains a column A with list of items.</p>\n\n<p>Sheet 1 column A contains duplicate items. Sheet 2 column A contains unique values. Therefore, we will have to perform a lookup across a range. </p>\n\n<p>I need on sheet 2, where there is a text match between any items between sheet 1 and sheet 2, for the matching cell/s to return the fill colour of the matched cell in sheet 1 column 1.</p>\n\n<p>My logic:</p>\n\n<p>If Sheet2!$A1 finds a match in Sheet1!$A1, then cell on sheet 2 that matches must change its fill colour to match the reference cell on sheet 1.</p>\n\n<p>I have Kutools but could find no way to make it work. I could also not find a way in Excel with conditional formatting.</p>\n\n<p>The end product of this is to link each item in sheet 2 column A, to a smart object in PowerPoint (cell pasted into text field as linked Excel item). </p>\n\n<p>Whenever the colour of an item on sheet 1 column A changes as a result of conditional formatting isolated there, the colour will change in sheet 2 and will reflect in the corresponding item in PowerPoint.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>-Sim</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 586, "user_id": 3495713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SLYAw.jpg?s=128&g=1", "display_name": "Manpreet Singh Dhillon", "link": "https://stackoverflow.com/users/3495713/manpreet-singh-dhillon"}, "is_accepted": false, "score": 0, "last_activity_date": 1529507774, "creation_date": 1529507774, "answer_id": 50951634, "question_id": 50951556, "link": "https://stackoverflow.com/questions/50951556/search-cell-for-two-separate-strings-using-instr/50951634#50951634", "title": "Search cell for two separate strings using InStr", "body": "<p>Just change the condition : </p>\n\n<pre><code>If InStr(1, cell.Value, \"iPad Pro 10.5\", vbTextCompare) &gt; 0 Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If InStr(1, cell.Value, \"iPad Pro\", vbTextCompare) &gt; 0  and If InStr(1, cell.Value, \"10.5\", vbTextCompare) &gt; 0 Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 1, "creation_date": 1529508447, "post_id": 50951666, "comment_id": 88901326, "body": "I <code>Like</code> this solution, because it respects string order. To make it work case-insensitive: <code>If LCase(cell.Value) Like &quot;*ipad pro*10.5*&quot; Then</code>"}], "tags": [], "owner": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "is_accepted": false, "score": 1, "last_activity_date": 1529507862, "creation_date": 1529507862, "answer_id": 50951666, "question_id": 50951556, "link": "https://stackoverflow.com/questions/50951556/search-cell-for-two-separate-strings-using-instr/50951666#50951666", "title": "Search cell for two separate strings using InStr", "body": "<p>You can use the <code>Like</code> operator to see if a String matches a pattern.</p>\n\n<pre><code>If cell.Value Like \"*iPad Pro*10.5*\" Then\n</code></pre>\n\n<p>This will be a match if the cell contains any string where both \"iPad Pro\" and \"10.5\" are substrings, in that order.</p>\n"}], "owner": {"reputation": 63, "user_id": 7704270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5793c5d918bf6c50fbc6330780d49f1b?s=128&d=identicon&r=PG&f=1", "display_name": "christopherhlee", "link": "https://stackoverflow.com/users/7704270/christopherhlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529507862, "creation_date": 1529507496, "last_edit_date": 1531164843, "question_id": 50951556, "link": "https://stackoverflow.com/questions/50951556/search-cell-for-two-separate-strings-using-instr", "title": "Search cell for two separate strings using InStr", "body": "<p>I have a conditional that will enter \"PRO1 10.5\" into cell H1 if \"iPad Pro 10.5\" can be found in cell A1. But, the formatting varies and \"iPad Pro\" and \"10.5\" may be separated in A1 -- For example: </p>\n\n<blockquote>\n  <p>\"Apple iPad Pro 2nd Gen. 64GB, Wi-Fi, 10.5in Space Gray\"</p>\n</blockquote>\n\n<p>For cases such as this, how should I search for these two divided strings to end with my desired result? There are several other sizes and models that require specific classification, too.</p>\n\n<p>Here is my current code</p>\n\n<pre><code>For Each cell In SrchRng\n    If InStr(1, cell.Value, \"iPad Pro 10.5\", vbTextCompare) &gt; 0 Then\n        cell.Offset(0, 7).Value = \"PRO1 10.5\"\n    End If\nNext cell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7500588, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158202726035464/picture?type=large", "display_name": "Alex Allen", "link": "https://stackoverflow.com/users/7500588/alex-allen"}, "edited": false, "score": 0, "creation_date": 1529566780, "post_id": 50952054, "comment_id": 88922582, "body": "Thanks Division. . One thing I&#39;m confused about is how do a) exclude more than one sheet within the script. also how do I amend the source copy one column across. As the data I want to copy from each sheet is in cells C21:F40"}], "tags": [], "owner": {"reputation": 28, "user_id": 4195417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hPDd3.png?s=128&g=1", "display_name": "DvisionX", "link": "https://stackoverflow.com/users/4195417/dvisionx"}, "is_accepted": false, "score": 0, "last_activity_date": 1529509023, "creation_date": 1529509023, "answer_id": 50952054, "question_id": 50951369, "link": "https://stackoverflow.com/questions/50951369/combined-data-from-multiple-sheets-into-one-sheet/50952054#50952054", "title": "Combined data from multiple sheets into one sheet", "body": "<p>Some of this post is vague to exactly what you need, but I think what you are looking for can be found here:</p>\n\n<p><a href=\"https://danwagner.co/how-to-combine-data-from-multiple-sheets-into-a-single-sheet/\" rel=\"nofollow noreferrer\">Merge Data From Multiple Sheets Onto One Sheet</a></p>\n\n<p>However, if you are not familiar with VBA, even this website, followed exactly may be difficult. </p>\n"}], "owner": {"reputation": 1, "user_id": 7500588, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158202726035464/picture?type=large", "display_name": "Alex Allen", "link": "https://stackoverflow.com/users/7500588/alex-allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1529566870, "creation_date": 1529507039, "last_edit_date": 1529566870, "question_id": 50951369, "link": "https://stackoverflow.com/questions/50951369/combined-data-from-multiple-sheets-into-one-sheet", "title": "Combined data from multiple sheets into one sheet", "body": "<p>I have data within cells C21:F40 on multiple sheets (excluded merge and loadfile sheets) that I want to copy onto one  master sheet (Merge). Once the data has been consolidated on the Merge sheet I then want to sum col c and remove any duplicates.</p>\n\n<p><a href=\"https://i.stack.imgur.com/V292q.jpg\" rel=\"nofollow noreferrer\">Data example</a></p>\n\n<p>I've looked everywhere and cannot find anything that can do the above so any help would be greatly appreciated</p>\n\n<p>Option Explicit\nPublic Sub CombineDataFromAllSheets()</p>\n\n<pre><code>Dim wksSrc As Worksheet, wksDst As Worksheet\nDim rngSrc As Range, rngDst As Range\nDim lngLastCol As Long, lngSrcLastRow As Long, lngDstLastRow As Long\n\n'Notes: \"Src\" is short for \"Source\", \"Dst\" is short for \"Destination\"\n\n'Set references up-front\nSet wksDst = ThisWorkbook.Worksheets(\"Import\")\nlngDstLastRow = LastOccupiedRowNum(wksDst) '&lt;~ defined below (and in Toolbelt)!\nlngLastCol = LastOccupiedColNum(wksDst) '&lt;~ defined below (and in Toolbelt)!\n\n'Set the initial destination range\nSet rngDst = wksDst.Cells(lngDstLastRow + 1, 1)\n\n'Loop through all sheets\nFor Each wksSrc In ThisWorkbook.Worksheets\n\n    'Make sure we skip the \"Import\" destination sheet!\n    If wksSrc.Name &lt;&gt; \"Import\" Then\n\n        'Identify the last occupied row on this sheet\n        lngSrcLastRow = LastOccupiedRowNum(wksSrc)\n\n        'Store the source data then copy it to the destination range\n        With wksSrc\n            Set rngSrc = .Range(.Cells(2, 4), .Cells(lngSrcLastRow, lngLastCol))\n            rngSrc.Copy Destination:=rngDst\n        End With\n\n        'Redefine the destination range now that new data has been added\n        lngDstLastRow = LastOccupiedRowNum(wksDst)\n        Set rngDst = wksDst.Cells(lngDstLastRow + 1, 1)\n\n    End If\n\nNext wksSrc\n</code></pre>\n\n<p>End Sub</p>\n\n<p>'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'INPUT       : Sheet, the worksheet we'll search to find the last row\n'OUTPUT      : Long, the last occupied row\n'SPECIAL CASE: if Sheet is empty, return 1\nPublic Function LastOccupiedRowNum(Sheet As Worksheet) As Long\n    Dim lng As Long\n    If Application.WorksheetFunction.CountA(Sheet.Cells) &lt;> 0 Then\n        With Sheet\n            lng = .Cells.Find(What:=\"*\", _\n                              After:=.Range(\"B1\"), _\n                              Lookat:=xlPart, _\n                              LookIn:=xlFormulas, _\n                              SearchOrder:=xlByRows, _\n                              SearchDirection:=xlPrevious, _\n                              MatchCase:=False).Row\n        End With\n    Else\n        lng = 1\n    End If\n    LastOccupiedRowNum = lng\nEnd Function</p>\n\n<p>'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'INPUT       : Sheet, the worksheet we'll search to find the last column\n'OUTPUT      : Long, the last occupied column\n'SPECIAL CASE: if Sheet is empty, return 1\nPublic Function LastOccupiedColNum(Sheet As Worksheet) As Long\n    Dim lng As Long\n    If Application.WorksheetFunction.CountA(Sheet.Cells) &lt;> 0 Then\n        With Sheet\n            lng = .Cells.Find(What:=\"*\", _\n                              After:=.Range(\"B1\"), _\n                              Lookat:=xlPart, _\n                              LookIn:=xlFormulas, _\n                              SearchOrder:=xlByColumns, _\n                              SearchDirection:=xlPrevious, _\n                              MatchCase:=False).Column\n        End With\n    Else\n        lng = 1\n    End If\n    LastOccupiedColNum = lng\nEnd Function</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1529507044, "post_id": 50951305, "comment_id": 88900405, "body": "You&#39;re missing a backslash at the end of <code>savePATH</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529507240, "post_id": 50951305, "comment_id": 88900551, "body": "You haven&#39;t provided a filename."}], "answers": [{"comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529507819, "post_id": 50951381, "comment_id": 88900940, "body": "I missed that. But perhaps sFile is declared as module variable (yuk)?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529511845, "post_id": 50951381, "comment_id": 88903468, "body": "Seems not from the question and the described outcome (folder name is used as the filename)"}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 1, "last_activity_date": 1529507069, "creation_date": 1529507069, "answer_id": 50951381, "question_id": 50951305, "link": "https://stackoverflow.com/questions/50951305/excel-file-not-saving-to-the-correct-path/50951381#50951381", "title": "Excel file not saving to the correct path", "body": "<p>You must add the trailing backslash:</p>\n\n<pre><code>Sub Save_Book()\n\nDim savePATH As String\n\nsavePATH = \"\\\\ftl-store\\Departments\\HR\\HR Reports and Metrics\\LOA Reports\\BRT Reports\\\"\n\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = False\n\n\nActiveWorkbook.SaveAs Filename:=savePATH &amp; sFile, FileFormat:=51\n\n    Application.DisplayAlerts = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1832, "user_id": 2494051, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/73978fba31cf292b557173dc597e5186?s=128&d=identicon&r=PG", "display_name": "Jose M.", "link": "https://stackoverflow.com/users/2494051/jose-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 50951381, "answer_count": 1, "score": 0, "last_activity_date": 1529507069, "creation_date": 1529506884, "question_id": 50951305, "link": "https://stackoverflow.com/questions/50951305/excel-file-not-saving-to-the-correct-path", "title": "Excel file not saving to the correct path", "body": "<p>I wrote the following procedure to save my file to a network path:</p>\n\n<pre><code>Sub Save_Book()\n\nDim savePATH As String\n\nsavePATH = \"\\\\ftl-store\\Departments\\HR\\HR Reports and Metrics\\LOA Reports\\BRT Reports\"\n\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = False\n\n\nActiveWorkbook.SaveAs Filename:=savePATH &amp; sFile, FileFormat:=51\n\n    Application.DisplayAlerts = False\n\nEnd Sub\n</code></pre>\n\n<p>However, my procedure is not working correctly.  Its saving the file to the path, but the correct path. It saves the file to here: <code>\\\\ftl-store\\Departments\\HR\\HR Reports and Metrics\\LOA Reports\\BRT Reports\"</code> Thus missing the destination folder. </p>\n\n<p>Instead of saving the file to the path it takes this part: </p>\n\n<pre><code>BRT Reports\n</code></pre>\n\n<p>and shows as part of my file name when it saves.  </p>\n\n<p>Any help will be appreciated.</p>\n"}, {"tags": ["ms-access", "vba", "autohotkey"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1529507289, "post_id": 50951258, "comment_id": 88900583, "body": "It seems really unlikely this makes a difference, as long as <code>MyDB</code> is a valid path. Start by verifying it is."}, {"owner": {"reputation": 63, "user_id": 6356172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184ce542d2545edcec36cbcd18924adc?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Thompson", "link": "https://stackoverflow.com/users/6356172/dale-thompson"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1529507374, "post_id": 50951258, "comment_id": 88900637, "body": "Access could not open the correct file if the path was not valid. The file is open in a read-only state."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6356172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184ce542d2545edcec36cbcd18924adc?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Thompson", "link": "https://stackoverflow.com/users/6356172/dale-thompson"}, "edited": false, "score": 0, "creation_date": 1529515533, "post_id": 50953627, "comment_id": 88905462, "body": "Thank you, that worked! Erik was right as well. Access was able to open the file using forward slashes instead of backslashes but perhaps interpreted the path as a network or Internet path instead of a local path. I&#39;m not sure why I thought the slashes were being turned around. The script doesn&#39;t need the replacement function at all--that line can be omitted."}], "tags": [], "owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "is_accepted": true, "score": 1, "last_activity_date": 1529514603, "creation_date": 1529514603, "answer_id": 50953627, "question_id": 50951258, "link": "https://stackoverflow.com/questions/50951258/autohotkeys-script-opens-access-file-as-read-only/50953627#50953627", "title": "AutoHotKeys script opens Access file as read-only", "body": "<p>So, your problem <em>most likely</em> the <code>StringReplace</code> functionality you are using. </p>\n\n<p>First, <code>StringReplace</code> is a depreciated function, the current one is <code>StrReplace</code>.</p>\n\n<p>Second, it looks like you are attempting to change all instances of <code>/</code> to <code>\\</code>, however, this is not what you are accomplishing with that function. In fact, you are doing the opposite. What you likely meant to do was <code>StringReplace, MyDb, MyDb, /, \\, All</code>. </p>\n\n<p>This would change all instances of <code>/</code> to <code>\\</code>, instead of <code>\\</code> to <code>/</code>, which would make more sense in this scenario.</p>\n"}], "owner": {"reputation": 63, "user_id": 6356172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184ce542d2545edcec36cbcd18924adc?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Thompson", "link": "https://stackoverflow.com/users/6356172/dale-thompson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 50953627, "answer_count": 1, "score": 1, "last_activity_date": 1529514603, "creation_date": 1529506758, "last_edit_date": 1529510336, "question_id": 50951258, "link": "https://stackoverflow.com/questions/50951258/autohotkeys-script-opens-access-file-as-read-only", "title": "AutoHotKeys script opens Access file as read-only", "body": "<p>Using AutoHotkeys to launch a Microsoft Access application in an unknown path, the script works only when the path and file name are given literally. When the script instead uses a variable, Access opens the file but as read-only. </p>\n\n<p>Why? Is there a fix? </p>\n\n<p>Does the script lack some permission?</p>\n\n<p>The file opens normally using this:</p>\n\n<p><code>acc := ComObjCreate(\"Access.Application\")</code><br>\n<code>acc.OpenCurrentDatabase(\"d:\\MyDatabases\\MyDB.accdb\")</code><br>\n<code>acc.Visible := true</code><br>\n<code>acc := Nothing</code> </p>\n\n<p>The file opens read-only using this:</p>\n\n<p><code>MyDB := A_ScriptDir \"/MyDB.accdb\"</code><br>\n<code>StringReplace,MyDB,MyDB,\\,/,All</code><br>\n<code>acc := ComObjCreate(\"Access.Application\")</code><br>\n<code>acc.OpencurrentDatabase(MyDB)</code><br>\n<code>acc.Visible := true</code><br>\n<code>acc := Nothing</code></p>\n\n<p>Edit: </p>\n\n<p>I\u2019ve found a substitute that works:  </p>\n\n<p><code>MyDB := A_ScriptDir \"/MyDB.accdb\"</code><br>\n<code>StringReplace,MyDB,MyDB,\\,/,All</code><br>\n<code>acc := ComObjGet(MyDB)</code><br>\n<code>acc := Nothing</code>  </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1529507401, "post_id": 50951205, "comment_id": 88900656, "body": "<code>After:=Range(&quot;F1&quot;)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1529507650, "post_id": 50951205, "comment_id": 88900828, "body": "<a href=\"https://stackoverflow.com/q/10714251/1188513\">Obligatory link to <i>avoid select and activate</i></a>"}], "answers": [{"tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 3, "last_activity_date": 1529507468, "creation_date": 1529507468, "answer_id": 50951550, "question_id": 50951205, "link": "https://stackoverflow.com/questions/50951205/vba-error-13-with-find-code/50951550#50951550", "title": "VBA Error 13 With Find code", "body": "<p>What causes error in this <code>Find</code> method is:</p>\n\n<pre><code>After:=ActiveCell\n</code></pre>\n\n<p>You can't search after cell which is not in searched range, column F in this case. Your active cell is not in column F.</p>\n"}], "owner": {"reputation": 41, "user_id": 9968164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pOv5L.png?s=128&g=1", "display_name": "bullfrog97", "link": "https://stackoverflow.com/users/9968164/bullfrog97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 50951550, "answer_count": 1, "score": 0, "last_activity_date": 1529507468, "creation_date": 1529506610, "question_id": 50951205, "link": "https://stackoverflow.com/questions/50951205/vba-error-13-with-find-code", "title": "VBA Error 13 With Find code", "body": "<p>I am having an issue with type mismatch, in my table the value is general since it is copied and pasted values from a pivot table</p>\n\n<p>Error thrown here:</p>\n\n<pre><code>Set mf = Columns(\"F\").Find(What:=ONE, After:=ActiveCell, LookIn:= _\nxlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\nxlNext, MatchCase:=False, SearchFormat:=False)\n\n\n\nDim ONE As String\n\nWorksheets(\"Chart\").Activate\nColumns(\"A:B\").Select\nSelection.Copy\nRange(\"F1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"F2\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nONE = Cells(2, \"F\").Value\nSheets(\"Paste Data Table\").Select\n\nSet mf = Columns(\"F\").Find(What:=ONE, After:=ActiveCell, LookIn:= _\n    xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n    xlNext, MatchCase:=False, SearchFormat:=False)\n\nActiveCell.EntireRow.Select\n\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Top 5 Breakdown\").Select\n\nSheets(\"Top 5 Breakdown\").Select\nRange(\"A2\").Select\nActiveSheet.Paste\nWorksheets(\"Paste Data Table\").Activate\nRange(\"A2\").Select\nApplication.CutCopyMode = False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 1, "creation_date": 1529507125, "post_id": 50951155, "comment_id": 88900462, "body": "I have tested this in Excel 2016 and it is working on both countdowns of the ActiveCell and also the testButton caption. They are displaying each number as it counts down. What version of excel are you using?"}, {"owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "reply_to_user": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1529538637, "post_id": 50951155, "comment_id": 88914324, "body": "Excel for Mac Version 15.41"}], "answers": [{"comments": [{"owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "edited": false, "score": 0, "creation_date": 1529538806, "post_id": 50951838, "comment_id": 88914377, "body": "The DoEvents call doesn&#39;t make a difference for me. Likely it is some Excel for Mac issue."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "edited": false, "score": 2, "creation_date": 1529539503, "post_id": 50951838, "comment_id": 88914546, "body": "Specifying it was a Mac from the start would have helped... Mac and ActiveX don&#39;t really play well. Replace the button with a shape (you&#39;ll get a much nicer looking button anyway), and assign it to a macro instead of handling its <code>Click</code> event. You&#39;ll be able to access it through the <code>Shapes</code> collection of your worksheet; declare a <code>Shape</code> object to access its properties, including its text content."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1529525935, "last_edit_date": 1529525935, "creation_date": 1529508374, "answer_id": 50951838, "question_id": 50951155, "link": "https://stackoverflow.com/questions/50951155/change-the-excel-button-caption-property-inside-of-a-loop/50951838#50951838", "title": "Change the Excel.Button.Caption property inside of a loop?", "body": "<p>Likely some repaint isn't happening, whatever the reason is (assuming <code>Application.ScreenUpdating</code> isn't turned off... which shouldn't be the case, since the cell value does get updated).</p>\n\n<p>Add a <code>DoEvents</code> call after the <code>Caption</code> assignment.</p>\n\n<pre><code>For i = COUNTDOWN To 0 Step -1\n    ActiveCell.FormulaR1C1 = i\n    testButton.Caption = i\n    DoEvents '&lt;~ let Excel process what just happened\n    Application.Wait Now + TimeValue(\"00:00:01\")\nNext i\n</code></pre>\n\n<p>That will also let Excel process any pending events and Windows messages.</p>\n"}], "owner": {"reputation": 264, "user_id": 3124279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64378a977307311f5255088d3b165dbf?s=128&d=identicon&r=PG&f=1", "display_name": "alwaysLearningABC", "link": "https://stackoverflow.com/users/3124279/alwayslearningabc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529525935, "creation_date": 1529506456, "last_edit_date": 1531164843, "question_id": 50951155, "link": "https://stackoverflow.com/questions/50951155/change-the-excel-button-caption-property-inside-of-a-loop", "title": "Change the Excel.Button.Caption property inside of a loop?", "body": "<p>I have the code below attached to a button in Excel. When the button is clicked, I would like to display a countdown by changing the Caption of the button to \"5... 4... 3... 2... 1... 0\" and waiting 1 second between each change. The \"i\" variable holds the countdown second.</p>\n\n<p>The cell to which I'm writing \"i\" displays the countdown correctly, but the button caption only changes when it gets to \"0\". It doesn't display the intermediate values.</p>\n\n<p>Why does the button text not change until after the loop is finished?</p>\n\n<pre><code>Sub Timer()\n    Const COUNTDOWN As Integer = 5\n\n    Dim testButton As Excel.Button\n    Set testButton = Application.ActiveSheet.Buttons(\"TestButton\")\n    testButton.Select\n\n    For i = COUNTDOWN To 0 Step -1\n        ActiveCell.FormulaR1C1 = i\n        testButton.Caption = i\n        Call Application.Wait(Now + TimeValue(\"00:00:01\"))\n   Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 35, "user_id": 9787579, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zDmYqoFAMcs/AAAAAAAAAAI/AAAAAAAACSk/JI5XC988sj0/photo.jpg?sz=128", "display_name": "Adam Owen", "link": "https://stackoverflow.com/users/9787579/adam-owen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529595489, "creation_date": 1529505510, "last_edit_date": 1531161705, "question_id": 50950833, "link": "https://stackoverflow.com/questions/50950833/loop-through-a-filtered-pivottable-adding-each-visible-value-to-the-next-cell-i", "title": "Loop through a Filtered PivotTable, adding each visible value to the next cell in a Range", "body": "<p>I'm currently at a bit of a standstill with looping through a Filtered PivotTable, and adding each visible value to the next cell in a pre-determined range. </p>\n\n<p>So far I have put together the following, amateurish, vba code. But my output is not as desired. It seems to be adding only the very final value to all the cells in the provided range.</p>\n\n<p><strong>See Edits, Code is extracting all data from PivotTable, ignoring the Filter in place and not stopping once reaching end of Union(A,B,C,D)</strong></p>\n\n<pre><code>Private Sub GenerateConsumableCard_Click()\n\nDim Pt As PivotTable\nDim Pf As PivotField\nDim Pi As PivotItem\nDim C As Range\n\nSet Pt = Sheets(\"Cards\").PivotTables(\"PivotTable1\")\nSet Pf = Pt.PivotFields(\"Consumable Name\")\nSet KB1 = Sheets(\"Cards\").Range(\"D11\")\nSet KB2 = Sheets(\"Cards\").Range(\"K11\")\nSet KB3 = Sheets(\"Cards\").Range(\"D22\")\nSet KB4 = Sheets(\"Cards\").Range(\"K22\")\nSet CRange = Union(KB1, KB2, KB3, KB4)\n\nWith Pt\n    .PivotCache.Refresh\n    .PivotCache.MissingItemsLimit = xlMissingItemsNone\n\nFor Each C In CRange.Cells\n    For Each Pi In Pf.PivotItems\n        If Pi.Visible = True Then\n           C.Value = Pi\n        End If\n    Next Pi\nNext C\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The idea behind what I've put together being that; each cell in the range will have a different value based on the information currently present in the PivotTable.\nI.E. The first visible value in the PivotTable will go to Cell D11, the Second to Cell K11, the third to cell D22.... etc.</p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>It seems I have more than one problem. I believe I may be referencing the complete wrong part of my PivotTable? Below is an image of the table as it currently stands.</p>\n\n<p>As before, I'm wanting to pull the individual values under \"Consumable Name\" and put them in order into the cell values within \"CRange\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/7KLIr.png\" rel=\"nofollow noreferrer\">ExamplePivotTable</a></p>\n\n<p><strong>Edit2:</strong></p>\n\n<p>So I've made a few more changes, but none of which are working.</p>\n\n<pre><code>Private Sub GenerateConsumableCard_Click()\n\nDim Pt As PivotTable\nDim Pf As PivotField\nDim Pi As PivotItem\nDim C As Range\n\nSet Pt = Sheets(\"KanBans\").PivotTables(\"PivotTable1\")\nSet Pf = Pt.PivotFields(\"Consumable Name\")\nSet KB1 = Sheets(\"KanBans\").Range(\"D11\")\nSet KB2 = Sheets(\"KanBans\").Range(\"K11\")\nSet KB3 = Sheets(\"KanBans\").Range(\"D22\")\nSet KB4 = Sheets(\"KanBans\").Range(\"K22\")\nSet CRange = Union(KB1, KB2, KB3, KB4)\n\nWith Pt\n    .PivotCache.Refresh\n    .PivotCache.MissingItemsLimit = xlMissingItemsNone\n\nFor Each Pi In Pf.VisibleItems\nFor Each C In CRange.Cells\n           C.Value = Pi\n     Next\nNext\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>It now seems to be correctly looping through the PivotTable, but is ignoring the filter placed on the data and extracting all items until the last item.\nI believe I may have also confused myself with:</p>\n\n<pre><code>For Each C In CRange\n</code></pre>\n\n<p>as it correctly iterates through the ranges, but does not stop once all ranges have been filled.</p>\n\n<p>Warm Regards</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1529505845, "post_id": 50950727, "comment_id": 88899538, "body": "You already know that the <code>1,1</code> so no reason to write code to give you that. Essentially <code>Selection.Cells(1,1)</code> refers to <code>BE5</code>. To get the size of the range you can do <code>Selection.Rows.Count</code> and <code>Selection.Columns.Count</code>. Which means that: <code>Selection.Cells(1,1).Offset(Selection.Rows.Count, Selection.Columns.Count)</code> would get you range/cell <code>BE182</code>. I have no idea what you are trying to do though as your question isn&#39;t terribly clear."}, {"owner": {"reputation": 35, "user_id": 3899716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75da480ae477f5515d382546f8099b4b?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3899716/christian"}, "edited": false, "score": 0, "creation_date": 1529506350, "post_id": 50950727, "comment_id": 88899890, "body": "So Selection.Cells(1,1) is BE5? I didn&#39;t understand that ^^ - thanks. But how do I &#39;break-down&#39; that into a numeric value x (e.g. 48) - for BE, and y (5) for 5? I need the numericvalue of BE5 from A1 so to speak and seperately in x and y."}], "answers": [{"tags": [], "owner": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "is_accepted": true, "score": 0, "last_activity_date": 1529506952, "creation_date": 1529506952, "answer_id": 50951325, "question_id": 50950727, "link": "https://stackoverflow.com/questions/50950727/vba-convert-range-to-cell-numbers-e-g-1-1/50951325#50951325", "title": "VBA: Convert range to cell numbers e.g. (1,1)", "body": "<p>You can use the <code>Row</code> and <code>Column</code> properties of the range to get the numeric bounds of the range.</p>\n\n<pre><code>Dim Selected As String\nDim SelectedRange() As String\nDim BeginSel As String\nDim EndSel As String\n\n' Get the range of cells selected by the user.\nSelected = Selection.Areas(1).Address(False, False)\nMsgBox \"Selected range: \" &amp; Selected\n\n' Split the selected range into begin and end cells.\nSelectedRange = Split(Selected, \":\")\nBeginSel = SelectedRange(0)\nEndSel = SelectedRange(1)\n\nMsgBox \"Begin Selected range: \" &amp; BeginSel\nMsgBox \"End Selected range: \" &amp; EndSel\n\n' Convert the begin and end cells to row and column values\nMsgBox Range(BeginSel).Row &amp; \", \" &amp; Range(BeginSel).Column\nMsgBox Range(EndSel).Row &amp; \", \" &amp; Range(EndSel).Column\n</code></pre>\n\n<p>Here I split the selected range on the <code>\":\"</code> character to get the begin and end cells of the range. You'll probably want to check the length of the array returned by the <code>Split</code> function to make sure the user has selected an actual <em>range</em> of cells instead of a single cell (or nothing).</p>\n\n<p>This converts the selected range <code>A1:E3</code> into the coordinates (1, 1) and (3, 5), for example.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1529507307, "creation_date": 1529507307, "answer_id": 50951479, "question_id": 50950727, "link": "https://stackoverflow.com/questions/50950727/vba-convert-range-to-cell-numbers-e-g-1-1/50951479#50951479", "title": "VBA: Convert range to cell numbers e.g. (1,1)", "body": "<p>How about:</p>\n\n<pre><code>Sub RowAndColumn()\n    Dim r1 As Range, r2 As Range, addy As String\n\n    addy = Selection.Address(0, 0)\n    If Selection.Count = 1 Then\n        MsgBox Selection.Row &amp; \",\" &amp; Selection.Column\n    Else\n        arr = Split(addy, \":\")\n        Set r1 = Range(arr(0))\n        Set r2 = Range(arr(1))\n        MsgBox r1.Row &amp; \",\" &amp; r1.Column &amp; vbCrLf &amp; r2.Row &amp; \",\" &amp; r2.Column\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3899716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75da480ae477f5515d382546f8099b4b?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3899716/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1355, "favorite_count": 0, "accepted_answer_id": 50951325, "answer_count": 2, "score": 0, "last_activity_date": 1594177781, "creation_date": 1529505193, "last_edit_date": 1529505335, "question_id": 50950727, "link": "https://stackoverflow.com/questions/50950727/vba-convert-range-to-cell-numbers-e-g-1-1", "title": "VBA: Convert range to cell numbers e.g. (1,1)", "body": "<p>By using this code I get a range selected in my worksheet.\nE.g. \"BE5:BE182\" I get as a return from this code: </p>\n\n<pre><code>MsgBox \"Selected range: \" &amp; Selection.Areas(1).Address(False, False)\n</code></pre>\n\n<p>Now I want my retrive BE5 and translate that into numeric values for both col. and row (e.g. 1,1), and I also want to do this for BE182. How do I do that?</p>\n\n<p>Ambition: My goal with the macro is to select a range where numeric data should be appended. Based on the row count between start of range and end of range I will always use col 1 (A) where country name are stored. Against these I want do achive a similar VLOOKUP-function, against data from another workbook - where the user also should select a range from where data should be taken from.</p>\n\n<p>The idea of letting the user define col. and row-range is that the row-range against vlook-up can change and that the col maybe not always is just +1.</p>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["excel", "date", "formatting", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1529505083, "post_id": 50950612, "comment_id": 88899040, "body": "Are your input values stored as dates or as text?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1529507986, "post_id": 50950612, "comment_id": 88901034, "body": "You haven&#39;t shown us the code that actually enters the information into the cells"}, {"owner": {"reputation": 393, "user_id": 706058, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f8daf3b470d57f3772e3b21d6693e439?s=128&d=identicon&r=PG", "display_name": "user706058", "link": "https://stackoverflow.com/users/706058/user706058"}, "edited": false, "score": 0, "creation_date": 1529508970, "post_id": 50950612, "comment_id": 88901676, "body": "The input values are in cells formatted with Date &quot;aaaa/mm/jj&quot; (equivalent to &quot;yyyy/mm/dd&quot;) I specify &quot;yyyy/mm/dd&quot; as format in VBA   Users need to input the dates with the same format, and I want the cells in which I copy the values to remain but they change. Not all the time as detailed in the post"}], "answers": [{"tags": [], "owner": {"reputation": 393, "user_id": 706058, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f8daf3b470d57f3772e3b21d6693e439?s=128&d=identicon&r=PG", "display_name": "user706058", "link": "https://stackoverflow.com/users/706058/user706058"}, "is_accepted": false, "score": 0, "last_activity_date": 1529566050, "creation_date": 1529566050, "answer_id": 50962744, "question_id": 50950612, "link": "https://stackoverflow.com/questions/50950612/excel-vba-formatnumber-for-date-yyyy-mm-dd-not-working-with-all-values/50962744#50962744", "title": "Excel - VBA: formatNumber for date (yyyy-mm-dd) not working with all values", "body": "<p>I managed to make it work by generating the date via date functions:</p>\n\n<pre><code>varSheetGeneratedCSV.Range(\"E\" &amp; j) = Year(varStartDate) &amp; \"/\" &amp; Month(varStartDate) &amp; \"/\" &amp; Day(varStartDate)\n</code></pre>\n\n<p>This outputs the correct value each time.</p>\n"}], "owner": {"reputation": 393, "user_id": 706058, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f8daf3b470d57f3772e3b21d6693e439?s=128&d=identicon&r=PG", "display_name": "user706058", "link": "https://stackoverflow.com/users/706058/user706058"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529566050, "creation_date": 1529504876, "last_edit_date": 1531161705, "question_id": 50950612, "link": "https://stackoverflow.com/questions/50950612/excel-vba-formatnumber-for-date-yyyy-mm-dd-not-working-with-all-values", "title": "Excel - VBA: formatNumber for date (yyyy-mm-dd) not working with all values", "body": "<p>I'm using VBA to generate a XLS sheet based on other sheets from the same XLS file.\nIt's pretty basic and all works except the following:</p>\n\n<pre><code>varSheetGeneratedCSV.Range(\"E\" &amp; j).NumberFormat = \"yyyy/mm/dd;@\"\nvarSheetGeneratedCSV.Range(\"F\" &amp; j).NumberFormat = \"yyyy/mm/dd;@\"\n</code></pre>\n\n<p>The value I pass are selected from a sheet's cells which are formatted with the following format:</p>\n\n<ul>\n<li>Custom: aaaa/mm/jj (French locale, equivalent to yyyy/mm/dd)</li>\n</ul>\n\n<p>The sheets gets the expected value in the cells (j is a loop index) for both E and F columns.</p>\n\n<p>But here are my results, depending on something I can't pin point, can you ?</p>\n\n<p>Input:</p>\n\n<ul>\n<li>Start: 2011/12/01</li>\n<li>End: 2037/12/31</li>\n</ul>\n\n<p>Result:</p>\n\n<ul>\n<li>2011/12/01 (expected)</li>\n<li>31/12/2037 (not expected, expected: 2037/12/31)</li>\n</ul>\n\n<hr>\n\n<p>Input:</p>\n\n<ul>\n<li>Start: 2028/06/19</li>\n<li>End: 2018/12/9</li>\n</ul>\n\n<p>Result:</p>\n\n<ul>\n<li>19/06/2028 (not expected, expected: 2028/06/19)</li>\n<li>19/12/2018 (not expected, expected: 2018/12/19)</li>\n</ul>\n\n<hr>\n\n<p>Any idea why the difference ?\nNote that when I double click the cell not correctly format and, without doing any change, hit enter, the format is then applied correctly.</p>\n\n<p>What could I add to my VBA to get the cell format to be applied as when I do it manually ?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "header"], "comments": [{"owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1529505128, "post_id": 50950566, "comment_id": 88899064, "body": "from where you are trying to enter the details. Is it from a cell in excel sheet"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1529505182, "post_id": 50950566, "comment_id": 88899100, "body": "What happens if you debug.print <code>Zeichnung, Bezeichnung</code> and <code>index_kpl</code> at that point?"}, {"owner": {"reputation": 290, "user_id": 8233556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310a9a6f7964c8606a0532b28a350b85?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/8233556/marco"}, "reply_to_user": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1529558907, "post_id": 50950566, "comment_id": 88918691, "body": "@george86, Yes, I use the content of different cells to define those variables."}, {"owner": {"reputation": 290, "user_id": 8233556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310a9a6f7964c8606a0532b28a350b85?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/8233556/marco"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1529559342, "post_id": 50950566, "comment_id": 88918871, "body": "@cybernetic.nomad, If I debug.print it shows all of the variables correct, without the old one."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1529568731, "post_id": 50950566, "comment_id": 88923665, "body": "This algorithm is corect. What if you run it step by step and check the result of each step with print preview? You should see the current headers disappearing then reappearing."}, {"owner": {"reputation": 290, "user_id": 8233556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310a9a6f7964c8606a0532b28a350b85?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/8233556/marco"}, "reply_to_user": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1529570919, "post_id": 50950566, "comment_id": 88924964, "body": "@AcsErno If I run the script step by step, and check the preview it runs as it should (At least not this Problem). It first deletes the contents and writes the new content."}, {"owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1529579417, "post_id": 50950566, "comment_id": 88930360, "body": "@Marco Just be curious what happens if you put a time delay in your code ...        newHour = Hour(Now())       newMinute = Minute(Now())       newSecond = Second(Now()) + 1       waitTime = TimeSerial(newHour, newMinute, newSecond)       Application.Wait waitTime"}, {"owner": {"reputation": 290, "user_id": 8233556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310a9a6f7964c8606a0532b28a350b85?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/8233556/marco"}, "reply_to_user": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1529579521, "post_id": 50950566, "comment_id": 88930417, "body": "@george86 I added an &quot;Application.Wait (1)&quot;. It still doesn&#39;t work. Does you code the same?"}, {"owner": {"reputation": 290, "user_id": 8233556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310a9a6f7964c8606a0532b28a350b85?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/8233556/marco"}, "reply_to_user": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1529580294, "post_id": 50950566, "comment_id": 88930957, "body": "@george86 I tried with your code as well, but it still doesn&#39;t work. But thanks for the input!"}, {"owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1529585276, "post_id": 50950566, "comment_id": 88934149, "body": "@what version of Excel are u using ? Do you mind showing the code as it is. May be i can try it on mine and see what is happening."}, {"owner": {"reputation": 290, "user_id": 8233556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310a9a6f7964c8606a0532b28a350b85?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/8233556/marco"}, "reply_to_user": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1529586546, "post_id": 50950566, "comment_id": 88934971, "body": "@george86 I&#39;m using Excel 2010."}, {"owner": {"reputation": 290, "user_id": 8233556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310a9a6f7964c8606a0532b28a350b85?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/8233556/marco"}, "reply_to_user": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1529586790, "post_id": 50950566, "comment_id": 88935154, "body": "@george86 I just found a solution. I added the whole code anyways. maybee it helps someone."}, {"owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1529589382, "post_id": 50950566, "comment_id": 88936966, "body": "@Marco  nice to know that u found a solution.."}], "answers": [{"tags": [], "owner": {"reputation": 290, "user_id": 8233556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310a9a6f7964c8606a0532b28a350b85?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/8233556/marco"}, "is_accepted": false, "score": 2, "last_activity_date": 1529586384, "creation_date": 1529586384, "answer_id": 50969340, "question_id": 50950566, "link": "https://stackoverflow.com/questions/50950566/updating-header-in-excel-with-vba-doesnt-overwrite-existing-values/50969340#50969340", "title": "Updating Header in Excel with vba, doesn&#39;t overwrite existing values", "body": "<p>Many Thanks for the suggestions! </p>\n\n<p>I found a solution.\nFrom the macro I recorded earlier there was the line\n     Application.PrintCommunication = False</p>\n\n<p>...within the code.\nUpon removal it worked as you would expect. </p>\n"}], "owner": {"reputation": 290, "user_id": 8233556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310a9a6f7964c8606a0532b28a350b85?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/8233556/marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1529586728, "creation_date": 1529504738, "last_edit_date": 1529586728, "question_id": 50950566, "link": "https://stackoverflow.com/questions/50950566/updating-header-in-excel-with-vba-doesnt-overwrite-existing-values", "title": "Updating Header in Excel with vba, doesn&#39;t overwrite existing values", "body": "<p>I have this vba script that writes some information in the header of an excel file. Sadly it doesn't update what's already written in the right and left header, althogh I set the headers to empty before writing to them again.\n(see code and pictures below)</p>\n\n<p>Has anyone an idea what's wrong? \nThanks in advance!</p>\n\n<pre><code>ActiveSheet.PageSetup.LeftHeader = \"\"\nActiveSheet.PageSetup.CenterHeader = \"\"\nActiveSheet.PageSetup.RightHeader = \"\"\n\n\nActiveSheet.PageSetup.LeftHeader = Zeichnung '.Value\nActiveSheet.PageSetup.CenterHeader = Bezeichnung '.Value\nActiveSheet.PageSetup.RightHeader = index_kpl '.Value\n</code></pre>\n\n<p>EDIT:\nalso, it seems that the last two caracters of the older string are removed. It removes two additional caracters if I remove the last two in advance. </p>\n\n<p>EDIT2:\nIF I run the script step by step it works. </p>\n\n<p>If I enable / disable ScreenUpdate it has no effect. </p>\n\n<p>EDIT3\nwaiting (Application.wait()) between clearing and writing to the header doesn't help either. </p>\n\n<p>EDIT4\nThe entire code is as follows (requested by george86):</p>\n\n<pre><code>Sub ausdrucken()\n\nSheets(\"alle_Zuweisungen\").Select\n\nBezeichnung = ActiveWorkbook.Sheets(\"Steuerung\").Range(\"J3\").Value\nBezeichnung = CStr(Bezeichnung &amp; \"\")\nZeichnung = ActiveWorkbook.Sheets(\"Steuerung\").Range(\"J4\").Value\nZeichnung = CStr(Zeichnung) ' &amp; \"\")\naktueller_Index = ActiveWorkbook.Sheets(\"Steuerung\").Range(\"J5\").Value\nindex_kpl = \"\u00c4nderungsindex \" &amp; aktueller_Index\nindex_kpl = CStr(index_kpl &amp; \"\")\nbenutze_Zeilen = ActiveSheet.UsedRange.Rows.Count\nPrintArea = \"A4\" &amp; \":\" &amp; \"J\" &amp; benutze_Zeilen\n\n\nActiveSheet.PageSetup.PrintArea = PrintArea '\"PrintArea:PrintArea\"\n'Application.PrintCommunication = False\n\n\nActiveSheet.PageSetup.LeftHeader = \"\"\nActiveSheet.PageSetup.CenterHeader = \"\"\nActiveSheet.PageSetup.RightHeader = \"\"\n\nApplication.Wait (2)\n\nActiveSheet.PageSetup.LeftHeader = \"\"\nActiveSheet.PageSetup.CenterHeader = \"\"\nActiveSheet.PageSetup.RightHeader = \"\"\n\n'Application.Wait (1)\n'newHour = Hour(Now())\n'newMinute = Minute(Now())\n'newSecond = Second(Now()) + 2\n'waitTime = TimeSerial(newHour, newMinute, newSecond)\n'Application.Wait waitTime\n\n\nActiveSheet.PageSetup.LeftHeader = Zeichnung 'CStr(\"&amp;L\" &amp; Zeichnung) '.Value\nActiveSheet.PageSetup.CenterHeader = Bezeichnung ' CStr(\"&amp;C\" &amp; Bezeichnung) '.Value\nActiveSheet.PageSetup.RightHeader = index_kpl 'CStr(\"&amp;R\" &amp; index_kpl) '.Value\n\nDebug.Print (Zeichnung)\nDebug.Print (Bezeichnung)\nDebug.Print (index_kpl)\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/RDurX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RDurX.jpg\" alt=\"first\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/OGf2o.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OGf2o.jpg\" alt=\"second\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/AjvQi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AjvQi.jpg\" alt=\"third\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 1, "creation_date": 1529505458, "post_id": 50950520, "comment_id": 88899258, "body": "Wouldn&#39;t it just be easier to open a query instead of the raw table? Then you have complete control over which columns are displayed, which records are displayed (if you want to filter) and what order the records are displayed in."}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1529505565, "post_id": 50950520, "comment_id": 88899330, "body": "What exactly about it does not work, some sort of error? Also, what is the column name and table name that you&#39;re trying to hide?"}, {"owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1529505731, "post_id": 50950520, "comment_id": 88899457, "body": "There is no error message, but the table still shows the column.  Table: tChart1_Reportable, Column: ID"}, {"owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1529505799, "post_id": 50950520, "comment_id": 88899506, "body": "And the table opens so it can be edited by front-end users, but I still need to preserve the ID column for archival purposes and linking to other tables.  Kind of complicated, and this is the best way I could think to do it."}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "reply_to_user": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1529506084, "post_id": 50950520, "comment_id": 88899704, "body": "In that case, what @Skippy mentioned would likely be your best option. Just write a query for the Front-End user that omits the ID column."}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1529506202, "post_id": 50950520, "comment_id": 88899783, "body": "If I had to guess, (with the way the code is written), it is most likely working properly, its just not updating to the GUI. In other words, if you reopened the Table it would be hidden. The code would require some sort of Requery option, although I am not 100% certain that is possible with a table in that format."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1529508130, "post_id": 50951215, "comment_id": 88901121, "body": "Hm, that opens the table but the ID column is not hidden."}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "reply_to_user": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1529509962, "post_id": 50951215, "comment_id": 88902303, "body": "You are probably hitting an error somewhere in the code. But the &quot;error handling&quot; is bypassing it. Try the updated code instead."}, {"owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1529510546, "post_id": 50951215, "comment_id": 88902706, "body": "The updated code worked without error and opened the table, but the ID column is still visible."}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "reply_to_user": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1529512017, "post_id": 50951215, "comment_id": 88903573, "body": "Something seems off, although its difficult to figure out without more information. How are you running the code, this is through a macro?"}, {"owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1529512209, "post_id": 50951215, "comment_id": 88903687, "body": "Right now I&#39;ve just been running it from the module in the Visual Basic Editor."}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "reply_to_user": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1529512420, "post_id": 50951215, "comment_id": 88903798, "body": "Add this line at the bottom after <code>Set dbs = Nothing</code>: <code>MsgBox &quot;Code ran successfully&quot;</code>"}, {"owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1529512516, "post_id": 50951215, "comment_id": 88903847, "body": "Ran the code- table opened with ID visible, and the msg box popped up."}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "reply_to_user": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1529513345, "post_id": 50951215, "comment_id": 88904288, "body": "Well, for whatever reason it looks like the code is not working for you. Could be the version of Access you have or a problem with the database somehow? But, I added a little bit of additional information to the answer, it should show you how to accomplish the same basic proceedure through a query instead of hiding the column on the table itself. Then you would just open the query, instead of the table, this is generally a safer way for Front-End users to interact with your database anyway."}, {"owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1529522763, "post_id": 50951215, "comment_id": 88908893, "body": "This started working, I was playing around with manually hiding and unhiding the column and then when I tried to run the code again it worked (???).  Thanks for all of your help!"}], "tags": [], "owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "is_accepted": false, "score": 0, "last_activity_date": 1529513204, "last_edit_date": 1529513204, "creation_date": 1529506663, "answer_id": 50951215, "question_id": 50950520, "link": "https://stackoverflow.com/questions/50950520/need-to-hide-a-column-in-a-table-on-button-click/50951215#50951215", "title": "Need to hide a column in a table on button click", "body": "<p>Although you really should think about using a query to accomplish this goal instead, the problem with this code is definitely that the Table itself does not refresh the hidden property on execution.</p>\n\n<p>That being said, this would likely suffice as a solution to this problem:</p>\n\n<pre><code>Public Sub SetColumnHidden() \n\n    Dim dbs As DAO.Database \n    Dim fld As DAO.Field \n    Dim prp As DAO.Property \n\n    Set dbs = CurrentDb \n\n    'Set field property. \n    Set fld = dbs.TableDefs!tChart1_Reportable.Fields!ID \n    fld.Properties(\"ColumnHidden\") = True \n\n    DoCmd.Close acTable, \"tChart1_Reportable\"\n    DoCmd.OpenTable \"tChart1_Reportable\"\n\n    Set prp = Nothing \n    Set fld = Nothing \n    Set dbs = Nothing \n\nEnd Sub\n</code></pre>\n\n<p>To work this through a query, create a new query with <code>Query Design</code>, open it in SQL view. Your query should like something like this: </p>\n\n<pre><code>SELECT [Field1],\n[Field2],\n[Field3]\nFROM tChart1_Reportable\n</code></pre>\n\n<p>Basically, add every field you want to view (by the field's name), removing the \"ID\" field from the list. This will accomplish what you're attempting to do. As far as why the code is not working for you, all I can say is it should be.</p>\n"}], "owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530117020, "creation_date": 1529504605, "last_edit_date": 1530117020, "question_id": 50950520, "link": "https://stackoverflow.com/questions/50950520/need-to-hide-a-column-in-a-table-on-button-click", "title": "Need to hide a column in a table on button click", "body": "<p>I have a button that calls a macro which opens up a table.  I'd like to hide a column in that table when it opens.  The macro opens the table tChart1_Reportable and I'd like to hide the ID column.</p>\n\n<p>I figure this has to be done in VBA with the RunCode action selected in the macro.</p>\n\n<p>I haven't had luck finding code that works.  Found this online but it doesnt work in the current form:</p>\n\n<pre><code>   Public Sub SetColumnHidden() \n\n Dim dbs As DAO.Database \n Dim fld As DAO.Field \n Dim prp As DAO.Property \n Const conErrPropertyNotFound = 3270 \n\n ' Turn off error trapping. \n On Error Resume Next \n\n Set dbs = CurrentDb \n\n ' Set field property. \n Set fld = dbs.TableDefs!tChart1_Reportable.Fields!ID \n fld.Properties(\"ColumnHidden\") = True \n\n ' Error may have occurred when value was set. \n If Err.Number &lt;&gt; 0 Then \n If Err.Number &lt;&gt; conErrPropertyNotFound Then \n On Error GoTo 0 \n MsgBox \"Couldn't set property 'ColumnHidden' \" &amp;; _ \n \"on field '\" &amp;; fld.Name &amp;; \"'\", vbCritical \n Else \n On Error GoTo 0 \n Set prp = fld.CreateProperty(\"ColumnHidden\", dbLong, True) \n fld.Properties.Append prp \n End If \n End If \n\n Set prp = Nothing \n Set fld = Nothing \n Set dbs = Nothing \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "shapes", "textrange", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1529504613, "post_id": 50950428, "comment_id": 88898694, "body": "The error occurs on a specific line. Which line is it that it breaks on?"}, {"owner": {"reputation": 451, "user_id": 2768400, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f830ed8684c7b41049f87564670eeb8d?s=128&d=identicon&r=PG&f=1", "display_name": "srt", "link": "https://stackoverflow.com/users/2768400/srt"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1529505994, "post_id": 50950428, "comment_id": 88899645, "body": "@JNevill The error was occurring on &quot;.TextRange.Delete&quot;. I have figured it out. The answer is below. Thanks anyway."}], "answers": [{"tags": [], "owner": {"reputation": 451, "user_id": 2768400, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f830ed8684c7b41049f87564670eeb8d?s=128&d=identicon&r=PG&f=1", "display_name": "srt", "link": "https://stackoverflow.com/users/2768400/srt"}, "is_accepted": false, "score": 0, "last_activity_date": 1529504600, "creation_date": 1529504600, "answer_id": 50950517, "question_id": 50950428, "link": "https://stackoverflow.com/questions/50950428/run-time-error-2147024809-80070057-the-specified-value-is-out-of-range-with-s/50950517#50950517", "title": "run time error -2147024809 (80070057) the specified value is out of range with shape", "body": "<p>Sry, for wasting your time to click on this question.</p>\n\n<p>It's just that, I was trying to edit the text of the shape when the sheet was protected. which is the cause for the error.</p>\n\n<p>Should have read through the below link earlier.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/44939935/microsoft-excel-vba-run-time-error-2147024809-80070057\">Microsoft Excel VBA - Run-Time Error &#39;-2147024809 (80070057)&#39;</a></p>\n"}], "owner": {"reputation": 451, "user_id": 2768400, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f830ed8684c7b41049f87564670eeb8d?s=128&d=identicon&r=PG&f=1", "display_name": "srt", "link": "https://stackoverflow.com/users/2768400/srt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2399, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529504655, "creation_date": 1529504329, "last_edit_date": 1531164843, "question_id": 50950428, "link": "https://stackoverflow.com/questions/50950428/run-time-error-2147024809-80070057-the-specified-value-is-out-of-range-with-s", "title": "run time error -2147024809 (80070057) the specified value is out of range with shape", "body": "<p>Here is my code,</p>\n\n<pre><code>If ActiveWorkbook.Sheets(\"About tool\").Range(\"G1\").Value = 1 Then\n    ActiveWorkbook.Sheets(\"About tool\").Range(\"G1\").Value = 0\n\n    With ActiveWorkbook.Sheets(\"About tool\").Shapes(\"Rounded Rectangle 2\").TextFrame2\n        If .HasText Then\n            .TextRange.Delete\n            .TextRange.Text = \"Unlock All\"\n        End If\n    End With\n\nElseIf ActiveWorkbook.Sheets(\"About tool\").Range(\"G1\").Value = 0 Then\n        ActiveWorkbook.Sheets(\"About this tool \").Range(\"G1\").Value = 1\n\n        With ActiveWorkbook.Sheets(\"About tool\").Shapes(\"Rounded Rectangle 2\").TextFrame2\n            If .HasText Then\n                .TextRange.Delete\n                .TextRange.Text = \"Lock All\"\n            End If\n        End With    \nEnd If\n</code></pre>\n\n<p>Here on the ELSEIF section, I am getting an error saying \"runtime error -2147024809 (80070057) the specified value is out of range\".</p>\n\n<p>It is working fine in the IF section. it is the same code with just change in the string passed as text.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1649, "user_id": 3516684, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5e55f57a1d9ea8a126a070aa68c060de?s=128&d=identicon&r=PG&f=1", "display_name": "Sparkler", "link": "https://stackoverflow.com/users/3516684/sparkler"}, "is_accepted": false, "score": 0, "last_activity_date": 1529510006, "creation_date": 1529510006, "answer_id": 50952373, "question_id": 50950287, "link": "https://stackoverflow.com/questions/50950287/how-to-export-all-sheets-in-a-workbook-to-a-single-text-file/50952373#50952373", "title": "How to export all sheets in a workbook to a single text file?", "body": "<p>Based on <a href=\"https://stackoverflow.com/a/59114/3516684\">this answer</a>, here is a line-by-line solution with vbTab as delimiter:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    Dim wsSheet As Worksheet\n    Dim nFileNum As Integer\n    Dim txtPath As String\n    Dim FirstSheet As Boolean\n\n    Application.ScreenUpdating = False\n\n    txtPath = ActiveWorkbook.FullName\n    txtPath = Replace(txtPath, \"xlsm\", \"txt\")\n    nFileNum = FreeFile\n\n    FirstSheet = True\n    For Each wsSheet In Worksheets\n        If FirstSheet = True Then\n            ' Overwrite\n            Open txtPath For Output As #nFileNum\n        Else\n            ' Append\n            Open txtPath For Append As #nFileNum\n        End If\n\n        wsSheet.Activate\n        ExportToTextFile CStr(nFileNum), vbTab, False, Not (FirstSheet)\n\n        Close #nFileNum\n\n        FirstSheet = False\n\n    Next wsSheet\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n\n\nPublic Sub ExportToTextFile(nFileNum As Integer, _\n                            Sep As String, SelectionOnly As Boolean, _\n                            SkipHeader As Boolean)\n\n    Dim WholeLine As String\n    Dim RowNdx As Long\n    Dim ColNdx As Integer\n    Dim StartRow As Long\n    Dim EndRow As Long\n    Dim StartCol As Integer\n    Dim EndCol As Integer\n    Dim CellValue As String\n\n    On Error GoTo EndMacro:\n\n    If SelectionOnly = True Then\n        With Selection\n            StartRow = .Cells(1).Row\n            StartCol = .Cells(1).Column\n            EndRow = .Cells(.Cells.Count).Row\n            EndCol = .Cells(.Cells.Count).Column\n        End With\n    Else\n        With ActiveSheet.UsedRange\n            StartRow = .Cells(1).Row\n            StartCol = .Cells(1).Column\n            EndRow = .Cells(.Cells.Count).Row\n            EndCol = .Cells(.Cells.Count).Column\n        End With\n    End If\n\n    If SkipHeader = True Then\n        StartRow = StartRow + 1\n    End If\n\n    For RowNdx = StartRow To EndRow\n        WholeLine = \"\"\n        For ColNdx = StartCol To EndCol\n            If Cells(RowNdx, ColNdx).Value = \"\" Then\n                CellValue = \"\"\n            Else\n                CellValue = Cells(RowNdx, ColNdx).Value\n            End If\n            WholeLine = WholeLine &amp; CellValue &amp; Sep\n        Next ColNdx\n        WholeLine = Left(WholeLine, Len(WholeLine) - Len(Sep))\n        Print #nFileNum, WholeLine\n    Next RowNdx\n\nEndMacro:\n    On Error GoTo 0\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1649, "user_id": 3516684, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5e55f57a1d9ea8a126a070aa68c060de?s=128&d=identicon&r=PG&f=1", "display_name": "Sparkler", "link": "https://stackoverflow.com/users/3516684/sparkler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529510006, "creation_date": 1529503883, "last_edit_date": 1531164843, "question_id": 50950287, "link": "https://stackoverflow.com/questions/50950287/how-to-export-all-sheets-in-a-workbook-to-a-single-text-file", "title": "How to export all sheets in a workbook to a single text file?", "body": "<p>It seems that the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-saveas-method-excel\" rel=\"nofollow noreferrer\">Workbook.SaveAs method</a> does not support appending to file (otherwise I could slightly modify one of the <a href=\"https://stackoverflow.com/questions/59075/save-each-sheet-in-a-workbook-to-separate-csv-files\">common solutions</a>).</p>\n\n<p>I know I can use the <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/open-statement\" rel=\"nofollow noreferrer\">Open</a> statement and <a href=\"https://stackoverflow.com/a/59114/3516684\">write line by line</a>, but I prefer a more high-level solution.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1529503938, "post_id": 50950037, "comment_id": 88898164, "body": "@drunken squirrel - <code>macros</code> is not a tag for VBA."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1529505802, "post_id": 50950729, "comment_id": 88899509, "body": "Unconditionally setting the tag value in <code>QueryClose</code> will not set the tag <i>only</i> when the &quot;X&quot; button is clicked, as hinted by the <code>CloseMode</code> value. Also, <code>Unload frm</code> is redundant, and if you had <code>With New classificationForm</code> then you wouldn&#39;t even need the <code>frm</code> variable, and it would be dead &amp; burried at <code>End With</code>. Clever use of the form&#39;s <code>Tag</code>, although I prefer using a <code>Boolean</code> custom property rather than magic strings. A Boolean property also makes the condition test for a positive, which reads better."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1529506753, "post_id": 50950729, "comment_id": 88900206, "body": "edited and inserted the check for setting the tag only when the &quot;X&quot; button is clicked. thanks @MathieuGuindon. Why is <code>Unload frm</code> redundant? And isn&#39;t the <code>With Userform1 .. End With</code> a bad practice?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1529506945, "post_id": 50950729, "comment_id": 88900335, "body": "I never said <code>With UserForm1</code>, I said <code>With New</code>, a construct which makes the <code>With</code> block hold the object reference for the new instance of the form class, making the object&#39;s lifetime entirely constrained by the <code>With</code> block. Working against the default instance of a form is a practice I&#39;ve been actively fighting for quite some time now ;-)"}, {"owner": {"reputation": 7, "user_id": 6866927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5109c0ee2ec8bada4f1abc3ee1a33bb?s=128&d=identicon&r=PG&f=1", "display_name": "JDC", "link": "https://stackoverflow.com/users/6866927/jdc"}, "edited": false, "score": 0, "creation_date": 1529507020, "post_id": 50950729, "comment_id": 88900384, "body": "Great, almost all work except for the X button. When clicked it gives the error:  Run-time error &#39;-2147418105 (80010007)&#39;: Automation error. The callee (server [not server application]) is not available and disappeared; all connections are invalid. The call may have executed.  The Debug highlights the line &quot;If .Tag &lt;&gt; &quot;NO&quot; Then....&quot;"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1529528104, "post_id": 50950729, "comment_id": 88911176, "body": "Have you changed \u201cokCommand_Click()\u201d and \u201ccancelCommand_Click()\u201d as per my answer?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1529506620, "last_edit_date": 1529506620, "creation_date": 1529505206, "answer_id": 50950729, "question_id": 50950037, "link": "https://stackoverflow.com/questions/50950037/how-to-exit-a-vba-macro-when-the-forms-x-button-is-clicked/50950729#50950729", "title": "How to exit a VBA macro when the form&#39;s &quot;X&quot; button is clicked?", "body": "<p>use <code>UserForm_QueryClose()</code> event handler to intercept any userform red \"X\" clicking</p>\n\n<p>then change your <code>UserForm</code> code pane as follows:</p>\n\n<pre><code>Private Sub okCommand_Click()\n    Me.Hide ' don't unload the Form, just hide it\nEnd Sub\n\nPrivate Sub cancelCommand_Click()\n    Me.Tag = \"NO\" ' signal to the calling sub that it must not send the email\n    Me.Hide ' don't unload the Form, just hide it\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = 0 Then Me.Tag = \"NO\" ' if user clicked the red X button signal to the calling sub that it must not send the email\nEnd Sub\n</code></pre>\n\n<p>and adjust your <code>Application_ItemSend</code> event handler code accordingly:</p>\n\n<pre><code>Set frm = New classificationForm\nWith frm\n    .Show vbModal\n    If .Tag &lt;&gt; \"NO\" Then ' if userform didn't signal not to send the email \n        Select Case True\n            Case frm.restrictedButton.Value\n                chosenvalue = \"Restricted\"\n            Case frm.internalButton.Value\n                chosenvalue = \"Internal\"\n            Case frm.publicButton.Value\n                chosenvalue = \"Public\"\n            Case Else\n                MsgBox \"No classification chosen\"\n                Cancel = True\n            Exit Sub\n        End Select\n    Else ' the userform signaled not to send the email\n        MsgBox \"No classification chosen\"\n        Cancel = True\n    End If\nEnd With\nUnload frm\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1529505334, "creation_date": 1529505334, "answer_id": 50950770, "question_id": 50950037, "link": "https://stackoverflow.com/questions/50950037/how-to-exit-a-vba-macro-when-the-forms-x-button-is-clicked/50950770#50950770", "title": "How to exit a VBA macro when the form&#39;s &quot;X&quot; button is clicked?", "body": "<p><code>Unload</code> is a lie. It seems to only work with the form's <em>default instance</em>, and working with forms' default instance is a poisonous place you don't want to go.</p>\n\n<p>Don't unload. <code>Hide</code> instead.</p>\n\n<p>Another problem is that since the calling code is querying the form's controls' state, it doesn't matter how the form was closed: Ok, Cancel, \"X\" - everything single one of these buttons gets the form unloaded and whatever was selected is acted upon: you have no mechanism in place to determine whether the user okayed the dialog, or wishes to cancel everything.</p>\n\n<p>Add a <code>Cancelled</code> property:</p>\n\n<pre><code>Private IsCancelled As Boolean\n\nPublic Property Get Cancelled() As Boolean\n    Cancelled = IsCancelled\nEnd Property\n</code></pre>\n\n<p>Handle the <code>QueryClose</code> event, set the <code>Cancel</code> parameter to <code>False</code> when the <code>CloseMode</code> is <code>vbFormControlMenu</code>, and <code>Hide</code> the form - actually, what you want is for that \"X\" button to do exactly the same thing as your <em>Cancel</em> button, so just do that:</p>\n\n<pre><code>Private Sub OkButton_Click()\n    Me.Hide\nEnd Sub\n\nPrivate Sub CancelButton_Click()\n    OnCancel\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = VbQueryClose.vbFormControlMenu Then\n        Cancel = True\n        OnCancel\n    End If\nEnd Sub\n\nPrivate Sub OnCancel()\n    IsCancelled = True\n    Me.Hide        \nEnd Sub\n</code></pre>\n\n<p>Now your calling code can determine whether the form was cancelled, and act accordingly.</p>\n\n<pre><code>If frm.Cancelled Then\n    Cancel = True\nElse\n    'user okayed the dialog: determine the selection...\nEnd If\n</code></pre>\n\n<p>See <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">this article</a> for more in-depth information about user forms: the calling code doesn't <em>need</em> to care about the controls on the form.</p>\n"}], "owner": {"reputation": 7, "user_id": 6866927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5109c0ee2ec8bada4f1abc3ee1a33bb?s=128&d=identicon&r=PG&f=1", "display_name": "JDC", "link": "https://stackoverflow.com/users/6866927/jdc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4503, "favorite_count": 0, "accepted_answer_id": 50950770, "answer_count": 2, "score": 0, "last_activity_date": 1592945852, "creation_date": 1529503121, "last_edit_date": 1592945852, "question_id": 50950037, "link": "https://stackoverflow.com/questions/50950037/how-to-exit-a-vba-macro-when-the-forms-x-button-is-clicked", "title": "How to exit a VBA macro when the form&#39;s &quot;X&quot; button is clicked?", "body": "<p>I have an Outlook macro that pops up a form when someone sends an email and asks them to select a classification. Under ThisOutlookSession I have:</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\n          Dim frm As classificationForm\n          Dim chosenvalue As String\n\n          Set frm = New classificationForm\n          frm.Show vbModal\n\n          Select Case True\n          Case frm.restrictedButton.Value\n            chosenvalue = \"Restricted\"\n          Case frm.internalButton.Value\n            chosenvalue = \"Internal\"\n          Case frm.publicButton.Value\n            chosenvalue = \"Public\"\n          Case Else\n            MsgBox \"No classification chosen\"\n            Cancel = True\n            Exit Sub\n          End Select\n\n    If TypeName(Item) = \"MailItem\" Then\n      Item.Subject = \"[\" &amp; chosenvalue &amp; \"] \" &amp; Item.Subject\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>and under classificationForm I have:</p>\n\n<pre><code>Private Sub okCommand_Click()\n  Unload Me\nEnd Sub\n\nPrivate Sub cancelCommand_Click()\n  Unload Me\nEnd Sub\n</code></pre>\n\n<p>The form is 3 option buttons (the classifications) and 2 command buttons (OK and Cancel).</p>\n\n<p>The [Internal] option button is selected by default. However, if someone clicks the form's \"X\" button in the top-right corner or the \"Cancel\" command button, then the Macro sends the email with the selected classification button when I want it to kick me back to the draft email like it would if there were no options selected.</p>\n\n<p>How would I do this? Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1529503465, "post_id": 50950030, "comment_id": 88897856, "body": "code works for me, no issues.  Make sure the &quot;numbers&quot; are exactly that, numbers and not text that look like numbers.  Make sure the column is set to &quot;General&quot; and try retyping a few of the numbers."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1529503874, "post_id": 50950030, "comment_id": 88898121, "body": "another way to verify it&#39;s numbers if you run a manual <code>SUM</code> form on the data inside a cell."}, {"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1529504086, "post_id": 50950030, "comment_id": 88898295, "body": "What locale are you on? If your locale is North European, then these numbers should use comma as decimal separator, not dot. On my locale, if I do this replacement, the sub works as expected, even if I format the numbers as text. If I use dot as decimal separator, the result is indeed 0."}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1529504135, "post_id": 50950030, "comment_id": 88898346, "body": "@Pnuts: several cells and the alignment is as it appears above.  Several blank spaces in a column with numbers."}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1529504161, "post_id": 50950030, "comment_id": 88898369, "body": "@Scott - I never thought of that, though after changing them to a number, the problem persists, returning 0 instead of a value."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1529505989, "post_id": 50950030, "comment_id": 88899643, "body": "@EricKing changing the number format doesn&#39;t change the value, but there are few workarounds <a href=\"https://support.office.com/en-us/article/convert-numbers-stored-as-text-to-numbers-40105f2a-fe79-4477-a171-c5bad0f0a885\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1529504117, "post_id": 50950254, "comment_id": 88898322, "body": "Nice approach, the only problem is if the &quot;blanks&quot; are not true blanks, but empty strings placed there by a formula or a space this will error."}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "edited": false, "score": 0, "creation_date": 1529504262, "post_id": 50950254, "comment_id": 88898447, "body": "This solution resolved my issue! Thank you for your time and energy Slai."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 2, "last_activity_date": 1529505223, "last_edit_date": 1529505223, "creation_date": 1529503805, "answer_id": 50950254, "question_id": 50950030, "link": "https://stackoverflow.com/questions/50950030/worksheetfunction-sumrng-returning-zero-versus-the-correct-sum/50950254#50950254", "title": "WorksheetFunction.Sum(rng) returning zero versus the correct sum", "body": "<p>Non-numeric values like text are ignored by <code>SUM</code>, but you can try converting the texts to numbers:</p>\n\n<pre><code>lAnswer = wbFrom.Sheets(\"Sheet0\").Evaluate(\"SUM(--P9:P50000)\")\n</code></pre>\n\n<p>Possible workaround for non-numeric text values:</p>\n\n<pre><code>lAnswer = wbFrom.Sheets(\"Sheet0\").Evaluate(\"sum(if(iserr(--P9:P50000),0,--P9:P50000))\")\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 50950254, "answer_count": 1, "score": 0, "last_activity_date": 1529505223, "creation_date": 1529503088, "last_edit_date": 1529503295, "question_id": 50950030, "link": "https://stackoverflow.com/questions/50950030/worksheetfunction-sumrng-returning-zero-versus-the-correct-sum", "title": "WorksheetFunction.Sum(rng) returning zero versus the correct sum", "body": "<p>The message box for this returns '0' instead of the correct summed value of the column and nothing gets pasted into Sheet1/D16.</p>\n\n<p>Where am I going wrong here?  I am trying to sum a column from one workbook and paste the value of that summed column into a cell in a different workbook. </p>\n\n<p>Code:</p>\n\n<pre><code>Dim rng3 As Range\nDim lAnswer As Variant\n\nSet rng3 = wbFrom.Sheets(\"Sheet0\").Range(\"P9:P50000\")\n\nlAnswer = Application.WorksheetFunction.Sum(rng3)\n\n'MsgBox lAnswer\n\nwbTo.Sheets(\"Sheet1\").Range(\"D16\").Value = lAnswer\n</code></pre>\n\n<p>Sample Data, which has spaces in it like this: </p>\n\n<pre><code>Header Name\n3545.0\n\n24.95\n\n\n0.0\n</code></pre>\n"}, {"tags": ["vba", "excel", "exe", "windows-task-scheduler"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 2, "creation_date": 1529503838, "post_id": 50949966, "comment_id": 88898097, "body": "Did you google this first? It seems like there are a lot of results that cover how to do this"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4973715, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6A9UD.jpg?s=128&g=1", "display_name": "coffeetime", "link": "https://stackoverflow.com/users/4973715/coffeetime"}, "edited": false, "score": 0, "creation_date": 1529580777, "post_id": 50950387, "comment_id": 88931288, "body": "Thank you very much Tom! This was truly helpful"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1529504218, "creation_date": 1529504218, "answer_id": 50950387, "question_id": 50949966, "link": "https://stackoverflow.com/questions/50949966/how-to-run-an-excel-macro-every-monday-using-windows-task-scheduler/50950387#50950387", "title": "How to run an Excel macro every Monday using Windows Task Scheduler", "body": "<p>In the workbook that runs your Macro make sure it is called in the <code>ThisWorkbook</code> Module <code>Workbook_Open</code></p>\n\n<pre><code>Private Sub Workbook_Open()\n    Call YourMacroHere\nEnd Sub\n</code></pre>\n\n<p>Then go to <code>Task Scheduler</code> and select <code>Create Basic Task</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/OkmhW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OkmhW.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then give your task a name</p>\n\n<p><a href=\"https://i.stack.imgur.com/EG3UP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EG3UP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Click <code>Next</code> and define your schedule</p>\n\n<p><a href=\"https://i.stack.imgur.com/SxcLm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SxcLm.png\" alt=\"enter image description here\"></a></p>\n\n<p>-> Next -></p>\n\n<p><a href=\"https://i.stack.imgur.com/j9ynf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j9ynf.png\" alt=\"enter image description here\"></a></p>\n\n<p>-> Next -> <code>Start a Program</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/HFlLJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HFlLJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>-> Next -> <code>Browse</code> and select your workbook</p>\n\n<p><a href=\"https://i.stack.imgur.com/fFf9i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fFf9i.png\" alt=\"enter image description here\"></a></p>\n\n<p>-> Next -> Confirm everything is correct and Finish</p>\n\n<p><a href=\"https://i.stack.imgur.com/CasY9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CasY9.png\" alt=\"enter image description here\"></a></p>\n\n<p>This will then, provided your computer is turned on will then open that Workbook every Monday at 9am. The <code>Workbook_Open()</code> event will then fire executing your macro. You may want to add to your code as well to shutdown the workbook after the macro has finished.</p>\n"}], "owner": {"reputation": 121, "user_id": 4973715, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6A9UD.jpg?s=128&g=1", "display_name": "coffeetime", "link": "https://stackoverflow.com/users/4973715/coffeetime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5254, "favorite_count": 0, "accepted_answer_id": 50950387, "answer_count": 1, "score": 0, "last_activity_date": 1529504218, "creation_date": 1529502928, "question_id": 50949966, "link": "https://stackoverflow.com/questions/50949966/how-to-run-an-excel-macro-every-monday-using-windows-task-scheduler", "title": "How to run an Excel macro every Monday using Windows Task Scheduler", "body": "<p>I created a macro that refreshes the data automatically and then it saves the file to a particular folder. I would like to set up a scheduled job that automatically runs my macro every Monday morning.</p>\n\n<p>How can I achieve this? </p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1529523322, "post_id": 50952685, "comment_id": 88909148, "body": "Thanks a lot for reply. I encountered a run-time error &#39;438&#39; (Object doesn&#39;t support this property or method)"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1529524211, "post_id": 50952685, "comment_id": 88909510, "body": "Can you update your post with the portion of html you have pasted as image above so that I can test it locally? That image cant be reused. Thanks."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1529526280, "post_id": 50952685, "comment_id": 88910414, "body": "Check out the edit. it should work now. I used <code>.queySelector()</code> instead of <code>.querySelector()</code>. Missed the <code>r</code> let alone a silly mistake was there."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1529526586, "post_id": 50952685, "comment_id": 88910548, "body": "There&#39;s no error now but the loop is infinite ..What should I do?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1529526679, "post_id": 50952685, "comment_id": 88910577, "body": "Kick out the loop and put a hardcoded delay to see what happens. Are you sure that very portion is not within iframe?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1529526954, "post_id": 50952685, "comment_id": 88910685, "body": "I&#39;m quite unsure why it fails to work for you cause it brought me success when I tested locally."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1529556967, "post_id": 50952685, "comment_id": 88918047, "body": "I suggest editing your post and post the solution of using &#39;keyboardevent&#39; .. Thank you very much for great help"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1529596212, "post_id": 50952685, "comment_id": 88941815, "body": "Thank you very much for you Shahin and also BLitE.exe You are awesome"}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": true, "score": 2, "last_activity_date": 1529565138, "last_edit_date": 1529565138, "creation_date": 1529510933, "answer_id": 50952685, "question_id": 50949198, "link": "https://stackoverflow.com/questions/50949198/select-an-item-from-drop-down-in-ie/50952685#50952685", "title": "Select an item from drop down in IE", "body": "<p>Try this. I used hardcoded delay to let the browser update it's content. The selector is able to select and change the desired number from dropdown. However, the only porblem was that the new content never updated unless we opted for <code>keyboardevent</code>.</p>\n\n<pre><code>Dim Html As HTMLDocument, post As Object, , evt As Object\n\nSet Html = IE.document ''without this line queryselector fails sometimes\n\nApplication.Wait Now + TimeValue(\"00:00:03\")\n\nSet post = Html.querySelector(\"select[name='WatchedCompaniesGrid_length']\")\npost.selectedIndex = 3\n</code></pre>\n\n<p>This is the portion that made that webpage update the result. I tried to show how you can use it in your script.</p>\n\n<pre><code>Set evt = Html.createEvent(\"keyboardevent\")\nevt.initEvent \"change\", True, False\n\nSet post = Html.querySelector(\"select[name='WatchedCompaniesGrid_length']\")\npost.selectedIndex = 3\npost.dispatchEvent evt\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1529557383, "post_id": 50956755, "comment_id": 88918167, "body": "Thank you very very much. That helped me a lot"}], "tags": [], "owner": {"reputation": 281, "user_id": 2857338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5e21d7f25573f28a85b386a3befa29?s=128&d=identicon&r=PG&f=1", "display_name": "BLitE.exe", "link": "https://stackoverflow.com/users/2857338/blite-exe"}, "is_accepted": false, "score": 3, "last_activity_date": 1529527451, "creation_date": 1529527451, "answer_id": 50956755, "question_id": 50949198, "link": "https://stackoverflow.com/questions/50949198/select-an-item-from-drop-down-in-ie/50956755#50956755", "title": "Select an item from drop down in IE", "body": "<p>First thing first what version of IE are you using? Cause it will depend on what is the event trigger for this selection. </p>\n\n<p>You can try this to select the index of that selection based on the option value. </p>\n\n<pre><code>Set oElt = ie.document.getElementsByName(\"WatchedCompaniesGrid_length\")\n    For a = 0 To oElt.Options.Length - 1\n        If oElt.Options(a).Text = \"sample Option Value\" Then\n            oElt.selectedIndex = a\n            Exit For\n        End If\n    Next\n</code></pre>\n\n<p>Now for the event trigger part. After you select your desired option. </p>\n\n<p>In IE11 you can try this one. </p>\n\n<pre><code>Dim objEvent\n    Set objEvent = IE.Document.createEvent(\"HTMLEvents\")    'Create an event handler for IE.Document\n    objEvent.initEvent \"change\", False, True\n    oElt.dispatchEvent objEvent   \n</code></pre>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 1, "accepted_answer_id": 50952685, "answer_count": 2, "score": 2, "last_activity_date": 1529565138, "creation_date": 1529500602, "last_edit_date": 1529524924, "question_id": 50949198, "link": "https://stackoverflow.com/questions/50949198/select-an-item-from-drop-down-in-ie", "title": "Select an item from drop down in IE", "body": "<p>In the following picture I am trying to click the option 50 from this drop down menu which is implemented in a table in html structure\nAny help please \n<a href=\"https://i.stack.imgur.com/imSJo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/imSJo.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried this line</p>\n\n<pre><code>.document.getElementByName(\"WatchedCompaniesGrid_length\").Value = \"50\"\n</code></pre>\n\n<p>But this throws an error</p>\n\n<p>I also tried those lines</p>\n\n<pre><code>     Set oElt = ie.document.getElementsByName(\"WatchedCompaniesGrid_length\")\nIf Not oElt Is Nothing Then\n    oElt(0).Value = \"50\"\n\nEnd If\n</code></pre>\n\n<p>and it actually selects the option but doesn't trigger the event .. I tried oElt.FireEvent \"onchange\" but doesn't work for me</p>\n\n<p>This is html lines</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;input name=\"WatchedCompaniesGridSelectedId\" id=\"WatchedCompaniesGridSelectedId\" type=\"hidden\" value=\"\" autocomplete=\"off\"&gt;&lt;script language=\"javascript\" type=\"text/javascript\"&gt;WatchedCompaniesGridinit = new RegSysPortal.Grid();WatchedCompaniesGridinit.Initialise('WatchedCompaniesGrid','','','','','','', '', '', 'false', 'true', 'true', 'true', 'two_button', '5', 'asc', '', '10', '1,R,3,C,4,C,5,C,6,C,7,C,8,C', '0', '0', '', '0', null, false, false);&lt;/script&gt;&lt;div class=\"frmResponse_blank\" id=\"WatchedCompaniesGrid_result\"&gt;&lt;span class=\"frmResponse_message_span\"&gt;&lt;/span&gt;&lt;/div&gt;    &lt;div class=\"dataTables_wrapper\" id=\"WatchedCompaniesGrid_wrapper\" role=\"grid\"&gt;&lt;div class=\"fg-headerbar\"&gt;&lt;div class=\"dataTables_length\" id=\"WatchedCompaniesGrid_length\"&gt;&lt;span&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;Show &lt;/td&gt;&lt;td&gt;&lt;select name=\"WatchedCompaniesGrid_length\" aria-controls=\"WatchedCompaniesGrid\" size=\"1\"&gt;&lt;option value=\"5\"&gt;5&lt;/option&gt;&lt;option value=\"10\"&gt;10&lt;/option&gt;&lt;option value=\"25\"&gt;25&lt;/option&gt;&lt;option value=\"50\"&gt;50&lt;/option&gt;&lt;option value=\"100\"&gt;100&lt;/option&gt;&lt;/select&gt;&lt;/td&gt;&lt;td&gt;entries&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=\"dataTables_filter\" id=\"WatchedCompaniesGrid_filter\"&gt;&lt;span&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;Search:&lt;/td&gt;&lt;td&gt;&lt;input aria-controls=\"WatchedCompaniesGrid\" type=\"text\" autocomplete=\"off\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;table class=\"z-index: 2000 dataTable\" id=\"WatchedCompaniesGrid\" aria-describedby=\"WatchedCompaniesGrid_info\" style=\"width: 987px;\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>** this is html part</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;Show &lt;/td&gt;&lt;td&gt;&lt;select name=\"WatchedCompaniesGrid_length\" aria-controls=\"WatchedCompaniesGrid\" size=\"1\"&gt;&lt;option value=\"5\"&gt;5&lt;/option&gt;&lt;option value=\"10\"&gt;10&lt;/option&gt;&lt;option value=\"25\"&gt;25&lt;/option&gt;&lt;option value=\"50\"&gt;50&lt;/option&gt;&lt;option value=\"100\"&gt;100&lt;/option&gt;&lt;/select&gt;&lt;/td&gt;&lt;td&gt;entries&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1529500371, "post_id": 50948984, "comment_id": 88895732, "body": "Unable to recreate the error whether I run this from an XLAM or an XLSM. Can you please clarify what this means: <i>using a Macro in a cell that call a Sub method ? Calling the same code from a button works perfectly.</i> What is a &quot;macro in a cell that call a sub method?&quot;"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1529500430, "post_id": 50948984, "comment_id": 88895764, "body": "Also, it looks like the <code>.Delete</code> is going to delete the worksheet that you just added. I&#39;m not sure that is intentional."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 2, "creation_date": 1529501235, "post_id": 50948984, "comment_id": 88896283, "body": "It may be an issue with the newly created sheet not properly being defined.  Try defining <code>ThisWorkbook.Sheets.Add</code> as <code>Dim nwSht as Sheet: Set nwSht = ThisWorkbook.Sheets.Add</code>.  Then start your <code>With</code> as <code>With nwSht</code>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1529501236, "post_id": 50948984, "comment_id": 88896284, "body": "Call from a cell? If you mean your code is part of a Public Function you call like =PFunction(), then I doubt your code will ever work. Please explain how you call from a cell?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1529501392, "post_id": 50948984, "comment_id": 88896387, "body": "To add/explain @JvdV &#39;s comment: it is generally forbidden to alter the Excel Environment during the execution of a UDF worksheet function call. So if you are expecting that a function evaluation will be able to add a worksheet, this is probably not possible without taking some extraordinary measures."}, {"owner": {"reputation": 57, "user_id": 1134626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5b3b107740a20236c68d63b3f3c6084?s=128&d=identicon&r=PG", "display_name": "mp9007", "link": "https://stackoverflow.com/users/1134626/mp9007"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1529503102, "post_id": 50948984, "comment_id": 88897637, "body": "@DavidZemens it is what I thought that it was forbidden to alter the Excel Environment. I was just not sure and wasn&#39;t able to find the good words to find my answer."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1529504618, "post_id": 50948984, "comment_id": 88898699, "body": "There is a way to get around this limit, by modifying the approach outlined here: <a href=\"https://stackoverflow.com/questions/9476282/cannot-vba-write-data-to-cells-in-excel-2007-2010-within-a-function/9493006#9493006\" title=\"cannot vba write data to cells in excel 2007 2010 within a function\">stackoverflow.com/questions/9476282/&hellip;</a>"}], "owner": {"reputation": 57, "user_id": 1134626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5b3b107740a20236c68d63b3f3c6084?s=128&d=identicon&r=PG", "display_name": "mp9007", "link": "https://stackoverflow.com/users/1134626/mp9007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1529504634, "answer_count": 0, "score": 1, "last_activity_date": 1529503983, "creation_date": 1529499935, "last_edit_date": 1529503983, "question_id": 50948984, "link": "https://stackoverflow.com/questions/50948984/excel-vba-adding-a-sheet-from-a-button-is-working-but-not-from-a-macro", "closed_reason": "Duplicate", "title": "Excel-VBA - Adding a sheet from a button is working, but not from a Macro", "body": "<p>I was wondering, can I add an excel sheet using a Macro in a cell that call a Sub method ? Calling the same code from a button works perfectly.</p>\n\n<p>My code crash a the <code>.Range(\"A1\") = \"Col1\"</code> with the wonderful error message <code>Application-defined or Object-defined error</code>. I have read that my cells needs to be fully qualified. So I tried replacing <code>ThisWorkbook</code> with <code>Workbooks(\"MyExcelAddins.xlam\")</code>, but no success.</p>\n\n<p>Is it because when I'm in a cell, the state of the application is not the same ?\nI suppose that adding a sheet didn't work...</p>\n\n<p>Thank you.</p>\n\n<p>My code:</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nWith ThisWorkbook.Sheets.Add\n    .Range(\"A1\") = \"Col1\"\n    .Range(\"B1\") = \"Col2\"\n    .Range(\"C1\") = \"Col3\"\n    .Range(\"D1\") = \"Col4\"\n    .Range(\"A2\") = filter1\n    .Range(\"B2\") = filter2\n    .Range(\"C2\") = filter3\n    .Range(\"D2\") = filter4\n\n    Workbooks(\"MyExcelAddIns.xlam\").Sheets(\"MyDataSheet\").Range(\"tblMyDataToFilter\").CurrentRegion.AdvancedFilter xlFilterInPlace, .Range(\"A1:D2\")\n    .Delete\nEnd With\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p><strong>EDIT</strong><br>\nClarification 1: what I mean by \"using a Macro in a cell that call a Sub method\" is <code>=MyFunc(A1;A2;A3;A4)</code>.<br>\nClarification 2: yes I know that my code is deleting the sheet right away. I wanted to be able to filter a table without looping throught each row and I found this technique in this answer : <a href=\"https://stackoverflow.com/questions/20764851/vba-excel-find-based-on-multiple-search-criteria-without-looping\">VBA (Excel): Find Based on Multiple Search Criteria Without Looping</a> .  </p>\n\n<p>Finally, I'll mark this post as \"Answered\", because the comment of David Zemens.</p>\n\n<blockquote>\n  <p>it is generally forbidden to alter the Excel Environment during the execution of a UDF worksheet function call.</p>\n</blockquote>\n\n<p>It is the answer I was looking for. Thank you guys.</p>\n"}, {"tags": ["vba", "excel", "difference"], "comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1529500859, "post_id": 50948958, "comment_id": 88896037, "body": "I find it really hard to read the whole question to understand your issue. You just want to add a &quot;*&quot; to the test result if the difference with &quot;Our Calculation&quot; is +/- 10%?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9963916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9604873e6a4fc9cdde66b137558d86?s=128&d=identicon&r=PG&f=1", "display_name": "runriot", "link": "https://stackoverflow.com/users/9963916/runriot"}, "edited": false, "score": 0, "creation_date": 1529697793, "post_id": 50949314, "comment_id": 88984315, "body": "Thank you! I needed to use helper cells (was hoping I could avoid it but that&#39;s okay) but it works perfectly!"}], "tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 0, "last_activity_date": 1529500998, "creation_date": 1529500998, "answer_id": 50949314, "question_id": 50948958, "link": "https://stackoverflow.com/questions/50948958/excel-vba-calculating-difference-between-two-cells-adding-characters-if-differ/50949314#50949314", "title": "Excel VBA Calculating difference between two cells + adding characters if difference is exceeded", "body": "<p>Here's a quick mockup I did that should do what you're asking for - you'll probably just have to adjust the column as I made my mock data in column A. </p>\n\n<p>Also note that for grabbing the values of test and calc I chose to grab the last 4 digits just to be safe. If you need more or less, you can just change that last number in the paranthesis.</p>\n\n<pre><code>Dim test As Double\nDim calc As Double\n\nFor i = 1 To Cells(Rows.count, \"A\").End(xlUp).row Step 3\n\n    test = Right$(Cells(i, \"A\").Value2, 4)\n    calc = Right$(Cells(i + 1, \"A\").Value2, 4)\n\n    If Abs(test - calc) / calc &gt; 0.1 Then\n        Cells(i, \"A\").Value2 = Cells(i, \"A\").Value2 &amp; \"*\"\n    End If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1529503684, "post_id": 50949454, "comment_id": 88897991, "body": "The last blank cell is just a spacer, though, isn&#39;t it?"}, {"owner": {"reputation": 13, "user_id": 9963916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9604873e6a4fc9cdde66b137558d86?s=128&d=identicon&r=PG&f=1", "display_name": "runriot", "link": "https://stackoverflow.com/users/9963916/runriot"}, "edited": false, "score": 0, "creation_date": 1529505563, "post_id": 50949454, "comment_id": 88899329, "body": "Yes the last cell is just a spacer cell."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1529501408, "creation_date": 1529501408, "answer_id": 50949454, "question_id": 50948958, "link": "https://stackoverflow.com/questions/50948958/excel-vba-calculating-difference-between-two-cells-adding-characters-if-differ/50949454#50949454", "title": "Excel VBA Calculating difference between two cells + adding characters if difference is exceeded", "body": "<p>Using end(up) misses the last blank cell below the final pair. I did it this way:</p>\n\n<pre><code>Sub QuikandDirty()\n            Dim r As Range\n            For Each r In Intersect(ActiveSheet.Columns(\"a\").Cells, ActiveSheet.UsedRange.Offset(1, 0)) 'assume col A\n            If r = 0 Then\n                If Abs(r.Offset(-2, 0) - r.Offset(-1, 0)) &gt; (r.Offset(-2, 0) / 10) Then\n                   r.Offset(-2, 0).Formula = CStr(r.Offset(-2, 0).Formula) &amp; \"*\"\n                End If\n            End If\n            Next r\n            End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9963916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9604873e6a4fc9cdde66b137558d86?s=128&d=identicon&r=PG&f=1", "display_name": "runriot", "link": "https://stackoverflow.com/users/9963916/runriot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "accepted_answer_id": 50949314, "answer_count": 2, "score": 1, "last_activity_date": 1529504713, "creation_date": 1529499882, "last_edit_date": 1529504713, "question_id": 50948958, "link": "https://stackoverflow.com/questions/50948958/excel-vba-calculating-difference-between-two-cells-adding-characters-if-differ", "title": "Excel VBA Calculating difference between two cells + adding characters if difference is exceeded", "body": "<p>So I've looked far and wide for anything similar and all other people's issues seem to be with numbers in neighboring columns. I'm trying to clean up a spreadsheet for my company that was created ages ago. The girl doing the data entry on it has very little Excel knowledge and is used to things being entered in this layout, so I don't particularly want to recreate the whole spreadsheet... Here's my problem haha</p>\n\n<p>I have two rows of data (in the same column), there is a skip cell and then repeat. This goes on for about 250 lines, each being \"paired\" results but in the same column with a skip cell between. I need to find the difference between these two only, such as Test Result #1 and it's pairing with Our Calculation #1 below (within 10% +/- of each other) and mark the top cell in the pair with an \"*\" after the number already existing in the cell.</p>\n\n<p>Example: First pair is within +/- 10% of our calculation, second is out of that range.<br>\n    Test Result #1  &ensp;  &ensp;&ensp;&ensp;&ensp;  12.5   <br>\nOur Calculation #1  &ensp;&ensp;    11.9   <br>  &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;<em>empty cell</em> <br>\nTest Result #2 &ensp;&ensp;&ensp; &ensp; &ensp;  15.0* <br>\nOur Calculation #2 &ensp; &ensp; 13.0 <br></p>\n\n<p>I know to get the \"*\" in, I'll use an if-then-else statement, which is no problem. But I'm struggling trying to figure out how (if it's possible) to calculate the difference. My sheet also has 6 columns of this same layout (one for each parameter for X sample we're looking at).</p>\n\n<p>Any pointers in the right direction are appreciated! Thank you!</p>\n"}, {"tags": ["vba", "image"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1529501324, "post_id": 50948752, "comment_id": 88896344, "body": "Calling Workbook the Excel.Application instance is not a good idea (Even if the instance was a workbook (which is not), using well known/reserved  class/object names as variable name can only confuse peoples."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1529501576, "post_id": 50948752, "comment_id": 88896503, "body": "Given Workbook is an Application object (sic.), Workbook.Sheets is the collection of sheets of the current ActiveWorkbook. Since you already have a reference to the workbook DataWorkbook, why not using it?"}, {"owner": {"reputation": 1, "user_id": 9967450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0hy8b_s0Op8/AAAAAAAAAAI/AAAAAAAARo4/RRuyQzY7Tww/photo.jpg?sz=128", "display_name": "Bert", "link": "https://stackoverflow.com/users/9967450/bert"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1529501843, "post_id": 50948752, "comment_id": 88896704, "body": "To be very honest, I have no idea how. I do not really understand how this part works."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1529501969, "post_id": 50948752, "comment_id": 88896810, "body": "<code>DataWorkbook.Sheets(&quot;Sheet1&quot;).Cells(1, 1) = &quot;Data to CELL&quot;</code> instead of <code>Workbook.Sheets(&quot;Sheet1&quot;).Cells(1, 1) = &quot;Data to CELL&quot;</code> will be clearer, easier to maintain, and less error prone..."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1529502117, "post_id": 50948752, "comment_id": 88896926, "body": "And closing the workbook should set the reference to Nothing already, but if you want to be explicit it would be better to set the references to nothing in reverse order (the workbook object named dataworkbook before the Application object named workbook)"}, {"owner": {"reputation": 1, "user_id": 9967450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0hy8b_s0Op8/AAAAAAAAAAI/AAAAAAAARo4/RRuyQzY7Tww/photo.jpg?sz=128", "display_name": "Bert", "link": "https://stackoverflow.com/users/9967450/bert"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1529502778, "post_id": 50948752, "comment_id": 88897412, "body": "That indeed works. However I do not succeed to use picture.insert(picturepath) with this DataWorkbook. Is that possible?"}, {"owner": {"reputation": 1, "user_id": 9967450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0hy8b_s0Op8/AAAAAAAAAAI/AAAAAAAARo4/RRuyQzY7Tww/photo.jpg?sz=128", "display_name": "Bert", "link": "https://stackoverflow.com/users/9967450/bert"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1529513879, "post_id": 50948752, "comment_id": 88904572, "body": "Is there anybody who can help getting the pictures in the external excel file imported as asked above?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1529658099, "post_id": 50948752, "comment_id": 88963548, "body": "You can use <code>DataWorkbook.Sheets(&quot;Sheet1&quot;).</code><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/shapes-addpicture-method-excel\" rel=\"nofollow noreferrer\">Shapes.AddPicture</a><code>(PicturePath , msoFalse, msoTrue, 0, 0, -1, -1)</code> to add the pictures in the workbook"}, {"owner": {"reputation": 1, "user_id": 9967450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0hy8b_s0Op8/AAAAAAAAAAI/AAAAAAAARo4/RRuyQzY7Tww/photo.jpg?sz=128", "display_name": "Bert", "link": "https://stackoverflow.com/users/9967450/bert"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1529747704, "post_id": 50948752, "comment_id": 88993884, "body": "Oh super! Thanks a lot Vincent!!!"}], "owner": {"reputation": 1, "user_id": 9967450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0hy8b_s0Op8/AAAAAAAAAAI/AAAAAAAARo4/RRuyQzY7Tww/photo.jpg?sz=128", "display_name": "Bert", "link": "https://stackoverflow.com/users/9967450/bert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529500458, "creation_date": 1529499224, "last_edit_date": 1529500458, "question_id": 50948752, "link": "https://stackoverflow.com/questions/50948752/insert-pictures-to-hidden-excel-file", "title": "Insert pictures to hidden Excel file", "body": "<p>I am trying to insert text and pictures from a specific folder to a hidden Excel file, in specific cells, but for some reason I do not succeed in adding the pictures to the file.</p>\n\n<p>What I can is open a hidden Excel file and add a bunch of data to the Excel. I can also add pictures tot the Excel from which the VBA script is running.\nHowever combining both is something where I fail.</p>\n\n<p>I use the following code to open an Excel file and put data in there:</p>\n\n<pre><code>Dim ExcelFileName As String\nExcelFileName = \"C:\\PictureTest.xlsx\"\n\n    Dim Workbook As New Excel.Application\n    Dim DataWorkbook As New Excel.Workbook\n    Set DataWorkbook = Workbook.Workbooks.Open(ExcelFileName)\n        Workbook.Sheets(\"Sheet1\").Cells(1, 1) = \"Data to CELL\"\n    DataWorkbook.Save\n    DataWorkbook.Close\n    Set Workbook = Nothing\n    Set DataWorkbook = Nothing\n</code></pre>\n\n<p>This one works perfectly, I can put data in any sheet anywhere I want.\nHowever I also need to put pictures on certain sheets/cells.</p>\n\n<p>I use the following code to add a picture to the active Excel file from which I am running the VBA script:</p>\n\n<pre><code>Dim PicturePath As String\nPicturePath = \"C:\\Picture.tif\"\n\nDim strPath As String\nDim Picture As Object\n            Set Picture = ActiveSheet.Pictures.Insert(PicturePath)\n            Picture.ShapeRange.LockAspectRatio = msoCTrue\n            Picture.Placement = xlMoveAndSize\n            Picture.ShapeRange.Width = 0.3 * Picture.Width\n</code></pre>\n\n<p>Is there anyone who can help me in getting both combined?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1529499201, "post_id": 50948633, "comment_id": 88894950, "body": "<a href=\"https://www.rondebruin.nl/win/s1/outlook/account.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s1/outlook/account.htm</a>"}, {"owner": {"reputation": 2219, "user_id": 5900271, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/081e7ff2df88737fa5d3a9911b56d177?s=128&d=identicon&r=PG&f=1", "display_name": "Wojtek Wencel", "link": "https://stackoverflow.com/users/5900271/wojtek-wencel"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1529499432, "post_id": 50948633, "comment_id": 88895093, "body": "@Marcucciboy2 I want to use <code>MailEnvelope</code>, not the Microsoft Outlook Object Library."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1529499825, "post_id": 50948633, "comment_id": 88895352, "body": "My apologies, I have not used the <code>MailEnvelope</code> class before"}], "owner": {"reputation": 2219, "user_id": 5900271, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/081e7ff2df88737fa5d3a9911b56d177?s=128&d=identicon&r=PG&f=1", "display_name": "Wojtek Wencel", "link": "https://stackoverflow.com/users/5900271/wojtek-wencel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529498806, "creation_date": 1529498806, "last_edit_date": 1531164843, "question_id": 50948633, "link": "https://stackoverflow.com/questions/50948633/sending-mailenvelope-with-multiple-email-accounts", "title": "Sending MailEnvelope with multiple email accounts", "body": "<p>I'm sending a <code>MailEnvelope</code> through macro in Excel. I have only one email account added to Outlook, but this will have to work with multiple accounts. Unfortunately I can't access the <code>From</code> property. Does excel ask you to chose an account when you have more than one? How can I solve this?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1529517904, "creation_date": 1529517904, "answer_id": 50954504, "question_id": 50948618, "link": "https://stackoverflow.com/questions/50948618/open-msg-from-network-drive-folder-then-download-hyperlinks/50954504#50954504", "title": "Open .msg from Network Drive Folder Then Download Hyperlinks", "body": "<p>Firstly, do not use <code>Application.CreateItemFromTemplate</code>. Use <code>Application.Session.OpenSharedItem</code>.</p>\n\n<p>Once you have <code>MailItem</code> object (you are already accessing the <code>Attachments</code> collection in your script above), read <code>GetInspector</code> property (returns <code>Inspector</code> object), then use <code>Inspector.WordEditor</code> to access <code>Word.Document</code> object. It exposes <code>Hyperlinks</code> property. </p>\n"}], "owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592985974, "creation_date": 1529498739, "last_edit_date": 1592985974, "question_id": 50948618, "link": "https://stackoverflow.com/questions/50948618/open-msg-from-network-drive-folder-then-download-hyperlinks", "title": "Open .msg from Network Drive Folder Then Download Hyperlinks", "body": "<p>My objective is to open all Outlook .msg files that are saved in a shared drive folder. Once each email is opened, open the hyperlinks contained in the body of the email and save the file that opens from the link. I would ideally skip links which would be different from the rest.</p>\n\n<p>This is the code I use to open .msg files and save attachments. I figure I could reuse part of this to open the hyperlinks.</p>\n\n<pre><code>Sub SaveAttachments()\n\n    Dim msg As Outlook.MailItem\n    Dim att As Outlook.Attachment\n    Dim strFilePath As String\n    Dim strAttPath As String\n    Dim colFiles As New Collection, f\n    Dim posr As String\n\n    'path for msgs\n    strFilePath = \"R:\\AP\\FY18\\\"\n\n    GetFiles strFilePath, \"*.msg\", True, colFiles\n\n    'path for saving attachments\n    strAttPath = \"R:\\AP\\Testing Extracts\\\"\n\n    For Each f In colFiles\n        Set msg = Application.CreateItemFromTemplate(f)\n        If msg.Attachments.Count &gt; 0 Then\n            For Each att In msg.Attachments\n                posr = InStrRev(att.filename, \".\")\n                ext = Right(att.filename, Len(att.filename) - posr)\n                posl = InStr(att.filename, \".\")\n                fname = Left(att.filename, posr - 1)\n                att.SaveAsFile strAttPath &amp; \"\\\" &amp; fname &amp; \"_\" &amp; Format(msg.ReceivedTime, \"ddmmyyyy_hhmm\") &amp; \".\" &amp; ext\n'               att.SaveAsFile strAttPath &amp; att.FileName\n            Next\n        End If\n    Next\n\nEnd Sub\n\nSub GetFiles(StartFolder As String, Pattern As String, _\n             DoSubfolders As Boolean, ByRef colFiles As Collection)\n\n    Dim f As String, sf As String, subF As New Collection, s\n\n    If Right(StartFolder, 1) &lt;&gt; \"\\\" Then StartFolder = StartFolder &amp; \"\\\"\n\n    f = Dir(StartFolder &amp; Pattern)\n    Do While Len(f) &gt; 0\n        colFiles.Add StartFolder &amp; f\n        f = Dir()\n    Loop\n\n    sf = Dir(StartFolder, vbDirectory)\n    Do While Len(sf) &gt; 0\n        If sf &lt;&gt; \".\" And sf &lt;&gt; \"..\" Then\n            If (GetAttr(StartFolder &amp; sf) And vbDirectory) &lt;&gt; 0 Then\n                    subF.Add StartFolder &amp; sf\n            End If\n        End If\n        sf = Dir()\n    Loop\n\n    For Each s In subF\n        GetFiles CStr(s), Pattern, True, colFiles\n    Next s\n\nEnd Sub\n</code></pre>\n\n<p>I've seen the following. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/26186279/urldownloadtofile-in-access-2010-sub-or-function-not-defined\">UrlDownloadToFile in Access 2010 - Sub or Function not Defined</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/48638504/outlook-script-that-automatically-opens-links-in-emails\">outlook script that automatically opens links in emails</a></p>\n\n<p>The second of those links lead me to <code>HTMLBody</code>. I managed to create a new email, not open the links in a saved email.</p>\n\n<p>A few things to note:</p>\n\n<ol>\n<li>The emails are saved to the folder by someone other than myself.</li>\n<li>I do not have access to the outlook inbox that the emails are being sent to. So I cannot pull it directly from the email in outlook.</li>\n<li>There are approximately 100 hyperlinks in the body of each .msg saved.</li>\n</ol>\n\n<p>I've never worked with hyperlinks in VBA before.</p>\n"}, {"tags": ["excel", "ms-word", "vba"], "comments": [{"owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "edited": false, "score": 1, "creation_date": 1529583070, "post_id": 50948487, "comment_id": 88932742, "body": "Can you clarify more exactly what you&#39;re actual question is?"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1529655863, "creation_date": 1529655863, "answer_id": 50983720, "question_id": 50948487, "link": "https://stackoverflow.com/questions/50948487/update-word-table-based-on-excel-data/50983720#50983720", "title": "Update Word table based on Excel data", "body": "<p>Since this appears to be a standard document format - something you'll be re-using - the first step is to create a Word document with the basic \"structures\". Type in and format all the static text that will never change. Use the Insert/Links/Bookmark command in the Ribbon to set \"targets\" for the dynamic data coming from Excel (or any other source).</p>\n\n<p>Save this as a <em>template</em> (dotx file format). Change your <code>WdObj.documents.Add</code> line of code to pick up this file path. A new document will be created based on the template and will contain the static text plus the bookmarks. Be sure to set it to a <code>Word.Document</code> object:</p>\n\n<pre><code>Dim wdDoc as Word.Document 'or As Object if you don't have a reference to the Word library\nSet wdDoc = WdObj.Documents.Add(\"filepath\")\n</code></pre>\n\n<p>Target the bookmarks you defined in your code*:</p>\n\n<pre><code>Dim rngTarget as Word.Range\nSet rngTarget = wdDoc.Bookmarks(\"NameOfBookmark\").Range\nrngTarget.PasteExcelTable False, False, False\n\nSet rngTarget = wdDoc.Bookmarks(\"DifferentBookmark\").Range\nrngTarget.Text = Sheet1.Range(\"A2\").Value2 'for example, to get the name\n</code></pre>\n\n<p>When you're done, don't forget to <em>save</em> the document before closing...</p>\n\n<pre><code>wdDoc.SaveAs \"filepath\"\nwdDoc.Close\nwdObj.Quit\nSet wdDoc = Nothing\nSet wdObj = Nothing\n</code></pre>\n\n<p>Also, use error handling correctly. As it stands, you won't see any errors, but you need to see them. Otherwise you won't know if or why your code is failing. Remove <code>On Error Resume Next</code> from your code - this only makes sense if you're using <code>GetObject</code> to pick up a running Word application. In such a case, this is followed immediately by <code>On Error GoTo 0</code> which turns errors back on. </p>\n\n<p>*Note: you can assign directly to a bookmark, but if you need the range for something else, such as formatting, better to do it in two steps. To assign directly:</p>\n\n<pre><code>wdDoc.Bookmarks(\"NameOfBookmark\").Range.Text = \"abc\"\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9600315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a1e1cd805e049385fa291544c2f2534?s=128&d=identicon&r=PG&f=1", "display_name": "Mubarak Abdullah", "link": "https://stackoverflow.com/users/9600315/mubarak-abdullah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 50983720, "answer_count": 1, "score": -1, "last_activity_date": 1529655863, "creation_date": 1529498324, "last_edit_date": 1531161705, "question_id": 50948487, "link": "https://stackoverflow.com/questions/50948487/update-word-table-based-on-excel-data", "title": "Update Word table based on Excel data", "body": "<p>I have a Report Template created in MS Word. Now, I have some data in Excel spreadsheet which needs to be merged with the report template. I explored the <code>Mail Merge</code> functionality in MS Word, where I can create multiple reports. But, as I see the function is only static and can only work, if the data is uniform for each row, which I don't. \nSample data in Excel is,\n<a href=\"https://i.stack.imgur.com/qoPKg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qoPKg.png\" alt=\"Excel Data\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/5fIwa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5fIwa.png\" alt=\"Excel Format 2\"></a></p>\n\n<p>The data is shown in word in the following format,\n<a href=\"https://i.stack.imgur.com/xJ6T9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xJ6T9.png\" alt=\"Word Format\"></a> </p>\n\n<pre><code>Sub CopyRowToRC()\nSheet2.Range(\"A:B\").Clear\ni = 1\nj = 2\nApplication.ScreenUpdating = False\nWith Sheet1\nLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\nFor i = 1 To LastRow\n\nWith Sheet2\nLastRows = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nIf i &gt; 1 Then\nLastRows = LastRows + 2\nEnd If\nEnd With\n\nIf j &lt;= LastRow Then\nSheet1.Rows(1).SpecialCells(xlCellTypeConstants).Copy\nSheet2.Range(\"A\" &amp; LastRows).PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=True, Transpose:=True\nSheet1.Rows(j).SpecialCells(xlCellTypeConstants).Copy\nSheet2.Range(\"B\" &amp; LastRows).PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=True, Transpose:=True\nj = j + 1\nEnd If\nNext\nSheet2.Activate\nApplication.ScreenUpdating = False\nWordUp\nEnd Sub\n\n\nSub WordUp()\nOn Error Resume Next\nDim WdObj As Object, fname As String\nfname = \"File Name\"\nSet WdObj = CreateObject(\"Word.Application\")\nWdObj.Visible = True\n\nWith Sheet2\nLastRows = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nSheet2.Range(\"A1:B\" &amp; LastRows).Copy\n\nWdObj.documents.Add\nWdObj.Selection.PasteExcelTable False, False, False\nWith WdObj\n    .ActiveDocument.Close\n    .Quit\nEnd With\nSet WdObj = Nothing\nSheet2.Range(\"A:B\").Clear\nSheet1.Activate\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>The above code helps me to create a table for each row for the second Excel format attached, in Word by just converting columns into rows. But there are data to be pasted outside the table too.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1529498311, "post_id": 50948333, "comment_id": 88894430, "body": "<code>Cells(0,</code> would always throw an error. The first row is number 1, thus <code>Cells(1,1)</code> is the minimum)."}, {"owner": {"reputation": 51, "user_id": 7671536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209247718893523/picture?type=large", "display_name": "Charlie Felix", "link": "https://stackoverflow.com/users/7671536/charlie-felix"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1529498645, "post_id": 50948333, "comment_id": 88894641, "body": "okay but even if i change that i get a object-defined or application-defined error."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1529498730, "post_id": 50948333, "comment_id": 88894683, "body": "Of course. But you are one step closer. Try this - <code>Sheets(&quot;sheet2&quot;).Cells(1, WorksheetFunction.Match(Columnname, Sheets(&quot;sheet2&quot;).Rows(1), 0)).Select</code> and see where you are getting the error."}, {"owner": {"reputation": 51, "user_id": 7671536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209247718893523/picture?type=large", "display_name": "Charlie Felix", "link": "https://stackoverflow.com/users/7671536/charlie-felix"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1529500258, "post_id": 50948333, "comment_id": 88895645, "body": "I get the same error :("}, {"owner": {"reputation": 51, "user_id": 7671536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209247718893523/picture?type=large", "display_name": "Charlie Felix", "link": "https://stackoverflow.com/users/7671536/charlie-felix"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1529500272, "post_id": 50948333, "comment_id": 88895660, "body": "The debugger doesnt highlight a line either"}, {"owner": {"reputation": 51, "user_id": 7671536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209247718893523/picture?type=large", "display_name": "Charlie Felix", "link": "https://stackoverflow.com/users/7671536/charlie-felix"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1529500331, "post_id": 50948333, "comment_id": 88895694, "body": "The code runs up until sheets(sheet2).select tho, so i know the match function is the problem"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7671536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209247718893523/picture?type=large", "display_name": "Charlie Felix", "link": "https://stackoverflow.com/users/7671536/charlie-felix"}, "edited": false, "score": 0, "creation_date": 1529506817, "post_id": 50950146, "comment_id": 88900253, "body": "Hi, that works perfectly except for one thing! It puts the new values at the bottom of each column. Sometimes my column will be missing values. Therefore the values will be put out of their respective row. Is there a way to fix this?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 51, "user_id": 7671536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209247718893523/picture?type=large", "display_name": "Charlie Felix", "link": "https://stackoverflow.com/users/7671536/charlie-felix"}, "edited": false, "score": 0, "creation_date": 1529510292, "post_id": 50950146, "comment_id": 88902545, "body": "@CharlieFelix, I have updated the answer. I made it so it won&#39;t error out on a variable that won&#39;t be in your master data. It&#39;s not necessarily shorter anymore :)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 51, "user_id": 7671536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209247718893523/picture?type=large", "display_name": "Charlie Felix", "link": "https://stackoverflow.com/users/7671536/charlie-felix"}, "edited": false, "score": 0, "creation_date": 1529561956, "post_id": 50950146, "comment_id": 88919953, "body": "@charlieFelix, no problem. See where it says \u2018If not CL is nothing then ..... end if\u2019? You can make an else in between that will handle with the missing values (your bonus question). Good luck"}, {"owner": {"reputation": 51, "user_id": 7671536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209247718893523/picture?type=large", "display_name": "Charlie Felix", "link": "https://stackoverflow.com/users/7671536/charlie-felix"}, "edited": false, "score": 0, "creation_date": 1529567454, "post_id": 50950146, "comment_id": 88922989, "body": "so  if not cl is nothing then XYZ else copy cell value to the end of the row?"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1529667049, "last_edit_date": 1529667049, "creation_date": 1529503455, "answer_id": 50950146, "question_id": 50948333, "link": "https://stackoverflow.com/questions/50948333/vba-how-can-i-select-the-cell-in-a-row-which-matches-a-variables-value/50950146#50950146", "title": "VBA: How can i select the cell in a row which matches a variable&#39;s value?", "body": "<p>What about this:</p>\n\n<pre><code>Dim LR As Long, X As Long, LC As Long, COL As Long\nDim RNG As Range, CL As Range\n\nOption Explicit\n\nSub Test()\n\nLR = Sheets(2).Cells.SpecialCells(xlCellTypeLastCell).Row 'Get last used row in your sheet\nLC = Sheets(2).Cells(1, Sheets(2).Columns.Count).End(xlToLeft).Column 'Get last used column in your sheet\nSet RNG = Sheets(2).Range(Sheets(2).Cells(1, 1), Sheets(2).Cells(1, LC))\n\n'Loop through all the columns on your sheet with values\nFor X = 1 To Sheets(1).Cells(1, Sheets(1).Columns.Count).End(xlToLeft).Column\n    Set CL = RNG.Find(Sheets(1).Cells(1, X).Value, lookat:=xlWhole)\n    If Not CL Is Nothing Then\n        COL = CL.Column\n        Sheets(2).Cells(LR + 1, COL).Value = Sheets(1).Cells(2, X).Value 'Get the value on LR offset by 1\n    Else\n        Sheets(2).Cells(1, Sheets(2).Cells(1, Sheets(2).Columns.Count).End(xlToLeft).Column).Value = Sheets(1).Cells(1, X).Value\n        Sheets(2).Cells(LR + 1, Sheets(2).Cells(1, Sheets(2).Columns.Count).End(xlToLeft).Column).Value = Sheets(1).Cells(2, X).Value\n    End If\nNext X\n\nEnd Sub\n</code></pre>\n\n<p>This way you will avoid using select. Which is very recommandable!</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 7671536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209247718893523/picture?type=large", "display_name": "Charlie Felix", "link": "https://stackoverflow.com/users/7671536/charlie-felix"}, "edited": false, "score": 0, "creation_date": 1529505920, "post_id": 50950197, "comment_id": 88899594, "body": "Hi, This nearly works but not quite. All my values are strings (not sure if that changes anything) but sheet2 row2 has 3 values in which are all the same value."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1529503633, "creation_date": 1529503633, "answer_id": 50950197, "question_id": 50948333, "link": "https://stackoverflow.com/questions/50948333/vba-how-can-i-select-the-cell-in-a-row-which-matches-a-variables-value/50950197#50950197", "title": "VBA: How can i select the cell in a row which matches a variable&#39;s value?", "body": "<p>This is Sheet1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WrMLt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WrMLt.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is Sheet2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/soAVb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/soAVb.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the code:</p>\n\n<pre><code>Option Explicit\n\nSub DynamicPaste()\n\n    Dim col As Long\n    Dim wks1 As Worksheet: Set wks1 = Worksheets(1)\n    Dim wks2 As Worksheet: Set wks2 = Worksheets(2)\n\n    For col = 1 To 3\n        Dim currentRow As Long\n        currentRow = WorksheetFunction.Match(wks2.Cells(1, col), wks1.Columns(1))\n        wks2.Cells(2, col) = wks1.Cells(currentRow, 2)\n    Next col\n\nEnd Sub\n</code></pre>\n\n<p>This is Sheet2 after the code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fwXNQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fwXNQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is a must-read - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n"}], "owner": {"reputation": 51, "user_id": 7671536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10209247718893523/picture?type=large", "display_name": "Charlie Felix", "link": "https://stackoverflow.com/users/7671536/charlie-felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1253, "favorite_count": 0, "accepted_answer_id": 50950146, "answer_count": 2, "score": 0, "last_activity_date": 1529667049, "creation_date": 1529497831, "last_edit_date": 1529498247, "question_id": 50948333, "link": "https://stackoverflow.com/questions/50948333/vba-how-can-i-select-the-cell-in-a-row-which-matches-a-variables-value", "title": "VBA: How can i select the cell in a row which matches a variable&#39;s value?", "body": "<p>I have 2 sheets. Sheet1 has 2 rows: column names and values. \nSheet 2 is a master sheet with all the possible column names in. I need to copy the values from sheet 1 into their appropriate column. </p>\n\n<p>I think i can do this via a match function, and so far i have this: </p>\n\n<pre><code>Sub dynamic_paste()\n\nDim Columnname As String\nDim inputvalue As String\nDim starter As Integer\nDim i As Integer\nstarter = 0\n\nFor i = 1 To 4\n'replace 4 with rangeused.rows.count?\n\nSheets(\"sheet1\").Select\nRange(\"a1\").Select\nActiveCell.Offset(0, starter).Select\nColumnname = ActiveCell\n'sets columnname variable\n\nActiveCell.Offset(1, 0).Select\ninputvalue = ActiveCell\n'sets inputname variable\n\nSheets(\"sheet2\").Select\n\n'**Cells(0, WorksheetFunction.Match(Columnname, Rows(1), 0)).Select**\n\nRange(\"a1\").Offset(1, starter).Value = inputvalue\n'inputs variable in the next cell along\n\nstarter = starter + 1\nNext\n\nEnd Sub\n</code></pre>\n\n<p>I need to find out how to use my columnname variable as the matching value, and then offset down to the first row that is empty - then change the value of that cell to the variable called inputvalue.</p>\n\n<p>For extra points: I need to make sure the code doesnt break if they dont find a matching value, and if possible put any values that dont match into the end of the row?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "edited": false, "score": 1, "creation_date": 1529497769, "post_id": 50948203, "comment_id": 88894050, "body": "You need to concatenate the string portion of formula and variables  so it that will form the correct excel formula, Also, for setting formula use <code>.Formula</code> instead <code>.Value</code> - Something like <code>&quot;=IF(AND(&quot; &amp; .cells(i-3 &amp; &quot;;&quot; &amp; LastColumn...</code> and so on"}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "edited": false, "score": 0, "creation_date": 1529498535, "post_id": 50948313, "comment_id": 88894570, "body": "Tom, thank you for the tips, I&#39;ll defintely consider each one of them. But unfortunately the <code>.Formula</code> didn&#39;t solve my problem. It keeps returning the same error, even if I just put a simple formula <code>&quot;=IF(2&gt;3;0;1)&quot;</code>"}, {"owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "edited": false, "score": 0, "creation_date": 1529498940, "post_id": 50948313, "comment_id": 88894803, "body": "Tom, problem solved. Thank you very much for you help, I couldn&#39;t figure out the &quot;.Formula&quot; statement without you, so I&#39;m upvoting you. Just for curiosity, I had to change any <code>;</code> to <code>,</code>, like <code>&quot;=IF(2&gt;3, 0, 1)&quot;</code> inside the in-built formula, then it worked."}, {"owner": {"reputation": 594, "user_id": 9868674, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mihai Adrian", "link": "https://stackoverflow.com/users/9868674/mihai-adrian"}, "reply_to_user": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "edited": false, "score": 1, "creation_date": 1529499818, "post_id": 50948313, "comment_id": 88895347, "body": "@GermanoLodi It is the system default setting for list separator."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 2, "last_activity_date": 1529498574, "last_edit_date": 1529498574, "creation_date": 1529497776, "answer_id": 50948313, "question_id": 50948203, "link": "https://stackoverflow.com/questions/50948203/pass-verbose-excels-in-built-function-to-a-cell-using-vba/50948313#50948313", "title": "Pass verbose Excel&#39;s in-built function to a Cell using VBA", "body": "<p>Use <code>.Formula</code> instead. </p>\n\n<p>Few other points:</p>\n\n<ul>\n<li><p>You don't need spaces in your <code>If</code> statement like some other\nlanguages unless you want to group statements together</p></li>\n<li><p>Your <code>For</code> loop doesn't explicitly define which sheet it should be<br>\ncounting the rows on. Use <code>.Rows.Count</code> instead to specify the sheet \n<code>Sheets(\"TC7_DATA\")</code> or declare another sheet</p></li>\n<li><p>Your <code>For</code> loop also will loop through every row in the sheet<br>\n(possibly all 1,048,576 of them). This is incredibly verbose. I'd<br>\nrecommend just looping through the ones you actually need instead.<br>\nYou already get the <code>LastColumn</code> why not get the <code>LastRow</code> as well<br>\nusing something like <code>LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row</code>\nand use this value in your for loop instead</p></li>\n</ul>\n\n<hr>\n\n<pre><code>With Sheets(\"TC7_DATA\")\n    LastColumn = .Cells(4, Columns.Count).End(xlToLeft).Column\n    For i = 1 To Rows.Count\n        If .Cells(i, 3).Value = \"Average Value\" Then\n            .Cells(i, LastColumn).Formula = \"=IF(AND(\" &amp; .Cells(i - 3, LastColumn) &amp; \"=0; \" &amp; .Cells(i - 2, LastColumn) &amp; \"=0; \" &amp; .Cells(i - 1, LastColumn) &amp; \"=0);\"\" - --\"\"; AVERAGE(\" &amp; .Cells(i - 3, LastColumn) &amp; \", \" &amp; .Cells(i - 3, LastColumn) &amp; \"))\"\n        End If\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 594, "user_id": 9868674, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mihai Adrian", "link": "https://stackoverflow.com/users/9868674/mihai-adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1529497914, "creation_date": 1529497914, "answer_id": 50948363, "question_id": 50948203, "link": "https://stackoverflow.com/questions/50948203/pass-verbose-excels-in-built-function-to-a-cell-using-vba/50948363#50948363", "title": "Pass verbose Excel&#39;s in-built function to a Cell using VBA", "body": "<p>You have to write to the Formula property, not the Value property.</p>\n\n<p>Example: </p>\n\n<pre><code>Sheets(\"CTC7_DATA\").[A11].Formula =\"=IF(2&gt;3; \"True\"; \"False\")\"\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 50948313, "answer_count": 2, "score": 0, "last_activity_date": 1529499395, "creation_date": 1529497423, "last_edit_date": 1529499395, "question_id": 50948203, "link": "https://stackoverflow.com/questions/50948203/pass-verbose-excels-in-built-function-to-a-cell-using-vba", "title": "Pass verbose Excel&#39;s in-built function to a Cell using VBA", "body": "<p>I'm having trouble in passing a built-in Excel function to a cell. It keeps returning <code>\"Run-time error '1004': Application-defined or object-defined error\".</code></p>\n\n<p>Basically what I'm trying to do is create a dynamic calculus of average/mean using VBA.</p>\n\n<pre><code>With Sheets(\"TC7_DATA\")\n    LastColumn = .Cells(4, Columns.Count).End(xlToLeft).Column\n    For i = 1 To Rows.Count\n        If (.Cells(i, 3).Value = \"Average Value\") Then\n            .Cells(i, LastColumn).Value = \"=IF(AND(.Cells(i-3; LastColumn)=0; .Cells(i-2; LastColumn)=0; .Cells(i-1; LastColumn)=0);\" - - - \"; AVERAGE(.Cells(i-3; LastColumn), .Cells(i-3; LastColumn)))\"\n        End If\n    Next i\nEnd With\n</code></pre>\n\n<p>If I insert the value without the <code>\"=\"</code> in the front of the function, it interprets as text and nothing goes wrong (except that the function don't actually works, of course).\nI tried to add <code>\"=\"</code> in the front of the cell without using VBA and the function works correctly. If I concatenate USING VBA</p>\n\n<pre><code>.Cells(i, LastColumn).Value = \"=\" &amp; .Cells(i, LastColumn).Value\n</code></pre>\n\n<p>The error returns.</p>\n\n<p>How can I pass a VERBOSE Excel in-built function:</p>\n\n<pre><code>(\"=IF(2&gt;3; \"True\"; \"False\")\") \n</code></pre>\n\n<p>to a Cell using VBA?</p>\n"}, {"tags": ["python", "python-3.x", "excel", "xlwings", "vba"], "comments": [{"owner": {"reputation": 1728, "user_id": 8547331, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Vrx69.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/8547331/jeronimo"}, "edited": false, "score": 3, "creation_date": 1529498954, "post_id": 50948003, "comment_id": 88894816, "body": "How about <code>wb.fullname</code>?"}, {"owner": {"reputation": 378, "user_id": 8300107, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8d884c95bf0c6f08cdd2e725dfbb9e9f?s=128&d=identicon&r=PG&f=1", "display_name": "hegdep", "link": "https://stackoverflow.com/users/8300107/hegdep"}, "reply_to_user": {"reputation": 1728, "user_id": 8547331, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Vrx69.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/8547331/jeronimo"}, "edited": false, "score": 0, "creation_date": 1529560950, "post_id": 50948003, "comment_id": 88919500, "body": "@Jeronimo That&#39;s the file itself. How do I get the address without the file name?"}, {"owner": {"reputation": 1728, "user_id": 8547331, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Vrx69.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/8547331/jeronimo"}, "edited": false, "score": 0, "creation_date": 1529564071, "post_id": 50948003, "comment_id": 88920993, "body": "Not sure what you mean by &quot;address&quot;. Can you give an example?"}, {"owner": {"reputation": 378, "user_id": 8300107, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8d884c95bf0c6f08cdd2e725dfbb9e9f?s=128&d=identicon&r=PG&f=1", "display_name": "hegdep", "link": "https://stackoverflow.com/users/8300107/hegdep"}, "reply_to_user": {"reputation": 1728, "user_id": 8547331, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Vrx69.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/8547331/jeronimo"}, "edited": false, "score": 0, "creation_date": 1529580120, "post_id": 50948003, "comment_id": 88930841, "body": "<code>wb.fullname</code> will give me <code>C:\\Users\\HegdeP\\Desktop\\Python Data Analysis\\OM646_Bio analysis\\0172_1190790270172\\xlwings trigger.xlsx</code>. I just want <code>C:\\Users\\HegdeP\\Desktop\\Python Data Analysis\\OM646_Bio analysis\\0172_1190790270172</code> as an input to <code>os.chdir</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1728, "user_id": 8547331, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Vrx69.jpg?s=128&g=1", "display_name": "Jeronimo", "link": "https://stackoverflow.com/users/8547331/jeronimo"}, "is_accepted": true, "score": 1, "last_activity_date": 1529581369, "last_edit_date": 1529581369, "creation_date": 1529580918, "answer_id": 50967616, "question_id": 50948003, "link": "https://stackoverflow.com/questions/50948003/get-location-of-the-workbook-calling-the-script/50967616#50967616", "title": "Get location of the workbook calling the script", "body": "<p>The absolute path of an <code>xlwings.Book</code> can be obtained via the <code>fullname</code> attribute, so in your case <code>wb.fullname</code>.</p>\n\n<p>In the comments you said you were only referring to the foldername. In this case, use </p>\n\n<pre><code>foldername = os.path.split(wb.fullname)[0]\n</code></pre>\n\n<p>Check out the docs for <a href=\"https://docs.python.org/3/library/os.path.html\" rel=\"nofollow noreferrer\"><code>os.path</code></a> for lots of other useful functions to work with filenames.</p>\n"}], "owner": {"reputation": 378, "user_id": 8300107, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8d884c95bf0c6f08cdd2e725dfbb9e9f?s=128&d=identicon&r=PG&f=1", "display_name": "hegdep", "link": "https://stackoverflow.com/users/8300107/hegdep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "accepted_answer_id": 50967616, "answer_count": 1, "score": 0, "last_activity_date": 1529581369, "creation_date": 1529496893, "last_edit_date": 1531161705, "question_id": 50948003, "link": "https://stackoverflow.com/questions/50948003/get-location-of-the-workbook-calling-the-script", "title": "Get location of the workbook calling the script", "body": "<p>I am trying to execute the following Python script from Excel using</p>\n\n<pre><code>Sub MacrosTrigger()\n    RunPython (\"import MacrosTrigger\")\nEnd Sub\n</code></pre>\n\n<p>MacrosTrigger.py contains the following sample code</p>\n\n<pre><code>import os\nimport pandas as pd\nimport glob\nimport matplotlib.pyplot as plt\nimport matplotlib\nimport xlwings as xw\nmatplotlib.rcParams['figure.figsize'] = (18.0, 5.0)\nwb = xw.Book.caller()\ncwd = os.getcwd()\nwb.sheets[0].range('A1').value = cwd\nos.chdir('C:\\\\Users\\\\HegdeP\\\\Desktop\\\\Python Data Analysis\\\\PST')\n</code></pre>\n\n<p>os.getcwd() returns the location of the Python interpreter. For automation purposes, I would like to be able to return the location of the workbook that is calling the script. i.e. location of the wb.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1529494186, "post_id": 50947122, "comment_id": 88891586, "body": "Is this working - <code>For Each targetSheewb.Worksheetst</code> - what is it supposed to be &amp; do?"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1529494450, "post_id": 50947122, "comment_id": 88891753, "body": "@Vityata Fixed it. It is supposed to take the data from targetSheet and place the data from the column into xData. But if xData(1) is less than xData(0) then an error occurs because I need it to be the same size, otherwise I get &quot;Substript out of range&quot;"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1529494535, "post_id": 50947122, "comment_id": 88891805, "body": "do you collect the values from another sheet/workbbok, or how does it get there? If you import it, can you just add the <code>0</code> after import and that would solve it?"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1529495008, "post_id": 50947122, "comment_id": 88892076, "body": "@krib Currently I&#39;m opening another workbook and get the data from that sheet. Then I&#39;m trying to add the value from the sheet to a variable. But if I try to do this I get the error because xData(1) isn&#39;t the same size as xData(0). A temporary fix would be to collect the error and insert the 0 afterwards but I want to avoid to even get to the error."}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "edited": false, "score": 0, "creation_date": 1529495219, "post_id": 50947345, "comment_id": 88892225, "body": "This is a good solution but I&#39;m trying to avoid unnecessary loops. Isn&#39;t there any way to add it directly to Range(Cells(1, 1), Cells(1, 1).End(xlDown)).Value2?"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "edited": false, "score": 0, "creation_date": 1529495608, "post_id": 50947345, "comment_id": 88892507, "body": "@Fredrik Well, I think every other solution will somehow loop through the range :) so it&#39;s close to best you can get."}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "edited": false, "score": 0, "creation_date": 1529496585, "post_id": 50947345, "comment_id": 88893166, "body": "I will use this for now. Just going to point out that at <code>For i = 1 To targetSheet.Cells(Rows.count, 1).End(xlUp).row</code> there should be a 1 instead of 2. Otherwise it works great! :)"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1529494707, "creation_date": 1529494707, "answer_id": 50947345, "question_id": 50947122, "link": "https://stackoverflow.com/questions/50947122/vba-if-row-is-empty-insert-value/50947345#50947345", "title": "VBA If row is empty insert value", "body": "<p>Just before collecting data fill empty cells in a loop :)</p>\n\n<pre><code>Dim xData() As Variant\nFor Each targetSheet In wb.Worksheets       \n    With targetSheet\n         For i = 1 To targetSheet.Cells(Rows.Count, 2).End(xlUp).Row\n             If targetSheet.Cells(i, 2) = \"\" Then targetSheet.Cells(i, 2) = 0\n         Next\n        'Populate the array\n         xData(0) = Application.Transpose(Range(Cells(1, 1), Cells(1, 1).End(xlDown)).Value2)\n         xData(1) = Application.Transpose(Range(Cells(1, 2), Cells(1, 2).End(xlDown)).Value2)\n    End With\nNext targetSheet\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": -1, "last_activity_date": 1529494786, "creation_date": 1529494786, "answer_id": 50947371, "question_id": 50947122, "link": "https://stackoverflow.com/questions/50947122/vba-if-row-is-empty-insert-value/50947371#50947371", "title": "VBA If row is empty insert value", "body": "<p>This simple VBA code will do the trick</p>\n\n<blockquote>\n  <p>Under presumption your column value is located in Excel Column \"B\" and the data is in \"Sheet1\"</p>\n</blockquote>\n\n<pre><code>Private Sub fill_blanks_with_zeroes()\n  For Each cell in Sheets(\"Sheet1\").Columns(\"B\").Cells\n      If IsEmpty(cell) Then\n            cell.Value = 0\n      End If\n  Next cell\nEnd Sub\n</code></pre>\n\n<p>You can call it in your procedure like so</p>\n\n<pre><code>Dim xData() As Variant\nFor Each targetSheet In wb.Worksheets       \n    With targetSheet\n        'Populate the array\n         xData(0) = Application.Transpose(Range(Cells(1, 1), Cells(1, 1).End(xlDown)).Value2)\n         xData(1) = Application.Transpose(Range(Cells(1, 2), Cells(1, 2).End(xlDown)).Value2)\n    End With\nNext targetSheet\nCall fill_blanks_with_zeroes\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "is_accepted": false, "score": 0, "last_activity_date": 1529494848, "creation_date": 1529494848, "answer_id": 50947395, "question_id": 50947122, "link": "https://stackoverflow.com/questions/50947122/vba-if-row-is-empty-insert-value/50947395#50947395", "title": "VBA If row is empty insert value", "body": "<p>Filling 0's instead empty cells will fix the issue.\nalso i get a subscript out of range error on xData(0) line - so declared array with length 2. </p>\n\n<pre><code>Dim lngRow, i As Long\nDim xData(2) As Variant\nFor Each targetSheet In wb.Worksheets       \n    With targetSheet\n         'Populate zeros\n         lngRow = .Cells(Rows.Count, 2).End(xlUp).Row\n         For i = 2 To lngRow //considering row 1 will have headers\n            If .Cells(i, 2) = \"\" Then .Cells(i, 2) = 0\n         Next\n         'Populate the array\n         xData(0) = Application.Transpose(.Range(.Cells(1, 1), .Cells(1, 1).End(xlDown)).Value2)\n         xData(1) = Application.Transpose(.Range(.Cells(1, 2), .Cells(1, 2).End(xlDown)).Value2)\n         Debug.Print UBound(xData(0))\n         Debug.Print UBound(xData(1))\n    End With\nNext targetSheet\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 0, "accepted_answer_id": 50947345, "answer_count": 3, "score": 0, "last_activity_date": 1529494848, "creation_date": 1529493959, "last_edit_date": 1529494310, "question_id": 50947122, "link": "https://stackoverflow.com/questions/50947122/vba-if-row-is-empty-insert-value", "title": "VBA If row is empty insert value", "body": "<p>I'm having some trouble with some data there it could occur that a cell is empty. For example we have two columns, ID and value. The ID shall always be correct but value could miss an \"value\". If this occurs then we should add a 0 in its place.</p>\n\n<p>The problem is that I do not know how to add this to <code>Application.Transpose(Range(Cells(1, 1), Cells(1, 1).End(xlDown)).Value2)</code> as this is the only thing that collect all the data from the the sheets.\nI need to do this as the sizes of the array is not the same and they must be to continue.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CAEnx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CAEnx.png\" alt=\"image\"></a></p>\n\n<pre><code>Dim xData() As Variant\nFor Each targetSheet In wb.Worksheets       \n    With targetSheet\n        'Populate the array\n         xData(0) = Application.Transpose(Range(Cells(1, 1), Cells(1, 1).End(xlDown)).Value2)\n         xData(1) = Application.Transpose(Range(Cells(1, 2), Cells(1, 2).End(xlDown)).Value2)\n    End With\nNext targetSheet\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "is_accepted": false, "score": -1, "last_activity_date": 1529494144, "last_edit_date": 1529494144, "creation_date": 1529494062, "answer_id": 50947147, "question_id": 50946824, "link": "https://stackoverflow.com/questions/50946824/ms-access-vba-loop-recordsets/50947147#50947147", "title": "MS Access VBA - Loop Recordsets", "body": "<p>If you're inserting records from tblmachines table to tblloop table based on the check box criteria use the below code:</p>\n\n<pre><code>Sub Btn_Click()\n    Dim StrQry As String\n    StrQry = \"insert into [tblloop] ([LoopDate], [loopMachines]) select # \" &amp; VBA.Now &amp; \"# as [LoopDate], [MachineName] from [tblmachines] where Checkbox = 'True'\"\n    Currentdb.Execute StrQry\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 9098538, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d5863ffca9fd9167d26eb2233bc2cd6f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadyjunior", "link": "https://stackoverflow.com/users/9098538/shadyjunior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529494144, "creation_date": 1529493031, "question_id": 50946824, "link": "https://stackoverflow.com/questions/50946824/ms-access-vba-loop-recordsets", "title": "MS Access VBA - Loop Recordsets", "body": "<p>I am wondering if anyone could direct me to a good tutorial on how to develop loops. Basically I have a \"tblmachines\" with columns ID, MachineName and Checkbox. What I want to create is an on click event, VBA will take todays date and input that into \"tblloop\" column \"LoopDate\", and then add all machines in \"tblmachines\" which have their checkbox selected into \"tblloop\" column \"loopMachines\".</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 77029, "user_id": 1729265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMMeP.jpg?s=128&g=1", "display_name": "mkl", "link": "https://stackoverflow.com/users/1729265/mkl"}, "edited": false, "score": 0, "creation_date": 1529497490, "post_id": 50946429, "comment_id": 88893855, "body": "<i>&quot;I cannot seem to extract the text string of the pdf&quot;</i> - what exactly do you mean? Does your code find nothing or can it not properly process what it finds? Do you get some error? If yes, which one, on which line?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5719557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f4816975fbda8227fedc3f9139b0a0?s=128&d=identicon&r=PG&f=1", "display_name": "OptimumCOW", "link": "https://stackoverflow.com/users/5719557/optimumcow"}, "edited": false, "score": 0, "creation_date": 1529594680, "post_id": 50948302, "comment_id": 88940783, "body": "thank you very much for this. As you said it works for what I need it for now which is fantastic! In future I want to make changes to the PDF so I would need to get the entire string so that I can manipulate it. Following on from your solution above I thought to replicate your Line Input approach but not filtering based on the character &quot;&lt;&lt;&quot;. What I found was that I could not copy past the character at line 19 col 105 suggesting that the character at 106 is something I cannot input. Do you know if you can extend the characters available in VBA to be able to capture this?"}, {"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "reply_to_user": {"reputation": 19, "user_id": 5719557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f4816975fbda8227fedc3f9139b0a0?s=128&d=identicon&r=PG&f=1", "display_name": "OptimumCOW", "link": "https://stackoverflow.com/users/5719557/optimumcow"}, "edited": false, "score": 0, "creation_date": 1529595809, "post_id": 50948302, "comment_id": 88941558, "body": "The character at 106 is probably some invisible Ascii character. Try outputting it in the Immediate window with <code>Asc([string])</code>. If that&#39;s correct, you can simply add this line of code after <code>Line Input #1, strTextLine</code>: <code>Replace(strTextLine, Chr([Illegal Ascii Character code]), VbNullstring)</code>. If this works for you please consider accepting the answer. Thx."}], "tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": true, "score": 0, "last_activity_date": 1529497753, "creation_date": 1529497753, "answer_id": 50948302, "question_id": 50946429, "link": "https://stackoverflow.com/questions/50946429/vba-reading-pdf-as-string-cannot-sometimes-but-can-other-times-run-time-e/50948302#50948302", "title": "VBA - Reading PDF as String - Cannot sometimes but can other times - &#39;Run time error 62&#39;", "body": "<p>According to the <a href=\"https://support.microsoft.com/en-us/help/858727/run-time-error-62-input-past-end-of-file-error-message-when-using-auto\" rel=\"nofollow noreferrer\">MSDN documentation</a>, this error is caused by the file containing </p>\n\n<blockquote>\n  <p>...blank spaces or extra returns at the end of the file or the syntax\n  is not correct.</p>\n</blockquote>\n\n<p>Since your code works sometimes on documents with very similar names and content to documents where it doesn't work, we can rule out syntax errors in this case.</p>\n\n<p>You can clean up the file contents before processing it any further by replacing the code at the top of your macro with the one below. With this I can read and extract information from your <code>Document16.pdf</code>:</p>\n\n<pre><code>Sub CoordExtractor_TestBuild01()\n\n\n'Purpose to link together the extracting real PDF information and outputting the results onto a spreadsheet\n\n\n'########################################################################################\n\n'Opening the PDF and getting the coordinates\nDim n As Long\nDim TextFile As Integer\nDim FilePath As String\nDim FileContent As String\n\n'File Path of Text File\n  FilePath = \"C:\\TEST\\Document16.pdf\" ' change path\n\n'Determine the next file number available for use by the FileOpen function\n  TextFile = FreeFile      \n\n'Open the text file in a Read State\n  Open FilePath For Input As TextFile\n\nDim strTextLine As String\nDim vItem As Variant\n\nLine Input #1, strTextLine\nvItem = Split(strTextLine, Chr(10))\n\n' clean file of garbage information line by line\nFor n = LBound(vItem) To UBound(vItem)\n\n    ' insert appropriate conditions here - in this case if the string \"&lt;&lt;\" is present\n    If InStr(1, vItem(n), \"&lt;&lt;\") &gt; 0 Then\n        If FileContent = vbNullString Then\n            FileContent = vItem(n)\n        Else\n            FileContent = FileContent &amp; Chr(10) &amp; vItem(n)\n        End If\n    End If\nNext n\n\n'Clost Text File\n  Close TextFile\n\n\n' insert the rest of the code here\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5719557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f4816975fbda8227fedc3f9139b0a0?s=128&d=identicon&r=PG&f=1", "display_name": "OptimumCOW", "link": "https://stackoverflow.com/users/5719557/optimumcow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2118, "favorite_count": 0, "closed_date": 1529558074, "accepted_answer_id": 50948302, "answer_count": 1, "score": 0, "last_activity_date": 1529591904, "creation_date": 1529491726, "last_edit_date": 1531164843, "question_id": 50946429, "link": "https://stackoverflow.com/questions/50946429/vba-reading-pdf-as-string-cannot-sometimes-but-can-other-times-run-time-e", "closed_reason": "Not suitable for this site", "title": "VBA - Reading PDF as String - Cannot sometimes but can other times - &#39;Run time error 62&#39;", "body": "<p>You can open PDFs in text editors to see the structure of how the PDF is written. </p>\n\n<p>Using VBA I have opened a PDF as a text file and go to extract the text and save it as a string variable in VBA. I want to look through this text to find a specific element; a polyline (called sTreamTrain) and get the vertices of the polyline by using the InStr function.</p>\n\n<p>When i add more vertices to the polyline I cannot seem to extract the text string of the pdf. I get the error 'Run time error 62' which I do not understand what it means or what about the PDF has changed to now have this error.</p>\n\n<p>Attached (via the link) is a PDF that I can read (Document 15) and a PDF I cannot read (Document 16). I have checked in excel so see that the vertices are present in both files. Also there is a copy of my VBA script as a notepad document and also my excel file (but it is difficult to find in my excel file - the script is \"Module 6\" function called \"CoordExtractor_TestBuild01()\")</p>\n\n<p><strong>Link:</strong> \n<a href=\"https://drive.google.com/open?id=1zOhwnFWZZfy9bTAxKiQFSl7qiQLlYIJV\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=1zOhwnFWZZfy9bTAxKiQFSl7qiQLlYIJV</a> </p>\n\n<p>Code snippet of the text extraction process below to reproduce the problem (given an applicable pdf is used):</p>\n\n<p>Sub CoordExtractor_TestBuild01()</p>\n\n<p>'Opening the PDF and getting the coordinates</p>\n\n<p>Dim TextFile As Integer\nDim FilePath As String\nDim FileContent As String</p>\n\n<p>'File Path of Text File\n  FilePath = \"C:\\Users\\KAllan\\Documents\\WorkingInformation\\sTreamTrain\\Document16 - Original.pdf\"</p>\n\n<p>'Determine the next file number available for use by the FileOpen function\n  TextFile = FreeFile</p>\n\n<p>'Open the text file in a Read State\n  Open FilePath For Input As TextFile</p>\n\n<p>'Store file content inside a variable\nDim Temp As Long\nTemp = LOF(TextFile)</p>\n\n<p>FileContent = Input(LOF(TextFile), TextFile)</p>\n\n<p>'Clost Text File\n  Close TextFile</p>\n\n<p>End Sub</p>\n\n<p>I would like someone to let me know what runtime error 62 is in this context and propose any workflows to get around it in future. Also, I would like to know whether there certain characters you cannot store as strings? - Perhaps these are included when I increase the number of vertices past a certain number.</p>\n\n<p>Also I would prefer to keep the scrips quite simple and not use external libraries because I want to share the script when it is done so others can use it thus its simpler if it works without extra dependencies etc, however, any and all advice welcome since this is only the first half of this project.</p>\n\n<p>Thank you very much. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1529489637, "last_edit_date": 1529489637, "creation_date": 1529488844, "answer_id": 50945472, "question_id": 50945390, "link": "https://stackoverflow.com/questions/50945390/vba-for-loop-hiding-rows-not-working/50945472#50945472", "title": "VBA: For loop hiding rows not working", "body": "<p>You can change your loop to this:</p>\n\n<pre><code>For i = 1 To lastRow    \n\n    If Left(Luottosht.Cells(i, \"A\"), 19) = \"Lyhennyssitoumuksen\" Then\n        hidRow = False\n    Else\n        hidRow = True\n    End If    \n    Luottosht.Rows(i).Hidden = hidRow\n\nNext i\n</code></pre>\n\n<p>or even the whole in one line:</p>\n\n<pre><code>For i = 1 To lastRow \nLuottosht.Rows(i).Hidden = CBool(Left(Luottosht.Cells(i, \"A\"), 19) &lt;&gt; \"Lyhennyssitoumuksen\")\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 9966787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42431947b3796adb38514522b8a2c38?s=128&d=identicon&r=PG&f=1", "display_name": "Th3FluffyAsian", "link": "https://stackoverflow.com/users/9966787/th3fluffyasian"}, "is_accepted": false, "score": 0, "last_activity_date": 1529493543, "creation_date": 1529493543, "answer_id": 50946994, "question_id": 50945390, "link": "https://stackoverflow.com/questions/50945390/vba-for-loop-hiding-rows-not-working/50946994#50946994", "title": "VBA: For loop hiding rows not working", "body": "<p>Your current code hides everything except the \"Lyhennyssitoumuksen\" row. To keep the block of 12 +1 blank visible you can try this: </p>\n\n<pre><code>Public Sub Luotonpurkukorko2()\n\nApplication.ScreenUpdating = False\n\nDim Luottowb As Workbook\nDim Luottosht As Worksheet\nDim i As Long, lastRow As Long\nDim hidRow As Boolean\n\nSet Luottowb = ActiveWorkbook\nSet Luottosht = Sheets(\"Sheet0\")\n\n'Finds the last row\nlastRow = Luottosht.Cells(Luottosht.Rows.Count, \"A\").End(xlUp).Row\n\n'Set all rows to visible\nLuottosht.Rows.Hidden = False\n\n'Default hidden to TRUE\nhidRow = True\n\nFor i = 1 To lastRow\n\nrestart:\n\n'if statement to check for 12 rows in block\nIf Left(Luottosht.Cells(i, \"A\"), 8) = \"Sopimust\" And Left(Luottosht.Cells(i, \"A\").Offset(11, 0), 19) = \"Lyhennyssitoumuksen\" Then\n\n'keeps 12 rows + 1 blank row\n        i = i + 13\n\n'restart the check incase there are multiple blocks of 12 rows adjacent to eachother\n        GoTo restart\n    End If\n\n    'Hide/Unhide rows\n    Luottosht.Rows(i).Hidden = hidRow\nNext i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8573149"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1536748460, "creation_date": 1529488595, "last_edit_date": 1536748460, "question_id": 50945390, "link": "https://stackoverflow.com/questions/50945390/vba-for-loop-hiding-rows-not-working", "title": "VBA: For loop hiding rows not working", "body": "<p>I'm trying to get my VBA code to work. I need to find blocks in my text that are 12 rows long (see picture). </p>\n\n<p>I'd like to hide all the rows that are not these blocks and seperate these blocks with a blank space. One block is 12 rows (for example A13181:A13192, A13168:A13179 etc). Between these blocks are few rows of text, but not always. The data is poorly sorted so all the row data is in the first cell of the row, so we should only look for data in A column.</p>\n\n<p>Block:</p>\n\n<p>First row: Sopimustunnus ja hoitokonttori...</p>\n\n<p>Last row:  Lyhennyssitoumuksen p\u00e4\u00e4ttymisp\u00e4iv\u00e4... </p>\n\n<p><a href=\"https://pasteboard.co/HqA9kxI.jpg\" rel=\"nofollow noreferrer\">https://pasteboard.co/HqA9kxI.jpg</a></p>\n\n<p>My problem is the second if statement. I'm having problems making the block visible</p>\n\n<pre><code>Public Sub Luotonpurkukorko2()\n\nApplication.ScreenUpdating = False\n\nDim Luottowb As Workbook\nDim Luottosht As Worksheet\nDim i As Long, lastRow As Long\nDim hidRow As Boolean\n\nSet Luottowb = ActiveWorkbook\nSet Luottosht = Sheets(\"Sheet0\")\n\n'Finds the last row\nlastRow = Luottosht.Cells(Luottosht.Rows.Count, \"A\").End(xlUp).Row\n\n'Set all rows to visible\nLuottosht.Rows.Hidden = False\n\n'Default hidden to TRUE\nhidRow = True\n\nFor i = 1 To lastRow\n\n\n     If Left(Luottosht.Cells(i, \"A\").Offset(1, 0), 8) = \"Sopimust\" Then\n        hidRow = True\n    End If\n\n    If Left(Luottosht.Cells(i, \"A\"), 19) = \"Lyhennyssitoumuksen\" Then\n    hidRow = False\n    End If\n\n    'Hide/Unhide rows\n    Luottosht.Rows(i).Hidden = hidRow\n\nNext i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 3, "creation_date": 1529488024, "post_id": 50945031, "comment_id": 88887688, "body": "You load the source range in an array, then you loop the array, writing each element to the destination, resetting the row and incrementing the column if the array element is blank."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1530810010, "post_id": 50945031, "comment_id": 89374827, "body": "As this is your first post: Please help to identify good solutions by marking them as accepted - see [Someone answers](stackoverflow.com/help/someone-answers) - Further links: <a href=\"https://stackoverflow.com/tour\">Help Tour</a> and <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9966622, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4JpFjf99NR0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mprbpbBixZoocoK1cWXJ-3u748Q/mo/photo.jpg?sz=128", "display_name": "Ke Ming Yu", "link": "https://stackoverflow.com/users/9966622/ke-ming-yu"}, "edited": false, "score": 0, "creation_date": 1529548148, "post_id": 50946833, "comment_id": 88916175, "body": "is there a way to select a range of column values to transpose?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1529493056, "creation_date": 1529493056, "answer_id": 50946833, "question_id": 50945031, "link": "https://stackoverflow.com/questions/50945031/how-to-use-vba-to-transpose-a-column-of-grouped-data-separated-by-blanks-to-ro/50946833#50946833", "title": "How to use VBA to &quot;transpose&quot; a column of grouped data separated by blanks to rows", "body": "<p>Here is Honorez's method:</p>\n\n<pre><code>Sub Honorez()\n    Dim N As Long, i As Long, j As Long, k As Long\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n    j = 2\n    k = 0\n    For i = 1 To N\n        v = Cells(i, 1)\n        If v = \"\" Then\n            j = j + 1\n            k = 0\n        Else\n            k = k + 1\n            Cells(k, j) = v\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/xqZmd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xqZmd.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1529509029, "creation_date": 1529509029, "answer_id": 50952058, "question_id": 50945031, "link": "https://stackoverflow.com/questions/50945031/how-to-use-vba-to-transpose-a-column-of-grouped-data-separated-by-blanks-to-ro/50952058#50952058", "title": "How to use VBA to &quot;transpose&quot; a column of grouped data separated by blanks to rows", "body": "<p><strong>Array method</strong></p>\n\n<p>In addition to @Gary's-Student 's fine solution, I demonstrate another approach using a datafield <strong>Array</strong> and write back values directly to the new columns:</p>\n\n<pre><code>Sub Honorez2()\nDim rng As Range\nDim ws  As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Honorez\")\nDim i As Long, ii As Long, j As Long, m As Long, n As Long\nDim a()\n' get data\n  n = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n  Set rng = ws.Range(\"A1:A\" &amp; n)\n  rng.Offset(0, 1).Resize(n, n - WorksheetFunction.CountA(Range(\"A:A\")) + 1) = \"\" ' clear prior values\n' write data field to array\n  a = rng\n  j = 2                                           ' start column for results\n  For i = 1 To n\n    If a(i, 1) = \"\" Or i = n Then\n       ' write data to new column\n         ws.Range(ws.Cells(1, j), ws.Cells(i - ii, j)).Value = _\n            ws.Range(ws.Cells(ii + 1, 1), ws.Cells(i, 1)).Value\n       ' remember row and increment column counter\n         ii = i: j = j + 1\n    End If\n  Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9966622, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4JpFjf99NR0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mprbpbBixZoocoK1cWXJ-3u748Q/mo/photo.jpg?sz=128", "display_name": "Ke Ming Yu", "link": "https://stackoverflow.com/users/9966622/ke-ming-yu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529509029, "creation_date": 1529487643, "last_edit_date": 1531164843, "question_id": 50945031, "link": "https://stackoverflow.com/questions/50945031/how-to-use-vba-to-transpose-a-column-of-grouped-data-separated-by-blanks-to-ro", "title": "How to use VBA to &quot;transpose&quot; a column of grouped data separated by blanks to rows", "body": "<p>Since i find my problem hard to explain, I'll just provide an example.</p>\n\n<p>This is the format of the data i have in excel in a column, separated by blanks.</p>\n\n<pre><code>A\n\nB\nC\nD\nE\n\nF\nG\nH\n</code></pre>\n\n<p>I wish to transpose it so that the final result is:</p>\n\n<pre><code>A B F\n  C G\n  D H\n  E\n</code></pre>\n\n<p>How do I do that?</p>\n"}, {"tags": ["javascript", "vba", "web-scraping", "html-parsing"], "comments": [{"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529485553, "post_id": 50944319, "comment_id": 88886012, "body": "The issue I face is with the code at the bottom -   For Each entitylink In IE.document.getElementsByClassName(&quot;tr&quot;)     If entitylink.getElementsByTagName = &quot;a&quot; And entitylink.textcontent = Sheets(&quot;Results&quot;).Range(&quot;N1&quot;).Value And entitylink.href = &quot;javascript:;&quot; Then     entitylink.Click     Exit For     End If     Next entitylink"}, {"owner": {"reputation": 800, "user_id": 6600287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Paxgk.jpg?s=128&g=1", "display_name": "Volodymyr I.", "link": "https://stackoverflow.com/users/6600287/volodymyr-i"}, "edited": false, "score": 0, "creation_date": 1529486067, "post_id": 50944319, "comment_id": 88886324, "body": "Try to execute script directly instead of &#39;cliking&#39;. <a href=\"https://stackoverflow.com/questions/3247391/click-button-or-execute-javascript-function-with-vba\" title=\"click button or execute javascript function with vba\">stackoverflow.com/questions/3247391/&hellip;</a>"}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "reply_to_user": {"reputation": 800, "user_id": 6600287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Paxgk.jpg?s=128&g=1", "display_name": "Volodymyr I.", "link": "https://stackoverflow.com/users/6600287/volodymyr-i"}, "edited": false, "score": 0, "creation_date": 1529487171, "post_id": 50944319, "comment_id": 88887087, "body": "Thanks for the response Volodymyr. I went through the link but to be honest, I have no clue what the post is referring to. Can you help me apply the same with my code here?"}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "reply_to_user": {"reputation": 800, "user_id": 6600287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Paxgk.jpg?s=128&g=1", "display_name": "Volodymyr I.", "link": "https://stackoverflow.com/users/6600287/volodymyr-i"}, "edited": false, "score": 0, "creation_date": 1529487357, "post_id": 50944319, "comment_id": 88887213, "body": "What exactly is the element I should be looking at here?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1529505051, "post_id": 50944319, "comment_id": 88899011, "body": "How come this line be valid <code>IE.document.getElementsByTagName(&quot;href&quot;)</code>? Don&#39;t you think <code>href</code> is an <code>attribute</code> instead of <code>tag</code> @Renin Mathew?."}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1529505523, "post_id": 50944319, "comment_id": 88899300, "body": "@SIM Thank you for your response. Although, I&#39;m quite unsure how it works, but it does provide the expected result."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1529505748, "post_id": 50944319, "comment_id": 88899471, "body": "Making it <code>(&quot;a&quot;)</code> instead of <code>(&quot;href&quot;)</code> is the right approach. Whether it is working or not is different issue."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529505687, "post_id": 50950036, "comment_id": 88899420, "body": "Thank you for your response. Then again, I am quite lost - what is the intended purpose of the above?"}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529521483, "post_id": 50950036, "comment_id": 88908322, "body": "Mostly yes but need not be the case. I need to click the closest match to the name provided in the search criteria."}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529522011, "post_id": 50950036, "comment_id": 88908578, "body": "Sheets(&quot;Results&quot;).Range(&quot;N1&quot;).Value is the name of the entity or the search criteria. I do not have a plan to get the closest match at the moment for now - like you may probably suggest, the topmost row is most likely the closest match and I think it should be fair to just go with the top row."}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529522053, "post_id": 50950036, "comment_id": 88908600, "body": "IE version 11.22"}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529523007, "post_id": 50950036, "comment_id": 88909013, "body": "Document mode = 11 (Default)"}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529524241, "post_id": 50950036, "comment_id": 88909521, "body": "You&#39;re a champion, and I mean it. Thanks QHarr. I am much obliged. Please be around to answer a question or two I may face during the rest of this project. Thanks a lot again!"}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529525764, "post_id": 50950036, "comment_id": 88910177, "body": "My most humble apologies, just to dig back into this again - is there anyway I can get the entire list of top 20 entities (as in the screenshot) onto an excel sheet? I could then perform some data validation to get the &#39;closest match&#39; to the user entered search criteria"}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529661886, "post_id": 50950036, "comment_id": 88965836, "body": "QHarr you&#39;re going to make heights. It was really kind of you to rewrite the entire code! On another note, I&#39;ve been attempting to get the entity address text on the page above to an excel cell and all I get in the cell is &quot;[OBJECT HTMLLIELEMENT]&quot;. I tried the same with debug.print and msgbox() but it works there and just not with the cell. Do you know why this happens? here is the code, Sheets(&quot;Results&quot;).Range(&quot;C27&quot;).Value = UCase(ie.document.getElementsByClassName(&quot;clearLeft&quot;)(1))"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529662198, "post_id": 50950036, "comment_id": 88966010, "body": "ie.document.getElementsByClassName(&quot;clearLeft&quot;)(1).innerText"}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529662611, "post_id": 50950036, "comment_id": 88966234, "body": "This is embarrassing. Sometimes I can get stupid. :D Thanks again mate!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1529662634, "post_id": 50950036, "comment_id": 88966251, "body": ":-) we all do it!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1529531156, "last_edit_date": 1529531156, "creation_date": 1529503121, "answer_id": 50950036, "question_id": 50944319, "link": "https://stackoverflow.com/questions/50944319/unable-to-click-a-javascript-based-link-which-is-also-the-part-of-a-table-on-a-w/50950036#50950036", "title": "Unable to click a JavaScript based link which is also the part of a table on a webpage using web elements through VBA", "body": "<p>You can use <code>.querySelector</code> to get the element you want which is the first with </p>\n\n<pre><code>.document.querySelector(\"a[onclick='viewCompanyDetails('B214273', '1529481460070');']\")\n</code></pre>\n\n<p>Then you may need to do either:</p>\n\n<pre><code>.document.querySelector(\"a[onclick='viewCompanyDetails('B214273', '1529481460070');']\").Click\n</code></pre>\n\n<p>or </p>\n\n<pre><code>.document.querySelector(\"a[onclick='viewCompanyDetails('B214273', '1529481460070');']\").fireEvent 'onclick'\n</code></pre>\n\n<hr>\n\n<p><strong>CSS selector:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/3GAuK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3GAuK.png\" alt=\"CSS query\"></a></p>\n\n<p>The selector returns 2 items from your HTML but <code>.querySelector</code> will only return the first of these when applying the selector to the HTML. The first is the required <code>\"SARL\"</code>.</p>\n\n<hr>\n\n<p>More info on <a href=\"https://msdn.microsoft.com/en-us/ie/ms536423(v=vs.94)\" rel=\"nofollow noreferrer\">.fireEvent</a> method:</p>\n\n<blockquote>\n  <p>fireEvent method: Fires a specified event on the object.</p>\n  \n  <p>Syntax: object.fireEvent(bstrEventName, pvarEventObject,<br>\n  pfCancelled)</p>\n</blockquote>\n\n<p>It has a boolean return value which if TRUE tells you the event was successfully fired.</p>\n\n<hr>\n\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector\" rel=\"nofollow noreferrer\"><code>.querySelector</code></a> method:</p>\n\n<blockquote>\n  <p>The <code>Document</code> method <code>querySelector()</code> returns the first <code>Element</code>\n  within the document that matches the specified selector, or group of\n  selectors. If no matches are found, null is returned.</p>\n  \n  <p>Syntax: element = document.querySelector(selectors); &lt;== note the \";\"\n  is not used in VBA</p>\n</blockquote>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>If  <code>.querySelector</code> method is not supported you could try looping the <code>a</code> tags and clicking when a particular string is found e.g.</p>\n\n<pre><code>Dim c As Object, n As Object\nSet c = ie.document.getElementsByTagName(\"a\")\nFor Each n In c\n    If InStr(1, n.innerText, \"Alinda Infrastructure Fund III (Euro) GP SARL\") &gt; 0 Then\n        n.Click\n        Exit For\n    End If\nNext n\n</code></pre>\n\n<p>Without more HTML to target the specific <code>a</code> tags of interest you can do a general write out of all <code>a</code> tags with:</p>\n\n<pre><code>Dim c As Object, n As Object, counter As Long\nSet c = ie.document.getElementsByTagName(\"a\")\nWith ActiveSheet\n    For Each n In c\n        counter = counter + 1\n        .Cells(counter, 1) = n.innerText\n    Next n\nEnd With\n</code></pre>\n\n<p>More HTML is needed to target this better; perhaps there is a className or Id to identify the element housing these <code>a</code> tags? </p>\n\n<p>For your link to write table to sheet:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim ie As Object\n    Application.ScreenUpdating = False\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = True\n        .navigate \"https://www.lbr.lu/mjrcs\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend '&lt;== Loop until loaded\n\n        Dim links As Object, link As Object\n        Set links = .document.getElementsByTagName(\"a\")\n\n        For Each link In links\n            If link.innerText = \"View the person's file\" Then\n                link.Click\n                Exit For\n            End If\n        Next link\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        .document.getElementById(\"companyName\").innerText = \"Alinda\"\n        .document.getElementsByClassName(\"button\")(0).Click\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim hTable As HTMLTable\n        Set hTable = .document.getElementsByClassName(\"commonTable\")(0)\n\n        Dim n As Object, tRow As Object, tCell As Object, tr As Object, td As Object, r As Long, c As Long, hBody As Object\n\n        r = 1\n        With ActiveSheet\n            Set hBody = hTable.getElementsByTagName(\"tbody\")\n            For Each n In hBody                 'HTMLTableSection\n                Set tRow = n.getElementsByTagName(\"tr\") 'HTMLTableRow\n                For Each tr In tRow\n                    Set tCell = tr.getElementsByTagName(\"td\")\n                    c = 1\n                    For Each td In tCell         'DispHTMLElementCollection\n                        .Cells(r, c).Value = td.innerText 'HTMLTableCell\n                        c = c + 1\n                    Next td\n                    r = r + 1\n                Next tr\n            Next n\n        End With\n        .Quit '&lt;== Remember to quit application\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 50950036, "answer_count": 1, "score": 0, "last_activity_date": 1557429347, "creation_date": 1529485452, "last_edit_date": 1557429347, "question_id": 50944319, "link": "https://stackoverflow.com/questions/50944319/unable-to-click-a-javascript-based-link-which-is-also-the-part-of-a-table-on-a-w", "title": "Unable to click a JavaScript based link which is also the part of a table on a webpage using web elements through VBA", "body": "<p>I am attempting to automate a certain process for my business by clicking on certain links on a webpage, inputting business data into a search box and compare it with existing data. I am however, unsuccessful at clicking a javascript based link which also the part of the table using VBA. The website's relevant HTML is as below,</p>\n\n<pre><code>&lt;tr class=\"odd\"&gt; &lt;td&gt; &lt;a onclick=\"viewCompanyDetails('B214273', '1529481460070');\" href=\"javascript:;\"&gt;Alinda Infrastructure Fund III (Euro) GP SARL&lt;/a&gt;&lt;/td&gt; &lt;td&gt;&lt;a onclick=\"viewCompanyDetails('B214273', '1529481460070');\" href=\"javascript:;\"&gt;B214273&lt;/a&gt;&lt;/td&gt; &lt;/tr&gt;\n</code></pre>\n\n<p>Here is my poor attempt at doing the project,</p>\n\n<pre><code>        Private Sub CommandButton1_Click()\n        Set IE = CreateObject(\"InternetExplorer.Application\")\n        my_url = \"https://www.lbr.lu/mjrcs/jsp/DisplayConsultDocumentsActionNotSecured.action?FROM_MENU=true&amp;time=1528967707649&amp;currentMenuLabel=menu.item.companyconsultation\"\n\n    consoletext = consoletext &amp; \"Connection established to Luxembourg Business Registers on www.rcsl.lu via Internet Explorer...\" &amp; vbNewLine &amp; vbNewLine\n    txtConsole.Value = consoletext\n    consoletext = consoletext &amp; \"Looking up Registre De Commerce et des Societes.\" &amp; vbNewLine &amp; vbNewLine\n    txtConsole.Value = consoletext\n\n        With IE\n            .Visible = True\n            .navigate my_url\n\n        Do Until Not IE.Busy And IE.readyState = 4\n            DoEvents\n        Loop\n\n        End With\n\n    For Each objlink In IE.document.getElementsByTagName(\"href\")\n    If objlink.href = \"/mjrcs/jsp/DisplayConsultDocumentsActionNotSecured.action?FROM_MENU=true&amp;time=1528969484260&amp;currentMenuLabel=menu.item.companyconsultation\" Then\n    objlink.Click\n    Exit For\n    End If\n    Next objlink\n\n    Do Until Not IE.Busy And IE.readyState = 4\n            DoEvents\n        Loop\n\n    consoletext = consoletext &amp; \"Looking up \" &amp; Sheets(\"Results\").Range(\"N1\").Value &amp; \" in the registry.\" &amp; vbNewLine &amp; vbNewLine\n    txtConsole.Value = consoletext\n\n    Dim TradeName As String\n    TradeName = ThisWorkbook.Sheets(\"Results\").Range(\"Y1\").Value\n\n     IE.document.getElementById(\"companyName\").Value = TradeName\n\n    Set objSubmit = IE.document.getElementsByTagName(\"input\")\n\n    For Each btn In objSubmit\n        If btn.Value Like \"Search\" Then\n            btn.Click\n        End If\n    Next\n\n        Do Until Not IE.Busy And IE.readyState = 4\n            DoEvents\n        Loop\n\n    For Each entitylink In IE.document.getElementsByClassName(\"tr\")\n    If entitylink.getElementsByTagName = \"a\" And entitylink.textcontent = Sheets(\"Results\").Range(\"N1\").Value And entitylink.href = \"javascript:;\" Then\n    entitylink.Click\n    Exit For\n    End If\n    Next entitylink\n\n\n    txtXMLpath.Value = \"\"\n\nEnd Sub\n</code></pre>\n\n<p>This is what the webpage content looks like,</p>\n\n<p><a href=\"https://i.stack.imgur.com/U2W27.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>I have hidden the name of the entity to protect the identity of the client. I need to click the result on the first row per the image.</p>\n\n<p>I will be much obliged if you could provide any help. Again, I'm a beginner in VBA and have no idea how to proceed here. Please let me know should you require further clarification</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1529484716, "post_id": 50943993, "comment_id": 88885504, "body": "See <a href=\"https://stackoverflow.com/q/10714251/8112776\">&quot;<b>How to avoid using Select in Excel VBA</b>&quot;</a>."}, {"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1529484940, "post_id": 50943993, "comment_id": 88885640, "body": "Do you have the sales 2009-2018.xlsx workbook open?"}, {"owner": {"reputation": 27, "user_id": 9925016, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uBduEJNu3yQ/AAAAAAAAAAI/AAAAAAAAAj4/r4reQaQtKLI/photo.jpg?sz=128", "display_name": "Can Erik", "link": "https://stackoverflow.com/users/9925016/can-erik"}, "edited": false, "score": 0, "creation_date": 1529485617, "post_id": 50943993, "comment_id": 88886043, "body": "Yes, &quot;sales 2009-2018.xlsx&quot; is already open. Some part of the code does it before reaching this part of the code."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1529485702, "post_id": 50943993, "comment_id": 88886092, "body": "Can you read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and come up with one?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1529485870, "post_id": 50943993, "comment_id": 88886198, "body": "Your macro was recorded in a particular cell. When you then run it, if you are not in the same cell you may get unusual results. Far better to replace activecell in the first line with an explicit statement about the cell you want : probably Range(&quot;n2&quot;) ?"}, {"owner": {"reputation": 27, "user_id": 9925016, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uBduEJNu3yQ/AAAAAAAAAAI/AAAAAAAAAj4/r4reQaQtKLI/photo.jpg?sz=128", "display_name": "Can Erik", "link": "https://stackoverflow.com/users/9925016/can-erik"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1529486293, "post_id": 50943993, "comment_id": 88886487, "body": "I put Range(&quot;N3&quot;).Select before VLOOKUP in order to be in the same cell I record it, however, it gives the same error. @Harassed Dad"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1529498207, "post_id": 50943993, "comment_id": 88894353, "body": "Try running the macro by clicking in the code and pressing F8. You can step through the code line by line by successive pressing of F8 until you get the error. The line in yellow is the source of the problem and will narrow it down."}], "owner": {"reputation": 27, "user_id": 9925016, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uBduEJNu3yQ/AAAAAAAAAAI/AAAAAAAAAj4/r4reQaQtKLI/photo.jpg?sz=128", "display_name": "Can Erik", "link": "https://stackoverflow.com/users/9925016/can-erik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529484442, "creation_date": 1529484442, "question_id": 50943993, "link": "https://stackoverflow.com/questions/50943993/vlookup-does-not-work-on-other-workbook-and-returns-1004-error", "title": "VLOOKUP does not work on other workbook and returns 1004 error", "body": "<p>I try to make VBA to perform a VLOOKUP, however, the table for VLOOKUP is in another workbook.</p>\n\n<p>When I record macro on the main workbook and generate VLOOKUP from dialogue box, it works. I can also fill the other rows and colums by simply dragging the active cell. When I stop recording macro, the result in VBA console can be found below;</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n        \"=VLOOKUP(RC3,'[sales 2009-2018.xlsx]sales 31122009'!R1C1:R546753C21,R1C,0)\"\n    Selection.AutoFill Destination:=Range(\"N3:N19\"), Type:=xlFillDefault\n    Range(\"N3:N19\").Select\n    Selection.AutoFill Destination:=Range(\"N3:AC19\"), Type:=xlFillDefault\n    Range(\"N3:AC19\").Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"N3\").Select\n</code></pre>\n\n<p>Thus, it goes to \"sales 2009-2018.xlsx\" for the data for VLOOKUP.</p>\n\n<p>However, when I run the macro to perform the same function it gives me the following error;</p>\n\n<blockquote>\n  <p>Run-time error '1004': Application-defined or object-defined error</p>\n</blockquote>\n\n<p>Why macro gives this error when running while it works perfectly when I record it?</p>\n\n<p>Thank you for your help in advance!</p>\n\n<p>Best regards,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1529483721, "post_id": 50943560, "comment_id": 88884974, "body": "Can you give an example of the &quot;several answers to this question&quot; that you&#39;ve tried and expand on &quot;they didn&#39;t work&quot;?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1529483865, "post_id": 50943560, "comment_id": 88885043, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1703576/excel-waiting-for-one-macro-to-finish-before-calling-another\">Excel waiting for one macro to finish before calling another</a>"}, {"owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529484603, "post_id": 50943560, "comment_id": 88885435, "body": "the Link there did not help..."}, {"owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529484856, "post_id": 50943560, "comment_id": 88885593, "body": "I already tried the sleep and wait methods they just stop the whole macro even the one that generates values. Also tried adding DoEvents in the end of the generating macro OR after when i call the generating macro in the main macro. the changes have no effect what so ever the code still does not wait for the generating to finish"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529484471, "post_id": 50943749, "comment_id": 88885360, "body": "Thanks for the answer, but the macro still opens up the file Sablonai.xlsm before the macro finishes generating values"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529484748, "post_id": 50943749, "comment_id": 88885526, "body": "Can you show how the excel document is lined up? Before and after, I have done a program that may solve your problem if I could understand the current result a little more clearly."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1529484959, "post_id": 50943749, "comment_id": 88885649, "body": "This part of your code is wrong, you use     With wbTarget.Worksheets(&quot;SO Lines&quot;) but then you have this after the With statement: ActiveSheet.Range(&quot;E4&quot;).Copy, which does NOT necessarily point to wbTarget.Worksheets(&quot;SO Lines&quot;). To have it work that way, change to: .Range(&quot;E4&quot;).Copy"}, {"owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529485024, "post_id": 50943749, "comment_id": 88885676, "body": "do you mean the data generation excel document or the end document? because the end document is just a blank space to paste in"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1529485171, "post_id": 50943749, "comment_id": 88885775, "body": "@jkpieterse I thought so, should this be included to activesheet.pasteSpecial too?"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529485266, "post_id": 50943749, "comment_id": 88885827, "body": "@sarunas2007 The data generation document would give us an insight on how it is structured. Furthermore, how is the generation occur? Do you have to save it to a document or could it be done with an array?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1529485506, "post_id": 50943749, "comment_id": 88885986, "body": "Yes, remove Activesheet there as well"}, {"owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529485561, "post_id": 50943749, "comment_id": 88886017, "body": "The generation macro works like this: you write in a sales order number (this part of the code is not in the code i provided)  and it just exports data from Dynamics AX into different sheets. i just want to copy the data from one sheet SO Lines. Hope that helps this is enough because i cant really provide more... the last two lines that trigger everything in the generation macro are           ActiveWorkbook.RefreshAll Application.ScreenUpdating = True"}, {"owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529485861, "post_id": 50943749, "comment_id": 88886194, "body": "yet again the code you guys provided, with the changes, works like it should when run with pressing F8, but not when just casually running the macro"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "edited": false, "score": 0, "creation_date": 1529486034, "post_id": 50943749, "comment_id": 88886297, "body": "Okay so you optimize the program a little with ScreenUpdating. I was thinking that you could use <code>Application.Transpose(Range(Cells(1, 1), Cells(1, 1).End(xlDown)).Value2)</code>. This will copy one column from the sheet into an array. By doing this you will only need to specify the sheet. If this solves the problem I will update the code above."}, {"owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529486379, "post_id": 50943749, "comment_id": 88886542, "body": "Sorry but i dont really understand where i am suppose to put this line of code. Im new to VBA coding"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "edited": false, "score": 0, "creation_date": 1529486452, "post_id": 50943749, "comment_id": 88886593, "body": "I can&#39;t show my project (due to policy) but will try to update the code above"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529487170, "post_id": 50943749, "comment_id": 88887085, "body": "@sarunas2007 Updated the code, bit difficult to copy everything so updated a part of it. This may/may not work depending on the format of your file. But it may guide you forward (I hope)"}, {"owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529487292, "post_id": 50943749, "comment_id": 88887174, "body": "Same question again, where am i suppose to add the updated code as i see it does not include the start of my export macro. am i suppose to put it after the code you provided earlier? after reading it i dont even understand how does it have to do anything with making my macro wait for another macro to finish..."}, {"owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529487789, "post_id": 50943749, "comment_id": 88887511, "body": "Dim dData(1) Variant is highlighted in red and says syntax error"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "edited": false, "score": 0, "creation_date": 1529488106, "post_id": 50943749, "comment_id": 88887747, "body": "I may have misunderstood then, what is wbThis, myValue, StrName. Though you wanted to copy the data but right now it looks like you want to paste it? The variables are declared but not used or not declared and used. Can you explain what you try to do?"}, {"owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "edited": false, "score": 0, "creation_date": 1529488632, "post_id": 50943749, "comment_id": 88888106, "body": "I only posted the code that needs fixing, Wbthis is the current document, MyValue is the sales order number that is pasted into the execusion excel  file where the generation macro is. strName isnt even uses anymore. Ill explain the point again. there are 3 excel files. 1 - where the main macro is that you see the code of. This file takes a sales number and puts it in -&gt; file 2. Excel that has the generation macro. the macro generates like 10 sheets worth of different information from the sales order. then i just want to copy one sheet and paste it into-&gt; empty excel 3 file"}], "tags": [], "owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "is_accepted": false, "score": 0, "last_activity_date": 1529487945, "last_edit_date": 1529487945, "creation_date": 1529483613, "answer_id": 50943749, "question_id": 50943560, "link": "https://stackoverflow.com/questions/50943560/how-to-wait-for-another-macro-to-finish-generating-values/50943749#50943749", "title": "How to wait for another macro to finish generating values?", "body": "<p>Try to avoid <code>Activate</code> and <code>Select</code> due to it's performance issues. When you step through the code it should work as intended as select/activate are able to finish before the next rows are being executed. \nHaven't tested the code below yet but I hope you understand the principe of <code>With</code>. </p>\n\n<p>Further examples of select could be seen at <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<pre><code>Set wbThis = ActiveWorkbook\nstrName = ActiveSheet.Name\nSet wbTarget = \nWorkbooks.Open(\"D:\\Users\\user37\\Desktop\\exportas\\Information.xlsm\")\nWith wbTarget.Worksheets(\"Information\")\n    ActiveSheet.Range(\"B2\").Value = myValue\n    Application.Run (\"'Information.xlsm'!ExportData\")\nWith wbTarget.Worksheets(\"SO Lines\")\n    .Range(\"E4\").Copy\nEnd With\n\nSet wbTarget = Workbooks.Open(\"D:\\Users\\user37\\Desktop\\exportas\\Sablonai.xlsm\")\nWith wbTarget.Worksheets(\"Duomenys\")\n    With ActiveSheet.Range(\"A1\")\n        .PasteSpecial\n    End With\nEnd With\n</code></pre>\n\n<p>Updated:</p>\n\n<pre><code>'In case of multiple columns we create an array\nDim dData(1) as Variant \nSet wbThis = ActiveWorkbook\nstrName = ActiveSheet.Name\nSet wbTarget = \nWorkbooks.Open(\"D:\\Users\\user37\\Desktop\\exportas\\Information.xlsm\")\nWith wbTarget.Worksheets(\"Information\")\n'Copies column 1 and 2\n    data(0) = Application.Transpose(Range(Cells(1,1),Cells(1,1).End(xlDown)).Value2)\n    data(1) = Application.Transpose(Range(Cells(2,1), Cells(2,1).End(xlDown)).Value2)\nEnd With\n\n'Once again we copy the data from column 1 and 2\nWith wbTarget.Worksheets(\"SO Lines\")\n    data(0) = Application.Transpose(Range(Cells(1,1),Cells(1,1).End(xlDown)).Value2)\n    data(1) = Application.Transpose(Range(Cells(2,1),Cells(2,1).End(xlDown)).Value2)\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "is_accepted": false, "score": 0, "last_activity_date": 1529492853, "creation_date": 1529492853, "answer_id": 50946765, "question_id": 50943560, "link": "https://stackoverflow.com/questions/50943560/how-to-wait-for-another-macro-to-finish-generating-values/50946765#50946765", "title": "How to wait for another macro to finish generating values?", "body": "<p>the Issue was solved by going to the generation macro -> data -> connections and disabling backround refresh for every query</p>\n"}], "owner": {"reputation": 11, "user_id": 8392525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_mzwic0tTs/AAAAAAAAAAI/AAAAAAAAADQ/T6t7JPIiIX8/photo.jpg?sz=128", "display_name": "sarunas2007", "link": "https://stackoverflow.com/users/8392525/sarunas2007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 859, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1579379560, "creation_date": 1529482901, "last_edit_date": 1579379560, "question_id": 50943560, "link": "https://stackoverflow.com/questions/50943560/how-to-wait-for-another-macro-to-finish-generating-values", "title": "How to wait for another macro to finish generating values?", "body": "<p>A macro that is run inside my main macro generates values that I need to copy to another Excel file.</p>\n\n<p>My main macro does not wait for the generating to finish and pastes empty cells into the other document.</p>\n\n<p>The code works as intended if I step through but not when pressing \"run\".</p>\n\n<pre><code>Set wbThis = ActiveWorkbook\nstrName = ActiveSheet.Name\nSet wbTarget = Workbooks.Open(\"D:\\Users\\user37\\Desktop\\exportas\\Information.xlsm\")\nwbTarget.Worksheets(\"Information\").Activate\nActiveSheet.Range(\"B2\").Value = myValue\nApplication.Run (\"'Information.xlsm'!ExportData\")\nwbTarget.Worksheets(\"SO Lines\").Activate\nActiveSheet.Range(\"E4\").Copy\n\nSet wbTarget = Workbooks.Open(\"D:\\Users\\user37\\Desktop\\exportas\\Sablonai.xlsm\")\nwbTarget.Worksheets(\"Duomenys\").Activate\nActiveSheet.Range(\"A1\").Select\nactiveSheet.PasteSpecial\n</code></pre>\n\n<p>I found several answers to this question but none of them seem to work for me.</p>\n\n<p>I tried the sleep and wait methods. They stop the whole macro even the one that generates values.</p>\n\n<p>I tried adding DoEvents in the end of the generating macro OR after when I call the generating macro in the main macro. The changes have no effect.</p>\n\n<p>Suggested duplicate <a href=\"https://stackoverflow.com/questions/1703576/excel-waiting-for-one-macro-to-finish-before-calling-another\">Excel waiting for one macro to finish before calling another</a> does not help.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 9224580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ac81d797b4f0aa0f55fecd41c89ba0?s=128&d=identicon&r=PG&f=1", "display_name": "user503842", "link": "https://stackoverflow.com/users/9224580/user503842"}, "edited": false, "score": 0, "creation_date": 1529484350, "post_id": 50943662, "comment_id": 88885289, "body": "jep, that&#39;s what I meant! Thx a lot, man! - However, one more question: When I do what you suggested, everything works out. But if I later decide to delete a row, Excel is not able to calculate the entries of the rows following the deleted row. I would have to perform your mentioned steps 3-4 again. Is there a way around this?"}, {"owner": {"reputation": 446, "user_id": 9805514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/227118daeaf6bac4d489e7751dc02a37?s=128&d=identicon&r=PG&f=1", "display_name": "IceTea", "link": "https://stackoverflow.com/users/9805514/icetea"}, "reply_to_user": {"reputation": 115, "user_id": 9224580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ac81d797b4f0aa0f55fecd41c89ba0?s=128&d=identicon&r=PG&f=1", "display_name": "user503842", "link": "https://stackoverflow.com/users/9224580/user503842"}, "edited": false, "score": 0, "creation_date": 1529493251, "post_id": 50943662, "comment_id": 88891010, "body": "@user503842 after you delete a row, you can go to the first cell after that, now with a #REF! and just key in the formula again. Since you already told Excel that you wanted the following cells afterwards to have the same formula, just changing one cell is enough.  eg. using my example above If I deleted row 7, the values starting from row 7 will have #REF!. Just type in &quot;=A6+1&quot; into row 7 again and the rest of the cells should go back to normal"}, {"owner": {"reputation": 446, "user_id": 9805514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/227118daeaf6bac4d489e7751dc02a37?s=128&d=identicon&r=PG&f=1", "display_name": "IceTea", "link": "https://stackoverflow.com/users/9805514/icetea"}, "reply_to_user": {"reputation": 115, "user_id": 9224580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ac81d797b4f0aa0f55fecd41c89ba0?s=128&d=identicon&r=PG&f=1", "display_name": "user503842", "link": "https://stackoverflow.com/users/9224580/user503842"}, "edited": false, "score": 0, "creation_date": 1529493396, "post_id": 50943662, "comment_id": 88891097, "body": "If you&#39;re looking at having the entries for the original row 8 stay as &quot;8&quot; and not &quot;7&quot; after you delete the row, the most straightforward way I can think of is to hide the row instead of deleting it."}], "tags": [], "owner": {"reputation": 446, "user_id": 9805514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/227118daeaf6bac4d489e7751dc02a37?s=128&d=identicon&r=PG&f=1", "display_name": "IceTea", "link": "https://stackoverflow.com/users/9805514/icetea"}, "is_accepted": true, "score": 1, "last_activity_date": 1529487506, "last_edit_date": 1529487506, "creation_date": 1529483323, "answer_id": 50943662, "question_id": 50943559, "link": "https://stackoverflow.com/questions/50943559/in-excel-how-do-i-add-a-value-per-row/50943662#50943662", "title": "In Excel, how do I add a value per row?", "body": "<ol>\n<li>Type in your starting value in the first row</li>\n<li>On the second row type \"=\" + click on the cell with your starting value + type \"+1\" and enter.</li>\n<li>Hover your mouse over the bottom right corner of the second cell with your equation until you see a black plus sign.</li>\n<li>Drag it down as many rows as you want.</li>\n</ol>\n\n<p>Here's a picture:\n<img src=\"https://i.stack.imgur.com/d4HhW.png\" alt=\"Here&#39;s a picture\"></p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1529488054, "creation_date": 1529488054, "answer_id": 50945177, "question_id": 50943559, "link": "https://stackoverflow.com/questions/50943559/in-excel-how-do-i-add-a-value-per-row/50945177#50945177", "title": "In Excel, how do I add a value per row?", "body": "<p>So <code>E242</code> already has 30000, <code>E243</code> already has 30001 and you want to permanently add one to each value?</p>\n\n<ul>\n<li>Type <code>1</code> in a blank cell and copy the cell (<code>Ctrl+C</code>).</li>\n<li>Select the range <code>E242:E276</code> and right-click.</li>\n<li>Select <code>Paste Special</code> to make a pop-out menu appear.<br>\nAt the bottom of the pop-out menu select <code>Paste Special</code> again. </li>\n<li>In the dialog box that opens select <code>Add</code> and click <code>OK</code>.  </li>\n</ul>\n\n<p>This will add your copied number to the value in the selected cells.</p>\n"}], "owner": {"reputation": 115, "user_id": 9224580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ac81d797b4f0aa0f55fecd41c89ba0?s=128&d=identicon&r=PG&f=1", "display_name": "user503842", "link": "https://stackoverflow.com/users/9224580/user503842"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1529496414, "accepted_answer_id": 50943662, "answer_count": 2, "score": -1, "last_activity_date": 1557767672, "creation_date": 1529482890, "last_edit_date": 1557767672, "question_id": 50943559, "link": "https://stackoverflow.com/questions/50943559/in-excel-how-do-i-add-a-value-per-row", "closed_reason": "Needs more focus", "title": "In Excel, how do I add a value per row?", "body": "<p>Consider a specific cell with the entry 30000. What I want to do is: increment the value by just 1 for every row that is following this cell. \nThere must be an easy way to do this, right?</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1529484013, "post_id": 50943139, "comment_id": 88885121, "body": "Have you declared you variables?  Add <code>Option Explicit</code> at the very top of [every] module [always] to help ensure variables and objects are being properly declared and referenced."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1529484233, "post_id": 50943139, "comment_id": 88885239, "body": "<code>Range(&quot;S&quot; &amp; FoundRow &amp; &quot;:AE&quot; &amp; FoundRow).Copy</code>  should this be prefixed with a sheet reference?"}, {"owner": {"reputation": 149, "user_id": 9534456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518d95ecc6ddc3a203e0b2cf9e60e698?s=128&d=identicon&r=PG&f=1", "display_name": "kit99", "link": "https://stackoverflow.com/users/9534456/kit99"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1529488602, "post_id": 50943139, "comment_id": 88888087, "body": "Yes @ashleedawg , I&#39;m using Option Explicit on this vba."}, {"owner": {"reputation": 149, "user_id": 9534456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518d95ecc6ddc3a203e0b2cf9e60e698?s=128&d=identicon&r=PG&f=1", "display_name": "kit99", "link": "https://stackoverflow.com/users/9534456/kit99"}, "edited": false, "score": 0, "creation_date": 1529488763, "post_id": 50943139, "comment_id": 88888208, "body": "Just tried to change line to  <code>wb_rapp.Sheets(1).Range(&quot;S&quot; &amp; FoundRow &amp; &quot;:AE&quot; &amp; FoundRow).Copy</code>  but it did not fix my problem."}], "owner": {"reputation": 149, "user_id": 9534456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518d95ecc6ddc3a203e0b2cf9e60e698?s=128&d=identicon&r=PG&f=1", "display_name": "kit99", "link": "https://stackoverflow.com/users/9534456/kit99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529481463, "creation_date": 1529481463, "last_edit_date": 1531164843, "question_id": 50943139, "link": "https://stackoverflow.com/questions/50943139/vba-help-on-debugging-copy-paste-thats-gone-wrong", "title": "VBA - help on debugging copy/paste that&#39;s gone wrong", "body": "<p>Something mysterious happens in a small part of my code, and I can't figure out what's wrong.\nThis is the problem-bit (and I've skipped the sheet/report-definitions that I have at the top):</p>\n\n<pre><code>Set FoundRow = sh_NYlandsum.Columns(1).Find(\"SUM\", lookat:=xlWhole, LookIn:=xlValues)\n    FoundRow.Offset(, 1).Resize(1, 33).Copy\n        sh_Data3.Range(\"C\" &amp; sh_Data3.Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n        Application.CutCopyMode = False\n\nSet wb_rapp = Workbooks.Open(fPath &amp; \"\\R2\\\" &amp; \"Gruppe1.xls\")   \n    FoundRow = wb_rapp.Sheets(1).Range(\"A1:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Find(\"SUM\", Cells(1, 1), MatchCase:=True).Row\n    Range(\"S\" &amp; FoundRow &amp; \":AE\" &amp; FoundRow).Copy\nFoundRow = sh_SumGrupper.Range(\"A1:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Find(\"G1\", Cells(1, 1)).Row    \nsh_SumGrupper.Range(\"B\" &amp; FoundRow &amp; \":N\" &amp; FoundRow).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nApplication.CutCopyMode = False\nwb_rapp.Close False\n</code></pre>\n\n<p>I've been debugging the code using F8, and this is what's happening:</p>\n\n<p>First bit goes to sheet NYlandsum (ThisWB), finds word \"SUM\" in row A, and copies columns B-AH. Data is passed into sheet \"Data3\" (ThisWB) columns C:AI (first available row).\nWorks just fine.</p>\n\n<p>Next bit opens up a report, finds word \"SUM\" in row A, and copies columns S-AE. Data is passed into sheet \"SumGrupper\" (ThisWB), where it finds row holding \"G1\" in column A, and puts data into columns B:N.\nWorks just fine.</p>\n\n<p>BUT..., when this last bit is finished the code also has taken the row number from sheet \"SumGrupper\" - where it has passed data (row holding \"G1\" in column A = <strong>row number 5</strong>), and replaced the word \"SUM\" from column A in sheet \"NYlandSUM\" with the value \"5\".\nHow the f... did that happen? Anyone that can spot what's wrong, and how to fix it?</p>\n"}, {"tags": [".net", "vba", "excel", "sum", "runtime-error"], "answers": [{"tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1529482652, "creation_date": 1529482652, "answer_id": 50943508, "question_id": 50942830, "link": "https://stackoverflow.com/questions/50942830/excel-vba-sum-multi-sheet-got-run-time-error-1004-application-defined-or-object/50943508#50943508", "title": "excel vba sum multi sheet got run-time error 1004: Application-defined or object-defined error", "body": "<p>Could you try : </p>\n\n<ol>\n<li>to replace <code>Set wb = ActiveWorkbook</code> by <code>Set wb = ThisWorkbook</code></li>\n<li>to put your code in a new module</li>\n</ol>\n\n<p><code>ThisWorkbook</code> refers to the workbook where you execute your code.\nError 1004 can happen when you have other workbook open.</p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1529486335, "last_edit_date": 1529486335, "creation_date": 1529485971, "answer_id": 50944494, "question_id": 50942830, "link": "https://stackoverflow.com/questions/50942830/excel-vba-sum-multi-sheet-got-run-time-error-1004-application-defined-or-object/50944494#50944494", "title": "excel vba sum multi sheet got run-time error 1004: Application-defined or object-defined error", "body": "<p>Instead of this:</p>\n\n<pre><code>ws.Cells(i + startrow, tmpcol + 4).Value = Application.WorksheetFunction.Sum(.Range(Cells(startrow + 1, PropStartcol + tmpcol), Cells(tmpSheetrow, PropStartcol + tmpcol)))\n</code></pre>\n\n<p>Write this:</p>\n\n<pre><code>ws.Cells(i + startrow, tmpcol + 4).Value = Application.WorksheetFunction.Sum(.Range(.Cells(startrow + 1, PropStartcol + tmpcol), .Cells(tmpSheetrow, PropStartcol + tmpcol)))\n</code></pre>\n\n<p>The difference is the dot in front of Cells (twice in the code). Without the dot, the <code>Cells</code> take as its worksheet the activesheet or the sheet in which they are located. And it breaks, because <code>.Range()</code> takes <code>wb.Sheets(SKUName)</code>.</p>\n\n<p>This is probably the most common problem in StackOverflow for <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a>:</p>\n\n<ul>\n<li><p><a href=\"https://stackoverflow.com/questions/48382421/with-worksheetsxxxx-works-only-when-xxxx-is-the-active-worksheet/48382702#48382702\">&#39;With Worksheets(&quot;xxxx&quot;)&#39; works only when &quot;xxxx&quot; is the active worksheet</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/49238125/find-last-column-sort-on-last-column/49238344#49238344\">Find last column &amp; sort on last column</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/50465500/variable-not-being-stored-in-the-code-when-sheet-changes/50465557#50465557\">Variable not being stored in the code when sheet changes</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/50758680/how-to-set-up-vba-code-for-only-one-sheet/50758824#50758824\">How to set up vba code for only one sheet?</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/48463874/finding-and-deleting-last-column-with-header-if-sum-is-0/48463998#48463998\">Finding and deleting last column with header if sum is 0</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/45886700/do-until-loop-excel-vba/45886736#45886736\">Do Until Loop Excel VBA</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/49796422/append-worksheets-of-same-structure-from-multiple-excel-files-into-one/49796488#49796488\">Append Worksheets of same structure from multiple Excel Files into one</a></p></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 8101148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f76c6d8bb0fc70b2df97555b9e23596?s=128&d=identicon&r=PG", "display_name": "Noah Liu", "link": "https://stackoverflow.com/users/8101148/noah-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 279, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529486524, "creation_date": 1529480490, "last_edit_date": 1529486524, "question_id": 50942830, "link": "https://stackoverflow.com/questions/50942830/excel-vba-sum-multi-sheet-got-run-time-error-1004-application-defined-or-object", "title": "excel vba sum multi sheet got run-time error 1004: Application-defined or object-defined error", "body": "<p>I got this 1004 run-time error on the code below. The line I mark as comment is the key of this question. Whenever the line mark as comment this code always got 1004 run-time error. And the code works good when I put the line back as normal code. Is there anyway to skip the sheet activation during this code since that activation makes the excel jumping around during the code running. </p>\n\n<p>Thank you.</p>\n\n<pre><code>Public Sub Summary_calculation()\n\n   Dim wb As Workbook\n   Dim ws As Worksheet\n   Dim endrow As Integer\n   Dim temprow As Integer\n   Dim tempcol As Integer\n   Dim i As Integer\n   Dim totalrec As Integer\n   Dim tmpSheet As Worksheet\n   Dim SKUCol As Integer\n   Dim SKUName As String\n   Dim tmpSheetrow As Integer\n   Dim tmpcol As Integer\n   Dim tmpQty As Double\n\n   Set wb = ActiveWorkbook\n   Set ws = wb.Sheets(\"Summary\")\n\n   SKUCol = 3\n\n   totalrec = ws.Cells(startrow, 1).CurrentRegion.Rows.Count - 1\n\n   For i = 1 To totalrec\n\n      SKUName = ws.Cells(i + startrow, SKUCol).Value\n\n      Set tmpSheet = wb.Sheets(SKUName)\n\n      'tmpSheet.Activate (Got 1004 error whenever remove this line of code)\n\n      tmpSheetrow = tmpSheet.Cells(startrow, Gapcol).CurrentRegion.Rows.Count + startrow - 1\n\n      For tmpcol = 0 To 16\n         With wb.Sheets(SKUName)\n\n            ws.Cells(i + startrow, tmpcol + 4).Value = Application.WorksheetFunction.Sum(.Range(Cells(startrow + 1, PropStartcol + tmpcol), Cells(tmpSheetrow, PropStartcol + tmpcol)))\n\n         End With\n      Next tmpcol\n      ws.Cells(1, 10) = Format(i / totalrec, \"00%\")\n      DoEvents\n   Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1529480694, "post_id": 50942753, "comment_id": 88883190, "body": "...and do you have a question?"}, {"owner": {"reputation": 103, "user_id": 7683911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/219a9e348c08c8aa8d3dd0d37ce74b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Chandrasekar R", "link": "https://stackoverflow.com/users/7683911/chandrasekar-r"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1529480755, "post_id": 50942753, "comment_id": 88883225, "body": "The above script doesn&#39;t work. I even tried with - Sub DateFilter() Sheets(&quot;Base Sheet&quot;).Range(&quot;A1:CS1&quot;).AutoFilter Field:=36, Criteria1:=&quot;&lt;=&quot; &amp; Application.EoQuarter(Date, -1) End Sub"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1529481002, "post_id": 50942753, "comment_id": 88883371, "body": "What is <code>EoQuarter</code>?  You can&#39;t make up functions and expect them to work.  Have you tried Googling your issue?  <a href=\"https://stackoverflow.com\">Stack Overflow</a> isn&#39;t a &quot;free code writing service&quot;..."}, {"owner": {"reputation": 103, "user_id": 7683911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/219a9e348c08c8aa8d3dd0d37ce74b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Chandrasekar R", "link": "https://stackoverflow.com/users/7683911/chandrasekar-r"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1529481125, "post_id": 50942753, "comment_id": 88883448, "body": "Something similar to  &quot;EoMonth(Date, 0)&quot; &#39;marks the last day of current month&#39;"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1529482826, "post_id": 50942753, "comment_id": 88884451, "body": "A good place to start would be a Google Search for &quot;how to calculate end of quarter in vba&quot;"}, {"owner": {"reputation": 103, "user_id": 7683911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/219a9e348c08c8aa8d3dd0d37ce74b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Chandrasekar R", "link": "https://stackoverflow.com/users/7683911/chandrasekar-r"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1529488687, "post_id": 50942753, "comment_id": 88888143, "body": "Thank you for your assistance"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 7683911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/219a9e348c08c8aa8d3dd0d37ce74b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Chandrasekar R", "link": "https://stackoverflow.com/users/7683911/chandrasekar-r"}, "edited": false, "score": 0, "creation_date": 1529483363, "post_id": 50943615, "comment_id": 88884773, "body": "Yes i understand but need to filter excluding &#39;thisQuarter&#39; &quot;&lt;&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 103, "user_id": 7683911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/219a9e348c08c8aa8d3dd0d37ce74b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Chandrasekar R", "link": "https://stackoverflow.com/users/7683911/chandrasekar-r"}, "edited": false, "score": 1, "creation_date": 1529483678, "post_id": 50943615, "comment_id": 88884946, "body": "@ChandrasekarR Well, then you should be much more clear in your question which says the opposite: <i>&quot;I need to filter Data with Date ONLY from Current Quarter onward, excluding all data with previous Quarter and year&quot;</i>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 103, "user_id": 7683911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/219a9e348c08c8aa8d3dd0d37ce74b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Chandrasekar R", "link": "https://stackoverflow.com/users/7683911/chandrasekar-r"}, "edited": false, "score": 0, "creation_date": 1529484528, "post_id": 50943615, "comment_id": 88885387, "body": "@ChandrasekarR - check out the <a href=\"https://stackoverflow.com/help/on-topic\">help center</a> as well as &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;.  Also see the <a href=\"https://meta.stackoverflow.com/questions/260648/stack-overflow-question-checklist\">Stack Overflow Question Checklist</a> for more tips about posting questions, as well as <b><a href=\"//meta.stackoverflow.com/questions/261592\">&quot;How much research effort is expected of Stack Overflow users?&quot;</a></b>. (+1)"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1529483116, "creation_date": 1529483116, "answer_id": 50943615, "question_id": 50942753, "link": "https://stackoverflow.com/questions/50942753/filter-date-from-current-quarter/50943615#50943615", "title": "Filter Date from current quarter", "body": "<p>There is a parameter to filter for the current quarter: <code>xlFilterThisQuarter</code></p>\n\n<pre><code>.AutoFilter Field:=1, Criteria1:=xlFilterThisQuarter, Operator:=xlFilterDynamic\n</code></pre>\n\n<p>See the documentation:</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-autofilter-method-excel\" rel=\"nofollow noreferrer\">Range.Autofilter Method</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlautofilteroperator-enumeration-excel\" rel=\"nofollow noreferrer\">XlAutoFilterOperator Enumeration</a></li>\n<li><a href=\"http://%20https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xldynamicfiltercriteria.aspx\" rel=\"nofollow noreferrer\">XlDynamicFilterCriteria enumeration</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1529483265, "creation_date": 1529483265, "answer_id": 50943649, "question_id": 50942753, "link": "https://stackoverflow.com/questions/50942753/filter-date-from-current-quarter/50943649#50943649", "title": "Filter Date from current quarter", "body": "<p><a href=\"https://www.mrexcel.com/forum/excel-questions/54333-calculate-next-quarter-end-date-vba.html\" rel=\"nofollow noreferrer\">The first result</a> from a <a href=\"https://www.google.com/search?q=calculate%20end%20of%20quarter%20in%20excel%20vba\" rel=\"nofollow noreferrer\">Google search</a> for \"calculate end of quarter in excel vba\" lead me to this answer: </p>\n\n<pre><code>DateSerial(Year(Range(\"B5\")), Month(Range(\"B5\")) + 4, 0)\n</code></pre>\n\n<p>which you can change to use today's date for the end of the current quarter like this:</p>\n\n<pre><code>DateSerial(Year(Date), Month(Date) + 4, 0)\n</code></pre>\n\n<p>Another search for your question could be \"autofilter current quarter excel\".</p>\n\n<p>Google should always be the first place to look for a solution to <em>any</em> problem.</p>\n"}], "owner": {"reputation": 103, "user_id": 7683911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/219a9e348c08c8aa8d3dd0d37ce74b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Chandrasekar R", "link": "https://stackoverflow.com/users/7683911/chandrasekar-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 50943649, "answer_count": 2, "score": -3, "last_activity_date": 1529483265, "creation_date": 1529480209, "last_edit_date": 1531164843, "question_id": 50942753, "link": "https://stackoverflow.com/questions/50942753/filter-date-from-current-quarter", "title": "Filter Date from current quarter", "body": "<p>I need to filter Data with Date ONLY from Current Quarter onward, excluding all data with previous Quarter and year.........</p>\n\n<pre><code>Sub DateFilter() \n    Sheets(\"Base Sheet\").Range(\"A1:CS1\").AutoFilter Field:=36, _\n        Criteria1:=\"&lt;\" &amp; ThisQuarter \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "acrobat"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1529479086, "post_id": 50942314, "comment_id": 88882251, "body": "Note that <code>Dim nameFile, s, exportCroppedPDF As String</code> will only define the last variable as <code>String</code> and the first 2 remain of type <code>Variant</code>. You must declare a type for <b>every</b> variable: <code>Dim nameFile As String, s As String, exportCroppedPDF As String</code>."}, {"owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1529479206, "post_id": 50942314, "comment_id": 88882321, "body": "@Peh oh, I wasn&#39;t aware of that, thanks for the information"}], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "edited": false, "score": 0, "creation_date": 1529480164, "post_id": 50942643, "comment_id": 88882880, "body": "@Peh, nice, but I don&#39;t see a way to crop a page no matter the resolution of the screen (if it is the problem) - I&#39;ll try something and will let you know, thanks for your time!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "edited": false, "score": 0, "creation_date": 1529480495, "post_id": 50942643, "comment_id": 88883065, "body": "@Chris well I think it should not be a matter of screen resolution. I think you used the parameters the wrong way and it should work with <code>CropPage (0,0,0,acroRect)</code>. Can you test this?"}, {"owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "edited": false, "score": 0, "creation_date": 1529480785, "post_id": 50942643, "comment_id": 88883243, "body": "@Peh on my computer, the crop action works perfectly, but not on my co-worker&#39;s desk who has a different resolution than me. That&#39;s why I don&#39;t see anything but the resolution, but you are right, based on the documentation I don&#39;t think either it is a resolution matter. I&#39;ll test the function a bit later this morning and we&#39;ll keep you in touch for sure! Thanks!"}, {"owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "edited": false, "score": 0, "creation_date": 1529568894, "post_id": 50942643, "comment_id": 88923765, "body": "@Peh Hello,  weirdly, without any changes, the cropped PDFs worked fine on my co-worker&#39;s computer this morning.  It seems that a reboot was enought. Plus, I tested the CropPages method today, and it also worked with the first 3 parameters in it. Thanks a lot for your time !"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1529479809, "creation_date": 1529479809, "answer_id": 50942643, "question_id": 50942314, "link": "https://stackoverflow.com/questions/50942314/excel-vba-crop-pdf-page-using-vba/50942643#50942643", "title": "Excel VBA - Crop PDF page using VBA", "body": "<p>According to the documentation <code>CropPages</code> has 4 arguments where <code>acroRect</code> should be the last one.</p>\n\n<blockquote>\n<pre><code>returnValue = Object.CropPages( nStartPage, nEndPage, nEvenOrOddPagesOnly, acroRect ) \n</code></pre>\n  \n  <p><strong>Parameters:</strong></p>\n  \n  <ul>\n  <li><code>nStartPage</code>: First page that is cropped. The first page in a PDDoc object is\n  page 0. </li>\n  <li><code>nEndPage</code>: Last page that is cropped.</li>\n  <li><code>nEvenOrOddPagesOnly</code> Value indicating which pages in the range are cropped. Must be\n  one of the following:  \n  \n  <ul>\n  <li><code>0</code> means crop all pages in the range</li>\n  <li><code>1</code> means crop only odd pages in the range</li>\n  <li><code>2</code> means crop only even pages in the range</li>\n  </ul></li>\n  <li><code>acroRect</code> An <code>AcroExch.Rect</code> specifying the cropping rectangle, which is\n  specified in user space. </li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1009, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1529479809, "creation_date": 1529478754, "last_edit_date": 1529479170, "question_id": 50942314, "link": "https://stackoverflow.com/questions/50942314/excel-vba-crop-pdf-page-using-vba", "title": "Excel VBA - Crop PDF page using VBA", "body": "<p>I wrote a piece of code that crops a pdf page and then re-insert this page in the global pdf using the Adobe Acrobat 10.0 Type Library for Excel VBA.\nThe code works fine on my computer but crops too much on the one of my co-worker. I think it might come from the resolution (1440x900 for mine, 1600x900 for my co-worker) but I just don't see where the resolution might interfer in the code.</p>\n\n<pre><code>Dim acroRect, jso, page As Object\nDim pdf1 As Acrobat.CAcroPDDoc\nDim nameFile, s, exportCroppedPDF As String\n\nSet acroRect = CreateObject(\"AcroExch.Rect\")\nSet pdf1 = CreateObject(\"AcroExch.PDDoc\")\n\nnameFile = \"namefile.pdf\"\n\nIf pdf1.Open(nameFile) Then\n    Set jso = pdf1.GetJSObject\n    Set page = pdf1.AcquirePage(pdf1.GetNumPages() - 1)\n\n    'These values were found from some tests I did, there is no logic behind them\n    acroRect.bottom = 22\n    acroRect.Left = 35      \n    acroRect.Right = 785    \n    acroRect.Top = 589     \n\n    page.CropPage (acroRect)\n\n    exportCroppedPDF = \"pathAndNamefile.pdf\"\n\n    s = jso.extractPages(0, pdf1.GetNumPages() - 1, exportCroppedPDF)\n\nElse\n    Debug.Print (\"Can't open the file!\")\nEnd If\n\npdf1.Close\nSet pdf1 = Nothing\nSet acroRect = Nothing\nSet jso = Nothing\nSet page = Nothing\n\nDebug.Print (\"Crop successful\")\n</code></pre>\n\n<p>I am not cumfortable at all with this library (the code comes from pieces of code I found on the Internet) so I might have wrote some wrong lines (but it initialy works).\nThanks a lot for your help!</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1529484017, "post_id": 50942298, "comment_id": 88885124, "body": "You can&#39;t have everything as one string as you are trying to combine formula and vba variable. The question is, what do you want to have in your output? Is it formula in <code>cell(I,4)</code> or just the result of the formula?"}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1529487097, "creation_date": 1529487097, "answer_id": 50944841, "question_id": 50942298, "link": "https://stackoverflow.com/questions/50942298/vlookup-between-two-workbooks-combined-with-isna-function-run-time-error-1004/50944841#50944841", "title": "VLookup between two workbooks combined with ISNA function. Run-time Error &#39;1004&#39;: Application defined or object defined error", "body": "<p>You are mixing VBA pieces into an Excel formula - that will not work. Excel does not know what <code>.Cells(i, 1).Value2</code> or <code>y</code> means, but that is what you write into the cell. VBA, on the other hand, doesn't replace <code>.Cells(i, 1).Value2</code> or <code>y</code> with the range itself as is it inside a constant string (within quotes), and VBA leaves those strings alone.</p>\n\n<p>So a first attempt would be to write (untested as I don't have your data, but you hopefully get the idea)</p>\n\n<pre><code>dim lookupAdr as string, f as string\nlookupAdr = \"[\" &amp; wb2.name &amp; \"]\" &amp; \"Sheet1!\" &amp; y.address\nf = \"=If(ISNA(VLookup(\" &amp; .Cells(i, 1).address &amp; \", \" _\n    &amp; lookupAdr &amp; \", 2, False)),0,VLookup( \" _\n    &amp; .Cells(i, 1).address &amp; \", \" &amp; lookupAdr &amp; \", 2, False))\"\nDebug.Print lookupAdr\nDebug.Print f\n.Cells(i, 4).formula = f\n</code></pre>\n\n<p>Note that I write the formula and the address of the lookup first into string variables - this helps to find errors. Note also that you should write formulas always to the property <code>.formula</code> of a cell, not to the <code>.value</code> property.</p>\n\n<p>However, there is room for improvement:\nUnless you are still on Excel 2003, you can use the <code>IFERROR</code> formula so that you don't have to repeat the <code>VLOOKUP</code>-part. This would lead to a much easier formula (again untested):</p>\n\n<pre><code> f = \"=IFERROR(VLookup( \" &amp; .Cells(i, 1).address &amp; \", \" &amp; lookupAdr &amp; \", 2, False), 0)\"\n</code></pre>\n\n<p>As a general rule when you try to create a formula within VBA, it is often helpfull to go the different way first: Write the final formula that you want to have into one cell, go to the VBA-Editor, open the <em>Immediate Window</em> (press <strong>[Ctrl]+[G]</strong>) and enter <code>? activecell.formula</code>. Then, write your code and compare the formula you create within VBA with the one you saw in the immediate window. </p>\n\n<p>And, as advice: Use <em>meaningfull</em> variable names. <code>y</code> is not really a good name for a range variable - use something like <code>lookupRange</code>. Everyone that will read the code (and that includes you!) will be thankfull.</p>\n"}], "owner": {"reputation": 3, "user_id": 9914135, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4o22YULXgik/AAAAAAAAAAI/AAAAAAAAG1Q/pX76Cvwx9yw/photo.jpg?sz=128", "display_name": "Mrinal Singh", "link": "https://stackoverflow.com/users/9914135/mrinal-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 401, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529487097, "creation_date": 1529478695, "last_edit_date": 1529479346, "question_id": 50942298, "link": "https://stackoverflow.com/questions/50942298/vlookup-between-two-workbooks-combined-with-isna-function-run-time-error-1004", "title": "VLookup between two workbooks combined with ISNA function. Run-time Error &#39;1004&#39;: Application defined or object defined error", "body": "<p>I am working on ws1 which is a worksheet in \"New\" workbook. it contains Bill No in column 1 and other relevant information in other columns.\nI want to Vlookup in another workbook called \"PDA\" and in that worksheet with sheet name \"Sheet1\" which has Bill no in Column F and the data that I want to copy in column G. If the Bill No is not present in PDA>Sheet1, then I want to return the value 0, because I have to sum the amount later.\nI have written this code, but it is giving error. Kindly help me with the issue.\nI am getting error in this line </p>\n\n<blockquote>\n  <p>.Cells(i, 4) = \"=If(ISNA(VLookup(.Cells(i, 1).Value2, y, 2,\n  False)),0,VLookup(.Cells(i, 1).Value2, y, 2, False))\"</p>\n</blockquote>\n\n<pre><code>Dim i As Long\nDim x As Range\nDim b As Range\nDim wb1 As Workbook\nDim ws1 As Worksheet\nSet wb1 = Workbooks.Open(\"C:\\Users\\mrisingh\\Desktop\\6-Eccs Billing List.xlsx\")\nSet x = wb1.Worksheets(\"Billing Sheet\").Range(\"B2:E100000\")\nSet ws1 = Workbooks(\"New\").Worksheets(\"Reconciliation\")\nWith ws1\nFor i = 2 To .Cells(Rows.Count, 1).End(xlUp).Row\n.Cells(i, 3) = Application.VLookup(.Cells(i, 1).Value2, x, 4, False)\nNext i\nEnd With\nSet b = wb1.Worksheets(\"Billing Sheet\").Range(\"B2:K100000\")\nWith ws1\nFor i = 2 To .Cells(Rows.Count, 1).End(xlUp).Row\n.Cells(i, 9) = Application.VLookup(.Cells(i, 1).Value2, b, 10, False)\nNext i\nEnd With\nwb1.Close savechanges:=False\n\nDim y As Range\nDim wb2 As Workbook\nSet wb2 = Workbooks.Open(\"C:\\Users\\mrisingh\\Desktop\\PDA.xlsx\")\nSet y = wb2.Worksheets(\"Sheet1\").Range(\"F845:G10000\")\nWith ws1\nFor i = 2 To .Cells(Rows.Count, 1).End(xlUp).Row\n.Cells(i, 4) = \"=If(ISNA(VLookup(.Cells(i, 1).Value2, y, 2, False)),0,VLookup(.Cells(i, 1).Value2, y, 2, False))\"\nNext i\nEnd With\nwb2.Close savechanges:=False\n</code></pre>\n"}, {"tags": ["vba", "excel", "color-palette"], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1529479715, "post_id": 50942161, "comment_id": 88882605, "body": "Can you guide me how to implement your answer in my code? I changed c=24 to c=ActiveWorkbook.Colors(10). For this I am getting Overflow error."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1529480661, "post_id": 50942161, "comment_id": 88883170, "body": "@AmanDevrath see my edit. The color index where the selected color is, is 10. If you use <code>Show(10)</code> then use <code>colorIndex = 10</code>."}, {"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1529480694, "post_id": 50942161, "comment_id": 88883191, "body": "I just had to change 1 line. Perfect. Thankyou so much. One question though, when the code colors the rows, the column lines goes away. is it possible that lines don&#39;t become invisible ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1529480836, "post_id": 50942161, "comment_id": 88883276, "body": "@AmanDevrath no, grid lines are only visible if there is no color otherwise you need to draw your own borders (but this is another question). If this answer solved your issue please mark it as solution."}, {"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1529481175, "post_id": 50942161, "comment_id": 88883474, "body": "Okay. I&#39;m fine with this. Thank you for your efforts. :)"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1529480242, "last_edit_date": 1529480242, "creation_date": 1529478144, "answer_id": 50942161, "question_id": 50941903, "link": "https://stackoverflow.com/questions/50941903/find-colorindex-from-palette-for-coloring-rows-when-value-changes-vba/50942161#50942161", "title": "Find colorindex from palette for coloring rows when value changes VBA", "body": "<p>The <code>Dialogs(xlDialogEditColor)</code> returns <code>True = -1</code> if a color was selected and <code>False = 0</code> if the user pressed cancel. To get the selected color use <code>ActiveWorkbook.Colors(10)</code> like in the example below.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ColorPaletteDialogBox()\n    Dim lcolor As Long\n    If Application.Dialogs(xlDialogEditColor).Show(10) = True Then\n      'user pressed OK\n      lcolor = ActiveWorkbook.Colors(10)\n      ActiveCell.Interior.Color = lcolor\n    Else\n      'user pressed Cancel\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>So for your loop you could use something like \u2026</p>\n\n<pre><code>Option Explicit\n\nPublic Sub HighLightRows()\n    Dim c As Integer\n    c = 2       'Color 1\n\n    Dim i As Long 'integer is too small for row counting!\n    i = 2\n\n    If Application.Dialogs(xlDialogEditColor).Show(10) = True Then\n        Do While (Cells(i, 1) &lt;&gt; \"\")\n            If (Cells(i, 1) &lt;&gt; Cells(i - 1, 1)) Then 'check for different value in cell A (index=1)\n                If c = 2 Then\n                    c = 10   'color 2\n                Else\n                    c = 2   'color 1\n                End If\n            End If\n\n            Rows(Trim(Str(i)) + \":\" + Trim(Str(i))).Interior.colorIndex = c\n            i = i + 1\n        Loop\n    Else\n      'user pressed Cancel\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 50942161, "answer_count": 1, "score": 0, "last_activity_date": 1529480242, "creation_date": 1529477341, "question_id": 50941903, "link": "https://stackoverflow.com/questions/50941903/find-colorindex-from-palette-for-coloring-rows-when-value-changes-vba", "title": "Find colorindex from palette for coloring rows when value changes VBA", "body": "<p>Code:</p>\n\n<pre><code>Public Sub HighLightRows()\n    Dim i As Integer\n    i = 2\n    Dim c As Integer\n    c = 2       'Color 1\n\n    'Dim colorIndex As XlColorIndex: colorIndex = Application.Dialogs(xlDialogEditColor).Show(10)\n    'MsgBox colorIndex\n\n    Do While (Cells(i, 1) &lt;&gt; \"\")\n        If (Cells(i, 1) &lt;&gt; Cells(i - 1, 1)) Then 'check for different value in cell A (index=1)\n            If c = 2 Then\n                c = 24   'color 2\n            Else\n                c = 2   'color 1\n            End If\n        End If\n\n        Rows(Trim(Str(i)) + \":\" + Trim(Str(i))).Interior.colorIndex = c\n        i = i + 1\n    Loop\n    End Sub\n</code></pre>\n\n<p>This code works perfectly and changes color when value in the column changes. But the colors are specified in the code. I want the user to select color of his/her choice.<br></p>\n\n<p>Output that I am getting with above code:<br>\n<a href=\"https://i.stack.imgur.com/hUnxY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hUnxY.jpg\" alt=\"enter image description here\"></a>\n<br><br>\n<strong>What I want the code to do:</strong><br>\nOpen the color palette.<br>User selects a color.<br>Color index is passed to a variable.<br>When value changes, rows is colored alternatively with white &amp; the color selected.\n<br>Eg. if user selects blue from palette, the rows will be blue &amp; white with alternate groups.if user selects green from palette, the rows will be green &amp; white with alternate groups.<br><br>\nI tried including this code :</p>\n\n<pre><code>Dim colorIndex As XlColorIndex: colorIndex = Application.Dialogs(xlDialogEditColor).Show(10)\nMsgBox colorIndex\n</code></pre>\n\n<p>palette opens up perfectly, but <code>MsgBox colorIndex</code> gives me -1 as output.</p>\n\n<p>I cant seem to get this to work. Any change in code.?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1529475916, "post_id": 50941532, "comment_id": 88880679, "body": "Have multiple IE windows open at the same time and cycle through each window adding the info relevant ie user name to all then password etc."}, {"owner": {"reputation": 550, "user_id": 6033621, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8e6417baa8a28b778d77066a60a5a83?s=128&d=identicon&r=PG&f=1", "display_name": "GuyWithCookies", "link": "https://stackoverflow.com/users/6033621/guywithcookies"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1529476170, "post_id": 50941532, "comment_id": 88880795, "body": "@SolarMike I don&#39;t see how this comment solves my question. I already wrote that spinning up multiple instances is needed to solve this issue - my question was    on HOW to do this with Excel VBA"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1529476317, "post_id": 50941532, "comment_id": 88880881, "body": "You wrote that each instance is opened, written then closed... I made the point that you can have several open at the same time and write the same info to each ie using a loop. If you are expecting someone to write the code then just give it to you ... good luck. Most people who post on here show effort in what they have built so far and then they get help..."}, {"owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "edited": false, "score": 0, "creation_date": 1529476566, "post_id": 50941532, "comment_id": 88881005, "body": "As you cannot open multiple IE instances in parallel via VBA, and you cannot fill each IE instance of a theoretical set of instances at the same time, how should that be possible. You did not provide any code, but somehow I assume you declared variables e.g. for username etc., and use that to fill each form, true? I dealt with similar issues, but to my knowledge, you cannot solve that other than looping each time."}, {"owner": {"reputation": 550, "user_id": 6033621, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8e6417baa8a28b778d77066a60a5a83?s=128&d=identicon&r=PG&f=1", "display_name": "GuyWithCookies", "link": "https://stackoverflow.com/users/6033621/guywithcookies"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1529476841, "post_id": 50941532, "comment_id": 88881122, "body": "@SolarMike I&#39;m not expecting someone to write code for me. My problem here is that afaik running multiple IE instances and filling them at once would require some kind of multi-threading. So my question was adressing this kind of general problem. Offending you was not the intention of my first comment - I apologize if it did."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1529498995, "post_id": 50941532, "comment_id": 88894844, "body": "Create some quantity of IE instances and put them into array. Loop through the array multiply times, check if IE state is ready then start to submit next user&#39;s data, and continue with the next IE instance immediately. Continue looping until all users&#39; data submit. If necessary close and open the IE instance before new submitting. Be aware that there could be cookies interference that might not allow the webpages to work in right way simultaneously. Then you may resort to an HTTP request with cookies processing, i. e. <code>MSXML2.ServerXMLHTTP</code> or <code>WinHttp.WinHttpRequest.5.1</code>."}, {"owner": {"reputation": 550, "user_id": 6033621, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8e6417baa8a28b778d77066a60a5a83?s=128&d=identicon&r=PG&f=1", "display_name": "GuyWithCookies", "link": "https://stackoverflow.com/users/6033621/guywithcookies"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1529558164, "post_id": 50941532, "comment_id": 88918454, "body": "@omegastripes ok thank you this is the best approach You can put your comment as an answer and I will mark it as correct"}], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 1, "last_activity_date": 1529562152, "creation_date": 1529562152, "answer_id": 50961668, "question_id": 50941532, "link": "https://stackoverflow.com/questions/50941532/fill-multiple-ie-webforms-in-parallel-with-excel/50961668#50961668", "title": "Fill multiple IE WebForms in parallel with Excel", "body": "<p>Create some quantity of IE instances and put them into array. Loop through the array multiply times, check if IE instance's state is ready then start to submit next user's data, and continue with the next IE instance immediately. Continue looping until all users' data uploaded. If necessary close and open the IE instance before new submitting. Do not forget to add <code>DoEvents</code> statement into the loop.</p>\n\n<p>Be aware that there could be cookies interference, etc. that might not allow the webpages to work in right way simultaneously. Then you may resort to an HTTP request approach with cookies processing, i. e. <code>MSXML2.ServerXMLHTTP</code> or <code>WinHttp.WinHttpRequest.5.1</code>.</p>\n"}], "owner": {"reputation": 550, "user_id": 6033621, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8e6417baa8a28b778d77066a60a5a83?s=128&d=identicon&r=PG&f=1", "display_name": "GuyWithCookies", "link": "https://stackoverflow.com/users/6033621/guywithcookies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 50961668, "answer_count": 1, "score": 1, "last_activity_date": 1529562152, "creation_date": 1529475832, "last_edit_date": 1531161705, "question_id": 50941532, "link": "https://stackoverflow.com/questions/50941532/fill-multiple-ie-webforms-in-parallel-with-excel", "title": "Fill multiple IE WebForms in parallel with Excel", "body": "<p>I'm developing an Excel Macro (VBA) which automatically fills an Internet Explorer WebForm with some user data from an Excel Sheet. </p>\n\n<p>Currently the Script works sequentiell. So an IE instance is spinned up, the form is filled with the user data and submited. After that the IE instance is closed. The process will be repeated until all users are processed.</p>\n\n<p>To speed up the process it would be better to spin up multiple IE instances at once and fill the user data in parallel. \nSo how can I run multiple processes/IE instances in VBA?</p>\n"}, {"tags": ["excel", "vba", "structure"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529474258, "post_id": 50941131, "comment_id": 88880002, "body": "Not enough code - it would help to show at least one pair of get/set methods..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529474399, "post_id": 50941131, "comment_id": 88880065, "body": "<code>Set xArray(index) = value</code> since this is an object you&#39;re assigning here.  No need to populate xArray with empty dataStruct&#39;s inside <code>constructor</code>"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529474809, "post_id": 50941131, "comment_id": 88880247, "body": "@TimWilliams Added two examples of get and set"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529475015, "post_id": 50941131, "comment_id": 88880335, "body": "@TimWilliams Thanks! Thought I did that at the beginning but must have missed testing it again after changing the constructor. But it all works now! Do you know another way to create a constructor too, right now it feels primitive to call it with &quot;dData.constructor(100)&quot;  but I don&#39;t know any other way to do it?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529475145, "post_id": 50941131, "comment_id": 88880377, "body": "There&#39;s no built-in constructor which can have arguments (Initialize doesn&#39;t have any).  I typically use a Sub called <code>Init()</code> if I need something like that.  See also: <a href=\"https://stackoverflow.com/questions/15224113/pass-arguments-to-constructor-in-vba\" title=\"pass arguments to constructor in vba\">stackoverflow.com/questions/15224113/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 0, "last_activity_date": 1529474825, "creation_date": 1529474825, "answer_id": 50941318, "question_id": 50941131, "link": "https://stackoverflow.com/questions/50941131/vba-object-type-inside-of-object-type/50941318#50941318", "title": "VBA Object type inside of Object type", "body": "<p>Simply add a method into each Class that either outputs as the other class, or takes an input as the other class. You haven't listed any properties, so I am going to guess how you get values out.</p>\n\n<p>For example, in Data Class</p>\n\n<pre><code>Sub ConvertFromList(values as List)\n    Redim data (0 to values.data.count)\n    For iterator = 0 to values.data.count\n        data(itearator) = values.data(iterator)\n    Next iterator\nEnd Sub\n</code></pre>\n\n<p>My example is not pretty, nor complete - but not much information was provided to start with.  But it does give you an idea what can be done. </p>\n\n<p>A neat solution will be a <code>Function</code> within the Class that exports as <code>Data</code>/<code>List</code> as the case may be.</p>\n"}], "owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529474825, "creation_date": 1529473912, "last_edit_date": 1592644375, "question_id": 50941131, "link": "https://stackoverflow.com/questions/50941131/vba-object-type-inside-of-object-type", "title": "VBA Object type inside of Object type", "body": "<p>I'm having some trouble of understanding on how to make my own type object.\nI have two different classes and I would like that my list type to be given the object of the data type.</p>\n<p>data Class: (Be aware that this is just a snippet of the code)</p>\n<pre><code>Private index As Integer\nPrivate id As String\nPrivate nameID() As String\nPrivate data() As String\nPrivate cnt As Integer\n\nPublic Function constructor(value As Integer)\n    index = 0\n    cnt = value\n    id = &quot;&quot;\n    ReDim nameID(0 To cnt)\n    ReDim data(0 To cnt)\nEnd Function\n\nProperty Let setName(value As String)\n    nameID(index) = value\nEnd Property\n\nProperty Let setData(value As String)\n    data(index) = value\n    index = index + 1\nEnd Property\n\nProperty Get getName()\n    getName = nameID\nEnd Property\n\nProperty Get getData()\n    getData = data\nEnd Property\n</code></pre>\n<p>list Class:</p>\n<pre><code>Private xArray() As dataStruct\nPrivate index As Integer\n\nPublic Function constructor(cnt As Integer)\n    ReDim xArray(1 To cnt)\n    Dim num As Integer\n    For num = 1 To cnt\n    Set xArray(num) = New dataStruct\n    'xArray(num).constructor(10)\n    Next\n    index = 1\nEnd Function\n</code></pre>\n<p>So the problem I have occurs when I try to get the values from my data class to my list class. I have tried to set them equal each other and assign each value separately but nothing seems to work. I get the &quot;Run-time error '438: Object doesn't support this property or method'. If I try to use the commented code I get past the <code>setID</code> but when entering <code>setName</code> it comes a type mismatch but it should be an array of type string.</p>\n<pre><code>Property Let addArray(value As dataStruct)\n    xArray(index) = value\n    'xArray(index).setID = value.getID\n    'xArray(index).setName = value.getName\n    'xArray(index).setData = value.getData\n    'xArray(index).setCnt = value.getCnt\n    index = index + 1\nEnd Property\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/YSZct.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YSZct.png\" alt=\"list\" /></a></p>\n<p>[Edited: Added example of get and set methods]</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "edited": false, "score": 0, "creation_date": 1529469553, "post_id": 50940143, "comment_id": 88878438, "body": "It looks like a similar question has been posted before, Run Time Error 462 has to do with unqualified references to Word objects when you&#39;re working in Excel VBA. Have a read through the answers, if you fix your references, the error should go away. Check out the similar question here: <a href=\"https://stackoverflow.com/questions/26030584/running-into-error-462-the-remote-server-machine-does-not-exist-when-working-wi\" title=\"running into error 462 the remote server machine does not exist when working wi\">stackoverflow.com/questions/26030584/&hellip;</a>"}, {"owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "edited": false, "score": 2, "creation_date": 1529469627, "post_id": 50940143, "comment_id": 88878460, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26030584/running-into-error-462-the-remote-server-machine-does-not-exist-when-working-wi\">Running into Error 462: The remote server machine does not exist when working with WORD via Excel VBA</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1529469708, "post_id": 50940143, "comment_id": 88878479, "body": "Try <code>For Each objTable In wrdApp.ActiveDocument.Tables</code>"}, {"owner": {"reputation": 11, "user_id": 9889698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212098349075801/picture?type=large", "display_name": "Shelnes Elie", "link": "https://stackoverflow.com/users/9889698/shelnes-elie"}, "edited": false, "score": 0, "creation_date": 1529529461, "post_id": 50940143, "comment_id": 88911708, "body": "Thank you so much Tim. It worked. Such a simple fix but I\u2019m still new to VBA. Appreciate it!"}], "owner": {"reputation": 11, "user_id": 9889698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212098349075801/picture?type=large", "display_name": "Shelnes Elie", "link": "https://stackoverflow.com/users/9889698/shelnes-elie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 530, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529492397, "creation_date": 1529468298, "last_edit_date": 1529492397, "question_id": 50940143, "link": "https://stackoverflow.com/questions/50940143/run-time-error-462", "title": "Run-Time Error &#39;462&#39;", "body": "<p>I am trying to run a macro from excel that will open up an existing word document, populate the fields from excel to word via content controls, and paste/format a table into the word document at a certain location. About 20% of the time, I'll get this Run Time Error 462 stating \"The remote Server Machine Does Not Exist or is Unavailable\". I will provide the code and the section where is usually gets stuck at as everything after works 100% of the time. Please help on this.</p>\n\n<pre><code>Public Sub Agreement()\n    With Sheets(\"Price List Table\")\n        .ListObjects(1).Name = \"Table1\"\n    End With\n\n    Dim tbl As Excel.Range    \n    Dim wrdApp    \n    Dim wrdDoc       \n    Dim WordTable As Word.Table       \n    Dim c As Integer\n\n    Set tbl = ThisWorkbook.Worksheets(Sheet2.Name).ListObjects(\"Table1\").Range    \n    Set wrdApp = CreateObject(\"Word.Application\")\n\n    wrdApp.Visible = False\n\n    Set wrdDoc = wrdApp.Documents.Open(\"C:\\Users\\Documents\\Example\")       \n    With wrdDoc       \n        tbl.Copy    \n        wrdApp.Selection.Find.Text = \"This is the section for the table to be pasted below it.\"    \n        wrdApp.Selection.Find.Execute   \n        wrdApp.Selection.MoveDown Unit:=wdLine, Count:=5, Extend:=wdMove    \n        wrdApp.Selection.PasteExcelTable False, False, False\n\n        Dim objTable As Object    \n        For Each objTable In ActiveDocument.Tables ' (This is where the error occurs)\n            objTable.AutoFitBehavior (wdAutoFitWindow)\n            objTable.AllowAutoFit = True\n        Next\n\n        wrdApp.Selection.GoTo wdGoToPage, wdGoToAbsolute, 1\n        wrdApp.Selection.GoTo What:=wdGoToTable, Which:=GoToNext\n        wrdApp.Selection.GoTo What:=wdGoToTable, Which:=GoToNext\n        wrdApp.Selection.GoTo What:=wdGoToTable, Which:=GoToNext\n        wrdApp.Selection.Tables(1).Select\n\n        With wrdApp.Selection.Borders(wdBorderTop)\n            .LineStyle = Options.DefaultBorderLineStyle\n            .LineWidth = Options.DefaultBorderLineWidth\n            .Color = Options.DefaultBorderColor\n        End With\n        With wrdApp.Selection.Borders(wdBorderLeft)\n            .LineStyle = Options.DefaultBorderLineStyle\n            .LineWidth = Options.DefaultBorderLineWidth\n            .Color = Options.DefaultBorderColor\n        End With\n        With wrdApp.Selection.Borders(wdBorderBottom)\n            .LineStyle = Options.DefaultBorderLineStyle\n            .LineWidth = Options.DefaultBorderLineWidth\n            .Color = Options.DefaultBorderColor\n        End With\n        With wrdApp.Selection.Borders(wdBorderRight)\n            .LineStyle = Options.DefaultBorderLineStyle\n            .LineWidth = Options.DefaultBorderLineWidth\n            .Color = Options.DefaultBorderColor\n        End With\n        With wrdApp.Selection.Borders(wdBorderHorizontal)\n            .LineStyle = Options.DefaultBorderLineStyle\n            .LineWidth = Options.DefaultBorderLineWidth\n            .Color = Options.DefaultBorderColor\n        End With\n        With wrdApp.Selection.Borders(wdBorderVertical)\n            .LineStyle = Options.DefaultBorderLineStyle\n            .LineWidth = Options.DefaultBorderLineWidth\n            .Color = Options.DefaultBorderColor\n        End With\n\n        wrdApp.Selection.Tables(1).Columns(3).Select\n        wrdApp.Selection.ParagraphFormat.Alignment = wdAlignParagraphRight\n        wrdApp.Selection.Tables(1).Columns(4).Select\n        wrdApp.Selection.ParagraphFormat.Alignment = wdAlignParagraphRight\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "tab-ordering"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1529492183, "post_id": 50939997, "comment_id": 88890361, "body": "MS Forms controls are ActiveX controls. Besides being available in UserForms, they can also be placed on the document surface. I&#39;m assuming you mean these, since the screen shot you showed in a different post was for such a control. But before we start thinking about it, please confirm that you&#39;re using these controls and not ones you&#39;ve added to the Toolbox. And you&#39;ve placed these on teh document surface? Inline with the text or with text wrap formatting?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1529492186, "post_id": 50939997, "comment_id": 88890366, "body": "Please note also that <i>form fields</i> in Word are something very specific and that is NOT ActiveX controls. Using the term &quot;form field&quot; in your question is extremely misleading."}, {"owner": {"reputation": 658, "user_id": 4329070, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh3.googleusercontent.com/-B5nAaBZy1nU/AAAAAAAAAAI/AAAAAAAAAno/zdzEuI_nelk/photo.jpg?sz=128", "display_name": "Abdullah Mamun-Ur- Rashid", "link": "https://stackoverflow.com/users/4329070/abdullah-mamun-ur-rashid"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1529494982, "post_id": 50939997, "comment_id": 88892058, "body": "Hello Cindy Meister, I can assure you that I have used ActiveX controls. Procedure was: Open a new ms word file(A4 Portrait)&gt;Developer Tab&gt;Design Mode&gt;ActiveX Controls&gt;Placed on the page. I didn&#39;t use labels for Controls such as text box, instead I used plain text as in normal document of ms word. I have updated my topic with screenshot of tools (ActiveX) that I used in forms."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1529495491, "post_id": 50939997, "comment_id": 88892424, "body": "Yes, these are the same controls as used in MS Forms (press Alt+F9 to toggle the underlying field code and you&#39;ll see they belong to the class <code>Forms</code>), and these are <i>not</i> form fields - form fields are the &quot;Legacy Forms&quot; listing. So, no text wrap formatting..."}], "answers": [{"comments": [{"owner": {"reputation": 658, "user_id": 4329070, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh3.googleusercontent.com/-B5nAaBZy1nU/AAAAAAAAAAI/AAAAAAAAAno/zdzEuI_nelk/photo.jpg?sz=128", "display_name": "Abdullah Mamun-Ur- Rashid", "link": "https://stackoverflow.com/users/4329070/abdullah-mamun-ur-rashid"}, "edited": false, "score": 0, "creation_date": 1529508291, "post_id": 50948095, "comment_id": 88901217, "body": "Thanks for your hardwork and code. very much disappointed to know that there is no simple workaround. I don&#39;t like form control as it&#39;s text box is flat, doesn&#39;t look like traditional text box. Anyway, I am giving you Upvote for your hard work and try. Thanks again."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 2, "last_activity_date": 1529497099, "creation_date": 1529497099, "answer_id": 50948095, "question_id": 50939997, "link": "https://stackoverflow.com/questions/50939997/how-to-set-tab-order-by-a-macro-in-ms-word/50948095#50948095", "title": "How to set tab order by a macro in MS Word?", "body": "<p>You aren't going to be any happier with this answer than you were with my last...</p>\n\n<p>The problem is that the keypress, or KeyDown, is only triggered by the fact that the focus is <em>in</em> an ActiveX control, and will be specific to that control. So you have no choice than a KeyDown event for every control. You can keep the code in the event to a minimum, but...</p>\n\n<p>There's no way to identify controls on a document surface directly by name as a <em>string</em>. <code>ThisDocument.ControlName</code> is possible, but there's nothing like ThisDocument.Controls(\"ControlName\") available that would let you substitute names, nor allow you to identify the name of the current control.</p>\n\n<p>There is a way to do it, but it's convoluted. Since these are in-line with the text (no text wrapping) they belong to the document's <code>InlineShapes</code> collection. Their programming interface can only be addressed through the InlineShape's <code>OLEFormat.Object</code> property. This means the code needs to loop the InlineShapes collection <em>twice</em>: once to identify the ActiveX control where the key was pressed, once to identify the control which should be next.</p>\n\n<p>The following code illustrates the principle. What it does <em>not</em> do is</p>\n\n<ul>\n<li>work for more than 9 controls - that would require code that checks, from the right of the name, how many characters are numerical</li>\n<li>go back to the first control if focus is in the last</li>\n</ul>\n\n<p>Note that it <em>might</em> be possible to get around event code for each control. It would involve using the Windows API, which means it would fire <em>every time</em> the user presses Tab. But I have no idea whether the key presses would be captured when focus is inside a control. And you would have to test each time if this is the case - and you'd still have to be able to identify which control the focus is in.</p>\n\n<pre><code>Private Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    GoToNextControl KeyCode, ThisDocument.TextBox1.Name\nEnd Sub\n\n\nPrivate Sub TextBox2_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    GoToNextControl KeyCode, ThisDocument.TextBox2.Name\nEnd Sub\n\nSub GoToNextControl(KeyCode As MSForms.ReturnInteger, controlName As String)\n    Dim ils As Word.InlineShape, ils2 As Word.InlineShape\n    Dim c As MSForms.Control\n    Dim baseName As String, nextName\n    Dim nameCounter As Long\n    baseName = Mid(controlName, 1, Len(controlName) - 1)\n    nameCounter = Right(controlName, 1)\n\n    If KeyCode = 9 Then\n        For Each ils In ThisDocument.InlineShapes\n            If ils.Type = wdInlineShapeOLEControlObject Then\n                If ils.OLEFormat.Object.Name = controlName Then\n                    nextName = baseName &amp; nameCounter + 1\n                    For Each ils2 In ThisDocument.InlineShapes\n                       If ils2.Type = wdInlineShapeOLEControlObject Then\n                           If ils2.OLEFormat.Object.Name = nextName Then\n                                ils2.Select\n                                Exit Sub\n                            End If\n                        End If\n                    Next\n                End If\n            End If\n        Next\n    End If\nEnd Sub\n</code></pre>\n\n<p>All-in-all it might make more sense to stick to the legacy form fields or to content controls, or move this to a UserForm that then writes to the document.</p>\n"}], "owner": {"reputation": 658, "user_id": 4329070, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh3.googleusercontent.com/-B5nAaBZy1nU/AAAAAAAAAAI/AAAAAAAAAno/zdzEuI_nelk/photo.jpg?sz=128", "display_name": "Abdullah Mamun-Ur- Rashid", "link": "https://stackoverflow.com/users/4329070/abdullah-mamun-ur-rashid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529509901, "creation_date": 1529467158, "last_edit_date": 1529509901, "question_id": 50939997, "link": "https://stackoverflow.com/questions/50939997/how-to-set-tab-order-by-a-macro-in-ms-word", "title": "How to set tab order by a macro in MS Word?", "body": "<p>I have a MS Word form with ActiveX control (not the form control). Suppose I have two textboxes and two option button as follows:</p>\n\n<pre><code>Name: [textBox1]\nAddress: [textBox2]\nGender: [opt1] Male [opt2] Female\n</code></pre>\n\n<p>Now if I want a tab order, I have to add following macro:</p>\n\n<pre><code>Private Sub textBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\nIf KeyCode = 9 Then\ntextBox2.Activate\nEnd If\nEnd Sub\n\nPrivate Sub textBox2_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\nIf KeyCode = 9 Then\nopt1.Activate\nEnd If\nEnd Sub\n\nPrivate Sub opt1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\nIf KeyCode = 9 Then\nopt2.Activate\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Now in my real form there are 20 text boxes and 12 option buttons, so it is quite boring to write down keydown event for each form field. How can I write a macro so that it will first get the name of current form field on keydown (and validating it as tab keydown) and then go to next form field?</p>\n\n<p>For the sake of tab order, I will then rename all form field chronologically such as field1, field2, field3......... etc, so that with an increment the code can move the tab to next form field.</p>\n\n<p>Here is the screen shot of ActiveX tools those I used in forms:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UsTbA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UsTbA.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have <a href=\"http://www.vbaexpress.com/forum/showthread.php?63007-How-to-set-tab-order-by-a-macro-in-ms-word&amp;p=381290#post381290\" rel=\"nofollow noreferrer\">cross-posted this topic</a> to VbaExpress forum also.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 1, "creation_date": 1529467103, "post_id": 50939710, "comment_id": 88877879, "body": "It will perform the same in a faster and more reliable way without <code>Select</code>: <code>Columns(&quot;A:A&quot;).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = &quot;=R[-1]C&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "is_accepted": false, "score": 1, "last_activity_date": 1529466880, "creation_date": 1529466880, "answer_id": 50939965, "question_id": 50939710, "link": "https://stackoverflow.com/questions/50939710/fill-blanks-with-top-cell/50939965#50939965", "title": "Fill blanks with top cell", "body": "<p><strong>This is how the code works:</strong></p>\n\n<p>Select the entire column A</p>\n\n<pre><code>Columns(\"A:A\").Select\n</code></pre>\n\n<p>Now select just the blank cells in column A</p>\n\n<pre><code>Selection.SpecialCells(xlCellTypeBlanks).Select\n</code></pre>\n\n<p>Now for every cell we've selected (all the blank cells in column A), input a formula.\nThe formula roughly equates to: \"Equals to the cell immediately above this cell.\"</p>\n\n<pre><code>Selection.FormulaR1C1 = \"=R[-1]C\"\n</code></pre>\n\n<p>The formula is using a relative cell reference, and it literally translates to \"Equals Row-1, same Column.\"</p>\n"}], "owner": {"reputation": 35, "user_id": 9900677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f338f1bad02404afff751c31791b879a?s=128&d=identicon&r=PG&f=1", "display_name": "Tevin", "link": "https://stackoverflow.com/users/9900677/tevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529466880, "creation_date": 1529464952, "question_id": 50939710, "link": "https://stackoverflow.com/questions/50939710/fill-blanks-with-top-cell", "title": "Fill blanks with top cell", "body": "<p>Given the following code, I would like to understand how it works:</p>\n\n<pre><code>    Columns(\"A:A\").Select\nSelection.SpecialCells(xlCellTypeBlanks).Select\nSelection.FormulaR1C1 = \"=R[-1]C\"\n</code></pre>\n\n<p>So what it currently does is it takes the top cell of the row and auto fills it down with formula =A1 relative to that cell on all blank cells below it. </p>\n\n<p>However it stops at the next cell that contains a value and does the same treatment down all the cells below it till the next.</p>\n\n<p>How does this work exactly? How does vba knows to take the formula from the cell above the blanks and not just from the first cell of the column? </p>\n\n<p>Much help is appreciated! </p>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 39, "user_id": 9939182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tkllR992FuE/AAAAAAAAAAI/AAAAAAAAEy4/dZdzFaREFas/photo.jpg?sz=128", "display_name": "Justin Sun", "link": "https://stackoverflow.com/users/9939182/justin-sun"}, "edited": false, "score": 0, "creation_date": 1529464194, "post_id": 50939486, "comment_id": 88877329, "body": "I know that ADODB could solve this problem, I am just curious how to solve this by using the trditional AddFromFile method."}], "owner": {"reputation": 39, "user_id": 9939182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tkllR992FuE/AAAAAAAAAAI/AAAAAAAAEy4/dZdzFaREFas/photo.jpg?sz=128", "display_name": "Justin Sun", "link": "https://stackoverflow.com/users/9939182/justin-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529462902, "creation_date": 1529462902, "question_id": 50939486, "link": "https://stackoverflow.com/questions/50939486/linking-multiple-source-from-access-database-to-excel-file-in-vba", "title": "Linking multiple source from Access database to Excel file in VBA", "body": "<p>I am trying to link two tables in Access to my Excel. One is Table_1 and the other is Table 2. But when I ran these codes, the two imported tables are linked to the same source, or say the same data source is imported twice. I tried to solve this problem by deleting the connection and re-connect it. But it does not work. The recorded macro use a line<code>Selection.ListObject.TableObject.Refresh</code>. But the system poped out an error stating that the object is not set when re-running the macro. Full code is below.</p>\n\n<p>I would like to ask how to release the object and connect to another table under this case.</p>\n\n<pre><code>Sub Macro1()\n\n\nSheets(\"S6_Inforce\").Select\nRange(\"B1\").Select\nWorkbooks(\"Lapse1709_ANALYSIS_v1_S6.xlsm\").Connections.AddFromFile _\n    \"C:\\Users\\j1sunx\\Desktop\\201709_Lapse_redo\\Step1_Analysis\\Lapse Study 201709 S6.accdb\" _\n    , True, False\nWith ActiveSheet.ListObjects.Add(SourceType:=4, Source:=ActiveWorkbook. _\n    Connections(\"Lapse Study 201709 S6\"), Destination:=Range(\"$B$1\")). _\n    TableObject\n    .RowNumbers = False\n    .PreserveFormatting = True\n    .RefreshStyle = 1\n    .AdjustColumnWidth = True\n    .ListObject.DisplayName = \"Table__1__S6_Inforce_Summary\"\n    .Refresh\nEnd With\nSheets(\"S6_Terminated\").Select\nRange(\"B1\").Select\nActiveWorkbook.Connections(\"Lapse Study 201709 S6\").Delete\n' Workbooks(\"Lapse1709_ANALYSIS_v1_S6.xlsm\").Connections.Delete\n' Selection.ListObject.TableObject.Refresh\nWorkbooks(\"Lapse1709_ANALYSIS_v1_S6.xlsm\").Connections.AddFromFile _\n    \"C:\\Users\\j1sunx\\Desktop\\201709_Lapse_redo\\Step1_Analysis\\Lapse Study 201709 S6.accdb\" _\n    , True, False\nWith ActiveSheet.ListObjects.Add(SourceType:=4, Source:=ActiveWorkbook. _\n    Connections(\"Lapse Study 201709 S6\"), Destination:=Range(\"$B$1\")). _\n    TableObject\n    .RowNumbers = False\n    .PreserveFormatting = True\n    .RefreshStyle = 1\n    .AdjustColumnWidth = True\n    .ListObject.DisplayName = \"Table__2__S6_Terminations_Summary\"\n    .Refresh\nEnd With\nRange(\"F10\").Select\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9682546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ARUJPFQmXxE/AAAAAAAAAAI/AAAAAAAAAEg/TAFv4uyAbaE/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/9682546/max"}, "edited": false, "score": 0, "creation_date": 1529467289, "post_id": 50939869, "comment_id": 88877915, "body": "thank you alot, this works exactly as I needed it :)"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1529474957, "post_id": 50939869, "comment_id": 88880309, "body": "Do not use <code>Application.Volatile</code> unless absolutely needed. <code>Application.Volatile</code> is only useful for UDF."}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 1, "last_activity_date": 1529466202, "creation_date": 1529466202, "answer_id": 50939869, "question_id": 50939169, "link": "https://stackoverflow.com/questions/50939169/how-to-count-specific-char-in-vba/50939869#50939869", "title": "How to count specific char in vba", "body": "<p>I see multiple problems with your code:</p>\n\n<ul>\n<li>There is no assignment of return value to function, in my example <code>slova = charCnt</code>, so it wouldn't return anything besides default 0 no matter what.</li>\n<li>It lacks <code>Application.Volatile</code>, so the formula used in Excel cell would require navigating to cell and pressing ENTER to force an update when data in range changes.</li>\n<li>Function has an argument <code>iVal</code> which isn't used anywhere.</li>\n<li><code>Application.WorksheetFunction.CountIf</code> returns count of cells, so it is limited to 1 character per cell. On top of it, correctly specified argument would be <code>\"*\u017e*\"</code></li>\n</ul>\n\n<p>Here is my solution to count all occurrences of hardcoded character in hardcoded range (must have exactly 1 column).</p>\n\n<pre><code>Function slova() As Long\n\n    Application.Volatile\n\n    Dim vData As Variant\n    Dim rowCounter As Long, charCnt As Long\n    Const myLetter As String = \"\u017e\"\n\n    vData = Range(\"A2:A11\")\n\n    For rowCounter = LBound(vData) To UBound(vData)\n        If vData(rowCounter, 1) &lt;&gt; vbNullString Then\n            charCnt = charCnt + UBound(Split(vData(rowCounter, 1), myLetter))\n        End If\n    Next rowCounter\n\n    slova = charCnt\n\nEnd Function\n</code></pre>\n\n<p>As you use function, you can also take advantage of it and use source range as an argument, the same goes for character.</p>\n"}], "owner": {"reputation": 25, "user_id": 9682546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ARUJPFQmXxE/AAAAAAAAAAI/AAAAAAAAAEg/TAFv4uyAbaE/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/9682546/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 50939869, "answer_count": 1, "score": 1, "last_activity_date": 1529466202, "creation_date": 1529460318, "last_edit_date": 1531164843, "question_id": 50939169, "link": "https://stackoverflow.com/questions/50939169/how-to-count-specific-char-in-vba", "title": "How to count specific char in vba", "body": "<p>So I need to count how many \u017e and \u010d are there in all of these fields.\nExample.\n<a href=\"http://prntscr.com/jwz1em\" rel=\"nofollow noreferrer\">http://prntscr.com/jwz1em</a></p>\n\n<p>I tryed with this code but it gives me 0 </p>\n\n<pre><code>Function slova(iVal)\nDim output As Integer\noutput = Application.WorksheetFunction.CountIf(Range(\"A2:A11\"), \"\u017e\")\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1529476332, "post_id": 50939082, "comment_id": 88880891, "body": "Appart from using <code>DCount(&quot;*&quot;, &quot;[tbl_VegMgnt_Management]&quot;, &quot;[circuit] = &#39;&quot; &amp; circuitName &amp; &quot;&#39;&quot;)</code>, your syntax is correct, thus something else must be going on."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1529874672, "post_id": 50939082, "comment_id": 89020666, "body": "That would be expected for expression in VBA setting a textbox value. Put the calc in ControlSource property of textbox."}, {"owner": {"reputation": 143, "user_id": 5843565, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c4b121d71a31bfe3b971584c3876b7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/5843565/jake"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1529978745, "post_id": 50939082, "comment_id": 89059968, "body": "@June7 Thank you for your advise.  <code>DCount([tbl_VegMgnt_Management]![_record_id], [tbl_VegMgnt_Management], &quot;[tbl_VegMgnt_Management]![_status] = &#39;Consent Required&#39;&quot;)</code>  Thats is the count I was going to do. I have never done this before and I get an error that states &quot;The specified table &quot;tbl_VegMgnt_Management&quot; could refer to more than one table listed in the from clause of your SQL statement.&quot;  Have you heard of this and if so what are your thoughts on the referencing"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1530125845, "post_id": 50939082, "comment_id": 89129274, "body": "Table and field names must be within quote marks. Why are you showing expression different from one in question?"}], "owner": {"reputation": 143, "user_id": 5843565, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c4b121d71a31bfe3b971584c3876b7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/5843565/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593955410, "creation_date": 1529459388, "last_edit_date": 1593955410, "question_id": 50939082, "link": "https://stackoverflow.com/questions/50939082/access-dcount-report", "title": "Access DCount Report", "body": "<p>I am trying to run a DCount function in a report for different circuit statistics. I am using this method to help limit the number of queries I am producing.</p>\n\n<p>This issue I am facing is the number of circuits. I have 2 circuits 1234 and 5678. When I view the report both names come up properly. when I use the DCount function though it takes the number from the last record.</p>\n\n<p>1234 should have 1 record\n5678 should have 216 records</p>\n\n<p>They are both reading 216 records.</p>\n\n<p>Does anyone know how to fix this?</p>\n\n<p>my DCount Function:</p>\n\n<p><code>Me.txt_CirCR = DCount(\"[_record_id]\", \"[tbl_VegMgnt_Management]\", \"[circuit] = '\" &amp; circuitName &amp; \"'\")</code></p>\n\n<p>Yes the circuits are supposed to be strings they are not always numeric</p>\n"}, {"tags": ["excel", "vba", "if-statement", "conditional-statements"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9964860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xN3f1POURW4/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2EMPCIAV9BHrHmJCeRdbfo2xog7A/mo/photo.jpg?sz=128", "display_name": "Felipe Romero", "link": "https://stackoverflow.com/users/9964860/felipe-romero"}, "edited": false, "score": 0, "creation_date": 1529466391, "post_id": 50939259, "comment_id": 88877738, "body": "Thank you, this helped me a lot"}], "tags": [], "owner": {"reputation": 586, "user_id": 9633414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17a4ec5f0dbe53ee0a2153b37138b17?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/9633414/j-doe"}, "is_accepted": false, "score": 0, "last_activity_date": 1529461036, "creation_date": 1529461036, "answer_id": 50939259, "question_id": 50938932, "link": "https://stackoverflow.com/questions/50938932/modify-columns-according-to-condition/50939259#50939259", "title": "modify columns according to condition", "body": "<p>This is not supposed to be a code writing forum. You are expected to show some effort.</p>\n\n<pre><code>Sub split_()\n\nDim P1 As Range\nRange(\"C1:D99999\").Clear\nSet P1 = Range(\"A1\").CurrentRegion\na = 1\n\nFor i = P1(1).Row To P1.Rows.Count\n    If P1(i, 2) &gt; 1 Then\n        For j = 1 To P1(i, 2)\n            Cells(a, 3) = P1(i, 1) &amp; \" (\" &amp; j &amp; \")\"\n            Cells(a, 4) = 1\n            a = a + 1\n        Next j\n    Else\n        Cells(a, 3) = P1(i, 1)\n        Cells(a, 4) = P1(i, 2)\n        a = a + 1\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9964860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xN3f1POURW4/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2EMPCIAV9BHrHmJCeRdbfo2xog7A/mo/photo.jpg?sz=128", "display_name": "Felipe Romero", "link": "https://stackoverflow.com/users/9964860/felipe-romero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1529485250, "creation_date": 1529457797, "last_edit_date": 1529485250, "question_id": 50938932, "link": "https://stackoverflow.com/questions/50938932/modify-columns-according-to-condition", "title": "modify columns according to condition", "body": "<p>Well I have the following problem, I have 2 columns as follows:</p>\n\n<pre><code> A B\n\"X\" 1\n\"Y\" 1\n\"Z\" 0\n\"W\" 2\n</code></pre>\n\n<p>What I want to do is find a way to create new columns C and D or better still, update columns A and B as follows:</p>\n\n<pre><code> C D\n\"X\" 1\n\"Y\" 1\n\"Z\" 0\n\"W (1)\" 1\n\"W (2)\" 1\n</code></pre>\n\n<p>Any suggestion or ideas on how can i do this will be much appreciated.</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9719677, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YZMUj.png?s=128&g=1", "display_name": "D.Martin", "link": "https://stackoverflow.com/users/9719677/d-martin"}, "edited": false, "score": 0, "creation_date": 1529551252, "post_id": 50939354, "comment_id": 88916787, "body": "thanks I implemented your tweaks and the code correctly creates a pivot table. Looking at the other questions I can see that when your data gets to large excel doesn&#39;t like passing your range. Thanks for your help!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1529468099, "last_edit_date": 1529468099, "creation_date": 1529461804, "answer_id": 50939354, "question_id": 50938733, "link": "https://stackoverflow.com/questions/50938733/vba-pivot-table-error-1004-refrence-is-not-valid/50939354#50939354", "title": "VBA Pivot Table; Error &#39;1004&#39; Refrence is not valid", "body": "<ol>\n<li>You can't create a pivot table from non-contiguous ranges like you're trying to do by excluding column G.</li>\n<li>Your Type Mismatch error is from trying to declare a <code>PivotCache</code> using a <code>Range</code> object for <code>SourceData</code>. <a href=\"https://stackoverflow.com/questions/50627908/run-time-error-5-invalid-procedure-call-or-argument-when-defining-pivot-cache\">This question</a>, or <a href=\"https://stackoverflow.com/questions/25606962/pivotcache-create-unable-to-handle-large-range\">this question</a>, shows you how to use a <code>String</code> reference.</li>\n<li><code>endCell</code> should be a <code>Long</code>, not an <code>Integer</code>. (Just a thought, maybe use <code>endRow</code> or some other name, <code>endCell</code> sounds like a <code>Range</code> variable and might be misleading.)</li>\n<li>Since <code>dataRange</code> is in a different workbook, you can use its <code>Address</code> with <code>External:=True</code> to get its full <code>String</code> reference including the workbook name. I'd use the <code>xlR1C1</code> reference style since it sounds like A1-style can cause errors with larger data sets.</li>\n</ol>\n\n<p>So to fix your errors, make these tweaks...</p>\n\n<pre><code>Dim dataAddress as String\nSet dataRange = wsData.Range(\"A1:AA\" &amp; endCell) ' or maybe endRow\ndataAddress = dataRange.Address(ReferenceStyle:=xlR1C1, External:=True)\n</code></pre>\n\n<p>Then within <code>Set rcPTCache = ...</code>, <code>SourceData:=dataAddress</code>.</p>\n"}], "owner": {"reputation": 15, "user_id": 9719677, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YZMUj.png?s=128&g=1", "display_name": "D.Martin", "link": "https://stackoverflow.com/users/9719677/d-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "accepted_answer_id": 50939354, "answer_count": 1, "score": 0, "last_activity_date": 1529468099, "creation_date": 1529455784, "last_edit_date": 1529457291, "question_id": 50938733, "link": "https://stackoverflow.com/questions/50938733/vba-pivot-table-error-1004-refrence-is-not-valid", "title": "VBA Pivot Table; Error &#39;1004&#39; Refrence is not valid", "body": "<p>I am creating a sheet that grabs data from another workbook and creates a pivot table based off the data.The error im running into is when I try to create the pivot table error '1004' Breaks the code, here is the line of code that breaks. If I attempt to fix the error it will instead run into a type mismatch error</p>\n\n<pre><code>Set rcPT = ActiveSheet.PivotTables.Add(PivotCache:=rcPTCache, TableDestination:=Range(\"A1\"))\n</code></pre>\n\n<p>I am fairly certain it has something to do with the data range as it works when I use a different range but im not sure, it may be a easy fix and I just need another perspective. Here is the full code.</p>\n\n<pre><code> Dim wbReviewPivots As Workbook\nSet wbReviewPivots = ActiveWorkbook\n\n\n\nDim wsPivots As Worksheet\nDim wbData As Workbook\nDim wsData As Worksheet\nDim endCell As Integer\nDim rcPT As PivotTable\nDim rcPTCache As PivotCache\nDim rcPlace As Range\n\n\n\n' set variable equal to data sheet and pivot sheet\nSet wbData = Workbooks.Open(\"//Workbook\\\\\")\nSet wsPivots = wbReviewPivots.Sheets(\"RootCausesCleaned\")\nSet wsData = Sheets(\"RawData\") 'gets the last row within the rawdata sheet\nendCell = wsData.Cells(Rows.Count, \"A\").End(xlUp).Row\n'set the data range\n\nwsData.Activate\nDim MyRange1 As Range, MyRange2 As Range, dataRange As Range\nSet MyRange1 = Range(\"A1:E\" &amp; endCell)\nSet MyRange2 = Range(\"G1:AA\" &amp; endCell)\nSet dataRange = Application.Union(MyRange1, MyRange2)\n\n\n\n'create root cause pivot chart\nwbReviewPivots.Sheets(\"RootCausesCleaned\").Activate\nSet rcPTCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=dataRange)\nSet rcPT = ActiveSheet.PivotTables.Add(PivotCache:=rcPTCache, TableDestination:=Range(\"A1\"))\n\n    With rcPT\n        .PivotFields(\"Cause\").Orientation = xlRowField\n        .PivotFields(\"Cause (Sub Category)\").Orientation = xlRowField\n        .PivotFields(\"Task ID\").Orientation = xlDataField\n    End With\n</code></pre>\n\n<p>The dataRange excludes the G column because if its included another error is run into, Its not a required column so it doesn't matter if the columns excluded but I do think its making it difficult to create the pivot tables. </p>\n\n<p>The excel table object could also be used, but this still runs into the same error.</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 11, "user_id": 9964617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afaa814bba74bd06deb561a2146420dc?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/9964617/don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529451129, "creation_date": 1529451129, "question_id": 50938249, "link": "https://stackoverflow.com/questions/50938249/opening-table-form-from-toolbar-with-vba-button-macro", "title": "Opening Table-Form (from toolbar) with VBA Button Macro", "body": "<p>How can I open the UserForm for tables that is built into the toolbar in Excel 365 and contains previous entries by using a macro attached to a button object?</p>\n\n<p>I have tried recording the macro since this is very basic but the result when executed opens the form without any existing data. The recording gives:</p>\n\n<pre><code>Sub OpenForm()\n' OpenForm Macro\nActiveSheet.ShowDataForm\nEnd Sub      \n</code></pre>\n\n<p>It Results in this:<a href=\"https://i.stack.imgur.com/gJOng.jpg\" rel=\"nofollow noreferrer\">This is the output from the recorded macro code</a>\nWhen I select the table manually and then click the form button it opens like it should:<a href=\"https://i.stack.imgur.com/ApPNs.jpg\" rel=\"nofollow noreferrer\">press this button</a> and <a href=\"https://i.stack.imgur.com/5XAIW.jpg\" rel=\"nofollow noreferrer\">provide a result like this</a>.</p>\n"}, {"tags": ["excel", "checkbox", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 0, "last_activity_date": 1529450617, "last_edit_date": 1529450617, "creation_date": 1529450307, "answer_id": 50938159, "question_id": 50937852, "link": "https://stackoverflow.com/questions/50937852/excel-vba-unable-to-get-checkboxes-property-when-checkbox-clicked-on-copied-sh/50938159#50938159", "title": "Excel VBA &#39;unable to get checkboxes property&#39; when checkbox clicked on copied sheet", "body": "<p>You should be able to access the checkbox by</p>\n\n<pre><code>Sheets(sheetname).Shapes(MyShapeIndex).OLEFormat.Object.Value\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Sheets(sheetname).OLEObjects(OLEIndex).Object.Value\n</code></pre>\n\n<p>Hope that helps.</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 6124690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3LIUc.jpg?s=128&g=1", "display_name": "MooseLucifer", "link": "https://stackoverflow.com/users/6124690/mooselucifer"}, "edited": false, "score": 0, "creation_date": 1529452128, "post_id": 50938168, "comment_id": 88874930, "body": "Awesome! I didn&#39;t know what the immediate window was so I had to look that up haha. I feel like you used to be able to check the actual name of the objects using &#39;properties&#39;, but I wasn&#39;t able to do so for these. Does that only apply to activex controls? Either way, I was able to get the new names for the checkboxes and have worked it out from there. Thank you!!"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 103, "user_id": 6124690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3LIUc.jpg?s=128&g=1", "display_name": "MooseLucifer", "link": "https://stackoverflow.com/users/6124690/mooselucifer"}, "edited": false, "score": 0, "creation_date": 1529452874, "post_id": 50938168, "comment_id": 88875103, "body": "AFAIK you can&#39;t get a Properties window for a Form control on a sheet (others may be able to help) As for ActiveX controls, they have their code in the Workbook module, so may be more difficult to use than Form controls in this case."}, {"owner": {"reputation": 103, "user_id": 6124690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3LIUc.jpg?s=128&g=1", "display_name": "MooseLucifer", "link": "https://stackoverflow.com/users/6124690/mooselucifer"}, "edited": false, "score": 0, "creation_date": 1529453145, "post_id": 50938168, "comment_id": 88875151, "body": "That seems like the case, I must be mis-remembering what I was seeing the properties for. Either way, the immediate box is a pretty great tool, can&#39;t wait to dig deeper! Thanks again for your help c:"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1529450413, "creation_date": 1529450413, "answer_id": 50938168, "question_id": 50937852, "link": "https://stackoverflow.com/questions/50937852/excel-vba-unable-to-get-checkboxes-property-when-checkbox-clicked-on-copied-sh/50938168#50938168", "title": "Excel VBA &#39;unable to get checkboxes property&#39; when checkbox clicked on copied sheet", "body": "<p>When you copy a <code>CheckBox</code> to another sheet, its <code>Name</code> will change.  You need another method to identify them, perhaps the <code>Caption</code>?</p>\n\n<p>You can use this little Sub to identify the Names and Captions of Checkboxes on a sheet</p>\n\n<pre><code>Sub LitsNames()\n    Dim ws As Worksheet\n    Dim cb As CheckBox\n    Set ws = ActiveSheet\n    For Each cb In ws.CheckBoxes\n        Debug.Print \"Name = \" &amp; cb.Name, \"Caption = \" &amp; cb.caption\n    Next\nEnd Sub\n</code></pre>\n\n<p>See the results in the Immediate window</p>\n\n<p>This Function will return the Checkbox with a given Caption (if there are more than one CB with a given caption, then this won't work)</p>\n\n<pre><code>Function GetCB(ws As Worksheet, caption As String) As CheckBox\n    Dim cb As CheckBox\n    For Each cb In ws.CheckBoxes\n        If cb.caption = caption Then\n            Set GetCB = cb\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>Use this like so</p>\n\n<pre><code>Sub Demo()\n    Dim cb As CheckBox\n\n    Set cb = Nothing\n    Set cb = GetCB(ActiveSheet, \"Some Caption\")\n    If Not cb Is Nothing Then\n        If cb.Value = 1 Then\n            ' do stuff\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 6124690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3LIUc.jpg?s=128&g=1", "display_name": "MooseLucifer", "link": "https://stackoverflow.com/users/6124690/mooselucifer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3361, "favorite_count": 0, "accepted_answer_id": 50938168, "answer_count": 2, "score": 0, "last_activity_date": 1529450617, "creation_date": 1529447823, "last_edit_date": 1592644375, "question_id": 50937852, "link": "https://stackoverflow.com/questions/50937852/excel-vba-unable-to-get-checkboxes-property-when-checkbox-clicked-on-copied-sh", "title": "Excel VBA &#39;unable to get checkboxes property&#39; when checkbox clicked on copied sheet", "body": "<p>As the title kinda implies, my macro works as intended on the original sheet, but the same macro fails on the copied sheet.</p>\n<p>I have an Excel workbook that takes an input from sheet1 to copy and populate sheet2, such that the book now contains sheet1, sheet2, and sheet3 (which is the populated copy of sheet2). Sheet2 contains a bunch of checkboxes, which are copied to sheet3. Sheet2 always has the same name, but the name for sheet3 changes every time.</p>\n<p>I wrote a macro in the workbook module to add info to a few different books when each checkbox is clicked. The macro works as expected when the checkbox on sheet2 is clicked, but when I click the checkbox on sheet3, I receive &quot;Run-time error '1004': Unable to get the CheckBoxes property of the Worksheet class&quot;.</p>\n<p>Here is the line that is getting the error:</p>\n<blockquote>\n<p>sheetname = ActiveSheet.name</p>\n<p>If Sheets(sheetname).CheckBoxes(&quot;43&quot;) = 1 Then</p>\n</blockquote>\n<p>Both checkboxes call the same macro, and the name of the sheet is dictated by 'sheetname = ActiveSheet.Name' and appears correct when used on sheet3.</p>\n<p>Things I have tried in vain:</p>\n<ul>\n<li>changing &quot;= 1&quot; to &quot;= True&quot;</li>\n<li>changing &quot;CheckBoxes&quot; to &quot;OLEObjects&quot;</li>\n<li>verified 'sheetname' is correct</li>\n<li>Change sheet3 checkbox to ActiveX, applied code</li>\n<li>change name of copied checkbox and change code to reflect new name</li>\n<li>write macro on sheet2 and/or sheet3 modules</li>\n<li>&quot;CheckBoxes(&quot;43&quot;).Value = 1&quot;</li>\n</ul>\n<p>Why does it work on one sheet, and not on the other?</p>\n<p>Thank you for your time!</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1529447615, "post_id": 50937730, "comment_id": 88873955, "body": "Asking for a tutorial makes the Q off topic.  I removed that to save you from down votes and close votes."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1529447681, "post_id": 50937730, "comment_id": 88873970, "body": "Is <code>.Body = &quot;...&quot; .Display (...)</code> on the same line in your real code, or is that just an issue posting here.  They need to be on separate lines"}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1529447711, "post_id": 50937730, "comment_id": 88873976, "body": "Thank you Chris. It won&#39;t happen again!"}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1529447795, "post_id": 50937730, "comment_id": 88873993, "body": "For typed it out wrong. They are on separate lines in my macro. I&#39;ll edit it on the post. Sorry again."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1529448045, "post_id": 50937730, "comment_id": 88874049, "body": "There are several other typos too. <code>Sub Send Mail()</code> --&gt; <code>Sub SendMail()</code> , <code>Dim blRunning As Boolen</code> --&gt; <code>Dim blRunning As Boolean</code> , <code>Set olMaill = Nothing</code> --&gt; <code>Set olMail = Nothing</code>Again, are these real code issues or posting issues?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1529448093, "post_id": 50937730, "comment_id": 88874063, "body": "What are trying to do with <code>.Display (&quot;Spell check, data attached?, SEND&quot;)</code> ? <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-display-method-outlook\" rel=\"nofollow noreferrer\">see help</a>"}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1529448329, "post_id": 50937730, "comment_id": 88874127, "body": "Addressing your first question about the spelling issues, I&#39;m afraid its just the post and not the real code again (typing to fast). Addressing your second question I am trying to display a message for the user of the template/outlook email to check the email before sending and to remember to send (which is ironic that it says spell check on it)."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1529448738, "post_id": 50937730, "comment_id": 88874216, "body": "Did you try to debug the code? What line of code exactly throws an exception?"}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529448881, "post_id": 50937730, "comment_id": 88874249, "body": "The error comes up when debugging the line:  .Body = &quot;Support Message&quot;"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1529448986, "post_id": 50937730, "comment_id": 88874279, "body": "Code runs file for me (once typos are fixed).  BTW the string parameter you pass to <code>Display</code> does nothing, you should remove it"}, {"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529449121, "post_id": 50937730, "comment_id": 88874314, "body": "Ok it is removed. I still receive the same run-time error. Any suggestions?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529451226, "post_id": 50938138, "comment_id": 88874770, "body": "okay I will try out one of those suggestions. Thank you. That solves the body problem. Is there a way to write a macro that will pull the original entry creator out of a pivot table or table field into the recipient section? I&#39;m trying to automate the whole process of email multiple users from this data table. Thank you for your help."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "edited": false, "score": 0, "creation_date": 1529479893, "post_id": 50938138, "comment_id": 88882718, "body": "I&#39;d recommend marking the right answer and asking separate questions in new threads."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1529450106, "creation_date": 1529450106, "answer_id": 50938138, "question_id": 50937730, "link": "https://stackoverflow.com/questions/50937730/outlook-template-pull-up-excel-using-vba/50938138#50938138", "title": "Outlook template pull up Excel using VBA", "body": "<pre><code> .Body = \"Support message\" \n</code></pre>\n\n<p>You may try to set the <code>BodyFormat</code> before setting the message body.</p>\n\n<p>Most probably you have faced with a security issue in Outlook. \"Security\" in this context refers to the so-called \"object model guard\" that triggers security prompts and blocks access to certain features in an effort to prevent malicious programs from harvesting email addresses from Outlook data and using Outlook to propagate viruses and spam.</p>\n\n<p>Possible workarounds are:</p>\n\n<ol>\n<li><a href=\"http://www.add-in-express.com/outlook-security/index.php\" rel=\"nofollow noreferrer\">Outlook Security Manager</a> which allows to disable and enable security in Outlook dynamically. </li>\n<li>A low-level code which doesn't trigger security issues (Extended MAPI). </li>\n<li>Develop a COM add-in. In order to avoid Outlook object model security prompts, the add-in must derive all Outlook objects from this Outlook.Application object. In VSTO add-ins, that would be the <code>Globals.ThisAddin.Application</code> object.</li>\n<li>Deploying a GPO policy.</li>\n</ol>\n\n<p>Read more about possible options in the <a href=\"http://www.outlookcode.com/article.aspx?ID=52\" rel=\"nofollow noreferrer\">Outlook \"Object Model Guard\" Security Issues for Developers</a> article. </p>\n"}], "owner": {"reputation": 15, "user_id": 9964042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957f9ade821d914bb030b780a56b29eb?s=128&d=identicon&r=PG&f=1", "display_name": "FinanceGuy", "link": "https://stackoverflow.com/users/9964042/financeguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 50938138, "answer_count": 1, "score": 0, "last_activity_date": 1592985989, "creation_date": 1529447097, "last_edit_date": 1592985989, "question_id": 50937730, "link": "https://stackoverflow.com/questions/50937730/outlook-template-pull-up-excel-using-vba", "title": "Outlook template pull up Excel using VBA", "body": "<p>I have a list of Data that contains various entry details (Made by, Date, Amount, etc.) stored on a excel worksheet. I am trying to auto support to people who made the entries in the first place.</p>\n\n<p>My goals for the macro I'm writing are:</p>\n\n<ol>\n<li>Create a mail object</li>\n<li>Set mail object to outlook template file</li>\n<li>setting and then filling in the template with data about the original entry writer (thats who I will be sending it to), the comment they left about the entry, and pulling some other details for the template.</li>\n<li>Save to drafts for later review/send </li>\n</ol>\n\n<p>This what I have to far:</p>\n\n<pre><code>Sub SendMail()\n        Dim olApp As Outlook.Application \n         Dim olMail As Outlook.MailItem \n         Dim  blRunning As Boolean\n\n         blRunning = True \n         on Error Resume Next \n         Set olApp = GetObject (,\"Outlook.Application\") \n         If olApp Is Nothing Then \n             Set olApp = New Outlook.Application \n             blRunning = False \n        End If  \n        On Error GoTo 0 \n\n        Set olMail = olApp.CreateItem(olMailItem) \n        With olMail \n            .Subject = \"Automatic Entry Support\" \n            .Recipients.Add \"J.Doe@gmail.com\"  \n            .Attachments.Add \"C:\\Users\\J.Doe\\Documents\\Project\\Template draft.xlsx\"  \n            .Body = \"Support message\" \n            .Display (\"Spell check, data attached?, SEND\")\n        End With\n        If Not blRunning Then olApp.Quit\n\n        Set olApp = Nothing\n        Set olMail = Nothing\n    End Sub\n</code></pre>\n\n<p>(There are lines in the code that I placed with \"fake\" lines to not show anything important). </p>\n\n<p>Also, this is my first post on this site so please comment if I am not asking the question in the right format. </p>\n\n<p><strong>UPDATE</strong>: I am also receiving an error when trying to run the code: \"Run-time error '-2147024894 (8007002): Automation error\" </p>\n"}, {"tags": ["vba", "sumifs"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9964271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d53ebac7c4ae09a4c4e3a385e9a4ea0a?s=128&d=identicon&r=PG&f=1", "display_name": "mave", "link": "https://stackoverflow.com/users/9964271/mave"}, "edited": false, "score": 0, "creation_date": 1529587459, "post_id": 50937292, "comment_id": 88935646, "body": "Thanks. It really helped."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1529445929, "last_edit_date": 1529445929, "creation_date": 1529444289, "answer_id": 50937292, "question_id": 50937198, "link": "https://stackoverflow.com/questions/50937198/application-defined-or-object-defined-error-vba-sumifs-formula/50937292#50937292", "title": "Application defined or object defined error: VBA: sumifs formula", "body": "<blockquote>\n  <p>Issue line: Sheets(\"Sheet2\").<strong>Cells(12, c)</strong>.Value = </p>\n</blockquote>\n\n<p>You have a syntax issue with the <code>Cells</code> object. The correct syntax is <code>Cells(Row Index, Col Index)</code> where index is a number (or col letter houesd in quotes).   </p>\n\n<p><strong>Row Index</strong> is self explanatory (<code>1 = 1</code>).<br>\n<strong>Column Index</strong>: <code>A = 1</code>, <code>B = 2</code>, <code>C = 3</code> or <code>A = \"A\"</code>, <code>B = \"B\"</code>, <code>C = \"C\"</code></p>\n\n<hr>\n\n<p>If your goal is to have the <code>SUMIF</code> value displayed in cell <code>C12</code>, you can try any of the three equal alternatives below. </p>\n\n<pre><code>1) Sheets(\"Sheet2\").Cells(12, \"C\").Value =\n2) Sheets(\"Sheet2\").Cells(12, 3).Value =\n3) Sheets(\"Sheet2\").Range(\"C12\").Value =\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9964271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d53ebac7c4ae09a4c4e3a385e9a4ea0a?s=128&d=identicon&r=PG&f=1", "display_name": "mave", "link": "https://stackoverflow.com/users/9964271/mave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529445929, "creation_date": 1529443689, "question_id": 50937198, "link": "https://stackoverflow.com/questions/50937198/application-defined-or-object-defined-error-vba-sumifs-formula", "title": "Application defined or object defined error: VBA: sumifs formula", "body": "<p>I am not able to correct this code. It is throwing error in line where i have used sumifs formula. Whats wrong in this?      </p>\n\n<pre><code>Sub try()   \nDim Arg1 As Range   \nDim Arg2 As Range   \nDim Arg3 As Range   \nDim Arg4 As Range   \n\n\n\nSet Arg1 = Sheets(\"Raw Data_All Products\").Range(\"O:O\")   \nSet Arg2 = Sheets(\"Raw Data_All Products\").Range(\"J:J\")   \nSet Arg3 = Sheets(\"Raw Data_All Products\").Range(\"B:B\")   \nSet Arg4 = Sheets(\"Raw Data_All Products\").Range(\"A:A\")   \n\nSheets(\"Sheet2\").Cells(12, c).Value = \nApplication.WorksheetFunction.SumIfs(Arg1, Arg2, \"SM Parcels\", Arg3, \"2015\", \nArg4, \"1\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3, "user_id": 9964145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0baab641d45422df1a132b72c5f26?s=128&d=identicon&r=PG&f=1", "display_name": "Jac", "link": "https://stackoverflow.com/users/9964145/jac"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1529441734, "post_id": 50936762, "comment_id": 88872084, "body": "By the way, the row that is highlighted when the error message comes up is: &quot;If Application.WorksheetFunction.Countif(Range(&quot;B118:B124&quot;), Target) Then&quot;"}, {"owner": {"reputation": 3, "user_id": 9964145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0baab641d45422df1a132b72c5f26?s=128&d=identicon&r=PG&f=1", "display_name": "Jac", "link": "https://stackoverflow.com/users/9964145/jac"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1529441970, "post_id": 50936762, "comment_id": 88872180, "body": "hi urdearboy, the only thing that&#39;s missing from the code above is: Private Sub Worksheet_Change (ByVal Target As Range). It&#39;s obviously the very first line of code. Everything else is shown above. Thanks"}, {"owner": {"reputation": 3, "user_id": 9964145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0baab641d45422df1a132b72c5f26?s=128&d=identicon&r=PG&f=1", "display_name": "Jac", "link": "https://stackoverflow.com/users/9964145/jac"}, "edited": false, "score": 0, "creation_date": 1529442075, "post_id": 50936762, "comment_id": 88872217, "body": "Any idea what might cause the runtime error when I try to change multiple cells in B at the same time?"}, {"owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "edited": false, "score": 0, "creation_date": 1529442230, "post_id": 50936762, "comment_id": 88872272, "body": "Welcome to Stack Overflow! The standard site style would be to update your question rather than have clarifying comments. Good luck!"}], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1529443095, "post_id": 50937037, "comment_id": 88872583, "body": "For a neat coding pattern you must set Application.EnableEvents=False before the ClearContents line and set it back to True and prevent calling the event handler an infinite loop (although this would not be the case)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529443432, "post_id": 50937037, "comment_id": 88872707, "body": "You check the intersect with Col B, but then loop over the entire Target range: you should only process the cells in the Intersect range. BTW <code>Range(Target.Address)</code> is the same as <code>Target</code>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529443527, "post_id": 50937037, "comment_id": 88872742, "body": "@TimWilliams If I strip away everything between <code>Private Sub</code> and <code>End Sub</code> and just do <code>Debug.Print Target</code>, it&#39;s printing the <code>Target.Value</code>, so I was under the impression I needed to grab the address."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1529443983, "post_id": 50937037, "comment_id": 88872901, "body": "If you look at the method parameter, <code>Target</code> is already a <code>Range</code> object, so there&#39;s no need to do any conversion to get a range from it.  <code>Debug.Print Target</code> will output the <i>default property</i> of Target, which happens to be its <code>Value</code>. <code>Debug.Print Target</code> will error on a multi-cell Range, because <code>Value</code> is an array and not a single value."}, {"owner": {"reputation": 3, "user_id": 9964145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0baab641d45422df1a132b72c5f26?s=128&d=identicon&r=PG&f=1", "display_name": "Jac", "link": "https://stackoverflow.com/users/9964145/jac"}, "edited": false, "score": 0, "creation_date": 1529445006, "post_id": 50937037, "comment_id": 88873263, "body": "Thanks Guys. DisplayName, where would I set Application.EnableEvents back to true? Afrer clearcontents line? thanks"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529503531, "post_id": 50937037, "comment_id": 88897899, "body": "@TimWilliams Thanks for the explanation - I did not know that."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 3, "user_id": 9964145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0baab641d45422df1a132b72c5f26?s=128&d=identicon&r=PG&f=1", "display_name": "Jac", "link": "https://stackoverflow.com/users/9964145/jac"}, "edited": false, "score": 0, "creation_date": 1529503648, "post_id": 50937037, "comment_id": 88897969, "body": "@Jac I&#39;ve updated the answer to work a little more consistently."}, {"owner": {"reputation": 3, "user_id": 9964145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0baab641d45422df1a132b72c5f26?s=128&d=identicon&r=PG&f=1", "display_name": "Jac", "link": "https://stackoverflow.com/users/9964145/jac"}, "edited": false, "score": 0, "creation_date": 1529628761, "post_id": 50937037, "comment_id": 88954291, "body": "Thanks dwirony. appreciate your help."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1529503629, "last_edit_date": 1529503629, "creation_date": 1529442862, "answer_id": 50937037, "question_id": 50936762, "link": "https://stackoverflow.com/questions/50936762/excel-2016-vba-runtime-error-13/50937037#50937037", "title": "Excel 2016 VBA Runtime error 13", "body": "<p>I <em>think</em> the issue is that <code>COUNTIF</code> is expecting a singular value, not a range containing values. Try this instead:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Intersect(Target, Range(\"B:B\")) Is Nothing Then\n    For Each cell In Range(Target.Address)\n        If Application.WorksheetFunction.CountIf(Range(\"B118:B124\"), cell) Then\n            Range(\"D\" &amp; cell.Row).ClearContents\n        End If\n    Next cell\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: Updated answer with everyone's contributions:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Intersect(Target, Range(\"B:B\")) Is Nothing Then\n    For Each cell In Target\n        If Not Intersect(cell, Range(\"B:B\")) Is Nothing Then\n            If Application.WorksheetFunction.CountIf(Range(\"B118:B124\"), cell) Then\n                Application.EnableEvents = False\n                    Range(\"D\" &amp; cell.Row).ClearContents\n                Application.EnableEvents = True\n            End If\n        End If\n    Next cell\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9964145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0baab641d45422df1a132b72c5f26?s=128&d=identicon&r=PG&f=1", "display_name": "Jac", "link": "https://stackoverflow.com/users/9964145/jac"}, "edited": false, "score": 0, "creation_date": 1529444582, "post_id": 50937104, "comment_id": 88873122, "body": "Hi Ricardo, thanks for response. I have a hundred cells that I need this code to apply to. Isn&#39;t there a simpler/shorter way to solve this problem? It would be a pretty long code. If there is another way, I&#39;d greatly appreciate your help. Thanks"}, {"owner": {"reputation": 3, "user_id": 9964145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0baab641d45422df1a132b72c5f26?s=128&d=identicon&r=PG&f=1", "display_name": "Jac", "link": "https://stackoverflow.com/users/9964145/jac"}, "edited": false, "score": 0, "creation_date": 1529444678, "post_id": 50937104, "comment_id": 88873156, "body": "Also, I&#39;m new to VBA. What do you mean by loop? does it refer to a quick way of correcting the code?"}, {"owner": {"reputation": 3, "user_id": 9964145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0baab641d45422df1a132b72c5f26?s=128&d=identicon&r=PG&f=1", "display_name": "Jac", "link": "https://stackoverflow.com/users/9964145/jac"}, "edited": false, "score": 0, "creation_date": 1529445220, "post_id": 50937104, "comment_id": 88873325, "body": "never mind. just copied your code. Works great. Thanks a lot!"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "reply_to_user": {"reputation": 3, "user_id": 9964145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0baab641d45422df1a132b72c5f26?s=128&d=identicon&r=PG&f=1", "display_name": "Jac", "link": "https://stackoverflow.com/users/9964145/jac"}, "edited": false, "score": 0, "creation_date": 1529446262, "post_id": 50937104, "comment_id": 88873587, "body": "Glad it worked. Sorry for not replying on time to your questions, I am at work. Edit: strongly recommended to read a bit about VBA For Loops, you will use them a lot once you know how to use them."}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1529443196, "creation_date": 1529443196, "answer_id": 50937104, "question_id": 50936762, "link": "https://stackoverflow.com/questions/50936762/excel-2016-vba-runtime-error-13/50937104#50937104", "title": "Excel 2016 VBA Runtime error 13", "body": "<p>When selecting a range, you must process each individually in this case. Loop the range in target and done.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    For Each cell In Target\n        If Not Intersect(cell, Range(\"B:B\")) Is Nothing Then\n            If Application.WorksheetFunction.CountIf(Range(\"B118:B124\"), cell) Then\n                Range(\"D\" &amp; cell.Row).ClearContents\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9964145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0baab641d45422df1a132b72c5f26?s=128&d=identicon&r=PG&f=1", "display_name": "Jac", "link": "https://stackoverflow.com/users/9964145/jac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 50937037, "answer_count": 2, "score": 0, "last_activity_date": 1529503629, "creation_date": 1529441456, "last_edit_date": 1529442289, "question_id": 50936762, "link": "https://stackoverflow.com/questions/50936762/excel-2016-vba-runtime-error-13", "title": "Excel 2016 VBA Runtime error 13", "body": "<p>I wrote the code below to clear the cell in column D only if the value of the cell in in the corresponding row of column B changes to a value that is part of a specific list/range (B118:B124). If I change the cell in B to any value that is not part of that list, the cell in the corresponding row in D will not clear (that is what I want). </p>\n\n<p>The code below works fine, except, if for example I want to delete 5 (adjacent) cells in column B at the same time, I get runtime error 13. Same is the case if I enter a new value in the first of the deleted/blank cells and then try to auto fill it down to the rest of deleted/blank cells. Basically, the code below seems to not work if I want to change multiple cells in B at the same time (autofill,...). If I only delete/change one cell (in B) at a time, it works just fine. Any help would be greatly appreciated. Thanks.</p>\n\n<pre><code>Private Sub Worksheet_Change (ByVal Target As Range)  \n\nIf Not Intersect(Target, Range(\"B:B\")) Is Nothing Then\n    If Application.WorksheetFunction.CountIf(Range(\"B118:B124\"), Target) Then\n        Range(\"D\" &amp; Target.Row).ClearContents\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1529440322, "post_id": 50936467, "comment_id": 88871568, "body": "Can you post sample data and expected result?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1529440385, "post_id": 50936467, "comment_id": 88871590, "body": "Function called from the worksheet cannot change the format or value of another cell, nor can it change the format of the cell calling it."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1529441097, "post_id": 50936628, "comment_id": 88871855, "body": "1.You cannot select another cell from a Function called from the worksheet. 2. Using <code>.Select</code> is almost never the answer to problems, One should avoid <code>.Select</code> and simply reference the cell in the call.  <code>.Select</code> only slows down the code."}], "tags": [], "owner": {"reputation": 23, "user_id": 8688084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/936e198d2af3461edbae7fbb5dd8dd73?s=128&d=identicon&r=PG&f=1", "display_name": "doubleM", "link": "https://stackoverflow.com/users/8688084/doublem"}, "is_accepted": false, "score": -2, "last_activity_date": 1529440877, "creation_date": 1529440877, "answer_id": 50936628, "question_id": 50936467, "link": "https://stackoverflow.com/questions/50936467/vba-modify-current-cell-content-with-a-function/50936628#50936628", "title": "Vba modify current cell content with a function", "body": "<p>Did you try to select the range in a object before and to call the function with it ?</p>\n\n<p>Dim anotherCell as range\nSet anotherCell = range(\"A1\").select 'For example</p>\n\n<p>' and you call your function (you have to declare it before in a specific 'functions' module for example)\nmyFunction(anotherCell)</p>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 9962824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uWBTs.jpg?s=128&g=1", "display_name": "Izaya", "link": "https://stackoverflow.com/users/9962824/izaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1529519481, "creation_date": 1529519481, "answer_id": 50954903, "question_id": 50936467, "link": "https://stackoverflow.com/questions/50936467/vba-modify-current-cell-content-with-a-function/50954903#50954903", "title": "Vba modify current cell content with a function", "body": "<p>Thank you Scott for your answer.\nSo as you said : <strong>Function called from the worksheet cannot change the format or value of another cell, nor can it change the format of the cell calling it.</strong>\nAnd it makes sense. I will search another way to do my job.</p>\n"}], "owner": {"reputation": 366, "user_id": 9962824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uWBTs.jpg?s=128&g=1", "display_name": "Izaya", "link": "https://stackoverflow.com/users/9962824/izaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 471, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529519481, "creation_date": 1529440168, "last_edit_date": 1529440317, "question_id": 50936467, "link": "https://stackoverflow.com/questions/50936467/vba-modify-current-cell-content-with-a-function", "title": "Vba modify current cell content with a function", "body": "<p>I want to access to the current cell and modify something on it. Not the ActiveCell (it works only if there is no entry in the function), but the cell in which the equation is entering (in this case : <code>=myFunction(A1)</code> for example).</p>\n\n<p>Here the code : </p>\n\n<pre><code>Public Function myFunction(anotherCell As String) As String\n    'Do something with anotherCell\n    myFunction = \"something\"\n    'Change interior cell color\n    'Add hyperlink\nEnd Function\n</code></pre>\n\n<p>I want to add a hyperlink on this specific cell and modify its inner color (not the text color). I know how to do it on a defined cell by its position, but not on the cell where the string \"something\" will be written. </p>\n\n<p>Thank you very much for your help !</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1529440190, "post_id": 50936437, "comment_id": 88871519, "body": "Can you post the solution you have found?"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1529441254, "creation_date": 1529441254, "answer_id": 50936710, "question_id": 50936437, "link": "https://stackoverflow.com/questions/50936437/excel-paste-multiple-times-vba/50936710#50936710", "title": "Excel paste multiple times VBA", "body": "<p>Here as a mock you can use to build what you need. In the below code:<br>\nPasteValue (<code>x</code>) = Col A<br>\nNumber of times to paste (<code>y</code>) = Col B<br>\nPaste range = Col F  </p>\n\n<p>You will need to change the paste range to your desired sheet. Something like <code>Thisworkbook.Sheets(\"Sheet2\").Range(\"A\" &amp; LRow2\").PasteSpecial xlPasteValues</code> should work</p>\n\n<pre><code>Sub pasteX()\n\nDim LRow As Long, LRow2 As Long, x As Integer, y As Integer\nLRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor x = 2 To LRow\ny = Range(\"A\" &amp; x).Offset(, 1).Value\n    For y = 1 To y\n        LRow2 = Range(\"F\" &amp; Rows.Count).End(xlUp).Offset(1).Row\n        Range(\"A\" &amp; x).Copy\n        Range(\"F\" &amp; LRow2).PasteSpecial xlPasteValues\n    Next y\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4200, "user_id": 3104974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bf327f4729e0af1e6bf0582391fad75?s=128&d=identicon&r=PG&f=1", "display_name": "ascripter", "link": "https://stackoverflow.com/users/3104974/ascripter"}, "edited": false, "score": 0, "creation_date": 1529670477, "post_id": 50936807, "comment_id": 88970364, "body": "Is this what you needed? If it is, would you mind accepting this answer or the other, whichever helped you more?"}], "tags": [], "owner": {"reputation": 4200, "user_id": 3104974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bf327f4729e0af1e6bf0582391fad75?s=128&d=identicon&r=PG&f=1", "display_name": "ascripter", "link": "https://stackoverflow.com/users/3104974/ascripter"}, "is_accepted": false, "score": 0, "last_activity_date": 1529441675, "creation_date": 1529441675, "answer_id": 50936807, "question_id": 50936437, "link": "https://stackoverflow.com/questions/50936437/excel-paste-multiple-times-vba/50936807#50936807", "title": "Excel paste multiple times VBA", "body": "<p>Looping over the rows of the source sheet until blank string appears as <code>Paste Value</code>. For each row, loop <code>Number of Pastes</code> in the target sheet and increment the counter.</p>\n\n<pre><code>Option Explicit\n\nSub paste()\n    Dim rw, rw_target, rw_source As Integer\n    Dim sht_source, sht_target As Worksheet\n\n    Set sht_source = Sheets(\"table1\")\n    Set sht_target = Sheets(\"table2\")\n\n    rw_source = 2  'first row is header\n    rw_target = 1  'start pasting at row 1 in target sheet\n\n    While sht_source.Cells(rw_source, 1).Value &lt;&gt; \"\"\n        For rw = 1 To sht_source.Cells(rw_source, 2).Value\n            sht_target.Cells(rw_target, 1).Value = sht_source.Cells(rw_source, 1).Value\n            rw_target = rw_target + 1\n        Next rw\n        rw_source = rw_source + 1\n    Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9964008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e418dcb4baafd06bb8497ebccf96c2c?s=128&d=identicon&r=PG&f=1", "display_name": "MLMW", "link": "https://stackoverflow.com/users/9964008/mlmw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3178, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529460207, "creation_date": 1529440052, "last_edit_date": 1529460207, "question_id": 50936437, "link": "https://stackoverflow.com/questions/50936437/excel-paste-multiple-times-vba", "title": "Excel paste multiple times VBA", "body": "<p>I am hoping to find a macro which will allow me to paste a certain value X number of times into a separate worksheet.  Ideally, the number of \"items\" can easily be updated. </p>\n\n<p>For example sheet 1 looks like this: </p>\n\n<pre><code>Paste Value     Number of Pastes\nItem 1          3\nItem 2          1\nItem 3          5\n</code></pre>\n\n<p>On sheet 2, it would appear as</p>\n\n<pre><code>Item 1\nItem 1\nItem 1\nItem 2\nItem 3\nItem 3\nItem 3\nItem 3\nItem 3\n</code></pre>\n\n<p>I have found solutions to post on the same worksheet, but haven't been able to get it to paste to a separate worksheet. </p>\n\n<p>Thanks for your time. </p>\n"}]