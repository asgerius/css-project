[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "edited": false, "score": 0, "creation_date": 1505951436, "post_id": 46333302, "comment_id": 79627433, "body": "this question should be able to answer it <a href=\"https://stackoverflow.com/questions/32127581/removing-duplicate-values-from-a-string-in-visual-basic\">https://stackoverflow.com/questions/32127581/removing-duplic&zwnj;&#8203;ate-values...</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "edited": false, "score": 0, "creation_date": 1505951588, "post_id": 46333302, "comment_id": 79627462, "body": "@DaBeau96 The best answer in that question includes a function which does exactly what the OP wants, so I am voting to close as duplicate."}, {"owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505951811, "post_id": 46333302, "comment_id": 79627517, "body": "@YowE3K sounds good"}], "owner": {"reputation": 11, "user_id": 6530786, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208767886287358/picture?type=large", "display_name": "Kunal Pritwani", "link": "https://stackoverflow.com/users/6530786/kunal-pritwani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1505952157, "answer_count": 0, "score": 0, "last_activity_date": 1505951213, "creation_date": 1505951213, "last_edit_date": 1531161705, "question_id": 46333302, "link": "https://stackoverflow.com/questions/46333302/any-way-if-we-can-remove-repeated-values-in-a-single-cell-in-excel", "closed_reason": "Duplicate", "title": "Any way if we can remove repeated values in a single cell in Excel?", "body": "<p>I have a column like Department ID:\nit has Values like:</p>\n\n<p>-</p>\n\n<ol>\n<li>11\\22\\34\\34</li>\n<li>33\\33\\44\\44</li>\n<li>22\\22</li>\n<li>11\\11\\22</li>\n</ol>\n\n<p>So I want the repeated values removed and the output should be like:</p>\n\n<ol>\n<li>11\\22\\34</li>\n<li>33\\44</li>\n<li>22</li>\n<li>11\\22</li>\n</ol>\n\n<p>Please let me know how to do it or where to look? Thanks</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 11, "user_id": 8644693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/133024d70608e3593b80642ab97bd194?s=128&d=identicon&r=PG&f=1", "display_name": "MaryJane", "link": "https://stackoverflow.com/users/8644693/maryjane"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1505949905, "post_id": 46333000, "comment_id": 79627087, "body": "What information should I provide? This is my first post. I can usually figure things out by troubleshooting or reading others&#39; questions. I&#39;m lost on this one."}, {"owner": {"reputation": 11, "user_id": 8644693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/133024d70608e3593b80642ab97bd194?s=128&d=identicon&r=PG&f=1", "display_name": "MaryJane", "link": "https://stackoverflow.com/users/8644693/maryjane"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1505951475, "post_id": 46333000, "comment_id": 79627439, "body": "I rewrote the question. Hopefully more clear."}, {"owner": {"reputation": 660, "user_id": 4921218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc3a36b66cdff29c046c4e7035a764a2?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Marion", "link": "https://stackoverflow.com/users/4921218/sam-marion"}, "edited": false, "score": 0, "creation_date": 1505951721, "post_id": 46333000, "comment_id": 79627498, "body": "What is the value of VBatch? If you set a break point and copy the exact sql query produced are you saying it returns something from other than the Inventory table?"}, {"owner": {"reputation": 660, "user_id": 4921218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc3a36b66cdff29c046c4e7035a764a2?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Marion", "link": "https://stackoverflow.com/users/4921218/sam-marion"}, "edited": false, "score": 0, "creation_date": 1505951790, "post_id": 46333000, "comment_id": 79627514, "body": "Also I don&#39;t know much about VBA but this is prone to sql injection. If VBatch is taking user input they could easily do what they will to your DB"}, {"owner": {"reputation": 11, "user_id": 8644693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/133024d70608e3593b80642ab97bd194?s=128&d=identicon&r=PG&f=1", "display_name": "MaryJane", "link": "https://stackoverflow.com/users/8644693/maryjane"}, "edited": false, "score": 0, "creation_date": 1505953192, "post_id": 46333000, "comment_id": 79627819, "body": "Vbatch is whatever batch they select in a drop down in the form. And yes, the value that SQL pulls from the query is different than the value SQL pulls from the table created from the query.   Right now my query is a separate Access object but perhaps I should try running it in code within this sub."}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 2, "creation_date": 1505956063, "post_id": 46333000, "comment_id": 79628433, "body": "I&#39;m curious why you select field <code>Available</code> in <code>mySQL</code>, but able to get the value from field <code>FlowerAvailable</code>.  Is that all of your code?  Beside, will the query return more than 1 rows?"}, {"owner": {"reputation": 11, "user_id": 8644693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/133024d70608e3593b80642ab97bd194?s=128&d=identicon&r=PG&f=1", "display_name": "MaryJane", "link": "https://stackoverflow.com/users/8644693/maryjane"}, "edited": false, "score": 0, "creation_date": 1506002891, "post_id": 46333000, "comment_id": 79652401, "body": "No, I was just trying to simplify my naming conventions for the example but it&#39;s the same (edited my code above). Put the query returns only one row. I can look at my query outside of the form and see the value of the Available field for that batch and it&#39;s one thing but returns something else with the SQL select in the form."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8644693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/133024d70608e3593b80642ab97bd194?s=128&d=identicon&r=PG&f=1", "display_name": "MaryJane", "link": "https://stackoverflow.com/users/8644693/maryjane"}, "edited": false, "score": 0, "creation_date": 1506024668, "post_id": 46346422, "comment_id": 79665027, "body": "Wow I didn&#39;t realize I could this. Thank you so much!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1506003639, "creation_date": 1506003639, "answer_id": 46346422, "question_id": 46333000, "link": "https://stackoverflow.com/questions/46333000/sql-select-statement-suddenly-retrieving-wrong-value-only-when-selecting-form-an/46346422#46346422", "title": "SQL Select statement suddenly retrieving wrong value only when selecting form another query", "body": "<p>To read a single value from a table or query, your code is a bit over the top.</p>\n\n<p>For this scenario, Access has the <a href=\"https://support.office.com/en-us/article/DLookup-Function-8896cb03-e31f-45d1-86db-bed10dca5937\" rel=\"nofollow noreferrer\"><code>DLookup</code> function</a>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>VAvail = DLookup(\"Available\", \"Inventory\", \"BatchID = '\" &amp; VBatch &amp; \"'\")\nForms!ChangeOrders.ChangeOrderSubform.Form.Availability.Value = VAvail\n</code></pre>\n\n<p>That's all that is needed.</p>\n"}], "owner": {"reputation": 11, "user_id": 8644693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/133024d70608e3593b80642ab97bd194?s=128&d=identicon&r=PG&f=1", "display_name": "MaryJane", "link": "https://stackoverflow.com/users/8644693/maryjane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506003639, "creation_date": 1505948782, "last_edit_date": 1506003218, "question_id": 46333000, "link": "https://stackoverflow.com/questions/46333000/sql-select-statement-suddenly-retrieving-wrong-value-only-when-selecting-form-an", "title": "SQL Select statement suddenly retrieving wrong value only when selecting form another query", "body": "<p>I have a order creation form in an Access database where the user selects a product and VBA code is triggered with SQL select statement to retrieve the current availability of that product. This is how it's set up:</p>\n\n<ol>\n<li>I have a Packages table where products batches are added to inventory. </li>\n<li>I have an OrderDetail table where items from product batches are allocated to orders. </li>\n<li>I have a InventoryPrep query with a the total packaged per batch and field that sums the number of allocated products per batch from the OrderDetail table.</li>\n<li>Then I have an Inventory query that that has a calculated field that takes the TotalPackaged field from the InventoryPrep query and subtracts the TotalAllocated field from the InventoryPrep query. </li>\n</ol>\n\n<p>Here is the VBA code in my form, triggered by an update to the [Batch] combo box: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim VBatch As String\nVBatch = Me.Batch.Value\nDim VAvail As Double\nDim mySQL As String\nDim conn1 As ADODB.Connection\nSet conn1 = CurrentProject.Connection\nDim rs1 As New ADODB.Recordset\nrs1.ActiveConnection = conn1\n\nmySQL = \"SELECT Available FROM Inventory WHERE BatchID = \" &amp; \"'\" &amp; VBatch &amp; \"'\"\n        rs1.Open mySQL\n        rs1.MoveFirst\n        VAvail = rs1.Fields(\"Available\").Value\n        Forms!ChangeOrders.ChangeOrderSubform.Form.Availability.Value = VAvail\n        rs1.Close\n        conn1.Close\n        Set rs1 = Nothing\n        Set conn1 = Nothing\n</code></pre>\n\n<p>This has been working just fine for weeks, retreiving the correct available amount as packaged items are added to the Packages table and orders are being added in the OrderDetail table. Yesterday it started returning the Packaged field from the InventoryPrep query instead. </p>\n\n<p>I tried a bunch of things and then created a table from the query and used the SELECT statement to look it up in the table. That worked. There is something about my query set up that has caused it to stop recognizing my calculated field. I need help! </p>\n\n<p>This is my first time posting and I hope this is enough information. I'm pretty new to Access and VBA but I've learned a lot from reading in this forum. I hope someone can help or let me know what other information could shed light on the problem. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "edited": false, "score": 0, "creation_date": 1505948850, "post_id": 46332953, "comment_id": 79626798, "body": "It&#39;s printing to the immediate window. Press Ctrl+G to show it in the VBA. Where do you want the names printed?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1505949910, "post_id": 46332953, "comment_id": 79627089, "body": "you are already doing it."}], "answers": [{"comments": [{"owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "edited": false, "score": 0, "creation_date": 1506098400, "post_id": 46333168, "comment_id": 79698413, "body": "This code also opens the selected excel file. How do we avoid that?"}, {"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "reply_to_user": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "edited": false, "score": 0, "creation_date": 1506130353, "post_id": 46333168, "comment_id": 79709600, "body": "You need to close it after you got sheet names."}, {"owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "edited": false, "score": 0, "creation_date": 1506320430, "post_id": 46333168, "comment_id": 79754479, "body": "Thanks, This is very close to what I wanted!"}], "tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": true, "score": 1, "last_activity_date": 1506130390, "last_edit_date": 1506130390, "creation_date": 1505950119, "answer_id": 46333168, "question_id": 46332953, "link": "https://stackoverflow.com/questions/46332953/loop-through-sheets-in-a-workbook-by-its-file-path/46333168#46333168", "title": "Loop through sheets in a workbook by its file path", "body": "<p>You need to open that file before you get sheets names:</p>\n\n<pre><code>Dim sFilePath As String\nsFilePath = Application.GetOpenFilename()\nWorkbooks.Open (sFilePath)\n\nFor Each sht In ActiveWorkbook.Sheets\n      Debug.Print sht.Name\nNext sht\n\n'to close sFilePath workbook\nActiveWorkbook.Close False\n</code></pre>\n\n<p>Hope this help.</p>\n"}, {"comments": [{"owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "edited": false, "score": 0, "creation_date": 1506121036, "post_id": 46333223, "comment_id": 79707915, "body": "I was hoping if there&#39;s a way to do this without opening the file ( the file doesnt pop up on the screen)?"}], "tags": [], "owner": {"reputation": 11, "user_id": 2870075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v0A0h.jpg?s=128&g=1", "display_name": "FrozenButter", "link": "https://stackoverflow.com/users/2870075/frozenbutter"}, "is_accepted": false, "score": 1, "last_activity_date": 1505950436, "creation_date": 1505950436, "answer_id": 46333223, "question_id": 46332953, "link": "https://stackoverflow.com/questions/46332953/loop-through-sheets-in-a-workbook-by-its-file-path/46333223#46333223", "title": "Loop through sheets in a workbook by its file path", "body": "<p>to print file and sheets in a given directory:</p>\n\n<pre><code>    Sub Main()\n\n    filePath = \"C:\\Users\\jesse\\Documents\\ExcelTest\\\"     'folder to search\n    currentFile = Dir(filePath &amp; \"*.xls*\")\n    Do Until currentFile = \"\"\n\n        Debug.Print currentFile\n        Set Workbook = Workbooks.Open(filePath &amp; currentFile, False, True)\n\n        For Each Sheet In Workbook.Sheets\n            Debug.Print Sheet.Name\n        Next Sheet\n\n        Workbook.Close SaveChanges:=False\n        currentFile = Dir\n   Loop\n\n    Set Workbook = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Hope this solved your problem. cheers!</p>\n"}], "owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "accepted_answer_id": 46333168, "answer_count": 2, "score": 0, "last_activity_date": 1506130390, "creation_date": 1505948475, "question_id": 46332953, "link": "https://stackoverflow.com/questions/46332953/loop-through-sheets-in-a-workbook-by-its-file-path", "title": "Loop through sheets in a workbook by its file path", "body": "<p>I want to print all the sheet names in a particular excel sheet. If I was doing it for the current workbook, this is how my code would be:</p>\n\n<pre><code>For Each sht In ActiveWorkbook.Sheets\n      Debug.Print sht.Name\nNext sht\n</code></pre>\n\n<p>I want to print the names of all the sheets present in a variable, say <code>sFilePath</code> which is the absolute file path of an excel file. How do I print the names of all the sheets in that excel file? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "edited": false, "score": 0, "creation_date": 1505948476, "post_id": 46332909, "comment_id": 79626694, "body": "<code>I&#39;d like to have it copy to a new worksheet</code> It looks like you&#39;re already copying to a new worksheet. Or do you mean a new Excel document?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1505948738, "post_id": 46332909, "comment_id": 79626769, "body": "What sheet do you expect the <code>If Range(&quot;G&quot; &amp; r)...</code> lines? You don&#39;t reference a worksheet there like you do later <code>ws.Cells()</code>...  Also, is the <code>46704</code>... all a range? Perhaps just <code>If [range] &gt;= 46704 and [range] &lt;= 46899</code>?"}, {"owner": {"reputation": 19, "user_id": 8644881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0l3R0hMLlsw/AAAAAAAAAAI/AAAAAAAAGFc/xyMEp_fOyGA/photo.jpg?sz=128", "display_name": "Jason Denniston", "link": "https://stackoverflow.com/users/8644881/jason-denniston"}, "edited": false, "score": 0, "creation_date": 1505949335, "post_id": 46332909, "comment_id": 79626936, "body": "No, unfortunately, these are a specific set of unique values."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1505949340, "post_id": 46332909, "comment_id": 79626939, "body": "The <code>If</code> statement could potentially be done as <code>If InStr(&quot;|46704|46741|46743|....|46898|46899|&quot;, &quot;|&quot; &amp; ws1.Range(&quot;G&quot; &amp; r).Value &amp; &quot;|&quot;) &gt; 0 Then</code>.  (I&#39;m assuming the values you are checking are from <code>&quot;Sheet1&quot;</code> based on the use of <code>For r = 2 To lr</code> where <code>lr</code> is the number of rows in column G on <code>&quot;Sheet1&quot;</code>.)"}, {"owner": {"reputation": 19, "user_id": 8644881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0l3R0hMLlsw/AAAAAAAAAAI/AAAAAAAAGFc/xyMEp_fOyGA/photo.jpg?sz=128", "display_name": "Jason Denniston", "link": "https://stackoverflow.com/users/8644881/jason-denniston"}, "edited": false, "score": 0, "creation_date": 1506305842, "post_id": 46332909, "comment_id": 79750589, "body": "A lot of the suggestions that have been made are over my head, but I&#39;m working on learning and implementing them as I go.  Thank you for all your suggestions."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505951223, "post_id": 46333048, "comment_id": 79627389, "body": "<code>Rows(r)</code> should also be <code>ws1.Rows(r)</code>, and <code>lr = ws1.Cells(Rows.Count, &quot;G&quot;).End(xlUp).Row</code> should be <code>lr = ws1.Cells(ws1.Rows.Count, &quot;G&quot;).End(xlUp).Row</code>, and <code>ws2.Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row</code> should be <code>ws2.Cells(ws2.Rows.Count, &quot;A&quot;).End(xlUp).Row</code>."}], "tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1505949668, "last_edit_date": 1505949668, "creation_date": 1505949118, "answer_id": 46333048, "question_id": 46332909, "link": "https://stackoverflow.com/questions/46332909/have-a-working-excel-macro-need-help-tweaking-it/46333048#46333048", "title": "Have a working Excel macro, need help tweaking it", "body": "<p>You can try this code to copy to a new sheet:</p>\n\n<pre><code>Set ws2 = Sheets.Add After:=Sheets(Sheets.Count)\n</code></pre>\n\n<p>Also, you need to reference a worksheet here Range(\"G\" &amp; r).Value </p>\n\n<pre><code>ws1.Range(\"G\" &amp; r).Value \n</code></pre>\n\n<p>Hope this help.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 8644881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0l3R0hMLlsw/AAAAAAAAAAI/AAAAAAAAGFc/xyMEp_fOyGA/photo.jpg?sz=128", "display_name": "Jason Denniston", "link": "https://stackoverflow.com/users/8644881/jason-denniston"}, "edited": false, "score": 0, "creation_date": 1506307585, "post_id": 46333400, "comment_id": 79750932, "body": "I am working on implementing the section version.  It works awesome. Thanks!  The thing I&#39;d like to be able to do is have it copy to a new workbook. Is that possible?  p.s. I see I said worksheet in the original post, I meant workbook."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 19, "user_id": 8644881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0l3R0hMLlsw/AAAAAAAAAAI/AAAAAAAAGFc/xyMEp_fOyGA/photo.jpg?sz=128", "display_name": "Jason Denniston", "link": "https://stackoverflow.com/users/8644881/jason-denniston"}, "edited": false, "score": 0, "creation_date": 1506318989, "post_id": 46333400, "comment_id": 79753868, "body": "I updated <code>AllenAutoFilter()</code> to copy data to a new Workbook. Every time you run it you&#39;ll get a new file (behind the initial one) usually called Book2, 3, etc"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1506318856, "last_edit_date": 1506318856, "creation_date": 1505951948, "answer_id": 46333400, "question_id": 46332909, "link": "https://stackoverflow.com/questions/46332909/have-a-working-excel-macro-need-help-tweaking-it/46333400#46333400", "title": "Have a working Excel macro, need help tweaking it", "body": "<p>Here is a simplified versions using an <strong><code>AutoFilter()</code></strong></p>\n\n<hr>\n\n<blockquote>\n<pre><code>Public Sub AllenAutoFilter()\n   Const SET1 = \"46704,46741,46743,46745,46748,46765,46773,46774,46788,46797,46798,46799,\"\n   Const SET2 = \"46801,46802,46803,46804,46805,46806,46807,46808,46809,46814,46815,46816,\"\n   Const SET3 = \"46818,46819,46825,46835,46845,46850,46851,46852,46853,46854,46855,46856,\"\n   Const SET4 = \"46857,46858,46859,46860,46861,46862,46863,46864,46865,46866,46867,46868,\"\n   Const SET5 = \"46869,46885,46895,46896,46897,46898,46899\"\n   Const ALL = SET1 &amp; SET2 &amp; SET3 &amp; SET4 &amp; SET5\n\n   Dim ws1 As Worksheet, ws2 As Worksheet, lr1 As Long, lr2 As Long, arr As Variant\n\n    arr = Split(ALL, \",\")\n    Application.ScreenUpdating = False\n    With ThisWorkbook\n        Set ws1 = .Worksheets(\"Sheet1\")\n        Set ws2 = Workbooks.Add.Worksheets(1)    'New Workbook, Sheet1\n    End With\n\n    ws1.AutoFilterMode = False\n    lr1 = ws1.Cells(Rows.Count, \"G\").End(xlUp).Row\n    lr2 = ws2.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\n    With ws1.UsedRange\n        .Columns(7).AutoFilter Field:=1, Criteria1:=arr, Operator:=xlFilterValues\n        .Offset(1).Resize(lr1 - 1).Rows.Copy Destination:=ws2.Range(\"A\" &amp; lr2)\n    End With\n    ws1.AutoFilterMode = False\n\n    ws1.Activate\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 8644881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0l3R0hMLlsw/AAAAAAAAAAI/AAAAAAAAGFc/xyMEp_fOyGA/photo.jpg?sz=128", "display_name": "Jason Denniston", "link": "https://stackoverflow.com/users/8644881/jason-denniston"}, "edited": false, "score": 0, "creation_date": 1506305893, "post_id": 46333463, "comment_id": 79750602, "body": "I implemented the case section, and have it working.  Thank you so much for your input."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1505952526, "creation_date": 1505952526, "answer_id": 46333463, "question_id": 46332909, "link": "https://stackoverflow.com/questions/46332909/have-a-working-excel-macro-need-help-tweaking-it/46333463#46333463", "title": "Have a working Excel macro, need help tweaking it", "body": "<p>you can use case statement</p>\n\n<pre><code>Option Explicit\n\nSub Allen()\n    Dim lr1 As Long, lr2 As Long, r As Long, ws1 As Worksheet, ws2 As Worksheet, n As Long\n    Application.ScreenUpdating = False\n    Set ws1 = Sheets(\"Sheet1\")\n    Set ws2 = Sheets(\"Sheet2\")\n    n = 2\n    lr1 = ws1.Cells(Rows.Count, \"G\").End(xlUp).Row\n    lr2 = ws2.Cells(Rows.Count, \"A\").End(xlUp).Row\n        For r = 2 To lr1\n            Select Case CDec(Range(\"G\" &amp; r).Value) - 46000      ' convert to number and subtract 46000 to make lookup list smaller\n\n                Case 704, 741, 743, 745, 748, 765, 773, 774, _\n                     788, 797, 798, 799, 801, 802, 803, 804, _\n                     805, 806, 807, 808, 809, 814, 815, 816, _\n                     818, 819, 825, 835, 845, 850, 851, 852, _\n                     853, 854, 855, 856, 857, 858, 859, 860, _\n                     861, 862, 863, 864, 865, 866, 867, 868, _\n                     869, 885, 895, 896, 897, 898, 899\n\n                    Rows(r).Copy Destination:=ws2.Range(\"A\" &amp; n + 1)\n                    n = ws2.Cells(Rows.Count, \"A\").End(xlUp).Row\n            End Select\n        Next r\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1505954267, "creation_date": 1505954267, "answer_id": 46333666, "question_id": 46332909, "link": "https://stackoverflow.com/questions/46332909/have-a-working-excel-macro-need-help-tweaking-it/46333666#46333666", "title": "Have a working Excel macro, need help tweaking it", "body": "<p>here is one that uses range objects only (no counting lines)</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Application.ScreenUpdating = False\n\n    Dim ws1 As Worksheet\n    Set ws1 = Sheets(\"Sheet1\")\n\n    Dim ws2 As Worksheet\n    Set ws2 = Sheets(\"Sheet2\")\n\n    Dim lr1 As Range\n    Set lr1 = Range(ws1.Cells(2, \"G\"), ws1.Cells(Rows.Count, \"G\").End(xlUp))\n\n    Dim lr2 As Range\n    Set lr2 = ws2.Cells(Rows.Count, \"A\").End(xlUp).Offset(1) ' point to next empty cell\n\n    Dim r As Range\n    For Each r In lr1\n\n        Select Case CDec(r.Value) - 46000   ' convert to number and subtract 46000 to make lookup list smaller\n\n            Case 704, 741, 743, 745, 748, 765, 773, 774, _\n                 788, 797, 798, 799, 801, 802, 803, 804, _\n                 805, 806, 807, 808, 809, 814, 815, 816, _\n                 818, 819, 825, 835, 845, 850, 851, 852, _\n                 853, 854, 855, 856, 857, 858, 859, 860, _\n                 861, 862, 863, 864, 865, 866, 867, 868, _\n                 869, 885, 895, 896, 897, 898, 899\n\n                r.EntireRow.Copy Destination:=lr2\n                Set lr2 = lr2.Offset(1)              ' point to next empty cell\n        End Select\n\n    Next r\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8644881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0l3R0hMLlsw/AAAAAAAAAAI/AAAAAAAAGFc/xyMEp_fOyGA/photo.jpg?sz=128", "display_name": "Jason Denniston", "link": "https://stackoverflow.com/users/8644881/jason-denniston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1506318856, "creation_date": 1505948193, "last_edit_date": 1505948953, "question_id": 46332909, "link": "https://stackoverflow.com/questions/46332909/have-a-working-excel-macro-need-help-tweaking-it", "title": "Have a working Excel macro, need help tweaking it", "body": "<p>I have this macro that does a good job of copying rows to another sheet.  There are a few tweaks I'd like to make to it, but I'm not sure how.</p>\n\n<p>1) I'd like to have it copy to a new worksheet.</p>\n\n<p>2) Is there a way to simplify the \"If Range(\"G\" &amp; r).Value = \"46704\" Or\" section? Like list them with commas or something?</p>\n\n<pre><code>Sub Allen()\nDim lr As Long, lr2 As Long, r As Long, ws1 As Worksheet, ws2 As Worksheet, n As Long\nApplication.ScreenUpdating = False\nSet ws1 = Sheets(\"Sheet1\")\nSet ws2 = Sheets(\"Sheet2\")\nn = 2\nlr = ws1.Cells(Rows.Count, \"G\").End(xlUp).Row\nlr2 = ws2.Cells(Rows.Count, \"A\").End(xlUp).Row\n    For r = 2 To lr\n    If Range(\"G\" &amp; r).Value = \"46704\" Or Range(\"G\" &amp; r).Value = \"46741\" Or Range(\"G\" &amp; r).Value = \"46743\" Or Range(\"G\" &amp; r).Value = \"46745\" Or Range(\"G\" &amp; r).Value = \"46748\" Or Range(\"G\" &amp; r).Value = \"46765\" Or Range(\"G\" &amp; r).Value = \"46773\" Or Range(\"G\" &amp; r).Value = \"46774\" Or Range(\"G\" &amp; r).Value = \"46788\" Or Range(\"G\" &amp; r).Value = \"46797\" Or Range(\"G\" &amp; r).Value = \"46798\" Or Range(\"G\" &amp; r).Value = \"46799\" Or Range(\"G\" &amp; r).Value = \"46801\" Or Range(\"G\" &amp; r).Value = \"46802\" Or Range(\"G\" &amp; r).Value = \"46803\" Or Range(\"G\" &amp; r).Value = \"46804\" Or Range(\"G\" &amp; r).Value = \"46805\" Or Range(\"G\" &amp; r).Value = \"46806\" Or Range(\"G\" &amp; r).Value = \"46807\" Or Range(\"G\" &amp; r).Value = \"46808\" Or Range(\"G\" &amp; r).Value = \"46809\" Or Range(\"G\" &amp; r).Value = \"46814\" Or Range(\"G\" &amp; r).Value = \"46815\" Or Range(\"G\" &amp; r).Value = \"46816\" Or Range(\"G\" &amp; r).Value = \"46818\" Or Range(\"G\" &amp; r).Value = \"46819\" Or Range(\"G\" &amp; r).Value = \"46825\" Or Range(\"G\" &amp; r).Value = \"46835\" Or Range(\"G\" &amp; r).Value = \"46845\" _\n        Or Range(\"G\" &amp; r).Value = \"46850\" Or Range(\"G\" &amp; r).Value = \"46851\" Or Range(\"G\" &amp; r).Value = \"46852\" Or Range(\"G\" &amp; r).Value = \"46853\" Or Range(\"G\" &amp; r).Value = \"46854\" Or Range(\"G\" &amp; r).Value = \"46855\" Or Range(\"G\" &amp; r).Value = \"46856\" Or Range(\"G\" &amp; r).Value = \"46857\" Or Range(\"G\" &amp; r).Value = \"46858\" Or Range(\"G\" &amp; r).Value = \"46859\" Or Range(\"G\" &amp; r).Value = \"46860\" Or Range(\"G\" &amp; r).Value = \"46861\" Or Range(\"G\" &amp; r).Value = \"46862\" Or Range(\"G\" &amp; r).Value = \"46863\" Or Range(\"G\" &amp; r).Value = \"46864\" Or Range(\"G\" &amp; r).Value = \"46865\" Or Range(\"G\" &amp; r).Value = \"46866\" Or Range(\"G\" &amp; r).Value = \"46867\" Or Range(\"G\" &amp; r).Value = \"46868\" Or Range(\"G\" &amp; r).Value = \"46869\" Or Range(\"G\" &amp; r).Value = \"46885\" Or Range(\"G\" &amp; r).Value = \"46895\" Or Range(\"G\" &amp; r).Value = \"46896\" Or Range(\"G\" &amp; r).Value = \"46897\" Or Range(\"G\" &amp; r).Value = \"46898\" Or Range(\"G\" &amp; r).Value = \"46899\" Then\n            Rows(r).Copy Destination:=ws2.Range(\"A\" &amp; n + 1)\n            n = ws2.Cells(Rows.Count, \"A\").End(xlUp).Row\n        End If\n    Next r\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1505946034, "post_id": 46332576, "comment_id": 79625990, "body": "If the code works and you are looking for optimization then this question belongs on <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>  If it does not work, then please indicated the error and on which line it throws the error."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505946528, "post_id": 46332576, "comment_id": 79626177, "body": "FWIW - the call of <code>CONCATENATE</code> in <code>=CONCATENATE(LEFT(B2,12)&amp;&quot;.pdf&quot;)</code> is unnecessary - you are only passing it a single parameter so there is nothing to actually concatenate.  Likewise with <code>=CONCATENATE(A2&amp;&quot;-&quot;&amp;LEFT(B2,12)&amp;&quot;.pdf&quot;)</code>.  The first one could just be <code>=LEFT(B2,12)&amp;&quot;.pdf&quot;</code> and the second one <code>=A2&amp;&quot;-&quot;&amp;LEFT(B2,12)&amp;&quot;.pdf&quot;</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1505948718, "post_id": 46332576, "comment_id": 79626766, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Don&#39;t use <code>.Activate</code>/<code>.Select</code></a>!"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1505952931, "post_id": 46332576, "comment_id": 79627767, "body": "Create a UDF which takes 2 range inputs for Cols A, B. Then use this UDF in your worksheet without wasting columns. The UDF will do equalivent of those formulas with less fuss. Alternatively use the Sub to generate final file name via loop (manually invoked)."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 6169585, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10209152628042674/picture?type=large", "display_name": "William Lombard", "link": "https://stackoverflow.com/users/6169585/william-lombard"}, "edited": false, "score": 0, "creation_date": 1506023803, "post_id": 46337248, "comment_id": 79664627, "body": "HI Sktneer, that really is incredible. An operation that was at at least 20 seconds of hoping and praying Excel would not crash on itself is over in a blink of an eye. Tried it for 2000 records and still deathly quick. Thanks so much."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 155, "user_id": 6169585, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10209152628042674/picture?type=large", "display_name": "William Lombard", "link": "https://stackoverflow.com/users/6169585/william-lombard"}, "edited": false, "score": 0, "creation_date": 1506052644, "post_id": 46337248, "comment_id": 79672981, "body": "@WilliamLombard You&#39;re welcome! Glad it worked for you. Please take a minute to accept the solution to mark your question as Solved."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1505976641, "creation_date": 1505976641, "answer_id": 46337248, "question_id": 46332576, "link": "https://stackoverflow.com/questions/46332576/how-to-optimise-my-concatenate-vba-script-in-excel/46337248#46337248", "title": "How to optimise my CONCATENATE vba script in Excel?", "body": "<p>You may give this a try...</p>\n\n<pre><code>Sub RenamePDFFiles()\nDim lr As Long\nlr = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nWith Application\n    .Calculation = xlCalculationManual\n    .EnableAutoComplete = False\n    .ScreenUpdating = False\nEnd With\nRange(\"C2:C\" &amp; lr).Formula = \"=IF(B2=\"\"\"\",\"\"\"\",LEFT(B2,12)&amp;\"\".pdf\"\")\"\nRange(\"C2:C\" &amp; lr).Value = Range(\"C2:C\" &amp; lr).Value\n\nRange(\"D2:D\" &amp; lr).Formula = \"=IF(AND(A2=\"\"\"\",B2=\"\"\"\"),\"\"\"\",A2&amp;\"\"-\"\"&amp;LEFT(B2,12)&amp;\"\".pdf\"\")\"\nRange(\"D2:D\" &amp; lr).Value = Range(\"D2:D\" &amp; lr).Value\n\nColumns(\"A:B\").Delete\n\nWith Application\n    .Calculation = xlCalculationAutomatic\n    .EnableAutoComplete = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>For formula in column D, I have used <strong>AND</strong> function for the logical test so that if both columns A and B are empty, the corresponding cell in column D will also be empty. If required, change it to <strong>OR</strong> condition.</p>\n"}], "owner": {"reputation": 155, "user_id": 6169585, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10209152628042674/picture?type=large", "display_name": "William Lombard", "link": "https://stackoverflow.com/users/6169585/william-lombard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 46337248, "answer_count": 1, "score": 0, "last_activity_date": 1505976641, "creation_date": 1505945876, "question_id": 46332576, "link": "https://stackoverflow.com/questions/46332576/how-to-optimise-my-concatenate-vba-script-in-excel", "title": "How to optimise my CONCATENATE vba script in Excel?", "body": "<p>I've managed to put together a VBA script to automate the concatenating of strings in adjoining columns for the purpose of working with a Python/Applescript tool I've programmed for assisting with renaming of thousands of pdfs files. </p>\n\n<p>There are four columns being worked on. </p>\n\n<p>Col A - an article number for a particular computer in the organisation. 5 digits</p>\n\n<p>Col B - the manufacturer's serial number for a given article number. Several digits long, but only the first 12 are important.</p>\n\n<p>Col C - has a CONCATENATE function to derive the original name of a given PDF file related to a given serial number. \"=CONCATENATE(LEFT(B2,12)&amp;\".pdf\")\"</p>\n\n<p>Col D - has another CONCATENATE to help to define the <strong>new</strong> name of the PDF. \"=CONCATENATE(A2&amp;\"-\"&amp;LEFT(B2,12)&amp;\".pdf\")\"</p>\n\n<p>An example of what I am talking about...</p>\n\n<p>\"DMPQ44VZF4YD.pdf\" gets renamed to \"45872-DMPQ44VZF4YD.pdf\"</p>\n\n<p>I've recored a macro to record my using the CONCATENATE functions in cols C and D, then using autofill to drag that down manually to the bottom of the spreadsheet, then copying and pasting those (<strong>by value</strong>) to columns E and F and then deleting the columns A - D (inclusive) to leave behind only what I want. A messy way of doing things but it gets the job done.</p>\n\n<p>Each Excel file can have a differing number of records/rows. I've arbitrarily set it to 1500 items in the VBA script. Please take a look...</p>\n\n<pre><code>Sub Macro1()\n\nMacro1 Macro\n\n\n\nRange(\"C2\").Select\nActiveCell.FormulaR1C1 = \"=CONCATENATE(LEFT(RC[-1],12)&amp;\"\".pdf\"\")\"\nRange(\"C2\").Select\nSelection.AutoFill Destination:=Range(\"C2:C1500\"), Type:=xlFillDefault\nRange(\"C2:C174\").Select\nRange(\"D179\").Select\nActiveWindow.SmallScroll Down:=-364\nRange(\"D2\").Select\nActiveCell.FormulaR1C1 = \"=CONCATENATE(RC[-3]&amp;\"\"-\"\"&amp;LEFT(RC[-2],12)&amp;\"\".pdf\"\")\"\nRange(\"D2\").Select\nSelection.AutoFill Destination:=Range(\"D2:D1500\"), Type:=xlFillDefault\nRange(\"D2:D174\").Select\nActiveWindow.SmallScroll ToRight:=-2\nActiveWindow.SmallScroll Down:=-528\nColumns(\"C:D\").Select\nSelection.Copy\nColumns(\"F:F\").Select\nSelection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=False\nColumns(\"A:E\").Select\nApplication.CutCopyMode = False\nSelection.Delete Shift:=xlToLeft\nRows(\"1:1\").Select\nSelection.Delete Shift:=xlUp\nRange(\"D5\").Select\n\nDim Rng As Range\nFor Each Rng In ActiveSheet.UsedRange\n  If Rng.Value2 = \".pdf\" Or Rng.Value2 = \"-.pdf\" Then Rng.ClearContents\nNext Rng\n\nEnd Sub\n</code></pre>\n\n<p>It works well but can take a while to process (due to the arbitrarily high number of possible records in a given sheet, perhaps as well as the 'for' loop at the end to get rid of any trailing \".pdfs\" and \"-.pdfs\" that are a hangover from otherwise empty cells affected by the CONCATENATE function). Is there any way of making the more efficient when dealign with a small number of records or perhaps making it easily more scalable?</p>\n\n<p>Here is a link to the <a href=\"https://www.dropbox.com/s/gs9clcs58nu3ljy/Module21.bas?dl=0\" rel=\"nofollow noreferrer\">code</a> if that helps. </p>\n\n<p>Thanks once again.</p>\n\n<p>Will </p>\n"}, {"tags": ["excel", "vba", "pivot-table", "slicers"], "answers": [{"comments": [{"owner": {"reputation": 2174, "user_id": 2008576, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4f8209c20efe49a204fcc7e6e7862d0f?s=128&d=identicon&r=PG", "display_name": "tbur", "link": "https://stackoverflow.com/users/2008576/tbur"}, "edited": false, "score": 0, "creation_date": 1506041213, "post_id": 46335470, "comment_id": 79670309, "body": "Thank you for your reply! (And the only one, to boot.) I just had a thought. Using Power Query, I could add an Index, then produce two tables. The original data, and a second table (with some M futzing) that has the original index duplicated for each of the two Doctors per line. Then using PowerPivot, connect the two tables with an inner join. Then, have the Slicer filter the second dataset. Just thinking out loud here. And hey, thanks for that link. SNB&#39;s code always amazes and your additions make the original code so much more useful. Yeah, I copied that!"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 1, "last_activity_date": 1505967925, "creation_date": 1505967925, "answer_id": 46335470, "question_id": 46332550, "link": "https://stackoverflow.com/questions/46332550/or-criteria-on-pivottable-via-slicer/46335470#46335470", "title": "Or criteria on PivotTable via Slicer?", "body": "<p>To get a slicer to work this way you would have to add a new column - let's call it \"Doctor Who\" - and then list each item in the raw data twice...the first time with the name from Doctor_1 in the \"Doctor Who\" column, and the second time with Doctor_2 in the \"Doctor Who\" column. </p>\n\n<p>One way you could do this is by unpivoting the data, so that Doctor_1 and Doctor_2 get consolidated into a new field called \"Doctor\". If you have a version of Excel with the PowerQuery functionality (aka \"Get and Transform\") you can use that. Otherwise you could use the code I wrote previously at <a href=\"http://dailydoseofexcel.com/archives/2013/11/21/unpivot-shootout/\" rel=\"nofollow noreferrer\">http://dailydoseofexcel.com/archives/2013/11/21/unpivot-shootout/</a> to do this. Or give Google a spin for \"UnPivot\" and \"Excel\"</p>\n"}], "owner": {"reputation": 2174, "user_id": 2008576, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4f8209c20efe49a204fcc7e6e7862d0f?s=128&d=identicon&r=PG", "display_name": "tbur", "link": "https://stackoverflow.com/users/2008576/tbur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1505967925, "creation_date": 1505945727, "question_id": 46332550, "link": "https://stackoverflow.com/questions/46332550/or-criteria-on-pivottable-via-slicer", "title": "Or criteria on PivotTable via Slicer?", "body": "<p>I have a mind-bender here. There is a PivotTable with two columns representing Doctors. So the first column heading is <strong>Doctor_1</strong> and next to it is <strong>Doctor_2</strong>.</p>\n\n<p>Each line in the pivot table represents an interaction between two doctors. Like, one consults the other. So any Doctor can be Doctor_1 or Doctor_2.</p>\n\n<p>I've been figure out a way to have a Slicer emulate an \"Or\" condition on the two columns such that if \"Dr. Smith\" exists in either column, that line is retained while others are filtered.</p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1505948909, "post_id": 46332542, "comment_id": 79626815, "body": "It&#39;s not very clear what you want to do here.  You may need to separate out your positive and negative values into two different series, and change the sign on your negative values.  Then plot both sets on the same plot."}], "answers": [{"comments": [{"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "reply_to_user": {"reputation": 100, "user_id": 788748, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0bdf339d3b8f6f0464820259e034e6a?s=128&d=identicon&r=PG", "display_name": "Adnan Al-Husain", "link": "https://stackoverflow.com/users/788748/adnan-al-husain"}, "edited": false, "score": 0, "creation_date": 1505948834, "post_id": 46332890, "comment_id": 79626793, "body": "For Axis yes, I have try it."}, {"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "reply_to_user": {"reputation": 100, "user_id": 788748, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0bdf339d3b8f6f0464820259e034e6a?s=128&d=identicon&r=PG", "display_name": "Adnan Al-Husain", "link": "https://stackoverflow.com/users/788748/adnan-al-husain"}, "edited": false, "score": 0, "creation_date": 1505948984, "post_id": 46332890, "comment_id": 79626836, "body": "If you mean it is for data series bar, I think you need to try the tricks in this link: <a href=\"https://www.extendoffice.com/documents/excel/2218-excel-chart-negative-values-different-color.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a> but it still cannot change negative number to positive."}, {"owner": {"reputation": 100, "user_id": 788748, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0bdf339d3b8f6f0464820259e034e6a?s=128&d=identicon&r=PG", "display_name": "Adnan Al-Husain", "link": "https://stackoverflow.com/users/788748/adnan-al-husain"}, "edited": false, "score": 0, "creation_date": 1506073489, "post_id": 46332890, "comment_id": 79682873, "body": "yea ..the trick is to have them both in the same side (positive) with highlighting negative values by red."}], "tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1505948018, "creation_date": 1505948018, "answer_id": 46332890, "question_id": 46332542, "link": "https://stackoverflow.com/questions/46332542/excel-vba-charting-how-to-have-positive-and-negative-values-above-0-but-red-gre/46332890#46332890", "title": "Excel VBA Charting: How to have positive and negative values above 0 but red green colors?", "body": "<p>Select chart Axis (Y/X). Select Format Selection on Format tab. Find \"Number\" on the right box. Change Category to Number and select/change Negative Number box to red value.</p>\n\n<p>Hope this help.</p>\n"}], "owner": {"reputation": 100, "user_id": 788748, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0bdf339d3b8f6f0464820259e034e6a?s=128&d=identicon&r=PG", "display_name": "Adnan Al-Husain", "link": "https://stackoverflow.com/users/788748/adnan-al-husain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505948018, "creation_date": 1505945670, "question_id": 46332542, "link": "https://stackoverflow.com/questions/46332542/excel-vba-charting-how-to-have-positive-and-negative-values-above-0-but-red-gre", "title": "Excel VBA Charting: How to have positive and negative values above 0 but red green colors?", "body": "<p>I believe there is a little trick that I can't figure out.</p>\n\n<p>Excel VBA Charting: How to have positive and negative values above 0 but red green colors?</p>\n\n<p>I need to easy compare negative positive values.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "solver"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505945139, "post_id": 46332216, "comment_id": 79625650, "body": "Have you tested to see what effect setting <code>Application.Calculation</code> to <code>xlCalculationManual</code> has?  (I <b>think</b> Solver will force a calculation of the active sheet even if the overall calculation method is &quot;Manual&quot;.)"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1505945186, "post_id": 46332216, "comment_id": 79625669, "body": "&quot;Why would solver take longer to run with two books open even though it&#39;s not even touching one of them?&quot; &gt; Likely because you do not have enough RAM/Memory, also the issue with 32-bit software these days."}, {"owner": {"reputation": 150, "user_id": 7420464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1b1893b73a50174583069fdd7493d2?s=128&d=identicon&r=PG&f=1", "display_name": "fallengyro", "link": "https://stackoverflow.com/users/7420464/fallengyro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505946654, "post_id": 46332216, "comment_id": 79626211, "body": "@YowE3K Good thought! I was thinking the same thing. At first hesitant to try since I was concerned that my objective function would not update. Gave it a shot, no change. I think that calculation method might always be handled at the application level (even if solver is controlling it. i.e., everything is being set back to automatic). Good thought though, thanks!"}, {"owner": {"reputation": 150, "user_id": 7420464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1b1893b73a50174583069fdd7493d2?s=128&d=identicon&r=PG&f=1", "display_name": "fallengyro", "link": "https://stackoverflow.com/users/7420464/fallengyro"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1505947250, "post_id": 46332216, "comment_id": 79626373, "body": "@KDavis, it&#39;s possible. Forgive my ignorance regarding memory allocation, but if I look in taskmanager, I have ~4G free and Excel is only using ~200,000 K. Should this mean I&#39;m not pressing up against system or 32-bit application limits?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 14929979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed069687465c8e6fb3d7bb0a01d81f1e?s=128&d=identicon&r=PG", "display_name": "S. Rubin", "link": "https://stackoverflow.com/users/14929979/s-rubin"}, "is_accepted": false, "score": 0, "last_activity_date": 1609642232, "creation_date": 1609642232, "answer_id": 65546217, "question_id": 46332216, "link": "https://stackoverflow.com/questions/46332216/excel-solver-slow-due-to-second-workbook/65546217#65546217", "title": "Excel Solver slow due to second workbook", "body": "<p>The presence of 'workbook 2' is correlated but not causal.  In my case there is one particular workbook that causes the solver slowdown; most others don't.  The workbook that causes the slowdown is about 4mb.  Much larger workbooks do not cause a slowdown.  The one causing the slowdown does not to the best of my knowledge contain either macros or VB. I recommend that this problem be shown to Frontline systems who developed the original solver.</p>\n"}], "owner": {"reputation": 150, "user_id": 7420464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1b1893b73a50174583069fdd7493d2?s=128&d=identicon&r=PG&f=1", "display_name": "fallengyro", "link": "https://stackoverflow.com/users/7420464/fallengyro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 604, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1609642232, "creation_date": 1505943908, "last_edit_date": 1505946715, "question_id": 46332216, "link": "https://stackoverflow.com/questions/46332216/excel-solver-slow-due-to-second-workbook", "title": "Excel Solver slow due to second workbook", "body": "<p>I've noticed something new today that will cause me problems in the future regarding Excel's Solver, so I want to get a jump on it.</p>\n\n<p>I'm using VBA to sequentially apply solver moving down a sheet (let's say this sheet belongs to 'workbook 1'). This all works fine and I'm happy with the results of Solver. Yay... My concern is this: When I have a second rather large workbook open (let's call this 'workbook 2'), WHICH HAS ABOSOLUTELY NO LINKS TO MY CURRENT WORKBOOK, Solver takes around 20 times as long to run.</p>\n\n<p>Naturally the most reasonable thing to do is not have 'workbook 2' open when Solver is running. For now that's my solution, however, in the very near future I will need to have both workbooks open simultaneously. So I pose the following question:</p>\n\n<p>Why would solver take longer to run with two books open even though it's not even touching one of them?</p>\n\n<p>In case skeptics are concerned that my code is doing something unusual here it is:</p>\n\n<pre><code>Sub ExampleSeqSolver()\nDim Iter As Long\nDim Time0 As Double\nDim Duration As Double\n\nApplication.ScreenUpdating = False\n' Solver requires that it is working on the 'active sheet', silly but w/e\nSheets(\"Sheet1\").Activate\n' watch optimization efficiency\nTime0 = Timer\n\nFor Iter = 2 To 13\n\n    ' my data are sometimes related to adjacent rows so I was considering supplying an initial solution to reduce the number of runs\n    ' Sheets(\"Sheet1\").Range(\"$AC$\" &amp; ITER &amp; \":$AI$\" &amp; ITER) = _\n    ' Sheets(\"Sheet1\").Range(\"$AC$\" &amp; ITER - 1 &amp; \":$AI$\" &amp; ITER - 1)\n\n    If Cells(Iter, 1) &lt;&gt; 0 Then\n        SolverReset\n        SolverOptions AssumeNonNeg:=True, Iterations:=100\n        SolverAdd CellRef:=\"$AK\" &amp; Iter, Relation:=2, FormulaText:=\"1\"\n        SolverOK SetCell:=\"$AW$\" &amp; Iter, MaxMinVal:=\"2\", ByChange:=Sheets(\"Sheet1\").Range(\"$AC$\" &amp; Iter &amp; \":$AI$\" &amp; Iter), Engine:=1\n        SolverSolve True\n    End If\n\nNext Iter\n\n' report optimization duration\nDuration = Round(Timer - Time0, 2)\nMsgBox \"Optimization finished in \" &amp; Duration &amp; \" seconds\", vbInformation\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "dictionary", "syntax", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505943942, "post_id": 46332175, "comment_id": 79625191, "body": "Maybe replace <code>i</code> with <code>rngrow.Row - 1</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505944455, "post_id": 46332175, "comment_id": 79625390, "body": "Argh! I had suggested an alternative to <code>rngrow.Row - 1</code>, then deleted it because I thought the cells were on different sheets, but now realise that they aren&#39;t.  So, I&#39;ll suggest it again - you can use <code>rngrow.Cells(1, 1).Value</code> instead of <code>x(i, 1)</code> and <code>rngrow.Cells(1, 3).Value</code> instead of <code>x2(i, 1)</code>."}, {"owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1506008899, "post_id": 46332175, "comment_id": 79656647, "body": "@YowE3K Thanks for both those solutions, The <code>rngrow.row-1</code> replacing <code>i</code> works -- Your solution below also works and I think is slightly more transparent so I&#39;m applying that to my code."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1505944353, "creation_date": 1505944353, "answer_id": 46332302, "question_id": 46332175, "link": "https://stackoverflow.com/questions/46332175/creat-vba-dictionary-entry-when-criteria-is-met/46332302#46332302", "title": "Creat VBA Dictionary Entry When Criteria Is Met", "body": "<p>I would get rid of <code>rngrow</code> and just loop through rows 2 to <code>LastRow</code>:</p>\n\n<pre><code>Dim i As Long\nDim dict As Object\nDim LastRow As Long, shtReport As Worksheet\n\nSet shtReport = Worksheets(\"Mapping\")\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nWith shtReport\n    LastRow = .Range(\"G\" &amp; .Rows.Count).End(xlUp).Row\n\n    For i = 2 To LastRow\n        If .Cells(i, \"J\") = \"100\" Then\n            dict.Item(.Cells(i, \"G\").Value) = .Cells(i, \"I\").Value\n        End If\n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 46332302, "answer_count": 1, "score": 0, "last_activity_date": 1505944353, "creation_date": 1505943685, "last_edit_date": 1531164843, "question_id": 46332175, "link": "https://stackoverflow.com/questions/46332175/creat-vba-dictionary-entry-when-criteria-is-met", "title": "Creat VBA Dictionary Entry When Criteria Is Met", "body": "<p>I am new to VBA Dictionaries.  What I am trying to do is evaluate each row of a sheet.  If the value in Column J is \"100\", then I want to create a key/item entry into the dictionary.  If any other value is in Column J, I do not want the entry to be created and for the macro to look at the next row of data.</p>\n\n<p>I currently have the code below:</p>\n\n<pre><code>Dim x, x2, y, y2()\nDim i As Long\nDim dict As Object\nDim LastRowTwo As Long, shtOrders As Worksheet, shtReport As Worksheet\n\nSet shtOrders = Worksheets(\"Orders\")\nSet shtReport = Worksheets(\"Mapping\")\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nWith shtReport\n    LastRow = .Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n    x = .Range(\"G2:G\" &amp; LastRow).Value\n    x2 = .Range(\"I2:I\" &amp; LastRow).Value\n\n   Set SelectionRNG = Worksheets(\"Mapping\").Range(\"G2:J\" &amp; LastRow)\n\nFor Each rngrow In SelectionRNG.Rows\n\nIf rngrow.Cells(1, 4) = \"100\" Then\n dict.Item(x(i, 1)) = x2(i, 1)\n\nEnd If    \n Next\n  End With\n</code></pre>\n\n<p>I know that this line:</p>\n\n<pre><code>dict.Item(x(i, 1)) = x2(i, 1)\n</code></pre>\n\n<p>Is where my problem is.  I have used that syntax in the code below and it works fine:</p>\n\n<pre><code>    For i = 1 To UBound(x, 1)\n   dict.Item(x(i, 1)) = x2(i, 1)\n   Next i\n</code></pre>\n\n<p>I am stuck on how to change the syntax of either my \"rngrow code\" to add a dictionary entry without using the \"i\" or to adjust the code directly above to include an IF statement to check the value in column J (and only create an entry if J = 100 for the row currently being assessed. </p>\n\n<p>If the code above was not clear, the key would be in Column G and the item would be in column I.  (I later lookup Column G and retrieve column I's value.)</p>\n\n<p>As I said, I am new to this, so I appreciate any help!</p>\n\n<p>Cheers!</p>\n"}, {"tags": ["excel", "combobox", "vba"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505996197, "post_id": 46332154, "comment_id": 79647138, "body": "What is .Range(&quot;Location&quot;)?  Is it a custom column or Row name taht you created?"}, {"owner": {"reputation": 3, "user_id": 6705643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57cc74eb312ea8c0895859f9a9de2350?s=128&d=identicon&r=PG&f=1", "display_name": "Jester799", "link": "https://stackoverflow.com/users/6705643/jester799"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505998175, "post_id": 46332154, "comment_id": 79648666, "body": "Location is the column name in the data reference. It is also the name of the combo box. Could that be the issue?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505998955, "post_id": 46332154, "comment_id": 79649263, "body": "Yeah, but what is the column name? Is it &quot;A&quot;,&quot;B&quot;,&quot;C&quot; or did you change it to a custom name &quot;Location&quot;?"}, {"owner": {"reputation": 3, "user_id": 6705643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57cc74eb312ea8c0895859f9a9de2350?s=128&d=identicon&r=PG&f=1", "display_name": "Jester799", "link": "https://stackoverflow.com/users/6705643/jester799"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505999367, "post_id": 46332154, "comment_id": 79649605, "body": "I changed it to custom name &quot;Location&quot; same with &quot;CartName&quot;. Name manager references: CartName refers to &#39;Stockout Reference&#39;!$C:$C, Location refers to &quot;Stockout Reference&#39;!$A:$A"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506000488, "post_id": 46332154, "comment_id": 79650498, "body": "Well, i think your range is too big. Is it giving some error or just taking a long time to load? You could get the last line <code>lastrowA=wsz.Cells(wsz.Rows.Count, &quot;A&quot;).End(xlUp).Row</code> and populate with: <code>For each cell in Range(&quot;A1:A&quot;&amp;lastrowA): If cell &lt;&gt; &quot;&quot; Then Location.AddItem cell.Text: Next cell</code> assuming it starts on row 1"}, {"owner": {"reputation": 3, "user_id": 6705643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57cc74eb312ea8c0895859f9a9de2350?s=128&d=identicon&r=PG&f=1", "display_name": "Jester799", "link": "https://stackoverflow.com/users/6705643/jester799"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506001416, "post_id": 46332154, "comment_id": 79651260, "body": "No error code, and no loading at all. I will try that and let you know."}, {"owner": {"reputation": 3, "user_id": 6705643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57cc74eb312ea8c0895859f9a9de2350?s=128&d=identicon&r=PG&f=1", "display_name": "Jester799", "link": "https://stackoverflow.com/users/6705643/jester799"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506023294, "post_id": 46332154, "comment_id": 79664381, "body": "Didn&#39;t work. I rewrote my code in a new workbook and the lists are loading fine. I&#39;m still not sure what caused this error though. Thanks for the assistance anyway."}], "owner": {"reputation": 3, "user_id": 6705643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57cc74eb312ea8c0895859f9a9de2350?s=128&d=identicon&r=PG&f=1", "display_name": "Jester799", "link": "https://stackoverflow.com/users/6705643/jester799"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505995080, "creation_date": 1505943604, "last_edit_date": 1531164843, "question_id": 46332154, "link": "https://stackoverflow.com/questions/46332154/vba-combo-box-list-not-loading", "title": "VBA combo box list not loading", "body": "<p>I am having issues getting my combo boxes to populate. I have used: <a href=\"https://stackoverflow.com/questions/17946317/how-to-add-items-to-a-combobox-in-a-form-in-excel-vba\">How to add items to a combobox in a form in excel VBA?</a></p>\n\n<p>I have also made sure that my lists are named on that worksheet. What am I doing wrong?</p>\n\n<p>Here is the code for the initialization</p>\n\n<pre><code>Private Sub UserForm1_Initialize()\n    'Import Combo Box Lists\n    Dim cCart As Range\n    Dim cLoc As Range\n    Dim wsz As Worksheet\n    Set wsz = Worksheets(\"Stockout Reference\")\n\n    For Each cLoc In wsz.Range(\"Location\")\n        With Me.Location\n            .AddItem cLoc.Value\n        End With\n    Next cLoc\n\n    For Each cCart In wsz.Range(\"CartName\")\n        With Me.Cart\n            .AddItem cCart.Value\n        End With\n    Next cCart\n\n    Me.txtDate1.Value = Format(Date, \"Medium Date\")\nEnd Sub  \n</code></pre>\n\n<p>I do have code for the userform that follows this, but none of the variables are the same so I don't see how that could be an issue.</p>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1505991234, "post_id": 46331985, "comment_id": 79643822, "body": "I suggest you would use WordEditor to manipulate the text. <a href=\"https://msdn.microsoft.com/en-us/library/dd492012(v=office.12).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/dd492012(v=office.12).aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8635353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Bvdku7RAn0/AAAAAAAAAAI/AAAAAAAADqM/hb473HIAmlg/photo.jpg?sz=128", "display_name": "Pascal Stefan Buehrig", "link": "https://stackoverflow.com/users/8635353/pascal-stefan-buehrig"}, "edited": false, "score": 0, "creation_date": 1505945672, "post_id": 46332410, "comment_id": 79625865, "body": "well my strVar consists already of text pieces. I want to assign bold to them, not to write the string myself. The string text is originated by a rtf file"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 8635353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Bvdku7RAn0/AAAAAAAAAAI/AAAAAAAADqM/hb473HIAmlg/photo.jpg?sz=128", "display_name": "Pascal Stefan Buehrig", "link": "https://stackoverflow.com/users/8635353/pascal-stefan-buehrig"}, "edited": false, "score": 0, "creation_date": 1505945820, "post_id": 46332410, "comment_id": 79625920, "body": "If it is an RTF file, why not set the RtfBody property?"}, {"owner": {"reputation": 1, "user_id": 8635353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Bvdku7RAn0/AAAAAAAAAAI/AAAAAAAADqM/hb473HIAmlg/photo.jpg?sz=128", "display_name": "Pascal Stefan Buehrig", "link": "https://stackoverflow.com/users/8635353/pascal-stefan-buehrig"}, "edited": false, "score": 0, "creation_date": 1506112865, "post_id": 46332410, "comment_id": 79705402, "body": "Output is gonna be the same, I just tried if HTML would keep the bold fonts"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 8635353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Bvdku7RAn0/AAAAAAAAAAI/AAAAAAAADqM/hb473HIAmlg/photo.jpg?sz=128", "display_name": "Pascal Stefan Buehrig", "link": "https://stackoverflow.com/users/8635353/pascal-stefan-buehrig"}, "edited": false, "score": 0, "creation_date": 1506144464, "post_id": 46332410, "comment_id": 79711598, "body": "I am not sure what you mean."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1505944812, "creation_date": 1505944812, "answer_id": 46332410, "question_id": 46331985, "link": "https://stackoverflow.com/questions/46331985/excel-vba-assign-bold-font-to-lines-in-string-text/46332410#46332410", "title": "excel-vba: Assign bold font to lines in string text", "body": "<p>You need to set the HTMLBody property to a properly formatted HTML text:</p>\n\n<pre><code>strvar = \"&lt;html&gt;&lt;body&gt;some &lt;b&gt;bold&lt;/b&gt; text&lt;br&gt;and &lt;i&gt;italic&lt;/i&gt; too&lt;/body&gt;&lt;/html&gt;\"\n...\n.HTMLBody = strVar \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8635353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Bvdku7RAn0/AAAAAAAAAAI/AAAAAAAADqM/hb473HIAmlg/photo.jpg?sz=128", "display_name": "Pascal Stefan Buehrig", "link": "https://stackoverflow.com/users/8635353/pascal-stefan-buehrig"}, "edited": false, "score": 0, "creation_date": 1505945737, "post_id": 46332466, "comment_id": 79625887, "body": "How can I make something like ActiveCell work for a string? That&#39;s the one million dollar question"}, {"owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "reply_to_user": {"reputation": 1, "user_id": 8635353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Bvdku7RAn0/AAAAAAAAAAI/AAAAAAAADqM/hb473HIAmlg/photo.jpg?sz=128", "display_name": "Pascal Stefan Buehrig", "link": "https://stackoverflow.com/users/8635353/pascal-stefan-buehrig"}, "edited": false, "score": 0, "creation_date": 1505945926, "post_id": 46332466, "comment_id": 79625958, "body": "I would paste the string where you ant it then bold it"}, {"owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "reply_to_user": {"reputation": 1, "user_id": 8635353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Bvdku7RAn0/AAAAAAAAAAI/AAAAAAAADqM/hb473HIAmlg/photo.jpg?sz=128", "display_name": "Pascal Stefan Buehrig", "link": "https://stackoverflow.com/users/8635353/pascal-stefan-buehrig"}, "edited": false, "score": 0, "creation_date": 1505946100, "post_id": 46332466, "comment_id": 79626005, "body": "Is this string with the &quot;@&quot; in them going to be an email or body text?"}, {"owner": {"reputation": 1, "user_id": 8635353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Bvdku7RAn0/AAAAAAAAAAI/AAAAAAAADqM/hb473HIAmlg/photo.jpg?sz=128", "display_name": "Pascal Stefan Buehrig", "link": "https://stackoverflow.com/users/8635353/pascal-stefan-buehrig"}, "edited": false, "score": 0, "creation_date": 1505970680, "post_id": 46332466, "comment_id": 79631666, "body": "In the body text of an email"}], "tags": [], "owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "is_accepted": false, "score": 0, "last_activity_date": 1505945194, "creation_date": 1505945194, "answer_id": 46332466, "question_id": 46331985, "link": "https://stackoverflow.com/questions/46331985/excel-vba-assign-bold-font-to-lines-in-string-text/46332466#46332466", "title": "excel-vba: Assign bold font to lines in string text", "body": "<p>Here's the code to bold a string in the active cell if it contains a \"@\" in it. You'll need to figure out what you need it to do, but this should help get you started. It only works on the active cell as of right now.</p>\n\n<pre><code>If ActiveCell.Value Like \"*@*\" Then\n  ActiveCell.Font.Bold = True\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8635353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Bvdku7RAn0/AAAAAAAAAAI/AAAAAAAADqM/hb473HIAmlg/photo.jpg?sz=128", "display_name": "Pascal Stefan Buehrig", "link": "https://stackoverflow.com/users/8635353/pascal-stefan-buehrig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1322, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505945194, "creation_date": 1505942664, "question_id": 46331985, "link": "https://stackoverflow.com/questions/46331985/excel-vba-assign-bold-font-to-lines-in-string-text", "title": "excel-vba: Assign bold font to lines in string text", "body": "<p>I have a string element that contains several lines of text. If I use this string as an outlook body text though, they will have no format like bold font to specific lines. I would like to take this string and apply bold font to specific lines (e.g. to all which contain the symbol \"@\" with a for loop).</p>\n\n<p>How can I implement that in my code before I incorporate the string as body text of my e-mail? I guess I must create a new object out of it and get that one instead into the body of the e-mail.</p>\n\n<pre><code> Sub Send_Email()\n Dim OutApp As Object\n Dim OutMail As Object\n\n Application.ScreenUpdating = False\n Set OutApp = CreateObject(\"Outlook.Application\")\n OutApp.Session.Logon\n Dim iFile As Integer\n Dim strVar As String 'Pre-definition of the input variable\n\n iFile = FreeFile\n\n Open \"FILE_PATH\" For Input As #iFile\n strVar = Input(LOF(iFile), iFile) 'Definition of the input varibale\n Close #iFile\n\n Set OutMail = OutApp.CreateItem(0)\n On Error Resume Next\n\n With OutMail\n .To = \"\"\n .BCC = \"\"\n .Subject = \"\"    \n .BodyFormat = olFormatRichText\n .Body = strVar 'Creation of the e-mail text body\n .Display 'Or use .Send\nEnd With\nOn Error GoTo 0\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 1021, "user_id": 3335118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s22sH.png?s=128&g=1", "display_name": "theGleep", "link": "https://stackoverflow.com/users/3335118/thegleep"}, "edited": false, "score": 1, "creation_date": 1505941358, "post_id": 46331543, "comment_id": 79624184, "body": "look for String.Replace(regex) - and google BackReferences.  I <i>THINK</i> it would be something like <code>input.Replace(&quot;([0-9]*\\.?[0-9]*)&quot;, &quot;\\0&quot; + vbcrlf)</code>"}, {"owner": {"reputation": 4244, "user_id": 3348112, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab4cd9458f5debd780353a5554b718d8?s=128&d=identicon&r=PG&f=1", "display_name": "CAustin", "link": "https://stackoverflow.com/users/3348112/caustin"}, "edited": false, "score": 0, "creation_date": 1505941632, "post_id": 46331543, "comment_id": 79624299, "body": "Does each item always start with a numeral and end with a period? If so, you could use a simpler pattern: <code>\\d[ .\\dA-Za-z]+?\\.</code>"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505944041, "post_id": 46331543, "comment_id": 79625235, "body": "No, aways start with digit. But when he is alone. Can be without period."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1505946241, "post_id": 46331543, "comment_id": 79626052, "body": "Does it mean your list items do not contain digits? How do you distinguish between <code>4</code> as a bullet item and <code>4</code> as a number inside the text?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505947712, "post_id": 46331543, "comment_id": 79626511, "body": "Good point. I thought of that and just assumed only numbers as item bullet. But since all ends with period, i think i can make that it ends with word and period. I tried to make it starting with number and ending with word and period. Unsuccessful. I am reading a little more and making some attempts"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8395257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/545c2da5d3816d95e94b5fd02bf0911e?s=128&d=identicon&r=PG&f=1", "display_name": "miraliu", "link": "https://stackoverflow.com/users/8395257/miraliu"}, "is_accepted": false, "score": 0, "last_activity_date": 1505944277, "creation_date": 1505944277, "answer_id": 46332286, "question_id": 46331543, "link": "https://stackoverflow.com/questions/46331543/use-regex-to-split-numbered-list-array-into-numbered-list-multiline/46332286#46332286", "title": "Use Regex to Split Numbered List array into Numbered List Multiline", "body": "<p>If VBA's split supports look-behind regex then this one may work, assuming there's no digit except in the indexes:</p>\n\n<pre><code>    \\s(?=\\d)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505952816, "post_id": 46333170, "comment_id": 79627740, "body": "Thanks! I was trying to make this RegEx totally wrong. Using <code>^</code> to start. I need to study more, because RegEx is really useful. And <code>?=</code> or <code>?:</code> are some patterns definitions that i didn&#39;t see on the tutorials. Thanks again, answer well explained"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505954706, "post_id": 46333170, "comment_id": 79628121, "body": "Just changed to <code>\\d+(?:\\.\\d+)*[\\s\\S]*?[\\D]+\\.(?=\\s*(?:\\d+|$))</code> using <code>[\\D]</code> instead of <code>[a-zA-Z]</code>. Because if the list item ended with <code>).</code> it wouldn&#39;t work."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1505974728, "post_id": 46333170, "comment_id": 79633153, "body": "@danieltakeshi: Note that <code>\\D</code> matches any non-digit symbols. You may want to just use <a href=\"https://regex101.com/r/WpiKin/3\" rel=\"nofollow noreferrer\"><code>\\d+(?:\\.\\d+)*[\\s\\S]*?\\D\\.(?=\\s*(?:\\d|$))</code></a>. As for the <code>^</code>, it can match start of the string (with <code>RegExp.Multiline = False</code>), or start of the line (with <code>RegExp.Multiline = True</code>)"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1505976888, "post_id": 46333170, "comment_id": 79634262, "body": "@danieltakeshi And another hint: If there are no linebreaks in the string, <code>[\\s\\S]</code> can be replaced with <code>.</code>."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1505950434, "last_edit_date": 1505950434, "creation_date": 1505950126, "answer_id": 46333170, "question_id": 46331543, "link": "https://stackoverflow.com/questions/46331543/use-regex-to-split-numbered-list-array-into-numbered-list-multiline/46333170#46333170", "title": "Use Regex to Split Numbered List array into Numbered List Multiline", "body": "<blockquote>\n  <p>I can make that it ends with word and period</p>\n</blockquote>\n\n<p>Use</p>\n\n<pre><code>\\d+(?:\\.\\d+)*[\\s\\S]*?\\w+\\.\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/WpiKin/1\" rel=\"nofollow noreferrer\">regex demo</a>.</p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>\\d+</code> - 1 or more digits</li>\n<li><code>(?:\\.\\d+)*</code> - zero or more sequences of: \n\n<ul>\n<li><code>\\.</code> - dot</li>\n<li><code>\\d+</code> - 1 or more digits</li>\n</ul></li>\n<li><code>[\\s\\S]*?</code> - any 0+ chars, as few as possible, up to the first...</li>\n<li><code>\\w+\\.</code> - 1+ word chars followed with <code>.</code>.</li>\n</ul>\n\n<p>Here is a sample VBA code:</p>\n\n<pre><code>Dim str As String\nDim objMatches As Object\nstr = \" 1 One without dot. 2. Some Random String. 3.1 With SubItens. 3.2 With Another SubItem. 4. List item. 11.12 More than one digit.\"\nSet objRegExp = New regexp ' CreateObject(\"VBScript.RegExp\")\nobjRegExp.Pattern = \"\\d+(?:\\.\\d+)*[\\s\\S]*?\\w+\\.\"\nobjRegExp.Global = True\nSet objMatches = objRegExp.Execute(str)\nIf objMatches.Count &lt;&gt; 0 Then\n  For Each m In objMatches\n      Debug.Print m.Value\n  Next\nEnd If\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/yL9GN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yL9GN.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>NOTE</strong></p>\n\n<p>You may require the matches to only stop at the word + <code>.</code> that are followed with 0+ whitespaces and a number using <a href=\"https://regex101.com/r/WpiKin/2\" rel=\"nofollow noreferrer\"><code>\\d+(?:\\.\\d+)*[\\s\\S]*?[a-zA-Z]+\\.(?=\\s*(?:\\d+|$))</code></a>.</p>\n\n<p>The <code>(?=\\s*(?:\\d+|$))</code> positive lookahead requires the presence of 0+ whitespaces (<code>\\s*</code>) followed with 1+ digits (<code>\\d+</code>) or end of string (<code>$</code>) immediately to the right of the current location.</p>\n"}], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 1, "accepted_answer_id": 46333170, "answer_count": 2, "score": 2, "last_activity_date": 1505955140, "creation_date": 1505940628, "last_edit_date": 1531164843, "question_id": 46331543, "link": "https://stackoverflow.com/questions/46331543/use-regex-to-split-numbered-list-array-into-numbered-list-multiline", "title": "Use Regex to Split Numbered List array into Numbered List Multiline", "body": "<p>I am trying to learn Regex to answer a question on SO portuguese. </p>\n\n<h3>Input (Array or String on a Cell, so <code>.MultiLine = False</code>)?</h3>\n\n<pre><code> 1 One without dot. 2. Some Random String. 3.1 With SubItens. 3.2 With number 0n mid. 4. Number 9 incorrect. 11.12 More than one digit. 12.7 Ending (no word).\n</code></pre>\n\n<h3>Output</h3>\n\n<pre><code> 1 One without dot.\n 2. Some Random String.\n 3.1 With SubItens.\n 3.2 With number 0n mid.\n 4. Number 9 incorrect.\n 11.12 More than one digit.\n 12.7 Ending (no word).\n</code></pre>\n\n<p>What i thought was to use <a href=\"https://msdn.microsoft.com/pt-br/library/8yttk7sy(v=vs.110).aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-1\" rel=\"nofollow noreferrer\">Regex with Split</a>, but i wasn't able to implement the example on Excel.</p>\n\n<pre><code>Imports System.Text.RegularExpressions\n\nModule Example\n   Public Sub Main()\n      Dim input As String = \"plum-pear\"\n      Dim pattern As String = \"(-)\" \n\n      Dim substrings() As String = Regex.Split(input, pattern)    ' Split on hyphens.\n      For Each match As String In substrings\n         Console.WriteLine(\"'{0}'\", match)\n      Next\n   End Sub\nEnd Module\n' The method writes the following to the console:\n'    'plum'\n'    '-'\n'    'pear' \n</code></pre>\n\n<p>So reading <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">this</a> and <a href=\"http://analystcave.com/excel-regex-tutorial/#LVL_3_Regular_Expressions_Excel_Regex_8211_RegExp\" rel=\"nofollow noreferrer\">this</a>. The <a href=\"https://regexr.com/\" rel=\"nofollow noreferrer\">RegExr Website</a> was used with the expression <code>/([0-9]{1,2})([.]{0,1})([0-9]{0,2})/igm</code> on the Input.</p>\n\n<p>And the following is obtained:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YgqCE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YgqCE.png\" alt=\"RegExr\"></a></p>\n\n<p>Is there a better way to make this? Is the Regex Correct or a better way to generate? The examples that i found on google didn't enlight me on how to use RegEx with Split correctly.</p>\n\n<p>Maybe I am confusing with the logic of Split Function, which i wanted to get the split index and the separator string was the regex.</p>\n"}, {"tags": ["xml", "vba", "dom", "msxml6"], "answers": [{"tags": [], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "is_accepted": true, "score": 0, "last_activity_date": 1505940718, "creation_date": 1505940718, "answer_id": 46331556, "question_id": 46331378, "link": "https://stackoverflow.com/questions/46331378/trying-to-get-a-value-in-an-xml-document-at-a-given-namespace-and-name-using-msx/46331556#46331556", "title": "Trying to get a value in an XML document at a given namespace and name using MSXML", "body": "<p>I needed to set the DOM document's <code>SelectionNamespaces</code> property before calling <code>SelectSingleNode()</code>, as follows:</p>\n\n<pre><code>domDoc.SetProperty \"SelectionNamespaces\", \"xmlns:d='http://schemas.microsoft.com/ado/2007/08/dataservices'\"\n</code></pre>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 46331556, "answer_count": 1, "score": 0, "last_activity_date": 1505940718, "creation_date": 1505939875, "question_id": 46331378, "link": "https://stackoverflow.com/questions/46331378/trying-to-get-a-value-in-an-xml-document-at-a-given-namespace-and-name-using-msx", "title": "Trying to get a value in an XML document at a given namespace and name using MSXML", "body": "<p>I have an XML document that looks like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;entry xml:base=\"https://sps.utility.abc123.com/sites/xyz/_api/\" xmlns=\"http://www.w3.org/2005/Atom\" xmlns:d=\"http://schemas.microsoft.com/ado/2007/08/dataservices\" xmlns:m=\"http://schemas.microsoft.com/ado/2007/08/dataservices/metadata\" xmlns:georss=\"http://www.georss.org/georss\" xmlns:gml=\"http://www.opengis.net/gml\" m:etag=\"&amp;quot;5&amp;quot;\"&gt;\n&lt;id&gt;Web/Lists(guid'c920cb93-a31a-49a0-a4d6-ac1cb8fb0658')/Items(2)&lt;/id&gt;\n&lt;category term=\"SP.Data.REST_x0020_Test_x0020_ListListItem\" scheme=\"http://schemas.microsoft.com/ado/2007/08/dataservices/scheme\" /&gt;\n&lt;link rel=\"edit\" href=\"Web/Lists(guid'c920cb93-a31a-49a0-a4d6-ac1cb8fb0658')/Items(2)\" /&gt;\n&lt;title /&gt;\n&lt;updated&gt;2017-09-20T16:01:19Z&lt;/updated&gt;\n&lt;author&gt;\n&lt;name /&gt;\n&lt;/author&gt;\n&lt;content type=\"application/xml\"&gt;\n&lt;m:properties&gt;\n&lt;d:Title&gt;item 2 has a new value.&lt;/d:Title&gt;\n&lt;/m:properties&gt;\n&lt;/content&gt;\n&lt;/entry&gt;\n</code></pre>\n\n<p>I want to get the value at the <code>&lt;d:Title&gt;</code> node, which in this case is <code>item 2 has a new value.</code></p>\n\n<p>When I use the following:</p>\n\n<pre><code>Private Function getFieldValueFromXml(xml As Variant, fieldName As String)\n\nDim node As IXMLDOMNode\nDim namespaceAndName As String\nDim domDoc as MSXML2.DomDocument60    \n\nnamespaceAndName = \"d:\" &amp; fieldName\nSet domDoc = New DOMDocument60\nSet node = domDoc.SelectSingleNode(namespaceAndName)\ngetFieldValueFromXML = node.Text\n\nEnd Function\n</code></pre>\n\n<p>The <code>SelectSingleNode()</code> call throws this error:</p>\n\n<pre><code>Reference to undeclared namespace prefix: 'd'.\n</code></pre>\n\n<p>This also happens if I try to first set node with <code>m</code> as follows:</p>\n\n<pre><code>Set node = domDoc.SelectSingleNode(\"m:properties\")\n</code></pre>\n\n<p>How can I get at the inner text of <code>&lt;d:Title&gt;</code> here?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505939067, "post_id": 46331125, "comment_id": 79623179, "body": "No need for VBA. 1) Sort columns B:D on Col B Ascending; Then Cold C Ascending. 2) Use conditional formatting on range B2:B12. Formula will be <code>(B2=B1)</code>"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505939265, "post_id": 46331125, "comment_id": 79623262, "body": "@ScottHoltzman that would make the quantities jumbled!"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1505939357, "post_id": 46331125, "comment_id": 79623305, "body": "@bulbus - now I see what you mean by quantities not being affected."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1505939431, "post_id": 46331125, "comment_id": 79623325, "body": "I have tried different ways of sorting but have failed and that&#39;s why I turned to using writing VBA codes."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1505999904, "post_id": 46331604, "comment_id": 79650009, "body": "@sc1324 - not so much super. I thought of the best way to do it manually, then wrote the code for that. :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1505940892, "creation_date": 1505940892, "answer_id": 46331604, "question_id": 46331125, "link": "https://stackoverflow.com/questions/46331125/vba-coloring-duplicate-and-re-order-list/46331604#46331604", "title": "vba coloring duplicate and re-order list", "body": "<p>I just built and tested this and it works:</p>\n\n<pre><code>Option Explicit\n\nSub StackedSortByZip()\n\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Sheet1\")\n\n    With ws\n\n        Dim rZip As Range\n        Set rZip = .Range(\"B2:B12\")\n\n        Dim rCel As Range\n        For Each rCel In rZip\n\n            'look for another occurence of zip code\n            Dim rFound As Range\n            Set rFound = Range(rCel.Offset(1), rCel.End(xlDown)).Find(rCel, lookat:=xlWhole)\n\n            'if it's found\n            If Not rFound Is Nothing Then\n                rFound.Resize(1, 3).Cut ', cut the zip with lower quantity\n                'insert under original zip (as long as it's not last line)\n                If rFound.Address &lt;&gt; rCel.Offset(1).Address Then rCel.Offset(1).Insert Shift:=xlDown\n            End If\n\n        Next\n\n        'set conditional formatting\n        With rZip\n            .FormatConditions.Add Type:=xlExpression, Formula1:=\"=B1=B2\"\n            With .FormatConditions(.FormatConditions.Count)\n                .SetFirstPriority\n                .Font.Color = 255\n            End With\n        End With\n\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ChGNI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ChGNI.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "accepted_answer_id": 46331604, "answer_count": 1, "score": 0, "last_activity_date": 1505994022, "creation_date": 1505938766, "last_edit_date": 1531164843, "question_id": 46331125, "link": "https://stackoverflow.com/questions/46331125/vba-coloring-duplicate-and-re-order-list", "title": "vba coloring duplicate and re-order list", "body": "<p>I have a list of zip codes, their corresponding counties and their quantities, sorted by quantities largest to smallest. However, I need to re-arrange the list in a way so duplicates are next to each other while quantities are not being affected. For the coloring part, I only want to add the font color, once, to the zip code that can be in two counties.</p>\n\n<p>What I did was I added a help column, A and use countif function to find duplicate zip codes and add font color to all duplicates, so not quite the result I want. I think it has something to do with the finding the duplicates and inserting and copying which I am not familiar.</p>\n\n<pre><code>Sub test()        \n    Dim Rng1, Rng2, cell As Range\n    Dim LR1, LR2 As Long\n\n    LR1 = Cells(Rows.Count, \"B\").End(xlUp).Row\n\n    Set Rng1 = Range(\"B2\", \"B\" &amp; LR1)\n\n    For i = 2 To LR1\n        Cells(i, 1).Value = Application.WorksheetFunction.CountIf(Rng1, Cells(i, 2).Value)\n    Next i\n\n    Set Rng2 = Range(\"A2\", \"A\" &amp; LR1)\n\n    For Each cell In Rng2\n        If cell.Value &gt; 1 Then\n            cell.Offset(, 1).Font.Color = RGB(255, 0, 0)\n            Else\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>Please see picture for desire results. As you can see zip code 32413 can be either Walton or Bay County so I need to move the second entry right below the first. Also I only want to add font color to the second occurrence of the zip code that can be in two counties. </p>\n\n<p><a href=\"https://i.stack.imgur.com/WjgAb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WjgAb.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505939938, "post_id": 46331036, "comment_id": 79623555, "body": "Code works properly for me.  (I.e. clicking the &quot;X&quot; closes workbook B without saving it anywhere.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1505940495, "post_id": 46331036, "comment_id": 79623801, "body": "Why are trying to close workbook B without naming it? It makes no sense to open a new workbook, paste some data into it and then close it without saving it."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505940701, "post_id": 46331036, "comment_id": 79623885, "body": "@Jeeped It might be that workbook B is just being used as a temporary &quot;report&quot; being displayed to the user, and the user presses the &quot;X&quot; to close it once they have seen it.  i.e. a <b>big</b> MsgBox.  (It might not be too, but that was one scenario that I came up with where this might be desirable.)"}, {"owner": {"reputation": 13, "user_id": 8371816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCzb6.jpg?s=128&g=1", "display_name": "Sam Sagariya", "link": "https://stackoverflow.com/users/8371816/sam-sagariya"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1509041132, "post_id": 46331036, "comment_id": 80869342, "body": "@YowE3K Bro! you are exactly right! I still face the problem!"}], "owner": {"reputation": 13, "user_id": 8371816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCzb6.jpg?s=128&g=1", "display_name": "Sam Sagariya", "link": "https://stackoverflow.com/users/8371816/sam-sagariya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505940013, "creation_date": 1505938411, "last_edit_date": 1505940013, "question_id": 46331036, "link": "https://stackoverflow.com/questions/46331036/excel-vba-while-closing-temp-workbook-excel-closes-main-workbook", "title": "Excel VBA - While closing Temp workbook excel closes main workbook", "body": "<p>So i have workbook  'A' where macro runs to copy a range and paste it in new workbook 'B'\nWhen i try closing workbook 'B' by close(X) button it closes workbook 'A'</p>\n\n<p>Kindly help!</p>\n\n<pre><code>Dim wb As Workbook\n\nSheets(\"Hub\").Range(\"B9:C20\").Copy\n'Add Workbook\nSet wb = Workbooks.Add\nRange(\"A1\").Select\nActiveSheet.Paste\nActiveWorkbook.Saved = True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1505938015, "post_id": 46330904, "comment_id": 79622643, "body": "&quot;This creates a one dimensional array&quot; -- but it doesn&#39;t. It creates a two dimensional array with only 1 column."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1505938275, "post_id": 46330904, "comment_id": 79622773, "body": "To expand on @JohnColeman&#39;s comment, you are creating a two dimension array with 1 to 11999 in the <b>first rank</b> and 1 to 1 in the <b>second rank</b>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505938475, "post_id": 46330904, "comment_id": 79622881, "body": "Have you tried a <code>Union</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "edited": false, "score": 0, "creation_date": 1505998501, "post_id": 46331042, "comment_id": 79648911, "body": "Sorry I didn&#39;t get back to you yesterday, had to work quickly to try to get this implemented before the day was over. With some refactoring this worked for my code nicely."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 5, "last_activity_date": 1505938577, "last_edit_date": 1505938577, "creation_date": 1505938444, "answer_id": 46331042, "question_id": 46330904, "link": "https://stackoverflow.com/questions/46330904/how-to-get-range-of-cells-into-a-specific-array-dimension/46331042#46331042", "title": "How to get range of cells into a specific array dimension", "body": "<p>You do need a loop -- but loop over VBA arrays rather than individual cells:</p>\n\n<pre><code>Sub Test()\n    Dim A As Variant, B As Variant, C As Variant\n    Dim i As Long\n    B = Sheets(lookupSheet).Range(\"B2:B12000\").Value2\n    C = Sheets(lookupSheet).Range(\"D2:D12000\").Value2\n    ReDim A(1 To 11999, 1 To 2)\n    For i = 1 To 11999\n        A(i, 1) = B(i, 1)\n        A(i, 2) = C(i, 2)\n    Next i\n    'do stuff with A\nEnd Sub\n</code></pre>\n\n<p>This should only take a fraction of a second.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505938870, "post_id": 46331144, "comment_id": 79623079, "body": "Isn&#39;t it called a &quot;jagged&quot; array? ;-)"}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1505938835, "creation_date": 1505938835, "answer_id": 46331144, "question_id": 46330904, "link": "https://stackoverflow.com/questions/46330904/how-to-get-range-of-cells-into-a-specific-array-dimension/46331144#46331144", "title": "How to get range of cells into a specific array dimension", "body": "<p>You can do it with a ragged array:</p>\n\n<pre><code>Dim var1(1 To 2) As Variant\nDim var As Variant\nvar = Range(\"A1:A10\").Value2\nvar1(1) = var\nvar = Range(\"c1:c10\").Value2\nvar1(2) = var\nMsgBox var1(1)(3, 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1505938856, "creation_date": 1505938856, "answer_id": 46331149, "question_id": 46330904, "link": "https://stackoverflow.com/questions/46330904/how-to-get-range-of-cells-into-a-specific-array-dimension/46331149#46331149", "title": "How to get range of cells into a specific array dimension", "body": "<p>Probably no quicker than John Coleman's answer, but I think this does what you want.</p>\n\n<pre><code>Sub x()\n\nDim matchArray, r As Range\n\nSet r = Sheets(lookupSheet).Range(\"B2:D12000\")\n\nmatchArray = Application.Index(r, Evaluate(\"Row(1:\" &amp; r.Rows.Count &amp; \")\"), Array(1, 3))\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1505939026, "creation_date": 1505939026, "answer_id": 46331179, "question_id": 46330904, "link": "https://stackoverflow.com/questions/46330904/how-to-get-range-of-cells-into-a-specific-array-dimension/46331179#46331179", "title": "How to get range of cells into a specific array dimension", "body": "<p>Here are a couple more ways:</p>\n\n<pre><code>Sub Example1()\n    Const lookupSheet As String = \"Sheet1\"\n    Dim matchArray As Variant, arr1 As Variant, arr2 As Variant\n\n    With Sheets(lookupSheet)\n        arr1 = WorksheetFunction.Transpose(.Range(\"B2:B12000\").Value2)\n        arr2 = WorksheetFunction.Transpose(.Range(\"D2:D12000\").Value2)\n        matchArray = WorksheetFunction.Transpose(Array(arr1, arr2))\n    End With\nEnd Sub\n\nSub Example2()\n    Const lookupSheet As String = \"Sheet1\"\n    Dim matchArray As Variant\n    Dim x As Long\n\n    With Sheets(lookupSheet)\n        matchArray = .Range(\"B2:B12000\").Resize(, 2).Value2\n        For Each v In .Range(\"D2:D12000\").Value2\n            x = x + 1\n            matchArray(x, 2) = v\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 46331042, "answer_count": 4, "score": 3, "last_activity_date": 1505939026, "creation_date": 1505937861, "last_edit_date": 1505938187, "question_id": 46330904, "link": "https://stackoverflow.com/questions/46330904/how-to-get-range-of-cells-into-a-specific-array-dimension", "title": "How to get range of cells into a specific array dimension", "body": "<p>I need to get a range of cells into an array, which by itself is simple enough:</p>\n\n<pre><code>Dim matchArray As Variant\nmatchArray = Sheets(lookupSheet).Range(\"B2:B12000\").Value2\n</code></pre>\n\n<p>This creates a two-dimensional array with one column as the second dimension and if you expand the range to include a second column it creates a two-dimensional array with two columns for the second dimension:</p>\n\n<pre><code>matchArray = Sheets(lookupSheet).Range(\"B2:C12000\").Value2\n</code></pre>\n\n<p>But what if the two columns aren't next to each other and you don't want the one in the middle?</p>\n\n<pre><code>matchArray = Sheets(lookupSheet).Range(\"B2:B12000,D2:D12000\").Value2\n</code></pre>\n\n<p>The above would be my best guess but it doesn't work, it only returns the first range specified.</p>\n\n<p>So what I need is a way to return a range cell values into a specific dimension of the array.</p>\n\n<p>I know I could do it by looping through the rows but that would take far too long with the number of rows I'm going to be working with.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4843530"}, "edited": false, "score": 1, "creation_date": 1505937652, "post_id": 46330813, "comment_id": 79622472, "body": "And why not have that percentage in another column, so that you retain the value and the percentage?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4843530"}, "edited": false, "score": 0, "creation_date": 1505937866, "post_id": 46330813, "comment_id": 79622572, "body": "that example looks like you just want to have e2 be calculated to be the percentage b2/b1.  So, in e2 you would just have <code>=b2&#47;b1</code> and format it to a percentage.  Or else you are wanting to have b2 be calculated as the amount of b1*e2%, and assuming b2 is formatted as a percentage, you would just have , in b2, <code>=b1*e2</code>"}, {"owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1505938307, "post_id": 46330813, "comment_id": 79622792, "body": "Sorry I cannot view my own image at work. I believe I had the wrong image up originally. The goal is to not have the original value retained. I have a large portion of cells that will need this accomplished so I am making it as basic as I can for the community to add the rest later myself. I need the value in B2 to be replaced with the value of B1/B2."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505938434, "post_id": 46330813, "comment_id": 79622859, "body": "So <code>Range(&quot;B2&quot;).Value = Range(&quot;B2&quot;).Value&#47;Range(&quot;B1&quot;).Value</code>?"}, {"owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1505938763, "post_id": 46330813, "comment_id": 79623032, "body": "That looks right, I am pretty rough on my VBA. Is there a code to also change the formatting of that cell to be a percentage?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505939236, "post_id": 46330813, "comment_id": 79623246, "body": "<code>Range(&quot;B2&quot;).NumberFormat = &quot;0.00%&quot;</code>"}], "owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505938184, "creation_date": 1505937508, "last_edit_date": 1531164843, "question_id": 46330813, "link": "https://stackoverflow.com/questions/46330813/calculate-button-to-update-values", "title": "calculate button to update values", "body": "<p>I am looking for a script that will take a dollar amount value in a cell and run it through a small calculation and spit out the percent value in the <strong>SAME</strong> cell.</p>\n\n<p>Example image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EjS2H.jpg\" rel=\"nofollow noreferrer\">Example</a></p>\n\n<p>The goal would be to have a macro that will take the value of <strong>B2</strong> ($10) and replace it with the value <strong>10%</strong> (<strong>B1</strong> divided by the input value of <strong>B2</strong>) Can this be done?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1505936761, "post_id": 46330572, "comment_id": 79621990, "body": "What&#39;s <code>prog_end3a</code> declared as, and how did you define it?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 4, "creation_date": 1505936792, "post_id": 46330572, "comment_id": 79622006, "body": "<code>prog_shift_1 &amp; prog_end3a &amp; &quot;:&quot; &amp; subj_ec &amp; prog_end3a &amp; &quot;,&quot; ...</code> *this assumes <code>prog_end3a</code> variables hold the value of <code>50</code> (or whatever row number). If your variables are defined as ranges, than completely different answer. ....  <b>I know I have option explicit turned off, but its necessary for this circumstance</b> ... I can&#39;t imagine a good reason to ever turn it off."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505946253, "post_id": 46330572, "comment_id": 79626060, "body": "The fact that you already know how to use <code>prog_end3a</code> in your range definition (i.e. you are already using <code>... prog_shift_1 &amp; prog_end3a + i &amp; &quot;:&quot; ...</code>), and your mention of <code>Option Explicit</code> not being used, makes me think that your issue is not with the line of code you posted but elsewhere in your code.  Perhaps you should post enough of your code so that we can see what your issue is."}], "owner": {"reputation": 21, "user_id": 8644125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647044887c27fae5b97ced5a8728a2f5?s=128&d=identicon&r=PG&f=1", "display_name": "A.Nelson", "link": "https://stackoverflow.com/users/8644125/a-nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505938180, "creation_date": 1505936583, "last_edit_date": 1531161705, "question_id": 46330572, "link": "https://stackoverflow.com/questions/46330572/trying-to-select-multiple-ranges-using-defined-variables", "title": "Trying to select multiple ranges using defined variables", "body": "<p>I'm looking to change the current line of code to be variable - instead of using row 50, use \"prog_end3a\"</p>\n\n<pre><code>Range(prog_shift_1 &amp; \"50:\" &amp; subj_ec &amp; \"50,\" &amp; prog_shift_1 &amp; prog_end3a + i &amp; \":\" &amp; subj_ec &amp; 50 + i).Copy\n</code></pre>\n\n<p>I can't figure out how to properly replace 50 with prog_end3a so that it still selects the two ranges separately. Can anyone help? Also, I know I have option explicit turned off, but its necessary for this circumstance.</p>\n"}, {"tags": ["vba", "tree", "catia"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8464282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3abd9a9fef5768ad1bb2bf79c570e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Castella", "link": "https://stackoverflow.com/users/8464282/castella"}, "edited": false, "score": 0, "creation_date": 1505940495, "post_id": 46331132, "comment_id": 79623802, "body": "How would you create the headers?"}, {"owner": {"reputation": 131, "user_id": 3116617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s8c98.jpg?s=128&g=1", "display_name": "garthhh", "link": "https://stackoverflow.com/users/3116617/garthhh"}, "reply_to_user": {"reputation": 7, "user_id": 8464282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3abd9a9fef5768ad1bb2bf79c570e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Castella", "link": "https://stackoverflow.com/users/8464282/castella"}, "edited": false, "score": 0, "creation_date": 1505941663, "post_id": 46331132, "comment_id": 79624322, "body": "Essentially create a row of headers, like Excel.Cells(1,1).Value = &quot;CATProduct&quot;, Excel.Cells(1,2).Value = &quot;Instance Name&quot;, and so on, so all of those headers are only in one row. You only need to do this once, then create a loop (similar to what you already have) that just inserts the proper information in the same column as the associated header. This will allow you (or others) to more easily summarize/filter/sort data in the Excel sheet."}, {"owner": {"reputation": 7, "user_id": 8464282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3abd9a9fef5768ad1bb2bf79c570e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Castella", "link": "https://stackoverflow.com/users/8464282/castella"}, "edited": false, "score": 0, "creation_date": 1505988601, "post_id": 46331132, "comment_id": 79642065, "body": "I have made the alterations that you suggested but the result is the same, the same cell is being overwritten with the same values."}], "tags": [], "owner": {"reputation": 131, "user_id": 3116617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s8c98.jpg?s=128&g=1", "display_name": "garthhh", "link": "https://stackoverflow.com/users/3116617/garthhh"}, "is_accepted": false, "score": 0, "last_activity_date": 1505939251, "last_edit_date": 1505939251, "creation_date": 1505938776, "answer_id": 46331132, "question_id": 46330409, "link": "https://stackoverflow.com/questions/46330409/catia-v5-export-tree-through-vba-macro/46331132#46331132", "title": "catia v5 export tree through VBA macro", "body": "<p>Assuming by </p>\n\n<blockquote>\n  <p>in the same cell cycles through all of the parts and children in the spec tree</p>\n</blockquote>\n\n<p>you mean that it is writing/overwriting data from CATIA in the same cell, that is because you aren't incrementing anything regarding Excel rows/columns.</p>\n\n<p>I personally would create headers for things like CATProduct, Instance Name, etc. then put pure data below instead of repeating these identical headers every single time, but your format will work as well, it might just be more difficult to summarize data in Excel.</p>\n\n<p>Anyway, to maintain your existing format, you need to increment your Row at the end of your loop, around where t is incremented.</p>\n\n<p>In the existing loop, it appears that rows 2-6 are used (5 rows total) for the first oInProduct. There is a row = 2 at the beginning of the loop which needs to be put just before the loop, this means it will start from the second row. There is also a row = 4 inside the loop which needs to be changed, we can use row = row + 2 to get the same effect. Then, at the end of the loop, we increment again to reach that total of 5, so use row = row + 3.</p>\n\n<pre><code>row = 2\n\nfor i = 1 to oInProduct.Count\n\n    '**************************** Export title ***************************\n\n    col=1\n    Excel.Columns.Columns(1).Columnwidth = 5\n\n    ...\n    row = row + 2 'previously row = 4\n    ...\n\n    Excel.Cells(row,col + 4).HorizontalAlignment = 3\n    Excel.Cells(row + 2,col + 4).Value = 1 'insert Sinex Ref corresponding to PartNumber\n\n    t = t + 1\n    row = row + 3\n\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22786, "user_id": 974045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad548cd357d81ab99c5d60e64e02070?s=128&d=identicon&r=PG", "display_name": "Gibolt", "link": "https://stackoverflow.com/users/974045/gibolt"}, "edited": false, "score": 2, "creation_date": 1547843785, "post_id": 54260839, "comment_id": 95346334, "body": "This doesn&#39;t answer the question, which was how to do it via macro"}], "tags": [], "owner": {"reputation": 3, "user_id": 2048292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed75b8acb1939bd2f4ff27cd142fd7b?s=128&d=identicon&r=PG", "display_name": "Julian Krebs", "link": "https://stackoverflow.com/users/2048292/julian-krebs"}, "is_accepted": false, "score": 0, "last_activity_date": 1547842504, "creation_date": 1547842504, "answer_id": 54260839, "question_id": 46330409, "link": "https://stackoverflow.com/questions/46330409/catia-v5-export-tree-through-vba-macro/54260839#54260839", "title": "catia v5 export tree through VBA macro", "body": "<p>Try \n-->Analyze-->Bill of Material-->Define Format (for optional options)-->>Save as-->File format as .xls</p>\n\n<p>Or:\n-->File--> Save As --> Filetype:txt...Sure it's txt but maybe you can convert to .xls\n(expecially if you have missing licenses)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12711712, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBXQ8nhKok_uz3LOyTGZBy9w8WnMMxlThXdKZQa7w=k-s128", "display_name": "Ajayganesh Chanumolu", "link": "https://stackoverflow.com/users/12711712/ajayganesh-chanumolu"}, "is_accepted": false, "score": 0, "last_activity_date": 1579015316, "last_edit_date": 1579015316, "creation_date": 1579014121, "answer_id": 59736421, "question_id": 46330409, "link": "https://stackoverflow.com/questions/46330409/catia-v5-export-tree-through-vba-macro/59736421#59736421", "title": "catia v5 export tree through VBA macro", "body": "<p>I have used <em>AssemblyConverter</em> object which is available in Catia libraries to extract BOM.I found this when I recorded macro using the steps mentioned in above comment.<br>\nTry -->Analyze-->Bill of Material-->Define Format (for optional options)-->>Save as-->File format as .xls<br>\nI think this is the simplest and fast. Also, we can change format and location of file too.</p>\n\n<p>Recorded Macro:</p>\n\n<pre><code>Sub CATMain()\n\n    Dim productDocument1 As ProductDocument\n    Set productDocument1 = CATIA.ActiveDocument\n\n    Dim product1 As Product\n    Set product1 = productDocument1.Product\n\n    Dim assemblyConvertor1 As AssemblyConvertor\n    Set assemblyConvertor1 = product1.GetItem(\"BillOfMaterial\")\n\n    Dim arrayOfVariantOfBSTR1(4)\n    arrayOfVariantOfBSTR1(0) = \"Quantity\"\n    arrayOfVariantOfBSTR1(1) = \"Part Number\"\n    arrayOfVariantOfBSTR1(2) = \"Type\"\n    arrayOfVariantOfBSTR1(3) = \"Nomenclature\"\n    arrayOfVariantOfBSTR1(4) = \"Revision\"\n    Set assemblyConvertor1Variant = assemblyConvertor1\n    assemblyConvertor1Variant.SetCurrentFormat arrayOfVariantOfBSTR1\n\n    Dim arrayOfVariantOfBSTR2(1)\n    arrayOfVariantOfBSTR2(0) = \"Quantity\"\n    arrayOfVariantOfBSTR2(1) = \"Part Number\"\n    Set assemblyConvertor1Variant = assemblyConvertor1\n    assemblyConvertor1Variant.SetSecondaryFormat arrayOfVariantOfBSTR2\n\n    assemblyConvertor1.[Print] \"XLS\", \"C:\\Users\\Desktop\\BOM.xls\", product1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8464282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3abd9a9fef5768ad1bb2bf79c570e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Castella", "link": "https://stackoverflow.com/users/8464282/castella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3544, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1579015316, "creation_date": 1505935997, "last_edit_date": 1574170756, "question_id": 46330409, "link": "https://stackoverflow.com/questions/46330409/catia-v5-export-tree-through-vba-macro", "title": "catia v5 export tree through VBA macro", "body": "<p>I need to export the Catia Spec tree to use as a BoM.</p>\n\n<p>The Export Should:</p>\n\n<ul>\n<li>Go to Excel and will use the WalkDownTree function.</li>\n<li>Have the PartNumber, Nomenclature and a User Added\nProperty called \"Sinex Ref\".</li>\n<li><p>It will also have to make sure that the Exported Tree ignores Parts\nand Products called \"Ref\".</p></li>\n<li><p>Present the Quantity of each item using the\nPartNumber.</p></li>\n<li><p>Include the deactivated parts but mention that they\nare deactivated.</p></li>\n</ul>\n\n<p>I'm new to Catia and VBA and have come up with the following (I made adjustments to other macros that i have found but noticed that they ignore the children in the Tree). Currently the macro generates the Excel file and in the same cell cycles through all of the parts and children in the spec tree, regardless if they're deactivated or not.</p>\n\n<pre><code>Sub CATMain()\n\n\n' ********* is the current document a CATIA Product **************\n\n    If CATIA.Documents.Count = 0 Then\n\n        MsgBox \"There are no CATIA documents open. Please open a CATIA document and try again.\", ,msgboxtext\n\n        Exit Sub\n    End If\n\n\n    If InStr(CATIA.ActiveDocument.Name, \".CATProduct\") &lt; 1 Then\n\n        MsgBox \"The active document is not a Product. Please open a CATIA Product and try again.\", ,msgboxtext\n\n         Exit Sub\n    End If\n\n\n' ************* General declarations for the Active CATIA session *****************\n\n    Dim oProdDoc As ProductDocument\n    t = 1\n    Set oProdDoc = CATIA.ActiveDocument\n    Dim oRootProd As Product\n    Set oRootProd = oProdDoc.Product\n    Dim par As Parameters\n    Set par = oRootProd.UserRefProperties\n    Dim SinexRef As String\n\n\n' *************** begin spec tree scroll ******************\n\n    Call WalkDownTree(oRootProd)\nEnd Sub\n\nSub WalkDownTree(oInProduct As Product)\n        Dim oInstances As Products\n    Set oInstances = oInProduct.Products\n\n    On Error Resume Next\n    Set Excel = GetObject(, \"EXCEL.Application\")\n\n    If Err.Number &lt;&gt; 0 Then\n        Set Excel = CreateObject(\"EXCEL.Application\")\n        Excel.Visible = True\n        Excel.Workbooks.Add \n    End If\n\n    If t &lt;&gt; 1 Then\n        for i=1 to oInProduct.Count\n\n\n'**************************** Export title ***************************\n\n            row=2\n\n            col=1\n            Excel.Columns.Columns(1).Columnwidth = 5\n\n            Excel.Columns.Columns(2).Columnwidth = 15\n            Excel.Cells(row,col+1).Value = \"CATProduct:\"\n\n            Excel.Cells(row,col+1).Font.Bold = true\n\n            Excel.Cells(row,col+1).HorizontalAlignment = 3\n            Excel.Cells(row,col+2).Value = CATIA.ActiveDocument.Name\n\n' **************************** Export column titles ***************\n\n            row=4\n            Excel.Cells(row,col+1).Value = \"Instance Name\"\n            Excel.Cells(row,col+1).Font.Bold = true\n\n            Excel.Columns.Columns(2).Columnwidth = 20\n\n            Excel.Cells(row,col+1).borders.LineStyle = 1\n            Excel.Cells(row,col+1).HorizontalAlignment = 3\n            Excel.Cells(row+2,col+1).Value = oInProduct.ReferenceProduct.PartNumber\n\n            Excel.Cells(row,col+2).Value = \"Ref\"\n\n            Excel.Cells(row,col+2).Font.Bold = true\n\n            Excel.Columns.Columns(3).Columnwidth = 15\n            Excel.Cells(row,col+2).borders.LineStyle = 1\n\n            Excel.Cells(row,col+2).HorizontalAlignment = 3\n            Excel.Cells(row+2,col+2).Value = oInProduct.ReferenceProduct.Nomenclature\n\n            Excel.Cells(row,col+3).Value = \"Quantity\"\n\n            Excel.Cells(row,col+3).Font.Bold = true\n\n            Excel.Columns.Columns(4).Columnwidth = 15\n            Excel.Cells(row,col+3).borders.LineStyle = 1\n            Excel.Cells(row,col+3).HorizontalAlignment = 3\n            Excel.Cells(row+2,col+3).Value = 1 'insert item quantity corresponding to PartNumber\n\n            Excel.Cells(row,col+4).Value = \"SinexRef\"\n\n            Excel.Cells(row,col+4).Font.Bold = true\n\n            Excel.Columns.Columns(5).Columnwidth = 15\n            Excel.Cells(row,col+4).borders.LineStyle = 1\n\n            Excel.Cells(row,col+4).HorizontalAlignment = 3\n            Excel.Cells(row+2,col+4).Value = 1 'insert Sinex Ref corresponding to PartNumber\n\n            t = t + 1\n        Next\n    End If\n\n    Dim k As Integer\n    For k = 1 To oInstances.Count\n        Dim oInst As Product\n        Set oInst = oInstances.Item(k)\n\n        Call WalkDownTree(oInst)\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1505935305, "post_id": 46330193, "comment_id": 79621230, "body": "You have to specify which element of array you want in <code>&amp; arr &amp;</code>. As you want to list them all you need to have a loop that builds it."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 3, "creation_date": 1505937312, "post_id": 46330193, "comment_id": 79622258, "body": "<code>On Error Resume Next</code> is a nice way to shoot yourself in the foot when attempting to debug code. Actually, it&#39;s a nice way to shoot yourself in the foot in debugged production code except when used in a <i>very</i> controlled manner."}], "answers": [{"comments": [{"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1505935631, "post_id": 46330228, "comment_id": 79621396, "body": "It skips over that part actually. The message box is not popping up."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1505935701, "post_id": 46330228, "comment_id": 79621431, "body": "It is declared as a collection. My bad. Extremely sorry."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 6, "last_activity_date": 1505936977, "last_edit_date": 1505936977, "creation_date": 1505935336, "answer_id": 46330228, "question_id": 46330193, "link": "https://stackoverflow.com/questions/46330193/vba-display-collection-in-a-message-box-error/46330228#46330228", "title": "VBA Display Collection in a message box - error", "body": "<p>For an array, as it appeared that the OP was using one.  Now that the OP has editted the post to show a collection this method will not work.</p>\n\n<p>I will leave it for future readers for an option with arrays.</p>\n\n<pre><code>MsgBox \"There are \" &amp; UBound(arr) + 1 &amp; \" Reports available. They are  \" &amp; Join(arr,\",\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1505935966, "post_id": 46330385, "comment_id": 79621562, "body": "This will work if arr is an array. But in my case, it is a collection."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 3, "creation_date": 1505936345, "post_id": 46330385, "comment_id": 79621760, "body": "@Sid29 for the love of everything that&#39;s good in this world, <b>please</b> rename that variable to something meaningful, e.g. <code>reportColumns</code>. And <a href=\"https://www.joelonsoftware.com/2005/05/11/making-wrong-code-look-wrong/\" rel=\"nofollow noreferrer\"><b>drop <i>Systems Hungarian</i> notation</b></a>."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505936411, "post_id": 46330385, "comment_id": 79621798, "body": "@Mat&#39;sMug - I suppose that you mean me and not Sid?"}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505936476, "post_id": 46330385, "comment_id": 79621844, "body": "@Mat&#39;sMug Yes sir, will do :) It is so confusing. I started building it as an array and then just changed it to collection, that&#39;s why."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505936491, "post_id": 46330385, "comment_id": 79621856, "body": "@Mat&#39;sMug - ok, I will edit it here. But in general, once I started like this it is tough to change. My code will become inconsistent."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 1, "creation_date": 1505936534, "post_id": 46330385, "comment_id": 79621888, "body": "@Sid &amp; Vityata I happen to know <a href=\"http://www.rubberduckvba.com/\" rel=\"nofollow noreferrer\">a certain refactoring tool</a> that can help you fix that (and many other things) ;-)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505936600, "post_id": 46330385, "comment_id": 79621923, "body": "@Mat&#39;sMug - now you only need to know a certain boss, who does not allow additional software used in the company and everything will come to its place."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1505936655, "post_id": 46330385, "comment_id": 79621947, "body": "If your IT folks / programmers have tooling such as ReSharper or they&#39;re using Visual Studio, that certain boss is unfairly blocking your productivity."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505937052, "post_id": 46330385, "comment_id": 79622122, "body": "@Mat&#39;sMug - true, but &quot;the programmers are programmers and I am writing on that funny scripting language that does not even compile&quot; (these are real  words, that I have heard about 4 years ago in a German company. I always laugh when I remember it! :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505937157, "post_id": 46330385, "comment_id": 79622175, "body": "@Vityata oh FFS... he&#39;s mistaking VBA for VBScript. WTF does he think &#39;Debug&#39; -&gt; &#39;Compile&#39; do?!"}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505937317, "post_id": 46330385, "comment_id": 79622264, "body": "@Mat&#39;sMug will definitely look into that. Thanks:-)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505937346, "post_id": 46330385, "comment_id": 79622285, "body": "@Mat&#39;sMug - he meant VBA and he meant compiling the way C# does."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1505937755, "post_id": 46330385, "comment_id": 79622518, "body": "Wow, what a hopeless ignorant jerk. <a href=\"https://stackoverflow.com/a/31861832/1188513\">VBA is a perfectly fine OOP-capable COM-based language</a> and FWIW it&#39;s a hosted version of VB6, running with the very same VM. And VB6 was the &quot;funny scripting language&quot; everyone was using to compile executables and type libraries 15 years ago. The VM runs p-code, VBA compiles to p-code, and p-code is the pre-.NET equivalent of MSIL or Java&#39;s bytecode. This loser has no clue what he&#39;s talking about."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505938161, "post_id": 46330385, "comment_id": 79622722, "body": "@Mat&#39;sMug - true but he had his own way of understanding computers... That&#39;s why I have separated VBA from the other languages here -  <a href=\"http://vitoshacademy.com/about\" rel=\"nofollow noreferrer\">vitoshacademy.com/about</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1505940141, "post_id": 46330385, "comment_id": 79623643, "body": "@Vityata &quot;Smart Indent&quot; is actually &quot;Smart Indenter&quot;, and that&#39;s the 32-bit version. Rubberduck ported the original VB6 source code to C# with a few bug fixes, and Smart Indenter now lives on as a Rubberduck feature, happily running in 64-bit hosts. Sad to see Rubberduck missing on that page :&#39;("}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1505941021, "post_id": 46330385, "comment_id": 79624028, "body": "@Mat&#39;sMug - cheer up, it will appear in the near future :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 4, "last_activity_date": 1505936814, "last_edit_date": 1505936814, "creation_date": 1505935902, "answer_id": 46330385, "question_id": 46330193, "link": "https://stackoverflow.com/questions/46330193/vba-display-collection-in-a-message-box-error/46330385#46330385", "title": "VBA Display Collection in a message box - error", "body": "<p>This is what I came up with:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim arr     As Variant\n    arr = Array(\"Today\", \"Yesterday\", \"DayBefore\")\n\n    MsgBox (\"There are \" &amp; UBound(arr) + 1 &amp; _\n            \" reports available. They are \" &amp; Join(arr, \", \") &amp; \".\")\n\n\nEnd Sub\n</code></pre>\n\n<p>Concerning the collection this is one way to transfer the collection to a string:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe2()\n\n    Dim reportsCol  As New Collection\n    Dim i           As Long\n    Dim textReport  As String\n\n    reportsCol.Add \"Today\"\n    reportsCol.Add \"Yesterday\"\n    reportsCol.Add \"The day before yesterday\"\n\n    For i = 1 To reportsCol.Count\n        textReport = TextReport &amp; \" \" &amp; reportsCol(i) &amp; _\n            IIf(i = reportsCol.Count, \".\", \",\")\n    Next i\n\n    MsgBox textReport\n\nEnd Sub\n</code></pre>\n\n<p>The <code>IIf</code> at the bottom decides whether to put a full stop <code>.</code> or a comma <code>,</code>.</p>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2767, "favorite_count": 0, "accepted_answer_id": 46330385, "answer_count": 2, "score": 1, "last_activity_date": 1505936977, "creation_date": 1505935217, "last_edit_date": 1531164843, "question_id": 46330193, "link": "https://stackoverflow.com/questions/46330193/vba-display-collection-in-a-message-box-error", "title": "VBA Display Collection in a message box - error", "body": "<p>I am trying to Pop-up a message something like, </p>\n\n<pre><code>\"There are 3 Reports available . They are Today, Yesterday, Day before\"\n</code></pre>\n\n<p>This is the code, </p>\n\n<pre><code>  On Error Resume Next\n  For Each a In MonthYear\n     arr.Add a, a\n  Next\n\n  For i = 1 To arr.Count\n     Cells(i, 1) = arr(i)\n  Next\n\n\nMsgBox (\"There are \" &amp; arr.Count &amp; \" Reports available. They are  \" &amp; arr &amp;\n</code></pre>\n\n<p>But it is not working. It says sub or argument not found.</p>\n"}, {"tags": ["excel", "for-loop", "if-statement", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1505934637, "post_id": 46329993, "comment_id": 79620889, "body": "change the <code>or</code>s to <code>And</code>s"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5849766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee7a0f3f6c80f0e245959e709c96ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Maxx Sawyer", "link": "https://stackoverflow.com/users/5849766/maxx-sawyer"}, "edited": false, "score": 0, "creation_date": 1505954325, "post_id": 46330308, "comment_id": 79628046, "body": "Okay I&#39;ll have to give that a try, thanks for the help!"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 3, "last_activity_date": 1505935618, "creation_date": 1505935618, "answer_id": 46330308, "question_id": 46329993, "link": "https://stackoverflow.com/questions/46329993/clearing-contents-of-cell-with-for-loop-and-if-statement/46330308#46330308", "title": "Clearing contents of cell with for loop and if statement", "body": "<p>Whenever I see multiple conditions for <code>IF</code> statement, I immediately think about using Select Case for ease of readability and maintenance.</p>\n\n<pre><code>For Each cell In Worksheets(\"Sheet1\").UsedRange\n\n    Select Case Left(cell,3)\n\n        Case Is = 574, 584, 233 'do nothing\n        Case Else: cell.ClearContents\n\n    End Select\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5849766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee7a0f3f6c80f0e245959e709c96ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Maxx Sawyer", "link": "https://stackoverflow.com/users/5849766/maxx-sawyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505935618, "creation_date": 1505934518, "last_edit_date": 1531161705, "question_id": 46329993, "link": "https://stackoverflow.com/questions/46329993/clearing-contents-of-cell-with-for-loop-and-if-statement", "title": "Clearing contents of cell with for loop and if statement", "body": "<p>I have this bit of code:</p>\n\n<pre><code>For Each cell In Worksheets(\"Sheet1\").UsedRange\n      If(Left(cell, 3) &lt;&gt; 574 Or Left(cell, 3) &lt;&gt; 584 Or Left(cell, 3) &lt;&gt; 233) Then cell.ClearContents\nNext\n</code></pre>\n\n<p>The codes purpuse is to loop through all used cells in the spread sheet and if the first three digits are not 574, 233, 584, then the cell will be set to empty. </p>\n\n<p>In my spreadsheet I have values that should pass, the first three digits are equal to 574, 233, 584; but instead the loop delete everything from the spreadsheet. Any insight into errors in logic I may have would be welcomed. </p>\n"}, {"tags": ["css", "vba", "excel", "out-of-memory"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1505934453, "post_id": 46329843, "comment_id": 79620786, "body": "Can you also show the code, that calls the <code>Sub StatusBar</code>? I guess that you are entering a recursion without realizing it. E.g., you are calling from a <code>Worksheet_SelectChange</code> event, your code changes something, and you enter the event again and this is recursion."}, {"owner": {"reputation": 652, "user_id": 963687, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/hjj4E.jpg?s=128&g=1", "display_name": "ahmet", "link": "https://stackoverflow.com/users/963687/ahmet"}, "edited": false, "score": 0, "creation_date": 1505934522, "post_id": 46329843, "comment_id": 79620820, "body": "And also the full error message?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 652, "user_id": 963687, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/hjj4E.jpg?s=128&g=1", "display_name": "ahmet", "link": "https://stackoverflow.com/users/963687/ahmet"}, "edited": false, "score": 0, "creation_date": 1505934720, "post_id": 46329843, "comment_id": 79620932, "body": "@ahmet &quot;Out of stack space&quot; is the full error message. It&#39;s in the title <i>and</i> the body of the question."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1505934875, "post_id": 46329843, "comment_id": 79621005, "body": "Toggle <code>Application.EnableEvents</code> off at the start, and back on at the end of the procedure. Still out of stack space? If not, then your recursion is as @Vityata said: you&#39;re handling a worksheet event by calling this procedure, which modifies the worksheet, to which Excel responds by raising an event, which takes execution back to the worksheet event handler, only a few stack frames further down the call stack. Step through your code with the &quot;call stack&quot; debug toolwindow open, you&#39;ll see what&#39;s wrong and where."}, {"owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "reply_to_user": {"reputation": 652, "user_id": 963687, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/hjj4E.jpg?s=128&g=1", "display_name": "ahmet", "link": "https://stackoverflow.com/users/963687/ahmet"}, "edited": false, "score": 0, "creation_date": 1505936330, "post_id": 46329843, "comment_id": 79621746, "body": "@ahmet Because it&#39;s inconsistent, I can&#39;t reproduce with the rest of the error text. I&#39;ve edited the post with an example of the code that calls it."}, {"owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505936406, "post_id": 46329843, "comment_id": 79621794, "body": "@Mat&#39;sMug I&#39;ve updated to include EnableEvents, so we&#39;ll see if the error recurs. It&#39;s not something I can reproduce consistently. Because I&#39;m using Excel for Mac 2016, I have no ability to enter the call stack debug tool window. My VBA editor is very bare bones."}], "answers": [{"comments": [{"owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "edited": false, "score": 0, "creation_date": 1505940083, "post_id": 46330817, "comment_id": 79623608, "body": "What would that look like? If I call it via &quot;Call StatusBars(Target, ActiveSheet), will I need to declare my Sub as: Sub StatusBars(ByVal Target As Range, ActiveSheet As Worksheet)? And what would that mean for the variables themselves -- would I still need to specify ActiveSheet.Range in my &quot;Find&quot;?"}, {"owner": {"reputation": 652, "user_id": 963687, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/hjj4E.jpg?s=128&g=1", "display_name": "ahmet", "link": "https://stackoverflow.com/users/963687/ahmet"}, "reply_to_user": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "edited": false, "score": 0, "creation_date": 1505940464, "post_id": 46330817, "comment_id": 79623789, "body": "I dont know remember the syntax but it would propably be as you writtren in the comment. I am not sure, it fixs or not but as you try to refactor, you also should do that to encapsulate your variables."}], "tags": [], "owner": {"reputation": 652, "user_id": 963687, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/hjj4E.jpg?s=128&g=1", "display_name": "ahmet", "link": "https://stackoverflow.com/users/963687/ahmet"}, "is_accepted": false, "score": 0, "last_activity_date": 1505937525, "creation_date": 1505937525, "answer_id": 46330817, "question_id": 46329843, "link": "https://stackoverflow.com/questions/46329843/getting-out-of-stack-space-error-inconsistently/46330817#46330817", "title": "Getting &quot;Out of Stack space&quot; error inconsistently", "body": "<p>Activesheet is a global variable. When you set tabstarted1 etc. with Activesheet, because activesheet is on stack and did not disposed, your other variables like tabstarted1, design1 stays on stack memory. Try to get activesheet as parameter to your function.</p>\n"}, {"comments": [{"owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "edited": false, "score": 0, "creation_date": 1505943322, "post_id": 46330823, "comment_id": 79624989, "body": "This seems to have helped with the stack space issue, but now if any other issue occurs, my Excel is essentially frozen because the EnableEvents hasn&#39;t been reenabled. Is there a downside to using .EnableEvents = True immediately after I call the StatusBars() function? I&#39;m also still getting an occasional error (I believe it was the &quot;With block variable not set&quot; error) that highlights the &quot;Set TabStarted = TabStarted1.Offset(0, 1)&quot; line in the function."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1505937558, "creation_date": 1505937558, "answer_id": 46330823, "question_id": 46329843, "link": "https://stackoverflow.com/questions/46329843/getting-out-of-stack-space-error-inconsistently/46330823#46330823", "title": "Getting &quot;Out of Stack space&quot; error inconsistently", "body": "<p>I think the error is because your code changes the sheet and thus a new event is called. To make sure that this is the case, do the following - insert a STOP on the event like this:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Application.ScreenUpdating = False\n    Stop\n\n    Dim var1 As Variant\n    'rest of your code.\nEnd Sub\n</code></pre>\n\n<p>The first time you have a selection change you will stop on the stop. Then press <kbd>F5</kbd> and continue. If you stop again, then it is a recursion error. </p>\n\n<p>The easiest way to fix it is with <code>Application.EnableEvents = False</code> at the beginning of the event and <code>Application.EnableEvents = True</code> at the end of the code.</p>\n"}], "owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1505937558, "creation_date": 1505933981, "last_edit_date": 1505936503, "question_id": 46329843, "link": "https://stackoverflow.com/questions/46329843/getting-out-of-stack-space-error-inconsistently", "title": "Getting &quot;Out of Stack space&quot; error inconsistently", "body": "<p>On every page of my workbook, I have a status bar made of status boxes. There are three statuses -- \"Tab Started\", \"Design Updated\", and \"Configurations Complete\". Originally I had these boxes called out on every page (and using absolute references), but I recently tried to improve the efficiency and flexibility of the workbook by moving that code to a separate module and calling it on every workbook page near the top (+ setting variables using \"Find\" rather than absolute references). </p>\n\n<p>However, while this works 90% of the time or more, occasionally I get an error message \"Out of Stack Space\". Reading on the MSDN, none of the examples that might trigger this error seem to apply to my code (e.g. the code doesn't call itself). </p>\n\n<p>See below for code. </p>\n\n<pre><code>'This function is called by all workbook tabs and controls the status boxes\n\nSub StatusBars(ByVal Target As Range)\n\nDim TabStarted1 As Range\nSet TabStarted1 = ActiveSheet.Range(\"A4:Z5\").Find(\"Tab Started\")\nDim TabStarted As Range\nSet TabStarted = TabStarted1.Offset(0, 1) \n\nDim Design1 As Range\nSet Design1 = ActiveSheet.Range(\"A6:Z7\").Find(\"Design Updated\")\nDim Design As Range\nSet Design = Design1.Offset(0, 1)\n\nDim Configurations1 As Range\nSet Configurations1 = ActiveSheet.Range(\"A8:Z9\").Find(\"Configurations Complete\")\nDim Configurations As Range\nSet Configurations = Configurations1.Offset(0, 1)\n\nIf Not Intersect(Target, TabStarted) Is Nothing Then\n    If Target.Cells.Count = 2 Then\n        If WorksheetFunction.CountA(Target) = 0 Then 'If box is empty, then add an X, format it, change the box color and the tab color\n\n            TabStarted.Value = \"X\"\n            TabStarted.HorizontalAlignment = xlCenter\n            TabStarted.Font.Size = 25\n            TabStarted.Interior.Color = RGB(255, 255, 0)\n            Design.Interior.Color = RGB(255, 255, 255)\n            Design.Value = \"\"\n            Configurations.Interior.Color = RGB(255, 255, 255)\n            Configurations.Value = \"\"\n            ActiveSheet.Tab.Color = RGB(255, 255, 0)\n\n        Else 'if box is already checked clear, the X, the color, and the tab color\n            TabStarted.Interior.Color = RGB(255, 255, 255)\n            TabStarted.Value = \"\"\n            ActiveSheet.Tab.ColorIndex = xlColorIndexNone\n       End If\n    End If\n\nEnd If\n\nIf Not Intersect(Target, Design) Is Nothing Then\n    If Target.Cells.Count = 2 Then\n        If WorksheetFunction.CountA(Target) = 0 Then\n            Design.Value = \"X\"\n            Design.HorizontalAlignment = xlCenter\n            Design.Font.Size = 25\n            Design.Interior.Color = RGB(0, 112, 192)\n            TabStarted.Interior.Color = RGB(255, 255, 255)\n            TabStarted.Value = \"\"\n            Configurations.Interior.Color = RGB(255, 255, 255)\n            Configurations.Value = \"\"\n            ActiveSheet.Tab.Color = RGB(0, 112, 192)\n\n        Else\n            Design.Interior.Color = RGB(255, 255, 255)\n            Design.Value = \"\"\n            ActiveSheet.Tab.ColorIndex = xlColorIndexNone\n        End If\n    End If\n\nEnd If\n\nIf Not Intersect(Target, Configurations) Is Nothing Then\n    If Target.Cells.Count = 2 Then\n        If WorksheetFunction.CountA(Target) = 0 Then\n            Configurations.Value = \"X\"\n            Configurations.HorizontalAlignment = xlCenter\n            Configurations.Font.Size = 25\n            Configurations.Interior.Color = RGB(0, 176, 80)\n            TabStarted.Interior.Color = RGB(255, 255, 255)\n            TabStarted.Value = \"\"\n            Design.Interior.Color = RGB(255, 255, 255)\n            Design.Value = \"\"\n            ActiveSheet.Tab.Color = RGB(0, 176, 80)\n\n        Else\n            Configurations.Interior.Color = RGB(255, 255, 255)\n            Configurations.Value = \"\"\n            ActiveSheet.Tab.ColorIndex = xlColorIndexNone\n        End If\n    End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>EDIT:\nAn example of the code that calls this function:</p>\n\n<pre><code>'Remove Case Sensitivity\n  Option Compare Text\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nApplication.ScreenUpdating = False\n\n\nDim var1 As Variant\nDim var2 As Variant\nDim var3 As Variant\n\nDim PlusTemplates As Range\nSet PlusTemplates = Range(\"A14:Z15\").Find(\"+\")\n\nCall StatusBars(Target)\n\n[rest of the code]\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1505933478, "post_id": 46329679, "comment_id": 79620246, "body": "What have you tried? Can you give some more examples, and what your desired output is? Do you just want to know the character position of each letter in a string?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505933500, "post_id": 46329679, "comment_id": 79620255, "body": "so what would your output look like?  would it be in multiple cells as a small table, or one cell?"}, {"owner": {"reputation": 134, "user_id": 6835447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/625471f9507c88697728fc4b9611c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Hill", "link": "https://stackoverflow.com/users/6835447/justin-hill"}, "edited": false, "score": 0, "creation_date": 1505936276, "post_id": 46329679, "comment_id": 79621724, "body": "@Jeeped - Thanks for the feedback! I edited the question to try and meet your standards."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1505934264, "creation_date": 1505934264, "answer_id": 46329928, "question_id": 46329679, "link": "https://stackoverflow.com/questions/46329679/how-can-i-split-an-alphanumeric-string-in-excel-at-each-letter-and-capture-the-p/46329928#46329928", "title": "How can I split an alphanumeric string in excel at each letter and capture the position of that letter", "body": "<p>for a small table, let's get the location first:</p>\n\n<pre><code>=IFERROR(AGGREGATE(15,6,ROW(INDIRECT(\"1:\" &amp; LEN($A$1)))/(ISERROR(--MID($A$1,ROW(INDIRECT(\"1:\" &amp; LEN($A$1))),1))),ROW(1:1)),\"\")\n</code></pre>\n\n<p>And copy down.</p>\n\n<p>This will return the location of all the letters.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uOniw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uOniw.png\" alt=\"enter image description here\"></a></p>\n\n<p>From this a simple MID will get the letter:</p>\n\n<pre><code>=IF(B1&lt;&gt;\"\",MID($A$1,B1,1),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/EPthZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EPthZ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 134, "user_id": 6835447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/625471f9507c88697728fc4b9611c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Hill", "link": "https://stackoverflow.com/users/6835447/justin-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "closed_date": 1505982004, "accepted_answer_id": 46329928, "answer_count": 1, "score": -3, "last_activity_date": 1505936183, "creation_date": 1505933341, "last_edit_date": 1531161705, "question_id": 46329679, "link": "https://stackoverflow.com/questions/46329679/how-can-i-split-an-alphanumeric-string-in-excel-at-each-letter-and-capture-the-p", "closed_reason": "Not suitable for this site", "title": "How can I split an alphanumeric string in excel at each letter and capture the position of that letter", "body": "<p>I would like to split an alphanumeric string into parts based on the letters in the string. There will always be one or two numbers followed by a letter.  For example, '5F18J21H', I would like to know that letter 1 is F and is in position 2, letter 2 is J and in position 5, letter 3 is H and in position 8.  Can this be done with a function, or is vba the only option?  Any <strong>help</strong> is greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 1, "creation_date": 1506009895, "post_id": 46329608, "comment_id": 79657284, "body": "The answer was post with <a href=\"https://stackoverflow.com/users/1569536/scott-holtzman\"><code>Scott Holtzman</code></a> so deleted his answer because the question scope extended and updating. He introduced a <a href=\"http://www.ozgrid.com/VBA/autofilter-criteria.htm\" rel=\"nofollow noreferrer\">reference</a> that involved exact and useful true answer. with best regard and thanks for him."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506011429, "post_id": 46329608, "comment_id": 79658147, "body": "And to choose <a href=\"https://stackoverflow.com/a/21835032/7690982\">multiple criteria</a> on Autofilter"}], "answers": [{"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 1, "last_activity_date": 1506015399, "creation_date": 1506015399, "answer_id": 46350023, "question_id": 46329608, "link": "https://stackoverflow.com/questions/46329608/what-is-table-filtered-criteria-as-one-of-or-array-of-choosen-values-from-colu/46350023#46350023", "title": "What is table filtered criteria? (As one of or array of choosen values from column header drop-down list of Table)", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/autofilter-filters-property-excel\" rel=\"nofollow noreferrer\"><code>.AutoFilter.Filters</code></a> can be used to get the filter values:</p>\n\n<pre><code>Dim list As ListObject, colIndex As Long, filter As Filter\nSet list = ActiveSheet.ListObjects(\"Table1\")\nIf list.ShowAutoFilter = False Then Exit Sub   ' filters are not on\n\ncolIndex = list.ListColumns(\"Month\").Index\nSet filter = list.AutoFilter.filters(colIndex)\nIf filter.On = False Then Exit Sub             ' no filter\n\nSelect Case filter.Operator\n    Case 0:        Debug.Print filter.Criteria1                   ' no operator\n    Case xlOr:     Debug.Print filter.Criteria1, filter.Criteria2\n    Case xlValues: Debug.Print Join(filter.Criteria1)             ' array\n    Case Else: Debug.Print filter.Operator, filter.Criteria1, filter.Criteria2 ' handle the rest of the operators\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 46350023, "answer_count": 1, "score": -1, "last_activity_date": 1506015399, "creation_date": 1505933122, "last_edit_date": 1531161705, "question_id": 46329608, "link": "https://stackoverflow.com/questions/46329608/what-is-table-filtered-criteria-as-one-of-or-array-of-choosen-values-from-colu", "title": "What is table filtered criteria? (As one of or array of choosen values from column header drop-down list of Table)", "body": "<p>I have a Table with multiple columns that has auto filtering.</p>\n\n<p>One of my columns, has month auto filtering, which taking in bellow code. </p>\n\n<pre><code>ActiveSheet.ListObjects(\"Salary\").Range.AutoFilter Field:= _\n    Application.WorksheetFunction.Match(\"Mounth\", Range(\"Salary[#Headers]\"), 0), _\n    Criteria1:=\"=09\"\n</code></pre>\n\n<p>Sometimes I need give filtering criteria value of that column an assign to variable. So always not known about what is the filtered value.</p>\n\n<p>Of course user may select more than one items from table header menu drop-down list, as act of code below:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Salary\").Range.AutoFilter Field:= _\n    Application.WorksheetFunction.Match(\"Mounth\", Range(\"Salary[#Headers]\"), 0), _\n    Criteria1:=\"=09\", Operator:=xlOr, Criteria2:=\"=08\"\n</code></pre>\n\n<p>How can catch all selected ones in an array or sure if the selected value is unique and assigning that to a same variable?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1505932279, "post_id": 46329180, "comment_id": 79619655, "body": "Start by following this: <a href=\"https://www.ablebits.com/office-addins-blog/2013/09/19/insert-watermark-excel-worksheets/\" rel=\"nofollow noreferrer\">ablebits.com/office-addins-blog/2013/09/19/&hellip;</a> and use the macro recorder to record your actions. It will give you more code that add to what you have currently."}, {"owner": {"reputation": 138, "user_id": 8636825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cf2647051652e7c3d638a8e21090861?s=128&d=identicon&r=PG&f=1", "display_name": "M C", "link": "https://stackoverflow.com/users/8636825/m-c"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505934179, "post_id": 46329180, "comment_id": 79620639, "body": "Hey braX, thanks for the response.  I took a look at that link, and it&#39;s not helping my solve the specific problem I am running into here.  The watermark I want to use is not an image file outside of the spreadsheet, it&#39;s a textbox in the spreadsheet.  Also, using the header/footer option doesn&#39;t seem to be flexible enough for what I&#39;m trying to accomplish here."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505935771, "post_id": 46329180, "comment_id": 79621469, "body": "What you want to do may not be possible. I guess you will have to wait and see what others say."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1505937278, "post_id": 46329180, "comment_id": 79622234, "body": "Are there any hidden rows, hidden columns, or print areas?  Are all the row heights  and Column Widths the same?"}, {"owner": {"reputation": 138, "user_id": 8636825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cf2647051652e7c3d638a8e21090861?s=128&d=identicon&r=PG&f=1", "display_name": "M C", "link": "https://stackoverflow.com/users/8636825/m-c"}, "edited": false, "score": 0, "creation_date": 1505941055, "post_id": 46329180, "comment_id": 79624042, "body": "There are no hidden rows or columns or print areas.  Every row has the same height.  Not all columns have the same width."}], "owner": {"reputation": 138, "user_id": 8636825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cf2647051652e7c3d638a8e21090861?s=128&d=identicon&r=PG&f=1", "display_name": "M C", "link": "https://stackoverflow.com/users/8636825/m-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505934487, "creation_date": 1505931590, "last_edit_date": 1505934487, "question_id": 46329180, "link": "https://stackoverflow.com/questions/46329180/how-do-i-replicate-and-center-an-object-in-an-excel-worksheet-using-vba", "title": "How do I replicate and center an object in an Excel worksheet using VBA?", "body": "<p>I have some VBA that takes the contents of a few different worksheets, and prints them to PDF.  I'm trying to add a watermark type effect to each page that gets printed.  However, not every page will receive the same watermark.  I have a textbox that will correctly get updated as the VBA is running, and will always have what I want my \"watermark\" to be.  I've gotten to the point where I can copy the textbox and paste it in a specific location, but I need to be able to paste it in multiple locations, which will not always be the same.  I'm looking for each page to contain the \"watermark\" and for it to be centered (and potentially resized down to the dimensions of the page in a case where the watermark is larger than the page).  Additionally, the number of pages added to the PDF by the sheet is variable, but all pages should always receive the \"watermark\".  I have virtually no background in VBA.  The below code was produced by recording a macro.</p>\n\n<pre><code>Sheets(\"Sheet 1\").Select\nActiveSheet.Shapes.Range(Array(\"TextBox 3\")).Select\nSelection.Copy\nSheets(\"Sheet 2\").Select\nRange(\"C16\").SelectActiveSheet.Paste\n</code></pre>\n\n<p>I need the paste location to be dynamic and centered in the middle of the printed page.  I also need the image to appear on each printed page.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Edit:  One of the things the existing VBA does is print all the pages on the worksheet to PDF.  It then changes values of the pages, and prints them to PDF as well.  I need the watermark to update when the values do, which is currently working.  The problem I am having is that when the values change, the number of rows change, and so does the page count.  If I had a static page count I would just add the watermark (which is already updating as needed) everywhere it's supposed to be.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1505931144, "post_id": 46328973, "comment_id": 79619009, "body": "Add a nested if inside the first. <code>If Not (cell = 2012 or cell = 2013 or ...) then</code>"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1505932385, "post_id": 46329298, "comment_id": 79619717, "body": "<code>2012&lt;&gt;&quot;2012&quot;</code> but both with return true in IsNumeric.  And cell can certainly equal a number, as the default child of cell is <code>cell.Value</code>"}, {"owner": {"reputation": 156, "user_id": 6300208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a90edea6f653d90419946c32b8fe878?s=128&d=identicon&r=PG&f=1", "display_name": "brett_x", "link": "https://stackoverflow.com/users/6300208/brett-x"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505933083, "post_id": 46329298, "comment_id": 79620067, "body": "Thanks @ScottCraner . I&#39;ve had my head in Word vba lately. I updated my answer, it works for me."}], "tags": [], "owner": {"reputation": 156, "user_id": 6300208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a90edea6f653d90419946c32b8fe878?s=128&d=identicon&r=PG&f=1", "display_name": "brett_x", "link": "https://stackoverflow.com/users/6300208/brett-x"}, "is_accepted": true, "score": 1, "last_activity_date": 1505933036, "last_edit_date": 1505933036, "creation_date": 1505932037, "answer_id": 46329298, "question_id": 46328973, "link": "https://stackoverflow.com/questions/46328973/vba-looping-over-cells/46329298#46329298", "title": "VBA looping over cells", "body": "<p>Since you're really just doing a few more evaluations on the same cell, you can just \"and them\" together to keep it simple. </p>\n\n<pre><code>If IsNumeric(cell) And Not IsEmpty(cell) AND cell &lt;&gt; 2012 AND cell &lt;&gt; 2013 Then\n</code></pre>\n"}], "owner": {"reputation": 1314, "user_id": 7092900, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd63573fc5c6bb06de5243747e027fea?s=128&d=identicon&r=PG&f=1", "display_name": "Max888", "link": "https://stackoverflow.com/users/7092900/max888"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 46329298, "answer_count": 1, "score": 0, "last_activity_date": 1505933036, "creation_date": 1505930826, "last_edit_date": 1505931802, "question_id": 46328973, "link": "https://stackoverflow.com/questions/46328973/vba-looping-over-cells", "title": "VBA looping over cells", "body": "<p>I have some code working which replaces the values of cells if they are numeric and not empty. How can I amend the code to only replace the values if they are also not in (\"2012\", \"2013\", 2012, 2013)?</p>\n\n<pre><code>Set rng = ActiveSheet.UsedRange\nFor Each cell In rng\n  If IsNumeric(cell) And Not IsEmpty(cell) Then\n    cell.Value = \"max\"\n  End If\nNext cell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 8227225, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/71fae0fe43a6514240d64d07ce8b7ef8?s=128&d=identicon&r=PG&f=1", "display_name": "chairSitter", "link": "https://stackoverflow.com/users/8227225/chairsitter"}, "edited": false, "score": 1, "creation_date": 1505930970, "post_id": 46328976, "comment_id": 79618909, "body": "Wow. Thanks. I should have been able to figure that out... I feel dumb..."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1505930830, "creation_date": 1505930830, "answer_id": 46328976, "question_id": 46328922, "link": "https://stackoverflow.com/questions/46328922/double-quote-issue-with-pasting-a-formula-using-a-macro/46328976#46328976", "title": "Double quote issue with pasting a formula using a macro", "body": "<p>In VBA you need to double-up the quotes inside the string</p>\n\n<pre><code>Range(\"B2:B\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row).Formula = \"=IFERROR(LEFT(A2,FIND(\"\" \"\",A2)-1),A2)\"\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 8227225, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/71fae0fe43a6514240d64d07ce8b7ef8?s=128&d=identicon&r=PG&f=1", "display_name": "chairSitter", "link": "https://stackoverflow.com/users/8227225/chairsitter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 46328976, "answer_count": 1, "score": 0, "last_activity_date": 1505931466, "creation_date": 1505930617, "last_edit_date": 1531164843, "question_id": 46328922, "link": "https://stackoverflow.com/questions/46328922/double-quote-issue-with-pasting-a-formula-using-a-macro", "title": "Double quote issue with pasting a formula using a macro", "body": "<p>I am trying to write a Macro for a work project, and have come across an issue.</p>\n\n<p>My goal is to paste a formula in cell B2 and have excel fill it down to the last row with anything in it, referencing column A. What I would like to paste is:</p>\n\n<pre><code>=IFERROR(LEFT(A2,FIND(\" \",A2)-1),A2)\n</code></pre>\n\n<p>The formula is looking for the first space character in cell A2 (I use \" \" to mean a space) and to paste everything to the left of that space in the cell the formula is being typed in. Then I am filling it down. This is my code so far:</p>\n\n<pre><code>Range(\"B2:B\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row).Formula = \"=IFERROR(LEFT(A2,FIND(\" \",A2)-1),A2)\"\n</code></pre>\n\n<p>I think that excel is thinking that I am ending the formula after the first double quote in the FIND function. </p>\n\n<p>I have looked around a bit online and found people saying to use &amp;CHR(34) to force excel to interpret a doublequote as a character but I think this is only for strings. </p>\n\n<p>Does anyone know how to avoid this double quote issue? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505931273, "post_id": 46328853, "comment_id": 79619074, "body": "Any tool is going to have limitations. Consider the case where the <code>&quot;fnProcessOrder&quot;</code> string literal would be concatenated from parts, e.g. <code>.OnClick = &quot;fnProcess&quot; &amp; itemType</code>. FWIW I&#39;m very curious about your work on execution paths, and how you&#39;re going about it. <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> could use your expertise here, as one of the biggest upcoming challenges is going to be implementing the 20-some &quot;code path analysis&quot; code inspections we intend to implement. Are you doing this without a symbol table and abstract syntax tree?"}, {"owner": {"reputation": 1146, "user_id": 561664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27d80e551bae5faa99df1106d768e158?s=128&d=identicon&r=PG", "display_name": "Albert Perrien", "link": "https://stackoverflow.com/users/561664/albert-perrien"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505931464, "post_id": 46328853, "comment_id": 79619184, "body": "Well, I plan to do some basic processing, either with pyparsing, lex, or something hand-rolled. So, there will definitely be a symbol  tree, I&#39;ve begun building it already. Not being able to read the .OnClick property is holding everything else up though. I&#39;m hoping that I don&#39;t have to write anything to parse the binary..."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1505931777, "post_id": 46328853, "comment_id": 79619348, "body": "It is possible the value that is actually assigned is not readable or reversible (like a memory pointer to a function for example or an internal handle). Add a non visible text control next to your OK button and whenever you dynamically change OnClick, update that one as well. Or have a fixed OnClick function that then reads that text field and redirects accordingly."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1505932152, "post_id": 46328853, "comment_id": 79619571, "body": "I&#39;ve been working on Rubberduck for the better part of 3 years now, and our parser/resolver has seen 5 major contributors and I can assure you that anything hand-rolled is doomed (sorry!). Line continuations, line numbers/labels, precompiler directives, special-cased syntaxes, telling an array access from a function call - anything &quot;basic&quot; is going to be a naive solution that will hopelessly break down for anything but trivial code and test cases. What you&#39;re undertaking is no small job, I promise. That said I&#39;m sure there&#39;s a way to get a button&#39;s actual <code>OnClick</code> value (Rubberduck needs it!)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1505933713, "post_id": 46328853, "comment_id": 79620381, "body": "I think one of our contributors has been working on this - I&#39;ll ping him. Pretty sure it <i>does</i> involve parsing the binary. Are you writing this in VBA?"}, {"owner": {"reputation": 1146, "user_id": 561664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27d80e551bae5faa99df1106d768e158?s=128&d=identicon&r=PG", "display_name": "Albert Perrien", "link": "https://stackoverflow.com/users/561664/albert-perrien"}, "edited": false, "score": 0, "creation_date": 1505936519, "post_id": 46328853, "comment_id": 79621875, "body": "I&#39;m currently fiddling with it in VBA, trying to learn about the problem. I&#39;m not welded to just VBA, though. If there&#39;s some other solution out there that works better, I&#39;ll happily look into it, as I&#39;m looking at Rubberduck right now. I&#39;m always open to learning something new."}], "answers": [{"comments": [{"owner": {"reputation": 1146, "user_id": 561664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27d80e551bae5faa99df1106d768e158?s=128&d=identicon&r=PG", "display_name": "Albert Perrien", "link": "https://stackoverflow.com/users/561664/albert-perrien"}, "edited": false, "score": 0, "creation_date": 1505937359, "post_id": 46329915, "comment_id": 79622297, "body": "I understand that with dynamic assignment, the current value of OnClick can change, but is there a way to see what the current value is while the application is running? That way I can log it to a file at least. I think you might be right, though. A good stack trace utility might be the way to go. Does vbWatchDog support logging the stack without tripping an error?"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 1146, "user_id": 561664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27d80e551bae5faa99df1106d768e158?s=128&d=identicon&r=PG", "display_name": "Albert Perrien", "link": "https://stackoverflow.com/users/561664/albert-perrien"}, "edited": false, "score": 1, "creation_date": 1505946877, "post_id": 46329915, "comment_id": 79626267, "body": "Just to make it clear - it&#39;s not just dynamic -- it can be handled by multiple VBA procedure, with the syntax I showed above. This won&#39;t apply if we use the <code>=fnProcess()</code> syntax, of course but I wanted to be sure that was known. RE: vbWatchDog, you can use LiveCallStack that doesn&#39;t require tripping an error but the thing is you&#39;d still have to write code to read the call stack somewhere... perhaps within the <code>fnProcess</code> function for instance."}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": false, "score": 1, "last_activity_date": 1505934220, "creation_date": 1505934220, "answer_id": 46329915, "question_id": 46328853, "link": "https://stackoverflow.com/questions/46328853/programmatically-determining-the-event-handler-for-an-onclick-event-in-vba/46329915#46329915", "title": "Programmatically Determining the Event Handler for an OnClick Event in VBA", "body": "<p>Actually, the code does not look right to me. If you want to assign a VBA function to an event procedure, you have to use syntax similar to this: <code>.OnClick = \"=fnProcess()\"</code> Note the literal <code>=</code> and the <code>()</code> -- those are mandatory for making Access recognize you want to call a function. </p>\n\n<p>As additional consideration, you can have a class module (let's call it <code>Observer</code>) that has code similar to this:</p>\n\n<pre><code>Private WithEvents ctlInterest As Access.Textbox\n\nPublic Sub Init(TargetControl As Access.Control)\n  Set ctlInterest = TargetControl\n  With ctlInterst\n    If .OnClick = \"\" Then\n      .OnClick = \"[Event Procedure]\"\n    End If\n  End With\nEnd Sub\n\nPrivate ctlInterest_OnClick()\n  fnProcess()\nEnd Sub\n</code></pre>\n\n<p>and you can then deploy the class in a form like so....</p>\n\n<pre><code>Private objObserver As Observer\n\nPrivate Sub Form_Load()\n  Set objObserver = New Observer\n  objObserver.Init(Me.txtInterest)\nEnd Sub   \n</code></pre>\n\n<p>which will yield the same result, and you end up with <em>multiple</em> event handlers. </p>\n\n<p>For more information <a href=\"https://accessexperts.com/blog/2012/10/22/maximizing-code-reuse-multiple-event-handlers/\" rel=\"nofollow noreferrer\">this</a> may be of help.</p>\n\n<p>In conjunction with the fact that function expressions are possible and the fact that it can be dynamically assigned at any time, it pretty much require code-path analysis to identify possible entry points for all events handlers in a general. Which means you need <a href=\"https://github.com/rubberduck-vba/Rubberduck/\" rel=\"nofollow noreferrer\">Rubberduck</a>'s parser for that. Note that static code path analysis is planned but not implemented yet, AIUI.</p>\n\n<p>Also, I want to be sure -- if your intention is to build a call stack trace for error handling, you might need to look at third party add-in. For example, <a href=\"http://www.everythingaccess.com/vbwatchdog.asp\" rel=\"nofollow noreferrer\">vbWatchDog</a>, a commerical product, can provide that information in VBA. </p>\n"}, {"comments": [{"owner": {"reputation": 1146, "user_id": 561664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27d80e551bae5faa99df1106d768e158?s=128&d=identicon&r=PG", "display_name": "Albert Perrien", "link": "https://stackoverflow.com/users/561664/albert-perrien"}, "edited": false, "score": 0, "creation_date": 1505940902, "post_id": 46330653, "comment_id": 79623979, "body": "I&#39;m trying to find the current OnClick function of a control, without altering that particular control. I&#39;m assuming that the value for OnClick is set elsewhere in the program."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 1146, "user_id": 561664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27d80e551bae5faa99df1106d768e158?s=128&d=identicon&r=PG", "display_name": "Albert Perrien", "link": "https://stackoverflow.com/users/561664/albert-perrien"}, "edited": false, "score": 1, "creation_date": 1505947159, "post_id": 46330653, "comment_id": 79626345, "body": "@AlbertPerrien wait, is this a one-off thing? If that is the case, you might be fine with using a watch expression set to <code>Break when value changes</code> on the <code>OnClick</code> property of the control..."}, {"owner": {"reputation": 1146, "user_id": 561664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27d80e551bae5faa99df1106d768e158?s=128&d=identicon&r=PG", "display_name": "Albert Perrien", "link": "https://stackoverflow.com/users/561664/albert-perrien"}, "edited": false, "score": 0, "creation_date": 1505952084, "post_id": 46330653, "comment_id": 79627569, "body": "That&#39;s a really decent suggestion! If I set that property with an error handler to catch it, I may be able interrupt and log all the activity in the app. That won&#39;t handle things that are set by the VB editor at compile time, but it&#39;s a great start."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 1146, "user_id": 561664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27d80e551bae5faa99df1106d768e158?s=128&d=identicon&r=PG", "display_name": "Albert Perrien", "link": "https://stackoverflow.com/users/561664/albert-perrien"}, "edited": false, "score": 1, "creation_date": 1505974895, "post_id": 46330653, "comment_id": 79633232, "body": "@Albert Have you tried running my code? It returns the full code for the <code>OnClick</code> event in the form module, and doesn&#39;t alter anything"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1505939497, "last_edit_date": 1505939497, "creation_date": 1505936893, "answer_id": 46330653, "question_id": 46328853, "link": "https://stackoverflow.com/questions/46328853/programmatically-determining-the-event-handler-for-an-onclick-event-in-vba/46330653#46330653", "title": "Programmatically Determining the Event Handler for an OnClick Event in VBA", "body": "<p>This will return the full code for the event. If you just use one sub inside that event, it should work.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub TestModulePrinter()\n    Dim subName As String\n    With Forms(\"Order Entry\").Controls(\"OK\")\n      subName = \"Private Sub \" &amp; .Name &amp; \"_OnClick()\"\n    End With\n    Dim i As Long\n    Dim IsPrinting As Boolean\n    With Forms(\"Order Entry\").Module\n        For i = 1 To .CountOfLines\n            If Not IsPrinting Then\n                If Trim(.Lines(i, 1)) = subName Then\n                    IsPrinting = True\n                End If\n            Else\n                If Trim(.Lines(i, 1)) = \"End Sub\" Then\n                    IsPrinting = False\n                Else\n                    Debug.Print .Lines(i, 1)\n                End If\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1146, "user_id": 561664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27d80e551bae5faa99df1106d768e158?s=128&d=identicon&r=PG", "display_name": "Albert Perrien", "link": "https://stackoverflow.com/users/561664/albert-perrien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1554, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1505939497, "creation_date": 1505930394, "question_id": 46328853, "link": "https://stackoverflow.com/questions/46328853/programmatically-determining-the-event-handler-for-an-onclick-event-in-vba", "title": "Programmatically Determining the Event Handler for an OnClick Event in VBA", "body": "<p>I'm working on an application that traces execution paths in MS Access VBA. However, I've run into a problem. It seems that you can dynamically assign handlers to control OnClick and and other such events in VBA, but I don't see a way to read events from those controls. For example:</p>\n\n<pre><code>With Forms(\"Order Entry\").Controls(\"OK\") \n If .OnClick = \"\" Then \n .OnClick = \"fnProcessOrder\" \n End If \nEnd With \n</code></pre>\n\n<p>This dynamically assigns the function \"fnProcessOrder\" to the \"OK\" button. However, if you try to get the value of that button, you get this:</p>\n\n<pre><code>With Forms(\"Order Entry\").Controls(\"OK\") \n  Debug.Print \"My Handler --&gt;\" + .OnClick\nEndWith\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>--&gt; [Event Procedure]\n</code></pre>\n\n<p>And no further detail. This does seem to be the behavior stated by Microsoft in here: \n<a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/commandbutton-onclick-property-access\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/access-vba/articles/commandbutton-onclick-property-access</a> </p>\n\n<p>But I'm wondering if there is anyway to go further than that.</p>\n\n<p>I would have thought that that information would be in the MSysObjects and MSysQueries tables, but I don't see it there. I've tried extracting my test database using the Database Documenter, and I get that value from the generated documentation as well.</p>\n\n<p>Is there a way to find the VBA function that was assigned to the control?</p>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "edited": false, "score": 1, "creation_date": 1505930770, "post_id": 46328850, "comment_id": 79618816, "body": "This might <a href=\"https://stackoverflow.com/questions/15030180/excel-2013-print-to-pdf-in-vba\">help</a>"}, {"owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 1, "creation_date": 1505932890, "post_id": 46328850, "comment_id": 79619980, "body": "This is not a VB6 question at all.  Not even a programming question, but a question about versions of MS Office."}], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 3642787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TL4jp.jpg?s=128&g=1", "display_name": "SergioR", "link": "https://stackoverflow.com/users/3642787/sergior"}, "is_accepted": false, "score": 0, "last_activity_date": 1505991508, "creation_date": 1505991508, "answer_id": 46342190, "question_id": 46328850, "link": "https://stackoverflow.com/questions/46328850/using-excel-printout-is-creating-corrupt-pdf-files/46342190#46342190", "title": "Using excel .PrintOut is creating corrupt .pdf files", "body": "<p>Thanks to @DaBeau96 I came to an answer for my problem.</p>\n\n<p>I used the method</p>\n\n<pre><code>xlApp.Workbooks(1).ExportAsFixedFormat(0, filenameWithPath)\n</code></pre>\n\n<p>like this and now I don't have problems in compiling the exe.</p>\n\n<p>Thanks for all the comments.</p>\n"}], "owner": {"reputation": 48, "user_id": 3642787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TL4jp.jpg?s=128&g=1", "display_name": "SergioR", "link": "https://stackoverflow.com/users/3642787/sergior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506086357, "creation_date": 1505930385, "last_edit_date": 1506086357, "question_id": 46328850, "link": "https://stackoverflow.com/questions/46328850/using-excel-printout-is-creating-corrupt-pdf-files", "title": "Using excel .PrintOut is creating corrupt .pdf files", "body": "<p>I am using the following code to create a .pdf document based in an excel object:</p>\n\n<pre><code>filenameWithPath = \"C:\\\" &amp; xlApp.Workbooks(1).Name &amp; \".pdf\"\nCall xlApp.Workbooks(1).PrintOut(, , , , , , , filenameWithPath)\n</code></pre>\n\n<p>In my machine it works fine, I can open the .pdf file created. But when I do this process in other computer the .pdf created don't open and says it is an invalid .pdf file format.</p>\n\n<p>Due to guarantee compatibility with excel 2003 I can't use the \"ExportAsFixedFormat\" provided in excel versions >= 2007. </p>\n\n<p>I can't do it with PDF Distiller too.</p>\n\n<p>Anybody had this issue before?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "excel", "vba"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 1, "creation_date": 1505929405, "post_id": 46328391, "comment_id": 79618112, "body": "convert the vba code / function to C# can you show the VBA code?"}, {"owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "edited": false, "score": 0, "creation_date": 1505929452, "post_id": 46328391, "comment_id": 79618141, "body": "check this <a href=\"https://stackoverflow.com/questions/43648735/the-server-threw-an-exception-exception-from-hresult-0x80010105-rpc-e-server\">out</a>"}, {"owner": {"reputation": 384, "user_id": 6492655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1100758a0c4987aac1f3604c8147e2c4?s=128&d=identicon&r=PG", "display_name": "michal krzych", "link": "https://stackoverflow.com/users/6492655/michal-krzych"}, "edited": false, "score": 0, "creation_date": 1505929564, "post_id": 46328391, "comment_id": 79618190, "body": "Is your VBA code using <code>.Select</code> anywhere?"}, {"owner": {"reputation": 1, "user_id": 8217501, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-L5_GV-uG3gk/AAAAAAAAAAI/AAAAAAAAAIM/jhNsL426uys/photo.jpg?sz=128", "display_name": "Byron Josue Serrano Nu&#241;ez", "link": "https://stackoverflow.com/users/8217501/byron-josue-serrano-nu%c3%b1ez"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1505930027, "post_id": 46328391, "comment_id": 79618439, "body": "@MethodMan I wish but I can&#39;t because there&#39;s some functions that are working in a old system and must be used."}, {"owner": {"reputation": 1, "user_id": 8217501, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-L5_GV-uG3gk/AAAAAAAAAAI/AAAAAAAAAIM/jhNsL426uys/photo.jpg?sz=128", "display_name": "Byron Josue Serrano Nu&#241;ez", "link": "https://stackoverflow.com/users/8217501/byron-josue-serrano-nu%c3%b1ez"}, "reply_to_user": {"reputation": 384, "user_id": 6492655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1100758a0c4987aac1f3604c8147e2c4?s=128&d=identicon&r=PG", "display_name": "michal krzych", "link": "https://stackoverflow.com/users/6492655/michal-krzych"}, "edited": false, "score": 0, "creation_date": 1505930584, "post_id": 46328391, "comment_id": 79618729, "body": "@user12345 Yes, part of the implementation has some selects"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1505931004, "post_id": 46328391, "comment_id": 79618926, "body": "what does the old system have to do with the new.. I have done this many of times and if the old system is not aware of the new code then you should have zero issues.."}, {"owner": {"reputation": 384, "user_id": 6492655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1100758a0c4987aac1f3604c8147e2c4?s=128&d=identicon&r=PG", "display_name": "michal krzych", "link": "https://stackoverflow.com/users/6492655/michal-krzych"}, "edited": false, "score": 0, "creation_date": 1505981435, "post_id": 46328391, "comment_id": 79637100, "body": "@ByronJosueSerranoNu&#241;ez well, there you go. Your VBA function fails due to calling <code>.Select</code> on a hidden workbook. Revise the parts that use <code>.Select</code> and you should be fine."}], "owner": {"reputation": 1, "user_id": 8217501, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-L5_GV-uG3gk/AAAAAAAAAAI/AAAAAAAAAIM/jhNsL426uys/photo.jpg?sz=128", "display_name": "Byron Josue Serrano Nu&#241;ez", "link": "https://stackoverflow.com/users/8217501/byron-josue-serrano-nu%c3%b1ez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 546, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505930243, "creation_date": 1505928735, "last_edit_date": 1531164843, "question_id": 46328391, "link": "https://stackoverflow.com/questions/46328391/call-excel-vba-file-from-c-0x80010105-error", "title": "Call Excel VBA file from C# 0x80010105 error", "body": "<p>I been trying to call a VBA function from c# to automate some process, the problem is that when the Excel.Application visibility is false I get this error: </p>\n\n<blockquote>\n  <p>The server threw an exception. (Exception from HRESULT: 0x80010105 (RPC_E_SERVERFAULT))</p>\n</blockquote>\n\n<p>When the visibility is true everything works perfectly but the it opens the excel application and I need to keep this process in the background not in the foreground, any idea?</p>\n\n<p>Thanks!</p>\n\n<p><a href=\"https://i.stack.imgur.com/dYyC5.png\" rel=\"nofollow noreferrer\">Just works when visible is true, if not I get:  \"The server threw an exception. (Exception from HRESULT: 0x80010105 (RPC_E_SERVERFAULT)\" )</a></p>\n\n<pre><code>Function DetermineStructureUpdates(DataDBPathAndName As String, DataCopyDBPathAndName As String, SyncDBPathAndName As String, DataDBPw As String, SyncDBPw As String) As String\ndbDataPathAndName = DataDBPathAndName\ndbDataCopyPathAndName = DataCopyDBPathAndName\ndbSyncPathAndName = SyncDBPathAndName\ndbDataPW = DataDBPw\ndbSyncPW = SyncDBPw\nAppActivate Application.Caption 'Bring Excel to the foreground\nOn Error GoTo ErrorHandling\nCall DetermineDBStructure\nIf ErrorMessage &lt;&gt; \"\" Then GoTo ErrorHandling\nDetermineStructureUpdates = \"Success\"\nExit Function\n</code></pre>\n\n<p>ErrorHandling:\n    DetermineStructureUpdates = ErrorToReturn\nEnd Function</p>\n"}, {"tags": ["sql", "vba", "ms-access", "syntax-error"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1505928358, "post_id": 46328256, "comment_id": 79617475, "body": "Looks like you are missing a <code>Group By</code> part of your query."}, {"owner": {"reputation": 1, "user_id": 8643143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1aa277582949b76bd4d90c724d9fd3e?s=128&d=identicon&r=PG&f=1", "display_name": "MikeVM", "link": "https://stackoverflow.com/users/8643143/mikevm"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505943743, "post_id": 46328256, "comment_id": 79625126, "body": "Thanks but as mentioned before I don&#39;t have any experience with SQL. Could you please dumb it down? Based on what I could find online my groups are just concatenated, but then again, I&#39;m new to this."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1505970361, "post_id": 46328256, "comment_id": 79631573, "body": "Use Access query builder to help construct the SQL. That will give you syntax to replicate the SQL in VBA."}], "owner": {"reputation": 1, "user_id": 8643143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1aa277582949b76bd4d90c724d9fd3e?s=128&d=identicon&r=PG&f=1", "display_name": "MikeVM", "link": "https://stackoverflow.com/users/8643143/mikevm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505939432, "creation_date": 1505928241, "last_edit_date": 1505939432, "question_id": 46328256, "link": "https://stackoverflow.com/questions/46328256/3075-syntax-error-in-date-in-query-expression-vba-access", "title": "3075 Syntax Error in date in query expression - VBA / Access", "body": "<p>I've got a bit of an issue with a section of SQL code. Every time when I try to export to Excel from this database I get a 3075 syntax error relating to the date. From what I could see it's got to do with the fact that the interpreted end date is &lt; than the start date, which gives less than one day to export. </p>\n\n<p>Just to clarify, I did have a good look through most 3075 questions here but couldn't get a resolution on this.\nI don't have any experience in SQL and would appreciate anyone's input on this. </p>\n\n<p>Here's the code:</p>\n\n<pre><code>strSql = \"SELECT Min([Breaches and Errors Log].[Date Incident Reported]) AS [MinOfDate Incident Reported], Min([Breaches and Errors Log].[Date Incident Identified]) AS [MinOfDate Incident Identified], Min([Breaches and Errors Log].[Date Incident Commenced]) AS [MinOfDate Incident Commenced], Min([Breaches and Errors Log].[Date Incident Rectified]) AS [MinOfDate Incident Rectified], \" &amp; _\n             \" Max([Breaches and Errors Log].[Date Incident Reported]) AS [MaxOfDate Incident Reported], Max([Breaches and Errors Log].[Date Incident Identified]) AS [MaxOfDate Incident Identified], Max([Breaches and Errors Log].[Date Incident Commenced]) AS [MaxOfDate Incident Commenced], Max([Breaches and Errors Log].[Date Incident Rectified]) AS [MaxOfDate Incident Rectified] FROM [Breaches and Errors Log]\"\n</code></pre>\n\n<p>Here's the error that I'm getting:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rAWT9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rAWT9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "upload"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1505928329, "post_id": 46327983, "comment_id": 79617454, "body": "Are you giving it enough time to load? Try adding  <code>Application.Wait Now + TimeValue(&quot;00:00:10&quot;)</code> before <code>.Document.getElementById(&quot;FileUpload&quot;).Click</code> and see if you get the same error."}], "owner": {"reputation": 21, "user_id": 8643201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c87aaf31bd96e0e0e305b4434a65c407?s=128&d=identicon&r=PG&f=1", "display_name": "Clare", "link": "https://stackoverflow.com/users/8643201/clare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1570122067, "creation_date": 1505927265, "last_edit_date": 1570122067, "question_id": 46327983, "link": "https://stackoverflow.com/questions/46327983/upload-a-file-from-excel-to-internet-explorer", "title": "Upload a file from Excel to Internet Explorer", "body": "<p>I am trying to upload a xls file onto a website using VBA from Excel.</p>\n\n<p>I managed to open the website and got to the stage where you click on \"Browse...\" to choose the file to upload.</p>\n\n<p>I get the error</p>\n\n<blockquote>\n  <p>\"Object variable of with block variable not set\"</p>\n</blockquote>\n\n<p>The code is below, as is the html element. </p>\n\n<pre><code>'input type=\"file\" name=\"fileUpload\" id=\"fileUpload\" style=\"height:20px;width:450px;\"\n\nSub Upload()\n\n    Dim IE As InternetExplorer\n\n    Application.DisplayAlerts = False\n    Set IE = New InternetExplorerMedium\n\n    IE.Visible = 1\n    With IE\n\n        .Navigate url\n\n        Do While (IE.Busy Or IE.READYSTATE &lt;&gt; READYSTATE.READYSTATE_COMPLETE)\n            DoEvents\n        Loop            \n\n        ' Selects Create Report\n        .Document.getElementById(\"ctl00_body_upload\").Click\n        .Document.getElementById(\"FileUpload\").Click ' &lt;&lt;&lt;This is where it fails\n\n        Application.DisplayAlerts = True\n\n    End With\n\n    Set IE = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8643181"}, "edited": false, "score": 0, "creation_date": 1505927498, "post_id": 46328004, "comment_id": 79616951, "body": "thank you for your fast help! that was the solution."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505927589, "post_id": 46328004, "comment_id": 79617002, "body": "You are welcome @jMajik - Please remember to accept the answer (after 10 minutes) so that it does not remain open."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 0, "last_activity_date": 1505927337, "creation_date": 1505927337, "answer_id": 46328004, "question_id": 46327975, "link": "https://stackoverflow.com/questions/46327975/access-query-currentdb-openrecordset/46328004#46328004", "title": "Access Query CurrentDb.OpenRecordset", "body": "<p>You cant include your variables in your string. Try it like this instead.</p>\n\n<pre><code>strSQL = \"SELECT * FROM query1 WHERE ID =\" &amp; [Forms]![query1]![ID]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8643181"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1091, "favorite_count": 0, "accepted_answer_id": 46328004, "answer_count": 1, "score": 1, "last_activity_date": 1505939445, "creation_date": 1505927243, "last_edit_date": 1505939445, "question_id": 46327975, "link": "https://stackoverflow.com/questions/46327975/access-query-currentdb-openrecordset", "title": "Access Query CurrentDb.OpenRecordset", "body": "<p>I try to create a query in MS Access (VBA) where I can select only the current dataset (by ID) shown in the query form. Somehow my query does not work .. do you have a suggestion for me? </p>\n\n<pre><code>strSQL = \"SELECT * FROM query1 WHERE ID = [Forms]![query1]![ID]\"\nSet rs = CurrentDb.OpenRecordset(strSQL)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1505927856, "post_id": 46327963, "comment_id": 79617166, "body": "One way would be to concatenate the values on the left into a single cell with delimiters, and do the same on the right and then compare those. Would be more efficient but might still take time if you lots of data. VBA arrays would be faster."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 2, "creation_date": 1505927887, "post_id": 46327963, "comment_id": 79617183, "body": "You can use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-sumproduct-method-excel\" rel=\"nofollow noreferrer\">WorksheetFunction.SumProduct Method</a> and <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-countif-method-excel\" rel=\"nofollow noreferrer\">CountIF</a> on VBA. And transform this function to a VBA code. And here are <a href=\"https://fastexcel.wordpress.com/2011/10/26/match-vs-find-vs-variant-array-vba-performance-shootout/\" rel=\"nofollow noreferrer\">three ways to compare in VBA</a>"}, {"owner": {"reputation": 1102, "user_id": 5660197, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97df5665e51bcf688208167c32a7bb4e?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/5660197/tony"}, "edited": false, "score": 2, "creation_date": 1505928291, "post_id": 46327963, "comment_id": 79617431, "body": "<code>Concat()</code>... it is always so simple... Thank you very much."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1505928410, "post_id": 46327963, "comment_id": 79617511, "body": "As stated a simple COUNTIFS() will do it: <code>=IF(COUNTIFS(B:B,I5,C:C,J5,D:D,K5,E:E,L5,F:F,M5,G:G,N5),&quot;Mat&zwnj;&#8203;ch&quot;, &quot;No-Match&quot;)</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505929035, "post_id": 46327963, "comment_id": 79617894, "body": "@ScottCraner - I always forget these new-fangled formulae."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8643248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a99f3cf48b4e0093cf1a9de4522035a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Bambousek", "link": "https://stackoverflow.com/users/8643248/jan-bambousek"}, "is_accepted": false, "score": 0, "last_activity_date": 1505928131, "creation_date": 1505928131, "answer_id": 46328232, "question_id": 46327963, "link": "https://stackoverflow.com/questions/46327963/matching-an-excel-range-to-a-different-block-of-ranges/46328232#46328232", "title": "Matching an excel range to a different block of ranges", "body": "<p>You could just use matrix formulas which are meant to process arrays rather than values.</p>\n\n<p>If you wanted to see if ranges A1:A5 and B1:B5 had the same values you would use</p>\n\n<pre><code>=AND(A1:A5=B1:B5)\n</code></pre>\n\n<p>Don't forget to use <b>Ctrl+Shift+Enter</b> when you finish your formula, as it will specify that it is a matrix formula.</p>\n\n<p>This example evaluates if A1=B1 and A2=B2 and outputs TRUE if all of the conditions are true.</p>\n\n<p>To learn more about excel array formulas you can get started on <a href=\"https://support.office.com/en-us/article/Guidelines-and-examples-of-array-formulas-7d94a64e-3ff3-4686-9372-ecfd5caa57c7\" rel=\"nofollow noreferrer\">excel official help page about array formulas</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 8579132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3319b05a655f645fd8e050c0e38efb70?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Asthana", "link": "https://stackoverflow.com/users/8579132/abhinav-asthana"}, "is_accepted": false, "score": 0, "last_activity_date": 1505933940, "creation_date": 1505933940, "answer_id": 46329829, "question_id": 46327963, "link": "https://stackoverflow.com/questions/46327963/matching-an-excel-range-to-a-different-block-of-ranges/46329829#46329829", "title": "Matching an excel range to a different block of ranges", "body": "<p>You can create two helper Columns like Column-G &amp; Column-N. ( follow attached image)</p>\n\n<p>Column-G Formula: =CONCATENATE(A2,B2,C2,D2,E2,F2) at row no. 2 and drag down to last.</p>\n\n<p>Column-H Formula: =CONCATENATE(H2,I2,J2,K2,L2,M2) at row no. 2 and drag down to last.</p>\n\n<p>Now at Column-O you can put \"MATCH\" formula to match the rows and if it's not match you will get #NA error</p>\n\n<p><a href=\"https://i.stack.imgur.com/dujuf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dujuf.png\" alt=\"Row Match Trick\"></a></p>\n"}], "owner": {"reputation": 1102, "user_id": 5660197, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97df5665e51bcf688208167c32a7bb4e?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/5660197/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1505933940, "creation_date": 1505927210, "question_id": 46327963, "link": "https://stackoverflow.com/questions/46327963/matching-an-excel-range-to-a-different-block-of-ranges", "title": "Matching an excel range to a different block of ranges", "body": "<p>I would like to take a row in the right and then match it to the row in the left, and the compare the two values.  I made this formula which can work on a single instance.</p>\n\n<p><code>=IF(SUMPRODUCT(COUNTIF(B6:F6,$I$5:$M$5))=COUNT($I$5:$M$5), IF($N$5=G6, \"Match\", \"No-Match\"), FALSE)</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/3hc2f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3hc2f.png\" alt=\"enter image description here\"></a></p>\n\n<p>The problem is when I have hundreds of rows on the right and left, the only solution I can think of is to make a massive matrix of tests.  Is it possible to condense this to a single cell, with built-in formulas or vba?</p>\n"}, {"tags": ["excel", "installation", "exe", "vba"], "answers": [{"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1505930204, "creation_date": 1505930204, "answer_id": 46328815, "question_id": 46327962, "link": "https://stackoverflow.com/questions/46327962/installer-for-a-bundle-of-excel-vba-exe-files-csv-files/46328815#46328815", "title": "Installer for a bundle of Excel + VBA + exe files + CSV files", "body": "<p>I use Setup Factory to do that.\nYou can find an example script to use as a starter <a href=\"http://www.redcirclesoftware.com/setup-program-for-excel-addins/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>The only difficult bit is if you need to determine Excel bitness inside the installer without launching Excel. but maybe you can install both 32-bit and 64-bit exes and have the VBA determine which to call.</p>\n"}], "owner": {"reputation": 1, "user_id": 8643044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44991b0a95667c4eaf81bf1f105c8285?s=128&d=identicon&r=PG&f=1", "display_name": "user8643044", "link": "https://stackoverflow.com/users/8643044/user8643044"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505930204, "creation_date": 1505927206, "last_edit_date": 1531161705, "question_id": 46327962, "link": "https://stackoverflow.com/questions/46327962/installer-for-a-bundle-of-excel-vba-exe-files-csv-files", "title": "Installer for a bundle of Excel + VBA + exe files + CSV files", "body": "<p>I have an Excel file + VBA code + csv files + exe files from another language. I can call exe files from VBA and all together they do the job for me. The performance and speed is important for my computational intensive applications, so I am satisfied with the performance of this bundle. Now there is the issue of making an easy to install package for the potential clients. I did my research about using dlls and building Add-Ins for Excel and at this time, I think this is not a productive path for me. I am looking to build a professional installation package for the following cases:</p>\n\n<p>1- Installer puts an Excel workbook + CSV files and exe files in a right path for the client so she/he can immediately start working with the application.</p>\n\n<p>2- A combination of an add-in which is written with VBA (hopefully) and an installer that  manages other VBA codes + CSV files and exe files to be put in the write path and places. I wouldn't like to compile the source code of computational exe files into dlls. I would like the add-in code that I would develop just to act as the installer or a manger of the above named code. </p>\n\n<p>I appreciate if you could share your expertise and experience. My emphasis is in any case to use my computational exe file as they are, but it is still possible for me to re-compile the source codes to be consistent with the operating systems (Windows version and 32/64 bit machines).  </p>\n"}, {"tags": ["vba", "excel", "pdf", "pdf-generation"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1505935042, "post_id": 46327666, "comment_id": 79621096, "body": "How would you do it if you had to do it manually instead of programmatically?"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505936527, "post_id": 46327666, "comment_id": 79621880, "body": "I&#39;m preparing a VBA based application for a Workbook, that needs perform acts programmatically."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506015936, "post_id": 46327666, "comment_id": 79660621, "body": "I have Adobe Acrobat Professional on my system and please tell me witch references should be add in VBA references so contains related functions."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506018546, "post_id": 46327666, "comment_id": 79661960, "body": "I&#39;m not that familiar with Adobe, but with a quick search I found a screenshot here: <a href=\"https://stackoverflow.com/questions/37551957/using-vba-how-do-i-call-up-the-adobe-create-pdf-function\" title=\"using vba how do i call up the adobe create pdf function\">stackoverflow.com/questions/37551957/&hellip;</a>"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506019541, "post_id": 46327666, "comment_id": 79662455, "body": "I viewed above link before, but not succeed using in my need. Why no one answer my question in this therm? I need add my prepared print area for print in a new page section at the end of existed pdf file."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506021209, "post_id": 46327666, "comment_id": 79663314, "body": "Have you tried looking on google? I found this: <a href=\"https://www.excelguru.ca/forums/showthread.php?4733-merging-multiple-PDF-files-into-a-single-PDF-file-via-VBA-macro\" rel=\"nofollow noreferrer\">excelguru.ca/forums/&hellip;</a>"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506022091, "post_id": 46327666, "comment_id": 79663782, "body": "Yes, I was viewed this and searched with google search engine. Above reference is discussed about merging two existed pdf file. Thus I need append my new face of print area, at the end of initial pdf in new page section. I dont want create multiple pdfs and merge them."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506022195, "post_id": 46327666, "comment_id": 79663825, "body": "That may be your only option, achieving the same results."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506023371, "post_id": 46327666, "comment_id": 79664421, "body": "At <a href=\"https://stackoverflow.com/questions/37551957/using-vba-how-do-i-call-up-the-adobe-create-pdf-function\">this</a> old related valuable question, There where Adobe VBA references, and <a href=\"http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/iac_developer_guide.pdf\" rel=\"nofollow noreferrer\">developer guide</a> for this matter. Are you agree with: There where solution for solve this issue and reach what needed? The option I needed and think there where solution for it, is that appending print area at the end of initial existed pdf file in new page section.Are you believe my wanted option is irrational or unreachable?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1506577321, "post_id": 46327666, "comment_id": 79878154, "body": "May be codes in <a href=\"http://khkonsulting.com/2009/03/adobe-acrobat-and-vba-an-introduction/\" rel=\"nofollow noreferrer\">khkonsulting.com/2009/03/adobe-acrobat-and-vba-an-introducti&zwnj;&#8203;on</a> contains the methods you need. If the new face is to be new page in the PDF, I believe you need to create a PDF in Temp folder to merge them. Or perhaps move the face to new Worksheet to be exported."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1506591685, "post_id": 46327666, "comment_id": 79886680, "body": "Right. Thanks for above link. Thus I thought about pdf format and ADOBE functions for creating pdf content. And may us edit or modify an existed pdf file and contents? (as explained in this question)"}], "answers": [{"comments": [{"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1506246982, "post_id": 46374728, "comment_id": 79735071, "body": "Regard. This answer is nice, valuable and smart, thus the mechanism and method of using Adobe procedures for editing an existed pdf file as append, remove or etc... are much valuable and low-range-finder. I suggest extending the perfect and prone accepted answer under <a href=\"https://stackoverflow.com/questions/37551957/using-vba-how-do-i-call-up-the-adobe-create-pdf-function\">stackoverflow.com/questions...</a> related question."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1506248253, "post_id": 46374728, "comment_id": 79735337, "body": "I admit your advice solved my problem. And I used your solution. Yet The power of using Adobe references procedures is a matter that I wait for."}], "tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": true, "score": 1, "last_activity_date": 1506357993, "last_edit_date": 1506357993, "creation_date": 1506125018, "answer_id": 46374728, "question_id": 46327666, "link": "https://stackoverflow.com/questions/46327666/add-print-area-content-appending-at-the-end-of-initial-existed-pdf-file-in-a-n/46374728#46374728", "title": "Add print area content (appending) at the end of initial existed pdf file in a new page section", "body": "<p>In the Solution, I provide there is no need of Acrobat Pro.\nWe suppose that we have a table which named: Table2.\nWe have also a help sheet(to store filtered tables) which is Hiden and named: Help.</p>\n\n<pre><code>Option Explicit\n\nSub print_to_pdf()\n    Dim sh  As Long\n    Dim rg  As Range\n    Dim Rng As Range\n    Dim rw  As Range\n\n    Application.ScreenUpdating = False\n\n    For Each rw In Range(\"Table2[#All]\").Rows\n\n        If rw.EntireRow.Hidden = False Then\n            If Rng Is Nothing Then Set Rng = rw\n            Set Rng = Union(rw, Rng)\n        End If\n\n    Next\n\n    Rng.Copy\n\n    With Sheets(\"help\")\n        .Visible = True\n         sh = .Cells(Rows.Count, \"A\").End(xlUp).Row + 2\n        Set rg = Range(\"a3\" &amp; \":\" &amp; \"a\" &amp; sh - 2)\n\n        .Activate\n        .Cells(sh, \"A\").Select\n        ActiveSheet.Paste\n\n        ActiveSheet.PageSetup.PrintArea = rg\n\n        ActiveSheet.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=ThisWorkbook.Path &amp; \"\\rep.pdf\", _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=False\n\n        .Visible = False\n    End With\n\n    Application.ScreenUpdating = True\n\n    MsgBox \"Your PDF Has been Created with Success!!\", vbInformation\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1506519288, "post_id": 46437929, "comment_id": 79854210, "body": "I want new face of the print area that reforms by change filtering criteria; get appends at the end of initial pdf file quietly, without creating a new pdf file, in a new page section."}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "reply_to_user": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1506559427, "post_id": 46437929, "comment_id": 79873769, "body": "Yes I did read your original question. I also read your comment to the first question which solved your problem but lacked Adobe references. Have you read the Adobe API? It doesn&#39;t have methods for modifying the content of Adobe files and doesn&#39;t have methods for creating PDF content from external applications. You&#39;ll need to combine the two answers and then delete the temp files through Windows API."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1506591892, "post_id": 46437929, "comment_id": 79886838, "body": "Of course. I throw this approach. Thus I think about ADOBE functions (procedures) for modifying ADOBE content and edit existed pdf file that witch is I was opened the bounty worth for that."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1506758218, "post_id": 46437929, "comment_id": 79955731, "body": "Which preferences should we add in VBA?"}], "tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 3, "last_activity_date": 1506474188, "creation_date": 1506474188, "answer_id": 46437929, "question_id": 46327666, "link": "https://stackoverflow.com/questions/46327666/add-print-area-content-appending-at-the-end-of-initial-existed-pdf-file-in-a-n/46437929#46437929", "title": "Add print area content (appending) at the end of initial existed pdf file in a new page section", "body": "<p>You just need the \"Acrobat\" library.</p>\n\n<p>One simple solution is to use the native <code>ExportAsFixedFormat</code> method to save each section as a separate PDF file first, e.g. \"C:\\temp\\Part1.pdf\" and \"C:\\temp\\Part2.pdf\"</p>\n\n<p>Then use the <code>InsertPages</code> method in the Acrobat API as per example below:</p>\n\n<pre><code>Sub MergePDF()\n\nDim AcroApp As Acrobat.CAcroApp\n\nDim Part1Document As Acrobat.CAcroPDDoc\nDim Part2Document As Acrobat.CAcroPDDoc\n\nDim numPages As Integer\n\nSet AcroApp = CreateObject(\"AcroExch.App\")\n\nSet Part1Document = CreateObject(\"AcroExch.PDDoc\")\nSet Part2Document = CreateObject(\"AcroExch.PDDoc\")\n\nPart1Document.Open (\"C:\\temp\\Part1.pdf\")\nPart2Document.Open (\"C:\\temp\\Part2.pdf\")\n\n' Insert the pages of Part2 after the end of Part1\nnumPages = Part1Document.GetNumPages()\n\nIf Part1Document.InsertPages(numPages - 1, Part2Document, \n0, Part2Document.GetNumPages(), True) = False Then\n    MsgBox \"Cannot insert pages\"\nEnd If\n\nIf Part1Document.Save(PDSaveFull, \"C:\\temp\\MergedFile.pdf\") = False Then\n    MsgBox \"Cannot save the modified document\"\nEnd If\n\nPart1Document.Close\nPart2Document.Close\n\nAcroApp.Exit\nSet AcroApp = Nothing\nSet Part1Document = Nothing\nSet Part2Document = Nothing\n\nMsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n\n<p>Reference: <a href=\"http://www.khk.net/wordpress/2009/03/04/adobe-acrobat-and-vba-an-introduction/\" rel=\"nofollow noreferrer\">http://www.khk.net/wordpress/2009/03/04/adobe-acrobat-and-vba-an-introduction/</a></p>\n\n<p>Adobe Developer Guide: <a href=\"http://www.adobe.com/devnet/acrobat/pdfs/iac_developer_guide.pdf\" rel=\"nofollow noreferrer\">http://www.adobe.com/devnet/acrobat/pdfs/iac_developer_guide.pdf</a></p>\n\n<p>Adobe API Reference:\n<a href=\"http://www.adobe.com/devnet/acrobat/pdfs/iac_api_reference.pdf\" rel=\"nofollow noreferrer\">http://www.adobe.com/devnet/acrobat/pdfs/iac_api_reference.pdf</a></p>\n"}], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 876, "favorite_count": 0, "accepted_answer_id": 46374728, "answer_count": 2, "score": 2, "last_activity_date": 1506474188, "creation_date": 1505926133, "last_edit_date": 1506124590, "question_id": 46327666, "link": "https://stackoverflow.com/questions/46327666/add-print-area-content-appending-at-the-end-of-initial-existed-pdf-file-in-a-n", "title": "Add print area content (appending) at the end of initial existed pdf file in a new page section", "body": "<p>For generating a report, I have create pdf with bellow approach.</p>\n\n<pre><code>ActiveSheet.ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    fileName:=ThisWorkbook.path &amp; \"\\rep.pdf\", _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\n</code></pre>\n\n<p>In the <code>ActiveSheet,</code> there were specified Print Area, Witch contains a Table, so table's column filtered value have change programmatically, and need:</p>\n\n<p>I want <strong>new face of the print area that reforms by changing filtering criteria; get appends at the end of initial pdf file</strong> quietly, without creating a new pdf file, in <strong>a new page section</strong>.</p>\n\n<p>How can I do that?</p>\n\n<p>I have installed ADOBE Acrobat Professional on my system and able to add appropriate references in VBA references.</p>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 3, "creation_date": 1505926884, "post_id": 46327549, "comment_id": 79616598, "body": "<code>what:=dem1</code> is the value you are searching for, so to change the Range of search, you have to change this part <code>.Range(&quot;A9:A200&quot;)</code> and not the what value. For more information read <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel\" rel=\"nofollow noreferrer\">.Find Method</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1505927809, "post_id": 46327549, "comment_id": 79617146, "body": "What does <code>dem1</code> have to do with the name of a worksheet in <code>Worksheets(dem1)</code>? What are you actually looking for?"}, {"owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 0, "creation_date": 1505983162, "post_id": 46327549, "comment_id": 79638202, "body": "@Jeeped dem1 is what the values in column A and others will be (different each time, an example is &#39;2016_6500_DM_PM.txt&#39;), then it will look these values up in another workbook where the dem1 values are the sheet names. On each sheet is some data that i get and put back in thisworkbook."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505997293, "post_id": 46327549, "comment_id": 79647964, "body": "@RichPrag Note that you could make it all on the same function, creating a <a href=\"https://stackoverflow.com/questions/45636183/strange-cell-addresses-behaviour-for-non-contiguous-ranges-vba\">non contiguous range</a>. And looping through it."}], "owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505992109, "creation_date": 1505925738, "last_edit_date": 1505992109, "question_id": 46327549, "link": "https://stackoverflow.com/questions/46327549/vba-look-for-particular-values-in-multiple-non-adjacent-columns", "title": "VBA: look for particular values in multiple non-adjacent columns", "body": "<p>I have some code that looks through a range (currently only in column A) for particular values, takes that value and looks up a sheet in another book with the value name. It also sets the value address as a variable 'WhereCell' that i use in another part of the code. The code as it is works perfectly. </p>\n\n<p>I now want to change the code so it looks for values in both column A, and two other columns (possibly N and Y but that may change). how can i do this? I've put my code as it is below, but i get error 13: type mismatch on the line <code>dem1 = .Range(\"A\" &amp; x, \"N\" &amp; x).Value</code>, I assume because i cant put the \"A\" and \"N\" in the same range statement. How can i change it to search through multiple columns?</p>\n\n<pre><code> Sub GetFlows()\n\nDim cell As Range\nDim dem1 As String\nDim WhereCell As Range\nDim ws As Worksheet\n\nDim valueRng As Range\nDim x As Long\nDim y As Long\n\nFor Each ws In ThisWorkbook.Worksheets\n    With ws\n        If .Name &lt;&gt; \"Summary\" Then\n            For x = 9 To 200 ' run a loop from row 9 to 200\n                dem1 = .Range(\"A\" &amp; x, \"N\" &amp; x).Value\n                MsgBox dem1\n\n                If dem1 &lt;&gt; \"\" Then\n                    Set WhereCell = .Range(\"A9:A200\").Find(what:=dem1, LookAt:=xlPart)\n\n                    If Not WhereCell Is Nothing Then\n                        Workbooks(\"GetFilenames v2.xlsm\").Worksheets(dem1).Range(\"A1\").CurrentRegion.Copy\n                        WhereCell.Offset(, 2).PasteSpecial xlPasteValues\n                    End If\n                End If\n            Next x\n        End If\n    End With\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: i've solved it, I just repeated the entire code between 'For x' and 'next x' and changed the variables to refer to column N:</p>\n\n<pre><code>For Each ws In ThisWorkbook.Worksheets\n    With ws\n        If .Name &lt;&gt; \"Summary\" Then\n            For x = 9 To 200 ' run a loop from row 9 to 200\n                dem1 = .Range(\"A\" &amp; x).Value\n\n                If dem1 &lt;&gt; \"\" Then\n                    Set WhereCell_1 = .Range(\"A9:A200\").Find(what:=dem1, LookAt:=xlPart)\n\n                    If Not WhereCell_1 Is Nothing Then\n                        Workbooks(\"GetFilenames v3.xlsm\").Worksheets(dem1).Range(\"A1\").CurrentRegion.Copy\n                        WhereCell_1.Offset(, 2).PasteSpecial xlPasteValues\n                    End If\n                End If\n            Next x\n\n            For y = 9 To 200 ' run a loop from row 9 to 200\n                dem2 = .Range(\"N\" &amp; y).Value\n\n                If dem2 &lt;&gt; \"\" Then\n                    Set WhereCell_2 = .Range(\"N9:N200\").Find(what:=dem2, LookAt:=xlPart)\n\n                    If Not WhereCell_2 Is Nothing Then\n                        Workbooks(\"GetFilenames v3.xlsm\").Worksheets(dem2).Range(\"A1\").CurrentRegion.Copy\n                        WhereCell_2.Offset(, 2).PasteSpecial xlPasteValues\n                    End If\n                End If\n            Next y\n        End If\n    End With\nNext ws\n</code></pre>\n\n<p>That works fine, but i wonder if there is a way to avoid repeating the code and do it in a cleaner, more compact way. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1520007343, "last_edit_date": 1520007343, "creation_date": 1520006775, "answer_id": 49072932, "question_id": 46327524, "link": "https://stackoverflow.com/questions/46327524/how-to-input-data-in-website-where-html-tag-present-inside-iframe/49072932#49072932", "title": "How to input data in website where HTML tag present inside Iframe?", "body": "<p>Finally located an way to access a webpage frame using the following declarations</p>\n\n<pre><code>Sub test()       \nDim workFrame As HTMLIFrame        \nDim objShell As Object, oWin As Object              \nDim HTMLDoc As HTMLDocument    \nDim ie As InternetExplorer  `enter code here`\nSet objShell = CreateObject(\"Shell.Application\")\nSet IE_Doc = ie.Document              \nSet workFrame = ie.Document.getElementById(\"XXXXXX\")            \nSet HTMLDoc = workFrame.contentWindow.Document   \n'do something... perform an action   \n'.........      \n'.........    \nEnd Sub\n</code></pre>\n\n<p>Thank You.</p>\n"}], "owner": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1520007343, "creation_date": 1505925680, "last_edit_date": 1531164843, "question_id": 46327524, "link": "https://stackoverflow.com/questions/46327524/how-to-input-data-in-website-where-html-tag-present-inside-iframe", "title": "How to input data in website where HTML tag present inside Iframe?", "body": "<p>I am trying to input data into a table fields in webpage using vba, but I am unable to access any elements present in Iframe Tag.</p>\n\n<p>Website Tags:\n</p>\n\n<p>unable to access any elements inside this frame.</p>\n\n<p>I tried to access using frames method</p>\n\n<pre><code>Dim elemCollection As IHTMLElementCollection\nSet elemCollection = ie.Document.frames(\"patmainFrame\").Document.all\n</code></pre>\n\n<p>Here I am able to locate the Frame however I am unable to figure out how to access HTML elements inside a frame there is a dropdown that I want to select and insert that within a text box.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8642759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac43317090b06b9fe10591f750bdfdd4?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8642759/ben"}, "is_accepted": true, "score": 0, "last_activity_date": 1506093216, "last_edit_date": 1506093216, "creation_date": 1506092712, "answer_id": 46367821, "question_id": 46327523, "link": "https://stackoverflow.com/questions/46327523/excel-validation-add-not-working-from-ms-word-vba/46367821#46367821", "title": "Excel Validation.Add not working from MS Word VBA", "body": "<p>With help from a friend I was able to modify the second syntax to work.</p>\n\n<p>Using:</p>\n\n<pre><code>objNewExcel.Sheets(1).Range(\"e5\").Validation.Add (xlValidateWholeNumber, xlValidAlertStop, xlBetween, \"5\", \"10\")\n</code></pre>\n\n<p>Word VBA expects a returned value.  If you add \"Call\" to the beginning of the line or remove \"(\" and \")\" from the .Add method, VBA knows that there is not return and it works.</p>\n\n<p>Working Syntax's:</p>\n\n<pre><code>objNewExcel.Sheets(1).Range(\"e5\").Validation.Add xlValidateWholeNumber, xlValidAlertStop, xlBetween, \"5\", \"10\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Call objNewExcel.Sheets(1).Range(\"e5\").Validation.Add (xlValidateWholeNumber, xlValidAlertStop, xlBetween, \"5\", \"10\")\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8642759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac43317090b06b9fe10591f750bdfdd4?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8642759/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "accepted_answer_id": 46367821, "answer_count": 1, "score": 2, "last_activity_date": 1506093216, "creation_date": 1505925671, "question_id": 46327523, "link": "https://stackoverflow.com/questions/46327523/excel-validation-add-not-working-from-ms-word-vba", "title": "Excel Validation.Add not working from MS Word VBA", "body": "<p>I have a MS Word document that generates an Excel populated with data from a table in the Word document.  The Excel version of the Word table is intended to be a checklist.  As such, I'm trying to add features to the generated excel to make it more useful.  I tried to add conditional formatting (to make a row green if the row is marked complete) and Validation (so a Completed column has a dropdown with Yes or No).  I can make both work in Excel but can not get VBA from Word to add the functionality to the generated Excel.</p>\n\n<p>In both cases the .Add method seems to be causing the problem.  I have tried 2 syntaxes to do this:</p>\n\n<pre><code>With objNewExcel.Sheets(1).Range(\"e5\").Validation \n   .Add Type:=xlValidateWholeNumber, _\n        AlertStyle:= xlValidAlertStop, _\n        Operator:=xlBetween, _\n        Formula1:=\"5\", _\n        Formula2:=\"10\" \n   .InputTitle = \"Integers\" \n   .ErrorTitle = \"Integers\" \n   .InputMessage = \"Enter an integer from five to ten\" \n   .ErrorMessage = \"You must enter a number from five to ten\" \nEnd With\n</code></pre>\n\n<p>Returns Error \"excel runtime error '1004' application-defined or object-defined error\" which is not useful</p>\n\n<p>and </p>\n\n<pre><code>objNewExcel.Sheets(1).Range(\"e5\").Validation.Add(xlValidateWholeNumber, xlValidAlertStop, xlBetween, \"5\", \"10\")\n</code></pre>\n\n<p>Returning Error \"Expected: =\".  When I set the Validation to a var it gives me a type miss match error.  I DIMed the var as an object.</p>\n\n<p>I can't get either to work from MS Word VBA.  Does anyone know how to reference the Excel .Add method from Word VBA?</p>\n"}, {"tags": ["excel", "if-statement", "match", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1505929512, "post_id": 46327450, "comment_id": 79618166, "body": "You need to clean up your example up top, it makes no sense. You have Tom showing as a customer with no change up top, then in the next example you have him as a teller switching to a customer."}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1505929916, "creation_date": 1505929916, "answer_id": 46328743, "question_id": 46327450, "link": "https://stackoverflow.com/questions/46327450/excel-if-case-copy-paste-from-another-sheet/46328743#46328743", "title": "Excel-If case copy paste from another sheet", "body": "<p>This checks the status column, then if it's a rolechange, looks for the name on the other sheet and brings the new value in from the roleUpdates sheet.  </p>\n\n<pre><code>Sub ChangesRoles()\nDim i As Long, j As Long, sht As Worksheet, lastrow As Long\nSet sht = ThisWorkbook.Worksheets(\"roleUpdates\")\nlastrow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\nFor i = 2 To lastrow\n    If Worksheets(\"roleUpdates\").Range(\"C\" &amp; i).Value = \"roleChange\" Then\n        For j = 2 To lastrow\n            If Worksheets(\"Roles Sheet\").Range(\"B\" &amp; j).Value = Worksheets(\"roleUpdates\").Range(\"B\" &amp; i).Value Then\n                Worksheets(\"Roles Sheet\").Range(\"A\" &amp; j).Value = Worksheets(\"roleUpdates\").Range(\"A\" &amp; i).Value\n            End If\n        Next j\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Z9n3p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z9n3p.png\" alt=\"BeforeAfter\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 8642913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a75d6650ed2a3fafe665c5608d8962c7?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/8642913/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 46328743, "answer_count": 1, "score": 0, "last_activity_date": 1505929916, "creation_date": 1505925437, "last_edit_date": 1531161705, "question_id": 46327450, "link": "https://stackoverflow.com/questions/46327450/excel-if-case-copy-paste-from-another-sheet", "title": "Excel-If case copy paste from another sheet", "body": "<p>I have a workbook which has 2 sheets.(Roles and roleUpdates). Role update sheet contains the role changes and new roles. It has more entry than the Roles sheet but I only want to deal with the entries that is both in the Roles and RoleUpdates. One of the colums in the RoleUpdates is called \"status\" and one of the options is roleChange. Roles sheet is the one that I want to update which has the older roles. Basically I want to look at the status column in the RoleUpdates and if it is \"roleChange\", then I want to copy that role column in the RoleUpdates sheet and paste it into Roles sheet based on the name. Example;</p>\n\n<pre><code>roleUpdates Sheet\n\nCOL A       COL B     COL C \nROLES       NAMES     STATUS   \nTeller      David     roleChange   \nCustomer    Tom       noChange \nAdmin      Liam      roleChange\n-------------\n\n\n    Before Running Macro\nRoles Sheet\n    ------------- \nCOL A       COL B \nROLES       NAMES \nCustomer    Liam \nAdmin       David  \nTeller      Tom\n    -------------\n\n\nAfter Running Macro\nRoles Sheet\n    ------------- \nCOL A       COL B \nROLES       NAMES \nAdmin       Liam \nTeller      David  \nCustomer    Tom\n    -------------\n</code></pre>\n\n<p>I hope this was clear enough. Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1505925434, "post_id": 46327426, "comment_id": 79615748, "body": "What code have you tried?"}, {"owner": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505931633, "post_id": 46327426, "comment_id": 79619282, "body": "Dim i As Long For i = 57 To Rows.Count Step 55     Cells(i, 1) = &quot;Hello&quot; Next i which gives me sort of what i want. but i need to be able to say hello for the next ten row. so it needs to be row 57-67 &quot;hello&quot; next 55 rows blanks then row 122-132 &quot; hello next 55 rows blanks until the end of worksheet"}, {"owner": {"reputation": 44559, "user_id": 411022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9905bf9a7b8d5a587c1bdff07ef2e801?s=128&d=identicon&r=PG", "display_name": "Ilmari Karonen", "link": "https://stackoverflow.com/users/411022/ilmari-karonen"}, "edited": false, "score": 0, "creation_date": 1505941853, "post_id": 46327426, "comment_id": 79624402, "body": "Please try to avoid changing your question after you&#39;ve asked it. <a href=\"https://meta.stackexchange.com/questions/43478/exit-strategies-for-chameleon-questions\">Chameleon questions</a> are not well liked here. It&#39;s usually a good idea to describe the actual problem you&#39;re trying to solve in your question, so that people won&#39;t needlessly give you answers that only solve the problem you&#39;ve described, not the problem you really have."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "edited": false, "score": 0, "creation_date": 1505926932, "post_id": 46327473, "comment_id": 79616621, "body": "thank you, what if the lenght of my report is variable. so everytime i run my report the lenght its different, sometimes its 500 rows and sometimes its 1000 rows. how can i loop this so that the lenght of the report is variable?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "edited": false, "score": 0, "creation_date": 1505927036, "post_id": 46327473, "comment_id": 79616670, "body": "I&#39;ve added how to get the last row in my answer. <a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">Have a look at this for more information</a>"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 44559, "user_id": 411022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9905bf9a7b8d5a587c1bdff07ef2e801?s=128&d=identicon&r=PG", "display_name": "Ilmari Karonen", "link": "https://stackoverflow.com/users/411022/ilmari-karonen"}, "edited": false, "score": 0, "creation_date": 1505985064, "post_id": 46327473, "comment_id": 79639401, "body": "@IlmariKaronen Thanks for the heads up - have updated"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 3, "last_activity_date": 1505985037, "last_edit_date": 1505985037, "creation_date": 1505925527, "answer_id": 46327473, "question_id": 46327426, "link": "https://stackoverflow.com/questions/46327426/vba-how-to-loop-text-every-50-rows/46327473#46327473", "title": "VBA how to loop text every 50 rows", "body": "<p>Using the <code>Step</code> function</p>\n\n<p>If you just want the <code>Text</code> every 5 rows use:</p>\n\n<pre><code>For i = 1 To 500 Step 5\n    Cells(i, 1) = \"Hello\"\nNext i\n</code></pre>\n\n<p>If you want a value and then <code>Text</code> every 5 rows use:</p>\n\n<pre><code>For i = 1 To 500 Step 5\n    If rowCount = 5 Then\n        Cells(i, 1) = \"Hello\"\n        rowCount = 0\n    Else\n        Cells(i, 1) = i\n        rowCount = rowCount + 1\n    End If\nNext i\n</code></pre>\n\n<p>If you want to consider a variable row range then use the following in place of 500:</p>\n\n<pre><code>Cells(Rows.count,1).End(xlUp).row\n</code></pre>\n\n<p><strong><em>Update for after question was edited</em></strong>\nThis will do what your new question is asking for</p>\n\n<pre><code>Dim i As Long\n\n' Change this to your actual sheet\nWith ActiveSheet\n    For i = 1 To .Cells(.Rows.Count, \"A\").End(xlUp).Row - 7 Step 7\n        With .Cells(i, \"A\")\n            Range(.Offset(4, 0), .Offset(6, 0)).Value2 = \"Hello\"\n        End With\n    Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 881, "favorite_count": 0, "closed_date": 1505930399, "answer_count": 1, "score": -9, "last_activity_date": 1505985037, "creation_date": 1505925342, "last_edit_date": 1531164843, "question_id": 46327426, "link": "https://stackoverflow.com/questions/46327426/vba-how-to-loop-text-every-50-rows", "closed_reason": "Needs details or clarity", "title": "VBA how to loop text every 50 rows", "body": "<p>How can I insert a specific text every 4 rows for 3 rows until the last row of my worksheet?</p>\n\n<pre><code>1\n2\n3\n4\n5 Hello\n6 Hello\n7 Hello\n8\n9\n10\n11\n12 Hello\n13 Hello\n14 Hello\n15\n16\n17 \n18\n19 Hello\n.\n.\n500 Hello\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 4, "creation_date": 1505924849, "post_id": 46327189, "comment_id": 79615373, "body": "your destination isn&#39;t a fully qualified range.  You&#39;re trying to autofill the currently selected sheet and not the sheet in your &quot;With&quot; statement."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1505925635, "post_id": 46327189, "comment_id": 79615869, "body": "Implicit <code>ActiveSheet</code> references are a plague. See if <a href=\"https://stackoverflow.com/a/46324415/1188513\">this answer</a> helps."}, {"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1505928748, "post_id": 46327189, "comment_id": 79617720, "body": "@sous2817 Oh come on! Then what is the freaking with statement for!? grrr. I also had to then specify it for the the range for the rows count. but it works now! thanks for the help!"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 2, "creation_date": 1505929707, "post_id": 46327189, "comment_id": 79618263, "body": "the main thing is you got it working and learned a bit more about  the &#39;With&#39; statement.  Good luck with the rest of your project!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505993080, "post_id": 46327189, "comment_id": 79645155, "body": "RE <i>I also had to then specify it for the the range for the rows count</i> - a dot would have sufficed to qualify the member call with the <code>With</code> block variable..."}, {"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "edited": false, "score": 0, "creation_date": 1506114096, "post_id": 46327189, "comment_id": 79705934, "body": "Ah interesting. Thanks for the tip. A lot of times I find these example code bits and they say they work for them but then don&#39;t for me. Maybe they don&#39;t actually work sometimes. I am getting better though haha."}], "owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505924597, "creation_date": 1505924597, "question_id": 46327189, "link": "https://stackoverflow.com/questions/46327189/why-will-this-not-autofill", "title": "Why will this not Autofill?", "body": "<p>I am doing a VLOOKUP from a closed workbook. I am using this With statement for it. The first line after the with works. I get the cell from the closed workbook. and it shows up on my open one. The next line where it needs to autofill all the way down does NOT work. It throws an error </p>\n\n<p>\"Run time error '1004'. Autofill method of Range class failed.\"</p>\n\n<p>But if I hit debug and go to the sheet where this is supposed to get auto filled, then hit F8 to continue on and see if it works again, it then works!</p>\n\n<p>So why will this work when I am on the sheet but won't when I am not on the sheet even though the first line works?</p>\n\n<pre><code>With MainWindow.Sheets(1)\n    .Range(\"AE2\").Formula = \"=VLOOKUP($B2,'\" &amp; X &amp; \"]\" &amp; shtName &amp; \"'!$B$2:$K$99999,6,FALSE)\"\n    .Range(\"AE2\").AutoFill Destination:=Range(\"AE2:AE\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row)\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1505924579, "post_id": 46327130, "comment_id": 79615188, "body": "Quick question - instead of all the <code>Select Case</code> stuff, if <code>thismonth</code> is a number you could just do <code>startdate = thismonth - 1 &#47; 1</code>, no? (With the exception that <code>If thisMonth = 1 then startdate = 12</code>).  Also, @trincot makes a great point. You need to change how you set the start/end date. Also FYI you can use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-eomonth-method-excel\" rel=\"nofollow noreferrer\"><code>EOMONTH</code></a> for a quick way to get the last day of any month."}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 3, "creation_date": 1505924589, "post_id": 46327130, "comment_id": 79615193, "body": "Be aware that <code>8 &#47; 31</code> is not a date expression, but  the division of 8 by 31."}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1505924721, "post_id": 46327130, "comment_id": 79615280, "body": "@BruceWayne That is true, and how I originally started, but I specifically need to identify the first and last day of the previous month."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505924889, "post_id": 46327130, "comment_id": 79615403, "body": "You could use <code>ThisMonthYear = (Right(Date, 7)) </code> or <code>ThisMonth = Left((Right(Date, 7)), 2)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505925263, "post_id": 46327130, "comment_id": 79615622, "body": "FYI A date literal would look like <code>#9&#47;20&#47;2017#</code>"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "edited": false, "score": 3, "creation_date": 1505924910, "post_id": 46327215, "comment_id": 79615420, "body": "Ok, I have to laugh because that was so, so much more simple, and worked so much better! Thanks for your help!! :)"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "edited": false, "score": 0, "creation_date": 1505925111, "post_id": 46327215, "comment_id": 79615532, "body": "It said I have to wait a few minutes before I can do that, but I definitely will.  Also, can you explain the &quot;...,-2)+1&quot; in startDate rather than &quot;...-1)&quot; that appears in endDate"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "edited": false, "score": 1, "creation_date": 1505925890, "post_id": 46327215, "comment_id": 79616034, "body": "Nevermind, just looked up the EOMONTH function and got it figured out.  Thanks!"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 4, "last_activity_date": 1505924712, "creation_date": 1505924712, "answer_id": 46327215, "question_id": 46327130, "link": "https://stackoverflow.com/questions/46327130/formatting-variable-as-date-mm-dd/46327215#46327215", "title": "Formatting Variable as Date (mm/dd)", "body": "<p>How about a much simpler solution:</p>\n\n<pre><code>Dim startDate as Date\nDim endDate as Date\n\nstartDate = Application.WorksheetFunction.EOMONTH(Sheet1.[G9],-2) + 1\nendDate = Application.WorksheetFunction.EOMONTH(Sheet1.[G9],-1)\n</code></pre>\n\n<p>You can get rid of VBA altogether and write this worksheet formula directly in <code>J36</code> and <code>J37</code> respectively.</p>\n\n<p>J36: <code>=EOMONTH(G9,-2)+1</code></p>\n\n<p>J37: <code>=EOMONTH(G9,-1)</code></p>\n"}], "owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 46327215, "answer_count": 1, "score": 0, "last_activity_date": 1505924712, "creation_date": 1505924421, "question_id": 46327130, "link": "https://stackoverflow.com/questions/46327130/formatting-variable-as-date-mm-dd", "title": "Formatting Variable as Date (mm/dd)", "body": "<p>I am trying to create a script that identifies the date range of the previous month (Cell G9 is today's date).  It is working; however, the output is formatting the date much differently than I am intending.  The [J36] output is \"01/08\" when it should be \"08/01\" and the [J37] output is \"6:11:37 AM\" (interpretting it as a time), when it should be \"08/31\".  I am only coding for the output in particular cells because I want to see that it is working.  However, it is the variable I want to format, not the cell.  I'm going to be using the startdate and enddate variable in future code and those variables on their own won't be visable in any cells.</p>\n\n<p>I attempted to use the format(startdate,mm/dd), but I got an overflow error.</p>\n\n<p>Here is my script:</p>\n\n<pre><code>Dim thismonth As Integer\n    thismonth = Month(Sheet1.[G9])\nDim startdate As Date\nDim enddate As Date\n\n\nSelect Case thismonth\n    Case 1\n        startdate = 12 / 1\n        enddate = 12 / 31\n    Case 2\n        startdate = 1 / 1\n        enddate = 1 / 31\n    Case 3\n        startdate = 2 / 1\n        enddate = 2 / 28\n    Case 4\n        startdate = 3 / 1\n        enddate = 3 / 31\n    Case 5\n        startdate = 4 / 1\n        enddate = 4 / 30\n    Case 6\n        startdate = 5 / 1\n        enddate = 5 / 31\n    Case 7\n        startdate = 6 / 1\n        enddate = 6 / 30\n    Case 8\n        startdate = 7 / 1\n        enddate = 7 / 31\n    Case 9\n        startdate = 8 / 1\n        enddate = 8 / 31\n    Case 10\n        startdate = 9 / 1\n        enddate = 9 / 31\n    Case 11\n        startdate = 10 / 1\n        enddate = 10 / 31\n    Case 12\n        startdate = 11 / 1\n        enddate = 11 / 30\nEnd Select\n\nSheet1.[J36] = startdate\nSheet1.[J37] = enddate\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1505924908, "post_id": 46326943, "comment_id": 79615419, "body": "When deleting items from a collection you should work backwards to avoid side-effects from any deletions <code>For x = ActiveWorkbook.Worksheets.Count To 1 Step-1: Set ws = ActiveWorkbook.Worksheets(x)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1505924962, "post_id": 46326943, "comment_id": 79615447, "body": "And to test for array membership: <code>If Not IsError(Application.Match(ws.Name, exclude, 0)) Then</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1314, "user_id": 7092900, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd63573fc5c6bb06de5243747e027fea?s=128&d=identicon&r=PG&f=1", "display_name": "Max888", "link": "https://stackoverflow.com/users/7092900/max888"}, "edited": false, "score": 0, "creation_date": 1505924753, "post_id": 46327047, "comment_id": 79615304, "body": "thanks for your answer. this seems a lot of code for what would be a simple task in other languages - is there a simpler way to do this not using a public function?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1505924832, "post_id": 46327047, "comment_id": 79615358, "body": "Also you should keep in mind that <code>Filter</code> matches on <i>substrings</i> and not just the full values."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 1314, "user_id": 7092900, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd63573fc5c6bb06de5243747e027fea?s=128&d=identicon&r=PG&f=1", "display_name": "Max888", "link": "https://stackoverflow.com/users/7092900/max888"}, "edited": false, "score": 0, "creation_date": 1505924885, "post_id": 46327047, "comment_id": 79615398, "body": "@Max888 Well you could put it all on one line in the if statement if you wanted"}, {"owner": {"reputation": 1314, "user_id": 7092900, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd63573fc5c6bb06de5243747e027fea?s=128&d=identicon&r=PG&f=1", "display_name": "Max888", "link": "https://stackoverflow.com/users/7092900/max888"}, "edited": false, "score": 0, "creation_date": 1505925086, "post_id": 46327047, "comment_id": 79615518, "body": "so:     For Each ws In ActiveWorkbook.Worksheets     If Not UBound(Filter(exclude, ws.Name)) &gt; -1 Then ws.Delete      Next ws ?? &lt;br&gt;"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1505925317, "post_id": 46327047, "comment_id": 79615663, "body": "You can just do <code>= -1</code> instead of <code>not ... &lt; -1</code>"}, {"owner": {"reputation": 1314, "user_id": 7092900, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd63573fc5c6bb06de5243747e027fea?s=128&d=identicon&r=PG&f=1", "display_name": "Max888", "link": "https://stackoverflow.com/users/7092900/max888"}, "edited": false, "score": 1, "creation_date": 1505925690, "post_id": 46327047, "comment_id": 79615902, "body": "thanks I got it working but removed the Not - just so you already removed it in your updated answer"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 3, "last_activity_date": 1505925278, "last_edit_date": 1505925278, "creation_date": 1505924098, "answer_id": 46327047, "question_id": 46326943, "link": "https://stackoverflow.com/questions/46326943/how-to-delete-all-sheets-except-those-in-list/46327047#46327047", "title": "How to delete all sheets except those in list", "body": "<p>Use this function to test if it is in your array</p>\n\n<pre><code>Public Function InArray(arr As Variant, SearchValue As String) As Boolean\n    InArray = (UBound(Filter(arr, SearchValue)) &gt; -1)\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\n    If Not InArray(exclude, ws.Name) Then ws.Delete\nNext ws\n</code></pre>\n\n<hr>\n\n<p><strong><em>Update for all on one line</em></strong></p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\n    If UBound(Filter(arr, ws.Name)) = -1 Then ws.Delete\nNext ws\n</code></pre>\n\n<p>or use @TimWilliams suggestion in the comments above</p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\n    If Not IsError(Application.Match(ws.Name, exclude, 0)) Then ws.Delete\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 1314, "user_id": 7092900, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd63573fc5c6bb06de5243747e027fea?s=128&d=identicon&r=PG&f=1", "display_name": "Max888", "link": "https://stackoverflow.com/users/7092900/max888"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1498, "favorite_count": 0, "accepted_answer_id": 46327047, "answer_count": 1, "score": 0, "last_activity_date": 1505925278, "creation_date": 1505923746, "last_edit_date": 1531164843, "question_id": 46326943, "link": "https://stackoverflow.com/questions/46326943/how-to-delete-all-sheets-except-those-in-list", "title": "How to delete all sheets except those in list", "body": "<p>I have some VBA to delete all the sheets in a workbook.</p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\n    ws.Delete\nNext ws\n</code></pre>\n\n<p>how can I amend this to exclude some cases in a list? pseudo code would look like:</p>\n\n<pre><code>exclude = Array(\"apple\", \"orange\")\nFor Each ws In ActiveWorkbook.Worksheets\n    if ws not in array then ws.Delete\nNext ws\n</code></pre>\n"}, {"tags": ["excel", "vba", "extract"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1505923576, "post_id": 46326753, "comment_id": 79614584, "body": "I haven&#39;t looked at your code, but if you have a range you can find the name of the worksheet it is in by using <code>Range.Parent.Name</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1505924135, "post_id": 46326753, "comment_id": 79614924, "body": "Also, I <b><i>highly</i></b> recommend reading through, and applying, <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to Avoid using <code>.Select</code>/<code>.Activate</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1505924510, "post_id": 46327075, "comment_id": 79615142, "body": "What is the significance of the semicolon? I havent ever seen that style of syntax used before."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1505924598, "post_id": 46327075, "comment_id": 79615198, "body": "@BrandonBarney It&#39;s standard syntax? I didnt know there was a different way of doing it?  I know that strings go before the semi colon in quotes and variables afterwards"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1505924623, "post_id": 46327075, "comment_id": 79615215, "body": "I guess you could combine variables in the quotes too"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1505924812, "post_id": 46327075, "comment_id": 79615347, "body": "@BrandonBarney Not sure if there&#39;s any point in putting just after <code>Debug.Print</code> but it suppresses the new line. Putting it at the end would therefore print all results on one line."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1505924929, "post_id": 46327075, "comment_id": 79615428, "body": "I basically was following the documentation <a href=\"https://msdn.microsoft.com/en-us/library/aa716276(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa716276(v=vs.60).aspx</a>"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1505925268, "post_id": 46327075, "comment_id": 79615626, "body": "@DougCoats That is really strange. I have never seen the semicolon before, and it is odd that it would be the standard in the documentation. I always do something like <code>Debug.Print Foo</code> or <code>Debug.Print &quot;Foo = &quot; &amp; Foo</code>. They are functionally equivalent to the semicolon as far as I can tell. I wonder if the semicolon is deprecated...strange."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 3, "creation_date": 1505925764, "post_id": 46327075, "comment_id": 79615946, "body": "@DougCoats With the help of the RD team I understand it better now. It has different functionality than <code>Debug.Print Foo</code> since it, in a way, has a contextual behavior. It behaves like <code>Console.Write</code> from C#. Depending on the application it can be quite useful. Interesting to know :)."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1505925812, "post_id": 46327075, "comment_id": 79615976, "body": "Neat. Now I also understand it better :D Thanks"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505926680, "post_id": 46327075, "comment_id": 79616484, "body": "Pretty sure a semicolon is redundant <i>before</i> what&#39;s being printed. The semicolon basically says &quot;don&#39;t print an implicit newline&quot;, so the <i>next</i> <code>Debug.Print</code> call (or whatever follows the semicolon in the same instruction) will be output on the same line. Hard to put in words, but yeah the best I could come up with is <code>Console.Write</code> (terminating the statement with a semicolon) vs <code>Console.WriteLine</code> (without the semicolon). So <code>?&quot;foo&quot;;&quot;bar&quot;</code> is the same as <code>?&quot;foo&quot;&amp;&quot;bar&quot;</code> - also, using a comma to separate printed values is the same as concatenating with <code>vbTab</code> in-between the two values."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505940529, "post_id": 46327075, "comment_id": 79623815, "body": "@Mat&#39;sMug I coincidentally enough just had an opportunity to test what youre saying. I had to update about 40 records in sql server and I used &quot;debug.print; vbSql&quot; to output the sql statement. Each output was on its own line. So I out of curiousity ran a loop (see edited code above)and tested both options. If variable i is before semi colon its same line, if its after its nect line"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1505940764, "post_id": 46327075, "comment_id": 79623918, "body": "So I can see where they have their uses and honestly i think id still prefer after semi colon especially since I would want to mix up my outputs"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505940947, "post_id": 46327075, "comment_id": 79624000, "body": "That&#39;s what I&#39;m saying: <code>Debug.Print i</code> and <code>Debug.Print ; i</code> (with or without the whitespace before it) both produce the same output, i.e. the semicolon is redundant when it&#39;s before the output list =)"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505941135, "post_id": 46327075, "comment_id": 79624079, "body": "@Mat&#39;sMug Ah I guess I must be stupid LOL I totally looked over the qualifying part of your statement. Though I do find this to be an interesting distinction."}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 1, "last_activity_date": 1505940595, "last_edit_date": 1505940595, "creation_date": 1505924234, "answer_id": 46327075, "question_id": 46326753, "link": "https://stackoverflow.com/questions/46326753/how-to-extract-worksheet-name-in-vba/46327075#46327075", "title": "How to extract worksheet name in VBA?", "body": "<pre><code>dim sheet as worksheet\ndim wb as workbook\nset wb = thisworkbook\n\nfor each sheet in wb.Sheets\n    debug.print; sheet.Name\nnext sheet\n</code></pre>\n\n<p>Because we're nerds and want to check things:</p>\n\n<pre><code>Private Sub this()\n    For i = 0 To 99\n        Debug.Print i;\n        'prints to the same line\n    Next i\n\n    For i = 0 To 99\n        Debug.Print ; i\n        prints to next line\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8640758, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d41c5494bf12c0b6913e4e239bfa1c01?s=128&d=identicon&r=PG&f=1", "display_name": "Mourst", "link": "https://stackoverflow.com/users/8640758/mourst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2247, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505940595, "creation_date": 1505923116, "last_edit_date": 1505923669, "question_id": 46326753, "link": "https://stackoverflow.com/questions/46326753/how-to-extract-worksheet-name-in-vba", "title": "How to extract worksheet name in VBA?", "body": "<p>I have a script that rips some data for me from a certain tab in multiple excel workbooks.</p>\n\n<p>I am wondering how can I add to that to extract the workbook name for each workbook it goes through</p>\n\n<p>This is what I am using:</p>\n\n<pre><code>Dim fPath As String\nDim iSheet As String\nDim oSheet As String\nDim BMsheet As String\n\nDim country, bas, play As String\nDim fileNames As Range\nDim file As Range\nDim oWorkbook As Excel.Workbook ' outlook workbook\n\nDim MyRange As Range\n\niSheet = \"INPUT\"\noSheet = \"Data\"\nBMsheet = \"Potential Discovery Phasing\"\n\nDim fHandle As New FileSystemObject\n\nThisWorkbook.Worksheets(iSheet).Activate\nSet fileNames = Range(\"files\")\nThisWorkbook.Worksheets(oSheet).Activate\nRange(\"start\").Activate\n\nOn Error GoTo NotFound:\n\nFor Each file In fileNames.Cells\n    If fHandle.FileExists(file.Value) Then\n        Set oWorkbook = Workbooks.Open(file.Value, False, True)\n        'extract columns\n\n        ''''''''''''''''''''''''''''''''''''''''''''''''\n        '\n        ''''''''''''''''''''''''''''''''''''''''''''''''\n        oWorkbook.Worksheets(BMsheet).Select\n\n        If ActiveSheet.AutoFilterMode = True Then ActiveSheet.AutoFilterMode = False\n\n        Range(\"A6\").Select\n\n        ActiveCell.Offset(1, 0).Select\n        Set MyRange = Range(ActiveCell, ActiveCell.Offset(32, 7))\n\n        MyRange.Select\n\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n\n        ThisWorkbook.Activate\n        ThisWorkbook.Worksheets(oSheet).Select\n        Selection.PasteSpecial xlValues\n\n       'While ActiveCell.Value &lt;&gt; \"\"\n             'ActiveCell.Offset(0, -1).Value = file.Offset(0, -2).Value\n             ActiveCell.Offset(33, 0).Activate\n       'Wend\n\n        Application.CutCopyMode = False\n        oWorkbook.Close SaveChanges:=False\n\n        ActiveCell.Select\n        file.Offset(0, 1).Value = \"Yes\"\n    Else\n        file.Offset(0, 1).Value = \"No\"\n    End If\n\nSkip: Next file\n\n    Exit Sub\n\nNotFound:\n    GoTo Skip\nEnd Sub\n</code></pre>\n\n<p>I am fairly new to VBA so excuse my lack of knowledge</p>\n\n<p>Cheers</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "edited": false, "score": 0, "creation_date": 1505935010, "post_id": 46326699, "comment_id": 79621079, "body": "Show us what you have tried"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1505959388, "creation_date": 1505959388, "answer_id": 46334274, "question_id": 46326699, "link": "https://stackoverflow.com/questions/46326699/in-vba-word-how-to-check-if-a-paragraph-contains-any-bold/46334274#46334274", "title": "In VBA Word, how to check if a paragraph contains any bold?", "body": "<p>The help that can be offered at this stage of your endeavour doesn't go beyond showing you how to help yourself.</p>\n\n<p>The red line of your programming should be to find bold text in your document and determine if it is a whole paragraph. If it is then delete the blank line following it (and then continue searching for the next such paragraph?), and if it isn't, do nothing (and continue searching for the next bold text?).</p>\n\n<p>At the heart of this plan is VBA's <code>Find</code> method. You can look it up on MSDN and/or you can do the search manually while recording your key strokes with the macro recorder. Either of these ways will be very confusing, perhaps the latter more than the former although it promises to be the shorter way to your target. Actually, much depends upon how you define your target. If you want to learn VBA the questions you meet will be challenges you can master. Others have done it before you.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1572357608, "post_id": 46437447, "comment_id": 103528613, "body": "Thanks for your reply, sorry I never responded sooner, I didn&#39;t get any notifications about answers (I expected that I would) and haven&#39;t been back on here since. I have code that searches for &quot;^p&quot; and replaces it with &quot;^p^p&quot; to create a blank space between each paragraph. From what you&#39;ve shown, how could I run that &quot;If Selection.Font.Bold = True Then...&quot; for each paragraph in the entire document, so it does the search (and subsequent editing/formatting) for each paragraph?"}], "tags": [], "owner": {"reputation": 101, "user_id": 8666843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242ae8b950fa2c7ecc5dc28683e33ea1?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce M", "link": "https://stackoverflow.com/users/8666843/bruce-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1506470509, "last_edit_date": 1506470509, "creation_date": 1506470058, "answer_id": 46437447, "question_id": 46326699, "link": "https://stackoverflow.com/questions/46326699/in-vba-word-how-to-check-if-a-paragraph-contains-any-bold/46437447#46437447", "title": "In VBA Word, how to check if a paragraph contains any bold?", "body": "<p>I prefer the method that you were first considering. Create a Word file, and make sure that some text is bold and some is not. Highlight some plain text, or some bold text, or a range that includes plain and bold, and run the following routine.</p>\n\n<pre><code>Sub WhatTheHeck()\n    If Selection.Font.Bold = True Then MsgBox \"All is Bold\"\n    If Selection.Font.Bold = False Then MsgBox \"None is Bold\"\n    If Selection.Font.Bold = wdUndefined Then MsgBox \"Some is Bold\" \nEnd Sub\n</code></pre>\n\n<p>When you get the hang of that, learn (or ask again) some of the many ways to select text programmatically (with the .Select method), and you'll have everything you need.\n(For example, as somebody else suggested, you will be able to do a .Find with any complex criteria, combined with a .Select, and then call WhatTheHeck()).</p>\n\n<p>NOTE: It is worth mentioning that many true/false properties in VBA can be true, false, or wdUndefined, and possibly other values. In general, wdUndefined means 'a combination of true and false'. I know that the Selection.Font.Hidden property can also be wdUndefined, meaning a combination of both.</p>\n"}], "owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1220, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593764249, "creation_date": 1505922944, "last_edit_date": 1593764249, "question_id": 46326699, "link": "https://stackoverflow.com/questions/46326699/in-vba-word-how-to-check-if-a-paragraph-contains-any-bold", "title": "In VBA Word, how to check if a paragraph contains any bold?", "body": "<p>I've been teaching myself to use macros and VBA in work. I'm not code-minded so bear with me.</p>\n\n<p>I need to be able to find paragraphs that are wholly bold (such as a subheading), but I've been struggling to figure it out or find any help online. I've seen similar questions but the responses are too complicated for me to really know what I'm replicating, despite trying to use parts that seem relevant.</p>\n\n<p>My end goal is to, after finding a wholly bold paragraph, delete the character immediately following it (usually an empty line).</p>\n\n<p>I did find something that suggested 0 being regular, -1 being entirely bold and 9999999 being partially bold, but I've been unable to get anything like that to work as I couldn't tell what code was relevant to me. I'd really appreciate any help, thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1505922576, "post_id": 46326171, "comment_id": 79613896, "body": "I think you just need to shorten the formula supplied in the answers already - in A1 use <code>=COUNTIF(C1:$C$1,C1)</code>.  I assume your note that <i>in column C i have multiple data need to select</i> means you want a running count of each item in column C?"}, {"owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1505923015, "post_id": 46326171, "comment_id": 79614208, "body": "I want to set selection based on criteria In column C, eg. Billy. Is there anyway i can select all? any wildcard i can use?"}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1505921817, "creation_date": 1505921817, "answer_id": 46326309, "question_id": 46326171, "link": "https://stackoverflow.com/questions/46326171/excel-sequence-number-based-on-cell-value/46326309#46326309", "title": "Excel Sequence number based on cell value", "body": "<p>Put the formula <code>=IF(C1=$D$1,COUNTIF($C$1:C1,$D$1),\"\")</code> in A1 and copied down.</p>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "edited": false, "score": 1, "creation_date": 1505922671, "post_id": 46326403, "comment_id": 79613974, "body": "you are awesome! very clear explanation, thank your for your great help!"}, {"owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "edited": false, "score": 0, "creation_date": 1505923985, "post_id": 46326403, "comment_id": 79614841, "body": "hi any formula or wildcard i can use if i want to select all persons? column A will show from 1,2,3,4,5.....if D1 i put &quot;*&quot; ? I have tried it&#39;s not working"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "edited": false, "score": 0, "creation_date": 1505967509, "post_id": 46326403, "comment_id": 79630859, "body": "Nope, Thats not possible !!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1505980231, "post_id": 46326403, "comment_id": 79636279, "body": "You&#39;d need to use <code>COUNTA</code> to count everything - it counts the number of cells that aren&#39;t empty in a range.  You just need an <code>IF</code> statement to decide whether to use <code>COUNTA</code> or <code>COUNTIF</code>:  <code>=IF($D$1=&quot;*&quot;,COUNTA(C$1:C1),IF(C1=D$1,COUNTIF(C$1:C1,D$1),&quot;&quot;&zwnj;&#8203;))</code>"}, {"owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "edited": false, "score": 0, "creation_date": 1505982103, "post_id": 46326403, "comment_id": 79637543, "body": "Can I insert unique number ? In above example, I want to fill A1 for Billy 1 time, not 3 time.  Can it be done ?"}, {"owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "edited": false, "score": 0, "creation_date": 1505986846, "post_id": 46326403, "comment_id": 79640606, "body": "Darren Bartrup-Cook, your code work perfectly! thank you for your sharing, many learning today, hope i can do the same in the future for others !!"}], "tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": true, "score": 2, "last_activity_date": 1505922089, "creation_date": 1505922089, "answer_id": 46326403, "question_id": 46326171, "link": "https://stackoverflow.com/questions/46326171/excel-sequence-number-based-on-cell-value/46326403#46326403", "title": "Excel Sequence number based on cell value", "body": "<p>Select the whole column A or just the cells that you want to fill in and enter the formula in the formula bar,</p>\n\n<pre><code>=IF(C1=D$1,COUNTIF(C$1:C1,D$1),\"\")\n</code></pre>\n\n<p>Press <code>ctrl+enter</code> to fill the formula for the range of selected cells. </p>\n\n<p>You could then change the value in cell <code>D1</code> and see the output.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dFAEV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dFAEV.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/BgbOQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BgbOQ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1796, "favorite_count": 1, "accepted_answer_id": 46326403, "answer_count": 2, "score": 1, "last_activity_date": 1505922089, "creation_date": 1505921403, "question_id": 46326171, "link": "https://stackoverflow.com/questions/46326171/excel-sequence-number-based-on-cell-value", "title": "Excel Sequence number based on cell value", "body": "<p>In excel, how can I create auto numbering in column A ? eg. If I key in cell value in D1 with \"BILLY\", column A will populate sequence numbers from 1,2,3.....</p>\n\n<p>I have googled and found the closet is using below formula but unable to accomplish what i want because in column C i have multiple data need to select.</p>\n\n<p><a href=\"https://superuser.com/questions/645859/auto-sequential-numbering-based-on-cell-criteria/645903\">https://superuser.com/questions/645859/auto-sequential-numbering-based-on-cell-criteria/645903</a></p>\n\n<pre><code>A     B     C\n     ABC    JAMES\n     XYZ    BOB\n1    OXY    BILLY\n2    BNX    BILLY\n     SDA    MIKE\n3    WXK    BILLY\n     SAK    JANE\n</code></pre>\n\n<p>Anyone have done this before with formula or vba? would appreciate your help, thanks.</p>\n"}, {"tags": ["vba", "transparency", "powerpoint", "powerpoint2016"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4503279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jZ0XTJBX3Rc/AAAAAAAAAAI/AAAAAAAAABA/snUPRu_CJT8/photo.jpg?sz=128", "display_name": "James Travers", "link": "https://stackoverflow.com/users/4503279/james-travers"}, "edited": false, "score": 0, "creation_date": 1505926620, "post_id": 46326281, "comment_id": 79616448, "body": "Thank you, Do you know why Font.Fill works as a child of TextFrame2 but not of TextFrame?  This information wasn&#39;t clear from MS at all!"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 3, "user_id": 4503279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jZ0XTJBX3Rc/AAAAAAAAAAI/AAAAAAAAABA/snUPRu_CJT8/photo.jpg?sz=128", "display_name": "James Travers", "link": "https://stackoverflow.com/users/4503279/james-travers"}, "edited": false, "score": 0, "creation_date": 1506009653, "post_id": 46326281, "comment_id": 79657153, "body": "Previous versions of PowerPoint didn&#39;t allow us to specify Font.Fill (just Font.Color). When MS added a host of new text/font effects, they provided a TextFrame2 object to give access to the new effects but retained the old TextFrame for compatibility purposes.  And you&#39;re right: clarity isn&#39;t the strong point of MS&#39; documentation."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 2, "last_activity_date": 1505921695, "creation_date": 1505921695, "answer_id": 46326281, "question_id": 46326124, "link": "https://stackoverflow.com/questions/46326124/powerpoint-2016-text-transparency/46326281#46326281", "title": "Powerpoint 2016 Text Transparency", "body": "<p>Try this (for just the first member of the current selection)</p>\n\n<pre><code>With ActiveWindow.Selection.ShapeRange(1)\n    With .TextFrame2.TextRange.Font.Fill\n        .Transparency = 0.5\n    End With\nEnd With\n</code></pre>\n\n<p>If you want to iterate through all the shapes in the current selection, you'll want to test each shape to see if .HasTextFrame and .TextFrame.HasText are true before trying to work with the text.</p>\n"}], "owner": {"reputation": 3, "user_id": 4503279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jZ0XTJBX3Rc/AAAAAAAAAAI/AAAAAAAAABA/snUPRu_CJT8/photo.jpg?sz=128", "display_name": "James Travers", "link": "https://stackoverflow.com/users/4503279/james-travers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 809, "favorite_count": 0, "accepted_answer_id": 46326281, "answer_count": 1, "score": 0, "last_activity_date": 1505921695, "creation_date": 1505921246, "question_id": 46326124, "link": "https://stackoverflow.com/questions/46326124/powerpoint-2016-text-transparency", "title": "Powerpoint 2016 Text Transparency", "body": "<p>I need to set the Transparency of Text in a shape via VBA, in fact I need to set the transparency for the whole shape but it's the text I'm stuck with.</p>\n\n<p>I just can't seem to navigate the object model to find the Transparency Property</p>\n\n<pre><code>Function SetTransparency(Value As Single)\nOn Error GoTo AbortNameShape\n\nIf ActiveWindow.Selection.ShapeRange.Count = 0 Then\n    MsgBox \"No Shapes Selected\"\n    Exit Function\nEnd If\n\nWith ActiveWindow.Selection.ShapeRange\n    .Fill.Transparency = Value\n    .Line.Transparency = Value\n    .TextFrame.TextRange. **HELP**  .Transparency = Value\n    End With\nAbortNameShape:\nMsgBox Err.Description\n\nEnd Function\n</code></pre>\n\n<p>Google has given me</p>\n\n<pre><code>.TextFrame.TextRange.Characters.Font.Fill.Transparency\n</code></pre>\n\n<p>From <a href=\"https://www.mrexcel.com/forum/excel-questions/510589-transparent-text-shapes-textbox-1-a.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/510589-transparent-text-shapes-textbox-1-a.html</a></p>\n\n<p>But that fails on the <code>.Fill</code> property of <code>Font</code> object not existing.  I'm assuming MS have changed the object model in the 10 years that have passed since the answer was given, but I'm stuck for a current approach.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "vbscript", "outlook", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 7272775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ce15e1ea42912ed3fc163ce8b68f455?s=128&d=identicon&r=PG&f=1", "display_name": "Bp944", "link": "https://stackoverflow.com/users/7272775/bp944"}, "is_accepted": true, "score": 0, "last_activity_date": 1506417732, "creation_date": 1506417732, "answer_id": 46422537, "question_id": 46325917, "link": "https://stackoverflow.com/questions/46325917/vbs-outlook-signature-different-result-on-2013-compared-to-2010-2016-selectio/46422537#46422537", "title": "vbs Outlook Signature, different result on 2013 compared to 2010/2016 - Selection.GoTo?", "body": "<p>Commenting out </p>\n\n<pre><code>On Error Resume Next\n</code></pre>\n\n<p>tells me that the error is caused by the </p>\n\n<pre><code>.Selection.GoTo\n</code></pre>\n\n<p>in the SearchAndRep subroutine.</p>\n\n<p>Suggested by previous comment (now deleted)</p>\n"}], "owner": {"reputation": 37, "user_id": 7272775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ce15e1ea42912ed3fc163ce8b68f455?s=128&d=identicon&r=PG&f=1", "display_name": "Bp944", "link": "https://stackoverflow.com/users/7272775/bp944"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "accepted_answer_id": 46422537, "answer_count": 1, "score": 0, "last_activity_date": 1593341880, "creation_date": 1505920691, "last_edit_date": 1593341880, "question_id": 46325917, "link": "https://stackoverflow.com/questions/46325917/vbs-outlook-signature-different-result-on-2013-compared-to-2010-2016-selectio", "title": "vbs Outlook Signature, different result on 2013 compared to 2010/2016 - Selection.GoTo?", "body": "<p>I found this script that uses a Word template and placeholders to generate an Outlook signature and set the generated signature in Outlook. - Link removed due to not having more than 10 reputation - </p>\n\n<p>I made a few modifications to suit my needs and it worked great when testing on Outlook 2010 and 2016. However, I have been having issues with getting it to work with Outlook 2013. The placeholders are not being replaced the relevant information.</p>\n\n<pre><code>On Error Resume Next\n\nConst wdWord = 2\nConst wdParagraph = 4\nConst wdExtend = 1\nConst wdCollapseEnd = 0\n\n\nstrTemplatePath = \"\\\\server\\dir\\\"\nstrTemplateName = \"SignatureTemplate.docx\"\nstrReplyTemplateName = \"SignatureTemplateReply.docx\"\n\n\n'----- Connect to AD and get user info -----'\nSet objSysInfo = CreateObject(\"ADSystemInfo\")\nSet WshShell = CreateObject(\"WScript.Shell\")\n\nstrUser = objSysInfo.UserName\nSet objUser = GetObject(\"LDAP://\" &amp; strUser)\n\nstrFirstname = objUser.FirstName\nstrLastName = objUser.givenName\nstrDepartment = objUser.Department\nstrInitials = objUser.initials\nstrName = objUser.FullName\nstrTitle = objUser.Title\nstrDescription = objUser.Description\nstrOffice = objUser.physicalDeliveryOfficeName\nstrCred = objUser.info\nstrStreet = objUser.StreetAddress\nstrLocation = objUser.l\nstrPostCode = objUser.PostalCode\nstrPhone = objUser.TelephoneNumber\nstrMobile = objUser.Mobile\nstrFax = objUser.FacsimileTelephoneNumber\nstrEmail = objUser.mail\nstrWeb = \"\"\n\n'New Signature\nSet objWord = CreateObject(\"Word.Application\")\nSet objDoc = objWord.Documents.Open(strTemplatePath &amp; strTemplateName,,True)\nSet objEmailOptions = objWord.EmailOptions\nSet objSignatureObject = objEmailOptions.EmailSignature\nSet objSignatureEntries = objSignatureObject.EmailSignatureEntries\n\n\nSearchAndRep \"[Name]\", strName, objWord\nIf strTitle = \"\" Then \nSearchAndRep \"[Title]\", (objDoc.Bookmarks(\"title\").Range.Paragraphs(1).Range.Delete), objDoc\nElse SearchAndRep \"[Title]\", strTitle, objWord\nEnd If\nIf strDepartment = \"\" Then \nSearchAndRep \"[Department]\", (objDoc.Bookmarks(\"department\").Range.Paragraphs(1).Range.Delete), objDoc\nElse SearchAndRep \"[Department]\", strDepartment, objWord\nEnd If\nSearchAndRep \"[Phone]\", strPhone, objWord\nIf strMobile = \"\" Then \nSearchAndRep \"[Mobile]\", (objDoc.Bookmarks(\"mobile\").Range.Paragraphs(1).Range.Delete), objDoc\nElse SearchAndRep \"[Mobile]\", strMobile, objWord\nEnd If\nSearchAndRep \"[Fax]\", strFax, objWord\nSearchAndRep \"[OfficePhone]\", strOfficePhone, objWord\nSearchAndRep \"[email]\", strEmail, objWord\nSearchAndRep \"[web]\", strWeb, objWord\nIf strOffice = \"\" Then \nSearchAndRep \"[Office]\", (objDoc.Bookmarks(\"office\").Range.Paragraphs(1).Range.Delete), objDoc\nElse SearchAndRep \"[Office]\", strOffice, objWord\nEnd If\n\n\n\nSearchAndRepHyperlink \"[email]\", strWeb, objDoc\nSearchAndRepHyperlink \"[web]\", strWeb, objDoc\n\n\n\nSet objSelection = objDoc.Range()\nobjSignatureEntries.Add \"Full Signature\", objSelection\nobjSignatureObject.NewMessageSignature = \"Full Signature\"\n\n'see note below if a different reply signature is desired\n'objSignatureObject.ReplyMessageSignature = \"Reply Signature\"\n\n\n\nobjDoc.Saved = TRUE\nobjDoc.Close\nobjWord.Quit\n\n'______________________\n\n'Reply Signature\nSet objWord = CreateObject(\"Word.Application\")\nSet objDoc = objWord.Documents.Open(strTemplatePath &amp; strReplyTemplateName,,True)\nSet objEmailOptions = objWord.EmailOptions\nSet objSignatureObject = objEmailOptions.EmailSignature\nSet objSignatureEntries = objSignatureObject.EmailSignatureEntries\n\nSearchAndRep \"[Name]\", strName, objWord\nIf strTitle = \"\" Then \nSearchAndRep \"[Title]\", (objDoc.Bookmarks(\"title\").Range.Paragraphs(1).Range.Delete), objDoc\nElse SearchAndRep \"[Title]\", strTitle, objWord\nEnd If\nIf strDepartment = \"\" Then \nSearchAndRep \"[Department]\", (objDoc.Bookmarks(\"department\").Range.Paragraphs(1).Range.Delete), objDoc\nElse SearchAndRep \"[Department]\", strDepartment, objWord\nEnd If\nSearchAndRep \"[Phone]\", strPhone, objWord\nIf strMobile = \"\" Then \nSearchAndRep \"[Mobile]\", (objDoc.Bookmarks(\"mobile\").Range.Paragraphs(1).Range.Delete), objDoc\nElse SearchAndRep \"[Mobile]\", strMobile, objWord\nEnd If\nSearchAndRep \"[Fax]\", strFax, objWord\nSearchAndRep \"[OfficePhone]\", strOfficePhone, objWord\nSearchAndRep \"[email]\", strEmail, objWord\nSearchAndRep \"[web]\", strWeb, objWord\nIf strOffice = \"\" Then \nSearchAndRep \"[Office]\", (objDoc.Bookmarks(\"office\").Range.Paragraphs(1).Range.Delete), objDoc\nElse SearchAndRep \"[Office]\", strOffice, objWord\nEnd If\n\n\nSearchAndRepHyperlink \"[email]\", strWeb, objDoc\nSearchAndRepHyperlink \"[web]\", strWeb, objDoc\n\n\n\nSet objSelection = objDoc.Range()\nobjSignatureEntries.Add \"Reply Signature\", objSelection\nobjSignatureObject.ReplyMessageSignature = \"Reply Signature\"\n\nobjDoc.Saved = TRUE\nobjDoc.Close\nobjWord.Quit\n\n\n\n\n\n'----- Subrouting to search and replace template text placeholders -----\nSub SearchAndRep(searchTerm, replaceTerm, WordApp)\n    WordApp.Selection.GoTo 1\n    With WordApp.Selection.Find\n        .ClearFormatting\n        .Replacement.ClearFormatting\n        .MatchWholeWord = True\n        .Text = searchTerm\n        .Execute ,,,,,,,,,replaceTerm\n    End With\nEnd Sub\n\n\n'----- Subrouting to search and replace template hyperlink placeholders -----\n'         Note this can be picky...if it does not work re-create hyperlink in the template\nSub SearchAndRepHyperlink(searchLink, replaceLink, WordDoc)\n    Set colHyperlinks = WordDoc.Hyperlinks\n    For Each objHyperlink in colHyperlinks\n        If objHyperlink.Address = searchLink Then                                \n            objHyperlink.Address = replaceLink\n            End If\n    Next\nEnd Sub\n\n'WScript.Echo \"Signature set\"\n</code></pre>\n\n<p>I found this post - <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/67184929-d7da-4fba-875b-0e1371f46f2f/vbscript-for-outlook-signature-not-work-with-office-2013?forum=worddev\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/office/en-US/67184929-d7da-4fba-875b-0e1371f46f2f/vbscript-for-outlook-signature-not-work-with-office-2013?forum=worddev</a> where the answer suggested that the Selection.GoTo was not set correctly. I followed his suggestion but this would not resolve the issue.</p>\n\n<p>The rest of the code seems to work on 2013, the Word template is used and copied into Outlook and set as a signature but the placeholders are not replaced with the active directory information. So the signature (for Outlook 2013) ends up being set as:</p>\n\n<p>[Name]</p>\n\n<p>[Title]</p>\n\n<p>[OfficePhone]</p>\n\n<p>[Mobile]</p>\n\n<p>Thanks very much for your time.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505919299, "post_id": 46325174, "comment_id": 79611376, "body": "See <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_winother/using-applicationcaller-to-reference-the-worksheet/b861723e-c7aa-4944-b15a-5cda0d8d3da8?auth=1\" rel=\"nofollow noreferrer\">Application.Caller</a>"}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "edited": false, "score": 0, "creation_date": 1505921523, "post_id": 46325830, "comment_id": 79613113, "body": "The Sheet1_Toggle_To_GO_Back Sub doesn&#39;t work I have the message Object needed"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "edited": false, "score": 0, "creation_date": 1505922237, "post_id": 46325830, "comment_id": 79613641, "body": "@MaxBridge Did you change your references in the Global_Hold_Macro to be appropriate to your toggle?  I used r, c, and s, as examples showing the complexity of what needs to be captured.  If your button isn&#39;t tied to a cell, then the r &amp; c will not be recorded appropriately, though the s is activesheet, so it is captured."}, {"owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "edited": false, "score": 0, "creation_date": 1505923137, "post_id": 46325830, "comment_id": 79614295, "body": "Object is required when I press the go back button. I would guess a problem with the declaration of my public variable"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "edited": false, "score": 0, "creation_date": 1505923932, "post_id": 46325830, "comment_id": 79614806, "body": "@MaxBridge Sorry, I forgot to put in the sheet activate before selecting the button shape.  It causes that issue.  Updated my post."}, {"owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "edited": false, "score": 0, "creation_date": 1505926445, "post_id": 46325830, "comment_id": 79616344, "body": "Where do I put the public variable beacause c in the Sub Sheet1_Toggle_To_Go_Back() is empty?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "edited": false, "score": 0, "creation_date": 1505927139, "post_id": 46325830, "comment_id": 79616720, "body": "@MaxBridge It should be at the top of a module, outside of all subs.  It might be best to make a module just for the global variables."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1505923682, "last_edit_date": 1505923682, "creation_date": 1505920485, "answer_id": 46325830, "question_id": 46325174, "link": "https://stackoverflow.com/questions/46325174/how-to-return-to-the-place-in-my-workbook-where-the-button-was-clicked/46325830#46325830", "title": "How to return to the place in my workbook where the button was clicked?", "body": "<p>From Scott's suggestion, you can use a global variable and have sheet 1 use a button to go back to the last saved items, such as:</p>\n\n<pre><code>Public r as Long, Public c as Long, Public s as Worksheet\n\nSub Global_Hold_Macro()\n     'You would put \"Globlal_Hold_Macro\" in each togglebutton\n     r = Activecell.Row\n     c = Activecell.Column\n     s = Activesheet.Name\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub Sheet1_Toggle_To_Go_Back()\n    s.cells(r,c).Select\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>Will show this to call a specific named shape, in this case a button:</p>\n\n<pre><code>Public r as String\nPublic c as String\n\nSub Global_Hold_Macro()\n     'You would put \"Globlal_Hold_Macro\" in each togglebutton\n     r = Application.Caller\n     c = Activesheet.Name\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub Sheet1_Toggle_To_Go_Back()\n    Sheets(c).Activate\n    Sheets(c).Shapes(r).Select\nEnd Sub\n</code></pre>\n\n<p>This may not work if you use certain types of buttons/shapes.</p>\n"}], "owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505923682, "creation_date": 1505918731, "last_edit_date": 1531164843, "question_id": 46325174, "link": "https://stackoverflow.com/questions/46325174/how-to-return-to-the-place-in-my-workbook-where-the-button-was-clicked", "title": "How to return to the place in my workbook where the button was clicked?", "body": "<p>In my workbook I have many ToggleButton in different sheets that get me to the same sheet (SheetX) and then from that sheet I want to return where the ToggleButton was pressed.</p>\n\n<p>Is there a better way to do this that infinite If/End If statement</p>\n\n<p>Hope I'm clear enough</p>\n\n<pre><code>Private Sub CommandButton12_Click()\n\n    If Sheets(\"T1\").ToggleButton1.Value = True Or Sheets(\"T2\").ToggleButton1.Value = True Then\n\n        Sheets(\"T2\").Select\n\n            If Sheets(\"T1\").ToggleButton1.Value = True Or Sheets(\"T2\").ToggleButton1.Value = True Or Sheets(\"T3\").ToggleButton1.Value = True Then\n\n                Sheets(\"T3\").Select\n\n            End If\n\n            'So on and on and on\n\n    Else\n\n        Sheets(\"T1\").Select\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "range", "copy-paste", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6003781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0340a1913342faa6cfb3fa465cc7f401?s=128&d=identicon&r=PG&f=1", "display_name": "Simi", "link": "https://stackoverflow.com/users/6003781/simi"}, "edited": false, "score": 0, "creation_date": 1505919688, "post_id": 46325256, "comment_id": 79611660, "body": "thank you danieltakeshi for your help for the second time today :D It worked. I will read your tips so I can be better in future. Also yes I am multiplying with value in B1. getting to show $ in millions."}], "tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": true, "score": 2, "last_activity_date": 1505919320, "last_edit_date": 1592644375, "creation_date": 1505918929, "answer_id": 46325256, "question_id": 46325125, "link": "https://stackoverflow.com/questions/46325125/vba-code-pastes-values-in-range-instead-of-whole-column/46325256#46325256", "title": "vba code. pastes values in range instead of whole column", "body": "<p>You should change <code>Rows(intRow &amp; &quot;:&quot; &amp; intRow).Copy</code> to <code>Range(&quot;B&quot; &amp; intRow &amp; &quot;:M&quot; &amp; intRow).Copy</code></p>\n<p>Because with your first code, you are Copying the entire Row and then pasting. With the second code, You just copy from column B to M.</p>\n<p>And i don't know if it is what you intended, but you are multiplying the values that are pasted.</p>\n<h1>Tips:</h1>\n<ol>\n<li>You should avoid <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. So you declare the worksheet and range.</li>\n<li>Try to copy <a href=\"https://stackoverflow.com/a/8852772/7690982\">this way</a> with Range.Copy and Pasting with Transpose.</li>\n<li>Try using the example of the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel\" rel=\"nofollow noreferrer\">Range.Find Method</a></li>\n<li>If you try to get rid of Select, you should also substitute: <a href=\"https://stackoverflow.com/a/10718179/7690982\">.Select/.Activate/Selection/Activecell/Activesheet/Activeworkbook</a></li>\n</ol>\n"}], "owner": {"reputation": 15, "user_id": 6003781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0340a1913342faa6cfb3fa465cc7f401?s=128&d=identicon&r=PG&f=1", "display_name": "Simi", "link": "https://stackoverflow.com/users/6003781/simi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 46325256, "answer_count": 1, "score": 0, "last_activity_date": 1505919320, "creation_date": 1505918573, "last_edit_date": 1531164843, "question_id": 46325125, "link": "https://stackoverflow.com/questions/46325125/vba-code-pastes-values-in-range-instead-of-whole-column", "title": "vba code. pastes values in range instead of whole column", "body": "<p>Can someone help me with below issue please :)</p>\n\n<p>Issue: I have below code that finds textA in Budget sheet in column A copies that row... finds sheet with same textA and pastes in d4:d15. however it is pasting through out column D instead of just in that range. </p>\n\n<p>Help with : get vba to copy only B:M row range from budget sheet and paste in column d4:d15 only.</p>\n\n<pre><code>Sheets(\"Budget\").Select\nColumns(\"A:A\").Select\nOn Error Resume Next\nSelection.Find(What:=\"phh budget\", After:=ActiveCell, LookIn:= _\nxlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\nxlNext, MatchCase:=False, SearchFormat:=False).Activate\nIf Err.Number = 91 Then\nMsgBox \"ERROR: 'PHH budget' could not be found.\"\nEnd\nEnd If\n\n\nintRow = ActiveCell.Row\nRows(intRow &amp; \":\" &amp; intRow).Copy\nSheets(\"PHH\").Select\nrange(\"D3\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=True\n\nrange(\"B1\").Copy\nApplication.CutCopyMode = False\nSelection.Copy\nrange(\"D3:D15\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlMultiply, _\n    SkipBlanks:=False, Transpose:=False\nColumns(\"D:D\").EntireColumn.AutoFit\n</code></pre>\n\n<p>I appreciate any help. </p>\n"}, {"tags": ["vba", "ms-access", "transactions", "ado"], "comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 1, "creation_date": 1505918606, "post_id": 46325030, "comment_id": 79610877, "body": "You can query <code>Contact Details</code> after you write data to it to return the latest ID value(through an <code>ADODB.RecordSet</code>) and use it in you next <code>INSERT INTO</code> statement"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1505924929, "post_id": 46325030, "comment_id": 79615429, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1628267/autonumber-value-of-last-inserted-row-ms-access-vba\">Autonumber value of last inserted row - MS Access / VBA</a>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505924979, "post_id": 46325030, "comment_id": 79615462, "body": "<a href=\"https://stackoverflow.com/questions/42648/best-way-to-get-identity-of-inserted-row\" title=\"best way to get identity of inserted row\">stackoverflow.com/questions/42648/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 8191040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a272ffce36f88a4879f3eab5fd75c96?s=128&d=identicon&r=PG&f=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/8191040/darren"}, "edited": false, "score": 0, "creation_date": 1506001823, "post_id": 46325030, "comment_id": 79651585, "body": "Thanks for links. In the post  Autonumber value of last inserted row - MS Access / VBA I added the following ater my first .Execute                 Dim rs As New ADODB.Recordset                 Set rs = conn.Execute(&quot;SELECT LAST_INSERT_ID()&quot;, , adCmdText)                 Debug.Print rs.Fields(0).Value however rs.Fields(0).Value returned zero (0)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8191040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a272ffce36f88a4879f3eab5fd75c96?s=128&d=identicon&r=PG&f=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/8191040/darren"}, "is_accepted": false, "score": 0, "last_activity_date": 1506344441, "creation_date": 1506344441, "answer_id": 46405910, "question_id": 46325030, "link": "https://stackoverflow.com/questions/46325030/vba-adodb-transactions/46405910#46405910", "title": "VBA ADODB Transactions", "body": "<p>Thank you for all comments, I continued to have problems however I have come up with this solution which works quite well.</p>\n\n<p>I created a MySQL Stored Procedure:</p>\n\n<pre><code>CREATE  PROCEDURE `SPAddPartnerContact`(IN `PartnerID` INT(8), IN `FirstName` VARCHAR(255), IN `LastName` VARCHAR(255), IN `TelNo` VARCHAR(10), IN `MobileNo` VARCHAR(10), IN `EmailAddress` TEXT, IN `IsPrimaryContact` TINYINT(2), IN `_list` TEXT)\nBEGIN\nDECLARE _next TEXT DEFAULT NULL;\nDECLARE _nextlen INT DEFAULT NULL;\nDECLARE _value TEXT DEFAULT NULL;\nDECLARE _ContactID INT DEFAULT 0;\n\nDECLARE exit handler for sqlexception\n  BEGIN\n    -- ERROR\n  ROLLBACK;\nEND;\n\nDECLARE exit handler for sqlwarning\n BEGIN\n    -- WARNING\n ROLLBACK;\nEND;\n\nSTART TRANSACTION;\n\nINSERT INTO \nContactDetails \n(BP_ID, FirstName, \n LastName, TelNo , \n MobileNo, \n EmailAddress,\n IsPrimaryContact)\nValues \n(PartnerID, \n FirstName, \n LastName, \n TelNo, \n MobileNo,\n EmailAddress, \n IsPrimaryContact);\n\nSET _ContactID = LAST_INSERT_ID();\n\n\niterator:\nLOOP\n  IF LENGTH(TRIM(_list)) = 0 OR _list IS NULL THEN\n    LEAVE iterator;\n  END IF;\n\n  SET _next = SUBSTRING_INDEX(_list,',',1);\n  SET _nextlen = LENGTH(_next);\n  SET _value = TRIM(_next);\n\n  INSERT INTO ReportingType (ReportType, BP_ID, ContactID) VALUES (_next, PartnerID, _ContactID);\n  SET _list = INSERT(_list,1,_nextlen + 1,'');\nEND LOOP;\n\nCOMMIT;\n\n\n\nEND\n</code></pre>\n\n<p>I then Called the Stored Procedure:</p>\n\n<pre><code>Private Sub AddPartnerContact()\nDim ContactID As Long\n\nDim cmdSQL As ADODB.Command\nDim rsAddContact As New ADODB.Recordset\n\nDim bRecordAdded As Boolean\nDim sList As String\nDim delimiter As String\n\ndelimiter = \", \"\n\nOn Error GoTo ErrorHandler\n\n\n    Set cmdSQL = New ADODB.Command\n\n    With cmdSQL\n        .ActiveConnection = Replace(DBEngine.Workspaces(0).Databases(0).TableDefs(\"ContactDetails\").connect, \"ODBC;\", \"\")\n        .CommandType = adCmdStoredProc\n        .CommandText = \"SPAddPartnerContact\"\n        .Parameters.Append .CreateParameter(\"PartnerID\", adInteger, adParamInput, 8, PartnerID)\n        .Parameters.Append .CreateParameter(\"FirstName\", adVarChar, adParamInput, 255, Me.FirstName)\n        .Parameters.Append .CreateParameter(\"LastName\", adVarChar, adParamInput, 255, Me.LastName)\n        .Parameters.Append .CreateParameter(\"TelNo\", adVarChar, adParamInput, 50, Me.TeleNum)\n        .Parameters.Append .CreateParameter(\"MobileNo\", adVarChar, adParamInput, 50, Me.MobileNum)\n        .Parameters.Append .CreateParameter(\"EmailAddress\", adVarChar, adParamInput, 255, Me.EmailAddress)\n        .Parameters.Append .CreateParameter(\"IsPrimaryContact\", adTinyInt, adParamInput, 50, Me.PrimaryContact)\n\n            For i = 1 To ListView1.ListItems.Count\n                If ListView1.ListItems(i).Checked Then\n                    sList = sList &amp; colReportType(ListView1.ListItems(i)) &amp; delimiter\n                End If\n            Next i\n\n             sList = Left(sList, Len(sList) - Len(delimiter))\n\n            .Parameters.Append .CreateParameter(\"_list\", adVarChar, adParamInput, 255, sList)\n\n\n        .Execute\n    End With\n\n\n        '.Close\n\nExitHere:\n    Set conn = Nothing\n\n    If bRecordAdded Then\n        MsgBox \"Contact Added Successfully\", vbOKOnly, \"Contact Maintenance\"\n        Call cmdClose_Click\n    End If\n\n\n    Exit Sub\nErrorHandler:\n    bRecordAdded = False\n    If Err.Number = -2147467259 Then\n        MsgBox Err.Description\n        Resume ExitHere\n    Else\n        MsgBox Err.Description\n\n        Resume ExitHere\n    End If\nEnd Sub\n</code></pre>\n\n<p>Need to do a bit of tidying but I got the result I needed.</p>\n\n<p>Again thank you for taking the time answer my original question.</p>\n\n<p>Darren</p>\n"}], "owner": {"reputation": 1, "user_id": 8191040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a272ffce36f88a4879f3eab5fd75c96?s=128&d=identicon&r=PG&f=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/8191040/darren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2045, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508055188, "creation_date": 1505918292, "last_edit_date": 1508055188, "question_id": 46325030, "link": "https://stackoverflow.com/questions/46325030/vba-adodb-transactions", "title": "VBA ADODB Transactions", "body": "<p>Have an application developed in Access 2010 connected to MySQL Server via ODBC.</p>\n\n<p>I have 2 tables </p>\n\n<p><code>ContactDetails</code> with columns:</p>\n\n<pre><code>ID, FirstName, LastName, TelNo, MobileNo, EmailAddress, PrimaryContact, TimeStamp\n</code></pre>\n\n<p>and <code>ReportingType</code> with columns:</p>\n\n<pre><code>ID, ReportType, ContactID, TimeStamp\n</code></pre>\n\n<p>I'm using a ADO transaction but when inserting into <code>ContactDetails</code>, I need to retrieve the ID so I can insert a corresponding record into <code>ReportingType</code> and set <code>ReportingType.ContactID</code> to be <code>ContactDetails.ID</code>.</p>\n\n<p>In VB.Net I know I can use \"Select LAST_INSERT_ID()\" at the end of the SQL statement and <code>ExecuteScalar</code> will return the auto incremented <code>ID</code>.</p>\n\n<p>Below is my code</p>\n\n<pre><code>Dim conn As ADODB.Connection\n\nOn Error GoTo ErrorHandler\nSet conn = CurrentProject.Connection\n\nWith conn\n\n    .BeginTrans\n\n     'insert a new customer record\n    .Execute \"INSERT INTO ContactDetails (\" &amp; _\n             \"FirstName, \" &amp; _\n             \"LastName , \" &amp; _\n             \"TelNo , \" &amp; _\n             \"MobileNo ,\" &amp; _\n             \"EmailAddress ,\" &amp; _\n             \"IsPrimaryContact) \" &amp; _\n             \"Values ( \" &amp; _\n             \"'\" &amp; Me.FirstName &amp; \"',\" &amp; _\n             \"'\" &amp; Me.LastName &amp; \"',\" &amp; _\n             \"'\" &amp; Me.TeleNum &amp; \"',\" &amp; _\n             \"'\" &amp; Me.MobileNum &amp; \"',\" &amp; _\n             \"'\" &amp; Me.EmailAddress &amp; \"',\" &amp; _\n             False &amp; \");\", , adCmdText + adExecuteNoRecords\n\n            'Added from a possible solution\n            Dim rs As New ADODB.Recordset\n            Set rs = conn.Execute(\"SELECT @@Identity\", , adCmdText)\n            Debug.Print rs.Fields(0).Value  ' This returned 0\n\n        'Inset a new record into the ReportingType Table\n        For i = 1 To ListView1.ListItems.Count\n            If ListView1.ListItems(i).Checked Then\n                 .Execute \"INSERT INTO ReportingType \" &amp; _\n                          \"(ReportType,  ContactID) \" &amp; _\n                          \"VALUES \" &amp; _\n                          \"('\" &amp; colReportType(ListView1.ListItems(i)) &amp; \"' , \" &amp; ContactID &amp; \")\"\n            End If\n\n        Next i\n\n    .CommitTrans\nEnd With\nExitHere:\n    Set conn = Nothing\n    Exit Sub\nErrorHandler:\n    If Err.Number = -2147467259 Then\n        MsgBox Err.Description\n        Resume ExitHere\n    Else\n        MsgBox Err.Description\n        With conn\n            .RollbackTrans\n            '.Close\n        End With\n        Resume ExitHere\n    End If\nEnd Sub\n</code></pre>\n\n<p>Please can you help me with this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505919766, "post_id": 46324993, "comment_id": 79611716, "body": "between the text and code provided, the situation is very unclear."}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505920647, "post_id": 46324993, "comment_id": 79612381, "body": "@ScottHoltzman I&#39;ve edited my post. Hope it makes sense now."}], "answers": [{"comments": [{"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "edited": false, "score": 0, "creation_date": 1505921404, "post_id": 46325866, "comment_id": 79612995, "body": "Thanks it works but it does not keep the formatting."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505922483, "post_id": 46325866, "comment_id": 79613828, "body": "<code>xlPasteValuesAndFormats</code> - I think is the constant. Or add one more line <code>recordSht.Cells(1, lCol + 1).PasteSpecial xlPasteFormats</code>"}, {"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505922738, "post_id": 46325866, "comment_id": 79614009, "body": "@ScottHoltzman is right. Please add one line: recordSht.Cells(1, lCol + 1).PasteSpecial xlPasteFormats"}], "tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1505922709, "last_edit_date": 1505922709, "creation_date": 1505920564, "answer_id": 46325866, "question_id": 46324993, "link": "https://stackoverflow.com/questions/46324993/excel-vba-copy-sheet-without-link-to-original-sheet/46325866#46325866", "title": "Excel VBA Copy Sheet without link to original sheet", "body": "<p>I think you need to paste values on destination:</p>\n\n<pre><code>If CheckForDups Is Nothing Then \n    maxCustomerRng.EntireColumn.Copy \n    recordSht.Cells(1, lCol + 1).PasteSpecial xlPasteValues\n    recordSht.Cells(1, lCol + 1).PasteSpecial xlPasteFormats\nEnd If\n</code></pre>\n\n<p>Hope this help.</p>\n"}], "owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1066, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505922709, "creation_date": 1505918189, "last_edit_date": 1505920597, "question_id": 46324993, "link": "https://stackoverflow.com/questions/46324993/excel-vba-copy-sheet-without-link-to-original-sheet", "title": "Excel VBA Copy Sheet without link to original sheet", "body": "<p>I have two excel files; File_1 and File_2. File_1 has two sheets; Sheet_A and Sheet_B. Data from File_2 is transposed to Sheet_A (in File_1).</p>\n\n<p>I have a vba code attached to a button in Sheet_B that copies data from Sheet_A into Sheet_B. The code works fine, but it keeps the links from File_1. </p>\n\n<p>I would like to just copy the data and keep its formatting without keeping the links. How can I achieve this?</p>\n\n<p>The part of my code that copies the data from Sheet_A into Sheet_B is below:</p>\n\n<pre><code>    ' Check the Record Sheet to ensure the data is not already there\n    Set CheckForDups = recordSht.Range(recordSht.Cells(1, 1), recordSht.Cells(1, lCol)).Find(What:=maxCustomerRng.Offset(-1, 0).Value, LookIn:=xlValues)\n\n    ' If CheckForDups is Nothing then the date was not found on the record sheet. Therefore, copy the column\n    If CheckForDups Is Nothing Then maxCustomerRng.EntireColumn.Copy Before:=recordSht.Cells(1, lCol + 1)\n</code></pre>\n"}, {"tags": ["vba", "double"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1505917800, "post_id": 46324757, "comment_id": 79610250, "body": "first check to see if it is a number <code>If isnumeric(amtc.Value) then</code> then use <code>cdbl(amtc.Value)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8427772, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-AF2pLeSKceE/AAAAAAAAAAI/AAAAAAAAIzk/gUkgmgJTsVc/photo.jpg?sz=128", "display_name": "Sicelo Mpofana", "link": "https://stackoverflow.com/users/8427772/sicelo-mpofana"}, "edited": false, "score": 0, "creation_date": 1505923360, "post_id": 46325006, "comment_id": 79614444, "body": "Thanks gents, I&#39;ll try out both options and see if something works."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1505918692, "last_edit_date": 1505918692, "creation_date": 1505918237, "answer_id": 46325006, "question_id": 46324757, "link": "https://stackoverflow.com/questions/46324757/cant-assign-cell-value-to-double-variable/46325006#46325006", "title": "Can&#39;t assign cell value to double variable", "body": "<p>If <code>amtc.Value</code> contains an <code>Error</code> value, VBA cannot implicitly convert it to a <code>Double</code> (or any other type for that matter).</p>\n\n<p>The value of a cell that contains a <code>#VALUE!</code> error will be seen by VBA as being of a special <code>Error</code> type. You can generate these error values yourself for testing, with the <code>CVErr</code> function:</p>\n\n<pre><code>Debug.Print TypeName(CVErr(xlErrValue))          ' prints \"Error\"\nDebug.Print VarType(CVErr(xlErrValue)) = vbError ' prints \"True\"\n</code></pre>\n\n<p>You can use the <code>IsError</code> VBA function to determine if a <code>Variant</code> contains an <code>Error</code> value:</p>\n\n<pre><code>If Not IsError(amtc.Value) Then amount1(h) = amtc.Value\n</code></pre>\n\n<p>But that can still give you a <em>type mismatch</em> if the <code>Variant</code> contains a non-numeric <code>String</code>, so you can use the <code>IsNumeric</code> VBA function to ensure the type conversion will succeed:</p>\n\n<pre><code>If IsNumeric(amtc.Value) Then amount1(h) = amtc.Value\n</code></pre>\n\n<p>That's still an <em>implicit</em> type conversion though. You can use the <code>CDbl</code> VBA function to <em>explicitly</em> perform the type conversion:</p>\n\n<pre><code>If IsNumeric(amtc.Value) Then amount1(h) = CDbl(amtc.Value)\n</code></pre>\n\n<p>And now you have code that <em>does what it says</em>, and <em>says what it does</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 8427772, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-AF2pLeSKceE/AAAAAAAAAAI/AAAAAAAAIzk/gUkgmgJTsVc/photo.jpg?sz=128", "display_name": "Sicelo Mpofana", "link": "https://stackoverflow.com/users/8427772/sicelo-mpofana"}, "is_accepted": false, "score": 0, "last_activity_date": 1506418160, "creation_date": 1506418160, "answer_id": 46422699, "question_id": 46324757, "link": "https://stackoverflow.com/questions/46324757/cant-assign-cell-value-to-double-variable/46422699#46422699", "title": "Can&#39;t assign cell value to double variable", "body": "<p>Good day Matt &amp; Scott, </p>\n\n<p>I've tried both solutions, one thing that's clear is that it's not Numeric. What is baffling me now is that it's only on negative numbers where I can't format the data type, but it's allowing me to convert the negative number to a string and I'm unable to convert the string to a double.</p>\n\n<p>Hope you guys can shed some light...</p>\n"}], "owner": {"reputation": 5, "user_id": 8427772, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-AF2pLeSKceE/AAAAAAAAAAI/AAAAAAAAIzk/gUkgmgJTsVc/photo.jpg?sz=128", "display_name": "Sicelo Mpofana", "link": "https://stackoverflow.com/users/8427772/sicelo-mpofana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2284, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1506418160, "creation_date": 1505917649, "question_id": 46324757, "link": "https://stackoverflow.com/questions/46324757/cant-assign-cell-value-to-double-variable", "title": "Can&#39;t assign cell value to double variable", "body": "<p>Good afternoon, </p>\n\n<p>I have a sheet of data that has text and number values. I'm trying to assign the values to an array and check if it's within a certain range. Whenever I get a negative number I get a type mismatch error. I'm not sure how else to convert the data to a double data type. Here's a snippet of the code</p>\n\n<pre><code>Sub()\nDim amount1() as double\nDim h as integer \nDim amtc as range, amtr as range\n\n\n      ReDim amount1(AmtR.Cells.Count)\n    For Each amtc In AmtR.Cells\n            h = h + 1\n            amount1(h) = amtc.Value\nend sub\n</code></pre>\n\n<p>Any ideas to assist a brother?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 1, "creation_date": 1505920756, "post_id": 46325783, "comment_id": 79612481, "body": "Actually this code does not loop with all files the folder. It only access the first file. I want it to loop all files in the folder one after another as well."}, {"owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1505973839, "post_id": 46325783, "comment_id": 79632768, "body": "I just need the code to search all files in that folder for the matching data! I am not able to work with the code for that."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1505975167, "post_id": 46325783, "comment_id": 79633362, "body": "To loop over a list of files with the fileSytemObject, see <a href=\"https://stackoverflow.com/a/2683516/7599798\">stackoverflow.com/a/2683516/7599798</a> . Or you could use the VBA <code>dir</code> command"}, {"owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1505975410, "post_id": 46325783, "comment_id": 79633493, "body": "Since I am new to vba I want to know how I can put that code in my code to work properly with the loop."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1505975618, "post_id": 46325783, "comment_id": 79633598, "body": "I would split the code: One sub to loop over the files, and within a loop call another sub (with the filename or an already opened workbook as parameter) that handles the work with one file."}, {"owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1505975794, "post_id": 46325783, "comment_id": 79633687, "body": "I would try this out definitely as per my understanding. But if possible it would be great if you call tell me alterations in my code it would make my life much easier. Thank u."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1505920353, "creation_date": 1505920353, "answer_id": 46325783, "question_id": 46324636, "link": "https://stackoverflow.com/questions/46324636/loop-not-working-between-directories/46325783#46325783", "title": "Loop not working between directories", "body": "<p>I think you have to change the do while to</p>\n\n<pre><code>  Do While .Cells(lRow, 1) &lt;&gt; Empty\n</code></pre>\n\n<p>Explanation: If you use <code>Cells(lRow, 1)</code> (without dot), you access the active sheet. But in the moment you do a <code>workbook.open</code>, the active sheet will change, so at the next iteration you no longer look to the sheet <code>wOut</code> but to a sheet of the opened wokbook.</p>\n\n<p>If you write <code>.Cells(lRow, 1)</code> (with leading dot), <code>Cells</code> is seen as a property of whatever you have used in a <code>with</code>-clause, in your case <code>With wOut</code>. Alternatively, you could write <code>wOut.Cells(lRow, 1)</code> (this is just a matter of taste)</p>\n"}], "owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505920353, "creation_date": 1505917316, "last_edit_date": 1505918557, "question_id": 46324636, "link": "https://stackoverflow.com/questions/46324636/loop-not-working-between-directories", "title": "Loop not working between directories", "body": "<p>I worked around with a vba code to search a list of cells in a column of a workbook and those cells need to be searched in a folder and if cell is matched in any of the workbook all corresponding data needs to be copied to the main workbook.</p>\n\n<p>I was working with 2 loops but if one is working another one is not for example if I loop through all files in a folder I can't loop with the column in the main workbook to search one cell after another.</p>\n\n<p>Below is the code:</p>\n\n<pre><code>Sub SearchFolders()\n    Dim fso As Object\n    Dim fld As Object\n    Dim strSearch As String\n    Dim strPath As String\n    Dim strFile As String\n    Dim wOut As Worksheet\n    Dim wbk As Workbook\n    Dim wks As Worksheet\n    Dim rFound As Range\n    Dim irow As Integer\n    Dim rng As Range\n    Dim strFirstAddress As String\n\n    On Error GoTo ErrHandler\n    Application.ScreenUpdating = False\n    strPath = \"\\dfs\\Home\\Tes\"\n\n    Set wOut = ThisWorkbook.Worksheets(\"Data\")\n\n    With wOut\n    lRow = 2\n        Set fso = CreateObject(\"Scripting.FileSystemObject\")\n        Set fld = fso.GetFolder(strPath)\n\n        strFile = Dir(strPath &amp; \"\\*.xls*\")\n\n        Do While Cells(lRow, 1) &lt; Empty\n            strSearch = Cells(lRow, 1)\n            Set wbk = Workbooks.Open _\n                (Filename:=strPath &amp; \"\\\" &amp; strFile, _\n                UpdateLinks:=0, _\n                ReadOnly:=True, _\n                AddToMRU:=False)\n\n            For Each wks In wbk.Worksheets\n                Set rFound = wks.UsedRange.Find(strSearch)\n                If Not rFound Is Nothing Then\n                    strFirstAddress = rFound.Address\n                End If\n                Do\n                    If rFound Is Nothing Then\n                        Exit Do\n                     Else\n                        Cells(lRow, 2) = rFound.Offset(0, 1).Value\n                        Cells(lRow, 3) = rFound.Offset(0, 2).Value\n                    End If\n                    Set rFound = wks.Cells.FindNext(After:=rFound)\n                Loop While strFirstAddress &lt; rFound.Address\n            Next\n\n            wbk.Close (False)\n            lRow = lRow + 1\n        Loop\n    End With\n    MsgBox \"Done\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1505917596, "post_id": 46324631, "comment_id": 79610111, "body": "If you actually have Strings with leading zeroes, that should load into the array just fine. If you have numbers formatted to display leading zeroes, you&#39;ll need to loop, unless there is a consistent format to the data."}, {"owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1505917883, "post_id": 46324631, "comment_id": 79610304, "body": "There is a consistent format. They are all 10 digit numbers that may or may not have leading zeros. However, it&#39;s really strange, changing the format of the column to text does nothing but if you edit one of the values, even if you don&#39;t change anything, it gets that green triangle in the corner that means <code>Number Stored as Text</code> and after that point it automatically saves as a string in the array. But I need a way to programmatically force them to always be strings."}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1505918422, "post_id": 46324631, "comment_id": 79610722, "body": "Because the value in the Excel cell is a number, it will be saved as a number value in the array. When the number is stored as a text in Excel, this will store as a string in the array.  As far as Excel is concerned, &quot;000050&quot; and 000050 are two different values."}, {"owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "edited": false, "score": 0, "creation_date": 1505918455, "post_id": 46324631, "comment_id": 79610745, "body": "Yes, I am aware of that. That&#39;s the purpose of my question, I need to know how to make it not do that."}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1505918552, "post_id": 46324631, "comment_id": 79610827, "body": "I believe <code>B</code> is not possible. Thus <code>A</code> shouldn&#39;t be an issue as you anyway have to loop to convert to String array(just make a 10 length string everytime)"}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1505918670, "post_id": 46324631, "comment_id": 79610910, "body": "Even if you don&#39;t mind formatting the worksheet via <code>Range(&quot;A1:A10&quot;).NumberFormat=&quot;@&quot;</code>, you will have to use loops to reformat the cell.  VBA is okay but there&#39;s a lot missing from it compared to modern languages."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1505919131, "post_id": 46324631, "comment_id": 79611258, "body": "If you use <code>.Text</code> instead of <code>.Value2</code> it will preserve the leading 0&#39;s. (but it&#39;s slower)"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505919665, "post_id": 46324631, "comment_id": 79611640, "body": "@brax +1 it should be better than handling the messy details with String handling in VBA."}, {"owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "edited": false, "score": 0, "creation_date": 1505921530, "post_id": 46324631, "comment_id": 79613120, "body": "It doesn&#39;t work if you change it to <code>.Text</code> it always gets a Type Mismatch Error"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1505922534, "post_id": 46324631, "comment_id": 79613869, "body": "For multiple cells, <code>.Text</code> returns <code>Null</code> if they don&#39;t all have exactly the same <i>displayed</i> value, and a single value, rather than an array, if they do."}], "answers": [{"comments": [{"owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "edited": false, "score": 0, "creation_date": 1505921688, "post_id": 46326255, "comment_id": 79613239, "body": "I haven&#39;t tested it yet but this looks like the answer I was looking for."}, {"owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "edited": false, "score": 0, "creation_date": 1505922142, "post_id": 46326255, "comment_id": 79613588, "body": "Now I&#39;ve tested it and yes, this is the simplest answer as long as there&#39;s a consistent format."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1505921643, "creation_date": 1505921643, "answer_id": 46326255, "question_id": 46324631, "link": "https://stackoverflow.com/questions/46324631/how-to-grab-a-large-array-of-cells-quickly-and-preserve-leading-zeros-excel-vb/46326255#46326255", "title": "How to grab a large array of cells quickly and preserve leading zeros - Excel VBA", "body": "<p>Since they are all the same format, you can use a simple <code>Evaluate</code> call:</p>\n\n<pre><code>Dim primaryArray As Variant\nprimaryArray As Variant = ActiveSheet.Evaluate(\"INDEX(TEXT(A2:A276000,\"\"0000000000\"\"),)\")\n</code></pre>\n"}], "owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 46326255, "answer_count": 1, "score": 1, "last_activity_date": 1505923964, "creation_date": 1505917308, "last_edit_date": 1531164843, "question_id": 46324631, "link": "https://stackoverflow.com/questions/46324631/how-to-grab-a-large-array-of-cells-quickly-and-preserve-leading-zeros-excel-vb", "title": "How to grab a large array of cells quickly and preserve leading zeros - Excel VBA", "body": "<p>Grabbing a large range of cells and moving them into an array isn't very difficult with the <code>Variant</code> data type:</p>\n\n<pre><code>Dim primaryArray As Variant\nprimaryArray = Range(\"A2:A276000\").Value2\n</code></pre>\n\n<p>However, I require the array to contain strings that may or may not have leading zeros and I can't figure out how to control what kind of variable the variant array saves as.</p>\n\n<p>Of course I could convert the array to a string array afterwards:</p>\n\n<pre><code>Dim sPrimaryArray() As String\nReDim sPrimaryArray(LBound(primaryArray) To UBound(primaryArray)) As String\nFor i = LBound(primaryArray) To UBound(primaryArray)\n    sPrimaryArray(i) = CStr(primaryArray(i, 1))\nNext\n</code></pre>\n\n<p>Unfortunately, in my case, leading zeros must be preserved. When the variant array automatically saves as a <code>Double</code> (as it does in this case) it deletes the leading zeros, so converting to a string after this is pointless because I've lost the leading zeros that I needed to match the string reliably.</p>\n\n<p>Furthermore, this requires looping which is something I rather try to avoid. With over 200,000 entries, looping can take a long time.</p>\n\n<p>Is there any possible way to:</p>\n\n<ul>\n<li>A. Force a variant array to use the string data type</li>\n<li>B. Convert a range of cells directly to a string array without looping</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1505917107, "post_id": 46324534, "comment_id": 79609756, "body": "start the recorder, copy the second group under the first then sort on column B."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8614694, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oemdv.png?s=128&g=1", "display_name": "Arthur A", "link": "https://stackoverflow.com/users/8614694/arthur-a"}, "edited": false, "score": 0, "creation_date": 1505917994, "post_id": 46324666, "comment_id": 79610399, "body": "Actually, I&#39;m feeling really dumb right now. I solved it just by using the sort option on Excel. But I&#39;ve tried your answer and it worked too. Thank you!"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1505917404, "creation_date": 1505917404, "answer_id": 46324666, "question_id": 46324534, "link": "https://stackoverflow.com/questions/46324534/merge-rows-from-different-columns-in-excel/46324666#46324666", "title": "Merge rows from different columns in Excel", "body": "<p>Copy D:F down below A:C and then sort them seems the simplest solution:</p>\n\n<pre><code>  Sub Demo\n   Range(\"D2:F\" &amp; range(\"F2\").end(xldown).row).copy Range(\"A1\").End(xldown).Offset(1,0)\n\n Range(\"A1\").CurrentRegion.Sort Key1:=range(\"b1\"),Key2:=range(\"a1\")\n  End Sub\n</code></pre>\n\n<p>This assumes that both D and F have no blank cells until the bottom</p>\n"}], "owner": {"reputation": 5, "user_id": 8614694, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oemdv.png?s=128&g=1", "display_name": "Arthur A", "link": "https://stackoverflow.com/users/8614694/arthur-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 46324666, "answer_count": 1, "score": 0, "last_activity_date": 1505917404, "creation_date": 1505917049, "last_edit_date": 1531161705, "question_id": 46324534, "link": "https://stackoverflow.com/questions/46324534/merge-rows-from-different-columns-in-excel", "title": "Merge rows from different columns in Excel", "body": "<p>I have some columns in excel and I need to merge their rows together as the example below:</p>\n\n<p>Current file:</p>\n\n<pre><code>column A | column B | column C | column D | column E | column F\n001001     Adam          20      001002     Adam       1.2\n001001     Brian         21      001002     Brian      1.5\n001001     Cameron       25      001002     Cameron    1.1\n001001     Daniel        18      001002     Daniel     1.8\n001001     Edward        19      001002     Edward     2.3\n</code></pre>\n\n<p>Objective:</p>\n\n<pre><code>column A | column B | column C\n001001     Adam          20   \n001002     Adam          1.2\n001001     Brian         21   \n001002     Brian         1.5\n001001     Cameron       25   \n001002     Cameron       1.1\n001001     Daniel        18   \n001002     Daniel        1.8\n001001     Edward        19   \n001002     Edward        2.3\n</code></pre>\n\n<p>Is this possible? I'm starting to learn VBA so I'm stuck with this problem.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1505916989, "post_id": 46324253, "comment_id": 79609676, "body": "You cannot offset the row on full column references.  You will need to find the last row with data, limit your range to that then you can use the offset."}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1505918326, "post_id": 46324253, "comment_id": 79610645, "body": "The format for Offset is usually something like:  <code>Range(&quot;B1&quot; ).Offset(9, 0) = Value</code>  where 9 is rows and 0 is columns."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1505925186, "last_edit_date": 1505925186, "creation_date": 1505924813, "answer_id": 46327247, "question_id": 46324253, "link": "https://stackoverflow.com/questions/46324253/offset-individual-copied-columns-with-vba/46327247#46327247", "title": "Offset individual copied columns with VBA", "body": "<p>As Scott and Mitch pointed out, you would need to have a selected range with a defined start and finish row/column.  </p>\n\n<p>You can do this with some dynamic code (per source sheet/column) with code similar to:</p>\n\n<pre><code>Dim LR as Long, col1 as String\ncol1 = \"C\" 'Change to whatever column you want to focus\nWith Sheets(\"NAME1\")\n    LR = .Cells(.Rows.Count, col1).End(xlUp).Row\nEnd With\n</code></pre>\n\n<p>You can then move the data using the now defined LR (LR = last row):</p>\n\n<pre><code>With Sheets(\"NAME1\")\n    .Range( .Cells(1, col1), .Cells(LR, col1)).Copy Sheets(\"NAME2\").Cells(9,\"D\")\nEnd With\n</code></pre>\n\n<p>You only need to specify the upper left cell when pasting into a destination range.</p>\n"}], "owner": {"reputation": 193, "user_id": 5695578, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/akgRP.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5695578/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505925186, "creation_date": 1505916279, "last_edit_date": 1531164843, "question_id": 46324253, "link": "https://stackoverflow.com/questions/46324253/offset-individual-copied-columns-with-vba", "title": "Offset individual copied columns with VBA", "body": "<p>I am copying a set of individual columns from one workbook and pasting them to another. I want to offset what row my data is copied to (for example down 9 rows). I've tried to use the property:</p>\n\n<pre><code>.Offset()\n</code></pre>\n\n<p>But I don't know how to add it to my existing code.</p>\n\n<pre><code>Sub T1()\nDim sourceTitle As Range, targetTitle As Range\n\nSet sourceTitle = Workbooks(\"Data to Copy.xlsm\").Worksheets(2).Columns(\"B\")\nSet targetTitle = Workbooks(\"Data Destination.xlsm\").Worksheets(1).Columns(\"C\")\n\nSet sourceProject = Workbooks(\"Data to Copy.xlsm\").Worksheets(2).Columns(\"C\")\nSet targetProject = Workbooks(\"Data \nDestination.xlsm\").Worksheets(1).Columns(\"D\")\n\nSet sourcePM = Workbooks(\"Data to Copy.xlsm\").Worksheets(2).Columns(\"D\")\nSet targetPM = Workbooks(\"Data Destination.xlsm\").Worksheets(1).Columns(\"I\")\n\nSet sourceBusiness = Workbooks(\"Data to Copy.xlsm\").Worksheets(2).Columns(\"E\")\nSet targetBusiness = Workbooks(\"Data Destination.xlsm\").Worksheets(1).Columns(\"K\")\n\nSet sourceHigh = Workbooks(\"Data to Copy.xlsm\").Worksheets(2).Columns(\"F\")\nSet targetHigh = Workbooks(\"Data Destination.xlsm\").Worksheets(1).Columns(\"L\")\n\nSet sourceE0 = Workbooks(\"Data to Copy.xlsm\").Worksheets(2).Columns(\"G\")\nSet targetE0 = Workbooks(\"Data Destination.xlsm\").Worksheets(1).Columns(\"S\")\n\nSet sourceActual = Workbooks(\"Data to Copy.xlsm\").Worksheets(2).Columns(\"H\")\nSet targetActual = Workbooks(\"Data Destination.xlsm\").Worksheets(1).Columns(\"V\")\n\nsourceTitle.Copy Destination:=targetTitle\nsourceProject.Copy Destination:=targetProject\nsourcePM.Copy Destination:=targetPM\nsourceBusiness.Copy Destination:=targetBusiness\nsourceHigh.Copy Destination:=targetHigh\nsourceE0.Copy Destination:=targetE0\nsourceActual.Copy Destination:=targetActual\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement", "nested-loops"], "comments": [{"owner": {"reputation": 1956, "user_id": 4429015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqxqf.png?s=128&g=1", "display_name": "B001\u16e6", "link": "https://stackoverflow.com/users/4429015/b001%e1%9b%a6"}, "edited": false, "score": 0, "creation_date": 1505916126, "post_id": 46324159, "comment_id": 79609055, "body": "Get rid of the nested thing. Put code in functions instead"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1505916593, "post_id": 46324159, "comment_id": 79609393, "body": "Are you sure that the cells contain a dash or hyphen <code>-</code>? Or is this only the <code>.NumberFormat=&quot;0;-0;&quot;&quot;-&quot;&quot;&quot;</code> which is showing zero values as <code>-</code>? If so, then you might want to change the <code>If</code> statement to look for zero values."}], "owner": {"reputation": 62, "user_id": 8599937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42fcc5aeaa42de043320b7d61286824?s=128&d=identicon&r=PG&f=1", "display_name": "Samppa", "link": "https://stackoverflow.com/users/8599937/samppa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1541, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505918005, "creation_date": 1505916051, "last_edit_date": 1505918005, "question_id": 46324159, "link": "https://stackoverflow.com/questions/46324159/nested-if-statement-inside-for-loops-in-vba", "title": "Nested IF statement inside For loops in VBA", "body": "<p>My other macro scrapes mutual fund sizes from web and returns the values in <code>Worksheets(\"Updater\").Cells(xx,4)</code> (so column C). The macro scrapes also the date in which the fund has been updated on morningstar and returns it in column F on the same sheet. I've got 83 fund names in column A.</p>\n\n<p>On a sheet called \"Tracker\" I've got the fund names transposed. They start from cell (1,4) and go to (1,86). In column B I've got DATEVALUE of dates in column C. There're some issues with the date formats so I'll just hide the column B later.</p>\n\n<p>The below macro works as it is, but when you uncomment lines 11 and 22, it doesn't work as intended anymore. Idea is to look at the fund sizes on sheet \"Updater\" and return the fund size to the corresponding date on sheet \"Tracker\". As said, this works.</p>\n\n<p>However, with the nested if statement, I'd want to modify the macro so it would keep all the cells that contain other than \"-\" untouched. This way I would start to cumulate the fund size data when the macro is executed on a daily basis and doesn't overwrite the old fund sizes with \"-\".</p>\n\n<p>Now the macro flips the funds who knows where and I simply can't solve this nested if statement problem. Is this even the correct/best way to get where I want?</p>\n\n<pre><code>Sub fundSizeTracker()\n\nDim f       As Integer\nDim numRows As Integer\n\nnumRows = 86\nf = 2         'Sheet  fund names &amp; sizes\n\nFor m = 2 To 4 'Sheet  row number, starting at rowNo 2\n    For i = 4 To numRows 'Sheet  column number (set to include all 83 funds)\n        '                    If Worksheets(\"Tracker\").Cells(m, i) = \"-\" Then\n        '               Are Datevalues same?                'Tracker datevalue                        'Updater datevalue\n        If StrComp(Worksheets(\"Tracker\").Cells(m, 2).Value, Worksheets(\"Updater\").Cells(f, 13).Value) = 0 Then\n            Worksheets(\"Tracker\").Cells(m, i) = Worksheets(\"Updater\").Cells(f, 4).Value\n        Else\n            Worksheets(\"Tracker\").Cells(m, i) = \"-\"\n        End If\n        If f = numRows - 1 Then\n            f = 2\n        End If\n        f = f + 1\n        '                    End If\n    Next i\nNext m\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505915793, "post_id": 46323958, "comment_id": 79608794, "body": "removed formula tag since there are no formulas in this question (only VBA procedures and functions)."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1505915833, "creation_date": 1505915833, "answer_id": 46324072, "question_id": 46323958, "link": "https://stackoverflow.com/questions/46323958/extracting-numerical-cell-based-on-color-to-another-sheet/46324072#46324072", "title": "Extracting numerical cell based on color to another sheet", "body": "<p>Try this (arbitrary start column for source range and arbitrary Destination range):</p>\n\n<pre><code>If prange.Cells.Font.ColorIndex=33 Then\n     Sheets(\"NAME\").Cells(blah, 1).Copy Sheets(\"NAME2\").Cells(moo, rawr)\nEnd If\n</code></pre>\n\n<p>You would want this within your loop so that each value as it iterates through the cells and copy/pastes if true.</p>\n"}, {"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 19, "user_id": 8614725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab5ccfc6355887a6184e4e34debd17b1?s=128&d=identicon&r=PG&f=1", "display_name": "leoj", "link": "https://stackoverflow.com/users/8614725/leoj"}, "edited": false, "score": 0, "creation_date": 1506517126, "post_id": 46324176, "comment_id": 79852615, "body": "Please ask another question @leoj. It will be cleaner and clearer that way."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1505916104, "creation_date": 1505916104, "answer_id": 46324176, "question_id": 46323958, "link": "https://stackoverflow.com/questions/46323958/extracting-numerical-cell-based-on-color-to-another-sheet/46324176#46324176", "title": "Extracting numerical cell based on color to another sheet", "body": "<p>If I understand correctly, it's simpler than originally written.</p>\n\n<pre><code>Option Explicit\n\nSub TickerExtract()\n\n    Dim rngTicker As Range\n    Set rngTicker = Worksheets(\"Tickers\").Range(\"B1:B100\") 'change as needed, assumes value in column B\n\n    Dim rngCel As Range\n\n    For Each rngCel In rngTicker\n\n        If rngCel.Font.ColorIndex = 33 Then\n\n           'change name as needed and column references\n            Worksheets(\"Other\").Cells(Rows.Count, 1).End(xlUp).Offset(1).Resize(1, 2).Value = Array(rngCel.Offset(, -1).Value, rngCel.Value)\n\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8614725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab5ccfc6355887a6184e4e34debd17b1?s=128&d=identicon&r=PG&f=1", "display_name": "leoj", "link": "https://stackoverflow.com/users/8614725/leoj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 46324176, "answer_count": 2, "score": 0, "last_activity_date": 1505916104, "creation_date": 1505915504, "last_edit_date": 1531161705, "question_id": 46323958, "link": "https://stackoverflow.com/questions/46323958/extracting-numerical-cell-based-on-color-to-another-sheet", "title": "Extracting numerical cell based on color to another sheet", "body": "<p>If the number is Light-blue Id like to extract the value with the name (column A is the name) to another sheet.</p>\n\n<p>So far I have a working formula that extracts the numerical value. I'm just having trouble extracting the number and name to another sheet, which is the second formula that I have listed. I'd also like to learn what each line of code does. \nAnything is appreciated, thanks for your help</p>\n\n<pre><code>Function GetColorNum(prange As Range) As Double\n Dim xOut As Double\n Dim i As Long\n\n For i = 1 To 100\n\n    If prange.Cells.Font.ColorIndex = 33 Then\n    xOut = prange.Value\n\n    End If\n\nNext\nGetColorNum = xOut\n\nEnd Function\n\n\nSub tickerextract()\nDim c As Range\nDim ticker As String\n\n    If GetColorNum = True Then\n        Cells(i, 1).EntireRow.Copy\n            c.offset(0, 1) = ticker\n\nNext c\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1505915437, "post_id": 46323576, "comment_id": 79608539, "body": "Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a>. You have not actually asked any question here. And its better to focus a question to <i>one specific issue</i>, not several."}, {"owner": {"reputation": 11, "user_id": 8641501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d34f5e51452b55f961b02fd97fd07c94?s=128&d=identicon&r=PG&f=1", "display_name": "L.B.", "link": "https://stackoverflow.com/users/8641501/l-b"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505917279, "post_id": 46323576, "comment_id": 79609879, "body": "Hi thanks for your comment...the question is (in other words): how to fix the code in order to be able to copy the range  D26:P26 from Sheet2 and paste it in the next cell where the text in C21 from Sheet2 was found. Thanks again! /// I think my mistake is in this line: Worksheets(&quot;TRY Data&quot;).ActiveCell.Offset(0, 1).PasteSpecial xlPasteValues"}, {"owner": {"reputation": 11, "user_id": 8641501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d34f5e51452b55f961b02fd97fd07c94?s=128&d=identicon&r=PG&f=1", "display_name": "L.B.", "link": "https://stackoverflow.com/users/8641501/l-b"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505920508, "post_id": 46323576, "comment_id": 79612288, "body": "@Nikolaos Polygenis, thank you for answering so quickly :) however the range is not pasted in the next column where the cell with the matching text is...right now the range is pasted in the following column where the active cell is...and that cell can be anywhere I click before running the macro. Please help :("}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1505922784, "post_id": 46323576, "comment_id": 79614044, "body": "<b>Try replacing</b> <code>ActiveCell.Offset(0, 1).PasteSpecial Paste:=xlPasteValues</code> <b>with</b> <code>Range(&quot;D&quot; &amp; rng1.row).PasteSpecial Paste:=xlPasteValues</code> <b>or whatever column you want to use.</b>"}], "answers": [{"comments": [{"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "edited": false, "score": 0, "creation_date": 1505977859, "post_id": 46324029, "comment_id": 79634794, "body": "@Nikolaos Polygenis, thank you for answering so quickly :) however the range is not pasted in the next column where the cell with the matching text is...right now the range is pasted in the following column where the active cell is...and that cell can be anywhere I click before running the macro. Please help :( \u2013 L.B. 15 hours ago......  ok i didnt understand that you want this please wait .."}], "tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": false, "score": 0, "last_activity_date": 1505978453, "last_edit_date": 1505978453, "creation_date": 1505915706, "answer_id": 46324029, "question_id": 46323576, "link": "https://stackoverflow.com/questions/46323576/find-a-text-c21-from-sheet2-in-sheet1-and-then-copy-a-fixed-range-from-sheet2/46324029#46324029", "title": "Find a text (C21) from Sheet2 in Sheet1 and then copy a fixed range from Sheet2 into the next cell where text was found in Sheet1", "body": "<p>Please try:( I add you code in comment for the pivot.. workbook_pivot_exists is the workbook where your pivot is)</p>\n\n<pre><code> Option Explicit\n\nSub Save2()\n    Dim strSearch As String\n\n    strSearch = Worksheets(\"TRY graph\").Range(\"C21\").Value &amp; \" C-2018\"\n\n    Dim rng1 As Range\n\n    Dim adrs As String\n\n    Set rng1 = Worksheets(\"TRY Data\").Range(\"C:C\").Find(strSearch, lookat:=xlPart)\n\n\n\n    If Not rng1 Is Nothing Then\n\n    adrs = rng1.Address\n\n    Sheets(\"TRY graph\").Range(\"D26:P26\").Copy\n\n\n    With Sheets(\"TRY Data\")\n\n\n\n     .Range(adrs).Offset(0, 1).PasteSpecial Paste:=xlPasteValues\n\n\n    End With\n\n    Else\n\n        MsgBox strSearch &amp; \" not found\"\n\n    End If\n\nDim pivotTable As pivotTable\n\n'to refresh your pivot try:\n'Set pivotTable = whorkbook_pivot_exists.PivotTables(\"myPivot\")\n\n\n'pivotTable.RefreshTable\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8641501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d34f5e51452b55f961b02fd97fd07c94?s=128&d=identicon&r=PG&f=1", "display_name": "L.B.", "link": "https://stackoverflow.com/users/8641501/l-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505978453, "creation_date": 1505914536, "last_edit_date": 1505918991, "question_id": 46323576, "link": "https://stackoverflow.com/questions/46323576/find-a-text-c21-from-sheet2-in-sheet1-and-then-copy-a-fixed-range-from-sheet2", "title": "Find a text (C21) from Sheet2 in Sheet1 and then copy a fixed range from Sheet2 into the next cell where text was found in Sheet1", "body": "<p>I am learning-while-doing macros, I am new with this so thank you very much for your help :)</p>\n\n<p>I am trying to create a macro that:</p>\n\n<ol>\n<li>reads a text in one cell in Sheet2 (cell C21)</li>\n<li>looks for it in Sheet 1 (column C)</li>\n<li>copy a fixed range in Sheet2 (D26:P26)</li>\n<li>Paste the info from the next cell where the text was found in Sheet 1 (so if for example in #2 the text was found in the cell C23...the copied info is paste from D23 on)</li>\n<li>refresh a pivot table in Sheet2</li>\n<li>refresh a graph on Sheet2</li>\n</ol>\n\n<p>Sheet 1= TRY Data</p>\n\n<p>Sheet 2= TRY graph</p>\n\n<p>This is the macro I  have came up until now...finds the text, nows where it is but does not paste the info (and does not have how to update the graph). Once again thank you very much! :)</p>\n\n<pre><code>Sub Save2()\n\n    Dim strSearch As String\n\n    strSearch = Worksheets(\"TRY graph\").Range(\"C21\").Value &amp; \" C-2018\"\n\n    Dim rng1 As Range\n\n    Set rng1 = Worksheets(\"TRY Data\").Range(\"C:C\").Find(strSearch, &gt;lookat:=xlPart)\n\n    If Not rng1 Is Nothing Then\n\n       Worksheets(\"TRY graph\").Range(\"D26:P26\").Copy\n\n       Worksheets(\"TRY Data\").ActiveCell.Offset(0, 1).PasteSpecial &gt;xlPasteValues\n    Else\n\n       MsgBox strSearch &amp; \" not found\"\n    End If\n\n    Dim pivotTable As pivotTable\n\n    pivotTable.RefreshTable\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 4, "creation_date": 1505914520, "post_id": 46323528, "comment_id": 79607804, "body": "The way the code is written, you can simply delete the <code>ThisWorkbook.Sheet1.Activate</code> line. It&#39;s not necessary to <code>Activate</code> a sheet to work with its member objects. It is best practice however, to qualify the objects you are working with. For example, change <code>Cells(i, &quot;M&quot;)</code> to <code>Sheet3.Cells(i, &quot;M&quot;)</code>. Use of <code>Sheet1</code> and <code>Sheet1</code> assume VBA sheet object name, which is different syntax than <code>Worksheets(&quot;Sheet1</code>&quot;)`"}], "answers": [{"comments": [{"owner": {"reputation": 369, "user_id": 5595128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10207810805730539/picture?type=large", "display_name": "Mikkel Astrup", "link": "https://stackoverflow.com/users/5595128/mikkel-astrup"}, "edited": false, "score": 0, "creation_date": 1505978768, "post_id": 46324415, "comment_id": 79635399, "body": "Amazing, thanks for the help both of you! Using set sht=ThisWorkbook and removing activate solved the problems! :)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1505917040, "last_edit_date": 1505917040, "creation_date": 1505916682, "answer_id": 46324415, "question_id": 46323528, "link": "https://stackoverflow.com/questions/46323528/thiswoorkbook-runtime-error-438/46324415#46324415", "title": "ThisWoorkbook runtime Error 438", "body": "<p><code>Sheet1</code> isn't a member of <code>ThisWorkbook</code>. <code>ThisWorkbook</code> is a <code>Workbook</code> instance, and <code>Workbook</code> objects don't expose \"dynamic members\" for every worksheet in their <code>Worksheets</code> collection. Hence error 438, <em>Object does not support property or method</em>.</p>\n\n<p><code>Sheet1</code> is [I presume] the <code>CodeName</code> of a worksheet in <code>ThisWorkbook</code>: it's a global-scope <code>Worksheet</code> object VBA conveniently creates, named after the <code>(Name)</code> property of the document module.</p>\n\n<p>That <code>Sheet1</code> object has a <code>Parent</code> property; like every <code>Worksheet</code> object, it <em>already</em> knows what <code>Workbook</code> instance it belongs to:</p>\n\n<pre><code>Debug.Print Sheet1.Parent Is ThisWorkbook\n</code></pre>\n\n<p>IntelliSense has been trying to tell you that (by <em>not</em> listing a <code>Sheet1</code> member) - listen to what it says!</p>\n\n<hr>\n\n<p>That said, fixing the instruction like this:</p>\n\n<pre><code>Sheet1.Activate\n</code></pre>\n\n<p>...doesn't solve <em>the other problem</em>: you're using <code>Activate</code> only so that the unqualified <code>Cells</code> calls can refer to that specific worksheet:</p>\n\n<blockquote>\n<pre><code>For i = 1 To lastrow\n    If Len(Cells(i, \"M\")) &lt;&gt; 0 Then\n        dictionary.Add Cells(i, \"M\").Value, 1\n    End If\nNext\n</code></pre>\n</blockquote>\n\n<p>Instead, <em>qualify them</em>:</p>\n\n<pre><code>For i = 1 To lastrow\n    If Len(Sheet1.Cells(i, \"M\")) &lt;&gt; 0 Then\n        dictionary.Add Sheet1.Cells(i, \"M\").Value, 1\n    End If\nNext\n</code></pre>\n\n<p>And then the <code>Activate</code> call becomes completely useless.</p>\n\n<p>These implicit <code>ActiveSheet</code> references can be easy to introduce, and hard to spot. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> (an open-source VBE add-in project I manage) can help you locate them (and other things):</p>\n\n<p><img src=\"https://i.stack.imgur.com/BRDPi.png\" alt=\"&quot;Implicit reference to ActiveSheet&quot; inspection results\"></p>\n"}], "owner": {"reputation": 369, "user_id": 5595128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10207810805730539/picture?type=large", "display_name": "Mikkel Astrup", "link": "https://stackoverflow.com/users/5595128/mikkel-astrup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 46324415, "answer_count": 1, "score": 2, "last_activity_date": 1505917040, "creation_date": 1505914392, "question_id": 46323528, "link": "https://stackoverflow.com/questions/46323528/thiswoorkbook-runtime-error-438", "title": "ThisWoorkbook runtime Error 438", "body": "<p>I have a VBA to copy and paste unique values from Sheet1 onto Sheet3. However i get the runtime error 438 when i run the VBA. \nMy VBA looks like this: </p>\n\n<pre><code>Sub UniqueList()\n\nApplication.ScreenUpdating = False\nDim lastrow As Long\nDim i As Long\nDim dictionary As Object\nSet dictionary = CreateObject(\"scripting.dictionary\")\n\nThisWorkbook.Sheet1.Activate\nlastrow = Sheet1.Cells(Rows.Count, \"M\").End(xlUp).Row\n\nOn Error Resume Next\nFor i = 1 To lastrow\n    If Len(Cells(i, \"M\")) &lt;&gt; 0 Then\n        dictionary.Add Cells(i, \"M\").Value, 1\n    End If\nNext\n\nSheet3.Range(\"a2\").Resize(dictionary.Count).Value = _\nApplication.Transpose(dictionary.keys)\n\nApplication.ScreenUpdating = True\nMsgBox dictionary.Count &amp; \" unique cell(s) were found and copied.\"\n\nEnd Sub\n</code></pre>\n\n<p>The line that gets the error is: </p>\n\n<pre><code>ThisWorkbook.Sheet1.Activate\n</code></pre>\n\n<p>I run the VBA using a button from Sheet3. But i also tried running it using AltF8 and AltF11 with sheet1 open, nothing works. </p>\n\n<p>Im not really sure why i get that error so i hope that there is a person who can help with a solution </p>\n"}, {"tags": ["ms-access", "combobox", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1505913478, "post_id": 46323049, "comment_id": 79606958, "body": "Maybe you need a Requery? Also, if that event isn&#39;t working try the <code>Change</code> Event"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1505914279, "post_id": 46323049, "comment_id": 79607614, "body": "I can&#39;t replicate this behavior with the data you provided (combo boxes instantly clear when the AferUpdate event fires when I try this). Note that the AfterUpdate event fires when either changing a combo box through the dropdown, or when you tab out of a combo box you changed through typing. Can you please provide more details?"}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1505917292, "post_id": 46323817, "comment_id": 79609897, "body": "I doubt that solves the problem the OP is having, since (at least in my setup) <code>&quot;&quot;</code> or <code>&quot; &quot;</code> or <code>0</code> all are set instanly too. Yes, setting them to <code>Null</code> is better, but if you think this fixes the OPs problem, please explain why, else, comment. My best guess is that the <code>On Update</code> function fires late in the OPs setup, in which case this will make no difference, but as said, can&#39;t replicate so can&#39;t test"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1505917669, "post_id": 46323817, "comment_id": 79610162, "body": "This should work in the after update of the first combo box, I suspect his use of the field names rather than the referring to the current forms control object by using Me. is the cause of his problem, so I think my answer still stands."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1505918084, "post_id": 46323817, "comment_id": 79610457, "body": "That&#39;s useful information to include in the answer (it will help the user avoid the error again, and it&#39;s useful to know the <code>Me.</code> is the relevant part, and not the <code>Null</code>). I doubt it&#39;s true, though, since the <code>Me.</code> can be omitted if there are no conflicting variables (just like <code>Application.</code> in most situations), and if there were, you would probably not get this behavior (the code working, but just late). But as said, can&#39;t replicate so can&#39;t test, we will have to wait for the OP."}, {"owner": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "edited": false, "score": 0, "creation_date": 1506441657, "post_id": 46323817, "comment_id": 79819389, "body": "@Minty: Sorry for late reply. The name and control source got different names and this is a very old program so I am wondering if anything breaks if i try to rename them. In addition, I need to validate these combo boxes not null. Meaning, they can&#39;t be null before clicking a &#39;Validate&#39; btn. I need to clear out other 2 combo values just to make sure that users don&#39;t keep the stale values from  first chosen option of the first combo box. So, as soon as first combo box value changes, other two should clear out so that user will enter new values"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1506441878, "post_id": 46323817, "comment_id": 79819524, "body": "Okay - then in order to set the Controls value use the syntax <code>Me.YourControlName = Null</code> . When you type the <code>Me.</code> you should get intellisense to list the available control names."}, {"owner": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "edited": false, "score": 0, "creation_date": 1506447146, "post_id": 46323817, "comment_id": 79822406, "body": "I got debug error which highlights yellow in this line while doing <code>Me.YourControlName = Null</code>."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1506505213, "post_id": 46323817, "comment_id": 79844745, "body": "Sorry I was only indicating the syntax, replace <code>YourControlName</code> with your actual control name on your form."}], "tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 0, "last_activity_date": 1505918498, "last_edit_date": 1505918498, "creation_date": 1505915141, "answer_id": 46323817, "question_id": 46323049, "link": "https://stackoverflow.com/questions/46323049/clear-out-dropdown-value-once-another-drodown-value-is-changed-in-vba-access/46323817#46323817", "title": "Clear out dropdown value once another drodown value is changed in vba access?", "body": "<p>Set the combo to null to wipe any displayed value in them;</p>\n\n<pre><code>Me.Code = Null\nMe.GrpID = Null\n</code></pre>\n\n<p>This assumes your combo controls are called the same as your field names.</p>\n\n<p>Edit for clarity: Including the Me. makes sure your are changing the form control values. If your field names are the same as the controls then Access will change the underlying field values, and as you have discovered on your form these aren't reflected until you click in that fields bound control.</p>\n"}], "owner": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2325, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505918498, "creation_date": 1505913205, "last_edit_date": 1505913728, "question_id": 46323049, "link": "https://stackoverflow.com/questions/46323049/clear-out-dropdown-value-once-another-drodown-value-is-changed-in-vba-access", "title": "Clear out dropdown value once another drodown value is changed in vba access?", "body": "<p>I have three combo box controls(MFG, Code, and GrpID) in my VBA access form. Once the user selects an option from the first combo box (MFG), rest of combo boxes give me available options. But I need to do some validation i.e. what if the user decided to change the value of first combo box? The values of rest combo box should be cleared. All I need to do is once the first combo box is changed the second and third combo box need to be cleared out or at least set to focus on them so that users will realize that they can't use old values as first value is cleared in the first combo box. I added a code block 'AfterUpdate for first combo box as shown below:</p>\n\n<pre><code>Private Sub MFG_AfterUpdate()\n   Code.Value = \" \"\n   GrpID.Value = 0    \nEnd Sub\n</code></pre>\n\n<p>The problem after writing above code is: they don't get empty until they(Code and GrpID) get clicked. In other words, I need to click them to empty them every time I change the value of MFG. Can anyone direct me how do I clear them or at least focus them?</p>\n"}, {"tags": ["ms-access", "vba", "adodb"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1505911809, "post_id": 46322558, "comment_id": 79605775, "body": "You need to show the full SQL --- you can have a query that is not updatable..."}, {"owner": {"reputation": 65, "user_id": 7676688, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/SoD25.jpg?s=128&g=1", "display_name": "Donald W Garton", "link": "https://stackoverflow.com/users/7676688/donald-w-garton"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1505911862, "post_id": 46322558, "comment_id": 79605824, "body": "The recordset is created by: ADOrstStack.Open &quot;SELECT * FROM tblDocLibUndoStack ORDER BY f_UndoStackNumber&quot;, ADOcnn0, adOpenKeyset, adLockOptimistic"}, {"owner": {"reputation": 65, "user_id": 7676688, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/SoD25.jpg?s=128&g=1", "display_name": "Donald W Garton", "link": "https://stackoverflow.com/users/7676688/donald-w-garton"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1505911946, "post_id": 46322558, "comment_id": 79605879, "body": "I can update this recordset using .Execute but not using Field1 = &quot;xyz&quot;"}, {"owner": {"reputation": 65, "user_id": 7676688, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/SoD25.jpg?s=128&g=1", "display_name": "Donald W Garton", "link": "https://stackoverflow.com/users/7676688/donald-w-garton"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1505912087, "post_id": 46322558, "comment_id": 79605969, "body": ".Execute is: ADOcnn0.Execute &quot;UPDATE tblDocLibUndoStack SET f_UndoStack = &#39;&quot; &amp; strStack &amp; &quot;&#39; WHERE  f_UndoStackNumber = &quot; &amp; ADOrstStack!f_UndoStackNumber + 1"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1505912688, "post_id": 46322558, "comment_id": 79606386, "body": "Maybe I don&#39;t understand... Your &#39;.Execute&#39; (that you showabove) works just fine? But vba code like &#39;ADOrstStack!Field1 = &quot;xyz&quot; and ADOrstStack.Update doesn&#39;t work - is that correct?  Seeing only glimpses of part of your code makes it tough. I assume you have the &quot;.Update&quot; code?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1505912849, "post_id": 46322558, "comment_id": 79606509, "body": "Please don&#39;t put code in comments, edit your question instead. @DonaldWGarton"}, {"owner": {"reputation": 65, "user_id": 7676688, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/SoD25.jpg?s=128&g=1", "display_name": "Donald W Garton", "link": "https://stackoverflow.com/users/7676688/donald-w-garton"}, "edited": false, "score": 0, "creation_date": 1505913168, "post_id": 46322558, "comment_id": 79606745, "body": "...apologies if I am missing the obvious Wayne"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1505914007, "post_id": 46322558, "comment_id": 79607364, "body": "Don&#39;t take this wrong, but it is extremely difficult to diagnose a problem without seeing all code that is related to the issue you face. Without the code, we have to either assume certain things are correct/wrong, or we have to <i>believe</i> what the OP is telling us. In my case, I have a special disdain for relying on &#39;no changes&#39;. I spent six months unsuccessfully trying to solve a problem for a large corporation, only to ask AGAIN &#39;did you change something?&#39; and the sheepish reply was &#39;yes, but that couldn&#39;t matter&#39;.  Where is your UPDATE code that fails?"}, {"owner": {"reputation": 65, "user_id": 7676688, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/SoD25.jpg?s=128&g=1", "display_name": "Donald W Garton", "link": "https://stackoverflow.com/users/7676688/donald-w-garton"}, "edited": false, "score": 0, "creation_date": 1505914862, "post_id": 46322558, "comment_id": 79608064, "body": "Wayne ...I think I am confused - been rewriting DAO code to ADO for the past week with no prior experience with ADO.  I think I have it working ok now.  Yes the .Update was missing.  I thought I had read somewhere that it wasn&#39;t used in ADO..."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1505915991, "post_id": 46322558, "comment_id": 79608944, "body": "It&#39;s the .Edit that is not needed... Glad it&#39;s working!!  There was a great article from Microsoft re conversion from DAO to ADO, with samples, but the link no longer works... but I placed the code samples at this link:  <a href=\"http://1anddunn.com/DAOtoADO.txt\" rel=\"nofollow noreferrer\">1anddunn.com/DAOtoADO.txt</a>"}, {"owner": {"reputation": 65, "user_id": 7676688, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/SoD25.jpg?s=128&g=1", "display_name": "Donald W Garton", "link": "https://stackoverflow.com/users/7676688/donald-w-garton"}, "edited": false, "score": 0, "creation_date": 1505917133, "post_id": 46322558, "comment_id": 79609779, "body": "thank you very much for that link Wayne, regards Donald"}], "owner": {"reputation": 65, "user_id": 7676688, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/SoD25.jpg?s=128&g=1", "display_name": "Donald W Garton", "link": "https://stackoverflow.com/users/7676688/donald-w-garton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 544, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505924625, "creation_date": 1505911702, "last_edit_date": 1505924625, "question_id": 46322558, "link": "https://stackoverflow.com/questions/46322558/ms-access-vba-using-adodb-connection-string-field1-xyz-not-updating-the-ta", "title": "MS Access VBA using ADODB connection string - field1 = &quot;xyz&quot; not updating the table", "body": "<p>I have a front end .accdb file connecting to back end data via ADODB.connection.  SQL SELECT statements are working fine to create ADODB.recordsets but when I use SQL to select just one record that I want to update, code similar to: field1 = \"xyz\" doesn't error but neither does it update the table data in the back end .accdb database file.  I can update the backend data tables using .Execute but I prefer working with .recordsets.</p>\n\n<p>this is how I create my recordset that I want to loop through and update using simple Filed1 = \"field1 value\" for each field that I want to update.</p>\n\n<pre><code>Dim strStackPath As String\nDim ADOrstStack As ADODB.Recordset\nSet ADOrstStack = New ADODB.Recordset\nADOrstStack.Open \"SELECT * FROM tblDocLibUndoStack ORDER BY f_UndoStackNumber\", ADOcnn0, adOpenKeyset, adLockOptimistic\n</code></pre>\n\n<p>But I've had to use the .Execute code below to update the data.</p>\n\n<pre><code>ADOcnn0.Execute \"UPDATE tblDocLibUndoStack SET f_UndoStack = '\" &amp; strStack &amp; \"' WHERE f_UndoStackNumber = \" &amp; ADOrstStack!f_UndoStackNumber + 1\n</code></pre>\n\n<p>By the way, I'll add the connection string I am using, scavenged from looking at the string generated by </p>\n\n<pre><code>CurrentProject.AccessConnection\n\nADOstr0 = \"Provider='Microsoft.Access.OLEDB.10.0';Persist Security Info=False;Data Source=C:\\...Data.accdb;User ID=Admin;Data Provider=Microsoft.ACE.OLEDB.12.0\"\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "vba", "button", "jqgrid"], "comments": [{"owner": {"reputation": 1884, "user_id": 4527978, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Od9E3.png?s=128&g=1", "display_name": "parik", "link": "https://stackoverflow.com/users/4527978/parik"}, "edited": false, "score": 0, "creation_date": 1505912041, "post_id": 46322521, "comment_id": 79605939, "body": "Look answer of this question <a href=\"https://stackoverflow.com/questions/17656344/how-can-i-click-a-js-button-on-vb\" title=\"how can i click a js button on vb\">stackoverflow.com/questions/17656344/&hellip;</a>"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1505912681, "post_id": 46322521, "comment_id": 79606379, "body": "Something like this? <code>IE.document.parentWindow.execscript &quot;$(&#39;#hoofdleidingGrid&#39;).click()&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 8641154, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743845722586711/picture?type=large", "display_name": "Roncancio", "link": "https://stackoverflow.com/users/8641154/roncancio"}, "reply_to_user": {"reputation": 1884, "user_id": 4527978, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Od9E3.png?s=128&g=1", "display_name": "parik", "link": "https://stackoverflow.com/users/4527978/parik"}, "edited": false, "score": 0, "creation_date": 1505978894, "post_id": 46322521, "comment_id": 79635462, "body": "@parik. Sorry for the late response. Many thanks for your reply. When I add the code link.InvokeMember (&quot;Click&quot;) to the code I receive the error message: &quot;Error 438 object doesn&#39;t support this property or method access&quot;"}, {"owner": {"reputation": 1, "user_id": 8641154, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743845722586711/picture?type=large", "display_name": "Roncancio", "link": "https://stackoverflow.com/users/8641154/roncancio"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1505979079, "post_id": 46322521, "comment_id": 79635567, "body": "@ryan. Sorry for the late response. Thank you very much for your reply. Unfortunately like with my code the button doesn&#39;t respond. I have added the wait command so the code will execute when the web page is loaded but to no avail."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1505998862, "post_id": 46322521, "comment_id": 79649199, "body": "Is it possible to share the website in question? At this point, it might be more helpful to see it in action."}, {"owner": {"reputation": 1, "user_id": 8641154, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743845722586711/picture?type=large", "display_name": "Roncancio", "link": "https://stackoverflow.com/users/8641154/roncancio"}, "edited": false, "score": 0, "creation_date": 1506058279, "post_id": 46322521, "comment_id": 79674596, "body": "You are right but I am sorry. It is classified information for which you have to login. When entering the page there is already a filter that hides all the data. By clicking on the Clear button any filter on the page will be removed. I am currently in contact with the manufacturer of the program to automatically load the page without any filter. I&#39;ll keep you informed."}, {"owner": {"reputation": 1, "user_id": 8641154, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743845722586711/picture?type=large", "display_name": "Roncancio", "link": "https://stackoverflow.com/users/8641154/roncancio"}, "edited": false, "score": 0, "creation_date": 1506575538, "post_id": 46322521, "comment_id": 79877537, "body": "As promised I keep you informed. I have contacted the company who made the program and they will adjust the program so the filter automatically gets  cleared when loading the page. They advised me to update my Windows version (now 9)."}], "owner": {"reputation": 1, "user_id": 8641154, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743845722586711/picture?type=large", "display_name": "Roncancio", "link": "https://stackoverflow.com/users/8641154/roncancio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 842, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505911574, "creation_date": 1505911574, "question_id": 46322521, "link": "https://stackoverflow.com/questions/46322521/click-on-button-in-jquery-with-vba", "title": "Click on button in jquery with VBA", "body": "<p>For numerous days I have been looking for a way to enter a site to retrieve data automatically. I have been able to login on the site and click on the requested tabs on a certain page. The final step I need to do is to click on the button \"Clear\" on that page. So far I have tried:</p>\n\n<pre><code>For Each aInput In IE.document.getElementsByTagName(\"hoofdleidingGrid\")\n    If aInput.getAttribute(\"value\") = \"Clear\" Then\n        aInput.Click\n        Exit For\n    End If\nNext aInput\n</code></pre>\n\n<p>and</p>\n\n<pre><code>tekst = \"&lt;span class=\" &amp; Chr(34) &amp; \"ui-icon ui-icon-closethick\" &amp; Chr(34) &amp; \"&gt;&lt;/span&gt;\"\nSet elementcol = IE.document.getElementsByTagName(\"a\")\n\nFor Each link In elementcol\n    Debug.Print link.innerHTML\n    If link.innerHTML = tekst Then\n        link.Focus\n        link.Click\n    Application.Wait DateAdd(\"s\", 5, Now)\n\n    End If\nNext link\n</code></pre>\n\n<p>In both codes the line with .Click executes but there is no result like when it is done manually. \nThe section of the code on the website which contains the buttons is:</p>\n\n<pre><code>&gt; jQuery('#hoofdleidingGrid').jqGrid('navGrid',\"#hoofdleidingPaginatie\",\n&gt; {edit:false,add:false,del:false,search:false,refresh:false}); \n&gt; jQuery('#hoofdleidingGrid').jqGrid('navButtonAdd',\"#hoofdleidingPaginatie\",\n&gt; {caption:\"Clear\",title:\"Clear Search\",buttonicon :'ui-icon-refresh', \n&gt; onClickButton:function(){jQuery('#hoofdleidingGrid')[0].clearToolbar(); }}); \n&gt; jQuery('#hoofdleidingGrid').jqGrid('filterToolbar', {stringResult:true, \n&gt; searchOnEnter: true});});&lt;/script&gt;&lt;table id=\"hoofdleidingGrid\"&gt;&lt;tr&gt;&lt;td /&gt;&lt;/tr&gt;\n&gt; &lt;/table&gt;&lt;div id=\"hoofdleidingPaginatie\"&gt;&lt;/div&gt;        \n&gt; &lt;script type=\"text/javascript\"&gt;\n</code></pre>\n\n<p>I hope somebody can help me out.\nMany thanks in advance.</p>\n\n<p>Best regards,</p>\n\n<p>Roncancio</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505911343, "post_id": 46322257, "comment_id": 79605455, "body": "It would be best to also qualify your Rows.Count to a specific worksheet."}, {"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505911436, "post_id": 46322257, "comment_id": 79605521, "body": "Yes, sure. Thanks @braX"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1505914877, "post_id": 46322257, "comment_id": 79608079, "body": "@adhywijaya I would like to change it to row 5. But there it defines range (A)"}, {"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "edited": false, "score": 0, "creation_date": 1505918097, "post_id": 46322257, "comment_id": 79610462, "body": "Did you try it?"}], "tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": 2, "last_activity_date": 1505910846, "creation_date": 1505910846, "answer_id": 46322257, "question_id": 46322166, "link": "https://stackoverflow.com/questions/46322166/copying-the-rows-one-below-another-checking-on-the-last-filled-column/46322257#46322257", "title": "copying the rows one below another checking on the last filled column", "body": "<p>You need to get last blank row:</p>\n\n<pre><code>Sub lastweekctt()\n\n    Dim LastRow As Long\n\n    'get last row\n    LastRow = Worksheets(\"Evaluation\").Cells(Rows.Count,1).End(xlUp).Row\n    Worksheets(\"List\").Range(\"A4:W1000\").Copy _\n    Destination:=Worksheets(\"Evaluation\").Range(\"A\" &amp; LastRow + 1)\nEnd Sub\n</code></pre>\n\n<p>Hope this help.</p>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 2, "last_activity_date": 1505910870, "creation_date": 1505910870, "answer_id": 46322267, "question_id": 46322166, "link": "https://stackoverflow.com/questions/46322166/copying-the-rows-one-below-another-checking-on-the-last-filled-column/46322267#46322267", "title": "copying the rows one below another checking on the last filled column", "body": "<p>You will need to find the last row first</p>\n\n<pre><code>lLastRow = Worksheets(\"Evaluation\").Cells(Worksheets(\"Evaluation\").Rows.Count, 1).End(xlUp).Row\n</code></pre>\n\n<p>and then your destination range will look like this</p>\n\n<pre><code>.Range(\"A\" &amp; lLastRow + 1)\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505910870, "creation_date": 1505910587, "question_id": 46322166, "link": "https://stackoverflow.com/questions/46322166/copying-the-rows-one-below-another-checking-on-the-last-filled-column", "title": "copying the rows one below another checking on the last filled column", "body": "<p>I have a sheet List. I want the contents of list to be transferred to my sheet Evaluation. But my evaluation sheet, already consist of the previous evaluation. I want the new rows just below the old ones. Can some one help how I can achieve this ? </p>\n\n<p>I have the below code with me, which is a copy paste functionality. </p>\n\n<pre><code>Sub lastweekctt()\nWorksheets(\"List\").Range(\"A4:W1000\").Copy _\nDestination:=Worksheets(\"Evaluation\").Range(\"A5\")\nEnd Sub\n</code></pre>\n\n<p>I have my header in row 4 in both the sheets. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1505910845, "post_id": 46322133, "comment_id": 79605107, "body": "You are passing <code>&quot;-&quot;</code> to the <code>Start</code> argument of the <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/replace-function\" rel=\"nofollow noreferrer\"><code>Replace</code> function</a>. It expects a <code>Long</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1505911074, "post_id": 46322133, "comment_id": 79605275, "body": "As a side note, the big condition inside <code>SplitText</code> can be simplified to <code>If VBA.IsNumeric(xStr) = pIsNumber Then</code>."}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1505911387, "post_id": 46322133, "comment_id": 79605486, "body": "Hi Gserg, Thanks for your help! I was hoping to use the &quot;-&quot;,&quot;-&quot;, and &quot;_&quot; to format that date and take. When I run it in a cell, it works. Do you know why it wouldnt in the VBA code? ... in a cell it says Replace(old text, start number, number of characters, new text) which is why I had it formatted like that."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1505911615, "post_id": 46322133, "comment_id": 79605643, "body": "Because <a href=\"https://support.office.com/en-us/article/REPLACE-REPLACEB-functions-8d799074-2425-4a8a-84bc-82472868878a\" rel=\"nofollow noreferrer\">Excel&#39;s <code>REPLACE</code></a> has nothing to do with <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/replace-function\" rel=\"nofollow noreferrer\">VBA&#39;s <code>Replace</code></a>? In any case, <a href=\"https://meta.stackexchange.com/q/66377/147640\">neither of those</a> are the right choice to format a date."}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1505912054, "post_id": 46322133, "comment_id": 79605949, "body": "I did not realize those were different! When I recorded a macro of the cell, it gave me what you see above. Maybe explaining a bit more on what I want will help: I am running this on multiple files, and need to get the date and take from each filename (workbook name) and save them as variables to use later on. Is there code in VBA that does the same thing as the Excel Replace?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1505915299, "post_id": 46322133, "comment_id": 79608451, "body": "<code>Application.WorksheetFunction.Replace()</code>."}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1505916096, "post_id": 46322133, "comment_id": 79609031, "body": "That worked! Thank you so much!!"}], "answers": [{"tags": [], "owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "is_accepted": true, "score": 0, "last_activity_date": 1505916051, "creation_date": 1505916051, "answer_id": 46324158, "question_id": 46322133, "link": "https://stackoverflow.com/questions/46322133/writing-formula-in-vba-results-in-type-mismatch-13/46324158#46324158", "title": "Writing formula in VBA results in Type Mismatch 13", "body": "<p>I am a bit new to Stack Overflow so I wasnt sure how to set GSerg's comment to the answer, but all I had to do was change each \"Replace\" to \"WorksheetFunction.Replace\"! </p>\n\n<pre><code>My_Date = Left(WorksheetFunction.Replace(WorksheetFunction.Replace(WorksheetFunction.Replace(SplitText(NAMEoFILE, True), 2, 0, \"-\"), 5, 0, \"-\"), 8, 0, \"_\"), 7)\n\nMy_Take = Right(WorksheetFunction.Replace(WorksheetFunction.Replace(WorksheetFunction.Replace(SplitText(NAMEoFILE, True), 2, 0, \"-\"), 5, 0, \"-\"), 8, 0, \"_\"), 1)\n</code></pre>\n\n<p>Thank you GSerg!!</p>\n"}], "owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 46324158, "answer_count": 1, "score": 1, "last_activity_date": 1505916051, "creation_date": 1505910506, "question_id": 46322133, "link": "https://stackoverflow.com/questions/46322133/writing-formula-in-vba-results-in-type-mismatch-13", "title": "Writing formula in VBA results in Type Mismatch 13", "body": "<p>Overlying question: Is it possible to code formulas in VBA that save the values as a variable, without putting them in a cell on the worksheet?</p>\n\n<p>I get the error for the line starting with \"My_Date = Left(Replace\" ... I assume it will also be an issue for the \"My_Take = Right(Replace\" line.</p>\n\n<p>The function is supposed to take numbers out of strings:</p>\n\n<pre><code>Public Function SplitText(pWorkStr As String, pIsNumber As Boolean) As String\n\nDim xLen As Long\nDim xStr As String\nxLen = VBA.Len(pWorkStr)\nFor i = 1 To xLen\n    xStr = VBA.Mid(pWorkStr, i, 1)\n    If ((VBA.IsNumeric(xStr) And pIsNumber) Or (Not (VBA.IsNumeric(xStr)) And Not (pIsNumber))) Then\n        SplitText = SplitText + xStr\n    End If\nNext\nEnd Function\n</code></pre>\n\n<p>This formats the numbers as a date and take without any letters:</p>\n\n<pre><code>Sub Fill_Date_and_Take()\n\n    Dim NAMEoFILE As String\n\n    Dim My_Date As String\n    Dim My_Take As String\n\n    NAMEoFILE = \"I love dogs 09-20-17 Take Number 2.xlsx\"\n\n    My_Date = Left(Replace(Replace(Replace(SplitText(NAMEoFILE, True), 2, 0, \"-\"), 5, 0, \"-\"), 8, 0, \"_\"), 7)\n        MsgBox (My_Date)\n\n    My_Take = Right(Replace(Replace(Replace(SplitText(NAMEoFILE, True), 2, 0, \"-\"), 5, 0, \"-\"), 8, 0, \"_\"), 1)\n        MsgBox (My_Take)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1505910778, "post_id": 46321987, "comment_id": 79605050, "body": "I believe it has to do with how you are selecting the RngToCopy. You want to select the range by selecting individual cells to specify the contiguous range you are interested in. Something like this : <code>Dim rngToCopy As Range: Set rngToCopy = ws.Range(ws.Cells(1, 1), ws.Cells(15, lastrow))</code>"}, {"owner": {"reputation": 13, "user_id": 5887686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e6c4ce13bd00ede6fff8990160b13f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/5887686/mohammed"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1505911941, "post_id": 46321987, "comment_id": 79605875, "body": "i tried that but gave me run time error 91 &#39;object variable or with block variable not set&#39; ? @RyanWildry"}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "edited": false, "score": 0, "creation_date": 1505912041, "post_id": 46321987, "comment_id": 79605941, "body": "i think that your problem is that: the destination book you use is xls which contains 65536 rows, but you say to your question that has 300k rows..please change the destination workbook to xlsm \u2013"}, {"owner": {"reputation": 13, "user_id": 5887686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e6c4ce13bd00ede6fff8990160b13f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/5887686/mohammed"}, "reply_to_user": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "edited": false, "score": 0, "creation_date": 1505912122, "post_id": 46321987, "comment_id": 79605994, "body": "@NikolaosPolygenis sorry the source workbook is actually .xlsm i have edited the question"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1505912137, "post_id": 46321987, "comment_id": 79606004, "body": "Does it help if you Copy/Paste rather than using <code>Value = Value</code>?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1505912195, "post_id": 46321987, "comment_id": 79606042, "body": "@Mohammed did you remember to include <code>Set</code>?"}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "edited": false, "score": 0, "creation_date": 1505912445, "post_id": 46321987, "comment_id": 79606220, "body": "@Mohammed your destination workbook is xlsm too?"}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "edited": false, "score": 0, "creation_date": 1505912684, "post_id": 46321987, "comment_id": 79606381, "body": "the point which debug the line goes shows as that the RngToCopy overflows, thats why i ask you for the type of destination workbook"}, {"owner": {"reputation": 13, "user_id": 5887686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e6c4ce13bd00ede6fff8990160b13f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/5887686/mohammed"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1505916410, "post_id": 46321987, "comment_id": 79609251, "body": "thank you guys for your suggestion , i have found an answer from @ShaiRado his approach worked perfect for my needs :)"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1505912298, "creation_date": 1505912298, "answer_id": 46322756, "question_id": 46321987, "link": "https://stackoverflow.com/questions/46321987/run-time-error-6-overflow-copy-range-from-closed-workbook/46322756#46322756", "title": "Run-Time Error &#39;6&#39; overflow (copy range from closed workbook)", "body": "<p>Try a different approach, use <strong>Copy >> PasteSpecial</strong> (values only) :</p>\n\n<pre><code>' 1st: set copy range\nWith wkbk.Worksheets(1)\n    Set RngToCopy = .Range(\"A2:R2\", .Cells(.Rows.Count, \"A\").End(xlUp))\nEnd With\n\n' 2nd: set destination range start position\nSet DestCell = DestCell.Offset(RngToCopy.Rows.Count, 0)\n\n' 3rd: use copy&gt;&gt;paste special (values only)\nRngToCopy.Copy\nDestCell.PasteSpecial xlPasteValues\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5887686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e6c4ce13bd00ede6fff8990160b13f3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/5887686/mohammed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 46322756, "answer_count": 1, "score": 0, "last_activity_date": 1505912298, "creation_date": 1505910104, "last_edit_date": 1505912043, "question_id": 46321987, "link": "https://stackoverflow.com/questions/46321987/run-time-error-6-overflow-copy-range-from-closed-workbook", "title": "Run-Time Error &#39;6&#39; overflow (copy range from closed workbook)", "body": "<p>I have the below code placed on my active workbook which copy's data from a closed workbook. It works fine and very fast but i can only copy up to 8 columns if I select more than that I get a </p>\n\n<blockquote>\n  <p>run-time error 6 - Overflow</p>\n</blockquote>\n\n<p><strong>Code</strong>:</p>\n\n<pre><code>Sub Get_Data()\n\nDim RngToCopy As Range\nDim wkbk As Workbook\nDim DestCell As Range\nDim myFileNames As Variant\nDim iCtr As Long\nDim testStr As String\n\nSet DestCell = ThisWorkbook.Worksheets(1).Range(\"a1\")\n\nmyFileNames = Array(\"C:\\my documents\\excel\\book1.xlsm\") ' i could add more workbooks to copy from and append on current worksheet\n\nFor iCtr = LBound(myFileNames) To UBound(myFileNames)\n    testStr = \"\"\n    On Error Resume Next\n    testStr = Dir(myFileNames(iCtr))\n    On Error GoTo 0\n\n    If testStr = \"\" Then\n        MsgBox myFileNames(iCtr) &amp; \" doesn't exist!\"\n    Else\n        Set wkbk = Workbooks.Open(Filename:=myFileNames(iCtr))\n        With wkbk.Worksheets(1)\n            Set RngToCopy = .Range(\"a2:r2\", _\n            .Cells(.Rows.Count, \"A\").End(xlUp))\n        End With\n\n        DestCell.Resize(RngToCopy.Rows.Count, _\n            RngToCopy.Columns.Count).Value _\n            = RngToCopy.Value\n\n        Set DestCell = DestCell.Offset(RngToCopy.Rows.Count, 0)\n        wkbk.Close savechanges:=False\n    End If\nNext iCtr\n\nEnd Sub\n</code></pre>\n\n<p>when I debug the line that it goes to is: where am I going wrong :(</p>\n\n<pre><code>DestCell.Resize(RngToCopy.Rows.Count, _\nRngToCopy.Columns.Count).Value _\n= RngToCopy.Value\n</code></pre>\n\n<p>the source workbook is a big file with a lot of data, I tried most of the suggestions when I researched on the error but no luck.</p>\n\n<p>if it helps workbook contains 18 columns and 300k+ rows</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505909348, "post_id": 46321324, "comment_id": 79603964, "body": "What code have you tried so far?"}, {"owner": {"reputation": 61, "user_id": 6574752, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1adaf467bcf1e4ff41e7ba1a7d2beb1?s=128&d=identicon&r=PG&f=1", "display_name": "FatMan", "link": "https://stackoverflow.com/users/6574752/fatman"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505910076, "post_id": 46321324, "comment_id": 79604519, "body": "I&#39;ve written code that outputs a collection with the unique types of dice to roll using the cell&#39;s value as Key. I still need to figure out how to tally how many there are."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1505910176, "post_id": 46321324, "comment_id": 79604590, "body": "The people who help out here help you tweak existing code, not completely write it for you. Please make an attempt and post it in your question."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1505910844, "post_id": 46321324, "comment_id": 79605104, "body": "Use a dictionary, then increment the value of the dict when you encounter an existing key."}, {"owner": {"reputation": 61, "user_id": 6574752, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1adaf467bcf1e4ff41e7ba1a7d2beb1?s=128&d=identicon&r=PG&f=1", "display_name": "FatMan", "link": "https://stackoverflow.com/users/6574752/fatman"}, "edited": false, "score": 0, "creation_date": 1505912495, "post_id": 46321324, "comment_id": 79606261, "body": "Thanks, Ryan! It works really well. I think I can figure out the rest, except for one thing - how can I drop (or set to 0) the lowest value in an array without sorting it beforehand? Is it possible?"}], "answers": [{"tags": [], "owner": {"reputation": 558, "user_id": 7927748, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/62bb7763ae9694456113fb6787786e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Torc", "link": "https://stackoverflow.com/users/7927748/torc"}, "is_accepted": false, "score": 0, "last_activity_date": 1506088031, "creation_date": 1506088031, "answer_id": 46366352, "question_id": 46321324, "link": "https://stackoverflow.com/questions/46321324/vba-generating-numbers-for-unique-values-of-range-and-returning-them-to-the-ran/46366352#46366352", "title": "VBA: Generating numbers for unique values of range and returning them to the range (simulating dice rolls)", "body": "<p>Not sure if this is still needed, but I used a set of arrays to tackle this problem. Here's a summary of how I approached it:</p>\n\n<ol>\n<li>Get the values from the range in Excel, pass them to the first array</li>\n<li>Set up the number of times the dice needed to be rolled</li>\n<li>Pass the first array to a 2D array and populate it with info to finish</li>\n<li><p>Use a temporary array to get values from the rolls and then paste back into the Excel sheet</p>\n\n<pre><code>Sub roll()\n\nDim i As Long\nDim j As Long\nDim k As Long\nDim lr As Long\n\nDim upperbound As Long\nDim lowerbound As Long\nDim frequency As String\nDim rolls As String\n\nDim rng As Range\nDim arr1D() As String\nDim arr2D() As String\nDim rollresult As Integer\n\nDim arr_min As Variant\nDim FirstCheck As Boolean\nDim targetdi As Variant\n\n'Set the area with values for the dice roll simulation\nlr = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n'Clear the result area for roll results\nRange(Cells(2, \"B\"), Cells(lr, \"B\")).ClearContents\n\nSet rng = Range(Cells(2, \"A\"), Cells(lr, \"A\"))\n\n'Collect unique values from the range\nFor Each cell In rng\n    If (cell &lt;&gt; \"\") And (InStr(frequency, cell) = 0) Then\n        frequency = frequency &amp; cell &amp; \"|\"\n    End If\nNext cell\nIf Len(frequency) &gt; 0 Then frequency = Left(frequency, Len(frequency) - 1)\narr1D = Split(frequency, \"|\")\n\n    'Set up the 2D array with a space for the number of rolls\n    ReDim arr2D(LBound(arr1D) To UBound(arr1D), LBound(arr1D) To 3)\n\n        'Copy contents from first (1D) array into the second (2D) array\n    For i = LBound(arr1D) To UBound(arr1D)\n        arr2D(i, 0) = arr1D(i)\n        arr2D(i, 1) = Application.WorksheetFunction.CountIf(Range(Cells(2, \"A\"), Cells(lr, \"A\")), \"=\" &amp; arr2D(i, 0)) + 1\n        arr2D(i, 2) = Right(arr2D(i, 0), Len(arr2D(i, 0)) - InStr(1, arr2D(i, 0), \"d\"))\n\n    'Keep rollin rollin rollin WHAT Keep rollin rollin rollin\n        For j = 1 To (arr2D(i, 1))\n            If ((arr2D(i, 2)) &lt;&gt; \"\") Then\n                rollresult = Int((Int((arr2D(i, 2) + 1)) - 1 + 1) * Rnd + 1)\n                rolls = rolls &amp; rollresult &amp; \"|\"\n            End If\n        Next j\n    rolls = Left(rolls, Len(rolls) - 1)\n    arr2D(i, 3) = rolls\n    rolls = \"\"\n    Next i\n\nFor i = LBound(arr2D) To UBound(arr2D)\n    temparray = Split(arr2D(i, 3), \"|\")\n    arr_min = temparray(LBound(temparray))\n        For j = LBound(temparray) To UBound(temparray) 'LBound(temparray) To UBound(temparray) - 1\n            If temparray(j) &lt; arr_min Then\n                arr_min = temparray(j)\n            End If\n        Next j\n\n'Remove the lowest value, but preserve the order\n    For j = LBound(temparray) To UBound(temparray)\n        If temparray(j) = arr_min And FirstCheck = False Then\n            temparray(j) = \"\"\n            FirstCheck = True\n        End If\n    Next j\n\n'Place the results back in the sheet\nFor j = LBound(temparray) To UBound(temparray)\n    If temparray(j) &lt;&gt; \"\" Then\n        targetdi = arr2D(i, 0)\n            For k = 2 To lr\n                If Cells(k, \"A\").Value = targetdi And Cells(k, \"B\").Value = \"\" Then\n                    Cells(k, \"B\").Value = temparray(j)\n                End If\n            Next k\n        End If\n    Next j\n\nNext i\n\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 61, "user_id": 6574752, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1adaf467bcf1e4ff41e7ba1a7d2beb1?s=128&d=identicon&r=PG&f=1", "display_name": "FatMan", "link": "https://stackoverflow.com/users/6574752/fatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506088031, "creation_date": 1505908348, "last_edit_date": 1505912541, "question_id": 46321324, "link": "https://stackoverflow.com/questions/46321324/vba-generating-numbers-for-unique-values-of-range-and-returning-them-to-the-ran", "title": "VBA: Generating numbers for unique values of range and returning them to the range (simulating dice rolls)", "body": "<p>I am trying to implement a random number generation in an Excel sheet. The process is such:</p>\n\n<ol>\n<li>There are seven cells, each containing the number and type of dice to be rolled in standard notation (XdY+Z, where X is the number of Y-sided dice to roll, with Z being the bonus/penalty)</li>\n<li>The numbers are tallied up into unique groups by roll types</li>\n<li>The numbers are generated for each group (I have this step working, so this isn't the problem).</li>\n<li>One extra roll is made for each group</li>\n<li>The lowest number is dropped</li>\n<li>The numbers are assigned to an output range, in order, so they match their dice rows.</li>\n</ol>\n\n<p>I know I can extract the unique values from my input using a collection. I also already have a function which interprets the dice type and makes the roll. I am stumped though about being able to tally up the unique values, roll that many times + 1, drop lowest and then return them to the correct rows. Especially since I don't want to sort the results.</p>\n\n<p>I would appreciate any help or any direction in which you could point me.</p>\n\n<p><strong>Example:</strong>    </p>\n\n<pre><code>Input:   \n\n1d6    \n1d6    \n1d8    \n1d10    \n1d4    \n1d6   \n1d4    \n\nDivide into buckets: 3 x 1d6; 1 x 1d8; 1 x 1d10; 2 x 1d4    \n\nRoll dice, with an extra roll for each bucket:    \n4 x 1d6 - 4, 4, 5, 2    \n2 x 1d8 - 8, 7    \n2 x 1d10 - 1, 3    \n3 x 1d4 - 1, 1, 4    \n\nDrop lowest value, leaving the following numbers:    \n1d6: 4, 4, 5    \n1d8: 8    \n1d10: 3    \n1d4: 1, 4    \n\nAssign them in order:    \n1d6 - 4   \n1d6 - 4    \n1d8 - 8    \n1d10 - 3    \n1d4 - 1    \n1d6 - 5    \n1d4 - 4    \n</code></pre>\n\n<p>This is the original function, which simply goes down the list, generates the roll (through a <code>RollDice</code> function that performs the roll), and places it in the correct output cell:</p>\n\n<pre><code>Sub GenerateOld()\n    For i = 1 To 7\n        Range(\"Dice_Output\").Cells(i).Value = _\n            RollDice(Range(\"Dice_Input\").Cells(i).Value)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>This is my attempt at the new version of this code. Commented out are the sections I can't figure out:</p>\n\n<pre><code>Sub GenerateNew()\n    Dim diceDictionary\n    Set diceDictionary = CreateObject(\"Scripting.Dictionary\")\n\n    For Each Cell In Range(\"Char_Characteristics_Dice\").Cells\n        If diceDictionary.Exists(Cell.Value) Then\n            diceDictionary(Cell.Value) = diceDictionary(Cell.Value) + 1\n        Else\n            diceDictionary.Add Cell.Value, 1\n        End If\n    Next Cell\n\n    For Each diceType In diceDictionary\n        ' RollDice(diceType)\n        ' Roll X drop lowest\n    Next cont\n\n    ' Place back into Dice_Output range in order\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505910517, "post_id": 46321167, "comment_id": 79604858, "body": "Does the same happen if you copy/paste manually? Is it possible that some kind of event routine in the target wb is triggered?"}, {"owner": {"reputation": 1, "user_id": 8640908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a974ca338c6e1b43809a7760f78199?s=128&d=identicon&r=PG&f=1", "display_name": "aRandomPleb", "link": "https://stackoverflow.com/users/8640908/arandompleb"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505913094, "post_id": 46321167, "comment_id": 79606690, "body": "I also tried it with disabling events before and enabling them afterwards, same result. If i do it manually everything is fine. The copy/paste code is also working fine, i just cant do any debugging after these line were executed."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505913402, "post_id": 46321167, "comment_id": 79606914, "body": "<i>&quot;Cant do any debugging&quot;</i> is something different than <i>&quot;Excel crashes&quot;</i>. What exactly is the behaviour?"}, {"owner": {"reputation": 1, "user_id": 8640908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a974ca338c6e1b43809a7760f78199?s=128&d=identicon&r=PG&f=1", "display_name": "aRandomPleb", "link": "https://stackoverflow.com/users/8640908/arandompleb"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505914235, "post_id": 46321167, "comment_id": 79607572, "body": "@FunThomas When the code reaches a breakpoint, the VBA editor window pops up, then the usual &#39;Excel has stopped working, searching for a solution..&#39; window pops up and all open excel related windows close."}, {"owner": {"reputation": 1, "user_id": 8640908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a974ca338c6e1b43809a7760f78199?s=128&d=identicon&r=PG&f=1", "display_name": "aRandomPleb", "link": "https://stackoverflow.com/users/8640908/arandompleb"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505914765, "post_id": 46321167, "comment_id": 79607983, "body": "@FunThomas If i set a breakpoint before the lines that do the copy and pasting, I can do step by step debugging through the entire code without a problem though. I just cant do it if the breakpoint is reached after the copy and pasting is done."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505915681, "post_id": 46321167, "comment_id": 79608712, "body": "Hmm, no clue. One of the mysterios things with Excel. Have you checked if the code after the Paste is executed (put a <code>Debug.print</code> after the <code>paste</code>)"}, {"owner": {"reputation": 1, "user_id": 8640908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a974ca338c6e1b43809a7760f78199?s=128&d=identicon&r=PG&f=1", "display_name": "aRandomPleb", "link": "https://stackoverflow.com/users/8640908/arandompleb"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505916697, "post_id": 46321167, "comment_id": 79609478, "body": "Yes, everything works as intended. It only crashes if I set and reach a breakpoint."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8640908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a974ca338c6e1b43809a7760f78199?s=128&d=identicon&r=PG&f=1", "display_name": "aRandomPleb", "link": "https://stackoverflow.com/users/8640908/arandompleb"}, "edited": false, "score": 0, "creation_date": 1505911239, "post_id": 46321407, "comment_id": 79605390, "body": "What i already posted is everything that is relevant, the entire code is to long to post.  I am not looking for a fix, just for a possible explanation."}], "tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": false, "score": 0, "last_activity_date": 1505908576, "creation_date": 1505908576, "answer_id": 46321407, "question_id": 46321167, "link": "https://stackoverflow.com/questions/46321167/vba-cannot-debug-code-after-pasting-range-with-formatconditions/46321407#46321407", "title": "VBA cannot debug code after pasting range with formatConditions", "body": "<p>please replace:</p>\n\n<pre><code>sourceFile.Sheets(sourceSheetName).Range(sourceRangeAddress).Copy\ntargetFile.Sheets(targetSheetName).Range(targetPasteAddress).PasteSpecial Paste:=xlPasteAllMergingConditionalFormats\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8640908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a974ca338c6e1b43809a7760f78199?s=128&d=identicon&r=PG&f=1", "display_name": "aRandomPleb", "link": "https://stackoverflow.com/users/8640908/arandompleb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505914917, "creation_date": 1505907884, "last_edit_date": 1505914917, "question_id": 46321167, "link": "https://stackoverflow.com/questions/46321167/vba-cannot-debug-code-after-pasting-range-with-formatconditions", "title": "VBA cannot debug code after pasting range with formatConditions", "body": "<p>I know there are ways to get around the following problem, but I am still curious:\nI have a macro which pastes ranges between different workbooks. One of those ranges that gets copied to another workbook contains a few cells with conditional formats. After I paste this range to another workbook, excel stops working and crashes if I try to debug the code (by adding a line with 'Stop' or any other methods) until the workbook I pasted it to gets closed by the code. </p>\n\n<p>So for example this would cause excel to crash:</p>\n\n<pre><code>'Assume the sourceRange contains the cells with conditionalFormats\nsourceFile.Sheets(sourceSheetName).Range(sourceRangeAddress).Copy\ntargetFile.Sheets(targetSheetName).Range(targetPasteAddress).PasteSpecial xlPasteAllMergingConditionalFormats\nStop\n</code></pre>\n\n<p>I have already tried different types of paste special and also the .copy destination:=... method.\nUsing a breakpoint instead of STOP leads to the same result.</p>\n\n<p>Thanks in advance for any ideas.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1505908289, "post_id": 46321121, "comment_id": 79603284, "body": "Which line throws the error?"}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1505908644, "post_id": 46321121, "comment_id": 79603518, "body": "Sheets.Add(After:=Sheets(Sheets.Count)).Name = c.Value"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1505908885, "post_id": 46321121, "comment_id": 79603668, "body": "What is the value of <code>c</code> when it errors? Presumably it is not a valid name for a sheet."}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1505909075, "post_id": 46321121, "comment_id": 79603798, "body": "It should take the &quot;&quot;Flag&quot;&quot;,&quot;&quot;Groups Excluding Flag&quot;&quot; values? So either the first or second option."}], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1505908625, "post_id": 46321404, "comment_id": 79603501, "body": "Thanks, how exactly do I incorporate that into my existing code?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1505908909, "post_id": 46321404, "comment_id": 79603685, "body": "Not arguing against your answer but note that Excel does allow you to add and name a sheet in a single line."}], "tags": [], "owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1505908570, "creation_date": 1505908570, "answer_id": 46321404, "question_id": 46321121, "link": "https://stackoverflow.com/questions/46321121/vba-macro-filter-and-copy-to-new-tab/46321404#46321404", "title": "VBA Macro Filter And Copy To New Tab", "body": "<p>I'm pretty sure that the issue is with this line of code             <code>Sheets.Add(After:=Sheets(Sheets.Count)).Name = c.Value</code>  If I remember correctly, excel doesn't like for you to add a sheet and name it in the same line of code.  I would suggest creating and referencing the sheets like so</p>\n\n<pre><code>Dim ws1 As Worksheet\nDim ws2 As Worksheet\n    Set ws1 = Sheets.Add(After:=Sheets(Sheets.Count))\n    Set ws2 = Sheets.Add(After:=Sheets(Sheets.Count))\n    ws1.Range(\"A1\").Value = \"WS1\"\n    ws2.Range(\"A1\").Value = \"WS2\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1505909732, "post_id": 46321672, "comment_id": 79604259, "body": "Gave me the same error, with the final line of your code"}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1505909271, "creation_date": 1505909271, "answer_id": 46321672, "question_id": 46321121, "link": "https://stackoverflow.com/questions/46321121/vba-macro-filter-and-copy-to-new-tab/46321672#46321672", "title": "VBA Macro Filter And Copy To New Tab", "body": "<p>Change <code>Sheets.Add(After:=Sheets(Sheets.Count)).Name = c.Value</code> to the following:</p>\n\n<pre><code>With ThisWorkbook\n    Dim oW As Worksheet: Set oW = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n    oW.Name = c.Value\nEnd With\noW.Paste\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1505909786, "post_id": 46321694, "comment_id": 79604303, "body": "I&#39;m getting a syntax error with Sheets.Add(After:=Sheets(Sheets.Count))"}, {"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "reply_to_user": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1505909969, "post_id": 46321694, "comment_id": 79604435, "body": "Sorry, please change to this code: Sheets.Add After:=Sheets(Sheets.Count)"}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1505910407, "post_id": 46321694, "comment_id": 79604783, "body": "Thanks, I am now getting an error with  Range(&quot;L2:L&quot; &amp; LR).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range(&quot;AM1&quot;), Unique:=True                I edited my code to what I am now currently running. Noticed an issue with a column reference."}, {"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "reply_to_user": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1505911236, "post_id": 46321694, "comment_id": 79605389, "body": "You need to add CriteriaRange before CopyToRange."}, {"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "reply_to_user": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1505911843, "post_id": 46321694, "comment_id": 79605805, "body": "You can find at this link to get more info how to code advanced filter: <a href=\"https://stackoverflow.com/questions/26407599/excel-vba-advanced-filter-to-copy-data-to-another-workbook\" title=\"excel vba advanced filter to copy data to another workbook\">stackoverflow.com/questions/26407599/&hellip;</a>"}], "tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1505909991, "last_edit_date": 1505909991, "creation_date": 1505909351, "answer_id": 46321694, "question_id": 46321121, "link": "https://stackoverflow.com/questions/46321121/vba-macro-filter-and-copy-to-new-tab/46321694#46321694", "title": "VBA Macro Filter And Copy To New Tab", "body": "<p>I think you need to add and rename your new sheet before paste to it:</p>\n\n<pre><code>For Each c In Range([AM2], Cells(Rows.Count, \"AM\").End(xlUp))\n        With rng\n            .AutoFilter\n            .AutoFilter Field:=5, Criteria1:=c.Value\n            .SpecialCells(xlCellTypeVisible).Copy\n            Sheets.Add After:=Sheets(Sheets.Count)\n            Activesheet.Name = c.Value\n            ActiveSheet.Paste\n        End With\nNext c\n</code></pre>\n\n<p>Hope this help.</p>\n"}], "owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1505940797, "creation_date": 1505907742, "last_edit_date": 1505940797, "question_id": 46321121, "link": "https://stackoverflow.com/questions/46321121/vba-macro-filter-and-copy-to-new-tab", "title": "VBA Macro Filter And Copy To New Tab", "body": "<p>I have a macro which will insert a new column flagging particular cells. \nI want it to then create two tabs based on the values.\nMy macro is giving me an <code>error 1004 invalid name</code> for sheet or chart</p>\n\n<p>My code is </p>\n\n<pre><code>Sub Groups()\nColumns(\"L:L\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"L2\").Select\nRange(\"L2:L\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row).Formula = \"=IF(OR(RC[-1]=27594,RC[-1]=27601),\"\"Flag\"\",\"\"Groups Excluding Flag\"\")\"\nRange(\"L1\").Select\nActiveCell.FormulaR1C1 = \"Test\"\nColumns(\"L:L\").Select\n   Selection.Copy\n   Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n      :=False, Transpose:=False\n\nDim c As Range\nDim rng As Range\nDim LR As Long\n\n    LR = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set rng = Range(\"A1:Q\" &amp; LR)\n\n   Range(\"L2:L\" &amp; LR).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range(\"AM1\"), _ \nUnique:=True\n   Columns(\"L:L\").Select\n   Selection.Copy\n   Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n      :=False, Transpose:=False\n\n   For Each c In Range([AM2], Cells(Rows.Count, \"AM\").End(xlUp))\n    With rng\n        .AutoFilter\n        .AutoFilter Field:=5, Criteria1:=c.Value\n        .SpecialCells(xlCellTypeVisible).Copy\n        Sheets.Add After:=Sheets(Sheets.Count)\n        ActiveSheet.Name = c.Value\n        ActiveSheet.Paste\n    End With\nNext c\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1505907471, "post_id": 46320884, "comment_id": 79602758, "body": "Just a heads up, you can use <code>For i = 11 to LD</code> instead of <code>i = 1</code> and then use <code>i</code> instead of <code>10+i</code>. Also, could you provide the formula that you use and it works?"}, {"owner": {"reputation": 31, "user_id": 8640883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a253206118db183964258f15979670?s=128&d=identicon&r=PG&f=1", "display_name": "dantab22", "link": "https://stackoverflow.com/users/8640883/dantab22"}, "reply_to_user": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1505907799, "post_id": 46320884, "comment_id": 79602965, "body": "I might be missing the obvious here but if LD = 12 then that would only go 1 step?   The formulas: At cell C7, to calculate the monthly payment we use: =C6*((C4/12)*(1+(C4/12))^(C5))/((1+(C4/12))^(C5) - 1)  EDIT: Pressed enter early. Monthly Payment = Principle*(i(1+i)^loan duration)/((1+i)^loan duration) -1), where i = Annual interest/12"}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1505908045, "post_id": 46320884, "comment_id": 79603097, "body": "You are right. So instead of using <code>LD</code> use <code>LD +10</code>. To be fair, your code works fine the way it is. I just thing this would make it look nicer instead of having <code>10+</code> everywhere. It&#39;s more like a personal thing."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8640883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a253206118db183964258f15979670?s=128&d=identicon&r=PG&f=1", "display_name": "dantab22", "link": "https://stackoverflow.com/users/8640883/dantab22"}, "edited": false, "score": 0, "creation_date": 1505911388, "post_id": 46321511, "comment_id": 79605487, "body": "Thanks for the roundIt code. It still seems to be giving the same problem. I don&#39;t understand why when cell referencing the formulas in the worksheet and dragging it doesn&#39;t yield the same &#39;numerical&#39; error. I will have to go through each line one by one and see where the problem is."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 31, "user_id": 8640883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a253206118db183964258f15979670?s=128&d=identicon&r=PG&f=1", "display_name": "dantab22", "link": "https://stackoverflow.com/users/8640883/dantab22"}, "edited": false, "score": 0, "creation_date": 1505926123, "post_id": 46321511, "comment_id": 79616169, "body": "I&#39;ll add a more readable approach similar to yours to my answer. It&#39;s better code style to use fully qualified reference to a range. BTW, An annuity formula will always have some rounding differences, if it&#39;s not to much you will add/substract this in the last line."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1505927929, "post_id": 46321511, "comment_id": 79617200, "body": "There is also the short version <code>.Range(&quot;C2:E11&quot;).Formula = Array(&quot;=SUM(A2:B2)&quot;, &quot;=PRODUCT(A2:B2)&quot;, &quot;=A2&#47;B2&quot;)</code> or <code>.Range(&quot;C2:E11&quot;).Formula = [{&quot;=SUM(A2:B2)&quot;, &quot;=PRODUCT(A2:B2)&quot;, &quot;=A2&#47;B2&quot;}]</code>"}, {"owner": {"reputation": 31, "user_id": 8640883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a253206118db183964258f15979670?s=128&d=identicon&r=PG&f=1", "display_name": "dantab22", "link": "https://stackoverflow.com/users/8640883/dantab22"}, "edited": false, "score": 0, "creation_date": 1506372909, "post_id": 46321511, "comment_id": 79785921, "body": "Sorry for the late reply. Thanks for the detailed reply. The neatness of your code gives me a lot to learn from! It still yields the same error I occurred from my original code. I will play around with AutoFill routine to see if I can learn something new which will assist me in getting a correct solution"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 31, "user_id": 8640883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a253206118db183964258f15979670?s=128&d=identicon&r=PG&f=1", "display_name": "dantab22", "link": "https://stackoverflow.com/users/8640883/dantab22"}, "edited": false, "score": 0, "creation_date": 1506409724, "post_id": 46321511, "comment_id": 79797021, "body": "@dantab22, it would help if you show the underlying formulas as well as the set formatting in D11:G11 to analyze the differences. As I mentioned already, any rounding will lead to a (minimal) difference. I suppose that you didn&#39;t round your cell range, so that you see only formatted values (only rounded in Display) which , in fact, are calculated with their mathematical values. I think this to be an acceptable answer."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 31, "user_id": 8640883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a253206118db183964258f15979670?s=128&d=identicon&r=PG&f=1", "display_name": "dantab22", "link": "https://stackoverflow.com/users/8640883/dantab22"}, "edited": false, "score": 0, "creation_date": 1506608921, "post_id": 46321511, "comment_id": 79898426, "body": "@dantab22, I&#39;d be glad to hear from you if you did actually round in your worksheet version and if this is the solution to your problem - this would help other readers, too. See also (<a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>)"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1505927650, "last_edit_date": 1505927650, "creation_date": 1505908849, "answer_id": 46321511, "question_id": 46320884, "link": "https://stackoverflow.com/questions/46320884/banker-rounding-in-vba/46321511#46321511", "title": "Banker Rounding in VBA?", "body": "<p><strong>An alternative to the worksheet function (avoiding bankers' rounding):</strong></p>\n\n<pre><code>Function roundIt(ByVal d As Double, ByVal nDigits As Integer) As Double\n' Purpose: avoid so called bankers' rounding in VBA (5 always rounds even)\nIf nDigits &gt; 0 Then\n   ' if european colon instead of point separartor\n   ' roundIt= val(Replace(Format(d, \"0.\" &amp; String(nDigits, \"0\")), \",\", \".\"))\n     roundIt= val(Format(d, \"0.\" &amp; String(nDigits, \"0\")))\nElse\n   ' if european colon instead of point separartor\n   ' roundIt =  val(Replace(Format(d / (10 ^ nDigits), \"0.\"), \",\", \".\"))\n   roundIt = val(Format(d / (10 ^ nDigits), \"0.\"))\nEnd If\nEnd Function\n</code></pre>\n\n<p>Always use \"Option explicit\" to check your declarations.\nCode gets more readable if you use a Type structure.\nWrite this in the <strong>declaration head</strong> of your module.</p>\n\n<pre><code>Option Explicit\n\nType TLoan\n   Interest       As Double\n   LD             As Integer\n   Principal      As Double\n   Annuity        As Double\nEnd Type\n</code></pre>\n\n<p><strong>Here is your code with some additions</strong></p>\n\n<pre><code>Sub Loan2()\nDim loan As TLoan                                   ' declare loan as of type TLoan\nDim i As Integer                                    ' no more use for LD \", LD As Integer\"\nDim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"MySheetName\")     ' fully qualified range\n\nWith loan\n  .Interest = ws.Range(\"C4\").Value\n  .LD = ws.Range(\"C5\").Value\n  .Principal = ws.Range(\"C6\").Value\n  .Annuity = ws.Range(\"C7\").Value\nEnd With\n\nWith ws\n  .Range(\"B10\").Value = 0\n  .Range(\"F10\").Value = loan.Principal              ' principal\n  .Range(\"B11\", \"G1000\").ClearContents\n  .Range(\"B11\", \"G1000\").Interior.ColorIndex = xlNone\n\n  For i = 1 To loan.LD\n    .Cells(10 + i, 2).Value = i                     'Payment Period\n    .Cells(10 + i, 3) = roundIt(loan.Annuity, 2)   'Monthly Payment\n    .Cells(10 + i, 5) = roundIt(.Cells(10 + i - 1, 6) * (loan.Interest / 12), 2) 'Interest payment\n    .Cells(10 + i, 4) = roundIt(.Cells(10 + i, 3).Value - .Cells(10 + i, 5).Value, 2) 'Principle payment\n    .Cells(10 + i, 6).Value = Cells(10 + i - 1, 6).Value - .Cells(10 + i, 4).Value    'Balance\n    .Cells(10 + i, 7) = .Cells(10 + i, 4).Value + .Cells(10 + i, 5).Value             'Sum of principle and interest.\n  Next i\nEnd With\nEnd Sub\n</code></pre>\n\n<p><strong>Additional tip (autofill Routine)</strong></p>\n\n<p>Try to use an autofill routine as shown in \"Excel-VBA-autofill multiple cells with formula <a href=\"https://stackoverflow.com/questions/22104743/excel-vba-autofill-multiple-cells-with-formulas\">Excel VBA: AutoFill Multiple Cells with Formulas</a>, if you want to include formulas instead of pure values.</p>\n\n<p><strong>Attention:</strong> This code refers to another problem with different ranges! Try and play around.</p>\n\n<pre><code>Sub FillDown()\n\nDim strFormulas(1 To 3) As Variant\n\nWith ThisWorkbook.Sheets(\"Formeln\")\n    strFormulas(1) = \"=SUM(A2:B2)\"\n    strFormulas(2) = \"=PRODUCT(A2:B2)\"\n    strFormulas(3) = \"=A2/B2\"\n'    Pattern Formulas\n    .Range(\"C2:E2\").Formula = strFormulas\n'    AutoFill Target\n    .Range(\"C2:E11\").FillDown\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8640883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7a253206118db183964258f15979670?s=128&d=identicon&r=PG&f=1", "display_name": "dantab22", "link": "https://stackoverflow.com/users/8640883/dantab22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 861, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1505927650, "creation_date": 1505907058, "last_edit_date": 1531164843, "question_id": 46320884, "link": "https://stackoverflow.com/questions/46320884/banker-rounding-in-vba", "title": "Banker Rounding in VBA?", "body": "<p>I am trying to build a Mortgage Amortization calculator using <code>VBA</code>.\nWhen I type the formulas in the worksheet and reference each cell to the formula then my calculator works fine. It requires me to drag all my formulas down to duration of the loan.\nFor example, if loan duration is 300 months, I can just drag the formulas to say cell number 300 and it will work fine.</p>\n\n<p>PROBLEM: When I use <code>VBA</code> code to do the same I get essentially a rounding problem where after the end of the term, I don't get a balance of 0.00. I have tried both normal round function and <code>Application.WorksheetFunction.Round</code> and it still yields the same result.\nWhy do my calculations work on the worksheet but when translated into VBA code I get different results?\nLink to screenshot of my spreadsheet which corresponds to the code: \n<a href=\"https://i.stack.imgur.com/oWdla.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oWdla.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nSub Loan2()\n\nDim i As Integer, LD As Integer\nLD = Range(\"C5\").Value\nRange(\"B11\", \"G1000\").ClearContents\nRange(\"B11\", \"G1000\").Interior.ColorIndex = xlNone\nFor i = 1 To LD\n    Cells(10 + i, 2).Value = i 'Payment Period\n    Cells(10 + i, 3) = Application.WorksheetFunction.Round(Range(\"C7\").Value, 2) 'Monthly Payment\n    Cells(10 + i, 5) = Application.WorksheetFunction.Round(Cells(10 + i - 1, 6) * (Range(\"C4\").Value / 12), 2) 'Interest payment\n    Cells(10 + i, 4) = Application.WorksheetFunction.Round(Cells(10 + i, 3).Value - Cells(10 + i, 5).Value, 2) 'Principle payment\n    Cells(10 + i, 6).Value = Cells(10 + i - 1, 6).Value - Cells(10 + i, 4).Value 'Balance\n    Cells(10 + i, 7) = Cells(10 + i, 4).Value + Cells(10 + i, 5).Value 'Sum of principle and interest.\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1505904746, "post_id": 46319524, "comment_id": 79600896, "body": "I am not sure what exactly your question is. Can you formulate the exact step you need help with in one sentence?"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1505905586, "creation_date": 1505905586, "answer_id": 46320394, "question_id": 46319524, "link": "https://stackoverflow.com/questions/46319524/iterating-through-row-range-group-data-and-take-an-action/46320394#46320394", "title": "Iterating through row range group data and take an action", "body": "<p>You will be better placed to confront confusion if you do your indenting more logically. Related <code>For / Next</code>, <code>If / Else / End If</code> and <code>With / End With</code> should always be on the same indent level for easier reading. I rearranged your original code like this:-</p>\n\n<pre><code>For Each Cell In Rng1\n    If 1 &lt; Application.CountIf(Rng1, Cell.Value) Then\n        With Cell\n            .Offset(0, 4) = \"duplicate : \"\n            .Offset(0, 5) = lp\n        End With\n    Else\n        With Cell\n            .Offset(0, 4) = \"NOT duplicate : \"\n            .Offset(0, 5) = 0\n        End With\n    End If\nNext Cell\n</code></pre>\n\n<p>It now becomes apparent that the <code>With Cell / End With</code> need not be duplicated. I have further presumed that your variable <code>lp</code> actually was intended to hold the count. That made me arrive at the following compression of your code.</p>\n\n<pre><code>Dim Rng1 As Range\nDim Cell As Range\nDim lp As Integer\n\n' the sheet isn't specified: uses the ActiveSheet\nSet Rng1 = Range(\"B5:B\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row)\n\nFor Each Cell In Rng1\n    With Cell\n        lp = Application.CountIf(Rng1, .Value)\n        .Offset(0, 4) = IIf(lp, \"\", \"NOT \") &amp; \"duplicate : \"\n        .Offset(0, 5) = lp\n    End With\nNext Cell\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1505906196, "creation_date": 1505906196, "answer_id": 46320607, "question_id": 46319524, "link": "https://stackoverflow.com/questions/46319524/iterating-through-row-range-group-data-and-take-an-action/46320607#46320607", "title": "Iterating through row range group data and take an action", "body": "<p>Consider using a Dictionary or Collection, whenever, checking for duplicates.</p>\n\n<p>Here I use a Dictionary of Dictionaries to compile lists of Persons by Manager.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yLzIb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yLzIb.jpg\" alt=\"Output\"></a></p>\n\n<pre><code>Sub ListManagerList1()\n    Dim cell As Range\n    Dim manager As String, person As String\n    Dim key As Variant\n\n    Dim dictManagers As Object\n    Set dictManagers = CreateObject(\"Scripting.Dictionary\")\n\n    For Each cell In Range(\"B5:B\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row)\n        manager = cell.Value\n        person = cell.Offset(0, -1).Value\n\n        If Not dictManagers.Exists(manager) Then\n            dictManagers.Add manager, CreateObject(\"Scripting.Dictionary\")\n        End If\n\n        If Not dictManagers(manager).Exists(person) Then\n            dictManagers(manager).Add person, vbNullString\n        End If\n    Next\n\n    For Each key In dictManagers\n        Debug.Print key &amp; \" -&gt; \"; Join(dictManagers(key).Keys(), \",\")\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>I recommend you wanting <a href=\"https://www.youtube.com/watch?v=dND4coLI_B8&amp;t=420s&amp;index=43&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 39 - Dictionaries</a></p>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1505907428, "creation_date": 1505907428, "answer_id": 46321024, "question_id": 46319524, "link": "https://stackoverflow.com/questions/46319524/iterating-through-row-range-group-data-and-take-an-action/46321024#46321024", "title": "Iterating through row range group data and take an action", "body": "<p>Assuming your data is as in the image </p>\n\n<p><a href=\"https://i.stack.imgur.com/qzQSE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qzQSE.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then following code will give you result as in the image below.</p>\n\n<pre><code>Sub Demo()\n    Dim srcSht As Worksheet, destSht As Worksheet\n    Dim lastRow As Long, i As Long\n    Dim arr1(), arr2()\n    Dim dict As Object\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n    Set srcSht = ThisWorkbook.Sheets(\"Sheet2\")  'change Sheet2 to your data sheet\n    Set destSht = ThisWorkbook.Sheets(\"Sheet1\") 'change Sheet1 to your output sheet\n\n    arr1 = Application.Index(srcSht.Cells, [row(1:7000)], Array(2, 1))  'See note below\n    arr2 = arr1\n\n    For i = 1 To UBound(arr1, 1)\n        If Not dict.exists(LCase$(arr1(i, 1))) Then\n            dict.Add LCase$(arr1(i, 1)), i\n        Else\n            arr2(i, 1) = vbNullString\n            arr2(dict.Item(LCase$(arr1(i, 1))), 2) = arr2(dict.Item(LCase$(arr1(i, 1))), 2) &amp; \",\" &amp; arr1(i, 2)\n        End If\n    Next\n    destSht.Range(\"A1\").Resize(UBound(arr1, 1), UBound(arr1, 2)) = arr2 'display result\n    destSht.Columns(\"a\").SpecialCells(xlBlanks).EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/medQU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/medQU.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>Note :</em></strong> For details on assigning range to array see <a href=\"https://www.mrexcel.com/forum/excel-questions/564473-transfer-multiple-ranges-one-array.html\" rel=\"nofollow noreferrer\">this</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8634867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e297eef80b9895bdde15431c11f649?s=128&d=identicon&r=PG&f=1", "display_name": "SKT", "link": "https://stackoverflow.com/users/8634867/skt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1551919868, "creation_date": 1505903004, "last_edit_date": 1551919868, "question_id": 46319524, "link": "https://stackoverflow.com/questions/46319524/iterating-through-row-range-group-data-and-take-an-action", "title": "Iterating through row range group data and take an action", "body": "<p>I am getting to know Excel VBA. I have a working program that uses an action button on one sheet opens a source workbook and data worksheet, selects data and puts that into a second workbook and destination sheet. I then sort the data as needed and it looks like this<br>\n<a href=\"https://i.stack.imgur.com/Goo1W.png\" rel=\"nofollow noreferrer\">Destination sheet, sorted and annotated duplicates</a></p>\n\n<p>I am now trying to select the data based on col 2 \"B\" where the items are duplicated and/or not duplicated then perform an action (send an email to the manager about the staff under their control). I can get an email to work but its selecting the data that I'm having trouble with.</p>\n\n<p>the output data would be col 1 &amp; col 3 to 5 e.g.</p>\n\n<hr>\n\n<p>Dear Manager1,</p>\n\n<p>you staff member/s listed below have achieved  xyz</p>\n\n<ol>\n<li>Person1   22/06/2017  11/08/2017  22/08/2017</li>\n<li>Person11  22/06/2017  11/08/2017  22/08/2017</li>\n<li>Person15  22/06/2017  11/08/2017  22/08/2017</li>\n</ol>\n\n<p>congratulations....</p>\n\n<hr>\n\n<p>So what I hope somebody can help me with is a clue how I get to look at the data in col 2\nadd the Row data required to an array or something then to check the next Row add it to the same something until it is different to the next Row <br/>Pause do the action then do the next iteration.  Resulting in:</p>\n\n<ul>\n<li>Manager1 .....Person 1,11,15<h3>action</h3></li>\n<li>Manager10 ..... Person 10<h3>action</h3></li>\n<li>Manager2 ..... Person 12,16,2,25,28<h3>action</h3></li>\n<li>Manager3 ..... Person 13,17,26,29,3<h3>action</h3></li>\n</ul>\n\n<p>until last line is reached.</p>\n\n<p>I am so confused with arrays / lookups and loops I have lost the plot somewhere along the way.<br>\nI have a variable <strong>lastTmp</strong> which tells me the last line of data in the set, this will vary each month.<br>\nThe Range is:<br>\n<code>Set rng1 = Range(\"B5:B\" &amp; Cells(Rows.Count, \"B\").End(xlUp).row)</code><br>\nThe last piece of my working code is:</p>\n\n<pre><code>Dim lp As Integer\nlp = 1\nFor Each cell In rng1\n    If 1 &lt; Application.CountIf(rng1, cell.Value) Then\n        With cell\n                .Offset(0, 4) = \"duplicate : \"\n                .Offset(0, 5) = lp\n                End With\n                Else\n                With cell\n                .Offset(0, 4) = \"NOT duplicate : \"\n                .Offset(0, 5) = 0\n                End With\n        End If\n    Next cell\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 440, "user_id": 8535397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85bf67ccf8b1233bd12086eb224971f?s=128&d=identicon&r=PG&f=1", "display_name": "Tigregalis", "link": "https://stackoverflow.com/users/8535397/tigregalis"}, "edited": false, "score": 0, "creation_date": 1506050706, "post_id": 46344907, "comment_id": 79672496, "body": "Thanks. This is what I needed."}, {"owner": {"reputation": 440, "user_id": 8535397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85bf67ccf8b1233bd12086eb224971f?s=128&d=identicon&r=PG&f=1", "display_name": "Tigregalis", "link": "https://stackoverflow.com/users/8535397/tigregalis"}, "edited": false, "score": 1, "creation_date": 1506052106, "post_id": 46344907, "comment_id": 79672842, "body": "Minimal solution: <b>Controller.xlsm &gt; ThisWorkbook:</b> <code>Public SourceDocument As Word.Document \\ Sub SetContext(ByRef wdDoc As Word.Document) \\ Set SourceDocument = wdDoc \\ End Sub</code> <b>Normal.dotm &gt; Module1:</b> <code>Sub LoadController() \\ Dim xlApp As New Excel.Application \\ Dim xlWb As Excel.Workbook \\ Dim SourceDocument As Document \\ Set SourceDocument = ActiveDocument \\ xlApp.Visible = True \\ Set xlWb = xlApp.Workbooks.Open(FileName:=&quot;C:\\...\\Controller.xlsm&quot;, ReadOnly:=True) \\ xlApp.Run &quot;ThisWorkbook.SetContext&quot;, SourceDocument \\ End Sub</code>"}], "tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 1, "last_activity_date": 1505999605, "creation_date": 1505999605, "answer_id": 46344907, "question_id": 46319461, "link": "https://stackoverflow.com/questions/46319461/manipulate-a-word-document-caller-context-from-an-excel-workbook-callee/46344907#46344907", "title": "Manipulate a word document (&quot;caller&quot;/&quot;context&quot;) from an excel workbook (&quot;callee&quot;/&quot;controller&quot;) that was opened by it", "body": "<p>I have tested this and it worked perfectly with Office 2010.</p>\n\n<p><strong>Note</strong> that you need the Excel Library in your Word Normal Template and the Word Library in the <code>Excel Reference Check.xlsm</code></p>\n\n<p>You will need the following:</p>\n\n<p>Sub in the <code>ThisWorkBook</code> module in the  <code>Reference Check.xlsm</code>. </p>\n\n<p>So in your Excel VBA Project -> Microsoft Excel Objects -> ThisWorkBook</p>\n\n<pre><code>Option Explicit\n\nSub ExcelWordController(WordDocFromWord As Document)\n\n    'If you are wanting to use it as a Document then _\n        you will need the Word Library in Excel\n\n    MsgBox WordDocFromWord\n\n    'Just put some funny text inthe doc for a test\n    WordDocFromWord.Range(0, 0).Text = \"Yeah Baby It works\"\n\n    'Here you can then call someother Sub or so some processing\n\nEnd Sub\n</code></pre>\n\n<p>Then in your <code>Word</code> <code>Normal</code> project:</p>\n\n<pre><code>Option Explicit\n\n'Sub in Word Normal\nSub ExcelControlWordFromWordInitiation()\n\n    'Obvisouly you alrady have the Excel Library in the Word Doc\n\n    Dim xlApp As New Excel.Application\n    'xlWorkbook is a object in the Word Excel Library\n    'So I changed the name\n    Dim RefCheckWorkBook As Excel.Workbook\n    Dim R As Excel.Range\n\n    Dim SourceDocument As Document\n    Set SourceDocument = ActiveDocument\n\n    'You want to be able to see the Excel Application\n    xlApp.Visible = True\n\n    Set RefCheckWorkBook = xlApp.Workbooks.Open(Environ(\"USERPROFILE\") &amp; \"\\Desktop\\Reference Check.xlsm\")\n\n    'Calling the Sub in Excel from Word\n    Excel.Application.Run \"ThisWorkBook.ExcelWordController\", SourceDocument\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 440, "user_id": 8535397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85bf67ccf8b1233bd12086eb224971f?s=128&d=identicon&r=PG&f=1", "display_name": "Tigregalis", "link": "https://stackoverflow.com/users/8535397/tigregalis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 46344907, "answer_count": 1, "score": 1, "last_activity_date": 1505999605, "creation_date": 1505902818, "last_edit_date": 1531164843, "question_id": 46319461, "link": "https://stackoverflow.com/questions/46319461/manipulate-a-word-document-caller-context-from-an-excel-workbook-callee", "title": "Manipulate a word document (&quot;caller&quot;/&quot;context&quot;) from an excel workbook (&quot;callee&quot;/&quot;controller&quot;) that was opened by it", "body": "<h1>Background</h1>\n\n<p>I have a Word-macro in <code>Normal.dotm</code> that opens an Excel-workbook <code>Reference Check.xlsm</code>.</p>\n\n<p>The macro uses <code>RegExp</code> as well as <code>Range.Find</code> to find strings of a certain pattern, and then it places this information onto sheets in the Excel-workbook.</p>\n\n<p>This is the basic template:</p>\n\n<pre><code>Sub GetReferencesAndHyperlinksToExcel()\n' Shortcut Key: Ctrl+[Num *]\n\n    Dim oRegex As New RegExp\n    Dim oRegExMatches As MatchCollection\n    Dim oRegExMatch As Match\n    Const strPattern As String = \"(my pattern)\"\n\n    Dim SourceDocument As Document\n    Dim oStory As Range\n    Dim hl As Hyperlink\n\n    Dim xlApp As New Excel.Application\n    Dim xlWorkbook As Excel.Workbook\n    Dim R as Excel.Range\n\n    ' Set the context\n    Set SourceDocument = ActiveDocument\n\n    ' Load the spreadsheet\n    Set xlWorkbook = xlApp.Workbooks.Open(\"C:\\...\\Reference Check.xlsm\")\n\n    ' Set starting range to write to\n    With xlWorkbook.Worksheets(\"Reference Checks\")\n        .Range(\"ref\").ClearContents\n        Set R = .Range(\"ref\")(1, 1)\n    End With\n\n    ' Initialise regex\n    With oRegex\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = strPattern\n    End With\n\n    ' ==== Iterate through story ranges, then execute regex and write matches and hyperlinks to the spreadsheet ====\n\n    ' ==== Iterate through story ranges, then iterate through hyperlinks and write hyperlinks to the spreadsheet ====\n\nEnd Sub\n</code></pre>\n\n<p>The Excel-workbook does some calculations and lookups (with pre-filled column formulas) against a Data Table within the Workbook.</p>\n\n<p>Using that information, I manipulate the active Word document (the \"caller\" or the \"context\") in <strong>predictable</strong>^ ways.</p>\n\n<p>^If it's predictable, then we should be able to use a macro to do the work for us.</p>\n\n<h1>The problem</h1>\n\n<p>I want to use the now-open Excel workbook <code>Reference Checks.xlsm</code> as a \"console\" or \"controller\", where I can change some data, and use data, to perform operations on (make changes to) the document.</p>\n\n<p>To do this, I believe I need to somehow be able to refer to the original \"caller\" or \"context\", i.e. the Word document that was Active when I originally called it (<code>Set SourceDocument = ActiveDocument</code>), from within the now-open Workbook. This means that either:</p>\n\n<ol>\n<li>Macros within Excel (tied to Buttons) <code>Reference Check.xlsx</code> act on <code>SourceDocument</code> <em>(preferred)</em>, or</li>\n<li>Macros within Excel (tied to Buttons) <code>Reference Check.xlsx</code> call a Macro within Word <code>Normal.dotm</code> and then act on the <code>SourceDocument</code>* <em>(if this is possible, the above should be)</em>, or</li>\n<li>Various macros within <code>Normal.dotm</code> act on <code>SourceDocument</code>* <em>(workable, but clunky)</em></li>\n</ol>\n\n<p>*Note: This must actually be <code>SourceDocument</code> (the \"caller\" or \"context\") and not <code>ActiveDocument</code>, because it is possible that as I switch between windows, another document could become <code>ActiveDocument</code>.</p>\n\n<h1>Things I've thought of</h1>\n\n<p>For option 1, use a global variable in <code>Reference Checks.xlsm</code>, then when I load the workbook, set the reference to <code>SourceDocument</code>. This is my preferred option. I have no idea how to do this, however.</p>\n\n<p>For option 3, use a global variable in <code>Normal.dotm</code>, set the reference to the workbook when I open it, then read information in the workbook when I call the macros. A drawback would be that I have many macros I might call, and I would have to have many public subs (makes <code>Normal.dotm</code> quite unwieldy).</p>\n\n<h1>Help</h1>\n\n<p>How do I do this?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8639084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0c806a55198114f307f9a20ad181fbb?s=128&d=identicon&r=PG&f=1", "display_name": "NorxEz", "link": "https://stackoverflow.com/users/8639084/norxez"}, "edited": false, "score": 1, "creation_date": 1505902994, "post_id": 46319385, "comment_id": 79599813, "body": "Ok, that was trivial. And somehow exactly what I tried before. Just I didnt use a Public Sub and didnt manage to get the &quot;\u2022&quot; into it, cause it would Change the Symbol. Thank You :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1505902621, "creation_date": 1505902621, "answer_id": 46319385, "question_id": 46319163, "link": "https://stackoverflow.com/questions/46319163/how-to-search-for-symbols-within-a-vba-makro-for-word/46319385#46319385", "title": "How to search for symbols within a VBA Makro for Word", "body": "<p>Something as easy as this works for me:</p>\n\n<pre><code>Public Sub Testme()\n\n    With Selection.Find\n        .ClearFormatting\n        .Text = \"\u2022\"\n        .Execute Forward:=True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>If this is the bullet format and not a simple dot in a text, then you may use something like this to select the bulleted paragraph:</p>\n\n<pre><code>Sub FindBullet()\n    Dim rngTarget As Word.Range\n    Dim oPara As Word.Paragraph\n\n    Set rngTarget = Selection.Range\n    With rngTarget\n        Call .Collapse(wdCollapseEnd)\n        .End = ActiveDocument.Range.End\n\n        For Each oPara In .Paragraphs\n            If oPara.Range.ListFormat.ListType = _\n               WdListType.wdListBullet Then\n                oPara.Range.Select\n                Exit For\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://wordribbon.tips.net/T008259_Finding_Formatted_Bulleted_Paragraphs.html\" rel=\"nofollow noreferrer\">Source here</a>.</p>\n"}], "owner": {"reputation": 25, "user_id": 8639084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0c806a55198114f307f9a20ad181fbb?s=128&d=identicon&r=PG&f=1", "display_name": "NorxEz", "link": "https://stackoverflow.com/users/8639084/norxez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 46319385, "answer_count": 1, "score": 1, "last_activity_date": 1505902621, "creation_date": 1505902010, "question_id": 46319163, "link": "https://stackoverflow.com/questions/46319163/how-to-search-for-symbols-within-a-vba-makro-for-word", "title": "How to search for symbols within a VBA Makro for Word", "body": "<p>I\u00b4m new to <strong>VBA</strong> and have to write a little Makro for work.\nThis Makro will be used to search for a Special set of symbols inside a <strong>Word Document</strong>. </p>\n\n<p>So far I found a way to search for a string and mark it. \nYet it only functions with normal chars. The question is how to include symbols into the search.</p>\n\n<p>My code so far is:</p>\n\n<pre><code>With Selection.Find\n    .ClearFormatting\n    .Text = \"String\"\n    .Execute Forward:=True\nEnd With\n</code></pre>\n\n<p>The symbol-string needed to be found inside the document is: [\u2022]</p>\n\n<p>Thank You for Your Suggestions</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2007"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1505902775, "post_id": 46319060, "comment_id": 79599667, "body": "Use the first 255 characters in the find, then test each found cell against the full value."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 5, "creation_date": 1505904282, "post_id": 46319060, "comment_id": 79600611, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11724067/excel-range-find-using-a-string-longer-than-255-characters\">Excel.Range.Find using a string longer than 255 characters</a>.  Although the question has to do with C#, the answer has a useful VBA solution."}, {"owner": {"reputation": 105, "user_id": 8335985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a1cc1866b9e739b5bb77ae587886f8a?s=128&d=identicon&r=PG&f=1", "display_name": "PHP Enthu", "link": "https://stackoverflow.com/users/8335985/php-enthu"}, "edited": false, "score": 0, "creation_date": 1505904942, "post_id": 46319060, "comment_id": 79601009, "body": "so even in excel 2007/13/1, will I have to do the same?"}], "owner": {"reputation": 105, "user_id": 8335985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a1cc1866b9e739b5bb77ae587886f8a?s=128&d=identicon&r=PG&f=1", "display_name": "PHP Enthu", "link": "https://stackoverflow.com/users/8335985/php-enthu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 440, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1505906029, "creation_date": 1505901748, "last_edit_date": 1505906029, "question_id": 46319060, "link": "https://stackoverflow.com/questions/46319060/handle-more-than-255-characters-in-what-attribute-of-cells-find", "title": "Handle more than 255 characters in what:= attribute of Cells.find()", "body": "<p>Here <code>newStr</code> has sometimes more than 255 chars, and then it gives Type 13, mismatch error. Any suggestion ? I am aware that it is not possible in Office 2007 or below, how about later versions?</p>\n\n<pre><code>Set Variable = Cells.Find(What:=newStr, _\n                          After:=.Cells(1), _\n                        LookIn:=xlFormulas, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        matchcase:=yesno)\n</code></pre>\n"}, {"tags": ["excel", "vba", "events"], "comments": [{"owner": {"reputation": 1093, "user_id": 7814526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/leMzB.png?s=128&g=1", "display_name": "JensS", "link": "https://stackoverflow.com/users/7814526/jenss"}, "edited": false, "score": 0, "creation_date": 1505906244, "post_id": 46318949, "comment_id": 79601842, "body": "Can you please show the code you already have..."}, {"owner": {"reputation": 35, "user_id": 6445365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397ced349fb3d0e377802631289b2d3b?s=128&d=identicon&r=PG&f=1", "display_name": "\u0141ukasz d", "link": "https://stackoverflow.com/users/6445365/%c5%81ukasz-d"}, "reply_to_user": {"reputation": 1093, "user_id": 7814526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/leMzB.png?s=128&g=1", "display_name": "JensS", "link": "https://stackoverflow.com/users/7814526/jenss"}, "edited": false, "score": 0, "creation_date": 1507037006, "post_id": 46318949, "comment_id": 80045359, "body": "As I have written I have no clue how to do it. I have written a code that opens a workbook and copies a range from a predefined sheet. I wanted to make it more flexible to address a situation when sheet name is change (or order)                                                                                                                                                    My code is basically a  loop that goes through a range with files location, opens each and copies a range. how do I copy the code here? it says it is too long"}], "owner": {"reputation": 35, "user_id": 6445365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397ced349fb3d0e377802631289b2d3b?s=128&d=identicon&r=PG&f=1", "display_name": "\u0141ukasz d", "link": "https://stackoverflow.com/users/6445365/%c5%81ukasz-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505901469, "creation_date": 1505901469, "question_id": 46318949, "link": "https://stackoverflow.com/questions/46318949/excel-vba-workbook-event-on-file-that-was-open-with-vba", "title": "Excel VBA: Workbook Event on file that was open with VBA", "body": "<p>I am trying to do the following thing- I open a new worksheet with Worksheet.Open method and then on double-click in this open file copy the active tab to the initial spreadsheet. I have no clue on how to do the coping part, can it be done via Workbook Event?</p>\n\n<p>Lukasz</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1505900792, "post_id": 46318453, "comment_id": 79598361, "body": "You never increment <code>i</code> inside of <code>Do While i &lt;&gt; 94</code>."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1506090463, "post_id": 46319028, "comment_id": 79693757, "body": "what is the best way to empty my array for the next column?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1506091620, "post_id": 46319028, "comment_id": 79694514, "body": "<code>Redim myarray(0)</code> would erase all the data and resize the array to 1 element"}, {"owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1506092957, "post_id": 46319028, "comment_id": 79695305, "body": "I use Erase myarray and also myarray = &quot; &quot;. It cause error in line &quot;index = UBound(myarray2) &quot;. redim works better. But after 15th loop it shows different value which is number in countdown. with message subscript out of range in line &quot;rng1 = myarray(index)&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1506096105, "post_id": 46319028, "comment_id": 79697192, "body": "Could you post another question?  I&#39;m at work I&#39;m not sure if I will be able to help."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1505902491, "last_edit_date": 1505902491, "creation_date": 1505901658, "answer_id": 46319028, "question_id": 46318453, "link": "https://stackoverflow.com/questions/46318453/save-cell-address-in-array-and-use-it-as-variable-in-cell-formula/46319028#46319028", "title": "Save Cell.Address in array and use it as variable in cell formula", "body": "<p>You are trying to assign a string value to an array of Integers.  Changing <code>Dim myarray() As Integer</code> to <code>Dim myarray() As String</code> will correct the first error.</p>\n\n<p><code>Dim rng1 As String, rng2 As Integer, rng3 As Integer</code> should be changed to <code>Dim rng1 As String, rng2 As String, rng3 As String</code></p>\n\n<p>Don't use select unless absolutely necessary.</p>\n\n<pre><code>Set rng = Range(rng1, rng2)\nrng.Select\nFor Each cell In rng.Cells\n</code></pre>\n\n<p>This accomplishes the same then</p>\n\n<pre><code>For Each cell In Range(rng1, rng2)\n</code></pre>\n\n<p>Don't use a Loop when iterating over a specific range.</p>\n\n<p>In your <code>Do Loop</code> you never incremented <code>i</code>.  This will cause the routine to run indefinitely or until Excel crashes.</p>\n\n<p>This would probably do the same thing that your <code>Loop</code> was intended to do:</p>\n\n<pre><code>For i = 2 to 93\n\nNext\n</code></pre>\n\n<p><code>size = size + 1</code> and <code>index = index + 1</code> are doing redundant.  You resizing your array incorrectly leaving empty values that will cause errors later on:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vsyuV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vsyuV.jpg\" alt=\"myarray() demo\"></a></p>\n\n<pre><code>If .Cells(i, ncol) &gt;= 12 And .Cells(i - 1, ncol) &lt;= 12 Then\n    index = UBound(myarray)\n    If myarray(index) &lt;&gt; \"\" Then\n        index = index + 1\n        ReDim Preserve myarray(index)\n    End If\n    myarray(index) = .Cells(i, ncol).Address\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2335, "favorite_count": 0, "accepted_answer_id": 46319028, "answer_count": 1, "score": 2, "last_activity_date": 1505902491, "creation_date": 1505900212, "question_id": 46318453, "link": "https://stackoverflow.com/questions/46318453/save-cell-address-in-array-and-use-it-as-variable-in-cell-formula", "title": "Save Cell.Address in array and use it as variable in cell formula", "body": "<p>I have 37 columns x 92 rows. Some condition used to separate the data in each column which producing several separate ranges. Number of elements in each ranges need to be count so I use array to save the starting point address and set a range if end point is meet. Then loop inside the range using the CountIf application. \" myarray(index) = .Cells(i, ncol).Address\" line gives run-time error 13 type mismatch. Which part should I amend?. Thank you.</p>\n\n<pre><code>Option Explicit\n\nSub makeArray()\nDim ncol As Integer\nDim index As Integer, i As Integer\nDim size As Integer\nDim rng As Range, cell As Range\nDim rng1 As String, rng2 As Integer, rng3 As Integer\nDim myarray() As Integer\nReDim myarray(size)\n\nWith ThisWorkbook.Worksheets(\"sheet2 (2)\")\n For ncol = 2 To 37\n size = 1\n index = 0\n  For i = 2 To 93\n     'assign starting point and save cell.address in array\n     If .Cells(i, ncol) &gt;= 12 And .Cells(i - 1, ncol) &lt;= 12 Then\n     myarray(index) = .Cells(i, ncol).Address\n     size = size + 1\n     ReDim Preserve myarray(size)\n     index = index + 1\n     End If\n   Next i\n\n   i = 2\n   index = 0\n   Do While i &lt;&gt; 94\n     'assign end point and set range using array \n     If .Cells(i, ncol) &gt;= 12 And .Cells(i + 1, ncol) &lt;= 12 Then\n     rng1 = myarray(index)\n     rng2 = .Cells(i, ncol).Address\n     Set rng = Range(rng1, rng2)\n     rng.Select\n       For Each cell In rng.Cells\n       rng3 = .Cells(cell.Row, ncol).Address\n       .Cells(cell.Row, 74 + ncol).Formula = \" =CountIf(\" &amp; rng1 &amp; \":\" &amp; rng3 &amp; \",\" &amp; rng3 &amp; \")\"\n       Next cell\n       index = index + 1\n     End If\n   Loop\n\n Next ncol\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8640078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb45adc1134da9b407a3efeb289a41e7?s=128&d=identicon&r=PG&f=1", "display_name": "MLam", "link": "https://stackoverflow.com/users/8640078/mlam"}, "edited": false, "score": 1, "creation_date": 1506006599, "post_id": 46318338, "comment_id": 79655107, "body": "Thank you this helped me. I wanted to copy multiple columns. So I copied the code between with and changed the cells and destination for ws2. This seems to work."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1505899915, "creation_date": 1505899915, "answer_id": 46318338, "question_id": 46318220, "link": "https://stackoverflow.com/questions/46318220/copy-columns-with-varying-row-lengths-to-another-workbook/46318338#46318338", "title": "Copy columns with varying row lengths to another workbook", "body": "<p>In the code you posted you should qualify all cells with a sheet name in case it is not active when you run the macro. You will need to explain further the rest of your request as it is not clear (\"Column J needs to go column A and so on\").</p>\n\n<pre><code>Sub SO()\n\nDim lastRow As Long\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\nSet ws1 = Workbooks(\"Workbook1.xlsm\").Worksheets(\"Orderheader\")\nSet ws2 = Workbooks(\"Workbook2.xlsm\").Worksheets(\"Sheet1\")\n\nWith ws1\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    .Range(.Cells(2, 1), .Cells(lastRow, 1)).Copy\n    ws2.Range(\"A2\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8640078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb45adc1134da9b407a3efeb289a41e7?s=128&d=identicon&r=PG&f=1", "display_name": "MLam", "link": "https://stackoverflow.com/users/8640078/mlam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505900183, "creation_date": 1505899628, "last_edit_date": 1531164843, "question_id": 46318220, "link": "https://stackoverflow.com/questions/46318220/copy-columns-with-varying-row-lengths-to-another-workbook", "title": "Copy columns with varying row lengths to another workbook", "body": "<p>I need to copy columns from A2 to unknown row length to a new workbook. \nThe other workbook has other headers and I need to have Column A without header to Column C with another header and Column J needs to go column A and so on.</p>\n\n<p>I tried this code</p>\n\n<pre><code>Sub SO()\n\nDim lastRow As Long\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\nSet ws1 = Workbooks(\"Workbook1.xlsm\").Worksheets(\"Orderheader\")\nSet ws2 = Workbooks(\"Workbook2.xlsm\").Worksheets(\"Sheet1\")\n\nlastRow = ws1.Cells(ws1.Rows.Count, \"A\").End(xlUp).Row\n\nws1.Range(Cells(2, 1), Cells(lastRow, 1)).Copy\n\nws2.Range(\"A2\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n\n<p>It worked fine once and now it doesn't work. It also doesn't seem to work for multiple columns, which I really need. </p>\n\n<p>Now I get an error on \"Method 'Range' of object '_Worksheet' failed\"</p>\n\n<p>What am I doing wrong? </p>\n"}, {"tags": ["sql", "vba", "ado", "execute"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505909486, "post_id": 46318181, "comment_id": 79604066, "body": "You cant make them run at the same time. It doesnt work like that. You will have to find another alternative."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1505911480, "post_id": 46318181, "comment_id": 79605553, "body": "You can always insert two fields at the same time with an Insert Statement. <a href=\"https://msdn.microsoft.com/en-us/library/bb208861(v=office.12).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb208861(v=office.12).aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8596893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccab6a82b9b4e5b9ae76bf137548d642?s=128&d=identicon&r=PG&f=1", "display_name": "mmod", "link": "https://stackoverflow.com/users/8596893/mmod"}, "is_accepted": false, "score": 0, "last_activity_date": 1505914947, "creation_date": 1505914947, "answer_id": 46323726, "question_id": 46318181, "link": "https://stackoverflow.com/questions/46318181/ado-how-to-write-two-cnn-execute-commands-running-in-the-same-time/46323726#46323726", "title": "ADO - How to write two cnn.execute commands running in the same time?", "body": "<p>Thank you for yours comments. I go a little around -  I just added to range \"qqq\" column where is current date (now I am looking how do a autoupdate of it)</p>\n\n<pre><code>cnn.Execute \"INSERT INTO dane([IdTask],[Date]) SELECT [IdTask], [Teraz] FROM qqq_\n WHERE Line= '\" &amp; Me.ListBox1.List(lItem, 0) &amp; \"' And Task = '\" &amp;_\n Me.ListBox1.List(lItem, 1) &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8596893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccab6a82b9b4e5b9ae76bf137548d642?s=128&d=identicon&r=PG&f=1", "display_name": "mmod", "link": "https://stackoverflow.com/users/8596893/mmod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505914947, "creation_date": 1505899522, "question_id": 46318181, "link": "https://stackoverflow.com/questions/46318181/ado-how-to-write-two-cnn-execute-commands-running-in-the-same-time", "title": "ADO - How to write two cnn.execute commands running in the same time?", "body": "<p>I have this two working commands and I want them to work together, because now IdTask is pasted to, for example, row 1 and Date to row 2. I want them in the same row. I'm using ADO. </p>\n\n<pre><code> cnn.Execute \"INSERT INTO dane([IdTask]) SELECT (qqq.[IdTask]) FROM qqq_  \nWHERE Line= '\" &amp; Me.ListBox1.List(lItem, 0) &amp; \"' And Task = '\" &amp; Me.ListBox1.List(lItem, 1) &amp; \"'\"\n    cnn.Execute \"INSERT INTO dane ([Date]) VALUES (#\" &amp; MDate &amp; \"#)\"\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "pivot-table", "slicers", "vba"], "comments": [{"owner": {"reputation": 3878, "user_id": 4528269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e57eeb7fc4c275fd8d64640acbc8fb0e?s=128&d=identicon&r=PG&f=1", "display_name": "Ethan Field", "link": "https://stackoverflow.com/users/4528269/ethan-field"}, "edited": false, "score": 1, "creation_date": 1505899737, "post_id": 46318041, "comment_id": 79597603, "body": "This is off topic for Stack Overflow which is about asking <b>specific</b> and <b>answerable</b> <b>programming</b> related questions. This has nothing to do with a specific programming problem you are having. I would recommend that you try your luck on superuser.com however you will still need to ask something <b>specific</b> over there."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8627513, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-evQIKJvP0HM/AAAAAAAAAAI/AAAAAAAAAWM/XBjiK6FtxN0/photo.jpg?sz=128", "display_name": "Ravi Kant Agarwal", "link": "https://stackoverflow.com/users/8627513/ravi-kant-agarwal"}, "edited": false, "score": 0, "creation_date": 1506516454, "post_id": 46318267, "comment_id": 79852103, "body": "Hi Kresimir, Thanks for responding . I appreciate and your solution is working however it clicked something similar and sharing in case if you feel it will come handy. I created another coloumn in my table called &quot;Sale of Rest of team&quot;. In this col. I plotted - &quot;Total Sale - Sales of the team in corresponding Row) . For eg for Team one , this means ( Total sales- Sales of Team 1).  From here on .. life was easy and back to normal !!. I just created a normal pivot with slicer on team name and it compared the team one again rest of the teams !!! Thanks again .."}], "tags": [], "owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "is_accepted": true, "score": 0, "last_activity_date": 1505900084, "last_edit_date": 1505900084, "creation_date": 1505899742, "answer_id": 46318267, "question_id": 46318041, "link": "https://stackoverflow.com/questions/46318041/excel-pivot-slicer-or-via-vba/46318267#46318267", "title": "Excel - Pivot Slicer or Via VBA?", "body": "<p>You can achieve this with formula next to your PivotTable values. You will use formula against your total range of values in <code>col2</code>. If your columns are set to range <code>A:B</code>, and PivotTable is in range <code>D:E</code>, then put this formula <code>=E2/(SUM($B$2:$B$30)-SUMIF($A$2:$A$30,D2,$B$2:$B$30))</code> in cell <code>F2</code>. You should get result as follows. </p>\n\n<p><a href=\"https://i.stack.imgur.com/DbjKn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DbjKn.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you need to have result inside your PivotTable, then you should use PowerPivot and create a measure. try looking at this for more info: <a href=\"https://msdn.microsoft.com/en-us/library/gg399161(v=sql.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/gg399161(v=sql.110).aspx</a></p>\n"}], "owner": {"reputation": 25, "user_id": 8627513, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-evQIKJvP0HM/AAAAAAAAAAI/AAAAAAAAAWM/XBjiK6FtxN0/photo.jpg?sz=128", "display_name": "Ravi Kant Agarwal", "link": "https://stackoverflow.com/users/8627513/ravi-kant-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 46318267, "answer_count": 1, "score": 0, "last_activity_date": 1505900084, "creation_date": 1505899134, "last_edit_date": 1531161705, "question_id": 46318041, "link": "https://stackoverflow.com/questions/46318041/excel-pivot-slicer-or-via-vba", "title": "Excel - Pivot Slicer or Via VBA?", "body": "<p>I am posting this to all Excel Champs and Code Experts. I am familiar with Pivot and Slicer feature of excel however came with an requirement and I could not think of any way I can achieve it via pivot ( preferably ) </p>\n\n<p>The Requirement is like this. I  have team data in col 1 and Sales figures in col 2. Now with a simple pivot, I can have the team totals and things like that but I need to put in slicer on team name. If I select Team one , it should show Team one sales against total of other three team . PLease advice if there is a way to do that. In summary I need to compare a person's /team performance against total peers</p>\n\n<p>Team    Sales\nOne 20000\nTwo     15000\nThree   500\nFour    35000\nOne 500</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1505898432, "creation_date": 1505898432, "answer_id": 46317773, "question_id": 46317443, "link": "https://stackoverflow.com/questions/46317443/multi-criteria-dsum/46317773#46317773", "title": "Multi Criteria Dsum", "body": "<p>Dates must be enclosed with <code>#</code>. Also they need to be formatted in order to return the desired result.</p>\n\n<p>Try this:</p>\n\n<pre><code>StatusBox = DSum(\"[Task_time]\", \"[tbl_Data]\", \"[CDP] = '\" &amp; Environ(\"username\") &amp; \"' and [Record_Date] = #\" &amp; Format(Date, \"mm/dd/yyyy\") &amp; \"#\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1505901110, "creation_date": 1505901110, "answer_id": 46318791, "question_id": 46317443, "link": "https://stackoverflow.com/questions/46317443/multi-criteria-dsum/46318791#46318791", "title": "Multi Criteria Dsum", "body": "<p>You are just making it slightly too complicated:</p>\n\n<pre><code>StatusBox = DSum(\"[Task_time]\", \"[tbl_Data]\", \"[CDP] = '\" &amp; Environ(\"username\") &amp; \"' And [Record_Date] = Date()\")\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505901110, "creation_date": 1505897431, "question_id": 46317443, "link": "https://stackoverflow.com/questions/46317443/multi-criteria-dsum", "title": "Multi Criteria Dsum", "body": "<p>Im starting to pull my hair out.</p>\n\n<p>I am looking to do a multi criteria dsum that looks at the current user and todays date.</p>\n\n<p>Tried many variations but must be missing something very simple so any help is appreciated</p>\n\n<pre><code>StatusBox = DSum(\"[Task_time]\", \"[tbl_Data]\", \"[CDP] = '\" &amp; Environ(\"username\") &amp; \"' and [Record_Date] = '\" &amp; Date &amp; \"'\")\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1505909893, "post_id": 46317186, "comment_id": 79604377, "body": "How do you put data in Access? In query designer you can set &quot;Fail on Error&quot; and in VBA use <code>dbFailOnError</code> option of the <code>.Execute</code> method. Both will throw a datatype mismatch error (if that&#39;s the case)."}, {"owner": {"reputation": 73, "user_id": 8308208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f74fbc720f7277e6400790e80aa693?s=128&d=identicon&r=PG&f=1", "display_name": "Vix", "link": "https://stackoverflow.com/users/8308208/vix"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1505978224, "post_id": 46317186, "comment_id": 79635037, "body": "<code>dbFailOnError</code> will rolls back updates but I don&#39;t want this. When I try catch <code>Err.Number</code> in <code>myErr</code> and in if statement it shows that <code>myErr=0</code> but it is wrong because it dont import all data, skip number with <code>-</code> ."}], "owner": {"reputation": 73, "user_id": 8308208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f74fbc720f7277e6400790e80aa693?s=128&d=identicon&r=PG&f=1", "display_name": "Vix", "link": "https://stackoverflow.com/users/8308208/vix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505905116, "creation_date": 1505896671, "last_edit_date": 1505905116, "question_id": 46317186, "link": "https://stackoverflow.com/questions/46317186/convert-exception-access-special-chars", "title": "convert exception access special chars", "body": "<p>when I put data from excel to access database and access automaticaly set number type on fields but in excel I have number fields with '-' char. When I put data in access fields with '-' are empty. It's conversion error but access don't report it. How I can catch this error?</p>\n\n<pre><code>            myErr = Err.Number\n        myErr2 = Err.Description\n        If myErr &gt; 0 Then\n                              PrintMyLogNew myErr &amp; \" \" &amp; myErr2\n        End If\n</code></pre>\n"}, {"tags": ["vba", "excel", "execution"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1505895941, "post_id": 46316922, "comment_id": 79595154, "body": "For starters you need <code>If Target.Address = &quot;$D$1&quot; Then</code>."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1505896959, "post_id": 46317130, "comment_id": 79595789, "body": "In fairness to OP, it took quite a while before someone pointed out to me how to step through an event procedure (which was by adding a <code>Stop</code> statement). Perhaps there are other ways."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1505899927, "post_id": 46317130, "comment_id": 79597749, "body": "@SJR You can set a breakpoint in the event procedure by clicking in the margin."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1505900588, "post_id": 46317130, "comment_id": 79598232, "body": "@VincentG - so you can, how did I never know that!"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1505900883, "post_id": 46317130, "comment_id": 79598416, "body": "@SJR well, you can also use the F9 key, or use the toolbar button with an hand (Not sure if it shows up by default, you may have to customize the toolbar)"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1505896482, "creation_date": 1505896482, "answer_id": 46317130, "question_id": 46316922, "link": "https://stackoverflow.com/questions/46316922/event-triggered-vba-macro-runs-but-doesnt-execute/46317130#46317130", "title": "Event triggered VBA Macro runs, but doesn&#39;t execute", "body": "<p>Comparing two strings, such as <code>Target.Address</code> and <code>\"$d$1\"</code> using the following:</p>\n\n<pre><code>If Target.Address = \"$d$1\" Then\n</code></pre>\n\n<p>.. can never equate to <code>TRUE</code>, as if <code>Target.Address</code> did refer to column 4, row 1, it would hold the string <code>\"$D$1\"</code>. Using <code>=</code> to compare essentially uses <em>Binary Compare</em>.</p>\n\n<p>You either need to correct it to <code>\"$D$1\"</code>, or use a <em>Text Compare</em> method with the <code>StrComp</code> function.</p>\n\n<p>Stepping through the event, and hovering over the <code>Target.Address</code> would have highlighted this.</p>\n"}, {"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1505900562, "post_id": 46318409, "comment_id": 79598213, "body": "<code>If Target = Range(&quot;$D$1&quot;)</code> - no, that is wrong because it will compare values. Using <code>Address</code> is the way to go (or <code>Intersect</code>)."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1505901221, "post_id": 46318409, "comment_id": 79598678, "body": "@SJR I accept you&#39;re argument and have updated my answer as a result"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1505904441, "post_id": 46318409, "comment_id": 79600717, "body": "I wouldn&#39;t use the word <i>&#39;easier&#39;</i>. I&#39;d use the word <i>&#39;better&#39;</i>. It&#39;s not easier (there&#39;s more to type) but is a better method. You haven&#39;t mentioned <i>why</i> though, which could help the OP. (Why - because if more than one cell is changed at once - e.g. <code>Target.Address = &quot;$D$1:$D$2&quot;</code>, not using <code>Intersect</code> will mean the change is ignored if looking only for a single cell address.)"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1505911694, "last_edit_date": 1505911694, "creation_date": 1505900086, "answer_id": 46318409, "question_id": 46316922, "link": "https://stackoverflow.com/questions/46316922/event-triggered-vba-macro-runs-but-doesnt-execute/46318409#46318409", "title": "Event triggered VBA Macro runs, but doesn&#39;t execute", "body": "<p>As mentioned by the other poster - the binary comparison will never evaluate you argument to <code>True</code> you could either save the address as a string and change the argument to <code>If Target.Address = [Assigned String Name] Then</code> but it's much better to just change the argument to the following:</p>\n\n<pre><code>If Not Intersect(Target, Range(\"$D$1\")) Is Nothing And Target.Cells.Count = 1 Then\n\n    'code here\n\nEnd If\n</code></pre>\n\n<p>This mitigates the risk of code behaving not as you intended and also as it only passes the argument if only D1 changes and, as the comments below state, is the more appropriate code.</p>\n"}], "owner": {"reputation": 13, "user_id": 8639656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad7e23cfab68fefd17408f9a7299799d?s=128&d=identicon&r=PG&f=1", "display_name": "Michal S", "link": "https://stackoverflow.com/users/8639656/michal-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 46317130, "answer_count": 2, "score": 1, "last_activity_date": 1505940806, "creation_date": 1505895782, "last_edit_date": 1531164843, "question_id": 46316922, "link": "https://stackoverflow.com/questions/46316922/event-triggered-vba-macro-runs-but-doesnt-execute", "title": "Event triggered VBA Macro runs, but doesn&#39;t execute", "body": "<p>I have a pivot table with caculated item. Each time, when I change the parameter in the pivot main filter, text formatting goes back do default. </p>\n\n<p>In order not ot format the table each time, I created a macro, that should format the pivot table whenever I put a value in cell D1. C2 is the format sample cell. It appears that macro runs, but doesn't execute.</p>\n\n<p>Could You help?</p>\n\n<p>The code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Address = \"$d$1\" Then\n\nApplication.EnableEvents = False\n\n    Range(\"C2\").Activate\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n        \"=ORAZ(JE\u017bELI($B2=\" 'OFERTA/TOTAL RYNEK'\";1;0);JE\u017bELI(C2&gt;1;1;0))\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Font\n        .Color = -16776961\n        .TintAndShade = 0\n    End With\n\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent6\n        .TintAndShade = 0.399945066682943\n    End With\n\n    Selection.FormatConditions(1).StopIfTrue = False\n    Range(\"C2\").Select\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n        \"=ORAZ(JE\u017bELI($B1=\"\"OFERTA/TOTAL RYNEK\"\";1;0);JE\u017bELI(C1&gt;1;1;0))\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n\n    With Selection.FormatConditions(1).Font\n        .Color = -16776961\n        .TintAndShade = 0\n    End With\n\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent6\n        .TintAndShade = 0.399945066682943\n    End With\n\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.Copy\n    Columns(\"C:N\").Select\n    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = False\n\nApplication.EnableEvents = True\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1505899871, "post_id": 46316837, "comment_id": 79597710, "body": "If you are writing in Excel VBA, then the term <code>Application</code> applies to Excel. Excel Application doesn&#39;t have <code>ActiveExplorer</code> property. You should hook back to your Outlook Application which i do not see in the code supplied, like <code>Set myOlExp = myOutlookApp.ActiveExplorer</code>"}, {"owner": {"reputation": 69, "user_id": 8256713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/da5c5595467a75284612cd435cc0c699?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/8256713/mark"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1505901292, "post_id": 46316837, "comment_id": 79598725, "body": "What you mean on this? The code already set it to Outlook app in here <code>Dim myOlExp As Outlook.Explorer</code> right?"}], "answers": [{"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 1, "last_activity_date": 1505902128, "creation_date": 1505902128, "answer_id": 46319205, "question_id": 46316837, "link": "https://stackoverflow.com/questions/46316837/how-to-automate-reply-in-outlook-via-excel-vba/46319205#46319205", "title": "How to automate reply in outlook via Excel VBA?", "body": "<p>If you are writing in Excel VBA, then the term Application applies to Excel. Excel Application doesn't have ActiveExplorer property. You should hook back to your Outlook Application which i do not see in the code supplied, like Set <code>myOlExp = refToOutlookApplication.ActiveExplorer</code> </p>\n\n<p>Look at what you have shown above: </p>\n\n<p><code>Set myOlExp = Application.ActiveExplorer</code></p>\n\n<p>This means <code>Set myOlExp = Excel.Application.ActiveExplorer</code>, and the thing is that Excel Application has no Explorer Object.</p>\n\n<p>So you need: <code>Set myOlExp = refToOutlookApplication.ActiveExplorer</code></p>\n\n<p>You need to explicitly state that you wish to assign a variable to the property of the Outlook Application - which at this stage I am going to assume that you have created a reference somewhere else earlie in your module.</p>\n\n<p>If not, then you will need to do so with:</p>\n\n<pre><code>Dim refToOutlookApplication As Object    'Outlook.Application\nSet refToOutlookApplication = GetObject(, \"Outlook.Application\")\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8256713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/da5c5595467a75284612cd435cc0c699?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/8256713/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 46319205, "answer_count": 1, "score": 1, "last_activity_date": 1505902128, "creation_date": 1505895540, "question_id": 46316837, "link": "https://stackoverflow.com/questions/46316837/how-to-automate-reply-in-outlook-via-excel-vba", "title": "How to automate reply in outlook via Excel VBA?", "body": "<p>I'm trying my luck to have a program wherein you could reply to selected email in outlook using Excel VBA. Unfortunately, I can't find any working code.</p>\n\n<pre><code>Option Explicit\nSub ReplyMSG()\n  Dim olItem As Outlook.MailItem\n  Dim olReply As MailItem ' Reply\n  Dim olRecip As Recipient ' Add Recipient\n  Dim myOlExp As Outlook.Explorer\n  Dim myOlSel As Outlook.Selection\n\n  Set myOlExp = Application.ActiveExplorer\n  Set myOlSel = myOlExp.Selection\n\n  For Each olItem In myOlSel\n  Set olReply = olItem.ReplyAll\n  Set olRecip = olReply.Recipients.Add(\"Email Address Here\") ' Recipient Address\n    olRecip.Type = olCC\n        olReply.HTMLBody = \"Hello, Thank you. \" &amp; vbCrLf &amp; olReply.HTMLBody\n    olReply.Display\n\n    'olReply.Send\n  Next olItem\nEnd Sub\n</code></pre>\n\n<p>I'm trying to use this code but error 438 object doesn't support this property or method keeps on coming out. Hoping to get help with this automation.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1505899772, "post_id": 46316811, "comment_id": 79597634, "body": "Your code is invalid, please correct it and show working code. Then read and apply: <a href=\"http://stackoverflow.com/questions/418960/managing-and-debugging-sql-queries-in-ms-access/1099570#1099570\">How to debug dynamic SQL in VBA</a> -- if it doesn&#39;t help, add the output of <code>Debug.Print new_entry_sql</code> to your question."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1505899838, "post_id": 46316811, "comment_id": 79597679, "body": "Also, <i>&quot;errors out&quot;</i> isn&#39;t very helpful, please add the full error message."}, {"owner": {"reputation": 37, "user_id": 8639572, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0dcd2d42d83dfd42d352f8483fa017e?s=128&d=identicon&r=PG", "display_name": "Shawn Koh", "link": "https://stackoverflow.com/users/8639572/shawn-koh"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1506906571, "post_id": 46316811, "comment_id": 79990844, "body": "Thanks for pointing that out, and apologies for the incorrect code provided and the not-descriptive error message. I&#39;ll take note of that for future questions!"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8639572, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0dcd2d42d83dfd42d352f8483fa017e?s=128&d=identicon&r=PG", "display_name": "Shawn Koh", "link": "https://stackoverflow.com/users/8639572/shawn-koh"}, "edited": false, "score": 0, "creation_date": 1506906495, "post_id": 46322537, "comment_id": 79990827, "body": "Thank you so much! I was not aware that I had to specify FROM AS"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1505911636, "creation_date": 1505911636, "answer_id": 46322537, "question_id": 46316811, "link": "https://stackoverflow.com/questions/46316811/how-to-open-a-recordset-from-a-recordset/46322537#46322537", "title": "How to open a recordset from a recordset?", "body": "<p>Your quotation marks <code>\"</code> and new line continuations <code>&amp; _</code> are a bit messed up. I don't know if that's a copy-paste error or if this your actual code (doesn't compile).</p>\n\n<p>Anyways try this:</p>\n\n<pre><code>Sub testing()       \n    valid_unit_sql = \"SELECT * \" &amp; _\n                     \"FROM import_raw_data \" &amp; _\n                     \"WHERE unit_name IN (SELECT unit_name FROM unit)\"\n\n    new_entry_sql = \"SELECT * \" &amp; _\n                    \"FROM (\" &amp; valid_unit_sql &amp; \") AS T \" &amp; _\n                    \"WHERE T.id NOT IN (SELECT id FROM serviceman);\"\n\n    Debug.Print new_entry_sql\n\n    With CurrentDb\n        Set valid_unit = .OpenRecordset(valid_unit_sql)\n        Set new_entry = .OpenRecordset(new_entry_sql)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Output SQL:</p>\n\n<pre><code>SELECT * \nFROM \n    (\n        SELECT * \n        FROM import_raw_data \n        WHERE unit_name IN (SELECT unit_name FROM unit)\n    ) AS T \nWHERE T.id NOT IN (SELECT id FROM serviceman);\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8639572, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0dcd2d42d83dfd42d352f8483fa017e?s=128&d=identicon&r=PG", "display_name": "Shawn Koh", "link": "https://stackoverflow.com/users/8639572/shawn-koh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 46322537, "answer_count": 1, "score": 1, "last_activity_date": 1505911636, "creation_date": 1505895487, "last_edit_date": 1505899693, "question_id": 46316811, "link": "https://stackoverflow.com/questions/46316811/how-to-open-a-recordset-from-a-recordset", "title": "How to open a recordset from a recordset?", "body": "<p>I would like to open a recordset with VBA, from another recordset.</p>\n\n<p>This works if I write the SQL and save it into a query named new_entry and valid_unit</p>\n\n<pre><code>' valid_unit\nSELECT *\nFROM import_raw_data\nWHERE unit_name IN (SELECT unit_name FROM unit);\n\n' new_entry\nSELECT *\nFROM valid_unit\nWHERE id NOT IN (SELECT id FROM serviceman);\nWHERE\n</code></pre>\n\n<p>However, I would like to do this in VBA exclusively instead of saving the queries.</p>\n\n<pre><code>Sub testing()\n    valid_unit_sql = _\n        \"SELECT * \" _\n      &amp; \"FROM import_raw_data\"\n      &amp; \"WHERE unit_name IN (SELECT unit_name FROM unit);\n\n    new_entry_sql = _\n        \"SELECT * \"\n      &amp; \"FROM ( \" &amp; valid_unit_sql &amp; \") \" _\n      &amp; \"WHERE id NOT IN (SELECT id FROM serviceman);\"\n\n    With CurrentDb\n        Set valid_unit = .OpenRecordset(valid_unit_sql)\n        ' valid_unit works great\n        Set new_entry = .OpenRecordset(new_entry_sql)\n        ' this doesnt, it errors out\n    End With\nEnd Sub\n</code></pre>\n\n<p>May I know how do I do this? Should I be saving my valid_unit query and FROM valid_unit instead?</p>\n"}, {"tags": ["excel", "excel-formula", "irr", "xirr", "vba"], "answers": [{"comments": [{"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1505895095, "post_id": 46316523, "comment_id": 79594609, "body": "I want it in this format , cause it will be feeding into another sheet thanks"}], "tags": [], "owner": {"reputation": 19, "user_id": 8633313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8T4OL.jpg?s=128&g=1", "display_name": "tranyo", "link": "https://stackoverflow.com/users/8633313/tranyo"}, "is_accepted": false, "score": 0, "last_activity_date": 1505894572, "creation_date": 1505894572, "answer_id": 46316523, "question_id": 46316298, "link": "https://stackoverflow.com/questions/46316298/xirr-formulae-for-each-investment/46316523#46316523", "title": "XIRR Formulae For each investment", "body": "<p>pivottable can do it easily.It's not good for U?</p>\n"}, {"comments": [{"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1505987120, "post_id": 46330306, "comment_id": 79640843, "body": "Thank you very much"}], "tags": [], "owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "is_accepted": true, "score": 0, "last_activity_date": 1505935609, "creation_date": 1505935609, "answer_id": 46330306, "question_id": 46316298, "link": "https://stackoverflow.com/questions/46316298/xirr-formulae-for-each-investment/46330306#46330306", "title": "XIRR Formulae For each investment", "body": "<p>There are some problems of your data setup.  Here is how the IRR works (<a href=\"http://www.investopedia.com/ask/answers/022615/what-formula-calculating-internal-rate-return-irr-excel.asp\" rel=\"nofollow noreferrer\">http://www.investopedia.com/ask/answers/022615/what-formula-calculating-internal-rate-return-irr-excel.asp</a>).  Without your data, here is how you can make this to work for matching different investments.</p>\n\n<p>See the attached image below and assume you are entering the formula from <code>cell F2</code> and here you go:</p>\n\n<pre><code>=XIRR(OFFSET($C$1,MATCH(E2,$A$2:$A$17,0),0,COUNTIF($A$2:$A$17,E2)),OFFSET($B$1,MATCH(E2,$A$2:$A$17,0),0,COUNTIF($A$2:$A$17,E2)))\n</code></pre>\n\n<p>Please note this is an array formula (need to click <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> together)).</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ql6y4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ql6y4.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What I did is to use <code>OFFSET</code> to find the pertaining ranges for dates and values of each investment.  And here I have also showed you the results for a valid data inputs.  Try and let me know.</p>\n"}], "owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 46330306, "answer_count": 2, "score": 0, "last_activity_date": 1505935609, "creation_date": 1505893936, "last_edit_date": 1531161705, "question_id": 46316298, "link": "https://stackoverflow.com/questions/46316298/xirr-formulae-for-each-investment", "title": "XIRR Formulae For each investment", "body": "<p>I am trying to apply an XIRR Formulae so that the percentage of each investment is calculated  separately.  I attempted an IF formulea  an was not successful.  I need to amend the below formulae. This will be useful as i am trying to apply it to 200 invesmtents plus. </p>\n\n<pre><code>=XIRR(C2:C17,B2:B17)\n</code></pre>\n\n<p>Below is the data.\n<a href=\"https://i.stack.imgur.com/BuWBs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BuWBs.png\" alt=\"enter image description here\"></a></p>\n\n<p>Below is the result i am trying to get.</p>\n\n<p><a href=\"https://i.stack.imgur.com/F6Ork.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F6Ork.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "windows-10", "named-ranges", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1505894907, "post_id": 46316255, "comment_id": 79594502, "body": "Is it visible in the Name Manager? Can you supply a screenshot of that?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1505895206, "post_id": 46316255, "comment_id": 79594677, "body": "Just thinking out loud here.. if the named cell&#39;s RefersTo contained a <b>UDF</b>, or another <b>Name</b> which has been stripped out <i>before</i> deleting names, this might cause this error..?"}, {"owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1505895245, "post_id": 46316255, "comment_id": 79594705, "body": "No problem. I have amended my original post with the image of the name manager from the workbook which is created by the copy macro. There&#39;s a lot of names in this thing (which is why we delete them) but none have an errored name."}, {"owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1505895560, "post_id": 46316255, "comment_id": 79594922, "body": "There are no UDFs in this certain document but I can take a look for names containing names. But surely the fact that I am trying to just delete the thing rather than do any work with it should mean any of that wouldn&#39;t matter? I guess I&#39;d have to ask that one guy at microsoft that probably works on maintaining the VBA functionality haha."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1505895596, "post_id": 46316255, "comment_id": 79594946, "body": "<code>The error that appears is below</code> - no, it&#39;s not. There is no actual error message anywhere. In any case, <code>Foreach</code> does not like when you modify the collection being enumerated. If you want to delete all names, use the <code>for</code> loop and index-based approach."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1505896018, "post_id": 46316255, "comment_id": 79595207, "body": "<code>Foreach</code> does not like when you modify the collection being enumerated. +1"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1505898088, "post_id": 46316255, "comment_id": 79596573, "body": "Using 64bit office 2016 I can run         for each s in names:s.delete:next s  without error in the immediate window. So I&#39;m not convinced it&#39;s the For Each that&#39;s the problem"}, {"owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "edited": false, "score": 0, "creation_date": 1505899040, "post_id": 46316255, "comment_id": 79597160, "body": "It does seem to be specific to this workbook as it also works for me perfectly fine in other test on the same version... But this thing is so huge that I cannot just rebuild the workbook and test it. That would take a few days at least.  I am trying the enumeration that GSerg mentioned. Something like:      Dim i As Integer     Dim nmCount As Integer      nmCount = ActiveWorkbook.Names.Count      For i = 1 To nmCount     ActiveWorkbook.Names(i).Delete     Next i"}, {"owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "edited": false, "score": 0, "creation_date": 1505899918, "post_id": 46316255, "comment_id": 79597740, "body": "Unfortunately the enumeration method using the above code (although instead of Names(i).delete I had to use Names(1) due to the shuffle down) results in the same error... Only other thing I can think it could be is a corruption somewhere. I really don&#39;t want to rebuild this thing!"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1505910312, "post_id": 46316255, "comment_id": 79604702, "body": "@JaayB Of course you had to use <code>Names(1)</code> due to each operation changing the collection, that is the very same reason that sets the <code>foreach</code> off. You normally enumerate backwards when deleting, with <code>For i = nmCount To 1 Step -1</code>."}], "answers": [{"tags": [], "owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "is_accepted": true, "score": 0, "last_activity_date": 1506063847, "creation_date": 1506063847, "answer_id": 46358718, "question_id": 46316255, "link": "https://stackoverflow.com/questions/46316255/error-deleting-named-range-on-windows-10-excel-2013-older-versions-work-fine/46358718#46358718", "title": "Error Deleting Named Range on Windows 10 Excel 2013 - Older Versions Work Fine", "body": "<p>It seems that my Windows profile had a corruption somewhere. The file also worked on other Windows 10 installations around the office. Re-installing Excel did not fix it, but rebuilding my Windows profile did. This is a first for me, and I thought I had seen everything already.</p>\n\n<p>I would like to thank everyone who looked into this. I'm sure if this were a normal issue with Excel, the enumeration suggestion would have been spot on.</p>\n"}], "owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 46358718, "answer_count": 1, "score": 0, "last_activity_date": 1506063847, "creation_date": 1505893802, "last_edit_date": 1531164843, "question_id": 46316255, "link": "https://stackoverflow.com/questions/46316255/error-deleting-named-range-on-windows-10-excel-2013-older-versions-work-fine", "title": "Error Deleting Named Range on Windows 10 Excel 2013 - Older Versions Work Fine", "body": "<p>I'm having a problem that I don't really know how to fix. I have a code that runs perfectly in Windows 7 Excel 2010 and always has. In the last few weeks it has developed an error but only when running in Windows 10 Excel 2013.</p>\n\n<p>Basically the below code copies some data sheets to a new workbook in order to strip the VBA out (as this is blocked by company filters). It then loops through all the objects and names and deletes them before sending it via Outlook </p>\n\n<pre><code>Private Sub btnSend_Click()\n'---------------------Create the email spreadsheet---------------------------------\nDim FName           As String\nDim FPath           As String\nDim NewBook         As Workbook\nDim EEName As String\nDim nm As Name\n\nEEName = Range(\"ForeNameCell\").Value &amp; \" \" &amp; Range(\"SurnameCell\").Value\nFPath = VBA.Environ(\"temp\") &amp; \"\\\" 'file path to store the copy of the sheet\nFName = \"NS Form - \" &amp; EEName &amp; \" \" &amp; VBA.Format(VBA.Now(), \"mm_dd_yyyy hh mm AMPM\")\n\nSet NewBook = Workbooks.Add 'create a new workbook\nThisWorkbook.Sheets(\"contract Print Out\").Copy Before:=NewBook.Sheets(1) 'copy over the printoutallfields sheet\nThisWorkbook.Sheets(\"Oracle Data\").Copy Before:=NewBook.Sheets(1) 'copy over the printoutallfields sheet\n'copy and paste special data in new workbook to remove formula\nNewBook.Sheets(\"contract Print Out\").Cells.Copy\nNewBook.Sheets(\"contract Print Out\").Cells.PasteSpecial xlPasteValues\nNewBook.Sheets(\"Oracle Data\").Cells.Copy\nNewBook.Sheets(\"Oracle Data\").Cells.PasteSpecial xlPasteValues\n'remove back buttons\nDim myshape As Shape\nFor Each myshape In NewBook.Sheets(\"contract Print Out\").Shapes\n    myshape.Delete\nNext myshape\nFor Each myshape In NewBook.Sheets(\"Oracle Data\").Shapes\n    myshape.Delete\nNext myshape\n'remove links and named ranges\nApplication.Calculation = xlManual\nOn Error Resume Next\nFor Each nm In NewBook.Names\n    nm.Delete ' This line now errors in W10 E2013\nNext\nOn Error GoTo 0\nApplication.Calculation = xlCalculationAutomatic\n\n'NewBook.Sheets(\"PrintOutallFields\").Name = \"User Data\" 'rename it in the destination workbook\nApplication.DisplayAlerts = False 'turn off overwrite prompt so that it will just overwrite\nNewBook.SaveAs Filename:=FPath &amp; FName 'save the file\nDoEvents\nApplication.DisplayAlerts = True 'turn overwrite prompt back on\nNewBook.Close\n</code></pre>\n\n<p>The error that appears is below and when I query the name it is trying to delete it comes up with #NAME?. Every single name seems to appear this way to the code as when I skip ahead and try to go to the next nm, the same thing happens.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0ktyo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0ktyo.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/2WSh5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2WSh5.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/oByA2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oByA2.png\" alt=\"enter image description here\"></a></p>\n\n<p>I forgot to mention the reason we delete the names from the workbook is due to them always referring the original file. This causes issues when we receive it as the original would of course, always be on the customers PC.</p>\n\n<p>My guess is MS in their eternal wisdom, pushed an update which breaks VBA between versions ... AGAIN! I've had to fix a few of these already but I am stumped by this one.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1505895801, "post_id": 46316201, "comment_id": 79595078, "body": "What do you mean by not &quot;accordingly&quot;? I can&#39;t see any reference in your code to comments - do you mean cell contents?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1505896010, "post_id": 46316201, "comment_id": 79595205, "body": "@SJR ya. I mean the cell content#"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1505906814, "creation_date": 1505906814, "answer_id": 46320806, "question_id": 46316201, "link": "https://stackoverflow.com/questions/46316201/extracting-data-from-one-workbook-and-pasting-in-another-with-comments/46320806#46320806", "title": "Extracting data from one workbook and pasting in another with comments", "body": "<p>I refactored your code correcting the unqualified references and printing the Source and Destination range addresses to the Immediate window.  This should give you an idea of what is going on.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nc6Ww.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nc6Ww.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<pre><code>Sub Extract()\n    Dim DestinationWB As Workbook\n    Dim OriginWB As Workbook\n    Dim FileWithPath As String, path1 As String, TheHeader As String\n    Dim lastRow As Long, col As Long\n    Dim cell As Range, Source As Range\n\n    Set DestinationWB = ThisWorkbook\n    path1 = DestinationWB.Path\n    FileWithPath = path1 &amp; \"\\Downloads\\CTT.xlsx\"\n    Set OriginWB = Workbooks.Open(Filename:=FileWithPath)\n\n    With OriginWB.Worksheets(\"Report\")\n        lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n        For col = 1 To .Cells(22, .Columns.Count).End(xlToLeft).Column\n            'get the name of the field (names are in row 22)\n            TheHeader = OriginWB.Worksheets(\"Report\").Cells(22, col).Value\n\n            With DestinationWB.Worksheets(\"CTT\").Range(\"A4:P4\")\n                'Find the name of the field (TheHeader) in the destination (in row 4)\n                Set cell = .Find(TheHeader, LookIn:=xlValues)\n            End With\n\n            If Not cell Is Nothing Then\n                Set Source = .Range(.Cells(23, col), .Cells(lastRow, col))\n                Source.Copy Destination:=cell.Offset(1)\n                Debug.Print Source.Address(External:=True), \"Copied to \", cell.Offset(1).Address(External:=True)\n            Else\n                'handle the error\n            End If\n        Next\n    End With\n    OriginWB.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 46320806, "answer_count": 1, "score": 0, "last_activity_date": 1505906814, "creation_date": 1505893657, "question_id": 46316201, "link": "https://stackoverflow.com/questions/46316201/extracting-data-from-one-workbook-and-pasting-in-another-with-comments", "title": "Extracting data from one workbook and pasting in another with comments", "body": "<p>I would like to copy the data from one workbook to another. </p>\n\n<p>My source workbook has some comments listed in each row. When  I use my code to copy, it does not copy the comments accordingly. Could any one help, how I could copy from one workbook to another with the comment field ? my comments are in Column P.</p>\n\n<pre><code>Sub Extract()\nDim DestinationWB As Workbook\n    Dim OriginWB As Workbook\n    Dim path1 As String\n    Dim FileWithPath As String\n    Dim lastRow As Long, i As Long, LastCol As Long\n    Dim TheHeader As String\n    Dim cell As Range\n\n    Set DestinationWB = ThisWorkbook\n    path1 = DestinationWB.Path\n    FileWithPath = path1 &amp; \"\\Downloads\\CTT.xlsx\"\n    Set OriginWB = Workbooks.Open(filename:=FileWithPath)\n\n\n    lastRow = OriginWB.Worksheets(\"Report\").Cells(Rows.count, 1).End(xlUp).Row\n    LastCol = OriginWB.Worksheets(\"Report\").Cells(22, Columns.count).End(xlToLeft).Column\n\n    For i = 1 To LastCol\n        'get the name of the field (names are in row 22)\n        TheHeader = OriginWB.Worksheets(\"Report\").Cells(22, i).Value\n\n        With DestinationWB.Worksheets(\"CTT\").Range(\"A4:P4\")\n            'Find the name of the field (TheHeader) in the destination (in row 4)\n            Set cell = .Find(TheHeader, LookIn:=xlValues)\n        End With\n\n        If Not cell Is Nothing Then\n            OriginWB.Worksheets(\"Report\").Range(Cells(23, i), Cells(lastRow, i)).Copy Destination:=DestinationWB.Worksheets(\"CTT\").Cells(5, cell.Column)\n        Else\n            'handle the error\n        End If\n    Next i\n\n    OriginWB.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "autocad"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1505892483, "post_id": 46315588, "comment_id": 79592986, "body": "I would say the only way is pressing cancel at the second input box to trigger the <code>Case Else</code> and then jump to the beginning (eg with a goto). Or tell the user not to hit OK until he is sure that his selection was correct. This is a user problem not a programming issue. Also check your syntax! There should be no <code>:</code> in front of <code>: Set</code>!"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1505893433, "post_id": 46315588, "comment_id": 79593607, "body": "@Peh or after <code>Case &quot;#&quot;</code> for that matter"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1505894051, "post_id": 46315588, "comment_id": 79593959, "body": "Might be better to use a form with both questions, a tick box and a single commit button.  The tick box will return TRUE/FALSE and you can feed that response directly to the <code>layerobj</code>."}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1506504349, "post_id": 46315588, "comment_id": 79844124, "body": "I used a GoTo function to solve this, I had to give all the options a Label. Thanks guys!"}], "owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505994170, "creation_date": 1505891896, "last_edit_date": 1531164843, "question_id": 46315588, "link": "https://stackoverflow.com/questions/46315588/going-back-to-make-correction-on-vba", "title": "Going Back to Make Correction on VBA", "body": "<p>I am busy with input box selection and when I do an error I want to go back and make a correction but my code only allows me to make one selection and does not allow me to go back and make corrections, for example if I select \"Yes\", then realise I want to select \"No\" for the first option and I am already on the second option, I want be able to go back to my first input box and select \"No\". here is my code</p>\n\n<pre><code>ans = InputBox(\"1 = Yes\" &amp; vbCrLf &amp; \"2 = No\", \"Motor Davit\")\n\nSelect Case ans\n    Case \"1\":\n        : Set layerObj = ThisDrawing.Layers.Add(\"Motor_Davit_\" &amp; Size)\n        layerObj.LayerOn = True\n\n    Case \"2\":\n        : Set layerObj = ThisDrawing.Layers.Add(\"Motor_Davit_\" &amp; Size)\n        layerObj.LayerOn = False\nEnd Select\n\nans = InputBox(\"1 = Yes\" &amp; vbCrLf &amp; \"2 = No\", \"Two Pass\")\n\nSelect Case ans\n    'Select whether it's a Two Pass unit or wha\n     Case \"1\":\n         : Set layerObj = ThisDrawing.Layers.Add(\"TWO_PASS_\" &amp; Size)\n         layerObj.LayerOn = True\n     Case \"2\":\n         : Set layerObj = ThisDrawing.Layers.Add(\"TWO_PASS_\" &amp; Size)\n         layerObj.LayerOn = False                \n     Case Else: MsgBox \"Wrong Input Dude.\", vbCritical, MSG: Exit Sub\nEnd Select\n</code></pre>\n"}, {"tags": ["excel", "webpage", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1505891384, "post_id": 46315340, "comment_id": 79592330, "body": "What is <code>ActiveSheet.Gender</code>? A sheet does not have the property <code>Gender</code>! Where did you get this code from?"}, {"owner": {"reputation": 1, "user_id": 8639129, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512014512198741/picture?type=large", "display_name": "Munashe Zanza", "link": "https://stackoverflow.com/users/8639129/munashe-zanza"}, "edited": false, "score": 0, "creation_date": 1505893136, "post_id": 46315340, "comment_id": 79593424, "body": "I got this from a work mate who copied off a forum site. I am still a VBA newbie so bear with me"}, {"owner": {"reputation": 1, "user_id": 8639129, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512014512198741/picture?type=large", "display_name": "Munashe Zanza", "link": "https://stackoverflow.com/users/8639129/munashe-zanza"}, "edited": false, "score": 0, "creation_date": 1505893404, "post_id": 46315340, "comment_id": 79593586, "body": "Okay have rectified ActiveSheet.Gender section"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1505893744, "post_id": 46315340, "comment_id": 79593791, "body": "@MunasheZanza Right, so you don&#39;t get the error anymore. Voting to close."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505937637, "post_id": 46315340, "comment_id": 79622462, "body": "Which line do you get the &quot;run-time error 438&quot; on now?  Still on the <code>QueryTables.Add</code>?"}, {"owner": {"reputation": 1, "user_id": 8639129, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512014512198741/picture?type=large", "display_name": "Munashe Zanza", "link": "https://stackoverflow.com/users/8639129/munashe-zanza"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505976637, "post_id": 46315340, "comment_id": 79634130, "body": "Yes on that line @YowE3K"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8639129, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512014512198741/picture?type=large", "display_name": "Munashe Zanza", "link": "https://stackoverflow.com/users/8639129/munashe-zanza"}, "edited": false, "score": 0, "creation_date": 1505894717, "post_id": 46316207, "comment_id": 79594385, "body": "It is not working for me. Did it run succesfully when you did it?"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 1, "user_id": 8639129, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512014512198741/picture?type=large", "display_name": "Munashe Zanza", "link": "https://stackoverflow.com/users/8639129/munashe-zanza"}, "edited": false, "score": 0, "creation_date": 1505908296, "post_id": 46316207, "comment_id": 79603293, "body": "It did. Define &quot;not working&quot;?  The nice thing about this approach is that you don&#39;t pollute your sheet with all kinds of noise from the query, as you do with <code>ActiveSheet.QueryTables</code>. You just get a simple JSON string that is then straightforward to parse."}, {"owner": {"reputation": 1, "user_id": 8639129, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512014512198741/picture?type=large", "display_name": "Munashe Zanza", "link": "https://stackoverflow.com/users/8639129/munashe-zanza"}, "edited": false, "score": 0, "creation_date": 1505976707, "post_id": 46316207, "comment_id": 79634173, "body": "I am getting compile error: invalid outside procedure"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 1, "user_id": 8639129, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512014512198741/picture?type=large", "display_name": "Munashe Zanza", "link": "https://stackoverflow.com/users/8639129/munashe-zanza"}, "edited": false, "score": 0, "creation_date": 1505976798, "post_id": 46316207, "comment_id": 79634217, "body": "Okay... then put the code inside a procedure. I suggest you do a web search for &quot;compile error: invalid outside procedure&quot;. Try to solve the problem yourself before asking for help."}, {"owner": {"reputation": 1, "user_id": 8639129, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512014512198741/picture?type=large", "display_name": "Munashe Zanza", "link": "https://stackoverflow.com/users/8639129/munashe-zanza"}, "edited": false, "score": 0, "creation_date": 1505981373, "post_id": 46316207, "comment_id": 79637055, "body": "okay I have solved procedure issue the issue now is how do I get this code to look up each value in column and paste in the adjacent cell."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 1, "user_id": 8639129, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512014512198741/picture?type=large", "display_name": "Munashe Zanza", "link": "https://stackoverflow.com/users/8639129/munashe-zanza"}, "edited": false, "score": 1, "creation_date": 1505981610, "post_id": 46316207, "comment_id": 79637220, "body": "Try something, then come back with a question about the specific problem you&#39;re having."}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": false, "score": 1, "last_activity_date": 1505893678, "creation_date": 1505893678, "answer_id": 46316207, "question_id": 46315340, "link": "https://stackoverflow.com/questions/46315340/run-time-438-on-searching-and-pasting-gender/46316207#46316207", "title": "Run-time 438 on searching and pasting gender", "body": "<p>Here's another way to do it, using the <a href=\"https://msdn.microsoft.com/en-us/library/aa384106(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>WinHttpRequest</code> object</a>:</p>\n\n<pre><code>Dim httpRequest As Object\nDim url As String\nDim i As Long\nDim jsonResponse As String\n\nSet httpRequest = CreateObject(\"MSXML2.ServerXMLHTTP\")\nurl = \"https://gender-api.com/get?name=elizabeth\" ' For example\nhttpRequest.Open \"POST\", url, False\nhttpRequest.send\njsonResponse = httpRequest.ResponseText\nMsgBox jsonResponse\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8639129, "user_type": "registered", "profile_image": "https://graph.facebook.com/1512014512198741/picture?type=large", "display_name": "Munashe Zanza", "link": "https://stackoverflow.com/users/8639129/munashe-zanza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1505893678, "creation_date": 1505891040, "last_edit_date": 1531161705, "question_id": 46315340, "link": "https://stackoverflow.com/questions/46315340/run-time-438-on-searching-and-pasting-gender", "title": "Run-time 438 on searching and pasting gender", "body": "<p>I am running the following code that takes a value from column A, searches it on the URL: <a href=\"https://gender-api.com\" rel=\"nofollow noreferrer\">https://gender-api.com</a> and returns the gender of the person and pastes it in column B. </p>\n\n<p>I get a </p>\n\n<blockquote>\n  <p>run-time error 438 </p>\n</blockquote>\n\n<p>when running the code. Please help.</p>\n\n<pre><code>Sub URL_Get_Gender_Query()\n    strSearch = Range(\"a4\")\n    With ActiveSheet.QueryTables.Add(Connection:=\"URL;https://gender-api.com?SearchText=\" &amp; strSearch &amp; \"&amp;safe=active\", _Destination:=Range(\"b4\")) \n        '^ Run-time error 438 here\n\n        .BackgroundQuery = True\n        .TablesOnlyFromHTML = True\n        .Refresh BackgroundQuery:=False\n        .SaveData = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1505890202, "post_id": 46314999, "comment_id": 79591643, "body": "If <code>M</code> is 24 before the loop, then <code>19 And M = 24</code> will evaluate to <code>19</code>.  If <code>M</code> is not 24 before the loop, then <code>19 And M = 24</code> will evaluate to <code>0</code>.  <code>For i = 7 To 0 Step 1</code> won&#39;t do anything because the start value is already greater than the end value."}, {"owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "edited": false, "score": 0, "creation_date": 1505890256, "post_id": 46314999, "comment_id": 79591687, "body": "<code>ActiveSheet.Cells(x, y).value</code> prefer this, cell object has a lot of other properties too."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1505890392, "post_id": 46314999, "comment_id": 79591769, "body": "<code>If</code>s are not loop, but branching conditions. <code>For</code> is the loop here."}, {"owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "edited": false, "score": 0, "creation_date": 1505890472, "post_id": 46314999, "comment_id": 79591823, "body": "<code>M = 24</code> for in the begging and then at the end of very first iteration you have <code>M = M  + 1</code> executed which makes M = 25, now the condition  <code>For i = 7 To 19 And M = 24 Step 1</code>  will be false because of <code>AND</code> so loop will terminate after one iteration."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "edited": false, "score": 1, "creation_date": 1505890528, "post_id": 46314999, "comment_id": 79591852, "body": "@AbhinavRawat The start and end values for <code>For</code> loops are only executed once - prior to the loop starting.  They are not re-evaluated after each iteration."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1505891211, "post_id": 46314999, "comment_id": 79592243, "body": "@YowE3K Obligatory link: <a href=\"https://stackoverflow.com/q/42354228/11683\">unless they don&#39;t</a> ;)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1505891999, "post_id": 46314999, "comment_id": 79592687, "body": "@GSerg It&#39;s a good thing that, in this case, the end value is an expression and therefore my statement still holds for this case at least! :D"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505892941, "post_id": 46314999, "comment_id": 79593296, "body": "It is not clear what you are attempting to do.  Assuming the value of <code>M</code> is 24 prior to the loop (the only way the code will do <b>anything</b>) you seem to be updating certain values on row 24 based on info primarily from column G, then updating values on row 25 based on info primarily from column H, then updating values on row 26 based on info primarily from column I, ..., until you finally (when <code>i</code> is 18) are updating values on row 35 based on info primarily from column R.  Is that the intention?"}, {"owner": {"reputation": 33, "user_id": 8618951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-lxvd1C5Mfoo/AAAAAAAAAAI/AAAAAAAAC98/vbels3y9YGk/photo.jpg?sz=128", "display_name": "Karthik P", "link": "https://stackoverflow.com/users/8618951/karthik-p"}, "edited": false, "score": 0, "creation_date": 1505895295, "post_id": 46314999, "comment_id": 79594733, "body": "@Yow3EK you are right, I am trying to do exactly what you mentioned"}, {"owner": {"reputation": 33, "user_id": 8618951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-lxvd1C5Mfoo/AAAAAAAAAAI/AAAAAAAAC98/vbels3y9YGk/photo.jpg?sz=128", "display_name": "Karthik P", "link": "https://stackoverflow.com/users/8618951/karthik-p"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505897390, "post_id": 46314999, "comment_id": 79596065, "body": "@YowE3K I changed the code to: Dim M As Integer M = 24    For i = 7 To 19 Step 1      If M = 36 Then         Exit For     End If"}, {"owner": {"reputation": 33, "user_id": 8618951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-lxvd1C5Mfoo/AAAAAAAAAAI/AAAAAAAAC98/vbels3y9YGk/photo.jpg?sz=128", "display_name": "Karthik P", "link": "https://stackoverflow.com/users/8618951/karthik-p"}, "reply_to_user": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "edited": false, "score": 0, "creation_date": 1505897523, "post_id": 46314999, "comment_id": 79596158, "body": "@Abhinav Rawat I changed the initial part to Dim M As Integer M = 24    For i = 7 To 19 Step 1      If M = 36 Then         Exit For     End If"}, {"owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "edited": false, "score": 0, "creation_date": 1505898503, "post_id": 46314999, "comment_id": 79596866, "body": "@KarthikP I also tested it with an example sub in VBA, that is fine, I thought the for loop here works just like other programming languages checking the loop condition every time, so that was my bad. I&#39;ll suggest you to use break point and immediate window and use print statements wherever you feel a problem, it will help you in tracking exactly where you have the bug."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505937493, "post_id": 46314999, "comment_id": 79622389, "body": "If you change your <code>For</code> loop to be <code>For i = 7 To 18</code>, you won&#39;t need your <code>If M = 36 Then</code> test, because <code>M</code> is 36 if and only if <code>i</code> is 19."}, {"owner": {"reputation": 33, "user_id": 8618951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-lxvd1C5Mfoo/AAAAAAAAAAI/AAAAAAAAC98/vbels3y9YGk/photo.jpg?sz=128", "display_name": "Karthik P", "link": "https://stackoverflow.com/users/8618951/karthik-p"}, "edited": false, "score": 0, "creation_date": 1506264119, "post_id": 46314999, "comment_id": 79739647, "body": "I tried the below pasted loop in an entirely new worksheet, but it is giving the same wrong result."}], "answers": [{"comments": [{"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "reply_to_user": {"reputation": 33, "user_id": 8618951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-lxvd1C5Mfoo/AAAAAAAAAAI/AAAAAAAAC98/vbels3y9YGk/photo.jpg?sz=128", "display_name": "Karthik P", "link": "https://stackoverflow.com/users/8618951/karthik-p"}, "edited": false, "score": 0, "creation_date": 1505911303, "post_id": 46315239, "comment_id": 79605428, "body": "Technically your loop is correct (afte the shown change). If it gives you wrong values in wrong places your If..thens aren&#39;t flawless. Try with only the first 2-3 if..thens and check each single value to find where it goes wrong. Without analysing the exact sheet with your data its impossible to help you check your logic."}], "tags": [], "owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "is_accepted": false, "score": 0, "last_activity_date": 1505890700, "creation_date": 1505890700, "answer_id": 46315239, "question_id": 46314999, "link": "https://stackoverflow.com/questions/46314999/if-loop-not-working-in-vba/46315239#46315239", "title": "If loop not working in VBA", "body": "<p>Probably pulling the <code>M = 24</code> before the <code>For</code> will help you getting the desired results:</p>\n\n<pre><code>M = 24\nFor i = 7 To 19 \n....\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8618951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-lxvd1C5Mfoo/AAAAAAAAAAI/AAAAAAAAC98/vbels3y9YGk/photo.jpg?sz=128", "display_name": "Karthik P", "link": "https://stackoverflow.com/users/8618951/karthik-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505890700, "creation_date": 1505889835, "last_edit_date": 1531164843, "question_id": 46314999, "link": "https://stackoverflow.com/questions/46314999/if-loop-not-working-in-vba", "title": "If loop not working in VBA", "body": "<p>Can anyone help me understand why the code in VBA pasted below is not working?</p>\n\n<p>I am new to VBA, part of the code may look primitive.<br>\nThe code was supposed to give numbers that are 2 digits and paste it at a location, but it is throwing out at places 3 digit numbers and at random locations.</p>\n\n<pre><code>Dim M As Integer\n'M = 24\n\nFor i = 7 To 19 And M = 24 Step 1\n    If M = 36 Then\n        Exit For\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= 0 And ActiveSheet.Cells(7, i) &lt;= 15 And ActiveSheet.Cells(8, i) &lt;= 15 Then\n        ActiveSheet.Cells(M, 6) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= 345 And ActiveSheet.Cells(8, i) &lt;= 360 Or ActiveSheet.Cells(7, i) &gt;= 345 And ActiveSheet.Cells(8, i) &lt;= 0 Then\n        ActiveSheet.Cells(M, 6) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 6) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 7) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 7) Then\n            ActiveSheet.Cells(M, 6) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n        Else\n            ActiveSheet.Cells(M, 6) = (ActiveSheet.Cells(23, 7) - ActiveSheet.Cells(7, i)) / 30 * 100\n            ActiveSheet.Cells(M, 7) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 7)) / 30 * 100\n        End If\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 8) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 9) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 9) Then\n            ActiveSheet.Cells(M, 7) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n        Else\n            ActiveSheet.Cells(M, 7) = (ActiveSheet.Cells(23, 9) - ActiveSheet.Cells(7, i)) / 30 * 100\n            ActiveSheet.Cells(M, 8) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 9)) / 30 * 100\n        End If\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 10) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 11) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 11) Then\n            ActiveSheet.Cells(M, 8) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) * 0.3\n        Else\n            ActiveSheet.Cells(M, 8) = (ActiveSheet.Cells(23, 11) - ActiveSheet.Cells(7, i)) / 30 * 100\n            ActiveSheet.Cells(M, 9) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 11)) / 30 * 100\n        End If\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 12) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 13) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 13) Then\n            ActiveSheet.Cells(M, 9) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n        Else\n            ActiveSheet.Cells(M, 9) = (ActiveSheet.Cells(23, 13) - ActiveSheet.Cells(7, i)) / 30 * 100\n            ActiveSheet.Cells(M, 10) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 13)) / 30 * 100\n        End If\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 14) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 15) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 15) Then\n            ActiveSheet.Cells(M, 10) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n        Else\n            ActiveSheet.Cells(M, 10) = (ActiveSheet.Cells(23, 15) - ActiveSheet.Cells(7, i)) / 30 * 100\n            ActiveSheet.Cells(M, 11) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 15)) / 30 * 100\n        End If\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 16) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 17) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 17) Then\n            ActiveSheet.Cells(M, 11) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n        Else\n            ActiveSheet.Cells(M, 11) = (ActiveSheet.Cells(23, 17) - ActiveSheet.Cells(7, i)) / 30 * 100\n            ActiveSheet.Cells(M, 12) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 17)) / 30 * 100\n        End If\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 18) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 19) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 19) Then\n            ActiveSheet.Cells(M, 12) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n        Else\n            ActiveSheet.Cells(M, 12) = (ActiveSheet.Cells(23, 19) - ActiveSheet.Cells(7, i)) / 30 * 100\n            ActiveSheet.Cells(M, 13) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 19)) / 30 * 100\n        End If\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 20) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 21) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 21) Then\n            ActiveSheet.Cells(M, 13) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n        Else\n            ActiveSheet.Cells(M, 13) = (ActiveSheet.Cells(23, 21) - ActiveSheet.Cells(7, i)) / 30 * 100\n            ActiveSheet.Cells(M, 14) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 21)) / 30 * 100\n        End If\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 22) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 23) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 23) Then\n            ActiveSheet.Cells(M, 14) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n        Else\n             ActiveSheet.Cells(M, 14) = (ActiveSheet.Cells(23, 23) - ActiveSheet.Cells(7, i)) / 30 * 100\n              ActiveSheet.Cells(M, 15) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 23)) / 30 * 100\n        End If\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 24) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 25) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 25) Then\n            ActiveSheet.Cells(M, 15) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n        Else\n            ActiveSheet.Cells(M, 15) = (ActiveSheet.Cells(23, 25) - ActiveSheet.Cells(7, i)) / 30 * 100\n            ActiveSheet.Cells(M, 16) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 25)) / 30 * 100\n        End If\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 26) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 27) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 27) Then\n            ActiveSheet.Cells(M, 16) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n        Else\n            ActiveSheet.Cells(M, 16) = (ActiveSheet.Cells(23, 25) - ActiveSheet.Cells(7, i)) / 30 * 100\n            ActiveSheet.Cells(M, 17) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 25)) / 30 * 100\n        End If\n    End If\n\n    If ActiveSheet.Cells(7, i) &gt;= ActiveSheet.Cells(23, 28) And ActiveSheet.Cells(7, i) &lt;= ActiveSheet.Cells(23, 29) Then\n        If ActiveSheet.Cells(8, i) &lt;= ActiveSheet.Cells(23, 29) Then\n            ActiveSheet.Cells(M, 17) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(7, i)) / 30 * 100\n        Else\n            ActiveSheet.Cells(M, 17) = (ActiveSheet.Cells(23, 29) - ActiveSheet.Cells(7, i)) / 30 * 100\n             ActiveSheet.Cells(M, 6) = (ActiveSheet.Cells(8, i) - ActiveSheet.Cells(23, 29)) / 30 * 100\n        End If\n    End If\n\n    M = M + 1\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "edited": false, "score": 0, "creation_date": 1505889281, "post_id": 46314705, "comment_id": 79591133, "body": "Thanks..but it formats percentage as a fraction (&quot;0.6&quot;) instead of &quot;60.0%&quot;"}, {"owner": {"reputation": 3333, "user_id": 3138531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a9a9881a8fedbbd3048ebdfced5ef3a?s=128&d=identicon&r=PG", "display_name": "serakfalcon", "link": "https://stackoverflow.com/users/3138531/serakfalcon"}, "edited": false, "score": 0, "creation_date": 1505889584, "post_id": 46314705, "comment_id": 79591303, "body": "that&#39;s fixable by changing the format of the cell itself."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505892715, "post_id": 46314705, "comment_id": 79593140, "body": "Updated my answer to show 2 ways to reach your goal"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1505892674, "last_edit_date": 1505892674, "creation_date": 1505888742, "answer_id": 46314705, "question_id": 46314656, "link": "https://stackoverflow.com/questions/46314656/excel-vba-trim-decimal-places-off-a-percentage/46314705#46314705", "title": "Excel VBA: Trim decimal places off a percentage", "body": "<p>In VBA, you can use the <code>round</code> function.</p>\n\n<pre><code>wbTarget_ACX.Cells(Row_TargetStart, j + 5) = Round(Percentage_value, 1) &amp; \" (\" &amp; Sample_size &amp; \")\"\n</code></pre>\n\n<p>If your percentage value is already correctly formatted in the sheet, use the <code>text</code>-property of the cell:</p>\n\n<pre><code>wbTarget_ACX.Cells(Row_TargetStart, j + 5) = wbSource_ACX.Range(\"M\" &amp; j).text &amp; \" (\" &amp; Sample_size &amp; \")\"\n</code></pre>\n\n<p>Else calculate the value by your own (and add the %-sign)</p>\n\n<pre><code>Percentage_value = wbSource_ACX.Range(\"M\" &amp; j).Value * 100\nwbTarget_ACX.Cells(Row_TargetStart, j + 5) = Round(Percentage_value, 1) &amp; \"% (\" &amp; Sample_size &amp; \")\"\n</code></pre>\n\n<p>BTW: You can (and should) remove all the <code>activate</code> and <code>select</code> commands - they are not neccessary.</p>\n"}, {"tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": false, "score": 0, "last_activity_date": 1505889546, "creation_date": 1505889546, "answer_id": 46314925, "question_id": 46314656, "link": "https://stackoverflow.com/questions/46314656/excel-vba-trim-decimal-places-off-a-percentage/46314925#46314925", "title": "Excel VBA: Trim decimal places off a percentage", "body": "<p>The value in the cell is only formated to look like a rounded percentage. Excel stores the actual value as calculated with all decimal places in the background. You see this when you click on the cell and look at the value in the formula bar.</p>\n\n<p>You can trim the value to 1 decimal place in VBA either by a number of methods. There is the <code>Round</code> Function in VBA or you can use one of the worksheet functions that also do rounding. Here are a few examples (with the number in the example being written in cell A1 of the active sheet):</p>\n\n<pre><code>Sub test()\n    Debug.Print Round(Range(\"a1\"), 1)\n    Debug.Print WorksheetFunction.Round(Range(\"a1\"), 1)\n    Debug.Print WorksheetFunction.RoundUp(Range(\"a1\"), 1)\n    Debug.Print WorksheetFunction.RoundDown(Range(\"a1\"), 1)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1327, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505892674, "creation_date": 1505888487, "question_id": 46314656, "link": "https://stackoverflow.com/questions/46314656/excel-vba-trim-decimal-places-off-a-percentage", "title": "Excel VBA: Trim decimal places off a percentage", "body": "<p>Below is a snippet of an excel vba code. I'm trying to combine a percentage value and numerical sample size value (both in separate cells) into one cell</p>\n\n<p>However, there are many decimals for the % value. Even though I have changed the format to show only 1 decimal value, when I click on the cell, it still shows multiple decimal places. Hence, when I combine the 2 variables, the full length of decimal places is combined with the sample size, which is not what I want.</p>\n\n<p>How do I trim off these unnecessary decimal places?</p>\n\n<pre><code>        For j = Row_SourceStart To Row_SourceEnd\n\n            wbSource.Activate\n            wbSource_ACX.Select\n            Percentage_value = wbSource_ACX.Range(\"M\" &amp; j).NumberFormat = \"0.0%\"\n            Sample_size = wbSource_ACX.Cells(j, 12)\n\n            wbTarget.Activate\n            Set wbTarget_ACX = wbTarget.Worksheets(ArrayWS_Source(0))\n            wbTarget_ACX.Select\n            wbTarget_ACX.Cells(Row_TargetStart, j + 5) = Percentage_value &amp; \" (\" &amp; Sample_size &amp; \")\"\n\n        Next j\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1505887339, "post_id": 46314196, "comment_id": 79590224, "body": "Refer <a href=\"https://stackoverflow.com/questions/46137592/excel-vba-i-need-to-transpose-data-from-columns-to-rows/46138010#46138010\">this</a>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1505906635, "post_id": 46314196, "comment_id": 79602148, "body": "Use <code>Power Query</code> (excel 2010-13) or <code>Get &amp; Transform</code> (Excel 2016) to unpivot the <code>A B C</code> columns."}, {"owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "edited": false, "score": 0, "creation_date": 1505937826, "post_id": 46314196, "comment_id": 79622553, "body": "I got a way to do this just using formulas without VBA if that is the way you want.  But you will need to convince chris neilsen so I can add to the answer."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 8633313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8T4OL.jpg?s=128&g=1", "display_name": "tranyo", "link": "https://stackoverflow.com/users/8633313/tranyo"}, "is_accepted": false, "score": -1, "last_activity_date": 1505889533, "creation_date": 1505889533, "answer_id": 46314920, "question_id": 46314196, "link": "https://stackoverflow.com/questions/46314196/how-to-stack-up-excel-rows-to-columns-as-shown-below/46314920#46314920", "title": "How to stack up excel rows to column(s)? [as shown below]", "body": "<p>hope this will help you ;)</p>\n\n<pre><code>        Public Type res\n            cat As String\n            mtype As String\n            price As Long\n        End Type\n        Sub arranger()\n        'defs+inits\n            Set src = Sheets(\"src\")\n            Set res = Sheets(\"result\")\n            Dim mydatas() As res\n            lastrow = src.Cells(1, 1).End(xlDown).Row\n            'just for safe :)\n            If lastrow &gt; 65000 Then Exit Sub\n            ReDim mydatas(2 To lastrow * 3)\n            act = 2\n\n        'fill array\n            For actrow = 2 To lastrow\n                For col = 2 To 4\n                    mydatas(act).cat = src.Cells(actrow, 1)\n                    mydatas(act).mtype = src.Cells(1, col)\n                    mydatas(act).price = src.Cells(actrow, col)\n                    act = act + 1\n                Next col\n            Next actrow\n        'write back in new format\n            'headers\n            res.Cells(1, 1) = \"Cat\"\n            res.Cells(1, 2) = \"Type\"\n            res.Cells(1, 3) = \"price\"\n            'datas\n            For act = 2 To UBound(mydatas) - 2\n                res.Cells(act, 1) = mydatas(act).cat\n                res.Cells(act, 2) = mydatas(act).mtype\n                res.Cells(act, 3) = mydatas(act).price\n            Next act\n\n        End Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7005074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLBgg.png?s=128&g=1", "display_name": "Sashank Allamraju", "link": "https://stackoverflow.com/users/7005074/sashank-allamraju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "closed_date": 1505888967, "answer_count": 1, "score": 0, "last_activity_date": 1505906202, "creation_date": 1505886669, "last_edit_date": 1531161705, "question_id": 46314196, "link": "https://stackoverflow.com/questions/46314196/how-to-stack-up-excel-rows-to-columns-as-shown-below", "closed_reason": "Duplicate", "title": "How to stack up excel rows to column(s)? [as shown below]", "body": "<p>I have a dataset with 50,000 records. The format is like shown below.</p>\n\n<pre><code>Category | A   | B   | C\n---------|-----|-----|-----\nX        | 100 | 120 | 150\nY        | 200 | 220 | 250\nZ        | 300 | 320 | 350\n</code></pre>\n\n<p>I want the resulting table to look like the one shown below. </p>\n\n<pre><code>Category | Type | price\n---------|------|-----\nX        | A    | 100 \nX        | B    | 120\nX        | C    | 150\n---------|------|----\nY        | A    | 200 \nY        | B    | 220\nY        | C    | 250\n---------|------|----\nZ        | A    | 300 \nZ        | B    | 320\nZ        | C    | 350\n</code></pre>\n\n<p>How can I do this in MS Excel?</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1505887183, "post_id": 46314145, "comment_id": 79590153, "body": "Are you missing a backslash in your file path after <code>001 Practice Data Reports</code>  ?"}, {"owner": {"reputation": 1, "user_id": 8638730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0beca46842ec6474aece358d9c32088b?s=128&d=identicon&r=PG&f=1", "display_name": "BradJP", "link": "https://stackoverflow.com/users/8638730/bradjp"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1505888816, "post_id": 46314145, "comment_id": 79590909, "body": "Hi, thanks for your comment, I updated with a backslash, however, it still produces the &#39;400&#39; error"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1505899508, "post_id": 46314145, "comment_id": 79597457, "body": "You have checked that the folder  Y:\\002 Data Program Documents\\001 Practice Data Reports Actually exists?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1505918978, "post_id": 46314145, "comment_id": 79611144, "body": "What is the full path generated?"}, {"owner": {"reputation": 1, "user_id": 8638730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0beca46842ec6474aece358d9c32088b?s=128&d=identicon&r=PG&f=1", "display_name": "BradJP", "link": "https://stackoverflow.com/users/8638730/bradjp"}, "edited": false, "score": 0, "creation_date": 1505947600, "post_id": 46314145, "comment_id": 79626476, "body": "Hi, the folder definitely exists, however, to simplify, I created a folder on my desktop to save the PDF&#39;s into but still no luck, the &#39;400&#39; error is still displaying"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1505950851, "post_id": 46314145, "comment_id": 79627304, "body": "What&#39;s in <code>J3</code> ?"}, {"owner": {"reputation": 1, "user_id": 8638730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0beca46842ec6474aece358d9c32088b?s=128&d=identicon&r=PG&f=1", "display_name": "BradJP", "link": "https://stackoverflow.com/users/8638730/bradjp"}, "edited": false, "score": 0, "creation_date": 1505954392, "post_id": 46314145, "comment_id": 79628057, "body": "Hi, J3 has a drop down list / filter which is part of a pivot table. I need the code to filter each item in the drop down list and save a PDF for each filter selection."}, {"owner": {"reputation": 1, "user_id": 8638730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0beca46842ec6474aece358d9c32088b?s=128&d=identicon&r=PG&f=1", "display_name": "BradJP", "link": "https://stackoverflow.com/users/8638730/bradjp"}, "edited": false, "score": 0, "creation_date": 1505965926, "post_id": 46314145, "comment_id": 79630519, "body": "I think it may not be working as the VBA says to look at a dropdown/data validation list. I need for it to look/loop through a Pivot Table filter/drop down... Could anyone assist with updating the code to do this.... Rather than &#39;Dropdown&#39; it should relate to the Pivot Table"}], "owner": {"reputation": 1, "user_id": 8638730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0beca46842ec6474aece358d9c32088b?s=128&d=identicon&r=PG&f=1", "display_name": "BradJP", "link": "https://stackoverflow.com/users/8638730/bradjp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 581, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505886434, "creation_date": 1505886434, "question_id": 46314145, "link": "https://stackoverflow.com/questions/46314145/error-400-on-excel-vba-pdf-print", "title": "Error &#39;400&#39; on Excel VBA - PDF Print", "body": "<p>I am receiving an Error '400' message box - (no other info/text displays), whilst trying to run the following code as per below. I am not overly experienced in VBA and have copied this code from another workbook and adjusted accordingly. In short, the code looks at a drop down list/pivot table filter and will create, name and save a PDF in a specified folder location. Any help would be appreciated! &amp; thank you in advance! :) Below is the following code I am using:</p>\n\n<p>Sub PDFReports()</p>\n\n<pre><code>Dim Dropdown1 As String\nDim Range1 As Range\nDim option1 As Range\nDim counter As Long\nDim cellcontents As String\nDim SaveAsStr As String\n\ncounter = 1\nDropdown1 = \"j3\"\n\nSet Range1 = Evaluate(Range(Dropdown1).Validation.Formula1)\n\nFor Each option1 In Range1\nActiveSheet.Range(\"j3\").Select\n  ActiveCell.Value = option1.Value 'change dropdown value\n   SaveAsStr = \"Y:\\002 Data Program Documents\\001 Practice Data Reports\" &amp; _\n   ActiveSheet.Range(\"J3\").Value 'save pdf with value in dropdown in filename\n   ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n       SaveAsStr &amp; \" Data Report \" &amp; Format(Now, \"dd-mm-yy\") &amp; \".pdf\"\n    counter = counter + 1\nNext option1\n\n    MsgBox \"Reports complete\"\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1505883347, "post_id": 46313537, "comment_id": 79588712, "body": "You&#39;re not doing anything with n2. And you&#39;re assigning n1, which comes from H2, back to H2, overwriting any formula that lives in H2. That code does nothing useful. It is not clear what you are trying to achieve."}, {"owner": {"reputation": 319, "user_id": 4980228, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/087979b462aecd87d52ae5f5b9d88bcc?s=128&d=identicon&r=PG&f=1", "display_name": "Midori_hige", "link": "https://stackoverflow.com/users/4980228/midori-hige"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1505884165, "post_id": 46313537, "comment_id": 79588977, "body": "I&#39;m trying to add C2 with H2 till H2 reaches 0 and also that this can be applied to the entire row of C2 and H2 where there are values."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1505886221, "post_id": 46313537, "comment_id": 79589717, "body": "What is the formula in H2? I&#39;m still not seeing what the bigger picture is and why you want to use VBA to set H2 to 0. What is the purpose of all this?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1505886414, "post_id": 46313537, "comment_id": 79589806, "body": "you have a problem with basic math. if you add -40000 to 10000 you will get -30000"}, {"owner": {"reputation": 319, "user_id": 4980228, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/087979b462aecd87d52ae5f5b9d88bcc?s=128&d=identicon&r=PG&f=1", "display_name": "Midori_hige", "link": "https://stackoverflow.com/users/4980228/midori-hige"}, "edited": false, "score": 0, "creation_date": 1505886632, "post_id": 46313537, "comment_id": 79589900, "body": "H2 interacts with other cells to calculate a value. When C2 changes, so does H2."}, {"owner": {"reputation": 319, "user_id": 4980228, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/087979b462aecd87d52ae5f5b9d88bcc?s=128&d=identicon&r=PG&f=1", "display_name": "Midori_hige", "link": "https://stackoverflow.com/users/4980228/midori-hige"}, "edited": false, "score": 0, "creation_date": 1505886806, "post_id": 46313537, "comment_id": 79589992, "body": "Here it how it works:  B2 = 100,000 | C2 = 10,000 | D2 = C2 + B2 | E2 = 50,000 | F2 = D2 -E2 | G2 = 100,000 | H2 = F2 -G2"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1505886932, "post_id": 46313537, "comment_id": 79590060, "body": "H2 .... what is the formula?"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1505893548, "post_id": 46313537, "comment_id": 79593669, "body": "@Midori_hige, so you want to run this for entire C and H column up to the last range?"}], "answers": [{"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 1, "last_activity_date": 1505895723, "creation_date": 1505895723, "answer_id": 46316904, "question_id": 46313537, "link": "https://stackoverflow.com/questions/46313537/how-to-perform-a-while-loop-keep-formula-in-cell-and-apply-into-entire-row-exc/46316904#46316904", "title": "How to perform a while loop, keep formula in cell and apply into entire row? Excel", "body": "<p>Hope this is what you are looking for...</p>\n\n<pre><code>Dim n1 As Double\nDim n2 As Double\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim lastrow, i As Variant\n    lastrow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To lastrow\n        n1 = Cells(i, 8).Value\n        n2 = Cells(i, 3).Value\n        Do While n1 &lt;&gt; 0\n            n2 = n2 + (n1 * -1)\n            Cells(i, 3).Value = n2\n            n1 = Cells(i, 8).Value\n        Loop\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 4980228, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/087979b462aecd87d52ae5f5b9d88bcc?s=128&d=identicon&r=PG&f=1", "display_name": "Midori_hige", "link": "https://stackoverflow.com/users/4980228/midori-hige"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 46316904, "answer_count": 1, "score": 2, "last_activity_date": 1505895723, "creation_date": 1505883104, "last_edit_date": 1505890780, "question_id": 46313537, "link": "https://stackoverflow.com/questions/46313537/how-to-perform-a-while-loop-keep-formula-in-cell-and-apply-into-entire-row-exc", "title": "How to perform a while loop, keep formula in cell and apply into entire row? Excel", "body": "<p>I'm trying to create a Macros using Excel and Visual Basic where I can perform an addition between a cell and another cell that has a formula in it. I need to perform this addition until the cell with the formula reaches 0. </p>\n\n<p>Let's say, if:</p>\n\n<p>C2 = 10,000<br>\nH2 (the one with the formula) = -40,000</p>\n\n<p>I have to add the 40,000 from H2 to C2, so I can get 50,000 and H2 reaches 0. H2 would reach 0 due to its formula.</p>\n\n<p>What I have tried to accomplish this is by using a While Loop. However, this loop gets stuck in infinite and also my H2 cell loses it's formula.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Dim n1 As Double\nDim n2 As Double\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)            \n    n1 = Cells(2, 8).Value\n    n2 = Cells(2, 3).Value\n\n    Do While n1 &lt;&gt; 0\n        n2 = n2 + (n1 * -1)\n        Cells(2, 3).Value = n2\n        n1 = Cells(2, 8).Value       \n    Loop\nEnd Sub\n</code></pre>\n\n<p>Also, I need to apply this very same method but on every row of C and H where they have a value.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1505888990, "post_id": 46313498, "comment_id": 79590994, "body": "And your question is?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1505891087, "post_id": 46313498, "comment_id": 79592173, "body": "And your question is? With keeping in mind that <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">\u201c<i>Can someone help me?</i>\u201d is not an actual question!</a>"}], "owner": {"reputation": 35, "user_id": 6577141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43377c1664fb3ffbb563fe403be963f1?s=128&d=identicon&r=PG&f=1", "display_name": "wainseven", "link": "https://stackoverflow.com/users/6577141/wainseven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505885331, "creation_date": 1505882884, "last_edit_date": 1505885331, "question_id": 46313498, "link": "https://stackoverflow.com/questions/46313498/loop-every-worksheet-to-find-matched-value-and-paste-entire-row-to-the-master-sh", "title": "Loop every worksheet to find matched value and paste entire row to the master sheet", "body": "<p>Sorry I am new to vba. What I am trying to do is to merge different workbooks into the master workbook under the same file. After that I need to look across every worksheets in the master workbook to look for value in a particular column that matches the input value. If there is a match, then copy the entire row to the master workbook.</p>\n\n<p>e.g. Sheet 2</p>\n\n<pre><code>PAYING  CASH    20914-351   13796   \nCLOSED  AUTOPAY 10515-283   13795   \nPAYING  AUTOPAY 10415-152   13794   \nPAYING  CASH    10515-146   13793\n</code></pre>\n\n<p>Sheet 3</p>\n\n<pre><code>CLOSED  AUTOPAY 30215-037   13792   \nPAYING  AUTOPAY 20914-351   13791   \nPAYING  CASH    10415-221   13790\n</code></pre>\n\n<p>If the input value in sheet 2, sheet 3 matches 20914-351 in column C, then the entire row copied to the masterbook </p>\n\n<pre><code>PAYING  CASH    20914-351   13796\n\nPAYING  AUTOPAY 20914-351   13791\n</code></pre>\n\n<p>I have copied from somewhere and got it working for the merging part. Thank you so much!</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim directory As String, fileName As String, sheet As Worksheet, total As Integer\nDim WrdArray() As String\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\ndirectory = \"C:\\Users\\ISS-KTHP-001\\Desktop\\Accom Master File\\\"\nfileName = Dir(directory &amp; \"*.xlsx\")\n\nDo While fileName &lt;&gt; \"\"\nWorkbooks.Open (directory &amp; fileName)\n    WrdArray() = Split(fileName, \".\")\n    For Each sheet In Workbooks(fileName).Worksheets\n    Workbooks(fileName).ActiveSheet.Name = WrdArray(0)\n        total = Workbooks(\"Book2.xlsm\").Worksheets.Count\n        Workbooks(fileName).Worksheets(sheet.Name).Copy     after:=Workbooks(\"Book2.xlsm\").Worksheets(total)\n\n        GoTo exitFor:\n\n    Next sheet\n\nexitFor:\nWorkbooks(fileName).Close\nfileName = Dir()\nLoop\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1505889329, "post_id": 46312837, "comment_id": 79591156, "body": "If today is <code>Date()</code> then yesterday is <code>Date() - 1</code> and tomorrow is <code>Date() + 1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505893246, "post_id": 46315819, "comment_id": 79593491, "body": "The month being used in the comparison is based on <code>[Due Date]</code>, not <code>[Opened Date]</code>.  And <code>DateAdd(&quot;d&quot;, Offset, Date)</code> can be simplified to <code>Date() + Offset</code>."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505893789, "post_id": 46315819, "comment_id": 79593806, "body": "Thanks, missed that. Answer is expanded."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1505893749, "last_edit_date": 1505893749, "creation_date": 1505892602, "answer_id": 46315819, "question_id": 46312837, "link": "https://stackoverflow.com/questions/46312837/how-to-find-tomorrow-and-yesterday-date/46315819#46315819", "title": "How to find tomorrow and yesterday date", "body": "<p>You must take into account that \"tommorrow\" and \"yesterday\" may fall in another year. Thus, use <em>DateAdd</em>:</p>\n\n<pre><code>Dim Offset As Integer\n\nSelect Case [Forms]![issues]![OpenedDateFilter]\n    Case \"tomorrow\"\n        Offset = 1\n    Case \"yesterday\"\n        Offset = -1\n    Case Else\n        Offset = 0\nEnd Select\n\nMe.Filter = \"[Opened Date] = #\" &amp; Format(DateAdd(\"d\", Offset, Date), \"yyyy\\/mm\\/dd\") &amp; \"#\"\nMe.FilterOn = True\n</code></pre>\n\n<p>If <code>[Due Date]</code> is not a typo, you can use <em>DateSerial</em>:</p>\n\n<pre><code>Me.Filter = \"[Opened Date] = #\" &amp; Format(DateSerial(Year(Date), Month([Due Date]), Day(Date) + Offset), \"yyyy\\/mm\\/dd\") &amp; \"#\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8638176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969a467f2234de3056dbb91f727fb3cf?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamedamy Amy", "link": "https://stackoverflow.com/users/8638176/mohamedamy-amy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 787, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1505901381, "creation_date": 1505878410, "last_edit_date": 1505901381, "question_id": 46312837, "link": "https://stackoverflow.com/questions/46312837/how-to-find-tomorrow-and-yesterday-date", "title": "How to find tomorrow and yesterday date", "body": "<p>I want to filter a form to show the dates for tomorrow and yesterday.</p>\n\n<p>The form is working well for today with the following macro</p>\n\n<pre><code>if [Forms]![issues]![OpenedDateFilter]=\"today\"\napplyfilter\nwhere condition\n(Year([Opened Date])=Year(Date()) And Month([Due Date])=Month(Date()) And \nDay([Opened Date])=Day(Date()))\n</code></pre>\n\n<p>Thank you for any help or pointers.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1, "user_id": 3724482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9c1fa6d250488fe061339775c4b52e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3724482", "link": "https://stackoverflow.com/users/3724482/user3724482"}, "edited": false, "score": 0, "creation_date": 1505877253, "post_id": 46312655, "comment_id": 79587134, "body": "Sub ctest() Dim i As Long For i = 1 To 5000     With Range(&quot;AR&quot; &amp; i)              If Left(.Value, 1) &lt;&gt; &quot;i&quot; Then GoTo NextIteration Else          If Len(.Value) = 6 Then .Copy Destination:=.Offset(, 2)         If Len(.Value) = 7 Then .Copy Destination:=.Offset(, 2)          NextIteration:     End With  Next i End Sub"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505881042, "post_id": 46312655, "comment_id": 79588030, "body": "Define &quot;But this doesn&#39;t seem to work well.&quot; - does it give an error?  Does it not do what you expect?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3724482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9c1fa6d250488fe061339775c4b52e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3724482", "link": "https://stackoverflow.com/users/3724482/user3724482"}, "edited": false, "score": 0, "creation_date": 1505896156, "post_id": 46312899, "comment_id": 79595308, "body": "thats a good idea.... however,    If Left(.Value, 1) = &quot;i&quot; Then  this line doesnt seem to be recognised very well. hmm the value is all blanks"}], "tags": [], "owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "is_accepted": false, "score": 0, "last_activity_date": 1505878850, "creation_date": 1505878850, "answer_id": 46312899, "question_id": 46312655, "link": "https://stackoverflow.com/questions/46312655/vba-conditional-skipping-statements-loop/46312899#46312899", "title": "VBA conditional skipping statements loop", "body": "<p>If you just want to skip the loop, why don't use basic <code>if</code> statement</p>\n\n<pre><code>Sub ctest()\nDim i As Long\nFor i = 1 To 5000\n    With Range(\"AR\" &amp; i)\n\n        If Left(.Value, 1) = \"i\" Then\n            If Len(.Value) = 6 Then .Copy Destination:=.Offset(, 2)\n            If Len(.Value) = 7 Then .Copy Destination:=.Offset(, 2)\n        End If\n\n    End With\n\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3724482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9c1fa6d250488fe061339775c4b52e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3724482", "link": "https://stackoverflow.com/users/3724482/user3724482"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505880905, "creation_date": 1505877230, "last_edit_date": 1505880905, "question_id": 46312655, "link": "https://stackoverflow.com/questions/46312655/vba-conditional-skipping-statements-loop", "title": "VBA conditional skipping statements loop", "body": "<p>Tried to look into cells in a column and then find out if the cells has 6/7 characters and if it has i.</p>\n\n<p>Then copy over.</p>\n\n<pre><code>Sub ctest()\nDim i As Long\nFor i = 1 To 5000\n    With Range(\"AR\" &amp; i)\n\n        If Left(.Value, 1) &lt;&gt; \"i\" Then GoTo NextIteration Else\n\n        If Len(.Value) = 6 Then .Copy Destination:=.Offset(, 2)\n        If Len(.Value) = 7 Then .Copy Destination:=.Offset(, 2)\n\nNextIteration:\n    End With\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>But this doesn't seem to work well..\nThanks guys.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505877961, "post_id": 46312628, "comment_id": 79587293, "body": "You should really declare all your variables, and <code>sathish</code> should probably be declared as a <code>String</code> if it is going to contain values such as <code>&quot;ABC21A&quot;</code>.  (It&#39;s good practice to include <code>Option Explicit</code> as the first line of your module, so that your code won&#39;t run until you <b>have</b> explicitly declared all your variables.)  But that doesn&#39;t explain your error because at the moment your variable is declared implicitly as a <code>Variant</code> (with a subtype of <code>Variant&#47;String</code>) so shouldn&#39;t do anything differently than if you had declared it correctly."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 2, "creation_date": 1505878065, "post_id": 46312628, "comment_id": 79587320, "body": "After <code>.getElementById(&quot;btnSubmit&quot;).Click</code>, does it navigate to different url? If so, you cannot re-use that Document instance. The error you got simply says there aren&#39;t those Elements on that login Document. You need to use a different method to get that new <b>Document</b> in order to get those elements. Search <i>ShellWindows</i> and there should be many examples."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505878169, "post_id": 46312628, "comment_id": 79587339, "body": "^^ or, if the <code>id=&quot;filter_ReferenceCode&quot;</code> is on the same document as you clicked on the previous statement, perhaps you need to fill in its <code>Value</code> <b>before</b> you do the <code>Click</code>."}, {"owner": {"reputation": 21, "user_id": 8617346, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y4bD9MrUgJM/AAAAAAAAAAI/AAAAAAAACuI/mst7q2jEmvM/photo.jpg?sz=128", "display_name": "sathish kumar ronnie", "link": "https://stackoverflow.com/users/8617346/sathish-kumar-ronnie"}, "edited": false, "score": 0, "creation_date": 1505878519, "post_id": 46312628, "comment_id": 79587434, "body": "when i used F8 to run the code manually it working properly to get data. But i cant do it automatically use play button"}, {"owner": {"reputation": 21, "user_id": 8617346, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y4bD9MrUgJM/AAAAAAAAAAI/AAAAAAAACuI/mst7q2jEmvM/photo.jpg?sz=128", "display_name": "sathish kumar ronnie", "link": "https://stackoverflow.com/users/8617346/sathish-kumar-ronnie"}, "edited": false, "score": 0, "creation_date": 1505878654, "post_id": 46312628, "comment_id": 79587465, "body": "Error happening here:-           appIE.document.getElementById(&quot;__tab_tabFilter&quot;).Click"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505878861, "post_id": 46312628, "comment_id": 79587521, "body": "How did your code compile with <code>Option Explicit</code> (which, BTW, you should <b>always</b> have), without <code>sathish</code> being declared? BTW you should give meaningful names to your variables: <i>your</i> name doesn&#39;t mean anything in the code."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1505880733, "post_id": 46312628, "comment_id": 79587961, "body": "If your code runs while debugging but fails when run straight through, that&#39;s typically an indication that you need to add in some wait time after certain steps."}, {"owner": {"reputation": 21, "user_id": 8617346, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y4bD9MrUgJM/AAAAAAAAAAI/AAAAAAAACuI/mst7q2jEmvM/photo.jpg?sz=128", "display_name": "sathish kumar ronnie", "link": "https://stackoverflow.com/users/8617346/sathish-kumar-ronnie"}, "edited": false, "score": 0, "creation_date": 1506047092, "post_id": 46312628, "comment_id": 79671670, "body": "Hi All, Thanks for your response, i use wait time now its working successfully. T"}], "owner": {"reputation": 21, "user_id": 8617346, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y4bD9MrUgJM/AAAAAAAAAAI/AAAAAAAACuI/mst7q2jEmvM/photo.jpg?sz=128", "display_name": "sathish kumar ronnie", "link": "https://stackoverflow.com/users/8617346/sathish-kumar-ronnie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 472, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505878734, "creation_date": 1505876972, "last_edit_date": 1531164843, "question_id": 46312628, "link": "https://stackoverflow.com/questions/46312628/error-shows-like-object-variable-or-with-block-variable-not-set", "title": "Error shows like &quot;Object variable or With block variable not set &quot;", "body": "<p>While runing the below code I received an error on this line:</p>\n\n<pre><code>appIE.document.getElementById(\"__tab_tabFilter\").Click\n</code></pre>\n\n<p>The error is:</p>\n\n<blockquote>\n  <p><em>Object variable or With block variable not set</em></p>\n</blockquote>\n\n<p>A variable <code>sathish</code> should contain a value like <code>\"ABC21A\"</code>. Please suggest me how to declare this variable. Also, this code needs to run 1000 times to fetch data.</p>\n\n<pre><code>Sub macro()\n    Dim appIE As Object\n    Dim objElement As Object\n    Dim Y As Long\n    Dim obj As Object\n    Dim r As Long, c As Long, t As Long\n\n    Dim objCollection As Object\n    Dim eRow As Long\n\n    ' Create InternetExplorer Object\n    Set appIE = CreateObject(\"InternetExplorer.Application\")\n\n    With appIE\n       appIE.Visible = False\n       appIE.navigate \"website\"\n\n       Do While appIE.Busy Or appIE.ReadyState &lt;&gt; 4\n          DoEvents\n       Loop\n\n       appIE.Visible = True\n       appIE.document.getElementById(\"Username\").Value = \"\"\n       appIE.document.getElementById(\"Password\").Value = \"\"\n       appIE.document.getElementById(\"btnSubmit\").Click\n\n       Number = Range(\"A1\", Range(\"A1\").End(xlDown)).Rows.Count\n\n       For Y = 1 To Number\n           sathish = Cells(Y, 1).Value\n           appIE.document.getElementById(\"__tab_tabFilter\").Click\n           appIE.document.getElementById(\"filter_ReferenceCode\").Value = sathish\n           appIE.document.getElementById(\"filter_btnSetFilter\").Click\n\n           'Set IE = Nothing\n           Set objCollection = appIE.document.getElementsByTagName(\"TABLE\")\n\n           For t = 10 To (objCollection.Length - 1)\n               For r = 0 To (objCollection(t).Rows.Length - 1)\n                   eRow = Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n                   For c = 0 To (objCollection(t).Rows(r).Cells.Length - 1)\n                       ThisWorkbook.Worksheets(2).Cells(eRow, c + 1) = objCollection(t).Rows(r).Cells(c).innerText\n                   Next c\n               Next r\n\n               If t = objCollection.Length - 1 Then\n                   Cells(eRow + 1, 1) = \"\"\n               End If\n           Next t\n        Next Y\n    End With\n    ' Set IE = Nothing\nEnd Sub\n</code></pre>\n\n<p>Using <code>Option Explicit</code> I get the same \"Object variable or With block variable not set\" error here: </p>\n\n<pre><code>appIE.document.getElementById(\"__tab_tabFilter\").Click\n</code></pre>\n\n<p>HTML:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;span id=\"__tab_tabFilter\" class=\"ajax__tab_tab\"&gt;Filter&lt;/span&gt;\n\n&lt;input name=\"filter:ReferenceCode\" type=\"text\" maxlength=\"32\" id=\"filter_ReferenceCode\" class=\"textbox\" style=\"width:136px;\"&gt;\n</code></pre>\n"}]