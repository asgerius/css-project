[{"tags": ["excel", "vba", "formatting", "numbers"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1563413178, "post_id": 57085273, "comment_id": 100694691, "body": "Pl be little be more elaborate on the way you want to sum and the example provided. Do you want to sum numerically then 16+4 would be 20, if want to concatenate the strings then it would be 164 or 16,4 (with comma as separator)."}, {"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1563486963, "post_id": 57085273, "comment_id": 100727217, "body": "Thanks for replying. I have a column price and column qty. And a column with total. I wanted to see the total of all values in the total column in the userform. The calculations are made direct from the userform. So no formulas in my Excel sheet"}], "answers": [{"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1563438268, "last_edit_date": 1563438268, "creation_date": 1563437710, "answer_id": 57089983, "question_id": 57085273, "link": "https://stackoverflow.com/questions/57085273/sum-of-listbox-is-not-showing-the-comma/57089983#57089983", "title": "sum of listbox is not showing the comma", "body": "<p>You import text values into your ListBox, I think it's better to import values/doubles directly. </p>\n\n<p>but try:</p>\n\n<pre><code>Mysum = Mysum + Replace(.List(r, 4), \".\", \",\")\n</code></pre>\n\n<p>or (only when it's possible to evaluate to a number):</p>\n\n<pre><code>Mysum = Mysum + Application.Evaluate(.List(r, 4))\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1563438268, "creation_date": 1563406634, "last_edit_date": 1563431037, "question_id": 57085273, "link": "https://stackoverflow.com/questions/57085273/sum-of-listbox-is-not-showing-the-comma", "title": "sum of listbox is not showing the comma", "body": "<p>I am trying to sum the total in a column form a Listbox\nI noticed if I use point, the calculation is not correct. After using comma calculation was correct, but the total is calculated via VBA and is not showing correctly. The result is that the sum of that column is not correctly shown.\nexample\n2,16 +\n4,16\nis calculated as 632. but is should be 6,32\nI provided the code I used. I am not an expert neither a programmer. So a little help of you guys is welcome. </p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim Mysum As Double\nDim Cnt As Long\nMysum = 0\n\nSheet1.Activate\nListBox1.ColumnWidths = \"140;95;50;55;55;65;90\"         'Column Widths Of \nListbox\nListBox1.ColumnCount = 7                                                        \n'Column Count Of Listbox\nListBox1.List = Sheet1.Range(\"A2:G\" &amp; Sheet1.Cells(Rows.count, \n1).End(xlUp).Row).Value\n\nWith ListBox1\nFor r = 0 To .ListCount - 1\nCnt = Cnt + 1\nMysum = Mysum + .List(r, 4)\nNext r\nEnd With\nTextBox10.Value = Mysum\nTextBox12.Value = Cnt\n\n\nWith ComboBox1\n.AddItem \"Item Name\"\n.AddItem \"Barcode\"\n.AddItem \"Location\"\nEnd With\nWith ComboBox2\n.AddItem \"=\"\n.AddItem \"&lt;\"\n.AddItem \"&gt;\"\nEnd With\nTextBox9.Value = ListBox1.ListCount\nEnd Sub    \n</code></pre>\n"}, {"tags": ["vba", "ms-word", "ms-office"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1563403355, "post_id": 57084771, "comment_id": 100692805, "body": "Please share how you tried to adapt the code from the linked answer."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563405097, "post_id": 57084771, "comment_id": 100693200, "body": "&quot;it did not work for me&quot; - it&#39;s exactly the type of code which someone might post here as an answer, so if it didn&#39;t work for you it&#39;s always useful to (a) show exactly what you tried and (b) explain what errors you got, or how it didn&#39;t produce the expected result."}, {"owner": {"reputation": 3, "user_id": 11762063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/075fe4ae108b178c56d4dd693aa2b186?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi Tetali", "link": "https://stackoverflow.com/users/11762063/vamsi-tetali"}, "edited": false, "score": 0, "creation_date": 1563405206, "post_id": 57084771, "comment_id": 100693227, "body": "BigBen, Tim Williams, thanks for the feedback. I edited my question to include the code that I tried."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563423050, "post_id": 57084771, "comment_id": 100696525, "body": "<code>oDoc.Close SaveChanges:=False</code> don&#39;t you want to save the changes though?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11762063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/075fe4ae108b178c56d4dd693aa2b186?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi Tetali", "link": "https://stackoverflow.com/users/11762063/vamsi-tetali"}, "edited": false, "score": 0, "creation_date": 1563407285, "post_id": 57085228, "comment_id": 100693649, "body": "Aiyuni, thanks for your answer. I tried it but I again don&#39;t see any output or error message."}, {"owner": {"reputation": 766, "user_id": 9217609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa066678695c56e5bd95bc07dd9954f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aiyuni", "link": "https://stackoverflow.com/users/9217609/aiyuni"}, "reply_to_user": {"reputation": 3, "user_id": 11762063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/075fe4ae108b178c56d4dd693aa2b186?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi Tetali", "link": "https://stackoverflow.com/users/11762063/vamsi-tetali"}, "edited": false, "score": 0, "creation_date": 1563407377, "post_id": 57085228, "comment_id": 100693665, "body": "In general, when dealing with code that gives no useful output or errors: Have you tried debugging through the code line by line and seeing what it is actually doing/changing, if anything?"}, {"owner": {"reputation": 3, "user_id": 11762063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/075fe4ae108b178c56d4dd693aa2b186?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi Tetali", "link": "https://stackoverflow.com/users/11762063/vamsi-tetali"}, "edited": false, "score": 0, "creation_date": 1563407864, "post_id": 57085228, "comment_id": 100693768, "body": "Aiyuni, I have tried and, to the best of my understanding, each line of the code makes sense. I might just be too green at this point to figure out where the code is failing. I&#39;ll keep trying. Thank you for your help"}, {"owner": {"reputation": 3, "user_id": 11762063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/075fe4ae108b178c56d4dd693aa2b186?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi Tetali", "link": "https://stackoverflow.com/users/11762063/vamsi-tetali"}, "edited": false, "score": 0, "creation_date": 1563464885, "post_id": 57085228, "comment_id": 100717941, "body": "Tim, I did change that to True and tried but still no luck. I isolated the code within the loop and checked it to see if I maybe screwed something up there but that worked fine on one document. The issue seems to be in the loop"}], "tags": [], "owner": {"reputation": 766, "user_id": 9217609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa066678695c56e5bd95bc07dd9954f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aiyuni", "link": "https://stackoverflow.com/users/9217609/aiyuni"}, "is_accepted": false, "score": 0, "last_activity_date": 1563406222, "creation_date": 1563406222, "answer_id": 57085228, "question_id": 57084771, "link": "https://stackoverflow.com/questions/57084771/how-can-i-batch-this-vba-code-on-a-folder-full-of-word-documents/57085228#57085228", "title": "How can I batch this VBA code on a folder full of word documents?", "body": "<p>Avoid using ActiveDocument when dealing with a bunch of files. Specify the document variable explicitly: </p>\n\n<pre><code> Do While vFile &lt;&gt; \"\"\n        Set oDoc = Documents.Open(fileName:=vDirectory &amp; vFile)\n\n        Set myRange = oDoc.Range(0, 0) \n\n        oDoc.TablesOfContents.Add _ \n         Range:=myRange, _ \n         UseFields:=False, _ \n         UseHeadingStyles:=True, _ \n         LowerHeadingLevel:=3, _ \n         UpperHeadingLevel:=1, _ \n         AddedStyles:=\"myStyle, yourStyle\"\n\n        oDoc.Close SaveChanges:=False\n        vFile = Dir\n    Loop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11762063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/075fe4ae108b178c56d4dd693aa2b186?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi Tetali", "link": "https://stackoverflow.com/users/11762063/vamsi-tetali"}, "is_accepted": false, "score": 0, "last_activity_date": 1563466156, "creation_date": 1563466156, "answer_id": 57098703, "question_id": 57084771, "link": "https://stackoverflow.com/questions/57084771/how-can-i-batch-this-vba-code-on-a-folder-full-of-word-documents/57098703#57098703", "title": "How can I batch this VBA code on a folder full of word documents?", "body": "<p>I modified this to use the following code and it worked perfectly:</p>\n\n<pre><code>Sub InsertTOC()\n    Dim strPath As String\n    Dim strFile As String\n    Dim doc As Document\n    With Application.FileDialog(4) ' msoFileDialogFolderPicker\n        If .Show Then\n            strPath = .SelectedItems(1)\n        Else\n            MsgBox \"No folder specified!\", vbExclamation\n            Exit Sub\n        End If\n    End With\n    If Right(strPath, 1) &lt;&gt; \"\\\" Then\n        strPath = strPath &amp; \"\\\"\n    End If\n    Application.ScreenUpdating = False\n    On Error GoTo ErrHandler\n    strFile = Dir(strPath &amp; \"*.docx\")\n    Do While strFile &lt;&gt; \"\"\n        Set doc = Documents.Open(strPath &amp; strFile)\n        Set myRange = doc.Range(0, 0) \n    doc.TablesOfContents.Add _ \n     Range:=myRange, _ \n     UseFields:=False, _ \n     UseHeadingStyles:=True, _ \n     LowerHeadingLevel:=3, _ \n     UpperHeadingLevel:=1, _ \n     AddedStyles:=\"myStyle, yourStyle\"\n        doc.Close SaveChanges:=True\n        strFile = Dir\n    Loop\nExitHandler:\n    Application.ScreenUpdating = True\n    Exit Sub\nErrHandler:\n    MsgBox Err.Description, vbExclamation\n    Resume ExitHandler\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11762063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/075fe4ae108b178c56d4dd693aa2b186?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi Tetali", "link": "https://stackoverflow.com/users/11762063/vamsi-tetali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563466156, "creation_date": 1563402500, "last_edit_date": 1563405470, "question_id": 57084771, "link": "https://stackoverflow.com/questions/57084771/how-can-i-batch-this-vba-code-on-a-folder-full-of-word-documents", "title": "How can I batch this VBA code on a folder full of word documents?", "body": "<p>I have a piece of code to add a table of contents in a word file that worked well when used on one file. How can I extend this to a folder full of word documents. The word documents are already all in one folder.</p>\n\n<p>I have tried to adapt the code from the answers to this stackoverflow question but it did not do anything - no error message but also no output at all (<a href=\"https://stackoverflow.com/questions/11526577/loop-through-all-word-files-in-directory\">Loop through all Word Files in Directory</a>). Here is what I tried:</p>\n\n<pre><code>    Dim vDirectory As String\n    Dim oDoc As Document\n\n    vDirectory = \"C:\\programs2\\test\\\"\n\n    vFile = Dir(vDirectory &amp; \"*.*\")\n\n    Do While vFile &lt;&gt; \"\"\n        Set oDoc = Documents.Open(fileName:=vDirectory &amp; vFile)\n\n        Set myRange = ActiveDocument.Range(0, 0) \n        ActiveDocument.TablesOfContents.Add _ \n         Range:=myRange, _ \n         UseFields:=False, _ \n         UseHeadingStyles:=True, _ \n         LowerHeadingLevel:=3, _ \n         UpperHeadingLevel:=1, _ \n         AddedStyles:=\"myStyle, yourStyle\"\n\n        oDoc.Close SaveChanges:=False\n        vFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Here is the code that worked on a single document:</p>\n\n<pre><code>Set myRange = ActiveDocument.Range(0, 0) \nActiveDocument.TablesOfContents.Add _ \n Range:=myRange, _ \n UseFields:=False, _ \n UseHeadingStyles:=True, _ \n LowerHeadingLevel:=3, _ \n UpperHeadingLevel:=1, _ \n AddedStyles:=\"myStyle, yourStyle\"\n</code></pre>\n\n<p>The expected output is that every word file in the relevant folder has a table of contents automatically added at the beginning</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1563402332, "post_id": 57084703, "comment_id": 100692536, "body": "you need to put the <code>wks</code> in front of the <code>Range</code>s and the <code>shapes</code>"}, {"owner": {"reputation": 3, "user_id": 10082169, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WUIYQIGYf-Q/AAAAAAAAAAI/AAAAAAAAEHs/TrkeJqBjQEg/photo.jpg?sz=128", "display_name": "Allegra", "link": "https://stackoverflow.com/users/10082169/allegra"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1563402602, "post_id": 57084703, "comment_id": 100692603, "body": "Hi Scott, thank you for correcting my post first of all. I followed your advice however no luck, the code is still delaying the appearance of the shapes."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1563403301, "post_id": 57084703, "comment_id": 100692786, "body": "add <code>wks.Calculate</code> before your last loop"}, {"owner": {"reputation": 3, "user_id": 10082169, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WUIYQIGYf-Q/AAAAAAAAAAI/AAAAAAAAEHs/TrkeJqBjQEg/photo.jpg?sz=128", "display_name": "Allegra", "link": "https://stackoverflow.com/users/10082169/allegra"}, "edited": false, "score": 0, "creation_date": 1563404034, "post_id": 57084703, "comment_id": 100692954, "body": "Perfect! it works! much appreciated, thank you."}], "owner": {"reputation": 3, "user_id": 10082169, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WUIYQIGYf-Q/AAAAAAAAAAI/AAAAAAAAEHs/TrkeJqBjQEg/photo.jpg?sz=128", "display_name": "Allegra", "link": "https://stackoverflow.com/users/10082169/allegra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563402167, "creation_date": 1563401986, "last_edit_date": 1563402167, "question_id": 57084703, "link": "https://stackoverflow.com/questions/57084703/hangman-game-runs-okay-in-stepping-mode-but-delays-making-shapes-visible-in-norm", "title": "Hangman game runs okay in stepping mode but delays making shapes visible in normal mode", "body": "<p>I am trying to set up this hangman game however, so far it only works in stepping mode.</p>\n\n<p>What happens after pressing play is that if I choose a wrong letter, it does not show \"hangman\" shape until I make a correct guess.</p>\n\n<p>So, for example, if I make 2 incorrect guesses (so there should be 2 shapes showing before repeating the loop), nothing happens until my 3rd guess is correct, then it shows both shapes at once.</p>\n\n<p>The code works fine in stepping mode, if i go through the code with F8, there are no issues, shapes show up in order. Not really sure what could be the issue here.</p>\n\n<pre><code>Option Explicit\n\nDim wks As Worksheet\nDim word As Range\nDim rect As Shape\n\nSub Hangman()\n\n\nDim fletter As Variant\nDim myLetter As String\nDim i As Byte\n\nSet wks = ThisWorkbook.ActiveSheet\nSet word = wks.Range(\"B1:J1\")\n\ni = 1\n\nDo Until wks.Range(\"b1:j1\").Font.Color = VBA.ColorConstants.vbBlack Or i = 9\n\nmyLetter = VBA.InputBox(\"What is the next letter\")\n\nSet word = Range(\"B1:J1\").Find(myLetter)\n\n\n\n\n        If Not word Is Nothing Then\n\n        word.Font.Color = VBA.ColorConstants.vbBlack\n        fletter = word.Address\n\n            Do\n\n            Set word = Range(\"B1:J1\").FindNext(word)\n            word.Font.Color = VBA.ColorConstants.vbBlack\n\n            If word.Address = fletter Then Exit Do\n\n\n            Loop\n\n        Else\n\n\n        Set rect = ThisWorkbook.ActiveSheet.shapes(\"Shape\" &amp; i)\n\n        rect.Visible = msoTrue\n\n\n        i = i + 1\n\n        End If\n\n\n   Loop\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563400091, "post_id": 57084355, "comment_id": 100692039, "body": "Is the error on the <code>Run</code> line?"}, {"owner": {"reputation": 23, "user_id": 11058977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b43ad006d53ce0e196936d689572d9f3?s=128&d=identicon&r=PG&f=1", "display_name": "MagicWagon", "link": "https://stackoverflow.com/users/11058977/magicwagon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563400434, "post_id": 57084355, "comment_id": 100692117, "body": "Yes. I forgot to mention that."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1563401505, "post_id": 57084355, "comment_id": 100692366, "body": "Your new antivirus is using its euristics?"}, {"owner": {"reputation": 23, "user_id": 11058977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b43ad006d53ce0e196936d689572d9f3?s=128&d=identicon&r=PG&f=1", "display_name": "MagicWagon", "link": "https://stackoverflow.com/users/11058977/magicwagon"}, "edited": false, "score": 0, "creation_date": 1563464896, "post_id": 57084355, "comment_id": 100717946, "body": "Fairly certain it&#39;s not the antivirus."}, {"owner": {"reputation": 23, "user_id": 11058977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b43ad006d53ce0e196936d689572d9f3?s=128&d=identicon&r=PG&f=1", "display_name": "MagicWagon", "link": "https://stackoverflow.com/users/11058977/magicwagon"}, "edited": false, "score": 0, "creation_date": 1563469430, "post_id": 57084355, "comment_id": 100720176, "body": "The code below works too, so it seems like it&#39;s just a .bat issue. wsh.Run Chr(34) &amp; C:\\Program Files (x86)\\Notepad++\\notepad++.exe &amp; Chr(34)"}], "owner": {"reputation": 23, "user_id": 11058977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b43ad006d53ce0e196936d689572d9f3?s=128&d=identicon&r=PG&f=1", "display_name": "MagicWagon", "link": "https://stackoverflow.com/users/11058977/magicwagon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 710, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563400096, "creation_date": 1563399470, "last_edit_date": 1563400096, "question_id": 57084355, "link": "https://stackoverflow.com/questions/57084355/permission-denied-for-vba-shell-call-on-windows-10", "title": "Permission Denied for VBA Shell Call on Windows 10", "body": "<p>We recently upgraded to Windows 10. This VBA code was working in Windows 7 to run a batch script, but now it throws \"Run-time error '70': Permission denied.</p>\n\n<p>I've tried several variations of the script, but continue to run into issues. I have Administrator rights on my computer as well. This is on a network drive, but it hasn't been an issue before. Using a cmd prompt, I am able to call this batch file successfully. Any ideas or help you provide would be appreciated.</p>\n\n<pre><code>Sub DailyBatchProcess()\nDim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowStyle As Integer: windowStyle = 1\nwsh.Run Chr(34) &amp; \"S:\\Data\\Daily Items\\1 Daily Batch\\BAT\\Transaction Adjustments.bat\" &amp; Chr(34), windowStyle, waitOnReturn\nSet wsh = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "networking", "network-programming", "network-connection"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1563398262, "post_id": 57084028, "comment_id": 100691451, "body": "It depends. If your Excel file runs on the server (and has good rights), via VBA you can launch a command line to query the logged users (depending on the OS of the server, for example it would be Bash if your server is Linux). That should be pretty easy. However, if your Excel file runs on an other computer, then either Cisco NetAccess provides an API to retrieve the connected users (which I would doubt, this would be an admin API of course, but I wouldn&#39;t distribute such a functionality externally), or I don&#39;t think it would be possible."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1563398543, "post_id": 57084028, "comment_id": 100691537, "body": "If your Excel file runs on another computer, alternatively to the API and admitting you know the server credentials, you may still use an utility such as plink (this is again for Linux, but there are others for other OS) to login and run a remote command to retrieve the users. But be aware that security-wise, hardcoding admin server credentials in an Excel macro is terrible."}, {"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1563398979, "post_id": 57084028, "comment_id": 100691691, "body": "Assuming a log is written (and it probably is/ can), I think I would prefer to query the log file from VBA.  Simpler, safer."}], "owner": {"reputation": 3, "user_id": 10220361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf08bc573ae749c040140fcc838c6737?s=128&d=identicon&r=PG&f=1", "display_name": "Rob F.", "link": "https://stackoverflow.com/users/10220361/rob-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563397364, "creation_date": 1563397364, "question_id": 57084028, "link": "https://stackoverflow.com/questions/57084028/how-to-check-if-a-user-is-logged-into-cisco-netaccess-in-vba-excel", "title": "How to check if a user is logged into Cisco NetAccess in VBA (Excel)?", "body": "<p>We use Cisco NetAccess to authenticate users who access various databases. The URL format is <a href=\"https://server:port/netaccess/loginuser.html\" rel=\"nofollow noreferrer\">https://server:port/netaccess/loginuser.html</a>. After logging in via a browser, it displays:</p>\n\n<pre><code>You are logged in.\nUsername: username\nUser IP: x.x.x.x\nSince: hh:mm:ss xST ddd mmm d yyyy\n</code></pre>\n\n<p>The authentication has a duration of about 8 hours. This must be completed before signing into the front end app or querying the back end DB via Excel, Access, DbVis, etc.</p>\n\n<p>We're building a dashboard in Excel that will query such a database. I'd like to write a VBA script that will check if the current user is logged into this authentication before attempting to query the DB. Is there a way to ping/query the server to see if the username and user IP are logged in?</p>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-access-forms"], "comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1563399215, "post_id": 57083865, "comment_id": 100691776, "body": "Which line is highlighted when the error occurs?"}, {"owner": {"reputation": 1, "user_id": 6035259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b342a32fc5cd11a954b0f0a16d759f4?s=128&d=identicon&r=PG&f=1", "display_name": "SKay", "link": "https://stackoverflow.com/users/6035259/skay"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1563399800, "post_id": 57083865, "comment_id": 100691946, "body": "Lee Mac, The highlighted line is : Select Case Me.OptionViewDelete"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1563400046, "post_id": 57083865, "comment_id": 100692029, "body": "Have you used the name <code>OptionViewDelete</code> elsewhere in your project for a different object/function/module?"}, {"owner": {"reputation": 1, "user_id": 6035259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b342a32fc5cd11a954b0f0a16d759f4?s=128&d=identicon&r=PG&f=1", "display_name": "SKay", "link": "https://stackoverflow.com/users/6035259/skay"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1563400227, "post_id": 57083865, "comment_id": 100692067, "body": "No, I created OptionViewDelete only for this sub"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1563400580, "post_id": 57083865, "comment_id": 100692164, "body": "So what is <code>Me.OptionViewDelete</code>?  Is it an option frame/group control?"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1563408705, "post_id": 57083865, "comment_id": 100693920, "body": "Should be <b>Case 1</b>, not <b>Case Is = 1</b>"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "reply_to_user": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1563419537, "post_id": 57083865, "comment_id": 100695846, "body": "@Rene  See <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/select-case-statement\" rel=\"nofollow noreferrer\">online docs for Select Case</a>.  The <code>Is</code> keyword is optional, but it is valid syntax.  There is no difference between the two expressions."}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1563425746, "post_id": 57083865, "comment_id": 100697122, "body": "@ C Perkins, I stand corrected."}, {"owner": {"reputation": 1, "user_id": 6035259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b342a32fc5cd11a954b0f0a16d759f4?s=128&d=identicon&r=PG&f=1", "display_name": "SKay", "link": "https://stackoverflow.com/users/6035259/skay"}, "edited": false, "score": 0, "creation_date": 1563474395, "post_id": 57083865, "comment_id": 100722316, "body": "I apologize, I made a mistake in my question. The frame name is ViewDelete. The labelname is &#39;OptionViewDelete&#39;. My bad! :(  Thanks a lot to LeeMac, Perkins and Rene for trying to help. Really appreciate it!. Its all working good now."}], "owner": {"reputation": 1, "user_id": 6035259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b342a32fc5cd11a954b0f0a16d759f4?s=128&d=identicon&r=PG&f=1", "display_name": "SKay", "link": "https://stackoverflow.com/users/6035259/skay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594636006, "creation_date": 1563396483, "last_edit_date": 1594636006, "question_id": 57083865, "link": "https://stackoverflow.com/questions/57083865/how-to-fix-object-doesnt-support-this-property-or-method-error-when-using-opt", "title": "How to fix &#39;Object doesn&#39;t support this property or method&#39; error when using option group in MS Access?", "body": "<p>I have a form in MS Access with two options and one command button. When option <code>1</code> is selected and the command button clicked, a Select query must run, and when option <code>2</code> is selected and the command button clicked, a Delete query must run. </p>\n\n<p>Below is my code; I am getting the error:</p>\n\n<blockquote>\n  <p>Run-time error '438' Object doesn't support this property or method. </p>\n</blockquote>\n\n<p>Any help greatly appreciated.</p>\n\n<pre><code>Private Sub CmdViewDeleteRecords_Click()\n    Select Case Me.OptionViewDelete\n        Case Is = 1\n            DoCmd.OpenQuery \"qrySelectRecords\", acViewNormal, acEdit\n        Case Is = 2\n            DoCmd.OpenQuery \"qryDeleteRecords\"\n    End Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 62, "user_id": 11673304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368dcb9a50d5cfc7e27d6fc730d77684?s=128&d=identicon&r=PG&f=1", "display_name": "tmsdajpa", "link": "https://stackoverflow.com/users/11673304/tmsdajpa"}, "edited": false, "score": 0, "creation_date": 1563396828, "post_id": 57083855, "comment_id": 100690930, "body": "Edit. I misunderstood. You don&#39;t need a table for this. You can just do a query. But, I can still help you with the table. What are the fields for table 1?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1563474884, "post_id": 57083855, "comment_id": 100722563, "body": "Don&#39;t need second table, build an aggregate query or a report."}, {"owner": {"reputation": 1, "user_id": 11799686, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dtyqsM2wa6o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdsketF3VaIcUQN1t9ROJryMa1V2A/photo.jpg?sz=128", "display_name": "Sebastian Gulczinski", "link": "https://stackoverflow.com/users/11799686/sebastian-gulczinski"}, "edited": false, "score": 0, "creation_date": 1563891815, "post_id": 57083855, "comment_id": 100846359, "body": "For Table 1 I have Partner Name, Close date, The amount the Partner gets paid, and what kind of deal it is (On Premise or Cloud). The reason I thought a second table would be better is because each partner has a different quota to reach. If this can still be done with a query please let me know! Thanks!"}], "owner": {"reputation": 1, "user_id": 11799686, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dtyqsM2wa6o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdsketF3VaIcUQN1t9ROJryMa1V2A/photo.jpg?sz=128", "display_name": "Sebastian Gulczinski", "link": "https://stackoverflow.com/users/11799686/sebastian-gulczinski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594636015, "creation_date": 1563396421, "last_edit_date": 1594636015, "question_id": 57083855, "link": "https://stackoverflow.com/questions/57083855/creating-an-order-log-that-tracks-attainment-to-quota", "title": "Creating an Order Log That Tracks attainment to quota", "body": "<p>I have 2 tables in Access. One table is where Manual Data entry occurs that inputs a Partner name and How much the deal was made for. The Second table I want to track the sum of all the deals each partner has made up to that point. This would be to track their quota attainment. Any ideas on how this can be done?</p>\n"}, {"tags": ["excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563395331, "post_id": 57083580, "comment_id": 100690358, "body": "What does your sheet look like? Where does the data start/end?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1563395331, "post_id": 57083580, "comment_id": 100690359, "body": "What line gives you the error?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1563395914, "post_id": 57083580, "comment_id": 100690601, "body": "<code>Columns(&quot;I:J&quot;).AutoFilter Field 2</code>?  I believe this is similar to vlookup where it counts the fields (columns) in your range.  you could also specify the column to be filtered, rather than just &quot;10&quot;, e.g. <code>Columns(10)</code>"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 1, "creation_date": 1563395925, "post_id": 57083580, "comment_id": 100690605, "body": "The error occurs because you&#39;re trying to filter something that isn&#39;t in that range. Field = 10 means give me the 10th column of my selected range <code>&quot;J:J&quot;</code> in this case, which only has <b>one column <code>J</code></b>. Either expand the range of the your <code>Columns</code> declaration or set Field = 1 if you just want to filter on the values in Column J, right now it&#39;s more like attempting to filter on values in column S"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1563398071, "post_id": 57083580, "comment_id": 100691377, "body": "@Mike Post this as the answer and I&#39;ll upvote"}], "owner": {"reputation": 5, "user_id": 6854714, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kS1X4apbWXY/AAAAAAAAAAI/AAAAAAAAABI/lWeCZRvDsgY/photo.jpg?sz=128", "display_name": "william vinemorris", "link": "https://stackoverflow.com/users/6854714/william-vinemorris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563395467, "creation_date": 1563394885, "last_edit_date": 1563395467, "question_id": 57083580, "link": "https://stackoverflow.com/questions/57083580/how-to-fix-range-of-object-failed-while-using-autofilter", "title": "How to fix Range of object failed while using autofilter", "body": "<p>Autofilter in vba gives me method of range error</p>\n\n<p>I've tried changing ranges and variables.</p>\n\n<pre><code>Private Sub Names_Afterupdate()\nDim ws As Worksheet\nDim strname As String\nSet ws = Worksheets(\"LookupLists\")\nstrname = Me.Names.Value\n\nColumns(\"J:J\").AutoFilter _\nField:=10, _\nCriteria1:=\"=*\" &amp; strname &amp; \"*\", _\nOperator:=xlAnd\n\nEnd Sub\n</code></pre>\n\n<p>I'm only trying to filter columns I:J which are a table and the .autofilter part gives me the error</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1563394885, "post_id": 57083530, "comment_id": 100690171, "body": "I feel like what I&#39;m thinking would be related to a type-mismatch, not set to nothing error... but try definding your destination with offset and resize, or use <code>Range(Cells(activecell.row,12),Cells(activecell.row,12+222))</code> as the full destination range... and make sure they&#39;re on the same line... e.g. <code>Rng2.Find(What:=ActiveCell).Offset(, 4).Resize(, 222).Copy Range(Cells(activecell.row,12),Cells(activecell.row,12+222))</code>  ... I used col 12 as you said H + 4"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563395127, "post_id": 57083530, "comment_id": 100690276, "body": "You&#39;re assuming that the <code>Find</code> is successful. It might not be. <code>Dim myRng as Range</code>, then <code>Set myRng = Rng2.Find(What:=ActiveCell.Value)</code>. Then test <code>If Not MyRng Is Nothing</code> before attempting to <code>Offset</code> and <code>Resize</code>."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1563395237, "post_id": 57083530, "comment_id": 100690322, "body": "Find has many other parameters which you need to provide.  And you need to account for the possibility Find returns Nothing.  If the post is an exact copy of your code, Destination needs to be on the same line as Copy (or add a _)"}], "answers": [{"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 0, "last_activity_date": 1563395507, "creation_date": 1563395507, "answer_id": 57083694, "question_id": 57083530, "link": "https://stackoverflow.com/questions/57083530/error-91-when-using-find-function-using-activecell/57083694#57083694", "title": "Error 91 when using Find Function, Using ActiveCell?", "body": "<p>Error 91 means your <code>Find</code> didn't find anything. Change your code to this</p>\n\n<pre><code>Set rFound = Rng2.Find(What:=ActiveCell)\n\nDebug.Assert Not rFound Is Nothing\n\nrFound.Offset(, 4).Resize(, 222).Copy _\nDestination:=ActiveCell.Offset(, 1)\n</code></pre>\n\n<p>and you'll see that <code>rFound</code> is <code>Nothing</code>. The error is that you're trying use the <code>Offset</code> property on a range that doesn't exist. You'll have to figure out why it's not finding it, but here are a few things to try:</p>\n\n<p>First, when you use <code>Find</code> in code, include as many parameters as you can. If you change a parameter in the UI Find Dialog, it persists. So you may be searching for Entire Cell Contents when you don't want to. Or you maybe looking in Formulas when you want Values.</p>\n\n<p>Make sure there are not trailing spaces or other nonprintable characters that are preventing a match.</p>\n\n<p>Make sure that numbers are numbers and text is text and that you don't have a mix where you have text that merely looks like it's a number. </p>\n"}], "owner": {"reputation": 13, "user_id": 11710852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cbfc2524e9000be8df43e56c53d2f6b?s=128&d=identicon&r=PG&f=1", "display_name": "TaylorFlavor69", "link": "https://stackoverflow.com/users/11710852/taylorflavor69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 57083694, "answer_count": 1, "score": 1, "last_activity_date": 1563396808, "creation_date": 1563394667, "last_edit_date": 1563396808, "question_id": 57083530, "link": "https://stackoverflow.com/questions/57083530/error-91-when-using-find-function-using-activecell", "title": "Error 91 when using Find Function, Using ActiveCell?", "body": "<p>I'm getting the run time 91 error when I step through my code.<br>\nThe point of the code is to use the ActiveCell(Which will be in Column H) to match a value in Column D, then look 4 cells to the right and copy the next 222 cells in the row. The destination is one cell to the right of the ActiveCell. I'd then like to clear the cell.</p>\n\n<pre><code>Sub MirrorUsers()\nDim WS1 As Worksheet\nDim Rng1 As Range\nDim Rng2 As Range\n\nApplication.ScreenUpdating = False\n\nSet WS1 = ActiveSheet\nSet Rng1 = WS1.Range(WS1.Range(\"H2\"), WS1.Range(\"H\" &amp; Rows.Count).End(xlUp))\nSet Rng2 = WS1.Range(WS1.Range(\"D2\"), WS1.Range(\"D\" &amp; Rows.Count).End(xlUp))\n\nRng2.Find(What:=ActiveCell).Offset(, 4).Resize(, 222).Copy \nDestination:=ActiveCell.Offset(, 1)\n\nRng1.Clear\n\nEnd Sub\n</code></pre>\n\n<p>I expect values to mirror another rows values in specific cells. I am receiving a run time error 91 currently.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1563394527, "post_id": 57083447, "comment_id": 100690008, "body": "You want to put the formula using <code>FormulaArray</code> into the first cell <code>R2</code> then fill down.  What you are doing is akin to highlighting all the cells, putting the formula in the formula bar and hitting Ctrl-Shift-Enter.  It will fill the same formula into all the rows.  You want to enter the formula into the first cell as an array formula then fill down."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "edited": false, "score": 0, "creation_date": 1563403229, "post_id": 57083738, "comment_id": 100692770, "body": "I didn&#39;t know about the limit. However that solution didn&#39;t work. It just doesn&#39;t replace anything and leaves the range with the &quot;=SUM(PPP)&quot; formula in there. Any other suggestion to work around this?"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "reply_to_user": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "edited": false, "score": 0, "creation_date": 1563403350, "post_id": 57083738, "comment_id": 100692801, "body": "@CarlosCasio, it works for me. I have tried it several times. You have to leave the VBA window and click inside on the sheet and the cells would update."}, {"owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "edited": false, "score": 1, "creation_date": 1563404169, "post_id": 57083738, "comment_id": 100692993, "body": "Oh my... that&#39;s true. Why is it necessary to leave the VBA window?. It worked tho, thank you for the solution!"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "reply_to_user": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "edited": false, "score": 0, "creation_date": 1563404573, "post_id": 57083738, "comment_id": 100693095, "body": "@CarlosCasio, I am not really sure; I think it has to do with the fact that you are doing an in-place replace. I just make sure the range isn&#39;t selected beforehand, run my macro and then come back to see the results. That way it doesn&#39;t bother you."}], "tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 0, "last_activity_date": 1563396384, "last_edit_date": 1563396384, "creation_date": 1563395763, "answer_id": 57083738, "question_id": 57083447, "link": "https://stackoverflow.com/questions/57083447/formulaarray-commando-is-not-working-on-vba-execution-code/57083738#57083738", "title": "FormulaArray commando is not working on VBA Execution Code", "body": "<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.formulaarray\" rel=\"nofollow noreferrer\"><code>Range.FormulaArray</code></a> property has a character limit of 255. Your string is 362 characters long, hence the error. To work around the character limit, you have to use placeholders that you will later fill with the correct string, like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim pp As String, Final As Long, last As Long\n\npp = \"--(FREQUENCY(IF(('BD MXN'!$J$2:$J$\" \n&amp; Final &amp; \"=\"\"A\"\")*('BD MXN'!$X$2:$X$\" &amp; Final &amp; \"='Acum MXN'!Q2)*('BD \nMXN'!$Q$2:$Q$\" &amp; Final &amp; \"='Acum MXN'!O2)*('BD MXN'!$I$2:$I$\" &amp; Final &amp; \n\"=\"\"REAL\"\")*('BD MXN'!$W$2:$W$\" &amp; Final &amp; \"='Acum MXN'!P2)*('BD MXN'!$O$2:$O$\" &amp; \nFinal &amp; \"='Acum MXN'!A2),'BD MXN'!$A$2:$A$\" &amp; Final &amp; \"),'BD MXN'!$A$2:$A$\" &amp; \nFinal &amp; \")&gt;0)\"\n\nWith Range(\"R2:R\" &amp; last)\n    .FormulaArray = \"=SUM(PPP)\"\n    .Replace \"PPP\", pp\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 57083738, "answer_count": 1, "score": 1, "last_activity_date": 1563396384, "creation_date": 1563394323, "last_edit_date": 1563396066, "question_id": 57083447, "link": "https://stackoverflow.com/questions/57083447/formulaarray-commando-is-not-working-on-vba-execution-code", "title": "FormulaArray commando is not working on VBA Execution Code", "body": "<p>Basically I set up a formula en Excel which then I copied into VBA, however this is an array formula:</p>\n\n<pre><code>{=SUM(--(FREQUENCY(IF(('BD MXN'!$J$2:$J$5893=\"A\")*('BD MXN'!$X$2:$X$5893='Acum MXN'!Q2)*('BD MXN'!$Q$2:$Q$5893='Acum MXN'!O2)*('BD MXN'!$I$2:$I$5893=\"REAL\")*('BD MXN'!$W$2:$W$5893='Acum MXN'!P2)*('BD MXN'!$O$2:$O$5893='Acum MXN'!A2),'BD MXN'!$A$2:$A$5893),'BD MXN'!$A$2:$A$5893)&gt;0))}_\n</code></pre>\n\n<p>What it does is to count unique values from another sheet considering various criteria. The formula works great if I do it on my own, however once I add it to the code it doesn't work. My code is the following:</p>\n\n<pre><code>Range(\"R2:R\" &amp; last).FormulaArray = \"=SUM(--(FREQUENCY(IF(('BD MXN'!$J$2:$J$\" \n&amp; Final &amp; \"=\"\"A\"\")*('BD MXN'!$X$2:$X$\" &amp; Final &amp; \"='Acum MXN'!Q2)*('BD \nMXN'!$Q$2:$Q$\" &amp; Final &amp; \"='Acum MXN'!O2)*('BD MXN'!$I$2:$I$\" &amp; Final &amp; \n\"=\"\"REAL\"\")*('BD MXN'!$W$2:$W$\" &amp; Final &amp; \"='Acum MXN'!P2)*('BD MXN'!$O$2:$O$\" &amp; \nFinal &amp; \"='Acum MXN'!A2),'BD MXN'!$A$2:$A$\" &amp; Final &amp; \"),'BD MXN'!$A$2:$A$\" &amp; \nFinal &amp; \")&gt;0))\"\n</code></pre>\n\n<p>The <code>Final</code> variable is just a last row value. I know the formula works because if I do the same code but with \"Formula\" instead of \"FormulaArray\", it will throw a #VALUE error on Excel, then I go back to the cell and press CTRL + SHIFT + ENTER and it works, I do nothing to the formula.</p>\n\n<p>If I leave the FormulaArray option, it doesn't even write anything, it's like skipping that line.</p>\n"}, {"tags": ["excel", "vba", "sap"], "answers": [{"tags": [], "owner": {"reputation": 1147, "user_id": 6658422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4d9d661e1ad2554b1f3146049458757?s=128&d=identicon&r=PG&f=1", "display_name": "divingTobi", "link": "https://stackoverflow.com/users/6658422/divingtobi"}, "is_accepted": true, "score": 0, "last_activity_date": 1574866474, "creation_date": 1574866474, "answer_id": 59072904, "question_id": 57083339, "link": "https://stackoverflow.com/questions/57083339/is-there-a-way-to-suppress-a-prompt-asking-for-query-parameters-when-updating-a/59072904#59072904", "title": "Is there a way to suppress a prompt asking for query parameters when updating a data source (SAP) from an excel macro?", "body": "<p>I believe you should pre-populate some of the fields and save the file. Some of the fields are mandatory, and maybe you have not filled them all out in the file you are loading and refreshing.</p>\n\n<p>I am using <code>Call Application.Run(\"SAPExecuteCommand\", \"RefreshData\")</code> similarly, and I do not get a dialog box.</p>\n\n<p>You could also try to set variables and then execute a refresh from within VBA using</p>\n\n<pre><code>Call Application.Run(\"SAPSetVariable\", \"my_variable\", value, \"INPUT_STRING\", \"DS_1\") \nCall Application.Run(\"SAPExecuteCommand\", \"RefreshData\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11792169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d4243ce6e17061b08a675e4815b87e6?s=128&d=identicon&r=PG&f=1", "display_name": "soft_weaver", "link": "https://stackoverflow.com/users/11792169/soft-weaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 59072904, "answer_count": 1, "score": 0, "last_activity_date": 1574866474, "creation_date": 1563393751, "last_edit_date": 1563431708, "question_id": 57083339, "link": "https://stackoverflow.com/questions/57083339/is-there-a-way-to-suppress-a-prompt-asking-for-query-parameters-when-updating-a", "title": "Is there a way to suppress a prompt asking for query parameters when updating a data source (SAP) from an excel macro?", "body": "<p>I am updating a data source from an excel macro by running </p>\n\n<pre><code>Application.Run(\"SAPExecuteCommand\", \"RefreshData\", \"DS_1\")\n\n</code></pre>\n\n<p>, which generates a prompt asking for the user to input query parameters. However, I just want to go with the already set parameters. Is there a way to suppress the prompt altogether or perhaps effectively just click OK when prompted? (perhaps finding the element that is the OK button and clicking it from the same macro, without resorting to absolute coordinates?)</p>\n\n<p><a href=\"https://i.stack.imgur.com/U58MA.png\" rel=\"nofollow noreferrer\">The prompt that I want to suppress or obviate</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 3, "creation_date": 1563393511, "post_id": 57083283, "comment_id": 100689568, "body": "Is there a reason you are not using conditional formatting?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1563394479, "post_id": 57083283, "comment_id": 100689985, "body": "When the error shows, what do you see in the immediate window if you type <code>? Target.address</code>?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1563394485, "post_id": 57083283, "comment_id": 100689988, "body": "@cybernetic.nomad has the efficient fix...  Specific to your post, i&#39;m not getting an issue.  I have copied and pasted your macro in my <code>ThisWorkbook</code> and it works just fine, provided I am on sheets(3) and any cell i have entered (f2 to edit) and left blank turns yellow and if I add a value it turns green.  My only color-related issue is if I copy/paste cells in sheets(3) and the paste is GREEN, despite copying blank cells."}, {"owner": {"reputation": 29, "user_id": 11770341, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oTrLd_v9_00/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reeWNLfrZg--fDF39ll1PIXGAY9_w/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11770341/andrew"}, "edited": false, "score": 0, "creation_date": 1563394776, "post_id": 57083283, "comment_id": 100690129, "body": "I&#39;ve never used conditional formatting before. I&#39;m not looking for any specific values, I just want it to change color if ANY data (numerical or otherwise) is put into the cell. Could anyone help me with the formatting to accomplish this?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1563394962, "post_id": 57083283, "comment_id": 100690200, "body": "Use conditional formatting with the following formula: <code>=LEN(A1)&gt;0</code> See <a href=\"https://imgur.com/a/WxOn2Lf\" rel=\"nofollow noreferrer\">this sample</a>"}, {"owner": {"reputation": 29, "user_id": 11770341, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oTrLd_v9_00/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reeWNLfrZg--fDF39ll1PIXGAY9_w/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11770341/andrew"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1563396395, "post_id": 57083283, "comment_id": 100690791, "body": "Okay I figured it out. Thank you for the help! @cybernetic.nomad &amp; Cyril"}], "answers": [{"tags": [], "owner": {"reputation": 28, "user_id": 11776282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c12197d6746ca4b5e11b6eb2fea7bf41?s=128&d=identicon&r=PG&f=1", "display_name": "jorgitoxx21", "link": "https://stackoverflow.com/users/11776282/jorgitoxx21"}, "is_accepted": true, "score": 1, "last_activity_date": 1563458770, "creation_date": 1563458770, "answer_id": 57096452, "question_id": 57083283, "link": "https://stackoverflow.com/questions/57083283/cells-will-not-turn-green-when-altered/57096452#57096452", "title": "Cells will not turn green when altered", "body": "<p>A couple of days ago I faced the same problem. The thing is when the sheet is protected there is no way to alter the format of a certain cell. It does not matter if the cell is locked or unlocked. </p>\n\n<p>An easy way to change the color would be to use conditional formatting.\n1. select cell you want to format\n2. Set new rule so the cell when is empty it is filled yello and when it is filled with somehting it turns green.</p>\n\n<pre><code>=A1=\"\" then format yellow\n=A1&lt;&gt;\"\" then format green \n</code></pre>\n\n<p>The other thing you can try is to unlock and lock the worksheet when you want it to turn into new color. However I think this will only work if you are using a macro.</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal sh As Object, ByVal Target As Range)\n\nDim Destino As Workbook\n\nDestino.ActiveShee.Unprotect(\"password\")\n\nIf Target.Worksheet.Index = 3 Then\n    If Not IsEmpty(Target) Then\n    Target.Interior.ColorIndex = 4\n    Else: Target.Interior.ColorIndex = 6\n    End If\nEnd If\n\nDestino.ActiveShee.protect(\"password\")\n\nEnd Sub\n</code></pre>\n\n<p>Those are my answers for you</p>\n"}], "owner": {"reputation": 29, "user_id": 11770341, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oTrLd_v9_00/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reeWNLfrZg--fDF39ll1PIXGAY9_w/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11770341/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 57096452, "answer_count": 1, "score": 1, "last_activity_date": 1563458770, "creation_date": 1563393469, "question_id": 57083283, "link": "https://stackoverflow.com/questions/57083283/cells-will-not-turn-green-when-altered", "title": "Cells will not turn green when altered", "body": "<p>I have a worksheet set up that only has certain cells unlocked for editing on an otherwise locked sheet. All of these cells are originally colored yellow, and are empty. My goal is to get the cells to turn from their base color of yellow to green when any data is entered into them, and to stay green as long as it contains any type of data, but to turn back to yellow if data is removed. I have written code for this and I cannot see what the problem is, so I must be missing something, because the code does not do what I want it to, and only gets an error message instead. This code is located in my main workbook code.</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal sh As Object, ByVal Target As Range)\n    If Target.Worksheet.Index = 3 Then\n        If Not IsEmpty(Target) Then\n        Target.Interior.ColorIndex = 4\n        Else: Target.Interior.ColorIndex = 6\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>The error I get says \"Runtime error \"1004\": Application-defined or object-defined error, and occurs in line 5:\n    Else: Target.Interior.ColorIndex = 6.\nIf anyone can give me a hand with this I would appreciate it greatly!</p>\n"}, {"tags": ["vba", "forms", "ms-access", "modal-dialog"], "answers": [{"tags": [], "owner": {"reputation": 469, "user_id": 3862163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c044036e475ca103a3e5c233b1550ce?s=128&d=identicon&r=PG&f=1", "display_name": "DRC", "link": "https://stackoverflow.com/users/3862163/drc"}, "is_accepted": false, "score": 0, "last_activity_date": 1563393401, "creation_date": 1563393401, "answer_id": 57083268, "question_id": 57083267, "link": "https://stackoverflow.com/questions/57083267/how-to-prevent-button-clicks-in-a-ms-access-form-a-when-form-b-is-correctly-disp/57083268#57083268", "title": "How to prevent button clicks in a MS Access Form_A when Form_B is correctly displayed modal over Form_A", "body": "<p>As I was typing up the question, it occurred to me that the main problem was that the subs and functions I was calling during \"housekeeping\" used the <code>DoEvents</code> action to allow the Form_B \"Working\" dialog to update/animate.  However, <code>DoEvents</code> also allows mouse clicks to register.</p>\n\n<p>So, how to prevent the problem?</p>\n\n<p><strong>Include the \"housekeeping\" calls in the <em>Form_Open</em> event rather than the <em>Form_Load</em> event</strong> because the <em>Form_Open</em> event occurs first, before the <em>Form_Load</em> and before the form is displayed, so, there will not be any buttons visible to click if the \"housekeeping\" code is called in <em>Form_Open</em>.</p>\n\n<p>Hope this helps someone else who might have had a similar problem.</p>\n"}], "owner": {"reputation": 469, "user_id": 3862163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c044036e475ca103a3e5c233b1550ce?s=128&d=identicon&r=PG&f=1", "display_name": "DRC", "link": "https://stackoverflow.com/users/3862163/drc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594636030, "creation_date": 1563393401, "last_edit_date": 1594636030, "question_id": 57083267, "link": "https://stackoverflow.com/questions/57083267/how-to-prevent-button-clicks-in-a-ms-access-form-a-when-form-b-is-correctly-disp", "title": "How to prevent button clicks in a MS Access Form_A when Form_B is correctly displayed modal over Form_A", "body": "<p>I realized while I was typing up this question what the problem might be and was then able to solve it.  So, I have posted the question and then the answer in case it helps someone else.</p>\n\n<p>I am using MS Access 2016.  I have a Form_A that displays a menu of buttons--each button takes the user to a distinct form to perform whatever functions the user needs to perform.  For example, one Form_A menu button could be [Add Clients] while another button could be [Add Staff], etc.</p>\n\n<p>When the user first logs into the system, I use VBA code to do a number of \"housecleaning\" functions.  Form_A and the buttons are visible, but I have made a Form_B that is a small dialog that shows the word \"Working\" with animated \"...\" while the VBA in Form_A does the housecleaning.  </p>\n\n<p><strong>The problem that I cannot solve is that even though I have set Form_B's \"Pop Up\" property to \"Yes\" and its \"Modal\" property to \"Yes\", the user can still click buttons on the Form_A menu which then execute while Form_B is still doing its housecleaning.</strong></p>\n\n<p><strong>I thought setting Form_B to modal should prevent button clicks on Form_A from getting registered.</strong></p>\n\n<p>More details:</p>\n\n<ol>\n<li>In the <em>Form_Load</em> event, Form_A calls \"housekeeping\" code that resides in a Module.  That module has a Public Sub called \"RemakeTables.\"  The RemakeTables code uses <code>DoCmd.OpenForm \"Form_B\"</code> to display the \"Working\" dialog.</li>\n<li>The RemakeTables code calls several other Public subs.  Between each call to the other Public subs, a <code>DoEvents</code> is called which allows for the \"Working\" dialog to animate the \"...\" (i.e., cycle between \"Working\", \"Working.\", \"Working..\", and \"Working...\").</li>\n</ol>\n\n<p>My hunch is that the <code>DoEvents</code> is what is allowing clicks to get registered in Form_A.</p>\n\n<p>How should I be doing this so that clicks cannot be registered while the Form_B \"Working\" dialog is showing but can still be animated?</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563392337, "post_id": 57083001, "comment_id": 100689021, "body": "What line throws the error?"}, {"owner": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563392422, "post_id": 57083001, "comment_id": 100689063, "body": "<code>Sub FindSimilar()</code> and <code>words() = Split(term.Value)</code> - specifically at <code>Value</code>"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1563392444, "post_id": 57083001, "comment_id": 100689072, "body": "The function Split takes two parameters, but you&#39;re only passing one."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1563392466, "post_id": 57083001, "comment_id": 100689083, "body": "@MatteoNNZ the delimiter is optional."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563392520, "post_id": 57083001, "comment_id": 100689104, "body": "@BigBen I hadn&#39;t realized that :) good call."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563392545, "post_id": 57083001, "comment_id": 100689110, "body": "@BigBen yeah, just figured out. I wouldn&#39;t omit it though, default values are evil :)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1563392565, "post_id": 57083001, "comment_id": 100689118, "body": "@MatteoNNZ I agree with you :)"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563392726, "post_id": 57083001, "comment_id": 100689187, "body": "I think @BigBen is right, this must be a problem at the modular level - OP should copy and paste the entire module here."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563392746, "post_id": 57083001, "comment_id": 100689198, "body": "Can&#39;t replicate the error with the code you&#39;ve provided."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563392868, "post_id": 57083001, "comment_id": 100689260, "body": "Do you have any other code in the module/workbook? If you paste just this code into a new workbook with the same sheets, do you get the same error?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1563393462, "post_id": 57083001, "comment_id": 100689541, "body": "when you get the error, what is returned in the immediate window if you type <code>?term.address</code> and <code>? term.value</code>?"}, {"owner": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "edited": false, "score": 0, "creation_date": 1563393888, "post_id": 57083001, "comment_id": 100689731, "body": "It says syntax error....btw I just ran it on a windows install of excel and it worked fine."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1563394588, "post_id": 57083001, "comment_id": 100690034, "body": "BOTH lines return <code>syntax error</code>?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1563394938, "post_id": 57083001, "comment_id": 100690190, "body": "Which one?  I suggested two lines to type in the immediate window, so I don&#39;t know which one you are referring to."}, {"owner": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "edited": false, "score": 0, "creation_date": 1563395081, "post_id": 57083001, "comment_id": 100690247, "body": "It was this line: <code>?term.value</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1563395116, "post_id": 57083001, "comment_id": 100690269, "body": "What did the other line return?"}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1593586838, "post_id": 57083001, "comment_id": 110829385, "body": "shoudln&#39;t it be <code>words = Split(...)</code>, is <code>words() = Split(...)</code> even valid syntax?"}], "owner": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593586597, "creation_date": 1563392079, "last_edit_date": 1593586597, "question_id": 57083001, "link": "https://stackoverflow.com/questions/57083001/how-to-identify-compile-error-with-split-value", "title": "How To Identify Compile Error With Split Value", "body": "<p>I have got through every compile error post on the site and I know it has something to do with the <code>.Value</code>. I have tried setting it to <code>= Now</code> and adding <code>(Now, term.Value)</code> similar to what others have done. Does anyone see why I'm getting the \"Compile error: Method or data member not found\"</p>\n\n<p>Please let me know if you see anything wrong specifically with the <code>words() = Split(term.Value)</code> code:</p>\n\n<pre><code>Sub FindSimilar()\n    Dim phrases As Range, phrase As Range\n    Dim terms As Range, term As Range\n    Dim matches As String\n    Dim words() As String\n\n    'ensure this has the correct sheet names for your workbook\n    Set phrases = ThisWorkbook.Worksheets(\"Export\").Range(\"B2:B4345\")\n    Set terms = ThisWorkbook.Worksheets(\"Topics\").Range(\"D1847:D4847\")\n\n    For Each term In terms\n        matches = \"\"\n        words() = Split(term.Value)\n\n\n        For i = 0 To UBound(words, 1)\n        If Len(words(i)) &gt; 2 Then\n         Select Case words(i)\n          Case \"business\", \"example\", \"string\"\n          Case Else\n            For Each phrase In phrases\n                If InStr(1, phrase.Value, words(i)) Then\n                    matches = matches &amp; phrase &amp; \"/\"\n                End If\n            Next phrase\n         End Select\n        End If\n        Next i\n\n        If matches &lt;&gt; vbNullString Then\n            term.Offset(0, 6).Value = Left(matches, Len(matches) - 1)\n        Else\n            term.Offset(0, 6).Value = \"No match\"\n        End If\n    Next term\nEnd Sub\n</code></pre>\n\n<p>Also, as a note, this code was working well and it just stopped working so I'm assuming it's just an update or some small text. I'm using Excel for Mac.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1563391433, "post_id": 57082843, "comment_id": 100688629, "body": "Do you not get any errors?  This line, <code>Range(&quot;F:G&quot; &amp; Rows.Count)</code>, isn&#39;t how you&#39;d use a range. You at least want to do <code>Range(&quot;F1:G&quot; &amp; rows.Count)</code>, but even then I highly doubt you want to loop through every single row in the worksheet?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1563391691, "post_id": 57082843, "comment_id": 100688744, "body": "@BruceWayne well OP is using <code>.End(xlUp).Row</code> but your point about the range notation still stands."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563391733, "post_id": 57082843, "comment_id": 100688764, "body": "<code>Cells(r, &quot;f:&quot;)</code> - get rid of that colon."}, {"owner": {"reputation": 3, "user_id": 11790921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dccc74bf2f986e00808cb822f375b913?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/11790921/christina"}, "edited": false, "score": 0, "creation_date": 1563391792, "post_id": 57082843, "comment_id": 100688786, "body": "It does loop through every single row. Very disturbing, and it just adds blank rows. So Im really struggle in finding out how this work. Tomorrow evening this assignment is due, let hope for the best :) !"}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 10609408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05205d061d53c93f7dc53cfec02ec877?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10609408/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1563463123, "last_edit_date": 1563463123, "creation_date": 1563396952, "answer_id": 57083959, "question_id": 57082843, "link": "https://stackoverflow.com/questions/57082843/add-copy-row-below-for-each-value-0/57083959#57083959", "title": "Add/copy row below for each value &gt; 0", "body": "<p>You don't want your program to needlessly search every single row in the workbook. You should instead have to search until it reaches the last row that has value. I have already written a function that looks for the last row with a value in a given sheet. It looks like this:</p>\n\n<pre><code>'Returns the last row in the specified sheet containing a value\nFunction returnLastRow(ByVal sheetName As String, countCol As Integer) As Long\n    With Sheets(sheetName)\n        returnLastRow = .Cells(.Rows.Count, countCol).End(xlUp).row\n    End With\nEnd Function\n</code></pre>\n\n<p>The function is passed the sheet name and column that you want it to search in and returns the last row that has a value. Example function call that looks in the first column of a worksheet called \"work\" and returns the last row that contains a value:</p>\n\n<pre><code>bottomRow = returnLastRow(\"work\", 1)\n</code></pre>\n\n<p>Now we can pass the bottomRow variable to the Add_Rows() subroutine which it can use to narrow down the range that it's going to operate on. When looping through a dynamic range, it's best to use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.cells\" rel=\"nofollow noreferrer\">Range.cells() property</a> because we can numerically refer to the rows and columns. Here's how I would modify your subroutine:</p>\n\n<pre><code>Sub Add_Rows(ByVal sheetName As String, bottomRow As Long)\n    With Sheets(sheetName)\n        For ctr = 1 To bottomRow\n            If (.Cells(ctr, 10).Value &gt; 0) Then\n                'insert a blank row\n                .Rows(ctr + 1 &amp; \":\" &amp; ctr + 1).Insert\n                '+1 to bottomRow since we've added a new row.\n                bottomRow = bottomRow + 1\n                'Copy information from ctr row\n                .Range(.Cells(ctr, 1), .Cells(ctr, 5)).Copy\n                'Add to new row\n                .Range(.Cells(ctr + 1, 1), .Cells(ctr + 1, 5)).PasteSpecial xlPasteAll\n            End If\n        Next ctr\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11790921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dccc74bf2f986e00808cb822f375b913?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/11790921/christina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 57083959, "answer_count": 1, "score": 0, "last_activity_date": 1563463123, "creation_date": 1563391346, "last_edit_date": 1563391821, "question_id": 57082843, "link": "https://stackoverflow.com/questions/57082843/add-copy-row-below-for-each-value-0", "title": "Add/copy row below for each value &gt; 0", "body": "<p>So I use Excel VBA to build easy macro's, but now its getting a little bit too complex for me. I want to copy a row each time a certain value appears in column F till J. So, if column F row 2 has a cell value > 0, than the entire row needs to be copied below exept for the cell values in column G till J. If column G row 2 also has a cell value > 0, then the entire row needs to be copied again exept for the cell values of column F, H till J. The picture below shows what I really wanna achieve.</p>\n\n<p><a href=\"https://i.stack.imgur.com/EhB0q.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EhB0q.jpg\" alt=\"Example\"></a></p>\n\n<p>After days of trial and error with different codes, I see that the following vba code inserts blank rows, without copying the row above it. </p>\n\n<pre><code> Sub Add_Rows()\n  Dim r As Long\n\n  Application.ScreenUpdating = False\n  For r = Range(\"F:G\" &amp; Rows.Count).End(xlUp).Row To 4 Step -1\n    If Cells(r, \"f:G\").Value &gt; 0 Then Rows(r + 1).Resize(Cells(r, \"G\").Value).Insert\n  Next r\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>How do I need to adjust this code in order to get it exactly as the example?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1563391487, "post_id": 57082772, "comment_id": 100688654, "body": "Why do you have <code>call file2</code> outside a subroutine?"}, {"owner": {"reputation": 43, "user_id": 11735662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11300b0fded39534a472333c68d5e9d0?s=128&d=identicon&r=PG&f=1", "display_name": "learningguy", "link": "https://stackoverflow.com/users/11735662/learningguy"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1563393138, "post_id": 57082772, "comment_id": 100689388, "body": "call File2 is suppose to be in the file1 routine."}], "owner": {"reputation": 43, "user_id": 11735662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11300b0fded39534a472333c68d5e9d0?s=128&d=identicon&r=PG&f=1", "display_name": "learningguy", "link": "https://stackoverflow.com/users/11735662/learningguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563392118, "creation_date": 1563390991, "last_edit_date": 1563392118, "question_id": 57082772, "link": "https://stackoverflow.com/questions/57082772/vba-code-doesnt-paste-data-on-the-last-row", "title": "VBA Code doesn&#39;t paste data on the last row", "body": "<p>I wrote some code to grab data from two workbooks after my data format them then paste them into a master workbook. The first dataset that I moved to the master workbook works fine but the second data set doesn't paste over to the next open row.</p>\n\n<p>When i run the code that extracts the data separately it works, but when I call the 2nd macro into the first it doesn't work which is how I want it to be. </p>\n\n<pre><code>Sub file1()\n'\n' test Macro\n'\n\n'\n'file 1 grabs the latest data\n  Application.ScreenUpdating = False\n    Dim MyPath As String\n    Dim MyFile As String\n    Dim LatestFile As String\n    Dim LatestDate As Date\n    Dim LMD As Date\n\n    MyPath = \"C:\\Users\\TAmon1\\Desktop\\AAV Utilization Report\\E\"\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n    MyFile = Dir(MyPath &amp; \"*.xlsx\", vbNormal)\n    If Len(MyFile) = 0 Then\n        MsgBox \"No files were found...\", vbExclamation\n        Exit Sub\n    End If\n    Do While Len(MyFile) &gt; 0\n        LMD = FileDateTime(MyPath &amp; MyFile)\n        If LMD &gt; LatestDate Then\n            LatestFile = MyFile\n            LatestDate = LMD\n        End If\n        MyFile = Dir\n    Loop\nWorkbooks.Open MyPath &amp; LatestFile\n'Variables for Vlookup\nDim wbcsv As Workbook, wbplanning As Workbook\nSet wbplanning = Workbooks(\"Planning_tool.xlsm\")\nSet wbcsv = Workbooks.Open(MyPath &amp; LatestFile)\nDim wb As Workbook\nSet lol = Workbooks.Open(MyPath &amp; LatestFile)\n\n\n\n'formats data to what I want    ActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").Sort.SortFields.Add2 _\n        Key:=Range(\"Table1[[#All],[SLIPED_CIR]]\"), SortOn:=xlSortOnValues, Order _\n        :=xlDescending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n' Copy data from file one\n   Range(\"a4\").CurrentRegion.Select\n    Selection.Copy\n    Windows(\"Compile1\").Activate\n    Range(\"a1\").Select\n    ActiveSheet.Paste\nlol.Close savechanges:=False\nEnd Sub\n '^^^^Code above works... calling file two doesn't work :(\n\ncall file2\nSub file2()\n'grabs latest data\n    Dim MyPath2 As String\n    Dim MyFile2 As String\n    Dim LatestFile2 As String\n    Dim LatestDate2 As Date\n    Dim LMD2 As Date   \n    MyPath2 = \"C:\\Users\\TAmon1\\Desktop\\AAV Utilization Report\\nsn\"\n    If Right(MyPath2, 1) &lt;&gt; \"\\\" Then MyPath2 = MyPath2 &amp; \"\\\"\n    MyFile2 = Dir(MyPath2 &amp; \"*.xlsx\", vbNormal)\n    If Len(MyFile2) = 0 Then\n        MsgBox \"No files were found...\", vbExclamation\n        Exit Sub\n    End If\n    Do While Len(MyFile2) &gt; 0\n        LMD2 = FileDateTime(MyPath2 &amp; MyFile2)\n        If LMD2 &gt; LatestDate2 Then\n            LatestFile2 = MyFile2\n            LatestDate2 = LMD2\n        End If\n        MyFile2 = Dir\n    Loop\nWorkbooks.Open MyPath2 &amp; LatestFile2\n'Variables for Vlookup\nDim wbcsv2 As Workbook, wbplanning2 As Workbook\nSet wbplanning2 = Workbooks(\"Planning_tool.xlsm\")\nSet wbcsv2 = Workbooks.Open(MyPath2 &amp; LatestFile2)\nDim wb2 As Workbook\nSet lol2 = Workbooks.Open(MyPath2 &amp; LatestFile2)\n'formats file2\n   ActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").Sort.SortFields.Add2 _\n        Key:=Range(\"Table1[[#All],[SLIPED_CIR]]\"), SortOn:=xlSortOnValues, Order _\n        :=xlDescending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n   Range(\"a4\").Select\n   Selection.CurrentRegion.Select\n    Selection.Offset(1, 0).Resize(Selection.Rows.Count - 1).Copy\n    Windows(\"Compile1\").Activate\n' paste file two...    \n'uses offset and xlup function to fin the next open row and insert data\nActiveWorkbook.Worksheets(\"Sheet1\").Range(\"A65000\").End(xlUp).Offset(1).PasteSpecial xlPasteAll\n\n\n\n\n\n\nlol2.Close savechanges:=False\n\nEnd Sub\n</code></pre>\n\n<p>File 2 data should be right under file 1 data but instead file 2 data doesn't popup unless I run the two functions separately.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1563391131, "post_id": 57082765, "comment_id": 100688500, "body": "Instead of us assuming things from the start, what does <code>Me</code> refer to? Are you in the the code module of a userform?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1563391179, "post_id": 57082765, "comment_id": 100688519, "body": "A few points: this code doesn&#39;t compile. Where is <code>c</code> declared? It&#39;s always a good idea to enforce variable declaration using <code>Option Explicit</code> in <i>all</i> code/class/form modules."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1563391193, "post_id": 57082765, "comment_id": 100688527, "body": "Yes this is in the code module of the userform. Sorry forgot a few lines of code. Added them. Including <code>dim c as Control</code>"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1563393009, "post_id": 57082765, "comment_id": 100689320, "body": "Your code is working fine for me as posted.  Regarding the apparent skip of <code>if c Then</code>, just making sure intended purpose is to check the VALUE of c, because c&#39;s default return value for that checkbox appears to be True/False for checked unchecked so if the box is unchecked it will fail this step.  What References do you have selected?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1563394074, "post_id": 57082765, "comment_id": 100689814, "body": "Try moving that &quot;Microsoft Forms 2.0 Object Library&quot; to be right after &quot;Microsoft Office 16.0 Object Library&quot;."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1563394680, "post_id": 57082765, "comment_id": 100690086, "body": "@GSerg thanks that did it!"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1563395706, "post_id": 57082765, "comment_id": 100690532, "body": "@gserg can you explain <i>why</i> that&#39;s important?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1563401029, "post_id": 57082765, "comment_id": 100692265, "body": "@chrisneilsen I&#39;m not sure actually. Since it worked, there must be a type named <code>Control</code> in the ADO, DAO, or Outlook libraries that gets picked due to the reference order. But I cannot see such type in any of these libraries, and I cannot reproduce the issue when I reference the same libraries in the OP&#39;s original order."}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563393924, "creation_date": 1563390965, "last_edit_date": 1563393924, "question_id": 57082765, "link": "https://stackoverflow.com/questions/57082765/looping-issue-with-excel-forms", "title": "Looping issue with Excel Forms", "body": "<p>I'm getting a type mismatch error when running the following code on an Excel form with a check box. Not sure why as this code works for my other user forms just fine without this error. Also noticed others in the office can run this without the type mismatch error. </p>\n\n<p>Code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate Sub CheckBox1_Click()\nEnd Sub  \n\nPrivate Sub OkButton_Click()\n    Dim c As Control\n\n    For Each c In Me.Controls '&lt;----Error line\n        If TypeOf c Is MSForms.CheckBox Then\n            If c Then\n                Select Case c.Name    \n                Case \"CheckBox1\"\n                   'Code    \n                Case Else\n                End Select\n            End If\n        End If\n    Next c\n\n    Hide\nEnd Sub\n</code></pre>\n\n<p>I've attempted to use <code>For each c in Forms(UserForm1).controls</code> but it doesn't recognize the fact that the box is checked and runs the loop without running the code for the check box. </p>\n\n<p>Any help would be greatly appreciated. </p>\n\n<p>EDIT:\nHere are my current references</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nt7Sk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nt7Sk.png\" alt=\"References\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1563390276, "post_id": 57082548, "comment_id": 100688145, "body": "you should debug the values in your arrays <code>Temp1</code> and <code>Temp2</code> , from element 25,000 and after. I am using <code>Transpose</code> for arrays with 150K rows, and it&#39;s working fine"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1563390940, "last_edit_date": 1563390940, "creation_date": 1563390347, "answer_id": 57082638, "question_id": 57082548, "link": "https://stackoverflow.com/questions/57082548/writing-large-89-000-elements-array-to-range/57082638#57082638", "title": "Writing large (~89,000 elements) array to range", "body": "<p>Make the arrays 2 dimensional with one column:</p>\n\n<pre><code>ReDim Temp1(1 To LastRowB - 1,1 to 1)\nReDim Temp1(1 To LastRowB - 1,1 to 1)\n</code></pre>\n\n<p>Then when you assign the values:</p>\n\n<pre><code>Temp1(i,1) = Arr1(j, 2)\nTemp2(i,1) = Arr1(j, 3) \n</code></pre>\n\n<p>Then you do not need the <code>Application.Transpose</code></p>\n\n<pre><code>sheet2.Range(\"C2:C\" &amp; ExtLRow) = Temp1\nsheet2.Range(\"G2:G\" &amp; ExtLRow) = Temp2\n</code></pre>\n\n<hr>\n\n<p>Also to speed things up avoid the loops altogether:</p>\n\n<pre><code>Sub Test()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\n'call subs to find last rows for each sheet\nLastRowASub\nLastRowBSub\n\nDim i As Long\nDim j As Long\nDim x As Double\nDim y As Double\n\nDim Arr1() As Variant\nDim Arr2() As Variant\nDim Temp1() As Variant\nDim Temp2() As Variant\n\nReDim Temp1(1 To LastRowB - 1, 1 To 1)\nReDim Temp2(1 To LastRowB - 1, 1 To 1)\n\n'populate first array\nArr1 = Sheet1.Range(\"A2:K\" &amp; lastrowa).Value\n\n\n'populate second array\nArr2 = sheet2.Range(\"F2:F\" &amp; LastRowB).Value\n\n'populate two temporary arrays based on matching between arrays 1 and 2\nFor i = 1 To UBound(Arr2, 1)\n    For j = 1 To UBound(Arr1, 1)\n        If Arr1(j, 11) = Arr2(i, 1) And Not IsEmpty(Arr1(j, 3)) Then\n            Temp1(i, 1) = Arr1(j, 3)\n            Temp2(i, 1) = Arr1(j, 1)\n        End If\n    Next j\nNext i\n\n'write temp arrays to sheet2\nsheet2.Range(\"C2:C\" &amp; ExtLRow).Value = Temp1\nsheet2.Range(\"G2:G\" &amp; ExtLRow).Value = Temp2\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9075067, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TkVaVsEx1O0/AAAAAAAAAAI/AAAAAAAAAGQ/fsPRED0JTUA/photo.jpg?sz=128", "display_name": "Ramzi Saud", "link": "https://stackoverflow.com/users/9075067/ramzi-saud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 57082638, "answer_count": 1, "score": 0, "last_activity_date": 1563390940, "creation_date": 1563389884, "question_id": 57082548, "link": "https://stackoverflow.com/questions/57082548/writing-large-89-000-elements-array-to-range", "title": "Writing large (~89,000 elements) array to range", "body": "<p>After populating my arrays based on some criteria I am attempting to write two temporary arrays to two different ranges on the worksheet. Using my current method with the transposed arrays I begin to get <code>#N/A</code> values after row 24,392. I'm not sure how to get past the size limitations of <code>Application.Transpose</code>.</p>\n\n<p><code>LastRowA</code> and <code>LastRowB</code> are declared globally as <code>long</code>. The value of <code>LastRowA</code> is >11,000 and <code>LastRowB</code> is >80,000</p>\n\n<pre><code>Sub Test()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\n'call subs to find last rows for each sheet\nLastRowASub\nLastRowBSub\n\nDim i As Long\nDim j As Long\nDim x As Double\nDim y As Double\n\nDim Arr1() As Variant\nDim Arr2() As Variant\nDim Temp1() As String\nDim Temp2() As String\nReDim Arr1(1 To LastRowA - 1, 3)\nReDim Arr2(1 To LastRowB - 1)\nReDim Temp1(1 To LastRowB - 1)\nReDim Temp2(1 To LastRowB - 1)\n\n'populate first array\nFor x = 1 To LastRowA - 1\n    Arr1(x, 1) = sheet1.Range(\"k\" &amp; x + 1)\n    Arr1(x, 2) = sheet1.Range(\"c\" &amp; x + 1)\n    Arr1(x, 3) = sheet1.Range(\"a\" &amp; x + 1)\nNext x\n\n'populate second array\nFor y = 1 To LastRowB - 1\n    Arr2(y, 1) = sheet2.Range(\"f\" &amp; y + 1)\nNext y\n\n'populate two temporary arrays based on matching between arrays 1 and 2\nFor i = 1 To UBound(Arr2)\n    For j = 1 To UBound(Arr1)\n        If Arr1(j, 1) = Arr2(i, 1) And Not IsEmpty(Arr1(j, 2)) Then\n            Temp1(i) = Arr1(j, 2)\n            Temp2(i) = Arr1(j, 3)\n        End If\n    Next j\nNext i\n\n'write temp arrays to sheet2\nsheet2.Range(\"C2:C\" &amp; ExtLRow) = Application.Transpose(Temp1)\nsheet2.Range(\"G2:G\" &amp; ExtLRow) = Application.Transpose(Temp2)\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n\n<p>Everything is working as expected other than the transposed arrays returning <code>#N/A</code>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1563389871, "post_id": 57082519, "comment_id": 100687980, "body": "Msgbox Int(struserdn)?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1563389924, "post_id": 57082519, "comment_id": 100688004, "body": "<code>MsgBox Mid(struserdn, 4)</code> will give you the string after the leading 3 characters"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1563390016, "post_id": 57082519, "comment_id": 100688039, "body": "@ShaiRado how about using that same format to paste the value to a cell, say <code>$A$1</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1563390080, "post_id": 57082519, "comment_id": 100688064, "body": "Range(&quot;A1&quot;).Value2 = Mid(struserdn, 4)"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1563390297, "post_id": 57082519, "comment_id": 100688155, "body": "@ShaiRado when running <code>Range(&quot;A1&quot;).Value2 = Mid(struserdn, 4)</code> it makes cell <code>A1</code> = 4"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1563390578, "post_id": 57082519, "comment_id": 100688265, "body": "@ShaiRado declaring struserdn as <code>String</code> solved the problem"}], "answers": [{"tags": [], "owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "is_accepted": true, "score": 0, "last_activity_date": 1563390747, "creation_date": 1563390747, "answer_id": 57082710, "question_id": 57082519, "link": "https://stackoverflow.com/questions/57082519/how-to-replace-part-of-a-function-result-in-excel-vba/57082710#57082710", "title": "How to replace part of a Function result in Excel VBA", "body": "<p>Here is the working version:</p>\n\n<p><strong>Displaying Function result in MsgBox without leading Zeros</strong></p>\n\n<pre><code>Public Sub employeeldap_office()\nDim struser As String\nDim struserdn As Integer\n\nstruser = UserForm1.TextBox1.Text\nstruserdn = Get_LDAP_User_Properties(\"user\", \"samAccountName\", struser, \"department\")\n\nIf Len(struserdn) &lt;&gt; 0 Then\n\n  MsgBox Mid(struserdn, 4)\nElse\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>Displaying Function result in cell range without leading Zeros</strong></p>\n\n<pre><code>Public Sub employeeldap_office()\nDim struser As String\nDim struserdn As String\n\nstruser = UserForm1.TextBox1.Text\nstruserdn = Get_LDAP_User_Properties(\"user\", \"samAccountName\", struser, \"department\")\n\nIf Len(struserdn) &lt;&gt; 0 Then\n    Sheet2.Range(\"AB13\").Value2 = Mid(struserdn, 4)\nElse\n\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 57082710, "answer_count": 1, "score": 0, "last_activity_date": 1563390747, "creation_date": 1563389719, "last_edit_date": 1563390591, "question_id": 57082519, "link": "https://stackoverflow.com/questions/57082519/how-to-replace-part-of-a-function-result-in-excel-vba", "title": "How to replace part of a Function result in Excel VBA", "body": "<p>I would like to replace my <code>Function</code> result with a different formatting. Currently my Sub displays the output integer as \"<strong>0009594</strong>\". I would like my function result to be displayed without the leading 3 zeros, \"<strong>9594</strong>\". </p>\n\n<p>My function result varies based off UserID from <code>UserForm1.TextBox1</code></p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Public Sub employeeldap_office()\nDim struser As String\nDim struserdn As Integer\n\nstruser = UserForm1.TextBox1.Text\nstruserdn = Get_LDAP_User_Properties(\"user\", \"samAccountName\", struser, \"department\")\n\nIf Len(struserdn) &lt;&gt; 0 Then\n\n    MsgBox struserdn\nElse\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563389947, "post_id": 57082302, "comment_id": 100688010, "body": "Consider using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetchange\" rel=\"nofollow noreferrer\"><code>Workbook.SheetChange</code></a> and <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetselectionchange\" rel=\"nofollow noreferrer\"><code>Workbook.SheetSelectionChange</code></a> events instead."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11799003, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zonvsScbO_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBgY4ZxoVyKoghexSWAmG7xVfG5g/photo.jpg?sz=128", "display_name": "Robert Kuhnle", "link": "https://stackoverflow.com/users/11799003/robert-kuhnle"}, "edited": false, "score": 1, "creation_date": 1563389181, "post_id": 57082346, "comment_id": 100687630, "body": "In simplifying my question (got rid of some junk) it made it a little more understandable for me...  So just create a module and pass the action from the worksheet events to the module procedures to do the work.  I have to remember how to do some of that ;-)  I&#39;ll give it a shot"}], "tags": [], "owner": {"reputation": 2318, "user_id": 2670571, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0c4a608118770c1bdfbc1ad857a375bf?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2670571/john"}, "is_accepted": false, "score": 1, "last_activity_date": 1563388883, "creation_date": 1563388883, "answer_id": 57082346, "question_id": 57082302, "link": "https://stackoverflow.com/questions/57082302/how-to-simplify-dozens-of-excel-tabs-with-the-same-underlying-vba-code/57082346#57082346", "title": "How to simplify; dozens of Excel Tabs with the same underlying VBA Code", "body": "<p>Create a subroutine that contains the logic and then create the application you drop on to each sheet.  This application will call the subroutine.  Now, when you change the subroutine, all of the sheets will pickup the same modification.  </p>\n"}, {"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1563390847, "last_edit_date": 1563390847, "creation_date": 1563390512, "answer_id": 57082668, "question_id": 57082302, "link": "https://stackoverflow.com/questions/57082302/how-to-simplify-dozens-of-excel-tabs-with-the-same-underlying-vba-code/57082668#57082668", "title": "How to simplify; dozens of Excel Tabs with the same underlying VBA Code", "body": "<p>Instead of using the Worksheet events, use their corresponding Workbook events: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetselectionchange\" rel=\"nofollow noreferrer\"><code>Workbook.SheetSelectionChange</code></a> and <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetchange\" rel=\"nofollow noreferrer\"><code>Workbook.SheetChange</code></a>. These fire whenever <em>any</em> worksheet has a selection change or cell change. </p>\n\n<p>Add these to the <code>ThisWorkbook</code> code module.</p>\n\n<pre><code>Dim PreVal\n\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    If Target.Address = \"$D$1\" Or Target.Address = \"$D$2\" Then\n        PreVal = Target.Value\n    End If\nEnd Sub\n\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    On Error GoTo SafeExit\n    Application.EnableEvents = False\n\n    If Target.Address = \"$D$1\" Or Target.Address = \"$D$2\" Then\n        If Target.Value &lt;&gt; PreVal Then\n            SomethingSomewhere = Value\n            PreVal = Target.Value\n        End If\n    End If\n\nSafeExit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>You can modify these to ignore the logging page by checking <code>Sh.Name</code>, for example.</p>\n"}], "owner": {"reputation": 31, "user_id": 11799003, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zonvsScbO_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBgY4ZxoVyKoghexSWAmG7xVfG5g/photo.jpg?sz=128", "display_name": "Robert Kuhnle", "link": "https://stackoverflow.com/users/11799003/robert-kuhnle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1563390847, "creation_date": 1563388645, "question_id": 57082302, "link": "https://stackoverflow.com/questions/57082302/how-to-simplify-dozens-of-excel-tabs-with-the-same-underlying-vba-code", "title": "How to simplify; dozens of Excel Tabs with the same underlying VBA Code", "body": "<p>I have 51 unique tabs in a workbook.  Each tab has a bit of code that will update the 52nd tab when certain cells are changed on the 51.   Bottom line, it's an audit history of the 2 cells on each of the 51 tabs.</p>\n\n<p>I've pieced together the following code that I drop onto each worsheets VBA section.  The problem is that I have to do this for every single sheet in the workbook.  I'd think that I should be able to have just a single common call to the meat of the VBA...</p>\n\n<pre><code>Dim PreVal\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nIf Target.Address = \"$D$1\" Or Target.Address = \"$D$2\" Then\n    PreVal = Target.Value\nEnd If\n\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Address = \"$D$1\" Then\n    If Target.Value &lt;&gt; PreVal Then\n        SomethingSomewhere = Value\n        PreVal = Target.Value\n    End If\nEnd If\n\nIf Target.Address = \"$D$2\" Then\n    If Target.Value &lt;&gt; PreVal Then\n        SomethingSomewhere = Value\n        PreVal = Target.Value\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>It works wonderfully, just managing any changes needs to be done on every single sheet..</p>\n\n<p>BTW, the SomethingSomewhere equals Value  sets the app user name, sheet name, preval, target value, and date time into columns on the logging page</p>\n"}, {"tags": ["excel", "vba", "selenium", "xpath", "css-selectors"], "comments": [{"owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "edited": false, "score": 0, "creation_date": 1563389031, "post_id": 57082285, "comment_id": 100687558, "body": "HTML looks malformed missing the <code>&lt;</code> and <code>&gt;</code>. Can you cross check once?"}, {"owner": {"reputation": 103, "user_id": 11750785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/360285e3b0b8030d16c81a81ba50f02d?s=128&d=identicon&r=PG&f=1", "display_name": "DWP", "link": "https://stackoverflow.com/users/11750785/dwp"}, "reply_to_user": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "edited": false, "score": 0, "creation_date": 1563389131, "post_id": 57082285, "comment_id": 100687605, "body": "Apologies, just edited the HTML, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "is_accepted": true, "score": 2, "last_activity_date": 1582733228, "last_edit_date": 1582733228, "creation_date": 1563389419, "answer_id": 57082454, "question_id": 57082285, "link": "https://stackoverflow.com/questions/57082285/trying-to-fill-text-in-input-box-with-dynamic-drop-down/57082454#57082454", "title": "Trying to fill text in input box with dynamic drop down", "body": "<p>To send a <em>character sequence</em> within the desired element you can use either of the following <a href=\"https://stackoverflow.com/questions/48369043/official-locator-strategies-for-the-webdriver/48376890#48376890\">Locator Strategies</a>:</p>\n\n<ul>\n<li><p>Using <code>FindElementByCss</code>:</p>\n\n<pre><code>obj.FindElementByCss(\"input.form-control.cust-autosuggest.ng-valid.ng-touched.ng-dirty.ng-valid-parse#selectcustTxt\").SendKeys (\"1111\")\n</code></pre></li>\n<li><p>Using <code>FindElementByXPath</code>:</p>\n\n<pre><code>obj.FindElementByXPath(\"//input[@class='form-control cust-autosuggest ng-valid ng-touched ng-dirty ng-valid-parse' and @id='selectcustTxt']\").SendKeys (\"1111\")\n</code></pre></li>\n</ul>\n\n<hr>\n\n<h2>Reference</h2>\n\n<p>You can find a couple of relevant discussions in:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/60391442/how-to-send-text-to-some-html-elements/60398142#60398142\">How to send text to some HTML elements?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/57107574/need-help-to-fill-number-into-chrome-input-box-with-selenium/57107749#57107749\">Need help to fill number into Chrome input box with Selenium</a></li>\n</ul>\n"}], "owner": {"reputation": 103, "user_id": 11750785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/360285e3b0b8030d16c81a81ba50f02d?s=128&d=identicon&r=PG&f=1", "display_name": "DWP", "link": "https://stackoverflow.com/users/11750785/dwp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 57082454, "answer_count": 1, "score": 1, "last_activity_date": 1612117277, "creation_date": 1563388567, "last_edit_date": 1612117277, "question_id": 57082285, "link": "https://stackoverflow.com/questions/57082285/trying-to-fill-text-in-input-box-with-dynamic-drop-down", "title": "Trying to fill text in input box with dynamic drop down", "body": "<p>I need some help. Chrome (v 75.0.3770.100) using Selenium Basic ChromeDriver (v 75.0.3770.140) in Excel (2013) VBE. There's an input box which generates a dynamic list if the customer id# exists. I wish to fill in the customer id# then select from the dynamic drop down. But first step, I'm struggling to input my text to the box. I'm able to click on the box with</p>\n\n<pre><code>obj.FindElementById(\"selectcustTxt\").Click\n</code></pre>\n\n<p>but when I try to fill in the box with:</p>\n\n<pre><code>obj.FindElementById(\"selectcustTxt\").Value = \"1111\"\n</code></pre>\n\n<p>I get an error Run-time error '424': Object required</p>\n\n<p>I tried the following FindElementByXPath with both .Value and .Text but get the same Run-time error '424': Object required</p>\n\n<pre><code>obj.FindElementByXPath(\"//input[@class='form-control cust-autosuggest ng-pristine ng-valid ng-touched'][@id='selectcustTxt']\").Value = \"1111\"\n</code></pre>\n\n<p>Here's the HTML:</p>\n\n<pre><code>&lt;div class=\"form-group search-field\"&gt;&lt;input id=\"selectcustTxt\" type=\"text\" class=\"form-control cust-autosuggest ng-valid ng-touched ng-dirty ng-valid-parse\" autocomplete=\"off\" plshholder=\"Enter Cust name\" autocomplepte=\"off\" ng-model=\"cust\" suggest-type=\"custService\" sh-autosuggest=\"custAddresses\" data-validation=\"required\"&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1563388711, "post_id": 57082289, "comment_id": 100687426, "body": "i tried that but how do i implement that into such code mine allways comes out as error"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1563388780, "post_id": 57082289, "comment_id": 100687449, "body": "@zgivod - you recorded a macro and there was an error when you ran it? The code above would throw an  error, if your Picture is not named exactly &quot;Picture 1&quot;."}, {"owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1563389125, "post_id": 57082289, "comment_id": 100687601, "body": "if i use the exact recorded macro then i wont be able to save picture with document...."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1563389697, "post_id": 57082289, "comment_id": 100687880, "body": "@zgivod - I really do not understand what do you mean with &quot;exact recorded macro and saving picture with document&quot;... Honestly, the macro recorder is one of the few things that gives some small advantage of VBA. Anyway, just COPY and PASTE the second code in my answer, changing the path <code>&quot;C:\\SomePic.jpg&quot;</code> to where the picture is. The code would delete all other pictures on the first worksheet, so be careful. Cheers!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1563389581, "last_edit_date": 1563389581, "creation_date": 1563388575, "answer_id": 57082289, "question_id": 57082244, "link": "https://stackoverflow.com/questions/57082244/how-can-i-rotate-an-image-and-move-it-to-a-specific-location/57082289#57082289", "title": "How can I rotate an image and move it to a specific location?", "body": "<p>The macro recorder would really help you here - upload the picture and see what code it produces for the rotating. Mine is like this:</p>\n\n<pre><code>ActiveSheet.Shapes.Range(Array(\"Picture 1\")).Select\nSelection.ShapeRange.IncrementRotation 90\n</code></pre>\n\n<p>Of course, the <code>Selection</code> and the <code>ActiveSheet~.Select</code>  should be avoided, but this depends on your code. This is a good way to rotate the picture without select:</p>\n\n<pre><code>Sub TestMe()\n\n    KillAllShapes Worksheets(1)\n    ThisWorkbook.Worksheets(1).Pictures.Insert (\"C:\\SomePic.jpg\")\n    Dim myShape As Shape\n    Set myShape = Worksheets(1).Shapes(1)\n\n    With myShape\n        .Top = Range(\"B5\").Top\n        .Left = Range(\"B5\").Left\n        .IncrementRotation 180 'or 90\n    End With\n\nEnd Sub\n\nSub KillAllShapes(wks As Worksheet)\n\n    Dim sh As Shape\n    For Each sh In wks.Shapes\n        sh.Delete\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>This one from <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.shaperange.incrementrotation\" rel=\"nofollow noreferrer\">the ShapeRange.IncrementRotation documentation</a> looks ok:</p>\n\n<pre><code>Set myDocument = Worksheets(1) \nWith myDocument.Shapes(1).Duplicate \n    .Fill.PresetTextured msoTextureGranite \n    .IncrementLeft 70 \n    .IncrementTop -50 \n    .IncrementRotation 30 \nEnd With\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563389581, "creation_date": 1563388395, "last_edit_date": 1563388689, "question_id": 57082244, "link": "https://stackoverflow.com/questions/57082244/how-can-i-rotate-an-image-and-move-it-to-a-specific-location", "title": "How can I rotate an image and move it to a specific location?", "body": "<p>I am trying to upload a picture and then rotate it and move it to specific location, but I can't seem to get it to rotate. I have this code because I want to save the picture with the document.</p>\n\n<pre><code>Sub tyh()\n    ActiveSheet.Shapes.AddPicture _\n    Filename:=\"C:\\Users\\dovi.dovi-PC\\Desktop\\ads bh\\IMG-7042.jpg\", _\n    linktofile:=msoFalse, savewithdocument:=msoCTrue, _\n    Left:=1200, Top:=0, Width:=350, Height:=604\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1563387269, "creation_date": 1563387269, "answer_id": 57081991, "question_id": 57081959, "link": "https://stackoverflow.com/questions/57081959/how-do-i-name-a-chart-object/57081991#57081991", "title": "How do I name a chart object?", "body": "<p>Try setting the <code>ChartObject</code> first, and then name it:</p>\n\n<pre><code>Dim ChtObj As ChartObject\n\nSet ChtObj = Sheets(\"Unit2SelectedData\").ChartObjects.Add(Left:=1700, Top:=50, Width:=800, Height:=400)\nChtObj.Name = \"My Chart\"\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4040720, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QvfTgm9_FVA/AAAAAAAAAAI/AAAAAAAAAGc/y3T4WN6XCq8/photo.jpg?sz=128", "display_name": "flamingbird123", "link": "https://stackoverflow.com/users/4040720/flamingbird123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 57081991, "answer_count": 1, "score": 0, "last_activity_date": 1563387269, "creation_date": 1563387127, "question_id": 57081959, "link": "https://stackoverflow.com/questions/57081959/how-do-i-name-a-chart-object", "title": "How do I name a chart object?", "body": "<p>How do I change the name of a chartobject instead of referring it as ChartObject(1)? The Chartobject is on a sheet named \"Unit2SelectedData\"</p>\n\n<pre><code>Sheets(\"Unit2SelectedData\").ChartObjects.Add Left:=1700, Top:=50, Width:=800, Height:=400\nSheets(\"Unit2SelectedData\").ChartObjects(1).Activate\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1563387331, "post_id": 57081919, "comment_id": 100686775, "body": "What is the error, and on what line does it occur?"}, {"owner": {"reputation": 1, "user_id": 11799120, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oYAmGtGeZwc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsRSgYOLdp6WkfxJEf9vmgx_k49A/photo.jpg?sz=128", "display_name": "Joe R", "link": "https://stackoverflow.com/users/11799120/joe-r"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1563387611, "post_id": 57081919, "comment_id": 100686913, "body": "Warcupine It errors as type mismatch on the if statement of the loop sometimes, such as at the 70th and 71st iteration of the loop, and later on as well, up towards 200. It used to error the first time at the 54th iteration, but then switched to the 71st, regardless of what data set I run."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1563388149, "post_id": 57081919, "comment_id": 100687169, "body": "does the data contain worksheet error values (e.g. <code>#N&#47;A</code>, <code>#VALUE</code>, <code>#REF!</code>, etc.)?"}, {"owner": {"reputation": 1, "user_id": 11799120, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oYAmGtGeZwc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsRSgYOLdp6WkfxJEf9vmgx_k49A/photo.jpg?sz=128", "display_name": "Joe R", "link": "https://stackoverflow.com/users/11799120/joe-r"}, "edited": false, "score": 0, "creation_date": 1563388787, "post_id": 57081919, "comment_id": 100687454, "body": "No it doesn&#39;t, strictly values, no formulas at all"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1563389470, "post_id": 57081919, "comment_id": 100687773, "body": "Are they all numbers?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563389779, "post_id": 57081919, "comment_id": 100687923, "body": "You have a lot of clauses in that <code>And</code>&#39;ed <code>If</code> test - remember VBA doesn&#39;t short-circuit tests, so all comparisons will be evaluated, even if an earlier one fails.  Also, if any of the Areas have &gt;1 cell you can&#39;t do something like compare <code>.Value</code> directly with a number or &quot;&quot;.  You might consider breaking out your tests and making sure all areas are single-cell ranges.  Also pusing a range variable in place of <code>ActiveSheet.Range(rng3.Address).SpecialCells(xlCellTypeVisib&zwnj;&#8203;le)</code> will make your code 10x more readable."}, {"owner": {"reputation": 1, "user_id": 11799120, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oYAmGtGeZwc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsRSgYOLdp6WkfxJEf9vmgx_k49A/photo.jpg?sz=128", "display_name": "Joe R", "link": "https://stackoverflow.com/users/11799120/joe-r"}, "edited": false, "score": 0, "creation_date": 1563391805, "post_id": 57081919, "comment_id": 100688793, "body": "Warcupine, yes, and Tim thanks i will try all of these. Like I said, I&#39;m still getting the hang of this sort of thing"}], "owner": {"reputation": 1, "user_id": 11799120, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oYAmGtGeZwc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsRSgYOLdp6WkfxJEf9vmgx_k49A/photo.jpg?sz=128", "display_name": "Joe R", "link": "https://stackoverflow.com/users/11799120/joe-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563387087, "creation_date": 1563386947, "last_edit_date": 1563387087, "question_id": 57081919, "link": "https://stackoverflow.com/questions/57081919/is-there-a-better-way-to-loop-through-only-visible-cells-of-a-column-and-compare", "title": "Is there a better way to loop through only visible cells of a column and compare the current cell to the next cell and the cell two after?", "body": "<p>I have been using this code to try and count when the performance value goes up a certain degree from one cell to the next, but sometimes I need to count if the performance has gone up two cells in advance, and only count those situations once. The code I have been using throws an error at random intervals, and I cannot determine why. I am very new at VBA.</p>\n\n<p>I have tried several different methods of only looking through the filtered cells only, to no avail when it comes to comparing cells.</p>\n\n<pre><code>Dim i As Variant\ni = 1\n\nOn Error GoTo ErrLoops:\n\nErrCountLoop:\n\nDo While i &lt; 328\n\n    If ActiveSheet.FilterMode = True And ((ActiveSheet.Range(rng3.Address).SpecialCells _\n            (xlCellTypeVisible).Areas(i + 1).Value) &lt;&gt; \"\") And ((ActiveSheet.Range(rng3.Address).SpecialCells _\n            (xlCellTypeVisible).Areas(i).Value) &lt; -45) And (((ActiveSheet.Range(rng3.Address).SpecialCells _\n            (xlCellTypeVisible).Areas(i + 1).Value) - 25) &gt; (ActiveSheet.Range(rng3.Address).SpecialCells _\n            (xlCellTypeVisible).Areas(i).Value)) And ((ActiveSheet.Range(rng3.Address).SpecialCells _\n            (xlCellTypeVisible).Areas(i + 2).Value) - 50 &gt; (ActiveSheet.Range(rng3.Address).SpecialCells _\n            (xlCellTypeVisible).Areas(i).Value)) And ((ActiveSheet.Range(rng3.Address).SpecialCells _\n            (xlCellTypeVisible).Areas(i + 1).Value) &gt; -85) Then\n\n            count3 = count3 + 1\n    ElseIf ActiveSheet.FilterMode = False Then\n\n\n    End If\n    i = i + 1\n\n  Loop\nIf i &gt; 328 Then\n    GoTo StackCount\nEnd If\n\nErrLoops:\ni = i + 1\nResume ErrCountLoop\n\nStackCount:\nMsgBox \"Number of stacks = \" &amp; count3\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1563386804, "post_id": 57081819, "comment_id": 100686563, "body": "<code>if isnumeric(application.match(ws.name,range(&quot;A1:A20&quot;),0)) then</code> ?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1563387355, "post_id": 57081819, "comment_id": 100686783, "body": "It may be the case that a description of what you want to do with this selected data may result in a more efficient method of accomplishing your end goal."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1563386840, "creation_date": 1563386840, "answer_id": 57081890, "question_id": 57081819, "link": "https://stackoverflow.com/questions/57081819/if-statement-using-list-of-variables-in-vba/57081890#57081890", "title": "If Statement using List of Variables in VBA", "body": "<p>Something like the code below will fit your needs (see code notes for some explanations):</p>\n\n<pre><code>Dim ws As Worksheet\nDim SheetNamesArr As Variant\n\n' read the sheet names array from a range in one of your sheets\nSheetNamesArr = ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1:A10\") ' &lt;-- you can modify the range to suit your needs\n\nFor Each ws In ActiveWorkbook.Worksheets 'This statement starts the loop\n    ' use Match to find if shee't sname is found within an array\n    If Not IsError(Application.Match(ws.Name, SheetNamesArr, 0)) Then\n        ' do something if sheet's name is found\n\n    Else\n        ' do something else &gt;&gt; raise an error msg\n\n    End If\n\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11799091, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CIO9kz04DQo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcbQt6e3M0gb6Ddn8BHXpr2mp3xWw/photo.jpg?sz=128", "display_name": "CDPTAN", "link": "https://stackoverflow.com/users/11799091/cdptan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 57081890, "answer_count": 1, "score": 0, "last_activity_date": 1563386840, "creation_date": 1563386602, "question_id": 57081819, "link": "https://stackoverflow.com/questions/57081819/if-statement-using-list-of-variables-in-vba", "title": "If Statement using List of Variables in VBA", "body": "<p>I'm trying to write an if statement that checks the current excel tab versus a list (either stored on another tab, manually entered in a list in vba, or other) and this is in a loop. It all works fine if I manually type in one item off the list in VBA but I cant figure out a way to have it reference the entire list. </p>\n\n<p>I have tried cases, referencing a range, manually putting the list in the direct VBA code. </p>\n\n<p>The desired result is having the \"ABC\" being a list of 20-40 different items. I'm hoping to avoid a super long or statement. For efficiency I was hoping to just put = some range so that I dont have to manually update VBA everytime the data changes.</p>\n\n<pre><code>Dim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets 'This statement starts the loop\n    If ws.Name = \"ABC\" Then\n\n\n\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "find"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1563385349, "post_id": 57081526, "comment_id": 100685925, "body": "<code>Set foundRange = Worksheets(&quot;Leona&quot;).Range(&quot;C:C&quot;).Find(Reg, LookAt:=xlWhole)</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 5, "creation_date": 1563385421, "post_id": 57081526, "comment_id": 100685953, "body": "But to improve your code, consider <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. Also avoid relying on <code>Activate</code> and <code>ActiveCell</code>"}, {"owner": {"reputation": 3, "user_id": 11124133, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f8LNv3Lqjqk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffxLzVXubp4z1ib8t5kbNteic85A/mo/photo.jpg?sz=128", "display_name": "Karlage", "link": "https://stackoverflow.com/users/11124133/karlage"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563385657, "post_id": 57081526, "comment_id": 100686071, "body": "I&#39;ve just tried {Set foundRange = Worksheets(&quot;Leona&quot;).Range(&quot;C:C&quot;).Find(Reg, LookAt:=xlWhole).select} but i got a type mismatch error. Also thanks for that link about avoiding select, i&#39;ll go through that when i get time."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563385708, "post_id": 57081526, "comment_id": 100686087, "body": "Don&#39;t <code>Select</code> and <code>Dim foundRange As Range</code>."}, {"owner": {"reputation": 3, "user_id": 11124133, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f8LNv3Lqjqk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffxLzVXubp4z1ib8t5kbNteic85A/mo/photo.jpg?sz=128", "display_name": "Karlage", "link": "https://stackoverflow.com/users/11124133/karlage"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563385892, "post_id": 57081526, "comment_id": 100686166, "body": "ah, i&#39;ll try that now"}, {"owner": {"reputation": 3, "user_id": 11124133, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f8LNv3Lqjqk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffxLzVXubp4z1ib8t5kbNteic85A/mo/photo.jpg?sz=128", "display_name": "Karlage", "link": "https://stackoverflow.com/users/11124133/karlage"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563386140, "post_id": 57081526, "comment_id": 100686279, "body": "That&#39;s great. thanks loads for that"}], "owner": {"reputation": 3, "user_id": 11124133, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f8LNv3Lqjqk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffxLzVXubp4z1ib8t5kbNteic85A/mo/photo.jpg?sz=128", "display_name": "Karlage", "link": "https://stackoverflow.com/users/11124133/karlage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563385388, "creation_date": 1563385247, "last_edit_date": 1563385388, "question_id": 57081526, "link": "https://stackoverflow.com/questions/57081526/how-do-i-handle-it-when-i-cant-find-a-variable", "title": "How do i handle it when i can&#39;t find a variable", "body": "<p>I've written some code with the intention that on the worksheet \"main\" it will cycle through the rows,taking the value from the cell in column C (Reg) and then moving to the relevant tab depending on the beginning letter of the corresponding cell in column B. however sometimes (Reg) doesn't exist on any other tab and I can't work out how to handle it when it can't find (reg) in any of the other corresponding tabs.</p>\n\n<p>I've tried to use on error goto next but that just ends up causing issues further into the Loop when it's pulling back values from cells that I didn't intend for it to look at. My VB is basic really so I'm not sure of how I could be dealing with this better as there is a lot of .select in my code and I've been told I shouldn't use that.</p>\n\n<pre><code>Sub comments_chase()\n\nDim comment, chase As String\nDim Reg As String\nDim reg_add As String\nDim Foundrange As String\n\n\n\nApplication.ScreenUpdating = False\n\n\n\n    Workbooks(\"Progression chases.xlsm\").Activate\n\n    Worksheets(\"main\").Activate\n\n\n\n    Range(\"C4\").Select\n\n\n\n    Do Until ActiveCell.Value = \"\"\n\n    reg_add = ActiveCell.Address\n\n    Reg = ActiveCell.Value\n\n    ActiveCell.Offset(0, -1).Select\n\n\n\n    On Error GoTo Error_step\n\n\n\n    If Left(ActiveCell.Value, 1) = \"L\" Or Left(ActiveCell.Value, 1) = \"M\" Or Left(ActiveCell.Value, 1) = \"N\" Or Left(ActiveCell.Value, 1) = \"O\" Or Left(ActiveCell.Value, 1) = \"P\" Or Left(ActiveCell.Value, 1) = \"Q\" Then\n\n    Worksheets(\"Adie\").Activate\n\n    Set Foundrange = Range(\"C:C\").Find(Reg, LookAt:=xlWhole).Select\n\n        If Foundrange Is Nothing Then\n\n        GoTo Error_step\n\n        Else\n\n    ActiveCell.Offset(0, 11).Select\n\n    comment = ActiveCell.Value\n\n    ActiveCell.Offset(0, 1).Select\n\n    chase = ActiveCell.Value\n\n    Workbooks(\"Progression chases.xlsm\").Activate\n\n    Worksheets(\"main\").Activate\n\n    Range(\"C:C\").Find(Reg, LookAt:=xlWhole).Select\n\n    ActiveCell.Offset(0, 11).Select\n\n    ActiveCell.Value = comment\n\n    ActiveCell.Offset(0, 1).Select\n\n    ActiveCell.Value = chase\n\n    End If\n\n\n\n    On Error GoTo Error_step\n\n\n\n        ElseIf Left(ActiveCell.Value, 1) = \"A\" Or Left(ActiveCell.Value, 1) = \"B\" Or Left(ActiveCell.Value, 1) = \"C\" Then\n\n        Worksheets(\"Andy\").Activate\n\n    Set Foundrange = Range(\"C:C\").Find(Reg, LookAt:=xlWhole).Select\n\n    If Foundrange Is Nothing Then\n\n    GoTo Error_step\n\n    Else\n\n        ActiveCell.Offset(0, 11).Select\n\n        comment = ActiveCell.Value\n\n        ActiveCell.Offset(0, 1).Select\n\n        chase = ActiveCell.Value\n\n        Workbooks(\"Progression chases.xlsm\").Activate\n\n        Worksheets(\"main\").Activate\n\n        Range(\"C:C\").Find(Reg, LookAt:=xlWhole).Select\n\n        ActiveCell.Offset(0, 11).Select\n\n        ActiveCell.Value = comment\n\n        ActiveCell.Offset(0, 1).Select\n\n        ActiveCell.Value = chase\n\n        End If\n\n\n\nOn Error GoTo Error_step\n\n            ElseIf Left(ActiveCell.Value, 1) = \"D\" Or Left(ActiveCell.Value, 1) = \"E\" Or Left(ActiveCell.Value, 1) = \"F\" Or Left(ActiveCell.Value, 1) = \"G\" Or Left(ActiveCell.Value, 1) = \"H\" Or Left(ActiveCell.Value, 1) = \"J\" Or Left(ActiveCell.Value, 1) = \"K\" Then\n\n            Worksheets(\"Georgia\").Activate\n\n    Set Foundrange = Range(\"C:C\").Find(Reg, LookAt:=xlWhole).Select\n\n    If Foundrange Is Nothing Then\n\n    GoTo Error_step\n\n    Else\n\n            ActiveCell.Offset(0, 11).Select\n\n            comment = ActiveCell.Value\n\n            ActiveCell.Offset(0, 1).Select\n\n            chase = ActiveCell.Value\n\n            Workbooks(\"Progression chases.xlsm\").Activate\n\n            Worksheets(\"main\").Activate\n\n            Range(\"C:C\").Find(Reg, LookAt:=xlWhole).Select\n\n            ActiveCell.Offset(0, 11).Select\n\n            ActiveCell.Value = comment\n\n            ActiveCell.Offset(0, 1).Select\n\n            ActiveCell.Value = chase\n\n            End If\n\n\n\nOn Error GoTo Error_step\n\n                ElseIf Left(ActiveCell.Value, 1) = \"R\" Or Left(ActiveCell.Value, 1) = \"S\" Or Left(ActiveCell.Value, 1) = \"T\" Or Left(ActiveCell.Value, 1) = \"U\" Or Left(ActiveCell.Value, 1) = \"V\" Or Left(ActiveCell.Value, 1) = \"W\" Or Left(ActiveCell.Value, 1) = \"(\" Or Left(ActiveCell.Value, 1) = \"[\" Or Left(ActiveCell.Value, 1) = \"*\" Then\n\n                Worksheets(\"Leona\").Activate\n\n    Range(\"C:C\").Find(Reg, LookAt:=xlWhole).Select\n\n    Foundrange = ActiveCell.Value\n\n    If Foundrange Is Nothing Then\n\n    GoTo Error_step\n\n    Else\n\n                ActiveCell.Offset(0, 11).Select\n\n                comment = ActiveCell.Value\n\n                ActiveCell.Offset(0, 1).Select\n\n                chase = ActiveCell.Value\n\n                Workbooks(\"Progression chases.xlsm\").Activate\n\n                Worksheets(\"main\").Activate\n\n                Range(\"C:C\").Find(Reg, LookAt:=xlWhole).Select\n\n                ActiveCell.Offset(0, 11).Select\n\n                ActiveCell.Value = comment\n\n                ActiveCell.Offset(0, 1).Select\n\n                ActiveCell.Value = chase\n\n\n\n            End If\n\nError_step:  Worksheets(\"main\").Activate\n\n\n\n            Worksheets(\"main\").Activate\n\n           Range(reg_add).Select\n\n           ActiveCell.Offset(1, 0).Select\n\n           End If\n\n\n\n    Loop\n\n\n\nEnd Sub\n</code></pre>\n\n<p>The above code has 2 slightly different attempts to handle it. to show what I've tried</p>\n\n<p>I'm getting runtime error 424 Object required and on debug it's stopping at \"If Foundrange is Nothing Then\"in the block referencing sheet (\"Leona\")</p>\n\n<p>Ideally if it all worked correctly i would have hoped that it found the (Reg) on sheet (\"Leona\") and brought back the values in Comment and Chase and then put them into the relevant cell on sheet (Main)</p>\n\n<p>can anyone help with where I've gone wrong?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 5, "creation_date": 1563385551, "post_id": 57081507, "comment_id": 100686012, "body": "VBA likes its spacing.. Adding spaces around ampersands will allow it to compile. Then heed the answer below."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1563388401, "post_id": 57081507, "comment_id": 100687289, "body": "Without the space, <code>&amp;</code> is interpreted as a <i>type hint</i>, e.g. <code>Debug.Print TypeName(42&amp;)</code> will not output <code>Integer</code> like <code>TypeName(42)</code> would. With the space, it&#39;s the string concatenation operator."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1563386452, "post_id": 57081590, "comment_id": 100686398, "body": "You already use <code>Rows</code>, you can remove the <code>EntireRow</code> and just use <code>Worksheets(&quot;Exhibit&quot;).Rows(start_row &amp; &quot;:&quot; &amp; end_row).Hidden = True</code>"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1563386489, "last_edit_date": 1563386489, "creation_date": 1563385538, "answer_id": 57081590, "question_id": 57081507, "link": "https://stackoverflow.com/questions/57081507/how-do-i-concatenate-a-string-with-double-quotes-and-a-colon-in-vba/57081590#57081590", "title": "How do I concatenate a string with double quotes and a colon in VBA?", "body": "<p>Ditch the opening and closing quotes entirely:</p>\n\n<pre><code>Worksheets(\"Exhibit\").Rows(start_row &amp; \":\" &amp; end_row).Hidden = True\n</code></pre>\n\n<p>And as pointed out by <a href=\"https://stackoverflow.com/users/3076048/mark-balhoff\">@Mark Balhoff</a>, add spaces around the ampersands.</p>\n"}], "owner": {"reputation": 166, "user_id": 7758051, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f48c22e8be301c7245d6343b1d1ca12b?s=128&d=identicon&r=PG&f=1", "display_name": "user7758051", "link": "https://stackoverflow.com/users/7758051/user7758051"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "accepted_answer_id": 57081590, "answer_count": 1, "score": 0, "last_activity_date": 1563431641, "creation_date": 1563385175, "last_edit_date": 1563431641, "question_id": 57081507, "link": "https://stackoverflow.com/questions/57081507/how-do-i-concatenate-a-string-with-double-quotes-and-a-colon-in-vba", "title": "How do I concatenate a string with double quotes and a colon in VBA?", "body": "<p>My macro hides rows depending on variable values (start_row and end_row).</p>\n\n<p>I have this line of code:</p>\n\n<pre><code>Worksheets(\"Exhibit\").Rows(\"\"\"\"&amp;start_row&amp;\":\"&amp;end_row&amp;\"\"\"\").EntireRow.Hidden = True\n</code></pre>\n\n<p>Which for the values start_row = 1 and end_row = 5, I would want it to do the same thing as the following code:</p>\n\n<pre><code>Worksheets(\"Exhibit\").Rows(\"1:5\").EntireRow.Hidden = True\n</code></pre>\n\n<p>I get a \"Compile error: Expected: list separator or )\" which highlights the \":\" portion of the line, though.</p>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["vba", "dynamic", "sum"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1563385173, "post_id": 57081361, "comment_id": 100685849, "body": "You <b><i>really</i></b> need to <a href=\"https://stackoverflow.com/q/10714251/5781745\">avoid using <code>.Select</code></a> in your code. And using <code>ActiveCell</code> is <i>okay</i> if your actually have a legitimate purpose for using the ActiveCell, but using because you had VBA select it is just... not good."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1563385514, "post_id": 57081361, "comment_id": 100685998, "body": "So let me see if I am understanding exactly what you are wanting to do. You would like to first sum up the entire column F (excluding rows 1-2), sum up G, and then subtract them? Also, what&#39;s the purpose of adding the formula <code>=SUM(...)</code> to the worksheet - do you require this or was this just to help you store your variable?"}, {"owner": {"reputation": 1, "user_id": 11798897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-A94a7YLY9fQ/AAAAAAAAAAI/AAAAAAAACaI/3m1NF1Hcqlg/photo.jpg?sz=128", "display_name": "Paula Yankova", "link": "https://stackoverflow.com/users/11798897/paula-yankova"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1563391204, "post_id": 57081361, "comment_id": 100688535, "body": "Hello K. Davis,"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1563391772, "post_id": 57081361, "comment_id": 100688778, "body": "Hello, if you can answer my questions in my 2nd comment I would be happy to assist, and also fix the issues in the first comment in the process. Do you require the formula to be present on the sheet or were you just using it to store a value for your code?"}, {"owner": {"reputation": 1, "user_id": 11798897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-A94a7YLY9fQ/AAAAAAAAAAI/AAAAAAAACaI/3m1NF1Hcqlg/photo.jpg?sz=128", "display_name": "Paula Yankova", "link": "https://stackoverflow.com/users/11798897/paula-yankova"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1563392352, "post_id": 57081361, "comment_id": 100689029, "body": "Hello K. Davis, Thank you for your reply. What I have is these 2columns, Since the data is imported the columns are dynamic, but I always need this result.  col F     G 50 \t  62.5 50\t  100 50\t  100 50\t  0 250  \t0 500\t  1000 50  \t100 =SUM(F89:F95)\t=SUM(G89:G95) =F96-G96\t I&quot;m trying to recreate the same process with VBA. since I don&#39;t want the formulas to be visible for the user, therefore recording a macro doesn&#39;t really work for me. These are my first steps in independent VBA coding, and i would really appreciate the advice even for future reference :). Thanks again"}, {"owner": {"reputation": 1, "user_id": 11798897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-A94a7YLY9fQ/AAAAAAAAAAI/AAAAAAAACaI/3m1NF1Hcqlg/photo.jpg?sz=128", "display_name": "Paula Yankova", "link": "https://stackoverflow.com/users/11798897/paula-yankova"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1563392666, "post_id": 57081361, "comment_id": 100689161, "body": "not sure if the reply is clear: column F &amp; G have 7 values each"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1563392949, "post_id": 57081361, "comment_id": 100689291, "body": "Is all of this contained on the same worksheet? So the two columns you are adding and the end result? Or are the columns on a different sheet than the result? I see your result is supposed to go to <code>Worksheets(1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11798897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-A94a7YLY9fQ/AAAAAAAAAAI/AAAAAAAACaI/3m1NF1Hcqlg/photo.jpg?sz=128", "display_name": "Paula Yankova", "link": "https://stackoverflow.com/users/11798897/paula-yankova"}, "edited": false, "score": 0, "creation_date": 1563397540, "post_id": 57083483, "comment_id": 100691162, "body": "To answer your question - no, the result will be directed to another worksheet. Thanks a lot for your solution, i will try the first thing tomorrow \ud83d\ude0a"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1563394505, "creation_date": 1563394505, "answer_id": 57083483, "question_id": 57081361, "link": "https://stackoverflow.com/questions/57081361/how-to-subtract-the-sum-of-2-or-more-dynamic-columns-in-vba/57083483#57083483", "title": "How to subtract the sum of 2 or more dynamic columns in VBA?", "body": "<p>It is recommended that you avoid using <code>.Select</code> in your code. There may be a few edge cases where you may need to use it, but the average VBA user will likely never have to encounter a single instance where they'd have to use <code>.Select</code> in their lifetime.</p>\n\n<p>First, we want to set the worksheet to a variable that contains the columns we are going to be looking at. Then we want to assign two separate ranges - one for the <code>F</code> column and one for <code>G</code>. It's easier to manage your ranges this way, and generally makes the code cleaner and easier to read.</p>\n\n<p>Then sum the ranges to their own variables, and the end result would be subtracting them.</p>\n\n<pre><code>Sub TestSum()\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(1)\n\n    Dim RngF As Range, RngG As Range\n    Set RngF = ws.Range(ws.Range(\"F3\"), ws.Cells(lastRow(ws, \"F\"), \"F\"))\n    Set RngG = ws.Range(ws.Range(\"G3\"), ws.Cells(lastRow(ws, \"G\"), \"G\"))\n\n    Dim SumF As Long, SumG As Long\n    SumF = Application.WorksheetFunction.Sum(RngF)\n    SumG = Application.WorksheetFunction.Sum(RngG)\n\n    ws.Range(\"G1\").Value = SumF - SumG\n\nEnd Sub\n\nFunction lastRow(ByVal ws As Worksheet, Optional ByVal col As Variant = 1) As Long\n    lastRow = ws.Cells(ws.Rows.Count, col).End(xlUp).Row\nEnd Function\n</code></pre>\n\n<p>However, you can create your own <em>custom formula</em> - better known as a UDF (<em><strong>U</strong>ser <strong>D</strong>efined <strong>F</strong>unction</em>). I understand you do not want the users to see the <em>original formula</em>, but I am not sure how you feel about one that hides everything and you simply only see the name.</p>\n\n<p>Everything will be the same as above - except instead of having the Sub apply the value to the worksheet, you will assign the value to the function itself.</p>\n\n<pre><code>Function getSum() As Long\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(1)\n\n    Dim RngF As Range, RngG As Range\n    Set RngF = ws.Range(ws.Range(\"F3\"), ws.Cells(lastRow(ws, \"F\"), \"F\"))\n    Set RngG = ws.Range(ws.Range(\"G3\"), ws.Cells(lastRow(ws, \"G\"), \"G\"))\n\n    Dim SumF As Long, SumG As Long\n    SumF = Application.WorksheetFunction.Sum(RngF)\n    SumG = Application.WorksheetFunction.Sum(RngG)\n\n    getSum = SumF - SumG\n\nEnd Function\n\nFunction lastRow(ByVal ws As Worksheet, Optional ByVal col As Variant = 1) As Long\n    lastRow = ws.Cells(ws.Rows.Count, col).End(xlUp).Row\nEnd Function\n</code></pre>\n\n<p>Then on your worksheet in <code>G1</code>, you would type the following formula:</p>\n\n<pre><code>=getSum()\n</code></pre>\n\n<p>The benefit of this method is that if a value changes in either column, this would automatically update without any additional intervention.</p>\n"}], "owner": {"reputation": 1, "user_id": 11798897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-A94a7YLY9fQ/AAAAAAAAAAI/AAAAAAAACaI/3m1NF1Hcqlg/photo.jpg?sz=128", "display_name": "Paula Yankova", "link": "https://stackoverflow.com/users/11798897/paula-yankova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 652, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563394505, "creation_date": 1563384606, "last_edit_date": 1563384907, "question_id": 57081361, "link": "https://stackoverflow.com/questions/57081361/how-to-subtract-the-sum-of-2-or-more-dynamic-columns-in-vba", "title": "How to subtract the sum of 2 or more dynamic columns in VBA?", "body": "<p>Could you help me with the solution to this issue, I'm a beginner?:</p>\n\n<p>2 dynamic columns \"F:G\", I need to sum each column and then subtract the result without using Macro recording- (I do not wish the user to view the formula)</p>\n\n<p>I've tried the below code, but it doesn't return the result of subtracting column F-G, it returns the subtraction of the last cell on the last row. </p>\n\n<pre><code>Sub testsum()\n    Dim B As Integer\n    Dim W As Integer\n    Dim LastCell As String\n\n    ActiveSheet.Select\n    Range(\"F3\").Select\n         Selection.End(xlDown).Select\n         LastCell = ActiveCell.Address(False, False)\n         ActiveCell.Offset(1, 0).Select\n         ActiveCell.Value = \"=sum(f3:\" &amp; LastCell &amp; \")\"\n\n    Range(\"G3\").Select\n         Selection.End(xlDown).Select\n         LastCell = ActiveCell.Address(False, False)\n         ActiveCell.Offset(1, 0).Select\n         ActiveCell.Value = \"=sum(G3:\" &amp; LastCell &amp; \")\"\n\n    Worksheets(1).Range(\"G1\").Value = B - W\n\nEnd Sub\n</code></pre>\n\n<p>I wish to recreate the result of <code>=Sum(F:F)-Sum(G:G)</code> on a different Worksheet.</p>\n"}, {"tags": ["excel", "vba", "find"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1563386457, "post_id": 57081172, "comment_id": 100686405, "body": "Not really sure what you&#39;re asking. Your code sample doesn&#39;t seem to relate to the comparisons you mention. Is the issue to do with the Lookin parameter? Think we need an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563393129, "post_id": 57081172, "comment_id": 100689384, "body": "Would not hurt to be more consistent with your use of <code>CurrentFile</code> to qualify <code>Sheets(SheetName)</code>  If you have multiple workbooks open that could potentially cause problems.  <code>LookIn</code> should definitely be xlValues - changing that to <code>xlFormulas</code> to get it to &quot;work&quot; is leading you away from the root cause of the problem."}], "owner": {"reputation": 25, "user_id": 6287116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c262b8261cd96eb7bcab3c6811ead718?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/6287116/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563431634, "creation_date": 1563383868, "last_edit_date": 1563431634, "question_id": 57081172, "link": "https://stackoverflow.com/questions/57081172/range-find-method-giving-inconsistent-results", "title": "Range.Find method giving inconsistent results", "body": "<p>I've developed a routine that loops through workbooks/worksheets, finds a maximum value in a column, writes a corresponding cell's value to the main workbook, and repeats. Within this routine is a line of code that uses the Range.Find method to set the location of the maximum value in the column. I have been encountering issues with several of the sheets returning errors, which for the time being are being handled by simply writing \"Error\" to the cell \"BreakVoltCell\" in the main workbook. The errors occur seemingly at random, sometimes working for one sheet in a workbook and failing for the next, however it's the same sheets on each run so I believe there's a reason. The code is as follows:</p>\n\n<pre><code>'Get breakdown voltage\nDim rngSlope As Range\nSet rngSlope = CurrentFile.Sheets(SheetName).Range(\"E2:E\" &amp; _ \nSheets(SheetName).Cells.SpecialCells(xlCellTypeLastCell).Row)\n\nDim BreakVoltSlope As Double\nBreakVoltSlope = WorksheetFunction.Max(rngSlope)\n\nDim BreakVoltLoc As Range\nSet BreakVoltLoc = rngSlope.Find(BreakVoltSlope, Sheets(SheetName).Range(\"E2\"), _ \nxlFormulas, xlPart, xlByRows, xlNext, False, False, False)\n\nDim BreakVolt As Double\nBreakVolt = BreakVoltLoc.Offset(0, -3).Value\nBreakVoltCell.Value = BreakVolt\nSet BreakVoltCell = BreakVoltCell.Offset(1, 0)\n</code></pre>\n\n<p>Through basic debugging and using some line number specifications and error line outputs I've confirmed that it is the find method that is failing to return a range. I've read on several forums that specifying all parameters for the method can alleviate this as many parameters can get changed during runtime and will be reused in their changed state on the next loop. However after trying this the error persists, while changing these parameters I also thought it was strange that using xlFormulas for the LookIn parameter worked while xlValues did not (returned errors for all sheets instead of only some). To debug further I put a breakpoint in the error handler and used the immediate window to test the logical equivalency between the variable holding the max value \"BreakVoltSlope\" and the cell in the test range where I knew the maximum value was. The test between BreakVoltSlope and the cell's formula returned FALSE while the test between BreakVoltSlope and the cell's value returned TRUE, this immediately raised questions since as I mentioned earlier using xlValues in the LookIn parameter failed. What is even more confounding is that afterwards I did the same tests after a sheet that worked properly and found that once again formula comparison returned FALSE and value comparison returned TRUE! </p>\n\n<p>I feel I must be fundamentally misunderstanding how the Find method works, the logical comparisons not only suggest that my code shouldn't work when using xlFormulas as the search region, but they also suggest that it should work when using xlValues which it doesn't. Instead it works for >90% of sheets when using xlFormulas but not all of them. If anyone has a deep understanding of where this inconsistency comes from I'm curious to hear! If I can provide any more detail let me know.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1563387491, "creation_date": 1563387491, "answer_id": 57082064, "question_id": 57081017, "link": "https://stackoverflow.com/questions/57081017/selecting-the-email-that-invoked-a-rule-that-runs-a-vba-script/57082064#57082064", "title": "Selecting the email that invoked a rule that runs a VBA script", "body": "<p>The item which triggered the rule is passed as a parameter:</p>\n\n<pre><code>Public Sub RuleTest(mail as MailItem)\n    MsgBox mail.HTMLBody\nEnd Sub\n</code></pre>\n\n<p>In addition, there are three main ways for working with bodies in Outlook:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow noreferrer\">Body</a>.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow noreferrer\">HTMLBody</a>. </li>\n<li>Word editor. The Inspector class provides the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow noreferrer\">WordEditor</a> property which returns an instance of the Document class from the Word object model which represents the message body. Outlook uses Word as an email editor. </li>\n</ol>\n\n<p>You can read more about that in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow noreferrer\">Chapter 17: Working with Item Bodies</a> .</p>\n"}], "owner": {"reputation": 3, "user_id": 10354961, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KfkxDOt7WTE/AAAAAAAAAAI/AAAAAAAAAJA/Ll0coCMH3U0/photo.jpg?sz=128", "display_name": "xearow", "link": "https://stackoverflow.com/users/10354961/xearow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 57082064, "answer_count": 1, "score": -1, "last_activity_date": 1563387491, "creation_date": 1563383257, "question_id": 57081017, "link": "https://stackoverflow.com/questions/57081017/selecting-the-email-that-invoked-a-rule-that-runs-a-vba-script", "title": "Selecting the email that invoked a rule that runs a VBA script", "body": "<p>I have a rule that runs a VBA script. Within that VBA script i need to get the text from within the body of the email that invoked the rule. How would I go about doing this?</p>\n\n<p>Cant find anywhere that has a way to do this at all really.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1563383038, "post_id": 57080889, "comment_id": 100684881, "body": "What happened when you tried that?"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1563388639, "creation_date": 1563388639, "answer_id": 57082301, "question_id": 57080889, "link": "https://stackoverflow.com/questions/57080889/how-to-store-results-of-loop-if-statement-in-another-worksheet-columns/57082301#57082301", "title": "How to store results of loop If statement in another worksheet columns?", "body": "<p>Perhaps something like:</p>\n\n<pre><code>Sub Michael()\n    Dim v As String, WhichRow As Long\n    Dim cel As Range\n    WhichRow = 1\n\n    For Each cel In Range(\"A4:A85\")\n        v = cel.Value\n        If (v Like \"boston*\" Or v Like \"manfield*\" Or v Like \"barnes*\" Or v Like \"langley*\") And cel.Offset(0, 2).Value Like \"mass*\" Then\n            MsgBox cel.Value &amp; Chr(13) &amp; Chr(10) &amp; cel.Offset(0, 2).Value\n            Sheets(\"results\").Cells(WhichRow, \"A\").Value = cel.Value &amp; Chr(13) &amp; Chr(10) &amp; cel.Offset(0, 2).Value\n            WhichRow = WhichRow + 1\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11644704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f03bac1ea8a654840a9134e01b39f9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Ziegler", "link": "https://stackoverflow.com/users/11644704/michael-ziegler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57082301, "answer_count": 1, "score": 0, "last_activity_date": 1563388639, "creation_date": 1563382696, "question_id": 57080889, "link": "https://stackoverflow.com/questions/57080889/how-to-store-results-of-loop-if-statement-in-another-worksheet-columns", "title": "How to store results of loop If statement in another worksheet columns?", "body": "<p>I need to store the results of my for each If statement in the results worksheet of  the active workbook.</p>\n\n<p>My loop works but I need to be able to store the results in column a and c from the results worksheet</p>\n\n<p>This is the code for the loop</p>\n\n<pre><code>  For Each cel In Range(\"A4:A85\")\n\n            With cel\n\n               If (.Value Like \"boston*\" Or .Value Like \"manfield*\" Or _\n            .Value Like \"barnes*\" Or.Value Like \"langley*\") _\n            And .Offset(0, 2).Value Like \"mass*\" Then\n\n\n\n                 MsgBox cel.Value &amp; Chr(13) &amp; Chr(10) &amp;  cel.Offset(0, \n2).Value\n</code></pre>\n\n<p>I was thinking about something like this </p>\n\n<pre><code> Pseudocode: worksheets worksheetname column.value = cel.value and \ncell.offset(0,2).value =cell.offset(0,2).value\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563384992, "post_id": 57080799, "comment_id": 100685752, "body": "1) Avoid using <code>GoTo</code> - that creates spaghetti code. 2) You&#39;re probably looking for <code>Range.SpecialCells(xlCellTypeVisible)</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563385054, "post_id": 57080799, "comment_id": 100685792, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39121960/copy-filtered-data-to-another-sheet-using-vba\">Copy filtered data to another sheet using VBA</a>"}, {"owner": {"reputation": 11, "user_id": 10722930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-swnCNK4jCDE/AAAAAAAAAAI/AAAAAAAADZY/FdSUz8danm0/photo.jpg?sz=128", "display_name": "Imtiazul Haque", "link": "https://stackoverflow.com/users/10722930/imtiazul-haque"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563392341, "post_id": 57080799, "comment_id": 100689025, "body": "BigBen, I have done that as you can see I have commented it out. The problem with that one is it skips some of the rows below the header for some reason!!! It works if the 2nd row is visible below the header then no issue but if let&#39;s say 1665th row is visible below the header after filtering, then it captures a random range."}], "owner": {"reputation": 11, "user_id": 10722930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-swnCNK4jCDE/AAAAAAAAAAI/AAAAAAAADZY/FdSUz8danm0/photo.jpg?sz=128", "display_name": "Imtiazul Haque", "link": "https://stackoverflow.com/users/10722930/imtiazul-haque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563431620, "creation_date": 1563382266, "last_edit_date": 1563431620, "question_id": 57080799, "link": "https://stackoverflow.com/questions/57080799/filtered-dataset-not-getting-pasted-in-the-destination-sheet-properly", "title": "Filtered dataset not getting pasted in the destination sheet properly", "body": "<p>I am trying to paste my filtered dataset to different sheets(already created) based on the filter criteria. Each destination sheet has appropriate header information in a table so I will just paste the filtered dataset in those sheets. The issue I am facing is whenever I paste the filtered dataset from the stored range variable, it's pasting everything(both filtered data and unfiltered data). Since my destination sheet has table in it, to avoid duplicate data or unwanted data, I first clear the table and then paste my filtered data. But every single time I paste data, it dumps everything instead of just the filtered dataset. Any idea why this might be happening?</p>\n\n<p>I have tried filtering in a different method but irrespective of what filtering criteria I use, excel keeps populating my destination table with all the data from the raw sheet.</p>\n\n<pre><code>Sub Formulae()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\nApplication.DisplayAlerts = False\n\n\nDim StartTime As Double\nDim MinutesElapsed As String\nDim wb As Workbook\nDim sh_raw As Worksheet\nDim sh_cart As Worksheet\nDim myarr As Variant\nDim r1 As Range\nDim r2 As Range\nDim Rng As Range\nDim xWs As Worksheet\n\n'Remember time when macro starts\n  StartTime = Timer\n\nSet wb = ThisWorkbook\n\nSet sh_cart = wb.Sheets(\"Cart Information\")\n\n''Checking if the Raw_Data sheet exists or not. If not exists, then MACRO aborts and prompts the user to run the import macro first.\n\nFor Each sh In Worksheets\nIf sh.Name Like \"Raw*\" Then flg = True: Exit For\nNext\nIf flg = True Then\nGoTo Start:\nElse\nMsgBox \"No Raw Data Sheet exists!!! Please run the 'Import' Macro First.\"\nGoTo ResetSettings:\nEnd If\n\nStart:\n\nSet sh_raw = wb.Sheets(\"Raw_Data\") 'My source data resides in this raw datasheet\n\nWith sh_raw\n    .Range(\"G1\").Value = \"Section\"\n    .Range(\"G2\").Formula = \"=VLOOKUP([@[IP_Address]],Cart_Information,6,0)\"\n    '.Range(\"E2\", Range(\"E2\").End(xlDown)).NumberFormat = \"m/d/yyyy\"\n    .Cells.Columns.AutoFit\nEnd With\n\n'sh_raw.Cells.AutoFit\n\n'Here I will filter the raw data set based on the section list in another sheet\nsh_cart.Activate\nSet Rng = Range(\"H1\", Range(\"H1\").End(xlDown)) 'Setting the criteria list inside a range\n\nmyarr = Application.WorksheetFunction.Transpose(Rng) 'Storing the range in an array by transposing the list\n\n'Now I\"ll filter the base table according to my filter list\nFor Each item In myarr\n    sh_raw.Activate\n    'Debug.Print item\n\n    '''I wanna copy only the visible range below the header from the filtered raw data set\n    sh_raw.ListObjects(\"ELMS\").Range.AutoFilter Field:=7, Criteria1:=item\n    'Set r2 = sh_raw.ListObjects(\"ELMS\").AutoFilter.Range.SpecialCells(xlCellTypeVisible).Areas(2)(1, 1)\n    'Set r2 = Range(r2, r2.End(xlToRight))\n    'Set r2 = Range(r2, r2.End(xlDown))\n\n    Set r1 = sh_raw.ListObjects(\"ELMS\").AutoFilter.Range\n    Set r2 = Intersect(r1.Offset(1, 0), r1) 'storing the filtered range without the header in r2 range variable\n\n    '''Looping through each template sheets which are named after the filter criteria list\n    For Each xWs In Application.ActiveWorkbook.Worksheets\n        If xWs.Name = item Then\n        xWs.Activate\n\n            With xWs\n                '.Range(\"A1:Q1\").AutoFilter\n                .Range(\"A2:Q2\", Range(\"A2:Q2\").End(xlDown)).ClearContents 'Clearing the table first in case there is data from previous run\n                '.Range(\"A2\").Select\n                '.Range(\"A2:Q2\", Range(\"A2:Q2\").End(xlDown)).Delete\n            End With\n        r2.Copy Destination:=ActiveSheet.Range(\"A2\") 'Now pasting the stored data in the template table\n\n        ''Also I'm pasting all the required formulae in the sheet for making a pivot table &amp; chart based on the filtered dataset\n            With xWs\n                    .Range(\"E2\", Range(\"E2\").End(xlDown)).NumberFormat = \"m/d/yyyy\"\n                    .Range(\"H2\").Formula = \"=INT(E2)\" 'since this is a table, the formula gets autofilled throughout the cells\n                    '.Range(\"H2\", \"H\" &amp; Cells(Rows.count, 1).End(xlUp).Row).FillDown 'filling the entire column with the formula\n                    .Range(\"I2\").Formula = \"=IF(ISNUMBER(SEARCH(\"\"Hour\"\",B2)),MAX(0,IF(AND(D3=D2,B3=B2),C3-C2,0),),\"\"\"\")\"\n                    '.Range(\"I2\", \"I\" &amp; Cells(Rows.count, 1).End(xlUp).Row).FillDown 'filling the entire column with the formula\n                    .Range(\"J2\").Formula = \"=IF(ISNUMBER(SEARCH(\"\"Hour\"\",B2)),MIN(IF(HOUR($E2)=20,4,IF(HOUR($E2)=0,8,IF(HOUR($E2)=4,12,IF(HOUR($E2)=8,16,0)))),MAX(0,IF(AND(D2=D1,B2=B1),C2-C1,0),)),\"\"\"\")\"\n                    '.Range(\"J2\", \"J\" &amp; Cells(Rows.count, 1).End(xlUp).Row).FillDown 'filling the entire column with the formula\n                    '.Range(\"K2\").Formula = \"=INT(E2)\" 'Dummy formula for now\n                    '.Range(\"K2\", \"K\" &amp; Cells(Rows.count, 1).End(xlUp).Row).FillDown 'filling the entire column with the formula\n                    .Range(\"L2\").FormulaArray = \"=INDEX([Field_Value],MATCH(1,(\"\"Test_Location\"\"=[Field_Name])*([@[IP_Address]]=[IP_Address])*([@[Poll_Date]]=[Poll_Date]),0))\"\n                    '.Range(\"L2\", \"L\" &amp; Cells(Rows.count, 1).End(xlUp).Row).FillDown 'filling the entire column with the formula\n                    .Range(\"K2\").FormulaArray = \"=IF([@Channel]=0,\"\"\"\",INDEX(Cycler_Channel[[1]:[8]],MATCH([@Cycler],Cycler_Channel[Cycler],0),[@Channel]))\" ''Actual formula is used\n                    '.Range(\"K2\", \"K\" &amp; Cells(Rows.count, 1).End(xlUp).Row).FillDown 'filling the entire column with the formula\n                    .Range(\"K2\", Range(\"K2\").End(xlDown)).NumberFormat = 0\n                    .Range(\"M2\").FormulaArray = \"=INDEX([Field_Value],MATCH(1,(\"\"TC_IPaddress\"\"=[Field_Name])*([@[IP_Address]]=[IP_Address])*([@[Poll_Date]]=[Poll_Date])*([@Channel]=[Channel]),0))\"\n                    '.Range(\"M2\", \"M\" &amp; Cells(Rows.count, 1).End(xlUp).Row).FillDown 'filling the entire column with the formula\n                    .Range(\"N2\").FormulaArray = \"=INDEX([Field_Value],MATCH(1,(\"\"UUTID\"\"=[Field_Name])*([@[IP_Address]]=[IP_Address])*([@[Poll_Date]]=[Poll_Date])*([@Channel]=[Channel]),0))\"\n                    '.Range(\"N2\", \"N\" &amp; Cells(Rows.count, 1).End(xlUp).Row).FillDown 'filling the entire column with the formula\n                    .Range(\"O2\", Range(\"O2\").End(xlDown)).Value = \"TBD\"\n                    .Range(\"P2\", Range(\"P2\").End(xlDown)).Value = \"TBD\"\n                    .Range(\"Q2\").Formula = \"=VLOOKUP(D2,Cart_Information,5,FALSE)\"\n                    '.Range(\"Q2\", \"Q\" &amp; Cells(Rows.count, 1).End(xlUp).Row).FillDown 'filling the entire column with the formula\n                    .Cells.Columns.AutoFit\n\n            End With\n        End If\n    Next\n\nNext item\n\n'Refreshing the pivot table once pivot tables have been updated with latest data\nDim pt As PivotTable\nDim WS As Worksheet\n\n    For Each WS In ThisWorkbook.Worksheets\n\n        For Each pt In WS.PivotTables\n          pt.RefreshTable\n        Next pt\n\n    Next WS\n\n'Determine how many seconds code took to run\n  MinutesElapsed = Format((Timer - StartTime) / 86400, \"hh:mm:ss\")\n\nMsgBox \"This code ran successfully in \" &amp; MinutesElapsed &amp; \" minutes.\", vbInformation ''Displaying the information for macro execution time\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = False\n\nEnd Sub\n</code></pre>\n\n<p>I expect my code to paste only the filtered data in the destination table but it pastes the whole raw dataset even though I specifically store the filtered dataset in a range variable.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1563381159, "post_id": 57080330, "comment_id": 100684040, "body": "Bit hard to tell - we could do with an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. As an aside, you do realise that <code>rg.Cells(row, 1)</code> is A5 when row=1?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1563381214, "post_id": 57080330, "comment_id": 100684067, "body": "Hm that does mean that whenever you run this code you will overwrite as you are starting the results at A5."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1563381428, "post_id": 57080330, "comment_id": 100684166, "body": "<code>row</code> should be incremented inside the if statement."}, {"owner": {"reputation": 45, "user_id": 11798627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebeec59191ce9b2cc4a646d3c10f2673?s=128&d=identicon&r=PG&f=1", "display_name": "Mike1911", "link": "https://stackoverflow.com/users/11798627/mike1911"}, "edited": false, "score": 0, "creation_date": 1563382490, "post_id": 57080330, "comment_id": 100684656, "body": "SJR, yes I realize that is A5, that column is for the date of inspection, and each row is a different date.  Each worksheet is a different vehicle, but the columns are all the same."}, {"owner": {"reputation": 45, "user_id": 11798627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebeec59191ce9b2cc4a646d3c10f2673?s=128&d=identicon&r=PG&f=1", "display_name": "Mike1911", "link": "https://stackoverflow.com/users/11798627/mike1911"}, "edited": false, "score": 0, "creation_date": 1563382750, "post_id": 57080330, "comment_id": 100684749, "body": "And SJR, yes, I want to overwrite the destination sheet every time it is run, as it is the collection point.  Each inspection is added on an individual vehicle, and I am collecting the mass data on the destination sheet.  If it didn&#39;t overwrite, I would get duplicates of previous inspections on the destination sheet when a new inspection was added."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1563386071, "post_id": 57080330, "comment_id": 100686245, "body": "OK so they&#39;re not the issues. After one loop, <code>row</code> could be as much as 150 so when you come to the next sheet <code>rg.Cells(row, 1)</code> will be outside &quot;A5:VF150&quot;. Think you need to look at something like Cyril&#39;s approach."}, {"owner": {"reputation": 45, "user_id": 11798627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebeec59191ce9b2cc4a646d3c10f2673?s=128&d=identicon&r=PG&f=1", "display_name": "Mike1911", "link": "https://stackoverflow.com/users/11798627/mike1911"}, "edited": false, "score": 0, "creation_date": 1563388906, "post_id": 57080330, "comment_id": 100687501, "body": "@ SJR, I used TinMan&#39;s suggestion to get the first sheet iterating rows properly.  Now the next sheet doesn&#39;t copy over.  I edited my original post to include the new code.  Help please?"}, {"owner": {"reputation": 45, "user_id": 11798627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebeec59191ce9b2cc4a646d3c10f2673?s=128&d=identicon&r=PG&f=1", "display_name": "Mike1911", "link": "https://stackoverflow.com/users/11798627/mike1911"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1563388968, "post_id": 57080330, "comment_id": 100687533, "body": "@TinMan, I used your suggestion, fixed part of the problem.  Please see my edit above and see if you can help with the next step."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1563396357, "post_id": 57080330, "comment_id": 100690776, "body": "@Mike1911 you should break up your code into smaller easier to test subs and functions.  What is the significance of <code>A5:VF150</code>?  Should this be a dynamic range?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11798627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebeec59191ce9b2cc4a646d3c10f2673?s=128&d=identicon&r=PG&f=1", "display_name": "Mike1911", "link": "https://stackoverflow.com/users/11798627/mike1911"}, "edited": false, "score": 0, "creation_date": 1563388682, "post_id": 57080570, "comment_id": 100687415, "body": "I see how that would work if I was trying to copy the entire 150 row range from each worksheet, but right now there are only a couple rows on each worksheet.  Also, the destination sheet requires ordered pairs for the next step in my project.  I am using the two For statements with i and j to filter for occupied rows and columns, and copy specific information over.  How can I put the For and If Not statements into your example?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 45, "user_id": 11798627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebeec59191ce9b2cc4a646d3c10f2673?s=128&d=identicon&r=PG&f=1", "display_name": "Mike1911", "link": "https://stackoverflow.com/users/11798627/mike1911"}, "edited": false, "score": 0, "creation_date": 1563391686, "post_id": 57080570, "comment_id": 100688741, "body": "@Mike1911 I used the <code>.UsedRange.Copy</code> as a general example, though you can do all of your efforts by replacing the <code>If</code>-statement I provided (since you use a Select Case to determine the appropriate sheet names).  When your <code>If Not IsEmpty(rg.Cells(row, 1)) Then</code> is met, then determine the <code>lrd</code> and use <code>lrd+1</code> in your <code>.value=.value</code> statements.  Will make a quick edit to my answer to give a better idea about what I mean."}, {"owner": {"reputation": 45, "user_id": 11798627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebeec59191ce9b2cc4a646d3c10f2673?s=128&d=identicon&r=PG&f=1", "display_name": "Mike1911", "link": "https://stackoverflow.com/users/11798627/mike1911"}, "edited": false, "score": 0, "creation_date": 1563395449, "post_id": 57080570, "comment_id": 100690423, "body": "well, that did....something. I do have all data now... but each row has two completely blank rows between them, and every third row has a 1 in column A (I intended to leave a 1 in column A for each occupied row to use the lrd) down to row 1502, with the second sheet&#39;s data on rows 455 and 458."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 45, "user_id": 11798627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebeec59191ce9b2cc4a646d3c10f2673?s=128&d=identicon&r=PG&f=1", "display_name": "Mike1911", "link": "https://stackoverflow.com/users/11798627/mike1911"}, "edited": false, "score": 0, "creation_date": 1563395688, "post_id": 57080570, "comment_id": 100690521, "body": "@Mike1911 2 blanks per, and you&#39;re not using a step function or anything... my only guess is <code>If Not IsEmpty(rg.Cells(row, 1)) Then</code> is throwing a True and causing values to start.  What is how those rows are completely blank, even no &quot;1&quot; in column A..."}, {"owner": {"reputation": 45, "user_id": 11798627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebeec59191ce9b2cc4a646d3c10f2673?s=128&d=identicon&r=PG&f=1", "display_name": "Mike1911", "link": "https://stackoverflow.com/users/11798627/mike1911"}, "edited": false, "score": 0, "creation_date": 1563397814, "post_id": 57080570, "comment_id": 100691284, "body": "I replaced the row in  <code>If Not IsEmpty(rg.Cells(row, 1)) Then</code> with i, this stopped excel from copying the column A 1s through the entire 1500 row range, all of the data follows one after the other.  I still have two blank rows between each row... but I think I can live with that.  Thanks for your help"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1563391947, "last_edit_date": 1563391947, "creation_date": 1563381244, "answer_id": 57080570, "question_id": 57080330, "link": "https://stackoverflow.com/questions/57080330/how-to-write-to-next-row-on-destination-worksheet-when-looping-through-multiple/57080570#57080570", "title": "How to write to next row on destination worksheet when looping through multiple sheets", "body": "<p>You will want to determine last row on the destinatino sheet each time you paste, similar to:</p>\n\n<pre><code>Dim dest As Worksheet, ws As Worksheet, lrd As Long\nSet dest = Worksheets(\"Dest\")\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Dest\" Then\n        ws.UsedRange.Copy\n        lrd = dest.Cells(dest.Rows.Count, 1).End(xlUp).Row 'LAST ROW DEST\n        dest.Cells(lrd + 1, 1).PasteSpecial xlValues\n    End If\nNext ws\n</code></pre>\n\n<hr>\n\n<p><strong>Edit1:</strong></p>\n\n<p>Used the above as a quick example to indicate that you want to find the lrd (last row destination) before you assign a destination.  Here is something using your code:</p>\n\n<pre><code>For i = 1 To 150 'CYRIL COMMENT:  True Case row loop\n    If Not IsEmpty(rg.Cells(row, 1)) Then\n        lrd = rgdataWks.Cells(rgdataWks.Rows.Count,1).End(xlUp).Row 'ADDED, may need to change col A reference\n        For j = 1 To 72 'CYRIL COMMENT:  True Case column loop\n            If Not IsEmpty(rg.Cells(i, ((j * 4) + 1))) Then\n                rgdataWks.Cells(lrd+1, (j * 4)).Value2 = rg.Cells(i, ((j * 4)  + 1)).Value2\n                rgdataWks.Cells(lrd+1, ((j * 4) + 1)).Value2 = rg.Cells(i, 1).Value2\n                rgdataWks.Cells(lrd+1, ((j * 4) + 1)).NumberFormat = \"dd mmm yy\"\n                rgdataWks.Cells(lrd+1, ((j * 4) + 2)).Value2 = rg.Cells(i, 3).Value2\n                rgdataWks.Cells(lrd+1, ((j * 4) + 3)).Value2 = rg.Cells(i, ((j * 4) + 3)).Value2\n            End If\n        Next j\n        rgdataWks.Cells(lrd+1, 1).Value2 = 1\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1563397390, "creation_date": 1563397390, "answer_id": 57084036, "question_id": 57080330, "link": "https://stackoverflow.com/questions/57080330/how-to-write-to-next-row-on-destination-worksheet-when-looping-through-multiple/57084036#57084036", "title": "How to write to next row on destination worksheet when looping through multiple sheets", "body": "<p>You should break you code up into smaller units.  The fewer tasks that a subroutine performs the easier it is to read, modify, and debug.  </p>\n\n<p>Notice that the my code allows you to test adding a row to PMD COLLECTION without having to iterate of the data in multiple worksheets:</p>\n\n<blockquote>\n<pre><code>AppendPMDRow \"testing\", 1, 2, 3\n</code></pre>\n</blockquote>\n\n<p>You can also test that a single worksheet without having to iterate over all the worksheets:</p>\n\n<blockquote>\n<pre><code>  ProcessTrackerWorksheet Worksheets(\"TestData\")\n</code></pre>\n</blockquote>\n\n<h2>Sample Code</h2>\n\n<pre><code>Sub Update_Model()\n   Application.ScreenUpdating = False\n   Dim ws As Worksheet\n    For Each ws In Worksheets\n        Select Case UCase(ws.Name)\n            Case \"FLEET STATUS\", \"CRACK THRESHOLDS\", \"PMD COLLECTION\", \"CALCULATIONS\"\n\n            Case Else\n                ProcessTrackerWorksheet ws\n        End Select\n    Next ws\nEnd Sub\n\nSub ProcessTrackerWorksheet(ws As Worksheet)\n    Dim r As Long, c As Long\n    With ws\n        For r = 1 To .Cells(.Rows.Count, 1).End(xlUp).row\n            If Len(.Cells(r, 1).Value) &gt; 0 Then\n                For c = 2 To 72 * 4 Step 4\n                    AppendPMDRow .Cells(r, c).Value, .Cells(r, 1).Value, .Cells(r, 3).Value, .Cells(r, c + 2).Value\n                Next\n            End If\n        Next\n    End With\nEnd Sub\n\nSub AppendPMDRow(ParamArray Values() As Variant)\n    Dim target As Range\n    With Worksheets(\"PMD COLLECTION\")\n       Set target = .Cells(.Rows.Count, 1).End(xlUp).Offset(1)\n       target.Resize(1, UBound(Values)).Value = Values\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11798627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebeec59191ce9b2cc4a646d3c10f2673?s=128&d=identicon&r=PG&f=1", "display_name": "Mike1911", "link": "https://stackoverflow.com/users/11798627/mike1911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 57080570, "answer_count": 2, "score": 1, "last_activity_date": 1563397390, "creation_date": 1563380310, "last_edit_date": 1563388283, "question_id": 57080330, "link": "https://stackoverflow.com/questions/57080330/how-to-write-to-next-row-on-destination-worksheet-when-looping-through-multiple", "title": "How to write to next row on destination worksheet when looping through multiple sheets", "body": "<p>I am trying to write a macro in excel, activated by a button, to copy rows of data from mostly blank worksheets, and need each row to stack beneath the next on the destination worksheet.  Data will be added to these worksheets as more information comes in, and will need to be updated on a regular basis.  However, I can't seem to get more than two rows copied.</p>\n\n<p>I have tried row = row + 1 in what seems like would be the appropriate areas.  I also have tried some \"last row\" solutions found on the internet, without success.  I think the wrinkle is the For loop through i and j in each sheet, but I could just be making a really simple mistake in using others solutions.</p>\n\n<pre><code>Sub Update_Model()\n\n    Dim trackerWks As Worksheet\n    Dim dataWks As Worksheet\n    Dim rg As Range\n    Dim i As Long\n    Dim j As Long\n    Dim rgdataWks As Range\n    Dim row As Long\n\n    Set dataWks = Worksheets(\"PMD COLLECTION\")\n    Set rgdataWks = dataWks.Range(\"A3:VD1500\")\n\n    Dim ws As Worksheet\n    For Each ws In Worksheets\n    Select Case UCase(ws.Name)\n    Case \"FLEET STATUS\", \"CRACK THRESHOLDS\", \"PMD COLLECTION\", \"CALCULATIONS\"\n    ' do nothing\n    Case Else\n\n    row = row + 1\n    Set trackerWks = Worksheets(ws.Name)\n    Set rg = ws.Range(\"A5:VF150\")\n\n    For i = 1 To 150\n        If Not IsEmpty(rg.Cells(row, 1)) Then\n            For j = 1 To 72\n                If Not IsEmpty(rg.Cells(i, ((j * 4) + 1))) Then\n                rgdataWks.Cells(row, (j * 4)).Value2 = rg.Cells(i, ((j * 4)  + 1)).Value2\n                rgdataWks.Cells(row, ((j * 4) + 1)).Value2 = rg.Cells(i, 1).Value2\n                rgdataWks.Cells(row, ((j * 4) + 1)).NumberFormat = \"dd mmm yy\"\n                rgdataWks.Cells(row, ((j * 4) + 2)).Value2 = rg.Cells(i, 3).Value2\n                rgdataWks.Cells(row, ((j * 4) + 3)).Value2 = rg.Cells(i, ((j * 4) + 3)).Value2\n                End If\n            Next j\n        rgdataWks.Cells(row, 1).Value2 = 1\n        End If\n    row = row + 1\n    Next i\n\n    End Select\n\n    Next\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>I would expect this to write to a new row after every j and in between every worksheet.  Instead, it writes the first two lines of the first worksheet, and nothing more.\nI know the worksheet loop works, because if I remove the \"row = row + 1\" statements, only one line appears, which is the last line of the last worksheet.</p>\n\n<p>EDIT-------------------------------------------------------</p>\n\n<p>After using tinman's suggestion to iterate the row inside the If statement, I got all of the first worksheet onto the destination page.  However, the next worksheet doesn't copy over.  Does anyone have advice on how to get the next worksheet moving?</p>\n\n<p>Here is my Minimum Reproducible Example... I think.  I'm new, so if you need more or less, let me know.</p>\n\n<pre><code>    Dim ws As Worksheet\n    For Each ws In Worksheets\n        Select Case UCase(ws.Name)\n            Case \"...\"\n            Case Else\n                Set trackerWks = Worksheets(ws.Name)\n                Set rg = ws.Range(\"A5:VF150\")\n                    For i = 1 To 150\n                        row = row + 1\n                        If Not IsEmpty(rg.Cells(row, 1)) Then\n                            For j = 1 To 72\n                                If Not IsEmpty(rg.Cells(i, ((j * 4) + 1))) Then\n                                    ...\n                                    ...\n                                End If\n                            Next j\n                        End If\n                    Next i  \n        End Select\n    Next ws   \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "object"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563382794, "post_id": 57080163, "comment_id": 100684781, "body": "The default state of a cell is <code>Locked</code> = True - did you first unlock all the cells you want the use to be able to change?"}, {"owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563383697, "post_id": 57080163, "comment_id": 100685189, "body": "I believe so.  Both work very well in their own workbook.  No problems.  What I didn&#39;t add is that neither work when combined into the same so I don&#39;t believe that to be the issue."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563384048, "post_id": 57080163, "comment_id": 100685359, "body": "There&#39;s nothing in the <code>BeforeDoubleClick</code> event handler which would impact how your other two event handlers function, so it seems more like there&#39;s some other difference between the working/not working sheets."}, {"owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563397748, "post_id": 57080163, "comment_id": 100691256, "body": "Okay.  I appreciate the input.  All other macros work correctly except these two.  They are the only coding within Objects for the Worksheet.  I&#39;ll keep looking and testing."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563399959, "post_id": 57080163, "comment_id": 100691996, "body": "The only thing I&#39;d add is that in your <code>Worksheet_SelectionChange</code> you test for <code>Target.Locked</code> - that test might not return expected results: for example it will return <code>Null</code> if <code>Target</code> is a multi-cell range containing both locked and unlocked cells."}], "owner": {"reputation": 41, "user_id": 10100880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6d34e32ff7961261be61b48246f7f4?s=128&d=identicon&r=PG&f=1", "display_name": "Neuner", "link": "https://stackoverflow.com/users/10100880/neuner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1563427153, "creation_date": 1563379656, "last_edit_date": 1563427153, "question_id": 57080163, "link": "https://stackoverflow.com/questions/57080163/ms-excel-objects-lock-row-based-on-value-working-with-other-object", "title": "MS Excel Objects Lock Row based on Value working with Other Object", "body": "<p>I have programming, with major help from others, that works great for two separate workbooks. The problem is that I can't seem to have them both work within the same workbook and I don't know why.</p>\n\n<p>We have a large contact database (4800 rows) workbook with a lot of sorting macros. I use the following to allow the user to double-click a cell to select or de-select a contact. This is under the Excel Objects, Sheet1 (MASTER):</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    'Limit Target count to 1\n    If Target.Count &gt; 1 Then Exit Sub\n    'Isolate Target to a specific range\n    If Intersect(Target, Range(\"SelectionMaster\")) Is Nothing Then Exit Sub\n    'set Target font tp \"marlett\"\n    Target.Font.Name = \"marlett\"\n    'Check value of target\n    If Target.Value &lt; \"a\" Then\n        Target.Value = \"a\" 'Sets target Value = \"a\"\n        Cancel = True\n        Exit Sub\n    End If\n    If Target.Value = \"a\" Then\n        Target.Value = \"r\"\n        Cancel = True\n        Exit Sub\n    End If\n    If Target.Value = \"r\" Then\n        Target.ClearContents 'Sets Target Value = \"\"\n        Cancel = True\n        Exit Sub\n    End If\n    End Sub\n</code></pre>\n\n<p>In another workbook, I tested the following for locking a particular row if an 'X' is placed in Column AZ (end of contact data). This is under the Excel Objects, Sheet1 (Sheet1):</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim LR As Long\n    If Not Target.Column = 52 Then Exit Sub\n    If Target.Count &gt; 1 Then Exit Sub\n    If UCase(Target.Value) = \"X\" Then\n        ActiveSheet.Unprotect\n        Target.EntireRow.Locked = True\n        ActiveSheet.Protect\n    End If\nEnd Sub\n\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Locked Then\n        If MsgBox(\"Row is locked. Do you want to change the value ?\", vbYesNo) = vbYes Then\n            ActiveSheet.Unprotect\n            Target.EntireRow.Locked = False\n            Cells(ActiveCell.Row, 52).Value = \"\"\n            ActiveSheet.Protect              \n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>In the Database file, I have certain rows that identify the contact's category that I would like to have locked. All other cells can be changed. If I copy over the 2nd code to the database file, it doesn't work correctly. Instead it locks all of the cells and prompts the message box regardless of an 'X' in Column AZ. Can these two not co-exist or what is this newb doing wrong?</p>\n"}, {"tags": ["vba", "ms-access", "file-rename"], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1563411755, "creation_date": 1563411755, "answer_id": 57085760, "question_id": 57080137, "link": "https://stackoverflow.com/questions/57080137/vba-replace-all-files-in-folder-with-todays-date-in-the-middle/57085760#57085760", "title": "VBA Replace all Files in Folder with Today&#39;s Date in the middle", "body": "<p>I think the VBA solution involving <code>fso</code>  and <code>regex</code> will do the required. (Though failed to understand what is meant by recursive.) May add reference (VBA project Window - Tools - Reference) and add \"Microsoft Scripting Runtime\" and \"Microsoft VBScript Regular Expression ...\"</p>\n\n<pre><code>Sub test()\nDim fso As FileSystemObject, fld As Folder, fl As File\nDim Rg As RegExp\nSet fso = CreateObject(\"Scripting.filesystemobject\")\nSet fld = fso.GetFolder(\"C:\\users\\user\\desktop\\Folder1\") ' Modify folder name to your choice\n\nSet Rg = CreateObject(\"VBScript.RegExp\")\n  With Rg\n  .Global = True\n  .Pattern = \"(([\\d]{4}.[\\d]{2}.[\\d]{2}))\"\n\n      For Each fl In fld.Files\n        If .test(fl.Name) Then\n        fl.Name = .Replace(fl.Name, Format(Now, \"yyyy.mm.dd\"))\n        Else\n        Debug.Print fl.Name &amp; \" Not renamed\"\n        End If\n     Next\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6748745, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-H6iY9VY_s6g/AAAAAAAAAAI/AAAAAAAABoI/aVtclW53oT0/photo.jpg?sz=128", "display_name": "Greg Williams", "link": "https://stackoverflow.com/users/6748745/greg-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1563465096, "creation_date": 1563379558, "last_edit_date": 1563465096, "question_id": 57080137, "link": "https://stackoverflow.com/questions/57080137/vba-replace-all-files-in-folder-with-todays-date-in-the-middle", "title": "VBA Replace all Files in Folder with Today&#39;s Date in the middle", "body": "<p>I am looking to utilize a batch file or VBA to replace the date in all files in a folder with today's date.</p>\n\n<p>I have searched here and on other forums and have found the below to be the closest to what I want to achieve but they are doing a unique DateStamp format: <a href=\"https://stackoverflow.com/questions/15523995/renaming-all-files-in-the-folder\">a link</a></p>\n\n<p>Here is the code from that link</p>\n\n<pre><code>var fso = new ActiveXObject(\"Scripting.FileSystemObject\");\nvar folder = fso.GetFolder(\".\");\n\nvar files = new Enumerator(folder.Files);\n\nwhile (!files.atEnd()) {\n    var file = '' + files.item();\n    if (/\\.csv$/i.test(file)) {\n        var dest = file.replace(/_Done[^\\.]+/i, '');\n        if (dest != file) {\n            WSH.Echo('Renaming ' + file + ' -&gt; ' + dest);\n            files.item().Move(dest);\n        }\n    }\n    files.moveNext();\n}\n</code></pre>\n\n<p>Example 1:</p>\n\n<pre><code>PLOG - (Daymon) Raritan - 2018.07.16 - (WB) OTC\n--needs to be --\nPLOG - (Daymon) Raritan - 2019.07.17 - (WB) OTC\n</code></pre>\n\n<p>Example 2: </p>\n\n<pre><code>PLOG - (Flagship+) Ardo - 2019.06.03 - (FRO) Vegetables and Vegetable\n--needs to be--\nPLOG - (Flagship+) Ardo - 2019.07.17 - (FRO) Vegetables and Vegetable\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3496, "user_id": 2961734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f0229603e30b04fddc833d85afc9e0?s=128&d=identicon&r=PG&f=1", "display_name": "Laughing Vergil", "link": "https://stackoverflow.com/users/2961734/laughing-vergil"}, "edited": false, "score": 0, "creation_date": 1563380903, "post_id": 57080083, "comment_id": 100683927, "body": "This is very much like <a href=\"https://stackoverflow.com/questions/19789709/operation-must-use-an-updateable-query-error-in-ms-access\">this previous question</a>, but only one of the answers looks appropriate to me. Try <code>UPDATE DISTINCTROW</code> instead of just <code>UPDATE</code>."}, {"owner": {"reputation": 11, "user_id": 11798615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64dd66d0d805c1d3999aad2833e9712c?s=128&d=identicon&r=PG&f=1", "display_name": "RAP", "link": "https://stackoverflow.com/users/11798615/rap"}, "reply_to_user": {"reputation": 3496, "user_id": 2961734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f0229603e30b04fddc833d85afc9e0?s=128&d=identicon&r=PG&f=1", "display_name": "Laughing Vergil", "link": "https://stackoverflow.com/users/2961734/laughing-vergil"}, "edited": false, "score": 1, "creation_date": 1563381833, "post_id": 57080083, "comment_id": 100684357, "body": "I tried before I posted this."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11798615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64dd66d0d805c1d3999aad2833e9712c?s=128&d=identicon&r=PG&f=1", "display_name": "RAP", "link": "https://stackoverflow.com/users/11798615/rap"}, "edited": false, "score": 0, "creation_date": 1563459007, "post_id": 57083650, "comment_id": 100714311, "body": "I changed the code as recommended, unfortunately the problem persists..."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 11, "user_id": 11798615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64dd66d0d805c1d3999aad2833e9712c?s=128&d=identicon&r=PG&f=1", "display_name": "RAP", "link": "https://stackoverflow.com/users/11798615/rap"}, "edited": false, "score": 0, "creation_date": 1563460608, "post_id": 57083650, "comment_id": 100715309, "body": "It was just an example. Clearly, the search text doesn&#39;t match the actual field text, so double-check the field content."}, {"owner": {"reputation": 11, "user_id": 11798615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64dd66d0d805c1d3999aad2833e9712c?s=128&d=identicon&r=PG&f=1", "display_name": "RAP", "link": "https://stackoverflow.com/users/11798615/rap"}, "edited": false, "score": 0, "creation_date": 1563462718, "post_id": 57083650, "comment_id": 100716631, "body": "If the UPDATE could not find a matching record in the table, it would fail differently."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 11, "user_id": 11798615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64dd66d0d805c1d3999aad2833e9712c?s=128&d=identicon&r=PG&f=1", "display_name": "RAP", "link": "https://stackoverflow.com/users/11798615/rap"}, "edited": false, "score": 0, "creation_date": 1563472391, "post_id": 57083650, "comment_id": 100721489, "body": "Then you probably miss a <i>timestamp</i> field in the table and to relink the table after having added this."}, {"owner": {"reputation": 11, "user_id": 11798615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64dd66d0d805c1d3999aad2833e9712c?s=128&d=identicon&r=PG&f=1", "display_name": "RAP", "link": "https://stackoverflow.com/users/11798615/rap"}, "edited": false, "score": 0, "creation_date": 1563541357, "post_id": 57083650, "comment_id": 100744915, "body": "How did you arrive at the notion that a timestamp field is needed?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 11, "user_id": 11798615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64dd66d0d805c1d3999aad2833e9712c?s=128&d=identicon&r=PG&f=1", "display_name": "RAP", "link": "https://stackoverflow.com/users/11798615/rap"}, "edited": false, "score": 0, "creation_date": 1563548529, "post_id": 57083650, "comment_id": 100748899, "body": "Because that is often the reason for a table being non updatable."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1563395268, "creation_date": 1563395268, "answer_id": 57083650, "question_id": 57080083, "link": "https://stackoverflow.com/questions/57080083/operation-must-use-an-updateable-query-error-in-ms-access/57083650#57083650", "title": "\u201cOperation must use an updateable query\u201d error in MS Access", "body": "<p>As you use nchar(10), you must pass a string of 10 characters, say:</p>\n\n<pre><code>sql_cmd = \"UPDATE tbl_rap SET field_2 = 'X' WHERE field_1 = '010308HB3 '\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11798615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64dd66d0d805c1d3999aad2833e9712c?s=128&d=identicon&r=PG&f=1", "display_name": "RAP", "link": "https://stackoverflow.com/users/11798615/rap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594636043, "creation_date": 1563379356, "last_edit_date": 1594636043, "question_id": 57080083, "link": "https://stackoverflow.com/questions/57080083/operation-must-use-an-updateable-query-error-in-ms-access", "title": "\u201cOperation must use an updateable query\u201d error in MS Access", "body": "<p>This question has been asked many times, my case seems to be the simplest, still I did not find the answer to my question...</p>\n\n<p>The environment is Windows, Access 2013.\nTable tbl_rap is linked, resides on MS SQL Server 2007</p>\n\n<p>Table tbl_rap is constructed as follows:</p>\n\n<pre><code>id - int (Identity)\nfield_1 nchar(10)\nfield_2 nchar(1)\n</code></pre>\n\n<p>The following code works</p>\n\n<pre><code>sql_cmd = \"INSERT INTO tbl_rap (field_1,field_2) VALUES ('010308HB3','R')\"\nDoCmd.RunSQL sql_cmd\n</code></pre>\n\n<p>But this code</p>\n\n<pre><code>sql_cmd = \"UPDATE tbl_rap SET field_2 = 'X' WHERE field_1 = '010308HB3'\"\nDoCmd.RunSQL sql_cmd\n</code></pre>\n\n<p>fails with run-time error 3037 \"Operation must use an updateable query\"</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "selenium"], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1563385292, "post_id": 57081379, "comment_id": 100685894, "body": "I am using Selenium in VBA and I tried .Text and tried Attribute(&quot;value&quot;) and nothing returns the value that the user typed ..I think this is a very good point but how to implement the <code>document.querySelector(&quot;#txtCaptcha&quot;).value</code> to use in the code"}], "tags": [], "owner": {"reputation": 181, "user_id": 4378647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XHb8RaZ1F3Y/AAAAAAAAAAI/AAAAAAAAABQ/jrKs0kBRp5c/photo.jpg?sz=128", "display_name": "Tanuj Vishnoi", "link": "https://stackoverflow.com/users/4378647/tanuj-vishnoi"}, "is_accepted": false, "score": 1, "last_activity_date": 1563384666, "creation_date": 1563384666, "answer_id": 57081379, "question_id": 57079943, "link": "https://stackoverflow.com/questions/57079943/wait-till-captcha-field-filled-with-four-numbers/57081379#57081379", "title": "Wait till Captcha field filled with four numbers", "body": "<p>It must be the element value. try to get innerText or value in the browser console. Use document.querySelector(\"#txtCaptcha\").value or document.querySelector(\"#txtCaptcha\").innerText .</p>\n"}, {"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1563447200, "post_id": 57089286, "comment_id": 100707201, "body": "Thanks  a lot for great help. This works like charm."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1563435177, "creation_date": 1563435177, "answer_id": 57089286, "question_id": 57079943, "link": "https://stackoverflow.com/questions/57079943/wait-till-captcha-field-filled-with-four-numbers/57089286#57089286", "title": "Wait till Captcha field filled with four numbers", "body": "<p>It is in an iframe based on your other questions. Use the iframe <code>src</code> in the <code>.get</code> line. As you are using selenium the appropriate syntax is as shown below. <code>DoEvents</code> allows the user to input values.</p>\n\n<pre><code>Do\n    DoEvents\nLoop While Len(.FindElementById(\"txtCaptcha\").Attribute(\"value\")) &lt; 4\n</code></pre>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 57089286, "answer_count": 2, "score": -1, "last_activity_date": 1563435177, "creation_date": 1563378891, "last_edit_date": 1563382443, "question_id": 57079943, "link": "https://stackoverflow.com/questions/57079943/wait-till-captcha-field-filled-with-four-numbers", "title": "Wait till Captcha field filled with four numbers", "body": "<p>This is not a try to overcome the captcha, I have coded the code so as to let the user type the captcha appears to him in the field of captcha</p>\n\n<p>What I am trying to do but didn't find a way and stuck at it is that I would like to write waiting lines till the field of captcha is filled\nso I tried such lines</p>\n\n<pre><code>Do\n    Application.Wait Now + TimeValue(\"00:00:01\")\n    Loop Until Len(.FindElementById(\"txtCaptcha\").Text) = 4\n</code></pre>\n\n<p>But when debugging I didn't get the text of the element after I have typed some numbers in ..How can I achieve that point?</p>\n\n<p>I have alternative solution is to set a line like that</p>\n\n<pre><code>Application.Wait Now + TimeValue(\"00:00:10\")\n</code></pre>\n\n<p>That will wait for 10 seconds till the user type the numbers but I would like to wait using Do Loop Until ...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1563378394, "post_id": 57079735, "comment_id": 100682500, "body": "There is a limit if you try to union all in one shot, but you can union many more if you build up the range step-by-step"}, {"owner": {"reputation": 2849, "user_id": 619792, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/319beaef8e81a997729d2e4f407e67a4?s=128&d=identicon&r=PG", "display_name": "Phill Healey", "link": "https://stackoverflow.com/users/619792/phill-healey"}, "edited": false, "score": 1, "creation_date": 1563379200, "post_id": 57079735, "comment_id": 100682975, "body": "You really should show what code you have &amp;/or what you&#39;ve tried, regardless of how irrelevant you think it is."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1563378594, "creation_date": 1563378594, "answer_id": 57079840, "question_id": 57079735, "link": "https://stackoverflow.com/questions/57079735/is-there-a-function-that-can-combine-more-than-30-ranges-together-into-one-othe/57079840#57079840", "title": "Is there a function that can combine more than 30 ranges together into one (other than union because I have too many ranges)?", "body": "<p>There is a limit if you try to union all in one shot, but you can union many more if you build up the range step-by-step</p>\n\n<pre><code>Dim a as range, b as range, c as range, d as range, rngAll as range\n\n'...set the ranges a-d\n\nSet rngAll = Application.union(a, b, c, d) '&lt;&lt; limited to 30 ranges\n\n'...but no limit with this incremental method  \nSet rngAll = Application.union(a, b)\nSet rngAll = Application.union(rngAll, c)\nSet rngAll = Application.union(rngAll, d)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11787196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NnhY1_OrBQg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej3pD1Mq70oSoMEhWgu_S_W1JUJA/photo.jpg?sz=128", "display_name": "Claire Spriggs", "link": "https://stackoverflow.com/users/11787196/claire-spriggs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 57079840, "answer_count": 1, "score": -2, "last_activity_date": 1563382274, "creation_date": 1563378224, "last_edit_date": 1563382274, "question_id": 57079735, "link": "https://stackoverflow.com/questions/57079735/is-there-a-function-that-can-combine-more-than-30-ranges-together-into-one-othe", "title": "Is there a function that can combine more than 30 ranges together into one (other than union because I have too many ranges)?", "body": "<p>I would like to select 39 ranges at once normally I have been using the union method on VBA but this only accepts 30 ranges. Does anyone know a way around this?????</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563378581, "post_id": 57079732, "comment_id": 100682609, "body": "why are you using <code>.value  = .value</code> , it&#39;s useless. Remove that line and the code should work fine"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563378729, "post_id": 57079732, "comment_id": 100682696, "body": "And again if in the end you are changing the format to <code>0</code> why to change it in the code to <code>General</code> ??\\"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1563378801, "post_id": 57079732, "comment_id": 100682745, "body": "You need to loop over the cells one-by-one (or at least loop over the <code>Areas</code> in the visible cell range): you cannot use .Value like that except on a single cell or a single-area range.  If you try it on a non-contiguous range you will get unexpected results."}, {"owner": {"reputation": 183, "user_id": 10452645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yr8HioiNN0w/AAAAAAAAAAI/AAAAAAAAABA/t7HjQ8S6l_E/photo.jpg?sz=128", "display_name": "MrZH6", "link": "https://stackoverflow.com/users/10452645/mrzh6"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563431424, "post_id": 57079732, "comment_id": 100698961, "body": "@TimWilliams I was thinking about that worrying it will be slow but it seems to work pretty fast. Even for large range. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1563379175, "creation_date": 1563379175, "answer_id": 57080027, "question_id": 57079732, "link": "https://stackoverflow.com/questions/57079732/vba-excel-text-to-number-format-issue-overwrites-with-wrong-values/57080027#57080027", "title": "VBA-Excel text to number format issue - overwrites with wrong values", "body": "<p>Replace with this...</p>\n\n<pre><code>For each cll in Selection.SpecialCells(xlCellTypeVisible)\n    cll.NumberFormat = \u201cGeneral\u201d\n    cll.Value = cll.Value\nNext cll\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 10452645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yr8HioiNN0w/AAAAAAAAAAI/AAAAAAAAABA/t7HjQ8S6l_E/photo.jpg?sz=128", "display_name": "MrZH6", "link": "https://stackoverflow.com/users/10452645/mrzh6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563382755, "creation_date": 1563378222, "last_edit_date": 1563382755, "question_id": 57079732, "link": "https://stackoverflow.com/questions/57079732/vba-excel-text-to-number-format-issue-overwrites-with-wrong-values", "title": "VBA-Excel text to number format issue - overwrites with wrong values", "body": "<p>I have a code which converts text strings in a selection of cells to values. It works good, until there are some hidden rows in the Selection. Then the values beneath the hidden rows are overwritten with value from the above cell.</p>\n\n<p>Do you have any ideas how to fix the code below?</p>\n\n<pre><code>Sub text_to_values()\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\n    .Calculation = xlCalculationManual\nEnd With\n\nWith Selection.SpecialCells(xlCellTypeVisible)\n    .NumberFormat = \"General\"\n    .Value = .Value\nEnd With\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    .Calculation = xlCalculationAutomatic\nEnd With\n\nSelection.NumberFormat = \"0\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 1676889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0976ef4bdcbfd36179fdf864d36f22f3?s=128&d=identicon&r=PG", "display_name": "eren", "link": "https://stackoverflow.com/users/1676889/eren"}, "reply_to_user": {"reputation": 13, "user_id": 11798419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e493132cc6bbb1832ffc77d6eea5d4b7?s=128&d=identicon&r=PG&f=1", "display_name": "SoMuchCode", "link": "https://stackoverflow.com/users/11798419/somuchcode"}, "edited": false, "score": 0, "creation_date": 1563452123, "post_id": 57092608, "comment_id": 100709869, "body": "You are welcome. You can mark the answer if it solved your problem :)"}], "tags": [], "owner": {"reputation": 458, "user_id": 1676889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0976ef4bdcbfd36179fdf864d36f22f3?s=128&d=identicon&r=PG", "display_name": "eren", "link": "https://stackoverflow.com/users/1676889/eren"}, "is_accepted": true, "score": 1, "last_activity_date": 1563446244, "creation_date": 1563446244, "answer_id": 57092608, "question_id": 57079560, "link": "https://stackoverflow.com/questions/57079560/why-is-my-macros-working-in-a-workbook-but-not-in-personal-xlsb/57092608#57092608", "title": "Why is my macros working in a workbook but not in PERSONAL.XLSB?", "body": "<p>The problem is at row #3 where you are setting the value of variable ws. If you put breakpoint on that line and use your debugger you'll see that the program does not recognize 'Sheet1' or at least not as you want it to (as a instance of Worksheet object) (see the image bellow).</p>\n\n<p><a href=\"https://i.stack.imgur.com/jlhpe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jlhpe.png\" alt=\"enter image description here\"></a></p>\n\n<p>The solution to this depends on what you need. You can simply replace 'Sheet1' with <code>ActiveWorkbook.ActiveSheet</code>, this way the macro will change the content in column AA for active worksheet. See the code below:</p>\n\n<pre><code>Sub Zero()\n    Dim lastRow As Long\n    Dim ws As Worksheet\n    Set ws = ActiveWorkbook.ActiveSheet\n    lastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n         Application.ScreenUpdating = False\n         ws.Range(\"AA16:AA\" &amp; lastRow).FormulaR1C1 = \"0\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11798419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e493132cc6bbb1832ffc77d6eea5d4b7?s=128&d=identicon&r=PG&f=1", "display_name": "SoMuchCode", "link": "https://stackoverflow.com/users/11798419/somuchcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57092608, "answer_count": 1, "score": 1, "last_activity_date": 1563446244, "creation_date": 1563377650, "last_edit_date": 1563427162, "question_id": 57079560, "link": "https://stackoverflow.com/questions/57079560/why-is-my-macros-working-in-a-workbook-but-not-in-personal-xlsb", "title": "Why is my macros working in a workbook but not in PERSONAL.XLSB?", "body": "<p>I have created a macros on a worksheet that sets the cells within a dynamic range to \"0\". It works great. I want this code to be available for use on other worksheets so I added the working code to my PERSONAL.XLSB.  When I copy that same code to PERSONAL.XLSB it does not work. Not even on the original worksheet that it had worked on because I moved the code to Personal.XLSB  </p>\n\n<p>I have other macros in Personal.xlsb that works so I know I'm utilizing my personal macros workbook correctly. </p>\n\n<pre><code>Sub Zero()       \n    Dim lastRow As Long\n    Dim ws As Worksheet\n    Set ws = Sheet1\n    lastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n         Application.ScreenUpdating = False\n         ws.Range(\"AA16:AA\" &amp; lastRow).FormulaR1C1 = \"0\"\nEnd Sub\n</code></pre>\n\n<p>This code causes all of the Cells, starting at AA16 down to the last cell with content to be set to \"0\". Hooray! When this code is copied to Personal.xlsb, it does nothing. </p>\n\n<p>I don't get an error message, just nothing happens.</p>\n"}, {"tags": ["excel", "vba", "switch-statement", "select-case"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1563377852, "post_id": 57079451, "comment_id": 100682155, "body": "See in that linked post that you need to use <code>Select Case True</code>. The result of a <code>Like</code> comparison is a <code>Boolean</code>. That said, you&#39;d need to repeat the <code>.Cells(y, 1).Value2</code>, you can&#39;t string together the right side of <code>Like</code> like you&#39;re trying to."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563377966, "post_id": 57079451, "comment_id": 100682224, "body": "@BigBen - So because the conditions use a <code>wildcard</code> and <code>like</code> I can&#39;t make it a lot shorter?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1563378012, "post_id": 57079451, "comment_id": 100682259, "body": "It&#39;s because the <code>Like</code> comparison returns a <code>Boolean</code>. The wildcard has nothing to do with it."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563378539, "post_id": 57079451, "comment_id": 100682584, "body": "@BigBen - But the wildcard won&#39;t  work without a <code>Like</code>. So, the <code>case statement</code> would need to be just as long as the <code>If statement</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1563378573, "post_id": 57079451, "comment_id": 100682607, "body": "It would be slightly shorter because you&#39;d only have one instance of <code>.Rows(y).Delete shift:=xlShiftUp</code>."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563378637, "post_id": 57079451, "comment_id": 100682637, "body": "@BigBen - Do you mind posting it in an answer so you can get some reputation?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1563378657, "post_id": 57079451, "comment_id": 100682650, "body": "Sure will add as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 1, "last_activity_date": 1563378889, "creation_date": 1563378889, "answer_id": 57079940, "question_id": 57079451, "link": "https://stackoverflow.com/questions/57079451/select-case-with-multiple-like-conditions/57079940#57079940", "title": "Select Case with multiple &quot;Like&quot; conditions", "body": "<p>Use Case True as was pointed out in the comments.</p>\n\n<pre><code>   Select Case True\n        Case .Cells(y, 1).Value2 Like \"* TRUST *\" _\n        Or .Cells(y, 1).Value2 Like \"* AND *\" _\n        Or .Cells(y, 1).Value2 Like \"* &amp; *\" _\n        Or .Cells(y, 1).Value2 Like \"* OF *\" _\n        Or .Cells(y, 1).Value2 Like \"* LLC*\" _\n        Or .Cells(y, 1).Value2 Like \"* REV TR *\" _\n        Or .Cells(y, 1).Value2 Like \"* LV TR *\" _\n        Or .Cells(y, 1).Value2 Like \"* BY *\" _\n        Or .Cells(y, 1).Value2 Like \"*'S *\" _\n        Or .Cells(y, 1).Value2 Like \"C/O*\"\n            .Rows(y).Delete shift:=xlShiftUp\n    End Select\n</code></pre>\n\n<p>An alternative is to write a function to iterate over the conditions:</p>\n\n<pre><code>Function Likes(Value As Variant, ParamArray Conditions() As Variant)\n    Dim Condition\n    For Each Condition In Conditions\n        If Value Like Condition Then\n            Likes = True\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<h2>Usage</h2>\n\n<blockquote>\n<pre><code>If Likes(.Cells(y, 1).Value2, \"* TRUST *\", \"* AND *\", \"* &amp; *\", \"* OF *\", \"* LLC*\", \"* REV TR *\", \"* LV TR *\", \"* BY *\", \"*'S *\", \"C/O*\") Then\n    .Rows(y).Delete shift:=xlShiftUp\nEnd If\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1563379006, "creation_date": 1563379006, "answer_id": 57079984, "question_id": 57079451, "link": "https://stackoverflow.com/questions/57079451/select-case-with-multiple-like-conditions/57079984#57079984", "title": "Select Case with multiple &quot;Like&quot; conditions", "body": "<p>You can't string together the right side of that <code>Like</code> comparison like you're attempting to.</p>\n\n<p>Also, as noted in the linked post, you need to use <code>Select Case True</code>, because the result of a <code>Like</code> comparison is a <code>Boolean</code>.</p>\n\n<p>The <code>Select Case</code> could then look something like this:</p>\n\n<pre><code>Select Case True\n    Case .Cells(y, 1).Value2 Like \"* TRUST *\", _\n         .Cells(y, 1).Value2 Like \"* AND *\", _\n         .Cells(y, 1).Value2 Like \"* &amp; *\", _ \n         '... and so on\n\n        .Rows(y).Delete shift:=xlShiftUp\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 57079984, "answer_count": 2, "score": 0, "last_activity_date": 1563431576, "creation_date": 1563377337, "last_edit_date": 1563431576, "question_id": 57079451, "link": "https://stackoverflow.com/questions/57079451/select-case-with-multiple-like-conditions", "title": "Select Case with multiple &quot;Like&quot; conditions", "body": "<p>I am trying to reduce a large <code>If statement</code> by creating a smaller <code>Case statement</code>.  I am not sure what I am doing wrong, but here is what I have so far.</p>\n\n<p>It is similar to <a href=\"https://stackoverflow.com/questions/18409418/excel-vba-select-case-if-activecell-like-string\">this post</a>, but doesn't address the multiple situations and one result of my issue.</p>\n\n<pre><code>With tempWB.Worksheets(1)\n    rwCnt = .cells(Rows.Count, 1).End(xlup).Row\n    .Rows(rwCnt).Delete shift:=xlShiftUp\n    rwCnt = rwCnt - 1\n\n    For y = rwCnt to 2 step -1\n        'Delete Non-Individuals\n        Select Case .Cells(y, 1).Value2\n            Case (.Cells(y, 1).Value2 Like (\"* TRUST *\" Or \"* AND *\" Or \"* &amp; *\" Or \"* OF *\" Or _\n            \"* LLC*\" Or \"* REV TR *\" Or \"* LV TR *\" Or \"* BY *\" Or \"*'S *\" Or \"C/O*\"))\n                .Rows(y).Delete shift:=xlShiftUp\n        End Select\n    Next y\n\n'        If .Cells(y, 1).Value2 Like \"* TRUST *\" Then\n'            .Rows(y).Delete shift:=xlShiftUp\n'        ElseIf .Cells(y, 1).Value2 Like \"* AND *\" Then\n'            .Rows(y).Delete shift:=xlShiftUp\n'        ElseIf .Cells(y, 1).Value2 Like \"* &amp; *\" Then\n'            .Rows(y).Delete shift:=xlShiftUp\n'        ElseIf .Cells(y, 1).Value2 Like \"* OF *\" Then\n'            .Rows(y).Delete shift:=xlShiftUp\n'        ElseIf .Cells(y, 1).Value2 Like \"* LLC*\" Then\n'            .Rows(y).Delete shift:=xlShiftUp\n'        ElseIf .Cells(y, 1).Value2 Like \"* REV TR *\" Then\n'            .Rows(y).Delete shift:=xlShiftUp\n'        ElseIf .Cells(y, 1).Value2 Like \"* LV TR *\" Then\n'            .Rows(y).Delete shift:=xlShiftUp\n'        ElseIf .Cells(y, 1).Value2 Like \"* BY *\" Then\n'            .Rows(y).Delete shift:=xlShiftUp\n'        ElseIf .Cells(y, 1).Value2 Like \"*'S *\" Then\n'            .Rows(y).Delete shift:=xlShiftUp\n'        ElseIf .Cells(y, 1).Value2 Like \"C/O*\" Then\n'            .Rows(y).Delete shift:=xlShiftUp\n'        End If\n\n\nEnd With\n</code></pre>\n\n<p>Below the <code>Case statement</code> is the <code>If statement</code> that works great, it just looks clunky and I think a <code>Case statement</code> would simplify things a bit.  I'm just not 100% sure how to implement it.  Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1563377594, "post_id": 57079339, "comment_id": 100682028, "body": "Try <code>InsertLines</code> or <code>ReplaceLine</code> instead of <code>AddFromString</code>"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "edited": false, "score": 0, "creation_date": 1563378948, "post_id": 57079591, "comment_id": 100682811, "body": "Brilliant. Thank you."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1563379982, "post_id": 57079591, "comment_id": 100683446, "body": "Note to readers: while this answer addresses OP&#39;s immediate concern with getting the results they&#39;re after, it does not address the blatant misuse of the VBIDE API. <code>i</code> has no business <i>existing</i>, and is being overwritten inside the loop by the <code>.Find</code> method call."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1563380210, "post_id": 57079591, "comment_id": 100683596, "body": "@MathieuGuindon I can&#39;t believe that you would propose such genocide!!  <code>i</code> does have a place in the code just not in a <code>For Loop</code> ;-)."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1563380545, "post_id": 57079591, "comment_id": 100683753, "body": "@MathieuGuindon interesting enough, exiting the <code>For Loop</code> if the search phrase was not found would make the <code>For Loop</code> quite efficient."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1563382105, "post_id": 57079591, "comment_id": 100684490, "body": "Ok, upon further examination, you are absolutely correct. My main issue is one of readability though - it&#39;s not immediately apparent that <code>i</code> is in fact being modified by <code>CodeModule.Find</code>, i.e. you call it with <code>i=1</code> and the <code>ReplaceLine</code> call is made with e.g. <code>i=37</code>. That makes <code>i = i + 1</code> prevent finding any second occurrence of the search string at <code>i</code>. I&#39;d definitely use a much more explicit UDT approach, but this answer isn&#39;t wrong. Upvoted."}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 3, "last_activity_date": 1563380073, "last_edit_date": 1563380073, "creation_date": 1563377742, "answer_id": 57079591, "question_id": 57079339, "link": "https://stackoverflow.com/questions/57079339/finding-and-adding-code-into-a-module-via-a-macro/57079591#57079591", "title": "Finding and adding code into a module via a macro", "body": "<p>Replace the line with a the new text:</p>\n\n<blockquote>\n<pre><code>vb.CodeModule.ReplaceLine i, \"Add This\" &amp; vb.CodeModule.Lines(i, 1)\n</code></pre>\n</blockquote>\n\n<p>Based on Mathieu Guindon's answer, here is how I would handle all the instances of the search phrase:</p>\n\n<pre><code>Do While vb.CodeModule.Find(strSearchPhrase, i, 1, -1, -1)\n    vb.CodeModule.ReplaceLine i, \"Add This\" &amp; vb.CodeModule.Lines(i, 1)\n    i = i + 1\nLoop\n'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1563381109, "last_edit_date": 1563381109, "creation_date": 1563378891, "answer_id": 57079941, "question_id": 57079339, "link": "https://stackoverflow.com/questions/57079339/finding-and-adding-code-into-a-module-via-a-macro/57079941#57079941", "title": "Finding and adding code into a module via a macro", "body": "<p>Iterating all lines of a module seems a poor use of the <code>Find</code> method, which is capable of finding text anywhere in a module and takes <code>ByRef</code> arguments that, if the function returns <code>True</code>, will contain the exact location of the found text - that's a great use case for a user-defined <code>Type</code>:</p>\n\n<pre><code>Option Explicit\nPrivate Type CodeStringLocation\n    StartLine As Long\n    EndLine As Long\n    StartColumn As Long\n    EndColumn As Long\nEnd Type\n\nSub test()\n    Dim module As CodeModule\n    Set module = ThisWorkbook.VBProject.VBComponents(\"Module1\").CodeModule\n    Dim foundAt As CodeStringLocation\n    If module.Find(\"test\", foundAt.StartLine, foundAt.StartColumn, foundAt.EndLine, foundAt.EndColumn) Then\n        'L9C5-L9C9\n        Debug.Print \"L\" &amp; foundAt.StartLine &amp; \"C\" &amp; foundAt.StartColumn &amp; \"-L\" &amp; foundAt.EndLine &amp; \"C\" &amp; foundAt.EndColumn\n    End If\nEnd Sub\n</code></pre>\n\n<p>Now that you have the in-editor line number you want to rewrite, use <code>CodeModule.ReplaceLine</code> to rewrite it - for example by replacing the <code>Debug.Print</code> statement above with this:</p>\n\n<pre><code>Dim newLine As String\nnewLine = Replace(module.Lines(foundAt.StartLine, 1), \"test\", \"Renamed\")\nmodule.ReplaceLine foundAt.StartLine, newLine\n</code></pre>\n\n<p>If you need to replace all occurrences of the search text in the module, simply run the search until <code>CodeModule.Find</code> returns <code>False</code> - like this:</p>\n\n<pre><code>Dim foundAt As CodeStringLocation\nDo While module.Find(\"test\", foundAt.StartLine, foundAt.StartColumn, foundAt.EndLine, foundAt.EndColumn)\n    Dim newLine As String\n    newLine = Replace(module.Lines(foundAt.StartLine, 1), \"test\", \"Renamed\")\n    module.ReplaceLine foundAt.StartLine, newLine\nLoop\n</code></pre>\n\n<p>Key point being that everything but the search text is an <em>output</em> parameter; by hard-coding any of these arguments, you lose the reference to the value they return. If you want to limit the search to a specific scope or range of lines, the right way to do it would be to configure the <code>foundAt</code> values before running the search.</p>\n\n<pre><code>Dim foundAt As CodeStringLocation\nfoundAt.StartLine = 10\nDo While module.Find(\"test\", foundAt.StartLine, foundAt.StartColumn, ...\n</code></pre>\n\n<p>That way you leverage the actual bidirectional nature of the arguments, without losing the reference to the output values - and without iterating up to 10K lines of code when you don't need to.</p>\n\n<p>Note that this is purely text-based search and takes absolutely zero syntactical considerations: the API will not care if the search string is found in an identifier, a comment, a string literal, or a keyword.</p>\n"}], "owner": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 57079591, "answer_count": 2, "score": 2, "last_activity_date": 1563381109, "creation_date": 1563377043, "question_id": 57079339, "link": "https://stackoverflow.com/questions/57079339/finding-and-adding-code-into-a-module-via-a-macro", "title": "Finding and adding code into a module via a macro", "body": "<p>I am trying to create code in VBA that will search thru a module, find specific text, then add a string BEFORE that text in the same line. For example, every time it says \"yo\" in the module, I want it changed to say \"Add This yo\".</p>\n\n<p>The code below successfully finds instances where it says \"yo\" in the module, but it doesn't add the text where I want it to. Instead, text is added at the very top of the module (not even inside a sub). How do I get this text to be added before \"yo\"?</p>\n\n<pre><code>Public Sub Edit()\n\nDim vb As VBComponent\nDim i As Long\nDim intFoundLine As Integer\nDim strSearchPhrase As String\nSet vb = ThisWorkbook.VBProject.VBComponents(\"Module2\")\nstrSearchPhrase = \"yo\"\nintLinesNr = vb.CodeModule.CountOfLines\n\nFor i = 1 To intLinesNr\n    If vb.CodeModule.Find(strSearchPhrase, i, 1, -1, -1) Then\n        intFoundLine = i\n        MsgBox \"Found at \" &amp; intFoundLine\n        vb.CodeModule.AddFromString (\"Add This\")\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563377842, "post_id": 57079228, "comment_id": 100682149, "body": "Because <code>Autofilter</code> takes argument as Text, and whatever is being displayed is the character it will filter."}, {"owner": {"reputation": 361, "user_id": 5916842, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3312dab3a323aa75369b11c47f1d271a?s=128&d=identicon&r=PG&f=1", "display_name": "SimonInNYC", "link": "https://stackoverflow.com/users/5916842/simoninnyc"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563378172, "post_id": 57079228, "comment_id": 100682345, "body": "@Mikku, can you suggest a way to filter zeros in this case? maybe another vba function?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1563378411, "post_id": 57079228, "comment_id": 100682516, "body": "You can use Replace <code>0</code> with <code>-</code>, actually it&#39;s not clear in question how you are using it. If you can explain that, there should be another way to do it."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563379129, "post_id": 57079228, "comment_id": 100682928, "body": "You should also paste the full code, and a minimum reproducible problem."}, {"owner": {"reputation": 361, "user_id": 5916842, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3312dab3a323aa75369b11c47f1d271a?s=128&d=identicon&r=PG&f=1", "display_name": "SimonInNYC", "link": "https://stackoverflow.com/users/5916842/simoninnyc"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563379141, "post_id": 57079228, "comment_id": 100682937, "body": "@Mikku, description updated.  I need to use this VBA macro together with <code>DCOUNT</code> function in Excel, which treats <code>0</code> just fine as criteria (even when the target cell formatted as <code>-</code>)"}], "owner": {"reputation": 361, "user_id": 5916842, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3312dab3a323aa75369b11c47f1d271a?s=128&d=identicon&r=PG&f=1", "display_name": "SimonInNYC", "link": "https://stackoverflow.com/users/5916842/simoninnyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563431372, "creation_date": 1563376705, "last_edit_date": 1563431372, "question_id": 57079228, "link": "https://stackoverflow.com/questions/57079228/vba-autofilter-on-zeros-that-formatted-as-minus-sign", "title": "VBA autofilter on zeros that formatted as - (minus sign)", "body": "<p>How to filter zeros (value) using Autofilter function in VBA when the zeros are formatted as \"-\" (Accounting style)?</p>\n\n<p>Autofilter works fine when the criteria is set to be \"<strong>-</strong>\" instead of \"<strong>0</strong>\".  However, I am doing this together with <code>DCOUNT</code> function, which treats \"<strong>0</strong>\" fine as a criteria.  Another question is, how to make the two (VBA <code>autofilter</code> function and Excel <code>DCOUNT</code> function)working at the same time?</p>\n\n<p>For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/eC51M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eC51M.png\" alt=\"Screenshot\"></a></p>\n\n<ul>\n<li><code>.AutoFilter Field:=colIndex, Criteria1:=\"-\"</code> works</li>\n<li><code>.AutoFilter Field:=colIndex, Criteria1:=\"0\"</code> fails</li>\n</ul>\n\n<p>Even all underlying values for \"-\" are zeros.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2215198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f4f99354d173054b686cd54050247e?s=128&d=identicon&r=PG", "display_name": "Mithun Kumar", "link": "https://stackoverflow.com/users/2215198/mithun-kumar"}, "edited": false, "score": 0, "creation_date": 1563434396, "post_id": 57088293, "comment_id": 100700300, "body": "It says type mismatch at:  If IsError(Application.Match(DataA(iRow, 1), DataG, 0)) Then"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 2215198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f4f99354d173054b686cd54050247e?s=128&d=identicon&r=PG", "display_name": "Mithun Kumar", "link": "https://stackoverflow.com/users/2215198/mithun-kumar"}, "edited": false, "score": 0, "creation_date": 1563435709, "post_id": 57088293, "comment_id": 100700934, "body": "@MithunKumar That&#39;s strange I tested it now and it works for me. What is the value of <code>iRow</code> and <code>DataA(iRow, 1)</code> and <code>LastRowA</code> and <code>LastRowG</code> in case of error? \u2022 Did you change anything in the code?"}, {"owner": {"reputation": 1, "user_id": 2215198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f4f99354d173054b686cd54050247e?s=128&d=identicon&r=PG", "display_name": "Mithun Kumar", "link": "https://stackoverflow.com/users/2215198/mithun-kumar"}, "edited": false, "score": 0, "creation_date": 1563778784, "post_id": 57088293, "comment_id": 100796588, "body": "I have copied the file here: <a href=\"https://www.dropbox.com/s/2m45os3gp1irtct/M2U_RPA.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/2m45os3gp1irtct/M2U_RPA.xlsm?dl=0</a>   iRow =2, DataA(iRow, 1) is as in the sheet. It does not begin the loop."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 2215198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f4f99354d173054b686cd54050247e?s=128&d=identicon&r=PG", "display_name": "Mithun Kumar", "link": "https://stackoverflow.com/users/2215198/mithun-kumar"}, "edited": false, "score": 0, "creation_date": 1563779430, "post_id": 57088293, "comment_id": 100796865, "body": "In this file there is no sheet <code>Main_Recon</code> please clarify"}, {"owner": {"reputation": 1, "user_id": 2215198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f4f99354d173054b686cd54050247e?s=128&d=identicon&r=PG", "display_name": "Mithun Kumar", "link": "https://stackoverflow.com/users/2215198/mithun-kumar"}, "edited": false, "score": 0, "creation_date": 1563972380, "post_id": 57088293, "comment_id": 100877283, "body": "<a href=\"https://www.dropbox.com/s/fyhq5w33sugcjl6/5-5Recon.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/fyhq5w33sugcjl6/5-5Recon.xlsm?dl=0</a> Sorry that was the wrong link."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 2215198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f4f99354d173054b686cd54050247e?s=128&d=identicon&r=PG", "display_name": "Mithun Kumar", "link": "https://stackoverflow.com/users/2215198/mithun-kumar"}, "edited": false, "score": 0, "creation_date": 1563975157, "post_id": 57088293, "comment_id": 100878867, "body": "Actually the code runs on your data. But it will need approximately 5 days. The immense number of Matches in the last loop is the problem. You must either reduce your data find another approach or use something else than Excel (that is able to multithread and use more than one CPU core, VBA is single-threaded only!)"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1563431350, "creation_date": 1563431350, "answer_id": 57088293, "question_id": 57079187, "link": "https://stackoverflow.com/questions/57079187/i-have-written-a-piece-of-code-that-does-reconciliation-the-first-part-checks-b/57088293#57088293", "title": "I have written a piece of code that does reconciliation: The first part checks between columns:", "body": "<ol>\n<li>The issue is that you run the loop 4 times, but you can combine 2 loops.</li>\n<li>You can gain some speed in the process using arrays to read/write. Every read/write action to a cell needs a lot of time. So the idea is to read all data cells into an array <code>DataA</code> <strong>at once</strong> (only 1 read action) then process the data in the array and then write it back to the cells at once (only 1 write action). So if you have 100 rows you save 99 read/write actions.</li>\n</ol>\n\n<p>So you would end up with something like below. Note this is untested, so backup before running this.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AutoRecon()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Main_Recon\")\n\n    Application.ScreenUpdating = False\n\n    'find last rows of columns\n    Dim LastRowA As Long\n    LastRowA = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim LastRowG As Long\n    LastRowG = ws.Cells(ws.Rows.Count, \"G\").End(xlUp).Row\n\n    'read data into array\n    Dim DataA() As Variant 'read data from column A into array\n    DataA = ws.Range(\"A1\", \"A\" &amp; LastRowA).Value\n    Dim DataG() As Variant 'read data from column G into array\n    DataG = ws.Range(\"G1\", \"G\" &amp; LastRowG).Value\n\n\n    Dim iRow As Long\n    For iRow = 2 To Application.Max(LastRowA, LastRowG) 'combine loop to the max of both columns\n        If iRow &lt;= LastRowA Then 'run only until max of column A\n            If ws.Cells(iRow, \"A\").Errors.Item(xlNumberAsText).Value = True Then\n                DataA(iRow, 1) = \"N\" &amp; DataA(iRow, 1)\n            End If\n        End If\n\n        If iRow &lt;= LastRowG Then 'run only until max of column G\n            If ws.Cells(iRow, \"G\").Errors.Item(xlNumberAsText).Value = True Then\n                DataG(iRow, 1) = \"N\" &amp; DataG(iRow, 1)\n            End If\n        End If\n    Next iRow\n\n    'write array back to sheet\n    ws.Range(\"A1\", \"A\" &amp; LastRowA).Value = DataA\n    ws.Range(\"G1\", \"G\" &amp; LastRowG).Value = DataG\n\n    'read data into array\n    Dim DataO() As Variant 'read data from column O into array (max size = column A)\n    DataO = ws.Range(\"O1\", \"O\" &amp; LastRowA).Value\n    Dim DataS() As Variant 'read data from column G into array (max size = column G)\n    DataS = ws.Range(\"S1\", \"S\" &amp; LastRowG).Value\n\n    Dim oRow As Long, sRow As Long\n    oRow = 2 'output row start\n    sRow = 2\n    For iRow = 2 To Application.Max(LastRowA, LastRowG) 'combine loop to the max of both columns\n        If iRow &lt;= LastRowA Then\n            If IsError(Application.Match(DataA(iRow, 1), DataG, 0)) Then\n                DataO(oRow, 1) = DataA(iRow, 1)\n                oRow = oRow + 1\n            End If\n        End If\n\n        If iRow &lt;= LastRowG Then\n            If IsError(Application.Match(DataG(iRow, 1), DataA, 0)) Then\n                DataS(sRow, 1) = DataG(iRow, 1)\n                sRow = sRow + 1\n            End If\n        End If\n    Next iRow\n\n    'write array back to sheet\n    ws.Range(\"O1\", \"O\" &amp; LastRowA).Value = DataO\n    ws.Range(\"S1\", \"S\" &amp; LastRowG).Value = DataS\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2215198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f4f99354d173054b686cd54050247e?s=128&d=identicon&r=PG", "display_name": "Mithun Kumar", "link": "https://stackoverflow.com/users/2215198/mithun-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563431350, "creation_date": 1563376595, "last_edit_date": 1563429237, "question_id": 57079187, "link": "https://stackoverflow.com/questions/57079187/i-have-written-a-piece-of-code-that-does-reconciliation-the-first-part-checks-b", "title": "I have written a piece of code that does reconciliation: The first part checks between columns:", "body": "<p>I have written a piece of code that does reconciliation: </p>\n\n<p>The first part checks between columns.</p>\n\n<p>Works absolutely fine on upto 100k Rows, then simply freezes on anything bigger. Is the an optimal way to write this? Should I be using a scripting dictionary for the reconciliation too? Ive been off VBA for a while now and I am pretty rusty! Thanks for reading and helping.</p>\n\n<pre><code>Sub AutoRecon()\n    Worksheets(\"Main_Recon\").Select\n    Dim i As Long, _\n    LRa As Long, _\n    LRb As Long, _\n    rowx As Long\n    LRa = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    LRb = Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n    rowx = 2\n\n    Application.ScreenUpdating = False    \n\n    For i = 2 To LRa\n        If Range(\"A\" &amp; i).Errors.Item(xlNumberAsText).Value = True Then\n            Range(\"A\" &amp; i).Value = \"N\" &amp; Range(\"A\" &amp; i).Value\n            rowx = rowx + 1\n        End If\n    Next i\n\n\n    rowx = 2\n    For i = 2 To LRb\n        If Range(\"G\" &amp; i).Errors.Item(xlNumberAsText).Value = True Then\n            Range(\"G\" &amp; i).Value = \"N\" &amp; Range(\"G\" &amp; i).Value\n            rowx = rowx + 1\n        End If\n    Next i\n\n\n    rowx = 2\n    For i = 2 To LRa\n        If IsError(Application.Match(Range(\"A\" &amp; i).Value, Range(\"G2:G\" &amp; LRb), 0)) Then\n            Range(\"O\" &amp; rowx).Value = Range(\"A\" &amp; i).Value\n            rowx = rowx + 1\n        End If\n    Next i\n\n    rowx = 2\n    For i = 2 To LRb\n        If IsError(Application.Match(Range(\"G\" &amp; i).Value, Range(\"A2:A\" &amp; LRa), 0)) Then\n            Range(\"S\" &amp; rowx).Value = Range(\"G\" &amp; i).Value\n            rowx = rowx + 1\n        End If\n    Next i\n\n    Application.ScreenUpdating = True\nEnd Sub\n\n</code></pre>\n\n<p>This takes too long.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563376743, "post_id": 57079170, "comment_id": 100681531, "body": "Please share how you tried to adapt that answer to your needs."}, {"owner": {"reputation": 2203, "user_id": 5651991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QAp3Q.png?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/5651991/vlad"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563376896, "post_id": 57079170, "comment_id": 100681611, "body": "For example, if a cell had &quot;h&quot; then there was keypress &quot;e&quot;, then I attempted to concatenate with the existing and change the target cell to &quot;he&quot; with events turned off.  This completely didn&#39;t work."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1563377450, "post_id": 57079170, "comment_id": 100681946, "body": "Do you have one particular cell you are writing in, and you need to capture from?"}, {"owner": {"reputation": 2203, "user_id": 5651991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QAp3Q.png?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/5651991/vlad"}, "edited": false, "score": 0, "creation_date": 1563378334, "post_id": 57079170, "comment_id": 100682456, "body": "I check if the cell is in a named range using intersection.  If it is outside that range I turn off the keypress event checking."}], "answers": [{"comments": [{"owner": {"reputation": 2203, "user_id": 5651991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QAp3Q.png?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/5651991/vlad"}, "edited": false, "score": 0, "creation_date": 1563409463, "post_id": 57080272, "comment_id": 100694057, "body": "This works for message box <code>MsgBox pTemp</code>.  Is it possible to make it work with <code>Target.Offset(1) = pTemp</code> to have the cell below mirror the contents of the cell being edited? I&#39;ve tried and it works only for the first letter then doesn&#39;t allow more keystrokes."}], "tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1563437414, "last_edit_date": 1563437414, "creation_date": 1563380083, "answer_id": 57080272, "question_id": 57079170, "link": "https://stackoverflow.com/questions/57079170/capture-keypress-completion-event-in-a-cell-in-an-excel-worksheet/57080272#57080272", "title": "Capture keypress completion event in a cell in an Excel worksheet", "body": "<p>so what wrong with your posted example?, lets make a litlle corrections.</p>\n\n<p>Put this to module</p>\n\n<pre><code>Option Explicit\n\nPrivate Type POINTAPI\n    x As Long\n    y As Long\nEnd Type\n\nPrivate Type MSG\n    hwnd As Long\n    Message As Long\n    wParam As Long\n    lParam As Long\n    time As Long\n    pt As POINTAPI\nEnd Type\n\n\nPrivate Declare Function WaitMessage Lib \"user32\" () As Long\n\nPrivate Declare Function PeekMessage Lib \"user32\" Alias \"PeekMessageA\" _\n    (ByRef lpMsg As MSG, ByVal hwnd As Long, _\n     ByVal wMsgFilterMin As Long, _\n     ByVal wMsgFilterMax As Long, _\n     ByVal wRemoveMsg As Long) As Long\n\nPrivate Declare Function TranslateMessage Lib \"user32\" _\n    (ByRef lpMsg As MSG) As Long\n\nPrivate Declare Function PostMessage Lib \"user32\" Alias \"PostMessageA\" _\n    (ByVal hwnd As Long, _\n     ByVal wMsg As Long, _\n     ByVal wParam As Long, _\n     lParam As Any) As Long\n\nPrivate Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n    (ByVal lpClassName As String, _\n     ByVal lpWindowName As String) As Long\n\nPrivate Const WM_KEYDOWN As Long = &amp;H100\nPrivate Const PM_REMOVE  As Long = &amp;H1\nPrivate Const WM_CHAR    As Long = &amp;H102\nPrivate bExitLoop As Boolean\n\n\nPublic pTemp As String\nPublic GlobalArray As Variant\n\n\nSub TrackKeyPressInit()\n\n    Dim msgMessage As MSG\n    Dim bCancel As Boolean\n    Dim iKeyCode As Integer\n    Dim lXLhwnd As Long\n    GlobalArray = Array(19, 20, 46, 40, 35, 13, 27, 36, 45, 37, 144, 34, 33, 39, 145, 9, 38)\n        'BACKSPACE  8\n        'BREAK  19\n        'CAPS LOCK  20\n        'DELETE 46\n        'DOWN ARROW 40\n        'END    35\n        'ENTER 13\n        'ESC    27\n        'HOME   36\n        'INS    45\n        'LEFT ARROW 37\n        'NUM LOCK   144\n        'PAGE DOWN  34\n        'PAGE UP    33\n        'RIGHT ARROW    39\n        'SCROLL LOCK    145\n        'TAB    9\n        'UP ARROW   38\n    On Error GoTo errHandler:\n        Application.EnableCancelKey = xlErrorHandler\n        bExitLoop = False\n        lXLhwnd = FindWindow(\"XLMAIN\", Application.Caption)\n    Do\n        WaitMessage\n        If PeekMessage _\n            (msgMessage, lXLhwnd, WM_KEYDOWN, WM_KEYDOWN, PM_REMOVE) Then\n            iKeyCode = msgMessage.wParam\n            TranslateMessage msgMessage\n            PeekMessage msgMessage, lXLhwnd, WM_CHAR, WM_CHAR, PM_REMOVE\n            If iKeyCode = vbKeyBack Then SendKeys \"{BS}\"\n            'If iKeyCode = vbKeyReturn Then SendKeys \"{ENTER}\"\n            bCancel = False\n            Sheet_KeyPress ByVal msgMessage.wParam, ByVal iKeyCode, ByVal Selection, bCancel\n            If bCancel = False Then\n                PostMessage lXLhwnd, msgMessage.Message, msgMessage.wParam, 0\n            End If\n        End If\nerrHandler:\n        DoEvents\n    Loop Until bExitLoop\n\nEnd Sub\n\nSub StopKeyWatch()\n    bExitLoop = True\nEnd Sub\n\nPrivate Sub Sheet_KeyPress(ByVal KeyAscii As Integer, _\n                           ByVal KeyCode As Integer, _\n                           ByVal Target As Range, _\n                           Cancel As Boolean)\n\n    If Not Intersect(Target, Range(\"A1:D10\")) Is Nothing Then\n        If IsInArray(KeyAscii, GlobalArray) Then\n            StopKeyWatch ' exit if pressed key in globalscope (restricted)\n            Cancel = True\n            SendKeys \"{ENTER}\" ' UPDATE CELL\n        Else\n            pTemp = pTemp &amp; Chr(KeyAscii)\n               Target.Offset(0) = pTemp\n               Target.Offset(1) = pTemp\n            Cancel = True\n            Application.ScreenUpdating = True\n        End If\n    Else\n        StopKeyWatch\n    End If\n\nEnd Sub\n\nFunction IsInArray(stringToBeFound As Integer, arr As Variant) As Boolean\n    IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\nEnd Function\n</code></pre>\n\n<p>And put this to active sheet</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    pTemp = \"\"\n    TrackKeyPressInit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2203, "user_id": 5651991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QAp3Q.png?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/5651991/vlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 1, "accepted_answer_id": 57080272, "answer_count": 1, "score": 1, "last_activity_date": 1563437414, "creation_date": 1563376546, "last_edit_date": 1563429216, "question_id": 57079170, "link": "https://stackoverflow.com/questions/57079170/capture-keypress-completion-event-in-a-cell-in-an-excel-worksheet", "title": "Capture keypress completion event in a cell in an Excel worksheet", "body": "<p>Is there a way with VBA to capture the event after a key has been pressed in an Excel worksheet?  </p>\n\n<p>There was a similar question answered here:\n<a href=\"https://stackoverflow.com/questions/11153995/is-there-any-event-that-fires-when-keys-are-pressed-when-editing-a-cell/11154285#11154285\">Is there any event that fires when keys are pressed when editing a cell?</a><br>\nThis is the demo workbook with the answer:\n<a href=\"http://www.321webs.com/download/30478.htm\" rel=\"nofollow noreferrer\">http://www.321webs.com/download/30478.htm</a></p>\n\n<p>This works for capturing the keypress event, to check and potentially stop the keypress, but I want to allow all keypresses and just trigger an event after each one.</p>\n\n<p>The purpose is to capture the cell value as the user types.  If the user is typing \"hello\" then an event is triggered at these states of the target cell:</p>\n\n<ol>\n<li>\"h\"</li>\n<li>\"he\"</li>\n<li>\"hel\" </li>\n<li>\"hell\"</li>\n<li>\"hello\"</li>\n</ol>\n\n<p>and if the user uses the backspace or delete, it captures the cell content after each of these instances too.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10408059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7a232dd29a7822e42585c7337cb7d0?s=128&d=identicon&r=PG&f=1", "display_name": "P.Weg", "link": "https://stackoverflow.com/users/10408059/p-weg"}, "edited": false, "score": 0, "creation_date": 1563434300, "post_id": 57079408, "comment_id": 100700246, "body": "Thanks a lot. Sometimes the solution is too simple to see."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1563377227, "creation_date": 1563377227, "answer_id": 57079408, "question_id": 57079162, "link": "https://stackoverflow.com/questions/57079162/setting-a-formatted-controlsource-of-a-textbox-dynamically-on-report-rowsource/57079408#57079408", "title": "Setting a formatted &quot;ControlSource&quot; of a textbox dynamically on report Rowsource change", "body": "<p>You can set the Format property of that textbox to: <em>mm/yy</em> </p>\n\n<p>and and leave its ControlSource as <em>OrderDate</em></p>\n"}], "owner": {"reputation": 57, "user_id": 10408059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7a232dd29a7822e42585c7337cb7d0?s=128&d=identicon&r=PG&f=1", "display_name": "P.Weg", "link": "https://stackoverflow.com/users/10408059/p-weg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 57079408, "answer_count": 1, "score": 0, "last_activity_date": 1594636054, "creation_date": 1563376517, "last_edit_date": 1594636054, "question_id": 57079162, "link": "https://stackoverflow.com/questions/57079162/setting-a-formatted-controlsource-of-a-textbox-dynamically-on-report-rowsource", "title": "Setting a formatted &quot;ControlSource&quot; of a textbox dynamically on report Rowsource change", "body": "<p>I have a Report as \"Subform\" in a Form where I have some control buttons. </p>\n\n<p>If I press a Button to view some \"archived file data\", I am changing the rowsource of the report from the Query <code>qryDefaultview</code> to the Query <code>qryTempView</code> via vba. <code>qryTempView</code> is a dynamically generated query that can include include values of search fields on the form.</p>\n\n<p>This works as intended, but to save up some screenspace, I have edited some textboxes that show dates on my report to show only the month and the last two digits of the year of the date. In the <code>ControlSource</code> window, it writes like this:</p>\n\n<pre><code>=Format$([qryDefaultview.Orderdate];\"mm/jj\")\n</code></pre>\n\n<p>How can I transfer this into a VBA prompt? I know how to format data via <code>Format()</code> prompt in VBA but I don't know how I can set the rowsource to a certain field of a query. </p>\n\n<p>It's probably very easy, but I have spent quite some time on this Problem</p>\n"}, {"tags": ["excel", "vba", "slicers"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1563460506, "post_id": 57079032, "comment_id": 100715244, "body": "Actually running your provided code in a test environment and pivot table, I&#39;m not getting any errors, so the structure is fine. Can you provide a snapshot of your pivot/slicer with any non-critical items blacked out?"}, {"owner": {"reputation": 21, "user_id": 11076139, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4WR2P_4vqc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPrhhZjENzanH0bfTicMUADKQOnYw/mo/photo.jpg?sz=128", "display_name": "Efrain Ortiz Jr", "link": "https://stackoverflow.com/users/11076139/efrain-ortiz-jr"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1563462318, "post_id": 57079032, "comment_id": 100716419, "body": "I&#39;ve added them to the original post"}], "owner": {"reputation": 21, "user_id": 11076139, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_4WR2P_4vqc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPrhhZjENzanH0bfTicMUADKQOnYw/mo/photo.jpg?sz=128", "display_name": "Efrain Ortiz Jr", "link": "https://stackoverflow.com/users/11076139/efrain-ortiz-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563462301, "creation_date": 1563376057, "last_edit_date": 1563462301, "question_id": 57079032, "link": "https://stackoverflow.com/questions/57079032/application-defined-or-object-defined-error-related-to-slicers", "title": "Application Defined or object Defined Error related to slicers", "body": "<p>I am fairly new to VBA and I am trying to run VBA code to try and select a slicer but I am getting a runtime error 1004 Application Defined or object defined error. I'm not sure if it is due to the name .SlicerItems or if there is something else in the code that is causing this.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nSVAL = Format(Date, \"ww\")\nSVAL = Format(Date, \"YYYY\") &amp; SVAL\n\nSheets(\"Summary\").Select\nActiveWorkbook.RefreshAll\n\nWith ActiveWorkbook.SlicerCaches(\"Slicer_WK_NBR_F\")\n    .ClearManualFilter\n    For Each oSlicerItem In .SlicerItems\n        If oSlicerItem.Name = SVAL Then\n            oSlicerItem.Selected = True\n        Else\n            oSlicerItem.Selected = False\n        End If\n     Next oSlicerItem\nEnd With\n\nApplication.DisplayAlerts = False\nActiveWorkbook.SaveAs Filename:=\"C:\\brdata\\reports\\sales\\DEPARTMENT_SALES_YTD.xlsx\", FileFormat:=51\n\nEnd Sub\n</code></pre>\n\n<p>the error I am getting is on the line that says</p>\n\n<pre><code>For Each oSlicerItem in .SlicerItems\n</code></pre>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p><a href=\"https://i.stack.imgur.com/m0tek.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m0tek.png\" alt=\"Excel Slicer\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/QQzNS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QQzNS.png\" alt=\"Slicer Settings\"></a></p>\n"}, {"tags": ["excel", "vba", "automation"], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1563376398, "post_id": 57079054, "comment_id": 100681334, "body": "Also, before attaching the file, check if the file exists"}, {"owner": {"reputation": 198, "user_id": 7102095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211015901574118/picture?type=large", "display_name": "Abd&#243;n Araya", "link": "https://stackoverflow.com/users/7102095/abd%c3%b3n-araya"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1563376492, "post_id": 57079054, "comment_id": 100681389, "body": "@Zac Can you hint me how can I do that?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563376508, "post_id": 57079054, "comment_id": 100681402, "body": "Use the <code>Dir</code> function."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1563376543, "post_id": 57079054, "comment_id": 100681424, "body": "Exactly what @BigBen said :). Also, don&#39;t forget the additional bits in BigBen&#39;s answer.. they might be critical to your solution"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1563377140, "last_edit_date": 1563377140, "creation_date": 1563376153, "answer_id": 57079054, "question_id": 57079016, "link": "https://stackoverflow.com/questions/57079016/automated-mailing-on-vba-fails-on-second-iteration/57079054#57079054", "title": "Automated mailing on VBA fails on second iteration", "body": "<p>Simple fix: move <code>Set objMail = outlookApp.CreateItem(olMailItem)</code> <em>inside</em> the loop.</p>\n\n<p>You need a new mail item for each row. The code as is fails because you're trying to attach a file to an email you just sent (on the first iteration).</p>\n\n<p>Other things you could fix:</p>\n\n<ul>\n<li><code>Dim archivoFuente, toMail, ccMail As String</code> - only <code>ccMail</code> is a <code>String</code>. You are looking for <code>Dim archivoFuente As String, toMail As String, ccMail As String</code>.</li>\n<li><code>Dim i, j As Integer</code> - should be <code>Dim i As Long, j As Long</code>. Excel has more rows than <code>Integer</code> can handle.</li>\n</ul>\n"}], "owner": {"reputation": 198, "user_id": 7102095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211015901574118/picture?type=large", "display_name": "Abd&#243;n Araya", "link": "https://stackoverflow.com/users/7102095/abd%c3%b3n-araya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 57079054, "answer_count": 1, "score": 0, "last_activity_date": 1563387229, "creation_date": 1563375996, "last_edit_date": 1563387229, "question_id": 57079016, "link": "https://stackoverflow.com/questions/57079016/automated-mailing-on-vba-fails-on-second-iteration", "title": "Automated mailing on VBA fails on second iteration", "body": "<p>I modified VBA code to send to X mail address X attachment. On the first iteration the code works perfectly, the mail is sent as is with the correct file. On the second iteration the code stops when attaching it's file (on <code>objMail.Attachments.Add archivoFuente</code> line) showing up this screen:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XHFlg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XHFlg.png\" alt=\"Se ha producido el error...\"></a></p>\n\n<p>My code gets the main data from the first sheet wich contains the mail address in the second column and the filename it's standarized from the name of the user and the file extension on the third column. With that done the filename it's attached to the directory, then I add body, subject and other things for the user to see on the mail, finally the mail is sent and I empty the strings variables to start the text iteration but then I encounter the error even with the file on the folder and with the same filename as standarized...</p>\n\n<pre><code>Sub bulkMail()\nDim outlookApp As Outlook.Application\nDim objMail As Outlook.MailItem\nDim archivoFuente, toMail, ccMail As String\nDim i, j As Integer\nDim fila As Long\n\nfila = Cells(Rows.Count, 2).End(xlUp).Row\n\n'On Error Resume Next\n\nSet outlookApp = New Outlook.Application\nSet objMail = outlookApp.CreateItem(olMailItem)\n\nFor i = 2 To fila\n\n    toMail = Cells(i, 2) ' &amp; \";\"\n    archivoFuente = \"C:\\Users\\...\" &amp; Cells(i, 3)\n    objMail.Attachments.Add archivoFuente ' on the second iteration, stops here\n\n    ThisWorkbook.Save\n    'archivoFuente = ThisWorkbook.FullName\n    'objMail.Attachments.Add archivoFuente\n\n    objMail.To = toMail\n    objMail.Subject = \"TEST\"\n    objMail.Body = \"LOREM,\" &amp; vbNewLine &amp; \"IPSUM.\" &amp; vbNewLine &amp; \"BYE.\"\n\n    objMail.Send\n\n    toMail = \"\"\n    archivoFuente = \"\"\n\nNext i\n\nMsgBox \"DONE!\"\n\nEnd Sub\n</code></pre>\n\n<p>Appreciate any help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1563376162, "post_id": 57078830, "comment_id": 100681204, "body": "Welcome to the forum. Can you let us know what <code>ra</code> means in your code -&gt; <code>ra.Address</code>"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1563376292, "post_id": 57079081, "comment_id": 100681275, "body": "This. Or if the search result is on the sheet you want to exclude, keep searching until there&#39;s no result or one is found on a sheet you don&#39;t want to exclude"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1563376463, "post_id": 57079081, "comment_id": 100681373, "body": "@MathieuGuindon  You are correct!, but then the open issue is: On which sheet was the data found??"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563376642, "post_id": 57079081, "comment_id": 100681489, "body": "Really what OP should do is return the value given next to the word sought instead of using the result of this UDF in INDIRECT."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1563376811, "post_id": 57079081, "comment_id": 100681563, "body": "I&#39;d use <code>Range.Parent</code> to get the sheet the found range belongs to"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1563381543, "last_edit_date": 1563381543, "creation_date": 1563376230, "answer_id": 57079081, "question_id": 57078830, "link": "https://stackoverflow.com/questions/57078830/is-it-possible-to-force-cells-find-to-exclude-a-sheet-from-its-search/57079081#57079081", "title": "Is it possible to force Cells.find to exclude a sheet from its search?", "body": "<p>Just perform the search on a specific sheet:</p>\n\n<pre><code>Public Function SuperSearch(sheetname As String, SVal As String) As String\n    Dim FVal As Range\n    Set FVal = Sheets(sheetname).Cells.Find(What:=SVal, LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlPrevious)\n    If FVal Is Nothing Then\n        MsgBox (\"Not Found\")\n    Else\n        SuperSearch = FVal.Address\n    End If\nEnd Function\n</code></pre>\n\n<p>For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0HNfV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0HNfV.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Interesting Resource:</strong></p>\n\n<p><a href=\"https://www.ozgrid.com/forum/forum/tip-tricks-code/17729-kickbutt-vba-find-function?t=27240\" rel=\"nofollow noreferrer\">Arron Blood</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11798249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ae9d4dca6a142fa31418e081c79ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Lund", "link": "https://stackoverflow.com/users/11798249/lund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563381543, "creation_date": 1563375412, "last_edit_date": 1563375638, "question_id": 57078830, "link": "https://stackoverflow.com/questions/57078830/is-it-possible-to-force-cells-find-to-exclude-a-sheet-from-its-search", "title": "Is it possible to force Cells.find to exclude a sheet from its search?", "body": "<p>Im trying to create a function that returns the adress of a given value. I have come as far as making a search function that returns the adress, however I do not know how to exclude the sheet that the function will be used in. My code so far is given below.</p>\n\n<p>Ideally I want to look up a value in the second or third sheet (whereever it is written) and return its adress, which I can then use to find the values given next to the searched word using indirect. </p>\n\n<p>I have tried using some build in functions such as INDEX(MATCH(, however as I do not know the match column this does not provide any results. </p>\n\n<pre><code>Public Function SuperSearch(SVal As String)\n    Dim FVal As Range\n        Set FVal = Cells.Find(What:=SVal, LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlPrevious)\n            If FVal Is Nothing Then\n            MsgBox (\"Not Found\")\n            Else\n            SuperSearch = ra.Address\n            End If\nEnd Function\n</code></pre>\n\n<p>When I run the above function I am simply given the value I used in my search: </p>\n\n<pre><code>       A                   B\n</code></pre>\n\n<p>1<br>\n2   FindMeImHelpFull    =SuperSearch(A2)\n3       </p>\n\n<p>Returns         </p>\n\n<pre><code>       A                   B\n</code></pre>\n\n<p>1<br>\n2   FindMeImHelpFull          A$2$\n3       </p>\n\n<p>I would like it to return the string FindMeImHelpFull in sheet2 on H15 instead giving me:       </p>\n\n<pre><code>       A                   B\n</code></pre>\n\n<p>1<br>\n2   FindMeImHelpFull       Sheet2!H$15$\n3</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-forms"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563374389, "post_id": 57078460, "comment_id": 100680176, "body": "Name it something else. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.application\" rel=\"nofollow noreferrer\"><code>Application</code></a> is the Access application."}, {"owner": {"reputation": 61, "user_id": 10771120, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U8-EdVy-84Y/AAAAAAAAAAI/AAAAAAAACpQ/pmbnCFfG6hQ/photo.jpg?sz=128", "display_name": "Kiran Chapidi", "link": "https://stackoverflow.com/users/10771120/kiran-chapidi"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563376847, "post_id": 57078460, "comment_id": 100681582, "body": "Thank you BigBen, I thought so too, thank you for the confirmation"}], "owner": {"reputation": 61, "user_id": 10771120, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U8-EdVy-84Y/AAAAAAAAAAI/AAAAAAAACpQ/pmbnCFfG6hQ/photo.jpg?sz=128", "display_name": "Kiran Chapidi", "link": "https://stackoverflow.com/users/10771120/kiran-chapidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594636074, "creation_date": 1563374271, "last_edit_date": 1594636074, "question_id": 57078460, "link": "https://stackoverflow.com/questions/57078460/ms-access-vba-code-error-with-visible-invisible-vba-code", "title": "MS Access vba code error with visible invisible VBA code", "body": "<p>I have a filed called application. I have written code in vba to make the other field \"application_txt\" field visible and invisible if a particular value from application field is selected. But for this particulat field application when I write the below code in vba it throws the error. I dont understand why. It works fine for the other fields. Below is the code:</p>\n\n<p>Can anyone please help me with this problem. Is it allowed to give application as field name in MS Access.</p>\n\n<p>Many thanks,\nKiran Chapidi</p>\n\n<pre><code>This is not working:\nPrivate Sub application_Click()\nIf application.Value = \"5= others\" Then\n    Me.application_txt.Visible = True\nElse\n    Me.application_txt.Visible = False\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This is working fine:</p>\n\n<pre><code>Private Sub Design_Click()\nIf Design.Value = \"3= others\" Then\n   Me.design_txt.Visible = True\nElse\n   Me.design_txt.Visible = False\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 7, "creation_date": 1563372581, "post_id": 57077864, "comment_id": 100678925, "body": "<code>xlUp</code> - the letter &quot;l&quot;, not the number &quot;1&quot;."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1563372653, "post_id": 57077864, "comment_id": 100678974, "body": "Also you don&#39;t need to <code>FillDown</code>. <code>Range(&quot;H2:H&quot; &amp; Cells(Rows.Count, 1).End(xlUp).Row).Formula = &quot;=HOUR(G2)&quot;</code>."}], "owner": {"reputation": 11, "user_id": 11798066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6BwUBBQtXRg/AAAAAAAAAAI/AAAAAAAAABw/hNb9ZnscH6U/photo.jpg?sz=128", "display_name": "Soji Coker", "link": "https://stackoverflow.com/users/11798066/soji-coker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1593586658, "creation_date": 1563372478, "last_edit_date": 1593586658, "question_id": 57077864, "link": "https://stackoverflow.com/questions/57077864/the-code-gives-run-time-error-1004-application-defined", "title": "The code gives &quot;Run-time error&quot; 1004&quot; Application defined", "body": "<p>Please I am really new to VBA. but the code below gives run time error. I just need to get the hour of a column.</p>\n\n<pre><code>ActiveSheet.Columns(\"H\").Insert Shift:=xlToRight\nRange(\"h1\").Value = \"HOUR\"\n\nRange(\"H2\").Formula = \"=HOUR(G2)\"\nRange(\"H2:H\" &amp; Cells(Rows.Count, 1).End(x1UP).Row).FillDown\nRange(\"H2:H\" &amp; Cells(Rows.Count, 1).End(x1UP).Row).NumberFormat = \"General\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1563371727, "post_id": 57077546, "comment_id": 100678351, "body": "Copy both sheets into a new sheet and then save as PDF."}, {"owner": {"reputation": 1, "user_id": 11798020, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--r24FESb4IU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdd00JvEceGt5-6LUSii5lh8wvfVg/photo.jpg?sz=128", "display_name": "Charlie Davies", "link": "https://stackoverflow.com/users/11798020/charlie-davies"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563371872, "post_id": 57077546, "comment_id": 100678453, "body": "First workbook has 23 sheets and the second one has a sheet with multiple graphs, therefore I cannot do that @BigBen"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563371904, "post_id": 57077546, "comment_id": 100678483, "body": "Create a new temporary workbook and merge the sheets in it. Then discard the temp workbook, i.e. don&#39;t save it."}, {"owner": {"reputation": 1, "user_id": 11798020, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--r24FESb4IU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdd00JvEceGt5-6LUSii5lh8wvfVg/photo.jpg?sz=128", "display_name": "Charlie Davies", "link": "https://stackoverflow.com/users/11798020/charlie-davies"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563372784, "post_id": 57077546, "comment_id": 100679066, "body": "And how can I do that if the files are in different folders?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1563372837, "post_id": 57077546, "comment_id": 100679101, "body": "Open both files and copy the sheets you want to a new workbook (?)."}], "owner": {"reputation": 1, "user_id": 11798020, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--r24FESb4IU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdd00JvEceGt5-6LUSii5lh8wvfVg/photo.jpg?sz=128", "display_name": "Charlie Davies", "link": "https://stackoverflow.com/users/11798020/charlie-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563375315, "creation_date": 1563371558, "last_edit_date": 1563375315, "question_id": 57077546, "link": "https://stackoverflow.com/questions/57077546/is-there-a-way-to-create-a-single-pdf-from-one-workbook-and-add-a-single-tab-fro", "title": "Is there a way to create a single PDF from one workbook and add a single tab from another one into it?", "body": "<p>Basically, I was wondering if is possible to create a single PDF from 2 different workbooks sheets. I know how to write a code to create a PDF using multiple worksheets from one workbook, but I was wondering if into this PDF can be added one worksheet from another workbook at the end using VBA?</p>\n\n<pre><code>Sub SaveAllToPDF()\n\nDim OriginalSheet\nDim i As Long\n\nOriginalSheet = ActiveSheet.Name\n\n\n    Sheets(Array(sheets)).Select\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        \"C:\\Users\\xhdhfd\\Documents\\PDF\\\" &amp; Sheets(\"Admin\").Range(\"H25\").Value &amp; \".pdf\"\n\nSheets(OriginalSheet).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 166, "user_id": 11348379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e157387f24dcebef764066025520d0?s=128&d=identicon&r=PG&f=1", "display_name": "SomeNerdAtWork", "link": "https://stackoverflow.com/users/11348379/somenerdatwork"}, "edited": false, "score": 0, "creation_date": 1565037066, "post_id": 57077474, "comment_id": 101217681, "body": "I think I know what you are trying to ask here, but this doesn&#39;t seem to be an actual question or contain enough code for anyone to work off of. If you provide some more information I may be able to help."}], "answers": [{"tags": [], "owner": {"reputation": 612, "user_id": 10548234, "user_type": "registered", "profile_image": "https://graph.facebook.com/495896574223399/picture?type=large", "display_name": "hiichaki", "link": "https://stackoverflow.com/users/10548234/hiichaki"}, "is_accepted": false, "score": 0, "last_activity_date": 1594637793, "creation_date": 1594637793, "answer_id": 62874371, "question_id": 57077474, "link": "https://stackoverflow.com/questions/57077474/how-to-add-a-day-and-using-format-fct-in-vba/62874371#62874371", "title": "How to Add a day and using format fct in VBA", "body": "<p>I'm not sure about your question but it seems you want to do something like this:</p>\n<pre><code>SELECT Employee_Data.[Employee Number], Employee_Data.Leave \nFROM Employee_Data \nWHERE [Date_Leave] = DateAdd(&quot;d&quot;, -1, Date())\n</code></pre>\n<p><a href=\"https://www.techonthenet.com/access/functions/date/dateadd.php\" rel=\"nofollow noreferrer\">Check this link for details</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11779982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f992d3451bc8e2db0cd3d963c2bfb41?s=128&d=identicon&r=PG&f=1", "display_name": "Er Hab", "link": "https://stackoverflow.com/users/11779982/er-hab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594637793, "creation_date": 1563371324, "last_edit_date": 1594636085, "question_id": 57077474, "link": "https://stackoverflow.com/questions/57077474/how-to-add-a-day-and-using-format-fct-in-vba", "title": "How to Add a day and using format fct in VBA", "body": "<p>I want to add or retry  a day in acces vba but access gives me an error \"Error syntax - Operator missing\"</p>\n\n<p>I have retry and add some quote but no result</p>\n\n<blockquote>\n  <p>SELECT Employee_Data.[Employee Number],Employee_Data.Leave    FROM\n  Employee_Data   WHERE (([Date_Leave]=\"\"#\"\" &amp; Format([Date_Leave] -\n  1,\"\"dd/mm/yyyy\"\") &amp; \"\"#\"\"));</p>\n</blockquote>\n\n<p>\"Error syntax - Operator missing\"</p>\n"}, {"tags": ["excel", "vba", "combobox", "userform"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1563371089, "post_id": 57077319, "comment_id": 100677906, "body": "The ranges are not the same size.  I doubt the formula worked on the spread sheet."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1563371152, "post_id": 57077319, "comment_id": 100677955, "body": "I think you have an extra <code>1</code> on your index range:<code>&#39;Teams&#39;!B2:S21</code> should probably be: <code>&#39;Teams&#39;!B2:S2</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1563371273, "post_id": 57077319, "comment_id": 100678030, "body": "<code>ReturnVal = Evaluate(&quot;=INDEX(&#39;Teams&#39;!B2:S2,MATCH(&quot;&quot;&quot; &amp; Me.Select_Team.Value &amp; &quot;&quot;&quot;,&#39;Teams&#39;!B3:S3,0))&quot;)</code>"}, {"owner": {"reputation": 49, "user_id": 11797904, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156023722201114/picture?type=large", "display_name": "mccarthy995", "link": "https://stackoverflow.com/users/11797904/mccarthy995"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1563372055, "post_id": 57077319, "comment_id": 100678576, "body": "SCOTT YOU&#39;RE A LEGEND!"}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 11797904, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156023722201114/picture?type=large", "display_name": "mccarthy995", "link": "https://stackoverflow.com/users/11797904/mccarthy995"}, "is_accepted": true, "score": 0, "last_activity_date": 1563374665, "last_edit_date": 1563374665, "creation_date": 1563372152, "answer_id": 57077752, "question_id": 57077319, "link": "https://stackoverflow.com/questions/57077319/using-index-match-function-in-a-userform-combobox/57077752#57077752", "title": "Using INDEX &amp; MATCH Function in a Userform Combobox", "body": "<pre><code>ReturnVal = Evaluate(\"=INDEX('Teams'!B2:S2,MATCH(\"\"\" &amp; Me.Select_Team.Value &amp; \"\"\",'Teams'!B3:S3,0))\")\n</code></pre>\n\n<p>\u2013 Scott Craner (c.f. comment)</p>\n\n<p>This works (in case anyone needs to copy it)</p>\n"}], "owner": {"reputation": 49, "user_id": 11797904, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156023722201114/picture?type=large", "display_name": "mccarthy995", "link": "https://stackoverflow.com/users/11797904/mccarthy995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 57077752, "answer_count": 1, "score": 0, "last_activity_date": 1563374665, "creation_date": 1563370898, "last_edit_date": 1563371551, "question_id": 57077319, "link": "https://stackoverflow.com/questions/57077319/using-index-match-function-in-a-userform-combobox", "title": "Using INDEX &amp; MATCH Function in a Userform Combobox", "body": "<p>Hi I need a bit of assistance getting this one started. I have a formula that works great on a worksheet, however I do not know how to convert that to a VBA code that will populate a combobox for me. </p>\n\n<p>I had tried this and it populated the combobox with the N/A value and not the one I wanted:</p>\n\n<pre><code> Dim ReturnVal As Variant\n\n    ReturnVal = Evaluate(\"=INDEX('Teams'!B2:S21,MATCH(1,(\"\"\" &amp; Me.Select_Team.Value &amp; \"\"\" ='Teams'!B3:S3),0))\")\n\n    If Not IsError(ReturnVal) Then\n        Me.Team_Leader.Value = ReturnVal\n    Else\n        Me.Team_Leader.Value = \"N/A\"\n    End If\n</code></pre>\n\n<p>This is the formula that works on the excel worksheet. </p>\n\n<p>Formula: </p>\n\n<pre><code>=INDEX(Teams!B2:S21,1,MATCH('Ticket Pools'!J6,Teams!B3:S3,0))\n</code></pre>\n\n<p>This searches names of Teams and brings up their allocated team leader from a range. </p>\n\n<p>The Userform is called \"Edit_Teams\", on it there is a combobox \"Team_leader\" where I want the combobox to populate. The combobox is loaded so I just use:</p>\n\n<p>\"<code>Me.Team_Leader.Value = ReturnVal</code>\"</p>\n\n<p>Can anyone help please?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1563371338, "post_id": 57077272, "comment_id": 100678081, "body": "To keep it in VBA you can look at a personal binary workbook with a userform. Your other option is to write a gui in another language and then call the vba from that."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1563371898, "post_id": 57077272, "comment_id": 100678478, "body": "I would recommend grabbing Visual Studio and creating a VSTO office add-in. You can use <a href=\"https://docs.microsoft.com/en-us/visualstudio/vsto/deploying-an-office-solution-by-using-windows-installer?view=vs-2019\" rel=\"nofollow noreferrer\">this tutorial</a> as a guide for how that works. You will be writing in C#, but you&#39;ll find that much of the excel interaction feels similar to VBA. This obviously has a big fat learning curve, but it&#39;s also very powerful."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1563371996, "post_id": 57077272, "comment_id": 100678535, "body": "A less difficult to learn option is an HTA application which is still supported even in Windows 10. This is a vbscript based application that uses HTML (and javascript) for the UI. You can send them the .hta file you create and they can open it like an executable and depending on your HTML skills, it can feel very much like a native program. Writing vbscript will feel comfortable since it&#39;s very similar to VBA."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1563372921, "post_id": 57077272, "comment_id": 100679168, "body": "VBA won&#39;t compile an executable .exe file. You can make an Excel add-in that Excel will load at startup (just like @JNevill&#39;s VSTO Office add-in suggestion, but in VBA), and then this special document can work at application level and as far as I can tell that <i>could</i> work for that person&#39;s purposes. If they&#39;re adamant that it needs to be a standalone executable, it can&#39;t be VBA."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1563382947, "post_id": 57077272, "comment_id": 100684843, "body": "Check this <a href=\"https://stackoverflow.com/a/47111556/2165759\">WSH VBS GUI</a> solution."}], "owner": {"reputation": 25, "user_id": 11735137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ln8ncAoeKVI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfqx-aPNs_SrcDqyPDuky1RdrMB6A/photo.jpg?sz=128", "display_name": "Brendan", "link": "https://stackoverflow.com/users/11735137/brendan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563371483, "creation_date": 1563370768, "last_edit_date": 1563371483, "question_id": 57077272, "link": "https://stackoverflow.com/questions/57077272/how-to-make-executabile-gui-for-macros-code-to-run-on-multiple-excel-files", "title": "How to make executabile GUI for macros code to run on multiple Excel files?", "body": "<p>Hopefully somebody can guide me in the right direction. I have VBA code that I made that can be ran on multiple Excel spreadsheets. The person I made the code for wants a .exe file with a GUI that can be opened and then you select the excel file you want and it will export a new Excel file that has been modified.</p>\n\n<p>I have not tried anything but research. I understand that this may be beyond VBA for Excel's functionality but if so can somebody guide me in the right direction? Thank you for any help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1563373942, "post_id": 57077256, "comment_id": 100679885, "body": "Each of the lines where you paste need to be updated to include the worksheet in the <code>.cells</code> portion of the range.  For example, <code>wsCopy.Range(wsCopy.Cells(x,3), wsCopy.Cells(x,5)).PasteSpecial xlPasteValues</code>.  Otherwise they may not be going in the correct worksheet."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1563374654, "post_id": 57077256, "comment_id": 100680331, "body": "Also, all 3 <code>If</code> statements are the same.  Why not just combine?"}, {"owner": {"reputation": 3, "user_id": 11699333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca57bb796bce5f95f422e87d5531926?s=128&d=identicon&r=PG&f=1", "display_name": "JBowen", "link": "https://stackoverflow.com/users/11699333/jbowen"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1563377279, "post_id": 57077256, "comment_id": 100681846, "body": "Thanks for the suggestion to update the paste cell references. As for combining the three If statements I&#39;m open to suggestions.  Note that the copy from range of columns 3 to 12 skip column 5 and the past to range of columns 1 to 10 skip column 6.  Thanks."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1563403966, "post_id": 57077256, "comment_id": 100692932, "body": "I could not recreate the error.  <code>x</code> reset to 19 before each new sheet was created.  Try using <code>F8</code> to step through and watch the value of <code>x</code> in the locals window to see how the value changes."}, {"owner": {"reputation": 3, "user_id": 11699333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca57bb796bce5f95f422e87d5531926?s=128&d=identicon&r=PG&f=1", "display_name": "JBowen", "link": "https://stackoverflow.com/users/11699333/jbowen"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1563457743, "post_id": 57077256, "comment_id": 100713426, "body": "Thanks Darrell H. I learned something new. I didn&#39;t know about the locals window.  I think I see what&#39;s happening but not sure how to fix it. The values of j and x are increasing as the code works it way through the JobHist_DataWorking spreadsheet and it is cycling though all rows every time a new sheet is created. I&#39;m thinking I need an if then else statement for it to do nothing if the if statement is false else do the copy paste. Would this be the right approach to this problem?"}, {"owner": {"reputation": 3, "user_id": 11699333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca57bb796bce5f95f422e87d5531926?s=128&d=identicon&r=PG&f=1", "display_name": "JBowen", "link": "https://stackoverflow.com/users/11699333/jbowen"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1563459800, "post_id": 57077256, "comment_id": 100714826, "body": "I tried adding IF NOT sht.Range(&quot;A&quot; &amp; j).Value = wsCopy.Range(&quot;C1&quot;) Then Else... but the outcome was the same."}, {"owner": {"reputation": 3, "user_id": 11699333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca57bb796bce5f95f422e87d5531926?s=128&d=identicon&r=PG&f=1", "display_name": "JBowen", "link": "https://stackoverflow.com/users/11699333/jbowen"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1563462156, "post_id": 57077256, "comment_id": 100716319, "body": "I moved the placement of &quot;x = 19&quot; and &quot;x = x + 1&quot; and got it to run as desired. Thank you for your help."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1563464184, "post_id": 57077256, "comment_id": 100717506, "body": "Glad to hear it.  It helps to step through and see the variable change to figure out why it doesn\u2019t do what we expect."}], "owner": {"reputation": 3, "user_id": 11699333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca57bb796bce5f95f422e87d5531926?s=128&d=identicon&r=PG&f=1", "display_name": "JBowen", "link": "https://stackoverflow.com/users/11699333/jbowen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563466904, "creation_date": 1563370721, "last_edit_date": 1563466904, "question_id": 57077256, "link": "https://stackoverflow.com/questions/57077256/populating-template-from-2-worksheets-data-from-2nd-worksheet-not-copying-to-co", "title": "Populating template from 2 worksheets; data from 2nd worksheet not copying to correct line after first completed template", "body": "<p>I am creating an individual worksheet for each employee based on a template which is populated from two worksheets. I can get the Employee_Data to populate correctly. (Thanks to assistance from Tim Williams.)  However, when copying the JobHist_DataWorking data only the first completed template is on the correct line; subsequent worksheets are populated further down.  The job history information should begin pasting to line 19 for the first job record.</p>\n\n<p>Being a novice coder, I played with the code and have managed to get the last employee to populate on line 40 rather than line 260 as my earlier attempts netted. However, it needs to be on line 19.  I looked at the Do While/Until Loop but could not get the placements in my current code to run. Below is my code as it currently works but not correctly.</p>\n\n<p>EDIT: Code has been updated as suggested.</p>\n\n<p>EDIT #2: Code has been updated to reflect it working correctly thanks to help of Darrell H.</p>\n\n<pre><code>Option Explicit\n\nSub NewSheets()\n    Dim i As Integer\n    Dim j As Integer\n    Dim x As Integer\n\n    Dim ws As Worksheet, wb As Workbook\n    Dim sh As Worksheet, wsCopy As Worksheet, v\n    Dim sht As Worksheet\n\n    Set wb = ActiveWorkbook\n    Set ws = wb.Sheets(\"Template\")\n    Set sh = wb.Sheets(\"Employee_Data\")\n    Set sht = wb.Sheets(\"JobHist_DataWorking\")\n\n    x = 19\n\n    For i = 2 To sh.Range(\"B\" &amp; sh.Rows.Count).End(xlUp).Row\n\n        ws.Copy After:=wb.Sheets(Sheets.Count)\n        Set wsCopy = wb.Sheets(wb.Sheets.Count)\n\n        wsCopy.Name = sh.Range(\"F\" &amp; i).Value\n        wsCopy.Range(\"C1\").Value = sh.Range(\"A\" &amp; i).Value\n        wsCopy.Range(\"C2\").Value = sh.Range(\"G\" &amp; i).Value\n        wsCopy.Range(\"C3\").Value = sh.Range(\"H\" &amp; i).Value\n        wsCopy.Range(\"C4\").Value = sh.Range(\"I\" &amp; i).Value\n        wsCopy.Range(\"C5\").Value = sh.Range(\"J\" &amp; i).Value\n        wsCopy.Range(\"C6\").Value = sh.Range(\"S\" &amp; i).Value\n        wsCopy.Range(\"C7\").Value = sh.Range(\"V\" &amp; i).Value\n        wsCopy.Range(\"C8\").Value = sh.Range(\"W\" &amp; i).Value\n        wsCopy.Range(\"C9\").Value = sh.Range(\"X\" &amp; i).Value\n        wsCopy.Range(\"C11\").Value = sh.Range(\"L\" &amp; i).Value\n        wsCopy.Range(\"C12\").Value = sh.Range(\"AH\" &amp; i).Value\n         v = sh.Range(\"AJ\" &amp; i).Value\n        If Len(v) &gt; 0 Then wsCopy.Range(\"C13\").Value = v\n        wsCopy.Range(\"C14\").Value = sh.Range(\"AM\" &amp; i).Value\n        wsCopy.Range(\"C15\").Value = sh.Range(\"AP\" &amp; i).Value\n        wsCopy.Range(\"C16\").Value = sh.Range(\"AQ\" &amp; i).Value\n        wsCopy.Range(\"H1\").Value = sh.Range(\"F\" &amp; i).Value\n        wsCopy.Range(\"H3\").Value = sh.Range(\"K\" &amp; i).Value\n        wsCopy.Range(\"N1\").Value = sh.Range(\"C\" &amp; i).Value\n        wsCopy.Range(\"N11\").Value = sh.Range(\"N\" &amp; i).Value\n\n\n          For j = 2 To sht.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n               With Worksheets(\"JobHist_DataWorking\")\n                    If Not sht.Range(\"A\" &amp; j).Value = wsCopy.Range(\"C1\") Then\n                        x = 19\n                        Else\n                            sht.Range(.Cells(j, 3), .Cells(j, 4)).Copy\n                               wsCopy.Range(wsCopy.Cells(x, 1), wsCopy.Cells(x, 2)).PasteSpecial xlPasteValues\n                            sht.Range(.Cells(j, 6), .Cells(j, 8)).Copy\n                               wsCopy.Range(wsCopy.Cells(x, 3), wsCopy.Cells(x, 5)).PasteSpecial xlPasteValues\n                            sht.Range(.Cells(j, 9), .Cells(j, 12)).Copy\n                              wsCopy.Range(wsCopy.Cells(x, 7), wsCopy.Cells(x, 10)).PasteSpecial xlPasteValues\n                            Application.CutCopyMode = False\n                     x = x + 1\n                    End If\n                End With\n              Next j\n\n     Next i\n\nEnd Sub\n</code></pre>\n\n<p>The first employee has three job records which are currently populating on lines 19, 20 and 21 as expected. The second employee also has three job records, but they are populating on lines 22, 23 and 24. The third employee has two job records which are populating on lines 25 and 26.  This progression down the template continues such that the 10th and 11th employees who have only one job record each are populating on lines 39 and 40 respectively.</p>\n\n<p>The job history for each employee should begin on line 19. Thank you for your help.</p>\n"}, {"tags": ["excel", "vba", "selenium", "web-scraping", "automation"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563382225, "post_id": 57077212, "comment_id": 100684554, "body": "Have you tried using inputbox and setting the result to the appropriate element?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563383103, "post_id": 57077212, "comment_id": 100684920, "body": "Thanks a lot.Can you give me more details please?"}], "answers": [{"comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1563420479, "post_id": 57080985, "comment_id": 100696045, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/196607/discussion-on-answer-by-qharr-activate-selenium-bot-window-in-excel-vba\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1563388148, "last_edit_date": 1563388148, "creation_date": 1563383123, "answer_id": 57080985, "question_id": 57077212, "link": "https://stackoverflow.com/questions/57077212/activate-selenium-bot-window-in-excel-vba/57080985#57080985", "title": "Activate selenium bot window in excel VBA", "body": "<p>Use javascript to return focus? For having window at front</p>\n\n<pre><code>bot.ExecuteScript \"window.focus();\"\n</code></pre>\n\n<hr>\n\n<p>Ways of pausing for input:</p>\n\n<ol>\n<li>inputbox:</li>\n</ol>\n\n<p>Why not use an inputBox (set to number type) to capture entry ? Below is pseudo code (assuming captcha is in an iframe which needs to be switched to. </p>\n\n<pre><code>Dim captchaBox As Object, captcha As Long\n.SwitchToFrame (.FindElementById(\"someId\")) '&lt;==some identifier for iframe if present\nSet captchaBox = .FindElementByCss(\"#txtCaptia\")\n' Accept Number from the user\ncaptcha = Application.InputBox(\"Please enter 4 digit captcha:\", \"Captcha\", , , , , , 1)\ncaptchaBox.Value = captcha\n'.SwitchToDefaultContent   ''&lt;back to main if in iframe and is required even after submit.\n</code></pre>\n\n<hr>\n\n<ol start=\"2\">\n<li><code>DoEvents</code> and loop until desired length:</li>\n</ol>\n\n<p>Code</p>\n\n<pre><code>Dim submitButton As Object\nSet submitButton =  .FindElementsByCss(\"#cmdSubmit\")\nDo\nDoEvents\nLoop Until submitButtons.count = 0 \n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Dim captcha As Object\nSet captcha =  .FindElementsByCss(\"#txtCaptcha\")\nDo\nDoEvents\nLoop Until len(captcha.value) = 4\n</code></pre>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 57080985, "answer_count": 1, "score": 0, "last_activity_date": 1563388148, "creation_date": 1563370611, "last_edit_date": 1563383520, "question_id": 57077212, "link": "https://stackoverflow.com/questions/57077212/activate-selenium-bot-window-in-excel-vba", "title": "Activate selenium bot window in excel VBA", "body": "<p>I am trying to make the window of the selenium bot activated ...\nFirst I declared this line</p>\n\n<pre><code>Dim mainWin As selenium.Window\n</code></pre>\n\n<p>then after the Get line</p>\n\n<pre><code>.Get \"https://www.kuwaitcourts.gov.kw/searchPages/searchCases.jsp\"\n</code></pre>\n\n<p>I put this line that sets the window</p>\n\n<pre><code>Set mainWin = .Window\n</code></pre>\n\n<p>and before a message box I would like to activate the bot window so I used these lines</p>\n\n<pre><code>        mainWin.Activate\n\n        MsgBox \"Click OK After Entering Captcha\", 64\n</code></pre>\n\n<p>There is no problem at the start of the loop as the bot window is already active but as for the second loop I didn't get the bot window activated\nAny idea how to overcome this point and make the selenium bot window active when needed to be active</p>\n\n<p>Thanks advanced for help</p>\n"}, {"tags": ["excel", "vba", "ms-access", "outlook"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1563529032, "post_id": 57076799, "comment_id": 100738785, "body": "Try using range.CopyPicture"}, {"owner": {"reputation": 27, "user_id": 11203145, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-53A3mtFrJMU/AAAAAAAAAAI/AAAAAAAAABc/AhWQS0ICwUQ/photo.jpg?sz=128", "display_name": "Beno&#238;t Laurent", "link": "https://stackoverflow.com/users/11203145/beno%c3%aet-laurent"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1563529492, "post_id": 57076799, "comment_id": 100739046, "body": "Hi, I change my code to : <code>rng.CopyPicture     TempWB.Worksheets(1).ChartObjects.Add(0, 0, rng.Width, rng.Height).Chart.Paste</code> It copied the range in the correct format (the same way <code>TempWB.Worksheets(1).Range(&quot;A1&quot;).PasteSpecial Paste:=xlPasteAll</code> does by the way), but I believe that the Rangeto HTML function can&#39;t manage pictures, only ranges. So nothing is displayed in the body of the mail."}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1563542779, "post_id": 57076799, "comment_id": 100745681, "body": "When you use the second option be sure to close the workbook; <code>TempWB.Close SaveChanges:=False</code>"}, {"owner": {"reputation": 27, "user_id": 11203145, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-53A3mtFrJMU/AAAAAAAAAAI/AAAAAAAAABc/AhWQS0ICwUQ/photo.jpg?sz=128", "display_name": "Beno&#238;t Laurent", "link": "https://stackoverflow.com/users/11203145/beno%c3%aet-laurent"}, "edited": false, "score": 0, "creation_date": 1563544160, "post_id": 57076799, "comment_id": 100746503, "body": "Good point. I did exactly that and I also quit the Excel Application using <code>xlApp.Quit</code>. However, the Excel app is still open in the task manager."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11203145, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-53A3mtFrJMU/AAAAAAAAAAI/AAAAAAAAABc/AhWQS0ICwUQ/photo.jpg?sz=128", "display_name": "Beno&#238;t Laurent", "link": "https://stackoverflow.com/users/11203145/beno%c3%aet-laurent"}, "edited": false, "score": 0, "creation_date": 1563432301, "post_id": 57080176, "comment_id": 100699345, "body": "Hi, I tried all of the Paste Types using the list in the link you provided already. <code>xlPasteAll</code> copies the range as a picture in the temp workbook and nothing is pasted in the body of the mail. And when I use <code>xlPasteAllUsingSourceTheme</code> I get an error 1004."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 2, "last_activity_date": 1563379694, "creation_date": 1563379694, "answer_id": 57080176, "question_id": 57076799, "link": "https://stackoverflow.com/questions/57076799/pastespecial-does-not-keep-source-formatting-when-copying-range-in-excel/57080176#57080176", "title": "PasteSpecial does not keep source formatting when copying range in Excel", "body": "<p>You need to use the <code>xlPasteAll</code> or <code>xlPasteAllUsingSourceTheme</code> values if you want to preserve formatting. See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlpastetype\" rel=\"nofollow noreferrer\">XlPasteType enumeration</a>.</p>\n"}], "owner": {"reputation": 27, "user_id": 11203145, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-53A3mtFrJMU/AAAAAAAAAAI/AAAAAAAAABc/AhWQS0ICwUQ/photo.jpg?sz=128", "display_name": "Beno&#238;t Laurent", "link": "https://stackoverflow.com/users/11203145/beno%c3%aet-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1591162656, "creation_date": 1563369388, "last_edit_date": 1591162656, "question_id": 57076799, "link": "https://stackoverflow.com/questions/57076799/pastespecial-does-not-keep-source-formatting-when-copying-range-in-excel", "title": "PasteSpecial does not keep source formatting when copying range in Excel", "body": "<p>I am copying a range of cells from an existing workbook to a temporary workbook and want to keep the exact formatting of the source workbook. \nI'm using a modified version of the RangetoHTML function by Ron de Bruin.</p>\n\n<p>The purpose is to copy a range from the source workbook to the body of a mail.</p>\n\n<p>But, when I run the macro, it pastes the range in the mail <s>only in values</s> in a different format (see link below). All other paste type of the PasteSpecial either fails or give the same result.</p>\n\n<p>I've tried every paste type of the PasteSpecial method with no luck.</p>\n\n<p>If I try to specify more arguments for the PasteSpecial function it throws a 1004 error (I don't need to use anything else than the default values though).</p>\n\n<p>The source workbook has merged cells but I tried removing the merged cells but that didn't change the output.</p>\n\n<p>This code is called multiple times as I want to insert ranges from different workbook. The result is always the correct range but with no formatting.</p>\n\n<p>It is run from Access as I'm trying to run this script from a form. It is in a public module and called when creating the mail body in another module.\nHere is an extract of the part that trows an error when removing the comments:</p>\n\n<pre><code>Public Function RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n\n    Dim xlApp As Excel.Application\n    Dim TempWB As Excel.workbook\n\n    Set TempWB = xlApp.Workbooks.Add(1)\n    rng.Copy 'This is passed as an argument of the RangetoHTML function\n    TempWB.Worksheets(1).Range(\"A1\").PasteSpecial Paste:=xlPasteValues ', Operation:=-4142, SkipBlanks:=True, Transpose:=False\n    TempWB.Worksheets(1).Range(\"A1\").PasteSpecial Paste:=xlPasteFormats ', Operation:=-4142, SkipBlanks:=True, Transpose:=False\n    TempWB.Worksheets(1).Range(\"A1\").PasteSpecial Paste:=xlPasteColumnWidths ', Operation:=-4142, SkipBlanks:=True, Transpose:=False\n\n'The rest is similar to the original version of RangetoHTML\n\n    'Close TempWB\n    TempWB.Close savechanges:=False\n    xlApp.Quit\n\n    Set TempWB = Nothing\n    Set xlApp = Nothing\n\nEnd Function\n</code></pre>\n\n<p>I want the range to be displayed in the body of the mail the same as in the source workbook .</p>\n\n<p>I can't seem to find any problem with this code that will prevent the formatting to be copied over despite all my attempts.</p>\n\n<p><strong>EDIT</strong> :</p>\n\n<p>If I change the line  :</p>\n\n<pre><code>Set TempWB = xlApp.Workbooks.Add(1)\n</code></pre>\n\n<p>to :</p>\n\n<pre><code>Set TempWB = Workbooks.Add(1)\n</code></pre>\n\n<p>then the output is in the correct formatting, but there is an instance of Excel that stays open in the task manager after the sub ends.</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>Here is some screenshots to help explain the issue (with sensitive information blurred).</p>\n\n<p>This is the output I'm expecting:\n<img src=\"https://i.stack.imgur.com/BCmKi.png\" alt=\"Correct output\"></p>\n\n<p>And here is the actual result I get when using the code provided above:\n<img src=\"https://i.stack.imgur.com/l4kZal.png\" alt=\"What I got\"></p>\n\n<p>I've checked the content of the temp file where the table is pasted and the formatting is identical to what is pasted in the mail body. That tells me that the <code>PasteSpecial</code> is the culprit here and not the rest of the RangetoHTML function.</p>\n\n<p><strong>EDIT 3:</strong></p>\n\n<p>I also tried to use the plain <code>Paste</code> function and I got the same result as pictured above:</p>\n\n<pre><code>rng.Copy\nTempWB.Worksheets(1).Paste\n</code></pre>\n\n<p><strong><code>PasteSpecial</code> actually does nothing no matter which arguments I provide.</strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 62, "user_id": 11673304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368dcb9a50d5cfc7e27d6fc730d77684?s=128&d=identicon&r=PG&f=1", "display_name": "tmsdajpa", "link": "https://stackoverflow.com/users/11673304/tmsdajpa"}, "edited": false, "score": 0, "creation_date": 1563369114, "post_id": 57076630, "comment_id": 100676569, "body": "What format are the numbers in?"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1563369497, "post_id": 57076630, "comment_id": 100676869, "body": "Yes, formatting might be the issue. On my side (UK settings) comma is a &quot;thousands separator&quot;, meaning that 1,652 is treated as a valid number (one thousand and 652), while 0.903 is treated as General (meaning it isn&#39;t recognised by Excel as a number, that is why your code is skipping these cells). I&#39;d also suggest to modify your code a little bit and not loop through all cells in column BI (it makes the whole process very slow)."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1563370394, "post_id": 57076630, "comment_id": 100677439, "body": "In doing a little testing, Excel will recognize numbers if you use <code>.NumberFormat = &quot;# ###.##0&quot;</code>, where the gap is the thousands place (comma in US, dot in EU); I have not been able to do the same with a decimal (using NumberFormat).  If you use <code>.Replace What:=&quot;.&quot;, Replacement:=&quot; &quot;</code> (for US equivalent), you will end up with a string, not a number.  Inferring from the above two points, that I cannot get the number format to allow skipping the decimal nor does replacing the decimal allow the value to stay a number, I would say that you cannot get both criteria met without reading from VBA (UDF)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1563370494, "post_id": 57076630, "comment_id": 100677512, "body": "Have you tried <code>=VALUE()</code> and then pasting the values back?  It might work as I think it looks at the language of the workbook."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1563439688, "post_id": 57076630, "comment_id": 100703056, "body": "Are you sure that you have any non-breakable space (Chr(160)) in the original cells?"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1563440619, "post_id": 57076630, "comment_id": 100703561, "body": "@z32a7ul in some cells below yes I am sure."}], "answers": [{"comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1563376905, "post_id": 57077480, "comment_id": 100681621, "body": "No I actually wanted to end with 1.652 but my code changes the values to 1652 Except for prices below 1 in which case 0.903 doesn&#39;t change"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1563378022, "post_id": 57077480, "comment_id": 100682267, "body": "@Pierre44 so you&#39;re just looking to change <code>Columns(&quot;BI&quot;).NumberFormat = &quot;#.##0&quot;</code> rather than &quot;#,##0&quot;?  Might even be affected by <code>DecimalSeparator</code> which is under <code>Application</code> (i&#39;m not positive how that works, considering the decomal place is a regional system setting)"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1563378583, "post_id": 57077480, "comment_id": 100682613, "body": "No it s rather that Excel couldn&#39;t recognize the values in the cells. In Excel you just need to click on the cell and press enter. But a"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1563378708, "post_id": 57077480, "comment_id": 100682682, "body": "@Pierre44 So if I&#39;m understanding correctly, your issue isn&#39;t particularly your code but getting Excel to recognize numbers at all?  <code>Columns(&quot;BI&quot;).TextToColumns</code> would resolve that issue.  I apologize if I&#39;m not getting the gist of your issue; i am trying to pair what you are saying in these comments with your post, which doesn&#39;t clearly state current to desired situation."}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1563378810, "post_id": 57077480, "comment_id": 100682750, "body": "I change the question/the code to make it only about the main topic. The rest is probably just adding confusion"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1563379118, "post_id": 57077480, "comment_id": 100682921, "body": "@Pierre44 Might I request a clear statement about what your current situation is (e.g., I have an array of strings which are not recognized as numbers, such as 1,652) and what your desired output is (e.g., 1.652), and <a href=\"https://stackoverflow.com/posts/57076630/edit\">put that into your Post</a>?  I read the update to read &quot;i want to keep the comma&quot; but that still leaves me with questions about your values/strings."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1563371909, "last_edit_date": 1563371909, "creation_date": 1563371340, "answer_id": 57077480, "question_id": 57076630, "link": "https://stackoverflow.com/questions/57076630/why-does-replacex-chr160-replaces-empty-space-and-comma-instead-of-only-empt/57077480#57077480", "title": "Why does Replace(x,Chr(160)) replaces Empty Space AND comma instead of only Empty Space", "body": "<p>Wait a sec... I think I confused what the issue is with my first comment... </p>\n\n<p>You want decimal places to have no decimal places and no space between them? </p>\n\n<pre><code>For i = top to bottom 'define these\n    Cell(i,\"BI\").value = Cell(i,\"BI\").value*1000 \nNext i\nColumns(\"BI\").Numberformat = \"###0\"\n</code></pre>\n\n<p>Just multiply by 1k, since you have 3 decimal places.</p>\n\n<hr>\n\n<p>Adding a non-loop alternative for the multiply by 1k:</p>\n\n<pre><code>dim rng as range\nset rng = range(cells(top,\"BI\"),cells(bottom,\"BI\")) 'define top and bottom\nrng = Evaluate(rng.address &amp; \"*1000\")\nrng.Numberformat = \"###0\"\n</code></pre>\n\n<hr>\n\n<p>If I am understanding correctly, you would be going from:</p>\n\n<pre><code>Old    |    New\n1.652  |    1652\n0.903  |    903\n0.816  |    816 \n</code></pre>\n\n<p>If you want that leading 0, you can format with <code>rng.Numberformat = \"0000\"</code>and it looks like:</p>\n\n<pre><code>Old    |    New\n1.652  |    1652\n0.903  |    0903\n0.816  |    0816 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 0, "last_activity_date": 1563444559, "last_edit_date": 1563444559, "creation_date": 1563441728, "answer_id": 57091180, "question_id": 57076630, "link": "https://stackoverflow.com/questions/57076630/why-does-replacex-chr160-replaces-empty-space-and-comma-instead-of-only-empt/57091180#57091180", "title": "Why does Replace(x,Chr(160)) replaces Empty Space AND comma instead of only Empty Space", "body": "<p>I think you shouldn't do this replacing in case of cells that contain numbers because Replace works with Strings and the Cell's Value is formatted according to many rules, which may be different by your location.</p>\n\n<p>So, I think you should do it only for Cells that contain Strings. I added an If for this purpose to your code:</p>\n\n<pre><code>Sub Deletespaces()\n    Dim cell As Range: For Each cell In ActiveSheet.UsedRange\n        If VarType(cell.Value) = vbString Then\n            cell.Value = Replace(cell.Value, Chr(160), \"\")\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Note: I don't think other value types could contain a non-breakable space.</p>\n"}], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563444559, "creation_date": 1563368884, "last_edit_date": 1563431987, "question_id": 57076630, "link": "https://stackoverflow.com/questions/57076630/why-does-replacex-chr160-replaces-empty-space-and-comma-instead-of-only-empt", "title": "Why does Replace(x,Chr(160)) replaces Empty Space AND comma instead of only Empty Space", "body": "<p>My goal is to delete some spaces on my whole Sheet. The code below works but is also taking off the Comma from some numbers making the numbers wrong. </p>\n\n<pre><code>Sub Deletespaces()\n\nDim cell As Range\n\nFor Each cell In ActiveSheet.UsedRange\n\ncell.Value = Replace(cell.Value, Chr(160), \"\")\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/RUBxU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RUBxU.jpg\" alt=\"enter image description here\"></a>     = = = = > \n<a href=\"https://i.stack.imgur.com/A6Lzp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A6Lzp.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Somehow for every number above 1.00, the code is taking the <code>,</code> out.<br>\nHow should I correct my code to keep the comma</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1563368947, "post_id": 57076414, "comment_id": 100676450, "body": "From the line of code you have, you need to change it to <code>Set rs = conn.Execute(&quot;SELECT vfrhma000 *from vfrhma000 where maenume = &quot;&quot;&quot; &amp; textbox1.value &amp; &quot;&quot;&quot;&quot;)</code> (assuming that the value from the textbox should be in double-quotes."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11029402, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-drAyTXpTQNA/AAAAAAAAAAI/AAAAAAAABnU/npReKzWTFw4/photo.jpg?sz=128", "display_name": "Otoniel Rincon", "link": "https://stackoverflow.com/users/11029402/otoniel-rincon"}, "edited": false, "score": 0, "creation_date": 1563370368, "post_id": 57076825, "comment_id": 100677422, "body": "this work great thank yo so much!!! Set rs = conn.Execute(&quot;SELECT * from vfrhma000 where maenume = &quot; &amp; textbox1.value)"}, {"owner": {"reputation": 1, "user_id": 11029402, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-drAyTXpTQNA/AAAAAAAAAAI/AAAAAAAABnU/npReKzWTFw4/photo.jpg?sz=128", "display_name": "Otoniel Rincon", "link": "https://stackoverflow.com/users/11029402/otoniel-rincon"}, "edited": false, "score": 0, "creation_date": 1563417431, "post_id": 57076825, "comment_id": 100695482, "body": "Sorry guys. Now im wondering what if i want to reference an specific cell insted of a text box like this: Set rs = conn.Execute(&quot;SELECT em_descri,maenomi,maenomb,maeapel,maecedun, maesexo, maesuel,&quot; _          &amp; &quot;maefena, maefein, puetitu, ub_descri,of_descri,np_descri, cTipo_empl &quot; _          &amp; &quot;from vfrhma000 where maenomi= &#39;%&quot; &amp; Worksheets(&quot;sheet1&quot;).Range(&quot;e9&quot;).Value&amp;&quot;%&#39;&quot;)"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1563431170, "last_edit_date": 1563431170, "creation_date": 1563369498, "answer_id": 57076825, "question_id": 57076414, "link": "https://stackoverflow.com/questions/57076414/how-to-dynamicly-use-a-text-box-to-query-in-vba-a-excel/57076825#57076825", "title": "How to dynamicly use a text box to query in vba a excel", "body": "<p>You are sending <em>textbox1.value</em> as search criteria. Everything within the quotes is left untouched by VBA.</p>\n\n<p>If you want to get the content of the textbox, write it like this:</p>\n\n<pre><code>Set rs = conn.Execute(\"SELECT * from vfrhma000 where maenume = \" &amp; textbox1.value)\n</code></pre>\n\n<p>Now, the content of the textbox will be read by the VBA runtime and concatenated to your SQL statement.</p>\n\n<p>If you are searching for a string, you will need to put (single) quotes around your search string: </p>\n\n<pre><code>Set rs = conn.Execute(\"SELECT * from vfrhma000 where maenume = '\" &amp; textbox1.value &amp; \"'\")\n</code></pre>\n\n<p>In any case, you should be aware that if the textbox is used to get the search criteria from the user, you are vulnerable to <a href=\"https://en.wikipedia.org/wiki/SQL_injection\" rel=\"nofollow noreferrer\"><em>SQL injection</em></a>. Unless you are just playing around, you should take that serious. Have a look to <a href=\"https://stackoverflow.com/a/49509616/7599798\">https://stackoverflow.com/a/49509616/7599798</a> to get an idea of how to use parameters to a query. </p>\n\n<p><strong>Update</strong>\nIf the sql statement gets more complicated, it's a good idea to write it in a variable before executing it. If it fails, you can dump the content to the immediate window, check if it looks okay and try to execute it directly against the database (new query for access, SQL*Plus or SQL developer for Oracle, SQL Management Studio for SQL Server ...)</p>\n\n<pre><code>Dim sql as string, searchValue as string\nsearchValue = Worksheets(\"sheet1\").Range(\"e9\").Value\nsql = \"SELECT * from vfrhma000 where maenomi = '%\" &amp; searchValue &amp; \"%'\"\nDebug.Print sql\nSet rs = conn.Execute(searchValue)\n</code></pre>\n\n<p>In your case, maybe you have to change the <code>=</code> into a <code>like</code>. Also, you may want to check if cell E9 contains a valid search term.</p>\n"}], "owner": {"reputation": 1, "user_id": 11029402, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-drAyTXpTQNA/AAAAAAAAAAI/AAAAAAAABnU/npReKzWTFw4/photo.jpg?sz=128", "display_name": "Otoniel Rincon", "link": "https://stackoverflow.com/users/11029402/otoniel-rincon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563431170, "creation_date": 1563368286, "last_edit_date": 1563368444, "question_id": 57076414, "link": "https://stackoverflow.com/questions/57076414/how-to-dynamicly-use-a-text-box-to-query-in-vba-a-excel", "title": "How to dynamicly use a text box to query in vba a excel", "body": "<p>i want to use a textbox to dynamically change the query</p>\n\n<p>What am i doing wrong?</p>\n\n<pre><code>Set rs = conn.Execute(\"SELECT vfrhma000 *from vfrhma000 where maenume = textbox1.value\")\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "crash"], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 1401286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f754444b21036c3a51bf8eb4fde12e59?s=128&d=identicon&r=PG", "display_name": "Andrew Richards", "link": "https://stackoverflow.com/users/1401286/andrew-richards"}, "is_accepted": false, "score": 0, "last_activity_date": 1563370342, "creation_date": 1563370342, "answer_id": 57077122, "question_id": 57076344, "link": "https://stackoverflow.com/questions/57076344/ms-access-crashes-every-time-i-use-immediate-window/57077122#57077122", "title": "MS Access crashes every time I use Immediate Window", "body": "<p>Okay, so I've just found the solution. </p>\n\n<p>Using the old principle of \"What's changed since I last got this to work\" I discovered that it seems to be a problem with my installation of Dextop.</p>\n\n<p>I wanted to have a way of having multiple virtual desktops, and the built-in virtual desktops system in Windows 10 wouldn't cut it. Every time I do anything in SSMS on one desktop, it's reflected in the other. </p>\n\n<p>So, I had a look around and found good reviews for Dextop. It seemed to work well - I have two different databases open in Access (one on each Desktop), and two different instances of SSMS, one pointing at each server. However, it seems to be this that was causing the Immediate Window to crash the relevant application.</p>\n\n<p>Exit Dextop - all works well. \nRestart Dextop - symptom immediately re-appears.</p>\n\n<p>So now to try to find another alternative to Dextop....</p>\n"}], "owner": {"reputation": 133, "user_id": 1401286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f754444b21036c3a51bf8eb4fde12e59?s=128&d=identicon&r=PG", "display_name": "Andrew Richards", "link": "https://stackoverflow.com/users/1401286/andrew-richards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563370342, "creation_date": 1563368071, "last_edit_date": 1563368178, "question_id": 57076344, "link": "https://stackoverflow.com/questions/57076344/ms-access-crashes-every-time-i-use-immediate-window", "title": "MS Access crashes every time I use Immediate Window", "body": "<p>Every time I use the MS Access Immediate Window within the VBA Editor, Access crashes if I type any procedure name followed by the spacebar.</p>\n\n<p>For example, I have a procedure called \"CreateCEUploadFile\" which takes a string parameter for a year. So, I'd like to type \"CreateCEUploadFile \"2019\". However, as soon as I hit the spacebar after the e of File, Access freezes for a second, then crashes.</p>\n\n<p>I initially thought this was specific to a database I've created. This is a database which was initially created 7 years ago, and has been worked on steadily over that time. So, I tried:</p>\n\n<ol>\n<li>Compiling, then compacting and repairing. No change.</li>\n<li>Decompiling the file. No change. </li>\n<li>Re-compiling the file. No change</li>\n<li>Creating a new database file, importing all objects. No change.</li>\n<li>Restarting the PC. No change.</li>\n<li>Removing Office (Office 365 Pro), restarting the PC, re-installing Office, re-starting the PC. No change.</li>\n</ol>\n\n<p>I've now experimented, and discovered that the same issue occurs in all database files on this PC (a laptop that I've been using without issues for around 2 years). It also occurs with any call to any function (whether my own or built in), as soon as I hit a character after the function name.</p>\n\n<p>In the immediate window:</p>\n\n<pre><code>? now  --&gt; works\n\n? date --&gt; works\n\n? format( --&gt; crashes as soon as I hit the spacebar`\n</code></pre>\n\n<p>I have now just discovered that this same issue occurs in MS Excel's VBA Immediate Window too...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1563367601, "post_id": 57076060, "comment_id": 100675522, "body": "@JvdV I&#39;m still getting type mismatch error when adding multiple <code>&quot;</code> to the separator"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1563367608, "post_id": 57076060, "comment_id": 100675527, "body": "What do you want to do with an &quot;&amp;&quot; in a range? <code>A5:A9&amp; B5:B9</code> is not a valid range AFAIK"}, {"owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1563367690, "post_id": 57076060, "comment_id": 100675570, "body": "@PatrickHonorez the code works perfectly fine the way it is with that range. I just can&#39;t seem to add a separator in between the ranges EDIT: In fact, the code DOESN&#39;T work without the &quot;&amp;&quot; before the B range..."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1563367934, "creation_date": 1563367934, "answer_id": 57076313, "question_id": 57076060, "link": "https://stackoverflow.com/questions/57076060/how-to-add-a-separator-to-evaluate-function-in-vba/57076313#57076313", "title": "How to add a separator to Evaluate function in VBA?", "body": "<p>You need quotes and ampersands inside your formula string:</p>\n\n<pre><code>r = wsCopy.Evaluate(\"=A5:A\" &amp; DefCopyLastRow &amp; \"&amp;\"\" - \"\"&amp;B5:B\" &amp; DefCopyLastRow)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 57076313, "answer_count": 1, "score": 0, "last_activity_date": 1563367934, "creation_date": 1563367175, "question_id": 57076060, "link": "https://stackoverflow.com/questions/57076060/how-to-add-a-separator-to-evaluate-function-in-vba", "title": "How to add a separator to Evaluate function in VBA?", "body": "<p>I have a code that takes two columns from a Pivot Table, combines &amp; copies the values and outputs the combined output into another table range. The only problem is that these values are combined together without any spaces or separators at all. I would like to add \" - \" between the values.</p>\n\n<p>I've tried adding \"- \" between the Ranges and get \"Type mismatch\" errors no matter how I try to add it.</p>\n\n<p>One of my tries:</p>\n\n<pre><code>r = wsCopy.Evaluate(\"=A5:A\" &amp; DefCopyLastRow &amp; \"- \" &amp; \"&amp; B5:B\" &amp; DefCopyLastRow)\n</code></pre>\n\n<p>Full original code:</p>\n\n<pre><code>Dim r\n\nr = wsCopy.Evaluate(\"=A5:A\" &amp; DefCopyLastRow &amp; \"&amp; B5:B\" &amp; DefCopyLastRow)\nwsDest.Range(\"J\" &amp; DefDestLastRow).Resize(UBound(r, 1), 1).Value = r\n</code></pre>\n\n<p>Input:</p>\n\n<p><a href=\"https://i.stack.imgur.com/C9u4b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C9u4b.png\" alt=\"enter image description here\"></a></p>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5BuTV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5BuTV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["python", "excel", "vba", "plot"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1563373735, "post_id": 57075878, "comment_id": 100679736, "body": "As far as moving points with a mouse, possible but not easy. See <a href=\"https://peltiertech.com/chart-events-microsoft-excel/\" rel=\"nofollow noreferrer\">this article</a> about how to enable events for embedded charts. Once you enable them, the trickiest part is relating mouse coordinates and axes coordinates. It can be a headache to get right. It might be easiest to have a 1-point data series and figure out how to detect when it is selected."}], "answers": [{"comments": [{"owner": {"reputation": 5466, "user_id": 180685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5253bc10e05e82c3032158a0c319f045?s=128&d=identicon&r=PG", "display_name": "MoeAmine", "link": "https://stackoverflow.com/users/180685/moeamine"}, "edited": false, "score": 0, "creation_date": 1563376562, "post_id": 57077348, "comment_id": 100681439, "body": "While using the function in a macro, I am calling &quot;thisLine&quot; as &quot;Straight Connector 2&quot; and &quot;Chart&quot; as &quot;Chart 1&quot;. However, I am getting an error: Type mismatch for thisLine. Can you show me how you&#39;re referring to thisLine?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 5466, "user_id": 180685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5253bc10e05e82c3032158a0c319f045?s=128&d=identicon&r=PG", "display_name": "MoeAmine", "link": "https://stackoverflow.com/users/180685/moeamine"}, "edited": false, "score": 0, "creation_date": 1563378335, "post_id": 57077348, "comment_id": 100682457, "body": "<code>thisLine As Shape, cht As Chart</code>. These are the <i>objects</i>, not their names or strings. So, e.g., <code>GetSlopeWithinChart(ActiveSheet.ChartObjects(1).Chart.Shapes&zwnj;&#8203;(1), ActiveSheet.ChartObjects(1).Chart)</code>. Pass the actual objects to the function. NB this was tested using a line that <i>belongs to the Chart</i> rather than the sheet."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 5466, "user_id": 180685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5253bc10e05e82c3032158a0c319f045?s=128&d=identicon&r=PG", "display_name": "MoeAmine", "link": "https://stackoverflow.com/users/180685/moeamine"}, "edited": false, "score": 0, "creation_date": 1563378592, "post_id": 57077348, "comment_id": 100682620, "body": "I&#39;ve edited the answer to include the test procedure <code>foo</code> that I used."}, {"owner": {"reputation": 5466, "user_id": 180685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5253bc10e05e82c3032158a0c319f045?s=128&d=identicon&r=PG", "display_name": "MoeAmine", "link": "https://stackoverflow.com/users/180685/moeamine"}, "edited": false, "score": 0, "creation_date": 1563379840, "post_id": 57077348, "comment_id": 100683360, "body": "Thanks David, it is working properly. I will be trying to improve the accuracy as it is off around 4% in my computer. I really like your approach!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 5466, "user_id": 180685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5253bc10e05e82c3032158a0c319f045?s=128&d=identicon&r=PG", "display_name": "MoeAmine", "link": "https://stackoverflow.com/users/180685/moeamine"}, "edited": false, "score": 0, "creation_date": 1563381228, "post_id": 57077348, "comment_id": 100684074, "body": "Cheers. This was an interesting problem to solve :)  Some other thing you <i>might</i> need to consider is the thickness of the axes which may slightly affect the size of the plot area -- there&#39;s a few little things like that which might get in the way. But ultimately, if you do this to 1 or maybe 2 decimals you should be pretty accurate in most cases."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1563378546, "last_edit_date": 1563378546, "creation_date": 1563370948, "answer_id": 57077348, "question_id": 57075878, "link": "https://stackoverflow.com/questions/57075878/how-to-obtain-a-slope-by-moving-a-line/57077348#57077348", "title": "How to obtain a slope by moving a line?", "body": "<p>Obtaining the actual (literal) slope of the line is fairly straightforward, even though the line doesn't expose it's endpoints, we can use its <code>.Top</code>, <code>.Left</code>, <code>.Height</code> and <code>.Width</code> properties to derive those, and then apply the standard slope formula:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function GetSlope(thisLine As Shape)\nDim ret\nIf Not IsLine(thisLine) Then\n    ret = CVErr(13)\n    GoTo EarlyExit\nEnd If\n\nDim x1 As Single, x2 As Single, y1 As Single, y2 As Single\n\nWith thisLine\n    x1 = .Left\n    x2 = .Left + .Width\n    y1 = .Top\n    y2 = .Top + .Height\nEnd With\n\nret = (y2 - y1) / (x2 - x1)\nEarlyExit:\n    GetSlope = ret\nEnd Function\n\nPrivate Function IsLine(shp As Shape) As Boolean\nIsLine = shp.Type = msoLine\nEnd Function\n</code></pre>\n\n<p><strong>HOWEVER</strong> (and this may be a deal-breaker depending on what you actually hope to obtain here), this is <strong>NOT LIKELY</strong> the slope relative to the plot area, which depends on the size and scale of the axes. For example, the following chart plots a series of x/y coordinates and the slope given as <code>y = 2x</code>, yet the slope given by the <code>GetSlope</code> function (for a Line shape with an approximately same slope) returns <code>0.9166661</code> which is the literal slope of this line from its positional coordinates.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mgHYK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mgHYK.png\" alt=\"enter image description here\"></a></p>\n\n<p>It seems you may need a further hack to approximate (I'm not sure how precisely you can implement this) the X/Y coordinates of the line's endpoints within the plot/scale. I think this will get you there, or mostly there, within some reasonable precision:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nSub foo()\nDim cObj As ChartObject\nDim cht As Chart\nDim shpLine As Shape\nDim shp As Shape\n\nSet cObj = Sheet1.ChartObjects(1)\nSet cht = cObj.Chart\nSet shpLine = cht.Shapes(1)\n\nMsgBox GetSlopeWithinChart(shpLine, cht)\n\nEnd Sub\nFunction GetSlopeWithinChart(thisLine As Shape, cht As Chart)\nDim ret\nIf Not IsLine(thisLine) Then\n    ret = CVErr(13)\n    GoTo EarlyExit\nEnd If\n\nDim x1 As Single, x2 As Single, y1 As Single, y2 As Single\nDim plot As PlotArea\nDim xFactor As Double\nDim yFactor As Double\n\nSet plot = cht.PlotArea\n\nxFactor = getScaleFactor(plot.Width, cht.Axes(xlCategory, xlPrimary))\nyFactor = getScaleFactor(plot.Height, cht.Axes(xlValue, xlPrimary))\n\nWith thisLine\n    x1 = .Left\n    x2 = .Left + .Width\n    y1 = .Top\n    y2 = .Top + .Height\nEnd With\n\nret = ((y2 - y1) / (x2 - x1)) / (yFactor / xFactor)\n\nEarlyExit:\n    GetSlopeWithinChart = ret\n\nEnd Function\nPrivate Function getScaleFactor(size As Single, ax As Axis)\n    getScaleFactor = size / (ax.MaximumScale - ax.MinimumScale)\nEnd Function\nPrivate Function IsLine(shp As Shape) As Boolean\nIsLine = shp.Type = msoLine\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/OZ2v9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OZ2v9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Another test with a slope which we expect to be ~10:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DyZ1A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DyZ1A.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>NOTE:</strong> This does not seem to account for the \"orientation\" of the line, so it won't properly give you a negative slope value for a line that's oriented with a downward slope. I'm not sure there's an easy way to derive the line's orientation, so I'll leave that up to you :) Here we see this, a positive slope value even though the line appears oriented downwards:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WkDuC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WkDuC.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5466, "user_id": 180685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5253bc10e05e82c3032158a0c319f045?s=128&d=identicon&r=PG", "display_name": "MoeAmine", "link": "https://stackoverflow.com/users/180685/moeamine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 2, "accepted_answer_id": 57077348, "answer_count": 1, "score": -1, "last_activity_date": 1563378546, "creation_date": 1563366522, "question_id": 57075878, "link": "https://stackoverflow.com/questions/57075878/how-to-obtain-a-slope-by-moving-a-line", "title": "How to obtain a slope by moving a line?", "body": "<p>I am wondering if there is any possible way how to obtain the slope of a line that I move manually on a graph. All is need is the slope (m) and I do not care about the R square, etc. The image below is just for illustration.</p>\n\n<p>NOTE: The line should be moved manually using the cursor.</p>\n\n<p>It might be not possible in excel, but if you have any idea where I should start looking, it will be useful! Thanks.</p>\n\n<p><a href=\"https://i.stack.imgur.com/r2jyB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r2jyB.png\" alt=\"\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 5919, "user_id": 627885, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/2xK9I.jpg?s=128&g=1", "display_name": "Ram Singh", "link": "https://stackoverflow.com/users/627885/ram-singh"}, "edited": false, "score": 0, "creation_date": 1563367749, "post_id": 57075981, "comment_id": 100675608, "body": "I&#39;m not creating these document myself. these comes from outer resources and have hundreds of pages. so i was trying to do it using Macro"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5919, "user_id": 627885, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/2xK9I.jpg?s=128&g=1", "display_name": "Ram Singh", "link": "https://stackoverflow.com/users/627885/ram-singh"}, "edited": false, "score": 0, "creation_date": 1563368153, "post_id": 57075981, "comment_id": 100675903, "body": "Same procedure just need to find the positions where the section breaks need to be inserted. Don&#39;t insert blank pages."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1563367251, "last_edit_date": 1563367251, "creation_date": 1563366915, "answer_id": 57075981, "question_id": 57075658, "link": "https://stackoverflow.com/questions/57075658/adding-blank-page-where-text-ends-on-an-odd-page/57075981#57075981", "title": "Adding blank page where text ends on an odd page", "body": "<p>Actually you just need to insert the correct even/odd section breaks and it will automatically beginn the next section on a even or odd page. So you will never have to care about it.</p>\n\n<p>For example if you have </p>\n\n<blockquote>\n<pre><code>Section 1\n\n--- Even Page (section break) ---\n\nSection 2\n</code></pre>\n</blockquote>\n\n<p>Then <em>Section 2</em> will <strong>always</strong> start on a even page, no matter if <em>Section 1</em> ended even or odd.</p>\n\n<p><a href=\"https://i.stack.imgur.com/S9j6o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S9j6o.png\" alt=\"enter image description here\"></a></p>\n\n<p>See <a href=\"https://support.office.com/en-us/article/insert-a-section-break-eef20fd8-e38c-4ba6-a027-e503bdf8375c\" rel=\"nofollow noreferrer\">Insert a section break</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 1, "last_activity_date": 1563445135, "creation_date": 1563445135, "answer_id": 57092265, "question_id": 57075658, "link": "https://stackoverflow.com/questions/57075658/adding-blank-page-where-text-ends-on-an-odd-page/57092265#57092265", "title": "Adding blank page where text ends on an odd page", "body": "<p>The issue is caused by the page break is part of the same paragraph as the last line of the page and the first line of the next page.</p>\n\n<p>Using the code below will work.</p>\n\n<pre><code>Sub Test()\n  InsertSectionBreaks \"S U M M A R Y             \"\n  InsertSectionBreaks \"R O Y A L T Y             \"\nEnd Sub\n\nSub InsertSectionBreaks(FindText As String)\n  Dim FindRange As Word.Range, SectionRange As Word.Range\n  Dim Found As Boolean\n\n  Set FindRange = ActiveDocument.Content\n\n  ' Find next section based on text, insert odd page section break just before\n  FindRange.Find.ClearFormatting\n  With FindRange.Find\n    .Text = FindText\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    Found = .Execute\n  End With\n\n  Do While Found\n    If FindRange.Information(wdActiveEndAdjustedPageNumber) &gt; 1 Then\n      Set SectionRange = FindRange.Duplicate\n      With SectionRange\n        .Expand wdParagraph\n    'move start of range until we get the page break\n    .MoveStartUntil Cset:=Chr(12)\n    .Collapse wdCollapseStart\n    'add a new paragraph to separate the page break\n    .InsertParagraph\n    'move the range to include only the page break and replace it with a section break\n        .Move wdCharacter\n        .MoveEnd wdCharacter\n        .Delete wdCharacter\n        .InsertBreak Type:=wdSectionBreakOddPage\n      End With\n    End If\n    FindRange.Collapse wdCollapseEnd\n    Found = FindRange.Find.Execute\n  Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5919, "user_id": 627885, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/2xK9I.jpg?s=128&g=1", "display_name": "Ram Singh", "link": "https://stackoverflow.com/users/627885/ram-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 57092265, "answer_count": 2, "score": 0, "last_activity_date": 1579541447, "creation_date": 1563365855, "last_edit_date": 1579541447, "question_id": 57075658, "link": "https://stackoverflow.com/questions/57075658/adding-blank-page-where-text-ends-on-an-odd-page", "title": "Adding blank page where text ends on an odd page", "body": "<p>We are using a Duplex printer and we want Summary and Royalty to start on a new page.</p>\n\n<p>Summary is always one page, means we need to insert a blank page after this page. </p>\n\n<p>There is another section i.e. Royalty, if Royalty finishes on an odd page number then we need to add a blank page. </p>\n\n<p>My Code is:</p>\n\n<pre><code>Sub Test()\n    InsertSectionBreaks \"S U M M A R Y             \"\n    InsertSectionBreaks \"R O Y A L T Y             \"\nEnd Sub\n\n\nSub InsertSectionBreaks(FindText As String)\n    Dim FindRange As Word.Range, SectionRange As Word.Range\n    Dim Found As Boolean\n\n    Set FindRange = ActiveDocument.Content\n\n    ' Find next section based on text, insert odd page section break just before\n    FindRange.Find.ClearFormatting\n    With FindRange.Find\n        .Text = FindText\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        Found = .Execute\n    End With\n\n    Do While Found\n        'avoid adding a section break at beginning of document\n        If FindRange.Information(wdActiveEndAdjustedPageNumber) &gt; 1 Then\n            Set SectionRange = FindRange.Duplicate\n            With SectionRange\n                .Expand wdParagraph\n                .Collapse wdCollapseStart\n                .InsertBreak Type:=wdSectionBreakOddPage\n            End With\n        End If\n        FindRange.Collapse wdCollapseEnd\n        Found = FindRange.Find.Execute\n    Loop\nEnd Sub\n</code></pre>\n\n<p>But this is throwing the last line of page to blank page.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1563366049, "creation_date": 1563366049, "answer_id": 57075725, "question_id": 57075543, "link": "https://stackoverflow.com/questions/57075543/finding-a-number-in-a-string-in-excel-vba/57075725#57075725", "title": "Finding a number in a string in excel VBA", "body": "<p>Regex is the best way, but a loop can also work:</p>\n\n<pre><code>Sub dural()\n    Dim s As String, i As Long\n    s = \"james\"\n    For i = 0 To 9\n        If InStr(1, s, CStr(i)) &gt; 0 Then\n            MsgBox (\"Number Found In Your Name. Please Correct That!!\")\n            Exit Sub\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 11712978, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bYsTFSLlvEQ/AAAAAAAAAAI/AAAAAAAAAJ0/-UmjRjPejks/photo.jpg?sz=128", "display_name": "Xander Cage", "link": "https://stackoverflow.com/users/11712978/xander-cage"}, "edited": false, "score": 0, "creation_date": 1563371386, "post_id": 57075786, "comment_id": 100678108, "body": "Can it stop loading the codes below it? That&#39;s what I need now."}, {"owner": {"reputation": 101, "user_id": 11280799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZvMNSZWojsE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuzF2ZK7J3fl-ajDYT6mhYyalAQA/mo/photo.jpg?sz=128", "display_name": "Aman", "link": "https://stackoverflow.com/users/11280799/aman"}, "reply_to_user": {"reputation": 19, "user_id": 11712978, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bYsTFSLlvEQ/AAAAAAAAAAI/AAAAAAAAAJ0/-UmjRjPejks/photo.jpg?sz=128", "display_name": "Xander Cage", "link": "https://stackoverflow.com/users/11712978/xander-cage"}, "edited": false, "score": 0, "creation_date": 1564036287, "post_id": 57075786, "comment_id": 100899847, "body": "I tried doing this, and it runs code inside If everytime. it does not have anything to check."}], "tags": [], "owner": {"reputation": 101, "user_id": 11280799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZvMNSZWojsE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuzF2ZK7J3fl-ajDYT6mhYyalAQA/mo/photo.jpg?sz=128", "display_name": "Aman", "link": "https://stackoverflow.com/users/11280799/aman"}, "is_accepted": true, "score": 1, "last_activity_date": 1563366260, "creation_date": 1563366260, "answer_id": 57075786, "question_id": 57075543, "link": "https://stackoverflow.com/questions/57075543/finding-a-number-in-a-string-in-excel-vba/57075786#57075786", "title": "Finding a number in a string in excel VBA", "body": "<p>InStr function is not boolean, it returns integer value. It will give you nth number of the string(fname), if your searching expression(for example \"0\") is inside string(fname). Otherwise, it returns zero. So, you can try your code like this:</p>\n\n<pre><code>For i=0 to 9\n    If InStr(fname, i)&gt;0 Then\n        MsgBox (\"Number Found In Your Name. Please Correct That!!\")\n    End If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11796107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ldlJl.png?s=128&g=1", "display_name": "DistillerWithComputer", "link": "https://stackoverflow.com/users/11796107/distillerwithcomputer"}, "reply_to_user": {"reputation": 19, "user_id": 11712978, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bYsTFSLlvEQ/AAAAAAAAAAI/AAAAAAAAAJ0/-UmjRjPejks/photo.jpg?sz=128", "display_name": "Xander Cage", "link": "https://stackoverflow.com/users/11712978/xander-cage"}, "edited": false, "score": 0, "creation_date": 1563377104, "post_id": 57075906, "comment_id": 100681739, "body": "I&#39;m not sure what you mean. But you can replace the code you posted with the one in the answers."}, {"owner": {"reputation": 19, "user_id": 11712978, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bYsTFSLlvEQ/AAAAAAAAAAI/AAAAAAAAAJ0/-UmjRjPejks/photo.jpg?sz=128", "display_name": "Xander Cage", "link": "https://stackoverflow.com/users/11712978/xander-cage"}, "edited": false, "score": 0, "creation_date": 1563429863, "post_id": 57075906, "comment_id": 100698405, "body": "after it displays the error message, it shouldn&#39;t run the lines of code below it."}, {"owner": {"reputation": 11, "user_id": 11796107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ldlJl.png?s=128&g=1", "display_name": "DistillerWithComputer", "link": "https://stackoverflow.com/users/11796107/distillerwithcomputer"}, "reply_to_user": {"reputation": 19, "user_id": 11712978, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bYsTFSLlvEQ/AAAAAAAAAAI/AAAAAAAAAJ0/-UmjRjPejks/photo.jpg?sz=128", "display_name": "Xander Cage", "link": "https://stackoverflow.com/users/11712978/xander-cage"}, "edited": false, "score": 0, "creation_date": 1563515393, "post_id": 57075906, "comment_id": 100732572, "body": "I think I understand. There is more code below this part. If you change Exit For into Exit Sub it should work."}], "tags": [], "owner": {"reputation": 11, "user_id": 11796107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ldlJl.png?s=128&g=1", "display_name": "DistillerWithComputer", "link": "https://stackoverflow.com/users/11796107/distillerwithcomputer"}, "is_accepted": false, "score": 1, "last_activity_date": 1563366625, "creation_date": 1563366625, "answer_id": 57075906, "question_id": 57075543, "link": "https://stackoverflow.com/questions/57075543/finding-a-number-in-a-string-in-excel-vba/57075906#57075906", "title": "Finding a number in a string in excel VBA", "body": "<p>Maybe a simple answer, but Cstr() changes integers into strings.</p>\n\n<pre><code>For i = 0 To 9\n    If InStr(fname, CStr(i)) Then\n        MsgBox (\"Number Found In Your Name. Please Correct That!!\")\n        Exit For\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1563366934, "creation_date": 1563366934, "answer_id": 57075992, "question_id": 57075543, "link": "https://stackoverflow.com/questions/57075543/finding-a-number-in-a-string-in-excel-vba/57075992#57075992", "title": "Finding a number in a string in excel VBA", "body": "<p>You could try implement `EVALUATE'</p>\n\n<pre><code>If Evaluate(\"COUNT(FIND(ROW(1:10)-1,\"\"\" &amp; fname &amp; \"\"\"))\") &gt; 0 then\n    Msgbox \"Number Found In Your Name. Please Correct That!!\"\nEnd if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1563369658, "creation_date": 1563369658, "answer_id": 57076880, "question_id": 57075543, "link": "https://stackoverflow.com/questions/57075543/finding-a-number-in-a-string-in-excel-vba/57076880#57076880", "title": "Finding a number in a string in excel VBA", "body": "<p>No loop needed, it can be done with one line:</p>\n\n<pre><code>If Fname like \"*[0-9]*\" Then MsgBox (\"Number Found In Your Name. Please Correct That!!\")\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11712978, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bYsTFSLlvEQ/AAAAAAAAAAI/AAAAAAAAAJ0/-UmjRjPejks/photo.jpg?sz=128", "display_name": "Xander Cage", "link": "https://stackoverflow.com/users/11712978/xander-cage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 57075786, "answer_count": 5, "score": 0, "last_activity_date": 1563428826, "creation_date": 1563365533, "last_edit_date": 1563428826, "question_id": 57075543, "link": "https://stackoverflow.com/questions/57075543/finding-a-number-in-a-string-in-excel-vba", "title": "Finding a number in a string in excel VBA", "body": "<p>I am trying to find a number in a string given via textbox in excel vba and display an error saying it cant continue and after that it must stop from loading the codes below.</p>\n\n<p>fname is Full Name given by the user</p>\n\n<pre><code>If InStr(fname, \"0\") Then\n    MsgBox (\"Number Found In Your Name. Please Correct That!!\")\n\n Dim i(0 To 9) As String\n    i(0) = \"0\"\n    i(1) = \"1\"\n    i(2) = \"2\"\n    i(3) = \"3\"\n    i(4) = \"4\"\n    i(5) = \"5\"\n    i(6) = \"6\"\n    i(7) = \"7\"\n    i(8) = \"8\"\n    i(9) = \"9\"\n\n\nIf InStr(fname, \"0\") Then\n    MsgBox (\"Number Found In Your Name. Please Correct That!!\")\n\nEnd If\n</code></pre>\n\n<p>It is supposed to search in the text given by the user and display an error if it contains a number(list of numbers)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1563366432, "post_id": 57075399, "comment_id": 100674805, "body": "Try the method for Excel 2007 <a href=\"https://support.microsoft.com/en-us/help/884406/a-line-chart-may-plot-gaps-in-lines-when-the-data-range-contains-blank\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 133, "user_id": 4040720, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QvfTgm9_FVA/AAAAAAAAAAI/AAAAAAAAAGc/y3T4WN6XCq8/photo.jpg?sz=128", "display_name": "flamingbird123", "link": "https://stackoverflow.com/users/4040720/flamingbird123"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1563366794, "post_id": 57075399, "comment_id": 100675021, "body": "Hi,   This does work if I am manually selecting the ranges to create the graphs, and I have tried this before. But, I am trying to create the graphs using VBA code within excel and this doesn&#39;t help too much. Thank you though."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1563370928, "post_id": 57075399, "comment_id": 100677792, "body": "What&#39;s the difference between two graphs? Missing values within the range are being sorted out. Also set your chart properties after you have added all the series."}, {"owner": {"reputation": 133, "user_id": 4040720, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QvfTgm9_FVA/AAAAAAAAAAI/AAAAAAAAAGc/y3T4WN6XCq8/photo.jpg?sz=128", "display_name": "flamingbird123", "link": "https://stackoverflow.com/users/4040720/flamingbird123"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1563371433, "post_id": 57075399, "comment_id": 100678140, "body": "The main issue with the 2 graphs. For the first graph I set the range to J10:J40 + other data ranges.   While the second graph is just set to J10:J28 + other data ranges for the extent of the data.   I have another form in which the user enters a date range and it pulls all the data between those 2 dates from a data table.   So this would have to graph more than J:10 to J:28 (Graph 2) if the date range is higher. If i set the ranges to 500, everything it would look like graph 3? If that makes sense."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1563392748, "post_id": 57075399, "comment_id": 100689200, "body": "With option 1, blank cells in the used range are interpolated, and so your graph has all the points connected, which was your original question, as July 12 is skipped. The first 2 graphs are essentially the same, with the exception of the blanks <b>AT THE END</b> of the series data (hence no inter/extrapolation). Since all those rows are blank, why plot them in the first case? If a user selects an end date for which there is <b>NO</b> data at all, why not use <code>.End(xlUp)</code> to set the true plot range&#39;s end?"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4040720, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QvfTgm9_FVA/AAAAAAAAAAI/AAAAAAAAAGc/y3T4WN6XCq8/photo.jpg?sz=128", "display_name": "flamingbird123", "link": "https://stackoverflow.com/users/4040720/flamingbird123"}, "edited": false, "score": 0, "creation_date": 1563369398, "post_id": 57076498, "comment_id": 100676798, "body": "Hey,   I added the line <code>ActiveChart.DisplayBlanksAs = xlInterpolated </code> within my chart properties    and I removed <code>.SpecialCells(xlCellTypeConstants) </code> from the ranges   I will update the post with a picture of the graph, since it will be easier to explain. I changed the ranges from J10:J40 just for this example."}], "tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": false, "score": 0, "last_activity_date": 1563392436, "last_edit_date": 1563392436, "creation_date": 1563368516, "answer_id": 57076498, "question_id": 57075399, "link": "https://stackoverflow.com/questions/57075399/how-to-create-a-dynamic-range-skip-blank-cells-in-excel-vba/57076498#57076498", "title": "How to create a dynamic range &amp; skip blank cells in excel vba", "body": "<p>First, <strong>STOP</strong> using <code>.SpecialCells(xlCellTypeConstants)</code> ranges. Use the normal ranges e.g. <code>Range(\"J10:J500\")</code>.</p>\n\n<p><strong>Solution</strong>: Use chart properties to interpolate or connect lines over missing values.  To do this, add the following line for each chart, replacing <code>ActiveChart</code> or chart variable or name:</p>\n\n<pre><code>ActiveChart.DisplayBlanksAs = xlInterpolated\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4040720, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QvfTgm9_FVA/AAAAAAAAAAI/AAAAAAAAAGc/y3T4WN6XCq8/photo.jpg?sz=128", "display_name": "flamingbird123", "link": "https://stackoverflow.com/users/4040720/flamingbird123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1563392436, "creation_date": 1563365050, "last_edit_date": 1563371244, "question_id": 57075399, "link": "https://stackoverflow.com/questions/57075399/how-to-create-a-dynamic-range-skip-blank-cells-in-excel-vba", "title": "How to create a dynamic range &amp; skip blank cells in excel vba", "body": "<p>I am currently trying to create an embedded graph on my worksheet labelled \"Unit2SelectedData.\" The problem that is occurring is when I create the graph from the ranges, it doesn't skip the cells with the value #N/A/Blank so the legend/values are off.  </p>\n\n<p>I tried changing the cell values to #N/A and when I manually create the graph it works and skips the #N/A values. But when automating it with VBA it does not. </p>\n\n<p>So far I tried .DisplayBlanksAs = xlNotPlotted and Cells.Replace \"#N/A\", vbNullString and it did not seem to do the trick. I also tried changing the values from #N/A or =NA() to completely blank. Help would be appreciated! </p>\n\n<p>I realized the main problem is the way I set my ranges to get data for the graph. I am currently using  <code>.SpecialCells(xlCellTypeConstants)</code> \nto only get constant values from a large range which i have set to cells 10:500. \nIf I removed this and create the graph I skip the blank cells and the graph looks like the series values in the desired example below. But, if not all those rows are populated with data the graph has a ton of empty columns/series and it makes the graph look bad. \nFor example if I create the graph with only 5 rows populated with data, then there would be 495 extra blank points on the graph. (You can see in the code below in the 'Chart Selected Data' block.)\nHow do I alter my code to fix this? / Create a range that selects the last row with data?</p>\n\n<pre><code>Sub GraphUnit2()\n\n    'Variables Declaration\n    'Range\n     Dim dataRange As Range\n    'Range 1\n     Dim dataRange1 As Range\n    'Range 2\n     Dim dataRange2 As Range\n    'Range 3\n    Dim dataRange3 As Range\n    'Range 4\n    Dim dataRange4 As Range\n    'Range 5\n    Dim dataRange5 As Range\n    'Range 6\n    Dim dataRange6 As Range\n    'Range 7\n    Dim dataRange7 As Range\n    'Range 8 (Dates + Time)\n    Dim dataRange8 As Range\n\n\n    'Chart Selected Data\n    'Range\n        Set dataRange = Sheets(\"Unit2SelectedData\").Range(\"J10:J500\").SpecialCells(xlCellTypeConstants)\n    'Range 1\n        Set dataRange1 = Sheets(\"Unit2SelectedData\").Range(\"C10:C500\").SpecialCells(xlCellTypeConstants)\n    'Range 2\n        Set dataRange2 = Sheets(\"Unit2SelectedData\").Range(\"D10:D500\").SpecialCells(xlCellTypeConstants)\n    'Range 3\n        Set dataRange3 = Sheets(\"Unit2SelectedData\").Range(\"E10:E500\").SpecialCells(xlCellTypeConstants)\n    'Range 4\n        Set dataRange4 = Sheets(\"Unit2SelectedData\").Range(\"F10:F500\").SpecialCells(xlCellTypeConstants)\n    'Range 5\n        Set dataRange5 = Sheets(\"Unit2SelectedData\").Range(\"G10:G500\").SpecialCells(xlCellTypeConstants)\n    'Range 6\n        Set dataRange6 = Sheets(\"Unit2SelectedData\").Range(\"H10:H500\").SpecialCells(xlCellTypeConstants)\n    'Range 7\n        Set dataRange7 = Sheets(\"Unit2SelectedData\").Range(\"I10:I500\").SpecialCells(xlCellTypeConstants)\n    'Range 8\n        Set dataRange8 = Sheets(\"Unit2SelectedData\").Range(\"A10:B500\").SpecialCells(xlCellTypeConstants)\n\n    'Chart Location/ Coordinates\n    Sheets(\"Unit2SelectedData\").ChartObjects.Add Left:=900, Top:=50, Width:=800, Height:=400\n    Sheets(\"Unit2SelectedData\").ChartObjects(1).Activate\n\n\n    With ActiveChart      'Set chart properties\n\n        .ChartType = xlLineMarkers\n        .ApplyLayout Layout:=5\n        .SeriesCollection.NewSeries\n        .HasLegend = True\n        .Legend.Position = xlRight\n        .Axes(xlCategory).MinorTickMark = xlOutside\n        .Axes(xlValue).MinorTickMark = xlOutside\n        .Axes(xlValue).MaximumScale = Application.WorksheetFunction.RoundUp(Application.WorksheetFunction.Max(dataRange), -1)\n        .Axes(xlCategory, xlPrimary).HasTitle = True\n        'X axis label\n        .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Date/Time\"\n        .Axes(xlValue, xlPrimary).HasTitle = True\n        .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Place\"\n        .SeriesCollection(1).Name = \"PlaceHolder\"\n        .SeriesCollection(1).Values = dataRange\n        .SeriesCollection(1).XValues = dataRange8\n        .ChartTitle.Text = \"Place Holder\"\n        End With\n\n\n    'Data Series for Range 1\n\n    With ActiveChart.SeriesCollection.NewSeries\n    .Values = dataRange1\n    .Name = Sheets(\"Unit2SelectedData\").Range(\"C3\")\n    End With\n\n    'Data Series for Range 2\n         With ActiveChart.SeriesCollection.NewSeries\n        .Values = dataRange2\n        .Name = Sheets(\"Unit2SelectedData\").Range(\"D3\")\n        End With\n\n    'Data Series for Range 3\n        With ActiveChart.SeriesCollection.NewSeries\n            .Values = dataRange3\n            .Name = Sheets(\"Unit2SelectedData\").Range(\"E3\")\n        End With\n\n\n    'Data Series for Range 4\n    With ActiveChart.SeriesCollection.NewSeries\n            .Values = dataRange4\n            .Name = Sheets(\"Unit2SelectedData\").Range(\"F3\")\n        End With\n\n\n    'Data Series for Range 5\n        With ActiveChart.SeriesCollection.NewSeries\n        .Values = dataRange5\n        .Name = Sheets(\"Unit2SelectedData\").Range(\"G3\")\n    End With\n\n    'Data Series for Range 6\n    With ActiveChart.SeriesCollection.NewSeries\n        .Values = dataRange6\n        .Name = Sheets(\"Unit2SelectedData\").Range(\"H3\")\n    End With\n\n    'Data Series for Range 7\n    With ActiveChart.SeriesCollection.NewSeries\n        .Values = dataRange7\n        .Name = Sheets(\"Unit2SelectedData\").Range(\"I3\")\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Example of the Data: </p>\n\n<pre><code>    Date        Value 1    Value 2  Value 3  Value 4  Value 5.... etc \n    11/07/2019     1         2         3        4        5\n    12/07/2019     #N/A     #N/A       4        5       #N/A\n    13/07/2019     3         4       #N/A       6        7\n    14/07/2019     4         5         6        7        8\n\n</code></pre>\n\n<p>When I print the graph the value 1 series. It would be </p>\n\n<pre><code>    July 11 1 \n    July 12 3 \n    July 13 4 \n    July 14 0/blank \n\n</code></pre>\n\n<p>Where ideally I want it to be </p>\n\n<pre><code>    July 11 1 \n    July 12 Blank/0/Skip on the graph  \n    July 13 3 \n    July 14 4 \n\n</code></pre>\n\n<p>As you can see theres a ton of blank spaces when I set the range from J10:J40 and other ranges to 10:40. For now, all these cells aren't filled with data, but they potentially will be. \n<img src=\"https://i.imgur.com/uWY2n9w.jpg\" alt=\"Link to graph\"></p>\n\n<p>This is what I want the graph to look like. \n<img src=\"https://i.imgur.com/5EYnF2j.jpg\" alt=\"Link to desired graph\"></p>\n\n<p>Option 2 graph\n<img src=\"https://i.imgur.com/knZ0SZx.jpg\" alt=\"Link to option 2 graph\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1563364945, "post_id": 57075283, "comment_id": 100673915, "body": "<code>arrWeights</code> is 2D for starters."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1563365284, "post_id": 57075283, "comment_id": 100674098, "body": "You don&#39;t need a loop to populate an array with a range."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563365526, "post_id": 57075283, "comment_id": 100674222, "body": "Use <code>arrWeights(WgtColctr, 1) = Val(Weights.Cells(WgtColctr, 1).Value) </code>"}, {"owner": {"reputation": 11, "user_id": 11766093, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9gaO3xUXevc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdanc0lU0MSnrJp1vr05eYn1Qb6oQ/photo.jpg?sz=128", "display_name": "prashant jadhav", "link": "https://stackoverflow.com/users/11766093/prashant-jadhav"}, "edited": false, "score": 0, "creation_date": 1563365621, "post_id": 57075283, "comment_id": 100674283, "body": "Thank you all. Problem solved."}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1563365584, "creation_date": 1563365584, "answer_id": 57075558, "question_id": 57075283, "link": "https://stackoverflow.com/questions/57075283/subscript-out-of-range-does-not-enter-the-loop/57075558#57075558", "title": "Subscript out of range, does not enter the loop", "body": "<p>You are trying to assign value to a <strong>2D array</strong>.</p>\n\n<p><strong>Use:</strong> <code>arrWeights(WgtColctr, 1) = Val(Weights.Cells(WgtColctr, 1).Value)</code></p>\n\n<p><strong>Instead of:</strong> <code>arrWeights(WgtColctr) = Val(Weights.Cells(WgtColctr, 1).Value)</code></p>\n"}], "owner": {"reputation": 11, "user_id": 11766093, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9gaO3xUXevc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdanc0lU0MSnrJp1vr05eYn1Qb6oQ/photo.jpg?sz=128", "display_name": "prashant jadhav", "link": "https://stackoverflow.com/users/11766093/prashant-jadhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1563365584, "creation_date": 1563364708, "last_edit_date": 1563364900, "question_id": 57075283, "link": "https://stackoverflow.com/questions/57075283/subscript-out-of-range-does-not-enter-the-loop", "title": "Subscript out of range, does not enter the loop", "body": "<pre><code>Public Function APortfolioReturnsXL1(Returns As Range, Weights As Range) As Double()\n\n    On Error GoTo errHandler\n\n    Dim arrReturns() As Double\n    Dim arrWeights() As Double\n    Dim TotRows As Double\n    Dim TotCols As Double\n    Dim RowCtr As Double\n    Dim Colctr As Double\n    Dim WgtColctr As Double\n    Dim WgtRows As Double\n\n    TotRows = Returns.Rows.Count\n    TotCols = Returns.Columns.Count\n\n    WgtRows = Weights.Rows.Count\n\n    ReDim arrReturns(1 To TotRows, 1 To TotCols)\n\n    For RowCtr = 1 To TotRows\n        For Colctr = 1 To TotCols\n            arrReturns(RowCtr, Colctr) = Val(Returns.Cells(RowCtr, Colctr).Value)\n        Next\n    Next\n\n\n    ReDim arrWeights(1 To WgtRows, 1 To 1)\n\n\n    For WgtColctr = 1 To WgtRows\n\n        arrWeights(WgtColctr) = Val(Weights.Cells(WgtColctr, 1).Value)\n\n    Next\n\n\n    APortfolioReturnsXL1 = APortfolioReturns(arrReturns(), arrWeights())\n\n     Exit Function\n\nerrHandler:\n    MsgBox \"An error has occurred.\" &amp; vbCrLf &amp; Err.Description &amp; vbCrLf &amp; CStr(Err.Number)\n\nEnd Function\n</code></pre>\n\n<p>I am getting an </p>\n\n<blockquote>\n  <p>error subscript out of range</p>\n</blockquote>\n\n<p>.</p>\n\n<p>it doesnt enter the loop in the this line:</p>\n\n<pre><code>For WgtColctr = 1 To WgtRows\n\n        arrWeights(WgtColctr) = Val(Weights.Cells(WgtColctr, 1).Value)\n\n    Next\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1563364958, "post_id": 57075265, "comment_id": 100673923, "body": "Add a <code>Debug.Print rng.Address</code> just after the <code>Set rng</code> line. Compare the results from the first run with subsequent runs."}, {"owner": {"reputation": 1, "user_id": 11785119, "user_type": "registered", "profile_image": "https://graph.facebook.com/2271450322945253/picture?type=large", "display_name": "Pravsaran Singh", "link": "https://stackoverflow.com/users/11785119/pravsaran-singh"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1563365319, "post_id": 57075265, "comment_id": 100674114, "body": "hi @Sam , i tried your debug line, but its still not generating the result"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1563365539, "post_id": 57075265, "comment_id": 100674230, "body": "That was not the expected result. What is the output from the debug statement?"}, {"owner": {"reputation": 1, "user_id": 11785119, "user_type": "registered", "profile_image": "https://graph.facebook.com/2271450322945253/picture?type=large", "display_name": "Pravsaran Singh", "link": "https://stackoverflow.com/users/11785119/pravsaran-singh"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1563365763, "post_id": 57075265, "comment_id": 100674344, "body": "nothing. nothing is displayed anywhere."}, {"owner": {"reputation": 1, "user_id": 11785119, "user_type": "registered", "profile_image": "https://graph.facebook.com/2271450322945253/picture?type=large", "display_name": "Pravsaran Singh", "link": "https://stackoverflow.com/users/11785119/pravsaran-singh"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1563365820, "post_id": 57075265, "comment_id": 100674382, "body": "but when i check the locals window, &quot;cell&quot; shows a value of &quot;nothing&quot; in it. Could it be of some concern?"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1563365962, "post_id": 57075265, "comment_id": 100674479, "body": "Just to make sure - is the output pane visible? Press Ctrl+G if not"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1563368036, "post_id": 57075265, "comment_id": 100675816, "body": "You should add an explicit reference to the worksheet to which the range belongs. For example <code>ThisWorkbook.Worksheets(&quot;Name of ws&quot;).Range(......)</code>"}, {"owner": {"reputation": 1, "user_id": 11785119, "user_type": "registered", "profile_image": "https://graph.facebook.com/2271450322945253/picture?type=large", "display_name": "Pravsaran Singh", "link": "https://stackoverflow.com/users/11785119/pravsaran-singh"}, "edited": false, "score": 0, "creation_date": 1563430837, "post_id": 57075265, "comment_id": 100698731, "body": "nothing is working. output pane is also not visible and neither is the explicit reference working"}], "owner": {"reputation": 1, "user_id": 11785119, "user_type": "registered", "profile_image": "https://graph.facebook.com/2271450322945253/picture?type=large", "display_name": "Pravsaran Singh", "link": "https://stackoverflow.com/users/11785119/pravsaran-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563364823, "creation_date": 1563364647, "last_edit_date": 1563364823, "question_id": 57075265, "link": "https://stackoverflow.com/questions/57075265/output-generation-problem-p-s-the-code-runs", "title": "Output Generation Problem (P.s The Code Runs)", "body": "<p>I am trying to plot a diagonal from a range of a single row. When I first ran the code, it generated the values but when i tried again, the code runs but no output is generated. Any suggestions?</p>\n\n<pre><code>Sub diagonal()\n\n    Dim i As Integer, rng As Range, col As Integer, ro As Integer\n    Set rng = Range(\"C32:L32\").Rows(32).CurrentRegion\n    Dim cell As Range\n    col = 25\n    ro = 37\n    For Each cell In rng\n        col = col - 1\n        ro = ro + 1\n        cell.Value = cell(ro, col)\n    Next cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1563364362, "post_id": 57075160, "comment_id": 100673622, "body": "<a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/program-structure/how-to-label-statements\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/visual-basic/programming-gui&zwnj;&#8203;de/&hellip;</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1563364366, "post_id": 57075160, "comment_id": 100673625, "body": "It&#39;s marks <code>x</code> as a <i>label</i> that you can <code>goto</code>. The modern form of old BASIC line-numbers."}, {"owner": {"reputation": 815, "user_id": 5227689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89abdeef079014affae1f012239e2f9b?s=128&d=identicon&r=PG&f=1", "display_name": "Old Nick", "link": "https://stackoverflow.com/users/5227689/old-nick"}, "edited": false, "score": 0, "creation_date": 1563364622, "post_id": 57075160, "comment_id": 100673752, "body": "The two dots after the x mean that x is a label, you can use goto to jump to it. In your example this is done after 1 is subtracted from b"}], "answers": [{"tags": [], "owner": {"reputation": 4466, "user_id": 4876561, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/LrLr2.jpg?s=128&g=1", "display_name": "wundermahn", "link": "https://stackoverflow.com/users/4876561/wundermahn"}, "is_accepted": false, "score": 2, "last_activity_date": 1563364476, "creation_date": 1563364476, "answer_id": 57075213, "question_id": 57075160, "link": "https://stackoverflow.com/questions/57075160/what-is-the-meaning-of-two-dot-in-this-code/57075213#57075213", "title": "What is the meaning of two dot in this code?", "body": "<p>In this, the 'two dots', or the colon, is a delimiter of statements. It is a shorthand way of writing multiple lines of VBA code, in one line. For example...</p>\n\n<p><code>b = b - 1: GoTo x</code></p>\n\n<p>is equivalent to</p>\n\n<pre><code>b = b - 1\n\nGoTo x\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/7649101/excel-vba-pound-and-colon-signs-meaning\">Excel VBA Pound and Colon Signs Meaning?</a></p>\n"}, {"tags": [], "owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "is_accepted": true, "score": 3, "last_activity_date": 1563365246, "last_edit_date": 1563365246, "creation_date": 1563364770, "answer_id": 57075307, "question_id": 57075160, "link": "https://stackoverflow.com/questions/57075160/what-is-the-meaning-of-two-dot-in-this-code/57075307#57075307", "title": "What is the meaning of two dot in this code?", "body": "<p>The two dots are called a colon. And the colon has two functions in Visual Basic for Applications</p>\n\n<p><strong>Defining a label:</strong> In your example <code>x</code> is a label. You can use labels to jump to a specific part of your code, with the <code>goto</code> statement. In your example, this happens on this line:</p>\n\n<pre><code>b = b - 1: GoTo x\n</code></pre>\n\n<p>And you can use it to <strong>separate instructions</strong> (which incidentally happens on the same line). In VBA we usually separate statements with newlines, but one could also use the colon. Though this usually doesn't read too easily. Grabbing the same line of code again:</p>\n\n<pre><code>b = b - 1: GoTo x\n\nis equivalent to\n\nb = b - 1\nGoTo x\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11797355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-slxgQGE2aoc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd7EImHH3p0S-tPe1QApE1tNbzeeA/photo.jpg?sz=128", "display_name": "mutluilker", "link": "https://stackoverflow.com/users/11797355/mutluilker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 903, "favorite_count": 0, "accepted_answer_id": 57075307, "answer_count": 2, "score": 0, "last_activity_date": 1563365246, "creation_date": 1563364290, "last_edit_date": 1563364826, "question_id": 57075160, "link": "https://stackoverflow.com/questions/57075160/what-is-the-meaning-of-two-dot-in-this-code", "title": "What is the meaning of two dot in this code?", "body": "<p>I want to learn what is usage of two dot in excel vba.</p>\n\n<pre><code>Sub loadparts(a)    \n    Sheets(\"Sheet1\").Select\n\n    Dim lists()    \n    b = 2    \n    'what is the meaning of two dots.\n\nx:\n    If Cells(b, a) &lt;&gt; \"\" Then   \n        ReDim Preserve lists(1 To b - 1)   \n        lists(b - 1) = Sheets(b, a)\n\n        b = b - 1: GoTo x\n    End If\n\n    UserForm1.ListBox1.List = lists()  \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1563364285, "post_id": 57075144, "comment_id": 100673579, "body": "Please add the code you have this far."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1563364310, "post_id": 57075144, "comment_id": 100673595, "body": "If you show us your code, we should be able to help. It might be worth reading: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to ask a question</a>"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 3, "creation_date": 1563364363, "post_id": 57075144, "comment_id": 100673623, "body": "What hinders you to use a simple <code>If</code>-statement?"}, {"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "edited": false, "score": 0, "creation_date": 1563364498, "post_id": 57075144, "comment_id": 100673686, "body": "I know how to start by an if statement however, I&#39;m not sure how to move on to the next index if the cell value is &quot;closed&quot;"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1563364997, "post_id": 57075144, "comment_id": 100673951, "body": "A simple line like <code>If Cells(index, 2) &lt;&gt; &quot;Closed&quot; Then</code> to check a value, if different to <code>Closed</code> it will continue the code, if equal to <code>Closed</code> it will skip the rest of the code and go to next iteration."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1563365009, "post_id": 57075144, "comment_id": 100673960, "body": "just use an <code>If</code> statement that contains the code inside the loop"}, {"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "edited": false, "score": 0, "creation_date": 1563365104, "post_id": 57075144, "comment_id": 100674002, "body": "Can you check my modifications?"}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1563365418, "creation_date": 1563365418, "answer_id": 57075505, "question_id": 57075144, "link": "https://stackoverflow.com/questions/57075144/how-to-run-the-code-depending-on-the-value-of-a-cell/57075505#57075505", "title": "How to run the code depending on the value of a cell?", "body": "<p>The structure of the iteration should look like:</p>\n\n<pre><code>'First bit of code\nFor index = 3 To 37\n    If Sheet.Cells(index, 3) = \"OPEN\" then\n        'Code\n    End if\nNext index\n'Continue your code\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 57075505, "answer_count": 1, "score": 0, "last_activity_date": 1563365418, "creation_date": 1563364201, "last_edit_date": 1563365080, "question_id": 57075144, "link": "https://stackoverflow.com/questions/57075144/how-to-run-the-code-depending-on-the-value-of-a-cell", "title": "How to run the code depending on the value of a cell?", "body": "<p>I have recently created a code that is based on a for loop. It reads the value of each row in the first column and completes the rest of the line for each row. </p>\n\n<p>However, I want to complete the rest of the line based on the value of the 2nd column of each line. </p>\n\n<p>Indeed, the second column now has either the value \"OPEN\" or \"CLOSED\". I want the program to run if the cell is \"open\" and I want to move on to the next row if the cell is \"closed\".</p>\n\n<p>Any idea how I can do so?</p>\n\n<p>Here is the code I have so far: </p>\n\n<pre><code>Sub StressTest()\n\n    Dim index As Integer\n    Dim dateColumn As Integer\n    Dim portfolioDate As String\n    Dim portfolioName As Variant\n    Dim ParametricVar As Double\n    Dim AuM As Double\n    Dim PreviousVar As Double\n    Dim PreviousAuM As Double\n    Dim strPath As String\n    Dim strFilePath As String\n    Dim wb As Workbook\n    Dim sheet As Worksheet\n    Dim ws1 As Worksheet\n    Dim ws2 As Worksheet\n    Dim rng1 As Range\n    Dim rng2 As Range\n    Dim workB As Workbook\n    Dim min As Double\n    Dim max As Double\n\n\n    Set wb = ThisWorkbook\n    Set sheet = ActiveSheet\n\n\n    portfolioDate = InputBox(\"Please enter date under the following form : YYYY-MM\", \"Date at the time of Stress Test\", \"Type Here\")\n    Debug.Print \"Current portfolio date is: \" &amp; portfolioDate\n\n\n\n\n      For index = 3 To 37\n    If sheet.Cells(index, 3) = \"OPEN\" Then\n                dateColumn = MatchHeader(portfolioDate)\n                portfolioName = ActiveSheet.Range(\"B\" &amp; index &amp; \"\").Value\n\n\n                strPath = \"G:\\Risk\\Risk Reports\\VaR-Stress test\\\" &amp; portfolioDate &amp; \"\\\" &amp; portfolioName &amp; \"\"\n\n                Set wb = Workbooks.Open(strPath)\n\n                ParametricVar = Workbooks(portfolioName).Worksheets(\"VaR Comparison\").Range(\"B19\")\n                PreviousVar = sheet.Cells(index, dateColumn + 7).Value\n                AuM = Workbooks(portfolioName).Worksheets(\"Holdings - Main View\").Range(\"E11\")\n                PreviousAuM = sheet.Cells(index, dateColumn + 9).Value\n\n\n                Set ws1 = wb.Worksheets(\"Scenarios - Main View\")\n                Set ws2 = wb.Worksheets(\"VaR - Main View\")\n                Set rng2 = ws2.Range(\"J16:J1000\")\n                Set rng1 = ws1.Range(\"11:11\")\n\n                max = Application.WorksheetFunction.max(rng2)\n\n                sheet.Cells(index, dateColumn).Value = ParametricVar / AuM\n                sheet.Cells(index, dateColumn + 2).Value = AuM\n                sheet.Cells(index, dateColumn + 4).Value = ws1.Cells(10, Worst(rng1))\n                sheet.Cells(index, dateColumn + 5).Value = Loss(rng1)\n                sheet.Cells(index, dateColumn + 6).Value = max\n                sheet.Cells(index, dateColumn + 1).Value = (ParametricVar - PreviousVar) / PreviousVar\n                sheet.Cells(index, dateColumn + 3).Value = (AuM - PreviousAuM) / PreviousAuM\n\n\n\n\n\n                wb.Close Savechanges:=False\n\n        Next index\n\n        Else: If sheet.Cells(index, 3) = \"CLOSED\" Then Next index\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium", "iframe", "webdriver"], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1563365286, "post_id": 57075229, "comment_id": 100674103, "body": "Thanks a lot but in fact I am interested in VBA. But of course I knew the idea and apply it in VBA <code>.SwitchToFrame &quot;searchCaseDiv&quot;</code>"}], "tags": [], "owner": {"reputation": 1410, "user_id": 7013205, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0-NIZhYs9ok/AAAAAAAAAAI/AAAAAAAAABw/UhhDdIcg9lA/photo.jpg?sz=128", "display_name": "S Ahmed", "link": "https://stackoverflow.com/users/7013205/s-ahmed"}, "is_accepted": false, "score": 1, "last_activity_date": 1563364531, "creation_date": 1563364531, "answer_id": 57075229, "question_id": 57075048, "link": "https://stackoverflow.com/questions/57075048/element-doesnt-exist-although-it-has-id-attribute/57075229#57075229", "title": "Element doesn&#39;t exist although it has ID attribute", "body": "<p>The element is inside of an <code>iframe</code> with id <em>searchCaseDiv</em>. You have to switch to that iframe to be able to access the element. </p>\n\n<p>Use <code>.SwitchToFrame</code> to switch frame.  </p>\n\n<p>For java, it would be like this, </p>\n\n<pre class=\"lang-java prettyprint-override\"><code>driver.switchTo().frame(\"searchCaseDiv\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1563365108, "post_id": 57075258, "comment_id": 100674004, "body": "Thanks a lot. I got this line <code>.SwitchToFrame.FindElementById(&quot;searchCaseDiv&quot;, timeout:=10000)</code> in red so it may be incorrect. I am not sure"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1563365242, "post_id": 57075258, "comment_id": 100674081, "body": "I used this <code>.SwitchToFrame &quot;searchCaseDiv&quot;</code> and this worked fine for me. Thanks a lot"}], "tags": [], "owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "is_accepted": true, "score": 1, "last_activity_date": 1579704749, "last_edit_date": 1579704749, "creation_date": 1563364622, "answer_id": 57075258, "question_id": 57075048, "link": "https://stackoverflow.com/questions/57075048/element-doesnt-exist-although-it-has-id-attribute/57075258#57075258", "title": "Element doesn&#39;t exist although it has ID attribute", "body": "<p>To send a <em>character sequence</em> to the <strong>Username</strong>  field as the the desired element are within an <code>&lt;iframe&gt;</code> so you have to:</p>\n\n<ul>\n<li>Induce <em>WebDriverWait</em> for the desired <em>frame to be available and switch to it</em>.</li>\n<li>Induce <em>WebDriverWait</em> for the desired <em>element to be clickable</em>.</li>\n<li><p>You can use the following solution:</p>\n\n<pre><code>With bot\n    .Start \"Chrome\"\n    .Get \"https://www.kuwaitcourts.gov.kw/searchPages/searchCases.jsp\"\n    .SwitchToFrame \"searchCaseDiv\"\n    .FindElementByCss(\"input[type=text][name='txtCaseNo']\").SendKeys sCase\n</code></pre></li>\n</ul>\n\n<blockquote>\n  <p>You can find a relevant discussion in <a href=\"https://stackoverflow.com/questions/59848281/how-to-send-text-with-in-the-username-field-within-an-iframe-using-selenium-vba/59848433#59848433\">How to send text with in the username field within an iframe using Selenium VBA</a></p>\n</blockquote>\n\n<hr>\n\n<h2>tl; dr</h2>\n\n<p><a href=\"https://stackoverflow.com/questions/53203417/ways-to-deal-with-document-under-iframe\">Ways to deal with #document under iframe</a></p>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 57075258, "answer_count": 2, "score": 0, "last_activity_date": 1579704749, "creation_date": 1563363871, "last_edit_date": 1563366556, "question_id": 57075048, "link": "https://stackoverflow.com/questions/57075048/element-doesnt-exist-although-it-has-id-attribute", "title": "Element doesn&#39;t exist although it has ID attribute", "body": "<p>In selenium excel vba I am trying to learn more about how to deal with the CSS selectors\nAnd I am wondering because when inspecting an element with ID and when run the code I got a message that the element not found\nHere's the code till now</p>\n\n<pre><code>Private bot As New selenium.ChromeDriver\n\nSub Test()\nDim win, mainWin As selenium.Window, sCode As String, i As Long\nDim urlImage As String, urlPost As String\n\nDim sCase As String\nsCase = \"192160470\"\n\nSet bot = New ChromeDriver\n\nWith bot\n    .Start \"Chrome\"\n\n    'First Window (Main Window)\n    .Get \"https://www.kuwaitcourts.gov.kw/searchPages/searchCases.jsp\"\n    '.FindElementById(\"txtCaseNo\").SendKeys sCase\n    .FindElementByCss(\"input[type=text][name='txtCaseNo']\").SendKeys sCase\n\n    'MsgBox \"Click OK After Entering Captcha\", 64\n\n\n    Stop\n    .Quit\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>and here's the HTML part for that element</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;td&gt;&lt;input type=\"text\" name=\"txtCaseNo\" id=\"txtCaseNo\" maxlength=\"9\" class=\"inputTextBox\" onkeypress=\"return onlyNumbers(event);\"&gt;&lt;/td&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I am stuck at this line</p>\n\n<pre><code>.FindElementByCss(\"input[type=text][name='txtCaseNo']\").SendKeys sCase\n</code></pre>\n\n<p>Thanks advanced for any help or any ideas</p>\n"}, {"tags": ["excel", "vba", "windows"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1563364574, "post_id": 57075047, "comment_id": 100673727, "body": "If you can change the code to something else, without breaking your program, you may want to question whether the initial code was correct, or the substitute. To me it appears that neither does what you intended to do."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10057220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701f18e699c2fa1ebf5c15536b0e4161?s=128&d=identicon&r=PG&f=1", "display_name": "Alex3917", "link": "https://stackoverflow.com/users/10057220/alex3917"}, "edited": false, "score": 0, "creation_date": 1563865116, "post_id": 57095591, "comment_id": 100831195, "body": "Thanks for this comment which solved this issue much smarter than my simple workaround. This issue is obviously an Excel VBA type case failure which occured in combination with a new Windows 10 version!"}], "tags": [], "owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "is_accepted": false, "score": 0, "last_activity_date": 1563456321, "creation_date": 1563456321, "answer_id": 57095591, "question_id": 57075047, "link": "https://stackoverflow.com/questions/57075047/issue-with-large-value-in-double-variable-in-excel-vba-with-windows-10-ltsc/57095591#57095591", "title": "Issue with large value in Double variable in Excel VBA with Windows 10 LTSC", "body": "<p><em>(Not enough points to just comment, so posting as an answer instead)</em></p>\n\n<p>VB/VBA is a little tricky in what it does under the hood when it comes to determing variable types. It tends to do data type conversions (<em>e.g. Double -> Single</em>), if it finds that doing so \"optimizes\" the code/execution.</p>\n\n<p>Therefore it might help in forcing VBA to utilize the correct data type. This might be accomplished by the dedictated conversion methods such as CDbl(), CLng() etc. or by adding the type-declaration character (<em>e.g. '#' for Double, '&amp;' for Long</em>) to the variable/value in question. In your case this might look like:</p>\n\n<pre><code>' Using type-declaration character '#' for Double\nMin = 1E+300#\n' Using data type conversion method CDbl()\nIf (Min &gt; CDbl(MyVarA(2, I))) Then Min = CDbl(MyVarA(2, I))\n</code></pre>\n\n<p>All of the above ofc assumes that the actual data in question doesn't exceed the Double range.</p>\n"}], "owner": {"reputation": 1, "user_id": 10057220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701f18e699c2fa1ebf5c15536b0e4161?s=128&d=identicon&r=PG&f=1", "display_name": "Alex3917", "link": "https://stackoverflow.com/users/10057220/alex3917"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563456321, "creation_date": 1563363866, "last_edit_date": 1563452485, "question_id": 57075047, "link": "https://stackoverflow.com/questions/57075047/issue-with-large-value-in-double-variable-in-excel-vba-with-windows-10-ltsc", "title": "Issue with large value in Double variable in Excel VBA with Windows 10 LTSC", "body": "<p>A variable declared as Double caused Excel VBA to terminate function in Windows 10 LTSC. This code does NOT work:\n<code>\nDim Min As Double\nMin = 1E+300\nIf (Min &gt; MyVarA(2, I)) Then Min = MyVarA(2, I)\n</code>\nNo error message, function just termiates without any failure.</p>\n\n<p>This code works in Windows 10 LTSB and other older Windows version like Win8.1 or Win7!</p>\n\n<p>Solution to solve this issue: Reduce 1E+300 to 1E+30! This code works well:\n<code>\nDim Min As Double\nMin = 1E+30\nIf (Min &gt; MyVarA(2, I)) Then Min = MyVarA(2, I)\n</code></p>\n"}, {"tags": ["excel", "vba", "selenium", "iframe", "webdriverwait"], "comments": [{"owner": {"reputation": 34075, "user_id": 5168011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eb70c32e1e533e7c0cb2f9317a6b2aa3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy", "link": "https://stackoverflow.com/users/5168011/guy"}, "edited": false, "score": 1, "creation_date": 1563362076, "post_id": 57074490, "comment_id": 100672440, "body": "If you could use selenium to bypass <i>I am not a robot</i> it wouldn&#39;t be very useful."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1563362158, "post_id": 57074490, "comment_id": 100672486, "body": "This is the second post I&#39;ve seen this week where someone is trying to do exactly what the site doesn&#39;t want them to do. It might be doable but what you are attempting to do may very well be illegal. I would strongly advice against it"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1563365384, "post_id": 57074490, "comment_id": 100674152, "body": "@Zac Thanks a lot. I have edited the main post and removes any illegal requests."}], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1563370647, "post_id": 57077202, "comment_id": 100677607, "body": "Thanks a lot for great help. I appreciate a lot your help."}], "tags": [], "owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "is_accepted": true, "score": 1, "last_activity_date": 1563372584, "last_edit_date": 1563372584, "creation_date": 1563370584, "answer_id": 57077202, "question_id": 57074490, "link": "https://stackoverflow.com/questions/57074490/css-selector-for-recaptcha-checkbok-using-selenium-and-vba-excel/57077202#57077202", "title": "CSS selector for reCAPTCHA checkbok using Selenium and VBA Excel", "body": "<p>To <code>click()</code> on the element, as the desired element is within an <code>&lt;iframe&gt;</code> so you have to:</p>\n\n<ul>\n<li>Induce a waiter and switch to the desired frame.</li>\n<li>Induce a waiter for the desired <em>element to be clickable</em>.</li>\n<li><p>You can use the following solution:</p>\n\n<pre><code>.SwitchToFrame.FindElementByXPath(\"//iframe[contains(@src, 'recaptcha') and not(@title='recaptcha challenge')]\", timeout:=10000)\n.FindElementByCss(\"div.recaptcha-checkbox-checkmark\").Click\n</code></pre></li>\n</ul>\n\n<p>You can find similar discussions in:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/55264221/how-to-click-on-the-recaptcha-using-selenium-and-java/55265044#55265044\">How to click on the reCaptcha using Selenium and Java</a></li>\n<li><a href=\"https://stackoverflow.com/questions/53917157/find-the-recaptcha-element-and-click-on-it-python-selenium/53917309#53917309\">Find the reCAPTCHA element and click on it \u2014 Python + Selenium</a></li>\n</ul>\n\n<blockquote>\n  <p>Here you can find a relevant discussion on <a href=\"https://stackoverflow.com/questions/53203417/ways-to-deal-with-document-under-iframe\">Ways to deal with #document under iframe</a></p>\n</blockquote>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1843, "favorite_count": 0, "accepted_answer_id": 57077202, "answer_count": 1, "score": 0, "last_activity_date": 1612615578, "creation_date": 1563361756, "last_edit_date": 1612615578, "question_id": 57074490, "link": "https://stackoverflow.com/questions/57074490/css-selector-for-recaptcha-checkbok-using-selenium-and-vba-excel", "title": "CSS selector for reCAPTCHA checkbok using Selenium and VBA Excel", "body": "<p>On the website I am trying to fill in some fields on, there is a checkbox that I need to click to add the check mark in it:</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"rc-anchor-content\"&gt;&lt;div class=\"rc-inline-block\"&gt;&lt;div class=\"rc-anchor-center-container\"&gt;&lt;div class=\"rc-anchor-center-item rc-anchor-checkbox-holder\"&gt;&lt;span class=\"recaptcha-checkbox goog-inline-block recaptcha-checkbox-unchecked rc-anchor-checkbox recaptcha-checkbox-expired\" role=\"checkbox\" aria-checked=\"false\" id=\"recaptcha-anchor\" dir=\"ltr\" aria-labelledby=\"recaptcha-anchor-label\" aria-disabled=\"false\" tabindex=\"0\"&gt;&lt;div class=\"recaptcha-checkbox-border\" role=\"presentation\" style=\"\"&gt;&lt;/div&gt;&lt;div class=\"recaptcha-checkbox-borderAnimation\" role=\"presentation\" style=\"\"&gt;&lt;/div&gt;&lt;div class=\"recaptcha-checkbox-spinner\" role=\"presentation\" style=\"transform: rotate(180deg);\"&gt;&lt;/div&gt;&lt;div class=\"recaptcha-checkbox-spinnerAnimation\" role=\"presentation\" style=\"\"&gt;&lt;/div&gt;&lt;div class=\"recaptcha-checkbox-checkmark\" role=\"presentation\"&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=\"rc-inline-block\"&gt;&lt;div class=\"rc-anchor-center-container\"&gt;&lt;label class=\"rc-anchor-center-item rc-anchor-checkbox-label\" aria-hidden=\"true\" role=\"presentation\" id=\"recaptcha-anchor-label\"&gt;&lt;span aria-live=\"polite\" aria-labelledby=\"recaptcha-accessible-status\"&gt;&lt;/span&gt;I'm not a robot&lt;/label&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n<p>Using Selenium in VBA, I tried the following</p>\n<pre><code>.FindElementByCss(&quot;div.recaptcha-checkbox-border&quot;).Click\n</code></pre>\n<p>And also I tried</p>\n<pre><code>.FindElementByCss(&quot;span.recaptcha-checkbox&quot;).Click\n</code></pre>\n<p>But I got an error at this line.</p>\n<p>Here's the link of the website to see the whole HTML\n<a href=\"https://www.moj.gov.kw/AR/E-Gov/Pages/eServices01.aspx\" rel=\"nofollow noreferrer\">https://www.moj.gov.kw/AR/E-Gov/Pages/eServices01.aspx</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1563362878, "post_id": 57074446, "comment_id": 100672854, "body": "How many exceptions do you have? If it&#39;s just a few, there are some simple tricks to use, that aren&#39;t useful if the list is long"}, {"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1563366763, "post_id": 57074446, "comment_id": 100674998, "body": "Thanks Sam - Usually only a few, I&#39;d say per run of the tool up to 10 sub-folder paths to be excluded. However there may be thousands of sub-folders of a similar nature to be excluded which is why I also need functionality to exclude based on a string within the sub-folder path so they can all be excluded in one go i.e. If all sub-folders 1-5 contain another sub-folder within each called &quot;To be deleted&quot;, then I want to be able to say &quot;ignore all folder paths containing the words &quot;To be deleted&quot;. They can then be done in one sweep rather than thousands of individual whole folder paths."}], "answers": [{"comments": [{"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563441960, "post_id": 57077132, "comment_id": 100704302, "body": "Hi Ron, thank you very much for the above. Great explanation however the code is far beyond me at the moment so was trying to fully understand before responding! If I&#39;m not mistaken you are saying that firstly everything is returned in an array THEN exceptions removed then pasted to the worksheet? Do you know if there is a way to skip the exceptions so that they are not included in the array in the first place? This is what I had in mind with a view to significantly speeding up the process. If everything must first be included in the array than I presume this will take longer overall?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563448367, "post_id": 57077132, "comment_id": 100707798, "body": "@Haris <b>What happened when you tried it?</b>  It should run a lot faster (5-10x) because you are not doing all those worksheet writes. You will always have to read the file name -- either to save it or test to see if it is in your exception list.  Testing each name one at a time will likely take longer than filtering them out at the end."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563448632, "post_id": 57077132, "comment_id": 100707965, "body": "@Haris If the above is not fast enough, in some testing (on network drives), I have found that using the Shell object to run the command window <code>Dir</code> command is faster than the FSO methods, but the differences seem insignificant on a single computer."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563448848, "post_id": 57077132, "comment_id": 100708071, "body": "@Haris And finally, the <code>Filter</code> function does look for <code>contains</code>, so you can specify merely the parent subfolder, as you seem to indicate you want to do."}, {"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563453683, "post_id": 57077132, "comment_id": 100710800, "body": "Hi Ron. Just ran it now on a folder with c.3000 files with 2 sub-folders excluded and it took 7m22s. Also ran it with the solution I currently have (doesn&#39;t have exclusions facility so these must be manually extracted and does have additional elements to the code i.e creates a further 10 columns and inserts formulas into each) and that took 3m40s. I couldn&#39;t possibly understand as to why it is quicker but they are the results."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563455070, "post_id": 57077132, "comment_id": 100711627, "body": "@Haris Clearly there is something you are not sharing, or an issue with how you are implementing this routine on your system.  I just ran my routine on a folder with 3927 files in various subfolders, and it ran in 11.6 <b>seconds</b>.  With two subfolders excluded, dropping the file total to 3060, the procedure ran in the same time."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563458146, "post_id": 57077132, "comment_id": 100713717, "body": "@Haris BTW, with only 3000 files taking minutes to process, my opinion is that your speed issues have little to do with the file reading/filtering routines.  Your routine takes seconds to run on my machine also."}, {"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563458337, "post_id": 57077132, "comment_id": 100713864, "body": "Wow 11.6 seconds! In terms of the code I only shared what I thought was relevant at the time I posted (I can post the whole code if it will help as my ultimate aim in all of this is speed!). I ran your code exactly as you posted it. I wonder if the speed difference is to do with the fact I am on a workplace network and anywhere up to 600 people potentially using the system at once during working hours. That being said, the PCs we use are still reasonably quick (very similar to my PC at home) so don&#39;t understand why such a huge disparity. Thank you for all your help anyway."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563458596, "post_id": 57077132, "comment_id": 100714035, "body": "@Haris As I wrote above, accessing a network drive, that has no where&#39;s near the use you described, I found much better speed using the <code>Shell</code> and the <code>CMD &#47;c Dir</code> method to write to a text file, then process the file names that way."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563502143, "post_id": 57077132, "comment_id": 100729960, "body": "@Haris For fun, I wrote a routine using the <code>Shell</code> which resulted in the same output as the FSO and your original routine.  The FSO and your original, with <b>30,000</b> files (on a local drive), took about 70 seconds to run.  The <code>Shell</code> routine produced the same output in about 3.2 seconds.  It is likely there are other issues slowing down your code, but the directory read/write routine can be sped up."}, {"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563528448, "post_id": 57077132, "comment_id": 100738463, "body": "That&#39;s crazy. From what I have read on the web so far there are 3 ways to do it. FSO Object, Shell Object and Dir (I think). But I also hear they have their own strengths and weaknesses e.g. for my project I need to be able to return the filepath filename and date last modified which apparently works well with FSO? I have loads to learn but am embarrassingly excited about the start of my programming journey!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1563530994, "post_id": 57077132, "comment_id": 100739777, "body": "@Haris If you open the CMD window, you can examine the various arguments for the <code>Dir</code> command (<b>NOT</b> the VBA <code>Dir</code> function).  Those parameters can be returned, but then you have to do some programming to &quot;put them together&quot;.  Not as convenient as the FSO, but faster."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1563380344, "last_edit_date": 1563380344, "creation_date": 1563370359, "answer_id": 57077132, "question_id": 57074446, "link": "https://stackoverflow.com/questions/57074446/loop-through-all-files-and-folders-using-fso-but-ignore-specified-sub-folders-te/57077132#57077132", "title": "Loop through all files and folders using FSO BUT ignore specified sub-folders/text string", "body": "<p>One method of eliminating certain folders:</p>\n\n<ul>\n<li>Read the files and information into an array</li>\n<li>filter the array</li>\n<li>write the array to the worksheet</li>\n</ul>\n\n<p>I used a dictionary to collect the information before writing it to an array.</p>\n\n<p>Here is the code, along with a routine that calls the recursive routine and also writes to the worksheet.</p>\n\n<p>Note that I have qualified the worksheet names. Otherwise it defaults to activesheet, over which you may not have control.</p>\n\n<p>Also note that the process of working within VBA arrays is much speedier than the multiple worksheet write operations in your original code.</p>\n\n<pre><code>Option Explicit\nPublic dFI As Scripting.Dictionary\n\nSub RecursiveFolder(objFolder As Scripting.Folder, _\n    IncludeSubFolders As Boolean)\n    'Declare the variables\n    Dim objFile As Scripting.File\n    Dim objSubFolder As Scripting.Folder\n    'Dim NextRow As Long\n    Dim arrFI(1 To 3) As Variant\n\n    'Loop through each file in the folder\n    For Each objFile In objFolder.Files\n            arrFI(1) = objFile.Path 'This is superfluous since it is also the key\n            arrFI(2) = objFile.Name\n            arrFI(3) = objFile.DateLastModified\n            dFI.Add Key:=objFile.Path, Item:=arrFI\n    Next objFile\n\n    'Loop through files in the subfolders\n    If IncludeSubFolders Then\n        For Each objSubFolder In objFolder.SubFolders\n            Call RecursiveFolder(objSubFolder, True)\n        Next objSubFolder\n    End If\nEnd Sub\n\n'----------------------------   \nSub GetList()\n    Dim FO As Scripting.Folder\n    Dim FSO As Scripting.FileSystemObject\n    Dim V As Variant, W As Variant\n    Dim vRes As Variant\n    Dim I As Long\n\n    Dim WS As Worksheet:            Set WS = Worksheets(\"sheet1\")\n    Dim R As Range\n        Set R = WS.Cells(1, 1)\n\n        Dim wsEX As Worksheet:      Set wsEX = Worksheets(\"Exceptions\")\n        Dim vEX As Variant\n        With wsEX\n            'assumes exceptions are in column A\n            vEX = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp))\n        End With\n\nSet FSO = New FileSystemObject\nSet FO = FSO.GetFolder(\"C:\\Users\\Ron\\Documents\\Data\") 'or whatever\nSet dFI = New Scripting.Dictionary\n\n    Call RecursiveFolder(FO, True)\n\nV = dFI.Keys\n\nFor Each W In vEX\n    V = Filter(V, W, False, vbTextCompare)\nNext W\n\n'create results array\nReDim vRes(1 To UBound(V) + 1, 1 To 3)\nI = 0\nFor Each W In V\n    I = I + 1\n    vRes(I, 1) = W\n    vRes(I, 2) = dFI(W)(2)\n    vRes(I, 3) = dFI(W)(3)\nNext W\n\n\nWith R.Resize(UBound(vRes, 1), UBound(vRes, 2))\n    .EntireColumn.Clear\n    .Value = vRes\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><em>If you have a large list of excluded subfolders, it may or may not be more expeditious to filter on a worksheet using the <code>autofilter</code> or <code>advancedfilter</code>.  You would have to test to see whether that method works faster than the VBA Filter function</em></p>\n"}], "owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "accepted_answer_id": 57077132, "answer_count": 1, "score": 0, "last_activity_date": 1563380344, "creation_date": 1563361605, "last_edit_date": 1563362378, "question_id": 57074446, "link": "https://stackoverflow.com/questions/57074446/loop-through-all-files-and-folders-using-fso-but-ignore-specified-sub-folders-te", "title": "Loop through all files and folders using FSO BUT ignore specified sub-folders/text string", "body": "<p>Please allow me to start off by saying I am EXTREMELY new to programming and this is also my very first post on a website forum, ever! So forgive me if proper etiquette etc has not been followed.</p>\n\n<p>The task I am trying to carry out is an Excel VBA problem. </p>\n\n<p>I am trying to create a tool/macro that, for any given folder path, lists all files in all folders (and sub-folders) in an Excel spreadsheet BUT (and this is the crucial part) to ignore a list of specified exceptions.</p>\n\n<p>I have picked up bits and pieces over the internet over the last few weeks and have managed to get to the point of listing everything (using FileSystemObject, this seems to be answered many times on the web already, thankfully).</p>\n\n<p>I cannot, for the life of me however, find anything that allows for exceptions to be specified.</p>\n\n<p>The reason I need to do it this way is because I am testing literally thousands of thousands of sub-folders and almost a million files so this takes a lot of time (and this process must be repeated on a monthly basis!). If however, I can specify which sub-folders to ignore (and there are many), either based on the whole sub-folder path or a string within the folder path, this (in theory) would save me loads of time.</p>\n\n<p>In summary and as an example:</p>\n\n<p>For Top Level Folder Path: <code>C:\\This is the top folder\\</code></p>\n\n<p>Which contains the following sub-folders (each of which contain further sub-folders and files):</p>\n\n<pre><code>Sub-folder 1\nSub-folder 2\nSub-folder 3\nSub-folder 4\nSub-folder 5\n</code></pre>\n\n<p>I want to return all files and folders but skip sub-folders 3 and 5 (or skip a specified sub-folder within a sub-folder). The sub-folders to be ignored will be based on specified filepaths within another tab (\"exceptions\") on the Excel worksheet. </p>\n\n<p>I am very new to programming and have heard mention of potentially using the Dir object or Shell object but in my research so far the FileSystemObject (FSO) is the quickest/most flexible so would prefer for the solution to be based on use of FSO.</p>\n\n<p>Current relevant code extract is as follows: </p>\n\n<pre><code>Sub RecursiveFolder(objFolder As Scripting.Folder, _\n    IncludeSubFolders As Boolean)\n    'Declare the variables\n    Dim objFile As Scripting.File\n    Dim objSubFolder As Scripting.Folder\n    Dim NextRow As Long\n\n    'Find the next available row\n    NextRow = Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\n    'Loop through each file in the folder\n    For Each objFile In objFolder.Files\n        Cells(NextRow, \"A\").Value2 = objFile.Path\n        Cells(NextRow, \"B\").Value2 = objFile.Name\n        Cells(NextRow, \"C\").Value = objFile.DateLastModified\n        NextRow = NextRow + 1\n    Next objFile\n\n    'Loop through files in the subfolders\n    If IncludeSubFolders Then\n        For Each objSubFolder In objFolder.SubFolders\n            Call RecursiveFolder(objSubFolder, True)\n        Next objSubFolder\n    End If\nEnd Sub\n</code></pre>\n\n<p>Hoping then for the outcome to be that every single file from all the sub-folders is listed EXCEPT from those sub-folders listed on the \"exceptions\" tab. </p>\n\n<p>I have been stuck on this for ages so any help would be much appreciated!</p>\n\n<p>P.S. Not as important but as a bonus would be great if the code can also return, next to the \"Date Last Modified\", the user who last saved each file (c.600 users on the drive).</p>\n\n<p>P.P.S The version of Excel I am using is 2010.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1563361957, "post_id": 57074323, "comment_id": 100672377, "body": "This is not so much an Excel question than a SQL question, no? With modern Excel (2010 and later) it is much easier to use Power Query to load and process SQL data. Have you given that any thought?"}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1563362197, "post_id": 57074323, "comment_id": 100672510, "body": "This goes through our file management system called M-Files so I am not able to access sql straight away."}], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1563363049, "post_id": 57074643, "comment_id": 100672953, "body": "Debugger seems to make this line red <code>Cells(i, 1).Value = results[i]</code>. This should be different <code>results[i]</code>?"}, {"owner": {"reputation": 116, "user_id": 3008454, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000002685023/picture?type=large", "display_name": "Roman", "link": "https://stackoverflow.com/users/3008454/roman"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1563363698, "post_id": 57074643, "comment_id": 100673267, "body": "You updated your code to results(i), did you try results[i]. (square brackets)"}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1563363874, "post_id": 57074643, "comment_id": 100673364, "body": "Yes, please see screenshot"}, {"owner": {"reputation": 116, "user_id": 3008454, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000002685023/picture?type=large", "display_name": "Roman", "link": "https://stackoverflow.com/users/3008454/roman"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1563365140, "post_id": 57074643, "comment_id": 100674022, "body": "You were right about the ()  brackets, using [] does not work"}], "tags": [], "owner": {"reputation": 116, "user_id": 3008454, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000002685023/picture?type=large", "display_name": "Roman", "link": "https://stackoverflow.com/users/3008454/roman"}, "is_accepted": true, "score": 1, "last_activity_date": 1563365231, "last_edit_date": 1563365231, "creation_date": 1563362359, "answer_id": 57074643, "question_id": 57074323, "link": "https://stackoverflow.com/questions/57074323/list-values-from-sql-search-to-excel/57074643#57074643", "title": "List values from sql search to Excel", "body": "<p>If you're looking for a quick and direct way try this:</p>\n\n<p><code>For i = 1 To results.Count\n    Cells(i, 1).Value = results(i - 1)\n Next i\n</code></p>\n\n<p><strong>Tip:</strong> Cells(row, column)</p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 57074643, "answer_count": 1, "score": 0, "last_activity_date": 1571647686, "creation_date": 1563361189, "last_edit_date": 1571647686, "question_id": 57074323, "link": "https://stackoverflow.com/questions/57074323/list-values-from-sql-search-to-excel", "title": "List values from sql search to Excel", "body": "<p>I am running a search from Excel to get objects Internal ID's by External ID. In <code>ThisWorkbook.Sheets(\"Other Data\").Range(\"J30\").Value</code> I have External ID <code>f5f9a21b-9208-de11-995f-005056bb3dfa</code>. After search code should display Internal ID. </p>\n\n<p>This one works and I am getting a message:\n<em>There were 3 objects with the display Id of f5f9a21b-9208-de11-995f-005056bb3dfa</em></p>\n\n<p>How I can make this code to actually display these ID's for example starting from cell A1?</p>\n\n<p>So instead of just a message:</p>\n\n<p>MsgBox (\"There were \" &amp; results.Count &amp; \" objects with the display Id of\" &amp; ThisWorkbook.Sheets(\"Other Data\").Range(\"J30\").Value)</p>\n\n<p>I would get the ID's in Excel? Basically I need <code>results.Count</code> not to count items but input them to Excel. </p>\n\n<p>Code edited according to suggestion, but debugger is pointing to <code>ThisWorkbook.Sheets(\"Start\").Cells(i, 1).Value = results(i)</code></p>\n\n<pre><code>Private Sub SurroundingSub()\n    Set oVault = oMFClientApp.BindToVault(szVaultName, 0, True, True)\n    ' Create the condition.\n    Dim condition As New SearchCondition\n    Dim oScs: Set oScs = CreateObject(\"MFilesAPI.SearchConditions\")\n    Dim oVaultConnections As MFilesAPI.VaultConnections\n    Dim i As Integer\n\n    ' Set the expression.\n    condition.Expression.DataStatusValueType = MFStatusType.MFStatusTypeExtID\n\n    ' Set the condition type.\n    condition.ConditionType = MFConditionType.MFConditionTypeEqual\n\n    ' Set the value.\n    ' In this case \"MyExternalObjectId\" is the ID of the object in the remote system.\n    condition.TypedValue.SetValue MFDataType.MFDatatypeText, ThisWorkbook.Sheets(\"Other Data\").Range(\"J30\").Value\n\n            'Add the condition to the collection.\n            oScs.Add -1, condition\n\n            'Search.\n            Dim results 'As ObjectSearchResults\n            Set results = oVault.ObjectSearchOperations.SearchForObjectsByConditions(oScs, MFSearchFlags.MFSearchFlagNone, False) ' False = SortResults\n\n            'Output the number of items matching (should be one in each object type, at a maximum).\n            'MsgBox (\"There were \" &amp; results.Count &amp; \" objects with the display Id of\" &amp; ThisWorkbook.Sheets(\"Other Data\").Range(\"J30\").Value)\n\n            For i = 1 To results.Count\n            ThisWorkbook.Sheets(\"Start\").Cells(i, 1).Value = results[i]\n            Next i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gCZ0T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gCZ0T.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>Also () does not work:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aapzr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aapzr.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 183, "user_id": 11709287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w2fV_JQhXF4/AAAAAAAAAAI/AAAAAAAAV_o/ByQFYQe94LU/photo.jpg?sz=128", "display_name": "Horst", "link": "https://stackoverflow.com/users/11709287/horst"}, "edited": false, "score": 0, "creation_date": 1563360490, "post_id": 57073925, "comment_id": 100671603, "body": "Maybe that particular sheet isn&#39;t a worksheet. Are there any diagram-sheets in your workbook? Try to replace <code>worksheets</code> with <code>sheets</code>."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1563361362, "post_id": 57073925, "comment_id": 100672069, "body": "Have you explored <code>UserInterfaceOnly</code> option when protecting your worksheet?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563362626, "post_id": 57073925, "comment_id": 100672732, "body": "Does it work if you comment out or delete the line  <code>MyMainRutineCall</code>? If it runs, then you must include the code of <code>MyMainRutineCall</code> in your question."}, {"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "edited": false, "score": 0, "creation_date": 1563363297, "post_id": 57073925, "comment_id": 100673082, "body": "I have updated with <code>MyMainRutineCall</code>"}, {"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "reply_to_user": {"reputation": 183, "user_id": 11709287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w2fV_JQhXF4/AAAAAAAAAAI/AAAAAAAAV_o/ByQFYQe94LU/photo.jpg?sz=128", "display_name": "Horst", "link": "https://stackoverflow.com/users/11709287/horst"}, "edited": false, "score": 1, "creation_date": 1563363375, "post_id": 57073925, "comment_id": 100673120, "body": "@Horst It has to be worksheets. It cannot work with sheets."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563364441, "post_id": 57073925, "comment_id": 100673658, "body": "@SimonJ Where is your button located (which workbook and worksheet)? \u2022 Note that <code>If myFile &lt;&gt; &quot;False&quot; Then</code> must be <code>If myFile &lt;&gt; False Then</code> because <code>GetSaveAsFilename</code> returns a <code>boolean</code> type <code>False</code> if cancel is pressed not a <code>string</code>."}, {"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1563364541, "post_id": 57073925, "comment_id": 100673708, "body": "@Zac What a great solution! It seems to work now."}, {"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563364590, "post_id": 57073925, "comment_id": 100673738, "body": "@P\u1d07\u029c The button is located in none of the pages that should be printed. So in another sheet."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563364749, "post_id": 57073925, "comment_id": 100673830, "body": "@SimonJ In the same workbook? Then replace all your <code>ActiveWorkbook</code> with <code>ThisWorkbook</code> it is much more reliable. Avoid <code>ActiveWorkbook</code> unless you are coding an add-in or something similar. \u2022 Is this solved now?"}, {"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563365349, "post_id": 57073925, "comment_id": 100674132, "body": "@P\u1d07\u029c YEs it is solved now :) Thank you all!"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1563366316, "creation_date": 1563366316, "answer_id": 57075804, "question_id": 57073925, "link": "https://stackoverflow.com/questions/57073925/error-1004-method-protect-of-object-worksheet-failed/57075804#57075804", "title": "Error 1004 Method &#39;Protect&#39; of object &#39;_Worksheet&#39; failed", "body": "<p>Actually the issue seemed to be</p>\n\n<pre><code>If myFile &lt;&gt; \"False\" Then\n</code></pre>\n\n<p>which should be </p>\n\n<pre><code>If myFile &lt;&gt; False Then\n</code></pre>\n\n<p>because the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.getsaveasfilename\" rel=\"nofollow noreferrer\">Application.GetSaveAsFilename method</a> returns either a file name as <code>Variant/String</code> or a <code>False</code> as <code>Variant/Boolean</code>. But not a string <code>\"False\"</code>.</p>\n\n<p>So my recommendation is also to use <code>ThisWorkbook</code> in some more places to make it more reliable:</p>\n\n<pre><code>Option Explicit\n\nPrivate Const yourPassword As String = \"MyPassWord\"\n\nSub ButtonClick()\n\n    UnprotectAll\n\n    MyMainRutineCall\n\n    ProtectAll\n\nEnd Sub\n\nSub MyMainRutineCall()\n    On Error GoTo errHandler\n\n    Dim wbA As Workbook\n    Set wbA = ThisWorkbook\n\n    Dim wsA As Worksheet\n    Set wsA = wbA.ActiveSheet\n\n    'get active workbook folder, if saved\n    Dim strPath As String\n    strPath = IIf(wbA.path = vbNullString, Application.DefaultFilePath, wbA.path) &amp; Application.PathSeparator\n\n    Dim strName As String\n    strName = \"PDF\" &amp; \" - \" &amp; wsA.Range(\"G61\").Value\n\n    'create default name for savng file\n    Dim strFile As String\n    strFile = strName &amp; \".pdf\"\n\n    Dim strPathFile As String\n    strPathFile = strPath &amp; strFile\n\n    If bFileExists(strPathFile) Then\n        If MsgBox(\"Overwrite existing file?\", vbQuestion + vbYesNo, \"File Exists\") &lt;&gt; vbYes Then\n            ' user can enter name and\n            ' select folder for file\n            Dim myFile As Variant\n            myFile = Application.GetSaveAsFilename( _\n                InitialFileName:=strPathFile, _\n                FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n                Title:=\"Select Folder and FileName to save\")\n            If myFile &lt;&gt; False Then\n                strPathFile = myFile\n            Else\n                GoTo exitHandler\n            End If\n        End If\n    End If\n\n    'Select sheets to use\n    Dim ary() As Variant\n    ary = Array(Sheet7.Name, Sheet3.Name)\n\n    Dim a As Variant\n    For Each a In ary\n        ThisWorkbook.Sheets(a).Move After:=ThisWorkbook.Sheets(Sheets.Count)\n    Next a\n\n    ThisWorkbook.Sheets(ary).Select\n\n    'export to PDF in current folder\n    ThisWorkbook.ActiveSheet.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=strPathFile, _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=False\n\n    'confirmation message with file info\n    MsgBox \"PDF file has been created: \" &amp; vbCrLf &amp; strPathFile\n\nexitHandler:\n    Exit Sub\n\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\nEnd Sub\n\n\nSub UnprotectAll()\n    Dim sh As Worksheet\n    For Each sh In ThisWorkbook.Worksheets\n        sh.Unprotect Password:=yourPassword\n    Next sh\nEnd Sub\n\n\nSub ProtectAll()\n    Dim sh As Worksheet\n    For Each sh In ThisWorkbook.Worksheets\n        sh.Protect Password:=yourPassword\n    Next sh\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 0, "accepted_answer_id": 57075804, "answer_count": 1, "score": 0, "last_activity_date": 1563366316, "creation_date": 1563359877, "last_edit_date": 1563363274, "question_id": 57073925, "link": "https://stackoverflow.com/questions/57073925/error-1004-method-protect-of-object-worksheet-failed", "title": "Error 1004 Method &#39;Protect&#39; of object &#39;_Worksheet&#39; failed", "body": "<p>I'm trying to protect my sheets again after running a macro. It comes up with an <code>Run-time error 1004 Method 'Protect' of object '_Worksheet' failed</code>. All sheets are unprotected before running this script. If they are protected on beforehand the fail still come.</p>\n\n<p>I have tried changing <code>ActiveWorkbook</code> to <code>ThisWorkbook</code>. When I did this I could run <code>ProtectAll</code> fine by it self. Running the whole code makes the problem.</p>\n\n<pre><code>Option Explicit\n\nPrivate Const yourPassword As String = \"MyPassWord\"\n\nSub ButtonClick()\n\nUnprotectAll\n\nMyMainRutineCall\n\nProtectAll\n\nEnd Sub\nSub MyMainRutineCall()\n\nDim wsA As Worksheet\nDim wbA As Workbook\nDim strName As String\nDim strPath As String\nDim strFile As String\nDim strPathFile As String\nDim myFile As Variant\nDim lOver As Long\nDim ary\nDim a As Variant\nOn Error GoTo errHandler\n\n\nSet wbA = ActiveWorkbook\nSet wsA = ActiveSheet\n\n'get active workbook folder, if saved\nstrPath = wbA.Path\nIf strPath = \"\" Then\n  strPath = Application.DefaultFilePath\nEnd If\nstrPath = strPath &amp; \"\\\"\n\nstrName = \"PDF\" _\n          &amp; \" - \" &amp; wsA.Range(\"G61\").Value _\n\n'create default name for savng file\nstrFile = strName &amp; \".pdf\"\nstrPathFile = strPath &amp; strFile\n\nIf bFileExists(strPathFile) Then\n  lOver = MsgBox(\"Overwrite existing file?\", _\n    vbQuestion + vbYesNo, \"File Exists\")\n  If lOver &lt;&gt; vbYes Then\n    'user can enter name and\n    ' select folder for file\n    myFile = Application.GetSaveAsFilename _\n      (InitialFileName:=strPathFile, _\n          FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n          Title:=\"Select Folder and FileName to save\")\n    If myFile &lt;&gt; \"False\" Then\n      strPathFile = myFile\n    Else\n      GoTo exitHandler\n    End If\n  End If\nEnd If\n\n'Select sheets to use\nary = Array(Sheet7.Name, Sheet3.Name)\n\nFor Each a In ary\n    Sheets(a).Move after:=Sheets(Sheets.Count)\nNext a\n\nThisWorkbook.Sheets(ary).Select\n\n'export to PDF in current folder\nActiveSheet.ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=strPathFile, _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\n\n'confirmation message with file info\nMsgBox \"PDF file has been created: \" _\n  &amp; vbCrLf _\n  &amp; strPathFile\n\nexitHandler:\n    Exit Sub\n\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\n\nEnd Sub\n\nSub UnprotectAll()\n    Dim sh As Worksheet\n    For Each sh In ActiveWorkbook.Worksheets\n        sh.Unprotect Password:=yourPassword\n    Next sh\nEnd Sub\n\nSub ProtectAll()\n    Dim sh As Worksheet\n    For Each sh In ActiveWorkbook.Worksheets\n        sh.Protect Password:=yourPassword\n    Next sh\nEnd Sub\n</code></pre>\n\n<p>The things that is buggy is <code>sh.Protect Password:=yourPassword</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91, "user_id": 7765660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d22597168d5cd279878b0e69e03aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "omaril", "link": "https://stackoverflow.com/users/7765660/omaril"}, "edited": false, "score": 1, "creation_date": 1563360992, "post_id": 57073807, "comment_id": 100671880, "body": "Can you you provide code for IsEmailValid. as this might be consuming a lot of time."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1563362126, "post_id": 57073807, "comment_id": 100672469, "body": "Actually this should be quite the fastest way. While the code could be shortened a bit, that would not improve speed noticible. As omaril already said, it looks like your <code>IsEmailValid</code> function is using a lot of time. The problem is not in the code you posted but in the code of <code>IsEmailValid</code>. If <code>IsEmailValid</code> needs only 1 second to analyze 1 cell it is already 1000 seconds for 1000 cells. So here is the issue. <a href=\"https://stackoverflow.com/posts/57073807/edit\">Edit</a> your question and add the code of <code>IsEmailValid</code>."}, {"owner": {"reputation": 33, "user_id": 8912124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c2f3fb9698310044d6467631791eda?s=128&d=identicon&r=PG&f=1", "display_name": "sander126", "link": "https://stackoverflow.com/users/8912124/sander126"}, "edited": false, "score": 0, "creation_date": 1563402792, "post_id": 57073807, "comment_id": 100692654, "body": "I have edited my Question and added my IsEmailValid Function. Though it only takes fraction of a second to execute if used on the Cell itself"}], "answers": [{"tags": [], "owner": {"reputation": 52, "user_id": 11493815, "user_type": "registered", "profile_image": "https://graph.facebook.com/893731690958613/picture?type=large", "display_name": "Juras Sulcas", "link": "https://stackoverflow.com/users/11493815/juras-sulcas"}, "is_accepted": false, "score": -1, "last_activity_date": 1563359949, "creation_date": 1563359949, "answer_id": 57073950, "question_id": 57073807, "link": "https://stackoverflow.com/questions/57073807/faster-way-to-put-formula-into-range/57073950#57073950", "title": "Faster way to put formula into Range", "body": "<p>Wouldn't something like this work? I've tried to make a shorter version.</p>\n\n<pre><code>Sub valEmail()\n\n    Dim rnum As Long\n\n    Application.ScreenUpdating = False    \n\n    With ActiveSheet\n\n    rnum = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Range(\"F2\").Formula = \"=isemailvalid(A2)\"\n    Range(\"F2\").Copy Destination:=Range(\"F3\" &amp; \":\" &amp; \"F\" &amp; rnum)\n\n    End with\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 8912124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c2f3fb9698310044d6467631791eda?s=128&d=identicon&r=PG&f=1", "display_name": "sander126", "link": "https://stackoverflow.com/users/8912124/sander126"}, "edited": false, "score": 0, "creation_date": 1563522757, "post_id": 57091228, "comment_id": 100735580, "body": "Thanks man. This worked faster than my previous code. Though I replaced &quot;validEmail.Formula = &quot;=IsEmailValid(A2)&quot; to With function."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1563442320, "last_edit_date": 1563442320, "creation_date": 1563441845, "answer_id": 57091228, "question_id": 57073807, "link": "https://stackoverflow.com/questions/57073807/faster-way-to-put-formula-into-range/57091228#57091228", "title": "Faster way to put formula into Range", "body": "<p>Try this function <code>IsEmailValid</code> instead of yours:</p>\n\n<pre><code>Public Function IsEmailValid(ByVal EmailAddress As String) As Boolean\n    Dim RegEx As Object\n    Set RegEx = CreateObject(\"vbscript.regexp\")\n\n    With RegEx\n        .IgnoreCase = True\n        .Global = True\n        .Pattern = \"^((\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*)\\s*[;]{0,1}\\s*)+$\"\n    End With\n\n    IsEmailValid = RegEx.test(EmailAddress)\nEnd Function\n</code></pre>\n\n<p>Alternative RegEx for emails can be found here: <a href=\"https://emailregex.com\" rel=\"nofollow noreferrer\">https://emailregex.com</a></p>\n\n<hr>\n\n<pre><code>Public Sub ValEmail()\n    Application.Calculation = xlCalculationManual\n    Application.DisplayStatusBar = False\n    Application.EnableEvents = False\n    ActiveSheet.DisplayPageBreaks = False\n    Application.ScreenUpdating = False\n\n    On Error GoTo CATCH\n    Dim LastRow As Long\n    LastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Dim validEmail As Range\n    Set validEmail = Range(\"F2\", \"F\" &amp; LastRow)\n\n    validEmail.Formula = \"=IsEmailValid(A2)\"\n\n    On Error Goto 0\n\nCATCH:\n    Application.Calculation = xlCalculationAutomatic\n    Application.DisplayStatusBar = True\n    Application.EnableEvents = True\n    ActiveSheet.DisplayPageBreaks = True\n    Application.ScreenUpdating = True\n\n    If Err.Number &lt;&gt; 0 Then\n        Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext\n        Err.Clear\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8912124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c2f3fb9698310044d6467631791eda?s=128&d=identicon&r=PG&f=1", "display_name": "sander126", "link": "https://stackoverflow.com/users/8912124/sander126"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 57091228, "answer_count": 2, "score": 1, "last_activity_date": 1563442320, "creation_date": 1563359459, "last_edit_date": 1563402685, "question_id": 57073807, "link": "https://stackoverflow.com/questions/57073807/faster-way-to-put-formula-into-range", "title": "Faster way to put formula into Range", "body": "<p>I have a macro that sets the formula of the Range. It works on small Range but if the range gets more than 1000 it executes very slow</p>\n\n<p>Also <code>Application.ScreenUpdating = False</code> does not work</p>\n\n<p>Here is the setup:\nI have column A where I paste Emails or Passwords.\nI then click a button to run my Macro to Check if the Email or Password is Valid and Return True or False only to the Rows that have values.</p>\n\n<p>Here is my Code:</p>\n\n<pre><code>Sub ValEmail()\n\nApplication.Calculation = xlCalculationManual\nApplication.DisplayStatusBar = False\nApplication.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\nApplication.ScreenUpdating = False\n\nDim lastRow As String\nDim useRange As String\nDim cel As Range\nDim validEmail As Range\nDim rnum As Integer\n\n'Gets the Last Row Used\nrnum = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nlastRow = \"F\" &amp; rnum\n\n'Set the Range where formula will be put\nuseRange = \"F2\" &amp; \":\" &amp; lastRow\n\nSet validEmail = Range(useRange)\n\n'Put formula into Range\nvalidEmail.Formula = \"=IsEmailValid(A2)\"\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.DisplayStatusBar = True\nApplication.EnableEvents = True\nActiveSheet.DisplayPageBreaks = True\nEnd Sub\n</code></pre>\n\n<p>My code works but it is very slow most especially if I have 10k + Rows with Values. Even if there are only 200 Rows it is very slow.</p>\n\n<p>Edit, here is my IsEmailValid Code:</p>\n\n<pre><code>Function IsEmailValid(strEmail)\n\nDim strArray As Variant\nDim strItem As Variant\nDim i As Long, c As String, blnIsItValid As Boolean\nblnIsItValid = True\n\ni = Len(strEmail) - Len(Application.Substitute(strEmail, \"@\", \"\"))\nIf i &lt;&gt; 1 Then IsEmailValid = False: Exit Function\nReDim strArray(1 To 2)\nstrArray(1) = Left(strEmail, InStr(1, strEmail, \"@\", 1) - 1)\nstrArray(2) = Application.Substitute(Right(strEmail, Len(strEmail) - Len(strArray(1))), \"@\", \"\")\nFor Each strItem In strArray\n    If Len(strItem) &lt;= 0 Then\n        blnIsItValid = False\n        IsEmailValid = blnIsItValid\n        Exit Function\n    End If\n    For i = 1 To Len(strItem)\n        c = LCase(Mid(strItem, i, 1))\n        If InStr(\"abcdefghijklmnopqrstuvwxyz'_-.\", c) &lt;= 0 And Not IsNumeric(c) Then\n            blnIsItValid = False\n            IsEmailValid = blnIsItValid\n            Exit Function\n        End If\n    Next i\n    If Left(strItem, 1) = \".\" Or Right(strItem, 1) = \".\" Then\n        blnIsItValid = False\n        IsEmailValid = blnIsItValid\n        Exit Function\n    End If\nNext strItem\nIf InStr(strArray(2), \".\") &lt;= 0 Then\n    blnIsItValid = False\n    IsEmailValid = blnIsItValid\n    Exit Function\nEnd If\ni = Len(strArray(2)) - InStrRev(strArray(2), \".\")\nIf i &lt;&gt; 2 And i &lt;&gt; 3 Then\n    blnIsItValid = False\n    IsEmailValid = blnIsItValid\n    Exit Function\nEnd If\nIf InStr(strEmail, \"..\") &gt; 0 Then\n    blnIsItValid = False\n    IsEmailValid = blnIsItValid\n    Exit Function\nEnd If\nIsEmailValid = blnIsItValid\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1563360604, "post_id": 57073772, "comment_id": 100671667, "body": "What is the first day of the first week??"}, {"owner": {"reputation": 37, "user_id": 9656895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b875f006a330b693b059e6d9c4c4b569?s=128&d=identicon&r=PG&f=1", "display_name": "learnTech", "link": "https://stackoverflow.com/users/9656895/learntech"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1563364745, "post_id": 57073772, "comment_id": 100673826, "body": "Week number will change on every Saturday"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1563369811, "post_id": 57073772, "comment_id": 100677089, "body": "Could you please further clarify your question? 1st of September is Sunday, 6th of September is Friday, meaning that 6/09/2019 still falls in the first week of September (even if we assume that the &quot;new&quot; week always starts on Saturday). I fail to see why 6/09/2019 should be marked as the second week of September."}, {"owner": {"reputation": 37, "user_id": 9656895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b875f006a330b693b059e6d9c4c4b569?s=128&d=identicon&r=PG&f=1", "display_name": "learnTech", "link": "https://stackoverflow.com/users/9656895/learntech"}, "edited": false, "score": 0, "creation_date": 1563369857, "post_id": 57073772, "comment_id": 100677120, "body": "our 2019 financial year is starting on 29 Dec 2018 to Dec 27 2019, so based on this period, 29 dec 2019 to 4 jan 2019 is the Week 1 of Jan 2019, from 5 th Jan 2019 week 2 will start. like this I need to show Sep 6 as week 2"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1563372764, "post_id": 57073772, "comment_id": 100679057, "body": "Follow-up question: if the second fiscal week of September is 31 August - 6 September, then the first September week of your fiscal year is 24 August - 30 August? Is that correct?"}, {"owner": {"reputation": 37, "user_id": 9656895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b875f006a330b693b059e6d9c4c4b569?s=128&d=identicon&r=PG&f=1", "display_name": "learnTech", "link": "https://stackoverflow.com/users/9656895/learntech"}, "edited": false, "score": 0, "creation_date": 1563374274, "post_id": 57073772, "comment_id": 100680112, "body": "yes, your guess is correct."}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1563379381, "post_id": 57073772, "comment_id": 100683087, "body": "To be honest I&#39;m not sure how to achieve this with <code>dateCell</code> since we have &quot;custom&quot; week numbers... I&#39;m going to post an alternative solution in a minute."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9656895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b875f006a330b693b059e6d9c4c4b569?s=128&d=identicon&r=PG&f=1", "display_name": "learnTech", "link": "https://stackoverflow.com/users/9656895/learntech"}, "edited": false, "score": 0, "creation_date": 1563429964, "post_id": 57080190, "comment_id": 100698429, "body": "I can use this ans for 2019, but my project has 104 weeks, these weeks will generated based on start date.i.e if start date is Sep 6, then 7 days will add to the week no. like this 104 weeks will generate. I am looking for VBA code/Excel custom formula for this requirement. the start date is dynamic in current month/upcoming months. it will be great help if any solution found for this."}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "reply_to_user": {"reputation": 37, "user_id": 9656895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b875f006a330b693b059e6d9c4c4b569?s=128&d=identicon&r=PG&f=1", "display_name": "learnTech", "link": "https://stackoverflow.com/users/9656895/learntech"}, "edited": false, "score": 0, "creation_date": 1563436745, "post_id": 57080190, "comment_id": 100701491, "body": "Can you use the first code that I posted for that? It uses <code>For Each rng in Range (&quot;A2:A53&quot;)</code> statement. You can change the cell range to <code>A2:A106</code> where you have your relevant dates for 104 weeks."}], "tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": false, "score": 0, "last_activity_date": 1563379735, "creation_date": 1563379735, "answer_id": 57080190, "question_id": 57073772, "link": "https://stackoverflow.com/questions/57073772/find-the-week-no-in-a-month-based-on-the-financial-calendar-in-vba/57080190#57080190", "title": "Find the week no in a month based on the Financial calendar in VBA", "body": "<p>In order to test this code I added dates for the whole year (column A) along with their respective week numbers (column B) and months (column C). I followed your request where you specified financial calendar to be on 4-4-5 basis.</p>\n\n<p>The code produces the following results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YqfS0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YqfS0.png\" alt=\"enter image description here\"></a></p>\n\n<p>Code:</p>\n\n<pre><code>Sub finDates()\n    Dim dateCell As Long, weekNo As Long, weekYear As Long, monthNo As Long\n    Dim finalResult As String\n    Dim calc As Double\n    Dim rng As Range\n\n    For Each rng In Range(\"A2:A53\")\n        dateCell = rng.Value 'column A\n        weekYear = DatePart(\"ww\", dateCell, vbSaturday) 'column B\n        calc = weekYear / (4 + (1 / 3))\n        monthNo = Application.WorksheetFunction.RoundUp(calc, 0) 'column C\n        weekNo = Application.WorksheetFunction.RoundUp((calc - Fix(calc)) * (4 + 1 / 3), 0)\n\n        If weekNo Then\n            finalResult = Format(DateSerial(2019, monthNo, 1), \"\\ mmm \" &amp; \"\\W\" &amp; weekNo)\n        Else\n            finalResult = Format(DateSerial(2019, monthNo, 1), \"\\ mmm \" &amp; \"\\W\" &amp; 5)\n        End If\n\n        rng.Offset(0, 3).Value = finalResult 'column D\n    Next rng\nEnd Sub\n</code></pre>\n\n<p>That being said, if you only want to analyse one date, you can use the following code:</p>\n\n<pre><code>Sub finDates()\n    Dim dateCell As Long, weekNo As Long, weekYear As Long, monthNo As Long\n    Dim finalResult As String\n    Dim calc As Double\n\n    dateCell = Range(\"A1\").Value\n    weekYear = DatePart(\"ww\", dateCell, vbSaturday)\n    calc = weekYear / (4 + (1 / 3))\n    monthNo = Application.WorksheetFunction.RoundUp(calc, 0)\n    weekNo = Application.WorksheetFunction.RoundUp((calc - Fix(calc)) * (4 + 1 / 3), 0)\n\n    If weekNo Then\n        finalResult = Format(DateSerial(2019, monthNo, 1), \"\\ mmm \" &amp; \"\\W\" &amp; weekNo)\n    Else\n        finalResult = Format(DateSerial(2019, monthNo, 1), \"\\ mmm \" &amp; \"\\W\" &amp; 5)\n    End If\n\n    Range(\"B1\").Value = finalResult\nEnd Sub\n</code></pre>\n\n<p>Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VePks.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VePks.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 37, "user_id": 9656895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b875f006a330b693b059e6d9c4c4b569?s=128&d=identicon&r=PG&f=1", "display_name": "learnTech", "link": "https://stackoverflow.com/users/9656895/learntech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563379735, "creation_date": 1563359306, "last_edit_date": 1563359412, "question_id": 57073772, "link": "https://stackoverflow.com/questions/57073772/find-the-week-no-in-a-month-based-on-the-financial-calendar-in-vba", "title": "Find the week no in a month based on the Financial calendar in VBA", "body": "<p>The issue is Sep 6 2019 needs to display as Week 2 of Sep, but i am getting Sep Week 1.\n    Week no will change on every Saturday. my Financial calendar is 4-4-5 basis, </p>\n\n<p>My Financial calendar starts on Last week of December(2018) to Dec 27 2019. below is the format I need to show.</p>\n\n<pre><code>Jan = 4 weeks\nFeb = 4 weeks\nMar = 5 weeks\nApr = 4 weeks\nMay = 4 weeks\nJun = 5 weeks\nJul = 4 weeks\nAug = 4 weeks\nSep = 5 weeks\nOct = 4 weeks\nNov = 4 weeks\nDec = 5 weeks (sometimes 6)\n\nweekNo= Trim(Format(dateCell.Value, \"\\ mmm \" &amp; \"\\W\" &amp; DatePart(\"ww\", dateCell) - DatePart(\"ww\", DateSerial(Year(dateCell), Month(dateCell), 1)) +1))\n</code></pre>\n\n<p>VBA Code tried: it is returning ISO week no as sep Week 1, but I need week no as per financial calendar. that is Sep 6 2019 need to display as sep Week 2.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563357464, "post_id": 57073109, "comment_id": 100670042, "body": "That means your <code>If</code> statement is not <code>True</code>. Debug your code, go through it step by step using F8 and check the value of <code>dom</code> and <code>Sheets(&quot;Data&quot;).Range(&quot;domsubdomain&quot;).Cells(i, 25).Value</code> \u2022 Actually <code>subpo</code> is not declared and therefore <code>0</code> so it should error at <code>Cells(i, 25)</code> \u2022 Make sure you use <code>Option Explicit</code> as first line in your code. I recommend always to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>."}, {"owner": {"reputation": 13, "user_id": 11670105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SSVtSKuEHyE/AAAAAAAAAAI/AAAAAAAAAEI/TiZpZnwHHAc/photo.jpg?sz=128", "display_name": "mariam jallouli", "link": "https://stackoverflow.com/users/11670105/mariam-jallouli"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563357649, "post_id": 57073109, "comment_id": 100670170, "body": "@P\u1d07\u029c nothing comes up. For subpro it was a mistake I forgot to change it to position"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563357777, "post_id": 57073109, "comment_id": 100670259, "body": "in your <code>CommandButton2_Click</code> write as first line <code>Stop</code>. Then click your button. If it stops at <code>Stop</code> with a yellow line start pressing F8 it goes through your code then step by step. If it comes to your <code>If</code> statement check the values."}, {"owner": {"reputation": 13, "user_id": 11670105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SSVtSKuEHyE/AAAAAAAAAAI/AAAAAAAAAEI/TiZpZnwHHAc/photo.jpg?sz=128", "display_name": "mariam jallouli", "link": "https://stackoverflow.com/users/11670105/mariam-jallouli"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563358147, "post_id": 57073109, "comment_id": 100670472, "body": "@P\u1d07\u029c it came to dom value 1st but I put a msgbox to make sure it comes out as I want and it does."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563361778, "post_id": 57073109, "comment_id": 100672276, "body": "and what is the result of it? and what is the result of <code>Sheets(&quot;Data&quot;).Range(&quot;domsubdomain&quot;).Cells(i, 25).Value</code>? If you expect us to help we need much more details than <i>&quot;it does&quot;</i>."}, {"owner": {"reputation": 13, "user_id": 11670105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SSVtSKuEHyE/AAAAAAAAAAI/AAAAAAAAAEI/TiZpZnwHHAc/photo.jpg?sz=128", "display_name": "mariam jallouli", "link": "https://stackoverflow.com/users/11670105/mariam-jallouli"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563363817, "post_id": 57073109, "comment_id": 100673334, "body": "@P\u1d07\u029c it concatenates the 3 letters of the domain with the sub domain"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563363984, "post_id": 57073109, "comment_id": 100673417, "body": "Sorry you need to tell the <b>exact</b> result (value) of both expressions (that I asked in my comments before). And you need to answer the questions. We cannot help you if you don&#39;t provide the information we ask for. Reading <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> might also help to improve your question."}], "owner": {"reputation": 13, "user_id": 11670105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SSVtSKuEHyE/AAAAAAAAAAI/AAAAAAAAAEI/TiZpZnwHHAc/photo.jpg?sz=128", "display_name": "mariam jallouli", "link": "https://stackoverflow.com/users/11670105/mariam-jallouli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 329, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563357772, "creation_date": 1563357109, "last_edit_date": 1563357772, "question_id": 57073109, "link": "https://stackoverflow.com/questions/57073109/how-to-increment-numbers-automatically-after-the-insert-of-a-new-row", "title": "How to increment numbers automatically after the insert of a new row?", "body": "<p>In my data table I am trying to insert a new row whenever a new information is added. \nEach row has a unique index, for example in the first column, I have some work domains such as Pilotage, in the second column I have sub domains of the domain for example for Pilotage I have Quality, the index is Pil_01. Each sub domain has its own products, when I add a product in position 15, I want that the indexes below line 15 that belong to the domain pilotage to be incremented by 1 </p>\n\n<pre><code>Private Sub CommandButton2_Click()    \n    Dim position As Integer\n    Dim dom As String\n    Dim tbl As ListObject\n    Dim ws As Worksheet\n    Dim newrow As ListRow\n\n    ' domain is the name of the comobox in which the user will choose the domain and subdomain the name of the comobox in which the user will choose the sub domain\\ domsubdomain is a column in my table which has the 3 first letters of the domain concatenated with the subdomain\n    dom = Left(domain, 3) &amp; subdomain\n    position = Application.WorksheetFunction.Match(dom, Sheets(\"Data\").Range(\"domsubdomain\"), 0)\n\n    ' this is the code allowing me to insert a new row and add some data into it\n    Set ws = Sheets(\"Data\")\n    Set tbl = ws.ListObjects(\"Referentiel\")\n    Set newrow = tbl.ListRows.Add(position + 1)\n\n    With newrow\n        .Range(2) = subdomain\n        .Range(3) = Produit\n        .Range(4) = Procedure\n    If Procedure &lt;&gt; \"\" Then\n        count = 1\n        .Range(5) = Processus\n    End If\n\n\n    ' The for loop will allow me to go through all data in that column starting from the new row's position and increment the cells by one. It stops when meeting a new domain\n    For i = position To 1000\n        If dom = Sheets(\"Data\").Range(\"domsubdomain\").Cells(i, 25).Value Then\n            chaine = Sheets(\"Data\").Range(\"domsubdomain\").Cells(i, 24).Value\n            chaine = chaine + 1\n            Sheets(\"Data\").Range(\"domsubdomain\").Cells(i, 24).Value = chaine\n        Else\n            MsgBox \"Exit\"\n            Exit For\n        End If\n    Next i  \nEnd Sub\n</code></pre>\n\n<p>with this code I have the message exit instead of going through the code below</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1563356790, "post_id": 57072989, "comment_id": 100669677, "body": "There is a typo <code>1Rows</code> should be <code>lRows</code> (lower case <code>L</code> not a one <code>1</code>) \u2022 I recommend always to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>. That would prevent such typos. \u2022 I recommend to specify the sheet for <code>Range(&quot;A:A&quot;)</code> like <code>ws.Range(&quot;A:A&quot;)</code>"}, {"owner": {"reputation": 5, "user_id": 6854714, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kS1X4apbWXY/AAAAAAAAAAI/AAAAAAAAABI/lWeCZRvDsgY/photo.jpg?sz=128", "display_name": "william vinemorris", "link": "https://stackoverflow.com/users/6854714/william-vinemorris"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563357013, "post_id": 57072989, "comment_id": 100669793, "body": "Thank you I didn&#39;t even notice it until i put the code in here because in excel they looked identical, i have turned on that setting as well."}], "owner": {"reputation": 5, "user_id": 6854714, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kS1X4apbWXY/AAAAAAAAAAI/AAAAAAAAABI/lWeCZRvDsgY/photo.jpg?sz=128", "display_name": "william vinemorris", "link": "https://stackoverflow.com/users/6854714/william-vinemorris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563356726, "creation_date": 1563356699, "last_edit_date": 1563356726, "question_id": 57072989, "link": "https://stackoverflow.com/questions/57072989/how-to-fix-syntax-error-while-using-cells-function-in-vba", "title": "How to fix Syntax Error while using .cells function in vba?", "body": "<p>I carry on getting either \"syntax error\" or \"expected list separator or )\" on the first .cells line but it works perfectly if I remove it</p>\n\n<p>I have tried changing variable names and types</p>\n\n<pre><code>Private Sub cmdAdd_Click()\n    Dim lRows As Long\n    Dim col As Range\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Activity\")\n    Set col = Range(\"A:A\")\n\n    lRows = Application.WorksheetFunction.Count(col) + 1\n\n    'copy the data to the database\n    With ws\n      .Cells(1Rows, 1).Value = 1Rows\n      .Cells(lRows, 2).Value = Me.DateS.Value \n    End With\nEnd Sub\n</code></pre>\n\n<p>it should out put a number one after the last one in column A but it gives me error instead</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1563356266, "post_id": 57072692, "comment_id": 100669403, "body": "want to know what problem are you facing and also one suggestion want to give by looking at your code , before range provide workbook and worksheet name for which you are referring"}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "is_accepted": true, "score": 0, "last_activity_date": 1563357355, "creation_date": 1563357355, "answer_id": 57073186, "question_id": 57072692, "link": "https://stackoverflow.com/questions/57072692/vba-script-to-overwrite-all-contents-from-worksheet-with-same-name-from-one-work/57073186#57073186", "title": "VBA script to overwrite all contents from worksheet with same name from one workbook to another", "body": "<pre><code>Sub so()\nDim wb As Workbook\nDim wb1 As Workbook\nSet wb = Workbooks(\"SourceWorkbook.xlsx\")\nSet wb1 = Workbooks(\"MasterWorkbook.xlsx\")\nDim wk As Worksheet\nDim wm As Worksheet\nSet wm = wb1.Worksheets(\"Asia\")\nFor Each wk In wb.Worksheets\n wk.Activate\nIf (wk.Name = \"Asia\") Then\n        Dim TR As Integer\n        TR = wk.Range(\"S\" &amp; Rows.Count).End(xlUp).Row\n        wk.Range(\"Z4\").Formula = \"=CONCATENATE(TEXT(D4,\"\"mm/dd/yyyy\"\"),S4,M4)\"\n        wk.Range(\"Z4:Z\" &amp; TR).Copy wm.Range(\"Z4\")\n        Application.CutCopyMode = False\n\n        Dim UR As Integer\n        UR = wk.Range(\"S\" &amp; Rows.Count).End(xlUp).Row\n        wk.Range(\"AA4\").Formula = \"=CONCATENATE(TEXT(D4,\"\"mm/dd/yyyy\"\"),S4,F4)\"\n        wk.Range(\"AA4:AA\" &amp; UR).Copy wm.Range(\"AA4\")\n        Application.CutCopyMode = False\n\n        Dim DR As Integer\n        DR = wk.Range(\"S\" &amp; Rows.Count).End(xlUp).Row\n        wk.Range(\"AB4\").Formula = \"=CONCATENATE(TEXT(A4,\"\"mm/dd/yyyy\"\"),S4,K4)\"\n       wk.Range(\"AB4:AB\" &amp; DR).Copy wm.Range(\"AB4\")\n        Application.CutCopyMode = False\n\n        Dim FR As Integer\n        FR = wk.Range(\"S\" &amp; Rows.Count).End(xlUp).Row\n        wk.Range(\"AC4\").Formula = \"=CONCATENATE(TEXT(A4,\"\"mm/dd/yyyy\"\"),S4,K4)\"\n        wk.Range(\"AC4:AC\" &amp; FR).Copy wm.Range(\"AC4\")\n        Application.CutCopyMode = False\n\n        ActiveSheet.Range(\"A1\").Value = Date\n        ActiveSheet.Range(\"A1\").Formula = \"=TEXT(TODAY(),\"\"dd/mm/yyyy\"\")\"\n\n        Last = Cells(Rows.Count, \"A\").End(xlUp).Row\n        For j = Last To 1 Step -1\n             If ActiveSheet.Cells(j, 1) &gt; ActiveSheet.Range(\"A1\") Then\n\n                ActiveSheet.Cells(j, 29).FormulaR1C1 = \"=CONCATENATE(RC[-10], RC[-18])\"\n\n\n            End If\n\n        Next j\nEnd If\nNext wk\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11796668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9d9d04a2bd37462788e71318b9cb4c0?s=128&d=identicon&r=PG&f=1", "display_name": "Xkluah89", "link": "https://stackoverflow.com/users/11796668/xkluah89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 57073186, "answer_count": 1, "score": 0, "last_activity_date": 1563359171, "creation_date": 1563355793, "last_edit_date": 1563359171, "question_id": 57072692, "link": "https://stackoverflow.com/questions/57072692/vba-script-to-overwrite-all-contents-from-worksheet-with-same-name-from-one-work", "title": "VBA script to overwrite all contents from worksheet with same name from one workbook to another", "body": "<p>VBA amateur here, I am writing a code to automate some processes in my workplace, i am however stuck in trying to overwrite all contents from workseets of the same name from one workbook to another. </p>\n\n<p>My current process is as follows.</p>\n\n<ul>\n<li>I store the macro in workbook 1</li>\n<li>I open the worksheet which i wish to run the macro on </li>\n<li>I run the macro</li>\n<li>Ideally the macro should run the code below onto every worksheet and following which overwrite the data of a similar worksheet name in my master workbook. It is likely to be 40 different sheets with static worksheet name.</li>\n</ul>\n\n<p>example: copy contents in worksheet(\"Asia\") of workbook A into worksheet(\"Asia\") of master workbook.</p>\n\n<p>Please advise if this can be done in vba.</p>\n\n<p>I tried looking up solutions on this site but is unable to find a solution.</p>\n\n<pre><code>Dim wk As Worksheet\nFor Each wk In ActiveWorkbook.Worksheets\n wk.Activate\n\n\n        Dim TR As Integer\n        TR = Range(\"S\" &amp; Rows.Count).End(xlUp).Row\n        Range(\"Z4\").Formula = \"=CONCATENATE(TEXT(D4,\"\"mm/dd/yyyy\"\"),S4,M4)\"\n        Range(\"Z4\").Copy\n        Range(\"Z4:Z\" &amp; TR).PasteSpecial xlPasteAll\n        Application.CutCopyMode = False\n\n        Dim UR As Integer\n        UR = Range(\"S\" &amp; Rows.Count).End(xlUp).Row\n        Range(\"AA4\").Formula = \"=CONCATENATE(TEXT(D4,\"\"mm/dd/yyyy\"\"),S4,F4)\"\n        Range(\"AA4\").Copy\n        Range(\"AA4:AA\" &amp; UR).PasteSpecial xlPasteAll\n        Application.CutCopyMode = False\n\n        Dim DR As Integer\n        DR = Range(\"S\" &amp; Rows.Count).End(xlUp).Row\n        Range(\"AB4\").Formula = \"=CONCATENATE(TEXT(A4,\"\"mm/dd/yyyy\"\"),S4,K4)\"\n        Range(\"AB4\").Copy\n        Range(\"AB4:AB\" &amp; DR).PasteSpecial xlPasteAll\n        Application.CutCopyMode = False\n\n        Dim FR As Integer\n        FR = Range(\"S\" &amp; Rows.Count).End(xlUp).Row\n        Range(\"AC4\").Formula = \"=CONCATENATE(TEXT(A4,\"\"mm/dd/yyyy\"\"),S4,K4)\"\n        Range(\"AC4\").Copy\n        Range(\"AC4:AC\" &amp; FR).PasteSpecial xlPasteAll\n        Application.CutCopyMode = False\n\n        ActiveSheet.Range(\"A1\").Value = Date\n        ActiveSheet.Range(\"A1\").Formula = \"=TEXT(TODAY(),\"\"dd/mm/yyyy\"\")\"\n\n        Last = Cells(Rows.Count, \"A\").End(xlUp).Row\n        For j = Last To 1 Step -1\n             If ActiveSheet.Cells(j, 1) &gt; ActiveSheet.Range(\"A1\") Then\n\n                ActiveSheet.Cells(j, 29).FormulaR1C1 = \"=CONCATENATE(RC[-10], RC[-18])\"\n\n\n            End If\n\n        Next j\n\nNext wk\n\nEnd Sub\n</code></pre>\n\n<p>My code for the spreadsheet above work, i am just figuring out how i can update the data in my master workbook.</p>\n"}, {"tags": ["excel", "vba", "powerpoint", "dropdown"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1563786070, "post_id": 57072572, "comment_id": 100800080, "body": "I&#39;d like to test for you, but this is a lot of code and of course I don&#39;t have your workbooks or anything. Could you please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? It just needs enough to reproduce the problem, without any &quot;bells and whistles&quot;."}, {"owner": {"reputation": 11, "user_id": 11796675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/babf7dcc9e1b8cc63026a3df91f5fcb6?s=128&d=identicon&r=PG&f=1", "display_name": "callumlmcgrath", "link": "https://stackoverflow.com/users/11796675/callumlmcgrath"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1563882425, "post_id": 57072572, "comment_id": 100840626, "body": "I couldn&#39;t work out how to attach a file so hopefully the following link will let you download them - <a href=\"https://wetransfer.com/downloads/6dcbda3f91a46c957f5dbb0cb0b2deaa20190723114415/ec3fe2\" rel=\"nofollow noreferrer\">wetransfer.com/downloads/&hellip;</a> It contains the PowerPoint presentation and the Excel file too."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1563887208, "post_id": 57072572, "comment_id": 100843442, "body": "No, file attachments aren&#39;t allowed here, and for good reason. This is a Q&amp;A site, not a help desk. The information here should be accessible to everyone who may have interest in the problem. Files provided externally don&#39;t meet these criteria. Please provide all relevant information <i>in the question</i>. Yes, that probably means time and extra work - but we shouldn&#39;t have to do that work, as well as look for the solution..."}], "owner": {"reputation": 11, "user_id": 11796675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/babf7dcc9e1b8cc63026a3df91f5fcb6?s=128&d=identicon&r=PG&f=1", "display_name": "callumlmcgrath", "link": "https://stackoverflow.com/users/11796675/callumlmcgrath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563882447, "creation_date": 1563355345, "last_edit_date": 1563882447, "question_id": 57072572, "link": "https://stackoverflow.com/questions/57072572/toggle-dropdown-send-graphs-to-powerpoint-and-save", "title": "Toggle dropdown, send graphs to powerpoint and save", "body": "<p>Example Documents - <a href=\"https://wetransfer.com/downloads/6dcbda3f91a46c957f5dbb0cb0b2deaa20190723114415/ec3fe2\" rel=\"nofollow noreferrer\">https://wetransfer.com/downloads/6dcbda3f91a46c957f5dbb0cb0b2deaa20190723114415/ec3fe2</a></p>\n\n<p>I am trying to select an option from a drop down (which will change some graphs), then send graphs to a Powerpoint presentation, save the presentation and move on to the next option in the dropdown to repeat.</p>\n\n<p>Getting it to do it once is ok, but I'm struggling with the repeat - I get an error </p>\n\n<blockquote>\n  <p>Run-time error '70' Permission Denied</p>\n</blockquote>\n\n<p>when it gets to the bit where it needs to open a powerpoint with the name of the next option on the dropdown. The error is on </p>\n\n<pre><code>FileCopy \"K:\\Data Analysis\\Toxicology\\Tox Customer MI\" &amp; \"\\\" &amp; Range(\"Customer_MI_Template\"), PPReport_Name). \n</code></pre>\n\n<p>I think it may be because it hasn't actually selected the next dropdown option and so is a duplicate file name.</p>\n\n<p>I thought at first it was because it couldn't find the file location as it was set to 'ThisWorkbook.Path' however if I change this to the actually drive and file path it still doesn't work.</p>\n\n<p>I then thought it was because the next thing on my dropdown had illegal characters, however I removed these and still no.</p>\n\n<pre><code>Option Explicit\n\nSub MakePowerpoint()\n\nThisWorkbook.Save\n\n\nDim MyPath As String\nDim FileName As String\n\nDim objPPT As Object\nDim ppt As Object\nDim sld As Object\nDim shp As Object\nDim PPReport_Name As String\nDim DocName As String\nDim shpIndex As Long\nDim CurSlide As Long\n\nDim sh As Excel.Worksheet\nDim ObjName As String\nDim ObjType As String\nDim PPSldNum As Long\nDim PPObjName As String\nDim MyTop As Double\nDim MyLeft As Double\nDim MyHeight As Double\nDim MyWidth As Double\nDim cl As Range\nDim OldText As String\nDim NewText As String\n\nDim dvCell As Range\n    Dim inputRange As Range\n    Dim c As Range\n    Dim i As Long\n\n' which cell has data v to for each c in input from online\n\n 'Which cell has data validation\n    Set dvCell = Worksheets(\"Customer Homepage\").Range(\"D11\")\n     'Determine where validation comes from\n    Set inputRange = Evaluate(dvCell.Validation.Formula1)\n\n\n    i = 1\n     'Begin our loop\n    Application.ScreenUpdating = False\n    For Each c In inputRange\n\n' Set up the pathname and the output PowerPoint Presentation Name\nMyPath = ThisWorkbook.Path\nPPReport_Name = MyPath &amp; \"\\\" &amp; MonthName(Month(Range(\"D10\"))) &amp; \"\\\" &amp; Range(\"PPReport_Name\")\n\n' Copy the template file to the PowerPoint Presentation Name\n***FileCopy \"K:\\Data Analysis\\Toxicology\\Tox Customer MI\" &amp; \"\\\" &amp; Range(\"Customer_MI_Template\"), PPReport_Name***\n\n' Open the PowerPoint Presentation\nSet objPPT = CreateObject(\"PowerPoint.Application\")\nobjPPT.Visible = True\nobjPPT.presentations.Open PPReport_Name\n\nSet ppt = objPPT.activepresentation\n\n' Add objects\nFor Each cl In Range(\"Table_Objects[Excel Page]\")\n    ObjType = cl.Offset(0, 2).Value     ' Type of the thing to copy\n    If ObjType &lt;&gt; \"Text\" Then\n        Set sh = Sheets(cl.Value)       ' Excel Sheet\n        ObjName = cl.Offset(0, 1).Value ' Name of the thing to copy\n    End If\n\n    PPSldNum = cl.Offset(0, 3).Value    ' PowerPoint slide number\n    PPObjName = cl.Offset(0, 4).Value   ' PowerPoint object\n    MyTop = cl.Offset(0, 5).Value       ' Top\n    MyLeft = cl.Offset(0, 6).Value      ' Left\n    MyHeight = cl.Offset(0, 7).Value    ' Height\n    MyWidth = cl.Offset(0, 8).Value     ' Width\n    OldText = cl.Offset(0, 9).Value     ' Old Text\n    NewText = cl.Offset(0, 10)          ' New Text\n\n    Set sld = ppt.slides(PPSldNum)      ' Active Slide\n\n    Select Case ObjType\n        Case \"Text\"\n            sld.Shapes(PPObjName).TextFrame.TextRange.Text = _\n                Replace(sld.Shapes(PPObjName).TextFrame.TextRange.Text, OldText, NewText)\n        Case \"Chart\"\n            sh.Shapes(ObjName).CopyPicture\n        Case \"Range\"\n            sh.Range(ObjName).CopyPicture\n    End Select\n\n    If ObjType = \"Chart\" Or ObjType = \"Range\" Then\n        sld.Shapes.Paste\n        shpIndex = sld.Shapes.Count\n        With sld.Shapes(shpIndex)\n            .LockAspectRatio = msoFalse\n            .Top = 72 * MyTop\n            .Left = 72 * MyLeft\n            .Height = 72 * MyHeight\n            .Width = 72 * MyWidth\n        End With\n    End If\n\nNext\n\n\n'Next c and screenupdate true from online\n\nNext c\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nFunction GetText(ObjName As String, Pos As Long) As String\nDim cl As Range\nDim Result As String\n\nResult = \"Value not found\"\n\nFor Each cl In Range(\"Table_TextFrame[PPObjName]\")\n    If cl.Value = ObjName Then\n        Result = cl.Offset(0, Pos).Value\n        Exit For\n    End If\nNext\nGetText = Result\nEnd Function\n</code></pre>\n\n<p>The macro will run and save a powerpoint based on whoever I select in the dropdown no problem, but then will not repeat for the next option on the dropdown.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563355627, "post_id": 57072525, "comment_id": 100669032, "body": "While you can trigger new sheets with <code>Workbook_NewSheet</code> event and removing sheets with the <code>Workbook_SheetBeforeDelete</code> event you will run into issues if someone renames a sheet, because there is no event for renaming sheets."}, {"owner": {"reputation": 53, "user_id": 10618733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec60eddcd824249e94f6fe661e12b64e?s=128&d=identicon&r=PG&f=1", "display_name": "cristi m", "link": "https://stackoverflow.com/users/10618733/cristi-m"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563356260, "post_id": 57072525, "comment_id": 100669399, "body": "The sheets will not be renamed."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563356519, "post_id": 57072525, "comment_id": 100669541, "body": "Well you probably cannot prevent this (just assume that no one will do it), the same issue occurs when someone moves a sheet around (re orders them). If you can prevent renaming and re-sorting, then try to use the both events that I suggested to edit your columns. The index of the added (or deleted) sheet <code>sh.Index</code> in these events should give you the column number where to add/delete a column."}, {"owner": {"reputation": 53, "user_id": 10618733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec60eddcd824249e94f6fe661e12b64e?s=128&d=identicon&r=PG&f=1", "display_name": "cristi m", "link": "https://stackoverflow.com/users/10618733/cristi-m"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563360908, "post_id": 57072525, "comment_id": 100671844, "body": "How do i add a column or delete one based on sh.Index?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563361901, "post_id": 57072525, "comment_id": 100672346, "body": "As you added the other columns too (see your code). Instead of <code>i</code> use the index. Give it a try do some research and if you get stuck or errors come back and ask a question and show your code."}], "owner": {"reputation": 53, "user_id": 10618733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec60eddcd824249e94f6fe661e12b64e?s=128&d=identicon&r=PG&f=1", "display_name": "cristi m", "link": "https://stackoverflow.com/users/10618733/cristi-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563355288, "creation_date": 1563355200, "last_edit_date": 1563355288, "question_id": 57072525, "link": "https://stackoverflow.com/questions/57072525/create-a-column-in-a-different-sheet-for-each-sheet-in-workbook", "title": "Create a column in a different sheet for each sheet in workbook", "body": "<p>I have 4  sheets in my workbook. However I will add or remove sheets before sheet4. That is the only sheet that doesn't change. On this sheet I want to create a column for each sheet before sheet4. Column A for sheet1, column B for sheet2 and column C for Sheet3. </p>\n\n<p>The first cell of each column should contain sheet name. I managed to do this but I'm unable to do the following: Whenever I delete a sheet the corresponding column created in sheet4 should be deleted and when I add a new sheet a new column should be created relative to the position in the workbook (if in between sheets 2 and 3 the column should be column C) </p>\n\n<p>I would also like to insert a defined range like A1:A5, B1:B5 etc instead of a full column for each sheet, if is possible.</p>\n\n<pre><code>Sub Prepare2_Sheet()\n    Dim sheetnum As Long\n    sheetnum = ThisWorkbook.Worksheets(\"Sheet4\").Index - 1\n\n    For i = 1 To sheetnum\n        Sheet4.Columns(i).Insert\n        Sheet4.Cells(1, i) = ThisWorkbook.Worksheets(i).Name\n    Next i        \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1563354201, "post_id": 57072168, "comment_id": 100668136, "body": "Have you tried supplying the correct password?"}, {"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1563354589, "post_id": 57072168, "comment_id": 100668379, "body": "@TimStack Yes I believe I had. But what is &quot;the correct password&quot;? Several users should be able to use this workbook and button."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1563355177, "post_id": 57072168, "comment_id": 100668725, "body": "AFAIK <i>you</i> are the one who locked the wb, so you should know the password. The user does not need to know the password as long as your code unlocks the wb with the correct password"}, {"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1563355707, "post_id": 57072168, "comment_id": 100669089, "body": "@TimStack Great! It is the same pawssword. I have relocated the password string and it solves the error 1004. Yet all sheets are unprotected after running the script."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1563356086, "post_id": 57072168, "comment_id": 100669299, "body": "Well that is exactly what you coded. You want VBA <i>not</i> to do what you wrote?"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "edited": false, "score": 0, "creation_date": 1563355145, "post_id": 57072454, "comment_id": 100668703, "body": "Thank you! I Just realized that. The problem was that <code>Private Const yourPassword As String = &quot;ThePassWord&quot;</code> was located in the middle of the module and not in the very beginning."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "edited": false, "score": 0, "creation_date": 1563355219, "post_id": 57072454, "comment_id": 100668757, "body": "@SimonJ Anyway activate <code>Option Explicit</code>. It would have thrown a warning."}, {"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "edited": false, "score": 0, "creation_date": 1563355541, "post_id": 57072454, "comment_id": 100668974, "body": "I just did. It didn&#39;t throw a warning. But all sheets are now unprotected after running the script?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "edited": false, "score": 0, "creation_date": 1563355728, "post_id": 57072454, "comment_id": 100669101, "body": "@SimonJ strange I thought it should. \u2022 If you run <code>ProtectAll</code> all should be protected. Or what was your question? Note that <code>ActiveWorkbook</code> is the workbook that has the focus (is on top) but <code>ThisWorkbook</code> is the workbook the code is running in."}, {"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "edited": false, "score": 0, "creation_date": 1563355846, "post_id": 57072454, "comment_id": 100669162, "body": "I run <code>ProtectAll</code> just before my <code>End Sub</code> at the <code>ButtonClick()</code>. Yet it leaves all sheets unprotected and whole workbook too."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "edited": false, "score": 0, "creation_date": 1563355893, "post_id": 57072454, "comment_id": 100669193, "body": "Change <code>ActiveWorkbook</code> to <code>ThisWorkbook</code>. If it doesn&#39;t work go throug your code step by step using F8 and see what happens."}, {"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "edited": false, "score": 0, "creation_date": 1563357046, "post_id": 57072454, "comment_id": 100669809, "body": "<code>ProtectAll</code> works fine just by it self. I have tried to move it around in the script but it gets more buggy than else. I belive it should be before <code>Exit Sub</code> and/or the <code>ExitHandler</code>?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "edited": false, "score": 0, "creation_date": 1563357252, "post_id": 57072454, "comment_id": 100669929, "body": "@SimonJ well that&#39;s getting a way beyond your original question now. Please ask a new question if you have a new problem and post your code in the new question. We are not able to answer follow up questions in comments that are not the original question. \u2022 But of course you should make sure it runs (even in case of error)."}, {"owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "edited": false, "score": 0, "creation_date": 1563357525, "post_id": 57072454, "comment_id": 100670081, "body": "I&#39;ve tried another approach and created a sub for the button only which calls for <code>UnprotectAll</code>, then <code>MainRutine</code>, then <code>ProtectAll</code>. It is the <code>Method &#39;Protect&#39; of object &#39;_Worksheet failed</code> that comes as a error 1004 now"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "edited": false, "score": 0, "creation_date": 1563357633, "post_id": 57072454, "comment_id": 100670158, "body": "@SimonJ Again: Please ask a new question and include your code in that new question, we cannot answer this in comments here."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1563354991, "last_edit_date": 1592644375, "creation_date": 1563354991, "answer_id": 57072454, "question_id": 57072168, "link": "https://stackoverflow.com/questions/57072168/excel-run-macro-button-with-password-protection/57072454#57072454", "title": "Excel Run Macro button with password protection", "body": "<ol>\n<li><p>Make sure you use <code>Option Explicit</code> as first line in <strong>every</strong> module and worksheet code! This ensures you don't run into a not declared local scope variable <code>yourPassword</code> which then is empty.</p>\n<p>I recommend always to activate <code>Option Explicit</code>: In the VBA editor go to <em>Tools</em> \u203a <em>Options</em> \u203a <em><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></em>.</p>\n</li>\n<li><p>Make sure you unprotect (manually) all your sheets using your password.</p>\n</li>\n<li><p>Define your new desired password as constant in a module</p>\n<pre><code> Private Const yourPassword As String = &quot;ThePassWord&quot;\n</code></pre>\n</li>\n<li><p>Use this constant for your <code>.Protect</code>/<code>.Unprotect</code></p>\n<pre><code> sh.Protect Password:=yourPassword\n</code></pre>\n</li>\n<li><p>Then run your code again.</p>\n</li>\n</ol>\n"}], "owner": {"reputation": 7, "user_id": 10759202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469471ee0a473d37bb05e21f9248fec5?s=128&d=identicon&r=PG&f=1", "display_name": "Simon J", "link": "https://stackoverflow.com/users/10759202/simon-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "accepted_answer_id": 57072454, "answer_count": 1, "score": 0, "last_activity_date": 1563355078, "creation_date": 1563353995, "last_edit_date": 1563355043, "question_id": 57072168, "link": "https://stackoverflow.com/questions/57072168/excel-run-macro-button-with-password-protection", "title": "Excel Run Macro button with password protection", "body": "<p>My workbook is passwordprotected and consists of unlocked cells for input and ane button for PDF print. Due to the password protection of the sheets the PDF print button doesn't work.</p>\n\n<p>I have tried with the following earlier questions and answers. Yet it says that my entered password is wrong(!)</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12932254/macros-dont-work-when-sheet-is-protected-running-macro-returns-run-time-error\">Macros don&#39;t work when sheet is protected. Running macro returns run-time error 1004</a></p>\n\n<pre><code>Sub ButtonClick()\n\nUnprotectAll\n\n'Some stuff here\n\nProtectAll\n\nEnd Sub\n\nPrivate Const yourPassword As String = \"ThePassWord\"\n\nSub UnprotectAll()\n    Dim sh As Worksheet\n    For Each sh In ActiveWorkbook.Worksheets\n        sh.Unprotect Password:=yourPassword\n    Next sh\nEnd Sub\n\nSub ProtectAll()\n    Dim sh As Worksheet\n    For Each sh In ActiveWorkbook.Worksheets\n        sh.Protect Password:=yourPassword\n    Next sh\nEnd Sub\n</code></pre>\n\n<p>I get the</p>\n\n<blockquote>\n  <p>error \"1004\".<br>\n  The password you supplied is not correct.</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 2, "creation_date": 1563353313, "post_id": 57071932, "comment_id": 100667651, "body": "Welcome to SO. Whenever you use a variable to hold the row or column index you should declare it as long and not integer."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1563354236, "post_id": 57071932, "comment_id": 100668161, "body": "Integers get cast to a Long internally anyway - so there&#39;s not really any point in using them unless you specifically want to throw a run-time error when you exceed the upper boundary of an integer...."}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1563354326, "post_id": 57071998, "comment_id": 100668207, "body": "Do we have a canonical answer about using <code>Long</code> that we can link to? I feel like I have to explain it all the time..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1563354579, "post_id": 57071998, "comment_id": 100668372, "body": "@sam yes we have: <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long/26409520#26409520\">Why Use Integer Instead of Long?</a>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1563353833, "last_edit_date": 1563353833, "creation_date": 1563353392, "answer_id": 57071998, "question_id": 57071932, "link": "https://stackoverflow.com/questions/57071932/using-macro-in-a-for-loop/57071998#57071998", "title": "Using macro in a for loop", "body": "<p>You probably meant to use </p>\n\n<pre><code>Sub forLoop()\n    Dim rw As Long 'should be long!\n    For rw = 680 to 700\n        Cells(rw, 7).Value = getCoordinates(Cells(rw, 5).Value) \n    Next rw 'must be rw not i\nEnd Sub\n</code></pre>\n\n<p>Note that if you have the code of the <code>getCoordinates</code> function in a module, you should also be able to use it as a formula instead of VBA.</p>\n\n<p>Just write the following formula into column G:</p>\n\n<pre><code>=getCoordinates(E:E)\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11796478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c8af09558d1783bf55a4a5d17632012?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/11796478/ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "accepted_answer_id": 57071998, "answer_count": 1, "score": 1, "last_activity_date": 1563353833, "creation_date": 1563353152, "last_edit_date": 1563353268, "question_id": 57071932, "link": "https://stackoverflow.com/questions/57071932/using-macro-in-a-for-loop", "title": "Using macro in a for loop", "body": "<p>I'm searching for a way to use a function (get the coordinates from an address. Here is the code that I am using <a href=\"https://myengineeringworld.net/2014/06/geocoding-using-vba-google-api.html\" rel=\"nofollow noreferrer\">https://myengineeringworld.net/2014/06/geocoding-using-vba-google-api.html</a>) in a for-loop since I have more than 5000 rows.\nIs it possible to use the cells(row, col).Value = function. If yes, how can I?</p>\n\n<pre><code>Sub forLoop()\n    Dim rw as Integer\n    for rw = 680 to 700\n        Cells(rw,7). Value = getCoordinates(rw,5) 'in the column 5 I have the adress\n    next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer", "fitnesse"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563369156, "post_id": 57071883, "comment_id": 100676607, "body": "Can you share the url? Failing that - the html using the snippet tool via <a href=\"https://stackoverflow.com/posts/57071883/edit\">edit</a>."}, {"owner": {"reputation": 45, "user_id": 2536944, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5031c8a92f606409c30e5ac6e60797a?s=128&d=identicon&r=PG", "display_name": "Vidhyasaghar", "link": "https://stackoverflow.com/users/2536944/vidhyasaghar"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563372827, "post_id": 57071883, "comment_id": 100679095, "body": "The application is in my enterprise machine, sorry. But the application looks something like <a href=\"https://media.licdn.com/dms/image/C5112AQFY5SssHzI3aA/article-inline_image-shrink_1500_2232/0?e=1567641600&amp;v=beta&amp;t=Ofz1CvFmJM1UXFBFT_JT5ZhBBSnKvGGkvhaYroGkagE\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 45, "user_id": 2536944, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5031c8a92f606409c30e5ac6e60797a?s=128&d=identicon&r=PG", "display_name": "Vidhyasaghar", "link": "https://stackoverflow.com/users/2536944/vidhyasaghar"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564744409, "post_id": 57071883, "comment_id": 101140682, "body": "This is caused due to Win 10 i think. Am able to run the same code in Win 7 but not in Win 10"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564744509, "post_id": 57071883, "comment_id": 101140733, "body": "This line Set btn = IE.Document.getElementByName(&quot;save&quot;) should be Set btn = IE.Document.getElemenstByName(&quot;save&quot;)(0)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564744554, "post_id": 57071883, "comment_id": 101140752, "body": "We need to see the html in question however for the rest of the answer,"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 2536944, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5031c8a92f606409c30e5ac6e60797a?s=128&d=identicon&r=PG", "display_name": "Vidhyasaghar", "link": "https://stackoverflow.com/users/2536944/vidhyasaghar"}, "edited": false, "score": 0, "creation_date": 1563361017, "post_id": 57073881, "comment_id": 100671890, "body": "I have already verified the element names by checking the HTML elements, i wan not able to paste the actual code because the setup is in enterprise machine, hence the missing &#39;s&#39;. And i tried the createObject also and it throws &quot;Method document of object &#39;Iwebbrowser2&#39; failed&quot; error. Any idea how to resolve that?"}, {"owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "reply_to_user": {"reputation": 45, "user_id": 2536944, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5031c8a92f606409c30e5ac6e60797a?s=128&d=identicon&r=PG", "display_name": "Vidhyasaghar", "link": "https://stackoverflow.com/users/2536944/vidhyasaghar"}, "edited": false, "score": 0, "creation_date": 1563363509, "post_id": 57073881, "comment_id": 100673177, "body": "It seems that you are using internet explorer at a medium integrity level, try to use &quot;Set IE = CreateObject(&quot;InternetExplorer.ApplicationMedium&quot;)&quot;, here is a <a href=\"https://stackoverflow.com/questions/30086425/excel-vba-method-document-of-object-iwebbrowser2-failed/41471828#41471828\">thread</a>, you could refer to it."}, {"owner": {"reputation": 45, "user_id": 2536944, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5031c8a92f606409c30e5ac6e60797a?s=128&d=identicon&r=PG", "display_name": "Vidhyasaghar", "link": "https://stackoverflow.com/users/2536944/vidhyasaghar"}, "edited": false, "score": 0, "creation_date": 1563371401, "post_id": 57073881, "comment_id": 100678119, "body": "I am using InternetExplorerMedium, this is similar to the CreateObject(&quot;InternetExplorer.ApplicationMedium&quot;) right?."}, {"owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "reply_to_user": {"reputation": 45, "user_id": 2536944, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5031c8a92f606409c30e5ac6e60797a?s=128&d=identicon&r=PG", "display_name": "Vidhyasaghar", "link": "https://stackoverflow.com/users/2536944/vidhyasaghar"}, "edited": false, "score": 0, "creation_date": 1563436149, "post_id": 57073881, "comment_id": 100701151, "body": "Yes, you could have a try."}, {"owner": {"reputation": 45, "user_id": 2536944, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5031c8a92f606409c30e5ac6e60797a?s=128&d=identicon&r=PG", "display_name": "Vidhyasaghar", "link": "https://stackoverflow.com/users/2536944/vidhyasaghar"}, "edited": false, "score": 0, "creation_date": 1563440138, "post_id": 57073881, "comment_id": 100703287, "body": "That&#39;s what i already did but it did not write data into the Textarea. Is it because since the Textarea is inside a set of forms like(Body-&gt;Article-&gt;Form-&gt;Fieldset-&gt;TextArea)? I tried to create a dummy webpage with only one textarea and applied the same code and it executed fine"}, {"owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "reply_to_user": {"reputation": 45, "user_id": 2536944, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5031c8a92f606409c30e5ac6e60797a?s=128&d=identicon&r=PG", "display_name": "Vidhyasaghar", "link": "https://stackoverflow.com/users/2536944/vidhyasaghar"}, "edited": false, "score": 0, "creation_date": 1563441343, "post_id": 57073881, "comment_id": 100703968, "body": "I have tested it (try to put the Textarea inside the forms), it still works well on my side, perhaps there have another part of code prevent this behavior.  can you post the Enough code to reproduce the problem as in <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>, so that we could test it."}], "tags": [], "owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "is_accepted": false, "score": 0, "last_activity_date": 1563359727, "creation_date": 1563359727, "answer_id": 57073881, "question_id": 57071883, "link": "https://stackoverflow.com/questions/57071883/not-able-to-write-content-in-textarea-in-fitnesse-from-vba/57073881#57073881", "title": "Not able to write content in textarea in Fitnesse from vba", "body": "<p>Please try to use F12 developer tools to check the html element, make sure it contains the pagename and pageContent elements. Besides, please check your code, you lost a 's' in the getElementsByName method.</p>\n\n<p>If still not working, I suggest you could try to use the following code(create the IE object using CreateObject method, the following code works well on my side.):</p>\n\n<pre><code>Sub test()\n\nDim IE As Object\n\nSet IE = CreateObject(\"InternetExplorer.application\")\n\nsURL = \"website url\"\n\nWith IE\n    .Navigate sURL\n    .Visible = True\nEnd With\n\n\nIE.Document.getElementById(\"pagename\").Value = \"Dummay_Page\" '--&gt; This is Page name text Box\n\nStrVal = &lt;cocntent from sheet1&gt;\n\nIE.Document.getElementById(\"pageContent\").innerText = StrVal '--&gt; This is Page Textarea\n\nSet btn = IE.Document.getElementsByName(\"save\")(0) '-- This is a Page button\n\nbtn.Click\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 2536944, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5031c8a92f606409c30e5ac6e60797a?s=128&d=identicon&r=PG", "display_name": "Vidhyasaghar", "link": "https://stackoverflow.com/users/2536944/vidhyasaghar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563369190, "creation_date": 1563352945, "last_edit_date": 1563369190, "question_id": 57071883, "link": "https://stackoverflow.com/questions/57071883/not-able-to-write-content-in-textarea-in-fitnesse-from-vba", "title": "Not able to write content in textarea in Fitnesse from vba", "body": "<p>I am developing a VBA where it will open the Fitnesse link to create a new Test page and write Page name, Page content and click save.</p>\n\n<ol>\n<li>Am using <code>InternetExplorerMedium</code> from VBA library to access Fitnesse link to create new Test page(Success).</li>\n<li>Then i will read content in an excel sheet into a variable(Success).</li>\n<li>Then i will paste the content into the text area of the new Test page created(Not Happening).</li>\n<li>Then i will click Save(Success)</li>\n</ol>\n\n<p></p>\n\n<pre><code>Set IE = New InternetExplorerMedium\nsURL = \"FitnesseURL\"\nWith IE\n    .Navigate sURL\n    .Visible = True\nEnd With\nIE.Document.getElementById(\"pagename\").Value = \"Dummay_Page\" '--&gt; This is Page name text Box\nStrVal = &lt;Content from Sheet1&gt;\nIE.Document.getElementById(\"pageContent\").innerText = StrVal '--&gt; This is Page Textarea\nSet btn = IE.Document.getElementByName(\"save\") ' -- This is a Page button\nbtn(0).Click\n</code></pre>\n\n<p>I want the content from the Sheet1 to be pasted in the Fitnesse Test page textarea but it is not happening i have tried <code>.innerText</code>,<code>.innerHTML</code> and <code>.Value</code> options</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 1, "creation_date": 1563353715, "post_id": 57071868, "comment_id": 100667877, "body": "You should use worksheet variables where you can store the two worksheet objects you want to work with. This will allow you to use explicit references to range objects belonging to the worksheets which in turn will help you keep better track of what you are doing."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1563353729, "post_id": 57071868, "comment_id": 100667881, "body": "For <b>every</b> <code>Range</code> and <code>Cells</code> please specify in which sheet it is. Eg. <code>Worksheets(&quot;MySheetName&quot;).Range</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1563353825, "post_id": 57071868, "comment_id": 100667933, "body": "^^ and <code>Set currParam = Cells(defVal.Row, defVal.Column - 1)</code> as <code>defval</code> is a range itself. Btw this is equivalent to <code>defval.offset(,-1)</code>. And it will never be <code>Nothing</code> as you&#39;ve just defined it."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1563354476, "post_id": 57071868, "comment_id": 100668305, "body": "Why don&#39;t you just use VLOOKUP?"}, {"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 0, "creation_date": 1563356363, "post_id": 57071868, "comment_id": 100669454, "body": "would be great to use it but I am facing problem in accessing to cell values dinamycally"}, {"owner": {"reputation": 625, "user_id": 2880342, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917a1ca96bd067832d2b7e4d8967d336?s=128&d=identicon&r=PG&f=1", "display_name": "GoodJuJu", "link": "https://stackoverflow.com/users/2880342/goodjuju"}, "edited": false, "score": 0, "creation_date": 1563357158, "post_id": 57071868, "comment_id": 100669872, "body": "Using the INDEX, MATCH formula will do this for you without code: INDEX, MATCH is broken down into 3 main Parts: The values you want to return, the value you want to match and the value list you want to lookup. Place the below formula into Sheet1 Cell B5 and Replace your sheet names accordingly (if required): =INDEX(Sheet2!$D$2:$D$5, MATCH(Sheet1!$A5, Sheet2!$A$2:$A$5,0))"}, {"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 0, "creation_date": 1563357480, "post_id": 57071868, "comment_id": 100670053, "body": "but in this case I don&#39;t have the flexibility of setting a dinamic range in which search and in which put values."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1563366232, "post_id": 57071868, "comment_id": 100674654, "body": "@SJR Or, if this <i>has</i> to be VBA, <code>WorksheetFunction.VLookup</code> or <code>WorksheetFunction.Match</code> and <code>Worksheet.Cell</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1563366719, "post_id": 57071868, "comment_id": 100674980, "body": "@Chronocidal- aye, I followed OP&#39;s approach but could be worth another answer."}], "answers": [{"comments": [{"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 0, "creation_date": 1563366543, "post_id": 57075645, "comment_id": 100674873, "body": "ok, it gave me the correct result. Unfortunately it also raised an error: method Find of object Range failed.  on  Set rgFound = Worksheets(&quot;Sheet2&quot;).Range(&quot;A2&quot;, Worksheets(&quot;Sheet2&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp)).Find(currParam.value)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 0, "creation_date": 1563366696, "post_id": 57075645, "comment_id": 100674967, "body": "I&#39;ve amended the code above as problem may be a blank cell, but that line is not in my code."}, {"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 0, "creation_date": 1563367493, "post_id": 57075645, "comment_id": 100675454, "body": "The name of the string I have inserted. I think the function is triggered a second time because of the modification caused by defVal.value = currParamDict.value (the code is in a Worksheet_Change sub)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 1, "creation_date": 1563367578, "post_id": 57075645, "comment_id": 100675510, "body": "You didn&#39;t mention that. You need to disable events. I meant what is its specific value when it errors?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 0, "creation_date": 1563367614, "post_id": 57075645, "comment_id": 100675532, "body": "Why do you not have any reference to <code>Target</code>?"}, {"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 1, "creation_date": 1563367965, "post_id": 57075645, "comment_id": 100675756, "body": "ok I have added an intersect for the column. Thanks a lot for the help"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1563366676, "last_edit_date": 1563366676, "creation_date": 1563365809, "answer_id": 57075645, "question_id": 57071868, "link": "https://stackoverflow.com/questions/57071868/find-cell-value-in-another-sheet/57075645#57075645", "title": "Find cell value in another sheet", "body": "<p>Try this</p>\n\n<pre><code>Sub x()\n\nDim rgFound As Range\nDim defVal As Range\nDim currParam As Range\nDim currParamDict As Range\n\nWith Worksheets(\"Sheet1\")\n    For Each defVal In .Range(\"A2\", .Range(\"A\" &amp; Rows.Count).End(xlUp)).Offset(, 1)\n        Set currParam = defVal.Offset(, -1)\n        If Len(currParam.Value) &gt; 0 Then\n            Set rgFound = Worksheets(\"Sheet2\").Range(\"A:A\").Find(currParam.Value)\n            If rgFound Is Nothing Then\n                Debug.Print \"Name was not found.\"\n            Else\n                Set currParamDict = rgFound.Offset(, 3)\n                defVal.Value = currParamDict.Value\n            End If\n        End If\n    Next defVal\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 57075645, "answer_count": 1, "score": 0, "last_activity_date": 1563366676, "creation_date": 1563352901, "last_edit_date": 1563353661, "question_id": 57071868, "link": "https://stackoverflow.com/questions/57071868/find-cell-value-in-another-sheet", "title": "Find cell value in another sheet", "body": "<p>I have to excel sheet and, using vba, I would like to get a value in one of those, search it in the other one and return a correspondant value in the first sheet.</p>\n\n<p>Given the sheet 1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0PbWg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0PbWg.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like to search the string I inserted in A5 in another sheet:</p>\n\n<p>Sheet 2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YACsy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YACsy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Once I found the match (A2 in this case), I would get the 'value' (in D2 in this case) and report it in the cell B5 of the Sheet1.</p>\n\n<p>That's what I tried:</p>\n\n<pre><code>Dim rgFound As Range\nDim defVal As Range\nDim currParam As Range\nDim currParamDict As Range\n\nFor Each defVal In Range(\"B:B\")\n\n    Set currParam = Cells(Range(defVal).Row, Range(defVal).Column - 1)\n    If currParam Is Nothing Then\n        Debug.Print \"Name was not found.\"        \n    End If\n\n    Set rgFound = Worksheets(\"Sheet2\").Range(\"A:A\").Find(currParam.value)\n    If rgFound Is Nothing Then\n        Debug.Print \"Name was not found.\"\n    Else\n        Set currParamDict = Cells(Range(rgFound).Row, Range(rgFound).Column + 3)\n        defVal.value = currParamDict.value\n    End If\nNext defVal\n</code></pre>\n\n<p>That's clearly wrong since the compiler gives me an error on Range at the line:</p>\n\n<pre><code>Set currParam = Cells(Range(defVal).Row, Range(defVal).Column - 1)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 11796267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b92b313fbbe9b2529b74f0f09b96cfc3?s=128&d=identicon&r=PG&f=1", "display_name": "doireallyhaveto", "link": "https://stackoverflow.com/users/11796267/doireallyhaveto"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1563406865, "post_id": 57071863, "comment_id": 100693572, "body": "Thank you for the feedback - I&#39;ve updated my question as requested. I now have functional code but cannot work out how to generalise it?"}], "owner": {"reputation": 11, "user_id": 11796267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b92b313fbbe9b2529b74f0f09b96cfc3?s=128&d=identicon&r=PG&f=1", "display_name": "doireallyhaveto", "link": "https://stackoverflow.com/users/11796267/doireallyhaveto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1563472907, "creation_date": 1563352887, "last_edit_date": 1563472907, "question_id": 57071863, "link": "https://stackoverflow.com/questions/57071863/generate-part-codes-based-on-multiple-variable-constraints", "title": "Generate part codes based on multiple variable constraints", "body": "<p>I need to generate thousands of unique descriptive stock codes based on a number of varying constraints in a consistent way. So for example product group a is defined by a material, gauge, girth, folds, and taper. There are a variable number of each on of these categories - as in there are 2 unique materials, 10 unique gauges, 20 unique girths, 10 unique folds, and they are tapered or not. So for example a product code should look like: MAT11.001100G7FTY, which is material 1, 1.00 gauge, 1100 girth, 7 fold, tapered. </p>\n\n<p>Another example of a product group b is constrained by the material, gauge, product type (there are multiple product types in group b), length, width and height. So an example code would be MAT11.25SUMP800Lx900Wx700H, which is material 1, 1.25 gauge, sump, 800 long, 900 wide, 700 high. </p>\n\n<p>All combinations utilising all constraints need to be generated. So ABCDE is a part code, but ACE is not. </p>\n\n<p>The constraint data is simple enough that I can manipulate it into whatever form is required. Currently I have each product group separate and then one constraint type per column and all of the possible options for that constraint as the rows. As per the below</p>\n\n<p>I have a basic understanding of VBA but am struggling with the best solution for this problem. Should I be generating arrays of each constraint and then concatenating every value in each array with each other value? Or a multi dimension array? Or should I be iterating down all of the rows and all columns and writing the values directly to the column that will store the final values directly, without storing them in a variable at some point along the way</p>\n\n<p>The final outcome I need is a single column with one part code per row. </p>\n\n<p>EDIT: Here is the constraint data and my current code - this is currently functional, but the number of arrays and size of the arrays are hard-coded. Is there a way I can generalise this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/JZMY6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JZMY6.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim m(0 To 1) As String 'material array\n    Dim g(0 To 18) As String 'girth array\n    Dim f(0 To 9) As String 'fold array\n    Dim t(0 To 1) As String 'taper array\n\n    Dim mItem As Variant 'material array element\n    Dim gItem As Variant 'girth array element\n    Dim fItem As Variant 'fold array element\n    Dim tItem As Variant 'taper array element\n\n    Dim i As Integer 'for iterating\n\n    For i = 0 To 1\n        m(i) = Cells(i + 1, 1).Value 'store materials in material array\n    Next i\n\n    For i = 0 To 18\n        g(i) = Cells(i + 1, 2).Value 'store girth in material array\n    Next i\n\n    For i = 0 To 9\n        f(i) = Cells(i + 1, 3).Value 'store folds in material array\n    Next i\n\n    For i = 0 To 1\n        t(i) = Cells(i + 1, 4).Value 'store taper in material array\n    Next i\n\n    'reset iteration to row 1\n    i = 1\n\n    'loop through each arary and concatate values\n    For Each mItem In m()\n        For Each gItem In g()\n                For Each fItem In f()\n                    For Each tItem In t()\n\n                        ActiveSheet.Cells(i, 10).Value = ActiveSheet.Cells(i, 10).Value &amp; mItem 'write material value to result col\n                        ActiveSheet.Cells(i, 10).Value = ActiveSheet.Cells(i, 10).Value &amp; gItem 'write girth value to result col\n                        ActiveSheet.Cells(i, 10).Value = ActiveSheet.Cells(i, 10).Value &amp; fItem 'write fold value to result col\n                        ActiveSheet.Cells(i, 10).Value = ActiveSheet.Cells(i, 10).Value &amp; tItem 'write taper value to result col\n\n                        i = i + 1 'next row\n                Next\n            Next\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": false, "score": 2, "last_activity_date": 1563367908, "creation_date": 1563367908, "answer_id": 57076305, "question_id": 57071706, "link": "https://stackoverflow.com/questions/57071706/table-field-defined-as-char-has-values-with-trailing-spaces/57076305#57076305", "title": "Table field defined as CHAR has values with trailing spaces", "body": "<p>In Access DDL, a <code>CHAR</code> column is fixed-length, 255 characters. Values inserted into that column will be padded with spaces to the full 255 characters.</p>\n\n<p>If you want a variable-length column use <code>TEXT</code> instead. The default maximum length is still 255 characters (you can specify a smaller maximum length, e.g., <code>TEXT(100)</code>) but the values will not be padded.</p>\n"}], "owner": {"reputation": 15, "user_id": 11537378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KhrlAZSDjIM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceOu_croND7Xr0GbH38d1venBqWg/mo/photo.jpg?sz=128", "display_name": "Oki Toma", "link": "https://stackoverflow.com/users/11537378/oki-toma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1563411461, "creation_date": 1563352256, "last_edit_date": 1563411461, "question_id": 57071706, "link": "https://stackoverflow.com/questions/57071706/table-field-defined-as-char-has-values-with-trailing-spaces", "title": "Table field defined as CHAR has values with trailing spaces", "body": "<p>I am developing a vba tool to analyse the logs. \nI create a table with CREATE command </p>\n\n<pre><code>     CREATE TABLE \" &amp; txtImportedLogTbleName &amp; \" (\u65e5\u4ed8 DATETIME, WindowsID CHAR, \u540d\u524d CHAR) \n</code></pre>\n\n<p>then read the values from a file. \nAfter importing the data, each field has many spaces (255-the length of the data) after the value. \nTried Trim to export values to an array and deleted the rs. but no luck so far.</p>\n\n<p>below is the code I Tried.</p>\n\n<pre><code>Public Function TrimAllFields(ByVal strSQL As String)\n   Dim intX, intArrDimX, intY, intArrDimY, intMyRecCounts As Integer\n   Dim arrTemp(), txtRsData As String\n   Dim db As DAO.Database\n   Dim rs As DAO.Recordset\n\nSet db = CurrentDb\nCurrentDb.TableDefs.Refresh\nSet rs = db.OpenRecordset(strSQL)\nOn Error Resume Next\nIf Not rs.EOF Then rs.MoveLast\nintMyRecCounts = rs.RecordCount\n  If (Err.Number &lt;&gt; 0) Then Call ErrorCatcher(Err.Number, Err.Description, Erl): Err.Clear\n  On Error GoTo 0\n   If intMyRecCounts &gt; 0 Then\n      intArrDimX = rs.RecordCount\n      intArrDimY = rs.Fields.Count\n      rs.MoveFirst\n\n      ReDim arrTemp(intArrDimX, intArrDimY)\n         intX = 0\n         While Not rs.EOF And Not rs.BOF\n            For intY = 0 To intArrDimY - 1\n               If Not rs.Fields(intY).Value = \"\" Then\n                  arrTemp(intX, intY) = Trim(rs.Fields(intY).Value)\n                  rs.Edit\n                  rs.Fields(intY) = arrTemp(intX, intY)\n                  rs.Update\n               End If\n            Next intY\n'            rs.Delete\n            rs.MoveNext\n             intX = intX + 1\n         Wend\nrs.Close\nSet rs = Nothing\nDoCmd.SetWarnings True\nEnd Function\n</code></pre>\n"}, {"tags": ["html", "vba", "web"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563370503, "post_id": 57071670, "comment_id": 100677521, "body": "Is this a public url that can be shared?"}, {"owner": {"reputation": 11, "user_id": 11750918, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A0sa940ikYg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPmuyXDv1qySMukTWTxNeAnm5Cbw/photo.jpg?sz=128", "display_name": "tien le", "link": "https://stackoverflow.com/users/11750918/tien-le"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563373799, "post_id": 57071670, "comment_id": 100679792, "body": "@QHarr: sorry, this is a private url but if you need any other html codes, let me know if i can find them. Thanks. (P/S:It looks like I&#39;m not able to adjust what&#39;s inside the checkbox field.)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563449282, "post_id": 57071670, "comment_id": 100708268, "body": "what do you mean by update the page? Unless you control the page all changes will be lost on page refresh. Normally automating a tickbox is part of a selection process prior to getting a new (different) page or downloading something."}, {"owner": {"reputation": 11, "user_id": 11750918, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A0sa940ikYg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPmuyXDv1qySMukTWTxNeAnm5Cbw/photo.jpg?sz=128", "display_name": "tien le", "link": "https://stackoverflow.com/users/11750918/tien-le"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563463828, "post_id": 57071670, "comment_id": 100717298, "body": "@QHarr: the page has an update button to save all changes made in text boxes. When i click that update button or click on another other text boxes, all changes made in text boxes will be gone. A manual process would be clicking on a box before entering a value or clicking on the check box to mark it. Looks like I need to somehow control the mouse to click on the text box first then apply the code because once i left click a text box, a new html class will pop up."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11750918, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A0sa940ikYg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPmuyXDv1qySMukTWTxNeAnm5Cbw/photo.jpg?sz=128", "display_name": "tien le", "link": "https://stackoverflow.com/users/11750918/tien-le"}, "is_accepted": false, "score": 0, "last_activity_date": 1563543468, "creation_date": 1563543468, "answer_id": 57113707, "question_id": 57071670, "link": "https://stackoverflow.com/questions/57071670/updated-attribute-of-a-class-name-keeps-changing-to-its-original-value/57113707#57113707", "title": "Updated attribute of a class name keeps changing to its original value", "body": "<p>After long hours of research, I was able to do what i needed to by using Selenium and Sendkey method. </p>\n"}], "owner": {"reputation": 11, "user_id": 11750918, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A0sa940ikYg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPmuyXDv1qySMukTWTxNeAnm5Cbw/photo.jpg?sz=128", "display_name": "tien le", "link": "https://stackoverflow.com/users/11750918/tien-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563543468, "creation_date": 1563352132, "last_edit_date": 1563353214, "question_id": 57071670, "link": "https://stackoverflow.com/questions/57071670/updated-attribute-of-a-class-name-keeps-changing-to-its-original-value", "title": "Updated attribute of a class name keeps changing to its original value", "body": "<p>A portion of my code below was able to change the attribute of a checkbox class name in a website. The code ran just fine resulting a check-mark displayed as expected but after I updated the page, that check-mark was just gone and the checkbox returned unchecked. My goal here is to tick that check box and be able to save that change. </p>\n\n<p>'Code to update checkbox class name:</p>\n\n<pre><code>Set elements = ie.document.getelementsbytagname(\"i\")(2)\nif elements.classname = \"fa fa-square-o no\" then\n   elements.classname = \"fa fa-check-square yes\"\nend if\n</code></pre>\n\n<p>Below is the inspected html elements:</p>\n\n<p>*Before changing class name</p>\n\n<pre><code>&lt;div tabindex=\"-1\" role=\"gridcell\" aria-selected=\"false\" aria-readonly=\"true\" aria-required=\"true\" class=\"wj-cell dt-boolean wj-align-center\" style=\"left: 538px; top: 116px; width: 39px; height: 29px;\"&gt;&lt;i class=\"fa fa-square-o no\"&gt;&lt;/i&gt;&lt;/div&gt;\n&lt;i class=\"fa fa-square-o no\"&gt;&lt;/i&gt;\n</code></pre>\n\n<p>*After changing class name</p>\n\n<pre><code>&lt;div tabindex=\"-1\" role=\"gridcell\" aria-selected=\"false\" aria-readonly=\"true\" aria-required=\"true\" class=\"wj-cell dt-boolean wj-align-center\" style=\"left: 538px; top: 116px; width: 39px; height: 29px;\"&gt;&lt;i class=\"fa fa-square-o no\"&gt;&lt;/i&gt;&lt;/div&gt;\n&lt;i class=\"fa fa-check-square yes\"&gt;&lt;/i&gt;\n</code></pre>\n\n<p>*After manually un-checked the box and right clicked on the box to inspect elements, this new html code popped up</p>\n\n<pre><code>&lt;div class=\"axm-grid-active-editor\" style=\"display: block; top: 225px; left: 568px; width: 38px; height: 29px;\"&gt; &lt;div class=\"df__control no-border is_modified \" aria-label=\"\"&gt;&lt;div class=\"df__control--boolean\"&gt;&lt;span class=\"modified-flag\"&gt;&lt;/span&gt;  &lt;label class=\"switch switch-green\"&gt;&lt;input type=\"checkbox\" class=\"switch-input\"&gt; &lt;span class=\"switch-label\" data-on=\"Yes\" data-off=\"No\"&gt;&lt;/span&gt; &lt;span class=\"switch-handle\"&gt;&lt;/span&gt;&lt;/label&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n</code></pre>\n\n<p>*HTML code after manually clicked on the checkbox</p>\n\n<pre><code>&lt;div tabindex=\"-1\" role=\"gridcell\" aria-selected=\"false\" aria-readonly=\"true\" aria-required=\"true\" class=\"wj-cell dt-boolean wj-align-center axm-current-cell\" style=\"left: 538px; top: 174px; width: 39px; height: 29px;\"&gt;&lt;i class=\"fa fa-check-square yes\"&gt;&lt;/i&gt;&lt;span class=\"k-dirty \"&gt;&lt;/span&gt;&lt;/div&gt;\n</code></pre>\n\n<p>I'm still learning to use VBA to control website. Hopefully these information provides y'all enough information to give me some guidelines. If not, please let me know, I'll see if I can give out anything else.</p>\n\n<p>Thanks y'all.</p>\n"}, {"tags": ["arrays", "excel", "vba", "multidimensional-array"], "answers": [{"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1563351975, "post_id": 57071604, "comment_id": 100666955, "body": "Ah shoot, I knew this too. Thanks for refreshing my memory"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1563352924, "last_edit_date": 1563352924, "creation_date": 1563351889, "answer_id": 57071604, "question_id": 57071556, "link": "https://stackoverflow.com/questions/57071556/redim-preserve-array-to-start-at-index-3/57071604#57071604", "title": "ReDim Preserve array to start at index 3", "body": "<p>In a multi dimensional array you can only redesign <code>ReDim</code> the last array dimension.</p>\n\n<p>For example in a multi dimensional array you can do </p>\n\n<pre><code>Dim myArr(1 To 10, 1 To 20)\nReDim Preserve myArr(1 To 10, 1 To 25)\n</code></pre>\n\n<p>but you cannot do </p>\n\n<pre><code>Dim myArr(1 To 10, 1 To 20)\nReDim Preserve myArr(1 To 15, 1 To 20)\n</code></pre>\n\n<p>nor can you do </p>\n\n<pre><code>Dim myArr(1 To 10, 1 To 20)\nReDim Preserve myArr(1 To 10, 5 To 20)\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Dim myArr(1 To 10, 1 To 20)\nReDim Preserve myArr(5 To 10, 1 To 20)\n</code></pre>\n\n<p>The documentation of the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/redim-statement\" rel=\"nofollow noreferrer\">ReDim statement</a> says:</p>\n\n<blockquote>\n  <p><em>\"If you use the <code>Preserve</code> keyword, you can resize only the last array dimension and you can't change the number of dimensions at all.<br>\n  \u2026<br>\n  Similarly, when you use <code>Preserve</code>, you can change the size of the array only by changing the upper bound; changing the lower bound causes an error.\"</em></p>\n</blockquote>\n\n<p>The only solution to get around this would be to define a new array with the new dimensions and shift the data into this new array using a loop. But then the idea of loading a range of values into an array at once like</p>\n\n<pre><code>myArr = sht.Range(\"A3:M\" &amp; LRow).Value\n</code></pre>\n\n<p>is completly useless. Actually in this case loading the not needed data of the first 2 rows into the array too should be faster than shifting the array with a loop.</p>\n\n<p>Use </p>\n\n<pre><code>myArr = sht.Range(\"A1:M\" &amp; LRow).Value\n</code></pre>\n\n<p>and you can use <code>myArr(5, 2)</code> to refer to <code>B5</code>. Loading the additional 2 lines into the array too should not make a big difference.</p>\n"}], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 57071604, "answer_count": 1, "score": 0, "last_activity_date": 1563352924, "creation_date": 1563351728, "question_id": 57071556, "link": "https://stackoverflow.com/questions/57071556/redim-preserve-array-to-start-at-index-3", "title": "ReDim Preserve array to start at index 3", "body": "<p>I populate an array with a range, and would like to have the same field and record numbers in the array as on  the actual range.<br>\nIn other words: if the array is derived from <code>A5:D10</code>, <code>myArr(5,2)</code> should refer to <code>B5</code>. </p>\n\n<pre><code>Dim myArr As Variant\nmyArr = sht.Range(\"A3:M\" &amp; LRow)\n\n'Redesign array references\n    'This works\n    ReDim Preserve myArr(1 To LRow -2, 0 To 12)\n\n    'This does not work\n    ReDim Preserve myArr(3 To LRow, 1 To 13)\n</code></pre>\n\n<blockquote>\n  <p>Subscript out of range</p>\n</blockquote>\n\n<p>The error message above suggest I may try to go out of bounds with the indexes, but they're the same size as the working indexes. What am I doing wrong here?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563350739, "post_id": 57070999, "comment_id": 100666312, "body": "You would either need to scroll down and make another (or more) screenshot(s) until the end of the web page and in the end overlap all the images at the correct position to fiddle them together to one big screenshot image. \u2022 Or find a third party tool that can exactly do what you want and that you can automate by VBA or command line. \u2022 First is to broad to be answered here, and second is off-topic."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563369707, "post_id": 57070999, "comment_id": 100677016, "body": "You could use selenium and take advantage of chrome and firefox settings: <a href=\"https://www.deconetwork.com/blog/how-to-take-full-webpage-screenshots-instantly/\" rel=\"nofollow noreferrer\">deconetwork.com/blog/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563369833, "post_id": 57070999, "comment_id": 100677103, "body": "You could also try vba command line if FF installed: <a href=\"https://stackoverflow.com/questions/13158083/take-a-full-page-screenshot-with-firefox-on-the-command-line\" title=\"take a full page screenshot with firefox on the command line\">stackoverflow.com/questions/13158083/&hellip;</a>  or switch languages and try something like: <a href=\"https://stackoverflow.com/questions/41721734/take-screenshot-of-full-page-with-selenium-python-with-chromedriver\" title=\"take screenshot of full page with selenium python with chromedriver\">stackoverflow.com/questions/41721734/&hellip;</a>     btw putting @User doesn&#39;t notify the user unless they are already part of the thread."}], "owner": {"reputation": 83, "user_id": 8976485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5effcf155646caff2e982e8522122c6?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish", "link": "https://stackoverflow.com/users/8976485/ashish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563350954, "creation_date": 1563349875, "last_edit_date": 1563350954, "question_id": 57070999, "link": "https://stackoverflow.com/questions/57070999/screenshot-of-full-webpage-using-vba", "title": "Screenshot of Full Webpage using VBA", "body": "<p>I am going to take screenshot of Fallowing Webpage</p>\n\n<p><a href=\"https://www.nseindia.com/live_market/dynaContent/live_watch/option_chain/optionKeys.jsp?symbolCode=-9999&amp;symbol=BANKNIFTY&amp;symbol=BANKNIFTY&amp;instrument=-&amp;date=-&amp;segmentLink=17&amp;symbolCount=2&amp;segmentLink=17\" rel=\"nofollow noreferrer\">https://www.nseindia.com/live_market/dynaContent/live_watch/option_chain/optionKeys.jsp?symbolCode=-9999&amp;symbol=BANKNIFTY&amp;symbol=BANKNIFTY&amp;instrument=-&amp;date=-&amp;segmentLink=17&amp;symbolCount=2&amp;segmentLink=17</a></p>\n\n<p>But screenshot showing only visible window</p>\n\n<p>is there any way to take a full webpage screenshot</p>\n\n<p>My Codes:</p>\n\n<pre><code>Private Declare Sub keybd_event Lib \"user32\" (ByVal bVk As Byte, ByVal bScan As Byte, ByVal dwFlags As Long, ByVal dwExtraInfo As Long)\n\nPrivate Declare Sub Sleep Lib \"kernel32.dll\" (ByVal dwMilliseconds As Long)\n\nPrivate Const VK_SNAPSHOT As Byte = 44\n\nPrivate Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nPrivate Declare Function ShowWindow Lib \"user32\" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long\n\nPrivate Const SW_SHOWMAXIMIZED = 3\nPrivate Const VK_LCONTROL As Long = &amp;HA2\nPrivate Const VK_V = &amp;H56\nPrivate Const KEYEVENTF_KEYUP = &amp;H2\n\nSub Test() \n    MP = ActiveWorkbook.Name\n    Dim IE As New SHDocVw.InternetExplorer\n\n    IE.Visible = True\n    IE.navigate \"https://www.nseindia.com/live_market/dynaContent/live_watch/option_chain/optionKeys.jsp?symbolCode=-9999&amp;symbol=BANKNIFTY&amp;symbol=BANKNIFTY&amp;instrument=-&amp;date=-&amp;segmentLink=17&amp;symbolCount=2&amp;segmentLink=17\"\n    ShowWindow IE.hwnd, SW_SHOWMAXIMIZED\n\n    Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE\n    Loop\n\n    Call keybd_event(VK_SNAPSHOT, 0, 0, 0)\n\n    Windows(MP).Activate\n    Range(\"A1\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>I need full Screenshot like attached Picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OyyJB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OyyJB.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 8224364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c59799baf85ce7195407911f29fbfbfe?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Steiner", "link": "https://stackoverflow.com/users/8224364/erik-steiner"}, "edited": false, "score": 0, "creation_date": 1563352816, "post_id": 57071250, "comment_id": 100667383, "body": "<code>I would leave the .. header of the default template simply empty, and check it upon save.</code> This won&#39;t work as I need to save the template when I created it and so the script fires to fill the template. I noticed a bug in your script: I open the template that has one default sheet. I change Company Ltd. to Else Ltd.. I save and close it. I open the saved file and add a sheet. Save it. You will notice that the company changed to its default value."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "reply_to_user": {"reputation": 381, "user_id": 8224364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c59799baf85ce7195407911f29fbfbfe?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Steiner", "link": "https://stackoverflow.com/users/8224364/erik-steiner"}, "edited": false, "score": 0, "creation_date": 1563361342, "post_id": 57071250, "comment_id": 100672062, "body": "Adding sheet fires the Workbook_NewSheet event,. You could use it to prefill header and footer."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1563362589, "last_edit_date": 1563362589, "creation_date": 1563350709, "answer_id": 57071250, "question_id": 57070820, "link": "https://stackoverflow.com/questions/57070820/create-header-and-footer-on-save-event-check-if-header-or-footer-exists/57071250#57071250", "title": "Create header and footer on save event. Check if header or footer exists", "body": "<p>I would leave the left, center and right header of the default template simply empty, and check it upon save. Then I would save the values and copy them to all other sheets. If you have many sheets, it is worth turning print communication off temporarily.  </p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim ShActive as Worksheet, sh As Worksheet\n    Dim sLH as String, sCH as String, sRH As String\n\n    Application.Printcommunication = False\n    Set shActive = ActiveSheet\n    With Activesheet.PageSetup\n         sLH = .LeftHeader\n         sCH = .CenterHeader\n         ...\n         If lenb(sLH) = 0 And lenb(sCH) = 0 And lenb(sRH) = 0 Then ' all empty = set defaults\n              sLH = \"Company: Company Ltd.\" &amp; Chr(10) &amp; \"Cutoff date: 31.12.20XX\"\n              ....\n         End If\n    End With\n\n    For Each sh in ActiveWorkBook.Sheets\n        With sh.PageSetup\n            .LeftHeader = sLH\n            ...\n        End With\n    Next\n    shActive.Activate ' just for sure\n    Application.Printcommunication = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 381, "user_id": 8224364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c59799baf85ce7195407911f29fbfbfe?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Steiner", "link": "https://stackoverflow.com/users/8224364/erik-steiner"}, "is_accepted": true, "score": 0, "last_activity_date": 1563537961, "creation_date": 1563537961, "answer_id": 57112177, "question_id": 57070820, "link": "https://stackoverflow.com/questions/57070820/create-header-and-footer-on-save-event-check-if-header-or-footer-exists/57112177#57112177", "title": "Create header and footer on save event. Check if header or footer exists", "body": "<p>Thank you for your input and support. I managed to create a template-file with a sheet called \"Template\", that already has nearly all required information that are used for all sheets that are created by the user. I now need to re-add the Workbook_BeforeSave event, because my current script can not handle the event where the user copies a sheet from another workbook to this sheet. So the copied sheet is missing header and footer.</p>\n\n<p>The current script that adds header and footer to all newly created sheets:\n<br>It copies the information of the sheet \"Template\" to newly created sheets. So the \"Template\" sheet is a requirement.</p>\n\n<pre><code>Private Sub Workbook_NewSheet(ByVal Sh As Object)\n    Application.ScreenUpdating = False\n    With Sheets(\"Template\").PageSetup\n        strHeadLeft = .LeftHeader\n        strHeadCenter = .CenterHeader\n        strHeadRight = .RightHeader\n        'strFootLeft = .LeftFooter\n        'strFootCenter = .CenterFooter\n        'strFootRight = .RightFooter\n        bGotHeaders = True\n    End With\n    If bGotHeaders Then\n        With ActiveSheet.PageSetup\n            .LeftHeader = strHeadLeft\n            .CenterHeader = strHeadCenter\n\n            If IsEmpty(strHeadRight) Then\n                strHeadRight = _\n                 \"&amp;10Ref: &amp;B&amp;10&amp;KFF0000 XXX-XXX\" &amp; _\n                  Chr(10) &amp; _\n                  \"&amp;B&amp;K000000File date created: \" &amp; _\n                  Format(Date, \"dd.mm.yyyy\") &amp; \" \" &amp; Time &amp; Chr(10) &amp; _\n                  \"User: &amp;B\" &amp; Application.UserName\n            Else\n                strHeadRight = strHeadRight &amp; _\n                 Chr(10) &amp; _\n                 \"&amp;B&amp;K000000File date created: \" &amp; _\n                 Format(Date, \"dd.mm.yyyy\") &amp; \" \" &amp; Time &amp; Chr(10) &amp; _\n                 \"User: &amp;B\" &amp; Application.UserName\n            End If\n\n            .RightHeader = strHeadRight\n            .LeftFooter = \"&amp;10Filename: &amp;F\" &amp; Chr(10) &amp; \"Sheet: &amp;A\"\n            '.CenterFooter = strFootCenter\n            .RightFooter = _\n              \"&amp;10Page &amp;P of &amp;N\"\n        End With\n    Else\n        MsgBox \"Sheet Template does not exist.\" &amp; vbCrLf &amp; _\n        \"For this reason, the header and footer cannot be inserted into newly created spreadsheets.\", _\n        vbExclamation, \"No Headers In Memory\"\n    End If\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 8224364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c59799baf85ce7195407911f29fbfbfe?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Steiner", "link": "https://stackoverflow.com/users/8224364/erik-steiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57112177, "answer_count": 2, "score": 0, "last_activity_date": 1563537961, "creation_date": 1563349143, "question_id": 57070820, "link": "https://stackoverflow.com/questions/57070820/create-header-and-footer-on-save-event-check-if-header-or-footer-exists", "title": "Create header and footer on save event. Check if header or footer exists", "body": "<p>I created a macro-template (workbook.xltm) and moved it to <code>C:\\Users\\USER\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART</code>. So this file is opened as the default workbook.\nThe workbook contains a little script that is executed, when the user clicks on the save button. The script adds header and footer to all sheets.</p>\n\n<p>My problem is the workflow as when a new file is opened, the user tends to alter the header by changing the company name for instance. Unfortunately at this point the file is not saved yet and so by hitting the save button, the header will be overwritten by the default company name from the script.</p>\n\n<ol>\n<li>It would be nice to have a condition that checks if a header and footer already exists. That would be the point when the user saves the file for the first time. This would avoid the case in which the header is overwritten by the default header text of the script.</li>\n<li>In addition to that it would be nice if the header and footer of the first sheet (from left) would be used for (copied to) all newly created sheets (if the user creates them). For now if a user creates a new sheet and hits the save button, the header/footer in the new sheet looks like the default header/footer from the script.</li>\n</ol>\n\n<p>The script:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    ActiveSheet.PageSetup.LeftHeader = \"Company: Company Ltd.\" &amp; Chr(10) &amp; \"Cutoff date: 31.12.20XX\"\n    ActiveSheet.PageSetup.LeftFooter = \"Filename: &amp;F\" &amp; Chr(10) &amp; \"Sheet: &amp;A\"\n    ActiveSheet.PageSetup.CenterFooter = \"Page &amp;P of &amp;N\"\n    ActiveSheet.PageSetup.TopMargin = Application.CentimetersToPoints(3.91)\n    ActiveSheet.PageSetup.HeaderMargin = Application.CentimetersToPoints(1.91)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1563349484, "post_id": 57070811, "comment_id": 100665678, "body": "You&#39;ll need to create a custom list I believe."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 2, "creation_date": 1563350141, "post_id": 57070811, "comment_id": 100666010, "body": "How about assigning numbers to your keywords( FUD-&gt;1, TED-&gt;2 etc) and creating an additional column with the corresponding numbers? You could then sort your data using this column."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11791132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be74fd39bc59786899508c42a50bef45?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/11791132/arthur"}, "edited": false, "score": 0, "creation_date": 1563367891, "post_id": 57072075, "comment_id": 100675703, "body": "Thank you very much for the answer. I updated my question, indeed my strings are only on one column and not split on three columns. Results need to be in only one column."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1563354961, "last_edit_date": 1563354961, "creation_date": 1563353676, "answer_id": 57072075, "question_id": 57070811, "link": "https://stackoverflow.com/questions/57070811/how-to-do-both-an-alphabetical-sort-and-an-other-specific-sort-for-a-column/57072075#57072075", "title": "How to do both, an alphabetical sort and an other specific sort for a column?", "body": "<p>You can do this without VBA (if you want to)</p>\n\n<ul>\n<li>Create your own custom sort list: <strong>File</strong> > <strong>Options</strong> > <strong>Advanced</strong> > <strong>General</strong>: <strong>Edit Custom List</strong> > Either <strong>Import</strong> or type your values. <a href=\"https://support.office.com/en-us/article/sort-data-using-a-custom-list-cba3d67a-c5cb-406f-9b14-a02205834d72\" rel=\"nofollow noreferrer\">Here</a> is a walkthrough.</li>\n<li>Select your range and in the ribbon, click <strong>Data</strong> > <strong>Sort</strong>.</li>\n<li>First rule is column B A-z</li>\n<li>Add a second rule for column C and under <strong>Order</strong> drop-down, select <strong>Custom List</strong> and select the list <code>FUD, Ted, BLD, APT</code>.</li>\n<li>Choose wheather or not you are using headers (I used them in example below)</li>\n<li>Confirm, and result should look like:</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/HOkQY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HOkQY.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can automate this procedure through VBA, there are examples around for example <a href=\"https://stackoverflow.com/questions/6100944/code-an-excel-vba-sort-with-a-custom-order-and-a-value-containing-commas\">here</a> and <a href=\"https://stackoverflow.com/questions/52848753/excel-vba-custom-order-sort\">here</a>.</p>\n"}], "owner": {"reputation": 43, "user_id": 11791132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be74fd39bc59786899508c42a50bef45?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/11791132/arthur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1563355952, "creation_date": 1563349087, "last_edit_date": 1563355952, "question_id": 57070811, "link": "https://stackoverflow.com/questions/57070811/how-to-do-both-an-alphabetical-sort-and-an-other-specific-sort-for-a-column", "title": "How to do both, an alphabetical sort and an other specific sort for a column?", "body": "<p>I am a beginner in VBA and I tried to do a specific sort after an aplhebitical sort.</p>\n\n<p>Initially all data are shuffled and I applyed a sort to sort by alphabetical order with the following code:</p>\n\n<pre><code>Range (\"A1\", Range(\"A1\").End(xlDwn)).Sort Key1:=Range(\"A1\"), Order1:=xlAscending, Header:=xlNo\n</code></pre>\n\n<p>Please find below the first column of my excel sheet after the alphabetical sort.    </p>\n\n<pre><code>   Column A\nString_Atest_1\nString_Btest_2\nString_C60_APT\nString_C60_BLD\nString_C60_FUD\nString_C60_TED\nString_C63_APT\nString_C63_BLD\nString_C63_FUD\nString_C63_TED\nString_C64_APT\nString_C64_BLD\nString_C64_FUD\nString_C64_TED\n...\n</code></pre>\n\n<p>But my goal is to do an alphabetical sort with this specific order : <code>FUD, TED, BLD, APT</code>.</p>\n\n<p>So the excepted result is:</p>\n\n<pre><code>   Column A\nString_Atest_1\nString_Btest_2\nString_C60_FUD\nString_C60_TED\nString_C60_BLD\nString_C60_APT\nString_C63_FUD\nString_C63_TED\nString_C63_BLD\nString_C63_APT\nString_C64_FUD\nString_C64_TED\nString_C64_BLD\nString_C64_APT\n...\n</code></pre>\n\n<p>Someone can help me to do this please? Thanks a lot.</p>\n"}, {"tags": ["vba", "sharepoint", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1563349695, "post_id": 57070629, "comment_id": 100665782, "body": "<a href=\"https://stackoverflow.com/a/54853243/11509084\">stackoverflow.com/a/54853243/11509084</a>"}], "owner": {"reputation": 179, "user_id": 9013218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1weSs.png?s=128&g=1", "display_name": "V. V. Kozlov", "link": "https://stackoverflow.com/users/9013218/v-v-kozlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1563353660, "creation_date": 1563348450, "last_edit_date": 1563353660, "question_id": 57070629, "link": "https://stackoverflow.com/questions/57070629/how-do-i-list-the-network-drives-available-to-me-in-vba-as-a-consequence-of-usi", "title": "How do I list the network drives available to me in VBA (as a consequence of using Sharepoint)?", "body": "<p>Our company recently installed SharePoint which sometimes has adverse effects when running Word VBA add-ins.  We are currently using Office 2013, though Excel seems to be largely unaffected.</p>\n\n<p>One thing which works for us is to map the SharePoint area to a \"legacy\" drive letter using <code>net use</code>,</p>\n\n<pre><code>net use z: https://sharepoint.con/departmentalStuff/etc/...\n</code></pre>\n\n<p>As it persists over multiple user logins and is in effect until canceled or changed, <code>net use</code> is not too hard on the users.</p>\n\n<p>Naturally, addin users would indirectly use the various VBA-supplied canned dialogue boxes such as <code>Application.FileDialog(msoFileDialogFilePicker)</code> to navigate among their various directories, both Sharepoint and non-Sharepoint, and select files.  These dialogue boxes display files with the legacy drive letters assigned by <code>net use</code>.  So far so good.</p>\n\n<p>However, the canned VBA dialogue boxes picking from a Sharepoint source will not return the legacy file names but rather UNC file names which are incompatible with the code further downstream.  My hackish workaround is to simply convert the file names using the following function (adapted from code found on SO):</p>\n\n<pre><code>Public Function toLegacyName(uncName As String) As String\n\n    uncName = Replace(uncName, \"https://\", \"//\")\n    uncName = Replace(uncName, \"/\", \"\\\")\n    If Left(uncName, 2) &lt;&gt; \"\\\\\" Then\n        toLegacyName = uncName\n        Exit Function\n    End If\n\n    Dim network As Object: Set network = CreateObject(\"WScript.Network\")\n    Dim netDrives As Object: Set netDrives = network.EnumNetworkDrives\n    Dim drives As String: drives = \"Network drive Mappings:\" &amp; Chr(13)\n    Dim myLet As String\n    Dim myUnc As String\n\n    Dim i As Long\n\n    ' loop through all network drives\n    For i = 0 To netDrives.Count - 1 Step 2\n        drives = drives &amp; \"Drive \" &amp; netDrives(i) &amp; \" = \" &amp; netDrives(i + 1) &amp; Chr(13)\n        myLet = netDrives.Item(i)\n        myUnc = netDrives.Item(i + 1)\n        myUnc = Replace(myUnc, \"@SSL\", \"\") ' installation-dependent ?\n\n        ' hopefully we find it here\n        If InStr(LCase(uncName), LCase(myUnc)) Then\n            toLegacyName = myLet &amp; Right(uncName, Len(uncName) - Len(myUnc))\n            Exit Function\n        End If\n    Next i\n\n    ' drive not mapped or something\n    MsgBox drives, vbOKOnly, \"Error with UNC file name \" &amp; uncName\n    toLegacyName = \"\"\n\nEnd Function\n</code></pre>\n\n<p>While this code works for me, I see that the list of drive letters in netDrives is not necessarily complete.  Some drive letters assigned by <code>net use</code> may be missing, possibly when the network resource is reused, as in</p>\n\n<pre><code>net use x: https://sharepoint.con/departmentalStuff/Marketing/... \nnet use y: https://sharepoint.con/departmentalStuff/Research/...\n</code></pre>\n\n<p>Is there a better way to determine all the drive mappings apart from <code>WScript.Network</code>?  Are solutions specific to Sharepoint when using Word addins?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1563348902, "post_id": 57070564, "comment_id": 100665347, "body": "It is simply not possible to force the user to enable macros. Even more so when you consider that the capability might be blocked by a network administrator - the user would have no choice. Nor is it really possible to block copying and pasting - making a screen shot is always possible and OCR software can convert that to text. And the Insert File capability means trying to disable pasting is not going to block bringing in new data. Word is a <i>word processor</i>: it was specifically <i>designed</i> for editing, not read-only..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1563348908, "post_id": 57070564, "comment_id": 100665351, "body": "A full-blown application could, perhaps, do what you need, but that&#39;s beyond the scope of Stack Overflow (and your capabilities, it appears.)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563349868, "post_id": 57070564, "comment_id": 100665871, "body": "Can you provide more background information about your document? Eg. if it is a form that users should be able to fill, but you want to prevent them from editing the rest it would be possible to restrict editing, but allow to fill the form. \u2022 Actually it is a bit unlogic to prevent copy/paste but allow editing. Can you explain why this should make sense?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1563351100, "post_id": 57070564, "comment_id": 100666505, "body": "I have to agree with P\u1d07\u029c.  This <i>only</i> makes sense if you are talking about a form and they are fairly easy to control.  Although people might still want to be able to paste."}, {"owner": {"reputation": 109, "user_id": 11402526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1084557f7f8018fb8e504f5bfcad4755?s=128&d=identicon&r=PG&f=1", "display_name": "rukuto", "link": "https://stackoverflow.com/users/11402526/rukuto"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1563353796, "post_id": 57070564, "comment_id": 100667913, "body": "It&#39;s an agreement with terms and conditions written on it and the other party wants the draft copies. They are not computer experts nor have the means/time/resources to get in touch with one who could type it out or get screenshots and edit them. But as I said, I just want to make it harder for them to copy my work.  @CindyMeister I know it, as I said that I did some research and I am not asking the code to be able to stop screenshotting or printing or retyping, I am just asking that it make things difficult for them where it is much harder than just Ctrl+c and Ctrl+v"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563354088, "post_id": 57070564, "comment_id": 100668076, "body": "@rukuto But editing always includes you are able to copy it. To prevent copying make a PDF and disallow copy and printing (this is not 100% secure too but it makes it more difficult). If they can edit your file they can copy it."}, {"owner": {"reputation": 109, "user_id": 11402526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1084557f7f8018fb8e504f5bfcad4755?s=128&d=identicon&r=PG&f=1", "display_name": "rukuto", "link": "https://stackoverflow.com/users/11402526/rukuto"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1563354127, "post_id": 57070564, "comment_id": 100668093, "body": "@CindyMeister If you have read the forum link that I have shared, you would know that it is possible to do what I am asking for (it has already been done) but the one available after 12 years is only a hybrid with another VBA command that is of no use to me."}, {"owner": {"reputation": 109, "user_id": 11402526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1084557f7f8018fb8e504f5bfcad4755?s=128&d=identicon&r=PG&f=1", "display_name": "rukuto", "link": "https://stackoverflow.com/users/11402526/rukuto"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563354218, "post_id": 57070564, "comment_id": 100668146, "body": "@P\u1d07\u029c I have added the VBA commands that I mentioned in the question, it works. I know there are ways around it but as I mentioned, as long it takes more effort than just Ctrl+c and Ctrl+v, it is fine."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563354456, "post_id": 57070564, "comment_id": 100668289, "body": "Well, if it works then where is the question? In most companies Macros are blocked by default (at least they should) unless the company signed them digitally. If I would have asked you for a &quot;terms and conditions&quot; and you would send me a file with macros I would decline the file anyway. Hopefully any other company that is concerned about their security would do the same."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1563354554, "post_id": 57070564, "comment_id": 100668353, "body": "No, your actual question is how to force enabling of macros. And that&#39;s simply not possible. Beyond that, the other technology you&#39;ve looked, with protecting, can be extended, as I recall, to include copy/paste. Research IRM (Information Rights Management). See for example <a href=\"http://download.microsoft.com/documents/uk/education/resources/tech/downloads/what-is-irm.pdf\" rel=\"nofollow noreferrer\">download.microsoft.com/documents/uk/education/resources/tech&zwnj;&#8203;/&hellip;</a>"}], "owner": {"reputation": 109, "user_id": 11402526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1084557f7f8018fb8e504f5bfcad4755?s=128&d=identicon&r=PG&f=1", "display_name": "rukuto", "link": "https://stackoverflow.com/users/11402526/rukuto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563354772, "creation_date": 1563348181, "last_edit_date": 1563348548, "question_id": 57070564, "link": "https://stackoverflow.com/questions/57070564/force-enable-macros-in-word", "title": "Force Enable Macros in Word", "body": "<p>I have been trying to find some VBA code (I am not a computer expert) that can allow me to force users to enable macros. Now, after researching, I know that it is not completely possible because it would make 'security' become useless. I also found codes for excel that hide the worksheets till macro is enabled or a password is used. </p>\n\n<p>I also found a thread in VBAexpress but the document with the code is not available and only a hybrid version of it is still there (it was in 2007, and I believe Microsoft might have also made many changes) which is not of use to me.\n<a href=\"http://www.vbaexpress.com/forum/showthread.php?6621-Solved-Word-challenge-Force-in-macro-enabling/page2\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/forum/showthread.php?6621-Solved-Word-challenge-Force-in-macro-enabling/page2</a> </p>\n\n<p>Now, from this I know it is possible to create a VBA code such that it restricts editing/printing if the macros are disabled and a pop-up is displayed that asks the user to enable macro's for full access. Can someone help me get this code and also tell me how to implement it. </p>\n\n<p>The reason why I am doing this is because I want to prevent copy-paste in the document but allow editing of it and also allowing copying and sharing of the document (as a file). The users are not tech experts but if they want to copy paste the document then I want to make it hard for them. I have also already used the 'restrict editing' thing to prevent editing of a few lines in the document. I have used the following codes but it requires enabling macros:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub EditCopy()\nMsgBox \"Copy is disabled.\"\nEnd Sub\n\n\nSub EditCut()\nMsgBox \"Cut is disabled.\"\nEnd Sub\n\n\nSub EditPaste()\nMsgBox \"Paste is disabled.\"\nEnd Sub\n\n\nSub EditPasteSpecial()\nMsgBox \"Paste Special is disabled.\"\nEnd Sub\n</code></pre>\n\n<p>Any solution is welcome. Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1563348705, "post_id": 57070174, "comment_id": 100665253, "body": "I would run a check to see if your workbooks open using <code>If Not x Is Nothing Then</code>. I would also check the sheet names. You haven&#39;t used the greatest naming convention so it will allow for room for error. Also when setting your <code>String</code> values use either <code>.Text</code> or <code>.Value</code>. I prefer to use <code>.Text</code> when working with <code>String</code> type."}, {"owner": {"reputation": 9, "user_id": 11795108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-krY4vLMj7Vc/AAAAAAAAAAI/AAAAAAAADf4/esGfQVZyhzU/photo.jpg?sz=128", "display_name": "yiehan tay", "link": "https://stackoverflow.com/users/11795108/yiehan-tay"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1563350347, "post_id": 57070174, "comment_id": 100666108, "body": "There is an error on FilePath = Worksheets(&quot;Sheet1&quot;).Range(&quot;B4&quot;). Should I have to activate Worksheets(&quot;Sheet1&quot;) or anything else?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1563351191, "post_id": 57070174, "comment_id": 100666571, "body": "No.  You never need to Activate.  But it is good practice to use <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;B4&quot;).Text</code> as this will prevent problems with formulae, URLs, etc)."}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1563351641, "post_id": 57070174, "comment_id": 100666797, "body": "Make sure that you actually have a sheet with the name <code>Sheet1</code>. Also qualify the workbook using <code>ThisWorkbook</code>."}, {"owner": {"reputation": 9, "user_id": 11795108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-krY4vLMj7Vc/AAAAAAAAAAI/AAAAAAAADf4/esGfQVZyhzU/photo.jpg?sz=128", "display_name": "yiehan tay", "link": "https://stackoverflow.com/users/11795108/yiehan-tay"}, "edited": false, "score": 0, "creation_date": 1563352148, "post_id": 57070174, "comment_id": 100667052, "body": "Thank you for your reply. But the error is still there. This my third sub and I created a new workbook at my first sub. Does it mean that I have to create a workbook coding in front of Worksheets(&quot;Sheet1&quot;).Range(&quot;B4&quot;)? I have no ideas how to qualify my original workbook as a name so that I can use in the workbook coding. Any ideas? After I added ThisWorkbook, the error is still there. Thank you!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1563355448, "post_id": 57070174, "comment_id": 100668914, "body": "yehan, are the worksheets/cells containing the file path information in an <i>open</i> workbook? If yes, is this the workbook containing the macro? Or are they in one of the workbooks you&#39;re trying to open?"}, {"owner": {"reputation": 9, "user_id": 11795108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-krY4vLMj7Vc/AAAAAAAAAAI/AAAAAAAADf4/esGfQVZyhzU/photo.jpg?sz=128", "display_name": "yiehan tay", "link": "https://stackoverflow.com/users/11795108/yiehan-tay"}, "edited": false, "score": 0, "creation_date": 1563356995, "post_id": 57070174, "comment_id": 100669784, "body": "the worksheets/cells containing the file path information in an open workbook, which is the workbook that contains the VBA code I&#39;m looking at. Yes, this workbook contains a macro."}], "owner": {"reputation": 9, "user_id": 11795108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-krY4vLMj7Vc/AAAAAAAAAAI/AAAAAAAADf4/esGfQVZyhzU/photo.jpg?sz=128", "display_name": "yiehan tay", "link": "https://stackoverflow.com/users/11795108/yiehan-tay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563355282, "creation_date": 1563346641, "last_edit_date": 1563355282, "question_id": 57070174, "link": "https://stackoverflow.com/questions/57070174/errors-of-my-vba-coding-in-copying-and-pasting-data-from-one-workbook-to-another", "title": "Errors of my VBA coding in copying and pasting data from one workbook to another workbook", "body": "<p>I would like to copy data whose file location stated on cells I4,I5 to the file whose file location stated on cells B4,B5.  The data should be copied from one workbook to another workbook but it shows me runtime error '9'. Anyone knows what is the problem?</p>\n\n<pre><code>Sub foo()\nDim x As Workbook\nDim y As Workbook\nDim FileName As String\nDim FilePath As String\nDim PFile As String\nDim PFilePath As String\n\nFilePath = Worksheets(\"Sheet1\").Range(\"B4\")\nFileName = Worksheets(\"Sheet1\").Range(\"B5\")\nPFilePath = Worksheets(\"Sheet1\").Range(\"I4\")\nPFile = Worksheets(\"Sheet1\").Range(\"I5\")\n\n'## Open both workbooks first:\nSet x = Workbooks.Open(PFilePath &amp; PFile)\nSet y = Workbooks.Open(FilePath &amp; FileName)\n\n'Now, copy what you want from x:\n x.Sheets(\"DTH&amp;TPDClaims List\").Range(\"A1:W9999\").Copy\n\n'Now, paste to y worksheet:\n y.Sheets(\"DTH&amp;TPDClaims List\").Range(\"A1:W9999\").PasteSpecial\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "edited": false, "score": 0, "creation_date": 1563349276, "post_id": 57070456, "comment_id": 100665580, "body": "Thanks! Trying it out right now. Reporting back in a few hours... :p"}], "tags": [], "owner": {"reputation": 625, "user_id": 2880342, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917a1ca96bd067832d2b7e4d8967d336?s=128&d=identicon&r=PG&f=1", "display_name": "GoodJuJu", "link": "https://stackoverflow.com/users/2880342/goodjuju"}, "is_accepted": true, "score": 0, "last_activity_date": 1563352314, "last_edit_date": 1563352314, "creation_date": 1563347772, "answer_id": 57070456, "question_id": 57070081, "link": "https://stackoverflow.com/questions/57070081/vba-item-not-found-in-this-collection-cant-find-why/57070456#57070456", "title": "VBA - Item not found in this collection - Can&#39;t find why", "body": "<p>As the QueryDef is not required at this point (you are deleting it, BUT it does not actually exist). A simple check to see if it exists before deleting it is all you need.</p>\n\n<p>Modifying your code as below should resolve the issue for you.</p>\n\n<pre><code>strSQL = \"\"\nstrSQL = strSQL &amp; \"SELECT Alla_Aktiva.LEVID AS [FINFO LEVERANT\u00d6RSNR], Alla_Aktiva.FINFONR AS [FINFO ARTIKELNUMMER], Alla_Aktiva.LEVARTNR AS [LEVERANT\u00d6RS ARTIKELNUMMER], Alla_Aktiva.PTISWEDISH AS INGRESS, Alla_Aktiva.PTKSWEDISH AS PRODUKTTEXT, Alla_Aktiva.PTTSWEDISH AS [TEKNISK BESKRIVNING], Alla_Aktiva.PTPSWEDISH AS PUNKTLISTA \"\nstrSQL = strSQL &amp; \"FROM FINFO_ORDERS_GRBES00 INNER JOIN Alla_Aktiva ON FINFO_ORDERS_GRBES00.SUPPLIERFROM_BELNRF = Alla_Aktiva.LEVID \"\nstrSQL = strSQL &amp; \"WHERE (((FINFO_ORDERS_GRBES00.SUBSCRIBERID_BEABN)=39221\"\nstrSQL = strSQL &amp; \"));\"\n\n' Modified Code below\n    Dim qdf As DAO.QueryDef\n\n    For Each qdf In CurrentDb.QueryDefs\n      If qdf.Name = \"ExportData2\" Then\n        CurrentDb.QueryDefs.Delete \"ExportData2\"\n         Exit For\n      End If\n    Next\n'End modified code\n\nSet queData = db.CreateQueryDef(\"ExportData2\", strSQL)\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"ExportData2\", \"G:\\Finfo_Jobb\\MCLankar\\MC Stat\\Utskick\\Abo-\" &amp; 39221 &amp; \"\" &amp; Format$(Now(), \"YYYYMMDDHHMMSS\") &amp; \".xlsx\", True\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57070456, "answer_count": 1, "score": 1, "last_activity_date": 1594636095, "creation_date": 1563346273, "last_edit_date": 1594636095, "question_id": 57070081, "link": "https://stackoverflow.com/questions/57070081/vba-item-not-found-in-this-collection-cant-find-why", "title": "VBA - Item not found in this collection - Can&#39;t find why", "body": "<p>In need of some assistance. I'm not a programmer nor fluent in VBA yet somehow ended up trying to automate an old Access file that my company manually runs every week. It takes over 2 hours to run manually, so Automation seemed worth it. Seems to have gotten most of it down but it fails on the last few commands now. Takes about an hour to run before the error occurs as well, so troubleshooting takes forever.</p>\n\n<p>I don't really know what I'm doing if I'm gonna be honest. Been using examples from different answers that I've found to other similar questions to automate this so far and the first 5 steps run without issue. I've tried other answers to this error but they've not yet fixed it for me and as I'm pretty much just throwing stuff at a wall and seeing what sticks, I'm not really sure how to proceed.</p>\n\n<p>Here's the code that gives the error:</p>\n\n<pre><code>strSQL = \"\"\nstrSQL = strSQL &amp; \"SELECT Alla_Aktiva.LEVID AS [FINFO LEVERANT\u00d6RSNR], Alla_Aktiva.FINFONR AS [FINFO ARTIKELNUMMER], Alla_Aktiva.LEVARTNR AS [LEVERANT\u00d6RS ARTIKELNUMMER], Alla_Aktiva.PTISWEDISH AS INGRESS, Alla_Aktiva.PTKSWEDISH AS PRODUKTTEXT, Alla_Aktiva.PTTSWEDISH AS [TEKNISK BESKRIVNING], Alla_Aktiva.PTPSWEDISH AS PUNKTLISTA \"\nstrSQL = strSQL &amp; \"FROM FINFO_ORDERS_GRBES00 INNER JOIN Alla_Aktiva ON FINFO_ORDERS_GRBES00.SUPPLIERFROM_BELNRF = Alla_Aktiva.LEVID \"\nstrSQL = strSQL &amp; \"WHERE (((FINFO_ORDERS_GRBES00.SUBSCRIBERID_BEABN)=39221\"\nstrSQL = strSQL &amp; \"));\"\n\ndb.QueryDefs.Delete \"ExportData2\"\nSet queData = db.CreateQueryDef(\"ExportData2\", strSQL)\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"ExportData2\", \"G:\\Finfo_Jobb\\MCLankar\\MC Stat\\Utskick\\Abo-\" &amp; 39221 &amp; \"\" &amp; Format$(Now(), \"YYYYMMDDHHMMSS\") &amp; \".xlsx\", True\n</code></pre>\n\n<p>db.QueryDefs.Delete \"ExportData2\" - this gets marked as the error with item not found in this collection as the error</p>\n\n<p>So this should, in theory, generate a statistics report of how much data each Supplier (Leverant\u00f6r in Swedish) has on their products and put it in an Excel file which is placed on our shared network disk (G:)</p>\n\n<p>Since it takes over an hour to run each time I try something new, I'm getting a bit frustrated with it and only have 3 more days until I go on a 3 week vacation and getting this up and running before then would allow me to not work during that vacation, generating the report. :p </p>\n\n<p>Any help would be greatly appreciated</p>\n\n<p>(Why my company is using Access to generate statistics from a product database of several million products and a few hundred different datapoints per product is beyond me :p (It's the way it's always been done-mentality and no financial incentive to update to something more suitable, but yeah...))</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "autofilter", "advanced-filter"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563344587, "post_id": 57069351, "comment_id": 100663217, "body": "Some questions: \u2460 Can you please provide some example data (see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>). \u2461 Are these values (you want to filter) saved as numbers or text in the cells?"}, {"owner": {"reputation": 5, "user_id": 11795661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3f17757c8dd318ecb294263b5fca18?s=128&d=identicon&r=PG&f=1", "display_name": "KeesKameel", "link": "https://stackoverflow.com/users/11795661/keeskameel"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563345092, "post_id": 57069351, "comment_id": 100663399, "body": "(1) 123093 123078 123124 123110 123131 123100 123134 123180 123183 123217 123218 123228 123233 123239 (2) As Numbers"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563345300, "post_id": 57069351, "comment_id": 100663482, "body": "If they are numbers you cannot use textfilers like <code>*</code> you need to use number filters. Therefore see my workaround answer below."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11795661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3f17757c8dd318ecb294263b5fca18?s=128&d=identicon&r=PG&f=1", "display_name": "KeesKameel", "link": "https://stackoverflow.com/users/11795661/keeskameel"}, "edited": false, "score": 0, "creation_date": 1563348154, "post_id": 57069739, "comment_id": 100664940, "body": "With a bit of tweaking i got it to work. In the formula i had to change the comma into a semicolon    . and i neede to add the worksheets and range into the code. Thanks!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5, "user_id": 11795661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3f17757c8dd318ecb294263b5fca18?s=128&d=identicon&r=PG&f=1", "display_name": "KeesKameel", "link": "https://stackoverflow.com/users/11795661/keeskameel"}, "edited": false, "score": 0, "creation_date": 1563348334, "post_id": 57069739, "comment_id": 100665051, "body": "@KeesKameel The formulas here are always meant for an US English Excel. Localized Excel versions of other countries might always need a localization of the formulas (since they somtimes use different separators <code>,</code> or <code>;</code> and also the function names might be translated into the country&#39;s language)."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1563345960, "last_edit_date": 1563345960, "creation_date": 1563344931, "answer_id": 57069739, "question_id": 57069351, "link": "https://stackoverflow.com/questions/57069351/excel-filter-multiple-values/57069739#57069739", "title": "Excel filter multiple values", "body": "<h3>Indirect (workaround) solution</h3>\n\n<p>Since you have real numbers in the column you want to filter at, you cannot use text filters with asterisks <code>*</code> and must use number filters. Therfore you would need to use a helper column for filtering, that shows only the last digit of your numbers. </p>\n\n<p>Add the following formula to your helper column:</p>\n\n<pre><code>=VALUE(RIGHT(A:A,1))\n</code></pre>\n\n<p>So it looks like in the picture below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8OzAx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8OzAx.png\" alt=\"enter image description here\"></a>\n<em><sup>Image 1: Added helper column showing the ending digit only.</sup></em></p>\n\n<p>Now you can filter for the exact ending numbers <code>1</code> or <code>2</code> (using <code>xlOr</code>), </p>\n\n<pre><code>.AutoFilter Field:=2, Criteria1:=\"=1\", Operator:=xlOr, Criteria2:=\"=2\"\n</code></pre>\n\n<p>or even on ending ranges like <code>1-5</code> by using the numeric in between filter <code>&gt;=1</code> and <code>&lt;=5</code> with <code>xlAnd</code>.</p>\n\n<pre><code>.AutoFilter Field:=2, Criteria1:=\"&gt;=1\", Operator:=xlAnd, Criteria2:=\"&lt;=5\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/5lnu4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5lnu4.png\" alt=\"enter image description here\"></a>\n<em><sup>Image 2: Data filtered by ending digits, showing only ending digits from 1 to 5.</sup></em></p>\n"}], "owner": {"reputation": 5, "user_id": 11795661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3f17757c8dd318ecb294263b5fca18?s=128&d=identicon&r=PG&f=1", "display_name": "KeesKameel", "link": "https://stackoverflow.com/users/11795661/keeskameel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "accepted_answer_id": 57069739, "answer_count": 1, "score": 0, "last_activity_date": 1563345960, "creation_date": 1563343045, "last_edit_date": 1563344299, "question_id": 57069351, "link": "https://stackoverflow.com/questions/57069351/excel-filter-multiple-values", "title": "Excel filter multiple values", "body": "<p>I have a datasheet with 1300 rows. Each row is numbered by a specific number linked to our database. I need to filter everything by two arguments 5 times. </p>\n\n<ul>\n<li>First one: filter everything ending on 0 and 1</li>\n<li>Second filter: filer everything ending on 2 and 3</li>\n<li>etc</li>\n<li>etc.</li>\n<li>fifth filter: filter everything ending on 8 and 9</li>\n</ul>\n\n<p>I need to use these filters seperately because different people will use it.</p>\n\n<p>example: person 1 will need to see data with the ending numbers 2 and 3\nperson 2 will need to see data with the ending numbers 6 and 7</p>\n\n<p>I can filter the data with one argument like <code>*5</code> or <code>*8</code> but when I try to use 2 arguments divided by <code>\"\"</code>, <code>OR</code>, <code>AND</code> it won't work. </p>\n\n<p>Advanced filtering also doesn't want to use my two arguments. When I put these 2 criteria in different cells and select them as criteria. The result will be blank. And when I only select one criteria like <code>*5</code>, the filter will make no sense because it will also show cells ending with other numbers.</p>\n\n<p>I expect the result to be a formula I can use in my advanced filter or a VBA code as I will be implementing it in a small script to make it as easy as possible to use for my colleagues. And an explanaition would be much appreciated so others and me can implement it in a different way.</p>\n"}, {"tags": ["excel", "vba", "sas"], "answers": [{"comments": [{"owner": {"reputation": 396, "user_id": 2337871, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/749a7a35e8eea963c37ae56eb29039bc?s=128&d=identicon&r=PG", "display_name": "user2337871", "link": "https://stackoverflow.com/users/2337871/user2337871"}, "edited": false, "score": 0, "creation_date": 1563398286, "post_id": 57069350, "comment_id": 100691454, "body": "That is precisely what I was looking for.  Thank you."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1563343037, "creation_date": 1563343037, "answer_id": 57069350, "question_id": 57069215, "link": "https://stackoverflow.com/questions/57069215/vba-populate-different-objects-using-the-value-from-a-sub-argument/57069350#57069350", "title": "VBA Populate Different Objects Using the Value from a Sub Argument", "body": "<p>If your SAS objects have a common \"Add\" method then you can do something like this:</p>\n\n<pre><code>Dim outputParams As SASRanges\nSet outputParams = New SASRanges\nAddParams outputParams \n\n\nDim prompts As SASPrompts\nSet prompts = sas.CreateSASPromptsObject\nAddParams prompts\n\n\n'add common parameters\nSub AddParams(obj As Object)\n    With obj\n        .Add \"DD_BD_AGE\", Sheet1.Range(\"DD_BD_Age\")\n        'etc for the rest\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 396, "user_id": 2337871, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/749a7a35e8eea963c37ae56eb29039bc?s=128&d=identicon&r=PG", "display_name": "user2337871", "link": "https://stackoverflow.com/users/2337871/user2337871"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 57069350, "answer_count": 1, "score": 0, "last_activity_date": 1563544770, "creation_date": 1563342339, "last_edit_date": 1563544770, "question_id": 57069215, "link": "https://stackoverflow.com/questions/57069215/vba-populate-different-objects-using-the-value-from-a-sub-argument", "title": "VBA Populate Different Objects Using the Value from a Sub Argument", "body": "<p>Good Afternoon All,</p>\n\n<p>Let me preface this post by saying I have very little experience using VBA, but it is the tool I have to work with in this instance, so here I am.  I am using the SAS Add-In for Microsoft Office, which isn't entirely relevant in this situation as far as I can tell, but it is best to give you some context.  I have 2 subs that function very differently but make use of the same named ranges.  </p>\n\n<p>The first sub uses values from 4 cells within Excel and submits them to a stored process which returns values to particular cells which are defined as named ranges - approximately 64.  Once that takes place the end-user will validate the results, make some changes to the values in the 64 cells and then submit the second sub.  The second sub then passes the values contained within the 64 cells for processing by a second stored process.</p>\n\n<p>It makes more sense to me to have the 64 variables defined once and not multiple times to save on maintenance, but they are applied to different objects for example:</p>\n\n<p><strong>Sub1</strong></p>\n\n<pre><code>Dim outputParams As SASRanges\nSet outputParams = New SASRanges\n\nDim DD_BD_Age As Range\nSet DD_BD_Age = Sheet1.Range(\"DD_BD_Age\")\n\noutputParams.Add \"DD_BD_AGE\", DD_BD_Age\n</code></pre>\n\n<p><strong>Sub2</strong></p>\n\n<pre><code>Dim prompts As SASPrompts\nSet prompts = sas.CreateSASPromptsObject\n\nDim DD_BD_Age As Range\nSet DD_BD_Age = Sheet1.Range(\"DD_BD_Age\")\n\nprompts.Add \"DD_BD_AGE\", DD_BD_Age\n</code></pre>\n\n<p>Is there any way that I can define these variables for use across either sub.  If I was using SAS I would create a macro with a parameter which would allow me to specify the value of outputParams or prompts depending on the context in which I was using them.  </p>\n\n<p>Admittedly, with my limited experience with VBA, I may just be making things more difficult than they need to be, so please let me know if this is the case.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}]