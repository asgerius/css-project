[{"tags": ["vba", "ms-access", "environ"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1549497476, "post_id": 54564378, "comment_id": 95927603, "body": "TBH, you&#39;re much better off restricting access to it via the file system.  I haven&#39;t run across <b><i>any</i></b> protection other than an Encrypt with Password that isn&#39;t fairly easy to bypass. The other option is to use a DBMS that has finer grained security, such as SQL Server Express."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1549527419, "post_id": 54564378, "comment_id": 95935745, "body": "As Comintern says, use encryption. You can just disable VBA altogether, and any VBA-based security will fail. Adding code like this gives a false sense of security, which is often worse than no security at all."}], "answers": [{"tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1549518102, "creation_date": 1549518102, "answer_id": 54566990, "question_id": 54564378, "link": "https://stackoverflow.com/questions/54564378/how-to-use-environ-function-to-avoid-other-from-using-my-access-db/54566990#54566990", "title": "how to use environ function to avoid other from using my Access DB", "body": "<p>Add this code to your startup form. When the form opens it will check for the username and computername, and if both match the form will open.</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n    If Not (Environ(\"username\") = \"santosh\" And Environ(\"computername\") = \"ABC-CAP1-093\") Then\n        Cancel = True\n        Application.Quit\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Avoid using shift key</strong> - I have already answered see this <a href=\"https://stackoverflow.com/questions/25692929/how-to-present-a-ms-access-form-to-the-end-user/54156862#54156862\">link</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11025589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ea0d34da5b021ad0ca8b3e21ad7fc0?s=128&d=identicon&r=PG&f=1", "display_name": "bmrp17", "link": "https://stackoverflow.com/users/11025589/bmrp17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549527291, "creation_date": 1549497301, "last_edit_date": 1549527291, "question_id": 54564378, "link": "https://stackoverflow.com/questions/54564378/how-to-use-environ-function-to-avoid-other-from-using-my-access-db", "title": "how to use environ function to avoid other from using my Access DB", "body": "<p>I manage an Access DB (accdb) and it contains some information about my company that I don\u00b4t want others to access it out of my company\u00b4s server.</p>\n\n<p>I thought to use Environ (5)=computername or Environ (12)=path to retrieve some references such as LEN(environ(path)). With this function, I could, for instance, make sure that the accdb file only works if LEN(environ(path))/2+15=55 (the lenght at my company\u00b4s server divided by 2 plus 15 = 80/2+15=55 = algorhytm).</p>\n\n<p>So, on opening the db, it should prompt for a number/code. If the user inserts 55 and the filepath = 80, it will open. If filepath=100 (filepath out of my company\u00b4s server), must be prompted 100/2+15=65 to open the db.</p>\n\n<p>Unfortunelly, I don't know how to programe it neither I know how to block the use of SHIFT (that breakes the VBA code on opening) because I'm a rookie.</p>\n\n<p>So, if you please, can you help me to solve these huge problems (1. algorhytm using Environ, 2. avoid using SHIFT on opening).</p>\n\n<p>Thanks in advance.</p>\n\n<p>Bruno</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1549493523, "post_id": 54563703, "comment_id": 95926431, "body": "For starters, <code>aSlide.Shapes.Paste</code> and the <code>.Select</code> should not be chained like that.  If you&#39;re having timing issues with the Office clipboard you&#39;re going to need to deal with the between those 2 calls.  That said, you probably need a short (couple ms) delay after the Copy and before the Paste."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1549515177, "post_id": 54563703, "comment_id": 95931234, "body": "Add <code>DoEvents</code> after the line <code>ActiveWorkbook.Sheets(i).Range(&quot;A1:O&quot; &amp; lastRow).CopyPicture Format:=xlPicture</code>"}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1549515277, "post_id": 54563798, "comment_id": 95931263, "body": "Hardcoding 2 seconds is a bad idea. There is no guarantee that the content will be placed in the clipboard in 2 seconds :) What if the application is busy doing something else? Best to add <code>DoEvents</code> and let the application decide the time it needs :)"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1549516257, "post_id": 54563798, "comment_id": 95931523, "body": "@SiddharthRout This is true- my answer is completely subjective here. I\u2019m only answering with what has worked best for me, having tried using DoEvents as well, and I\u2019ve been generating power points from Excel for a while now."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1549516744, "post_id": 54563798, "comment_id": 95931657, "body": "<a href=\"https://stackoverflow.com/questions/18851609/copy-from-excel-to-powerpoint-error\" title=\"copy from excel to powerpoint error\">stackoverflow.com/questions/18851609/&hellip;</a>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1549549590, "post_id": 54563798, "comment_id": 95948645, "body": "@SiddharthRout What is <code>Timer</code> in your second example there?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1549553952, "post_id": 54563798, "comment_id": 95951430, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Reference/User-Interface-Help/timer-function\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/Language/Reference/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1549493515, "creation_date": 1549493515, "answer_id": 54563798, "question_id": 54563703, "link": "https://stackoverflow.com/questions/54563703/occasionally-running-into-runtime-error-1004/54563798#54563798", "title": "Occasionally running into runtime error 1004", "body": "<p>This is a notorious issue when pasting from Excel to PowerPoint - the solution is to give the clipboard some breather time by adding a short break inbetween the copy/paste. Here is an example where we wait 2 seconds (which should be long enough):</p>\n\n<pre><code>Sub CreateSlides()\n\n    Dim PPApp As PowerPoint.Application\n    Dim PPFile As PowerPoint.Presentation\n    Dim lastRow As Integer\n    Dim aSlide As Slide\n    Dim path As String\n\n    path = \"C:Users\\Me\\Documents\\WorksheetSlides.pptx\"\n\n    Set PPApp = CreateObject(\"PowerPoint.Application\")\n    Set PPFile = PPApp.Presentations.Open(path)\n\n    For Each aSlide In PPFile.Slides\n        i = aSlide.SlideNumber + 1\n\n        aSlide.Select\n\n        If i &gt; ActiveWorkbook.Sheets.Count Then Exit For\n\n        lastRow = ActiveWorkbook.Sheets(i).Cells(Rows.Count, 1).End(xlUp).Row\n\n        ActiveWorkbook.Sheets(i).Range(\"A1:O\" &amp; lastRow).CopyPicture Format:=xlPicture\n\n        Wait\n\n        aSlide.Shapes.Paste.Select\n    Next\n\nEnd Sub\nSub Wait()\n\n    Application.Wait Now + TimeValue(\"0:00:02\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10992591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c4334625cee77f74bea18e5b822e246?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Kieu", "link": "https://stackoverflow.com/users/10992591/nathan-kieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "closed_date": 1549516888, "answer_count": 1, "score": 0, "last_activity_date": 1549493515, "creation_date": 1549493059, "last_edit_date": 1549493305, "question_id": 54563703, "link": "https://stackoverflow.com/questions/54563703/occasionally-running-into-runtime-error-1004", "closed_reason": "Duplicate", "title": "Occasionally running into runtime error 1004", "body": "<p>I created a macro to copy cells from my current excel workbook into a powerpoint presentation. The macro works, but occasionally I will get a</p>\n\n<blockquote>\n  <p>runtime error 1004: CopyPicture method of Range class failed.</p>\n</blockquote>\n\n<p>on line:</p>\n\n<p><code>ActiveWorkbook.Sheets(i).Range(\"A1:O\" &amp; lastRow).CopyPicture Format:=xlPicture</code></p>\n\n<p>I will also occasionally get</p>\n\n<blockquote>\n  <p>runtime error -2147188160 (80048240): Shapes (unknown member): invalid request. Clipboard is empty or contains data which may not be pasted here.</p>\n</blockquote>\n\n<p>on line:</p>\n\n<p><code>aSlide.Shapes.Paste.Select</code></p>\n\n<p>What's strange is that the errors occur at different places. For example, sometimes an error will occur on the 5th slide, then if I run it again, it will process the 5th slide just fine, but then run into an error again on the 10th slide.</p>\n\n<p>I tried using error handling, but everything I tried ended up freezing the program.</p>\n\n<pre><code>Sub CreateSlides()\n\n    Dim PPApp As PowerPoint.Application\n    Dim PPFile As PowerPoint.Presentation\n    Dim lastRow As Integer\n    Dim aSlide As Slide\n    Dim path As String\n\n    path = \"C:Users\\Me\\Documents\\WorksheetSlides.pptx\"\n\n    Set PPApp = CreateObject(\"PowerPoint.Application\")\n    Set PPFile = PPApp.Presentations.Open(path)\n\n    For Each aSlide In PPFile.Slides\n        i = aSlide.SlideNumber + 1\n\n        aSlide.Select\n\n        If i &gt; ActiveWorkbook.Sheets.Count Then Exit For\n\n        lastRow = ActiveWorkbook.Sheets(i).Cells(Rows.Count, 1).End(xlUp).Row\n\n        ActiveWorkbook.Sheets(i).Range(\"A1:O\" &amp; lastRow).CopyPicture Format:=xlPicture\n        aSlide.Shapes.Paste.Select\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1549492073, "post_id": 54563492, "comment_id": 95925922, "body": "Replace <code>C.Address</code> with <code>C.Offset(-1, 0).Value2</code> ?"}, {"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1549493325, "post_id": 54563492, "comment_id": 95926353, "body": "@chrisneilsen only the first range worked, <a href=\"https://imgur.com/a/MMdgtvb\" rel=\"nofollow noreferrer\">link</a>. But anyway, I&#39;d rather declare the range with the name I want, instead of using offset. Any ideia? Thanks for now."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1549494080, "post_id": 54563492, "comment_id": 95926623, "body": "Did you make the change for <i>both</i> uses of <code>C.Address</code>?"}, {"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1549494234, "post_id": 54563492, "comment_id": 95926671, "body": "@chrisneilsen I didn&#39;t, I forgot the other one actually. But it worked! Great! Another solution for this, like I said above, I&#39;d rather to declare the range with the name I want, instead of using offset. Any ideia for that? Thanks!!"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1549494304, "post_id": 54563492, "comment_id": 95926691, "body": "You might be able to use &quot;Named Range&quot; &#39;s instead of addresses.  But there is still two cells involved for each field. You could could use two named cells for each field I suppose, but an Offset seems simpler to me."}, {"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1549494801, "post_id": 54563492, "comment_id": 95926828, "body": "Yes, but I&#39;ve got other sheets with some much more cells instead of just two named. This was just for example. That&#39;s why I&#39;d rather be declare them. Can you tell me how should I do? Because what if I have 10 range? How should I write? Thanks."}, {"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1549496293, "post_id": 54563492, "comment_id": 95927277, "body": "@urdearboy thanks for the reply, how can I call them by name? I tried with  <code>Worksheets.Names</code>, but I couldnt do it. Can you help me please?"}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549500100, "post_id": 54564360, "comment_id": 95928205, "body": "Almost did what I wanted! The MsgBox still is showing name offset cell <code>MsgStr = MsgStr &amp; &quot;, &quot; &amp; nm.RefersToRange.Offset(-1, 0).Value2</code>, I also noticed that Name Manager must not contain any space, so the MsgBox would be something like &quot;Field1_Required&quot; instead of &quot;Fiel 1 Required is empty&quot; (it&#39;s more presentable for the client you know?).  That&#39;s what I wanted though, a beautiful message instead with underline in it."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549508386, "post_id": 54564360, "comment_id": 95929835, "body": "I wrote it to use offset because <i>I</i> believe that to be a better solution.   But as I said in my answer you could have two named ranges for each field.  Secondly, the message would show the text in the header cell, not the name given to the named range"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1549497176, "creation_date": 1549497176, "answer_id": 54564360, "question_id": 54563492, "link": "https://stackoverflow.com/questions/54563492/excel-vba-single-message-box-for-all-empty-cells/54564360#54564360", "title": "Excel VBA single message box for all empty cells", "body": "<p>Here's an approach using \" Named Range\" 's.</p>\n\n<p>Set up your names in the \"Name Manager\".  You could either use one Name for each field, and ensure the heading is always offset at a specific place (eg previous row, same column), or use two Names for each field (in which case the header can be anywhere - much more difficult to maintan in my opinion)</p>\n\n<p>Better still, use a specific format for the Names so you don't have to manage the Fields in two places (Name Manager and Code)</p>\n\n<p>I've used Names formatted as \"Field#_Required\".  Set up in Name Manager like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/FEfDv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FEfDv.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then this code will process all Workbook scoped Named Ranges looking for Names with the format \"Field*_Required\" that refer to a range on the specified sheet.  Headers are assumed to be in the same column, previous row.</p>\n\n<pre><code>Sub Demo()\n    Dim ws As Worksheet\n    Dim nm As Name\n    Dim MsgStr As String\n    Dim LastComma As Long\n\n    Set ws = Worksheets(\"YourForm\")  ' set to the Form sheet\n\n    ' Check every named range\n    For Each nm In ActiveWorkbook.Names\n        If nm.Name Like \"Field*_Required\" Then\n            If nm.RefersToRange.Worksheet Is ws Then\n                If IsEmpty(nm.RefersToRange.Value2) Then\n                    MsgStr = MsgStr &amp; \", \" &amp; nm.RefersToRange.Offset(-1, 0).Value2\n                End If\n            End If\n        End If\n    Next\n\n    If MsgStr &lt;&gt; vbNullString Then\n        MsgStr = Mid$(MsgStr, 3) ' strip leading \", \"\n        LastComma = InStrRev(MsgStr, \",\")\n        If LastComma &gt; 0 Then\n            MsgStr = Left$(MsgStr, LastComma - 1) &amp; _\n                     Replace$(MsgStr, \",\", \" and\", LastComma, 1)\n        End If\n        MsgStr = MsgStr &amp; \" cell\" &amp; IIf(LastComma &gt; 0, \"s are\", \" is\") &amp; \" empty\"\n        MsgBox MsgStr, vbCritical + vbOKOnly, \"Missing Fields!\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549583747, "post_id": 54566516, "comment_id": 95965186, "body": "It seems like your example must work it better! I made some research about dictionary (I&#39;ve never use before), but I don&#39;t know how to do it. Can you help me please? How do I call them on the loop for example? Can you send me a code? Really thanks for the tips for now."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549768146, "post_id": 54566516, "comment_id": 96019941, "body": "Sorry for the delay. I was travelling. Now I have added some code to my answer which should help you on your way."}, {"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549804846, "post_id": 54566516, "comment_id": 96026457, "body": "Great explanation! It&#39;s seem a little bit complicated about dict. I printed the result, but it doesn&#39;t show only the &quot;black field&quot;, and where should I put the Msgbox? Also, I didn&#39;t understand the last part &quot;Private Function&quot;. Just to register in this question and for me to learn, can you make an example with we use array instead of dict? Thanks for your time!!"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549862208, "post_id": 54566516, "comment_id": 96040991, "body": "It seems complicated because you didn&#39;t master it. The key is the Excel table where you keep the texts. This you need to fully understand! Next, run the proc CreateDict. Enable the line <code>Debug.Print Arr(R, 1), Join(DictVal, &quot;|&quot;)</code> to help you understand what&#39;s being done. Observe that <code>Arr = Worksheets(&quot;Dict&quot;).Range(&quot;A2:E5&quot;).Value</code> creates an array which you might use directly. In my example it is used to feed into the dictionary."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549862818, "post_id": 54566516, "comment_id": 96041143, "body": "Another key to understand my solution is that each dictionary&#39;s <i>Key</i>  has one &quot;translation&quot;. In my solution the &quot;translation&quot; is an array which can have any number of values. I have given them numbers and then named the numbers (in the Enum). The utility function as the bottom returns the array element you specify. At the bottom of <code>CreateDict</code> there is a test printout. Replace <code>Debug.Print DictVal(NdaAddress), DictVal(NdaCaption)</code> etc with  <code>Debug.Print DictItem(Dict(Key), NdaAddress), DictItem(Dict(Key), NdaCaption)</code> for a demonstration."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549863307, "post_id": 54566516, "comment_id": 96041285, "body": "I don&#39;t understand &quot;only the black field&quot;. In your project you might reconfigure <code>CreateDict</code> as a function to return a the entire dictionary as a variable to your <code>Main</code> proc. You could then use the function <code>DictItem</code> to construct any MsgBox you want using the numbered elements."}, {"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549926577, "post_id": 54566516, "comment_id": 96072919, "body": "Well, I couldn&#39; do it. This method is too hard,omg!! But the fact is, I need the msgbox to work with the name that I want to give, and not the range of it. And this solution you gave, I wasn&#39;t able to do it all by myself ):  Do you want me to send the sheet for example, or can you send me the code ready? PLEASE!!"}, {"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549926611, "post_id": 54566516, "comment_id": 96072931, "body": "The code that I have, it worked! But with the name of the range (not the way I want)."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549935849, "post_id": 54566516, "comment_id": 96075045, "body": "I think you made some headway and came to a new problem, perhaps implementation. Close this thread and start a new one from the position you are now at."}, {"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "edited": false, "score": 0, "creation_date": 1549936656, "post_id": 54566516, "comment_id": 96075197, "body": "Really thanks for your time! But my question was exactly the same, there&#39;s not point to close this thread. I would like to make my MsgBox better, that&#39;s it. My code works, but I need help. Have a great week (:"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": -1, "last_activity_date": 1549770057, "last_edit_date": 1549770057, "creation_date": 1549515262, "answer_id": 54566516, "question_id": 54563492, "link": "https://stackoverflow.com/questions/54563492/excel-vba-single-message-box-for-all-empty-cells/54566516#54566516", "title": "Excel VBA single message box for all empty cells", "body": "<p>Named ranges aren't the solution here. You want to enter \"E23\" and return \"Celular\". That is a dictionary's job. If you don't want to set up a dictionary a simple array might do, like</p>\n\n<pre><code>Dim Dict(1,10) As Variant\nDict(0, 0) = \"E23\"\nDict(1, 0) = \"Celular\"\nDict(0, 1) = \"C17\"\nDict 1, 1) = [Whatever]\n</code></pre>\n\n<p>If <code>Dict</code> were a dictionary you could call \"Celular\" by the name of \"E23\". If it's an array, as above, you can use an Enum to define its position in the array by another name.</p>\n\n<p>Edit Feb 10, 2019 ======================\nI set up a worksheet called \"Dict\" <a href=\"https://i.stack.imgur.com/0gOXH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0gOXH.png\" alt=\"like this\"></a>.</p>\n\n<p>Now you can run code like below. Remember, however, that you need to set a reference to MS Scripting Runtime.</p>\n\n<pre><code>Option Explicit\n\nEnum Nda                                ' Dictionary array\n    NdaAddress\n    NdaCaption\n    NdaCapCell\n    NdaTip\nEnd Enum\n\nSub CreateDict()\n    ' https://excelmacromastery.com/vba-dictionary/\n\n    Dim Dict As Scripting.Dictionary\n    Dim Arr As Variant\n    Dim R As Long, C As Long\n    Dim DictVal() As String\n\n    Set Dict = New Scripting.Dictionary\n    Arr = Worksheets(\"Dict\").Range(\"A2:E5\").Value\n    For R = 1 To UBound(Arr)\n        ReDim DictVal(1 To UBound(Arr, 2) - 1)\n        For C = 2 To UBound(Arr, 2)\n            DictVal(C - 1) = Arr(R, C)\n        Next C\n'        Debug.Print Arr(R, 1), Join(DictVal, \"|\")\n        Dict.Add Arr(R, 1), Join(DictVal, \"|\")\n    Next R\n\n    Dim Key As Variant\n    For Each Key In Dict.Keys\n        Debug.Print Key,\n        DictVal = Split(Dict(Key), \"|\")\n        Debug.Print DictVal(NdaAddress), DictVal(NdaCaption), DictVal(NdaCapCell), DictVal(NdaTip)\n    Next Key\nEnd Sub\n</code></pre>\n\n<p>The idea is that the Key \"Tel\" will give you the address of the cell, the adress of the caption cell, the caption itself and a control tip. Add or reduce as desired/required. Consider using a small utility function to retrieve the part you want.</p>\n\n<pre><code>Debug.Print DictItem(Dict(\"Name\"), NdaCaption)\nPrivate Function DictItem(DictKey As String, _\n                          Itm As Nda) As String\n    DictItem = Split(DictKey, \"|\")(Itm)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 54564360, "answer_count": 2, "score": 0, "last_activity_date": 1549770057, "creation_date": 1549491809, "last_edit_date": 1549524479, "question_id": 54563492, "link": "https://stackoverflow.com/questions/54563492/excel-vba-single-message-box-for-all-empty-cells", "title": "Excel VBA single message box for all empty cells", "body": "<p>I am trying to return the \"titles\" of the cells and not the address of all cells that are empty in the range below, or in the form below aswell.\nI would like to display a single message box listing all the returned titles of the cells (I gave the titles above the cells) if there are any.</p>\n\n<p>So, instead of <code>Range(\"C17, E23\")</code>, I'd like to show the title of the cell.\nExample:\nRange (\"C17\") = \"Nome/Raz\u00e3o Social\"\nRange (\"E23\") = \"Celular\"</p>\n\n<p>Range and title of the cells: <a href=\"https://imgur.com/a/V9qU5Zb\" rel=\"nofollow noreferrer\">https://imgur.com/a/V9qU5Zb</a></p>\n\n<p>Code run perfect, but I'd like to improve like I said above.</p>\n\n<p>Code running: <a href=\"https://imgur.com/a/MMdgtvb\" rel=\"nofollow noreferrer\">https://imgur.com/a/MMdgtvb</a></p>\n\n<p>Thanks!</p>\n\n<pre><code>\nDim C As Range\nDim MsgStr As String\nDim rng As Range\n\n\n'Define which cell must not be empty in the range below\nSet rng = Planilha4.Range(\"C17, E23\")\n\n'Check every cell in the range\nFor Each C In rng\n    If C.Value2 = \"\" Then\n        If MsgStr = \"\" Then\n            MsgStr = C.Address(False, False)\n        Else\n            MsgStr = MsgStr &amp; \",\" &amp; C.Address(False, False)\n        End If\n    End If\nNext C\n\nDim lLastComma As Long: lLastComma = InStrRev(MsgStr, \",\")\nIf lLastComma &gt; 0 Then: MsgStr = Left(MsgStr, lLastComma - 1) &amp; Replace(MsgStr, \",\", \" and \", lLastComma, 1)\nMsgBox MsgStr &amp; \" cell\" &amp; IIf(lLastComma &gt; 0, \"s are \", \" is \") &amp; \"empty\"\n\n'MsgBox MsgStr &amp; \" cells are empty\", vbExclamation\n\nEnd Sub\n\n\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1549492462, "post_id": 54563482, "comment_id": 95926062, "body": "The presence of duplicates on <code>Price</code> and <code>Date</code> is likely going to make this extremely difficult (if not impossible) with Access SQL.  Have you considered a VBA function?"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1549494479, "post_id": 54563607, "comment_id": 95926743, "body": "But if you add another R record with -10  on 2/2/2016 it will not mark the new line or ID 4 as true.  This only works on the first credit and first refund on the given day, that may work for the OP.  This is an FYI not criticism as it may be okay, there may never be a second refund on the same day with two charges."}, {"owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1549494730, "post_id": 54563607, "comment_id": 95926808, "body": "Yes this is the case were only 1 pair with opposite prices at the same day will be updated. I don&#39;t know if this does not cover the requirements."}], "tags": [], "owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "is_accepted": false, "score": 1, "last_activity_date": 1549493631, "last_edit_date": 1549493631, "creation_date": 1549492527, "answer_id": 54563607, "question_id": 54563482, "link": "https://stackoverflow.com/questions/54563482/select-pair-of-records-in-same-table-sql/54563607#54563607", "title": "Select pair of records in same table SQL", "body": "<p>With <code>EXISTS</code>:</p>\n\n<pre><code>UPDATE RECORDS AS T \nSET T.Processed = TRUE\nWHERE \n  (T.Type IN ('C', 'R') AND\n    EXISTS (SELECT 1 FROM RECORDS \n      WHERE Type IN ('C', 'R') AND Type &lt;&gt; T.Type AND Date = T.Date AND Price + T.Price = 0\n    )\n  )\n  AND T.Id = (SELECT MIN(ID) FROM RECORDS WHERE Date = T.Date AND Price = T.Price AND Type = T.Type)\n</code></pre>\n\n<p>The last condition in <code>WHERE</code> covers the case of duplicates in the columns <code>Price</code>,  <code>Date</code> and <code>Type</code>.<br/>\nResults:</p>\n\n<pre><code>Id  Type    Price   Date        Processed\n1   C       30,00   1/1/2016    True\n2   R       -30,00  1/1/2016    True\n3   C       10,00   2/2/2016    True\n4   C       10,00   2/2/2016    NULL\n5   R       -10,00  2/2/2016    True\n6   C       25,00   3/2/2016    NULL\n7   C       42,00   4/2/2016    NULL\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9686541, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sergiu Nastase", "link": "https://stackoverflow.com/users/9686541/sergiu-nastase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549503915, "creation_date": 1549491770, "last_edit_date": 1549492184, "question_id": 54563482, "link": "https://stackoverflow.com/questions/54563482/select-pair-of-records-in-same-table-sql", "title": "Select pair of records in same table SQL", "body": "<p>I have a Access table called RECORDS with purchase records.   </p>\n\n<pre><code>   Id   | Type |  Price  |     Date    |  Processed  |\n------------------------------------------------------\n   1    |  C   |   30\u20ac   |  01/01/2016 |    Null     |\n------------------------------------------------------\n   2    |  R   |  -30\u20ac   |  01/01/2016 |    Null     |\n------------------------------------------------------\n   3    |  C   |   10\u20ac   |  02/02/2016 |    Null     |\n------------------------------------------------------\n   4    |  C   |   10\u20ac   |  02/02/2016 |    Null     |\n------------------------------------------------------\n   5    |  R   |  -10\u20ac   |  02/02/2016 |    Null     |\n------------------------------------------------------\n   6    |  C   |   25\u20ac   |  03/02/2016 |    Null     |\n------------------------------------------------------\n   7    |  C   |   42\u20ac   |  04/02/2016 |    Null     |\n------------------------------------------------------\n</code></pre>\n\n<p>What I want to do is to set True the charge (Type 'C') records who have an opposite pair of refund record (Type 'R'). </p>\n\n<p><strong>Like this:</strong> 1C and 1R = True</p>\n\n<pre><code>   Id   | Type |  Price  |     Date    |  Processed  |\n------------------------------------------------------\n   1    |  C   |   30\u20ac   |  01/01/2016 |    True     |\n------------------------------------------------------\n   2    |  R   |  -30\u20ac   |  01/01/2016 |    True     |\n------------------------------------------------------\n   3    |  C   |   10\u20ac   |  02/02/2016 |    True     |\n------------------------------------------------------\n   4    |  C   |   10\u20ac   |  02/02/2016 |    Null     |\n------------------------------------------------------\n   5    |  R   |  -10\u20ac   |  02/02/2016 |    True     |\n-----------------------------------------------------\n   6    |  C   |   25\u20ac   |  03/02/2016 |    Null     |\n------------------------------------------------------\n   7    |  C   |   42\u20ac   |  04/02/2016 |    Null     |\n------------------------------------------------------\n</code></pre>\n\n<p>So far I have this but it sets True all the N charge 'C' records </p>\n\n<pre><code>UPDATE \nRECORDS AS T1 \nINNER JOIN RECORDS T2 \nON ABS(T1.Price) = ABS(T2.Price) AND T1.Date =T2.Date \nSET T1.Processed = TRUE\nWHERE (T1.Type = 'C' AND T2.Type = 'R') OR (T1.Type = 'R' AND T2.Type = 'C')\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1549491841, "post_id": 54563319, "comment_id": 95925840, "body": "<i>&quot;currently I get a macro error. &quot;</i> - what is the error and on what line?"}, {"owner": {"reputation": 1744, "user_id": 10600584, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/319eb863cdc0db2dd90b533b742f8738?s=128&d=identicon&r=PG", "display_name": "FXD", "link": "https://stackoverflow.com/users/10600584/fxd"}, "edited": false, "score": 0, "creation_date": 1549501339, "post_id": 54563319, "comment_id": 95928462, "body": "If you have put <code>Private Sub Worksheet_Change(ByVal Target As Range)</code> twice in the same worksheet, it won&#39;t work. Rename them to e.g. <code>Private Sub Worksheet_Change1(ByVal Target As Range)</code> and <code>Private Sub Worksheet_Change2(ByVal Target As Range)</code> and make the <code>Private Sub Worksheet_Change(ByVal Target As Range)</code> simply call them both."}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1549513337, "last_edit_date": 1549513337, "creation_date": 1549509716, "answer_id": 54565818, "question_id": 54563319, "link": "https://stackoverflow.com/questions/54563319/combine-two-private-sub-worksheet-changebyval-target-as-range/54565818#54565818", "title": "Combine two &quot;Private Sub Worksheet_Change(ByVal Target As Range)&quot;", "body": "<p>You can only have one <code>Worksheet_Change</code> event per sheet. A simple work around is to turn your two <code>Events</code> into <code>Sub Procedures</code> and then create a master <code>Event</code> that simply calls both of your other subs. </p>\n\n<p>The set up will look something like this</p>\n\n<hr>\n\n<h2>Event</h2>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    AddDate Target\n    Dropdown Target\nEnd Sub\n</code></pre>\n\n<h2>Sub Procedure 1</h2>\n\n<pre><code>Sub AddDate (Target as Range)\n    'Your first code goes here\nEnd Sub\n</code></pre>\n\n<h2>Sub Procedure 2</h2>\n\n<pre><code>Sub Dropdown (Target as Range)\n    'Your second code goes here\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I would personally set up your validations in the <code>Event</code> and call your procedures accordingly. Then your subs can strictly focus on the action statements rather needing to do any validation. </p>\n\n<p>That may look something like this (notice all of your range variables are already initiated and no longer need to be declared)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n'DateAdd Validation\nDim WorkRng As Range\nSet WorkRng = Intersect(Application.ActiveSheet.Range(\"O:O\"), Target)\n\nIf Not WorkRng Is Nothing Then\n    DateAdd Target, WorkRng\nEnd If\n\n'Dropdown Validation\nDim rngDV As Range\nSet rngDV = Cells.SpecialCells(xlCellTypeAllValidation)\n\nIf Target.Count = 1 Then\n    If Not rngDV Is Nothing Then '&lt;-- I believe this is redundant\n        If Not Intersect(Target, rngDV) Is Nothing Then\n            Dropdown Target, rngDV\n        End If\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<pre><code>Sub DateAdd(Target As Range, WorkRng As Range)\n\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<pre><code>Sub Dropdown(Target As Range, rngDV As Range)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11024905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e0d8dcf3dd4759770ca84e4c685565?s=128&d=identicon&r=PG&f=1", "display_name": "TomCDubs", "link": "https://stackoverflow.com/users/11024905/tomcdubs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1300, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1549513337, "creation_date": 1549490871, "question_id": 54563319, "link": "https://stackoverflow.com/questions/54563319/combine-two-private-sub-worksheet-changebyval-target-as-range", "title": "Combine two &quot;Private Sub Worksheet_Change(ByVal Target As Range)&quot;", "body": "<p>I have the following two codes in my sheet, and I want them both to run - currently I get a macro error. Could you help me to combine them so that they both run??</p>\n\n<p>One enters the date in an adjacent cell when data is entered, the other allows multiple selections from a dropdown list. Both work individually.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim WorkRng As Range\nDim Rng As Range\nDim xOffsetColumn As Integer\nSet WorkRng = Intersect(Application.ActiveSheet.Range(\"O:O\"), Target)\nxOffsetColumn = 1\nIf Not WorkRng Is Nothing Then\n    Application.EnableEvents = False\n    For Each Rng In WorkRng\n        If Not VBA.IsEmpty(Rng.Value) Then\n            Rng.Offset(0, xOffsetColumn).Value = Now\n            Rng.Offset(0, xOffsetColumn).NumberFormat = \"dd/mm/yyyy\"\n        Else\n            Rng.Offset(0, xOffsetColumn).ClearContents\n        End If\n    Next\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>And the other code is:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim rngDV As Range\nDim oldVal As String\nDim newVal As String\nIf Target.Count &gt; 1 Then GoTo exitHandler\n\nOn Error Resume Next\nSet rngDV = Cells.SpecialCells(xlCellTypeAllValidation)\nOn Error GoTo exitHandler\n\nIf rngDV Is Nothing Then GoTo exitHandler\n\nIf Intersect(Target, rngDV) Is Nothing Then\n   'do nothing\nElse\n  Application.EnableEvents = False\n  newVal = Target.Value\n  Application.Undo\n  oldVal = Target.Value\n  Target.Value = newVal\n  If Target.Column = 10 _\n     Or Target.Column = 12 Then\n    If oldVal = \"\" Then\n       'do nothing\n      Else\n      If newVal = \"\" Then\n      'do nothing\n      Else\n      Target.Value = oldVal _\n    &amp; \", \" &amp; newVal\n'      NOTE: you can use a line break,\n'      instead of a comma\n'      Target.Value = oldVal _\n'        &amp; Chr(10) &amp; newVal\n      End If\n    End If\n  End If\nEnd If\n\nexitHandler:\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Many thanks </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 168, "user_id": 6619157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpzjW.png?s=128&g=1", "display_name": "Wilhelm", "link": "https://stackoverflow.com/users/6619157/wilhelm"}, "edited": false, "score": 0, "creation_date": 1549491277, "post_id": 54563251, "comment_id": 95925656, "body": "Your friend will be the split function: Dim mystring() - myString() = split(cel.value,&quot;_&quot;) - MyString will have at least one value myString(0) if there is no underscrore in the text. Or it has more values - one for each part where underscore was found."}, {"owner": {"reputation": 11, "user_id": 7495931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97da49c85ea86f2b9aaba4b4f12c4c35?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/7495931/josh"}, "reply_to_user": {"reputation": 168, "user_id": 6619157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpzjW.png?s=128&g=1", "display_name": "Wilhelm", "link": "https://stackoverflow.com/users/6619157/wilhelm"}, "edited": false, "score": 0, "creation_date": 1549627640, "post_id": 54563251, "comment_id": 95980326, "body": "Thank you for the response and help, I really appreciate it! The only problem is that I am having issues putting the string back together. The code below works perfectly to break the delimiter into another cell, but what if there are 2 of the same delimiters in one cell? How do I make sure that all of the text that has an underscore _ and is to the left of the : go into a specific cell?"}, {"owner": {"reputation": 11, "user_id": 7495931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97da49c85ea86f2b9aaba4b4f12c4c35?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/7495931/josh"}, "reply_to_user": {"reputation": 168, "user_id": 6619157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpzjW.png?s=128&g=1", "display_name": "Wilhelm", "link": "https://stackoverflow.com/users/6619157/wilhelm"}, "edited": false, "score": 0, "creation_date": 1549627771, "post_id": 54563251, "comment_id": 95980416, "body": "So that if this is in cell A -&gt; Hello_World:Hi Josh Hello_OverStack:Hi Mom. The Hello_World and Hello_OverStack go into column B and Hi Josh and Hi Mom go into column C?"}, {"owner": {"reputation": 11, "user_id": 7495931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97da49c85ea86f2b9aaba4b4f12c4c35?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/7495931/josh"}, "reply_to_user": {"reputation": 168, "user_id": 6619157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpzjW.png?s=128&g=1", "display_name": "Wilhelm", "link": "https://stackoverflow.com/users/6619157/wilhelm"}, "edited": false, "score": 0, "creation_date": 1549627795, "post_id": 54563251, "comment_id": 95980430, "body": "Thank you again for your help"}, {"owner": {"reputation": 11, "user_id": 7495931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97da49c85ea86f2b9aaba4b4f12c4c35?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/7495931/josh"}, "reply_to_user": {"reputation": 168, "user_id": 6619157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpzjW.png?s=128&g=1", "display_name": "Wilhelm", "link": "https://stackoverflow.com/users/6619157/wilhelm"}, "edited": false, "score": 0, "creation_date": 1549628182, "post_id": 54563251, "comment_id": 95980654, "body": "Finally, I want to keep all of the text to the left of the : in 1 cell"}], "answers": [{"tags": [], "owner": {"reputation": 800, "user_id": 6310948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d0VKq.jpg?s=128&g=1", "display_name": "Erjon", "link": "https://stackoverflow.com/users/6310948/erjon"}, "is_accepted": false, "score": 0, "last_activity_date": 1549494330, "last_edit_date": 1549494330, "creation_date": 1549491721, "answer_id": 54563474, "question_id": 54563251, "link": "https://stackoverflow.com/questions/54563251/i-am-having-issues-looping-through-my-vba-code-and-putting-the-correct-variable/54563474#54563474", "title": "I am having issues looping through my VBA code and putting the correct variable in specific cells", "body": "<p>first of all can you show a column with your data and a column with the desired result so I can make a try?</p>\n\n<p>Second:</p>\n\n<pre><code>ws.range(\"I7:I500\").Select\n</code></pre>\n\n<p>will slow down your macro, instead you can use:</p>\n\n<pre><code>ws.range(\"I7:I500\").TextToColumns _\n    Destination:=range(\"L7:L500\"), _\n    DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, _\n    ConsecutiveDelimiter:=False, _\n    Tab:=True, _\n    Semicolon:=False, _\n    comma:=False, _\n    Space:=True, _\n    Other:=True, _\n    OtherChar:=\":\"\n</code></pre>\n\n<p>But anyway if you want to put some words with \"_\" in a range and other in another range you can use a loop, it is more easy to do and understand.</p>\n\n<p>For example if you want to split the words with \"_\" then you can use something like this</p>\n\n<pre><code>Dim cell As Range\n\nFor Each cell In Range(\"L7:L500\").Cells\nIf InStr(cell, \"_\") &gt; 0 Then\n   cell.Offset(0, 1) = Left(cell, WorksheetFunction.Find(\"_\", cell))\n   cell.Offset(0, 2) = Right(cell, Len(cell) -WorksheetFunction.Find(\"_\",cell))\nElse\n   cell.Offset(0, 3) = cell\nEnd If\nNext cell \n</code></pre>\n\n<p>and if we suppose that the column L is with a word like \"Hello_World\" then in the column M you will have \"Hello_\" and in the column N you will have \"World\", the next column will have all those words that dont have any \"_\"</p>\n"}], "owner": {"reputation": 11, "user_id": 7495931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97da49c85ea86f2b9aaba4b4f12c4c35?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/7495931/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1549494330, "creation_date": 1549490526, "question_id": 54563251, "link": "https://stackoverflow.com/questions/54563251/i-am-having-issues-looping-through-my-vba-code-and-putting-the-correct-variable", "title": "I am having issues looping through my VBA code and putting the correct variable in specific cells", "body": "<p>I am a little new to VBA</p>\n\n<p>How the macro works is when someone inputs in the error child_variations.color: Update attribution to reflect the correct data or more than 1 of these errors into a cell. The macro will split in the string at the colon into separate cells (that part of the macro is working correctly). Then the macro needs to loop through each cell and if the string in the cell contains an underscore (<em>) then that string is saved in a variable and is put into a cell. If the string does not contain an underscore (</em>), then it is saved into a different variable.</p>\n\n<p>The issue that I am having is putting the string together into separate cells. I want to put all of the text that is on the left of the colon into one string and one cell. I also want to put the text that is right of the colon in another string and cell. I have tried to use the loop and the if statements below, but all of the text to the left and right of the colon is being put into the same cell. </p>\n\n<p>Below I have before along with how the cells are supposed to look in the spreadsheet.</p>\n\n<p>Before\nchild_variations.color:Update attribution to reflect the correct data.\ndigital_assets.images.primary_image_url:Primary image does not align with alternate image(s).</p>\n\n<p>How it should look\nchild_variations.color  Update attribution to reflect the correct data.</p>\n\n<p>Any help that you can give to me would help out greatly! </p>\n\n<pre><code>        Sub delimted()\n     Dim ws As Worksheet\n     Dim cel As range\n     Dim str As String\n     Dim str_is_blank As String\n     Dim my_range As range\n     Dim no_of_rows As Long\n     Dim i As Long\n     Dim str_with_special_char As String\n     Set my_range = Sheets(\"Setup\").range(\"L7:Z500\")\n     no_of_rows = my_range.Rows.Count\n     Set ws = ThisWorkbook.Sheets(\"Setup\")\n     ws.range(\"I7:I500\").Select\n    Selection.TextToColumns _\n        Destination:=range(\"L7:L500\"), _\n        DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, _\n        ConsecutiveDelimiter:=False, _\n        Tab:=True, _\n        Semicolon:=False, _\n        comma:=False, _\n        Space:=True, _\n        Other:=True, _\n        OtherChar:=\":\"\n  For Each cel In my_range.Cells\n        If InStr(cel.Value, \"_\") &gt; 0 Then\n                str_with_special_char = str_with_special_char &amp; \" \" &amp; cel.Value\n                range(\"I7\").Value = str_with_special_char\n        ElseIf Not InStr(cel.Value, \"_\") Then\n            str = str &amp; \" \" &amp; cel.Value\n            range(\"J7\").Value = str\n        ElseIf IsEmpty(cel.Value) Then\n            str_is_blank = str_is_blank &amp; cel.Value\n        End If\nNext cel\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 1, "creation_date": 1549495537, "post_id": 54563165, "comment_id": 95927057, "body": "If you don&#39;t have a procedure named <code>pfPositionCursor</code> then of course you can&#39;t call it. Also, &quot;placing the cursor&quot; in a TextBox means that the next Input from the keyboard will be at that position, and as that is in that TextBox , the TextBox has the focus. For controls, &quot;having the focus&quot; and &quot;the next keystroke affects this control&quot; are equivalent."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1549498139, "post_id": 54563165, "comment_id": 95927776, "body": "What event is this code in? I use Click, Enter, GotFocus of the control to be acted on. Can&#39;t input to a locked control."}, {"owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "edited": false, "score": 0, "creation_date": 1549513295, "post_id": 54563165, "comment_id": 95930800, "body": "This code is on onOpen form event"}], "answers": [{"tags": [], "owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "is_accepted": false, "score": 0, "last_activity_date": 1549517620, "creation_date": 1549517620, "answer_id": 54566904, "question_id": 54563165, "link": "https://stackoverflow.com/questions/54563165/how-to-set-the-cursor-to-the-end-of-the-text-box-without-losing-the-setfocus/54566904#54566904", "title": "How to set the cursor to the end of the text box without losing the setfocus?", "body": "<p>You can pass a control in a function for example:</p>\n\n<pre><code>Call ControlFocusFunction(Me!MyTextbox)\n\n\nPublic Function TextBoxFocusFunction(ctlControl as Control)\n\n  If ctlControl.ControlType = acTextBox Then\n\n    ctlControl.SetFocus\n    ctlControl.SelStart(Len(ctlControl.Text))\n\n  End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549517620, "creation_date": 1549490219, "last_edit_date": 1549511865, "question_id": 54563165, "link": "https://stackoverflow.com/questions/54563165/how-to-set-the-cursor-to-the-end-of-the-text-box-without-losing-the-setfocus", "title": "How to set the cursor to the end of the text box without losing the setfocus?", "body": "<p>I am using this code to set the focus on the end of the text box in a form but I can only do so if I set the focus to that text box which is at the middle of my form. I have setup tab control and I want the focus to be at the first text box.</p>\n\n<p>My code is:</p>\n\n<pre><code>        Me.txtBox.Locked = True\n        Me.txtBox.SetFocus\n        Me.txtBox.SelStart = Len(Me.txtBox.Text)\n</code></pre>\n\n<p>I tried add this after the code above to set the focus to first text box again.</p>\n\n<pre><code>pfPositionCursor Me.txtBox1\n</code></pre>\n\n<p>But I get sub or function undefined on <code>pfPositionCursor</code></p>\n\n<p>Is there a way to do something like this?</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1549524320, "post_id": 54563082, "comment_id": 95934458, "body": "Can you please add the result of <code>Debug.Print getSQLString</code> so we can see which date and which format the date actually is? \u2022 Also note that in <code>where (((tblitemhistory.HistDate)  between</code> you open 3 parenthesis but you only close one. So either your code is incomplete or invalid."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1549569007, "post_id": 54563082, "comment_id": 95959443, "body": "PEH that&#39;s probably it, along with the 3 double-quotes at the end."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11025384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158105089694409/picture?type=large", "display_name": "Troy Richert", "link": "https://stackoverflow.com/users/11025384/troy-richert"}, "edited": false, "score": 0, "creation_date": 1549491118, "post_id": 54563213, "comment_id": 95925599, "body": "Thank you for the suggestion but I get the same result when I run the code."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "reply_to_user": {"reputation": 11, "user_id": 11025384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158105089694409/picture?type=large", "display_name": "Troy Richert", "link": "https://stackoverflow.com/users/11025384/troy-richert"}, "edited": false, "score": 0, "creation_date": 1549493948, "post_id": 54563213, "comment_id": 95926571, "body": "Does the query return anything if you replace <code>&quot; &amp; [SDATE] &amp; &quot;</code> and <code>&quot; &amp; [EDATE] &amp; &quot;</code> with hard-coded values in the <code>&quot;MM-DD-YY&quot;</code> format?"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "reply_to_user": {"reputation": 11, "user_id": 11025384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158105089694409/picture?type=large", "display_name": "Troy Richert", "link": "https://stackoverflow.com/users/11025384/troy-richert"}, "edited": false, "score": 1, "creation_date": 1549494090, "post_id": 54563213, "comment_id": 95926627, "body": "I&#39;m wondering, also, why you&#39;ve got this in there: <code>getSQLString = SQLstring</code>, it doesn&#39;t do anything.  A bit of a red herring."}, {"owner": {"reputation": 11, "user_id": 11025384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158105089694409/picture?type=large", "display_name": "Troy Richert", "link": "https://stackoverflow.com/users/11025384/troy-richert"}, "edited": false, "score": 0, "creation_date": 1549540788, "post_id": 54563213, "comment_id": 95943401, "body": "Hard coding the dates returns no results either. Something has to be goofy with my &quot;where&quot; statement in general...... getSQLString = SQLstring.... higher up in my code, I&#39;m calling &quot;getSQLstring&quot; which goes to my Function and ultimately the SQL statement.  It allows me to use the same bit of code for the connection(s) and formatting and I only need to worry about changing pieces of the Function for different applications.  I can post the entire code if you think it would help."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "reply_to_user": {"reputation": 11, "user_id": 11025384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158105089694409/picture?type=large", "display_name": "Troy Richert", "link": "https://stackoverflow.com/users/11025384/troy-richert"}, "edited": false, "score": 0, "creation_date": 1549568890, "post_id": 54563213, "comment_id": 95959381, "body": "Updated, I didn&#39;t look closely at your query.  MS likes to add a bunch of parens when you&#39;re using a query builder and it can make it pretty confusing to look at.  I make a habit of eliminating them, just for this reason."}], "tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 0, "last_activity_date": 1549568810, "last_edit_date": 1549568810, "creation_date": 1549490374, "answer_id": 54563213, "question_id": 54563082, "link": "https://stackoverflow.com/questions/54563082/why-does-my-where-statement-return-no-results/54563213#54563213", "title": "Why does my where statement return no results?", "body": "<p>Try removing the brackets from [SDATE] and [EDATE].  This is SQL syntax, not VBA syntax.  </p>\n\n<p>You might consider revising your format to mm/dd/yyyy, regional interpretation of dates may be causing you headaches.</p>\n\n<p>See this:</p>\n\n<p><a href=\"https://bytes.com/topic/access/insights/575420-literal-datetimes-their-delimiters\" rel=\"nofollow noreferrer\">https://bytes.com/topic/access/insights/575420-literal-datetimes-their-delimiters</a></p>\n\n<p>**Edit **</p>\n\n<p>I just realized you're not terminating all these parens:  <code>(((tblitemhistory.HistDate)</code>.  You don't need any of them.  Also, Having 3 quotes at the end adds a quote to the end of your query that you probably don't want, try <code>\"where tblitemhistory.HistDate BETWEEN #\" &amp; SDATE &amp; \"# AND #\" &amp; EDATE &amp; \"#\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11025384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158105089694409/picture?type=large", "display_name": "Troy Richert", "link": "https://stackoverflow.com/users/11025384/troy-richert"}, "edited": false, "score": 0, "creation_date": 1549580152, "post_id": 54583236, "comment_id": 95964103, "body": "Wow Parfait, you are above my pay grade!  :-) I don&#39;t quite understand. If I were to post my entire code, would you be willing to tweak it?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 11, "user_id": 11025384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158105089694409/picture?type=large", "display_name": "Troy Richert", "link": "https://stackoverflow.com/users/11025384/troy-richert"}, "edited": false, "score": 1, "creation_date": 1549582455, "post_id": 54583236, "comment_id": 95964871, "body": "The idea is you tweak this for your final solution. Essentially, it queries an Access database binding data values to parameters and dumps results into worksheet. I have comments in code to help."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1549578258, "creation_date": 1549578258, "answer_id": 54583236, "question_id": 54563082, "link": "https://stackoverflow.com/questions/54563082/why-does-my-where-statement-return-no-results/54583236#54583236", "title": "Why does my where statement return no results?", "body": "<p>Possibly you are in a region that runs dates as day first as opposed to month first. Hence, whatever date ranges are entered no data exists according to that section since you do not receive any errors. </p>\n\n<p>Consequently, consider two adjustments:</p>\n\n<ol>\n<li><p>Remove any formatting and have user enter date in whatever region they are in and adjust dates from their CPU's default. </p></li>\n<li><p>Use parameterization with MS Access' <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/querydef-object-dao\" rel=\"nofollow noreferrer\">QueryDefs</a> as opposed to SQL concatenation in your VBA as shown below with a DAO connection. </p></li>\n</ol>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub RunQuery()\n    Dim SDATE As Date, EDATE As Date\n    Dim SQLstring As String\n    Dim conn As Object, db As Object, qdef As Object\n\n    SDATE = Application.InputBox(\"Beginning Date\", \"Date 1\", Date - 31)   ' REMOVE Format()\n    EDATE = Application.InputBox(\"Ending Date\", \"Date 2\", Date)           ' REMOVE Format()\n\n    Set conn = CreateObject(\"DAO.DBEngine.120\")\n    Set db = conn.OpenDatabase(\"C:\\Path\\To\\Database.accdb\")\n\n    ' PREPARED STATEMENT (NO DATA) - CAN BE SAVED IN MS ACCESS AS QUERY OBJECT\n    SQLstring = \"PARAMETERS [Prm_SDATE] Date, [Prm_EDATE] Date;\" &amp; _\n                \"SELECT i.HistDate, s.MasterPNo, s.ItemDescription,\" &amp; _\n                \"       i.HistType, i.HistText, i.HistQty \" &amp; _\n                \"FROM tblitemhistory i \" &amp; _\n                \"INNER JOIN tblstockitems s ON i.StockID = s.ItemID\" &amp; _\n                \"WHERE i.HistDate BETWEEN [Prm_SDATE] AND [Prm_EDATE];\"\n\n    ' BIND PARAMETERS\n    Set qdef = db.CreateQueryDef(\"\", SQLstring)\n    qdef![Prm_SDATE] = SDATE\n    qdef![Prm_EDATE] = EDATE\n\n    ' OPEN RECORDSET\n    Set rst = qdef.OpenRecordset\n\n    ' DUMP OUTPUT TO EXCEL SHEET\n    Worksheets(\"Sheet1\").Range(\"A1\").CopyFromRecordset rst\n\n    rst.Close: db.Close        \n    Set qdef = Nothing: Set db = Nothing: Set conn = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11025384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158105089694409/picture?type=large", "display_name": "Troy Richert", "link": "https://stackoverflow.com/users/11025384/troy-richert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1549578258, "creation_date": 1549489871, "last_edit_date": 1549523899, "question_id": 54563082, "link": "https://stackoverflow.com/questions/54563082/why-does-my-where-statement-return-no-results", "title": "Why does my where statement return no results?", "body": "<p>I'm using Excel VBA to pull in data from an Access database.  My \"Select\" and \"From\" statements work fine. When I add the \"Where\" statement, I get no results. Can you help?!</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim SDATE As String\nDim EDATE As String\nDim SQLstring As String\n\nSDATE = Application.InputBox(\"Beginning Date\", \"Date 1\", Format(Date - 31, \"MM-DD-YY\"))\nEDATE = Application.InputBox(\"Ending Date\", \"Date 2\", Format(Date, \"MM-DD-YY\"))\n\nSQLstring = \"SELECT tblitemhistory.HistDate, tblstockitems.MasterPNo, tblstockitems.ItemDescription, tblitemhistory.HistType, tblitemhistory.HistText, tblitemhistory.HistQty \" &amp; _\n            \"FROM tblitemhistory INNER JOIN tblstockitems ON tblitemhistory.StockID = tblstockitems.ItemID\" &amp; _\n            \"where (((tblitemhistory.HistDate)  between #\" &amp; [SDATE] &amp; \"# AND #\" &amp; [EDATE] &amp; \"#\"\"\"\n\ngetSQLString = SQLstring\n</code></pre>\n\n<p>I'm hoping to pull records between two dates, input by the user. I get no errors when I run the code, but I get no results either.</p>\n"}, {"tags": ["excel", "vba", "if-statement", "range"], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1549494177, "creation_date": 1549494177, "answer_id": 54563907, "question_id": 54563039, "link": "https://stackoverflow.com/questions/54563039/if-variable-range-is-3-than-do-action-else-do-other-action/54563907#54563907", "title": "If variable range is &gt; 3 than do action else do other action", "body": "<p>If your dataset is an accurate enough example, you can scan through your business units and pick out only what you need. I have some example code here that will build up your sum range by using the <code>Union</code> function and applying that to the <code>SUM</code> formula when the entire business unit has been scanned. Of course, this is only an example that fits the data shown. You'll have to expand it to fit situations that are not visible to me.</p>\n\n<p>To simplify the logic, I've separated the code into a function that will start scanning rows for a business unit and will stop when it reaches the end of the business unit -- <em>the test I'm using for detecting the start of the next BU is a line that does not start with \"PL\". This may or may not be correct for all your data.</em></p>\n\n<p>Because this code is checking each line and accumulating the sum range using the <code>Union</code>, if you only have one cell, you'll still get a formula that says <code>=SUM($D$30)</code> but it works.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim dataArea As Range\n    Set dataArea = ActiveSheet.Range(\"A1\")\n\n    Do While Not IsEmpty(dataArea.Cells(1, 1))\n        Set dataArea = AddSums(dataArea)\n    Loop\nEnd Sub\n\nPrivate Function AddSums(ByRef businessUnitStart As Range) As Range\n    '--- loops through cells following the 'Start' range given,\n    '    and accumulates the range of accounts to summarize\n    '    RETURNS the start of the next business unit range\n    Dim accountRow As Range\n    Dim account As String\n    Set accountRow = businessUnitStart.Offset(1, 0)\n\n    Dim sumArea As Range\n    Do While Left$(accountRow.Cells(1, 1).Value2, 2) = \"PL\"\n        account = accountRow.Cells(1, 1).Value2\n        If (Left$(account, 8) = \"PL211010\") Or (Left$(account, 8) = \"PL203000\") Then\n            '--- add this account to the sum formula\n            If sumArea Is Nothing Then\n                Set sumArea = accountRow.Cells(1, 4)\n            Else\n                Set sumArea = Union(sumArea, accountRow.Cells(1, 4))\n            End If\n        End If\n        Set accountRow = accountRow.Offset(1, 0)\n    Loop\n\n    If Not sumArea Is Nothing Then\n        Dim accountSum As Range\n        Set accountSum = businessUnitStart.Offset(1, 6)\n        accountSum.Formula = \"=SUM(\" &amp; sumArea.Address &amp; \")\"\n    End If\n    Set AddSums = accountRow\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 54563907, "answer_count": 1, "score": 1, "last_activity_date": 1549494177, "creation_date": 1549489680, "question_id": 54563039, "link": "https://stackoverflow.com/questions/54563039/if-variable-range-is-3-than-do-action-else-do-other-action", "title": "If variable range is &gt; 3 than do action else do other action", "body": "<p>Some background: Each month I build a pivot table that has approx 30 or so business units (along the y axis) - lets call them groups. Each group has a number of GL accounts that change month to month. For example, Group 14 might have 10 GL accounts one month than the next have only 3. For each group, we need the summation of the totals for the GL accounts (that start with PL203000 &amp; PL211010) for each group. Before we had to total these GL accounts for each group by hand. This has been solved with the code I have displayed below.</p>\n\n<p>The code works perfectly when each group has more than one GL account (See pic 1)<a href=\"https://i.stack.imgur.com/frP0H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/frP0H.png\" alt=\"enter image description here\"></a></p>\n\n<p>The problem I am facing is when there is only one GL account, the code doesn't sum the correct amounts (see 2nd pic). </p>\n\n<p><a href=\"https://i.stack.imgur.com/gx4eu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gx4eu.png\" alt=\"Incorrect version\"></a></p>\n\n<p>When digging into my code, you can see that it is summing the incorrect sections since i have a Rows.Count.End(xlUp) establishing the range. If there is only one GL account, it skips to the next section thereby establishing an incorrect formula</p>\n\n<p>Perhaps my code needs to be completely revamped in order to account for groups where there is only one GL account to sum? If so, what sort of if statement can i code where it ignores groups that have only one GL account?</p>\n\n<p>If not, than is the solution to have VBA count the range and if it is less than 3, ignore group and move on to the next?</p>\n\n<pre><code>'this section spits out the values needed to sum\nFor i = nRowMax To 4 Step -1\nIf Left(Cells(i, 1), 8) = \"PL211010\" Or Left(Cells(i, 1), 8) = \"PL203000\" \nThen\n        Cells(i, 4).Copy\n        Cells(i, 5).PasteSpecial xlPasteValues\n\n        Range(Cells(i, 1), Cells(i, 4)).Select\n        With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 65535\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\nEnd If\nNext i\nApplication.CutCopyMode = False\n\n\n'this section uses the values the first section specified to write the sum formula\n'i believe the macro uses this section of code to write the first formula and the next section of code writes the formulas for the rest of the groups\nDim firstRow As Variant\nDim finalRow As Variant\n    finalRow = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n    firstRow = Cells(finalRow, 5).End(xlUp).Row\n    If IsNumeric(Cells(finalRow + 1, 5)) Then\n        Cells(firstRow, 6).Formula = \"=SUM(D\" &amp; firstRow &amp; \":D\" &amp; finalRow  &amp; \")\"\nEnd If\n\n'this section goes through the whole sheet to sum each group\nFor y = firstRow To 5 Step -1\nfinalRow = Cells(y, 5).End(xlUp).Row\nfirstRow = Cells(finalRow, 5).End(xlUp).Row\nIf firstRow &lt; 5 Then firstRow = 5\nIf IsNumeric(Cells(finalRow + 1, 5)) Then\n    Cells(firstRow, 6).Formula = \"=SUM(D\" &amp; firstRow &amp; \":D\" &amp; finalRow &amp;\")\"\nEnd If\ny = firstRow\n'If firstRow = 5 Then Exit Sub\nNext y\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-word", "cursor-position"], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 872154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b19f0bafc44095ec7ded908043cc099?s=128&d=identicon&r=PG", "display_name": "John Bentley", "link": "https://stackoverflow.com/users/872154/john-bentley"}, "edited": false, "score": 0, "creation_date": 1591959558, "post_id": 54562919, "comment_id": 110258706, "body": "An alternative, perhaps more readable, is <code>rng.SetRange Start:=rng.End, End:=rng.End</code>"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1549489041, "creation_date": 1549489041, "answer_id": 54562919, "question_id": 54562864, "link": "https://stackoverflow.com/questions/54562864/how-to-set-cursor-after-a-table-in-word-document-using-vba/54562919#54562919", "title": "How to set cursor after a table in word document using VBA", "body": "<p>To get to the point (paragraph) following a table, assign the table's Range to a <code>Range</code> object then collapse it to its end-point:</p>\n\n<pre><code>Dim rng as Word.Range\n'Do things here until table is finished\nSet rng = tbl.Range\nrng.Collapse wdCollapseEnd\n'Now the Range is after the table, so do things with it, for example:\nrng.Text = \"more text\"\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11025232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47687c640734181ae4813ecfe12e7933?s=128&d=identicon&r=PG&f=1", "display_name": "Asim Mir", "link": "https://stackoverflow.com/users/11025232/asim-mir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1260, "favorite_count": 0, "accepted_answer_id": 54562919, "answer_count": 1, "score": 2, "last_activity_date": 1594620043, "creation_date": 1549488837, "last_edit_date": 1594620043, "question_id": 54562864, "link": "https://stackoverflow.com/questions/54562864/how-to-set-cursor-after-a-table-in-word-document-using-vba", "title": "How to set cursor after a table in word document using VBA", "body": "<p>I've to create a report in Word document without a template. This report consists of records from MS Access - and there will be some text and then a table, iterative based on # of records (I'll be creating tables dynamically using VBA based on the # of records). \nI can start inserting text in the word document using a bookmark as starting point and then able to add a table and fill in cells. The question once done filling in the table how can I place the cursor on the next line after table to start inserting text. \nfollowing is my code anyone with some hints or example would appreciate - Thanks! </p>\n\n<pre><code>    Set wordObj = CreateObject(\"Word.Application\")\n\n    Set wordDoc = wordObj.Documents.Open(fileName:=wrdTMPLT, Visible:=True)\n\n    wordDoc.Bookmarks(\"rptdate\").Range.Text = Format(DATE, \"dd-mmm-yyyy\")\n    Set wordrange = wordDoc.GoTo(what:=wdGoToBookmark, Name:=\"startpoint\")      'set cursor to start point\n\n    wordrange.Text = Me.Text3_CHK\n\n    Set wordrange = wordDoc.GoTo(what:=wdGoToBookmark, Name:=\"tblpoint\")      'set cursor to location to insert table\n\n    Set tbl = wordDoc.Tables.Add(Range:=wordrange, numrows:=4, numcolumns:=2)\n\n    tbl.CELL(1, 1).Merge MergeTo:=tbl.CELL(1, 2)\n    tbl.CELL(3, 1).Merge MergeTo:=tbl.CELL(3, 2)\n    tbl.CELL(4, 1).Merge MergeTo:=tbl.CELL(4, 2)\n\n    tbl.CELL(1, 1).Range.InsertAfter \"Title: \"\n    tbl.CELL(2, 1).Range.InsertAfter \"Coordinator: \"\n    tbl.CELL(2, 2).Range.InsertAfter \"Engineer: \"\n    tbl.CELL(3, 1).Range.InsertAfter \"Vendor 1: \"\n    tbl.CELL(3, 2).Range.InsertAfter \"Vendor 2: \"\n    tbl.CELL(4, 1).Range.InsertAfter \"Contractor: \"\n\n    tbl.Borders.Enable = False\n\n    'Following text to enter after the table above                       \n    wordrange.Text = \"HellO\"\n\n    'continue with next table ... n text/table cycle  based  # of records\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 1, "creation_date": 1549488881, "post_id": 54562824, "comment_id": 95924674, "body": "This did it! Thanks a ton for your help!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1549489716, "post_id": 54562824, "comment_id": 95925040, "body": "Some explanation of how this resolves the &quot;it&#39;s also filter Numerical values in the column as well (0, 1, 2) which I want those shown&quot; might be in order. If you replace the one line of code in the question with this one line of code, it is still adding filters to everything that isn&#39;t in the select list."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1549557603, "post_id": 54562824, "comment_id": 95953700, "body": "@Adirmola by adding CStr to the statement adds a data type conversion, so that numerical and text values report as a string."}], "tags": [], "owner": {"reputation": 627, "user_id": 9701668, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-awM68pskP-Q/AAAAAAAAAAI/AAAAAAAAB1Q/DnVGA2d1iGc/photo.jpg?sz=128", "display_name": "Adirmola", "link": "https://stackoverflow.com/users/9701668/adirmola"}, "is_accepted": true, "score": 2, "last_activity_date": 1549488656, "creation_date": 1549488656, "answer_id": 54562824, "question_id": 54562470, "link": "https://stackoverflow.com/questions/54562470/vba-scripting-dictionary-filtering-issue/54562824#54562824", "title": "VBA Scripting.Dictionary Filtering issue", "body": "<p>I believe this what you'r looking for:</p>\n\n<p><code>arr.Item(CStr(.Cells(i, \"C\").Value2))</code></p>\n"}, {"comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1549488908, "post_id": 54562829, "comment_id": 95924689, "body": "Well, it will omit numeric values. I believe OP wants to convert numeric values into string."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 3, "last_activity_date": 1549488671, "creation_date": 1549488671, "answer_id": 54562829, "question_id": 54562470, "link": "https://stackoverflow.com/questions/54562470/vba-scripting-dictionary-filtering-issue/54562829#54562829", "title": "VBA Scripting.Dictionary Filtering issue", "body": "<p>Just add a test to see if the value is numeric before you add it to your filter dictionary:</p>\n\n<pre><code> Select Case UCase(.Cells(i, \"C\").Value2)\n     Case \"NA\", \"ND\", \"NH\", \"NK\", \"NL\", \"NQ\", \"NV\"\n         'do nothing\n     Case Else\n         If Not IsNumeric(.Cells(i, \"C\").Value2) Then\n            arr.Item(.Cells(i, \"C\").Value2) = vbNullString\n         End If\n End Select\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 54562824, "answer_count": 2, "score": 1, "last_activity_date": 1549523856, "creation_date": 1549486769, "last_edit_date": 1549523856, "question_id": 54562470, "link": "https://stackoverflow.com/questions/54562470/vba-scripting-dictionary-filtering-issue", "title": "VBA Scripting.Dictionary Filtering issue", "body": "<p>Hey all I'm having an issue with my Scripting Dictionary. it's supposed to filter out given text which it does but it's also filter Numerical values in the column as well (0, 1, 2) which I want those shown. </p>\n\n<p>Any help would be appreciated!</p>\n\n<pre><code>'Filter Prefixes\nSet arr = CreateObject(\"scripting.dictionary\")\nWith ActiveSheet\n lr = .Cells(Rows.Count, 1).End(xlUp).Row\n For i = 2 To lr\n     Select Case UCase(.Cells(i, \"C\").Value2)\n         Case \"NA\", \"ND\", \"NH\", \"NK\", \"NL\", \"NQ\", \"NV\"\n             'do nothing\n         Case Else\n             arr.Item(.Cells(i, \"C\").Value2) = vbNullString\n     End Select\n Next i\n .Range(\"A1:CU\" &amp; lr).AutoFilter Field:=3, Criteria1:=arr.keys, \nOperator:=xlFilterValues\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1549485685, "post_id": 54562201, "comment_id": 95923288, "body": "Have you tried: <code>Set Contact = Worksheets(&quot;Tables&quot;).Range(&quot;B:H&quot;)</code> or <code>Set Contact = Worksheets(&quot;Tables&quot;).Columns(2:8)</code>?"}, {"owner": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1549485946, "post_id": 54562201, "comment_id": 95923408, "body": "That does, but how does it change from ListObjects? All my other tables worked fine when set as a ListObject? Is it because I was only trying to reference part of the table?"}], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 2, "last_activity_date": 1549490362, "last_edit_date": 1549490362, "creation_date": 1549489830, "answer_id": 54563070, "question_id": 54562201, "link": "https://stackoverflow.com/questions/54562201/vba-multicolumn-reference-within-table/54563070#54563070", "title": "VBA Multicolumn reference within table", "body": "<p>You use <code>ListObjects(\"TableName\")</code> to reference the whole table.  Then <code>ListColumns(\"ColumnHeading\")</code> to reference specific columns within the table, where \"ColumnHeading\" is the actual heading name in the table (or <code>ListColumns(#)</code> where <code>#</code> is the index number of the column).  Then <code>DataBodyRange</code> to reference the range of the column data.  </p>\n\n<p>Rather than <code>VLookup</code> it would be better to use <code>Match</code> to find the row number, and a <code>Range.Cells</code> to get the result.</p>\n\n<p>Something like this</p>\n\n<pre><code>Sub Demo()\n    Dim lo As ListObject\n    Dim SearchRange As Range\n    Dim LookupRange As Range\n    Dim SearchTerm As Variant\n    Dim LookupItem As Variant\n    Dim idx As Variant\n\n    Set lo = Worksheets(\"Tables\").ListObjects(\"Table1\")\n    Set SearchRange = lo.ListColumns(\"Column2\").DataBodyRange\n    Set LookupRange = lo.ListColumns(\"Column8\").DataBodyRange\n\n    SearchTerm = \"YourSearchTerm\"\n    idx = Application.Match(SearchTerm, SearchRange, 0)\n    If Not IsError(idx) Then\n        LookupItem = LookupRange.Cells(idx, 1)\n        ' use the result as you wish\n        Debug.Print LookupItem\n    Else\n        ' SearchTerm not found.  What now?\n    End If\n\n    'For completeness, heres how to reference a range of columns\n    Dim VLookupRange As Range\n    Set VLookupRange = lo.Parent.Range(lo.ListColumns(\"Column2\").DataBodyRange, lo.ListColumns(\"Column8\").DataBodyRange)\n    Debug.Print VLookupRange.Address\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 54563070, "answer_count": 1, "score": 0, "last_activity_date": 1549490362, "creation_date": 1549485532, "last_edit_date": 1549488768, "question_id": 54562201, "link": "https://stackoverflow.com/questions/54562201/vba-multicolumn-reference-within-table", "title": "VBA Multicolumn reference within table", "body": "<p>I am trying to set a table in VBA, however, I only want to set the range to be specific columns within the table. I can't seem to find out how to do it. Everything I search for seems to return excel table referencing and it doesn't appear to be the correct syntax for VBA. This is what I have but I get a runtime error '9': subscript out of range.</p>\n\n<pre><code>Set Contact = Worksheets(\"Tables\").ListObjects(\"Table1[[Column2]:[Column8]]\")\n</code></pre>\n\n<p>edit: I don't think my question was clear. I am trying to reference a certain range within a table because I am using a vlookup to find the data I am looking for. I am referencing the information in column two and get the information in column 8 to set to a variable. So I am trying to set the listobject to be a table within a bigger table of sorts.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1549484545, "post_id": 54561812, "comment_id": 95922811, "body": "I&#39;d suggest reading <a href=\"https://stackoverflow.com/q/10714251/4088852\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1549484546, "post_id": 54561812, "comment_id": 95922813, "body": "Not sure if this completely fixes your problem or not but selecting sheets cells is unreliable and very bad practice. You can still use the same idea but better is to create row and col variables then set <code>row</code> to 24 and <code>col</code> to 10. Then increment <code>col</code> each time through the loop and access via <code>Cells(row, col)</code>."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1549487239, "post_id": 54561812, "comment_id": 95923987, "body": "I&#39;ve read your code, and except for <code>ActiveCell.Offset(1, 0) = Range(&quot;TL&quot;)</code> and <code>ActiveCell.Offset(2, 0) = Range(&quot;ML&quot;)</code> it doesn&#39;t seem to be doing anything. So I assume you rather wanted to say <code>If Application.CalculationState = xlDone Then</code> ... VBA is single-threaded, hence after you call <code>Application.Calculate</code>, the <code>CalculationState</code> should always be <code>xlDone</code> and your code inside the <code>If</code> block would never been called. By the way, I think you should really follow @Comintern  suggestion, this code relying on what the <code>Active</code> / <code>Selected</code> ranges are is very unstable."}], "owner": {"reputation": 1, "user_id": 10429805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025607730cc65a173cdad6b6cc842679?s=128&d=identicon&r=PG&f=1", "display_name": "VLookUp", "link": "https://stackoverflow.com/users/10429805/vlookup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549538979, "creation_date": 1549483960, "last_edit_date": 1549538979, "question_id": 54561812, "link": "https://stackoverflow.com/questions/54561812/do-while-loop-not-performing-the-task", "title": "Do While loop not performing the task", "body": "<p>have created this macro that allows the user to select scenario numbers using an InputBox and now I'm trying to run the scenarios and record some sort of results. This is very useful for cases that I might want to run +50 scenarios at the time. Scenario numbers trigger OFFSETs in my input sheet where it analyzes results. This works perfectly in break mode but when I actually run the macro as a \"user\" it just works for the first scenario and not the rest</p>\n\n<pre><code>Sub sbScenarioAnalysis()\nSheets(\"results\").Select\nRange(\"J24\").Select\nDo While ActiveCell.Value &lt;&gt; Empty\n\n    Range(\"ScenarioNumber\").Value = ActiveCell.Value\n\n      Application.Calculate\n        If Not Application.CalculationState = xlDone Then\n        ActiveCell.Offset(1, 0) = Range(\"TL\")\n        ActiveCell.Offset(2, 0) = Range(\"ML\")\n        End If\n    ActiveCell.Offset(0, 1).Select\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5868, "user_id": 2557263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a28006d7f96af66be38c4c9bd52af344?s=128&d=identicon&r=PG", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/2557263/alejandro"}, "edited": false, "score": 0, "creation_date": 1549483947, "post_id": 54561754, "comment_id": 95922543, "body": "The trick is the <code>MoveNext</code> call, not the loop itself."}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 3, "last_activity_date": 1549484112, "creation_date": 1549484112, "answer_id": 54561840, "question_id": 54561754, "link": "https://stackoverflow.com/questions/54561754/why-is-a-loop-needed-to-change-recordset-in-access-vba/54561840#54561840", "title": "Why is a loop needed to change recordset in Access VBA?", "body": "<p>You don't need a loop. You just need to trigger the update.</p>\n\n<p>In fact, this is only a limitation of how you set up the connection. Since it doesn't support batch updates, moving to the next record triggers the update.</p>\n\n<p>If you add <code>rs.Update</code> to that first piece of code, it should just work.</p>\n"}], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 54561840, "answer_count": 1, "score": 1, "last_activity_date": 1549484112, "creation_date": 1549483752, "question_id": 54561754, "link": "https://stackoverflow.com/questions/54561754/why-is-a-loop-needed-to-change-recordset-in-access-vba", "title": "Why is a loop needed to change recordset in Access VBA?", "body": "<p>I was trying to change a value of a recordset Boolean column in Access. The code that I was using did not throw any error:</p>\n\n<pre><code>    Dim rs As New ADODB.Recordset\n\n        rs.Open \"select * from TABLE where field1 = '\" &amp; Me.field1 &amp; \"' AND field2 = '\" &amp; Me.field2 &amp; \"'\",currentproject.connection, adOpenDynamic, adLockOptimistic\n        rs(\"boolean\") = True\n</code></pre>\n\n<p>However, the boolean value did not update. The <code>recordset.recodcount</code> property gives 1. This is why I thought I did not need a loop. But the record only updates if I add a loop and do not understand why this is the case.</p>\n\n<pre><code> Do While Not rs.EOF\n         rs(\"boolean\") = True\n       rs.MoveNext\n       Loop\n</code></pre>\n\n<p>Why do I need to add a loop to update a field when there is only one record?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549484447, "post_id": 54561698, "comment_id": 95922756, "body": "Isn&#39;t &quot;fill down&quot; a drag &amp; drop operation (albeit with custom double-click behavior on the handle)? I&#39;m not sure how you came to conclude that &quot;fill handle is a copy/paste function&quot;, is it because it clears the clipboard?"}, {"owner": {"reputation": 971, "user_id": 1132062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19da0652371ee5881adff136ef755372?s=128&d=identicon&r=PG", "display_name": "ReturnVoid", "link": "https://stackoverflow.com/users/1132062/returnvoid"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549485604, "post_id": 54561698, "comment_id": 95923264, "body": "Yes, I&#39;m referring to small handle that allows copy/paste, which I guess is same/similar to the fill down operation. Or is that the same thing? I just kind of figured they&#39;re copy/paste operation? Edit: don&#39;t care so much for the double-click fill behavior, just being able to access the handle on cell itself."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549485896, "post_id": 54561698, "comment_id": 95923390, "body": "Well if you <i>drag</i> that handle down, you get the <i>fill</i> behavior. My hunch is that it&#39;s a  D&amp;D operation, not C&amp;P - IOW you can&#39;t disable D&amp;D without losing autofill."}, {"owner": {"reputation": 971, "user_id": 1132062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19da0652371ee5881adff136ef755372?s=128&d=identicon&r=PG", "display_name": "ReturnVoid", "link": "https://stackoverflow.com/users/1132062/returnvoid"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549486115, "post_id": 54561698, "comment_id": 95923492, "body": "Right thanks, so any possible way to work around that then if that is indeed the case? As that&#39;s mildly annoying &amp; doesn&#39;t make sense, because I can still CTRL+C, CTRL+P."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549486435, "post_id": 54561698, "comment_id": 95923638, "body": "Short of hijacking the message pump and reprogramming Excel, I&#39;m not sure there&#39;s a solution there - why disable D&amp;D anyway?"}, {"owner": {"reputation": 971, "user_id": 1132062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19da0652371ee5881adff136ef755372?s=128&d=identicon&r=PG", "display_name": "ReturnVoid", "link": "https://stackoverflow.com/users/1132062/returnvoid"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549486846, "post_id": 54561698, "comment_id": 95923806, "body": "Need to disable D&amp;D because if I don&#39;t I need to account for possible #REF! issues that users may invoke on linked cells, accidentally or otherwise. I could edit my question to include catching &amp; overriding D&amp;D op?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1549487328, "post_id": 54561698, "comment_id": 95924027, "body": "I&#39;m guessing that accounting for the possible #REF! issues is going to be easier, and in the long term, much better for both you and your users. Changing the behavior of the host application to account for deficiencies in the code, validation, or to attempt and forestall user error isn&#39;t a real solution."}, {"owner": {"reputation": 971, "user_id": 1132062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19da0652371ee5881adff136ef755372?s=128&d=identicon&r=PG", "display_name": "ReturnVoid", "link": "https://stackoverflow.com/users/1132062/returnvoid"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1549487665, "post_id": 54561698, "comment_id": 95924165, "body": "@Comintern I&#39;ve contemplated that too &amp; will have to failing this, but was looking at these options first as this will be an easier to deal with, as data where #REF! may happen is dynamic &amp; expanding."}], "owner": {"reputation": 971, "user_id": 1132062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19da0652371ee5881adff136ef755372?s=128&d=identicon&r=PG", "display_name": "ReturnVoid", "link": "https://stackoverflow.com/users/1132062/returnvoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559571612, "creation_date": 1549483520, "last_edit_date": 1549485965, "question_id": 54561698, "link": "https://stackoverflow.com/questions/54561698/vba-disable-drag-and-drop-enable-fill-handle", "title": "vba disable drag and drop enable fill handle", "body": "<p>I want to disable drag and drop but in doing so it is also disabling fill handle, which I don't want to disable.</p>\n\n<p>Currently using following</p>\n\n<pre><code>Application.CellDragAndDrop = False '&lt;&lt;also cancels fill handle\nws.Protect \"Password\", Contents:=True, DrawingObjects:=False, AllowFormattingCells:=True, AllowFiltering:=True, userinterfaceonly:=True \n</code></pre>\n\n<p>Fill handle is a copy/paste function, &amp; I can manually still copy/paste, so not sure I understand why DragAndDrop, which is a cut/paste operation, should cause this issue.</p>\n\n<p>So is there some way to disable DragAndDrop but still allow fill handle to work? Thanks.</p>\n\n<p>EDIT: for reference, fill handle:\n<a href=\"https://support.office.com/en-us/article/copy-a-formula-by-dragging-the-fill-handle-in-excel-for-mac-dd928259-622b-473f-9a33-83aa1a63e218\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/copy-a-formula-by-dragging-the-fill-handle-in-excel-for-mac-dd928259-622b-473f-9a33-83aa1a63e218</a></p>\n"}, {"tags": ["excel", "vba", "fso"], "comments": [{"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 1, "creation_date": 1549483627, "post_id": 54561608, "comment_id": 95922388, "body": "Instead of having 110,000+ <code>edump.Write</code> operations, why not build one large string and then <code>edump.Write</code> the entire string all at once outside of your loop?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1549483718, "post_id": 54561608, "comment_id": 95922435, "body": "Why can&#39;t you just copy the range to a temporary worksheet and save it as a CSV?  I am reading the <code>eString = Chr(34) &amp; Cells(r, 1) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Cells(r, 2) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Cells(r, 3) &amp; Chr(34)</code> line correctly, right?"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1549490560, "post_id": 54561608, "comment_id": 95925380, "body": "@TateGarringer............I&#39;ll give that a try and see how it works"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1549490615, "post_id": 54561608, "comment_id": 95925404, "body": "@Comintern...........The user wants it as a txt file and not a csv file.  Can I use this method and save it as a txt file instead?  Thanks........"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1549491880, "post_id": 54561608, "comment_id": 95925853, "body": "A csv file <b><i>is</i></b> a text file. If they want it named .txt afterward, just rename it."}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1549555117, "post_id": 54561608, "comment_id": 95952153, "body": "@TateGarringer...........Thanks.  Your suggestion worked great and cut the time in half to create the text file."}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549483176, "creation_date": 1549483176, "question_id": 54561608, "link": "https://stackoverflow.com/questions/54561608/is-there-a-faster-way-to-create-a-txt-file", "title": "Is there a faster way to create a txt file?", "body": "<p>In my Excel macro, the user would like it to create a txt file of the results.  I am able to do so with the code below.  At this time, it takes about 5 minutes to create a txt file with 110,000 lines.  I'm afraid the user will complain about the time it takes.  I'm wondering if their is there a better / faster way to create this txt file?  </p>\n\n<p>Thanks in advance for your help....</p>\n\n<pre><code>Sub Create_Text_File()\n\n    Application.ScreenUpdating = False\n\n    ThisBook = \"\"\n    ThisBook = ActiveWorkbook.Name\n\n    Worksheets(\"Results\").Activate\n    r = 2\n\n    Dim X As Long\n    X = Cells.Find(\"*\", [A1], , , xlByRows, xlPrevious).Row\n\n    If X &gt; 1 Then\n\n        MyPath = \"\"\n        MyPath = ActiveWorkbook.Path\n        MyPath = MyPath &amp; \"\\\"\n\n        Load frmBank\n        frmBank.Show\n\n        On Error Resume Next\n\n        Dim efs As Object\n        Dim edump As Object\n        Dim eWriteString As String\n        Dim eRundate\n\n        eRundate = Year(Date)\n        If Len(Month(Date)) = 1 Then eRundate = eRundate &amp; 0\n\n        eRundate = eRundate &amp; Month(Date)\n        If Len(Day(Date)) = 1 Then eRundate = eRundate &amp; 0\n\n        eRundate = eRundate &amp; Day(Date)\n        If Len(Hour(Time)) = 1 Then eRundate = eRundate &amp; 0\n\n        eRundate = eRundate &amp; Hour(Time)\n        If Len(Minute(Time)) = 1 Then eRundate = eRundate &amp; 0\n\n        eRundate = eRundate &amp; Minute(Time)\n        If Len(Second(Time)) = 1 Then eRundate = eRundate &amp; 0\n\n        eRundate = eRundate &amp; Second(Time)\n\n        Randomize\n        eRandom = Int((99999 - 11111 + 1) * Rnd + 11111)\n\n        Set efs = CreateObject(\"Scripting.FileSystemObject\")\n\n        MyFileName = MyPath &amp; MyBank &amp; \" - \" &amp; eRundate &amp; \"-\" &amp; eRandom &amp; \".txt\"\n\n        Set edump = efs.createtextfile(MyFileName, False)\n\n        Do Until Len(Trim(Cells(r, 1))) + Len(Trim(Cells(r, 2))) + Len(Trim(Cells(r, 3))) = 0\n\n            eString = Chr(34) &amp; Cells(r, 1) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Cells(r, 2) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Cells(r, 3) &amp; Chr(34)\n\n            If Len(Trim(Cells((r + 1), 1))) &gt; 0 Then\n\n                eString = eString &amp; Chr(13) + Chr(10)\n\n            End If\n\n            eWriteString = eString\n\n            edump.Write eWriteString\n\n            r = r + 1\n\n        Loop\n\n        edump.Close\n\n        MsgBox \"  The txt file has been created.\", vbExclamation, \"Txt File Created\"\n\n    Else\n\n\n        MsgBox \"  The txt file was not created as there is no data on the 'Results' sheet.\", vbCritical, \"Txt File Not Created\"\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 10754996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10454f795afed51724282be97049c6c9?s=128&d=identicon&r=PG&f=1", "display_name": "M. R.", "link": "https://stackoverflow.com/users/10754996/m-r"}, "edited": false, "score": 0, "creation_date": 1549486857, "post_id": 54561082, "comment_id": 95923814, "body": "Should have added; even before adding the cell security, this macro started working slower than it used to.  No other macros in the workbook have appeared to slow down as much."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1549526572, "post_id": 54561082, "comment_id": 95935377, "body": "Note that <code>ActiveSheet.ProtectPassword:=&quot;Password&quot;</code> is missing a space between <code>.Protect Password:=&quot;Password&quot;</code>. \u2022 Also avoid using <code>ActiveSheet</code> which is not very reliable. Instead specify exactly which sheet you mean by its name."}, {"owner": {"reputation": 11, "user_id": 10754996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10454f795afed51724282be97049c6c9?s=128&d=identicon&r=PG&f=1", "display_name": "M. R.", "link": "https://stackoverflow.com/users/10754996/m-r"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1549545377, "post_id": 54561082, "comment_id": 95946147, "body": "Thank you, that was a typo in copying the code over, the code has the space for protect password correct in the workbook.  For the other, I switched ActiveSheet to the specific sheet, but unfortunately it did not change the cell locking issues."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10754996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10454f795afed51724282be97049c6c9?s=128&d=identicon&r=PG&f=1", "display_name": "M. R.", "link": "https://stackoverflow.com/users/10754996/m-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1549552052, "creation_date": 1549552052, "answer_id": 54576337, "question_id": 54561082, "link": "https://stackoverflow.com/questions/54561082/vba-locking-cells-only-working-in-some-cells-and-not-others/54576337#54576337", "title": "VBA - Locking Cells Only Working In Some Cells and Not Others", "body": "<p>So, even though it didn't work before, we went back and tried to alter the Allow Users to Edit Ranges.  Wiped all of them out again and the cell locking started working.  I'm not going to question why it worked vs not working the last time it was tried, just glad it's working!   That being said, the speed being different is still an issue.</p>\n"}], "owner": {"reputation": 11, "user_id": 10754996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10454f795afed51724282be97049c6c9?s=128&d=identicon&r=PG&f=1", "display_name": "M. R.", "link": "https://stackoverflow.com/users/10754996/m-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549552052, "creation_date": 1549480896, "last_edit_date": 1549545407, "question_id": 54561082, "link": "https://stackoverflow.com/questions/54561082/vba-locking-cells-only-working-in-some-cells-and-not-others", "title": "VBA - Locking Cells Only Working In Some Cells and Not Others", "body": "<p>this project is certainly testing my limits in VBA.  I have yet another question.   In this workbook, I have a button called \"Add Projects\" that takes a different sheet \"Project Templates\" and uses it to create a new sheet called \"Add Projects\".  I'm trying to add some specific cell locking when this sheet is created.  The idea is that users can alter certain areas, but not ones that have formulas or are auto-populated by an entry in a different cell.</p>\n\n<p>The problem is, when I add the code, certain ones lock appropriately, one particular cell does a popup asking for a password (when it should just be locked like the others), and some let you still edit them despite them being included in the locked code.</p>\n\n<p>I've checked the cell format, and the box for locked is selected.  I've also gone to the Allow Users to Edit Ranges and removed everything from there (although those ranges weren't in there).  I've moved the order of the ranges around, thinking maybe they were somehow overwriting each other even though I have a distinct cell set as the end range.</p>\n\n<pre><code>Public Sub Open_AddProjectSheet()\nApplication.ScreenUpdating = False\nActiveWorkbook.Unprotect Password:=\"Password\"\nWorksheets(\"ProjTemplate\").Visible = True\n\nIf WorksheetExists(\"AddProject\") = False Then\n GetTSResourceInfo\n GetTSProjectID\n ActiveWorkbook.Unprotect Password:=\"Password\"\nWorksheets(\"ProjTemplate\").Copy After:=Worksheets(\"ProjTemplate\")\nActiveSheet.Name = \"AddProject\"\n Worksheets(\"ProjTemplate\").Visible = xlSheetVeryHidden\nSheets(\"AddProject\").Activate\nActiveSheet.Unprotect Password:=\"Password\"\nActiveSheet.Cells.Locked = False\nActiveSheet.Range(\"E5,C6,L2,L6\").Locked = True\nActiveSheet.Range(\"E11:E190\").Locked = True\nActiveSheet.Range(\"G11:H190\").Locked = True\nActiveSheet.Range(\"K2:K6\").Locked = True\nActiveSheet.Range(\"L11:R190\").Locked = True\nActiveSheet.Range(\"L3:L5\").Locked = False\nActiveSheet.Protect Password:=\"Password\",UserInterFaceOnly:=True,Contents:=True\nElse\nanswer = MsgBox(\"'AddProject' sheet already active. Would you like to pick up where you left?  WARNING: Selecting 'No' will close the existing sheet and open a new one, any progress will not be saved.\", vbYesNo)\n\n    If answer = 6 Then\n        Worksheets(\"AddProject\").Activate\n        Else\n            *Same code as above*\n    End If\n\nEnd If\nWorksheets(\"ProjTemplate\").Visible = xlSheetVeryHidden\nActiveWorkbook.Protect Password:=\"Password\"\nApplication.ScreenUpdating = True\n End Sub\n</code></pre>\n\n<p>When running this code, E5,C6,K2-K6,L2,L11-R190 are all locked correctly. L6 brings up a popup asking for a password to change this cell.  All other ranges, E11-E190, G11-H190 are editable even though they should be locked.</p>\n\n<p>Any ideas I'm greatly appreciative of.  Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 0, "last_activity_date": 1549480038, "creation_date": 1549480038, "answer_id": 54560867, "question_id": 54560825, "link": "https://stackoverflow.com/questions/54560825/how-do-i-pass-a-cell-value-to-range-to-use-as-its-address/54560867#54560867", "title": "How do I pass a cell value to Range to use as its address?", "body": "<p>The <code>Address</code> property is read-only. It can't be used to change the range. Instead, just use the <code>Range</code> function:</p>\n\n<pre><code>Set Range1 = Range(Cells(3,3).Value)\n</code></pre>\n\n<p>should work.</p>\n"}], "owner": {"reputation": 13, "user_id": 3273136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc25f20036a8d24e869a779d59bb6cd?s=128&d=identicon&r=PG&f=1", "display_name": "user3273136", "link": "https://stackoverflow.com/users/3273136/user3273136"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 54560867, "answer_count": 1, "score": 1, "last_activity_date": 1549523848, "creation_date": 1549479865, "last_edit_date": 1549523848, "question_id": 54560825, "link": "https://stackoverflow.com/questions/54560825/how-do-i-pass-a-cell-value-to-range-to-use-as-its-address", "title": "How do I pass a cell value to Range to use as its address?", "body": "<p>I have a script that requires the user to enter a range of cells.  I do this with an input box</p>\n\n<pre><code>Set Range1 = Application.Selection\nSet Range1 = Application.InputBox(\"Source Ranges:\", xTitleId, Range1.Address, Type:=8)\nRange(\"C3\").Value = Range1.Address(External:=True)\n</code></pre>\n\n<p>I want the user to be able to run the script again, but just reuse the previous range.  I'm saving the address to a cell, and am now trying to pass that info from the cell BACK to the range...  Its giving me a type mismatch.  Below is how I am (probably too simply) trying to pass the information back.</p>\n\n<pre><code>Set Range1.Address = Cells(3, 3).Value\n</code></pre>\n\n<p>However, if I copy the previous range and paste that into the dialog box, it works fine.  I believe I'm just not passing the data right.  Any suggestions?</p>\n"}, {"tags": ["vba", "stored-procedures", "adodb"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1549479774, "post_id": 54560782, "comment_id": 95920730, "body": "Which line of code is triggering the error?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1549479826, "post_id": 54560782, "comment_id": 95920750, "body": "You don&#39;t <code>Set</code> the <code>cmd</code> object - you need to do that."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1549497240, "post_id": 54560782, "comment_id": 95927543, "body": "@CindyMeister that &quot;you dont set the cmd object&quot; comment would have been a fine upvote-worthy answer btw ;-)"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549519502, "post_id": 54560782, "comment_id": 95932582, "body": "@MathieuGuindon If I&#39;d known the correct syntax for what to set it <i>to</i> I would have answered :-) Since I was on a mobile device at the time I couldn&#39;t research it, but figured the OP or someone else could, once it was clear why the error was occurring. And for me, such a thing is borderline &quot;non-repro&quot; to close..."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1549480788, "last_edit_date": 1549480788, "creation_date": 1549480529, "answer_id": 54560986, "question_id": 54560782, "link": "https://stackoverflow.com/questions/54560782/getting-object-variable-block-variable-not-set-error-trying-to-use-vba-to-pull/54560986#54560986", "title": "Getting Object Variable, Block Variable not set error trying to use VBA to pull SQL Server stored procedure", "body": "\n\n<p>\"Object [or With block] variable not set\" is VBA's equivalent of other languages' \"null reference exception\", an error that occurs when you try to access an object's members when that object's reference is <code>null</code>, or in VBA terms, <code>Nothing</code>.</p>\n\n<p>That's precisely what's happening here:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>cmd.ActiveConnection = conn\n</code></pre>\n\n<p>The <code>cmd</code> object was declared, but never initialized. <code>Set</code> it to a <code>New</code> instance of an <code>ADODB.Command</code> class to fix the problem:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set cmd = New ADODB.Command\ncmd.ActiveConnection = conn\n</code></pre>\n\n<p>The \"With block\" part of the error message refers to the <code>With</code> block syntax:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim cmd As ADODB.Command\nWith cmd ''&lt;&lt; error 91 here\n    '...\nEnd With\n</code></pre>\n\n<p>You can use <code>With New</code> to have the object reference held by the <code>With</code> block, without needing to declare a local variable:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With New ADODB.Command\n    '...\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11024467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3d9e3dabee5429237c8ee57037d83a?s=128&d=identicon&r=PG&f=1", "display_name": "Apostate", "link": "https://stackoverflow.com/users/11024467/apostate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 54560986, "answer_count": 1, "score": 2, "last_activity_date": 1549480788, "creation_date": 1549479676, "last_edit_date": 1549480368, "question_id": 54560782, "link": "https://stackoverflow.com/questions/54560782/getting-object-variable-block-variable-not-set-error-trying-to-use-vba-to-pull", "title": "Getting Object Variable, Block Variable not set error trying to use VBA to pull SQL Server stored procedure", "body": "<p>I'm attempting to pull a stored procedure from SQL Server using VBA.  I'm able to pull basic SQL Code from the server, but when trying to use a complex code with a stored procedure, I'm getting a Error 91: Object Variable or With block variable not set.  Haven't been able to determine what I need to set to make this run correctly.</p>\n\n<p>The stored procedure with done without parameters, and do not have code for parameters listed.  I've tried some parameter code from other topics in this forum, but no change</p>\n\n<p>Removing the cmd lines and running it just for a SQL Code (SELECT * FROM Table) did work</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ConnectSQL()\n    Dim conn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim cmd As ADODB.Command\n    Dim sConnString As String\n'Create Connection String\n    sConnString = \"Provider=SQLOLEDB;Data Source=ServerName;\" &amp; _\n        \"Initial Catalog=DatabaseName;\" &amp; _\n        \"User ID=ID;\" &amp; _\n        \"Password=Password;\" &amp; _\n        \"Integrated Security=SSPI;\"\n'Create Connection and Recordset Objects\n    Set conn = New ADODB.Connection\n    Set rs = New ADODB.Recordset\n'Open Connection and Execute\n    conn.Open sConnString\n    cmd.ActiveConnection = conn\n    cmd.CommandType = adCmdStoredProc\n    cmd.CommandText = \"Paint558Ranking\"\n    Set rs = cmd.Execute\n'Check If Data\n    If Not rs.EOF Then\n'Transfer Result\n        Sheets(\"Sheet1\").Range(\"A1\").CopyFromRecordset rs\n'Close record\n        rs.Close\n    Else\n        MsgBox \"Error: No Records Returned.\", vbCritical\n    End If\n'Clean Up\n    If CBool(conn.State And adStateOpen) Then conn.Close\n    Set conn = Nothing\n    Set rs = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 5937324, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1f8a332e0a73f686f639e1b87d66b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5937324/mike"}, "is_accepted": true, "score": 2, "last_activity_date": 1549475570, "creation_date": 1549475570, "answer_id": 54559744, "question_id": 54559743, "link": "https://stackoverflow.com/questions/54559743/excel-vba-cant-find-project-or-library/54559744#54559744", "title": "Excel VBA: Can&#39;t find project or library", "body": "<p>Steps:</p>\n\n<ol>\n<li>panic</li>\n<li>Repaired Microsoft Office</li>\n<li>removed personal.xlsb file from XLStart to test</li>\n<li>Opened blank excel, Alt + F11 to open VBA</li>\n<li>Tools -> References -> Object Library</li>\n<li>Search for missing objects</li>\n<li>Corrected if found</li>\n<li>These steps didn't resolve, so renamed the file opened in safe mode (win + R type Excel.exe /safe) </li>\n<li>Updated dates, changed a few items and saved</li>\n<li>Opened file normally, issue resolved. </li>\n</ol>\n\n<p>Alternatively, try to have someone else open the file/update name and change a few things for you. the file is likely corrupt</p>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 7427161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2d91a477bfc4def93a4c1d48e67391?s=128&d=identicon&r=PG&f=1", "display_name": "kodfather", "link": "https://stackoverflow.com/users/7427161/kodfather"}, "edited": false, "score": 3, "creation_date": 1594714196, "post_id": 60075328, "comment_id": 111214240, "body": "Life saver! Thanks, works perfectly"}, {"owner": {"reputation": 100, "user_id": 1857936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dc7feb4a9905d3d2e4e4aa7272ae758?s=128&d=identicon&r=PG", "display_name": "Lars", "link": "https://stackoverflow.com/users/1857936/lars"}, "edited": false, "score": 0, "creation_date": 1615388296, "post_id": 60075328, "comment_id": 117675523, "body": "Wow, from panic to relief. Worked! THANKS!!!!"}], "tags": [], "owner": {"reputation": 91, "user_id": 12845222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/434494cb5d35d924a65d6ddc550d06db?s=128&d=identicon&r=PG&f=1", "display_name": "Greg_dodds", "link": "https://stackoverflow.com/users/12845222/greg-dodds"}, "is_accepted": false, "score": 9, "last_activity_date": 1580903879, "creation_date": 1580903879, "answer_id": 60075328, "question_id": 54559743, "link": "https://stackoverflow.com/questions/54559743/excel-vba-cant-find-project-or-library/60075328#60075328", "title": "Excel VBA: Can&#39;t find project or library", "body": "<p>I have found a solution to the problem which works 100% of the time, however it's slightly inconvenient.</p>\n\n<p>When trying to open the VBA > References, it will crash therefore I cannot find the missing reference. </p>\n\n<p>My workaround is to clear all trusted documents, which brings the 'Enable Content' pop up. Before enabling content, I will go back to VBA > References, remove and re-add OLE Automation.</p>\n\n<p>The next step is to save the file, enable content and you're good to go! </p>\n"}, {"comments": [{"owner": {"reputation": 457, "user_id": 1088005, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/df9fe40b45670e4d50f655914ea3a7a8?s=128&d=identicon&r=PG", "display_name": "bawpie", "link": "https://stackoverflow.com/users/1088005/bawpie"}, "edited": false, "score": 1, "creation_date": 1591095344, "post_id": 60603506, "comment_id": 109919213, "body": "Thank you, this worked for me.  Not sure what caused the corruption in the first place, but very handy tip.  I did lose some active X/form control buttons but better than losing the VBA!"}, {"owner": {"reputation": 5696, "user_id": 4421870, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/38f9356608b91648b260644fc7a1b6a3?s=128&d=identicon&r=PG&f=1", "display_name": "Mako212", "link": "https://stackoverflow.com/users/4421870/mako212"}, "edited": false, "score": 2, "creation_date": 1591819680, "post_id": 60603506, "comment_id": 110205467, "body": "This also worked for me. I&#39;ve encountered this problem several times, and it&#39;s a real bear to troubleshoot because it tends to make a workbook almost unusable (crashing even in safe mode), and Microsoft&#39;s official answer of &quot;go to References and make sure the the library is available&quot; is useless."}], "tags": [], "owner": {"reputation": 2604, "user_id": 3385948, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YJIjJ.png?s=128&g=1", "display_name": "Sean McCarthy", "link": "https://stackoverflow.com/users/3385948/sean-mccarthy"}, "is_accepted": false, "score": 5, "last_activity_date": 1583767020, "creation_date": 1583767020, "answer_id": 60603506, "question_id": 54559743, "link": "https://stackoverflow.com/questions/54559743/excel-vba-cant-find-project-or-library/60603506#60603506", "title": "Excel VBA: Can&#39;t find project or library", "body": "<p>When all else failed, this worked for me. I opened my workbook in Excel online (Office 365, in the browser, which doesn't support macros anyway), saved it with a new file name (still using .xlsm file extension), and reopened in the desktop software. It worked. </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4458471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a3f8a44aa9e137cfec7163b57a7ffdc?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/4458471/charlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1589723499, "creation_date": 1589723499, "answer_id": 61852885, "question_id": 54559743, "link": "https://stackoverflow.com/questions/54559743/excel-vba-cant-find-project-or-library/61852885#61852885", "title": "Excel VBA: Can&#39;t find project or library", "body": "<p>Try opening it in the Mac version of Excel. I tried this in last ditch desperation after no other recommendations worked (I couldn't try opening in online version because the file is password protected which isn't supported there). Mac Excel was able to open it without any complaints. I was then able to save it out just fine, and Windows (10, 64 bit- where the file was originally created) Excel was then able to read like normal. Using the various recovery methods with Windows Excel, the best I could get was a version that preserved the formulas but lost all of the VBA and all of the named ranges.</p>\n\n<p>BTW, one other feature of my problem: I was working on the file for about a week.  In that time, I never closed and reopened it. I did, however, save many, many times. Including saving versions in new files. I discovered the problem when I finally did close &amp; reopen. And I discovered that every single version I had saved in the past five days was also corrupt.</p>\n"}], "owner": {"reputation": 123, "user_id": 5937324, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1f8a332e0a73f686f639e1b87d66b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5937324/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19340, "favorite_count": 1, "closed_date": 1597050293, "accepted_answer_id": 54559744, "answer_count": 4, "score": 2, "last_activity_date": 1597037967, "creation_date": 1549475570, "question_id": 54559743, "link": "https://stackoverflow.com/questions/54559743/excel-vba-cant-find-project-or-library", "closed_reason": "Duplicate", "title": "Excel VBA: Can&#39;t find project or library", "body": "<p>Running Windows 10\nMicrosoft Excel 16\n64 bit</p>\n\n<p>Just encountered this issue - Opening a normal file with a small amount of VBA coding. </p>\n\n<p>On opening file today, ran into error \"Can't find project or library\"</p>\n\n<p>Error appeared in a few files, and after restarting was localized to a single file. </p>\n"}, {"tags": ["excel", "vba", "loops", "split"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "edited": false, "score": 0, "creation_date": 1549476349, "post_id": 54559634, "comment_id": 95919129, "body": "Hi SJR, thanks for responding to my question. When I run this it is split my text into different rows. Ideally, I would like the column A text to be split into columns A, B and C and then for the macro to go to the next row to do the same thing."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "edited": false, "score": 0, "creation_date": 1549476426, "post_id": 54559634, "comment_id": 95919164, "body": "Just put a comma in front of the Offset (amended above) to offset column rather than row. However, why don&#39;t you use Text to Columns, much more efficient?"}, {"owner": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "edited": false, "score": 0, "creation_date": 1549477730, "post_id": 54559634, "comment_id": 95919747, "body": "SJR can you explain what you mean Text to Columns? Do you mean formulas in the columns?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "edited": false, "score": 0, "creation_date": 1549477940, "post_id": 54559634, "comment_id": 95919827, "body": "No, it&#39;s an option in the Data menu. A few clicks and you&#39;re done  <a href=\"https://www.excel-easy.com/examples/text-to-columns.html\" rel=\"nofollow noreferrer\">excel-easy.com/examples/text-to-columns.html</a>"}, {"owner": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "edited": false, "score": 0, "creation_date": 1549478701, "post_id": 54559634, "comment_id": 95920189, "body": "For a little more background - I created code that opens a text file and copies data from that text file and pastes it into cell A1 in this workbook every time I run it. I just used the Text to Columns function and it works as I would like but when I run my macro to pull in new data the Text to Columns clears out."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1549477933, "last_edit_date": 1549477933, "creation_date": 1549475143, "answer_id": 54559634, "question_id": 54559571, "link": "https://stackoverflow.com/questions/54559571/how-to-split-text-and-loop-to-next-row/54559634#54559634", "title": "How to Split text and loop to next row", "body": "<p>You probably need to change the bit inside your loop thus as you are starting at A1. This assumes you want the entries in A2 and down. Not generally advisable to use Select/Activate, not very robust.</p>\n\n<p>Edited to move across columns rather than down rows.</p>\n\n<pre><code>For i = 0 To UBound(FullName)\n    Range(\"A1\").Offset(,i + 1).Value = FullName(i)\nNext i\n</code></pre>\n\n<p>That said, you can avoid a loop altogether and use</p>\n\n<pre><code>Range(\"B1\").Resize(, UBound(FullName) + 1).Value = FullName\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "edited": false, "score": 0, "creation_date": 1549476337, "post_id": 54559860, "comment_id": 95919124, "body": "Hi Wilhelm, thanks for responding to my question. When I run this it is split my text into different rows. Ideally, I would like the column A text to be split into columns A, B and C and then for the macro to go to the next row to do the same thing."}, {"owner": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "edited": false, "score": 0, "creation_date": 1549476512, "post_id": 54559860, "comment_id": 95919212, "body": "Also, the text that I am splitting all looks similar to this &quot;14912E33 190205 099.7920                                                       &quot;. It has 55 spaces at the end which I think is also throwing my code off. I have a macro that copies this text from a .TXT file which is why it looks goofy."}], "tags": [], "owner": {"reputation": 168, "user_id": 6619157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpzjW.png?s=128&g=1", "display_name": "Wilhelm", "link": "https://stackoverflow.com/users/6619157/wilhelm"}, "is_accepted": false, "score": 0, "last_activity_date": 1549476024, "creation_date": 1549476024, "answer_id": 54559860, "question_id": 54559571, "link": "https://stackoverflow.com/questions/54559571/how-to-split-text-and-loop-to-next-row/54559860#54559860", "title": "How to Split text and loop to next row", "body": "<pre><code>Sub Split_Text_Test1()\n\nDim Txt As String\nDim i As Integer\nDim FullName As Variant\nDim R As Integer, C As Integer\nRange(\"A1\").Select ' assumes that the cells below that are empty \n\nTxt = ActiveCell.Value\n\nFullName = Split(Txt, \" \")\nR = ActiveCell.Row\nC = ActiveCell.Column\nFor i = 0 To UBound(FullName)\n    Cells(R + 1 + i, C).Value = FullName(i)\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1549523817, "post_id": 54560481, "comment_id": 95934234, "body": "Note that row couting variables should always be of type <code>Long</code> because Excel has more rows than <code>Integer</code> can handle <code>Dim R As Long</code>. I recommend <a href=\"https://stackoverflow.com/a/26409520/3219613\">always to use Long instead of Integer</a> in VBA since there is no benefit in <code>Integer</code> at all. \u2022 <code>MaxR</code> is declared but never used."}], "tags": [], "owner": {"reputation": 168, "user_id": 6619157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpzjW.png?s=128&g=1", "display_name": "Wilhelm", "link": "https://stackoverflow.com/users/6619157/wilhelm"}, "is_accepted": true, "score": 0, "last_activity_date": 1549478522, "creation_date": 1549478522, "answer_id": 54560481, "question_id": 54559571, "link": "https://stackoverflow.com/questions/54559571/how-to-split-text-and-loop-to-next-row/54560481#54560481", "title": "How to Split text and loop to next row", "body": "<p>In this case I would use a loop (and your solution was not that far from this):</p>\n\n<pre><code>Dim Txt As String\nDim i As Integer\nDim FullName As Variant\nDim R As Integer, C As Integer, MaxR as Integer\nC = 1 ' can be another loop as well\nFor R = 1 to 1000\n\nTxt = Trim(Cells(r,1).Value) ' will remove space from start and end\nFullName = Split(Txt, \" \")\n\nFor i = 0 To UBound(FullName)\n    Cells(R , C + 1 + i ).Value = FullName(i)\nNext i\n\nNext R\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10392408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc12af2326263ddf9840adedb8efd0b?s=128&d=identicon&r=PG&f=1", "display_name": "tomi09pl", "link": "https://stackoverflow.com/users/10392408/tomi09pl"}, "is_accepted": false, "score": 0, "last_activity_date": 1549479530, "creation_date": 1549479530, "answer_id": 54560746, "question_id": 54559571, "link": "https://stackoverflow.com/questions/54559571/how-to-split-text-and-loop-to-next-row/54560746#54560746", "title": "How to Split text and loop to next row", "body": "<p>I added few thing to your code, see if that serves your purpose. However, as SJR said Text to columns option in Data menu would do the same with less effort. </p>\n\n<pre><code>Sub Split_Text_Test1()\n\nDim Txt As String\nDim i As Integer\nDim FullName As Variant\nDim lastRow As Long\nDim myRange As Range\n\nWith ActiveSheet.UsedRange\n        lastRow = .Rows(.Rows.Count).Row\nEnd With\nDebug.Print lastRow\n\n'Range(\"A1\").Select\n\nSet myRange = ActiveSheet.Range(\"A1\", \"A\" &amp; lastRow)\n\n    For Each cell In myRange\n\n        Txt = cell.Value\n\n        FullName = Split(Txt, \" \")\n\n            For i = 0 To UBound(FullName)\n                Cells(cell.Row, i + 1).Value = FullName(i)\n            Next i\n    Next cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 54560481, "answer_count": 4, "score": 0, "last_activity_date": 1549523617, "creation_date": 1549474885, "last_edit_date": 1549523617, "question_id": 54559571, "link": "https://stackoverflow.com/questions/54559571/how-to-split-text-and-loop-to-next-row", "title": "How to Split text and loop to next row", "body": "<p>I'm using the split function to split text using spaces. I have gotten my macro to split the text but I am having difficulties getting the loop to move to the next row below to split.</p>\n\n<pre><code>Sub Split_Text_Test1()\n\nDim Txt As String\nDim i As Integer\nDim FullName As Variant\n\nRange(\"A1\").Select\n\nTxt = ActiveCell.Value\n\nFullName = Split(Txt, \" \")\n\nFor i = 0 To UBound(FullName)\n    Cells(1, i + 1).Value = FullName(i)\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium", "web-scraping", "drop-down-menu"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549475296, "post_id": 54559497, "comment_id": 95918677, "body": "where is the html for the options list ? Are you unable to copy as you mention above?"}, {"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549475823, "post_id": 54559497, "comment_id": 95918919, "body": "Just now I had that strike, so I did a &#39;Find&quot; option in the developer window and pasted the code to my question. This is not a public site so I am sorry it cannot be shared."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549476047, "post_id": 54559497, "comment_id": 95919010, "body": "You will need to switch to the iframe first"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1549478246, "post_id": 54559934, "comment_id": 95919968, "body": "This code works like magic bot.ExecuteScript &quot;document.getElementById(&#39;x&#39;).value = &#39;xx&#39;;&quot; But do you know where I can learn more about this as I do not know Javascript. and it is a surprise to me that Javascript can be used in VBA."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1549478448, "post_id": 54559934, "comment_id": 95920070, "body": "It is not considered best practice from testing a websites functionality point of view in automation but I am usually more concerned about getting the job done in a consistent manner."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1549478773, "post_id": 54559934, "comment_id": 95920226, "body": "Not at all. Purists will want everything done by automating button pushing etc... I have cheated by running javascript to achieve the end goal. If you were testing the website functionality you would, however, want to be sure you could make selections from the dropdown via automation of click etc....."}, {"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1549478946, "post_id": 54559934, "comment_id": 95920310, "body": "Glad to hear it, Do you have any links to learn about this or is it entirely different subject where I have learn java first?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1549479109, "post_id": 54559934, "comment_id": 95920397, "body": "It is javascript not java. And knowing enough javascript to write statements like the above I think is a real bonus for web-scraping. I think it is also helpful for debugging pages, understanding what a webpage is doing. The line above is basically the same as you do in vba so no real learning curve there apart from knowing how to phrase it in the javascript way and wrap it in .execute statement. Doing a couple of beginner javascript lessons and knowing your vba scraping well should be enough for the simple cases."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1549476351, "creation_date": 1549476351, "answer_id": 54559934, "question_id": 54559497, "link": "https://stackoverflow.com/questions/54559497/unable-to-select-a-value-from-dropdown-in-webpage-using-selenium-vba/54559934#54559934", "title": "Unable to select a value from dropdown in webpage using selenium VBA", "body": "<p>Some points that may help:</p>\n\n<p>1) If inside an iframe you will need to switch to the iframe first</p>\n\n<pre><code>bot.SwitchToFrame(identifier)\n</code></pre>\n\n<p>Identifier can be the element selected by iframe name/id etc.</p>\n\n<p>2) You can try click and hold on the input text box before using your SendKeys</p>\n\n<pre><code>bot.FindElementById(\"x\").ClickAndHold\n'sendkeys line here\n</code></pre>\n\n<p>3) You can try setting the value with javascript</p>\n\n<pre><code>bot.ExecuteScript \"document.getElementById('x').value = 'xx';\"\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1088, "favorite_count": 0, "accepted_answer_id": 54559934, "answer_count": 1, "score": 1, "last_activity_date": 1549476351, "creation_date": 1549474644, "last_edit_date": 1549475810, "question_id": 54559497, "link": "https://stackoverflow.com/questions/54559497/unable-to-select-a-value-from-dropdown-in-webpage-using-selenium-vba", "title": "Unable to select a value from dropdown in webpage using selenium VBA", "body": "<p>I am trying to select a value from a dropdown in a web page using Seleinum with VBA binding, but I am unable to do it.</p>\n\n<p>This is the code I tried <code>bot.FindElementById(\"holder-samples-date-type-inputEl\").SendKeys \"XX\"</code> </p>\n\n<p>I am not getting any error the code runs it click the dropdown button and the list is shown but no value is selected and the dropdown does not change. </p>\n\n<p>I have the same project with VBA and IE (DOM elements) and this code works fine in Internet explorer <code>IE.document.getElementById(\"holder-samples-date-type-inputEl\").Value = \"XX\"</code></p>\n\n<p>The interesting part of this dropdown is after clicking the dropdown icon i am unable to inspect the list (like do a right click on the list) and if i click anywhere else in the web page or change the window the dropdown list get closed (like it retracts) note: this is not a mouseover drop down. Also, when the list is open there seems to be additional code added (I have pasted a snippet of the code)</p>\n\n<p>Below is the HTML from the web page.</p>\n\n<pre><code>&lt;div id=\"holder-samples-date-type-triggerWrap\" data-ref=\"triggerWrap\" class=\"x-form-trigger-wrap x-form-trigger-wrap-default x-form-trigger-wrap-invalid\"&gt;\n&lt;div id=\"holder-samples-date-type-inputWrap\" data-ref=\"inputWrap\" class=\"x-form-text-wrap x-form-text-wrap-default x-form-text-wrap-invalid\"&gt;&lt;input id=\"holder-samples-date-type-inputEl\" data-ref=\"inputEl\" type=\"text\" role=\"combobox\" aria-label=\"Chargebacks: Date Type\" aria-readonly=\"false\" aria-required=\"true\" aria-haspopup=\"true\" aria-expanded=\"false\" aria-autocomplete=\"list\" size=\"1\" name=\"P_samples_Date_Type\" readonly=\"readonly\" class=\"x-form-field x-form-required-field x-form-text x-form-text-default  x-form-invalid-field x-form-invalid-field-default\" autocomplete=\"off\" aria-labelledby=\"holder-samples-date-type-labelEl\" aria-owns=\"boundlist-1206\" componentid=\"holder-samples-date-type\" data-errorqtip=\"&lt;ul class=&amp;quot;x-list-plain&amp;quot;&gt;&lt;div&gt;Date Type&lt;/div&gt;&lt;li&gt;This field is required&lt;/li&gt;&lt;/ul&gt;\" aria-invalid=\"true\"&gt;&lt;/div&gt;\n&lt;div id=\"holder-samples-date-type-trigger-picker\"\naria-label=\"Trigger\" class=\"x-form-trigger x-form-trigger-default x-form-arrow-trigger x-form-arrow-trigger-default \"&gt;&lt;img class=\"combo-trigger-placeholder\" src=\"https://www.sample.net/clr/images/16x16_transparent.png\" title=\"combobox trigger\" alt=\"combobox trigger\"&gt;&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Below is the image\n<a href=\"https://i.stack.imgur.com/q3Hud.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q3Hud.png\" alt=\"enter image description here\"></a></p>\n\n<p>Since I am unable to do a right click on the dropdown option. I did a 'Find\" option in the developer window and below is the webpage code for the dropdown item and it is inside a iframe</p>\n\n<pre><code>&lt;div id=\"boundlist-1206-listWrap\" data-ref=\"listWrap\" role=\"presentation\" class=\"x-boundlist-list-ct x-unselectable\" style=\"overflow: auto; height: auto;\"&gt;\n  &lt;ul id=\"boundlist-1206-listEl\" data-ref=\"listEl\" class=\"x-list-plain\"&gt;\n    &lt;div data-qtip=\"\" class=\"x-boundlist-item x-boundlist-item-over\" tabindex=\"-1\" data-recordindex=\"0\" data-recordid=\"31\" data-boundview=\"boundlist-1206\" id=\"ext-932\" role=\"option\" aria-selected=\"false\"&gt;Received Date&lt;/div&gt;\n    &lt;div data-qtip=\"\" class=\"x-boundlist-item\" tabindex=\"-1\" data-recordindex=\"1\" data-recordid=\"32\" data-boundview=\"boundlist-1206\" id=\"ext-933\" role=\"option\" aria-selected=\"false\"&gt;Status Date&lt;/div&gt;\n    &lt;div data-qtip=\"\" class=\"x-boundlist-item\" tabindex=\"-1\" data-recordindex=\"2\" data-recordid=\"33\" data-boundview=\"boundlist-1206\" id=\"ext-934\" role=\"option\" aria-selected=\"false\"&gt;Due Date&lt;/div&gt;\n    &lt;div data-qtip=\"\" class=\"x-boundlist-item\" tabindex=\"-1\" data-recordindex=\"3\" data-recordid=\"34\" data-boundview=\"boundlist-1206\" id=\"ext-935\" role=\"option\" aria-selected=\"false\"&gt;Disposition Date&lt;/div&gt;\n  &lt;/ul&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1549474903, "post_id": 54559484, "comment_id": 95918499, "body": "I&#39;m confused as to what you&#39;re trying to do - <i>&quot;What I want is if Rng1 is not with in Range1 then goto the next rng1.&quot;</i> - your code is already doing that, no? It sounds like you need an <code>Exit For</code> somewhere? Also, for the sanity of yourself and others, you should really use more descriptive variables than <code>Rng1</code> and <code>Range1</code> - talk about confusing! :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11024211"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1549475152, "post_id": 54559484, "comment_id": 95918616, "body": "Sorry, if rng1 is not in range1 then goto the next rng1. untimatly what I am trying to do is eliminate the possibility of the user selecting a cell or range of cells outside of the defined range, range1."}], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1549487810, "post_id": 54559748, "comment_id": 95924214, "body": "A valid intersection between two ranges doesn\u2019t ensure one of them is completely contained in the other"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1549498106, "post_id": 54559748, "comment_id": 95927767, "body": "I know that, but that wasn&#39;t a requirement in the OP&#39;s question."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1549522016, "post_id": 54559748, "comment_id": 95933503, "body": "I\u2019m referring to her comment <i>\u201duntimatly what I am trying to do is eliminate the possibility of the user selecting a cell or range of cells outside of the defined range, range1\u201d</i>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1549524084, "post_id": 54559748, "comment_id": 95934345, "body": "I was following the general logic of the code the OP posted, and &quot;What I want is if Rng1 is not with in Range1 then goto the next rng1&quot; - seemed like the aim was to only process cells within the desired range.  The whole thing is a little unclear though."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1549475592, "creation_date": 1549475592, "answer_id": 54559748, "question_id": 54559484, "link": "https://stackoverflow.com/questions/54559484/exit-if-and-next-for/54559748#54559748", "title": "Exit If and Next For", "body": "<pre><code>Sub me_test()\n\n    Dim Range1 As Range\n    Dim Rng1 As Range\n\n    Set Range1 = Application.Selection\n\n    Set Range1 = Application.InputBox(\"Please Select Your Range :\", xtitledID, _\n                                       Range1.Address, Type:=8)\n\n    Set Range1 = Application.Intersect(Range1, ActiveSheet.Range(\"B7:B15\"))\n\n    If Range1 is nothing then\n         MsgBox \"No valid cells selected!\"\n    else\n         Range1.Value = \"Good\"\n    end if \n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1549476005, "creation_date": 1549476005, "answer_id": 54559857, "question_id": 54559484, "link": "https://stackoverflow.com/questions/54559484/exit-if-and-next-for/54559857#54559857", "title": "Exit If and Next For", "body": "<p>This should work. It works on my end</p>\n\n<pre><code>Sub me_test()\n\n    Dim Range1 As Range\n    Dim Rng1 As Range\n    Dim rngIntr As Range\n\n    Set Range1 = Application.Selection\n    Set Range1 = Application.InputBox(\"Please Select Your Range :\", xtitledID, Range1.Address, Type:=8)\n\n\n    For Each Rng1 In Range1\n        Set rngIntr = Intersect(Rng1.Cells, Range(\"B7:B15\").Cells)\n        If rngIntr Is Nothing Then\n            MsgBox \"Not within the perscribed range.\" &amp; vbCr &amp; \"Please click OK to continue.\"\n        Else\n            Rng1.Value = \"Good\"\n        End If\n        Set rngInr = Nothing\n    Next\n\n    Set Range1 = Nothing\n    Set Rng1 = Nothing\n\n    MsgBox \"All Done\"\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "is_accepted": false, "score": 0, "last_activity_date": 1549484737, "creation_date": 1549484737, "answer_id": 54561997, "question_id": 54559484, "link": "https://stackoverflow.com/questions/54559484/exit-if-and-next-for/54561997#54561997", "title": "Exit If and Next For", "body": "<p>How about this: Only show the \"Not within...\" Msgbox if <strong>none</strong> of the selected cells are within the desired range. Otherwise continue to iterate through the selection and write <em>Good</em> in every cell that is intersecting with the desired range.</p>\n\n<pre><code>Sub me_test2()\n\nDim Range1 As Range\nDim Rng1 As Range\nSet Range1 = Application.Selection\nSet Range1 = Application.InputBox(\"Please Select Your Range :\", xtitledID, Range1.Address, Type:=8)\n\nIf Intersect(Range(\"B7:B15\"), Range1) Is Nothing Then\n    MsgBox \"Not within the perscribed range.\" &amp; vbCr &amp; \"Please click OK to continue.\"\nElse\n    For Each Rng1 In Range1\n        If Not Intersect(Rng1, Range(\"B7:B15\")) Is Nothing Then\n            Rng1.Value = \"Good\"\n        End If\n    Next\n    MsgBox \"All Done\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1549487512, "creation_date": 1549487512, "answer_id": 54562622, "question_id": 54559484, "link": "https://stackoverflow.com/questions/54559484/exit-if-and-next-for/54562622#54562622", "title": "Exit If and Next For", "body": "<p>Maybe:</p>\n\n<pre><code>Sub me_test()\n    Dim rng1 As Range\n\n    Set rng1 = Application.InputBox(\"Please Select Your Range :\", xtitledID, Selection.Address, Type:=8)\n\n    If Union(rng1, Range(\"B7:B15\")).Address =  Range(\"B7:B15\").Address Then \n        rng1.Value = \"Good\"\n    Else\n        MsgBox \"Not within the perscribed range.\" &amp; vbCr &amp; \"Please click OK to continue.\"\n    End If\n\n    MsgBox \"All Done\"\n\nEnd Sub\n</code></pre>\n\n<p>You may also want to check for a valid used range selection:</p>\n\n<pre><code>Sub me_test()\n    Dim rng1 As Range\n\n    Do \n        Set rng1 = Application.InputBox(\"Please Select Your Range :\", xtitledID, Selection.Address, Type:=8)\n    Loop While rng1 Is Nothing\n\n    If Union(rng1, Range(\"B7:B15\")).Address =  Range(\"B7:B15\").Address Then \n        rng1.Value = \"Good\"\n    Else\n        MsgBox \"Not within the perscribed range.\" &amp; vbCr &amp; \"Please click OK to continue.\"\n    End If\n\n    MsgBox \"All Done\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11024211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1549523610, "creation_date": 1549474595, "last_edit_date": 1549523610, "question_id": 54559484, "link": "https://stackoverflow.com/questions/54559484/exit-if-and-next-for", "title": "Exit If and Next For", "body": "<p>I have a for next loop with an if statement. If the \"If statement\" is true then exit the if and next for.  Here is the code:  What I want is if Rng1 is not with in Range1 then goto the next rng1.  I seems like a simple solution, but I cannot figure is out.  Thank you in advance.</p>\n\n<pre><code>Sub me_test()\n\nDim Range1 As Range\nDim Rng1 As Range\nSet Range1 = Application.Selection\nSet Range1 = Application.InputBox(\"Please Select Your Range :\", xtitledID, Range1.Address, Type:=8)\n\n    For Each Rng1 In Range1\n        If Intersect(Rng1, Range(\"B7:B15\")) Is Nothing Then\n            MsgBox \"Not within the perscribed range.\" &amp; vbCr &amp; \"Please click OK to continue.\"\n        Else\n            Rng1.Value = \"Good\"\n        End If\n    Next\n\nMsgBox \"All Done\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10902020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72df090af10225d1ac2d33d98ec5d8dc?s=128&d=identicon&r=PG&f=1", "display_name": "RFC", "link": "https://stackoverflow.com/users/10902020/rfc"}, "edited": false, "score": 1, "creation_date": 1549474779, "post_id": 54559432, "comment_id": 95918426, "body": "This works. thanks. so the WorksheetFunction is for a single cell. ok, I see."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1549474818, "last_edit_date": 1549474818, "creation_date": 1549474444, "answer_id": 54559432, "question_id": 54559324, "link": "https://stackoverflow.com/questions/54559324/using-application-worksheetfunction-trim-to-trim-a-range-of-cells/54559432#54559432", "title": "Using Application.WorksheetFunction.Trim to trim a range of cells", "body": "<p><code>Trim()</code> expects string argument. The argument in <code>Application.WorksheetFunction.Trim  (rng)</code> is a Range, which can be parsed to a string, only if the range consists of a single cell.</p>\n\n<p>To <code>Trim()</code> all cells in a given range, they should be looped:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim myCell As Range\n    For Each myCell In Worksheets(1).Range(\"A1:A5\")\n        myCell = WorksheetFunction.Trim(myCell)\n    Next myCell\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 371, "user_id": 10728181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001838e711c4ea4a5e89a9d42b753f2e?s=128&d=identicon&r=PG&f=1", "display_name": "xyz333", "link": "https://stackoverflow.com/users/10728181/xyz333"}, "edited": false, "score": 1, "creation_date": 1581021352, "post_id": 54559480, "comment_id": 106300720, "body": "On my large dataset the loop to 43 sec while Evaluate finished in the blink of an eye"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1549474945, "last_edit_date": 1549474945, "creation_date": 1549474589, "answer_id": 54559480, "question_id": 54559324, "link": "https://stackoverflow.com/questions/54559324/using-application-worksheetfunction-trim-to-trim-a-range-of-cells/54559480#54559480", "title": "Using Application.WorksheetFunction.Trim to trim a range of cells", "body": "<p>Your code doesn't work because you need to loop through each cell, you can't do them all in one go</p>\n\n<pre><code>Dim rng As Range, r as range\nDim myanswer\n\nSet rng = ActiveSheet.Range(\"T2:T10\")\nfor each r in rng    \n     r.value=Application.WorksheetFunction.Trim(r)\nnext r\n</code></pre>\n\n<p>You can avoid a loop using Evaluate</p>\n\n<pre><code>Sub x()\n\nDim r As Range\n\nSet r = Range(\"T2:T10\")\n\nr = Evaluate(\"IF(\" &amp; r.Address &amp; \"=\"\"\"\",\"\"\"\",TRIM(\" &amp; r.Address &amp; \"))\")\n\nEnd Sub\n</code></pre>\n\n<p>Note that the worksheet function TRIM removes superfluous internal spaces whereas VBA Trim only removes leading and trailing spaces (you had this covered anyway).</p>\n"}], "owner": {"reputation": 23, "user_id": 10902020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72df090af10225d1ac2d33d98ec5d8dc?s=128&d=identicon&r=PG&f=1", "display_name": "RFC", "link": "https://stackoverflow.com/users/10902020/rfc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1271, "favorite_count": 0, "accepted_answer_id": 54559432, "answer_count": 2, "score": 1, "last_activity_date": 1549474945, "creation_date": 1549474034, "last_edit_date": 1549474129, "question_id": 54559324, "link": "https://stackoverflow.com/questions/54559324/using-application-worksheetfunction-trim-to-trim-a-range-of-cells", "title": "Using Application.WorksheetFunction.Trim to trim a range of cells", "body": "<p>I'm trying to Trim a range of cells using the <code>Application.WorksheetFunction.Trim</code>.  I'm trying to define my range, but I get a type mismatch error</p>\n\n<p>I created Dim and set my range and created a variable for the function.</p>\n\n<pre><code>Dim rng As Range\nDim myanswer\n\nSet rng = ActiveSheet.Range(\"T2:T10\")\nmyanswer = Application.WorksheetFunction.Trim(rng)\n</code></pre>\n\n<p>Here's another one of my codes</p>\n\n<pre><code>Dim rng As Range\nDim LastRow As Long\n\nLastRow = Cells(Rows.Count, \"T\").End(xlUp).Row\nSet rng = Range(\"T2:T\" &amp; LastRow)\n\nApplication.WorksheetFunction.Trim (rng)\n</code></pre>\n\n<p>I want it to trim each of cells to get rid extra spaces.</p>\n\n<p>Also tried using this but get out of memory.</p>\n\n<pre><code>rng = Application.WorksheetFunction.Trim(Cells.Value)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1549474090, "post_id": 54559264, "comment_id": 95918117, "body": "You&#39;re doing way too many date checks.  Based on the code, you only need to test <code>Year(date1) = Year(Date) - 1 And Year(date2) &lt;&gt;  Year(date1)</code>, and only test that <i>once</i>."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1549474164, "post_id": 54559264, "comment_id": 95918165, "body": "Show some source and expected results - perhaps the correct output is 0..."}, {"owner": {"reputation": 45, "user_id": 8045777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a30403171d8756bd1b2ae389815fd3?s=128&d=identicon&r=PG&f=1", "display_name": "Snehil", "link": "https://stackoverflow.com/users/8045777/snehil"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1549477098, "post_id": 54559264, "comment_id": 95919442, "body": "@SolarMike I have added a sample output picture under the code. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8045777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a30403171d8756bd1b2ae389815fd3?s=128&d=identicon&r=PG&f=1", "display_name": "Snehil", "link": "https://stackoverflow.com/users/8045777/snehil"}, "edited": false, "score": 0, "creation_date": 1549477068, "post_id": 54560072, "comment_id": 95919428, "body": "Thanks for the answer. I have added a sample output that I require under my question. If that could clear things up?"}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1549476907, "creation_date": 1549476907, "answer_id": 54560072, "question_id": 54559264, "link": "https://stackoverflow.com/questions/54559264/using-yeardate-in-if-statement-but-no-output/54560072#54560072", "title": "Using Year(Date) in IF statement but no output", "body": "<p>In the following code that you supplied you have:</p>\n\n<pre><code>            If Year(date2) = Year(Date) - 1 And Cells(j, 37).Interior.ColorIndex = 6 Then\n                Cells(j, 12).Value = \"New\"\n                If Year(date2) = Year(Date) - 1 And Cells(j, 37).Interior.ColorIndex &lt;&gt; 6 Then\n                    Cells(j, 12).Value = \"Major\"\n                Else\n                    Cells(j, 12).Value = \"\"\n                End If\n            End If\n</code></pre>\n\n<p>Where you get into the first if statement because <code>cells(j,37).interior.colorindex = 6</code>, but then, you do a check where <code>cells(j,37).interior.colorindex &lt;&gt; 6</code>.</p>\n\n<p>The conflict here is that it will always set <code>cells(j,12).value = \"\"</code>.  Either your first cell reference is off or your second reference is off. Another possibility is that you need to change one of the <code>colorindex</code> values.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 8045777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a30403171d8756bd1b2ae389815fd3?s=128&d=identicon&r=PG&f=1", "display_name": "Snehil", "link": "https://stackoverflow.com/users/8045777/snehil"}, "edited": false, "score": 0, "creation_date": 1549482588, "post_id": 54561045, "comment_id": 95921983, "body": "Thank you! @IrwinAllen13 The code run without any errors when I press the CommandButton1 from my excel sheet but it will not bring any data in Column &#39;L&#39; . So, I tried to execute that particular function line by line using the debugger and it works well but, it doesn&#39;t output data to cells on clicking Commandbutton1."}], "tags": [], "owner": {"reputation": 487, "user_id": 10946960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4b4b026d8ded0102e23e33a72bc79d?s=128&d=identicon&r=PG&f=1", "display_name": "IrwinAllen13", "link": "https://stackoverflow.com/users/10946960/irwinallen13"}, "is_accepted": false, "score": 0, "last_activity_date": 1549480748, "creation_date": 1549480748, "answer_id": 54561045, "question_id": 54559264, "link": "https://stackoverflow.com/questions/54559264/using-yeardate-in-if-statement-but-no-output/54561045#54561045", "title": "Using Year(Date) in IF statement but no output", "body": "<p>From your description, I believe you have too many if statements. You also have an if statement nested inside another if statement. </p>\n\n<pre><code>Dim j, lastrow As Long\nDim ws1, wb As Worksheet\nDim wbk As Workbook\nDim dateAL, dateAM As Date\nDim colorID As Variant\n\nSet wbk = Application.Workbooks(\"MaxiTrak RV Service Report - Blank.xlsm\")\nSet ws1 = wbk.Worksheets(\"ML_PSV_SERVICE\")\n\nlastrow = ws1.Range(\"AL\" &amp; Rows.Count).End(xlUp).Row\ncurrentyear = Year(Date)\n\nFor j = 2 To lastrow\n\n    dateAL = Year(ws1.Cells(j, 38).Value) ' column AL\n    dateAM = Year(ws1.Cells(j, 39).Value) ' column AM\n    colorID = ws1.Cells(j, 37).Interior.ColorIndex\n\n    If dateAL = currentyear - 1 And dateAM &lt;&gt; currentyear - 1 Then\n        Cells(j, 12).Value = \"Routine\"\n    Else\n        If dateAM = currentyear - 1 And colorID = 6 Then\n            Cells(j, 12).Value = \"New\"\n        Else\n            Cells(j, 12).Value = \"Major\"\n        End If\n    End If\n\nNext j\n</code></pre>\n\n<p>Try the above code, but please review the code FIRST.</p>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1549524434, "creation_date": 1549524434, "answer_id": 54568263, "question_id": 54559264, "link": "https://stackoverflow.com/questions/54559264/using-yeardate-in-if-statement-but-no-output/54568263#54568263", "title": "Using Year(Date) in IF statement but no output", "body": "<p>Try code below, it's pretty simple and self-explanatory:</p>\n\n<pre><code>Sub Compare()\n    Dim lastRow As Long, i As Long\n    lastRow = Range(\"AK\" &amp; Rows.Count).End(xlUp).Row\n    For i = 1 To lastRow\n        If Year(Range(\"AM\" &amp; i)) &lt;&gt; 2018 Then\n            If Year(Range(\"AL\" &amp; i)) = 2018 Then Range(\"L\" &amp; i) = \"Routine\"\n        ' column AM has year equal to 2018\n        ElseIf Range(\"AK\" &amp; i).Interior.ColorIndex = 6 Then\n            Range(\"L\" &amp; i) = \"New\"\n        Else\n            Range(\"L\" &amp; i) = \"Major\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8045777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a30403171d8756bd1b2ae389815fd3?s=128&d=identicon&r=PG&f=1", "display_name": "Snehil", "link": "https://stackoverflow.com/users/8045777/snehil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 54568263, "answer_count": 3, "score": 0, "last_activity_date": 1549525901, "creation_date": 1549473873, "last_edit_date": 1549525901, "question_id": 54559264, "link": "https://stackoverflow.com/questions/54559264/using-yeardate-in-if-statement-but-no-output", "title": "Using Year(Date) in IF statement but no output", "body": "<p>I am trying to grab data from three columns in my workbook <code>AK</code>,<code>AL</code> and AM respectively. After getting the data I am doing 3 different comparisons which are stated in the code below. </p>\n\n<p>Firstly, I am comparing the date in Column <code>AL</code> and Column <code>AM</code>. I am checking if Column <code>AL</code> is of year 2018 and Column <code>AM</code> is not of year 2018. If its true then It will insert text in Column <code>L</code> called \"Routine\". This is done cell by cell using a for loop as seen in the code. </p>\n\n<p>Next, there is a check if Column <code>AM</code> is of year 2018 and Column <code>AK</code> is color coded to <em>Yellow</em> color. If it is true then text will be inserted in Column <code>L</code> called \"New\".</p>\n\n<p>Lastly, there is a check if Column <code>AM</code> is of year 2018 and Column <code>AK</code> is not colored in <em>Yellow</em>. If it is true then text will be inserted in Column 'L' called \"Major\"</p>\n\n<p>Else, The cell will be left blank without any data inserted.</p>\n\n<p>PROBLEM: The code runs fine and there are no issues or errors. But I am not able to get the output I want. The code does not insert any text in the Column <code>L</code></p>\n\n<pre><code>Dim j As Long\nDim lastrow As Long\nDim ws1 As Worksheet\nDim wbk As Workbook\nDim wb As Worksheet\nDim date1 As Date, date2 As Date\n\nSet wbk = Application.Workbooks(\"MaxiTrak RV Service Report - Blank.xlsm\")\nSet ws1 = wbk.Worksheets(\"ML_PSV_SERVICE\")\n\nlastrow = ws1.range(\"AL\" &amp; Rows.Count).End(xlUp).Row\n\n    For j = 2 To lastrow\n\n    date1 = ws1.Cells(j, 38).Value\n    date2 = ws1.Cells(j, 39).Value\n\n        If Year(date1) = Year(Date) - 1 And Year(date2) &lt;&gt; Year(Date) - 1 Then\n            Cells(j, 12).Value = \"Routine\"\n            If Year(date2) = Year(Date) - 1 And Cells(j, 37).Interior.ColorIndex = 6 Then\n                Cells(j, 12).Value = \"New\"\n                If Year(date2) = Year(Date) - 1 And Cells(j, 37).Interior.ColorIndex &lt;&gt; 6 Then\n                    Cells(j, 12).Value = \"Major\"\n                Else\n                    Cells(j, 12).Value = \"\"\n                End If\n            End If\n        End If\n    Next j\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KvhOo.png\" rel=\"nofollow noreferrer\">Sample Output expected</a></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1549474009, "post_id": 54558825, "comment_id": 95918057, "body": "Your do While look is doing multiple additions of the same bookmark.  Is this what you want.  Only the last added bookmark will survive."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11024034, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aJMGPrpN2KU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP9eS1cC_fhWZNLFi50F8xrgVlTug/mo/photo.jpg?sz=128", "display_name": "Emma ", "link": "https://stackoverflow.com/users/11024034/emma"}, "edited": false, "score": 0, "creation_date": 1549621668, "post_id": 54559021, "comment_id": 95977043, "body": "Thank you. it makes perfect sense now. really appreciate your help. can&#39;t thank you enough"}], "tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": false, "score": 0, "last_activity_date": 1549473378, "last_edit_date": 1549473378, "creation_date": 1549473050, "answer_id": 54559021, "question_id": 54558825, "link": "https://stackoverflow.com/questions/54558825/how-do-i-resolve-runtime-error-5479-when-trying-to-select-multiple-documents/54559021#54559021", "title": "How do I resolve runtime error 5479 when trying to select multiple documents?", "body": "<p>You are attempting to save and close the document while still in the middle of a search. It seems that this behaves as if the find dialog box is still open and prevents the document closing properly, which then prevents the next document being loaded. Try moving save and close outside the <code>While</code> loop:</p>\n\n<pre><code>For nDocx = 1 To dlgFile.SelectedItems.Count\n\n  Documents.Open dlgFile.SelectedItems(nDocx)\n  MsgBox (ActiveDocument)\n  Set objDocx = ActiveDocument\n\n  Set myRange = ActiveDocument.Content\n  With myRange.Find\n    Do While .Execute(FindText:=\"TBC\", MatchCase:=True)\n      ActiveDocument.Bookmarks.Add Name:=\"UMR\", Range:=myRange\n      myRange.Select\n    Loop\n  End With\n  objDocx.Save\n  objDocx.Close\n  Set objDocx = Nothing\nNext nDocx\n</code></pre>\n\n<p>(this works in Word 2016, but I do get slightly different behaviour with your original code - all the documents stay open but with no runtime errors. I don't have 2013 here to check.)</p>\n"}], "owner": {"reputation": 11, "user_id": 11024034, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aJMGPrpN2KU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP9eS1cC_fhWZNLFi50F8xrgVlTug/mo/photo.jpg?sz=128", "display_name": "Emma ", "link": "https://stackoverflow.com/users/11024034/emma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1549473378, "creation_date": 1549472390, "last_edit_date": 1549473279, "question_id": 54558825, "link": "https://stackoverflow.com/questions/54558825/how-do-i-resolve-runtime-error-5479-when-trying-to-select-multiple-documents", "title": "How do I resolve runtime error 5479 when trying to select multiple documents?", "body": "<p>I attempted to write a macro to find a word and bookmark it and to do this for multiple documents, same word and same bookmark across all documents. However, if I select multiple documents, I get an error that says:</p>\n\n<blockquote>\n  <p>Runtime error 5479<br>\n  You cannot close Microsoft word because a dialogue box is open.</p>\n</blockquote>\n\n<p>I click OK, switch to Word and then close the dialog box. I'm running it in Word 2013 running on Windows 7.</p>\n\n<p>I would expect it to open each Word doc, find the term \"TBC\", add the bookmark UMR, and then save and close the document, then it would open the next document and do the same until it ran out of documents. </p>\n\n<p>What actually happens is it changes the first one, and then I get the runtime error. The line that gets highlighted when I hit debug is:</p>\n\n<pre><code>documents.Open dlgFile.SelectedItems (nDocx)\n</code></pre>\n\n<p>Here is my VBA:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Dim myRange As Range\n  Set dlgFile = Application.FileDialog(msoFileDialogFilePicker)\n\n  With dlgFile\n    dlgFile.AllowMultiSelect = True\n    If .Show = -1 Then\n\n      For nDocx = 1 To dlgFile.SelectedItems.Count\n\n        Documents.Open dlgFile.SelectedItems(nDocx)\n        MsgBox (ActiveDocument)\n        Set objDocx = ActiveDocument\n\n            Set myRange = ActiveDocument.Content\n            With myRange.Find\n                Do While .Execute(FindText:=\"TBC\", MatchCase:=True)\n                   ActiveDocument.Bookmarks.Add Name:=\"UMR\", Range:=myRange\n                   myRange.Select\n                   objDocx.Save\n                   objDocx.Close\n                Loop\n               End With\n            Set objDocx = Nothing\n       Next nDocx\n\nElse\n  MsgBox (\"You need to select documents first!\")\n  Exit Sub\n\nEnd If\n\n  End With\n\n  MsgBox (\"You have added all the bookmarks.\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1549472764, "post_id": 54558675, "comment_id": 95917405, "body": "Not your issue, but you may want to take a look at <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11023771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/POygZ.jpg?s=128&g=1", "display_name": "Vickyyy", "link": "https://stackoverflow.com/users/11023771/vickyyy"}, "edited": false, "score": 0, "creation_date": 1549473291, "post_id": 54558852, "comment_id": 95917688, "body": ".Range.Offset(ROWS2KEEP).Resize(lSize - (ROWS2KEEP - 1)).ClearContents  throws Run-time error &#39;1004&#39;: Application-defined or object-defined error"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 1, "user_id": 11023771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/POygZ.jpg?s=128&g=1", "display_name": "Vickyyy", "link": "https://stackoverflow.com/users/11023771/vickyyy"}, "edited": false, "score": 0, "creation_date": 1549533021, "post_id": 54558852, "comment_id": 95938715, "body": "It ran fine for me, but perhaps your situation i slightly different from my testing setup :-)"}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 1, "last_activity_date": 1549472460, "creation_date": 1549472460, "answer_id": 54558852, "question_id": 54558675, "link": "https://stackoverflow.com/questions/54558675/how-to-dynamically-reference-the-very-last-cell-in-any-given-table/54558852#54558852", "title": "How to dynamically reference the very last cell in any given table?", "body": "<p>Like so:</p>\n\n<pre><code>Sub Bt_clear_tb1()\n    Dim lSize As Long\n    Const ROWS2KEEP As Long = 10\n    'ScreenUpdate\n    Application.ScreenUpdating = False\n    Application.CutCopyMode = False\n\n    'Resize and cleanup\n    With ActiveSheet.ListObjects(\"Table1\")\n        lSize = .ListRows.Count\n        .Resize (.Range.Resize(ROWS2KEEP))\n        .ListColumns(1).DataBodyRange.ClearContents\n        .ListColumns(2).DataBodyRange = \"_ ...\"\n        .ListColumns(3).DataBodyRange = \"_ ...\"\n        .Range.Offset(ROWS2KEEP).Resize(lSize - (ROWS2KEEP - 1)).ClearContents\n    End With\n    'ScreenUpdate\n     Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1549533136, "post_id": 54559898, "comment_id": 95938782, "body": "INstead of adding 1 to ROWS2KEEP two times you could have defined ROWS2KEEP as 21 and omit the two additions :-)"}], "tags": [], "owner": {"reputation": 1, "user_id": 11023771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/POygZ.jpg?s=128&g=1", "display_name": "Vickyyy", "link": "https://stackoverflow.com/users/11023771/vickyyy"}, "is_accepted": true, "score": 0, "last_activity_date": 1549476195, "creation_date": 1549476195, "answer_id": 54559898, "question_id": 54558675, "link": "https://stackoverflow.com/questions/54558675/how-to-dynamically-reference-the-very-last-cell-in-any-given-table/54559898#54559898", "title": "How to dynamically reference the very last cell in any given table?", "body": "<p>Thanks for the hint!</p>\n\n<p>I found out the following solves my problem:</p>\n\n<pre><code>    Sub bt_table_1_clean()\n    'ScreenUpdate\n    Application.ScreenUpdating = False\n    Application.CutCopyMode = False\n\n    '@@@ Resize and cleanup\n     Const ROWS2KEEP As Long = 20\n\n    With ActiveSheet.ListObjects(\"Tab1\")\n        .Resize (.Range.Resize(ROWS2KEEP + 1))\n        .ListColumns(1).DataBodyRange.ClearContents\n        .ListColumns(2).DataBodyRange = ...\n        .ListColumns(3).DataBodyRange = ...\n        .Range.Offset(ROWS2KEEP + 1).Resize(ActiveSheet.UsedRange.Rows.Count).ClearContents\n    End With        \n\n    'ScreenUpdate\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>This is what I needed:</p>\n\n<pre><code>.Range.Offset(ROWS2KEEP + 1).Resize(ActiveSheet.UsedRange.Rows.Count).ClearContents\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 1, "user_id": 11023771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/POygZ.jpg?s=128&g=1", "display_name": "Vickyyy", "link": "https://stackoverflow.com/users/11023771/vickyyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 54559898, "answer_count": 2, "score": 0, "last_activity_date": 1549523591, "creation_date": 1549471869, "last_edit_date": 1549523591, "question_id": 54558675, "link": "https://stackoverflow.com/questions/54558675/how-to-dynamically-reference-the-very-last-cell-in-any-given-table", "title": "How to dynamically reference the very last cell in any given table?", "body": "<p>I'm trying to make a button that resets a given table to it's.. let's say <em>default size and formating</em></p>\n\n<p>I've spent some to get <strong>Range.Resize</strong> property right, but later found out that after <em>resizing</em> or <em>scaling down</em> the table it requires me to clean up everything that's left behind.</p>\n\n<pre><code>...\nSub Bt_clear_tb1()\n    'ScreenUpdate\n    Application.ScreenUpdating = False\n    Application.CutCopyMode = False\n\n    'Resize and cleanup\n    With ActiveSheet.ListObjects(\"Tab1\")\n        .Resize(.Range.Resize(10))\n        .ListColumns(1).DataBodyRange.ClearContents\n        .ListColumns(2).DataBodyRange = _ ...\n        .ListColumns(3).DataBodyRange = _ ...\n    End With\n\n    'Clear the rest | ---\u25ba Don't want it to be fixed \u25c4--- |\n        Range(\"A11\", \"Q11\").Select                   \u25c4--- |\n        Range(Selection, Selection.End(xlDown)).Select \u25c4--|\n        Selection.ClearContents                      \u25c4--- |\n\n    'ScreenUpdate\n     Application.ScreenUpdating = True\nEnd Sub\n...\n</code></pre>\n\n<p>Of course I got it to work manually on a fixed ranges, but I can't find a way to get the target range dynamically. So if I ever decided to move or resize it differently I wouldn't have to keep rewriting the code every time.</p>\n\n<p>Almost thought I got it</p>\n\n<p>like:</p>\n\n<pre><code>wb.ListObjects(1).Range.Cells(.Range.Rows.Count, .Range.Columns.Count).Offset(1,0).Select\n\nRange(Selection, Selection.End(xlToLeft).End(xlDown).Select\nSelection.ClearContents\n</code></pre>\n\n<p>But it's not dynamic.. if I change ListObjects(1) to other table it still clears area below the first one.</p>\n\n<p>Do you know any other way to somehow get the 'Range of an area below the table'?</p>\n\n<p>~also please, excuse my terrible English.. I hope this is readable and somehow makes sense</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1549472116, "post_id": 54558574, "comment_id": 95917061, "body": "This might give you a direction, but selecting part of the text in a cell- I don&#39;t see how you would &quot;hide&quot; it, perhaps make a copy of the cell and use delete to leave the rest, but anyway : <a href=\"https://stackoverflow.com/q/45693602/4961700\">stackoverflow.com/q/45693602/4961700</a>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1549473256, "post_id": 54558574, "comment_id": 95917666, "body": "Loop through all cells, loop through all characters in the cell. If the character&#39;s color is blue, change it to white."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549547061, "post_id": 54558574, "comment_id": 95947103, "body": "As you changed your question to a general approach, I added some examples to my answer. If it helps, please mark it as answer."}], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 2, "last_activity_date": 1549547003, "last_edit_date": 1592644375, "creation_date": 1549473956, "answer_id": 54559292, "question_id": 54558574, "link": "https://stackoverflow.com/questions/54558574/how-to-hide-colored-text-from-excel-using-vba-macro/54559292#54559292", "title": "How to hide colored text from excel using vba macro", "body": "<h1>Hide complete rows or columns</h1>\n<p>You can hide complete rows or columns e. g. by this:</p>\n<pre><code>Worksheet(...).Range(...).EntireRow.Hidden = True\nWorksheet(...).Range(...).EntireColumn.Hidden = True\n</code></pre>\n<p>You can also group rows or columns and set the outline level to hide them:</p>\n<pre><code>Worksheet(...).Range(...).EntireRow.Group\nWorksheet(...).Outline.ShowLevels RowLevels:=1\n</code></pre>\n<p>A single cell can not be hidden (it could only be deleted, but that would move the other cells beneath it).</p>\n<h1>Hide parts of a cell</h1>\n<p>Unfortunately you can <strong>not</strong> hide some characters within a cell like in Microsoft Word by <code>Font.Hidden</code>.<br />\nBut by following code you can change all blue characters to very small white ones.</p>\n<p>As there are many different &quot;blue&quot; colors (not only RGB(0,0,255)), my code checks, if the blue part of the color is higher than the red and green part.</p>\n<pre><code>Private Sub ChangeBlueTextToWhiteText()\n    Dim ws As Worksheet\n    Dim i As Integer\n    Dim c As Range\n    Dim currentColor As Long\n    Dim r As Byte, g As Byte, b As Byte\n    \n    Set ws = ActiveSheet\n    For Each c In ws.UsedRange.Cells\n        If c.Characters.Count &gt; 0 Then\n            For i = 1 To c.Characters.Count\n                \n                currentColor = c.Characters(i, 1).Font.Color\n                If currentColor &lt; 0 Then currentColor = &amp;H1000000 - currentColor\n                r = currentColor Mod 256             ' red part\n                g = currentColor \\ 256 Mod 256       ' green part\n                b = currentColor \\ (2 ^ 16) Mod 256  ' blue part\n                \n                If b &gt; r And b &gt; g Then ' if blue part is largest, then it's kinda &quot;blue&quot;\n                    c.Characters(i, 1).Font.Color = vbWhite\n                End If\n            Next i\n        End If\n    Next c\n    Set ws = Nothing\nEnd Sub\n</code></pre>\n<p>If you want to have the white characters as narrow as possible, you may additionally chose a narrow font and a small font size like this:</p>\n<pre><code>c.Characters(i, 1).Font.Name = &quot;Arial Narrow&quot;\nc.Characters(i, 1).Font.Size = 1\nc.Characters(i, 1).Font.Subscript = True\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5731243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0620a6129afd3370a991ceceb6354921?s=128&d=identicon&r=PG&f=1", "display_name": "NRR", "link": "https://stackoverflow.com/users/5731243/nrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1549709088, "creation_date": 1549471518, "last_edit_date": 1549709088, "question_id": 54558574, "link": "https://stackoverflow.com/questions/54558574/how-to-hide-colored-text-from-excel-using-vba-macro", "title": "How to hide colored text from excel using vba macro", "body": "<p>How to hide text from excel using vba macro?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11024035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fdb8622b4df4cbaef7d30c7debbeb8b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11024035/kyle"}, "edited": false, "score": 1, "creation_date": 1549472037, "post_id": 54558563, "comment_id": 95917014, "body": "Such a silly mistake... thank you for your quick reply, works perfectly!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1549471474, "creation_date": 1549471474, "answer_id": 54558563, "question_id": 54558487, "link": "https://stackoverflow.com/questions/54558487/application-volatile-not-recalculating-functions-when-values-on-another-workbook/54558563#54558563", "title": "Application.Volatile not recalculating functions when values on another workbook are changed", "body": "<p><code>Worksheets(Name)</code> is missing the reference to its workbook.  If you don't reference the workbook Excel assumes <code>ActiveWorkbook</code> which is the one that has focus / is on top. So that is the workbook the user switched to and it probably doesn't have a worksheet called <code>Name</code> and therefore your function errors and returns <code>#VALUE</code>.</p>\n\n<p>Reference to <code>ThisWorkbook</code> which is the workbook the code is running at.</p>\n\n<pre><code>ThisWorkbook.Worksheets(Name)\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11024035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fdb8622b4df4cbaef7d30c7debbeb8b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11024035/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 54558563, "answer_count": 1, "score": 1, "last_activity_date": 1549471474, "creation_date": 1549471230, "question_id": 54558487, "link": "https://stackoverflow.com/questions/54558487/application-volatile-not-recalculating-functions-when-values-on-another-workbook", "title": "Application.Volatile not recalculating functions when values on another workbook are changed", "body": "<p>I have an excel workbook that uses Application.Volatile in three user-defined functions. Below is an example of one of the functions, the other two are very similar. All they do is find a value on a specified worksheet and return the value to a summary worksheet.</p>\n\n<pre><code>Function estimated_commission(client As Range) As Double\n\n    Application.Volatile\n\n    Name = CStr(client.Value)\n    pull_value = Worksheets(Name).Range(\"A500\").End(xlUp).Offset(0, 5).Value\n\n    estimated_commission = pull_value\n\nEnd Function\n</code></pre>\n\n<p>The function works how I intended when the end user only has the workbook that uses the functions open. Calculation options for the workbook are set to Automatic.</p>\n\n<p>The issue comes when the user makes a change to a cell value or saves another workbook. These workbooks have no relation to the workbook with the user-defined functions. When the user re-activates the workbook with the functions, all of the user-defined functions return #VALUE error. Pressing F9 or recalculating the worksheet will remove all the errors and return the correct values.</p>\n\n<p>Is there a way to prevent this issue from occurring?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 4, "creation_date": 1549468889, "post_id": 54557702, "comment_id": 95915175, "body": "Which line gives the error?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 7, "creation_date": 1549468899, "post_id": 54557702, "comment_id": 95915184, "body": "<code>Dim i, j, L, k As Double</code> declares 3 variants and 1 double (just <code>k</code>)"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 2, "creation_date": 1549469222, "post_id": 54557702, "comment_id": 95915375, "body": "Try putting <code>Option Explicit</code> on the very first line of your file. This will help with debugging."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1549470402, "post_id": 54557702, "comment_id": 95916090, "body": "That&#39;s a hell of a lot of variables and <code>FOR</code> loops for 1 UDF. If you really need to do all of that, I would put the <code>FOR</code> loop in another UDF and make the call to it. <b>Second option</b>: If you tell us what it is that you are actually trying to achieve (with maybe a screen print of your sheet), we might be able to suggest a better approach"}], "answers": [{"tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": false, "score": 0, "last_activity_date": 1549472677, "last_edit_date": 1549472677, "creation_date": 1549470634, "answer_id": 54558316, "question_id": 54557702, "link": "https://stackoverflow.com/questions/54557702/vba-function-returns-value/54558316#54558316", "title": "VBA: function returns #VALUE", "body": "<p>You're trying to use some function parameters as arrays but you don't have them initialized as such</p>\n\n<p>For instance</p>\n\n<pre><code>ModS(i) = wgt(i) * S0(i) * Exp(r * T)\n</code></pre>\n\n<p>You have <code>wgt</code> and <code>SO</code> as</p>\n\n<pre><code>Public Function TaylorPrice1(S0 As Double, sigma As Double, wgt As Double, rho As Double, T As Double, Kappa As Double, r As Double, num As Double) As Double\n</code></pre>\n\n<p>In your function parameters. The same applies to</p>\n\n<pre><code>Modrho(i, j) = rho(i, j) * sigma(i) * sigma(j) * T\n</code></pre>\n\n<p>You can drop the <code>As Double</code> from all function parameters that <em>may</em> be arrays and delete your currently commented <code>Redim...</code> line, as un-commenting that would immediately overwrite the parameter values.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11023847, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216549451755997/picture?type=large", "display_name": "Davide Argentati", "link": "https://stackoverflow.com/users/11023847/davide-argentati"}, "is_accepted": false, "score": 0, "last_activity_date": 1549646064, "creation_date": 1549646064, "answer_id": 54597323, "question_id": 54557702, "link": "https://stackoverflow.com/questions/54557702/vba-function-returns-value/54597323#54597323", "title": "VBA: function returns #VALUE", "body": "<p>Thank you to everyone for your help. I found the problem. The inputs of the function are actually range of cells of an Excel spreadsheet. But VBA didn't recognize them as array, so I had to transform the range in array (rho in the code). Since I also have a multidimensional array, I found that the range variables store the values of the range as mono dimensional row by raw. For example, I have a 14x14 matrix, then the 17th value of the range corresponds to the 2nd row, 3nd column of the matrix. I hope this information can be useful to someone. This is how I solved the main problem</p>\n\n<pre><code>Dim i As Double\nDim j As Double\nDim L As Double\nDim k As Double\nDim S0() As Double\nDim sigma() As Double\nDim wgt() As Double\nDim rho() As Double\nDim Modrho() As Double\nDim ModS() As Double\n' transofrmo range nei vettori\nDim cell As Range\nDim num1 As Long, num2 As Long\nDim rhodritto() As Double\nnum1 = 0\nFor Each cell In S0Input\n      num1 = num1 + 1\nNext cell\nReDim S0(num1) As Double\nReDim sigma(num1) As Double\nReDim wgt(num1) As Double\nReDim rho(num1, num1) As Double\nReDim Modrho(num1, num1) As Double\nReDim ModS(num1) As Double\n\n\ni = 1\nFor Each cell In S0Input\n    S0(i) = cell.Value\n    i = i + 1\nNext cell\ni = 1\nFor Each cell In sigmaInput\n    sigma(i) = cell.Value\n    i = i + 1\nNext cell\ni = 1\nFor Each cell In wgtInput\n    wgt(i) = cell.Value\n    i = i + 1\nNext cell\nnum2 = 0\nFor Each cell In rhoInput\n   num2 = num2 + 1\nNext cell\nReDim rhodritto(num2)\ni = 1\nFor Each cell In rhoInput\n    rhodritto(i) = cell.Value\n    i = i + 1\nNext cell\nk = 1\nFor i = 1 To num1\n    For j = 1 To num1\n        rho(i, j) = rhodritto(k)\n        k = k + 1\n    Next j\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11023847, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216549451755997/picture?type=large", "display_name": "Davide Argentati", "link": "https://stackoverflow.com/users/11023847/davide-argentati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549646064, "creation_date": 1549468739, "last_edit_date": 1549479702, "question_id": 54557702, "link": "https://stackoverflow.com/questions/54557702/vba-function-returns-value", "title": "VBA: function returns #VALUE", "body": "<p>I have a sub that allows me to price an option via a certain model. Then I wanted to build a function that does exactly the same thing in the same way, but I get an error. Some inputs can be vector so I tried the code with and without the brackets. I also switched \"Worksheet.function\" with \"Application\", none of that worked. </p>\n\n<pre><code>Public Function TaylorPrice1(S0 As Double, sigma As Double, wgt As Double, rho As Double, T As Double, Kappa As Double, r As Double, num As Double) As Double\n\nDim ModS() As Double\nDim Z As Double\nDim i, j, L, k As Double\nDim Sum1, Sum2, Sum3, Sum4, Sum5 As Double\nDim U1, U2, U20, U2st, U2nd, U2rd, mz, vz As Double\nDim a1, a2, a3, B1, B2, c1, c2, c3, c4, d1, d2, d3, d4, z1, z2, z3, y, y1, y2 As Double\nDim py, pyst, pynd, Ny1, Ny2 As Double\nDim Modrho() As Double\n\n'ReDim S0(num), sigma(num), wgt(num), rho(num, num) As Double\nReDim ModS(num) As Double\nReDim Modrho(num, num) As Double\nZ = 1\n\n        Sum1 = 0\n        Sum2 = 0\n        Sum3 = 0\n        Sum4 = 0\n        Sum5 = 0\n        U1 = 0\n        U2 = 0\n        U20 = 0\n        U2st = 0\n        U2nd = 0\n        U2rd = 0\n\n        For i = 0 To num - 1\n            ModS(i) = wgt(i) * S0(i) * Exp(r * T)\n            U1 = U1 + ModS(i)\n        Next i\n\n        For i = 0 To num - 1\n            For j = 0 To num - 1\n                Modrho(i, j) = rho(i, j) * sigma(i) * sigma(j) * T\n                U2 = U2 + ModS(i) * ModS(j) * Exp((Z ^ 2) * Modrho(i, j))\n            Next j\n        Next i\n\n        mz = 2 * Log(U1) - 0.5 * Log(U2)\n        vz = Log(U2) - 2 * Log(U1)\n\n        For i = 0 To num - 1\n            For j = 0 To num - 1\n                U20 = U20 + ModS(i) * ModS(j)\n                U2st = U2st + ModS(i) * ModS(j) * Modrho(i, j)\n                U2nd = U2nd + ModS(i) * ModS(j) * Modrho(i, j) ^ 2\n                U2rd = U2rd + ModS(i) * ModS(j) * Modrho(i, j) ^ 3\n            Next j\n        Next i\n\n        a1 = -(U2st * Z ^ 2) / (2 * U20)\n        a2 = 2 * a1 ^ 2 - ((U2nd * Z ^ 4) / (2 * U20))\n        a3 = 6 * a1 * a2 - 4 * a1 ^ 3 - ((U2rd * Z ^ 6) / (2 * U20))\n\n        For k = 0 To num - 1\n            For j = 0 To num - 1\n                For i = 0 To num - 1\n                    Sum1 = Sum1 + 2 * (ModS(i) * ModS(j) * ModS(k) * Modrho(i, k) * Modrho(j, k))\n                Next i\n            Next j\n        Next k\n\n        B1 = (Z ^ 4) / (4 * U1 ^ 3) * Sum1\n        B2 = a1 ^ 2 - 0.5 * a2\n\n        For L = 0 To num - 1\n            For k = 0 To num - 1\n                For j = 0 To num - 1\n                    For i = 0 To num - 1\n                        Sum2 = Sum2 + 8 * (ModS(i) * ModS(j) * ModS(k) * ModS(L) * Modrho(i, L) * Modrho(j, k) * Modrho(k, L))\n                    Next i\n                Next j\n            Next k\n        Next L\n        Sum2 = Sum2 + 2 * U2st * U2nd\n        For L = 0 To num - 1\n            For k = 0 To num - 1\n                For j = 0 To num - 1\n                    For i = 0 To num - 1\n                        Sum3 = Sum3 + 6 * (ModS(i) * ModS(j) * ModS(k) * ModS(L) * Modrho(i, L) * Modrho(j, L) * Modrho(k, L))\n                    Next i\n                Next j\n            Next k\n        Next L\n        For k = 0 To num - 1\n            For j = 0 To num - 1\n                For i = 0 To num - 1\n                    Sum4 = Sum4 + 6 * (ModS(i) * ModS(j) * ModS(k) * Modrho(i, k) * (Modrho(j, k) ^ 2))\n                Next i\n            Next j\n        Next k\n\n        For k = 0 To num - 1\n            For j = 0 To num - 1\n                For i = 0 To num - 1\n                    Sum5 = Sum5 + 8 * (ModS(i) * ModS(j) * ModS(k) * Modrho(i, j) * Modrho(i, k) * Modrho(j, k))\n               Next i\n            Next j\n        Next k\n\n        c1 = -1 * a1 * B1\n        c2 = (Z ^ 6 / (144 * U1 ^ 4)) * (9 * Sum2 + 4 * Sum3)\n        c3 = (Z ^ 6 / (48 * U1 ^ 3)) * (4 * Sum4 + Sum5)\n        c4 = a1 * a2 - 2 / 3 * a1 ^ 3 - a3 / 6\n\n        d1 = 0.5 * (6 * a1 ^ 2 + a2 - 4 * B1 + 2 * B2) - 1 / 6 * (120 * a1 ^ 3 - a3 + 6 * (24 * c1 - 6 * c2 + 2 * c3 - c4))\n        d2 = 0.5 * (10 * a1 ^ 2 + a2 - 6 * B1 + 2 * B2) - (128 * (a1 ^ 3) / 3 - a3 / 6 + 2 * a1 * B1 - a1 * B2 + 50 * c1 - 11 * c2 + 3 * c3 - c4)\n        d3 = (2 * a1 ^ 2 - B1) - 1 / 3 * (88 * a1 ^ 3 + 3 * a1 * (5 * B1 - 2 * B2) + 3 * (35 * c1 - 6 * c2 + c3))\n        d4 = (-20 * (a1 ^ 3) / 3 + a1 * (-4 * B1 + B2) - 10 * c1 + c2)\n\n        z1 = d2 - d3 + d4\n        z2 = d3 - d4\n        z3 = d4\n        y = Log(Kappa)\n        y1 = (mz - y) / (Sqr(vz)) + Sqr(vz)\n        y2 = y1 - Sqr(vz)\n        Ny1 = Application.Norm_S_Dist(y1, True)\n        Ny2 = Application.Norm_S_Dist(y2, True)\n        py = (1 / (Sqr(2 * Application.Pi() * vz))) * Exp((-((y - mz) ^ 2) / (2 * vz)))\n        pyst = py * 1 / (-vz) * (y - mz)\n        pynd = mz / vz * pyst + py * (1 / (-vz)) * (1 + y * (-1 / vz) * (y - mz))\n        TaylorPrice1 = (U1 * Exp(-r * T) * Ny1 - Kappa * Exp(-r * T) * Ny2) + (Exp(-r * T) * Kappa * (z1 * py + z2 * pyst + z3 * pynd))\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "array-formulas", "excel-r1c1-notation"], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 10748933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed46e4351e5c29e936d9febe6885ec06?s=128&d=identicon&r=PG&f=1", "display_name": "jakrooster", "link": "https://stackoverflow.com/users/10748933/jakrooster"}, "is_accepted": true, "score": 0, "last_activity_date": 1553865240, "last_edit_date": 1553865240, "creation_date": 1549636985, "answer_id": 54594782, "question_id": 54557476, "link": "https://stackoverflow.com/questions/54557476/why-is-excel-vba-only-accepting-a-relative-r1c1-reference-in-this-array-formula/54594782#54594782", "title": "Why is Excel VBA only accepting a relative R1C1 reference in this array formula?", "body": "<p>No, there's no way I can force VBA to read RC1 as an R1C1 reference.</p>\n\n<p>From Scott Craner above:</p>\n\n<blockquote>\n  <p>\"Because there is a column <code>RC</code> you cannot do an absolute column and relative row without the <code>[]</code> after the R. You can do an absolute row and relative column <code>R1C</code> and it will work, but it will first try A1 and if that works it will use it, otherwise it will try R1C1.\"</p>\n</blockquote>\n"}], "owner": {"reputation": 29, "user_id": 10748933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed46e4351e5c29e936d9febe6885ec06?s=128&d=identicon&r=PG&f=1", "display_name": "jakrooster", "link": "https://stackoverflow.com/users/10748933/jakrooster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 54594782, "answer_count": 1, "score": 0, "last_activity_date": 1570548584, "creation_date": 1549468048, "last_edit_date": 1570548584, "question_id": 54557476, "link": "https://stackoverflow.com/questions/54557476/why-is-excel-vba-only-accepting-a-relative-r1c1-reference-in-this-array-formula", "title": "Why is Excel VBA only accepting a relative R1C1 reference in this array formula?", "body": "<p>I am trying to add this line of code to my VBA. It adds an array formula to a range of cells:</p>\n\n<pre><code>str_Formula = \"=INDEX(rng_List,MATCH(1,--(RC1&gt;=rng_A)*--(RC1&lt;=rng_B),0))\"\nrng_Formula.FormulaArray = str_Formula\n</code></pre>\n\n<p>For some reason, the formula only computes if I use a relative R1C1 reference (RC[-22]) instead. If I use the absolute form above, then it tries to use the value of cell RC1 (in A1 reference notation).</p>\n\n<p>Is there a way I can force VBA to read RC1 as an R1C1 reference?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "edited": false, "score": 0, "creation_date": 1549467903, "post_id": 54557241, "comment_id": 95914461, "body": "You can see my answer below. For what doesn&#39;t work in your code : You want Label5 to be Sum of everything, but, right now, it&#39;s str that get the sum of the labels captions. <code>For str = .label5.caption</code> just give the string inside Label5 caption to the str variable, and doesn&#39;t &quot;rename&quot; .Label5.caption to a shorter name"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1549468329, "post_id": 54557241, "comment_id": 95914825, "body": "Is there any particular reason why you are using <code>Labels</code>? wouldn&#39;t a <code>TextBox</code> be a better approach?"}, {"owner": {"reputation": 3, "user_id": 10445394, "user_type": "registered", "profile_image": "https://graph.facebook.com/2145596645459207/picture?type=large", "display_name": "Kenneth Arellano Ubaldo", "link": "https://stackoverflow.com/users/10445394/kenneth-arellano-ubaldo"}, "reply_to_user": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "edited": false, "score": 0, "creation_date": 1549468859, "post_id": 54557241, "comment_id": 95915160, "body": "@Thryn the code you gave worked but when I put the code on another set of labels, it got error saying it&#39;s overflow."}, {"owner": {"reputation": 3, "user_id": 10445394, "user_type": "registered", "profile_image": "https://graph.facebook.com/2145596645459207/picture?type=large", "display_name": "Kenneth Arellano Ubaldo", "link": "https://stackoverflow.com/users/10445394/kenneth-arellano-ubaldo"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1549468926, "post_id": 54557241, "comment_id": 95915204, "body": "@Zac I just don&#39;t need some user input during the program. The values of the labels come from the worksheet cells."}, {"owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "edited": false, "score": 0, "creation_date": 1549469031, "post_id": 54557241, "comment_id": 95915268, "body": "@KennethArellanoUbaldo You can use Long, alternativly, if you have no floating point with <code>Clng</code>. And you can &quot;Lock&quot; Textbox so no user can edit them with the Enable option."}, {"owner": {"reputation": 3, "user_id": 10445394, "user_type": "registered", "profile_image": "https://graph.facebook.com/2145596645459207/picture?type=large", "display_name": "Kenneth Arellano Ubaldo", "link": "https://stackoverflow.com/users/10445394/kenneth-arellano-ubaldo"}, "edited": false, "score": 0, "creation_date": 1549469123, "post_id": 54557241, "comment_id": 95915309, "body": "Okay now I remember what&#39;s the cause of that overflow. I remember that when I used <code>Double</code> instead of <code>Integer</code> and it worked."}, {"owner": {"reputation": 3, "user_id": 10445394, "user_type": "registered", "profile_image": "https://graph.facebook.com/2145596645459207/picture?type=large", "display_name": "Kenneth Arellano Ubaldo", "link": "https://stackoverflow.com/users/10445394/kenneth-arellano-ubaldo"}, "reply_to_user": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "edited": false, "score": 0, "creation_date": 1549469183, "post_id": 54557241, "comment_id": 95915349, "body": "@Thryn thank you very much for the help. Much appreciated!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1549470743, "post_id": 54557241, "comment_id": 95916290, "body": "If this answered your question please upvote/mark it as solved: <a href=\"https://meta.stackexchange.com/a/5235\">Accepting Answers: How does it work?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1549468641, "post_id": 54557315, "comment_id": 95915032, "body": "Ah, you&#39;re right, I implied that it was integer to begin with. I shouldn&#39;t. Let me edit that"}], "tags": [], "owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "is_accepted": false, "score": 0, "last_activity_date": 1549468660, "last_edit_date": 1549468660, "creation_date": 1549467595, "answer_id": 54557315, "question_id": 54557241, "link": "https://stackoverflow.com/questions/54557241/how-to-add-vba-label-values/54557315#54557315", "title": "How to add VBA label values?", "body": "<p>I would use</p>\n\n<p><code>.Label5.caption = Cdec(.Label1.Caption) + Cdec(.Label2.Caption) + Cdec(.Label3.Caption) + Cdec(.Label4.Caption)</code></p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1549468331, "creation_date": 1549468331, "answer_id": 54557576, "question_id": 54557241, "link": "https://stackoverflow.com/questions/54557241/how-to-add-vba-label-values/54557576#54557576", "title": "How to add VBA label values?", "body": "<p>It didn't work because you put the result of <code>Sum</code> into <code>str</code> but not into <code>Label5</code>. </p>\n\n<p>Note that a <code>String</code> variable is not an object but just a string value. So it does not reference to <code>Label5.Caption</code> instead <code>str = Label5.Caption</code> just <strong>copies</strong> the value of <code>Label5.Caption</code> into the variable <code>str</code> (no referencing).</p>\n\n<pre><code>With UserForm1\n   .Label5.Caption = WorksheetFunction.Sum(.Label1.Caption, .Label2.Caption, .Label3.Caption, .Label4.Caption)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10445394, "user_type": "registered", "profile_image": "https://graph.facebook.com/2145596645459207/picture?type=large", "display_name": "Kenneth Arellano Ubaldo", "link": "https://stackoverflow.com/users/10445394/kenneth-arellano-ubaldo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549468660, "creation_date": 1549467403, "last_edit_date": 1549467948, "question_id": 54557241, "link": "https://stackoverflow.com/questions/54557241/how-to-add-vba-label-values", "title": "How to add VBA label values?", "body": "<p>I'm just a beginner in using VBA in MS Excel. I have 1 form and 5 labels. Let's just name it Label1 to Label5. I want to have the sum of values of Label1 to Label4 and display it on Label5. </p>\n\n<pre><code>With UserForm1\n\n   Dim str As String\n   str = Label5.Caption\n   str = WorksheetFunction.Sum(.Label1.Caption, .Label2.Caption, _\n         .Label3.Caption, .Label4.Caption)\nEnd With\n</code></pre>\n\n<p>This is the code that I got but it doesn't work. Please help T_T </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1549467920, "post_id": 54557176, "comment_id": 95914484, "body": "Welcome to SO. You have tagged this question with <i>VBA</i>. Please, show the code you have tried, where are you stuck and so on."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1549468059, "post_id": 54557176, "comment_id": 95914605, "body": "When an item is selected, capture the items in current <code>Combobox</code> (possibly in an array), remove the selected item from the array and set the row source for other <code>Comboboxes</code> with that array"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1549468067, "post_id": 54557176, "comment_id": 95914618, "body": "Welcome! Also, people may be voting you down because you need to show some effort.  Also, here is a link to <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask questions</a>. :)"}], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1549470848, "post_id": 54557764, "comment_id": 95916336, "body": "Doesn&#39;t that update all <code>combobox</code> values.. even the one where the value was selected? hence removing the selected value from active <code>combobox</code>. Although OP hasn&#39;t specified if that&#39;s ok or not.. just a thought"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1549470987, "post_id": 54557764, "comment_id": 95916416, "body": "You&#39;re right it would do, however I don&#39;t see that as being an issue for most things - the value is still there (it&#39;s selected) and would be there again once it is deselected"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1549471104, "post_id": 54557764, "comment_id": 95916487, "body": "Fare enough. On a different note, what did you use to do the recording? I have never worked out how people do that :)"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 2, "creation_date": 1549471206, "post_id": 54557764, "comment_id": 95916548, "body": "@Zac It&#39;s a really handy tool called <a href=\"https://www.screentogif.com/\" rel=\"nofollow noreferrer\">ScreenToGif</a>"}, {"owner": {"reputation": 3, "user_id": 11023570, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D6ppZvpgnow/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNoEF8DzUFaEXafo8pATEsI0dOw2g/mo/photo.jpg?sz=128", "display_name": "Esteban", "link": "https://stackoverflow.com/users/11023570/esteban"}, "edited": false, "score": 0, "creation_date": 1549544919, "post_id": 54557764, "comment_id": 95945891, "body": "Brilliant!! Just what I needed, thanks Tom!"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1549470449, "last_edit_date": 1549470449, "creation_date": 1549468959, "answer_id": 54557764, "question_id": 54557176, "link": "https://stackoverflow.com/questions/54557176/shrinking-droplists-on-comboboxes-not-letting-users-choose-the-same-answer-in/54557764#54557764", "title": "&quot;Shrinking&quot; droplists on comboboxes, not letting users choose the same answer in to or more comboboxes, using a form with VBA coding in Excel?", "body": "<p>You can use something like the following to achieve what you're looking for</p>\n\n<pre><code>Option Explicit\nPrivate Sub UserForm_Initialize()\n    Call UpdateComboBoxValues\nEnd Sub\nPrivate Sub UpdateComboBoxValues()\n    Dim ComboValues As Variant, ComboBoxes As Variant\n    Dim cBox\n\n    ComboBoxes = Array(ComboBox1, ComboBox2, ComboBox3)\n    ComboValues = Array(\"w1\", \"w2\", \"w3\", \"w4\", \"w5\")\n\n    For Each cBox In ComboBoxes\n        If Not cBox.Value = vbNullString Then ComboValues = Filter(ComboValues, cBox.Value, False)\n    Next cBox\n\n    For Each cBox In ComboBoxes\n        cBox.List = ComboValues\n    Next cBox\nEnd Sub\nPrivate Sub ComboBox1_Change()\n    Call UpdateComboBoxValues\nEnd Sub\nPrivate Sub ComboBox2_Change()\n    Call UpdateComboBoxValues\nEnd Sub\nPrivate Sub ComboBox3_Change()\n    Call UpdateComboBoxValues\nEnd Sub\n</code></pre>\n\n<p>Resulting in:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VoIFt.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VoIFt.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 11023570, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D6ppZvpgnow/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNoEF8DzUFaEXafo8pATEsI0dOw2g/mo/photo.jpg?sz=128", "display_name": "Esteban", "link": "https://stackoverflow.com/users/11023570/esteban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 1, "closed_date": 1549481096, "accepted_answer_id": 54557764, "answer_count": 1, "score": -4, "last_activity_date": 1549525458, "creation_date": 1549467119, "last_edit_date": 1549525458, "question_id": 54557176, "link": "https://stackoverflow.com/questions/54557176/shrinking-droplists-on-comboboxes-not-letting-users-choose-the-same-answer-in", "closed_reason": "Needs more focus", "title": "&quot;Shrinking&quot; droplists on comboboxes, not letting users choose the same answer in to or more comboboxes, using a form with VBA coding in Excel?", "body": "<p>Inside a form I have 5 comboboxes with a same rowsource. Currently you can select the same option for all 5 comboboxes if you want. What I need is, whenever you select one option in a combobox, in the next combobox show the same list from the rowsource but excluding the options already selected in previous comboboxes. This way the droplist will continue shrinking while you keep selecting options, not allowing the user to repeat the same option in 2 or more comboboxes.</p>\n\n<p>I manage to make it work on a worksheet with formulas and data validation, but no clue how to make it work using vba and comboboxes on an userform.</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=1t4yl7P7-9A\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=1t4yl7P7-9A</a></p>\n\n<p>Literally this is what I need to do, but with a userform and VBA coding \n(watch the video to have a better Idea if my explanation is still not clear)</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 2, "creation_date": 1549466651, "post_id": 54556963, "comment_id": 95913615, "body": "What is actually going wrong? Is the comparison in your <code>If</code> statement not working expected, are you getting an error, etc.?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1549466731, "post_id": 54556963, "comment_id": 95913665, "body": "What is <code>temp1</code>?  Also, you are comparing to <code>year(date)</code> this is the current date.  Should it just be <code>if year(date1)&lt;&gt;year(date2) then</code>?"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1549466883, "post_id": 54556963, "comment_id": 95913767, "body": "Is temp1 the name of a sheet?"}, {"owner": {"reputation": 45, "user_id": 8045777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a30403171d8756bd1b2ae389815fd3?s=128&d=identicon&r=PG&f=1", "display_name": "Snehil", "link": "https://stackoverflow.com/users/8045777/snehil"}, "edited": false, "score": 0, "creation_date": 1549466919, "post_id": 54556963, "comment_id": 95913790, "body": "I edited my question for better help. The date is supposed to be the previous year and not the current year."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1549467173, "post_id": 54556963, "comment_id": 95913955, "body": "@Snehill the error you show does not seem to appear in the code at all...."}, {"owner": {"reputation": 45, "user_id": 8045777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a30403171d8756bd1b2ae389815fd3?s=128&d=identicon&r=PG&f=1", "display_name": "Snehil", "link": "https://stackoverflow.com/users/8045777/snehil"}, "edited": false, "score": 0, "creation_date": 1549467318, "post_id": 54556963, "comment_id": 95914044, "body": "I don&#39;t know why it still shows an error for me? any suggestions?"}, {"owner": {"reputation": 45, "user_id": 8045777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a30403171d8756bd1b2ae389815fd3?s=128&d=identicon&r=PG&f=1", "display_name": "Snehil", "link": "https://stackoverflow.com/users/8045777/snehil"}, "edited": false, "score": 0, "creation_date": 1549467502, "post_id": 54556963, "comment_id": 95914183, "body": "@BigBen yes It still shows an error."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1549467603, "post_id": 54556963, "comment_id": 95914250, "body": "Because your dates are probably not dates but perhaps &quot;text-that-looks-like-dates.&quot; Can be confirmed looking a screenshot of your data. Btw, this can be done with a formula, just want to confirm that you need VBA for this."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1549467729, "post_id": 54556963, "comment_id": 95914327, "body": "Ahh, now you have edited the error to match the edited code..."}, {"owner": {"reputation": 45, "user_id": 8045777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a30403171d8756bd1b2ae389815fd3?s=128&d=identicon&r=PG&f=1", "display_name": "Snehil", "link": "https://stackoverflow.com/users/8045777/snehil"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1549467843, "post_id": 54556963, "comment_id": 95914415, "body": "@SolarMike Sorry about that."}, {"owner": {"reputation": 45, "user_id": 8045777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a30403171d8756bd1b2ae389815fd3?s=128&d=identicon&r=PG&f=1", "display_name": "Snehil", "link": "https://stackoverflow.com/users/8045777/snehil"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1549467847, "post_id": 54556963, "comment_id": 95914418, "body": "@BigBen Yes It is supposed to be done in VBA"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1549468421, "post_id": 54556963, "comment_id": 95914901, "body": "Column S is column <i>19</i>. You have text in column 18, hence the type mismatch. Column U is column <i>21</i> as well."}, {"owner": {"reputation": 45, "user_id": 8045777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a30403171d8756bd1b2ae389815fd3?s=128&d=identicon&r=PG&f=1", "display_name": "Snehil", "link": "https://stackoverflow.com/users/8045777/snehil"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1549469217, "post_id": 54556963, "comment_id": 95915373, "body": "@BigBen Thanks a lot. That worked, I was actually not considering the hidden columns in the sheet. Although, there are 2 another problems. The Word &quot;Routine&quot; is being pushed to the other Workbook but it does not take filter into consideration uses all the data unfiltered. Secondly, even when the data is filtered through the VBA code the word &quot;Routine&quot; is being pushed out in the entire column on unfiltered data."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1549469394, "post_id": 54556963, "comment_id": 95915474, "body": "A loop by row (<code>For j = 2 To lastrow</code>) will not ignore rows that are filtered out... I&#39;d post a new question - it&#39;s best to keep it to one issue per question, and we&#39;ve fixed the main issue here."}], "owner": {"reputation": 45, "user_id": 8045777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a30403171d8756bd1b2ae389815fd3?s=128&d=identicon&r=PG&f=1", "display_name": "Snehil", "link": "https://stackoverflow.com/users/8045777/snehil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549467964, "creation_date": 1549466510, "last_edit_date": 1549467964, "question_id": 54556963, "link": "https://stackoverflow.com/questions/54556963/how-to-compare-dates-based-on-years-in-two-different-columns", "title": "How to Compare Dates based on Years in two different columns", "body": "<p>I've been trying to figure out how to compare the dates based on Years in two different columns of the same Worksheet. Columns 'S' and 'U' have dates in the format of - mm/dd/yyyy. The problem seems to be probably just in assigning date to the variable 'date1' and 'date2' but, there could be more problems in the code. </p>\n\n<pre><code>Function Condition()\n\nDim j As Long\nDim lastrow As Long\nDim ws1 As Worksheet\nDim wbk As Workbook\nDim wb As Worksheet\nDim date1 As Date, date2 As Date\n\n\nSet wbk = Application.Workbooks(\"RELIEF VALVE MASTER SPREADSHEET.xlsx\")\nSet ws1 = wbk.Worksheets(\"Valve List\")\n\nlastrow = ws1.range(\"S\" &amp; Rows.Count).End(xlUp).Row\n\n\nFor j = 2 To lastrow\n\ndate1 = ws1.Cells(j, 18).Value\ndate2 = ws1.Cells(j, 20).Value\n\nIf Year(date1) = Year(Date) - 1 Or Year(date2) &lt;&gt; Year(Date) - 1 Then\n    Application.Workbooks(\"MaxiTrak RV Service Report - Blank.xlsm\").Activate\n    ActiveWorkbook.Sheets(\"ML_PSV_SERVICE\").Select\n    Cells(j, 7).Value = \"Routine\"\nElse\n    ws1.Cells(j, 7) = \"\"\nEnd If\nNext j\n\nEnd Function\n</code></pre>\n\n<p>The basic Idea behind this code is to check if cell in the same row Ex:(S2 and U2) have the same year or not. If they are in the same year i.e(2018) then insert text \"Routine\" into another open Workbook on Column #7 in the same row. Thanks for the help in advance. </p>\n\n<p>The Error -> Type Mismatch on <code>date1 = ws1.Cells(j, 18).Value</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/UxUed.png\" rel=\"nofollow noreferrer\">Proof that it is a date format</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1549466274, "post_id": 54556787, "comment_id": 95913371, "body": "Yes, happens to us too (we have a file searcher that searches for code inside VBA modules and QueryTable queries). It is just the way Excel is. It is explicitly unsupported for unattended operations. There is not solution that I know of."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1549467282, "post_id": 54556787, "comment_id": 95914020, "body": "Just a guess, but you might watch the memory usage of Excel. I could imagine that if Excel closes a workbook it does not clean up properly and leaves some dirt of each workbook in memory. If Excel opens/closes a lot of workbooks memory usage might increase and hit the 2GB limit. If the limit is hit Excel might end up in an unpredictable state without showing any error. (I hit this limit several times with other things and sometimes there was an error other times Excel just ended up not working correctly anymore.) \u2022 Nevertheless I don&#39;t know a way to go around this."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1549484747, "post_id": 54556787, "comment_id": 95922888, "body": "Even when <code>Set ... = Nothing</code> is not necessary (<a href=\"https://stackoverflow.com/q/19038350/10908769\">stackoverflow.com/q/19038350/10908769</a> (and @GSerg wrote that answer :) ), I would give it a try in such a situation."}, {"owner": {"reputation": 5982, "user_id": 959460, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2b4c53a15d84753e84b3a291c3c72211?s=128&d=identicon&r=PG", "display_name": "Dr.YSG", "link": "https://stackoverflow.com/users/959460/dr-ysg"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1549549511, "post_id": 54556787, "comment_id": 95948586, "body": "@GSerg Large workbooks. Sounds possible. The same update program is run over a batch of 1000 smaller workbooks, and it works. OK, since the native content in the workbook is very small, I think the 1MB size is the 4 remote links. would clearing that data (how?) get around this issue? Should this be a new question?"}, {"owner": {"reputation": 5982, "user_id": 959460, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2b4c53a15d84753e84b3a291c3c72211?s=128&d=identicon&r=PG", "display_name": "Dr.YSG", "link": "https://stackoverflow.com/users/959460/dr-ysg"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549549548, "post_id": 54556787, "comment_id": 95948618, "body": "@Asger See my comment about large external workbooks."}], "owner": {"reputation": 5982, "user_id": 959460, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2b4c53a15d84753e84b3a291c3c72211?s=128&d=identicon&r=PG", "display_name": "Dr.YSG", "link": "https://stackoverflow.com/users/959460/dr-ysg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1549466859, "creation_date": 1549465981, "last_edit_date": 1549466859, "question_id": 54556787, "link": "https://stackoverflow.com/questions/54556787/excel-vba-processing-workbooks-stops-after-a-random-number-of-workbooks", "title": "Excel VBA processing workbooks stops after a random number of workbooks", "body": "<p>We need to run a VBA program to update over 500+ workbooks (removing and changing a worksheet in each of them).</p>\n\n<p>The below VBA program does a recursive traversal of all the workbook. </p>\n\n<p><strong>ISSUE</strong></p>\n\n<p>After doing anywhere from 50, 200, or sometimes 400 the macro stops. No errors. It just leaves an open workbook on the screen. it is always a different workbook, and often times it processes the offender, so it does not seem to be content related.</p>\n\n<p>I thought it might be the </p>\n\n<pre><code>GetFilesRecursive fso.GetFolder(directory), \"xlsx\", files, fso\n</code></pre>\n\n<p>which which is getting confused because of the update of the workbook with the SAVE. But I have also tried putting the output via SAVAS in a seperate folder tree, and that does not affect things.</p>\n\n<p>Any idea how one debugs such an issue?</p>\n\n<pre><code>\nConst ProgDir = \"D:\\Staffing\\SkillsUpdate\\ProgramOfficeData\" \n\nSub allPrograms(directory As String)\n    Dim fso As New Scripting.FileSystemObject\n    Dim files As New Collection\n    Dim file As Scripting.file\n    Dim result As Boolean\n    Dim index As Integer\n    clearErrors\n    GetFilesRecursive fso.GetFolder(directory), \"xlsx\", files, fso\n    index = 1\n    For Each file In files\n        If file Is Nothing Then\n            ' Do nothing\n        Else\n            result = oneProgram(file.ParentFolder.path, file.Name)\n            Application.StatusBar = \"Processing \" &amp; index &amp; \" of \" &amp; files.count\n            If (result) Then\n                index = index + 1\n            End If\n        End If\n    ' logError \"allPrograms(): processed:\", 0, directory &amp; \"\\\" &amp; file\n    Next file\n    Application.ThisWorkbook.Activate\n    Worksheets(\"Main\").Cells(4, 3).Value = \"Last Update: \" + Format(Now(), \"General Date\")\nEnd Sub\n\nFunction oneProgram(directory As String, fileName As String) As Boolean\n    Dim wbk As Workbook\n    Dim filePath As String\n    Dim result As Boolean\n    filePath = directory &amp; \"\\\" &amp; fileName\n    Set wbk = safeOpen(filePath, result)\n    If (Not result) Then\n        oneProgram = False\n        Exit Function\n    End If\n\n    killSkillNames wbk\n    clearProgSkills wbk\n    copyDropList wbk\n    copySkillsList wbk\n    addSkillNames wbk\n    addWinPercent wbk\n    hideProgSheets wbk\n\n    wbk.Close SaveChanges:=True\n    oneProgram = True\nEnd Function\nSub hideProgSheets(wbk As Workbook)\n    wbk.Worksheets(\"SkillsList\").Visible = False\n    wbk.Worksheets(\"DropLists\").Visible = False\nEnd Sub\nSub copyDropList(wbk As Workbook)\n    Dim source As Worksheet\n    Dim target As range\n    Dim dest As Worksheet\n    Set source = Application.ThisWorkbook.Worksheets(\"DropLists\")\n    Set dest = wbk.Sheets(\"DropLists\")\n    wbk.Names(\"YesNoList\").Delete\n    Set target = wbk.Worksheets(\"StaffRequest\").range(\"J3:K3\")\n    target.Validation.Delete 'delete previous validation\n    Application.DisplayAlerts = False\n        dest.Delete\n    Application.DisplayAlerts = True\n    source.Copy wbk.Sheets(Sheets.count)\n    wbk.Names.Add Name:=\"YesNoList\", RefersTo:=wbk.Sheets(\"DropLists\").range(\"A1:A2\")\nEnd Sub\nSub addWinPercent(wbk As Workbook)\n    Dim target As range\n    wbk.Names.Add Name:=\"WinPercent\", RefersTo:=wbk.Sheets(\"DropLists\").range(\"B1:B5\")\n    Set target = wbk.Worksheets(\"StaffRequest\").range(\"J3:K3\")\n    With target.Validation\n        .Add Type:=xlValidateList, _\n        Operator:=xlBetween, _\n        AlertStyle:=xlValidAlertStop, _\n        Formula1:=\"=WinPercent\"\n    End With\nEnd Sub\nSub clearProgSkills(wbk As Workbook)\n    Dim target As range\n    Set target = wbk.Worksheets(\"StaffRequest\").range(\"H10:J100\")\n    For Each cell In target\n    If (cell.Value &lt;&gt; \"\") And (cell.Value &lt;&gt; \"Total\") Then\n        cell.Value = \"No Skill\"\n    End If\n    Next cell\nEnd Sub\nSub RUNME_PROGRAMS()\n    allPrograms (ProgDir)\nEnd Sub\n\nSub GetFilesRecursive(f As Scripting.Folder, filter As String, c As Collection, fso As Scripting.FileSystemObject)\n  Dim sf As Scripting.Folder\n  Dim file As Scripting.file\n\n  For Each file In f.files\n    If InStr(1, fso.GetExtensionName(file.Name), filter, vbTextCompare) = 1 Then\n      c.Add file, file.path\n    End If\n  Next file\n\n  For Each sf In f.SubFolders\n    GetFilesRecursive sf, filter, c, fso\n  Next sf\nEnd Sub\nFunction safeOpen(filePath As String, result As Boolean) As Workbook\n    result = True\n    Dim book As Workbook\n    Dim lockTest As Boolean\n    Dim errCode As Integer\n    Dim errText As String\n\n    lockTest = IsWorkBookOpen(filePath, errCode, errText)\n    If (lockTest) Then\n        logError \"safeOpen: Open Problem with: \" &amp; filePath, errCode, errText\n        result = False\n        Exit Function\n    End If\n\n    On Error Resume Next ' turn off error trapping\n    Set book = Workbooks.Open(fileName:=filePath, ReadOnly:=False, UpdateLinks:=False)\n    On Error GoTo 0 ' turn on error trapping\n    If book Is Nothing Then\n        logError \"safeOpen: cannot Open File: \" &amp; filePath, errCode, errText\n        result = False\n    End If\n\n    Set safeOpen = book\nEnd Function\n\nFunction safeCellRead(rng As range) As Double\n    If (IsNumeric(rng.Value)) Then\n        safeCellRead = CDbl(rng.Value)\n    Else\n        safeCellRead = 0\n    End If\nEnd Function\n\nFunction IsWorkBookOpen(strFileName As String, errCode As Integer, errText As String) As Boolean\n\n    On Error Resume Next\n    ' If the file is already opened by another process,\n    ' and the specified type of access is not allowed,\n    ' the Open operation fails and an error occurs.\n    Open strFileName For Binary Access Read Write Lock Read Write As #1\n    Close #1\n\n    errCode = Err.Number\n    errText = Err.description\n    'If no error, file is not open.\n    If Err.Number = 0 Then\n        IsWorkBookOpen = False\n        End If\n\n    'Error #70 is another user has the file open in edit mode.\n    If Err.Number = 70 Then\n        IsWorkBookOpen = True\n        End If\n\n    'Error #75 is another user has the file open in read only mode.\n    If Err.Number = 75 Then\n        IsWorkBookOpen = False\n        End If\n    On Error GoTo 0 ' turn on error trapping\nEnd Function\nSub copySkillsList(wbk As Workbook)\n    Dim source As Worksheet\n    Dim dest As Worksheet\n    Set source = Application.ThisWorkbook.Worksheets(\"SkillsList\")\n    Set dest = wbk.Sheets(\"SkillsList\")\n    dest.Unprotect Password:=\"****\"\n    Application.DisplayAlerts = False\n        dest.Delete\n    Application.DisplayAlerts = True\n    source.Copy wbk.Sheets(Sheets.count)\nEnd Sub\nSub killSkillNames(wkb As Workbook)\n    Dim skills As Worksheet\n    Dim range As range\n    Dim tag As String\n    Dim cell As range\n    Set skills = wkb.Worksheets(\"SkillsList\")\n    Set range = skills.range(\"A1:AZ1\")\n    For Each cell In range\n    If cell &lt;&gt; \"\" Then\n        tag = cell.Value\n        wkb.Names(tag).Delete\n    End If\n    Next cell\nEnd Sub\nSub addSkillNames(wkb As Workbook)\n    Dim skills As Worksheet\n    Dim values As range\n    Dim top As range\n    Dim bottom As range\n    Dim tag As String\n    Dim cell As range\n    Set skills = wkb.Worksheets(\"SkillsList\")\n    Set headers = skills.range(\"A1:AZ1\")\n    For Each cell In headers\n    If cell &lt;&gt; \"\" Then\n        tag = cell.Value\n        Set top = cell.Offset(1, 0)\n        Set bottom = top.End(xlDown)\n        Set values = range(top, bottom)\n        wkb.Names.Add Name:=tag, RefersTo:=values\n    End If\n    Next cell\nEnd Sub\nSub clearErrors()\n    Dim eSheet As Worksheet\n    Set eSheet = Worksheets(\"ErrorLog\")\n    eSheet.range(\"A2:E4000\").Clear\n    eSheet.range(\"A1\").Value = 1\n    Application.DisplayStatusBar = True\n    Application.StatusBar = \"\"\nEnd Sub\n\nSub logError(errText As String, errNum As Integer, errDescription As String)\n    Dim eSheet As Worksheet\n    Dim eCount As Integer\n    Set eSheet = ThisWorkbook.Worksheets(\"ErrorLog\")\n    eCount = CInt(eSheet.range(\"A1\"))\n    eCount = eCount + 1\n    eSheet.Cells(eCount, 2).Value = errNum\n    eSheet.Cells(eCount, 3).Value = errText\n    eSheet.Cells(eCount, 4).Value = errDescription\n    Application.StatusBar = \"ERROR: \" &amp; eText\n    eSheet.range(\"A1\").Value = eCount\nEnd Sub\n\n\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1549465901, "post_id": 54556437, "comment_id": 95913139, "body": "You appear to be posting the same question again. What&#39;s different here? What exactly is the problem? Did you read my comment on your previous question?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1549466516, "post_id": 54556437, "comment_id": 95913526, "body": "&quot;My code was correct however it doesn&#39;t do what I needed it to do&quot;. <a href=\"https://i.imgur.com/jusLe9J.gif\" rel=\"nofollow noreferrer\">...huh?</a>  How&#39;s the code correct if it doesn&#39;t do what you expect?"}, {"owner": {"reputation": 15, "user_id": 11019629, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0DExzajBfBI/AAAAAAAAAAI/AAAAAAAAAUY/T9VOFnxi24g/photo.jpg?sz=128", "display_name": "Vishal Malhotra", "link": "https://stackoverflow.com/users/11019629/vishal-malhotra"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1549467332, "post_id": 54556437, "comment_id": 95914050, "body": "@BruceWayne I should have explained it better. What I meant to say was the code runs without issue however I need help getting it to delete based on another column."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11019629, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0DExzajBfBI/AAAAAAAAAAI/AAAAAAAAAUY/T9VOFnxi24g/photo.jpg?sz=128", "display_name": "Vishal Malhotra", "link": "https://stackoverflow.com/users/11019629/vishal-malhotra"}, "edited": false, "score": 0, "creation_date": 1549467230, "post_id": 54556954, "comment_id": 95913991, "body": "This is really cool. Thank you for the help hopefully I get as good as you haha."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1549466475, "creation_date": 1549466475, "answer_id": 54556954, "question_id": 54556437, "link": "https://stackoverflow.com/questions/54556437/selecting-range-between-two-words-then-based-on-a-different-column-deleting-them/54556954#54556954", "title": "Selecting Range between two words then based on a different column deleting them", "body": "<p>I recommend to use <code>Match</code> to find the rows where \"Revenue\" and \"Total Revenue\" are. Then check between these rows if there are blanks in column J <code>.SpecialCells(xlCellTypeBlanks)</code> and delete the <code>EntireRow</code>.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub DeleteEmpty()\n    Dim wsInput As Worksheet 'define worksheet\n    Set wsInput = ThisWorkbook.Worksheets(\"Input\")\n\n    Dim FirstRow As Long, LastRow As Long\n\n    On Error Resume Next 'Next line throws error if  \"Revenue\" or \"Total Revenue\" is not found\n    FirstRow = Application.WorksheetFunction.Match(\"Revenue\", wsInput.Range(\"A:A\"), False) + 1\n    LastRow = Application.WorksheetFunction.Match(\"Total Revenue\", wsInput.Range(\"A:A\"), False) - 1\n    On Error GoTo 0 'Always re-activate error handling!\n\n    'Check if both \"Revenue\" and \"Total Revenue\" were found\n    If FirstRow = 0 Or LastRow = 0 Then\n        MsgBox \"Revenue or Total Revenue not found\"\n        Exit Sub\n    End If\n\n    'Find empty cells in column J between FirstRow (Revenue) and LastRow (Total Revenue)\n    Dim EmptyCellsInJ As Range\n    On Error Resume Next\n    Set EmptyCellsInJ = wsInput.Range(wsInput.Cells(FirstRow, \"J\"), wsInput.Cells(LastRow, \"J\")).SpecialCells(xlCellTypeBlanks)\n    On Error GoTo 0\n\n    'If there are empty cells delete their rows\n    If Not EmptyCellsInJ Is Nothing Then\n        EmptyCellsInJ.EntireRow.Delete\n    Else\n        MsgBox \"nothing to delete\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11019629, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0DExzajBfBI/AAAAAAAAAAI/AAAAAAAAAUY/T9VOFnxi24g/photo.jpg?sz=128", "display_name": "Vishal Malhotra", "link": "https://stackoverflow.com/users/11019629/vishal-malhotra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 54556954, "answer_count": 1, "score": 0, "last_activity_date": 1549466475, "creation_date": 1549464881, "last_edit_date": 1549465507, "question_id": 54556437, "link": "https://stackoverflow.com/questions/54556437/selecting-range-between-two-words-then-based-on-a-different-column-deleting-them", "title": "Selecting Range between two words then based on a different column deleting them", "body": "<p>I made an original post (<a href=\"https://stackoverflow.com/questions/54542141/selecting-a-range-depended-on-two-key-words/54542937#54542937\">Selecting a Range depended on two Key Words</a>). My code was correct however it doesn't do what I needed it to do. I need help/ guidance to manipulate the code so that between Revenue and total revenue we look at column J if it is empty the entire row is deleted. I tried my best but as I am currently learning VBA I am struggling to find even how to approach it. </p>\n\n<p><a href=\"https://i.stack.imgur.com/SjbWB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SjbWB.png\" alt=\"Excel File\"></a></p>\n\n<p>Code thus far:</p>\n\n<pre><code>Dim rngFirst As Range\nDim rngLast As Range\n\nDim rngUnion As Range\nApplication.ScreenUpdating = False\n\nWith Sheets(\"Input\")\n    'Find the start and stop\n    Set rngFirst = .Cells.Find(what:=\"Performance Income\", lookat:=xlWhole, _\n        LookIn:=xlValues, MatchCase:=False)\n    Set rngLast = .Cells.Find(what:=\"Miscellaneous Income\", _\n        lookat:=xlWhole, LookIn:=xlValues, MatchCase:=False)\n\n    Set rngUnion = Range(rngFirst.Address, rngLast.Address)\n\n    rngUnion.SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n\nEnd With\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>I appreciate all the help thus far and any help given. Thank you. </p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1549463037, "post_id": 54555613, "comment_id": 95911295, "body": "The issue is that <code>(pt)</code> <a href=\"https://stackoverflow.com/a/8257503/11683\">tries</a> to pass <code>pt.[_Default]</code>, which for <code>PivotTable</code> is a <code>String</code>. Another good thing on the way to fix it is using <code>ByVal pt As PivotTable</code>, and amusingly, in that case the call can be performed correctly even with <code>(pt)</code>, but only when <code>pt</code> is declared as <code>Variant</code>. Declaring it as <code>Object</code> or <code>PivotTable</code> requires removing the parentheses, which is the correct thing to do anyway."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1549463311, "last_edit_date": 1549463311, "creation_date": 1549462287, "answer_id": 54555613, "question_id": 54555539, "link": "https://stackoverflow.com/questions/54555539/run-time-error-424-object-required-when-calling-function-vba/54555613#54555613", "title": "Run Time Error &#39;424&#39; object required when calling function VBA", "body": "<p>Change the sub to this one:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim pt As Object 'or Dim pt As PivotTable\n    For Each st In ActiveWorkbook.Worksheets\n        For Each pt In st.PivotTables\n            UpdatePivotSource pt\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>The difference is that <code>pt</code> is declared as Object and the <code>pt</code> is not within parenthesis. The parenthesis in VBA parameters should be used with caution, only when one knows what is happenning. E.g., objects are passed by reference (<code>ByRef</code>) and the parenthesis force <code>ByVal</code> passing.</p>\n\n<p>To avoid non-declared variables in the future use Option Explicit on the top of your module - <a href=\"https://stackoverflow.com/questions/2454552/what-do-option-strict-and-option-explicit-do\">What do Option Strict and Option Explicit do?</a></p>\n\n<ul>\n<li><a href=\"http://www.cpearson.com/excel/byrefbyval.aspx\" rel=\"nofollow noreferrer\">A nice explanation of Passing Variables ByRef and ByVal from CPearson.</a></li>\n</ul>\n"}], "owner": {"reputation": 840, "user_id": 5292347, "user_type": "registered", "accept_rate": 24, "profile_image": "https://lh3.googleusercontent.com/-ahmB1uSwJo8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFI54d1HiMALNuMeDWm_Lt8Ap5Aw/photo.jpg?sz=128", "display_name": "Carlos Siestrup", "link": "https://stackoverflow.com/users/5292347/carlos-siestrup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 54555613, "answer_count": 1, "score": 1, "last_activity_date": 1549463311, "creation_date": 1549462072, "last_edit_date": 1549462607, "question_id": 54555539, "link": "https://stackoverflow.com/questions/54555539/run-time-error-424-object-required-when-calling-function-vba", "title": "Run Time Error &#39;424&#39; object required when calling function VBA", "body": "<p>I'm using this code to update the source of all my pivot tables but I always get </p>\n\n<blockquote>\n  <p>\"Run Time Error '424' object required\". </p>\n</blockquote>\n\n<p>The weird part is that placing the code in the function inside the loop actually works without this error so I don't think it's the function's code but the way I'm calling it. I would like to know why it's not working.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    For Each st In ActiveWorkbook.Worksheets\n        For Each pt In st.PivotTables\n            UpdatePivotSource (pt)\n        Next\n    Next\nEnd Sub\n\nSub UpdatePivotSource(pt As PivotTable)\n    Dim StartPoint As Range\n    Dim NewRange As String\n    Dim LastCol As Long\n    Dim lastRow As Long\n    Dim Data_Sheet As Worksheet\n    Dim DataRange As Range\n\n    Set Data_Sheet = ThisWorkbook.Worksheets(Split(pt.PivotCache.SourceData, \"!\")(0))\n    Set StartPoint = Data_Sheet.Range(\"A1\")\n    LastCol = StartPoint.End(xlToRight).Column\n    lastRow = StartPoint.End(xlDown).Row\n\n    Set DataRange = Data_Sheet.Range(StartPoint, Data_Sheet.Cells(lastRow, LastCol))\n    NewRange = Data_Sheet.Name &amp; \"!\" &amp; DataRange.Address(ReferenceStyle:=xlR1C1)\n\n    pt.ChangePivotCache ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=NewRange)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "outlook", "range"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1549462012, "post_id": 54555472, "comment_id": 95910613, "body": "What have you tried so far?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1549462244, "post_id": 54555472, "comment_id": 95910778, "body": "This requires (if I remember correctly) to publish the range to an HTML file and use it in <code>.HTMLbody</code>, there are pre-writen functions to be found on the <a href=\"https://www.rondebruin.nl/win/s1/outlook/bmail2.htm\" rel=\"nofollow noreferrer\">internet</a>. Good luck with your own research!"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549476829, "post_id": 54555472, "comment_id": 95919341, "body": "You could also paste your range (as table, text or picture) into the email&#39;s body by this: <a href=\"https://stackoverflow.com/a/54376916/10908769\">stackoverflow.com/a/54376916/10908769</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 2, "last_activity_date": 1549465671, "last_edit_date": 1549465671, "creation_date": 1549464604, "answer_id": 54556345, "question_id": 54555472, "link": "https://stackoverflow.com/questions/54555472/vba-to-send-out-emails-with-range/54556345#54556345", "title": "VBA to send out emails with range", "body": "<p>Below is a <code>Function</code> to generate an HTML table and a <code>Sub</code> that calls it and generates the email</p>\n\n<pre><code>Public Function GenerateHTMLTable(srcData As Range, RegionSelector As String, Optional FirstRowAsHeaders As Boolean = True) As String\n    Dim InputData As Variant, HeaderData As Variant\n    Dim HTMLTable As String\n    Dim i As Long\n\n    ' Declare constants of table element\n    Const HTMLTableHeader As String = \"&lt;table&gt;\"\n    Const HTMLTableFooter As String = \"&lt;/table&gt;\"\n\n    ' Update with your sheet reference\n    If FirstRowAsHeaders = True Then\n        HeaderData = Application.Transpose(Application.Transpose(srcData.Rows(1).Value2))\n        InputData = Range(srcData.Rows(2), srcData.Rows(srcData.Rows.Count)).Value2\n        ' Add Headers to table\n        HTMLTable = \"&lt;tr&gt;&lt;th&gt;\" &amp; Join(HeaderData, \"&lt;/th&gt;&lt;th&gt;\") &amp; \"&lt;/th&gt;&lt;/tr&gt;\"\n    Else\n        InputData = srcData.Value2\n    End If\n\n    ' Loop through each row of data and add selected region to table output\n    For i = LBound(InputData, 1) To UBound(InputData, 1)\n        ' Test Region against chosen option\n        If InputData(i, 9) = RegionSelector Then\n            ' Add row to table for output in email\n            HTMLTable = HTMLTable &amp; \"&lt;tr&gt;&lt;td&gt;\" &amp; Join(Application.Index(InputData, i, 0), \"&lt;/td&gt;&lt;td&gt;\") &amp; \"&lt;/td&gt;&lt;/tr&gt;\"\n        End If\n    Next i\n\n    GenerateHTMLTable = HTMLTableHeader &amp; HTMLTable &amp; HTMLTableFooter\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>Sub testDemo()\n    Dim outlookApp As Object\n    Dim objMail As Object\n    Dim Region\n    Dim rng As Range\n\n    ' Create email\n    Set outlookApp = CreateObject(\"Outlook.Application\")\n\n    ' Update with your sheet reference\n    With Sheet1\n        Set rng = .Range(.Cells(1, 1), .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row, .Cells(1, .Columns.Count).End(xlToLeft).Column))\n    End With\n\n    For Each Region In Array(\"Central\", \"UK &amp; IE\")\n        With outlookApp.CreateItem(0)\n            ' Add table to Email body\n            .HTMLBody = GenerateHTMLTable(rng, CStr(Region), True)\n            ' Display created email\n            .Display\n        End With\n    Next Region\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gwVR9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gwVR9.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/l8TEU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l8TEU.png\" alt=\"enter image description here\"></a></p>\n\n<p>You could go further with this as well by editing the function to add a custom <code>css</code> to the table</p>\n"}], "owner": {"reputation": 7, "user_id": 10552793, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R6rYyyLRbCE/AAAAAAAAAAI/AAAAAAAADiQ/VnTynf_EChI/photo.jpg?sz=128", "display_name": "linkrisz", "link": "https://stackoverflow.com/users/10552793/linkrisz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 54556345, "answer_count": 1, "score": 0, "last_activity_date": 1549465671, "creation_date": 1549461871, "last_edit_date": 1549462533, "question_id": 54555472, "link": "https://stackoverflow.com/questions/54555472/vba-to-send-out-emails-with-range", "title": "VBA to send out emails with range", "body": "<p>Im trying to create a VBA that sends out emails with a specific range copied into the body.</p>\n\n<p>If values in column I are the same then copy cells A to H </p>\n\n<p>Repeat this for each Region</p>\n\n<p><a href=\"https://i.stack.imgur.com/M02s4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M02s4.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p>This is what was able to come up with as a start:</p>\n\n<pre><code>Sub Email()\n\n\n    Dim currentCentre As String\n    Dim cell As Range\n\n\n\n    lastrow = Range(\"A65536\").End(xlUp).row\n\n    For Each cell In Range(\"A2:I\" &amp; lastrow)\n\n    If cell.Offset(0, 8).Value = cell.Offset(1, 8).Value Then\n    Call prepMail\n\n\n    End If\n\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access", "recordset"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1549465493, "post_id": 54555350, "comment_id": 95912877, "body": "Why not simply create a stored procedure in sql server to insert the data and return the value of identity? You really should start thinking that way anyway to separate the data and presentation layers."}, {"owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1549465752, "post_id": 54555350, "comment_id": 95913038, "body": "I agree but I inherited this Access application from another developer and a lot of the code relies on opening recordsets in this way. Any ideas as to getting the ID field using my current method?"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 1, "creation_date": 1549465926, "post_id": 54555350, "comment_id": 95913150, "body": "If you want to fix this you have to do it in small chunks right? This seems like a great time to start fixing things. Otherwise use SCOPE_IDENTITY"}, {"owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1549466135, "post_id": 54555350, "comment_id": 95913285, "body": "How would I go about using SCOPE_IDENTITY?"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 1, "creation_date": 1549466179, "post_id": 54555350, "comment_id": 95913306, "body": "How did you use @@IDENTITY? Same thing, only scope_identity is safer."}, {"owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1549467074, "post_id": 54555350, "comment_id": 95913887, "body": "Doesn&#39;t work, just returns a null value"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1549467500, "post_id": 54555350, "comment_id": 95914182, "body": "Well then you would either have to stick with @@IDENTITY or fix it properly."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "edited": false, "score": 0, "creation_date": 1549463521, "post_id": 54555850, "comment_id": 95911616, "body": "Doesn&#39;t work. It&#39;s not a data type problem. It literally just sees the ID field as empty, all the other fields have values except the ID field, yet when I check SQL Server it has been added and has a valid ID."}, {"owner": {"reputation": 221, "user_id": 9994550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c894ad9ce27a5c6290b356850530ac18?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jose", "link": "https://stackoverflow.com/users/9994550/s-jose"}, "reply_to_user": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "edited": false, "score": 0, "creation_date": 1549463716, "post_id": 54555850, "comment_id": 95911744, "body": "In your code, you were using RSD as recordset variable not RST. have you tried to change it"}, {"owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "edited": false, "score": 0, "creation_date": 1549463879, "post_id": 54555850, "comment_id": 95911845, "body": "Ah yes I did change that but it didn&#39;t help, still empty"}], "tags": [], "owner": {"reputation": 221, "user_id": 9994550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c894ad9ce27a5c6290b356850530ac18?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jose", "link": "https://stackoverflow.com/users/9994550/s-jose"}, "is_accepted": false, "score": 0, "last_activity_date": 1549464694, "last_edit_date": 1549464694, "creation_date": 1549463103, "answer_id": 54555850, "question_id": 54555350, "link": "https://stackoverflow.com/questions/54555350/how-to-get-id-field-from-recordset/54555850#54555850", "title": "How to get ID field from recordset?", "body": "<p>Try</p>\n\n<pre><code> Private Sub btnAdd_Click()\n    Dim RST As New ADODB.Recordset\n    With RST\n         Open \"SELECT * FROM tblStandardFolders2009 WHERE StandardFoldersID = 0\", fnCNN, adOpenDynamic, adLockOptimistic\n            .AddNew\n                !Description = Me!txtAddGeneric\n                !MakeNewContract = False                    \n            .Update\n            .Bookmark = .LastModified\n            fnStandardFolders2009ID (CLng(RST!StandardFoldersID))\n            .Close\n        End With\n    Set RST = Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "is_accepted": true, "score": 0, "last_activity_date": 1565884596, "creation_date": 1565884596, "answer_id": 57512534, "question_id": 54555350, "link": "https://stackoverflow.com/questions/54555350/how-to-get-id-field-from-recordset/57512534#57512534", "title": "How to get ID field from recordset?", "body": "<p>I have solved the problem and thought I would give an answer for anyone in the future who views this.\nThe connection object being used to open the Recordset had 'adUseServer' as the cursor location. After changing the cursor location to 'adUseClient' I was able to see the ID of newly created records.</p>\n"}], "owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 57512534, "answer_count": 2, "score": 1, "last_activity_date": 1594549751, "creation_date": 1549461526, "last_edit_date": 1594549751, "question_id": 54555350, "link": "https://stackoverflow.com/questions/54555350/how-to-get-id-field-from-recordset", "title": "How to get ID field from recordset?", "body": "<pre><code>Private Sub btnAdd_Click()\nDim RST As New ADODB.Recordset\nWith RST\n     Open \"SELECT * FROM tblStandardFolders2009 WHERE StandardFoldersID = 0\", fnCNN, adOpenDynamic, adLockOptimistic\n        .AddNew\n            !Description = Me!txtAddGeneric\n            !MakeNewContract = False\n        .Update\n        fnStandardFolders2009ID (RSD!StandardFoldersID)\n        .Close\n    End With\nSet RST = Nothing\n</code></pre>\n\n<p>This code adds a record to one of my tables. I need to get the primary key after it's added so that I can use it in another method. RSD!StandardFoldersID is \"empty\" according to Access. Any ideas?</p>\n\n<p>EDIT: Using \"SELECT @@Identity\" afterwards does work but it's not reliable and I know there are better ways.</p>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1549463801, "post_id": 54556017, "comment_id": 95911797, "body": "Yes I understood using formula but for my requirement it should generate from userform."}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1549464354, "post_id": 54556017, "comment_id": 95912156, "body": "I am trying with your edited Code, but where I shall include &quot;BA&quot;"}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1549464971, "post_id": 54556017, "comment_id": 95912559, "body": "Little confused, from where the code will take &quot; Left$(LastSN, 2) as BA &quot; becasue I am not defining anywhere in the Excel"}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1549465141, "post_id": 54556017, "comment_id": 95912662, "body": "Me.txtId.Value = &quot;BA&quot; &amp; Format(Application.Max(Sheets(&quot;Tasks&quot;).Range(&quot;A12:A65536&quot;)) + 1, &quot;00860 ==&gt; in this line I am Clearing indicating to start with &quot;BA&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1549465260, "post_id": 54556017, "comment_id": 95912737, "body": "but this is using the last serial number <code>LastSN</code> which could be something like <code>BA00860</code> extracts <code>BA</code> from it, extracts <code>00860</code> from it and adds <code>+1</code> which results in <code>861</code> and formats them back to 5 digits <code>00861</code> and puts all together to <code>BA00861</code>. You just need to put the last serial number to which you want to add <code>+1</code> into <code>LastSN</code> and it will work."}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1549465975, "post_id": 54556017, "comment_id": 95913189, "body": "00861 00862 00863 00864 00865 00866 00867 00868 00869 01860 I am getting values like this and without &quot;BA&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1549466704, "post_id": 54556017, "comment_id": 95913644, "body": "What did you input as <code>LastSN</code>? It should be something like <code>BA00860</code> as I told you in my example, then it will work. If you do something different then it does not work of course."}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1549467261, "post_id": 54556017, "comment_id": 95914011, "body": "Yes I have given exacetly as you mentioned but also i am not able detect &quot;BA&quot; and the Serial number after 00869 is 01860 instead of 00870"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1549467538, "post_id": 54556017, "comment_id": 95914214, "body": "I added a full example (see edit) to proof that this works as intended. I don&#39;t know what but you must be doing something wrong."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1549467851, "post_id": 54556017, "comment_id": 95914421, "body": "@Santo I cannot tell, I don&#39;t know what you are doing, to less information. You need to put in some effort yourself now. My example works and clearly shows how to increase the serial number. I cannot give you a code that you just need to copy/paste, sorry. Therefore your question is a way too broad."}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1549623845, "post_id": 54556017, "comment_id": 95978368, "body": "Can I use this Code for adding up values &quot;Selection.AutoFill Destination:=Range(&quot;A&quot; &amp; A65536 &amp; &quot;:A&quot; &amp; A65536 + 1), Type:=xlFillDefault &quot;"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1549467506, "last_edit_date": 1549467506, "creation_date": 1549463645, "answer_id": 54556017, "question_id": 54555158, "link": "https://stackoverflow.com/questions/54555158/vba-code-to-auto-serial-number-in-column-a-when-data-entered-in-the-userform/54556017#54556017", "title": "VBA code to auto serial number in column A when data entered in the userform", "body": "<p>Note that this <code>.NumberFormat = \"00860\"</code> is no valid number format.</p>\n\n<p>You can do this easily with a formula. Assume your first serial number is written in A1 like \u2026</p>\n\n<p><a href=\"https://i.stack.imgur.com/pROJH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pROJH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then you can just use the formula <code>=LEFT(A1,2) &amp; TEXT(RIGHT(A1,5)+1,\"00000\")</code> in cell A2 and copy it down to get the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sWPTG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sWPTG.png\" alt=\"enter image description here\"></a></p>\n\n<p>In VBA you could use something like</p>\n\n<pre><code>Dim LastSN As String\nLastSN = Range(\"A1\").Value 'eg BA00860\n\nDim NextSN As String\nNextSN = Left$(LastSN, 2) &amp; Format$(Right(LastSN, 5) + 1, \"00000\")\n</code></pre>\n\n<p>Full example according comments:</p>\n\n<pre><code>Sub Test()\n    Dim LastSN As String\n    LastSN = \"BA00860\"\n\n    Dim NextSN As String\n    NextSN = Left$(LastSN, 2) &amp; Format$(Right(LastSN, 5) + 1, \"00000\")\n\n    MsgBox \"LastSN was: \" &amp; LastSN &amp; vbCrLf &amp; \"NextSN is: \" &amp; NextSN\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 592, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1549467506, "creation_date": 1549460911, "last_edit_date": 1549463151, "question_id": 54555158, "link": "https://stackoverflow.com/questions/54555158/vba-code-to-auto-serial-number-in-column-a-when-data-entered-in-the-userform", "title": "VBA code to auto serial number in column A when data entered in the userform", "body": "<p>I have a userform in which user can fill the data and data will insert in column C to Z. I need a code, either in worksheet or in userform to auto fill serial number starting with <code>BA00860</code> which will fill in column A everytime data has enter.</p>\n\n<p>I tried with the below Code under the <code>Commandbutton_Click</code> I was able to generate Serial numbers from <code>BA00860</code> to <code>BA00869</code>, then after it is starting with <code>BA01861</code> but not <code>BA00870</code>.  Please correct my code as I required to be <code>BA00860</code> \u2026 <code>BA00870</code> \u2026 <code>BA00880</code> and so on.</p>\n\n<pre><code>Me.txtId.Value = \"BA\" &amp; Format(Application.Max(Sheets(\"Tasks\").Range(\"A12:A65536\")) + 1, \"00860\")\n\nActiveCell.Offset(0, 0).Value = Me.txtId.Value\n\nActiveCell.Offset(0, 0).NumberFormat = \"00860\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549459745, "post_id": 54554738, "comment_id": 95909270, "body": "Can you use PowerQuery? It\u2019d be a faster and easier to implement alternative."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1549460005, "post_id": 54554738, "comment_id": 95909411, "body": "You could use <code>ADO</code> and build a <code>UNION</code> sql query from all files."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1549460047, "post_id": 54554738, "comment_id": 95909436, "body": "Hm... What is &quot;I can assing fixed range&quot;?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1549460133, "post_id": 54554738, "comment_id": 95909486, "body": "<a href=\"https://www.connectionstrings.com/textfile/\" rel=\"nofollow noreferrer\">connectionstrings.com/textfile</a> and <a href=\"https://analysistabs.com/excel-vba/ado-sql-macros-connecting-database/\" rel=\"nofollow noreferrer\">analysistabs.com/excel-vba/ado-sql-macros-connecting-databas&zwnj;&#8203;e</a>   also, <code>usedrange</code> may help also."}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1549461444, "post_id": 54555296, "comment_id": 95910271, "body": "or you can use <code>cells(rows.count,1).end(xlUp)</code> for example to find the depth of the column A (column 1), or <code>.UsedRange</code>"}, {"owner": {"reputation": 1, "user_id": 11022734, "user_type": "registered", "profile_image": "https://graph.facebook.com/1020972491295331/picture?type=large", "display_name": "Alexey Nenashev", "link": "https://stackoverflow.com/users/11022734/alexey-nenashev"}, "edited": false, "score": 0, "creation_date": 1549463931, "post_id": 54555296, "comment_id": 95911883, "body": "Thank you Nathan! I&#39;ve used <code>Set sourceRange = .Range(ActiveSheet.UsedRange.Address)</code> and it worked like a charm!"}], "tags": [], "owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "is_accepted": false, "score": 0, "last_activity_date": 1549461364, "creation_date": 1549461364, "answer_id": 54555296, "question_id": 54554738, "link": "https://stackoverflow.com/questions/54554738/merging-excel-sheets-from-books-in-the-directory-into-one-dynamic-source-data/54555296#54555296", "title": "Merging excel sheets from books in the directory into one: dynamic source data", "body": "<p>If I understand you correctly, you would like to have a dynamic way to select all the cells that have values in the sheet and copy to another \"master workbook\". This is how I've done this in the past.</p>\n\n<pre><code> Sub SelectActualUsedRange()\n\n  Dim FirstCell As Range, LastCell As Range\n\n  Set LastCell = Cells(Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n      SearchDirection:=xlPrevious, LookIn:=xlValues).Row, _\n      Cells.Find(What:=\"*\", SearchOrder:=xlByColumns, _\n      SearchDirection:=xlPrevious, LookIn:=xlValues).Column)\n\n  Set FirstCell = Cells(Cells.Find(What:=\"*\", After:=LastCell, SearchOrder:=xlRows, _\n      SearchDirection:=xlNext, LookIn:=xlValues).Row, _\n      Cells.Find(What:=\"*\", After:=LastCell, SearchOrder:=xlByColumns, _\n      SearchDirection:=xlNext, LookIn:=xlValues).Column)\n  Range(FirstCell, LastCell).Select\n\nEnd Sub\n</code></pre>\n\n<p>Instead of hard coding a range in the code you can use this small function to get the actual used range.\nHope this answers your question.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1550010879, "creation_date": 1550010879, "answer_id": 54659692, "question_id": 54554738, "link": "https://stackoverflow.com/questions/54554738/merging-excel-sheets-from-books-in-the-directory-into-one-dynamic-source-data/54659692#54659692", "title": "Merging excel sheets from books in the directory into one: dynamic source data", "body": "<p>Either one of these two options should work for you.  </p>\n\n<pre><code>' Merge data from multiple sheets into separate sheets\nSub AnalysisMerger1()\n    Dim WSA As Worksheet\n    Dim bookList As Workbook\n    Dim SelectedFiles As Variant\n    Dim NFile As Long\n    Dim FileName As String\n    Dim Ws As Worksheet, vDB As Variant, rngT As Range\n    Dim vFn, myFn As String\n\n    Application.ScreenUpdating = False\n\n    SelectedFiles = Application.GetOpenFilename(filefilter:=\"Excel Files (*.csv*), *.csv*\", MultiSelect:=True)\n    If IsEmpty(SelectedFiles) Then Exit Sub\n\n    For NFile = LBound(SelectedFiles) To UBound(SelectedFiles)\n        FileName = SelectedFiles(NFile)\n        vFn = Split(FileName, \"\\\")\n        myFn = vFn(UBound(vFn))\n        myFn = Replace(myFn, \".csv\", \"\")\n        Set bookList = Workbooks.Open(FileName, Format:=2)\n        Set WSA = bookList.Sheets(1)\n        vDB = WSA.UsedRange\n        bookList.Close (0)\n        Set Ws = Sheets.Add(after:=Sheets(Sheets.Count))\n        ActiveSheet.Name = myFn\n        Ws.Range(\"a1\").Resize(UBound(vDB, 1), UBound(vDB, 2)) = vDB\n    Next\n    Application.ScreenUpdating = True\n\nEnd Sub\n\n' Merge data from multime files into one sheet.\nSub AnalysisMerger2()\n    Dim WSA As Worksheet\n    Dim bookList As Workbook\n    Dim SelectedFiles() As Variant\n    Dim NFile As Long\n    Dim FileName As String\n    Dim Ws As Worksheet, vDB As Variant, rngT As Range\n\n    Application.ScreenUpdating = False\n\n\n    Set Ws = ThisWorkbook.Sheets(1)\n    Ws.UsedRange.Clear\n    'change folder path of excel files here\n    SelectedFiles = Application.GetOpenFilename(filefilter:=\"Excel Files (*.csv*), *.csv*\", MultiSelect:=True)\n\n\n    For NFile = LBound(SelectedFiles) To UBound(SelectedFiles)\n        FileName = SelectedFiles(NFile)\n        Set bookList = Workbooks.Open(FileName, Format:=2)\n        Set WSA = bookList.Sheets(1)\n        With WSA\n            vDB = .UsedRange\n            Set rngT = Ws.Range(\"a\" &amp; Rows.Count).End(xlUp)(2)\n            If rngT.Row = 2 Then Set rngT = Ws.Range(\"a1\")\n            rngT.Resize(UBound(vDB, 1), UBound(vDB, 2)) = vDB\n\n            bookList.Close (0)\n        End With\n    Next\n    Application.ScreenUpdating = True\n    Ws.Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11022734, "user_type": "registered", "profile_image": "https://graph.facebook.com/1020972491295331/picture?type=large", "display_name": "Alexey Nenashev", "link": "https://stackoverflow.com/users/11022734/alexey-nenashev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550010879, "creation_date": 1549459534, "question_id": 54554738, "link": "https://stackoverflow.com/questions/54554738/merging-excel-sheets-from-books-in-the-directory-into-one-dynamic-source-data", "title": "Merging excel sheets from books in the directory into one: dynamic source data", "body": "<p>So im trying to merge multiple .csv files into one excel workbook.\nAll .csv have 1 sheet and a random amount of row, but fixed amount of columns.</p>\n\n<p>I can assing fixed range, but that will overburdain the file, how do I define a range, which will select all filled rows in the file and paste them in the new one?</p>\n\n<pre><code>Sub Merge()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, Fnum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n\n    'Fill in the path\\folder where the files are\n    MyPath = ActiveWorkbook.Path &amp; \"\\\"\n\n    'If there are no Excel files in the folder exit the sub\n    FilesInPath = Dir(MyPath &amp; \"*.csv\")\n    If FilesInPath = \"\" Then\n        MsgBox \"No files found\"\n        Exit Sub\n    End If\n\n    'Fill the array(myFiles)with the list of Excel files in the folder\n    Fnum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        Fnum = Fnum + 1\n        ReDim Preserve MyFiles(1 To Fnum)\n        MyFiles(Fnum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    'Change ScreenUpdating, Calculation and EnableEvents\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Add a new workbook with one sheet\n    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n    rnum = 1\n\n    'Loop through all files in the array(myFiles)\n    If Fnum &gt; 0 Then\n        For Fnum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MyPath &amp; MyFiles(Fnum))\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n\n                On Error Resume Next\n\n                With mybook.Worksheets(1)\n                    Set sourceRange = .Range(\"A1:C1\")\n                End With\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    'if SourceRange use all columns then skip this file\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n                On Error GoTo 0\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.Rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                        MsgBox \"Sorry there are not enough rows in the sheet\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close savechanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        'Copy the file name in column A\n                        With sourceRange\n                            BaseWks.Cells(rnum, \"A\"). _\n                                    Resize(.Rows.Count).Value = MyFiles(Fnum)\n                        End With\n\n                        'Set the destrange\n                        Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                        'we copy the values from the sourceRange to the destrange\n                        With sourceRange\n                            Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                        End With\n                        destrange.Value = sourceRange.Value\n\n                        rnum = rnum + SourceRcount\n                    End If\n                End If\n                mybook.Close savechanges:=False\n            End If\n\n        Next Fnum\n        BaseWks.Columns.AutoFit\n    End If\n\nExitTheSub:\n    'Restore ScreenUpdating, Calculation and EnableEvents\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\nEnd Sub\n</code></pre>\n\n<p>Exactly in here the range is the source range defined, i need to swap it to dynamic source range </p>\n\n<pre><code>        With mybook.Worksheets(1)\n            Set sourceRange = .Range(\"A1:C1\")\n        End With\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11022940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff6ad297847f0fcbcff864fd207c3e8?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Carlos", "link": "https://stackoverflow.com/users/11022940/neil-carlos"}, "edited": false, "score": 0, "creation_date": 1549462872, "post_id": 54554572, "comment_id": 95911183, "body": "Tried using Selection.Resize instead of ActiveCell.Resize. It worked :) Thank you very much PEH!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1549459027, "creation_date": 1549459027, "answer_id": 54554572, "question_id": 54554488, "link": "https://stackoverflow.com/questions/54554488/i-need-to-copy-multiple-user-selected-rows-to-a-different-worksheet-the-problem/54554572#54554572", "title": "I need to copy multiple user selected rows to a different worksheet. The problem is, the selected rows are different each time the macro runs", "body": "<p>Use <code>Selection</code> instead of <code>ActiveCell</code>. </p>\n\n<p><code>Selection</code> contains <strong>all</strong> selected cells while <code>ActiveCell</code> is always only one cell within the whole <code>Selection</code>.</p>\n\n<p>In the following example <code>Selection</code> would be <code>Range(\"A2,B5,A7,A10:B10\")</code> but <code>ActiveCell</code> would be <code>Range(\"A10\")</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/l5yuS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l5yuS.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 11022940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff6ad297847f0fcbcff864fd207c3e8?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Carlos", "link": "https://stackoverflow.com/users/11022940/neil-carlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 54554572, "answer_count": 1, "score": 1, "last_activity_date": 1549459027, "creation_date": 1549458762, "last_edit_date": 1549458800, "question_id": 54554488, "link": "https://stackoverflow.com/questions/54554488/i-need-to-copy-multiple-user-selected-rows-to-a-different-worksheet-the-problem", "title": "I need to copy multiple user selected rows to a different worksheet. The problem is, the selected rows are different each time the macro runs", "body": "<p>Say the user selected E3 and E4, is there a way to copy the values of E3 and E4, as well as the next three cells on their right (F3:H4)?</p>\n\n<p>I tried using ActiveCell.Resize but I do not know how to copy selected rows since the selected rows change depending on the user.</p>\n\n<p>This is a sample of my code:</p>\n\n<pre><code>ActiveCell.Resize(, 4).Copy Destination:=Worksheets(\"Sheet3\").Range(\"b7:e14\")\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1549463573, "post_id": 54554734, "comment_id": 95911652, "body": "Could you explain why your solution answers the question?"}, {"owner": {"reputation": 189, "user_id": 3661800, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bAhMe.jpg?s=128&g=1", "display_name": "Kaw4Life", "link": "https://stackoverflow.com/users/3661800/kaw4life"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1549473061, "post_id": 54554734, "comment_id": 95917552, "body": "Not trying to be smart but I just do not understand how that is not obvious. Me.strLblName.FontBold = True is replaced with Controls(strLblName).FontBold = True"}, {"owner": {"reputation": 4625, "user_id": 1478654, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BiUl3.png?s=128&g=1", "display_name": "Clay", "link": "https://stackoverflow.com/users/1478654/clay"}, "edited": false, "score": 0, "creation_date": 1549478038, "post_id": 54554734, "comment_id": 95919866, "body": "I see that it&#39;s right...but probably ought to have some safety...like making sure Controls(strLbName) actually returned something before setting a property on it."}], "tags": [], "owner": {"reputation": 189, "user_id": 3661800, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bAhMe.jpg?s=128&g=1", "display_name": "Kaw4Life", "link": "https://stackoverflow.com/users/3661800/kaw4life"}, "is_accepted": false, "score": 0, "last_activity_date": 1549459521, "creation_date": 1549459521, "answer_id": 54554734, "question_id": 54554202, "link": "https://stackoverflow.com/questions/54554202/provide-control-name-via-string/54554734#54554734", "title": "Provide Control Name via String", "body": "<pre><code>Controls(strLblName).FontBold = True\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 3661800, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bAhMe.jpg?s=128&g=1", "display_name": "Kaw4Life", "link": "https://stackoverflow.com/users/3661800/kaw4life"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594620031, "creation_date": 1549457873, "last_edit_date": 1594620031, "question_id": 54554202, "link": "https://stackoverflow.com/questions/54554202/provide-control-name-via-string", "title": "Provide Control Name via String", "body": "<p>\"Me.strLblName.FontBold = True\" does not work.  I have tried Me.&amp; strLblName &amp;.FontBold = True along with many others.  Is this a syntax thing or do I need another method?</p>\n\n<pre><code>**Private Sub Form_Load()\nDim ctl As Control, intUsage As Integer, strCtlName As String, strLblName As String\nFor Each ctl In Me.Form.Controls\n    Select Case ctl.ControlType\n        Case acCommandButton\n            intUsage = DLookup(\"process_usage\", \"tbl_db_stats\", \"cbtn_name = '\" &amp; ctl.Name &amp; \"'\")\n            Debug.Print ctl.ControlType, ctl.Name, intUsage\n            strLblName = \"lbl_\" &amp; Right(ctl.Name, Len(ctl.Name) - 5)\n            If intUsage &lt; 10 Then\n                Stop\n                'CHANGE LABEL TEXT TO BOLD\n                Me.strLblName.FontBold = True\n            End If\n    End Select\nNext ctl\nEnd Sub**\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 3, "creation_date": 1549456587, "post_id": 54553647, "comment_id": 95907394, "body": "I suggest you to use a different name for variable <code>Name</code> because it&#39;s a command in VBA. Use something like <code>MyName</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1549457191, "last_edit_date": 1549457191, "creation_date": 1549456616, "answer_id": 54553832, "question_id": 54553647, "link": "https://stackoverflow.com/questions/54553647/excel-vba-issues-with-application-username-error/54553832#54553832", "title": "Excel/VBA issues with Application Username error", "body": "<p>Try this code in a new Excel workbook:</p>\n\n<pre><code>Sub TestMe()\n\n    WriteData        \n    Dim email As String\n    Dim name As String: name = \"Mike\"  'Application.UserName\n    email = WorksheetFunction.VLookup(name, Worksheets(1).Range(\"K:N\"), 4, False)\n    MsgBox email\n\nEnd Sub\n\nSub WriteData()\n\n    With Worksheets(1)\n        .Range(\"K1\") = \"Mike\"\n        .Range(\"K2\") = \"Mike2\"\n        .Range(\"N1\") = \"Mike@add.ress\"\n        .Range(\"N2\") = \"Mike2@add.ress\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>In general, it looks for value \"Mike\" in column \"K\" and returns the vlaue in column \"N\" of the corresponding row.</p>\n\n<hr>\n\n<p>If there is a possible error, thus the <code>VlookUp()</code> does not find a good value then the following two options are possible:</p>\n\n<ul>\n<li><p><code>Dim email As Variant</code> \nIt will return the number of the error in the <code>MsgBox()</code>, if an error exists. The reason is that <code>Variant</code> could take the error value in itself, and a String cannot.</p></li>\n<li><p>Use <code>IfError</code> and catch the error correspondingly. In the example below, it returns \"No \" and then the <code>name</code> variable:</p></li>\n</ul>\n\n<hr>\n\n<pre><code>Sub TestMe()\n\n    WriteData\n\n    Dim email As String\n    Dim name As String: name = \"Mike\"  'Application.UserName\n    With Application\n        email = .WorksheetFunction.IfError(.VLookup(name, _\n            Worksheets(1).Range(\"K:N\"), 4, False), \"No \" &amp; name)\n    End With\n    MsgBox email\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1549459538, "last_edit_date": 1549459538, "creation_date": 1549459130, "answer_id": 54554614, "question_id": 54553647, "link": "https://stackoverflow.com/questions/54553647/excel-vba-issues-with-application-username-error/54554614#54554614", "title": "Excel/VBA issues with Application Username error", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\n Sub test()\n\n    Dim email As String\n    Dim strname As String\n\n    strname = Application.UserName\n    email = WorksheetFunction.VLookup(strname, Sheet1.Range(\"K:N\"), 4, False)\n    If email = \"\" Then\n        MsgBox \"No email found for \" &amp; strname &amp; \".\"\n    Else\n        MsgBox \"The email address assign to \" &amp; strname &amp; \" is \" &amp; email &amp; \".\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 6096348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d6e579605c2c44d6c41d4483f34ad0a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/6096348/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1549491325, "creation_date": 1549491325, "answer_id": 54563399, "question_id": 54553647, "link": "https://stackoverflow.com/questions/54553647/excel-vba-issues-with-application-username-error/54563399#54563399", "title": "Excel/VBA issues with Application Username error", "body": "<p>Apologies, found the issue, the lookup table didn't had the same spelling as application.username. Hence it will throw that error.</p>\n\n<p>Thank you guys for your assistance.</p>\n"}], "owner": {"reputation": 127, "user_id": 6096348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d6e579605c2c44d6c41d4483f34ad0a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/6096348/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1549491325, "creation_date": 1549456027, "last_edit_date": 1549456186, "question_id": 54553647, "link": "https://stackoverflow.com/questions/54553647/excel-vba-issues-with-application-username-error", "title": "Excel/VBA issues with Application Username error", "body": "<p>I am trying to vlookup a name in a sheet via VBA using below script and get</p>\n\n<blockquote>\n  <p>Run time error 1004, \n  Application defined or object defined error.</p>\n</blockquote>\n\n<pre><code> Sub test()\nDim email As Variant\nDim name As String\nname = Application.UserName\nemail = WorksheetFunction.VLookup(name, Sheet1.Range(\"K:N\"), 4, False)\nMsgBox email\nEnd Sub\n</code></pre>\n\n<p>However when I hardcode a name like below, it works fine, what am I doing wrong?</p>\n\n<pre><code>name = \"Mike Thomson\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 2, "creation_date": 1549455111, "post_id": 54553161, "comment_id": 95906444, "body": "As it looks for a continuous range, which there isn&#39;t."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1549455574, "post_id": 54553161, "comment_id": 95906749, "body": "This is quite fun actually. I would go with a tiny bug/feature option."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1549456138, "post_id": 54553161, "comment_id": 95907091, "body": "You are copying, but not using what you&#39;ve copied, you&#39;re only doing the fill right.  You want something like <code>resize</code> and <code>offset</code>"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4161226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2e0e9af042de977e48d7a4151f3b49b?s=128&d=identicon&r=PG&f=1", "display_name": "STim", "link": "https://stackoverflow.com/users/4161226/stim"}, "edited": false, "score": 1, "creation_date": 1549458369, "post_id": 54554030, "comment_id": 95908412, "body": "There are lots of ways to achieve the desired result, but I&#39;m trying to understand the discrepancy between the keyboard instructions and the code instructions. I don&#39;t understand why <code>Range(Selection, Selection.End(xlToRight)).Select</code> does not select the range from &quot;A1&quot; to &quot;H1&quot; in the case of the third screenshot above, and none of the responses so far have clarified this issue."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 55, "user_id": 4161226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2e0e9af042de977e48d7a4151f3b49b?s=128&d=identicon&r=PG&f=1", "display_name": "STim", "link": "https://stackoverflow.com/users/4161226/stim"}, "edited": false, "score": 1, "creation_date": 1549463572, "post_id": 54554030, "comment_id": 95911650, "body": "@STim - It does not select <code>A1:H1</code> in the third screenshot because you have a value in cell <code>B1</code>. The <code>End</code> method will only move to the end of the contiguous data range (up, down, left, right) from the point where it begins, or to the next cell with data if there is a blank cell directly after the starting cell."}, {"owner": {"reputation": 55, "user_id": 4161226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2e0e9af042de977e48d7a4151f3b49b?s=128&d=identicon&r=PG&f=1", "display_name": "STim", "link": "https://stackoverflow.com/users/4161226/stim"}, "edited": false, "score": 0, "creation_date": 1549464732, "post_id": 54554030, "comment_id": 95912395, "body": "Okay, I understand, the key issue is that the VBA range method measures from the left-most point (or beginning point) of the range. Clearly though, the keyboard shortcuts performed on the multi-cell range produce different instructions, which do not correspond to the code produced by the macro recorder."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1549465037, "post_id": 54554030, "comment_id": 95912595, "body": "It is very much possible that what the macro recorder produces is not the same as what goes on in the &quot;brain&quot; of excel/VBA. Regardless, I think it would not hurt if this issue were to be corrected in the next Excel update."}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 0, "last_activity_date": 1549457284, "creation_date": 1549457284, "answer_id": 54554030, "question_id": 54553161, "link": "https://stackoverflow.com/questions/54553161/using-the-range-end-property-to-extend-a-multi-cell-range/54554030#54554030", "title": "Using the Range.End property to extend a multi-cell range", "body": "<pre><code>Sub copyfill()\nWith ThisWorkbook.Sheets(REFERENCE)\n    LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    .Range(.Cells(1,\"B\"),.Cells(1,LastCol).Value = .Cells(1,1).Value\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Perhaps not an answer to your question, but this does the same. Hope it helps.</p>\n\n<p>As Luuklag already mentioned, if you want to autofill a range, it has to be adjunct to a continuous range. Populate some continuous cells in <code>col A</code>, then add a value in <code>B1</code>. <code>Col B</code> will autofill without any problems. Try the same with only e.g. <code>A1</code> and <code>A20</code> populated, and you will notice <code>col B</code> does not autofill until the 20nd row.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 9755068, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b5aLXKYUeSU/AAAAAAAAAAI/AAAAAAAAAYU/XPREfr2Gr94/photo.jpg?sz=128", "display_name": "Gustavo Queiroz", "link": "https://stackoverflow.com/users/9755068/gustavo-queiroz"}, "is_accepted": false, "score": 0, "last_activity_date": 1549457756, "creation_date": 1549457756, "answer_id": 54554174, "question_id": 54553161, "link": "https://stackoverflow.com/questions/54553161/using-the-range-end-property-to-extend-a-multi-cell-range/54554174#54554174", "title": "Using the Range.End property to extend a multi-cell range", "body": "<p><strong>Get LASTROW</strong></p>\n\n<p>Try this:</p>\n\n<ul>\n<li>Declare a range with the interval between ActiveCell for the last non-empty column;</li>\n<li><p>Use <strong>for each</strong> to enter all values \u200b\u200bin each cell in the range.</p>\n\n<pre><code>Public Sub copyLastColumn()\nDim val As Variant: val = Selection.Value\nDim sh As Worksheet: Set sh = ThisWorkbook.Worksheets(1)\n\nDim rng As Range: Set rng = sh.Range(ActiveCell, _\n                                 sh.Cells(ActiveCell.Row, \nsh.Cells(ActiveCell.Row, sh.Columns.Count).End(xlToLeft).Column))\n\nFor Each el In rng\n    el.Value = val\nNext el\nEnd Sub\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 4161226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2e0e9af042de977e48d7a4151f3b49b?s=128&d=identicon&r=PG&f=1", "display_name": "STim", "link": "https://stackoverflow.com/users/4161226/stim"}, "edited": false, "score": 0, "creation_date": 1549465615, "post_id": 54555869, "comment_id": 95912953, "body": "That&#39;s not correct. In the case of the data in the third diagram, the commands in the macro actually mean: <code>Range(Range(&quot;A1:B1&quot;), Range(&quot;A1:B1&quot;).End(xlToRight))</code>. This is the same range reference as simply: <code>Range(&quot;A1:B1&quot;)</code>. Furthermore, <code>Range(&quot;A1:B1&quot;).End(xlToRight)</code> is equivalent to <code>Range(&quot;B1&quot;)</code>. So I can see why I&#39;m getting the result I&#39;m getting, but what I don&#39;t understand is why is there no correspondence between the keyboard shortcuts and the code produced?"}, {"owner": {"reputation": 72, "user_id": 10823192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fef2c5a3b9e27f899813876303e0b89e?s=128&d=identicon&r=PG&f=1", "display_name": "E.Georgiev", "link": "https://stackoverflow.com/users/10823192/e-georgiev"}, "reply_to_user": {"reputation": 55, "user_id": 4161226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2e0e9af042de977e48d7a4151f3b49b?s=128&d=identicon&r=PG&f=1", "display_name": "STim", "link": "https://stackoverflow.com/users/4161226/stim"}, "edited": false, "score": 0, "creation_date": 1549540004, "post_id": 54555869, "comment_id": 95942940, "body": "No - when you record macro - in 1-st step you stay in call A1 - this is range A1. In macro , as first row, you have to add : Range(&quot;A1:H1&quot;).Select . Thus the range become A1:H1, not A1 . Then macro will behave as you wish. The problem was that at first step you have to select range A1:H1"}], "tags": [], "owner": {"reputation": 72, "user_id": 10823192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fef2c5a3b9e27f899813876303e0b89e?s=128&d=identicon&r=PG&f=1", "display_name": "E.Georgiev", "link": "https://stackoverflow.com/users/10823192/e-georgiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1549463164, "creation_date": 1549463164, "answer_id": 54555869, "question_id": 54553161, "link": "https://stackoverflow.com/questions/54553161/using-the-range-end-property-to-extend-a-multi-cell-range/54555869#54555869", "title": "Using the Range.End property to extend a multi-cell range", "body": "<p>This happened because commands in macro mean :</p>\n\n<ol>\n<li>Selection = Range(\"A1\") </li>\n<li>Range(Selection, Selection.End(xlToRight)).Select = Range(\"A1\", Range(\"A1\").End(xlToRight)).Select</li>\n</ol>\n\n<p>This mean \"selection from cell A1 to the last cell in row 1 that contains data\".  </p>\n\n<p>You have to make diff\u0435rence between Selection from row 1 in macro - this is Range(\"A1\") and selection, which you make with mouse, before to start macro !   </p>\n\n<p>That's why, when you select 2 neighbour cell with values in them, you think that macro do nothing - but macro do it's job - you can be convicted in this if you have diff\u0435rent values in cells - for example Start in A1 and ST in A2 - after starting macro you will see that values in this cells became Start and Start</p>\n\n<p>You can see this URL for more : <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.end\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.end</a></p>\n"}], "owner": {"reputation": 55, "user_id": 4161226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2e0e9af042de977e48d7a4151f3b49b?s=128&d=identicon&r=PG&f=1", "display_name": "STim", "link": "https://stackoverflow.com/users/4161226/stim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1549471790, "creation_date": 1549454370, "last_edit_date": 1549471790, "question_id": 54553161, "link": "https://stackoverflow.com/questions/54553161/using-the-range-end-property-to-extend-a-multi-cell-range", "title": "Using the Range.End property to extend a multi-cell range", "body": "<p>Using the below data, and recording the following actions in the Macro Recorder produces the below code:</p>\n\n<pre><code>Ctrl + C \nCtrl + Shift + Right Arrow \nCtrl + R\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/DjIXO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DjIXO.png\" alt=\"Starting data with single-cell range selected\"></a></p>\n\n<pre><code>Sub Macro1()\n    Selection.Copy\n    Range(Selection, Selection.End(xlToRight)).Select\n    Application.CutCopyMode = False\n    Selection.FillRight\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/eQEJG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eQEJG.png\" alt=\"Data after entering above keyboard strokes\"></a></p>\n\n<p>This is what I would expect. Performing exactly the same keyboard strokes when multiple cells are selected such as in the image below achieves the same result and produces the same code in the Macro Recorder. However, reusing this code does NOT produce that result when multiple cells are selected. Why does the Range.End property not work in this context i.e. extending a multi-cell range? </p>\n\n<p><a href=\"https://i.stack.imgur.com/Bc5Zi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Bc5Zi.png\" alt=\"Starting data with multi-cell range selected\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549455106, "post_id": 54553039, "comment_id": 95906437, "body": "Can you show expected output?"}, {"owner": {"reputation": 5, "user_id": 10347061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09fb829899faacd6e9ecb5ba0c3bb58?s=128&d=identicon&r=PG&f=1", "display_name": "Ante antic", "link": "https://stackoverflow.com/users/10347061/ante-antic"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549457519, "post_id": 54553039, "comment_id": 95907924, "body": "Outputs are: <a href=\"https://ufile.io/7rihc\" rel=\"nofollow noreferrer\">ufile.io/7rihc</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10347061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09fb829899faacd6e9ecb5ba0c3bb58?s=128&d=identicon&r=PG&f=1", "display_name": "Ante antic", "link": "https://stackoverflow.com/users/10347061/ante-antic"}, "edited": false, "score": 0, "creation_date": 1549465674, "post_id": 54555020, "comment_id": 95913000, "body": "I need to calculate average of all the number,not row by row"}, {"owner": {"reputation": 487, "user_id": 10946960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4b4b026d8ded0102e23e33a72bc79d?s=128&d=identicon&r=PG&f=1", "display_name": "IrwinAllen13", "link": "https://stackoverflow.com/users/10946960/irwinallen13"}, "reply_to_user": {"reputation": 5, "user_id": 10347061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09fb829899faacd6e9ecb5ba0c3bb58?s=128&d=identicon&r=PG&f=1", "display_name": "Ante antic", "link": "https://stackoverflow.com/users/10347061/ante-antic"}, "edited": false, "score": 0, "creation_date": 1549470377, "post_id": 54555020, "comment_id": 95916075, "body": "I just updated the above answer to include a third macro for calculating the entire worksheet."}], "tags": [], "owner": {"reputation": 487, "user_id": 10946960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4b4b026d8ded0102e23e33a72bc79d?s=128&d=identicon&r=PG&f=1", "display_name": "IrwinAllen13", "link": "https://stackoverflow.com/users/10946960/irwinallen13"}, "is_accepted": true, "score": 0, "last_activity_date": 1549470473, "last_edit_date": 1549470473, "creation_date": 1549460534, "answer_id": 54555020, "question_id": 54553039, "link": "https://stackoverflow.com/questions/54553039/calculating-average-of-variable-data-size-using-vba-and-excel/54555020#54555020", "title": "Calculating average of variable data size using VBA and Excel", "body": "<p>Here are two quick functions that you could add to your workbook that can calculate the average of a column.</p>\n\n<pre><code>Private Function ColumnAvg(colRng As Range)\n\n    ColumnAvg = 0\n    On Error Resume Next\n\n    ColumnAvg = Application.WorksheetFunction.Sum(Columns(colRng.Column)) / _ \n                Application.WorksheetFunction.CountA(Columns(colRng.Column))\n\nEnd Function\n\nPrivate Function RowAvg(rowRng As Range)\n\n    RowAvg = 0\n    On Error Resume Next\n\n    RowAvg = Application.WorksheetFunction.Sum(Rows(rowRng.Row)) / _ \n             Application.WorksheetFunction.CountA(Rows(rowRng.Row))\n\nEnd Function\n</code></pre>\n\n<p>NOte: These are marked as private functions as they will calculate the ENTIRE column or row. These functions are meant to be called within VBA, not within the spreedsheet. Make sure you place these functions within the same module.</p>\n\n<p>Example of code:</p>\n\n<p>1 - <code>x = ColumnAvg(Range(\"A1\"))</code></p>\n\n<p>2 - <code>x = ColumnAvg(Range(\"A:A\"))</code></p>\n\n<p>3 - <code>x = ColumnAvg(Cells(1,1))</code></p>\n\n<p>If you are wanting to calculate the entire worksheet's average, then you could use this function...</p>\n\n<pre><code>Private Function AvgEverything()\nDim Text As String\n\n    Text = \"A1:\" &amp; Split(Cells(1, ActiveSheet.Columns.Count).Address(True, False), \"$\")(0) _ \n                 &amp; ActiveSheet.Rows.Count\n    AvgEverything = Application.WorksheetFunction.Sum(Range(Text)) / _\n                    Application.WorksheetFunction.CountA(Range(Text))\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10347061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09fb829899faacd6e9ecb5ba0c3bb58?s=128&d=identicon&r=PG&f=1", "display_name": "Ante antic", "link": "https://stackoverflow.com/users/10347061/ante-antic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 1, "accepted_answer_id": 54555020, "answer_count": 1, "score": 0, "last_activity_date": 1549470473, "creation_date": 1549453986, "last_edit_date": 1549455826, "question_id": 54553039, "link": "https://stackoverflow.com/questions/54553039/calculating-average-of-variable-data-size-using-vba-and-excel", "title": "Calculating average of variable data size using VBA and Excel", "body": "<p>I have task to upload multiple text files to multiple sheets and calculate average below that data.Some text files have 200 rows and some have 5 rows with \ndifferent number of data in each row.I have succesfully separate each file but i cannot make function average.Example of txt file: <a href=\"https://ufile.io/7ii41\" rel=\"nofollow noreferrer\">https://ufile.io/7ii41</a></p>\n\n<pre><code>Sub CombineTextFiles()\n    Dim xFilesToOpen As Variant\n    Dim I As Integer\n    Dim xWb As Workbook\n    Dim xTempWb As Workbook\n    Dim xDelimiter As String\n    Dim xScreen As Boolean\n    Dim lRow As Long\n    Dim lCol As Long\n    Dim Rws As Long\n    Dim Col As Integer\n    Dim r As Range\n    Dim FrNg As Range\n    On Error GoTo ErrHandler\n    xScreen = Application.ScreenUpdating\n    Application.ScreenUpdating = False\n    xFilesToOpen = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\", , \"Open\", , True)\n    If TypeName(xFilesToOpen) = \"Boolean\" Then\n        MsgBox \"No files were selected\", , \"Error\"\n        GoTo ExitHandler\n    End If\n    I = 1\n    Set xTempWb = Workbooks.Open(xFilesToOpen(I))\n    xTempWb.Sheets(1).Copy\n    Set xWb = Application.ActiveWorkbook\n    xTempWb.Close False\n    xWb.Worksheets(I).Columns(\"A:A\").TextToColumns _\n      Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n      TextQualifier:=xlDoubleQuote, _\n      ConsecutiveDelimiter:=False, _\n      Tab:=False, Semicolon:=False, _\n      Comma:=True, Space:=False, _\n      Other:=False\n      lRow = Cells.Find(what:=\"*\", _\n                    after:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Row\n     average=??\n\n    Do While I &lt; UBound(xFilesToOpen)\n        I = I + 1\n        Set xTempWb = Workbooks.Open(xFilesToOpen(I))\n        With xWb\n            xTempWb.Sheets(1).Move after:=.Sheets(.Sheets.Count)\n            .Worksheets(I).Columns(\"A:A\").TextToColumns _\n              Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n              TextQualifier:=xlDoubleQuote, _\n              ConsecutiveDelimiter:=False, _\n              Tab:=False, Semicolon:=False, _\n              Comma:=True, Space:=False, _\n              Other:=False\n        End With\n        lRow = Cells.Find(what:=\"*\", _\n                    after:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Row\n    average=??\n\n    Loop\n\nExitHandler:\n    Application.ScreenUpdating = xScreen\n    Set xWb = Nothing\n    Set xTempWb = Nothing\n    Exit Sub\nErrHandler:\n    MsgBox Err.Description, , \"Error\"\n    Resume ExitHandler\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 698, "user_id": 4244020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55d4e02944f4aaed2b934a701950a4df?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy8ball", "link": "https://stackoverflow.com/users/4244020/jimmy8ball"}, "edited": false, "score": 1, "creation_date": 1549453558, "post_id": 54552537, "comment_id": 95905542, "body": "Any particular reason you can&#39;t use an ODBC connection to your Access instance, your queries can be generated and stored in Access. You can then reference these directly from within EXCEL as a linked table. - Here is a good place to start - <a href=\"https://support.office.com/en-us/article/connect-to-an-access-database-a3d6500c-4bec-40ce-8cdf-fb4edb723525\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>.   You can then simply reference your Access query using VBA"}, {"owner": {"reputation": 156, "user_id": 3091705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e6d6b84b6f2208d16d8eb1f4312d4e28?s=128&d=identicon&r=PG&f=1", "display_name": "user3091705", "link": "https://stackoverflow.com/users/3091705/user3091705"}, "edited": false, "score": 0, "creation_date": 1549454371, "post_id": 54552537, "comment_id": 95906012, "body": "Agree that creating queries in Access and then connecting through Excel by creating a data source/connection there is the way to go. I would definitely avoid creating queries in VBA. The only reason I can think of for that is if you&#39;re trying to develop some interactive Excel application that requires generating queries on the fly. But also, this is too general a question for this forum. The idea here is that you have a specific problem for which you haven&#39;t been able to find a solution. Also, you&#39;re asking for &quot;recommendations&quot; which generates opinions--something we try to avoid."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1549459384, "post_id": 54552537, "comment_id": 95909044, "body": "You don&#39;t actually need a query to update <b>Access</b> database from excel. You could just open your table and filter it.. <a href=\"https://stackoverflow.com/questions/15709156/vba-code-to-update-create-new-record-from-excel-to-access\">have a look at Gord&#39;s answer</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1549464345, "post_id": 54555986, "comment_id": 95912150, "body": "When I try to run this I get a Compile Error: User-defined type not defined for DIM db As DAO.Database.  Is there some setting I need to turn on or something that needs downloaded for the DAO to work?"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "reply_to_user": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1549465085, "post_id": 54555986, "comment_id": 95912623, "body": "@BonnieZ - Yes, you need to make sure that your project has a reference to the Microsoft Data Access Objects.  In the VBA editor, under the tools menu, select &quot;References&quot; then make sure you have a check next to the item listed as &quot;Microsoft Access xx.x Object Library&quot;  Mine is listed as &quot;Microsoft Access 15.0 Object Library&quot;  I also have &quot;Microsoft Office 16.0 Access database engine Object Library&quot; checked"}, {"owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1549523347, "post_id": 54555986, "comment_id": 95934040, "body": "Great! Got to bulk of the code to run, but am now getting an error regarding my SQL query when it tries to run the code, .Open stSQL1, cnt.  I&#39;m thinking it has something to do with the variable I&#39;m trying to use for my SQL query.  Here&#39;s the query.  stSQL1 = &quot;SELECT * FROM Contacts WHERE ((Contact_Num) = &#39;&quot; &amp; ContactNum &amp; &quot;&#39;);&quot;  ContactNum has been previously assigned a value from a MsgBox input request.  Any idea what is wrong that&#39;s causing an error?"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "reply_to_user": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1549544002, "post_id": 54555986, "comment_id": 95945325, "body": "@BonnieZ - To pass a string variable to into your select statement you need to enclose it in quotes. To to this through VBA, you will need to use single quotes so that the compiler knows the difference. Try stSQL1 = &quot;SELECT * FROM Contacts WHERE ((Contact_Num)=&#39;&quot; &amp; ContactNum &amp; &quot;&#39;);&quot; note the single quotes inside my double quotes"}], "tags": [], "owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1549463569, "creation_date": 1549463569, "answer_id": 54555986, "question_id": 54552537, "link": "https://stackoverflow.com/questions/54552537/sql-query-in-excel-vba-to-pull-info-from-access/54555986#54555986", "title": "SQL Query in Excel VBA to pull info from Access", "body": "<p>I use DAO rather than ADO for my connections to Access databases.  Below is an example of a typical Sub that I use.  </p>\n\n<pre><code>Sub AccessSQL(ByVal Var1 As String, ByVal Var2 As String)\n    Dim DBPath As String\n    Dim i As long\n    Dim j As long\n    Dim db As DAO.Database\n    Dim rs As DAO.Recordset\n    Dim sSQL As String\n    Dim xlCell As Range\n        Set xlCell = Range(\"A1\")\n        DBPath = \"C:\\AccessDBS\\DataDB.accdb\"\n        sSQL = \"SELECT TableA.Field01, TableA.Field02, TableA.Field03 FROM TableA WHERE (((TableA.Field01) = '\" &amp; Var1 &amp; \"') And ((TableA.Field02) = '\" &amp; Var2 &amp; \"') And ((TableA.Field03) = 0) And (Not (TableA.Field04) = 0)) Or (((TableA.Field04) = 99999)) ORDER BY TableA.Field01;\"\n        Set db = OpenDatabase(DBPath)\n        Set rs = db.OpenRecordset(sSQL, dbOpenSnapshot)\n        If Not rs.EOF Then\n            rs.MoveLast\n            rs.MoveFirst\n            i = rs.RecordCount\n            If i &gt; 0 Then\n                rs.MoveFirst\n                For j = 1 To i\n                    With xlCell\n                        .Value = rs!Field01 &amp; \" - \" &amp; rs!Field02 \n                        .Offset(0,1).Value = rs!Field03\n                    End With\n                    rs.MoveNext\n                    Set xlCell = xlCell.Offset(1,0)\n                Next j\n            Else\n                xlCell.Value = \"No Records Returned\"\n            End If\n        Else\n            xlCell.Value = \"No Records Returned\"\n        End If\n        rs.Close\n        db.Close\n        Set rs = Nothing\n        Set db = Nothing\n        Set xlCell = Nothing \nEnd Sub\n</code></pre>\n\n<p>The above sub is being fed 2 string variables which are incorporated into my SQL SELECT statement.  It then cycles through the records returned and places them into the excel sheet.  Of course depending on what you need to do with the data that is returned, you can expand this to perform calculations or to populate combo boxes on forms or whatever.  </p>\n"}], "owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 0, "accepted_answer_id": 54555986, "answer_count": 1, "score": 0, "last_activity_date": 1549489359, "creation_date": 1549452307, "last_edit_date": 1549489359, "question_id": 54552537, "link": "https://stackoverflow.com/questions/54552537/sql-query-in-excel-vba-to-pull-info-from-access", "title": "SQL Query in Excel VBA to pull info from Access", "body": "<p>Revised question:  I'm not used to writing SQL queries in VBA so I've been using the macro recording for connecting to Access.  I've included the code that the macro recorder returns.  I'm getting an error message </p>\n\n<blockquote>\n  <p>Unexpected Error. Something went wrong. If the problem continues,\n  please restart Excel.</p>\n</blockquote>\n\n<p>If I click close on the error message then the spreadsheet with the database info from Access shows up in Excel, which is great, but I'd rather not have the error message pop up.</p>\n\n<p>Here's my code so far:</p>\n\n<pre><code>Sub Contact_Search()  \n\nDim ContactNum As String  \nRestart:  \nContactNum = InputBox(\"Enter the number to query.\", \"Contact Query\", \"Enter the number here...\")  \nIf ContactNum = \"Enter the number here...\" Then  \n  MsgBox \"Invalid response, please enter the number to query.\"  \n  GoTo Restart  \nElseIf ContactNum = \"\" Then  \n  MsgBox \"Number is mandatory.  Please enter number.\"  \n  GoTo Restart  \nEnd If  \n\nActiveWorkbook.Worksheets.Add After:=Sheets(1)  \nWith ActiveSheet.ListObjects.Add(SourceType:=0, Source:=Array( _  \n  \"OLEDB;Provider=Microsoft.ACE.OLEDB.12.0;Password=\"\"\"\";User ID=Admin;Data Source=C:\\Users\\path info\\folder name\\Contacts \" _  \n  , _\n  \"Database.accbd;Mode=Share Deny Write;Extended Properties=\"\"\"\";Jet OLEDB:System database=\"\"\"\";Jet OLEDB:Registry Path=\"\"\"\";Jet OLEDB:Da\" _  \n  , _\n  \"tabase Password=\"\"\"\";Jet OLEDB:Engine Type=6;Jet OLEDB:Database Locking Mod=0;Jet OLEDB:Global Partial Bulk Ops=2;Jet OLEDB:Globa\" _  \n  , _  \n  \"l Bulk Transactions=1;JetOLEDB:New Database Password=\"\"\"\";Jet OLEDB:Create System Database=False;Jet OLEDB:Encrypt Database=False\" _  \n  , _  \n  \";Jet OLEDB:Don't Copy Local on Compact=False;Jet OLEDB:Compact Without Replica Repair=False;Jet OLEDB:SFP=False;Jet OLEDB:Suppo\" _  \n  , _  \n  \"rt Complex Data+False;Jet OLEDB:Bypass User Info Validaton=False;Jet OLEDB:Limited DB Caching=False;Jet OLEDB;Bypass ChoiceField\" _  \n  ,  \" Validation=False\"), Destination:=Range(\"$A$1\")).QueryTable  \n.CommandType = xlCmdTable\n.CommandText = Array(\"Contacts\")\n.PreserveFormatting = True\n.BackgroundQuery = True\n.RefreshStyle = xlInsertDeleteCells  \n.SaveData = True  \n.AdjustColumnWidth = True\n.RefreshPeriod = 0  \n.PreserveColumnInfo = True  \n.SourceDataFile = \"C:\\Users\\path info\\folder name\\Contacts\\Database.accdb\"  \n.ListObject.DisplayName = \"Table_Database.accdb\"  \n.Refresh BackgroundQuery:=False  \nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I'm sure that much of what's in this code is not really needed, it's just stuff that the macro recorder puts in there but I'm not sure what is ok to take out and what has to be in there for it to work and I'm not sure if something in the code is causing the error message that I'm getting.  As I said, the info is still coming over, but I have to close out of the error message before it shows up in the excel doc.  </p>\n\n<p>Also, what I'm actually wanting to return is not the entire table, but only the rows that match the variable ContactNum that is input by the user. I'm not sure where in this code I would put the SQL language to only return the specific values rather than the entire table. Any ideas on the error message as well as the SQL verbiage?</p>\n"}, {"tags": ["json", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549451247, "post_id": 54551944, "comment_id": 95904176, "body": "Can you include the rest of the json? And what is a normal object? It looks like you have a string literal where you want a collection added as a value in the dictionary. That is not surprising if you are adding via Cstr(ws.Cells(i,j)). I don&#39;t know whether that means you need to declare a collection object and add the Cstr(ws.Cells(i,j)) to that collection then add the collection to the dictionary or whether this is a case of adding the [] before parsing the json string."}, {"owner": {"reputation": 13, "user_id": 11022385, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ThtTKgjGNMU/AAAAAAAAAAI/AAAAAAAADHc/Kjq74d_3i4w/photo.jpg?sz=128", "display_name": "Priyanka Das", "link": "https://stackoverflow.com/users/11022385/priyanka-das"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549451815, "post_id": 54551944, "comment_id": 95904482, "body": "I just wish to update the value in Prefix as              &quot;prefix&quot; : [ &quot;MS&quot; ]  and not as              &quot;prefix&quot; :  &quot;MS&quot; . I added Cstr to get &quot;&quot; around MS or else its coming without quotes in output"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549451983, "post_id": 54551944, "comment_id": 95904585, "body": "Is it as simple as resource (&quot;resource&quot;)(&quot;name&quot;)(1)(&quot;prefix&quot;).Add  Cstr(ws.Cells(i,j))   ?"}, {"owner": {"reputation": 13, "user_id": 11022385, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ThtTKgjGNMU/AAAAAAAAAAI/AAAAAAAADHc/Kjq74d_3i4w/photo.jpg?sz=128", "display_name": "Priyanka Das", "link": "https://stackoverflow.com/users/11022385/priyanka-das"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549452389, "post_id": 54551944, "comment_id": 95904828, "body": "Ok so my excel has value &quot;Sr&quot; and template has &quot;MS&quot; The above code its adding a new value to the Prefix as below  Prefix : [ &quot;MS&quot;, &quot;Sr&quot;] I just want output as Prefix : [&quot;Sr&quot;]"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1549452634, "creation_date": 1549452634, "answer_id": 54552638, "question_id": 54551944, "link": "https://stackoverflow.com/questions/54551944/modify-a-json-value-using-vba/54552638#54552638", "title": "Modify a JSON value using VBA", "body": "<p>It seems like you need to modify an item in a collection. To do this you need to remove that item and replace it with updated value. </p>\n\n<pre><code>Option Explicit\nPublic Sub demo()\n    Dim col As Collection\n    Set col = New Collection\n    col.Add \"Orange\"\n    Debug.Print col.Item(1)\n    col.Remove 1\n    col.Add \"Banana\"\n    Debug.Print col.Item(1)\nEnd Sub\n</code></pre>\n\n<p>Something like:</p>\n\n<pre><code>resource (\"resource\")(\"name\")(1)(\"prefix\").Remove 1\nresource (\"resource\")(\"name\")(1)(\"prefix\").Add Cstr(ws.Cells(i,j))\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11022385, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ThtTKgjGNMU/AAAAAAAAAAI/AAAAAAAADHc/Kjq74d_3i4w/photo.jpg?sz=128", "display_name": "Priyanka Das", "link": "https://stackoverflow.com/users/11022385/priyanka-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 54552638, "answer_count": 1, "score": 1, "last_activity_date": 1549455034, "creation_date": 1549450542, "last_edit_date": 1549455034, "question_id": 54551944, "link": "https://stackoverflow.com/questions/54551944/modify-a-json-value-using-vba", "title": "Modify a JSON value using VBA", "body": "<p>I have below JSON structure to modify. I have expected values stored in excel as rows and columns and the template saved in a File</p>\n\n<p>The part of template looks like:</p>\n\n<pre><code>\"name\" : [\n          {\n           \"use\" : \"official\",\n            \"text\" : \"MS JOHN DOE II\",\n            \"family\" : \"DOE\",\n            \"given\" : [\n              \"JOHN\"\n            ],\n            \"prefix\" : [\n              \"MS\"\n            ],\n            \"suffix\" : [\n              \"II\"\n            ],\n            \"period\" : {\n              \"end\" : \"2019-01-22T14:33:53Z\"\n            }\n          }\n        ]\n</code></pre>\n\n<p>Prefix in above template is an array with []\nI am writing below code to update the Prefix in above template as below</p>\n\n<pre><code>resource (\"resource\")(\"name\")(1)(\"prefix\") = Cstr(ws.Cells(i,j))\n</code></pre>\n\n<p>But the output JSON has prefix as normal object and not as Array</p>\n\n<pre><code>Output :  \"prefix\" : \"ms\"\n</code></pre>\n\n<p>How to write the correct syntax? Please help and guide!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1549449909, "post_id": 54551651, "comment_id": 95903320, "body": "What is the minimum and maximum scale that you are entering when the error happens? Remember you have declared them as Integer..."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1549449916, "post_id": 54551651, "comment_id": 95903325, "body": "<code>Integer</code> =&gt; <code>Long</code>. No reason to use <code>Integer</code> (which overflow around 32,000) in modern Excel running on 32 or 64 bit machines"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1549449969, "post_id": 54551651, "comment_id": 95903354, "body": "Apparently the user provides values that are outside of the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/integer-data-type\" rel=\"nofollow noreferrer\"><code>Integer</code> range</a>."}, {"owner": {"reputation": 43, "user_id": 9547854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad60988165dcf1005c75567141bbb3d?s=128&d=identicon&r=PG&f=1", "display_name": "Denisuu", "link": "https://stackoverflow.com/users/9547854/denisuu"}, "edited": false, "score": 0, "creation_date": 1549450972, "post_id": 54551651, "comment_id": 95904019, "body": "Changing from Integer to Long solved it thanks! Can I flag it as the answer?"}], "owner": {"reputation": 43, "user_id": 9547854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad60988165dcf1005c75567141bbb3d?s=128&d=identicon&r=PG&f=1", "display_name": "Denisuu", "link": "https://stackoverflow.com/users/9547854/denisuu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "closed_date": 1549451809, "answer_count": 0, "score": 0, "last_activity_date": 1549453703, "creation_date": 1549449715, "last_edit_date": 1549453703, "question_id": 54551651, "link": "https://stackoverflow.com/questions/54551651/graph-to-new-sheet-or-as-object-on-current-page-code-works-but-gives-a-overflow", "closed_reason": "Duplicate", "title": "Graph to new sheet or as object on current page. Code works but gives a Overflow (Error 6)", "body": "<p>I'm not sure what the problem is. The code works, it does what it's supposed to do but gives an error.</p>\n\n<p>I'm pretty new to this and I don't understand how to solve this. There doesn't seem to be as much information on VBA for excel as other programming languages.</p>\n\n<pre><code>Sub userInputGraph()\n\nDim inputRange As Range\nDim graphTitle As String\nDim minScale As Integer\nDim maxScale As Integer\n\n'Select table to convert to graph\nSet inputRange = Application.InputBox(\"Select a range \", , , , , , , 8)\nActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\nActiveChart.SetSourceData Source:=inputRange\n\n'User input (Yes on new sheet, no as object on active page)\nvarLocatienr = MsgBox(\"Do you want a new sheet?\", vbYesNo + vbQuestion, \"Worksheet or object\")\n\nIf varLocatienr = vbYes Then\n    ActiveChart.Location xlLocationAsNewSheet, \"Graph_Sheet\"\n\nElse:\n    ActiveChart.Location xlLocationAsObject, \"Sheet1\" \n    'This should become active sheet  \nEnd If\n\n'Properties and title\ngraphTitle = Application.InputBox(\"Give the graph a title: \")\n\n With ActiveChart\n    .HasTitle = True\n    .ChartTitle.Characters.Text = graphTitle\n    .Axes(xlCategory).HasTitle = True\n    .Axes(xlValue).HasTitle = True\nEnd With\n\nActiveChart.Axes(xlCategory).Select\n\nWith Selection.TickLabels.Font\n    .Color = vbRed\nEnd With\n\nActiveChart.Axes(xlCategory).Select\n\n'Input scales\nWith ActiveChart.Axes(xlValue)\n    minScale = InputBox(\"What is the minimum scale of selected the table?: \")\n    maxScale = InputBox(\"What is the maximum scale of the selected table?: \")\n    .MinimumScale = minScale\n    .MaximumScale = maxScale\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This is what the code should does, I only need to get rid of the error.</p>\n\n<pre><code>'User specify the range of the graph at the time of execution.\n'User can choose new worksheet or object on current page.\n'User inputs scale of the graph.\n'User gives a title to the graph\n'Adjust the color of the data bars\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 11021965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ilkNN.jpg?s=128&g=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/11021965/graham"}, "edited": false, "score": 2, "creation_date": 1549449297, "post_id": 54551465, "comment_id": 95902990, "body": "this looks a mess I doubt if anyone can make head or tail of this, I think I may have to redo it..........sigh"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1549449326, "post_id": 54551465, "comment_id": 95903013, "body": "Indent your code with 4 spaces or place ALL code between the ` tags.. this is a mess"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1549450222, "post_id": 54551465, "comment_id": 95903511, "body": "@Graham Can you review quickly but think it&#39;s sorted"}, {"owner": {"reputation": 13, "user_id": 11021965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ilkNN.jpg?s=128&g=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/11021965/graham"}, "edited": false, "score": 0, "creation_date": 1549450786, "post_id": 54551465, "comment_id": 95903889, "body": "yes that looks right now thank you Tom"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11021965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ilkNN.jpg?s=128&g=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/11021965/graham"}, "edited": false, "score": 0, "creation_date": 1549453428, "post_id": 54552043, "comment_id": 95905460, "body": "Tom thank you so much that works a treat, I am happy to take a quick and dirty fix as this line of code is in several other modules, and it would be a lot of work to rewrite all the modules to make the code more &quot;elegant&quot;."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 13, "user_id": 11021965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ilkNN.jpg?s=128&g=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/11021965/graham"}, "edited": false, "score": 0, "creation_date": 1549453512, "post_id": 54552043, "comment_id": 95905508, "body": "np - Often a quick and dirty fix is the most logical way to go. But in future consider writing your new code so that you don&#39;t fall into these traps again :). If this has solved your answer don&#39;t forget to click on the tick to the left of the answer/click on the upvote"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1549450892, "creation_date": 1549450892, "answer_id": 54552043, "question_id": 54551465, "link": "https://stackoverflow.com/questions/54551465/vba-recording-column-names-past-column-z/54552043#54552043", "title": "VBA recording column names past column Z", "body": "<p>A quick and dirty fix would be to replace this line</p>\n\n<pre><code>RangeString = Chr(65 + Columncounter) &amp; \"29\"\n</code></pre>\n\n<p>with something like</p>\n\n<pre><code>RangeString = Cells(29, ColumnCounter+1).address(RowAbsolute:=False, ColumnAbsolute:=False)\n</code></pre>\n\n<p>This should generate the <code>RangeString</code> variable without being dependent on <code>Chr(</code>. In this I've added one to your <code>ColumnCounter</code> as the loop starts at 0 which is less than the minimum of 1 for a Column.</p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1549450900, "creation_date": 1549450900, "answer_id": 54552044, "question_id": 54551465, "link": "https://stackoverflow.com/questions/54551465/vba-recording-column-names-past-column-z/54552044#54552044", "title": "VBA recording column names past column Z", "body": "<p>The problem is in:</p>\n\n<p><code>RangeString = Chr(65 + Columncounter) &amp; \"29\" 'set the range based on the columncounter</code></p>\n\n<p>This part of the code would work indeed up to <code>Z</code>. Which is not a good option. Use the <code>Offset</code> property, to get the correct address. E.g., the code below gives the address of the 5000th column of the first row:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim myRange As Range\n    Dim addCols As Long: addCols = 5000\n\n    Set myRange = Worksheets(1).Range(\"A1\")\n    Debug.Print myRange.Offset(0, addCols).Address\n\nEnd Sub\n</code></pre>\n\n<p>Or even get the new range as a range, without assigning its address to a variable:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim myRange As Range, newRange as Range\n    Dim addCols As Long: addCols = 5000\n\n    Set myRange = Worksheets(1).Range(\"A1\")\n    Set newRange = myRange.Offset(0, addCols)\n    Debug.Print newRange.Address\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11021965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ilkNN.jpg?s=128&g=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/11021965/graham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 54552043, "answer_count": 2, "score": -1, "last_activity_date": 1549450900, "creation_date": 1549449172, "last_edit_date": 1549450556, "question_id": 54551465, "link": "https://stackoverflow.com/questions/54551465/vba-recording-column-names-past-column-z", "title": "VBA recording column names past column Z", "body": "<p>I have some code that has been working fine for ages trouble is now my data has gone past column z and the code no longer works, once it gets past column z the rangestring value is[29 rather than AA29 ,AB29 etc. can anyone give me guidance on how I can make this work it needs to go to at least column AW. other people have told me I have made a fundamental error because I should have used column numbers and not names. I am no expert and have managed to get this working by cannibalising code I have found on here and other places. My code is below hopefully it is understandable.</p>\n\n<pre><code>Sub Copy_picked_X1s_to_final_56()\n    Dim SelectedName() As String              'this array holds the \"SelectedName\" for a specific date\n    Dim AllNames() As Variant                  'this array holds all the names in the \"Final Assignments\"\n    Dim NameCount1 As Long, NameCount2 As Long 'namecount 1 holds a count of the \"SelectedName\", namecount 2 holds a count of \"AllNames\" in the \"Final Assignments\"\n    Dim Services() As Variant                  'this array holds a list of all the \"Services\"\n    Dim Columncounter As Long                  'this array holds a count of all the columns that have \"Services\"\n    Dim NameCell As String                     'this string holds the location of the cell in \"Final Assignments\" where the \"SelectedName\" appears\n    Dim location As String\n    Dim Name1 As String\n    Dim Name2 As String\n    Dim NameFound As Long\n    Dim FillArray As Long                      'used to loop through the various arrays\n    Dim RangeString As String\n    Dim ServiceCount As Long\n\n    '***********************************************************************************************'\n    ' Fill the services array with the full list of services and loop through the services\n    '***********************************************************************************************'\n\n    Sheets(\"Final Assignments\").Select 'select \"Final Assignments\" worksheet\n    ServiceCount = Range(\"B3\", Range(\"B3\").End(xlToRight)).Cells.Count - 1 'set range of \"Services\" to count\n\n    ReDim Services(0 To ServiceCount) 'Redimension the \"Services\" array\n\n    For Columncounter = 0 To ServiceCount\n        'Services(Columncounter) = Range(\"B3\").Offset(0, Columncounter).Value 'collect the values\n    Next Columncounter\n\n    '***********************************************************************************************'\n    ' Loop through all the services\n    '***********************************************************************************************'\n\n    For Columncounter = 0 To ServiceCount\n\n        Sheets(\"Sorted X1\").Select 'select \"Sorted X1\" worksheet\n        RangeString = Chr(65 + Columncounter) &amp; \"29\" 'set the range based on the columncounter\n\n        NameCount1 = Range(RangeString, Range(RangeString).End(xlDown)).Cells.Count - 1 'count the number of names for the first date\n\n        ReDim SelectedName(0 To NameCount1) 'Redimension the \"SelectedName\" array\n        If SelectedName(0) = \"\" And SelectedName(1) = \"\" And NameCount1 = 1 Then\n            For FillArray = 0 To NameCount1 'gather the names\n\n                SelectedName(FillArray) = Range(RangeString).Offset(FillArray).Value\n            Next FillArray\n        End If\n\n        '***********************************************************************************************'\n        'Now select the first name in the final assignments list\n        '***********************************************************************************************'\n\n        Sheets(\"Final Assignments\").Select 'select \"Final Assignments\" worksheet\n        NameCount2 = Range(\"A4\", Range(\"A4\").End(xlDown)).Count - 1 'count the number of \"AllNames\" in the \"Final Assignments\"\n        Range(\"A3\").Select\n        If NameCount1 &lt; 4 Then\n            For NameFound = 0 To NameCount2\n                ActiveCell.Offset(1, 0).Select\n\n                For FillArray = 0 To NameCount1\n\n                    If SelectedName(FillArray) = ActiveCell.Value Then\n                        ActiveCell.Offset(0, Columncounter + 1).Value = \"X1\"   'Services(Columncounter)\n                    End If\n\n                Next FillArray\n\n            Next NameFound\n        End If\n    Next Columncounter 'increment along the row\n\nEnd Sub\n</code></pre>\n"}, {"tags": [".net", "excel", "vba", "https", "com-interop"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1549448222, "post_id": 54550589, "comment_id": 95902289, "body": "Have you compared the requests with Fiddler or online sandbox like <a href=\"https://webhook.site\" rel=\"nofollow noreferrer\">webhook.site</a>?"}, {"owner": {"reputation": 7246, "user_id": 2110762, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hZu8Y.jpg?s=128&g=1", "display_name": "Stochastically", "link": "https://stackoverflow.com/users/2110762/stochastically"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1549448862, "post_id": 54550589, "comment_id": 95902690, "body": "Thanks @omegastripes , no, I am not an expert in this so I was unaware of both.  I will try :-)"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1549706298, "post_id": 54550589, "comment_id": 96005652, "body": "I&#39;d focus on the Console vs Excel scenario on the same machine. I guess code using Excel and code using Console doesn&#39;t use the same .NET Framework layer underneath, so inner settings are probably different. There&#39;s been a great disturbance in the SSL force over the past months. <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/network-programming/tls\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/framework/network-programmin&zwnj;&#8203;g/&hellip;</a> can you try to define ServicePointManager.SecurityProtol = 0 ?"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1549717225, "post_id": 54550589, "comment_id": 96008071, "body": "<a href=\"https://docs.microsoft.com/cs-cz/dotnet/api/system.net.httpwebrequest.clientcertificates?view=netframework-4.7.2\" rel=\"nofollow noreferrer\">Here</a>: An application can add a certificate to a collection, but might not have access rights to it. To use a certificate contained in the collection, the application must have the same access rights as the entity that issued the certificate."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1549717851, "post_id": 54550589, "comment_id": 96008228, "body": "Excel needs the access rights to the certificate on the computer B as well. Check the access rights of Excel on computer A and set them on B accordingly.  <a href=\"https://docs.microsoft.com/cs-cz/dotnet/framework/wcf/feature-details/how-to-view-certificates-with-the-mmc-snap-in\" rel=\"nofollow noreferrer\">How to view certificates</a>."}, {"owner": {"reputation": 7246, "user_id": 2110762, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hZu8Y.jpg?s=128&g=1", "display_name": "Stochastically", "link": "https://stackoverflow.com/users/2110762/stochastically"}, "reply_to_user": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1549800291, "post_id": 54550589, "comment_id": 96025352, "body": "@SimonMourier thanks for the suggestions.  I am using an Excel.exe.config file to specify the .Net framework to use (now 4.7.2), and I&#39;ve also tried using ServicePointManager.SecurityProtol=0 .  But it still doesn&#39;t work, and Fiddler still shows me the same subtle differences in the TLS extensions and one difference in the Ciphers."}, {"owner": {"reputation": 7246, "user_id": 2110762, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hZu8Y.jpg?s=128&g=1", "display_name": "Stochastically", "link": "https://stackoverflow.com/users/2110762/stochastically"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1549800407, "post_id": 54550589, "comment_id": 96025382, "body": "@dee thanks for the suggestions, however the certificate that I&#39;m using isn&#39;t stored in the certificate manager, it&#39;s just a file on my C: hard drive.  And using Visual Studio debug mode I can see that the certificate is loaded properly in all cases."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1549828143, "post_id": 54550589, "comment_id": 96033511, "body": "How do you configure your .config, do you use the &#39;sku&#39; attribute (<a href=\"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/startup/supportedruntime-element\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/framework/configure-apps/&hellip;</a>)&zwnj;&#8203;? Are you sure this .config is used (for excel)? Have you checked both console &amp; excel processes (using a tool such as Process Explorer from sysinternals) to see if they have the same .dll loaded (well the ones related to .NETmostly)? Also, do the console and Excel run as the same bitness (x86 vs x64)."}, {"owner": {"reputation": 7246, "user_id": 2110762, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hZu8Y.jpg?s=128&g=1", "display_name": "Stochastically", "link": "https://stackoverflow.com/users/2110762/stochastically"}, "reply_to_user": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1549833022, "post_id": 54550589, "comment_id": 96034836, "body": "@SimonMourier Yes, I&#39;m using the &#39;sku&#39; attribute.  I&#39;ve checked that  the .config is being used by Excel by setting a non-default value for one of the ServicePointManager settings, and checking in Visual Studio debug mode that the setting is there.  I reported in today&#39;s update that there is just one DLL that&#39;s used by my console process that&#39;s not used at all by Excel, however regarding all other DLLs used by the console process Excel uses the identical versions (and of course there are various DLLS that Excel uses that are not used by the console process).  All processes are x64."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 1, "creation_date": 1549873202, "post_id": 54550589, "comment_id": 96044990, "body": "Is there&#39;s only 1 certificate? <a href=\"https://stackoverflow.com/questions/39528973/force-httpwebrequest-to-send-client-certificate\" title=\"force httpwebrequest to send client certificate\">stackoverflow.com/questions/39528973/&hellip;</a> otherwise you can try to add some traces <a href=\"https://stackoverflow.com/questions/3808016/how-do-i-see-the-raw-http-request-that-the-httpwebrequest-class-sends\" title=\"how do i see the raw http request that the httpwebrequest class sends\">stackoverflow.com/questions/3808016/&hellip;</a> .ncryptprov is Microsoft Key Storage Provider (KSP, an essential library for CNG, modern Windows crypto) thing is it looks like both codes take different crypto routes for some reason..."}, {"owner": {"reputation": 7246, "user_id": 2110762, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hZu8Y.jpg?s=128&g=1", "display_name": "Stochastically", "link": "https://stackoverflow.com/users/2110762/stochastically"}, "reply_to_user": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1549997984, "post_id": 54550589, "comment_id": 96105191, "body": "@SimonMourier thanks for that, it seems very helpful because using the diagnostics I&#39;ve been able to work out where the two executions diverge.  But the difference in the two diagnostic outputs seems quite obscure.  I&#39;ve edited the question, see &quot;Update 12-Feb-2019&quot;.  If you have any ideas on what that means, or who might know, then it would be very much appreciated."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1550046362, "post_id": 54550589, "comment_id": 96121450, "body": "If both startups look the same, it&#39;s good news (sort of...), but, the traces should exhibit some error in the end? Or where does that &quot;loginStatus&quot;=&quot;CERT_AUTH_REQUIRED&quot; comes from? is it a custom message sent by your server?"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 1, "creation_date": 1550046793, "post_id": 54550589, "comment_id": 96121642, "body": "Your MSDN traces show you don&#39;t end up with the same certificate issuer. I bet your server doesn&#39;t like the excel one. Or stop your anti virus and see if it wouldn&#39;t fix your issue"}, {"owner": {"reputation": 7246, "user_id": 2110762, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hZu8Y.jpg?s=128&g=1", "display_name": "Stochastically", "link": "https://stackoverflow.com/users/2110762/stochastically"}, "reply_to_user": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1550072926, "post_id": 54550589, "comment_id": 96137943, "body": "@SimonMourier thank you very much.  I disabled Kaspersky and the problem disappeared.  Completely bizarre, because the identical version of Kaspersky and identical version of Excel with my identical C# program didn&#39;t cause the problem on computer A (with Windows 10 1803).  I don&#39;t know if someone with a stackoverflow reputation as high as yours needs the 200 bonus here, but if you want it I think you have to post the answer for me to award it to you :-) .  Thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "is_accepted": true, "score": 2, "last_activity_date": 1550074022, "creation_date": 1550074022, "answer_id": 54674565, "question_id": 54550589, "link": "https://stackoverflow.com/questions/54550589/unable-to-use-a-certificate-to-login-to-a-website-via-com-interop-in-windows-10/54674565#54674565", "title": "Unable to use a certificate to login to a website via com-interop in Windows 10 1809", "body": "<p>Focusing on the C# console vs Excel 2010 issue (same machine, both running as 64-bit processes), traces have been added as explained here: <a href=\"https://stackoverflow.com/a/25683524/403671\">https://stackoverflow.com/a/25683524/403671</a></p>\n\n<p>The initial traces from Excel and Console are exactly the same (see the question for more detail). But the last traces (posted to MSDN) exhibit this:</p>\n\n<p>Console:</p>\n\n<pre><code>System.Net Information: 0 : [35268] Remote certificate: [Version] V3\n[ Lots of lines describing a certificate with [Subject]=&lt;TargetWebSite&gt;, [Issuer]=HydrantID SSL ICA G2, etc]\nSystem.Net Information: 0 : [35268] SecureChannel#47891719 - Remote certificate was verified as valid by the user.    \n</code></pre>\n\n<p>Excel:</p>\n\n<pre><code>System.Net Information: 0 : [39988] Remote certificate: [Version] V3\n[ Lots of lines describing a certificate with [Subject]=&lt;TargetWebSite&gt;, [Issuer]=Kaspersky, etc]\nSystem.Net Information: 0 : [39988] SecureChannel#2383799 - Remote certificate was verified as valid by the user.\n</code></pre>\n\n<p>It shows the certificate used in Excel is now issued by Kaspersky, which turns out to be the anti-virus product running on the PC. In fact, it's a Kaspersky product security feature to <a href=\"https://security.stackexchange.com/questions/104495/which-ca-issued-certificate-for-https-www-google-com\">intercept communications</a>, and this causes numerous issues, like <a href=\"https://forum.kaspersky.com/index.php?/topic/395220-kis-interfering-with-git/\" rel=\"nofollow noreferrer\">KIS Interfering with Git</a>, for example.</p>\n\n<p>Once this anti-virus is removed everything works as expected.</p>\n"}], "owner": {"reputation": 7246, "user_id": 2110762, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hZu8Y.jpg?s=128&g=1", "display_name": "Stochastically", "link": "https://stackoverflow.com/users/2110762/stochastically"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 1, "accepted_answer_id": 54674565, "answer_count": 1, "score": 5, "last_activity_date": 1550074022, "creation_date": 1549446432, "last_edit_date": 1550046318, "question_id": 54550589, "link": "https://stackoverflow.com/questions/54550589/unable-to-use-a-certificate-to-login-to-a-website-via-com-interop-in-windows-10", "title": "Unable to use a certificate to login to a website via com-interop in Windows 10 1809", "body": "<p>The C# code below, which logs in to a website,</p>\n\n<ul>\n<li>Works when called on computer A from Excel 2010 VBA via com-interop</li>\n<li>Works when called on computer B from a C# console application, but</li>\n<li>Fails when called on computer B from Excel 2010 VBA via com-interop</li>\n</ul>\n\n<p>The main difference between computer A and computer B is that computer A has windows 10 version 1803, whereas computer B has windows 10 version 1809.  Both computers have Studio 2017, and in all cases the target .Net Framework is 4.6.2. </p>\n\n<pre><code>using System;\nusing System.Runtime.InteropServices;\nusing System.IO;\n\n[Guid(\"97E1D9DB-8478-4E56-9D6D-26D8EF13B100\")]\n[ComVisible(true)]\npublic interface IToExcel {\n    string Do();\n}\n\n[Guid(\"BBF87E31-77E2-46B6-8093-1689A144BFC6\")]\n[ClassInterface(ClassInterfaceType.None)]\n[ComVisible(true)]\npublic class Main : IToExcel {\n    private const string XAPP_ID = \"...\";\n    private const string USERNAME = \"...\";\n    private const string PASSWORD = \"...\";\n    private const string CERT_FILE = @\"...\";\n    private const string CERT_PASSWORD = \"...\";\n    private const string WEBSITE = \"https:// ...\";\n\n    public string Do() {\n        System.Net.HttpWebRequest request = (System.Net.HttpWebRequest)System.Net.WebRequest.Create(new Uri(WEBSITE));\n        request.AutomaticDecompression = System.Net.DecompressionMethods.GZip | System.Net.DecompressionMethods.Deflate;\n        request.Method = \"POST\";\n        request.Accept = \"application/json\";\n        request.Timeout = request.ReadWriteTimeout = 20000;\n        request.ContentType = \"application/x-www-form-urlencoded\";\n        request.UseDefaultCredentials = true;\n        request.Proxy = null;\n        // setup headers\n        System.Net.WebHeaderCollection whc = new System.Net.WebHeaderCollection {\n            { \"X-Application\", XAPP_ID },\n            { System.Net.HttpRequestHeader.AcceptCharset, \"utf-8\" },\n            { System.Net.HttpRequestHeader.AcceptEncoding, \"gzip,deflate\" }\n        };\n        request.Headers.Add(whc);\n        // setup certificate\n        System.Security.Cryptography.X509Certificates.X509Certificate2 m_x509certificate = new System.Security.Cryptography.X509Certificates.X509Certificate2(CERT_FILE, CERT_PASSWORD);\n        request.ClientCertificates.Add(m_x509certificate);\n        // do call\n        using (Stream stream = request.GetRequestStream()) {\n            using (StreamWriter writer = new StreamWriter(stream, System.Text.Encoding.Default)) {\n                writer.Write(\"username=\" + USERNAME + \"&amp;password=\" + PASSWORD);\n            }\n        }\n        string responseData = string.Empty;\n        using (System.Net.WebResponse response = request.GetResponse()) {\n            using (Stream responseStream = response.GetResponseStream()) {\n                using (StreamReader reader = new StreamReader(responseStream, System.Text.Encoding.UTF8)) {\n                    responseData = reader.ReadToEnd();\n                }\n            }\n        }\n        return responseData;\n    }\n\n}\n</code></pre>\n\n<p>In all cases a little JSON object is returned, where the JSON object has a field called \"loginStatus\".  When it works, \"loginStatus\"=\"SUCCESS\", but when it fails \"loginStatus\"=\"CERT_AUTH_REQUIRED\".</p>\n\n<p>I tried looking at all the settings in System.Net.ServicePointManager but in all cases the settings were the same:</p>\n\n<ul>\n<li>ReusePort: False</li>\n<li>ServerCertificateValidationCallback: </li>\n<li>DnsRefreshTimeout: 120000</li>\n<li>EnableDnsRoundRobin: False</li>\n<li>Expect100Continue: True</li>\n<li>UseNagleAlgorithm: True</li>\n<li>MaxServicePointIdleTime: 100000</li>\n<li>DefaultConnectionLimit: 2</li>\n<li>MaxServicePoints: 0</li>\n<li>SecurityProtocol: Tls, Tls11, Tls12</li>\n<li>CheckCertificateRevocationList: False</li>\n<li>EncryptionPolicy: RequireEncryption</li>\n</ul>\n\n<p>Beyond that, I don't know what else to check.  Upgrading from .Net 4.6.2 to 4.7.1 had no effect, the results were the same.</p>\n\n<p>I had wondered whether this is a bug in Windows 1809, but since it works when called directly in a .Net console application I assume it's some subtle configuration issue.  Can anyone help me get this working from Excel 2010 on computer B ?</p>\n\n<p><strong>Update 8-Feb-2019</strong></p>\n\n<p>As suggested in the comments, I used Fiddler to review the structure of the https calls that are being made to the website.  The two that work look identical, and the one that fails looks slightly different:</p>\n\n<p>Calls that work OK</p>\n\n<ul>\n<li>TLS extension ec_point_formats = uncompressed [0x0]</li>\n<li>TLS extension encrypt_then_mac (RFC7366) not specified</li>\n<li>TLS extension renegotiation_info = 0</li>\n<li>Cipher TLS_EMPTY_RENEGOTIATION_INFO_SCSV not specified</li>\n</ul>\n\n<p>Failed call</p>\n\n<ul>\n<li>TLS extension ec_point_formats = uncompressed [0x0], ansiX962_compressed_prime [0x1], ansiX962_compressed_char2  [0x2]</li>\n<li>TLS extension encrypt_then_mac (RFC7366) = empty</li>\n<li>TLS extension renegotiation_info not specified</li>\n<li>Cipher TLS_EMPTY_RENEGOTIATION_INFO_SCSV specified</li>\n</ul>\n\n<p>But now I have that information, I'm not sure if it helps.  Perhaps the calls that work are both generated by the same low level code (in spite of the fact that they're on different versions of Windows 10), and the call that fails is generated by different low level code.</p>\n\n<p><strong>Update 10-Feb-2019</strong></p>\n\n<p>When calling from Excel via com-interop, I made the code execute the EXE in a new AppDomain instead of calling the login code directly.  And when I did that, the EXE failed to work and produced the same output as if I'd called the login code directly.</p>\n\n<p>Below is some of the Visual Studio Output window which shows the order in which DLLs are loaded when the EXE file runs, just before the login code executes.  The biggest difference between both the scenarios which succeed and the scenario which fails is that the scenario which fails never loads C:\\Windows\\System32\\ncryptprov.dll.  Does anyone know what causes that DLL to be loaded?</p>\n\n<p>\u2026</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\msisip.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\coml2.dll'   ---   LOADED EARLIER FROM EXCEL</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\wshext.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\AppxSip.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\tdh.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\xmllite.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\OpcServices.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\mintdh.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\urlmon.dll'   ---   LOADED EARLIER FROM EXCEL</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\mintdh.dll'</p>\n\n<p>(Win32): Unloaded 'C:\\Windows\\System32\\mintdh.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\iertutil.dll'   ---   LOADED EARLIER FROM EXCEL</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\pwrshsip.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\EsdSip.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\userenv.dll'   ---   LOADED EARLIER FROM EXCEL</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\dpapi.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\dnsapi.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\rasadhlp.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\FWPUCLNT.DLL'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\secur32.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\sspicli.dll'   ---   LOADED EARLIER FROM EXCEL</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\schannel.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\mskeyprotect.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\ncrypt.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\ntasn1.dll'</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\ncryptprov.dll'   ---   NOT EVER LOADED FROM EXCEL</p>\n\n<p>(Win32): Loaded 'C:\\Windows\\System32\\ncryptsslp.dll'</p>\n\n<p>At this point the C# code executes</p>\n\n<p><strong>Update 12-Feb-2019</strong></p>\n\n<p>Many many thanks to <a href=\"https://stackoverflow.com/users/403671/simon-mourier\">Simon Mourier</a> for telling me how to setup the System.Net diagnostics.  Running the diagnostics on computer B, the \"System.Net information\" rows that get output for the two cases start off the same, but eventually there is a difference.  This is the output from the Console EXE file on Computer B (i.e. the case that works):</p>\n\n<pre><code>System.Net Information: 0 : [35268] Current OS installation type is 'Client'.\nSystem.Net Information: 0 : [35268] RAS supported: True\nSystem.Net Information: 0 : [35268] Associating HttpWebRequest#21454193 with ServicePoint#34640832\nSystem.Net Information: 0 : [35268] Associating Connection#43332040 with HttpWebRequest#21454193\nSystem.Net Information: 0 : [35268] Connection#43332040 - Created connection from XXX.XXX.XXX.XXX:53002 to YYY.YYY.YYY.YYY:443.\nSystem.Net Information: 0 : [35268] TlsStream#54444047::.ctor(host=&lt;TargetWebSite&gt;, #certs=1, checkCertificateRevocationList=False, sslProtocols=Tls12)\nSystem.Net Information: 0 : [35268] Associating HttpWebRequest#21454193 with ConnectStream#20234383\nSystem.Net Information: 0 : [35268] HttpWebRequest#21454193 - Request: POST /api/certlogin HTTP/1.1\nSystem.Net Information: 0 : [35268] ConnectStream#20234383 - Sending headers\nSystem.Net Information: 0 : [35268] SecureChannel#47891719::.ctor(hostname=&lt;TargetWebSite&gt;, #clientCertificates=1, encryptionPolicy=RequireEncryption)\nSystem.Net Information: 0 : [35268] Enumerating security packages:\nSystem.Net Information: 0 : [35268]     Negotiate\nSystem.Net Information: 0 : [35268]     NegoExtender\nSystem.Net Information: 0 : [35268]     Kerberos\nSystem.Net Information: 0 : [35268]     NTLM\nSystem.Net Information: 0 : [35268]     TSSSP\nSystem.Net Information: 0 : [35268]     pku2u\nSystem.Net Information: 0 : [35268]     CloudAP\nSystem.Net Information: 0 : [35268]     WDigest\nSystem.Net Information: 0 : [35268]     Schannel\nSystem.Net Information: 0 : [35268]     Microsoft Unified Security Protocol Provider\nSystem.Net Information: 0 : [35268]     Default TLS SSP\nSystem.Net Information: 0 : [35268]     CREDSSP\nSystem.Net Information: 0 : [35268] SecureChannel#47891719 - Attempting to restart the session using the user-provided certificate: [Version]\nSystem.Net Information: 0 : [35268] SecureChannel#47891719 - Left with 1 client certificates to choose from.\nSystem.Net Information: 0 : [35268] SecureChannel#47891719 - Trying to find a matching certificate in the certificate store.\nSystem.Net Information: 0 : [35268] SecureChannel#47891719 - Locating the private key for the certificate: [Version]\nSystem.Net Information: 0 : [35268] SecureChannel#47891719 - Certificate is of type X509Certificate2 and contains the private key.\nSystem.Net Information: 0 : [35268] SecureChannel#47891719::.AcquireClientCredentials, new SecureCredential() (flags=(ValidateManual, NoDefaultCred, SendAuxRecord, UseStrongCrypto), m_ProtocolFlags=(Tls12Client), m_EncryptionPolicy=RequireEncryption)\nSystem.Net Information: 0 : [35268] AcquireCredentialsHandle(package = Microsoft Unified Security Protocol Provider, intent  = Outbound, scc     = System.Net.SecureCredential)\nSystem.Net Information: 0 : [35268] InitializeSecurityContext(credential = System.Net.SafeFreeCredential_SECURITY, context = (null), targetName = &lt;TargetWebSite&gt;, inFlags = ReplayDetect, SequenceDetect, Confidentiality, AllocateMemory, InitManualCredValidation)\nSystem.Net Information: 0 : [35268] InitializeSecurityContext(In-Buffer length=0, Out-Buffer length=184, returned code=ContinueNeeded).\nSystem.Net Information: 0 : [35268] InitializeSecurityContext(credential = System.Net.SafeFreeCredential_SECURITY, context = 227c85a89b0:2449d0deff0, targetName = &lt;TargetWebSite&gt;, inFlags = ReplayDetect, SequenceDetect, Confidentiality, AllocateMemory, InitManualCredValidation)\nSystem.Net Information: 0 : [35268] InitializeSecurityContext(In-Buffers count=2, Out-Buffer length=0, returned code=CredentialsNeeded).\n</code></pre>\n\n<p>However, when running from Excel 2010 via com-interop, instead of those last 4 InitializeSecurityContext lines, there are 6 InitializeSecurityContext lines as follows:</p>\n\n<pre><code>System.Net Information: 0 : [39988] InitializeSecurityContext(credential = System.Net.SafeFreeCredential_SECURITY, context = (null), targetName = &lt;TargetWebSite&gt;, inFlags = ReplayDetect, SequenceDetect, Confidentiality, AllocateMemory, InitManualCredValidation)\nSystem.Net Information: 0 : [39988] InitializeSecurityContext(In-Buffer length=0, Out-Buffer length=184, returned code=ContinueNeeded).\nSystem.Net Information: 0 : [39988] InitializeSecurityContext(credential = System.Net.SafeFreeCredential_SECURITY, context = 8a8e2f0:2449d0def90, targetName = &lt;TargetWebSite&gt;, inFlags = ReplayDetect, SequenceDetect, Confidentiality, AllocateMemory, InitManualCredValidation)\nSystem.Net Information: 0 : [39988] InitializeSecurityContext(In-Buffers count=2, Out-Buffer length=0, returned code=ContinueNeeded).\nSystem.Net Information: 0 : [39988] InitializeSecurityContext(credential = System.Net.SafeFreeCredential_SECURITY, context = 8a8e2f0:2449d0def90, targetName = &lt;TargetWebSite&gt;, inFlags = ReplayDetect, SequenceDetect, Confidentiality, AllocateMemory, InitManualCredValidation)\nSystem.Net Information: 0 : [39988] InitializeSecurityContext(In-Buffers count=2, Out-Buffer length=0, returned code=ContinueNeeded).\n</code></pre>\n\n<p>The first two InitializeSecurityContext lines are the identical, so presumably crucial difference is on the third InitializeSecurityContext line, where the console EXE has</p>\n\n<p>context = 227c85a89b0:2449d0deff0</p>\n\n<p>but the failed run via com-interop executino has</p>\n\n<p>context = 8a8e2f0:2449d0def90</p>\n\n<p>After that, things don't look the same, as one would expect.  Does anyone know what that difference means, and how to make the difference go away so that the com-interop execution behaves in the same way as the com-interop execution?</p>\n\n<p><strong>Update 13-Feb-2019</strong></p>\n\n<p>I have posted more of the diagnostic output on <a href=\"https://social.microsoft.com/Forums/en-US/35954da6-5fa7-4685-b40b-60110df0903e/systemnethttpwebrequest-fails-to-logon-to-a-website-via-cominterop-in-windows-10-1809\" rel=\"nofollow noreferrer\">an MSDN forum</a>.  </p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 2, "creation_date": 1549445944, "post_id": 54550364, "comment_id": 95900971, "body": "How did you declare the arrays and the submitted_dates how did you fill them? We need more info to help you"}, {"owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549446241, "post_id": 54550364, "comment_id": 95901127, "body": "I assigned it directly. All_Submitted_Dates = Range(&quot;K2&quot;, Range(&quot;K1&quot;).End(xlDown))"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1549446396, "post_id": 54550364, "comment_id": 95901204, "body": "Have you considered =WEEKNUM(A1) ? gives the week number directly from the date... assumed that A1 contains the date..."}, {"owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "edited": false, "score": 0, "creation_date": 1549446510, "post_id": 54550364, "comment_id": 95901272, "body": "yes. If I am using weeknum function directly from excel i am getting proper output."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549446671, "post_id": 54550364, "comment_id": 95901376, "body": "Use the debugger in step by step mode and try to see if the array is 0 index based. Does the error happens in the last range\u2019s item?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1549446779, "post_id": 54550364, "comment_id": 95901431, "body": "Have you tried <code>All_Submitted_Dates(DateCounter,1)</code>?"}, {"owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549446799, "post_id": 54550364, "comment_id": 95901443, "body": "@RicardoDiaz Array index is starting from 1."}, {"owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1549446849, "post_id": 54550364, "comment_id": 95901471, "body": "@FoxfireAndBurnsAndBurns Yes I have tried it."}], "answers": [{"comments": [{"owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "edited": false, "score": 0, "creation_date": 1549447146, "post_id": 54550735, "comment_id": 95901636, "body": "I have tried it as All_Submitted_Dates(DateCounter, 1). But I am getting the same error."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "edited": false, "score": 0, "creation_date": 1549447268, "post_id": 54550735, "comment_id": 95901702, "body": "and have you tried transposing it as above? Are you sure your array is populated?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "edited": false, "score": 0, "creation_date": 1549449598, "post_id": 54550735, "comment_id": 95903173, "body": "@NAVEENPRAKASH Take a look at my update. I&#39;ve had a further look at your code"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1549449577, "last_edit_date": 1549449577, "creation_date": 1549446850, "answer_id": 54550735, "question_id": 54550364, "link": "https://stackoverflow.com/questions/54550364/converting-date-in-workweek-in-excel-vba/54550735#54550735", "title": "Converting Date in workweek in excel vba", "body": "<p>Assigning an array from a range directly ends up resulting in a <code>2D</code> array and not a <code>1D</code>. To overcome this you can either reference it as such e.g. <code>All_Submitted_Dates(DateCounter, 1)</code> or <code>Transpose</code> your input.</p>\n\n<p>If your input data is kept in a single column you just need to <code>Transpose</code> it once</p>\n\n<pre><code>With Application\n    All_Submitted_Dates = .Transpose(Range(\"K2\", Range(\"K1\").End(xlDown)))\nEnd With\n</code></pre>\n\n<p>However, if your data is in multiple columns you will need to double <code>Transpose</code> it to get the <code>1D</code> array</p>\n\n<pre><code>With Application\n    All_Submitted_Dates = .Transpose(.Transpose(Range(\"K2\", Range(\"K1\").End(xlDown))))\nEnd With\n</code></pre>\n\n<p>You can then reference your array as you have done in the rest of your code</p>\n\n<p><strong><em>Update after comments</em></strong>\nI think your issue is due to a combination of things (however this may just be due to your haven't included the information in your question). Can you take a look at the code below.</p>\n\n<p>I've declared both <code>All_Submitted_Dates</code> and <code>All_WorkWeek</code> as variants. I've then set the <code>All_Submitted_Dates</code> with an explicit sheet reference (Yours would have been taking from the <code>ActiveSheet</code> possibly causing errors) and also <code>Transpos[e]</code>ing the values so that the code is working with a <code>1D</code> array. I've then <code>ReDim</code>ed the <code>All_WorkWeek</code> array so that the size matches with <code>All_Submitted_Dates</code>. I've then used your <code>For</code> loop as you've written above. However, I would suggest to use <code>Lbound(All_Submitted_Dates)</code> instead of 1 although it shouldn't matter too much but is good practice.</p>\n\n<p>You will need to update the <code>With Sheet1</code> block with a reference to your sheet where your input Data is stored however, this in my tests, works as intended. </p>\n\n<pre><code>Dim All_Submitted_Dates As Variant, All_WorkWeek As Variant\nDim DateCounter As Long\n' Update with your sheet reference\nWith Sheet1\n    All_Submitted_Dates = Application.Transpose(.Range(.Range(\"K2\"), .Cells(.Rows.Count, \"K\").End(xlUp)))\nEnd With\n\nReDim All_WorkWeek(LBound(All_Submitted_Dates) To UBound(All_Submitted_Dates))\nFor DateCounter = 1 To UBound(All_Submitted_Dates)\n    All_WorkWeek(DateCounter) = WorksheetFunction.WeekNum(All_Submitted_Dates(DateCounter))\nNext DateCounter\n</code></pre>\n\n<p>The issues I found where:</p>\n\n<ul>\n<li>Array being declared as <code>2D</code> and referenced as <code>1D</code></li>\n<li>Weak Range references meaning code was referring to <code>ActiveSheet</code> possibly causing errors</li>\n<li>Range selection using <code>End(xlDown)</code> but starting above the first cell, causing the Range to only select one cell (therefore possibly defaulting to value of cell rather than creating an array)</li>\n<li><code>All_WorkWeek</code> possibly not initiated correctly so that it wouldn't accept any values</li>\n</ul>\n"}], "owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 54550735, "answer_count": 1, "score": 0, "last_activity_date": 1549449577, "creation_date": 1549445660, "last_edit_date": 1549446521, "question_id": 54550364, "link": "https://stackoverflow.com/questions/54550364/converting-date-in-workweek-in-excel-vba", "title": "Converting Date in workweek in excel vba", "body": "<p>Hi I am having a columns in which dates are present in yyyy-mm-dd h:mm:ss format. \nI want to convert them into workweeks.</p>\n\n<p>I tried it like </p>\n\n<pre><code>For DateCounter = 1 To UBound(All_Submitted_Dates)\n    All_workweek(DateCounter) = WorksheetFunction.WeekNum(All_Submitted_Dates(DateCounter))\nNext DateCounter\n</code></pre>\n\n<p>But I am getting subscript out of range exception. Can anybody tell me whats the error?</p>\n"}, {"tags": ["excel", "vba", "unicode", "character-encoding"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1549445554, "post_id": 54550241, "comment_id": 95900745, "body": "Only use the FileDialog to get the file name, and then open the file <a href=\"https://stackoverflow.com/a/155176/11683\">with <code>OpenText</code></a> providing the encoding."}], "owner": {"reputation": 48, "user_id": 10316370, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o4BhPvwhJOk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOaVXjsCWKfg06IB_SFTkb8FQGuqw/mo/photo.jpg?sz=128", "display_name": "TadejP", "link": "https://stackoverflow.com/users/10316370/tadejp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1549448971, "creation_date": 1549445152, "last_edit_date": 1549448971, "question_id": 54550241, "link": "https://stackoverflow.com/questions/54550241/import-file-and-change-charset-to-utf-8", "title": "Import file and change charset to UTF-8", "body": "<p>I need some help with importing a file. I have exported a .dpl file which contains Russian text, which is not shown by default. It shows random chars, like in the example below.</p>\n\n<pre><code>lt:3 LANG:10001 \"PST requested\" LANG:10027 \"PST requested\" LANG:10007 \"\u0110\u02d8\u0110\u00b5\u0143\u0143\u201a \u0110\u00b7\u0110\u00b0\u0110\u017c\u0143\u20ac\u0110\u013e\u0143\u0110\u00b5\u0110\u02dd\u0110\u013e\" \n</code></pre>\n\n<p>I run the script below to select and import the file into a new sheet, but I have no idea where to insert the code to change <code>Charset = \"utf-8\"</code></p>\n\n<pre><code>Sub OpenAFile() 'import file\n\nDim fd As FileDialog\nDim homeWorkbook As Workbook\nSet homeWorkbook = ActiveWorkbook\nDim targetBook As Workbook\nDim targetSheet As Worksheet\n\nApplication.DisplayAlerts = False\n\nSet fd = Application.FileDialog(msoFileDialogOpen)\n\nFileWasChosen = fd.Show\n\nfd.Execute\n\nSet targetBook = ActiveWorkbook\nSet targetSheet = targetBook.Worksheets(1)\n\ntargetSheet.Copy After:=homeWorkbook.Sheets(homeWorkbook.Sheets.Count)\n\nApplication.DisplayAlerts = True\n\nWith homeWorkbook.Sheets(homeWorkbook.Sheets.Count)\n    .Name = \"Import\"\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>It needs to be displayed like this: </p>\n\n<pre><code>lt:3 LANG:10001 \"Limit alarm HH suppressed\" LANG:10027 \"Limit alarm HH suppressed\" LANG:10007 \"\u041f\u0440\u0435\u0434\u0435\u043b - \u0442\u0440\u0435\u0432. \u043e\u043f\u043e\u0432\u0435\u0449-\u0435 \u0430\u0432\u0430\u0440. \u0432\u044b\u0441. \u0443\u0440-\u043d\u044f \u0443\u0441\u0442\u0440-\u043d\u043e\" \n</code></pre>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["excel", "vba", "for-loop", "next"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1549444868, "post_id": 54550058, "comment_id": 95900340, "body": "For a (possibly poor) example structure to help you along, have a look at this : <a href=\"https://stackoverflow.com/q/50776026/4961700\">stackoverflow.com/q/50776026/4961700</a>  also look how the range is copied and delivered, which you don&#39;t seem to have yet."}, {"owner": {"reputation": 43, "user_id": 11018304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593ce088e7a8aa2375e815341c25e7fd?s=128&d=identicon&r=PG&f=1", "display_name": "Jodie", "link": "https://stackoverflow.com/users/11018304/jodie"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1549446245, "post_id": 54550058, "comment_id": 95901130, "body": "Thank you! I will look now. That must be why I now get the message break in code.  I know hardly anything about code and this is my first attempt so thank you for the help."}], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 43, "user_id": 11018304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593ce088e7a8aa2375e815341c25e7fd?s=128&d=identicon&r=PG&f=1", "display_name": "Jodie", "link": "https://stackoverflow.com/users/11018304/jodie"}, "edited": false, "score": 0, "creation_date": 1549446153, "post_id": 54550131, "comment_id": 95901078, "body": "You may want to look at incrementing your value of <code>i</code> in the loop as well. If this has solved your problem don&#39;t forgot to click the tick to mark it as solved on the left hand side of this answer"}, {"owner": {"reputation": 43, "user_id": 11018304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593ce088e7a8aa2375e815341c25e7fd?s=128&d=identicon&r=PG&f=1", "display_name": "Jodie", "link": "https://stackoverflow.com/users/11018304/jodie"}, "edited": false, "score": 0, "creation_date": 1549447512, "post_id": 54550131, "comment_id": 95901857, "body": "Thanks, I just realised that, the code works but I only get the last line. Fantastic! It&#39;s all working... what a buzz! Next step is to try to copy the headers over :)"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1549446168, "last_edit_date": 1549446168, "creation_date": 1549444751, "answer_id": 54550131, "question_id": 54550058, "link": "https://stackoverflow.com/questions/54550058/compile-error-for-without-next-vba-code/54550131#54550131", "title": "Compile error For without Next - VBA code", "body": "<p>You're missing <code>Next cell</code> at the end of your <code>For</code> loop</p>\n\n<pre><code>Sub CopyRows()\n    Dim cell As Range\n    Dim lastRow As Long\n    Dim i As Long\n\n    Dim wksh1 As Worksheet\n    Set wksh1 = Worksheets(\"01 Feb 19\")\n\n    Dim wksh2 As Worksheet\n    Set wksh2 = Worksheets(\"Deployed\")\n\n    lastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row 'finds the last row\n    i = 1\n\n    For Each cell In wksh1.Range(\"T1:T\" &amp; lastRow) 'looks in T column until the last row\n        If cell.Value = \"Deployed\" Then 'searches for word deployed\n            cell.EntireRow.Copy wksh2.Cells(i, 1) 'copies entire row into Deployed work sheet\n            i = i + 1 ' &lt;-- Added so that rows don't overwrite each other. Remove if it is intended to overwrite each row\n        End If\n    Next cell ' &lt;-- Added\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11018304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593ce088e7a8aa2375e815341c25e7fd?s=128&d=identicon&r=PG&f=1", "display_name": "Jodie", "link": "https://stackoverflow.com/users/11018304/jodie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1636, "favorite_count": 0, "accepted_answer_id": 54550131, "answer_count": 1, "score": 1, "last_activity_date": 1549446168, "creation_date": 1549444504, "last_edit_date": 1549444832, "question_id": 54550058, "link": "https://stackoverflow.com/questions/54550058/compile-error-for-without-next-vba-code", "title": "Compile error For without Next - VBA code", "body": "<p>I am trying to write some VBA code that will search a worksheet called \"01 Feb 19\", column (T) and look for the word \"Deployed\", if it finds that word will then copy the entire row into a new worksheet called \"deployed\". I've added a For loop and I know I need to add a Next but I can't figure it out.</p>\n\n<p>Here's my code so far.</p>\n\n<pre><code>Sub CopyRows()    \n    Dim cell As Range\n    Dim lastRow As Long\n    Dim i As Long\n\n    Dim wksh1 As Worksheet\n    Set wksh1 = Worksheets(\"01 Feb 19\")\n\n    Dim wksh2 As Worksheet\n    Set wksh2 = Worksheets(\"Deployed\")\n\n    lastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row 'finds the last row\n    i = 1\n\n    For Each cell In wksh1.Range(\"T1:T\" &amp; lastRow) 'looks in T column until the last row\n        If cell.Value = \"Deployed\" Then 'searches for word deployed\n            cell.EntireRow.Copy wksh2.Cells(i, 1) 'copies entire row into Deployed work sheet      \n        End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "combobox", "vba"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549442387, "post_id": 54549312, "comment_id": 95899060, "body": "Does the combo have several columns?"}, {"owner": {"reputation": 43, "user_id": 10064357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4681c294539252eb7fdc28c506058fd7?s=128&d=identicon&r=PG&f=1", "display_name": "A Lawliet", "link": "https://stackoverflow.com/users/10064357/a-lawliet"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549442906, "post_id": 54549312, "comment_id": 95899330, "body": "No, when creating on the wizard it only shows one column of data, which is how it should be, I think it could have to do with the last stage of the wizard, when it asks what to do with the value, either remembering the value or storing it somewhere else."}, {"owner": {"reputation": 43, "user_id": 10064357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4681c294539252eb7fdc28c506058fd7?s=128&d=identicon&r=PG&f=1", "display_name": "A Lawliet", "link": "https://stackoverflow.com/users/10064357/a-lawliet"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549443300, "post_id": 54549312, "comment_id": 95899530, "body": "@RicardoDiaz After cheking it on properties, yes, it has two columns. Why is that if I only selected one column when creating the combo box?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549443480, "post_id": 54549312, "comment_id": 95899617, "body": "Ok so there is the problem. Change the combo properties to one column."}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 1, "creation_date": 1549443835, "post_id": 54549312, "comment_id": 95899780, "body": "Try <code>Replace(.Column(1), &quot;&#39;&quot;, &quot;&#39;&#39;&quot;)</code>"}, {"owner": {"reputation": 43, "user_id": 10064357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4681c294539252eb7fdc28c506058fd7?s=128&d=identicon&r=PG&f=1", "display_name": "A Lawliet", "link": "https://stackoverflow.com/users/10064357/a-lawliet"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 1, "creation_date": 1549444064, "post_id": 54549312, "comment_id": 95899897, "body": "Thank you very much to both of you, replacing column 1 worked perfectly. The problem is solved but I&#39;d like to know anywa, before trying @Santosh solotuion, I&#39;ve tried to set the numbers of columns on 1 on properties, but then the combo became empty on the form, why is that?"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 1, "creation_date": 1549444422, "post_id": 54549312, "comment_id": 95900088, "body": "@ALawliet You are welcome :)"}, {"owner": {"reputation": 43, "user_id": 10064357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4681c294539252eb7fdc28c506058fd7?s=128&d=identicon&r=PG&f=1", "display_name": "A Lawliet", "link": "https://stackoverflow.com/users/10064357/a-lawliet"}, "edited": false, "score": 0, "creation_date": 1549444717, "post_id": 54549312, "comment_id": 95900260, "body": "One last question, how can I add an option to the combo in order to select all the options? I mean, once I select a filter, I cannot go back to show all the unfiltered resutls."}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1549445418, "post_id": 54549312, "comment_id": 95900647, "body": "When you make the combo box <code>combinado30</code> null, it should show you all the records."}], "answers": [{"tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1549443616, "creation_date": 1549443616, "answer_id": 54549839, "question_id": 54549312, "link": "https://stackoverflow.com/questions/54549312/filtering-with-combo-in-access-not-working-properly/54549839#54549839", "title": "Filtering with combo in Access not working properly", "body": "<p>Change the combo properties to one column should solve the problem</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 10064357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4681c294539252eb7fdc28c506058fd7?s=128&d=identicon&r=PG&f=1", "display_name": "A Lawliet", "link": "https://stackoverflow.com/users/10064357/a-lawliet"}, "is_accepted": false, "score": 1, "last_activity_date": 1549444379, "last_edit_date": 1549444379, "creation_date": 1549444131, "answer_id": 54549976, "question_id": 54549312, "link": "https://stackoverflow.com/questions/54549312/filtering-with-combo-in-access-not-working-properly/54549976#54549976", "title": "Filtering with combo in Access not working properly", "body": "<p>Turned out the combo box has 2 columns instead of one, @Santosh solution worked perfectly:</p>\n\n<pre><code> Replace(.Column(1), \"'\", \"''\")\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10064357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4681c294539252eb7fdc28c506058fd7?s=128&d=identicon&r=PG&f=1", "display_name": "A Lawliet", "link": "https://stackoverflow.com/users/10064357/a-lawliet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549444379, "creation_date": 1549441667, "last_edit_date": 1549442338, "question_id": 54549312, "link": "https://stackoverflow.com/questions/54549312/filtering-with-combo-in-access-not-working-properly", "title": "Filtering with combo in Access not working properly", "body": "<p>I've been trying to filter the result of a SQL query by using a combo box. I need it to be done with AfterUpdate() because I need it to show all the resutls (unfiltered) and then, if wanted, filter based on the content of the combo box. </p>\n\n<p>Here \"Cuadro_combinado30\" is the name of the combo box and \"Dossier\" is the name of the field I want to filter by.</p>\n\n<pre><code>Private Sub Cuadro_combinado30_AfterUpdate()\n\nDim strFilter As String\n\nWith Me.Cuadro_combinado30\n    If IsNull(.Value) Or .Value = \"**ALL**\" Then\n       ' If the combo box is cleared or ALL selected, clear the form filter.\n       Me.Filter = vbNullString\n       Me.FilterOn = False\n    Else\n        ' item other than ALL is selected, filter for an exact match.\n        strFilter = \"[Dossier] = '\" &amp; _\n            Replace(.Value, \"'\", \"''\") &amp; \"'\"\n        Debug.Print strFilter ' check this in Immediate window in case of \n        ' trouble you can use Ctrl+g to go to the Immediate window\n        Me.Filter = strFilter\n        Me.FilterOn = True\n    End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>So far, the result has been that when I enter the form, all results are showing, but when I select one option of the combo box in order to filter the results, then the query does not seem to find anything as no result is shown.</p>\n\n<p>Why is this code not working and what should I modify for it to work?</p>\n\n<p>Thank you. </p>\n\n<p>UPDATE: I've tried to use a text box instead of a combo box, and it works, when I type something on the text box the results are filtered based on what I just wrote. I guess it has to do with how the combo box is created, it seems that even when the combo box is showing content, the filter finds a NULL on it. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1549441685, "post_id": 54549168, "comment_id": 95898747, "body": "Check this thread. It\u2019s old, but maybe can point you in the right direction. <a href=\"https://www.excelforum.com/excel-programming-vba-macros/1039410-distributing-excel-files-with-vba-treeview-active-x-controls-in.html\" rel=\"nofollow noreferrer\">excelforum.com/excel-programming-vba-macros/&hellip;</a>"}, {"owner": {"reputation": 491, "user_id": 10154892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxWv-GwaUFs/AAAAAAAAAAI/AAAAAAAABNQ/k076JfSWJ-c/photo.jpg=k-s128", "display_name": "Gexas", "link": "https://stackoverflow.com/users/10154892/gexas"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549442350, "post_id": 54549168, "comment_id": 95899048, "body": "Thanks for the link. It offers to late bound the code, I figured it out myself, but have no idea how to do it. Another solution it offers is to ad this to my code <code>strGUID = &quot;{0D452EE1-E08F-101A-852E-02608C4D0BB4}&quot; &#39;Add the reference ThisWorkbook.VBProject.References.AddFromGuid GUID:=strGUID, Major:=1, Minor:=0</code> , however I do not understand where to add this lines? To my sub? Or somewhere else?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549442538, "post_id": 54549168, "comment_id": 95899122, "body": "In order to be efficient, I\u2019d add it at opening of the workbook event"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1549448825, "post_id": 54549168, "comment_id": 95902663, "body": "<a href=\"https://stackoverflow.com/questions/9879825/how-to-add-a-reference-programmatically/9880276#9880276\" title=\"how to add a reference programmatically\">stackoverflow.com/questions/9879825/&hellip;</a>"}, {"owner": {"reputation": 491, "user_id": 10154892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxWv-GwaUFs/AAAAAAAAAAI/AAAAAAAABNQ/k076JfSWJ-c/photo.jpg=k-s128", "display_name": "Gexas", "link": "https://stackoverflow.com/users/10154892/gexas"}, "edited": false, "score": 0, "creation_date": 1549453745, "post_id": 54549168, "comment_id": 95905647, "body": "Thanks <code>Siddhart Rout</code> for very clear explanation in provided link. So, it turns out, that in order to avoid users from manually turning on reference to <code>MSComctlLib</code> I need then to manually turn on another  reference and check <code>Trust Access To Visual Basic Project</code> in options. This approach is way harder and more complicated than initial one... My other idea is to turn off UserForm with TreeView completely if reference is missing, but is it possible to check active references without checking <code>Trust Access To Visual Basic Project</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 10154892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxWv-GwaUFs/AAAAAAAAAAI/AAAAAAAABNQ/k076JfSWJ-c/photo.jpg=k-s128", "display_name": "Gexas", "link": "https://stackoverflow.com/users/10154892/gexas"}, "edited": false, "score": 0, "creation_date": 1549441544, "post_id": 54549237, "comment_id": 95898699, "body": "ErrorHandler will work despite the fact that error is generated on <code>Private Sub ...()</code> line? That&#39;s great I thought that code execution won&#39;t even reach ErrorHandler."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 491, "user_id": 10154892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxWv-GwaUFs/AAAAAAAAAAI/AAAAAAAABNQ/k076JfSWJ-c/photo.jpg=k-s128", "display_name": "Gexas", "link": "https://stackoverflow.com/users/10154892/gexas"}, "edited": false, "score": 0, "creation_date": 1549441784, "post_id": 54549237, "comment_id": 95898786, "body": "You&#39;re right, have to think out of the box to solve that issue. From the top of my head you could also call that sub from another sub. This will enable the code to go through error checking lines before entering the sub. E.g. having the <code>On Error</code> line right before you call the sub, or populating a variable in the TreeView Sub and as it exits, checking in the main sub whether that value is populated. Hope that helps."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 491, "user_id": 10154892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxWv-GwaUFs/AAAAAAAAAAI/AAAAAAAABNQ/k076JfSWJ-c/photo.jpg=k-s128", "display_name": "Gexas", "link": "https://stackoverflow.com/users/10154892/gexas"}, "edited": false, "score": 0, "creation_date": 1549442315, "post_id": 54549237, "comment_id": 95899035, "body": "I have added code to support my alternative error handler from my previous comment"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 0, "last_activity_date": 1549442287, "last_edit_date": 1549442287, "creation_date": 1549441354, "answer_id": 54549237, "question_id": 54549168, "link": "https://stackoverflow.com/questions/54549168/late-binding-microsoft-windows-common-control-treeview-object/54549237#54549237", "title": "Late binding Microsoft Windows Common Control (TreeView) object", "body": "<p>For your last question:</p>\n\n<pre><code>Sub ()...\nOn Error GoTo ErrorHandler\n    'Your code\nExit Sub\nErrorHandler:\nMsgbox \"Could not load DragDrop function. Program execution has been terminated.\", vbExclamation, \"Error\"\nEnd Sub\n</code></pre>\n\n<p>If you want to, you could also just drop the MsgBox. </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>will not work as the code breaks on the first line.\nCode below to support my comment. If an error occurs in the sub-macro, then the PassedSub variable won't be set to True, thus indicating an error.</p>\n\n<pre><code>Public PassedSub As Boolean\nSub test1()\n\nOn Error Resume Next\n\nCall test2\nIf PassedSub = False Then GoTo ErrorHandler\nOn Error GoTo 0\n\nExit Sub\nErrorHandler:\nMsgBox \"Could not load DragDrop function. Program execution has been terminated.\", vbExclamation, \"Error\"\nEnd Sub\n\nSub test2()\n\nDebug.Print 2 / 0\nPassedSub = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 491, "user_id": 10154892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxWv-GwaUFs/AAAAAAAAAAI/AAAAAAAABNQ/k076JfSWJ-c/photo.jpg=k-s128", "display_name": "Gexas", "link": "https://stackoverflow.com/users/10154892/gexas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1549442287, "creation_date": 1549441034, "last_edit_date": 1549441299, "question_id": 54549168, "link": "https://stackoverflow.com/questions/54549168/late-binding-microsoft-windows-common-control-treeview-object", "title": "Late binding Microsoft Windows Common Control (TreeView) object", "body": "<p>I have implemented a DragDrop functionality to my Excel database using <code>TreeView</code> control, using this code:</p>\n\n<pre><code>Private Sub TreeView1_OLEDragDrop(Data As MSComctlLib.DataObject, Effect As Long, Button As Integer, Shift As Integer, X As Single, Y As Single)\nDim StrPath As String\n\nStrPath = Data.Files(1)\n'path saved in UserForm label named \"FilePathLB\"\nFilePathLB = StrPath\n\nEnd Sub\n</code></pre>\n\n<p>It works perfectly fine on most of the machines I distributed the file to, however some machines with older versions of MS Office fire an error on the very first line (<code>Private Sub ...</code>) due to not being able to find Microsoft Windows Common Control library.</p>\n\n<p>My question: is it possible to late bind this library and thereby preventing the error from happening? </p>\n\n<p>Or at least, is it possible to add a debugger to prevent the error from showing, something like <code>On Error Resume Next</code> for the whole Sub? I understand that in this case the DragDrop function would not work, but it is better than an error.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1549440833, "post_id": 54549018, "comment_id": 95898435, "body": "I think <code>If i=1 then</code> : <code>Thisworkbook.sheets(b).Range(&quot;A1:W90&quot;).Copy</code> :  <code>Else</code> <code>Thisworkbook.sheets(b).Range(&quot;A2:W90&quot;).Copy</code> : <code>End if</code> would do If Row 1 is the header"}, {"owner": {"reputation": 1, "user_id": 10989212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bb58fc232f421652d30720dd614e9af?s=128&d=identicon&r=PG&f=1", "display_name": "Parul Singh", "link": "https://stackoverflow.com/users/10989212/parul-singh"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1549445645, "post_id": 54549018, "comment_id": 95900799, "body": "Ok , this might work , this will copy the 1st sheet with the header and rest without the header . Thank you Ahmed AU."}], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 1, "user_id": 10989212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bb58fc232f421652d30720dd614e9af?s=128&d=identicon&r=PG&f=1", "display_name": "Parul Singh", "link": "https://stackoverflow.com/users/10989212/parul-singh"}, "edited": false, "score": 0, "creation_date": 1549463177, "post_id": 54549128, "comment_id": 95911394, "body": "If it worked, please accept the answer and upvote. Thx."}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1549440835, "creation_date": 1549440835, "answer_id": 54549128, "question_id": 54549018, "link": "https://stackoverflow.com/questions/54549018/i-want-to-add-the-data-from-other-sheets-without-copying-the-header-again-and-ag/54549128#54549128", "title": "I want to add the data from other sheets without copying the header again and again", "body": "<p>It is hard to see exactly what you want, but I gave it a try. This may work:</p>\n\n<pre><code>Sub collate_data()\n    Dim c As Integer\n    Dim i As Integer\n    Dim a As Integer\n    Dim b As Variant\n\n    ThisWorkbook.Sheets.Add after:=Sheets(\"Orders\")\n    ActiveSheet.Name = \"finalsheet\"\n    c = Sheets(\"Control2nd\").Range(\"A100\").End(xlUp).Row\n\n    For i = 1 To c\n        a = Sheets(\"Finalsheet\").Range(\"A10000\").End(xlUp).Row\n        b = Sheets(\"Control2nd\").Range(\"A\" &amp; i).Value\n        If i = 1 Then\n            ThisWorkbook.Sheets(b).Range(\"A1:W90\").Copy\n        Else\n            ThisWorkbook.Sheets(b).Range(\"A2:W90\").Copy\n        End If\n        ThisWorkbook.Sheets(\"FinalSheet\").Range(\"A\" &amp; a).Select\n        ActiveSheet.Paste\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10989212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bb58fc232f421652d30720dd614e9af?s=128&d=identicon&r=PG&f=1", "display_name": "Parul Singh", "link": "https://stackoverflow.com/users/10989212/parul-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549457791, "creation_date": 1549440323, "last_edit_date": 1549457791, "question_id": 54549018, "link": "https://stackoverflow.com/questions/54549018/i-want-to-add-the-data-from-other-sheets-without-copying-the-header-again-and-ag", "title": "I want to add the data from other sheets without copying the header again and again", "body": "<p>I want to add the data from other sheets without copying the header again and again. </p>\n\n<p>This code copy data from different sheets and collate in one sheet. But it includes header every time i merge the data under previous data. I want to add the data from other sheets without copying the header. </p>\n\n<pre><code>sub collate_data()\n    thisworkbook.sheets.add after:=sheets(\"Orders\")\n    Activesheet.name = \"finalsheet\"\n    c = sheets(\"Control2nd\").range(\"A100\").End(Xlup).row\n\n    for i = 1 to c\n        a = sheets(\"Finalsheet\").range(\"A10000\").End(xlup).Row\n        b = sheets(\"Control2nd\").range(\"A\" &amp; i).value\n        Thisworkbook.sheets(b).Range(\"A1:W90\").Copy\n        Thisworkbook.sheets(\"FinalSheet\").Range(\"A\" &amp; a).select\n        activesheet.Paste\n    Next\nEnd Sub\n</code></pre>\n\n<p>Expected result should header should be pasted only once and other sheets data should be pasted without header. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 1, "creation_date": 1549439849, "post_id": 54548876, "comment_id": 95898033, "body": "This is a good post in terms of trying to tell us what you would like. However, what have you tried? Have you tried to record a macro and then learning from there?"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1549440032, "post_id": 54548876, "comment_id": 95898111, "body": "Have you tried <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">Find Method</a> ?"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1549442936, "post_id": 54548876, "comment_id": 95899344, "body": "Please edit your question to show the code you have for &quot;macro to copy the data and put it in the (G2:G365) range&quot;?"}, {"owner": {"reputation": 1, "user_id": 11021468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04d5658f66a39af027802146cea8d4a2?s=128&d=identicon&r=PG&f=1", "display_name": "GM not Ford", "link": "https://stackoverflow.com/users/11021468/gm-not-ford"}, "edited": false, "score": 0, "creation_date": 1549472397, "post_id": 54548876, "comment_id": 95917216, "body": "Code added but only for a couple sheets. Yes I am learning VBA. I have been using excel for years and have gotten quite good at writing formulas to get my data arranged and displayed how I want it but the time it takes is getting out of hand. Using VBA to automate my data copying will greatly reduce my hands on time that can be used elsewhere. I still need to pull data from different sources but that will be difficult to figure out but by saving the time copying I can dedicate more time to learning how to do it,"}, {"owner": {"reputation": 1, "user_id": 11021468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04d5658f66a39af027802146cea8d4a2?s=128&d=identicon&r=PG&f=1", "display_name": "GM not Ford", "link": "https://stackoverflow.com/users/11021468/gm-not-ford"}, "edited": false, "score": 0, "creation_date": 1549522450, "post_id": 54548876, "comment_id": 95933670, "body": "I have been trying to use the Find Method but I keep getting errors, I do think that is the way to go and using Dim to set my (I1) cell as a reference so I do not need to write out the code for every worksheet change."}], "owner": {"reputation": 1, "user_id": 11021468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04d5658f66a39af027802146cea8d4a2?s=128&d=identicon&r=PG&f=1", "display_name": "GM not Ford", "link": "https://stackoverflow.com/users/11021468/gm-not-ford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549484364, "creation_date": 1549439602, "last_edit_date": 1549484364, "question_id": 54548876, "link": "https://stackoverflow.com/questions/54548876/how-do-i-use-a-date-reference-on-1-sheet-to-use-as-a-place-to-paste-data-on-mult", "title": "How do I use a date reference on 1 sheet to use as a place to paste data on multiple other sheets but copied on same sheet as to be pasted", "body": "<p>I have a workbook that needs daily updating of 72 different sheets. I want to use todays date located on \"SheetList\" (I1) as a search parameter to determine where data gets pasted. The data is located in the same range on each sheet (G2:G365) I then have a column on every sheet that lists the date range I am using (L2:L145). When the date is matched in (L2:145) I need to transpose all the cells copied in range (G2:G365) starting in column M next to the correct date. The data is copied and pasted on the same sheet but I need to do it over all 72 sheets. I already have the macro to copy the data and put it in the (G2:G365) range but I am stuck on figuring out how to locate the date in column L then offset to column M and transpose the cells. Not all copied cells have data but that should not be an issue as I want to copy and paste the whole range.</p>\n\n<p>So in a nutshell the date listed in cell I1 on \"SheetList\"</p>\n\n<p>copy data located on every sheet (G2:G365)</p>\n\n<p>match date from cell \"SheetList\" (I1) to correct row of (L2:145)</p>\n\n<p>Paste values (Numbers not text) into columns (M:NL) beside correct date</p>\n\n<p>I would prefer to use sheet codes vs sheet names as well.</p>\n\n<p>I have found many different scenarios but they all copy data to a different sheets, not the same one, and nothing seems look do an index match type function to determine where to put the data. I am new to VBA and have read a ton of conflicting ways to get info but nothing includes searching for where to place it.</p>\n\n<pre><code>Sub AAA_AllDailyUpdates()\n'\n' AAA_AllDailyUpdates Macro\n'\nSheets(\"VsRPI1-25-1st\").Select\n            Range(\"F2:F365\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"G2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    Sheets(\"VsRPI1-25-2nd\").Select\n           Range(\"F2:F365\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"G2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    Sheets(\"VsRPI1-25HomeFinal\").Select\n            Range(\"F2:F365\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"G2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n</code></pre>\n\n<p>End Sub</p>\n\n<pre><code>    Sub Transpose()\n    Sheets(\"VsRPI1-25Final\").Select\nRange(\"G2:G365\").Select\nSelection.Copy\n    Range(\"M94\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\n\nSheets(\"VsRPI1-25-1st\").Select\nRange(\"G2:G365\").Select\nApplication.CutCopyMode = False\nSelection.Copy\n    Range(\"M94\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\n</code></pre>\n\n<p>End Sub</p>\n\n<p>In the Transpose macro this is the line that I know needs to lookup the current date on \"SheetList\" (I1) but I am having trouble figuring out how to do the reference cell then offset into column \"M\"</p>\n\n<pre><code>    Range(\"M94\").Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1549437344, "post_id": 54548256, "comment_id": 95896955, "body": "i try the code but its says Autofil method of range class failed."}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "reply_to_user": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1549437764, "post_id": 54548256, "comment_id": 95897114, "body": "what is the value of Lastrowzxc?"}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1549437871, "post_id": 54548256, "comment_id": 95897152, "body": "Range(&quot;I4&quot;).CurrentRegion.Rows.Count  , the last cell in &quot;I&quot; have value."}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "reply_to_user": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1549438012, "post_id": 54548256, "comment_id": 95897205, "body": "That I can see. What is the actual value (number). How many rows do you have in your region?"}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1549438361, "post_id": 54548256, "comment_id": 95897374, "body": "the value number of my rows is not fixed , it depends on our extracted row files."}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "reply_to_user": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1549438474, "post_id": 54548256, "comment_id": 95897430, "body": "I understand that :) but when you get the error - what is the number of rows?"}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1549439352, "post_id": 54548256, "comment_id": 95897816, "body": "Hi Sir Pawel - thank you for answering my question. i got it thank  you so much! i already resolved! :)"}], "tags": [], "owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1549436705, "creation_date": 1549436705, "answer_id": 54548256, "question_id": 54547935, "link": "https://stackoverflow.com/questions/54547935/how-to-filldown-activecell-in-vba/54548256#54548256", "title": "How to Filldown activecell in vba", "body": "<p>You have incorrect address in 'Range' of autofill. This might work, but this is far from perfect (just a starting point to get you going):</p>\n\n<pre><code>Dim Lastrowzxc As Long\nLastrowzxc = Range(\"I4\").CurrentRegion.Rows.Count\n\nRange(\"G\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n  ActiveCell.FormulaR1C1 = \"=IF(RC[2]&lt;0,\"\"40\"\",\"\"50\"\")\"\nSelection.AutoFill Destination:=Range(Cells(2, 7), Cells(Lastrowzxc, ActiveCell.Column))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1549437584, "post_id": 54548269, "comment_id": 95897045, "body": "there&#39;s no specific last range sir Van."}], "tags": [], "owner": {"reputation": 154, "user_id": 4859154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHx8sN_2gAs/AAAAAAAAAAI/AAAAAAAAAKk/tKTtkGvTvwA/photo.jpg?sz=128", "display_name": "C. van Dorsten", "link": "https://stackoverflow.com/users/4859154/c-van-dorsten"}, "is_accepted": false, "score": 0, "last_activity_date": 1549535164, "last_edit_date": 1549535164, "creation_date": 1549436758, "answer_id": 54548269, "question_id": 54547935, "link": "https://stackoverflow.com/questions/54547935/how-to-filldown-activecell-in-vba/54548269#54548269", "title": "How to Filldown activecell in vba", "body": "<p>Suppose <code>I4:I20</code> is the range to fill and <code>G4</code> contains the formula, this is what you should do:</p>\n\n<pre><code>Range(\"I4:I20\").FormulaR1C1 = Range(\"G4\").FormulaR1C1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": true, "score": 0, "last_activity_date": 1549439290, "last_edit_date": 1549439290, "creation_date": 1549438142, "answer_id": 54548565, "question_id": 54547935, "link": "https://stackoverflow.com/questions/54547935/how-to-filldown-activecell-in-vba/54548565#54548565", "title": "How to Filldown activecell in vba", "body": "<p>Try this it works for me:</p>\n\n<pre><code>Dim Lastrowzxc As Long\nLastrowzxc = ActiveSheet.Range(\"I4\").currentRegion.Rows.Count\n\nRange(\"G\" &amp; ActiveSheet.Rows.count).End(xlUp).Offset(1).Select\n\nSelection.FormulaR1C1 = \"=IF(RC[2]&lt;0,\"\"40\"\",\"\"50\"\")\"\n\nSelection.AutoFill Destination:=Range(Range(ActiveCell.Address), Cells(Lastrowzxc, ActiveCell.Column))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 0, "last_activity_date": 1549438916, "creation_date": 1549438916, "answer_id": 54548725, "question_id": 54547935, "link": "https://stackoverflow.com/questions/54547935/how-to-filldown-activecell-in-vba/54548725#54548725", "title": "How to Filldown activecell in vba", "body": "<p>Why bother selecting ranges? It's bad practice. </p>\n\n<p>I don't quite understand what your goal is as you are selecting the cell below the last cell in col G. I suppose you want to start at the last row of col G until the last row for col I? If so..: </p>\n\n<pre><code>With Workbooks(\"REFERENCE\").Sheets(\"REFERENCE\")\nLastrowI = .Cells(.Rows.Count, \"I\").End(xlUp).Row\nLastrowG = .Cells(.Rows.Count, \"G\").End(xlUp).Row\n\n.Range(\"G\" &amp; LastrowG).FormulaR1C1 = \"=IF(RC[2]&lt;0,\"\"40\"\",\"\"50\"\")\" 'change Range if necessary\n.Range(\"G\" &amp; LastrowG).FormulaR1C1.AutoFill Destination:= .Range(\"G\" &amp; LastrowG &amp; \":G\" &amp; LastrowI)\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1545, "favorite_count": 0, "accepted_answer_id": 54548565, "answer_count": 4, "score": 0, "last_activity_date": 1549535164, "creation_date": 1549435065, "last_edit_date": 1549438834, "question_id": 54547935, "link": "https://stackoverflow.com/questions/54547935/how-to-filldown-activecell-in-vba", "title": "How to Filldown activecell in vba", "body": "<p>Could anyone help me? Let's say <code>I4:I</code> is my Lastrow and Activecell in G will fill down the formula. </p>\n\n<pre><code>Dim Lastrowzxc As Long\nLastrowzxc = Range(\"I4\").CurrentRegion.Rows.Count\n\nRange(\"G\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n  ActiveCell.FormulaR1C1 = \"=IF(RC[2]&lt;0,\"\"40\"\",\"\"50\"\")\"\nSelection.AutoFill Destination:=Range(ActiveCell.Address &amp; Lastrowzxc)\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549433945, "post_id": 54547252, "comment_id": 95895645, "body": "Are the 3 cells to it\u2019s right contiguous? How do you decide where to paste them? Please rey to be more specific describing the cases"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1549435381, "last_edit_date": 1549435381, "creation_date": 1549434074, "answer_id": 54547723, "question_id": 54547252, "link": "https://stackoverflow.com/questions/54547252/is-there-a-way-to-copy-multiple-user-selected-cells-into-another-worksheet-all-a/54547723#54547723", "title": "Is there a way to copy multiple user selected cells into another worksheet all at the same time?", "body": "<p>To copy/paste everything (values, formatting, etc), use:</p>\n\n<pre><code>ActiveCell.Resize(,3).Copy Destination:=Worksheets(\"myTargetWorksheetName\").Range(\"A1\")\n</code></pre>\n\n<p>Just change \u201cmyTargetWorksheetName\u201d to your actual destination sheet name and \u201cA1\u201d to your actual destination sheet landing cell</p>\n\n<p>To copy/paste values only:</p>\n\n<pre><code>Worksheets(\"myTargetWorksheetName\").Range(\"A1:C1\").Value = ActiveCell.Resize(,3).Value\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11021080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad356b7d74d2868f73531e7fe6f39f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah Hernandez", "link": "https://stackoverflow.com/users/11021080/sarah-hernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 54547723, "answer_count": 1, "score": 0, "last_activity_date": 1549435381, "creation_date": 1549431748, "question_id": 54547252, "link": "https://stackoverflow.com/questions/54547252/is-there-a-way-to-copy-multiple-user-selected-cells-into-another-worksheet-all-a", "title": "Is there a way to copy multiple user selected cells into another worksheet all at the same time?", "body": "<p>My main problem is copying a certain range of user selected data into another worksheet.</p>\n\n<p>I tried using selection.copy but i think it is better to avoid using that function.</p>\n\n<p>Is there a way that the user can select a single cell; copy the value of the cell including the values of the next three cells to its right, and paste it into a different worksheet?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2269, "user_id": 10953776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49be4ccecdbd4ef7926fb49db96d617?s=128&d=identicon&r=PG&f=1", "display_name": "anand_v.singh", "link": "https://stackoverflow.com/users/10953776/anand-v-singh"}, "edited": false, "score": 0, "creation_date": 1549432284, "post_id": 54547241, "comment_id": 95895090, "body": "I also had a similar problem, the only solution that worked was installing a VM, in which installing an OS in mandarin (Chineese) and compiling my code there, but it was c++ not vba so I cannot guarantee it will work"}, {"owner": {"reputation": 11, "user_id": 7171758, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BU3TqoLVjGY/AAAAAAAAAAI/AAAAAAAAABM/iIVXcb7uEvY/photo.jpg?sz=128", "display_name": "Nitish Singh", "link": "https://stackoverflow.com/users/7171758/nitish-singh"}, "reply_to_user": {"reputation": 2269, "user_id": 10953776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49be4ccecdbd4ef7926fb49db96d617?s=128&d=identicon&r=PG&f=1", "display_name": "anand_v.singh", "link": "https://stackoverflow.com/users/10953776/anand-v-singh"}, "edited": false, "score": 0, "creation_date": 1549436913, "post_id": 54547241, "comment_id": 95896775, "body": "@anand_v.singh Thank you for the response. Can you tell me bit more about your issue?  Is it the case:The code complied in OS other than in mandarin was not working for the user in China?"}, {"owner": {"reputation": 2269, "user_id": 10953776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49be4ccecdbd4ef7926fb49db96d617?s=128&d=identicon&r=PG&f=1", "display_name": "anand_v.singh", "link": "https://stackoverflow.com/users/10953776/anand-v-singh"}, "edited": false, "score": 0, "creation_date": 1549441272, "post_id": 54547241, "comment_id": 95898595, "body": "I was working with python, using py2exe to convert it into executable, the character <code>|</code> looked like <code>?</code> and there were other similar issues, I then installed python in the target computer and made the exe in that, then the characters looked okay in Chinese PC but broke in my system."}, {"owner": {"reputation": 2269, "user_id": 10953776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49be4ccecdbd4ef7926fb49db96d617?s=128&d=identicon&r=PG&f=1", "display_name": "anand_v.singh", "link": "https://stackoverflow.com/users/10953776/anand-v-singh"}, "edited": false, "score": 0, "creation_date": 1549441321, "post_id": 54547241, "comment_id": 95898611, "body": "I think there is a difference in how Unicode is implemented that come pre-installed in mandarin, however that is just a hunch"}, {"owner": {"reputation": 2269, "user_id": 10953776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49be4ccecdbd4ef7926fb49db96d617?s=128&d=identicon&r=PG&f=1", "display_name": "anand_v.singh", "link": "https://stackoverflow.com/users/10953776/anand-v-singh"}, "edited": false, "score": 0, "creation_date": 1549441484, "post_id": 54547241, "comment_id": 95898675, "body": "A similar thing then happened when I ported my code to c++., the characters would break based on where it was compiled. I didn&#39;t exactly figure out why it happened, but did find the workout that if I use a VM installed with Chinese/Mandarin windows, code compiled in it didn&#39;t break characters in Chinese systems"}, {"owner": {"reputation": 2269, "user_id": 10953776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49be4ccecdbd4ef7926fb49db96d617?s=128&d=identicon&r=PG&f=1", "display_name": "anand_v.singh", "link": "https://stackoverflow.com/users/10953776/anand-v-singh"}, "edited": false, "score": 0, "creation_date": 1549441563, "post_id": 54547241, "comment_id": 95898708, "body": "But even if compiled on VM, the characters would look different in my PC outside VM"}, {"owner": {"reputation": 2269, "user_id": 10953776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49be4ccecdbd4ef7926fb49db96d617?s=128&d=identicon&r=PG&f=1", "display_name": "anand_v.singh", "link": "https://stackoverflow.com/users/10953776/anand-v-singh"}, "edited": false, "score": 0, "creation_date": 1549441703, "post_id": 54547241, "comment_id": 95898754, "body": "I did not try to changing it from UTF-8 to Unicode, that might work though"}], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 11, "user_id": 7171758, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BU3TqoLVjGY/AAAAAAAAAAI/AAAAAAAAABM/iIVXcb7uEvY/photo.jpg?sz=128", "display_name": "Nitish Singh", "link": "https://stackoverflow.com/users/7171758/nitish-singh"}, "edited": false, "score": 0, "creation_date": 1549515245, "post_id": 54548438, "comment_id": 95931256, "body": "You are welcome. If you found this helpful then, please upvote and accept as your answer. Thanks."}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1549437559, "creation_date": 1549437559, "answer_id": 54548438, "question_id": 54547241, "link": "https://stackoverflow.com/questions/54547241/vba-code-getting-changed-for-the-user-of-china/54548438#54548438", "title": "VBA CODE getting changed for the user of China", "body": "<h1>Try using chrW for character codes of different languages</h1>\n\n<p>You can try the Unicode character for that string like the following:</p>\n\n<p><code>If ext_mould_Search3.Range(\"G\" &amp; rowPointer) Like \"*\" &amp; chrw(&amp;H00B1) &amp; \"*\" Then</code></p>\n\n<p>That may fix your problem.  Worth a try.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7171758, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BU3TqoLVjGY/AAAAAAAAAAI/AAAAAAAAABM/iIVXcb7uEvY/photo.jpg?sz=128", "display_name": "Nitish Singh", "link": "https://stackoverflow.com/users/7171758/nitish-singh"}, "edited": false, "score": 0, "creation_date": 1549514443, "post_id": 54553297, "comment_id": 95931052, "body": "Thank you for your response. It was really helpful and things are working."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1549454847, "creation_date": 1549454847, "answer_id": 54553297, "question_id": 54547241, "link": "https://stackoverflow.com/questions/54547241/vba-code-getting-changed-for-the-user-of-china/54553297#54553297", "title": "VBA CODE getting changed for the user of China", "body": "<p>The reason why the Chinese developer is not seeing correctly the <code>\u00b1</code> is because of the encoding they are using. In general,  for characters which are not in the the Ascii Character Codes Chart1 it is advisable to follow this rule:</p>\n\n<ul>\n<li>Create a very hidden worksheet in Excel, named <code>Settings</code> or something similar;</li>\n<li>Write the character there and refer it from there in your code;</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/tLBv1.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tLBv1.gif\" alt=\"enter image description here\"></a></p>\n\n<p>In your case it would be like this:</p>\n\n<pre><code>If ext_mould_Search3.Range(\"G\" &amp; rowPointer) Like \"*\" &amp; tblSettings.Range(\"A1\") &amp; \"*\" Then\n</code></pre>\n\n<p>If it is going to be used quite a lot, consider making an additional class with read-only constants, referring to that worksheet. E.g.:</p>\n\n<pre><code>Property Get GermanAE()\n    GermanAE = tblSettings.Range(\"A1\").Value2\nEnd Property\n</code></pre>\n\n<p>This could be called in the following way:</p>\n\n<pre><code>Public Sub TestMe()    \n   Dim DedicatedStrings As New DedicatedStrings\n   Debug.Print DedicatedStrings.GermanAE    '\u00e4\nEnd Sub\n</code></pre>\n\n<p>If you use just a few, you may consider using <a href=\"https://docs.microsoft.com/en-us/office/vba/excel/concepts/cells-and-ranges/refer-to-named-ranges\" rel=\"nofollow noreferrer\">named ranges</a> in Excel, and calling the chars (or the whole string) like this <code>[GermanAE]</code>, because it looks a quite understandable as well:</p>\n\n<p>If ext_mould_Search3.Range(\"G\" &amp; rowPointer) Like \"<em>\" &amp; [GermanAE] &amp; \"</em>\" Then</p>\n\n<p>This is a really good article for Encoding, explaining why the first 128 chars are quite the same for all settings:</p>\n\n<ul>\n<li><a href=\"https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/\" rel=\"nofollow noreferrer\">The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)</a></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 7171758, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BU3TqoLVjGY/AAAAAAAAAAI/AAAAAAAAABM/iIVXcb7uEvY/photo.jpg?sz=128", "display_name": "Nitish Singh", "link": "https://stackoverflow.com/users/7171758/nitish-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549513396, "creation_date": 1549431702, "last_edit_date": 1549513396, "question_id": 54547241, "link": "https://stackoverflow.com/questions/54547241/vba-code-getting-changed-for-the-user-of-china", "title": "VBA CODE getting changed for the user of China", "body": "<p>I have an Excel application, written in VBA, which is working well with the users in North America region as well as for Europe region. But the same application is not working well for the users in China.</p>\n\n<p>While debugging on user's system, I found out the <strong>\"\u00b1\"</strong> of the code is getting changed to <strong>\"?</strong>. </p>\n\n<p><strong>Can Someone help me on this?</strong></p>\n\n<p>This application takes data from the hidden worksheet and copies in our UI in Excel. I tried changing language setting but it didn't work. </p>\n\n<pre><code>If ext_mould_Search3.Range(\"G\" &amp; rowPointer) Like \"*\" &amp; \"\u00b1\" &amp; \"*\" Then\n    ext_mould_Search3.Range(\"G\" &amp; rowPointer).Select\n    ActiveCell.Replace What:=\" \", Replacement:=vbNullString, LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n    MyText = ext_mould_Search3.Range(\"G\" &amp; rowPointer).Value\n    Density = Left(MyText, Len(MyText) - 5)\nElse\n    Density = ext_mould_Search3.Range(\"G\" &amp; rowPointer)\nEnd If\n\n'Get data from the selected row\nmaterialName = ext_mould_Search3.Range(\"D\" &amp; rowPointer)\nShore = ext_mould_Search3.Range(\"H\" &amp; rowPointer)\nsap = ext_mould_Search3.Range(\"I\" &amp; rowPointer)\nfamily = ext_mould_Search3.Range(\"J\" &amp; rowPointer)\nshort = ext_mould_Search3.Range(\"R\" &amp; rowPointer)\n</code></pre>\n"}, {"tags": ["excel", "vba", "jira"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549434241, "post_id": 54547017, "comment_id": 95895757, "body": "The url returns error 400 for me"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549434336, "post_id": 54547017, "comment_id": 95895792, "body": "Maybe you need to login or something first. In which case please take a look at web scraping with selenium"}, {"owner": {"reputation": 154, "user_id": 4859154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHx8sN_2gAs/AAAAAAAAAAI/AAAAAAAAAKk/tKTtkGvTvwA/photo.jpg?sz=128", "display_name": "C. van Dorsten", "link": "https://stackoverflow.com/users/4859154/c-van-dorsten"}, "edited": false, "score": 0, "creation_date": 1549437198, "post_id": 54547017, "comment_id": 95896894, "body": "I suspect asn error in the URL. This is what the browser returns:  HTTP Status 400 \u2013 Bad Request The value &#39;ATHP&#39; does not exsist for the field &#39;project The server cannot or will not process the request due to something that is perceived to be a client error (e.g., malformed request syntax, invalid request message framing, or deceptive request routing)."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1549440357, "post_id": 54547017, "comment_id": 95898248, "body": "Have you tried looking at the trust center in Excel and adding the web address to your trusted locations?"}, {"owner": {"reputation": 1211, "user_id": 6237093, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh4.googleusercontent.com/-c1dpqIMQ1j4/AAAAAAAAAAI/AAAAAAAAJy0/mKo_jUhScqg/photo.jpg?sz=128", "display_name": "David Leal", "link": "https://stackoverflow.com/users/6237093/david-leal"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549457444, "post_id": 54547017, "comment_id": 95907877, "body": "@Ricardo Diaz The URL can be accessed only if you have opened a Jira session for this project. I provided it in case there is some special character or something the excel is interpreting in a different way."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 154, "user_id": 4859154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHx8sN_2gAs/AAAAAAAAAAI/AAAAAAAAAKk/tKTtkGvTvwA/photo.jpg?sz=128", "display_name": "C. van Dorsten", "link": "https://stackoverflow.com/users/4859154/c-van-dorsten"}, "edited": false, "score": 0, "creation_date": 1549458402, "post_id": 54547017, "comment_id": 95908434, "body": "I just copied and pasted in the browser, so as @C.vanDorsten said there\u2019s an error in the url."}, {"owner": {"reputation": 1211, "user_id": 6237093, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh4.googleusercontent.com/-c1dpqIMQ1j4/AAAAAAAAAAI/AAAAAAAAJy0/mKo_jUhScqg/photo.jpg?sz=128", "display_name": "David Leal", "link": "https://stackoverflow.com/users/6237093/david-leal"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549489367, "post_id": 54547017, "comment_id": 95924880, "body": "@RicardoDiaz the URL looks fine outside of excel (putting it directly in Chrome), but when I add it as a hyperlink and then click on it, I got the above error. I was trying to use this URL as a way to download the file (without assigning hyperlink), but I was not able to make it works. The issue is not related with the length of the hyperlink because I got the same problem using the shortener URL. The way the URL is formed you can use it in the navigator, but not in excel as an hyperlink, but I am not able to figure it out why?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1549494329, "post_id": 54547017, "comment_id": 95926697, "body": "I remember having something similar. You can do some research around url encoding inside office programs"}, {"owner": {"reputation": 154, "user_id": 4859154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHx8sN_2gAs/AAAAAAAAAAI/AAAAAAAAAKk/tKTtkGvTvwA/photo.jpg?sz=128", "display_name": "C. van Dorsten", "link": "https://stackoverflow.com/users/4859154/c-van-dorsten"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1549531915, "post_id": 54547017, "comment_id": 95938083, "body": "@Ricardo Diaz - No, is not the problem. I already  tried that and I got the same result."}, {"owner": {"reputation": 1211, "user_id": 6237093, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh4.googleusercontent.com/-c1dpqIMQ1j4/AAAAAAAAAAI/AAAAAAAAJy0/mKo_jUhScqg/photo.jpg?sz=128", "display_name": "David Leal", "link": "https://stackoverflow.com/users/6237093/david-leal"}, "edited": false, "score": 0, "creation_date": 1549560183, "post_id": 54547017, "comment_id": 95955205, "body": "By the way, I added a similar <a href=\"https://community.atlassian.com/t5/Jira-questions/Why-I-cannot-use-this-URL-as-an-Hyperlink-in-excel/qaq-p/1000766#U1001635\" rel=\"nofollow noreferrer\">question</a> in Altassian Jira Community, in case the solution has more to do with Jira than with Excel."}], "owner": {"reputation": 1211, "user_id": 6237093, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh4.googleusercontent.com/-c1dpqIMQ1j4/AAAAAAAAAAI/AAAAAAAAJy0/mKo_jUhScqg/photo.jpg?sz=128", "display_name": "David Leal", "link": "https://stackoverflow.com/users/6237093/david-leal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549560275, "creation_date": 1549430059, "last_edit_date": 1549560275, "question_id": 54547017, "link": "https://stackoverflow.com/questions/54547017/adding-this-url-from-jira-as-hyperlink-to-the-excel-cell-does-not-work-why", "title": "Adding this URL from JIRA as hyperlink to the excel cell does not work, why?", "body": "<p>I have the following link:</p>\n\n<pre><code>https://nttdata.atlassian.net/sr/jira.issueviews:searchrequest-csv-current-fields/temp/SearchRequest.csv?jqlQuery=project+%3D+ATHP+AND+issuetype+in+%28story%2C+feature%2C+task%29+AND+Sprint+%3D+1113+AND+%28status+was+not+in++%28DONE%2C+%22BUILD+COMPLETE%22%29+AFTER+%222019%2F01%2F21%22+%29+AND+%28status+was+not+in++%28DONE%2C+%22BUILD+COMPLETE%22%29++BEFORE+%222019%2F01%2F23%22%29&amp;tempMax=1000\n</code></pre>\n\n<p><strong>Note:</strong> It assumes to have an open Jira session for this project. I provided it here in case there is some special character that excel may interpret in a different way.</p>\n\n<p>It executes a Jira Query and downloads the result in a CSV file. </p>\n\n<p>This query is generated by JIRA when trying to export into an excel file the result of the Jira Query Language:</p>\n\n<pre><code>project = ATHP AND issuetype in (story, feature, task) AND \n    Sprint = 1113 AND (status was not in  (DONE, \"BUILD COMPLETE\") AFTER \n    \"2019/01/21\" ) AND (status was not in  (DONE, \"BUILD COMPLETE\")  \n    BEFORE \"2019/01/23\")\n</code></pre>\n\n<p><strong>Note:</strong> I was trying with a simpler query too based on JIRA request: project = ATHP (search for all issues of project with ID: ATHP) that produce the following query:</p>\n\n<pre><code>https://nttdata.atlassian.net/sr/jira.issueviews:searchrequest-csv-current-fields/temp/SearchRequest.csv?jqlQuery=project+%3DATHP&amp;tempMax=1000\n</code></pre>\n\n<p>with the same result.</p>\n\n<p>I added as a hyperlink to a cell and when I try to click on the cell, I get the following error:</p>\n\n<pre><code>Unable to open\nhttps://nttdata.atlassian.net/...\nCannot download the information you requested\n</code></pre>\n\n<p>I thought it may be possible due to the length of the link (396 characters) that has more than 255 characters (see this <a href=\"https://stackoverflow.com/questions/3893541/exceeding-max-char-limit-in-excel\">question</a>), then I created a shortened URL via Bitly, but I get the same error. If I copy and paste the URL directly in Chrome, I get the file downloaded using the original URL or the equivalent Bitly URL.</p>\n\n<p>I also tried to access the hyperlink via VBA script too:</p>\n\n<pre><code>Range(\"G11\").Select\nSelection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True\n</code></pre>\n\n<p>But I get the same error.</p>\n\n<p>I have another similar URL created by JIRA that works well as a hyperlink: </p>\n\n<pre><code>https://nttdata.atlassian.net/sr/jira.issueviews:searchrequest-csv-current-fields/39627/SearchRequest-39627.csv?tempMax=1000\n</code></pre>\n\n<p>One of the differences of this URL is that instead of passing the parameters to the query (<code>JiraQuery</code>) it invokes a filter (saved query) under ID: 39627.</p>\n\n<p>Any suggestion about what is going on here?, for sure there is something in the URL syntax that Excel does not like it, even the navigator accepts it.</p>\n"}, {"tags": ["excel", "vba", "string", "find", "export"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8514904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/742828297fe60d0ca2245740992a8e2d?s=128&d=identicon&r=PG&f=1", "display_name": "kailash", "link": "https://stackoverflow.com/users/8514904/kailash"}, "edited": false, "score": 0, "creation_date": 1549454012, "post_id": 54548896, "comment_id": 95905817, "body": "Thank you Ahmed AU for very fast response. As a matter of fact, there are more than 100 Serial No under &quot;From:&quot; and only one Serial No under &quot;To:&quot;. Similarly, there is only one  Serial No under From and there are more than hundred Serial No under &quot;To:&quot;. theretofore,  we have to first find To and catch the source or From numbers up to that point and start catching forward from  To to the end. As the workbooks are unorganized forms, there are blank cells between them. too. Thanks."}, {"owner": {"reputation": 49, "user_id": 8514904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/742828297fe60d0ca2245740992a8e2d?s=128&d=identicon&r=PG&f=1", "display_name": "kailash", "link": "https://stackoverflow.com/users/8514904/kailash"}, "edited": false, "score": 0, "creation_date": 1549474295, "post_id": 54548896, "comment_id": 95918220, "body": "It is a fast code and it helped me to sort my task with different approach. Although, it is silent about using FIND operations, I desperately needed, Tons of thanks. It gave me insight to solve my problem."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 49, "user_id": 8514904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/742828297fe60d0ca2245740992a8e2d?s=128&d=identicon&r=PG&f=1", "display_name": "kailash", "link": "https://stackoverflow.com/users/8514904/kailash"}, "edited": false, "score": 0, "creation_date": 1549499781, "post_id": 54548896, "comment_id": 95928148, "body": "It a pleasure to be useful. In Find method you are searching range A142  onward.with `Set rng = sh1.Range(&quot;A14&quot; &amp; i)&#39;. Other issues are also there. May refer <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">Link1</a> and <a href=\"https://excelmacromastery.com/excel-vba-find/\" rel=\"nofollow noreferrer\">Link2</a>. It is not necessary  use all the optional parameters."}, {"owner": {"reputation": 49, "user_id": 8514904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/742828297fe60d0ca2245740992a8e2d?s=128&d=identicon&r=PG&f=1", "display_name": "kailash", "link": "https://stackoverflow.com/users/8514904/kailash"}, "edited": false, "score": 0, "creation_date": 1549504746, "post_id": 54548896, "comment_id": 95929153, "body": "Thank you so much for the helpful links. Wonderful guidance. feeling like somebody gave me a basket of fish and taught how to fish."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 1, "last_activity_date": 1549439700, "creation_date": 1549439700, "answer_id": 54548896, "question_id": 54546796, "link": "https://stackoverflow.com/questions/54546796/how-to-use-find-as-a-first-and-last-row-to-look-value-at-to-match-value-and-c/54548896#54548896", "title": "How to use &quot;FIND&quot; as a first and last row to look value at, to match value and copy adjacent cell to another workbook?", "body": "<p>There seems to be multiple issues with the code. But what I understand from your requirement that basically you are trying to copying A14 to maximum up to around A40, skipping the text 'Serial No' &amp; empty cells and transposing them in to worksheet(\"sorter\") along with filename. I could not feel any great importance to use of find method.</p>\n\n<p>If that is the case you may try the below simplified brute force code (Since you claim only cells A14 to A40 contain significant data). However for better understanding of the problems may go through some good examples of Find Method and its parameters.Also try to avoid activate etc and take care of Loops with clear view of what you and to achieve.</p>\n\n<pre><code>Sub NewTry555()\nDim File As String\nDim RootFolder As String\nDim wbk As Workbook\nDim Sh As Worksheet\nDim wbk2 As Workbook\nDim sh2 As Worksheet\nDim LastRow As Long, LastRow2 As Long, Rw As Long, OfSt As Long\nDim FileNum As Long, Txt As String\n\nRootFolder = \"C:\\Users\\User\\Desktop\\Folder1\\\"\nSet wbk2 = ThisWorkbook\nSet sh2 = wbk2.Sheets(\"Sorter\")\nlastrow1 = sh2.Cells(Rows.Count, 1).End(xlUp).Row\n\n\nFile = Dir(RootFolder &amp; \"*.xl*\")\nFileNum = 0\n\n    While File &lt;&gt; \"\"\n    FileNum = FileNum + 1\n    Set wbk = Workbooks.Open(RootFolder &amp; File)\n    Set Sh = wbk.Sheets(1)\n    Sh.Cells.UnMerge\n    LastRow = Sh.Cells(Rows.Count, 1).End(xlUp).Row\n\n    lastrow1 = lastrow1 + 1\n    sh2.Range(\"A\" &amp; lastrow1).Offset(1).Value = FileNum\n    sh2.Range(\"B\" &amp; lastrow1).Value = File\n    OfSt = 0\n        For Rw = 14 To LastRow\n        Txt = Sh.Cells(Rw, 1).Text\n            If Len(Txt) &gt; 0 Then\n            If InStr(1, Txt, \"Serial No\") &lt;= 0 Then\n            OfSt = OfSt + 1\n            sh2.Range(\"B\" &amp; lastrow1).Offset(, OfSt).Value = Txt\n            End If\n            End If\n        Next\n    wbk.Close False\n    File = Dir\n    Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8514904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/742828297fe60d0ca2245740992a8e2d?s=128&d=identicon&r=PG&f=1", "display_name": "kailash", "link": "https://stackoverflow.com/users/8514904/kailash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 54548896, "answer_count": 1, "score": 1, "last_activity_date": 1549439700, "creation_date": 1549428614, "question_id": 54546796, "link": "https://stackoverflow.com/questions/54546796/how-to-use-find-as-a-first-and-last-row-to-look-value-at-to-match-value-and-c", "title": "How to use &quot;FIND&quot; as a first and last row to look value at, to match value and copy adjacent cell to another workbook?", "body": "<p>I am stuck with Type mismatch Error 13 on Find operator. As data on my workbooks are not placed in predictable place, I need to find \"From:\" first and look for \"Serial No\" as source numbers just before Finding \"To:\". After completing Source or From Serial Nos, I need to copy To Serial numbers too. Little difficult for a novice like me.</p>\n\n<p>I have got thousands of excel workbooks with single sheet in sub-folders in a folder and I want to copy relevant data to another workbook with VBA. Excel sheet contains at A14 \"From:\"  one or multiple Serial Numbers as parent and their multiple children serial numbers, for example in  in A16 1234345 , so that serial nos can be traced which they are made from...like tracing from from one parents to many children or from many parents to consolidated one. The data is in not-so-organised excel forms. </p>\n\n<pre><code>From:         Or From\nSerial No        Serial No  \n12365            521466\n                 541852\nTo:              752142\nSerial No     \n12435             To:\n34562            Serial No\n23645            548215\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>1 File1  From: 12365 To: 12435 34562 23645\n2 File   From: 12435 34562 23645 To: 548215\n</code></pre>\n\n<p>As some times, Parents are many and child is single or few, i put no 1 at A1 and increase by 1 for each rows written in Parent or child columns to derive last row and not to mix data output. I am trying to put the file name in the destination B Column, and \"From:\" or parent Serial no or serial numbers in Column C and \"To:\" Serial No or Serial numbers as child serial nos in Col D. I have created a macro that activates A14, (there is always \"Form:\") and find text \"Serial No\" and copy the next cell with actual serial no until \"To:\" is found in a cell in A:A some where down there for example A30 or A40. After, I find \"To:\", I use find \"Serial No\" and copy actual serial no in next cell and paste in Column D</p>\n\n<pre><code> Sub NewTry555()\n\nDim File As Variant\nDim fileList As Collection\nDim RootFolder As String\nDim wbk As Workbook\nDim sh1 As Worksheet\nDim wbk2 As Workbook\nDim sh2 As Worksheet\nDim findcell As Range\n\nSet fileList = New Collection\n\n\nRootFolder = \"C:\\Users\\Bota\\Desktop\\TestVba\\Folder1\\\"\n\n\nFile = Dir(RootFolder &amp; \"*.xl*\")\n\n While File &lt;&gt; \"\"\n\n'Add File to Collection\n    fileList.Add RootFolder &amp; File\n    File = Dir\n Wend\n\nDim FilePath As Variant\n\nDim objBasis As Workbook\nDim objReport As Workbook\n\nSet objBasis = ThisWorkbook\n\n For Each FilePath In fileList\n\nSet objReport = Workbooks.Open(FilePath)\n\nSet wbk = ActiveWorkbook\nSet sh1 = wbk.Sheets(1)\n\nDim rng As Range\nDim i As Long\n\nWith sh1\n\nEnd With\n\nSet wbk2 = ThisWorkbook\n\nSet sh2 = wbk2.Sheets(\"Sorter\")\n\nDim lastrow1 As Long\nDim Filename As String\nFilename = Dir(FilePath)\n\nsh2.Activate\n\nWith sh2\n lastrow1 = Cells(Rows.Count, 1).End(xlUp).Row\n ActiveSheet.Range(\"A\" &amp; lastrow1).Offset(1).Formula = 1\n ActiveSheet.Range(\"B\" &amp; lastrow1).Formula = Filename\nEnd With\n\n Dim LastRangeSearch As Range\nsh1.Activate\nWith ActiveSheet\nCells.Select\nSelection.UnMerge\n\nlastrow = Cells(Rows.Count, 1).End(xlUp).Row\nRange(\"A12\").Activate\nFor i = 2 To lastrow\n Set rng = sh1.Range(\"A14\" &amp; i)\n Set LastRangeSearch = sh1.Range(\"A\" &amp; i).Find(What:=\"To:\", \nAfter:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlWhole, \nSearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=True, \nSearchFormat:=False)\n\n Next\n sh1.Range(\"A14\").Activate\n rollno = \"*Serial No*\"\n Do Until LastRangeSearch\n findcell = rng.Find(What:=rollno, After:=ActiveCell, \n LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, \n SearchDirection:=xlNext, MatchCase:= _\nTrue, SearchFormat:=False)\n\n\nFor Each findcell In rng\n\nIf Not findcell Is Nothing Then\nfindcell.Offset(1).Copy\nsh2.Range(\"A\" &amp; lastrow1).Offset(0, 3).PasteSpecial xlPasteValues\n\nEnd If\n\nNext\nLoop\n\nEnd With\n\nsh1.Activate\nlastrow = Cells(Rows.Count, 1).End(xlUp).Row\n LastRangeSearch.Activate\n\n Do Until sh1.UsedRange(\"A\" &amp; lastrow)\n\nfindcell = rng.Find(What:=rollno, After:=ActiveCell, LookIn:=xlFormulas, \n LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, \nMatchCase:= True, SearchFormat:=False)\n\n\nFor Each findcell In rng\n\nIf Not findcell Is Nothing Then\nfindcell.Offset(1).Copy\nsh2.Range(\"A\" &amp; lastrow1).Offset(0, 4).PasteSpecial xlPasteValues\n\nEnd If\n\n\nNext\nLoop\n\n\nwbk.Close savechanges:=False\n\nNext FilePath\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"reputation": 154, "user_id": 4859154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHx8sN_2gAs/AAAAAAAAAAI/AAAAAAAAAKk/tKTtkGvTvwA/photo.jpg?sz=128", "display_name": "C. van Dorsten", "link": "https://stackoverflow.com/users/4859154/c-van-dorsten"}, "edited": false, "score": 0, "creation_date": 1549438573, "post_id": 54546751, "comment_id": 95897478, "body": "You can have as many conditional formatting rules as you want on a cell based on whatever formula you use. Unless I misunderstand you, I don&#39;t see the problem here."}, {"owner": {"reputation": 381, "user_id": 10645669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0835999bc1f9616fc3ff8b3ca7b0e3a0?s=128&d=identicon&r=PG&f=1", "display_name": "GTPV", "link": "https://stackoverflow.com/users/10645669/gtpv"}, "edited": false, "score": 0, "creation_date": 1549444976, "post_id": 54546751, "comment_id": 95900406, "body": "You could also return a &quot;reversed rank&quot; where top performer are ranked last. This would allow you to use the same rule."}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1549450125, "post_id": 54546751, "comment_id": 95903451, "body": "It&#39;s very interesting problem. I am not sure if you can solve this using pure Excel. With VBA the simplest solution may be delete and add proper conditional formatting when you change growth/rank cell (Worksheet Change event), but this may slow down the worksheet a bit"}], "owner": {"reputation": 11, "user_id": 2025936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45b74950fa17fa9e214a4e0194ccfcd7?s=128&d=identicon&r=PG", "display_name": "user2025936", "link": "https://stackoverflow.com/users/2025936/user2025936"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549438095, "creation_date": 1549428293, "last_edit_date": 1549438095, "question_id": 54546751, "link": "https://stackoverflow.com/questions/54546751/conditional-formatting-based-on-list-filtering", "title": "Conditional formatting based on list filtering", "body": "<p><strong>History</strong>: I have created a excel dashboard displaying categories and their measures. I have given a list option filtering to display either growth or rank. I have used Green to red conditional formatting to display the high to low performance.</p>\n\n<p><strong>Problem</strong>: When I filter on growth % it shows proper conditional formatting i.e. higher the growth greener the cell and vice versa. But this won't be case in Rank. Lower the rank greener should be the cell is the ideal way to display top performer. This should be the ideal solution. But I am unable to find a way to do that. </p>\n\n<p><strong>Possible solution where help is needed</strong>: Clubbing conditional formatting with <strong>'if'</strong> formula or similar to change conditional formatting based on filter value. Can we have two conditional formatting rules based on certain cell condition?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1549428094, "post_id": 54546643, "comment_id": 95893858, "body": "Can you provide more information? is this happening over multiple cells? what is the intent?  Please read the following: <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 13, "user_id": 11020870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0444e52919101d7a974576579e0836?s=128&d=identicon&r=PG&f=1", "display_name": "Hawary", "link": "https://stackoverflow.com/users/11020870/hawary"}, "reply_to_user": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1549428210, "post_id": 54546643, "comment_id": 95893888, "body": "Sorry for my lack of information about this case."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1549428216, "post_id": 54546643, "comment_id": 95893891, "body": "Do I understand this correctly? The formula is slowing down your already slow worksheet and you want to be able to press a button to fill a column with data according to the formula. There is a drawback that this column will only update when you press the button. BTW, Which column is it?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1549428480, "post_id": 54546643, "comment_id": 95893976, "body": "I see you have asked the same question again. There is no need for that. You can edit this question anytime. There is an <b>edit</b> button right below your post. Click it and make changes."}, {"owner": {"reputation": 13, "user_id": 11020870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0444e52919101d7a974576579e0836?s=128&d=identicon&r=PG&f=1", "display_name": "Hawary", "link": "https://stackoverflow.com/users/11020870/hawary"}, "edited": false, "score": 0, "creation_date": 1549428551, "post_id": 54546643, "comment_id": 95894003, "body": "I used tu run macro with excel formula =IF(J2&lt;&gt;J1,AD2-X2,AE1-X2). But it&#39;s very slow calculation, i think its because running a formula. So i try to simplify the formula to vba code. My column is AE2 =IF(J2&lt;&gt;J1,AD2-X2,AE1-X2)"}], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 13, "user_id": 11020870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0444e52919101d7a974576579e0836?s=128&d=identicon&r=PG&f=1", "display_name": "Hawary", "link": "https://stackoverflow.com/users/11020870/hawary"}, "edited": false, "score": 0, "creation_date": 1549429342, "post_id": 54546777, "comment_id": 95894188, "body": "What&#39;s up? the comments are not for discussion. you should start a chat for that."}, {"owner": {"reputation": 13, "user_id": 11020870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0444e52919101d7a974576579e0836?s=128&d=identicon&r=PG&f=1", "display_name": "Hawary", "link": "https://stackoverflow.com/users/11020870/hawary"}, "edited": false, "score": 0, "creation_date": 1549430041, "post_id": 54546777, "comment_id": 95894420, "body": "Hi can i have a discussion with you by email regarding my matter?"}, {"owner": {"reputation": 13, "user_id": 11020870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0444e52919101d7a974576579e0836?s=128&d=identicon&r=PG&f=1", "display_name": "Hawary", "link": "https://stackoverflow.com/users/11020870/hawary"}, "edited": false, "score": 0, "creation_date": 1549437639, "post_id": 54546777, "comment_id": 95897067, "body": "Hello, it almost work but, i tried to use else function and fail. How about else for function &quot;AE1-X2&quot;? It almost done"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 13, "user_id": 11020870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0444e52919101d7a974576579e0836?s=128&d=identicon&r=PG&f=1", "display_name": "Hawary", "link": "https://stackoverflow.com/users/11020870/hawary"}, "edited": false, "score": 0, "creation_date": 1549438840, "post_id": 54546777, "comment_id": 95897589, "body": "OK, I updated it to work with AE1 and X1 as well as AD2 and X2."}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": true, "score": 1, "last_activity_date": 1549439093, "last_edit_date": 1549439093, "creation_date": 1549428478, "answer_id": 54546777, "question_id": 54546643, "link": "https://stackoverflow.com/questions/54546643/if-cell-value-same-with-upper-cell-value/54546777#54546777", "title": "If cell value same with upper cell value", "body": "<p>Here is an answer to your question.  However, it is limited to only work with OP information.  Also, if the calculations are taking too long then, you should try setting your calculation to Manual (Formulas->Calculation Options->Manual).</p>\n\n<pre><code>Option Explicit\n\nPublic Sub RunIF()\n    Dim vntOut As Variant\n    Dim rngSame As Range\n\n    With ActiveSheet\n\n        Set rngSave = .Range(\"X2\")\n\n        If (LCase(Trim(.Range(\"J2\").Value)) &lt;&gt; LCase(Trim(.Range(\"J1\").Value))) Then\n            vntOut = .Range(\"AD2\").Value - rngSave.Value\n        Else\n            vntOut = .Range(\"AE1\").Value - rngSave.Value\n        End If\n\n        .Range(\"AE2\").value = vntOut\n\n        Set rngSave = Nothing\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>And here is your code converted to use Column J:</p>\n\n<pre><code>Private Sub CommandButton12_Click()\n    Dim x As Long\n    Dim LastRow As Long\n    Dim i as long \n\n    With Sheets(\"Shipping Schedule\")\n        LastRow = .Cells(.Rows.Count, \"J\").End(xlUp).Row\n\n        For i = 2 to LastRow\n\n            set r = .Range(\"J\" &amp; I)\n        'For Each r In .Range(\"J2:J\" &amp; LastRow)\n            If LCase(Trim(r.Value)) &lt;&gt; LCase(Trim(r.Offset(-1, 0).Value)) Then\n                'ae2 =                      \"AD2\"             -   \"x2\"\n                r.Offset(0, 21).Value = r.Offset(0, 20).Value - r.Offset(0, 14).Value\n            Else\n                'ae2 =                      \"AE1\"         -        \"x2\"\n                r.Offset(0, 21).Value = r.Offset(-1, 21).Value - r.Offset(0, 14).Value\n            End If\n\n            set r = nothing \n\n        Next i\n    End With\nEnd Sub\n\n</code></pre>\n\n<p>However, you should increment with I instead of for each as the cells are dependent on the previous row and excel may not loop through the range like you would prefer.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11020870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0444e52919101d7a974576579e0836?s=128&d=identicon&r=PG&f=1", "display_name": "Hawary", "link": "https://stackoverflow.com/users/11020870/hawary"}, "edited": false, "score": 0, "creation_date": 1549429582, "post_id": 54546914, "comment_id": 95894267, "body": "r.Offset(0, 19).Value = \u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026. (Convert this formula to vba excel code =IF(J2&lt;&gt;J1,AD2-X2,AE1-X2)"}], "tags": [], "owner": {"reputation": 13, "user_id": 11020870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0444e52919101d7a974576579e0836?s=128&d=identicon&r=PG&f=1", "display_name": "Hawary", "link": "https://stackoverflow.com/users/11020870/hawary"}, "is_accepted": false, "score": 0, "last_activity_date": 1549435980, "last_edit_date": 1549435980, "creation_date": 1549429465, "answer_id": 54546914, "question_id": 54546643, "link": "https://stackoverflow.com/questions/54546643/if-cell-value-same-with-upper-cell-value/54546914#54546914", "title": "If cell value same with upper cell value", "body": "<pre><code>Private Sub CommandButton12_Click()\n\n    Dim x As Long\n\n    Dim LastRow As Long \n\n    Sheets(\"Shipping Schedule\").Select\n\n\n    With Sheets(\"Shipping Schedule\")\n\n        LastRow = .Cells(.Rows.Count, \"N\").End(xlUp).Row\n\n        For Each r In .Range(\"N2:N\" &amp; LastRow)\n\n            If r.Value &lt;&gt; \"\" Then\n\n                r.Offset(0, 19).Value = \u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026.              \n\n            End if      \n\n        Next r      \n\n    End With\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1549430170, "creation_date": 1549430170, "answer_id": 54547036, "question_id": 54546643, "link": "https://stackoverflow.com/questions/54546643/if-cell-value-same-with-upper-cell-value/54547036#54547036", "title": "If cell value same with upper cell value", "body": "<h1>Excel Formula to VBA: Fill Column</h1>\n\n<pre><code>Sub FillColumn()\n\n    Const cCol As Variant = \"J\"    ' Last-Row-Column Letter/Number\n    Const cCol1 As Variant = \"AD\"\n    Const cCol2 As Variant = \"X\"\n    Const cCol3 As Variant = \"AE\"\n    Const cFirstR As Long = 1      ' First Row\n\n    Dim rng As Range    ' Last Used Cell in Last-Row-Column\n    Dim i As Long       ' Row Counter\n\n    Set rng = Columns(cCol).Find(\"*\", , xlFormulas, , xlByColumns, xlPrevious)\n    If rng Is Nothing Then Exit Sub\n\n    For i = cFirstR To rng.Row - 1\n        If Cells(i + 1, cCol) &lt;&gt; Cells(i, cCol) Then\n            Cells(i + 1, cCol3) = Cells(i + 1, cCol1) - Cells(i + 1, cCol2)\n          Else\n            Cells(i + 1, cCol3) = Cells(i, cCol3) - Cells(i + 1, cCol2)\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11020870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0444e52919101d7a974576579e0836?s=128&d=identicon&r=PG&f=1", "display_name": "Hawary", "link": "https://stackoverflow.com/users/11020870/hawary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 54546777, "answer_count": 3, "score": 0, "last_activity_date": 1549439093, "creation_date": 1549427484, "last_edit_date": 1549437492, "question_id": 54546643, "link": "https://stackoverflow.com/questions/54546643/if-cell-value-same-with-upper-cell-value", "title": "If cell value same with upper cell value", "body": "<p>I tried to make macro for my daily job, but i cannot use IF as formula due to so many item in my excel file, so solution is to convert formula to VBA code.</p>\n\n<p>I need help to convert if formula to VBA code in excel as below:\n=IF(J2&lt;>J1,AD2-X2,AE1-X2).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1549438084, "post_id": 54546216, "comment_id": 95897231, "body": "Note that both of your <code>For</code> loops are missing a <code>Next</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9920894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca81ee2d28bade0dfe7c67d9d9126fec?s=128&d=identicon&r=PG&f=1", "display_name": "Harley C", "link": "https://stackoverflow.com/users/9920894/harley-c"}, "edited": false, "score": 0, "creation_date": 1549426196, "post_id": 54546345, "comment_id": 95893464, "body": "Great!  Thanks for your help!"}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1549424939, "creation_date": 1549424939, "answer_id": 54546345, "question_id": 54546216, "link": "https://stackoverflow.com/questions/54546216/loop-through-a-column-in-a-worksheet-copy-each-value-to-paste-in-other-workshee/54546345#54546345", "title": "Loop through a column in a worksheet, copy each value to paste in other worksheets", "body": "<p>This should work:</p>\n\n<pre><code>Option Explicit\n\nSub RunIT()\n  Dim rng As Range\n\n  Dim intI As Integer\n\n  Set rng = Worksheets(1).Range(\"A3:A5\")\n\n  For intI = 2 To Worksheets.Count\n      rng.Cells(intI - 1, 1).Copy Worksheets(intI).Range(\"A1\")\n  Next intI\n\n  Set rng = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1549426878, "last_edit_date": 1549426878, "creation_date": 1549425870, "answer_id": 54546446, "question_id": 54546216, "link": "https://stackoverflow.com/questions/54546216/loop-through-a-column-in-a-worksheet-copy-each-value-to-paste-in-other-workshee/54546446#54546446", "title": "Loop through a column in a worksheet, copy each value to paste in other worksheets", "body": "<h1>Copy to Worksheets</h1>\n\n<h2>Visualize</h2>\n\n<p><a href=\"https://i.stack.imgur.com/VbS2z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VbS2z.jpg\" alt=\"enter image description here\"></a></p>\n\n<h2>The Code</h2>\n\n<pre><code>Sub CopyToWorksheets()\n\n    ' List of Worksheet Names\n    Const cSheets As String = \"Sheet1,Sheet2,Sheet3,Sheet4\"\n    Const cRange As String = \"A3:A5\"  ' Source Worksheet Range\n    Const cCell As String = \"A1\"      ' Target Worksheet Cell Range\n\n    Dim vntWs As Variant  ' Worksheet Array\n    Dim i As Long         ' Worksheet Array Row Counter\n\n    ' Split List of Worksheet Names into Worksheet Array.\n    vntWs = Split(cSheets, \",\")\n\n    ' In Source Worksheet\n    With ThisWorkbook.Worksheets(vntWs(0))\n        ' Loop through cells of Source Worksheet Range.\n        For i = 1 To UBound(vntWs)\n            ' Copy value of current cell of Source Worksheet Range\n            ' to current Target Worksheet Cell Range.\n            .Parent.Worksheets(vntWs(i)).Range(cCell) = .Range(cRange).Cells(i)\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9920894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca81ee2d28bade0dfe7c67d9d9126fec?s=128&d=identicon&r=PG&f=1", "display_name": "Harley C", "link": "https://stackoverflow.com/users/9920894/harley-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549437991, "creation_date": 1549423691, "last_edit_date": 1549437991, "question_id": 54546216, "link": "https://stackoverflow.com/questions/54546216/loop-through-a-column-in-a-worksheet-copy-each-value-to-paste-in-other-workshee", "title": "Loop through a column in a worksheet, copy each value to paste in other worksheets", "body": "<p>I am trying to loop through column A (Cell A3 to A5) of worksheet, Sheet1 (cell values are 1, 2 ,and 3). And copy and paste the values into other worksheets in cell A1. So Sheet2 A1 has 1 , Sheet3 A1 has 2 and Sheet4 A1 has 3 . Instead my code ends up putting 3 into all the worksheets. Can anyone help? Thanks in advance </p>\n\n<pre><code>Sub test()\n    Dim X As Long, Y As Long\n\n    For X = 2 To Worksheets.Count        \n        For Y = 3 To 5\n            Sheets(\"sheet1\").Range(\"A\" &amp; Y).Copy Worksheets(X).Range(\"A1\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1549427747, "post_id": 54546039, "comment_id": 95893783, "body": "with the errExit statement before the <code>Set dbs = Nothing</code> statement. you are probably still holding onto the dbs instance. Move the <code>dbs = nothing</code> till after the <code>errExit:</code> line. Also, you should only skip errors on a single line that you know will cause an error. Otherwise, you can get all kinds of bad results. Finally, try closing out access completely and reopening it."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1549440121, "creation_date": 1549440121, "answer_id": 54548975, "question_id": 54546039, "link": "https://stackoverflow.com/questions/54546039/creating-and-linking-a-new-table-in-the-backend-using-vba-in-the-frontend/54548975#54548975", "title": "Creating and linking a new table in the backend using VBA in the frontend", "body": "<p>Try opening the database <em>shared</em>:</p>\n\n<pre><code>Set dbs = OpenDatabase(DB_PATH, False, False, strConn)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10800407, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oI2bTm4vkQA/AAAAAAAAAAI/AAAAAAAAPPI/eRjBHA6T0XM/photo.jpg?sz=128", "display_name": "Nico Bronkhorst", "link": "https://stackoverflow.com/users/10800407/nico-bronkhorst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 318, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1549440121, "creation_date": 1549422050, "last_edit_date": 1549432471, "question_id": 54546039, "link": "https://stackoverflow.com/questions/54546039/creating-and-linking-a-new-table-in-the-backend-using-vba-in-the-frontend", "title": "Creating and linking a new table in the backend using VBA in the frontend", "body": "<p>Im using VBA in my Access frontend to create a new table in my Access backend, then I link the table to my frontend.\nThe table and index is created successfully, but I keep getting the same error saying that the backend is in use by another user when I try to create a linked table in the front end. How can I fix this. I have done this several times in the past on this project, but all of a sudden it does not want to work anymore.</p>\n\n<p>I have tried creating the table in the backend first, then adding values to the table, then closing the connection to the backend database and reconnecting to it, then to transfer the link to the front end. No GO, Same error over and over.\nI am the only person accessing both files. The backend does not even show a locked file, but still it says that I cannot access it.</p>\n\n<pre><code>Private Sub Command1_Click()\nOn Err GoTo errExit\nDim dbs As DAO.Database\nDim DB_PATH As String\nDim strConn As String\n\n    DB_PATH = DLookup(\"BackendDirectory\", \"Link_Save\")\n    strConn = \"MS Access;PWD=\" &amp; BE_PASSWORD &amp; \";DATABASE=\" &amp; DB_PATH\n    Set dbs = OpenDatabase(DB_PATH, True, False, strConn)\n\n'Create table tbl_Client_Type\n\n        dbs.Execute \"CREATE TABLE tbl_Client_Type (Client_Type_ID COUNTER CONSTRAINT PrimaryKey PRIMARY KEY, \" &amp; _\n                                        \"Client_Type TEXT(100) NOT NULL);\"\n\n        dbs.Execute \"CREATE INDEX Client_Type_ID ON tbl_Client_Type (Client_Type_ID ASC);\"\n\n        DoEvents: \n        dbs.Execute \"INSERT INTO tbl_Client_Type (Client_Type) VALUES ('Motor')\"\n        dbs.Execute \"INSERT INTO tbl_Client_Type (Client_Type) VALUES ('Sail')\"\n        dbs.Execute \"INSERT INTO tbl_Client_Type (Client_Type) VALUES ('Other')\"\n        DoEvents:\n\n        'dbs.Close\n        'Set dbs = Nothing\n        'Set dbs = DBEngine.OpenDatabase(DB_PATH, True, False, strConn)\n        DoEvents:\n\n        DoCmd.TransferDatabase acLink, \"Microsoft Access\", DB_PATH, acTable, \"tbl_Client_Type\", \"tbl_Client_Type\"\n\n        DoEvents:\n        RefreshLinkedTable \"tbl_Client_Type\"\n        Application.RefreshDatabaseWindow\n\n    dbs.Close\n    Set dbs = Nothing\n\nerrExit:\n   Debug.Print Err.Number\n    Debug.Print Err.Description\n\nEnd Sub\n</code></pre>\n\n<p><strong>Runtime error 3045\n\"Could not use 'Database', file already in use</strong></p>\n\n<p>The file is not in use and no laccdb lock file </p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1549416309, "post_id": 54545326, "comment_id": 95891569, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28098914/outlook-vba-script-run-time-error-13-randomly-while-iterating-emails-in-a-public\">outlook VBA script run-time error 13 randomly while iterating emails in a public folder</a>. See how the accepted answer uses an <code>Object</code> variable, which it then tests the <code>Class</code> of. You are using <code>MailItem</code> variable in your <code>For Each</code> loop."}, {"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1549416673, "post_id": 54545326, "comment_id": 95891630, "body": "Thank you very much for your edits. I went through that query as well, hence, the inclusion of (&#39;If TypeName(OmailItem) = &quot;MailItem&quot; ) but it didn&#39;t work. In addition, I requested help with additional questions.  I have already spent 10 hrs on these to figure out a solution but was not smart enough to find one."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1549416742, "post_id": 54545326, "comment_id": 95891641, "body": "Note my second sentence to fix your main problem."}, {"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1549417110, "post_id": 54545326, "comment_id": 95891699, "body": "The code does process few emails as soon as it encounters a meeting or appointment, I get this error. Also, I do not know how the code starts its sequence, i.e. which email it will process first. I was wondering if there is a way to control this. Sorry I learned VBA for outlook only two weeks ago."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1549417568, "post_id": 54545326, "comment_id": 95891782, "body": "There&#39;s one thing I&#39;d suggest changing from the linked answer - I&#39;d go with <code>TypeOf ... Is</code> instead of <code>TypeName</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1549418059, "post_id": 54545326, "comment_id": 95891866, "body": "@Comintern I agree with <code>TypeOf</code>. I think the linked answer proposes that an <code>If TypeName</code> check is unnecessary if you&#39;re already checking that <code>.Class = 43</code>"}, {"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1549464673, "post_id": 54545326, "comment_id": 95912357, "body": "Thanks Guys.. Now I understand based on the example from OM3R on what you guys meant. Can you please help me with the followup questions?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1549429114, "post_id": 54546154, "comment_id": 95894137, "body": "Thanks Om3R..  this works very well.  Can I pick your brain on my other two followup questions? 1) How do reply to all to a latest email based on a selected subject and email could be in Inbox or sent items.  2) How to loop in all emails in a folder, i.e. clicking &quot;Click here to view more on Microsoft edge&quot; give you access to all old emails."}, {"owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1549464238, "post_id": 54546154, "comment_id": 95912089, "body": "I edited your code to address this I am not sure how to post it.      Items.Sort &quot;ReceivedTime&quot;, True &#39;to put them in order by date              If TypeOf Items(1) Is Outlook.MailItem And Items(1).Restrict(sFilter) Then"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "edited": false, "score": 0, "creation_date": 1549465841, "post_id": 54546154, "comment_id": 95913103, "body": "I\u2019m away from my computer now but will help later @DJSingh can you post new question on what you have and tried"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1549423137, "creation_date": 1549423137, "answer_id": 54546154, "question_id": 54545326, "link": "https://stackoverflow.com/questions/54545326/code-not-executing-the-loop-due-to-run-type-error-13-outlook/54546154#54546154", "title": "Code not executing the loop due to run type error 13 outlook", "body": "<p>How about the following...</p>\n\n<pre><code>Option Explicit\nPublic Sub AccessInbox2()\n'Early binding\n    Dim Olook As Outlook.Application ' to access all the libraries of outlook\n    ' it is class which opens the gate for you to access\n    ' all outlook folders. Unlike the Folder class,\n    ' it exactly tells VBA which folder to use.\n\n    Set Olook = New Outlook.Application\n\n    Dim Sht As Worksheet\n    Set Sht = ThisWorkbook.Sheets(\"Sheet1\")\n\n\n\n    Dim Items As Outlook.Items\n    Set Items = Olook.GetNamespace(\"MAPI\") _\n                     .GetDefaultFolder(olFolderInbox) _\n                     .Folders(\"Goldy\").Items\n\n   Dim i As Long\n   Dim LastRow As Long\n   For i = Items.Count To 1 Step -1\n\n        If TypeOf Items(i) Is Outlook.MailItem Then\n            Debug.Print Items(i).Subject ' Print on Immediate Window\n\n            With Sht\n\n                 LastRow = .Cells(.Rows.Count, 7).End(xlUp).Row + 1\n                 Debug.Print .Cells(LastRow, 7).Address ' Print on Immediate Window\n                .Cells(LastRow, 7).Value = Items(i).Subject\n\n            End With\n\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10819615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2de14518ba082ca5aaf28ad6ce6c6?s=128&d=identicon&r=PG&f=1", "display_name": "DJSingh", "link": "https://stackoverflow.com/users/10819615/djsingh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1549423137, "creation_date": 1549415157, "last_edit_date": 1549419171, "question_id": 54545326, "link": "https://stackoverflow.com/questions/54545326/code-not-executing-the-loop-due-to-run-type-error-13-outlook", "title": "Code not executing the loop due to run type error 13 outlook", "body": "<p>I'm trying to list out all the subjects of emails in a particular folder. I am getting a <code>Run time Error 13</code> as soon as item not mail item, i.e.appointment, etc. </p>\n\n<p>Follow-up question: </p>\n\n<p>1) How do reply to all to a latest email based the subject and email could be in Inbox or sent items. </p>\n\n<p>2) How to loop in all emails in a folder, i.e. clicking \"Click here to view more on Microsoft edge\" give you access to all old emails. </p>\n\n<pre><code>Sub AccessInbox2()\n\n'Early binding\n\nDim Olook As Outlook.Application ' to access all the libraries of outlook\nDim OmailItem As Outlook.MailItem ' To access emails in the inbox\nDim ONameSpace As Outlook.Namespace ' it is class which opens the gate for you to access all outlook folders. Unlike the Folder class, it exactly tells VBA which folder to use.\nDim Fol As Outlook.Folder ' Where we have emails with attachments stored\nDim Atmt As Outlook.Attachment ' a class which will help us in dealing wiht emails which as attachements\nDim TotalEmails As Long\nDim i As Integer\n\n\nSet Olook = New Outlook.Application\nSet OmailItem = Olook.CreateItem(olMailItem) 'to deal with emails\n\n'messaging application protocal interface\ni = 1\nFor Each OmailItem In Olook.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox).Folders(\"Goldy\").Items\n\n    'If TypeName(OmailItem) = \"MailItem\" Then\n    If OmailItem.Class = 43 Then\n\n    Sheet1.Cells(i, 7).Value = OmailItem.Subject\n\n    End If\n\ni = i + 1\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1549468954, "post_id": 54544925, "comment_id": 95915225, "body": "I recommend to have a look at Regular Expressions (Regex) which is pretty mighty to extract specific data out of raw data: <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1549731147, "post_id": 54568685, "comment_id": 96011760, "body": "@Willie Does this solve your problem? If so, please click on the check mark."}], "tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1549526294, "creation_date": 1549526294, "answer_id": 54568685, "question_id": 54544925, "link": "https://stackoverflow.com/questions/54544925/search-log-file-for-multiple-conditions/54568685#54568685", "title": "Search Log File for Multiple Conditions", "body": "<p>What size Log file? Rows? and Kb/Mb/Gb?</p>\n\n<p>VBA above does Readall, then Split, then Loop/Cells to get it all into Excel</p>\n\n<p>This new procedure Reads each line, and searches for the 5 requested fields, saving them to local variables.  When \"Info:\" is reached it gets the Com10 data, and then writes a new row to the output.  Whenever the Mode_Name or Cond_Id is incorrect, it then bypasses all rows until the next \"%%%\".</p>\n\n<pre><code>Sub doLogFile()\n'    Get filename of input\n    Dim fPathOfInput As String\n    With Application.FileDialog(msoFileDialogFilePicker)\n        If .Show = 0 Then\n            fPathOfInput = \"\"\n        Else\n            fPathOfInput = .SelectedItems(1)\n        End If\n    End With\n    If Right(fPathOfInput, 4) &lt;&gt; \".txt\" _\n    Or fPathOfInput = \"\" Then\n        MsgBox (\"No input txt file selected. fn=\" &amp; fPathOfInput)\n        Exit Sub\n    End If\n\n'    Create new XLS with modified FN, with column heads\n    Dim wbOutput As Workbook, wsOutput As Worksheet, fPathOfOutput As String, nRow As Long\n    Const wsMySheetName As String = \"FoundRows\"\n    Set wbOutput = Workbooks.Add\n    wbOutput.ActiveSheet.Name = wsMySheetName\n    Set wsOutput = wbOutput.ActiveSheet\n    fPathOfOutput = Replace(fPathOfInput, \".txt\", \".xlsx\")\n    wbOutput.SaveAs Filename:=fPathOfOutput\n    nRow = 1\n    wsOutput.Cells(nRow, 1) = \"Cond_Id\"\n    wsOutput.Cells(nRow, 2) = \"Mode_Name\"\n    wsOutput.Cells(nRow, 3) = \"Exec_time\"\n    wsOutput.Cells(nRow, 4) = \"Com10 -Sub_Task\"\n    wsOutput.Cells(nRow, 5) = \"Com10 -Com_Task\"\n    wsOutput.Cells(nRow, 6) = \"LineNumber\"\n\n\n'    Open file, Read Each Row, Process, Close file\n    Dim textLine As String, cntLines As Long\n    cntLines = 0\n    Open fPathOfInput For Input As #1\n    Do Until EOF(1)\n        Line Input #1, textLine\n        cntLines = cntLines + 1\n\n'        Process each Row\n        Dim sLookFor As String\n        Dim posExecTime As Integer, saveExecTime As String\n        Dim saveModeName As String\n        Dim saveCondId As String, rowCondId As Long\n        Dim posCom10 As Integer, posCom11 As Integer, txtCom10 As String, saveSubTask As String, saveComTask As String\n        If Left(textLine, 3) = \"%%%\" Then\n            sLookFor = \"A\"\n            rowCondId = 0\n            saveExecTime = \"\": saveModeName = \"\": saveCondId = \"\": saveSubTask = \"\": saveComTask = \"\"\n        End If\n        If sLookFor &lt;&gt; \"X\" Then\n\n            posExecTime = InStr(textLine, \"Exec_time\")\n            If posExecTime Then\n                saveExecTime = Mid(textLine, posExecTime)\n                GoTo gotoLoop\n            End If\n\n            If Mid(textLine, 1, 10) = \"Mode_Name:\" Then\n                saveModeName = Mid(textLine, 12)\n                'If saveModeName = \"Mode1_xx_ALA\" Then\n                If Left(saveModeName, 6) = \"Mode1_\" And Right(saveModeName, 5) = \"_ALA;\" Then\n                Else\n                    sLookFor = \"X\"\n                End If\n                GoTo gotoLoop\n            End If\n\n            If Mid(textLine, 1, 13) = \"Condition_Id:\" Then\n                saveCondId = Mid(textLine, 15)\n                If saveCondId = \"X-MODE1-999999I;\" Then\n                'If Left(saveCondId, 6) = \"zzzz\" And Right(saveCondId, 4) = \"zzz\" Then\n                    rowCondId = cntLines\n                Else\n                    sLookFor = \"X\"\n                End If\n                GoTo gotoLoop\n            End If\n\n            If Mid(textLine, 1, 5) = \"Info:\" Then\n'                Find Com10\n                posCom10 = InStr(textLine, \"Com10:\")\n                posCom11 = InStr(textLine, \"Com11:\")\n                Dim posSubTask As Integer, posComTask As Integer, posSemi As Integer\n                If posCom10 And posCom11 Then\n                    txtCom10 = Mid(textLine, posCom10 + 7, posCom11 - posCom10 - 7)\n\n                    ' got --  Sub_Task: NNNN; Com_Task: NNNN;;\n                    posSubTask = InStr(txtCom10, \"Sub_Task:\")\n                    posSemi = InStr(txtCom10, \";\")\n                    saveSubTask = Mid(txtCom10, posSubTask + 10, posSemi - posSubTask - 10)\n\n                    posComTask = InStr(posSemi, txtCom10, \"Com_Task:\")\n                    posSemi = InStr(posSemi + 1, txtCom10, \";\")\n                    saveComTask = Mid(txtCom10, posComTask + 10, posSemi - posComTask - 10)\n\n'                    Write Excel row\n                    nRow = nRow + 1\n                    wsOutput.Cells(nRow, 1) = saveCondId\n                    wsOutput.Cells(nRow, 2) = saveModeName\n                    wsOutput.Cells(nRow, 3) = saveExecTime\n                    wsOutput.Cells(nRow, 4) = saveSubTask\n                    wsOutput.Cells(nRow, 5) = saveComTask\n                    wsOutput.Cells(nRow, 6) = rowCondId\n\n\n                End If\n'                Turn off scan\n                sLookFor = \"X\"\n                GoTo gotoLoop\n            End If\n\n\n        End If\n\ngotoLoop:\n    Loop\n    Close #1\n                    nRow = nRow + 1\n                    wsOutput.Cells(nRow, 1) = \"Total Rows in text file\"\n                    wsOutput.Cells(nRow, 6) = cntLines\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10724411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d1510cd5440edede608efb4a05ae601?s=128&d=identicon&r=PG&f=1", "display_name": "Willie", "link": "https://stackoverflow.com/users/10724411/willie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549526294, "creation_date": 1549411728, "last_edit_date": 1549468825, "question_id": 54544925, "link": "https://stackoverflow.com/questions/54544925/search-log-file-for-multiple-conditions", "title": "Search Log File for Multiple Conditions", "body": "<p>Thanks for any help in advance.</p>\n\n<p>I have a large Log File that I need to extract specific information for each block (record).</p>\n\n<p>In the Log File, triple percent signs (%%%) delineate each record block.\nEach record block has several lines of data.  </p>\n\n<p>Some of the information I need to query is on a single line (string) in the log file while other data are embedded in a single line string.  I will include a sample log file so maybe this will be clearer.</p>\n\n<p>I have several conditions that I need to search for each record block.  For example:</p>\n\n<pre><code>    If Cond_Id:  = X-MODE1-999999I \n    And\n    If Mode_Name: = Mode1_xx_ALA\n    Then\n    From the \u201cInfo:\u201d string within that record block \n       I need to Return   \n          the \u201cSub_Task\u201d and \u201cCom_Task\u201d values for \u201cCom10\u201d\n</code></pre>\n\n<p>along with the following:</p>\n\n<pre><code>    Cond_Id\n    Mode_Name\n    Exec_time(xxx)\n    Com10- Sub_Task\n    Com10- Com_Task\n    Some reference to a line number in the record block for \"Cond_Id:\" would be helpful\n</code></pre>\n\n<p>I need these data written to an Excel Sheet with header of the six (6) items above.  There will be many instances produced by each search and I need to write all of them in the excel sheet.</p>\n\n<p>With my limited programming knowledge, I am not sure if it would be best to read the log file into Excel or Load it into an array and do the queries.  These will be rather large Log Files so I am not sure about the overhead and which method would be best.</p>\n\n<p>I really need help with the logic for this task in excel vba.</p>\n\n<p>So for I can read the log file into an array and write it to a excel sheet. Please see below:</p>\n\n<pre><code>    Sub getTextFile()\n\n     Dim strPathFile As String\n     Dim strScriptPath As String\n    'Dim textFileName As String\n\n    'GET FILE &amp; path of Text File\n     strPathFile = strOpenTextFilePath \n     strScriptPath = Left(strPathFile, InStrRev(strPathFile, \"\\\"))\n\n     frmLogFileAnalysis.lblLogFileSRR = strPathFile\n\n     Dim txt As String, Arr, d, r, c, rv(), u, j\n\n    'read in the entire file\n     With CreateObject(\"scripting.filesystemobject\").opentextfile(strPathFile)\n       txt = .readall()\n      .Close\n    End With\n\n      Arr = Split(txt, vbCrLf) 'split lines to an array\n\n        For j = 1 To UBound(Arr)\n            Worksheets(\"LogFile\").Cells(j, 1).Value = Arr(j - 1)\n        Next\n\n  End Sub\n</code></pre>\n\n<p>Log File Example:</p>\n\n<pre><code>%%%\nxxx_xxx.xxx_xxx.Send.xxx_xxx.xxx_xxx\nxxx_xxx.xxx_xxx.Send.xxx_xxx.xxx_xxx\n2019 01 01 01 01 01.12345 xxx\n2019 01 01 01 01 01.12345 xxx\n2019 01 01 01 01 01.12345\nxxx_xxx_xxx\n 1234\nMode1_xx_xxx\nxxx 1\n id: 0; Exec_time(xxx): { 2019 01 01 01 01 01.12345 };\nCategory: XXX_XXX.XXX_MSG.ERROR;\nxxx_xxxxxx_State: TEST;\nMode_Name: Mode1_xx_Txx;\nSource: XXX_XXX.MODEM.XXXX.XXXX;\nCondition_Id: X-MODE1-999999I;\nLink_Id:  9( 9);\nOperation: ;\nMsg_Name: Stat_Table D_Name: Status_1 From_P: W To_Prev: I Value =&gt;  111111111 Limits =&gt; Value =&gt; 111111111\nImp cond: Info Id: 999; Execution_Time(xxx): 2019 01 01 01 01 01.12345; L_Id: 9( 9); Command_String: 00 00 00 00 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 ; ;\n\n\n%%%\nxxx_xxx.xxx_xxx.Send.xxx_xxx.xxx_xxx\n2019 01 01 01 01 01.12347 xxx\n2019 01 01 01 01 01.12347 xxx\n2019 01 01 01 01 01.12347\nxxx_xxx_xxx\n 1234\nMode1_xx_xxx\nxxx 1\n id: 0; Exec_time(xxx): { 2019 01 01 01 01 01.12347 };\nCategory: XXX_XXX.XXX_MSG.ERROR;\nxxx_xxxxxx_State: TEST;\nMode_Name: Mode1_xx_Txx;\nSource: XXX_XXX.MODEM.XXXX.XXXX;\nCondition_Id: X-MODE1-999999P;\nLink_Id:  9( 9);\nOperation: ;\nMsg_Name: Stat_Table D_Name: Status_1 From_P: I To_Prev: P Value =&gt;  111111111 Limits =&gt; Value =&gt; 111111111\nImp cond: Info Id: 999; Execution_Time(xxx): 2019 01 01 01 01 01.12347; L_Id: 9( 9); Command_String: 00 00 00 00 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 ; ;\n\n\n%%%\nxxx_xxx.xxx_xxx.Send.xxx_xxx.xxx_xxx\n2019 01 01 01 01 01.12349 xxx\n2019 01 01 01 01 01.12349 xxx\n2019 01 01 01 01 01.12349\nxxx_xxx_xxx\n 1234\nMode1_xx_xxx\nxxx 1\n id: 0; Exec_time(xxx): { 2019 01 01 01 01 01.12349 };\nCategory: XXX_XXX.XXX_MSG.ERROR;\nxxx_xxxxxx_State: TEST;\nMode_Name: Mode1_xx_Txx;\nSource: XXX_XXX.MODEM.XXXX.XXXX;\nCondition_Id: X-MODE1-999999W;\nLink_Id:  9( 9);\nOperation: ;\nMsg_Name: Stat_Table D_Name: Status_1 From_P: P To_Prev: W Value =&gt;  111111111 Limits =&gt; Value =&gt; 111111111\nImp cond: Info Id: 999; Execution_Time(xxx): 2019 01 01 01 01 01.12349; L_Id: 9( 9); Command_String: 00 00 00 00 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 ; ;\n\n\n%%%\nxxx_xxx.xxx_xxx.Send.xxx_xxx.xxx_xxx\n2019 01 01 01 01 01.12346 xxx\n2019 01 01 01 01 01.12346 xxx\n2019 01 01 01 01 01.12346\nxxx_xxx_xxx\n 1234\nMode1_xx_xxx\nxxx 1\n id: 0; Exec_time(xxx): { 2019 01 01 01 01 01.12346 };\nCategory: XXX_XXX.XXX_MSG.ERROR;\nxxx_xxxxxx_State: TEST;\nMode_Name: Mode1_xx_ALA;\nSource: XXX_XXX.MODEM.XXXX.XXXX;\nCondition_Id: X-MODE1-999999I;\nLink_Id:  9( 9);\nOperation: ;\n\nInfo: Sub_Task_table: { Com1: Sub_Task: TTTT; Com_Task: TTTT; ; Com2: Sub_Task: TTTT; Com_Task: TTTT; ;Com3: Sub_Task: TTTT; Com_Task: TTTT; ;Com4: Sub_Task: TTTT; Com_Task: TTTT; ;Com5: Sub_Task: TTTT; Com_Task: TTTT; ;Com6: Sub_Task: TTTT; Com_Task: TTTT; ;Com7: Sub_Task: TTTT; Com_Task: TTTT; ;Com8: Sub_Task: TTTT; Com_Task: TTTT; ;Com9: Sub_Task: TTTT; Com_Task: TTTT; ;Com10: Sub_Task: TTTT; Com_Task: TTTT; ;Com11: Sub_Task: TTTT; Com_Task: TTTT; ;Com12: Sub_Task: TTTT; Com_Task: TTTT; ;Com13: Sub_Task: TTTT; Com_Task: TTTT; ;Com14: Sub_Task: TTTT; Com_Task: TTTT; ;Com15: Sub_Task: TTTT; Com_Task: TTTT; ;Com16: Sub_Task: TTTT; Com_Task: TTTT; ;Com17: Sub_Task: TTTT; Com_Task: TTTT; ;Com18: Sub_Task: TTTT; Com_Task: TTTT; ;Com19: Sub_Task: TTTT; Com_Task: TTTT; ;Com20: Sub_Task: TTTT; Com_Task: TTTT; ;  }; ;\n\n\n%%%\nxxx_xxx.xxx_xxx.Send.xxx_xxx.xxx_xxx\n2019 01 01 01 01 01.12348 xxx\n2019 01 01 01 01 01.12348 xxx\n2019 01 01 01 01 01.12348\nxxx_xxx_xxx\n 1234\nMode1_xx_xxx\nxxx 1\n id: 0; Exec_time(xxx): { 2019 01 01 01 01 01.12348 };\nCategory: XXX_XXX.XXX_MSG.ERROR;\nxxx_xxxxxx_State: TEST;\nMode_Name: Mode1_xx_ALA;\nSource: XXX_XXX.MODEM.XXXX.XXXX;\nCondition_Id: X-MODE1-999999P;\nLink_Id:  9( 9);\nOperation: ;\n\nInfo: Sub_Task_table: { Com1: Sub_Task: TTTT; Com_Task: TTTT; ; Com2: Sub_Task: TTTT; Com_Task: TTTT; ;Com3: Sub_Task: TTTT; Com_Task: TTTT; ;Com4: Sub_Task: TTTT; Com_Task: TTTT; ;Com5: Sub_Task: TTTT; Com_Task: TTTT; ;Com6: Sub_Task: TTTT; Com_Task: TTTT; ;Com7: Sub_Task: TTTT; Com_Task: TTTT; ;Com8: Sub_Task: TTTT; Com_Task: TTTT; ;Com9: Sub_Task: TTTT; Com_Task: TTTT; ;Com10: Sub_Task: NNNN; Com_Task: NNNN; ;Com11: Sub_Task: TTTT; Com_Task: TTTT; ;Com12: Sub_Task: TTTT; Com_Task: TTTT; ;Com13: Sub_Task: TTTT; Com_Task: TTTT; ;Com14: Sub_Task: TTTT; Com_Task: TTTT; ;Com15: Sub_Task: TTTT; Com_Task: TTTT; ;Com16: Sub_Task: TTTT; Com_Task: TTTT; ;Com17: Sub_Task: TTTT; Com_Task: TTTT; ;Com18: Sub_Task: TTTT; Com_Task: TTTT; ;Com19: Sub_Task: TTTT; Com_Task: TTTT; ;Com20: Sub_Task: TTTT; Com_Task: TTTT; ;  }; ;\n\n\n%%%\nxxx_xxx.xxx_xxx.Send.xxx_xxx.xxx_xxx\n2019 01 01 01 01 01.12350 xxx\n2019 01 01 01 01 01.12350 xxx\n2019 01 01 01 01 01.12350\nxxx_xxx_xxx\n 1234\nMode1_xx_xxx\nxxx 1\n id: 0; Exec_time(xxx): { 2019 01 01 01 01 01.12350 };\nCategory: XXX_XXX.XXX_MSG.ERROR;\nxxx_xxxxxx_State: TEST;\nMode_Name: Mode1_xx_ALA;\nSource: XXX_XXX.MODEM.XXXX.XXXX;\nCondition_Id: X-MODE1-999999W;\nLink_Id:  9( 9);\nOperation: ;\n\nInfo: Sub_Task_table: { Com1: Sub_Task: TTTT; Com_Task: TTTT; ; Com2: Sub_Task: TTTT; Com_Task: TTTT; ;Com3: Sub_Task: TTTT; Com_Task: TTTT; ;Com4: Sub_Task: TTTT; Com_Task: TTTT; ;Com5: Sub_Task: TTTT; Com_Task: TTTT; ;Com6: Sub_Task: TTTT; Com_Task: TTTT; ;Com7: Sub_Task: TTTT; Com_Task: TTTT; ;Com8: Sub_Task: TTTT; Com_Task: TTTT; ;Com9: Sub_Task: TTTT; Com_Task: TTTT; ;Com10: Sub_Task: WWWW; Com_Task: WWWW; ;Com11: Sub_Task: TTTT; Com_Task: TTTT; ;Com12: Sub_Task: TTTT; Com_Task: TTTT; ;Com13: Sub_Task: TTTT; Com_Task: TTTT; ;Com14: Sub_Task: TTTT; Com_Task: TTTT; ;Com15: Sub_Task: TTTT; Com_Task: TTTT; ;Com16: Sub_Task: TTTT; Com_Task: TTTT; ;Com17: Sub_Task: TTTT; Com_Task: TTTT; ;Com18: Sub_Task: TTTT; Com_Task: TTTT; ;Com19: Sub_Task: TTTT; Com_Task: TTTT; ;Com20: Sub_Task: TTTT; Com_Task: TTTT; ;  }; ;\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1549410866, "post_id": 54544802, "comment_id": 95890418, "body": "So are you asking how to find out what <code>filenamepng</code> should <b><i>be</i></b>, or is that defined and given a value elsewhere?"}, {"owner": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1549411333, "post_id": 54544802, "comment_id": 95890514, "body": "Sorry, that is defined and given a value elsewhere. I just need the variable currently labeled <code>i</code> after the name in quotes (i.e. &quot;TEST&quot; and &quot;IDSS&quot;) to start at one for each section."}], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "edited": false, "score": 0, "creation_date": 1549412817, "post_id": 54544874, "comment_id": 95890877, "body": "That does not work. In the first &quot;section&quot; in my presentation (named &quot;Test&quot;) there are three slides with the 3rd one hidden. The second section (named &quot;IDSS&quot;) has 3 slides and they are slides 4, 5, and 6. This codes saves the first 2 slides (not the 3rd since it is hidden) twice. Once as TEST1 and TEST2, the other as IDSS1 and IDSS2. What I want the code to do is save the first 2 slides as TEST1 and TEST2. Then save slides 4-6, which are in the IDSS section, as IDSS1, IDSS2, and IDSS3. Hope that clears it up a bit. Thanks!"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 1, "creation_date": 1549413387, "post_id": 54544874, "comment_id": 95891001, "body": "instead of <code>ActivePresentation.Slides(j).Export filenamepng &amp; &quot;IDSS&quot; &amp; j &amp; &quot;.png&quot;, &quot;PNG&quot;</code> make it <code>sld.Export filenamepng &amp; &quot;IDSS&quot; &amp; j &amp; &quot;.png&quot;, &quot;PNG&quot;</code> and similar for TEST section"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "reply_to_user": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "edited": false, "score": 0, "creation_date": 1549414039, "post_id": 54544874, "comment_id": 95891139, "body": "@hunter21188 you have to be more clear in your question to get a clear answer, I focused on showing you how to make the correct numbers, but now your asking about your conditions, update your question to be able to help. I will adapt my answer based on ahmed AH answer if he understood what you mean"}, {"owner": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1549414164, "post_id": 54544874, "comment_id": 95891159, "body": "@AhmedAU Very close! It correctly saves slides 4 and 5 as IDSS1 and IDSS2, however it is ending the loop after 2 and not making it to slide 6. This has something to do with the fact there are only two unhidden slides in the TEST section. If I unhide that slide it makes it the whole way through."}, {"owner": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "edited": false, "score": 0, "creation_date": 1549414506, "post_id": 54544874, "comment_id": 95891233, "body": "@JustGreat Yes, I did. It is very close, just stopping after the second time through, so it never makes it to slide 6. See my comment above for more info. I also updated my question to hopefully make it more clear."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "reply_to_user": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "edited": false, "score": 0, "creation_date": 1549414614, "post_id": 54544874, "comment_id": 95891254, "body": "@hunter21188 Just saw it, tell me, can you confirm that this code is saving all your visible slides and not saving your hidden one ? is this what you mean ?"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 2, "creation_date": 1549414615, "post_id": 54544874, "comment_id": 95891255, "body": "@ JustGreat  may also  try change <code>ActivePresentation.Slides(j).SlideShowTransition.Hidden</code>  to <code>sld.SlideShowTransition.Hidden</code>"}, {"owner": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1549414646, "post_id": 54544874, "comment_id": 95891261, "body": "@JustGreat @AhmedAU Ah, I had to make both parts of the <code>If</code> statement <code>sld.</code> and that solved it. Thanks so much!"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "reply_to_user": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "edited": false, "score": 0, "creation_date": 1549414683, "post_id": 54544874, "comment_id": 95891271, "body": "@hunter21188 I will correct it right above and please tagg it as resolved."}, {"owner": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "edited": false, "score": 0, "creation_date": 1549414702, "post_id": 54544874, "comment_id": 95891277, "body": "@JustGreat Perfect. Will do. Thanks again!"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "reply_to_user": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "edited": false, "score": 0, "creation_date": 1549415224, "post_id": 54544874, "comment_id": 95891375, "body": "@hunter21188 glad to know that your problem is solved"}], "tags": [], "owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "is_accepted": true, "score": 1, "last_activity_date": 1549414736, "last_edit_date": 1549414736, "creation_date": 1549411360, "answer_id": 54544874, "question_id": 54544802, "link": "https://stackoverflow.com/questions/54544802/vba-loop-within-a-loop-where-the-second-loop-always-starts-at-1/54544874#54544874", "title": "VBA Loop Within a Loop Where the Second Loop Always Starts at 1", "body": "<p>Your question is not really clear, but I think that this is what you need, try it and let me know</p>\n\n<pre><code>    Dim sld As Slide\n\nTestSection = SectionIndexOf(\"Test\") 'Name of a section is in the quotes.\n\nIDSSslides = SectionIndexOf(\"IDSS\")\n\ndim i as integer 'Counter for TEST \ndim j as integer'Counter for IDSS \n\ni = 1 \nj=1\n\nFor Each sld In ActivePresentation.Slides\n\n    If sld.sectionIndex = TestSection And sld.SlideShowTransition.Hidden = msoFalse Then\n        sld.Export filenamepng &amp; \"TEST\" &amp; i &amp; \".png\", \"PNG\"\n        i=i+1\n    ElseIf sld.sectionIndex = IDSSslides And sld.SlideShowTransition.Hidden = msoFalse Then\n        sld.Export filenamepng &amp; \"IDSS\" &amp; j &amp; \".png\", \"PNG\"\n        j=j+1\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 54544874, "answer_count": 1, "score": 0, "last_activity_date": 1549414736, "creation_date": 1549410673, "last_edit_date": 1549414400, "question_id": 54544802, "link": "https://stackoverflow.com/questions/54544802/vba-loop-within-a-loop-where-the-second-loop-always-starts-at-1", "title": "VBA Loop Within a Loop Where the Second Loop Always Starts at 1", "body": "<p>I have the following code below that loops through all slides in a PPT presentation. If the slides fall under one of the sections and are not hidden, it will save them with an appropriate name. I am trying to get the number after the saved name (i.e. TEST#) to always start over at 1 for each section. So if there are five slides within the IDSS section, which starts at slide 5, then they would be saved: IDSS1, IDSS2, etc. The way I have it below just saves it with the current slide number. Thanks for any help you can provide!</p>\n\n<p><strong><em>Edit to Provide More Clearity</em></strong></p>\n\n<p>I have many different slides in this PPT presentation, all of which are located within a particular named section. For this example, assume there are 6 total slides. Slides 1-3 are in the section named \"TEST\" and slide 3 is hidden. Slides 4-6 are in the section \"IDSS\" and none are hidden. I need the code to loop through all the slides, figure out which ones are in the \"TEST\" section and name them \"TEST1\" and \"TEST2\" (the third slide is skipped since it is hidden). Then it moves on to the section \"IDSS\" and saves the slides as \"IDSS1\", IDSS2\", and \"IDSS3\". It's the number after the name I can't get to restart at 1 for each section. Hope this makes it more clear.</p>\n\n<pre><code>Dim sld As Slide\n\nTestSection = SectionIndexOf(\"Test\") 'Name of a section is in the quotes.\n\nIDSSslides = SectionIndexOf(\"IDSS\")\n\ni = 1\nFor Each sld In ActivePresentation.Slides\n\n    If sld.sectionIndex = TestSection And ActivePresentation.Slides(i).SlideShowTransition.Hidden = msoFalse Then\n        ActivePresentation.Slides(i).Export filenamepng &amp; \"TEST\" &amp; i &amp; \".png\", \"PNG\"\n    ElseIf sld.sectionIndex = IDSSslides And ActivePresentation.Slides(i).SlideShowTransition.Hidden = msoFalse Then\n        ActivePresentation.Slides(i).Export filenamepng &amp; \"IDSS\" &amp; i &amp; \".png\", \"PNG\"\n    End If\ni = i + 1\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1549408744, "last_edit_date": 1549408744, "creation_date": 1549408003, "answer_id": 54544389, "question_id": 54544256, "link": "https://stackoverflow.com/questions/54544256/converting-index-match-to-another-sheet-to-vba-code/54544389#54544389", "title": "Converting Index Match to Another Sheet to VBA Code", "body": "<p>Your main issue is these two lines:</p>\n\n<pre><code>    .Cells(8).Font.Color = IIf(IsError(h), RGB(255, 0, 0), h)\n    .Cells(8).Font.Bold = IIf(IsError(h), True, h)\n</code></pre>\n\n<p><code>h</code> returns an error or a value, but you are trying to use it as a RGB Color and a Boolean.  <code>h</code> cannot be all three things at the same time.</p>\n\n<p>Capture the error before and use a standard IF Then</p>\n\n<pre><code>Dim DestinationSheet As Worksheet\nSet DestinationSheet = Worksheets(\"Sheet1\") 'change to your sheet\n\nDim cmmtsSheet As Worksheet\nSet cmmtsSheet = Worksheets(\"Comments\")\n\nDim DestinationRow As Long\nDestinationRow = 3\n\nWith DestinationSheet\n\n    Dim mtchRow As Long\n    On Error Resume Next\n        mtchRow = Application.Match(.Cells(DestinationRow, 3), cmmtsSheet.Range(\"A:A\"), 0)\n    On Error GoTo 0\n\n    With .Cells(DestinationRow, 8)\n        If mtchRow &gt; 0 Then\n            .Value = cmmtsSheet.Cells(mtchRow, 3)\n            .Font.Color = RGB(255, 255, 255)\n            .Font.Bold = False\n        Else\n            .Value = \"Comment Required\"\n            .Font.Color = RGB(255, 0, 0)\n            .Font.Bold = True\n        End If\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10515481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1a32799ba7aae111a53dd508d4e419?s=128&d=identicon&r=PG&f=1", "display_name": "Geni O", "link": "https://stackoverflow.com/users/10515481/geni-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1054, "favorite_count": 0, "accepted_answer_id": 54544389, "answer_count": 1, "score": 0, "last_activity_date": 1549437813, "creation_date": 1549407112, "last_edit_date": 1549437813, "question_id": 54544256, "link": "https://stackoverflow.com/questions/54544256/converting-index-match-to-another-sheet-to-vba-code", "title": "Converting Index Match to Another Sheet to VBA Code", "body": "<p>I am trying to translate an index match formula into VBA code. I would like to do this because the cells that contain the index match formulas will not always have the same row values, so I can't simply place the formulas in specific rows. The formula is currently in column H, so I am trying to have VBA code that will match the values from the other sheet, and populate column H in the correct row based on the index match criteria.</p>\n\n<p>Here is my formula:</p>\n\n<pre><code>=IFERROR(INDEX(Comments!$K$2:$K$76,MATCH(C8,Comments!$B$2:$B$76,0)),\"COMMENT REQUIRED\")\n</code></pre>\n\n<p>I initially tried adapting to be a V-Lookup in VBA code as I was told this would be easier, but I have not been able to do this successfully. The VBA code that I tried is below: </p>\n\n<pre><code>        Dim h\n        With DestinationSheet.Rows(DestinationRow)\n        h = Application.VLookup(.Cells(3).Value, Sheets(\"Comments\").Range(\"$A$2:$C$100\"), 3, False)\n        .Cells(8).Value = IIf(IsError(h), \"COMMENT REQUIRED\", h)\n        .Cells(8).Font.Color = IIf(IsError(h), RGB(255, 0, 0), h)\n        .Cells(8).Font.Bold = IIf(IsError(h), True, h)\n        End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1549404655, "post_id": 54543760, "comment_id": 95888771, "body": "You don&#39;t need the <code>ist</code> part - this would even be more clear: <code>TagName(i) = ActiveWorkbook.Sheets(&quot;Parameters&quot;).Range(&quot;B&quot;&amp;i).Value</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1549406706, "creation_date": 1549406706, "answer_id": 54544184, "question_id": 54543760, "link": "https://stackoverflow.com/questions/54543760/out-of-context-and-selecting-filled-in-values-in-a-column/54544184#54544184", "title": "Out of Context and selecting filled in values in a column", "body": "<p>If you only want cells with values, you should probably have that as part of your loop. I think this should work. I also changed the array to be a variant in case you have a mix of string and numbers.</p>\n\n<pre><code>Sub GenTags()\n\nDim FolderPath As String\nDim OutputFileNum As Integer\nDim TagName(100) As Variant\nDim i As Long, c As Long\nDim ist As String\n\nSheets(\"Parameters\").Activate\n\n\nFor i = 1 To ActiveWorkbook.ActiveSheet.Columns(\"B\").End(xlDown).Row\n    If Not IsEmpty(Range(\"B\" &amp; i)) Then\n        TagName(c) = Range(\"B\" &amp; i).Value\n        c = c + 1\n    End If\n\n\nNext\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1549409921, "creation_date": 1549409921, "answer_id": 54544703, "question_id": 54543760, "link": "https://stackoverflow.com/questions/54543760/out-of-context-and-selecting-filled-in-values-in-a-column/54544703#54544703", "title": "Out of Context and selecting filled in values in a column", "body": "<p>This approach is a little more granular and takes care of empty cells in the column.</p>\n\n<p>It's easy just yo customize the \">>>>\" section</p>\n\n<pre><code>Sub GenTags()\n\nDim FolderPath As String\nDim OutputFileNum As Integer\n\n\nDim ist As String\n\n' Define object variables\nDim sourceSheet As Worksheet\nDim paramSheet As Worksheet\nDim sourceRange As Range\nDim cellEval As Range\n\n' Define other variables\nDim sourceSheetName As String\nDim paramSheetName As String\nDim sourceColumn As String\n\n\nDim tagName() As Variant\nDim counter As Long ' before i\nDim nonBlankCounter As Long\nDim totalCells As Long\n\n\n' &gt;&gt;&gt; Customize to fit your needs\nsourceSheetName = \"Sheet1\"\nparamSheetName = \"Parameters\"\nsourceColumn = \"B\"\n\n' Initialize objects - Change sheets names\nSet sourceSheet = ThisWorkbook.Worksheets(sourceSheetName)\nSet paramSheet = ThisWorkbook.Worksheets(paramSheetName)\nSet sourceRange = Application.Union(sourceSheet.Columns(sourceColumn).SpecialCells(xlCellTypeConstants), sourceSheet.Columns(sourceColumn).SpecialCells(xlCellTypeFormulas))\n\n' Get how many items in column b are\ntotalCells = sourceRange.Cells.Count\n\n' Redimension the array to include all the items\nReDim tagName(totalCells)\n\n' Initilize the counter (for documentation sake)\ncounter = 0\n\nFor Each cellEval In sourceRange\n\n    ' Add non empty values\n    If Trim(cellEval.Value) &lt;&gt; vbNullString Then\n\n        ' Store it in the array\n        tagName(counter) = cellEval.Value\n\n        counter = counter + 1\n\n    End If\n\nNext cellEval\n\n' Redim to leave only used items\nReDim Preserve tagName(counter - 1)\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if it helps!</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10902274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2812dbfd1bfd8c4494229ca8f67a9fac?s=128&d=identicon&r=PG&f=1", "display_name": "JParsons03", "link": "https://stackoverflow.com/users/10902274/jparsons03"}, "is_accepted": false, "score": 0, "last_activity_date": 1550690364, "creation_date": 1550690364, "answer_id": 54793777, "question_id": 54543760, "link": "https://stackoverflow.com/questions/54543760/out-of-context-and-selecting-filled-in-values-in-a-column/54793777#54793777", "title": "Out of Context and selecting filled in values in a column", "body": "<p>Thank you for your responses. Unfortunatley I had to put this project on the back burner until yesterday but I did try both answers and they didn't work. I decided to go a different direction with the entire code and got it working. Thank you for your help and sorry for the late response.</p>\n"}], "owner": {"reputation": 11, "user_id": 10902274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2812dbfd1bfd8c4494229ca8f67a9fac?s=128&d=identicon&r=PG&f=1", "display_name": "JParsons03", "link": "https://stackoverflow.com/users/10902274/jparsons03"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1550690364, "creation_date": 1549404248, "last_edit_date": 1549404996, "question_id": 54543760, "link": "https://stackoverflow.com/questions/54543760/out-of-context-and-selecting-filled-in-values-in-a-column", "title": "Out of Context and selecting filled in values in a column", "body": "<p>I am having 2 issues that I've been trying to solve all day. First off whenever I try to watch any variable no matter what it says  in the watches bar. I tried even just setting a variable to equal a number and watching it and it still gave me .</p>\n\n<p>Second I am trying to put all of the values in column B that have a value into an array (TagName) and it is driving me up a wall. This is the point of the for loop. The out of context thing is not helping the case.</p>\n\n<p>Just for reference \"ist\" was i as a string but then I added the B just to shorten the code. </p>\n\n<p>Don't worry about the extra dims those are for code that is already working </p>\n\n<p>Thank you for your help!</p>\n\n<pre><code>Sub GenTags()\n\nDim FolderPath As String\nDim OutputFileNum As Integer\nDim TagName(100) As String\nDim i As Long\nDim ist As String\n\nSheets(\"Parameters\").Activate\n\n\nFor i = 1 To ActiveWorkbook.ActiveSheet.Columns(\"B\").End(xlDown).Row\n  ist = \"B\" &amp; CStr(i)\n  TagName(i) = ActiveWorkbook.Sheets(\"Parameters\").Range(ist)\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 188041, "user_id": 10676716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/arsQA.jpg?s=128&g=1", "display_name": "GMB", "link": "https://stackoverflow.com/users/10676716/gmb"}, "edited": false, "score": 1, "creation_date": 1549405287, "post_id": 54543598, "comment_id": 95888964, "body": "I think that ms-access does not support recursive queries. If you have a limited number of hierarchy levels, you could imagine implement this with a series of joins..."}, {"owner": {"reputation": 1323, "user_id": 6826479, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kFsmmJsA9cU/AAAAAAAAAAI/AAAAAAAAAkQ/fgsvbyNstTE/photo.jpg?sz=128", "display_name": "Jaime Drq", "link": "https://stackoverflow.com/users/6826479/jaime-drq"}, "edited": false, "score": 1, "creation_date": 1549406892, "post_id": 54543598, "comment_id": 95889412, "body": "You can manage it using vba, using a loop or a recursive function, that queries the table for your <code>PersonId</code>, looks for the <code>Supervisor</code>, execute the same query for the <code>PersonId</code> of the <code>Supervisor</code>..., creating an array with the results gotten, exiting the loop when the query returns nothing."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10303246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bNDv82nmhDk/AAAAAAAAAAI/AAAAAAAANqM/hKmwaCjtBZw/photo.jpg?sz=128", "display_name": "Josh Johner", "link": "https://stackoverflow.com/users/10303246/josh-johner"}, "edited": false, "score": 0, "creation_date": 1549534180, "post_id": 54545043, "comment_id": 95939412, "body": "I think I&#39;m understanding this correctly. But visualizing this sql statement (if I&#39;m understanding it correctly) is almost impossible as it creates a new union for each subordinate. So if I had 10 managers, each with 3 supervisors then my statement would have 30 unions? What is the performance implications of this method. Have you ever had it cause issues?"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 23, "user_id": 10303246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bNDv82nmhDk/AAAAAAAAAAI/AAAAAAAANqM/hKmwaCjtBZw/photo.jpg?sz=128", "display_name": "Josh Johner", "link": "https://stackoverflow.com/users/10303246/josh-johner"}, "edited": false, "score": 0, "creation_date": 1549568937, "post_id": 54545043, "comment_id": 95959406, "body": "@JoshJohner It doesn&#39;t create a <code>union</code> for each subordinate, but rather a <code>union</code> for each <b>level</b> of the hierarchy - as such, the complexity and performance of the query is dependent on the number of levels in your management structure."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 0, "last_activity_date": 1549412556, "creation_date": 1549412556, "answer_id": 54545043, "question_id": 54543598, "link": "https://stackoverflow.com/questions/54543598/ms-access-sql-self-join-with-multiple-levels/54545043#54545043", "title": "MS-Access SQL Self Join with multiple levels", "body": "<p>Consider the following set of functions:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function BuildQuerySQL(lngsid As Long) As String\n    Dim intlvl As Integer\n    Dim strsel As String: strsel = selsql(intlvl)\n    Dim strfrm As String: strfrm = \"people as p0 \"\n    Dim strwhr As String: strwhr = \"where p0.supervisor = \" &amp; lngsid\n\n    While HasRecordsP(strsel &amp; strfrm &amp; strwhr)\n        intlvl = intlvl + 1\n        BuildQuerySQL = BuildQuerySQL &amp; \" union \" &amp; strsel &amp; strfrm &amp; strwhr\n        strsel = selsql(intlvl)\n        If intlvl &gt; 1 Then\n            strfrm = \"(\" &amp; strfrm &amp; \")\" &amp; frmsql(intlvl)\n        Else\n            strfrm = strfrm &amp; frmsql(intlvl)\n        End If\n    Wend\n    BuildQuerySQL = Mid(BuildQuerySQL, 8)\nEnd Function\n\nFunction HasRecordsP(strSQL As String) As Boolean\n    Dim dbs As DAO.Database\n    Set dbs = CurrentDb\n    With dbs.OpenRecordset(strSQL)\n        HasRecordsP = Not .EOF\n        .Close\n    End With\n    Set dbs = Nothing\nEnd Function\n\nFunction selsql(intlvl As Integer) As String\n    selsql = \"select p\" &amp; intlvl &amp; \".personid from \"\nEnd Function\n\nFunction frmsql(intlvl As Integer) As String\n    frmsql = \" inner join people as p\" &amp; intlvl &amp; \" on p\" &amp; intlvl - 1 &amp; \".personid = p\" &amp; intlvl &amp; \".supervisor \"\nEnd Function\n</code></pre>\n\n<p>Here, the <code>BuildQuerySQL</code> function may be supplied with the <code>PersonID</code> corresponding to a <code>Supervisor</code> and the function will return 'recursive' SQL code for an appropriate query to obtain the <code>PersonID</code> for all subordinates of the supervisor.</p>\n\n<p>Such function may therefore be evaluated to construct a saved query, e.g. for a supervisor with <code>PersonID = 5</code>, creating a query called <code>Subordinates</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub test()\n    CurrentDb.CreateQueryDef \"Subordinates\", BuildQuerySQL(5)\nEnd Sub\n</code></pre>\n\n<p>Or the SQL may be evaluated to open a RecordSet of the results perhaps, depending on the requirements of your application.</p>\n\n<p>Note that the function constructs a <code>UNION</code> query, with each level of nesting unioned with the previous query.</p>\n"}, {"comments": [{"owner": {"reputation": 17197, "user_id": 1388192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3466b95b663c5d5470fbc587d5372a34?s=128&d=identicon&r=PG", "display_name": "Erwin Smout", "link": "https://stackoverflow.com/users/1388192/erwin-smout"}, "edited": false, "score": 0, "creation_date": 1549447510, "post_id": 54545454, "comment_id": 95901856, "body": "&quot;but we probably want to keep this standard SQL&quot;  The SQL standard has WITH RECURSIVE for such problems."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 17197, "user_id": 1388192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3466b95b663c5d5470fbc587d5372a34?s=128&d=identicon&r=PG", "display_name": "Erwin Smout", "link": "https://stackoverflow.com/users/1388192/erwin-smout"}, "edited": false, "score": 0, "creation_date": 1549451883, "post_id": 54545454, "comment_id": 95904527, "body": "Great! Unfortunately, Access SQL does not implement this. I&#39;m not sure whether other vendors implements that, either. For example, <a href=\"https://docs.microsoft.com/en-us/sql/t-sql/queries/with-common-table-expression-transact-sql?view=sql-server-2017\" rel=\"nofollow noreferrer\">SQL Server allows recursive CTEs but not using the standard syntax</a>. <a href=\"https://en.wikipedia.org/wiki/Hierarchical_and_recursive_queries_in_SQL\" rel=\"nofollow noreferrer\">Thus, the compliance for this feature seems questionable</a>. Furthermore, even if this was SQL Server, <a href=\"http://www.sqlservercentral.com/articles/T-SQL/2926/\" rel=\"nofollow noreferrer\">there can be performance issues</a>."}, {"owner": {"reputation": 17197, "user_id": 1388192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3466b95b663c5d5470fbc587d5372a34?s=128&d=identicon&r=PG", "display_name": "Erwin Smout", "link": "https://stackoverflow.com/users/1388192/erwin-smout"}, "edited": false, "score": 0, "creation_date": 1549452682, "post_id": 54545454, "comment_id": 95904995, "body": "Yes.  Oracle does not even <b><i>want</i></b> to introduce the feature because they already had a solution (CONNECT BY) before the feature was introduced into the standard.  I only intended to point out that &quot;probably want to keep this standard&quot; is a bit of a poor argument."}, {"owner": {"reputation": 17197, "user_id": 1388192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3466b95b663c5d5470fbc587d5372a34?s=128&d=identicon&r=PG", "display_name": "Erwin Smout", "link": "https://stackoverflow.com/users/1388192/erwin-smout"}, "edited": false, "score": 0, "creation_date": 1549452823, "post_id": 54545454, "comment_id": 95905092, "body": "Also want to note that &quot;It is literally impossible to create a nonsensical hierarchy with it [adjacency list]&quot; is a very far stretch.  The structure per se does not prohibit &quot;hierarchies&quot; that are in fact cyclical graphs (and therefore not hierarchies at all) and preventing that is nowhere near trivial."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 17197, "user_id": 1388192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3466b95b663c5d5470fbc587d5372a34?s=128&d=identicon&r=PG", "display_name": "Erwin Smout", "link": "https://stackoverflow.com/users/1388192/erwin-smout"}, "edited": false, "score": 0, "creation_date": 1549453017, "post_id": 54545454, "comment_id": 95905232, "body": "Right - the &quot;standard&quot; part is simply that those 3 models can be setup to work on any other RDBMS, not just Access. The hard part is the implementation of the automatic management since that implies using triggers + stored procedures, which invariably becomes vendor-specific. I look at the model as basically creating an index to boost your query performance, albeit in much more manual manner."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 17197, "user_id": 1388192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3466b95b663c5d5470fbc587d5372a34?s=128&d=identicon&r=PG", "display_name": "Erwin Smout", "link": "https://stackoverflow.com/users/1388192/erwin-smout"}, "edited": false, "score": 0, "creation_date": 1549453203, "post_id": 54545454, "comment_id": 95905334, "body": "RE: the consistency comment - no, I was not referring to the cyclical graph which is allowed as indicated in the footnote. My definition is much more narrower - for any given inputs, you will be able to build a hierarchy with adjacency list. You can&#39;t have that with nested sets model (for example) because the left/right values must be a specific value. Failing to provide the correct values will mean the queries will start returning nonsensical results. Updated the footnote which hopefully makes that clearer."}, {"owner": {"reputation": 17197, "user_id": 1388192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3466b95b663c5d5470fbc587d5372a34?s=128&d=identicon&r=PG", "display_name": "Erwin Smout", "link": "https://stackoverflow.com/users/1388192/erwin-smout"}, "edited": false, "score": 0, "creation_date": 1549453814, "post_id": 54545454, "comment_id": 95905693, "body": "Cyclical graphs, if you don&#39;t prevent them, make computation of materialized paths nonterminating [unless it&#39;s explicitly countered in the computation itself of course].  As I&#39;m sure you know."}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": false, "score": 3, "last_activity_date": 1549465375, "last_edit_date": 1549465375, "creation_date": 1549416362, "answer_id": 54545454, "question_id": 54543598, "link": "https://stackoverflow.com/questions/54543598/ms-access-sql-self-join-with-multiple-levels/54545454#54545454", "title": "MS-Access SQL Self Join with multiple levels", "body": "<p>SQL is great for many things, but hierarchical data is one of bigger challenges. Some vendors has provided custom extensions to work around this (e.g. Oracle's <code>CONNECT</code> syntax or SQL Server's <code>hierarchyid</code> data type), but we probably want to keep this standard SQL<sup>1</sup>. </p>\n\n<p>What you have modeled is called \"adjacency list\" -- this is very simple and straightforward, and always consistent<sup>2</sup>. But as you found out, this sucks for querying, especially for an unknown depth or for a subtree, rather than from the root node.</p>\n\n<p>Therefore, we need to supplement this with an additional model. There are basically 3 other models that you should use in conjunction with the adjacency list model.</p>\n\n<ul>\n<li>Nested sets</li>\n<li>Materialized Path</li>\n<li>Ancestry traversal closure</li>\n</ul>\n\n<p>To study them in depth, we'll use this diagram:\n<a href=\"https://i.stack.imgur.com/bg3wE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bg3wE.png\" alt=\"Employee chart\"></a></p>\n\n<p>For this discussion, we are also assuming this is a simple hierarchy, that there are no cycles.</p>\n\n<p><strong><em>Joe Celko's Nested Sets.</em></strong></p>\n\n<p>Basically, you store the \"Left\" and \"Right\" value of each node which indicates its position in the tree. The root node will always have <code>1</code> for \"Left\" and <code>&lt;count of nodes * 2&gt;</code> for \"Right\". This is easier to illustrate with a diagram:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gBlen.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gBlen.png\" alt=\"Nested Sets\"></a></p>\n\n<p>Note that each node gets assigned a pair of number, one for \"Left\", and other for \"Right\". With that information, you can do some logical deductions. Finding all children becomes easy - you filter for values where the nodes' \"Left\" is greater than the target node's \"Left\" and where the same nodes' \"Right\" is smaller than the target node's \"Right\". </p>\n\n<p>The biggest downside with the model is that a change to the hierarchy almost invariably requires updating the entire tree, which makes it very awful to maintain for a fast moving charts. If this is something you only update once a year, this might be acceptable.</p>\n\n<p>The other issue with this model is that if there is a need for a multiple hierarchies, the nested set will not work without additional columns to track the separate hierarchy. </p>\n\n<p><strong><em>Materialized Path</em></strong></p>\n\n<p>You know how a filesystem path works, right? This is basically the same thing, except that we are storing this in the database<sup>3</sup>. For instance, a possible implementation of a materialized path might look like this:</p>\n\n<pre><code>ID  Name      Path\n1   Alice     1/\n2   Bob       1/2/\n3   Christina 1/3/\n4   Dwayne    1/4/\n5   Erin      1/2/5/\n6   Frank     1/2/6/\n7   Georgia   1/2/7/\n8   Harry     1/2/7/8/\n9   Isabella  1/3/9/\n10  Jake      1/3/10/\n11  Kirby     1/3/10/11/\n12  Lana      1/3/12/\n13  Mike      1/4/13/\n14  Norma     1/4/13/14/\n15  Opus      1/4/15/\n16  Rianna    1/4/16/\n</code></pre>\n\n<p>This is quite intuitive and can perform OK as long you write your SQL queries to use predicates like <code>WHERE Path LIKE '1/4/*'</code>. Engines will be able to use index on the path column. Note that if your queries involve querying a middle of the tree or from bottom up, that means index cannot be used and performance will suffer for it. But programming against a materialized path is pretty easy to understand. Updating a part of the tree won't propagate to unrelated nodes as the nested sets so that's also a plus in its favor.</p>\n\n<p>The biggest downside is that to be indexable, the text has to be a short column. For Access database that puts a 255 character limit on your path field. Even worse, there is no good way to predict when you are about to hit the limit -- you could hit it because you have too deep tree, or because you have too wide tree (e.g. bigger numbers taking up too much spaces). For that reason, large trees might necessitate some hard-coded limit to avoid this situation. </p>\n\n<p><strong><em>Ancestry Traversal Closure</em></strong></p>\n\n<p>This model involves a separate table which is updated whenever the employee table is updated. Instead of only recording the immediate relationship, we enumerate all the ancestry between two nodes. To illustrate, this is how the table will look like:</p>\n\n<p>Employee table:</p>\n\n<pre><code>ID  Name\n1   Alice\n2   Bob\n3   Christina\n4   Dwayne\n5   Erin\n6   Frank\n7   Georgia\n8   Harry\n9   Isabella\n10  Jake\n11  Kirby\n12  Lana\n13  Mike\n14  Norma\n15  Opus\n16  Rianna\n</code></pre>\n\n<p>Employee Ancestry Table:</p>\n\n<pre><code>Origin  Ancestor\n1        1\n2        1\n2        2\n3        1\n3        3\n4        1\n4        4\n5        1\n5        2\n5        5\n6        1\n6        2\n6        6\n7        1\n7        2\n7        7\n8        1\n8        2\n8        7\n8        8\n9        1\n9        3\n9        9\n10       1\n10       3\n10       10\n11       1\n11       3\n11       10\n11       11\n12       1\n12       3\n12       12\n13       1\n13       4\n14       1\n14       4\n14       13\n14       14\n15       1\n15       4\n15       15\n16       1\n16       4\n16       16\n</code></pre>\n\n<p>As you see, we generate several rows worth of all possible relationship between two nodes. As a bonus because it's a table, we can make use of foreign key and cascade delete to help keep it consistent. We still have to manually manage the inserts &amp; updates however. Because the table is also narrow, it makes it very easy to create query that can leverage index on the key, the origin and the ancestor to find the subtree, the children, the parent. This is the most flexible system at expense of extra complexity around the maintenance. </p>\n\n<p><strong><em>Maintaining the model</em></strong></p>\n\n<p>All 3 models discussed are basically denormalizing the data a bit in order to simplify the query and support an arbitrary depth search. A consequence of that is this necessitates us to manually manage the changes when the employee table is modified in some fashion.</p>\n\n<p>The most simplest approach is simply to just write a VBA procedure that will truncate and re-build the entire chart using your preferred model. This can work very well when the chart is small or does not change often. </p>\n\n<p>On the other end, you could consider using <em>Data Macros</em> on your employee table to perform the maintenance required to propagate the updates to the hierarchy. A caveat, though, if you use data macros, this makes it harder to port the data to another RDBMS system since none of those support data macros. (To be fair, the problem would still exist if you were porting from SQL Server's stored procedures/triggers to Oracle's stored procedure/triggers - those are very steeped in vendor's dialect that porting is a challenge). Using <em>data macros</em> or trigger + stored procedure mean that you can rely on the engine to maintain the hierarchy for you without any programming in the forms. </p>\n\n<p>A common temptation is to use form's <code>AfterUpdate</code> event to maintain the changes and that would work.... unless someone update it outside the form. For that reason, I would actually prefer that we used a data macro rather than relying on everyone to always use the form. </p>\n\n<p>Note that in all of this discussion, we should <strong>NOT</strong> discard the adjacency list model. As I commented earlier, this is the most normalized and consistent way to model the hierarchy. It is literally impossible to create a nonsensical hierarchy with it. For that reason alone, you should keep it as your \"authoritative truth\", which you can then build your model upon to aid the querying performance. </p>\n\n<p>Another good reason to keep using the adjacency list model is regardless of which model you use above, they introduce either additional columns or additional tables that are not meant to be directly edited by users but are for purpose somewhat equivalent to a calculated field and thus should not be tinkered with. If the users are allowed to edit only the <code>SupervisorID</code> field, then it becomes easy to code your data macros/triggers/VBA procedure around that one field, and updating the \"calculations\" of the additional fields/table to ensure correctness for the queries depending on such models. </p>\n\n<hr/>\n\n<p><sup>1. SQL Standard does describe a way to create a recursive query. However, the compliance for that particular feature seems to be poor. Furthermore, the performance may not be that great. (which is the case with SQL Server's particular implementation) The 3 models discussed are easily implemented in most of RDBMS and queries for querying the hierarchy can be easily written and ported. However, the implementation to automatically manage the changes to the hierarchy invariably requires vendor-specific dialect, using triggers or stored procedure which is not very portable.</sup></p>\n\n<p><sup>2. When I say consistent, I only mean that the model cannot create a nonsensical output. It's still possible to provide wrong data and make a weird hierarchy such as an employee's supervisor reporting to the employee, but not one that would give undefined results. However, it still is a hierarchy (even if it ends up as a cyclical graph). With other models, failing to maintain the derived data correctly means the queries will start returning undefined results.</sup></p>\n\n<p><sup>3. SQL Server's <code>hierarchyid</code> data type is in fact an implementation of this model.</sup></p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10303246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bNDv82nmhDk/AAAAAAAAAAI/AAAAAAAANqM/hKmwaCjtBZw/photo.jpg?sz=128", "display_name": "Josh Johner", "link": "https://stackoverflow.com/users/10303246/josh-johner"}, "edited": false, "score": 0, "creation_date": 1549533099, "post_id": 54549270, "comment_id": 95938761, "body": "My apologies. I did not mention that this was to set a recordsource for a form."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 23, "user_id": 10303246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bNDv82nmhDk/AAAAAAAAAAI/AAAAAAAANqM/hKmwaCjtBZw/photo.jpg?sz=128", "display_name": "Josh Johner", "link": "https://stackoverflow.com/users/10303246/josh-johner"}, "edited": false, "score": 0, "creation_date": 1549534508, "post_id": 54549270, "comment_id": 95939620, "body": "No problem. That&#39;s what the queries are for."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1549441485, "creation_date": 1549441485, "answer_id": 54549270, "question_id": 54543598, "link": "https://stackoverflow.com/questions/54543598/ms-access-sql-self-join-with-multiple-levels/54549270#54549270", "title": "MS-Access SQL Self Join with multiple levels", "body": "<p>As you probably will have a rather <strong>limited</strong> count, say six, of levels deep, you can use a <em>query with subqueries with subqueries</em> ... etc. Very simple.</p>\n\n<p>For an <strong>unlimited</strong> number of levels, the fastest way I've found, is to create a lookup function which walks the tree for each record. This can output either the level of the record or a compound key build by the key of the record and all keys above.</p>\n\n<p>As the lookup function will use the same recordset for every call, you can make it static, and (for JET) you can improve further by using <em>Seek</em> to locate the records.</p>\n\n<p>Here's an example which will give you an idea:</p>\n\n<pre><code>Public Function RecursiveLookup(ByVal lngID As Long) As String\n\n  Static dbs      As Database\n  Static tbl      As TableDef\n  Static rst      As Recordset\n\n  Dim lngLevel    As Long\n  Dim strAccount  As String\n\n  If dbs Is Nothing Then\n    ' For testing only.\n    ' Replace with OpenDatabase of backend database file.\n    Set dbs = CurrentDb()\n    Set tbl = dbs.TableDefs(\"tblAccount\")\n    Set rst = dbs.OpenRecordset(tbl.Name, dbOpenTable)\n  End If\n\n  With rst\n    .Index = \"PrimaryKey\"\n    While lngID &gt; 0\n      .Seek \"=\", lngID\n      If Not .NoMatch Then\n        lngLevel = lngLevel + 1\n        lngID = !MasterAccountFK.Value\n        If lngID &gt; 0 Then\n          strAccount = str(!AccountID) &amp; strAccount\n        End If\n      Else\n        lngID = 0\n      End If\n    Wend\n    ' Leave recordset open.\n    ' .Close\n  End With\n\n'  Don't terminate static objects.\n'  Set rst = Nothing\n'  Set tbl = Nothing\n'  Set dbs = Nothing\n\n'  Alternative expression for returning the level.\n'  (Adjust vartype of return value of function.) '  RecursiveLookup = lngLevel ' As Long\n  RecursiveLookup = strAccount\n\nEnd Function\n</code></pre>\n\n<p>This assumes a table with a primary key ID and a foreign (master) key pointing to the parent record - and a top level record (not used) with a visible key (AccountID) of 0.</p>\n\n<p>Now your tree will be nicely shown almost instantaneously using a query like this where Account will be the visible compound key:</p>\n\n<pre><code>  SELECT\n    *, RecursiveLookup([ID]) AS Account\n  FROM\n    tblAccount\n  WHERE\n    (AccountID &gt; 0)\n  ORDER BY\n    RecursiveLookup([ID]);\n</code></pre>\n\n<p>If you wish to use this to add records to another table, you should not make an SQL call for each, as this is very slow, but first open a recordset, then use <em>AddNew-Update</em> to append each record and, finally, close this recordset.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10303246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bNDv82nmhDk/AAAAAAAAAAI/AAAAAAAANqM/hKmwaCjtBZw/photo.jpg?sz=128", "display_name": "Josh Johner", "link": "https://stackoverflow.com/users/10303246/josh-johner"}, "edited": false, "score": 0, "creation_date": 1549534315, "post_id": 54564651, "comment_id": 95939504, "body": "After putting this to use, I realized that this does not get me the third level down from the supervisor (user). I am going to use some of the techniques presented by Lee Mac to union queries to get me to where i need to be."}], "tags": [], "owner": {"reputation": 23, "user_id": 10303246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bNDv82nmhDk/AAAAAAAAAAI/AAAAAAAANqM/hKmwaCjtBZw/photo.jpg?sz=128", "display_name": "Josh Johner", "link": "https://stackoverflow.com/users/10303246/josh-johner"}, "is_accepted": false, "score": 0, "last_activity_date": 1549499318, "creation_date": 1549499318, "answer_id": 54564651, "question_id": 54543598, "link": "https://stackoverflow.com/questions/54543598/ms-access-sql-self-join-with-multiple-levels/54564651#54564651", "title": "MS-Access SQL Self Join with multiple levels", "body": "<p>After considering the options presented here I have decided that I am going about this the wrong way. I have added a field to the \"People\" table \"PermissionsLevel\" which is a lookup from another table with a simple \"PermissionNumber\" and \"PermissionDescription\". I then use a select case in the Form_load() event for the logged in user's permission level. </p>\n\n<pre><code>Select Case userPermissionLevel\n\n    Case Creator\n        'Queries everyone in the database\n\n    Case Administrator    \n        'Queries everyone in the \"Department\" they are a member of\n\n    Case Supervisor\n        'Queries all people WHERE supervisor = userID OR _\n            supervisor IN (Select PersonID From People WHERE supervisor = userID)\n\n    Case Custodian '(Person in charge of maintaining the HAZMAT Cabinet and SDS)\n        'Queries WHERE supervisor = DLookup(\"Supervisor\", \"People\", \"PersonID = \" &amp; userID)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10303246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bNDv82nmhDk/AAAAAAAAAAI/AAAAAAAANqM/hKmwaCjtBZw/photo.jpg?sz=128", "display_name": "Josh Johner", "link": "https://stackoverflow.com/users/10303246/josh-johner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 1, "accepted_answer_id": 54545043, "answer_count": 4, "score": 2, "last_activity_date": 1549499318, "creation_date": 1549403447, "question_id": 54543598, "link": "https://stackoverflow.com/questions/54543598/ms-access-sql-self-join-with-multiple-levels", "title": "MS-Access SQL Self Join with multiple levels", "body": "<p>I have a table \"People\" with a primary key \"PersonID\" and a field that is \"Supervisor\". The \"Supervisor\" field contains the foreign key of a \"PersonID\" to create a self join. </p>\n\n<p>I would like to create an sql query that returns all people with \"Me\" (the PersonID that is logged into the database) as their supervisor, and anyone that has someone on that list labeled as their supervisor. Essentially I would like to list anyone below the supplied PersonID in the chain of command. </p>\n"}, {"tags": ["vba", "forms", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 1, "creation_date": 1549406552, "post_id": 54543314, "comment_id": 95889320, "body": "Hi! This is a vague question, and I am afraid any answers you get will mostly be guesses. Here is a starter question: How are you modeling the location/aisle/rack data in your table structure? The answer to this will drive the design of the forms and the rest of the application."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1549476514, "post_id": 54543314, "comment_id": 95919214, "body": "OK, your table structure looks good. You can easily base a form off of each of these tables. Now, onto your code sample. I am assuming this code is in the Aisle form. Why are you looping through the controls? Why don&#39;t you just do an <code>.AddNew</code> on the Upright form&#39;s recordset?"}, {"owner": {"reputation": 11, "user_id": 2383286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c6c9466e9a2afdf88e99a636bfc987?s=128&d=identicon&r=PG&f=1", "display_name": "Baioni", "link": "https://stackoverflow.com/users/2383286/baioni"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1549486124, "post_id": 54543314, "comment_id": 95923495, "body": "I guess I didn&#39;t think that would work since there is no group or anything dividing them like in vb and group controls"}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1549493997, "post_id": 54543314, "comment_id": 95926593, "body": "Access doesn&#39;t have grouping for forms (only reports). If you have relationships defined between your tables, you should look into SubDatasheets. You can probably do most of what you want using just them, with little or no code."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1549494055, "post_id": 54543314, "comment_id": 95926615, "body": "See reference: <a href=\"https://support.office.com/en-us/article/add-a-subdatasheet-900d1d30-5ea2-4e47-80a7-ddcb87a53d14\" rel=\"nofollow noreferrer\">Adding a Subdatasheet</a>"}, {"owner": {"reputation": 11, "user_id": 2383286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c6c9466e9a2afdf88e99a636bfc987?s=128&d=identicon&r=PG&f=1", "display_name": "Baioni", "link": "https://stackoverflow.com/users/2383286/baioni"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1549550631, "post_id": 54543314, "comment_id": 95949277, "body": "The tables are all set up with subdata sheets already.  I am trying to create a form similar because there are various people using this program.  Each location typically has 150 Aisles and each aisle has about 74 Uprights and each upright can have between 5-10 beams.  So you can see how this would get very difficult if they just worked with the tables."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1549562363, "post_id": 54543314, "comment_id": 95956284, "body": "I&#39;m sorry, I didn&#39;t look at my reference closely enough. I didn&#39;t expect Microsoft to give such bad advice. To clarify, I <i>don&#39;t</i> recommend setting up subdatasheets for tables. Tables should just hold data. I <i>do</i> recommend setting up forms in datasheet view, and setting up subforms that are also in datasheet view, so you can create proper subdatasheets at the form level. You can then use combo boxes to set TempVars to limit the forms to a particular location in the underlying query. TempVars can also be used to automatically fill in defaults for hidden foriegn key fields. Hope this helps"}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1549562655, "post_id": 54543314, "comment_id": 95956422, "body": "<i>Better</i> reference: <a href=\"https://bytes.com/topic/access/answers/204346-subdatasheets-how-use-subform\" rel=\"nofollow noreferrer\">Subdatasheets - How to use in subform?</a>"}, {"owner": {"reputation": 11, "user_id": 2383286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c6c9466e9a2afdf88e99a636bfc987?s=128&d=identicon&r=PG&f=1", "display_name": "Baioni", "link": "https://stackoverflow.com/users/2383286/baioni"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1549567667, "post_id": 54543314, "comment_id": 95958847, "body": "kismert when you say recordset are you referring to using ADO for setting the recordset?  Currently, I have 2 types of forms set up in Access.  1 form is a single form with all the table fields on it.  The second one has one main form than a subform inside a subform inside a subform."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1549571427, "post_id": 54543314, "comment_id": 95960528, "body": "I almost always use plain old DAO recordsets, except on those rare occasions when ADO does something that DAO can&#39;t. Your form setup sounds good. As long as it works, and your users understand how to use it, I think you&#39;re good to go."}, {"owner": {"reputation": 11, "user_id": 2383286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c6c9466e9a2afdf88e99a636bfc987?s=128&d=identicon&r=PG&f=1", "display_name": "Baioni", "link": "https://stackoverflow.com/users/2383286/baioni"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1551116655, "post_id": 54543314, "comment_id": 96514006, "body": "Thanks for the help. I was able to get the rows to clean.  Not the way I was hoping but it works for right now.  I had to resort to VB to create the groups and data forms."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1551117004, "post_id": 54543314, "comment_id": 96514182, "body": "Glad you got it to work"}], "owner": {"reputation": 11, "user_id": 2383286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c6c9466e9a2afdf88e99a636bfc987?s=128&d=identicon&r=PG&f=1", "display_name": "Baioni", "link": "https://stackoverflow.com/users/2383286/baioni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1549920314, "creation_date": 1549402113, "last_edit_date": 1549920314, "question_id": 54543314, "link": "https://stackoverflow.com/questions/54543314/how-do-you-clear-records-for-one-table-with-multiple-tables-on-the-same-form", "title": "How do you clear records for one table with multiple tables on the same form", "body": "<p>I created a single form with multiple tables in Access 2016.\nI am trying to figure out how I can use buttons to only make part of the form clear to enter a new record.</p>\n\n<p>This form is going to be used in a warehouse for measurements.  It will contain 1 location with multiple aisles and then each aisle will have multiple rack systems.\nWhen we measure the location information will not change.  The aisle will only change once all the racks are measured.</p>\n\n<p>In order to do this, I will need the form to be able to create new records as I move to new racks and then change aisles after I finish all the racks.</p>\n\n<p>Should this be one form with multiple subforms would that be easier than the way I am trying to do it?</p>\n\n<p>I have looked at the <code>docmd.gotonewrecord</code> and also <code>gotorecord</code> but neither is working for just specific fields:</p>\n\n<pre><code>Private Sub btnNextUpright_Click()\n\n    Dim ctrl As Control\n\n    txtaisleID.SetFocus\n\n    For Each ctrl In Me.Controls\n\n        If ctrl.Tag = \"upright\" And TypeName(ctrl) = \"TextBox\" Or TypeName(ctrl) = \"Combobox\" Then\n\n        DoCmd.GoToRecord , , acNewRec\n\n        End If\n\n    Next\n\n\nEnd Sub\n</code></pre>\n\n<p>I am expecting to be able to have a button on 3 parts of the Access form.</p>\n\n<p>One will clear the bottom third, one will clear the bottom two thirds and then a final one will clear the whole form.</p>\n\n<p>The following is the tables listed with keys</p>\n\n<p>tblLocation<br>\n -location (Primary Key)<br>\n -inspectby<br>\n -inspectdt  </p>\n\n<p>tblAisle<br>\n -aisleID (Primary Key)<br>\n -beamcnt<br>\n -uprightcnt<br>\n -2beam<br>\n -4beam<br>\n -6beam<br>\n -8beam<br>\n -uprwidth<br>\n -uprhght<br>\n -location (Foreign Key tblLocation)  </p>\n\n<p>tblUpright<br>\n -uprID (Primary Key)<br>\n -frntbck<br>\n -sideside<br>\n -aisleID (Foreign Key tblAisle)  </p>\n\n<p>tblBeam<br>\n -beamlvl<br>\n -bmlvlpass<br>\n -bmlvlfail<br>\n -bmlvlnotes<br>\n -uprID (Foreign Key tblUpright)<br>\n -ID (Primary Key)  </p>\n\n<p><a href=\"https://i.stack.imgur.com/cFMDh.png\" rel=\"nofollow noreferrer\">Form Design</a></p>\n\n<p>If you look at the form I am trying to write code that will add a new record to tblBeam and tblUpright when the NEXT UPRIGHT button is clicked  I tried the ADDNEW but it clears the entire form</p>\n\n<p>With this, I then need to create another button NEXT AISLE that will add a new record to all tables except tblLocation</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 5, "creation_date": 1549400609, "post_id": 54542934, "comment_id": 95887077, "body": "Turn of Screen Updating and set Calculation to manual - <code>Application.ScreenUpdating = False &#47;&#47; Application.Calculation = xlCalculationManual</code>.  Also, <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">don&#39;t use <code>.Select</code>/<code>Activate</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1549402176, "last_edit_date": 1549402176, "creation_date": 1549401387, "answer_id": 54543162, "question_id": 54542934, "link": "https://stackoverflow.com/questions/54542934/speeding-up-a-loop-in-vba/54543162#54543162", "title": "Speeding Up a Loop in VBA", "body": "<p>Similarly to when deleting rows, you can save your inserts until you're done looping.</p>\n\n<p>Run after selecting a cell at the top of the column you want to insert on (but not on row 1): </p>\n\n<pre><code>Sub Tester()\n\n    Dim c As Range, rngIns As Range, sht As Worksheet\n    Dim offSet As Long, cInsert As Range\n\n    Set sht = ActiveSheet\n\n    For Each c In sht.Range(Selection, _\n              sht.Cells(sht.Rows.Count, Selection.Column).End(xlUp)).Cells\n\n        offSet = IIf(offSet = 0, 1, 0) '&lt;&lt; toggle offset\n\n        If c.offSet(-1, 0).Value &lt;&gt; c.Value Then\n            'This is a workaround to prevent two adjacent cells from merging in\n            ' the rngInsert range being built up...\n            Set cInsert = c.offSet(0, offSet)\n\n            If rngIns Is Nothing Then\n                Set rngIns = cInsert\n            Else\n                Set rngIns = Application.Union(cInsert, rngIns)\n            End If\n        End If\n    Next c\n\n    If Not rngIns Is Nothing Then\n        rngIns.EntireRow.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Edit: runs in 3 secs on 25k rows populated using <code>=\"Val_\" &amp; ROUND(RAND()*1000)</code>, converted to values, then sorted.</p>\n"}, {"tags": [], "owner": {"reputation": 28, "user_id": 5822441, "user_type": "registered", "profile_image": "https://graph.facebook.com/10103357907663063/picture?type=large", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5822441/ryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1549405194, "last_edit_date": 1549405194, "creation_date": 1549401568, "answer_id": 54543198, "question_id": 54542934, "link": "https://stackoverflow.com/questions/54542934/speeding-up-a-loop-in-vba/54543198#54543198", "title": "Speeding Up a Loop in VBA", "body": "<p>Edited: Added two options: didn't test for speed. I thought test2() would have been faster but I'm not certain depending on number of rows.</p>\n\n<p>Untested, but just something I thought of quickly. If I'll remember I'll come back to this later because I think there are faster ways</p>\n\n<pre><code>Sub Test1()\n    Dim wsSheet         As Worksheet\n    Dim arrSheet()      As Variant\n    Dim collectRows     As New Collection\n    Dim rowNext         As Long\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Const ColCheck      As Integer = 6\n\n    Set wsSheet = ActiveSheet\n    arrSheet = wsSheet.Range(\"A1\").CurrentRegion\n\n    For rowNext = UBound(arrSheet, 1) To LBound(arrSheet, 1) + 1 Step -1\n        If arrSheet(rowNext, ColCheck) &lt;&gt; arrSheet(rowNext - 1, ColCheck) Then collectRows.Add rowNext\n    Next rowNext\n\n    For rowNext = 1 To collectRows.Count\n        wsSheet.Cells(collectRows(rowNext), 1).EntireRow.Insert\n    Next rowNext\n\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><strong>Second Option inserting all at once:</strong>\nI used a string here because union would change rows next to each other into one larger range. Instead of Range(\"1:1\", \"2:2\") it would create (\"1:2\") and that won't insert the way you need. I don't know of a cleaner way, but there probably is. </p>\n\n<pre><code>Sub Test2()\n    Dim wsSheet         As Worksheet\n    Dim arrSheet()      As Variant\n    Dim collectRows     As New Collection\n    Dim rowNext         As Long\n    Dim strRange        As String\n    Dim cntRanges       As Integer\n    Dim rngAdd          As Range\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Const ColCheck      As Integer = 6\n\n    Set wsSheet = ActiveSheet\n    arrSheet = wsSheet.Range(\"A1\").CurrentRegion\n\n    For rowNext = UBound(arrSheet, 1) To LBound(arrSheet, 1) + 1 Step -1\n        If arrSheet(rowNext, ColCheck) &lt;&gt; arrSheet(rowNext - 1, ColCheck) Then\n            strRange = wsSheet.Cells(rowNext, 1).EntireRow.Address &amp; \",\" &amp; strRange\n            cntRanges = cntRanges + 1\n            If cntRanges &gt; 10 Then\n                collectRows.Add Left(strRange, Len(strRange) - 1)\n                strRange = vbNullString\n                cntRanges = 0\n            End If\n        End If\n    Next rowNext\n\n\n    If collectRows.Count &gt; 0 Then\n        Dim i       As Long\n        For i = 1 To collectRows.Count\n            Set rngAdd = Range(collectRows(i))\n            rngAdd.Insert\n        Next i\n    End If\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1549409081, "creation_date": 1549409081, "answer_id": 54544558, "question_id": 54542934, "link": "https://stackoverflow.com/questions/54542934/speeding-up-a-loop-in-vba/54544558#54544558", "title": "Speeding Up a Loop in VBA", "body": "<h1>Insert If Not Equal</h1>\n\n<pre><code>Sub InsertIfNotEqual()\n\n    Const cSheet As Variant = 1   ' Worksheet Name/Index\n    Const cFirstR As Long = 5     ' First Row\n    Const cCol As Variant = \"E\"   ' Last-Row-Column Letter/Number\n\n    Dim rng As Range     ' Last Cell Range, Union Range\n    Dim vntS As Variant  ' Source Array\n    Dim vntT As Variant  ' Target Array\n    Dim i As Long        ' Source Array Row Counter\n    Dim j As Long        ' Target Array Row Counter\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    On Error GoTo ProcedureExit\n\n    ' In Worksheet\n    With ThisWorkbook.Worksheets(cSheet)\n        ' Determine the last used cell in Last-Row-Column.\n        Set rng = .Columns(cCol).Find(\"*\", , xlFormulas, , , xlPrevious)\n        ' Copy Column Range to Source Array.\n        vntS = .Cells(cFirstR, cCol).Resize(rng.Row - cFirstR + 1)\n    End With\n\n    ' In Arrays\n    ' Resize 1D Target Array to the first dimension of 2D Source Array.\n    ReDim vntT(1 To UBound(vntS)) As Long\n    ' Loop through rows of Source Array.\n    For i = 2 To UBound(vntS)\n        ' Check if current value is equal to previous value.\n        If vntS(i, 1) &lt;&gt; vntS(i - 1, 1) Then\n            ' Increase row of Target Array.\n            j = j + 1\n            ' Write Source Range Next Row Number to Target Array.\n            vntT(j) = i + cFirstR\n        End If\n    Next\n    ' If no non-equal data was found.\n    If j = 0 Then Exit Sub\n\n    ' Resize Target Array to found \"non-equal data count\".\n    ReDim Preserve vntT(1 To j) As Long\n\n    ' In Worksheet\n    With ThisWorkbook.Worksheets(cSheet)\n        ' Set Union range to first cell of row in Target Array.\n        Set rng = .Cells(vntT(1), 2)\n        ' Check if there are more rows in Target Array.\n        If UBound(vntT) &gt; 1 Then\n            ' Loop through the rest of the rows (other than 1) in Target Array.\n            For i = 2 To UBound(vntT)\n                ' Add corresponding cells to Union Range. To prevent the\n                ' creation of \"consecutive\" ranges by Union, the resulting\n                ' cells to be added are alternating between column A and B\n                ' (1 and 2) using the Mod operator against the Target Array\n                ' Row Counter divided by 2.\n                Set rng = Union(rng, .Cells(vntT(i), 1 + i Mod 2))\n            Next\n        End If\n        ' Insert blank rows in one go.\n        rng.EntireRow.Insert\n    End With\n\nProcedureExit:\n    With Application\n        .Calculation = xlCalculationAutomatic\n        .ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11019794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2e1cc0ef8ffb6f1dc6ef505e842640?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Darrow", "link": "https://stackoverflow.com/users/11019794/edward-darrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 54543162, "answer_count": 3, "score": 1, "last_activity_date": 1549409081, "creation_date": 1549400306, "question_id": 54542934, "link": "https://stackoverflow.com/questions/54542934/speeding-up-a-loop-in-vba", "title": "Speeding Up a Loop in VBA", "body": "<p>I am trying to speed up a loop in VBA with over 25,000 line items</p>\n\n<p>I have code that is stepping down through a spread sheet with over 25,000 lines in it. Right now the code loops thought each cell to see if the Previous cell values match the current cell values. If they do not match it inserts a new blank line. Right now the code take over 5 hours to complete on a pretty fast computer. Is there any way I can speed this up?</p>\n\n<pre><code>With ActiveSheet\n    BottomRow4 = .Cells(.Rows.Count, \"E\").End(xlUp).Row\n    End With\n\nDo\n    Cells(ActiveCell.Row, 5).Select\n\n    Do\n        ActiveCell.Offset(1, 0).Select\n\n    'Determines if previous cells is the same as current cells\nLoop Until (ActiveCell.Offset(0, -1) &amp; ActiveCell &lt;&gt; \nActiveCell.Offset(1, -1) &amp; ActiveCell.Offset(1, 0))\n\n    'Insert Blank Row if previous cells do not match current cells...\n    Rows(ActiveCell.Offset(1, 0).Row &amp; \":\" &amp; ActiveCell.Offset(1, \n0).Row).Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n\n    BottomRow4 = BottomRow4 + 1\n\nLoop Until ActiveCell.Row &gt;= BottomRow4\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "copy-paste"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1549401169, "post_id": 54542898, "comment_id": 95887290, "body": "Have you tried adjusting your references for ranges?   E.g., <i>Range(&quot;A2:B3&quot;)</i> is not as easy to utilize variables as <i>Range(Cells(2,1),Cells(3,&quot;B&quot;)</i> (yes, i chose to show 1 for A and B as &quot;B&quot;, which should let one know that either numeric or alpha variables can be used)."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1549401374, "creation_date": 1549401374, "answer_id": 54543157, "question_id": 54542898, "link": "https://stackoverflow.com/questions/54542898/how-to-copy-a-variable-range-of-rows-and-columns-from-one-workbook-to-another/54543157#54543157", "title": "How to Copy a Variable Range of Rows and Columns from one Workbook to Another?", "body": "<p>Example of comment:</p>\n\n<pre><code>dim sr as long, er as long, sc as long, ec as long\nsr = 2 'starting row\ner = cells(rows.count,1).end(xlup).row 'end row\nsc = 1 'starting column (\"A\")\nec = cells(1, rows.count).end(xltoleft).column 'end column\n'utilize above variables\nRange(Cells(sr,sc),Cells(er,ec)).Value = \"\"\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549401374, "creation_date": 1549400090, "last_edit_date": 1549400826, "question_id": 54542898, "link": "https://stackoverflow.com/questions/54542898/how-to-copy-a-variable-range-of-rows-and-columns-from-one-workbook-to-another", "title": "How to Copy a Variable Range of Rows and Columns from one Workbook to Another?", "body": "<p>I'm using a Master excel file to pull data in from outside workbooks. Currently, my macro accounts for a variable range of rows but I cannot figure out how to also account for a variable range of columns.</p>\n\n<p>The code below requires that I enter a range of cells that I would like to copy. Ideally, I would like to remove J so that I am not limited to an outside column but I haven't been able to figure that out through research. To make matters more complicated I have formulas in columns K and L that reference the values in Column A but that is a separate issue isn't urgent.</p>\n\n<pre><code>Sub Copy_Raw_Data()\n\n  Application.ScreenUpdating = False\n\n  Dim CopySheet As Worksheet\n  Dim pasteSheet As Worksheet\n\n  Set CopySheet = Worksheets(\"Raw Data Sheet1\")\n  Set pasteSheet = Worksheets(\"Master Sheet\")\n\n  Workbooks.Open (\"S:\\Raw Data.xlsx\")\n\n  With Sheets(\"Raw Data Sheet1\").Range(\"A2:J\" &amp; Cells(Rows.Count, \"J\").End(xlUp).Row).Copy\n\n  Workbooks(\"Master.xlsm\").Activate\n\n  pasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n  Application.CutCopyMode = False\n  Application.ScreenUpdating = True\n\n  End With\n\n  Workbooks(\"Raw Data.xlsx\").Save\n  Workbooks(\"Raw Data.xlsx\").Close\n\n  Worksheets(\"Master Sheet\").Select\n\nEnd Sub\n</code></pre>\n\n<p>I expect the copy to transfer a variable range of rows and columns from the 'Raw Data' workbook to the 'Master' workbook. Taking it one step further I would like my formulas in the last two columns to shift with the new data.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 3, "creation_date": 1549401861, "post_id": 54542366, "comment_id": 95887602, "body": "IF you save as a CSV you&#39;re essentially saving to another kind of text file. Text files cannot contain formatting - only workbooks (xlsx, etc.) can save formatting instructions."}, {"owner": {"reputation": 45, "user_id": 10348607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cdfc9d8ff57fd410d30ab19fe204c1?s=128&d=identicon&r=PG&f=1", "display_name": "Drzemlik", "link": "https://stackoverflow.com/users/10348607/drzemlik"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1549402584, "post_id": 54542366, "comment_id": 95887961, "body": "@Cindy Meister Then no interior color, i.e. no marking, which cells have been changed. But why I am loosing also the impact of the =Left function <code>Sh.Cells(i, 5) = Left$(Sh.Cells(i, 5).Value, 10)</code> ?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1549403927, "post_id": 54542366, "comment_id": 95888507, "body": "As @CindyMeister said, there are no formatting identifiers in a txt or csv file (nothing built-in, in any case). As an option, you could add some &quot;tag&quot; character to a changed cell using your code, e.g. <code>*&lt;cell contents&gt;</code> where the <code>*</code> would indicate (to you and your users) that it is a changed value. But it&#39;s up to you if you can modify the cell contents in this way."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1549404053, "post_id": 54542366, "comment_id": 95888558, "body": "All the various file names your code is using isn&#39;t completely clear, but near the end you &quot;kill&quot; a file - is this the file the changes are being written to?"}, {"owner": {"reputation": 45, "user_id": 10348607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cdfc9d8ff57fd410d30ab19fe204c1?s=128&d=identicon&r=PG&f=1", "display_name": "Drzemlik", "link": "https://stackoverflow.com/users/10348607/drzemlik"}, "edited": false, "score": 0, "creation_date": 1549404726, "post_id": 54542366, "comment_id": 95888798, "body": "@ Cindy Meister Yes, changes are written to the &quot;killed&quot; TmpFlName. Two files are used in the process. The other file is SomeFile.csv that is supposed to be saved with the changes - or was supposed to, I should say."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1549407838, "post_id": 54542366, "comment_id": 95889695, "body": "I&#39;m kind of surprised that this works at all - when you open a <code>.txt</code> file in Excel it doesn&#39;t generate a dummy <code>ThisWorkbook</code> module for it - only a <code>Sheet1</code>. It doesn&#39;t seem to instantiate that until you add another worksheet to it. That said, you should really be using the <code>Scripting.FileSystemObject</code> for this. Do you have any event handlers anywhere that are calling <code>Dir</code>?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1549434670, "post_id": 54542366, "comment_id": 95895918, "body": "Are you saying you are changing excel cell values (i.e. only showing first ten characters) then saving as CSV, but when you open up the CSV the change doesn&#39;t appear? Going by the comments I would guess that you are not saving or opening what you think you are. What really is the overall objective of this and your prior questions? If the final result is a CSV file then Excel is not even required in this whole process (and things will probably become a lot simpler)"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1549434819, "post_id": 54542366, "comment_id": 95895989, "body": "Here are some guides to working with CSV in Powershell. <a href=\"https://trevorsullivan.net/2015/08/06/working-with-csv-files-in-powershell/\" rel=\"nofollow noreferrer\">trevorsullivan.net/2015/08/06/&hellip;</a> <a href=\"https://stackoverflow.com/questions/16682744/read-a-csv-file-with-powershell-and-capture-corresponding-data\" title=\"read a csv file with powershell and capture corresponding data\">stackoverflow.com/questions/16682744/&hellip;</a>"}, {"owner": {"reputation": 45, "user_id": 10348607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cdfc9d8ff57fd410d30ab19fe204c1?s=128&d=identicon&r=PG&f=1", "display_name": "Drzemlik", "link": "https://stackoverflow.com/users/10348607/drzemlik"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1549486048, "post_id": 54542366, "comment_id": 95923466, "body": "@Comintern I have no idea how to implement <code>Scripting.FileSystemObject</code> to this code, I will do research later. The question about event handlers.., I suppose I don&#39;t use them as  I don&#39;t know what they are. I&#39;ve had a look <a href=\"https://support.microsoft.com/en-us/help/213566/how-to-create-application-level-event-handlers-in-excel\" rel=\"nofollow noreferrer\">here</a>, but this is sth I have yet to learn."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10348607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cdfc9d8ff57fd410d30ab19fe204c1?s=128&d=identicon&r=PG&f=1", "display_name": "Drzemlik", "link": "https://stackoverflow.com/users/10348607/drzemlik"}, "edited": false, "score": 0, "creation_date": 1549487143, "post_id": 54546562, "comment_id": 95923944, "body": "as you said I&#39;m simply trying to truncate col 5 of .csv file (and save the changes). Only after reading your answer did I realize that I complicated things and mislead potential troubleshooters. I can see in Locals window that your code works, though for now I can&#39;t adapt it so it would save .csv with the above changes. I will work on it. Thank you, accepted for working code, links with referrence and making me understand my own question better."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 45, "user_id": 10348607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cdfc9d8ff57fd410d30ab19fe204c1?s=128&d=identicon&r=PG&f=1", "display_name": "Drzemlik", "link": "https://stackoverflow.com/users/10348607/drzemlik"}, "edited": false, "score": 0, "creation_date": 1549499039, "post_id": 54546562, "comment_id": 95928002, "body": "it is a pleasure to be useful. Be free with any problems in adapting the code."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 0, "last_activity_date": 1549813823, "last_edit_date": 1549813823, "creation_date": 1549426826, "answer_id": 54546562, "question_id": 54542366, "link": "https://stackoverflow.com/questions/54542366/saving-txt-as-csv-cancels-all-changes-made-by-macro-in-the-file-how-to-preven/54546562#54546562", "title": "Saving .txt as .csv cancels all changes made by macro in the file. How to prevent it?", "body": "<p>What looked as a simple opening semicolon delimited text /cvs file in your <a href=\"https://stackoverflow.com/questions/54488624/macro-separates-csv-by-comma-despite-separator-set-to-semicolon/54489108#54489108\">earlier post</a> is now looks complicated.  Even overlooking other issues, in my trial, I find while saving txt/csv files from excel it may introduce some double quote in the saved file (depending on position of comma, spaces and semicolon in a line). May refer links   (<a href=\"https://stackoverflow.com/questions/11501531/saving-a-excel-file-into-txt-format-without-quotes\">Saving a Excel File into .txt format without quotes</a>) and <a href=\"https://excel.tips.net/T002237_Getting_Rid_of_Extra_Quote_Marks_in_Exported_Text_Files.html\" rel=\"nofollow noreferrer\">link</a> and <a href=\"https://superuser.com/questions/349882/how-to-avoid-double-quotes-when-saving-excel-file-as-unicode\">link2</a></p>\n\n<p>As what I understand, your requirement is simple to truncate 5th column of the semicolon delimited file with csv extension and save it back, the simple approach of may solve your the problem. However, I still not satisfied with the workaround approach and <strong>invite more simple and straight approach to solve the proble</strong>m (consisting txt file with comma, spaces and semicolons, while semicolon is to be treated as delimiter) </p>\n\n<p>Try</p>\n\n<pre><code>Sub test2()\nDim Fname As String, Path As String, Txt As String, Txt2 As String\nDim INum As Integer, ONum As Integer, TrucTo As Integer, ColNo As Long\nDim Cols As Variant\n\n' Modify the variables to your requirement\nPath = \"C:\\Users\\user\\Desktop\\\"\nFname = \"Somefile.csv\"     ' Target file name\nFname2 = \"Somefile2.csv\"   ' Temp file name\nTrucTo = 10                ' truncated to chars\nColNo = 4                   '  column to be truncated -1\n\nIf Dir(Path &amp; Fname2) &lt;&gt; \"\" Then Kill Path &amp; Fname2\n\n\nINum = FreeFile\nOpen Path &amp; Fname For Input As #INum\nONum = FreeFile\nOpen Path &amp; Fname2 For Output As #ONum\n\nDo Until EOF(1)\n    Line Input #1, Txt\n    Cols = Split(Txt, \";\")\n        If UBound(Cols) &gt;= ColNo Then\n            If Len(Cols(ColNo)) &gt;= truncto Then\n            Cols(ColNo) = Left(Cols(ColNo), TrucTo)\n            End If\n        End If\n    Txt2 = Join(Cols, \";\")\n    Print #ONum, Txt2\nLoop\nClose #ONum\nClose #INum\n\n\nKill Path &amp; Fname\nName Path &amp; Fname2 As Path &amp; Fname\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/cGGkJ.jpg\" rel=\"nofollow noreferrer\">This is the result input &amp; Output </a></p>\n"}], "owner": {"reputation": 45, "user_id": 10348607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cdfc9d8ff57fd410d30ab19fe204c1?s=128&d=identicon&r=PG&f=1", "display_name": "Drzemlik", "link": "https://stackoverflow.com/users/10348607/drzemlik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 54546562, "answer_count": 1, "score": -1, "last_activity_date": 1549813823, "creation_date": 1549397803, "last_edit_date": 1549493593, "question_id": 54542366, "link": "https://stackoverflow.com/questions/54542366/saving-txt-as-csv-cancels-all-changes-made-by-macro-in-the-file-how-to-preven", "title": "Saving .txt as .csv cancels all changes made by macro in the file. How to prevent it?", "body": "<p>The issue continues <a href=\"https://stackoverflow.com/q/54523166/10348607\">this</a> topic and is associated with <a href=\"https://stackoverflow.com/q/54488624/10348607\">my earlier post</a>.\nThe code should deal with .csv files changing cells' values and interior color. It does its job, but after saving .txt as .csv I end up with something that looks like the source file - no changes visible.</p>\n\n<p>I thought of using dictionaries, but to my understanding, to do so, I had to edit the newly saved .csv, which is exactly what I am trying to avoid in the below code. Does anyone have an idea how to have the changes saved?</p>\n\n<pre><code>Option Explicit\n\nSub fixCellsValue()\nDim wrk As Workbook\nDim Sh As Worksheet\nDim SourceFolder As String, Path As String, TmpFlName As String\nDim i As Long, lastrow As Long\n\nSourceFolder = ThisWorkbook.Path &amp; \"\\source\"\n\n'creating temporary .txt file\nIf Dir(SourceFolder &amp; \"SomeFile.*\") &lt;&gt; \"\" Then\n    If InStr(1, Dir(SourceFolder &amp; \"SomeFile.*\"), \".csv\") Then\n                    TmpFlName = SourceFolder &amp; \"\\TmpCsv.txt\"\n                    If Dir(TmpFlName) &lt;&gt; \"\" Then Kill TmpFlName\n                    FileCopy SourceFolder &amp; \"SomeFile.csv\", TmpFlName\n                    Workbooks.OpenText Filename:=TmpFlName, origin:= _\n                    1250, StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _\n                    ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=True, Comma:=False _\n                    , Space:=False, Other:=False, TrailingMinusNumbers:=True, Local:=False\n\n                    Set wrk = Application.Workbooks(\"TmpCsv.txt\")\n                    Set Sh = wrk.Worksheets(1)\n\n        lastrow = Sh.Cells(Sh.Rows.Count, \"A\").End(xlUp).row\n\n        'implementing changes to the temporary .txt file\n        For i = 2 To lastrow\n            If Len(Sh.Cells(i, 5)) &gt; 10 Then\n                Sh.Cells(i, 5) = Left$(Sh.Cells(i, 5).Value, 10)\n                Sh.Cells(i, 5).Interior.ColorIndex = 6\n            End If\n        Next i\n\n    End If\nEnd If\n\n'saving as .csv file and deleting .txt file\nIf InStr(1, wrk.Name, \"TmpCsv.txt\") Then\n    wrk.SaveAs Filename:=Dir(SourceFolder &amp; \"SomeFile.*\"), FileFormat:=xlCSV, Local:=True\n    wrk.Close Savechanges:=True\n    Kill TmpFlName\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 1, "creation_date": 1549398742, "post_id": 54542283, "comment_id": 95886273, "body": "I&#39;m not sure which row causes your error (you could find out this when debugging), but I guess it is the <code>If</code> row. Please check <code>If Me.StudentID = (Nz([Intake_QSF]![StudentID],&quot;&quot;)) Then </code> to avoid comparing your <code>StudentID</code> with a null value."}, {"owner": {"reputation": 29, "user_id": 10963152, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mHNRgvP-qr4/AAAAAAAAAAI/AAAAAAAAuOw/4Tl9Hsa5Mh4/photo.jpg?sz=128", "display_name": "Stan S", "link": "https://stackoverflow.com/users/10963152/stan-s"}, "reply_to_user": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1549400293, "post_id": 54542283, "comment_id": 95886926, "body": "Yes, it is the &quot;If&quot; row. I tried the code you posted and get another runtime error--only when it is a new StudentID record--if there is an existing record it works great."}], "answers": [{"tags": [], "owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "is_accepted": true, "score": 0, "last_activity_date": 1549401492, "creation_date": 1549401492, "answer_id": 54543183, "question_id": 54542283, "link": "https://stackoverflow.com/questions/54542283/toggle-sub-form-visibility-to-true-while-in-putting-new-record-of-same-id-number/54543183#54543183", "title": "Toggle sub-form visibility to true while in-putting new record of same ID number", "body": "<p>The problem is, as you already mentioned, that there is no recordset.</p>\n\n<p>Replace </p>\n\n<pre><code>If Me.StudentID = ([Intake_QSF]![StudentID]) Then\n    Me.Intake_QSF.Visible = True        \nEnd If\n</code></pre>\n\n<p>by this:</p>\n\n<pre><code>Me.Intake_QSF.Visible = Me.Intake_QSF.Form.Recordset.RecordCount &gt; 0\n</code></pre>\n\n<p>It will check if there are records at all and set the boolean value of the <code>Visible</code> property.</p>\n\n<p>Edit:</p>\n\n<p>Alternatively you could check if the current record of the subform is a new record:</p>\n\n<pre><code>Me.Intake_QSF.Visible = Not Me.Intake_QSF.Form.NewRecord\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10963152, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mHNRgvP-qr4/AAAAAAAAAAI/AAAAAAAAuOw/4Tl9Hsa5Mh4/photo.jpg?sz=128", "display_name": "Stan S", "link": "https://stackoverflow.com/users/10963152/stan-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 54543183, "answer_count": 1, "score": 0, "last_activity_date": 1549401492, "creation_date": 1549397440, "last_edit_date": 1549398265, "question_id": 54542283, "link": "https://stackoverflow.com/questions/54542283/toggle-sub-form-visibility-to-true-while-in-putting-new-record-of-same-id-number", "title": "Toggle sub-form visibility to true while in-putting new record of same ID number", "body": "<p>I have a form to track students' submitted paperwork. As someone enters the student's ID into the form, I have a query that populates a subform using the StudentID to show us if the student has previously submitted something.</p>\n\n<p>It works great if there is already a matching StudentID. But, if there is not a matching StudentID I get </p>\n\n<blockquote>\n  <p>Run-time error '2427': You entered an expression that has no value.</p>\n</blockquote>\n\n<p>This is in the <code>AfterUpdate</code> StudentID event:</p>\n\n<pre><code>    DoCmd.OpenQuery \"IntakePrevious_Q\"\n    DoCmd.Close acQuery, \"IntakePrevious_Q\", acSaveYes\n    [Intake_QSF].Requery\n\n    If Me.StudentID = ([Intake_QSF]![StudentID]) Then\n        Me.Intake_QSF.Visible = True        \n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10890792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214987079844508/picture?type=large", "display_name": "Abdullah Orhan", "link": "https://stackoverflow.com/users/10890792/abdullah-orhan"}, "edited": false, "score": 0, "creation_date": 1549400368, "post_id": 54542830, "comment_id": 95886959, "body": "yes it is true but there is no data on f12 (there is no error code)"}, {"owner": {"reputation": 3, "user_id": 10890792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214987079844508/picture?type=large", "display_name": "Abdullah Orhan", "link": "https://stackoverflow.com/users/10890792/abdullah-orhan"}, "edited": false, "score": 0, "creation_date": 1549404409, "post_id": 54542830, "comment_id": 95888692, "body": "that code is work i guess but last price data does not go to f12"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1549404476, "last_edit_date": 1549404476, "creation_date": 1549399807, "answer_id": 54542830, "question_id": 54542196, "link": "https://stackoverflow.com/questions/54542196/i-cant-extract-data-from-span-to-excel/54542830#54542830", "title": "I cant extract data from span to excel", "body": "<p><strong>Internet Explorer:</strong></p>\n\n<p><code>getElementById</code> returns a single element so you do not index into it.</p>\n\n<pre><code>doc.getElementById(\"hisse_Son\").innerText\n</code></pre>\n\n<p>Use a timed loop to ensure value has time to be populated</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim ie As InternetExplorer, ws As Worksheet, ele As Object\n    Dim t As Date, val As String\n    Const MAX_WAIT_SEC As Long = 10            '&lt;==Adjust wait time\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set ie = New InternetExplorer\n\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.isyatirim.com.tr/tr-tr/analiz/hisse/sayfalar/sirket-karti.aspx?hisse=ADANA\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        t = Timer\n        Do\n            On Error Resume Next\n            Set ele = .document.querySelector(\"#hisse_Son\") '(\".tahminyiltable td + td\")\n            val = ele.innerText\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While val = vbNullString\n        Activesheet.Range(\"F12\") =  val\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>XMLHTTP:</strong></p>\n\n<p>You can also mimic an XHR POST request of the page and use a json parser to parse out the value from the json response. I use <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">jsonconverter.bas</a>, and after downloading and adding the .bas to the project, go VBE > Tools > References > Add a reference to <code>Microsoft Scripting Runtime</code>.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo() \n    Const URL As String = \"https://www.isyatirim.com.tr/_layouts/15/IsYatirim.Website/StockInfo/CompanyInfoAjax.aspx/GetSermayeArttirimlari\"\n    Dim  data As String, json As Object\n    data = \"{\"\"hisseKodu\"\": \"\"ADANA\"\", \"\"hisseTanimKodu\"\": \"\"\"\", \"\"yil\"\":0, \"\"zaman\"\":\"\"HEPSI\"\", \"\"endeksKodu\"\":\"\"09\"\",\"\"sektorKodu\"\":\"\"\"\"}\"\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"POST\", URL, False\n        .setRequestHeader \"Content-Type\", \"application/json; charset=UTF-8\"\n        .setRequestHeader \"Accept\", \"application/json, text/javascript, */*; q=0.01\"\n        .Send data\n        Set json = jsonconverter.ParseJson(Replace$(Replace$(Replace$(.responseText, \"\\\", vbNullString), Chr$(34) &amp; \"[\", \"[\"), \"]\" &amp; Chr$(34), \"]\"))\n        Activesheet.Range(\"F12\") =  json(\"d\")(1)(\"PRICE_TL\")\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 0, "last_activity_date": 1549400703, "creation_date": 1549400703, "answer_id": 54543020, "question_id": 54542196, "link": "https://stackoverflow.com/questions/54542196/i-cant-extract-data-from-span-to-excel/54543020#54543020", "title": "I cant extract data from span to excel", "body": "<pre><code>With CreateObject(\"MSXML2.XMLHTTP\")\n    .Open \"GET\", \"https://www.isyatirim.com.tr/_layouts/15/Isyatirim.Website/Common/Data.aspx/OneEndeks?endeks=\" &amp; Range(\"A1\") &amp; \".E.BIST\", False\n    .Send\n    Range(\"F12\") = Split(Split(.ResponseText, \"\"\"last\"\":\", 2)(1), \",\", 2)(0)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10890792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214987079844508/picture?type=large", "display_name": "Abdullah Orhan", "link": "https://stackoverflow.com/users/10890792/abdullah-orhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 54542830, "answer_count": 2, "score": -1, "last_activity_date": 1565106525, "creation_date": 1549397063, "last_edit_date": 1549403047, "question_id": 54542196, "link": "https://stackoverflow.com/questions/54542196/i-cant-extract-data-from-span-to-excel", "title": "I cant extract data from span to excel", "body": "<p>\u0131 want to extract my excel last price to my excel\n \u0131 cant extract data from span to excel\n\u0131 tried a few code but it did not work\nHow can \u0131 fix it?</p>\n\n<pre><code>Sub D\u00fc\u011fme1_T\u0131kla()\nsirketismi = Range(\"a1\")\n\n\nDim ie As New InternetExplorer\n\nie.Visible = True\nie.navigate \"https://www.isyatirim.com.tr/tr-tr/analiz/hisse/Sayfalar/sirket-karti.aspx?hisse=\" &amp; sirketismi\nDo\nLoop Until ie.readyState = READYSTATE_COMPLETE\n\n\nDim doc As HTMLDocument\nSet doc = ie.document\n\ngf = doc.getElementById(\"hisse_Son\")(0).innerText\n\ngf = Range(\"f12\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1549397112, "post_id": 54542141, "comment_id": 95885566, "body": "You should always check first the items are found before processing to avoid errors. Step through your code to see if either variable is Nothing which means the search term was not found."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549397162, "post_id": 54542141, "comment_id": 95885585, "body": "Are the [ and ] visibly included in the cell\u2018s values?"}, {"owner": {"reputation": 15, "user_id": 11019629, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0DExzajBfBI/AAAAAAAAAAI/AAAAAAAAAUY/T9VOFnxi24g/photo.jpg?sz=128", "display_name": "Vishal Malhotra", "link": "https://stackoverflow.com/users/11019629/vishal-malhotra"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549399033, "post_id": 54542141, "comment_id": 95886400, "body": "@Asger The square brackets are not part of the cell&#39;s value. I took them off in code however the same errors occurs."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11019629, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0DExzajBfBI/AAAAAAAAAAI/AAAAAAAAAUY/T9VOFnxi24g/photo.jpg?sz=128", "display_name": "Vishal Malhotra", "link": "https://stackoverflow.com/users/11019629/vishal-malhotra"}, "edited": false, "score": 0, "creation_date": 1549463295, "post_id": 54542937, "comment_id": 95911475, "body": "I realized I made a foolish mistake. Thank you so much."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 15, "user_id": 11019629, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0DExzajBfBI/AAAAAAAAAAI/AAAAAAAAAUY/T9VOFnxi24g/photo.jpg?sz=128", "display_name": "Vishal Malhotra", "link": "https://stackoverflow.com/users/11019629/vishal-malhotra"}, "edited": false, "score": 0, "creation_date": 1549467452, "post_id": 54542937, "comment_id": 95914134, "body": "Great! If my solution helped you, please consider marking the answer"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549529927, "post_id": 54542937, "comment_id": 95937001, "body": "Sorry, this solution doesn&#39;t convince me. The two found ranges should be checked against <code>Nothing</code> and that&#39;s it. The original code will delete any row in the whole range containing a blank cell. The ranges neither have to be in the same column, nor does the first be located before the last, nor do you need a <code>Union</code> nor do you have to use their address."}], "tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": true, "score": 0, "last_activity_date": 1549400312, "creation_date": 1549400312, "answer_id": 54542937, "question_id": 54542141, "link": "https://stackoverflow.com/questions/54542141/selecting-a-range-depended-on-two-key-words/54542937#54542937", "title": "Selecting a Range depended on two Key Words", "body": "<p>This is working for me.</p>\n\n<p>You have to make sure the first range is a cell before the last one and they are located in the same column. Otherwise it throws an error.</p>\n\n<p>To define the new range, use the Address property of the start and finish ranges.</p>\n\n<pre><code>Sub DeleteBlankCells()\n\n    Dim rngFirst As Range\n    Dim rngLast As Range\n\n    Dim rngUnion As Range\n    Application.ScreenUpdating = False\n\n    With Sheets(\"Input\")\n        'Find the start and stop\n        Set rngFirst = .Cells.Find(what:=\"Performance Income\", lookat:=xlWhole, _\n            LookIn:=xlValues, MatchCase:=False)\n        Set rngLast = .Cells.Find(what:=\"Miscellaneous Income\", _\n            lookat:=xlWhole, LookIn:=xlValues, MatchCase:=False)\n\n        Set rngUnion = Range(rngFirst.Address, rngLast.Address)\n\n        rngUnion.SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n\n    End With\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11019629, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0DExzajBfBI/AAAAAAAAAAI/AAAAAAAAAUY/T9VOFnxi24g/photo.jpg?sz=128", "display_name": "Vishal Malhotra", "link": "https://stackoverflow.com/users/11019629/vishal-malhotra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 54542937, "answer_count": 1, "score": 0, "last_activity_date": 1549400312, "creation_date": 1549396848, "last_edit_date": 1549397005, "question_id": 54542141, "link": "https://stackoverflow.com/questions/54542141/selecting-a-range-depended-on-two-key-words", "title": "Selecting a Range depended on two Key Words", "body": "<p>I am currently working on a project to create a VBA to automatically delete blank lines. I have created the following with some help:</p>\n\n<pre><code>    Dim rngFirst As Range\n    Dim rngLast As Range\n\n    Application.ScreenUpdating = False\n\n    With Sheets(\"Input\")\n        'Find the start and stop\n        Set rngFirst = .Cells.Find(what:=\"[Performance Income]\", lookat:=xlWhole, _\n            LookIn:=xlValues, MatchCase:=False)\n        Set rngLast = .Cells.Find(what:=\"[Miscellaneous Income]\", _\n            lookat:=xlWhole, LookIn:=xlValues, MatchCase:=False)\n\n        .Range(rngFirst, rngLast).SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n    End With\n\n    Application.ScreenUpdating = True\n</code></pre>\n\n<p>I am having a 1004 Run Time error. I have searched for the reason why I think it has something to do with my range selection. However I don't know specifically, I was hoping to get help. Thank you in advance. </p>\n"}, {"tags": ["vba", "ms-access", "sharepoint", "linked-list"], "answers": [{"comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549396604, "post_id": 54542011, "comment_id": 95885329, "body": "Is it 2007 only relevant? Then you should mention that in your question header for future readers."}, {"owner": {"reputation": 1, "user_id": 11019578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a480558c54401c2abce9e9205f0e7658?s=128&d=identicon&r=PG&f=1", "display_name": "TheFalafelologist", "link": "https://stackoverflow.com/users/11019578/thefalafelologist"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549401691, "post_id": 54542011, "comment_id": 95887529, "body": "I&#39;m on Access 2016"}], "tags": [], "owner": {"reputation": 1, "user_id": 11019578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a480558c54401c2abce9e9205f0e7658?s=128&d=identicon&r=PG&f=1", "display_name": "TheFalafelologist", "link": "https://stackoverflow.com/users/11019578/thefalafelologist"}, "is_accepted": false, "score": 0, "last_activity_date": 1549396203, "creation_date": 1549396203, "answer_id": 54542011, "question_id": 54541937, "link": "https://stackoverflow.com/questions/54541937/how-do-i-get-a-sharepoint-table-to-link-to-access-with-proper-column-types-throu/54542011#54542011", "title": "How do I get a SharePoint table to link to access with proper column types through VBA?", "body": "<p>Solved it.</p>\n\n<p>You want to put \"False\" in the \"GetLookupDisplayValues\" criteria shown in the link below</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/bb238962(v=office.12)\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/bb238962(v=office.12)</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11019578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a480558c54401c2abce9e9205f0e7658?s=128&d=identicon&r=PG&f=1", "display_name": "TheFalafelologist", "link": "https://stackoverflow.com/users/11019578/thefalafelologist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549398320, "creation_date": 1549395916, "last_edit_date": 1549398320, "question_id": 54541937, "link": "https://stackoverflow.com/questions/54541937/how-do-i-get-a-sharepoint-table-to-link-to-access-with-proper-column-types-throu", "title": "How do I get a SharePoint table to link to access with proper column types through VBA?", "body": "<p>I have a several sharepoint tables, some of which use lookup fields (I know I know they are bad but for this database we need the lookup fields to be in place).</p>\n\n<p>If I manually link the table via the top ribbon it imports the table fine.</p>\n\n<p>If i use VBA and DoCmd.TransferSharePointList acLinkSharePointList then it returns all lookup columns as \"Short Text\" instead of a lookup field.</p>\n\n<p>I don't understand why it works perfectly when done manually but messes up when done through VBA. Anyone have any ideas? I can't find anyone with a similar issue on google.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 8, "creation_date": 1549395543, "post_id": 54541830, "comment_id": 95884847, "body": "Change all of your <code>As Integer</code> to <code>As Long</code> - the limit on integer is ~32k, which is pretty low if you&#39;re dealing with large datasets."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 3, "creation_date": 1549395823, "post_id": 54541830, "comment_id": 95884978, "body": "ThisWorkbook is a reserved name (workbook where this vba code resides)"}], "answers": [{"tags": [], "owner": {"reputation": 493, "user_id": 5283663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AoeY4.jpg?s=128&g=1", "display_name": "A. Lion", "link": "https://stackoverflow.com/users/5283663/a-lion"}, "is_accepted": false, "score": 0, "last_activity_date": 1549398364, "creation_date": 1549398364, "answer_id": 54542499, "question_id": 54541830, "link": "https://stackoverflow.com/questions/54541830/how-to-fix-overflow-error-when-calling-macros/54542499#54542499", "title": "How to fix overflow error when calling macros", "body": "<p>Likely you can break it at the first execution if you run the second Macro to test an excel sheet where the \"Nominal\" values is never set, in that case the following will generate an infinite loop that will break as soon as the maximum value for the integer dataRow is reached.\n        Do While Not dataSheet.Range(\"U\" &amp; dataRow) = \"Nominal\"\n            dataRow = dataRow + 1 'ERROR HERE\n        Loop\nYou could probably avoid the error by using a for instead of do while which is based on a pre-computed number of row or a max set as constraint.\nI do not have Office on my netbook but I am pretty sure the following logic is not going to crash, except for some silly syntax mistakes I could have done.</p>\n\n<pre><code>Sub Analysis()\n\nDim dataSheet As Worksheet\nDim thisSheet As Worksheet\nDim thisWorkbook As Workbook\n\nSet thisWorkbook = ActiveWorkbook\nSet thisSheet = ActiveSheet\n\nFor i = 1 To thisWorkbook.Sheets.Count\n\n    If Not thisWorkbook.Sheets(i).Name = thisSheet.Name Then\n\n        Set dataSheet = thisWorkbook.Sheets(i)\n\n    End If\n\nNext i\n\n\n\nIf thisWorkbook.Sheets.Count &gt;= 2 Then\n\n    'dataSheet now contains the sheet we need to pull data from.\n    Dim summaryRow(1 To 7) As Integer\n    Dim dataRow As Integer\n\n    Dim bfound as boolean\n    ''dataRow = 1\n\n    summaryRow(1) = 10\n    summaryRow(2) = 13\n    summaryRow(3) = 16\n    summaryRow(4) = 19\n    summaryRow(5) = 22\n    summaryRow(6) = 28\n    summaryRow(7) = 31\n\n    For i = 1 To UBound(summaryRow)\n\n       bfound=false\n       For dataRow = 1 to 2147000000\n            If dataSheet.Range(\"U\" &amp; dataRow) = \"Nominal\" Then\n                    bfound=true\n                    exit for\n            End If\n    Next\n\n        If bfound Then\n            dataRow = dataRow + 1\n            thisSheet.Range(\"I\" &amp; summaryRow(i)) = dataSheet.Range(\"U\" &amp; dataRow)\n            If Not dataSheet.Range(\"AH\" &amp; (dataRow + 1)) = \"\" Then\n                thisSheet.Range(\"J\" &amp; summaryRow(i)) = Application.WorksheetFunction.CountIf(dataSheet.Range(\"AH\" &amp; (dataRow + 1) &amp; \":\" &amp; \"AH\" &amp; (dataRow + 7)), \"=\" &amp; \"PASS\")\n                thisSheet.Range(\"K\" &amp; summaryRow(i)) = Application.WorksheetFunction.CountIf(dataSheet.Range(\"AH\" &amp; (dataRow + 1) &amp; \":\" &amp; \"AH\" &amp; (dataRow + 7)), \"=\" &amp; \"EVALUATE\")\n                thisSheet.Range(\"L\" &amp; summaryRow(i)) = Application.WorksheetFunction.CountIf(dataSheet.Range(\"AH\" &amp; (dataRow + 1) &amp; \":\" &amp; \"AH\" &amp; (dataRow + 7)), \"=\" &amp; \"FAIL\")\n            Else\n                thisSheet.Range(\"J\" &amp; summaryRow(i)) = \"N/A\"\n                thisSheet.Range(\"K\" &amp; summaryRow(i)) = \"N/A\"\n                thisSheet.Range(\"L\" &amp; summaryRow(i)) = \"N/A\"\n            End If\n        Else\n           '' I do not have idea what you want to do in this case\n        End if\n    Next i\n\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11019533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DJK5dILZhDY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN92euSYtBydN_AWFz7Jv_cDCmdbw/mo/photo.jpg?sz=128", "display_name": "Augustine Choi", "link": "https://stackoverflow.com/users/11019533/augustine-choi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "closed_date": 1549413530, "answer_count": 1, "score": -1, "last_activity_date": 1549398364, "creation_date": 1549395380, "last_edit_date": 1549398361, "question_id": 54541830, "link": "https://stackoverflow.com/questions/54541830/how-to-fix-overflow-error-when-calling-macros", "closed_reason": "Duplicate", "title": "How to fix overflow error when calling macros", "body": "<p>Im getting an overflow error when I call my macros. When I run them individually, it is fine, but when I call them one after the other, I get an error. First one imports the data and then the second macro does a small analysis of the imported data on a seperate sheet.</p>\n\n<p>First Macro </p>\n\n<pre><code>Sub ImportFiles()\n\n    Dim sheet As Worksheet\n    Dim total As Integer\n    Dim intChoice As Integer\n    Dim strPath As String\n    Dim i As Integer\n    Dim wbNew As Workbook\n    Dim wbSource As Workbook\n    Set wbNew = ActiveWorkbook\n\n    'allow the user to select multiple files\n    Application.FileDialog(msoFileDialogOpen).AllowMultiSelect = True\n    'make the file dialog visible to the user\n    intChoice = Application.FileDialog(msoFileDialogOpen).Show\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    'determine what choice the user made\n    If intChoice &lt;&gt; 0 Then\n        'get the file path selected by the user\n        For i = 1 To Application.FileDialog(msoFileDialogOpen).SelectedItems.Count\n            strPath = Application.FileDialog(msoFileDialogOpen).SelectedItems(i)\n\n            Set wbSource = Workbooks.Open(strPath)\n\n            For Each sheet In wbSource.Worksheets\n                total = wbNew.Worksheets.Count\n                wbSource.Worksheets(sheet.Name).Copy _\n                after:=wbNew.Worksheets(total)\n            Next sheet\n\n            wbSource.Close\n        Next i\n    End If\nEnd Sub\n</code></pre>\n\n<p>Second Macro (error in dataRow = dataRow + 1)</p>\n\n<pre><code>Sub Analysis()\n\nDim dataSheet As Worksheet\nDim thisSheet As Worksheet\nDim thisWorkbook As Workbook\n\nSet thisWorkbook = ActiveWorkbook\nSet thisSheet = ActiveSheet\n\nFor i = 1 To thisWorkbook.Sheets.Count\n\n    If Not thisWorkbook.Sheets(i).Name = thisSheet.Name Then\n\n        Set dataSheet = thisWorkbook.Sheets(i)\n\n    End If\n\nNext i\n\n\n\nIf thisWorkbook.Sheets.Count &gt;= 2 Then\n\n    'dataSheet now contains the sheet we need to pull data from.\n    Dim summaryRow(1 To 7) As Integer\n    Dim dataRow As Integer\n\n    dataRow = 1\n\n    summaryRow(1) = 10\n    summaryRow(2) = 13\n    summaryRow(3) = 16\n    summaryRow(4) = 19\n    summaryRow(5) = 22\n    summaryRow(6) = 28\n    summaryRow(7) = 31\n\n    For i = 1 To UBound(summaryRow)\n\n        Do While Not dataSheet.Range(\"U\" &amp; dataRow) = \"Nominal\"\n            dataRow = dataRow + 1 'ERROR HERE\n        Loop\n\n        dataRow = dataRow + 1\n\n        thisSheet.Range(\"I\" &amp; summaryRow(i)) = dataSheet.Range(\"U\" &amp; dataRow)\n        If Not dataSheet.Range(\"AH\" &amp; (dataRow + 1)) = \"\" Then\n            thisSheet.Range(\"J\" &amp; summaryRow(i)) = Application.WorksheetFunction.CountIf(dataSheet.Range(\"AH\" &amp; (dataRow + 1) &amp; \":\" &amp; \"AH\" &amp; (dataRow + 7)), \"=\" &amp; \"PASS\")\n            thisSheet.Range(\"K\" &amp; summaryRow(i)) = Application.WorksheetFunction.CountIf(dataSheet.Range(\"AH\" &amp; (dataRow + 1) &amp; \":\" &amp; \"AH\" &amp; (dataRow + 7)), \"=\" &amp; \"EVALUATE\")\n            thisSheet.Range(\"L\" &amp; summaryRow(i)) = Application.WorksheetFunction.CountIf(dataSheet.Range(\"AH\" &amp; (dataRow + 1) &amp; \":\" &amp; \"AH\" &amp; (dataRow + 7)), \"=\" &amp; \"FAIL\")\n        Else\n            thisSheet.Range(\"J\" &amp; summaryRow(i)) = \"N/A\"\n            thisSheet.Range(\"K\" &amp; summaryRow(i)) = \"N/A\"\n            thisSheet.Range(\"L\" &amp; summaryRow(i)) = \"N/A\"\n        End If\n\n    Next i\n\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549394933, "post_id": 54541486, "comment_id": 95884587, "body": "Why do you rename every (maybe only one existing) sheet as \u201eSheet1\u201c?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1549395079, "post_id": 54541486, "comment_id": 95884648, "body": "<code>Dim lastRow As Integer</code> ... in modern Excel, the number of rows can exceed what an integer can hold. There is no reason to use <code>Integer</code> in Excel VBA. Use <code>Long</code> instead."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "edited": false, "score": 0, "creation_date": 1549395393, "post_id": 54541486, "comment_id": 95884791, "body": "Yah, it is only ever one sheet. But every month a new sheet is dropped into the folder with a sheet name that is either random or I simply cannot understand the logic behind. So, I just want to rename it and move on."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549395426, "post_id": 54541486, "comment_id": 95884801, "body": "Interesting mix of criteria from different workbooks within one SUMIF. Can not test that actually. If that\u2018s not the reason for non-working, I learn\u2018t something new and interesting."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549395903, "post_id": 54541486, "comment_id": 95885018, "body": "@Asger And that is not even the complete list of criteria. I heavily edited it down. But Tate Garringer identified the issue as my excess use of loops below."}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "edited": false, "score": 0, "creation_date": 1549395278, "post_id": 54541732, "comment_id": 95884743, "body": "It worked! You are brilliant! I really appreciate your help. Thank you so much, Tate!"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "reply_to_user": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "edited": false, "score": 0, "creation_date": 1549395492, "post_id": 54541732, "comment_id": 95884826, "body": "Happy to have helped!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1549395633, "post_id": 54541732, "comment_id": 95884885, "body": "Congrats for hitting 1K! Keep &#39;em coming!"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549396306, "post_id": 54541732, "comment_id": 95885206, "body": "@MathieuGuindon Thanks! I&#39;ve been lurking SO since the beginning of time, the New Year seemed like an appropriate time to start giving back."}], "tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": true, "score": 4, "last_activity_date": 1549394965, "creation_date": 1549394965, "answer_id": 54541732, "question_id": 54541486, "link": "https://stackoverflow.com/questions/54541486/why-is-my-vba-sumifs-function-returning-zeros/54541732#54541732", "title": "Why is my VBA SUMIFS function returning zeros?", "body": "<p>You don't need so many nested loops. Your original code is looping through every possible criteria for each <code>k</code> and <code>l</code>. Assuming <code>wb_b.Cells(k, l)</code> is supposed to be a reference to the cell intersected by your month column and employee name row, you could use your <code>i</code> and <code>j</code> values.</p>\n\n<pre><code>For i = 7 To 18\n    Set Criteria1 = wb_b.Cells(7, i)\n    For j = 8 To 18\n        Set Criteria2 = wb_b.Cells(j, 6)\n        wb_b.Cells(j, i).Value = Application.WorksheetFunction.SumIfs(sumRange, cRange1, Criteria1, cRange2, Criteria2)\n    Next j\nNext i\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 54541732, "answer_count": 1, "score": 1, "last_activity_date": 1549395668, "creation_date": 1549393939, "last_edit_date": 1549395668, "question_id": 54541486, "link": "https://stackoverflow.com/questions/54541486/why-is-my-vba-sumifs-function-returning-zeros", "title": "Why is my VBA SUMIFS function returning zeros?", "body": "<p>First, allow me to thank you for any help you are able to lend me. I appreciate it! (:</p>\n\n<p>My issue is this: I have two workbooks, one with raw data, and one in which the raw data is consolidated into relevant statistics. I am trying to SUMIFS the data in X:X in my raw data workbook (6620) by two criteria in the results book and then update the value in the corresponding cell in the results book.</p>\n\n<p>The problem is that the macro returns all zeros. I have double checked the data types, names, ranges, etc, but no luck. Leaving me to think there is something wonky in my code.</p>\n\n<p>I include two photos at the end of this post of example raw data and results tables so you can see what I am working from.</p>\n\n<pre><code>Sub ImportFTEs()\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n        Dim ws As Integer\n\n        Workbooks.Open Filename:=ActiveWorkbook.Path &amp; \"\\6620\\FY19*.xlsb\"\n            For ws = 1 To Worksheets.Count\n                Sheets(ws).Name = \"Sheet1\"\n            Next ws\n\n        Dim i As Integer\n        Dim j As Integer\n        Dim k As Integer\n        Dim l As Integer\n        Dim totalFTE As Long\n        Dim lastRow As Integer\n            lastRow = Cells(Rows.Count, \"D\").End(xlUp).Row\n        Dim wb_a As Worksheet\n            Set wb_a = Workbooks.Open(ActiveWorkbook.Path &amp; \"\\FY19*.xlsb\").Sheets(\"Sheet1\")\n        Dim wb_b As Worksheet\n            Set wb_b = ThisWorkbook.Sheets(\"B\")\n        Dim sumRange As Range\n            Set sumRange = wb_a.Range(\"X:X\")\n        Dim cRange1 As Range\n            Set cRange1 = wb_a.Range(\"D:D\")\n        Dim criteria1 As Range\n        Dim cRange2 As Range\n            Set cRange2 = wb_a.Range(\"S:S\")\n        Dim criteria2 As Range\n            For k = 8 To 18\n                For l = 7 To 18\n                    For i = 7 To 18\n                    Set criteria1 = wb_b.Cells(7, i)\n                        For j = 8 To 18\n                        Set criteria2 = wb_b.Cells(j, 6)\n                            wb_b.Cells(k, l).value = Application.WorksheetFunction.SumIfs(sumRange, cRange1, criteria1, cRange2, criteria2)\n                        Next j\n                    Next i\n                Next l\n            Next k\n    ActiveWorkbook.Close savechanges:=True\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\nEnd Sub    \n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/YnSSW.png\" alt=\"Raw Data Table\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/BGZJJ.png\" alt=\"Results Table\"></p>\n"}, {"tags": ["excel", "vba", "controls", "userform", "uppercase"], "answers": [{"tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 7, "last_activity_date": 1549393494, "creation_date": 1549393494, "answer_id": 54541369, "question_id": 54541144, "link": "https://stackoverflow.com/questions/54541144/how-to-maintain-cursor-position-when-enforcing-change-on-a-userform-textbox/54541369#54541369", "title": "How to maintain cursor position when enforcing Change() on a UserForm TextBox?", "body": "<p>Try using a different event, such as the following:</p>\n\n<pre><code>Private Sub TextBox_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)\n   If KeyAscii &gt;= 97 And KeyAscii &lt;= 122 Then 'a-z\n      KeyAscii = Asc(UCase(Chr(KeyAscii)))\n   End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11919, "user_id": 9183344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7r5r.png?s=128&g=1", "display_name": "r.ook", "link": "https://stackoverflow.com/users/9183344/r-ook"}, "edited": false, "score": 0, "creation_date": 1549393930, "post_id": 54541395, "comment_id": 95884138, "body": "Thanks! Also a nice implementation but I felt the <code>KeyPress</code> was a bit more readable to me, and I don&#39;t have to use another variable :)  Thank you though! +1"}, {"owner": {"reputation": 11919, "user_id": 9183344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7r5r.png?s=128&g=1", "display_name": "r.ook", "link": "https://stackoverflow.com/users/9183344/r-ook"}, "edited": false, "score": 0, "creation_date": 1549394246, "post_id": 54541395, "comment_id": 95884283, "body": "@MathieuGuindon good advice.  I understand explicit is better than implicit, but I&#39;ll confess I&#39;m not a programming expert so a lot of these &quot;philosophies&quot; whooshes me by without others&#39; expertise.  I&#39;ll take your comment to heart and consider these caveats in the future."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11919, "user_id": 9183344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7r5r.png?s=128&g=1", "display_name": "r.ook", "link": "https://stackoverflow.com/users/9183344/r-ook"}, "edited": false, "score": 1, "creation_date": 1549394332, "post_id": 54541395, "comment_id": 95884335, "body": "@Idlehands nah, that&#39;s what I get for reading the answers before the question - ignore my previous comment (deleted), Brian&#39;s approach is flawless. The problem with the caret position was caused by the handler rewriting the textbox&#39; contents, and this code has the same issue: correcting the caret position is indeed done like this (upvoted), but it shouldn&#39;t need to be done in the first place."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1549395340, "post_id": 54541395, "comment_id": 95884773, "body": "I also agree that Brian&#39;s approach is cleaner than mine (take your upvote!). I&#39;ll have to consider re-factoring some of my code if this situation comes up again. Correcting the cursor position was a solution I came up with when handling a situation that called for a numeric value in a text box that I wanted kept in a &#39;0.00&#39; format. In this situation, I am rewriting the textbox contents to keep the decimal place, but I have to account for cursor movements and insertions. It&#39;s a somewhat different situation that OP&#39;s above."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 3, "last_activity_date": 1549393570, "creation_date": 1549393570, "answer_id": 54541395, "question_id": 54541144, "link": "https://stackoverflow.com/questions/54541144/how-to-maintain-cursor-position-when-enforcing-change-on-a-userform-textbox/54541395#54541395", "title": "How to maintain cursor position when enforcing Change() on a UserForm TextBox?", "body": "<p>You can capture the cursor position using <code>SelStart</code>, then reset the cursor when you're done manipulating the text.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub TextBox1_Change()\n    Dim cursorPos As Long\n    cursorPos = Me.TextBox1.SelStart\n    Me.TextBox1.Text = UCase(Me.TextBox1.Text)\n    Me.TextBox1.SelStart = cursorPos\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    Cancel = True\n    Me.Hide\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11919, "user_id": 9183344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7r5r.png?s=128&g=1", "display_name": "r.ook", "link": "https://stackoverflow.com/users/9183344/r-ook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 1, "accepted_answer_id": 54541369, "answer_count": 2, "score": 5, "last_activity_date": 1549393570, "creation_date": 1549392491, "question_id": 54541144, "link": "https://stackoverflow.com/questions/54541144/how-to-maintain-cursor-position-when-enforcing-change-on-a-userform-textbox", "title": "How to maintain cursor position when enforcing Change() on a UserForm TextBox?", "body": "<p>Suppose I have this following code in my EXCEL VBA UserForm:</p>\n\n<pre><code>Private Sub TextBox_Change()\n\nTextBox.Value = UCase(TextBox.Value)\n\nOtherText.Value = \"FOO \" &amp; TextBox.value &amp; \" BAR\"\n\nEnd Sub\n</code></pre>\n\n<p>It forces the textbox to be always upper case, and works well <em>when users type from the end</em>.</p>\n\n<p>However say I was given a text <code>\"HELLO WORLD\"</code> and I wanted to <em>insert</em> <code>\"CRUEL \"</code> in between (typed manually by users), as soon as I type in <code>C</code>, the cursor would jump to after <code>D</code> and the end result would become <code>\"HELLO CWORLDRUEL \"</code> (if I typed blindly).</p>\n\n<p>The cursor position wouldn't change if I had caps lock on, but it defeats the purpose of the code... and with a lower case character it always kicks the cursor to the end.</p>\n\n<p><strong>Is there a way to maintain the cursor position for these type of forced-case changes?</strong></p>\n\n<p>I had considered using <code>_Exit()</code> method but I do want to keep both the <code>OtherText</code> and <code>TextBox</code> value uppercase with each change.  Otherwise <code>OtherText</code> would be all uppercase, while <code>TextBox</code> is still lowercase before the <code>_Exit()</code> is executed and it looks... undesirable.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 2, "creation_date": 1549392338, "post_id": 54541069, "comment_id": 95883343, "body": "You probably stopped the code at some point during debugging or due to an error before it got to wdApp.Quit. Check your Windows Task manager for instances of Word still running and end them."}, {"owner": {"reputation": 51, "user_id": 10450793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4ecbd167d821596dd2ab6f93b95615?s=128&d=identicon&r=PG&f=1", "display_name": "sgl", "link": "https://stackoverflow.com/users/10450793/sgl"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1549392706, "post_id": 54541069, "comment_id": 95883524, "body": "I have have tried that also a lot of times, but stil getting the same error.."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1549395756, "post_id": 54541069, "comment_id": 95884948, "body": "What line triggers the error message?"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 1, "creation_date": 1549396267, "post_id": 54541069, "comment_id": 95885185, "body": "You simply open it twice. Set wDoc = ... and With wDoc ....Documents.Open"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1549398021, "post_id": 54541069, "comment_id": 95885981, "body": "Agree with Asger. See here: <code>With wdDoc :              .Visible = True :              .Documents.Open (stPathTemplate)  :             .Activate</code>  It makes no sense to do <code>wdDoc.Documents.Open</code> to open the same document. That will certainly cause the error. You also should NOT use <code>.Activate : With ActiveDocument.Content</code> that immediately follows. If this should be the same document <code>wdDoc.Content</code> Would be the right approach. If this is supposed to be a different document (you actually want to open a different one) declare and assign an additional object variable, then use that."}, {"owner": {"reputation": 51, "user_id": 10450793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4ecbd167d821596dd2ab6f93b95615?s=128&d=identicon&r=PG&f=1", "display_name": "sgl", "link": "https://stackoverflow.com/users/10450793/sgl"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1549480991, "post_id": 54541069, "comment_id": 95921288, "body": "@CindyMeister Can you help me with the syntax that I have to use? Because when I&#39;m trying to remove the whole with wdDoc ... then the part with : .ActviveDocument Content Find wouldn&#39;t work ( even when I try to use your approache with wdDoc.Content. I don&#39;t know how to adjust the code so that it will work.."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1549481414, "post_id": 54541069, "comment_id": 95921468, "body": "For this question, delete that second line that tries to open the document again. That should solve <i>this</i> question. Then, if the code is still not giving you the end solution start a new question based on that."}, {"owner": {"reputation": 51, "user_id": 10450793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4ecbd167d821596dd2ab6f93b95615?s=128&d=identicon&r=PG&f=1", "display_name": "sgl", "link": "https://stackoverflow.com/users/10450793/sgl"}, "edited": false, "score": 0, "creation_date": 1549482774, "post_id": 54541069, "comment_id": 95922070, "body": "Thank you for that. The &quot;is locked for editing&quot; bug is solved, but now the code gives this error: &quot;Object doesn&#39;t support this property or method&quot; error at the line: .activedocument.contentfind ( it also gives the same error when I delete that line)."}], "owner": {"reputation": 51, "user_id": 10450793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4ecbd167d821596dd2ab6f93b95615?s=128&d=identicon&r=PG&f=1", "display_name": "sgl", "link": "https://stackoverflow.com/users/10450793/sgl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1549397781, "creation_date": 1549392198, "last_edit_date": 1549397781, "question_id": 54541069, "link": "https://stackoverflow.com/questions/54541069/trying-to-insert-a-table-from-excel-into-word-but-getting-the-error-file-is-loc", "title": "Trying to insert a table from Excel into Word but getting the error &quot;file is locked for editing..&quot; by myself?", "body": "<p>I'm trying to create a code that reads a dynamic Excel table into an existing Word document and changes some variables in the document (for example %Username%) </p>\n\n<p>The code below gives me an \"Locked for editing\" error by myself, but that isn't the case. </p>\n\n<p>Can someone see what I have to change in the code?</p>\n\n<p>The code is:</p>\n\n<pre><code>Sub Export_Table_Word()\n\n    'Word objects.\n    Dim wdApp As Word.Application\n    Dim wdDoc As Word.Document\n    Dim wdbmRange As Word.Range\n\n    'Excel objects.\n    Dim wbBook As Workbook\n    Dim wsSheet As Worksheet\n    Dim rnReport As Range\n\n    'Path of Word Template\n    Dim stPathTemplate As String\n    Dim stPathSave As String\n\n    'Dynamic Replace variables\n    Dim UserName As String\n    Dim StrFind\n    Dim StrRepl As String\n\n    'Loop variable\n    Dim i As Long\n\n    Dim msWord As Object\n    Set msWord = CreateObject(\"Word.Application\")\n\n    'Define replacement variables\n    UserName = Application.UserName\n\n     sFirst = Split(UserName, \" \")(0) 'Firstname                         'sFirst = Split(UserName, \",\")(1) 'Firstname\n    sLast = Split(UserName, \" \")(1)  'Lastname\n    sUserName = Left(sFirst, 1) &amp; sLast  'First letter of firstname and lastname\n    sFullName = sFirst &amp; \" \" &amp; sLast  'Full name\n\n    StrFind = \"%User_Name%,%Full_name%, %Date%\"   'Strings to be replaced in the word document\n    StrRepl = sUserName &amp; \"*\" &amp; sFullName &amp; \"*\" &amp; \" \" &amp; Date    'Replaced by\n\n    'Initialize Path word template\n    stPathTemplate = \"C:\\Users\\xxx\\Desktop\\VBA_TEST\\VBA_Automation.docx\"\n    stPathSave = \"C:\\Users\\xxx\\Desktop\\VBA_TEST\\Finished.docx\"\n\n    'Initialize the Excel objects.\n    Set wbBook = ThisWorkbook\n    Set wsSheet = wbBook.Worksheets(1)\n    Set rnReport = wsSheet.Range(\"D2:D7\")\n\n    'Initialize the Word objets.\n    Set wdApp = New Word.Application\n    Set wdDoc = wdApp.Documents.Open(stPathTemplate)\n    Set wdbmRange = wdDoc.Bookmarks(\"Report\").Range\n\n    'If the macro has been run before, clean up any artifacts before trying to paste the table in again.\n    On Error Resume Next\n    With wdDoc.InlineShapes(1)\n        .Select\n        .Delete\n    End With\n    On Error GoTo 0\n\n    'Turn off screen updating.\n    Application.ScreenUpdating = True\n\n    With wdDoc\n        .Visible = True\n        .Documents.Open (stPathTemplate)     \n        .Activate\n\n        With .ActiveDocument.Content.Find\n             .ClearFormatting\n             .Replacement.ClearFormatting\n\n            For i = 0 To UBound(Split(StrFind, \",\")) 'Loop to replace all the defined dynamic strings\n             .Text = Split(StrFind, \",\")(i)\n             .Replacement.Text = Split(StrRepl, \"*\")(i)\n             .Execute Replace:=wdReplaceAll\n            Next i\n\n            .Forward = True\n            .Wrap = 1               'FindContinue\n            .Format = False\n            .MatchCase = False\n            .MatchWholeWord = False\n            .MatchWildcards = False\n            .MatchSoundsLike = False\n            .MatchAllWordForms = False\n\n            .Execute Replace:=2    'wdReplaceAll (WdReplace Enumeration)       \n        End With\n    End With\n\n     'Copy the report to the clipboard.\n    rnReport.Copy\n\n    'Select the range defined by the \"Report\" bookmark and paste in the report from clipboard.     \n    With wdbmRange\n        .Select\n        .Paste    \n    End With\n\n    'Save and close the Word doc.\n    With wdDoc\n        '.Save\n        .SaveAs2 Filename:=stPathSave, _\n    FileFormat:=wdFormatXMLDocument, AddToRecentFiles:=False\n\n        .Close\n    End With\n\n    'Quit Word.\n    wdApp.Quit\n\n    'Null out your variables.\n    Set wdbmRange = Nothing\n    Set wdDoc = Nothing\n    Set wdApp = Nothing\n\n    'Clear out the clipboard, and turn screen updating back on.\n    With Application\n        .CutCopyMode = False\n        .ScreenUpdating = True\n    End With\n\n    MsgBox (\"Done\") \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1549391245, "post_id": 54540785, "comment_id": 95882830, "body": "Have you tried using <code>debug.print</code> to see the value of <code>Filepath </code> immediately before your <code>if</code> statement?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1549391649, "post_id": 54540785, "comment_id": 95883018, "body": "There is nothing wrong with the logic of how you are using <code>Exit Sub</code> in the <code>If</code> statement -- the problem is that your condition for exiting is never being met."}, {"owner": {"reputation": 9, "user_id": 10515481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1a32799ba7aae111a53dd508d4e419?s=128&d=identicon&r=PG&f=1", "display_name": "Geni O", "link": "https://stackoverflow.com/users/10515481/geni-o"}, "edited": false, "score": 0, "creation_date": 1549391875, "post_id": 54540785, "comment_id": 95883123, "body": "Any ideas for why the condition may not be met? I just used debug.print to check the value of the templateFile variable, and it matches the file name of the document I currently have open. What I am trying to do is prompt the user to save as if templateFile matches the name of the currently open file"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1549391978, "post_id": 54540785, "comment_id": 95883162, "body": "Place a breakpoint (F9) on the <code>If</code> statement, then run the code and when the breakpoint is hit, hover <code>Filepath</code> and then hover <code>templatefile</code>. Do they match?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1549392144, "post_id": 54540785, "comment_id": 95883246, "body": "If you are never seeing <code>MsgBox &quot;Please save template as different document&quot;</code> then <code>Filepath</code> is never equal to <code>templateFile</code>. Perhaps you just are not perceiving the difference (which could be in white space). For example, what is <code>debug.Print (Len(Filepath) = Len(templateFile))</code>?"}, {"owner": {"reputation": 9, "user_id": 10515481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1a32799ba7aae111a53dd508d4e419?s=128&d=identicon&r=PG&f=1", "display_name": "Geni O", "link": "https://stackoverflow.com/users/10515481/geni-o"}, "edited": false, "score": 0, "creation_date": 1549392221, "post_id": 54540785, "comment_id": 95883281, "body": "I&#39;ve just checked this and filepath is empty. Is there a particular methodology for getting the name of the currently open file into a variable?"}, {"owner": {"reputation": 487, "user_id": 10946960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4b4b026d8ded0102e23e33a72bc79d?s=128&d=identicon&r=PG&f=1", "display_name": "IrwinAllen13", "link": "https://stackoverflow.com/users/10946960/irwinallen13"}, "edited": false, "score": 1, "creation_date": 1549392259, "post_id": 54540785, "comment_id": 95883303, "body": "Just out of best practice, i would avoid using spaces in file paths. If you have to use a space, perhaps an underscore would be better suited."}, {"owner": {"reputation": 487, "user_id": 10946960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4b4b026d8ded0102e23e33a72bc79d?s=128&d=identicon&r=PG&f=1", "display_name": "IrwinAllen13", "link": "https://stackoverflow.com/users/10946960/irwinallen13"}, "edited": false, "score": 0, "creation_date": 1549392286, "post_id": 54540785, "comment_id": 95883316, "body": "to get the file path...check this out... <a href=\"https://stackoverflow.com/questions/2813925/how-to-get-the-path-of-current-worksheet-in-vba\" title=\"how to get the path of current worksheet in vba\">stackoverflow.com/questions/2813925/&hellip;</a>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1549392429, "post_id": 54540785, "comment_id": 95883395, "body": "You could use <code>ActiveWorkbook.FullName</code>"}, {"owner": {"reputation": 9, "user_id": 10515481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1a32799ba7aae111a53dd508d4e419?s=128&d=identicon&r=PG&f=1", "display_name": "Geni O", "link": "https://stackoverflow.com/users/10515481/geni-o"}, "edited": false, "score": 0, "creation_date": 1549392702, "post_id": 54540785, "comment_id": 95883521, "body": "Setting filepath equal to ActiveWorkbook.FullName fixed the issue. My beginner&#39;s mistake was thinking filepath was a function that automatically fetched the file path for you. Thanks a ton"}], "answers": [{"comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 3, "creation_date": 1549393058, "post_id": 54541053, "comment_id": 95883695, "body": "Interesting: What is your logic that allows for a <code>goto</code> to be cleaner/simpler? <code>Goto</code>s create spaghetti code that is anything but. Especially as this example is well served by an <code>If-The-Else-Endif</code>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1549395205, "post_id": 54541053, "comment_id": 95884710, "body": "@AJD Without seeing the other code to be entered where the comment was left in the posted snippit, I made a suggestion, which wasn&#39;t directly intended to answer the question.  From having others review my code, adding Goto items for items which exit sub, rather than using if-statements, was the general consensus or at least the common feedback I was given.  After a few years of having that beaten into my head, I suggested here.  I guess I should ask, have I had bad associates reviewing or does that seem reasonable?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1549455450, "post_id": 54541053, "comment_id": 95906666, "body": "You could read: <a href=\"http://www.u.arizona.edu/~rubinson/copyright_violations/Go_To_Considered_Harmful.html\" rel=\"nofollow noreferrer\">Goto Considered Harmful</a>. They tend to be frowned upon, though VBA itself is a bit of an old-school language in which at least occasionally a goto is the best option. I don&#39;t think that this is one of those occasions, but it is somewhat similar to VBA error handling and is readable enough. I&#39;ve never heard of Gotos being advocated like that. Perhaps you are working somewhere which has a large VBA code base which is written in a certain style and the intention is to enforce consistency?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1549460389, "post_id": 54541053, "comment_id": 95909655, "body": "@JohnColeman  I asked a few people and you seem to be spot on... apparently the previous Manager (primary reviewer) had that style, pretty much requiring it... since things get passed around between reviewers, the style was kept consistent, leading to that being listed as the &quot;best practice&quot; here.  We have one older fellow who can&#39;t remember if he learned that here or if that was something he was taught back in the day.  Thanks for the link and sorry to other folks who read this post when the suggestion for goto was still there; i have since edited."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": -2, "last_activity_date": 1549460153, "last_edit_date": 1549460153, "creation_date": 1549392155, "answer_id": 54541053, "question_id": 54540785, "link": "https://stackoverflow.com/questions/54540785/if-statement-that-cancels-sub-based-on-file-name/54541053#54541053", "title": "If Statement That Cancels Sub Based on File Name", "body": "<p><strong>Post edited after accepting per the discussion in the comments below.</strong></p>\n\n<hr>\n\n<p>Added Option Explicit and specified how to list the Filepath, which should keep things similar:</p>\n\n<pre><code>Option Explicit\nsub fdsa()\n    Dim templateFile As String, Filepath As String\n    Filepath = Application.ActiveWorkbook.path &amp; ActiveWorkbook.Name &amp; \".xlsm\"\n    templateFile = \"T:\\Sales and Subs Dept\\ARK - Dev\\ALPHA TEMPLATE w.o Loop.xlsm\"\n    If Filepath = templateFile Then \n        MsgBox \"Please save template as different document.\"\n        Exit Sub\n    Else\n        'run your macro where case isn't true\n    End If\nend sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10515481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1a32799ba7aae111a53dd508d4e419?s=128&d=identicon&r=PG&f=1", "display_name": "Geni O", "link": "https://stackoverflow.com/users/10515481/geni-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 54541053, "answer_count": 1, "score": 0, "last_activity_date": 1549460153, "creation_date": 1549391158, "last_edit_date": 1549437797, "question_id": 54540785, "link": "https://stackoverflow.com/questions/54540785/if-statement-that-cancels-sub-based-on-file-name", "title": "If Statement That Cancels Sub Based on File Name", "body": "<p>I am trying to implement and If statement where if it is true, a message box is displayed and the sub is not carried out and if it is true, the sub is carried out like normal.</p>\n\n<p>With my current code, the sub is always carried out, even though the If condition should be met. I am not sure where I have gone wrong:</p>\n\n<pre><code>Dim templateFile As String\ntemplateFile = \"T:\\Sales and Subs Dept\\ARK - Dev\\ALPHA TEMPLATE w.o Loop.xlsm\"\n\nIf Filepath = templateFile Then\n    MsgBox \"Please save template as different document\"\n    Exit Sub\nElse\n</code></pre>\n\n<p>All other code goes below the else and concludes with an End If.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": true, "score": 0, "last_activity_date": 1549391199, "creation_date": 1549391199, "answer_id": 54540794, "question_id": 54540740, "link": "https://stackoverflow.com/questions/54540740/provide-contextual-help-for-users-on-custom-functions-in-excel-formulas/54540794#54540794", "title": "Provide contextual help for users on custom functions in Excel formulas", "body": "<p>You can press <code>Ctl+Shift+A</code> after typing the function name and it will present the parameter names in the formula bar. If you want an actual tooltip to display, check out <a href=\"https://stackoverflow.com/questions/4262421/how-to-put-a-tooltip-on-a-user-defined-function\">this post.</a></p>\n"}], "owner": {"reputation": 835, "user_id": 4629624, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/218b21a18c900e28e458c815f9c04f5b?s=128&d=identicon&r=PG&f=1", "display_name": "V. Brunelle", "link": "https://stackoverflow.com/users/4629624/v-brunelle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "closed_date": 1549392153, "accepted_answer_id": 54540794, "answer_count": 1, "score": 1, "last_activity_date": 1549391199, "creation_date": 1549390902, "question_id": 54540740, "link": "https://stackoverflow.com/questions/54540740/provide-contextual-help-for-users-on-custom-functions-in-excel-formulas", "closed_reason": "Duplicate", "title": "Provide contextual help for users on custom functions in Excel formulas", "body": "<p>I wrote a custom Excel formula using VBA. It has more than one argument and it can be confusing for other users (and even for me) to remember what arguments to put in the formula. </p>\n\n<p>I know that default formulas show contextual help to users when they use it in a cell, like in this example with the French version of <code>=VLookup(</code>:\n<a href=\"https://i.stack.imgur.com/7ZXWE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7ZXWE.png\" alt=\"Contextual help for RECHERCHEV function in Excel\"></a></p>\n\n<p>Question: Is there a way to do the same with a custom function? If not, do you know something else that can provide users with help on custom functions in formulas?</p>\n\n<p>Here are some details that are probably irrelevant to the question, but might be useful for readers. </p>\n\n<p>The code of the function looks like this:</p>\n\n<pre><code>Function myFunction(a, b, c, d, Optional ByVal e As Long = 1)\n'some computations that return r\nmyFunction = r\nEnd Function\n</code></pre>\n\n<p>The function is in a module in the .xlsm document (this can be changed). It works in formulas as intended, using <code>=myFunction(a,b,c,d)</code> in a cell. The function is easy on the CPU usage and uses mostly basic Excel functions. </p>\n"}, {"tags": ["excel", "vba", "sqlite", "blob", "adodb"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1549400137, "post_id": 54540681, "comment_id": 95886866, "body": "Are you using proper <a href=\"https://stackoverflow.com/q/6028288/1422451\">error handling</a>? Do so to catch runtime exceptions. Even try catching <a href=\"https://stackoverflow.com/a/28618190/1422451\">ADODB errors</a>. Report back actual error messages."}, {"owner": {"reputation": 11, "user_id": 9118336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f574f3bae2983f9e0a47bec554939c66?s=128&d=identicon&r=PG&f=1", "display_name": "PMCallahan", "link": "https://stackoverflow.com/users/9118336/pmcallahan"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1549404841, "post_id": 54540681, "comment_id": 95888835, "body": "@Parfait. yes I have the code wrapped in a &quot;On Error GoTo&quot; block and it still just shuts down.  The only error i can see is to click the Debug option before it closes and open debugging in Visual Studio 2017 and it shows this error. &quot;Unhandled exception at 0x752A9B60 (msvcrt.dll) in EXCEL.EXE: 0xC0000005: Access violation reading location 0x08EF0000.&quot;  I will repost an edit with full.  I removed some stuff that i thought was unimportant. Thanks"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1549465664, "post_id": 54540681, "comment_id": 95912993, "body": "Your <i>Cleanup</i> handler does not report any error number or message: <code>MsgBox Err.Number &amp; &quot; -  &quot; &amp; Err.Description</code> (see links in my comment). In fact your <i>Cleanup</i> should be the exit handler as it cleans out <code>set</code> objects. The error handler should report message and then call exit handler: <code>Resume Cleanup</code>."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1549466964, "post_id": 54540681, "comment_id": 95913816, "body": "Also, please edit with your environment. What Windows version? What version of MS Office? Is it 32 or 64-bit? What version of SQLite? Is it 32 or 64-bit? Same with ODBC driver? Search and open &quot;odbc&quot;. Ideally all architectures should align."}, {"owner": {"reputation": 11, "user_id": 9118336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f574f3bae2983f9e0a47bec554939c66?s=128&d=identicon&r=PG&f=1", "display_name": "PMCallahan", "link": "https://stackoverflow.com/users/9118336/pmcallahan"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1549471179, "post_id": 54540681, "comment_id": 95916532, "body": "@Parfait. I understand the error handling is not correct.  The point is that it won&#39;t even jump to that section of the code though.  It just dies.  Ill edit with a picture to show you. Office 2016, Windows 7 64 bit, SQLite3 vers. 3.21.0. ODBC 64bit"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1549476057, "post_id": 54540681, "comment_id": 95919016, "body": "How large are these images? How large is the SQLite database? You may need to wait for streaming to end before moving to next row. Try retrieving only <b>one</b> image outside of <i>any</i> looping (in smaller test subroutine)."}, {"owner": {"reputation": 11, "user_id": 9118336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f574f3bae2983f9e0a47bec554939c66?s=128&d=identicon&r=PG&f=1", "display_name": "PMCallahan", "link": "https://stackoverflow.com/users/9118336/pmcallahan"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1549492523, "post_id": 54540681, "comment_id": 95926082, "body": "@Parfait. This is one of 2 records in the DB.  The image is 388kb. I tried one in a separate sub and still excel closed on me. Sadface"}], "owner": {"reputation": 11, "user_id": 9118336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f574f3bae2983f9e0a47bec554939c66?s=128&d=identicon&r=PG&f=1", "display_name": "PMCallahan", "link": "https://stackoverflow.com/users/9118336/pmcallahan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549471725, "creation_date": 1549390677, "last_edit_date": 1549471725, "question_id": 54540681, "link": "https://stackoverflow.com/questions/54540681/vba-read-bytes-from-sqlite-to-file", "title": "VBA read bytes from sqlite to file", "body": "<p>I am attempting to retrieve a BLOB value from SQLite3 through VBA.  The bytes were entered from a http return using Python. They represent an image(TIF) that will later be returned to the user. I will start by saying that, due to restrictions on the computers being used to perform this action, I will be using VBA/Excel to do so.  I have already completed this process through Python and C# to verify there is nothing wrong with the data I am pulling out. Now I need to get it in to VBA to make it easily distributable to the users.</p>\n\n<p>In VBA I am able to get the record values out and iterate over them as needed, but whenever i get to the byte value my Excel Immediate Window gives me the box that says </p>\n\n<blockquote>\n  <p>\"EXCEL NOT RESPONDING, RESTART OR DEBUG\" etc. </p>\n</blockquote>\n\n<p>I have done many different things too, not just try to write the bytes to a file. I have tried simply</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim byt() as bytes\nbyt = rcdset.Fields(\"IMAGE_STRING\").Value\n</code></pre>\n\n<p>Also</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>LenB(rcdset.Fields(\"IMAGE_STRING\").Value)\n</code></pre>\n\n<p>and even just </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Debug.Print rcdset.Fields(\"IMAGE_STRING\").Value\n</code></pre>\n\n<p>No matter what I am doing, when I step through the code that touches <code>rcdset.Fields(\"IMAGE_STRING\").Value</code> it stops.</p>\n\n<p>Current code/attempt:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim stream As New ADODB.stream\nOutFile = \"P:\\Testie.TIF\"\nstream.Type = adTypeBinary\nstream.Open\nstream.Write rcdset.Fields(\"IMAGE_STRING\").Value\nstream.SaveToFile (OutFile)\n</code></pre>\n\n<p>And of course, as soon as it gets to <code>stream.Write rcdset.Fields(\"IMAGE_STRING\").Value</code> and calls that value it goes down.  I have tried accessing the field all different ways such as <code>rcdset.Fields(\"IMAGE_STRING\")</code>, <code>\"rcdset(\"IMAGE_STRING\")</code>, etc.</p>\n\n<p>How can I create this image file? I go write over to python and do a simple</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>with open(f'''P:\\\\{name}.{ext}''', 'wb') as of:\n    of.write(bytes)\n</code></pre>\n\n<p>and it creates write away.  C# same with of course a little more code but no problem.  This is driving me NUTS.  Can VBA not handle this kind of data?</p>\n\n<p>Full code below and any help is appreciated!</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim file As New Scripting.FileSystemObject\nDim conn As New ADODB.Connection\nDim rcdset As New ADODB.Recordset\nDim stream As New ADODB.stream\n'Dim rec As New ADODB.Field\nDim filepath As String\nDim bytes As Byte\nDim connStr As String\nDim sql As String\nDim lastrow As Integer\nDim ScacRange As Range\nDim RowCounter As Integer\nDim Pro As String\nDim Carrier As String\nDim PaperType As String\nDim downloaded() As String\nDim i As Integer\nDim paperTitle As String\nDim fileLen As Long\nDim OutFile As String\nDim binlength As Long\n\nlastrow = Cells(Rows.Count, 1).End(xlUp).Row\nIf lastrow &gt; 501 Then\n    MsgBox \"You can only process 500 at one time.\", vbInformation\n    Exit Sub\nEnd If\n\nSet ScacRange = Range(Cells(2, 2), Cells(lastrow, 2))\n\nfilepath = Cells(1, 5).Value\n\n\nRowCounter = 2\nFor Each Scac In ScacRange\n    If Len(Trim(Scac.Value)) &lt;&gt; 4 Then\n        MsgBox \"Row \" &amp; CStr(RowCounter) &amp; \" does not contain a 4 letter Scac.  Please correct and try again.\"\n        Exit Sub\n    End If\n    RowCounter = RowCounter + 1\nNext Scac\n\nIf Not file.FolderExists(filepath) Then\n    MsgBox \"The folder '\" &amp; filepath &amp; \"' does not exist.  Please enter a valid folder.\", vbExclamation, \"File Path Error\"\n    Exit Sub\nEnd If\n\nconnStr = \"DRIVER=SQLite3 ODBC Driver;Database=Z:\\IMAGE.db\"\n\n\nOn Error GoTo Cleanup\n\n    conn.Open connStr\n\n    For Each Scac In ScacRange\n\n        If IsEmpty(Scac) Or IsEmpty(Scac.Offset(0, -1)) Or IsEmpty(Scac.Offset(0, 1)) Then\n            Scac.Offset(0, 2).Value = \"Not all values present. No image retreived\"\n            GoTo NextIter\n        End If\n\n        Pro = Trim(Scac.Offset(0, -1).Value)\n        Carrier = Trim(UCase(Scac.Value))\n        PaperType = Scac.Offset(0, 1).Value\n\n        If PaperType = \"BOTH\" Then\n            sql = \"SELECT IMAGE_ID, IMAGE_STRING, IMAGE_FILE_EXT FROM DOCUMENTS WHERE PRO_NUMBER = '\" &amp; Pro &amp; \"' AND SCAC = '\" &amp; Carrier &amp; \"' AND IMAGE_TYPE IN('BL','DR')\"\n            rcdset.Open sql, conn\n            If rcdset.BOF And rcdset.EOF Then\n                Scac.Offset(0, 2).Value = \"No Images available\"\n                rcdset.Close\n                GoTo NextIter\n            End If\n            rcdset.MoveFirst\n            i = 0\n            Do Until rcdset.EOF\n                paperTitle = rcdset.Fields(0).Value\n                ReDim Preserve downloaded(i)\n                downloaded(i) = paperTitle\n                OutFile = \"P:\\Testie.TIF\"\n                stream.Type = adTypeBinary\n                stream.Open\n                ''''''''''''The below line is where it breaks down''''''''''''''''''''''''''''\n                stream.Write rcdset.Fields(\"IMAGE_STRING\").Value\n                stream.SaveToFile OutFile, adSaveCreateOverWrite\n\n                'do work\n                i = i + 1\n                Debug.Print paperTitle\n                rcdset.MoveNext\n            Loop\n            rcdset.Close\n            Scac.Offset(0, 2).Value = Join(downloaded, \", \") &amp; \" downloaded to folder.\"\n            ReDim downloaded(0)\n        Else:\n            sql = \"SELECT IMAGE_ID, IMAGE_STRING FROM DOCUMENTS WHERE PRO_NUMBER = '\" &amp; Pro &amp; \"' AND SCAC = '\" &amp; Carrier &amp; \"' AND IMAGE_TYPE = '\" &amp; PaperType &amp; \"'\"\n            rcdset.Open sql, conn\n            If rcdset.BOF And rcdset.EOF Then\n                Scac.Offset(0, 2).Value = \"No Images available\"\n                rcdset.Close\n                GoTo NextIter\n            End If\n            rcdset.MoveFirst\n            Debug.Print rcdset.Fields(0).Value\n            'dow work\n            Scac.Offset(0, 2).Value = \"Downloaded to folder\"\n            rcdset.Close\n        End If\nNextIter:\n    Next Scac\n\nCleanup:\n\nIf IsObject(rcdset) Then\n    If rcdset.State = 1 Then\n        rcdset.Close\n    End If\n    Set rcdset = Nothing\nEnd If\n\nIf IsObject(conn) Then\n    If conn.State = 1 Then\n        conn.Close\n    End If\n    Set conn = Nothing\nEnd If\n\nIf IsObject(file) Then\n    Set file = Nothing\nEnd If\n</code></pre>\n\n<p>Error picture below</p>\n\n<p><a href=\"https://www.google.com/imgres?imgurl=https%3A%2F%2Fwww.stellarinfo.com%2Fblog%2Fwp-content%2Fuploads%2F2017%2F02%2FExcel-not-responding.png&amp;imgrefurl=https%3A%2F%2Fwww.stellarinfo.com%2Fblog%2Ffix-microsoft-excel-is-not-responding-error%2F&amp;docid=XoYYxJE6mc5PtM&amp;tbnid=coD0C_Y_q1La5M%3A&amp;vet=10ahUKEwiM-_2Yx6fgAhUptIMKHepGDLYQMwhBKAEwAQ..i&amp;w=363&amp;h=266&amp;client=firefox-b-1-d&amp;bih=944&amp;biw=1920&amp;q=excel%20not%20responding%20error&amp;ved=0ahUKEwiM-_2Yx6fgAhUptIMKHepGDLYQMwhBKAEwAQ&amp;iact=mrc&amp;uact=8\" rel=\"nofollow noreferrer\">https://www.google.com/imgres?imgurl=https%3A%2F%2Fwww.stellarinfo.com%2Fblog%2Fwp-content%2Fuploads%2F2017%2F02%2FExcel-not-responding.png&amp;imgrefurl=https%3A%2F%2Fwww.stellarinfo.com%2Fblog%2Ffix-microsoft-excel-is-not-responding-error%2F&amp;docid=XoYYxJE6mc5PtM&amp;tbnid=coD0C_Y_q1La5M%3A&amp;vet=10ahUKEwiM-_2Yx6fgAhUptIMKHepGDLYQMwhBKAEwAQ..i&amp;w=363&amp;h=266&amp;client=firefox-b-1-d&amp;bih=944&amp;biw=1920&amp;q=excel%20not%20responding%20error&amp;ved=0ahUKEwiM-_2Yx6fgAhUptIMKHepGDLYQMwhBKAEwAQ&amp;iact=mrc&amp;uact=8</a></p>\n\n<p>I got this picture from google.  Couldnt get my image embedded</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping", "screen-scraping"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1549389085, "post_id": 54540256, "comment_id": 95881790, "body": "<code>pt-000015</code> is a class element, not an id?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1549390404, "post_id": 54540256, "comment_id": 95882413, "body": "You can try <code>.getElementsByClassName</code> - instead of <code>getElementById</code>."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1549395234, "post_id": 54540256, "comment_id": 95884722, "body": "It&#39;s not XML, it&#39;s HTML.  Question title is misleading."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 1290451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff639e576fffbc74a387d93522d00ca8?s=128&d=identicon&r=PG", "display_name": "Mark Main", "link": "https://stackoverflow.com/users/1290451/mark-main"}, "edited": false, "score": 1, "creation_date": 1549423726, "post_id": 54543678, "comment_id": 95892970, "body": "Thank you, that is what I needed, just some info that gets me past this roadblock. I really appreciate the help."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1549403852, "creation_date": 1549403852, "answer_id": 54543678, "question_id": 54540256, "link": "https://stackoverflow.com/questions/54540256/how-to-parse-html-data-using-excel-vba/54543678#54543678", "title": "How to parse HTML data using Excel VBA", "body": "<p>You need</p>\n\n<pre><code>html.getElementsByClassName(\"pt-000015\")\n</code></pre>\n\n<p>It is plural as returns a collection and needs Name on the end.</p>\n"}], "owner": {"reputation": 7, "user_id": 1290451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff639e576fffbc74a387d93522d00ca8?s=128&d=identicon&r=PG", "display_name": "Mark Main", "link": "https://stackoverflow.com/users/1290451/mark-main"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 54543678, "answer_count": 1, "score": -3, "last_activity_date": 1549424128, "creation_date": 1549388853, "last_edit_date": 1549424128, "question_id": 54540256, "link": "https://stackoverflow.com/questions/54540256/how-to-parse-html-data-using-excel-vba", "title": "How to parse HTML data using Excel VBA", "body": "<p>I am new to parsing HTML data using excel VBA. Below is my code and some sample HTML. Notice in the HTML: pt-DefaultParagraphFont-000016&quot;&gt;oles and Responsibilities</p>\n\n<p>I want to open hundreds of similar internal web pages, and find the Roles and Responsibilities section and then start to grab certain data and paste it into various columns.</p>\n\n<p>I've modified my code below, it works now based upon what was recommended.</p>\n\n<p>By the way, just in case this helps others, I did discover a great fix for 'object invoked has disconnected' errors; here is the fix: Set ie = New InternetExplorerMedium</p>\n\n<pre><code>Option Explicit\nEnum READYSTATE\nREADYSTATE_UNINITIALIZED = 0\nREADYSTATE_LOADING = 1\nREADYSTATE_LOADED = 2\nREADYSTATE_INTERACTIVE = 3\nREADYSTATE_COMPLETE = 4\nEnd Enum\n\nSub ImportStackOverflowData()\n    Dim a As String\n    Dim i As Long\n    Dim ie As InternetExplorer\n    Dim html As HTMLDocument\n\n    'Set ie = New InternetExplorer 'replaced with InternetExplorerMedium to fix error\n    Set ie = New InternetExplorerMedium 'this fixes this error: The object invoked has disconnected from its client\n    ie.Visible = False\n    ie.navigate \"policy.myurl.com\"\n    Do While ie.READYSTATE &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Loop\n    Set html = ie.document\n\n    Dim tag As IHTMLElement\n    Dim tags As IHTMLElementCollection\n    Set tags = html.getElementsByClassName(\"pt-000015\")\n    For Each tag In tags\n        'more logic here\n    Next\n\n    Set html = ie.document\n    Set ie = Nothing\nEnd Sub\n</code></pre>\n\n<p>HTML SAMPLE:</P>\ndiv class=&quot;pt-000015&quot;&gt;&lt;p dir=&quot;ltr&quot; class=&quot;pt-PolicyMajorSectionHead&quot;&gt;&lt;span class=&quot;pt-DefaultParagraphFont-000016&quot;&gt;R&lt;/span&gt;&lt;a id=&quot;Roles&quot; class=&quot;pt-000002&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pt-DefaultParagraphFont-000016&quot;&gt;oles and Responsibilities&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;p dir=&quot;ltr&quot; class=&quot;pt-Normal&quot;&gt;&lt;span class=&quot;pt-000000&quot;&gt;&#160;&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; class=&quot;pt-Policy1stLevelSubhead&quot;&gt;&lt;span class=&quot;pt-DefaultParagraphFont-000005&quot;&gt;&lt;b&gt;Key Data Governance Roles&lt;/b&gt;&lt;/span&gt;&lt;a id=&quot;56GeneralSectionTitle_Optional_L2&quot; class=&quot;pt-000002&quot;&gt;&lt;/a&gt;&lt;/p&gt;&lt;a id=&quot;56GeneralSectionTitle_Optional_L2&quot; class=&quot;pt-000002&quot;&gt;&lt;/a&gt;&lt;p dir=&quot;ltr&quot; class=&quot;pt-PolicyText-000006&quot;&gt;&lt;span class=&quot;pt-DefaultParagraphFont-000007&quot;&gt;Data governance is a shared responsibility.&lt;/span&gt;&lt;</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1549388369, "post_id": 54539946, "comment_id": 95881462, "body": "You should completely nullify the problem by getting rid of <code>ThisWorkbook</code> and just use the workbook&#39;s full name (i.e. <code>Workbooks(&quot;Workbook1&quot;)</code>)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1549388640, "post_id": 54539946, "comment_id": 95881574, "body": "What&#39;s the name of <code>ThisWorkbook</code> file?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1549388876, "post_id": 54539946, "comment_id": 95881681, "body": "There is never, ever, <i>ever</i> a need to copy the <code>ThisWorkbook</code> reference to another variable. Use the <code>ThisWorkbook</code> identifier to refer to the workbook that embeds your VBA project, wherever you need to refer to that particular workbook. Using <code>ThisWorkbook</code> consistently will make the code much easier to read, maintain, and debug, than if the <code>ThisWorkbook</code> reference is <code>wkbkP</code> somewhere, then <code>wb</code> somewhere else, and <code>ThisWorkbook</code> in another place."}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1549388891, "post_id": 54539946, "comment_id": 95881689, "body": "Just to be sure: does source.xlsx opens when running macro? I woul also check FullName or Path to see what will in msgbox appear"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549389358, "post_id": 54539946, "comment_id": 95881927, "body": "Try <code>FullName</code>. Are they still the same? BTW that should be <code>MsgBox wkbk,Name</code>, not <code>MsgBox (wkbk.Name)</code> - these extraneous parentheses will inevitably cause headaches at one point or another, best lose the habit. What they are doing, is force-evaluate the <code>wkbk.Name</code> expression (returns a string), and then pass that value <code>ByVal</code> to the invoked procedure (here the <code>MsgBox</code> function). Notice the whitespace between <code>MsgBox</code> and the <code>(</code> - when parentheses <i>are</i> needed (e.g. when capturing the return value of a function), the VBE removes that space."}, {"owner": {"reputation": 11, "user_id": 11018932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3f28d45f4de9d7596cc9b1e3aa9d491?s=128&d=identicon&r=PG&f=1", "display_name": "user11018932", "link": "https://stackoverflow.com/users/11018932/user11018932"}, "edited": false, "score": 0, "creation_date": 1549389784, "post_id": 54539946, "comment_id": 95882128, "body": "Thank y&#39;all (really!) but It&#39;s still not working... I&#39;ve tried all yout suggestions but it keeps &quot;not reading&quot; the <code>wkbk</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549389999, "post_id": 54539946, "comment_id": 95882233, "body": "FWIW there is nothing wrong with your code, so your question is hard to answer without knowing what values you&#39;re expecting. Excel will not open two workbooks that have the same name - would you happen to have <code>On Error Resume Next</code> in your real/actual code? If so, remove it. And please <a href=\"https://stackoverflow.com/posts/54539946/edit\">edit</a> your post to include enough data (expected vs actual) and a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that we can use to reproduce the problem."}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 2, "creation_date": 1549390056, "post_id": 54539946, "comment_id": 95882250, "body": "Three questions and all you wrote is &quot;not working&quot;. So how can we help you?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1549390472, "post_id": 54539946, "comment_id": 95882436, "body": "Open that file regularly (not via VBA), then in the Immediate Window (press CTRL+G in the VBEditor), type <code>?ThisWorkbook.Name</code>. Does the expected name get returned?"}], "owner": {"reputation": 11, "user_id": 11018932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3f28d45f4de9d7596cc9b1e3aa9d491?s=128&d=identicon&r=PG&f=1", "display_name": "user11018932", "link": "https://stackoverflow.com/users/11018932/user11018932"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549396807, "creation_date": 1549387643, "last_edit_date": 1549396807, "question_id": 54539946, "link": "https://stackoverflow.com/questions/54539946/why-cant-i-set-another-workbook-excel-vba", "title": "Why can&#39;t I set another workbook? (Excel VBA)", "body": "<p>The macro is simple, but I have literaly NO IDEA what is going wrong! I've search everywhere for an answer but apparently no one else have had this same problem.</p>\n\n<p>Here it is:</p>\n\n<pre><code>Sub Test()\n\nDim wkbkP As Workbook\nDim wkbk As Workbook\n\nSet wkbkP = ThisWorkbook 'Principal workbook\nSet wkbk = Workbooks.Open(\"C:\\Users\\wb\\Desktop\\source.xlsx\")\n\nMsgBox (wkbkP.Name)\nMsgBox (wkbk.Name)\n\nEnd Sub\n</code></pre>\n\n<p>The ideia of the original macro is to use this <code>wkbk</code> as source for some data that I will use in the <code>wkbkP</code>.\nAnyway, I was testing to see if it was working, but apparently it's not \"reading\" or \"understanding\" this line</p>\n\n<pre><code>Set wkbk = Workbooks.Open(\"C:\\Users\\wb\\Desktop\\source.xlsx\")\n</code></pre>\n\n<p>cause when I ask it to show <code>wkbk</code>'s name in the MsgBox, it shows me the same name as the <code>ThisWorkbook</code>(and no, they are not the same file).</p>\n\n<p>Thanks for helping!</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1549387816, "last_edit_date": 1549387816, "creation_date": 1549387011, "answer_id": 54539786, "question_id": 54539560, "link": "https://stackoverflow.com/questions/54539560/how-do-i-check-if-a-value-a-user-is-entering-in-textbox-is-a-numeric-double/54539786#54539786", "title": "How do I check if a value a user is entering in Textbox is a numeric double?", "body": "<p>You can try using the lost focus event:</p>\n\n<pre><code>Private Sub TextBox1_LostFocus()\n    Dim blnNumber As Boolean\n    Dim strNumber As String\n\n    strNumber = TextBox1.Value\n    blnNumber = IsNumeric(strNumber)\n\n    If Not blnNumber Then\n        Me!TextBox1.Undo\n        MsgBox \"only numbers are allowed\"\n    Else\n        'And, if you want to force a decimal.\n        If InStr(strNumber, \".\") &lt; 1 Then\n            Me!TextBox1.Undo\n            MsgBox \"only doubles are allowed\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Also, check the Textbox1 element that you have listed in access.  Is it's name TextBox1? or something else?\n For example, in excel it is represented like the following: <code>=EMBED(\"Forms.TextBox.1\",\"\")</code> even though the name that the code references is TextBox1.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549388733, "post_id": 54540082, "comment_id": 95881611, "body": "Note: I&#39;m not familiar with Access - <a href=\"https://stackoverflow.com/a/54540115/1188513\">Erik&#39;s answer</a> should definitely be preferred in this case."}, {"owner": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 0, "creation_date": 1549389420, "post_id": 54540082, "comment_id": 95881950, "body": "@Mathieus, I have tried your code but I get a error in line: &quot;Private Sub TextBox1_KeyPress(ByVal keyAscii As MSForms.ReturnInteger)&quot; Do I need a any reference?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 0, "creation_date": 1549389516, "post_id": 54540082, "comment_id": 95881993, "body": "@WKI &quot;assuming this is a MSForms textbox control&quot; - looks like it&#39;s not the case then. I don&#39;t have MS-Access to test anything, but I can assure you that this code works flawlessly with a <code>UserForm</code>... I&#39;m guessing you have an Access form, which seems to be using another type of controls. See if there&#39;s a <code>KeyDown</code> or <code>KeyPress</code> event that can be handled in a similar way."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 0, "creation_date": 1549389824, "post_id": 54540082, "comment_id": 95882146, "body": "@WKI a quick search showed that it appears the Access-forms textboxes <i>do</i> have a <code>KeyDown</code> event, just a different signature. See edit."}, {"owner": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 0, "creation_date": 1549389840, "post_id": 54540082, "comment_id": 95882156, "body": "There is a KeyDown even Let me try and see!"}, {"owner": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 0, "creation_date": 1549390962, "post_id": 54540082, "comment_id": 95882675, "body": "I think I am getting there? Code added. Is there a way to enable the dotKey, Backkey, and EnterKey?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 0, "creation_date": 1549391244, "post_id": 54540082, "comment_id": 95882829, "body": "I don&#39;t think backspace or enter keys fire a <code>KeyDown</code> event (if they do then <code>vbKeyBack</code> (ascii 8) and <code>vbKeyReturn</code> (ascii 13) would do it). You might need a combination of <code>KeyDown</code> and <code>Change</code> handlers to handle these, and it gets rather complicated pretty fast. Note that the <code>vbKeyDot</code> (ascii 46) is manually declared here. Place a breakpoint (F9) in the event handler, see if the breakpoint is hit when you press such or such key, look at the value of the <code>KeyCode</code>, alter the procedure or validation logic accordingly."}, {"owner": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 0, "creation_date": 1549391403, "post_id": 54540082, "comment_id": 95882907, "body": "I see. Thanks for helping me out."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1549389762, "last_edit_date": 1549389762, "creation_date": 1549388123, "answer_id": 54540082, "question_id": 54539560, "link": "https://stackoverflow.com/questions/54539560/how-do-i-check-if-a-value-a-user-is-entering-in-textbox-is-a-numeric-double/54540082#54540082", "title": "How do I check if a value a user is entering in Textbox is a numeric double?", "body": "<p>Write a validator function (could be in its own <code>KeyInputValidator</code> class or module), so you can reuse this logic everywhere you need it, instead of copy/pasting it for every numeric textbox you need:</p>\n\n<pre><code>Option Explicit\nPrivate Const vbKeyDot As Integer = 46\n\n'@Description(\"returns true if specified keyAscii is a number, or if it's a dot and value doesn't already contain one\")\nPublic Function IsValidKeyAscii(ByVal keyAscii As Integer, ByVal value As String) As Boolean\n    IsValidKeyAscii = (keyAscii = vbKeyDot And InStr(1, value, Chr$(vbKeyDot)) = 0) Or (keyAscii &gt;= vbKey0 And keyAscii &lt;= vbKey9)\nEnd Function\n</code></pre>\n\n<p>Then use it in the textboxes' <code>KeyPress</code> event handler (assuming this is a <code>MSForms</code> textbox control) to determine whether or not to accept the input - since the event provides a <code>MSForms.ReturnInteger</code> object, that object's <code>Value</code> property can be set to <code>0</code> to \"swallow\" a keypress:</p>\n\n<pre><code>Private Sub TextBox1_KeyPress(ByVal keyAscii As MSForms.ReturnInteger)\n    If Not IsValidKeyAscii(keyAscii.Value, TextBox1.value) Then keyAscii.Value = 0\nEnd Sub\n</code></pre>\n\n<p>That way you don't need to undo any inputs, or pop any annoying warning or message boxes: the value in the field is guaranteed to be a valid numeric value!</p>\n\n<hr>\n\n<p>EDIT the above event handler signature is for a <code>MSForms</code> control. Looks like Access uses a different interface:</p>\n\n<pre><code>Private Sub TextBox1_KeyDown(KeyCode As Integer, Shift As Integer)\n</code></pre>\n\n<p>Here the <code>KeyCode</code> is passed <code>ByRef</code>, so you can alter it directly. In other words, this becomes the logic:</p>\n\n<pre><code>    If Not IsValidKeyAscii(KeyCode, TextBox1.value) Then KeyCode = 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1549388420, "post_id": 54540115, "comment_id": 95881482, "body": "Nice! I&#39;m thinking I should probably avoid Access questions (or start fiddling with it)"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1549388607, "post_id": 54540115, "comment_id": 95881563, "body": "@MathieuGuindon Please don&#39;t. Questions can have many answers, and yours might teach OP a valuable lesson about allowing only specific characters in a field. Mine just teaches OP to avoid VBA for simple input validation (Access has a lot of non-VBA features to validate input)."}, {"owner": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 0, "creation_date": 1549389358, "post_id": 54540115, "comment_id": 95881928, "body": "@Erik I did set the validation on the table but users have complained that there should be a way to undo the change. Currently they can only do so by using the Esc button but they usually have no idea what the Esc button is for."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 1, "creation_date": 1549400395, "post_id": 54540115, "comment_id": 95886974, "body": "@WKI If you have a formatting or validation rule on the field (like setting the format to <i>General Number</i>), that&#39;s very relevant information for the question. That would explain why your code wouldn&#39;t trigger, validation rules are evaluated before the <code>BeforeUpdate</code> event fires. You could consider removing the validation rule on the control, but not on the table, to allow your code to work."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 3, "last_activity_date": 1549388284, "creation_date": 1549388284, "answer_id": 54540115, "question_id": 54539560, "link": "https://stackoverflow.com/questions/54539560/how-do-i-check-if-a-value-a-user-is-entering-in-textbox-is-a-numeric-double/54540115#54540115", "title": "How do I check if a value a user is entering in Textbox is a numeric double?", "body": "<p>You shouldn't be using VBA for this task at all.</p>\n\n<p>Just set the field format property to <em>General number</em>. That's the built-in way to ensure users can only enter numbers in a field.</p>\n"}], "owner": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "accepted_answer_id": 54540115, "answer_count": 3, "score": 3, "last_activity_date": 1594620009, "creation_date": 1549386202, "last_edit_date": 1594620009, "question_id": 54539560, "link": "https://stackoverflow.com/questions/54539560/how-do-i-check-if-a-value-a-user-is-entering-in-textbox-is-a-numeric-double", "title": "How do I check if a value a user is entering in Textbox is a numeric double?", "body": "<p>I am trying to check if a user enters a number value in a textbox, decimal places accepted. Any help is highly appreciated.</p>\n\n<pre><code>Private Sub textbox1_AfterUpdate()\nIf IsNumeric(textbox1.Value) = False Then\nMe!textbox1.Undo\n    MsgBox \"only numbers are allowed\"\nExit Sub\nEnd If\nExit Sub\n</code></pre>\n\n<p>using BeforeUpdate event:</p>\n\n<pre><code>Private Sub textbox1_BeforeUpdate(Cancel As Integer)\nIf IsNumeric(textbox1.Value) = False Then\n    MsgBox \"only numbers are allowed\"\nMe!textbox1.Undo\nCancel = True\nExit Sub\nEnd If\nExit Sub\n</code></pre>\n\n<p>My current code does not execute at all. I have also tried it in the textbox1_BeforeUpdate event. Please see code.</p>\n\n<p>New Code:</p>\n\n<pre><code>Public Function IsValidKeyAscii(ByVal keyAscii As Integer, ByVal value As \nString) As Boolean\nIsValidKeyAscii = (keyAscii = vbKeyDot And InStr(1, value, Chr$(vbKeyDot)) = \n0) Or (keyAscii &gt;= vbKey0 And keyAscii &lt;= vbKey9)\nEnd Function\n\nPrivate Sub textbox1_KeyDown(KeyCode As Integer, Shift As Integer)\nIf Not IsValidKeyAscii(KeyCode, textbox1.value) Then KeyCode = 0\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1549386297, "post_id": 54539502, "comment_id": 95880325, "body": "<code>i</code> and <code>j</code> are equal to 0 on both of those lines - what is your intent?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1549386440, "post_id": 54539502, "comment_id": 95880402, "body": "Also, what is that first <code>ws</code> loop doing? It looks like you&#39;re attempting to name every worksheet in your workbook &quot;Sheet1&quot;? What is the purpose of <code>lastrow</code> here? Too many questions, not enough clarification..."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1549386507, "post_id": 54539502, "comment_id": 95880435, "body": "@dwirony, my intent was to shift the criteria down and across for the SUMIFS function with each loop.  And yes, the raw data workbook will only ever have one sheet, but it will have a random name. So I was trying to rename so I can then reference it."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1549386580, "post_id": 54539502, "comment_id": 95880465, "body": "Those <code>Set</code> lines need to be within your loops, if that is your intent. Otherwise you&#39;re setting them once and never returning to them. You should try stepping through your code line by line using F8 and you&#39;ll see what I mean :)"}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1549386665, "post_id": 54539502, "comment_id": 95880518, "body": "Turns out I have no idea what I am looking for when stepping through it. It appears to be working until I try to move through &quot;Set arg2C = wc.Cells(7, i)&quot;."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1549386994, "post_id": 54539502, "comment_id": 95880725, "body": "Regarding <code>Set</code>, so it should look something like  Edit: That does not format like I thought it would...  <code>...                     For i = 7 To 18                         Set arg2C = wc.Cells(7, i)                             For j = 8 To 18                                 Set arg3C = wc.Cells(j, 6)                                 ... </code>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1549387260, "post_id": 54539502, "comment_id": 95880879, "body": "Not quite - one moment"}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "edited": false, "score": 1, "creation_date": 1549387693, "post_id": 54539858, "comment_id": 95881125, "body": "This did the trick! No more errors!  Now I just need to figure out why all of the returned values are zero... ::sigh::  Thank you so much!"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 2, "last_activity_date": 1549387315, "creation_date": 1549387315, "answer_id": 54539858, "question_id": 54539502, "link": "https://stackoverflow.com/questions/54539502/why-am-i-receiving-error-1004-when-trying-to-specify-the-loop-variable-in-a-cell/54539858#54539858", "title": "Why am I receiving Error 1004 when trying to specify the loop variable in a cell reference?", "body": "<p>Should be something like this - you need the <code>Set</code> lines containing <code>i</code> and <code>j</code> <em>inside</em> their respective loops - that way the values actually increment (and aren't 0 when they're initialized):  </p>\n\n<pre><code>Option Explicit\nSub ImportFTEs()\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Workbooks.Open Filename:=ActiveWorkbook.Path &amp; \"\\6620\\FY19*.xlsb\"\n\n    Dim i As Long, j As Long, k As Long, l As Long\n    Dim totalFTE As Long\n\n    Dim wb As Worksheet\n    Set wb = Workbooks.Open(ActiveWorkbook.Path &amp; \"\\FY19*.xlsb\").Sheets(\"Sheet1\")\n\n    Dim wc As Worksheet\n    Set wc = ThisWorkbook.Sheets(\"B\")\n\n    Dim sum1R As Range\n    Set sum1R = wb.Range(\"X:X\")\n\n    Dim arg2R As Range\n    Set arg2R = wb.Range(\"D:D\")\n\n    Dim arg3R As Range\n    Set arg3R = wb.Range(\"S:S\")\n\n    Dim arg2C As Range\n    Dim arg3C As Range\n\n    For k = 8 To 18\n        For l = 7 To 18\n            For i = 7 To 18\n\n                Set arg2C = wc.Cells(7, i)\n\n                For j = 8 To 18\n\n                    Set arg3C = wc.Cells(j, 6)\n\n                    wc.Cells(k, l).Value = Application.WorksheetFunction.SumIfs(sum1R, arg2R, arg2C, arg3R, arg3C)\n\n                Next j\n            Next i\n        Next l\n    Next k\n\n    ActiveWorkbook.Close True\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 1, "accepted_answer_id": 54539858, "answer_count": 1, "score": 0, "last_activity_date": 1549407355, "creation_date": 1549386016, "last_edit_date": 1549407355, "question_id": 54539502, "link": "https://stackoverflow.com/questions/54539502/why-am-i-receiving-error-1004-when-trying-to-specify-the-loop-variable-in-a-cell", "title": "Why am I receiving Error 1004 when trying to specify the loop variable in a cell reference?", "body": "<p>I am stuck, primarily because I am still brand spanking new at VBA. As such, I really appreciate any help you can lend me. I have looked through many other Error 1004 posts on here, but they were either for different issues, or it is quite possible that I am just too ignorant to know what to do with the advice in them.</p>\n\n<p>My issue is this:  I have two workbooks, one with raw data, and one in which the raw data is consolidated into relevant statistics. I am trying to sumif the data in X:X in my raw workbook (6620) by two criteria in the statistics book and then update the value in the corresponding cell in the statistics book.</p>\n\n<p>I am running into a Run-time Error 1004: Application-defined or object-defined error at the indicated points. I am lost as to how to move past this.</p>\n\n<p>Any help is greatly appreciated!</p>\n\n<p>This is as far as I have gotten:</p>\n\n<pre><code>Option Explicit\n\nSub ImportFTEs()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\n    Dim ws As Integer\n\n    Workbooks.Open Filename:=ActiveWorkbook.Path &amp; \"\\6620\\FY19*.xlsb\"\n        For ws = 1 To Worksheets.Count\n            Sheets(ws).Name = \"Sheet1\"\n        Next ws\n\n        Dim i As Integer\n        Dim j As Integer\n        Dim k As Integer\n        Dim l As Integer\n        Dim totalFTE As Long\n        Dim lastRow As Integer\n            lastRow = Cells(Rows.Count, \"D\").End(xlUp).Row\n        Dim wb As Worksheet\n            Set wb = Workbooks.Open(ActiveWorkbook.Path &amp; \"\\FY19*.xlsb\").Sheets(\"Sheet1\")\n        Dim wc As Worksheet\n            Set wc = ThisWorkbook.Sheets(\"B\")\n        Dim sum1R As Range\n            Set sum1R = wb.Range(\"X:X\")\n        Dim arg2R As Range\n            Set arg2R = wb.Range(\"D:D\")\n        Dim arg2C As Range\n            Set arg2C = wc.Cells(7, i)\n                                 &gt;&gt;&gt; Error 1004\n        Dim arg3R As Range\n            Set arg3R = wb.Range(\"S:S\")\n        Dim arg3C As Range\n            Set arg3C = wc.Cells(j, 6)\n                                 &gt;&gt;&gt; Error 1004\n            For k = 8 To 18\n                For l = 7 To 18\n                    For i = 7 To 18\n                        For j = 8 To 18\n                            wc.Cells(k, l).value = Application.WorksheetFunction.SumIfs(sum1R, arg2R, arg2C, arg3R, arg3C)\n                        Next j\n                    Next i\n                Next l\n            Next k\n    ActiveWorkbook.Close savechanges:=True\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1549386093, "post_id": 54539434, "comment_id": 95880212, "body": "In the range you are pasting, columns C-E, is there always something in column C? If not, lastrow will not be increasing."}, {"owner": {"reputation": 3, "user_id": 11018844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5162b0b7e9212fb4270c125cf75c823?s=128&d=identicon&r=PG&f=1", "display_name": "M. Reeves", "link": "https://stackoverflow.com/users/11018844/m-reeves"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1549392219, "post_id": 54539434, "comment_id": 95883277, "body": "There is a table, Column C in the table does not contain values. The code above finds the last row, at row 308, adds 1, and inserts at row 309 correctly. It&#39;s just that it pastes all 4 instances one on top of the other...so I can watch each value getting copied to 309 rather than the list expanding to 310, 311,312, etc."}, {"owner": {"reputation": 3, "user_id": 11018844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5162b0b7e9212fb4270c125cf75c823?s=128&d=identicon&r=PG&f=1", "display_name": "M. Reeves", "link": "https://stackoverflow.com/users/11018844/m-reeves"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1549392563, "post_id": 54539434, "comment_id": 95883454, "body": "Additionally, the original table, column C was pasting Dates - I modified the structure of the table, because I was trying to copy over and transfer the values of a non-contiguous range...couldn&#39;t get it to work, so I restructured.   Even when I was coping only the first 2 columns, which worked before I restructured Column C to be blanks instead of the dates, it worked but same issue encountered - it kept overwriting the last row with each cell from the loop and the last occurrence is what remained at bottom of table."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1549392571, "post_id": 54539434, "comment_id": 95883463, "body": "If you use <code>.Cells(lastrow, &quot;C&quot;).Resize(TargtRng.Rows.Count, TargtRng.Columns.Count).Value = TargtRng.Cells.Value</code> does it work?"}, {"owner": {"reputation": 3, "user_id": 11018844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5162b0b7e9212fb4270c125cf75c823?s=128&d=identicon&r=PG&f=1", "display_name": "M. Reeves", "link": "https://stackoverflow.com/users/11018844/m-reeves"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1549392744, "post_id": 54539434, "comment_id": 95883543, "body": "So remove Set TargtRng through Sleep and apply the code change you recommended? I&#39;ll try that and let you know - one moment"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1549393144, "post_id": 54539434, "comment_id": 95883740, "body": "Duh have only just noticed that your line assigning <code>lastrow</code> is outside your loop. I needs to be after the If line."}, {"owner": {"reputation": 3, "user_id": 11018844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5162b0b7e9212fb4270c125cf75c823?s=128&d=identicon&r=PG&f=1", "display_name": "M. Reeves", "link": "https://stackoverflow.com/users/11018844/m-reeves"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1549393190, "post_id": 54539434, "comment_id": 95883764, "body": "I just tried that, and the macro runs - but it&#39;s causing the same issue. The last row keeps getting overwritten. So instead of 4 rows being copied over to the bottom, 1 row is added which reflects the values of the 4thlast row to be copied.  To me - it seemed like it&#39;s not recognizing the new last row prior to continued to the next cell in the loop. Or it&#39;s running too fast - but I tried adding a sleep to it, and that&#39;s how i was able to watch it overwrite in slow motion."}, {"owner": {"reputation": 3, "user_id": 11018844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5162b0b7e9212fb4270c125cf75c823?s=128&d=identicon&r=PG&f=1", "display_name": "M. Reeves", "link": "https://stackoverflow.com/users/11018844/m-reeves"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1549393326, "post_id": 54539434, "comment_id": 95883831, "body": "Let me move the last row"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1549393364, "post_id": 54539434, "comment_id": 95883848, "body": "I&#39;ve suggested some code below."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1549393186, "creation_date": 1549393186, "answer_id": 54541301, "question_id": 54539434, "link": "https://stackoverflow.com/questions/54539434/loop-to-transfer-values-to-bottom-of-range-is-erroneously-overwriting-values/54541301#54541301", "title": "Loop to transfer values to bottom of range is erroneously overwriting values", "body": "<p>Try this, slightly simplified, but most importantly with the last row variable inside the loop so that it updates as you copy more data across.</p>\n\n<pre><code>Sub test1()\n\nDim Cell As Range\nDim lastrow As Long\nDim TargtRng As Range\n\nWith Sheets(\"Data_Rates\")\n    For Each Cell In .Range(\"X4:X\" &amp; .Cells(.Rows.Count, \"X\").End(xlUp).Row)\n        If Cell.Value = 1 Then\n            lastrow = .Cells(Rows.Count, \"C\").End(xlUp).Row + 1\n            .Cells(lastrow, \"C\").Resize(, 4).Value = Cell.Resize(, 4).Value\n        End If\n    Next Cell\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11018844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5162b0b7e9212fb4270c125cf75c823?s=128&d=identicon&r=PG&f=1", "display_name": "M. Reeves", "link": "https://stackoverflow.com/users/11018844/m-reeves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 54541301, "answer_count": 1, "score": 0, "last_activity_date": 1549437729, "creation_date": 1549385839, "last_edit_date": 1549437729, "question_id": 54539434, "link": "https://stackoverflow.com/questions/54539434/loop-to-transfer-values-to-bottom-of-range-is-erroneously-overwriting-values", "title": "Loop to transfer values to bottom of range is erroneously overwriting values", "body": "<p>I have a range, used as a raw data dump from another macro. In this range, I want the vba to go through certain columns (column Q), when the criteria is 1, copy the target range and move to the bottom of a table. I don't know the vba for the table, so just identified the last row, added 1 to paste at the bottom of the table since the table will automatically resize.</p>\n\n<p>My code does everything I need except the following: each instance it finds, it is pasting at the bottom...but as it loops, it overwrites the last entry that was made at the bottom of the table instead of finding the new row and pasting below. I tried adding a sleep timer, and this is how i was able to see it overwriting but it did not resolve the issue.</p>\n\n<p>Data dump range:\nColumns W to AC\nValues start at row 4 to whatever last row is from data dump.\nColumn X - Criteria column, either 0 or 1. If 1 then data needs to be moved.\nColumns X through AA, of the criteria =1 is being moved from this area, to the Table.</p>\n\n<p>Table starts A3 for headers and down to row 309. If I have 5 entries from data dump, then I expect those values to be pasted below the table, starting in column C. Therefore expanding the row from 309 to 313.</p>\n\n<pre><code>Public Declare Sub Sleep Lib \"kernel32\" (ByVal milliseconds As Long)\n\nSub test1()\n    Dim Cell As Range\n    Dim lastrow As Long\n    Dim TargtRng As Range\n\n    With Sheets(\"Data_Rates\")\n        lastrow = Worksheets(\"Data_Rates\").Cells(Rows.Count, \"C\").End(xlUp).Row + 1\n\n        For Each Cell In .Range(\"X4:X\" &amp; .Cells(.Rows.Count, \"X\").End(xlUp).Row)\n            If Cell.Value = \"1\" Then\n                '.Range(Cell, Cell.Offset(, 3)).Copy Destination:=.Cells(lastrow, \"C\")\n                Set TargtRng = .Range(Cell, Cell.Offset(, 3))\n                .Range(Cells(lastrow, \"C\"), Cells(lastrow, \"E\")).Resize(TargtRng.Rows.Count, TargtRng.Columns.Count).Value = TargtRng.Cells.Value\n                Sleep (500)\n            End If\n        Next Cell\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1549385829, "post_id": 54539415, "comment_id": 95880054, "body": "What have you got so far?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1549385977, "post_id": 54539415, "comment_id": 95880142, "body": "Always helps to show your existing code."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11018839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5992a4017d0b8bd535c2d01e1d64063f?s=128&d=identicon&r=PG&f=1", "display_name": "Cpilot", "link": "https://stackoverflow.com/users/11018839/cpilot"}, "edited": false, "score": 0, "creation_date": 1549392044, "post_id": 54539553, "comment_id": 95883201, "body": "Understood on the &quot;Bottom to Top&quot;, that is exactly what I needed!  Thank you so much for the help! This was giving me fits for the last few days.  Much appreciated"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1549386186, "creation_date": 1549386186, "answer_id": 54539553, "question_id": 54539415, "link": "https://stackoverflow.com/questions/54539415/deleting-an-entire-row-based-on-the-value-in-a-cell-with-a-loop/54539553#54539553", "title": "Deleting an entire row based on the value in a cell with a loop", "body": "<p>GIve this a try:</p>\n\n<pre><code>Sub HKiller()\n    For i = 451 To 12 Step -1\n        If Cells(i, \"H\").Value = 0 Then Rows(i).Delete\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Note we work from bottom to top to avoid index problems.</p>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 2094936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29cc319504483f523512bb34f3f868fa?s=128&d=identicon&r=PG", "display_name": "Rupesh Nath", "link": "https://stackoverflow.com/users/2094936/rupesh-nath"}, "is_accepted": false, "score": 0, "last_activity_date": 1558358818, "creation_date": 1558358818, "answer_id": 56221963, "question_id": 54539415, "link": "https://stackoverflow.com/questions/54539415/deleting-an-entire-row-based-on-the-value-in-a-cell-with-a-loop/56221963#56221963", "title": "Deleting an entire row based on the value in a cell with a loop", "body": "<p>I am trying the same action i.e., deleting column if any one of the two columns cell has \"0\" then to delete the row. I have modified the above code.  kindly suggest.</p>\n\n<pre><code>    Sub test()\n    Dim Lastrow As Long, i As Long\n    'LastColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 0 To Lastrow Step 1\n        If Cells(i, \"E\" Or \"F\").Value = 0 Then Rows(i).Delete\n        Lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>Thanks  </p>\n"}], "owner": {"reputation": 1, "user_id": 11018839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5992a4017d0b8bd535c2d01e1d64063f?s=128&d=identicon&r=PG&f=1", "display_name": "Cpilot", "link": "https://stackoverflow.com/users/11018839/cpilot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 54539553, "answer_count": 2, "score": -1, "last_activity_date": 1558358818, "creation_date": 1549385758, "last_edit_date": 1549437601, "question_id": 54539415, "link": "https://stackoverflow.com/questions/54539415/deleting-an-entire-row-based-on-the-value-in-a-cell-with-a-loop", "title": "Deleting an entire row based on the value in a cell with a loop", "body": "<p>I am trying to write a macro/vba which will examine rows 12 - 451 in my excel sheet.  If Column \"H\" (in any of the stated rows) contains a value of zero then that row should be deleted. </p>\n\n<p>The Excel will be utilized for an upload program and we cannot have any zero values in column \"H\"</p>\n\n<p>I have a Macro recorded which populates the rows 12 - 451 (columns \"A\" through \"H\") with the required data, but am having issues with the piece of code I can add to the macro (at the end) which will loop back through and delete any row which has a value of zero in column \"H\".</p>\n\n<p>I have tried to record the \"delete\" Macro but cannot figure out how to make the code loop through each row and delete those with the zero value.</p>\n\n<ul>\n<li>NOTE - Column \"H\" values will vary with numerical data which will contain zero's within that data (i.e. 100,341.00).  This value should be kept.  It is only those cells which contain ONLY a \"0\" which should be eliminated.  Parenthesis are NOT included in the upload sheet...</li>\n</ul>\n\n<p>Please let me know if more info is needed.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "sum", "sumifs"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1549383398, "post_id": 54538617, "comment_id": 95878642, "body": "Where do you want the output?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1549383458, "post_id": 54538617, "comment_id": 95878670, "body": "Is the <code>Q ID</code> unique enough to use or do we need to include other columns to get a truly unique Key?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1549383551, "post_id": 54538617, "comment_id": 95878718, "body": "Your best bet is probably a pivot table"}, {"owner": {"reputation": 3, "user_id": 10648378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alexandra Cheatham", "link": "https://stackoverflow.com/users/10648378/alexandra-cheatham"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1549383577, "post_id": 54538617, "comment_id": 95878731, "body": "Output can be in the same sheet, just another column. Each course has Q IDs 1 through 26, so it&#39;s not truly unique."}, {"owner": {"reputation": 3, "user_id": 10648378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alexandra Cheatham", "link": "https://stackoverflow.com/users/10648378/alexandra-cheatham"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1549383656, "post_id": 54538617, "comment_id": 95878776, "body": "Unfortunately I need to be able to calculate the response percentage per question for my pivot table :/"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1549383696, "post_id": 54538617, "comment_id": 95878799, "body": "You can do that in a pivot table."}, {"owner": {"reputation": 3, "user_id": 10648378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alexandra Cheatham", "link": "https://stackoverflow.com/users/10648378/alexandra-cheatham"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1549384078, "post_id": 54538617, "comment_id": 95879014, "body": "How would I go about that? I haven&#39;t been able to figure out how to do that in my existing pivot table"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1549384122, "post_id": 54538617, "comment_id": 95879048, "body": "I don&#39;t have time to retype your data, and I can&#39;t copy paste a picture."}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1549384881, "creation_date": 1549384881, "answer_id": 54539135, "question_id": 54538617, "link": "https://stackoverflow.com/questions/54538617/excel-sum-dependent-values-based-on-multiple-criteria-in-repeating-pattern/54539135#54539135", "title": "Excel - Sum dependent values based on multiple criteria in repeating pattern", "body": "<p>Like @Scott Craner said, I believe a pivot table would do the trick for you here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zX5qP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zX5qP.png\" alt=\"img1\"></a></p>\n\n<p>The percentage column would be another instance of \"Resp Cnt\", where you show values as a % of Parent Row Total.</p>\n"}], "owner": {"reputation": 3, "user_id": 10648378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alexandra Cheatham", "link": "https://stackoverflow.com/users/10648378/alexandra-cheatham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 54539135, "answer_count": 1, "score": 0, "last_activity_date": 1549384881, "creation_date": 1549383294, "last_edit_date": 1549383355, "question_id": 54538617, "link": "https://stackoverflow.com/questions/54538617/excel-sum-dependent-values-based-on-multiple-criteria-in-repeating-pattern", "title": "Excel - Sum dependent values based on multiple criteria in repeating pattern", "body": "<p>I'm currently working with a dataset with a fairly unusual setup. I'm trying to sum the number of responses based on the course and question ID for 40k+ entries. Each question is broken into four response categories. I'm trying to sum the number of responses for each question so I can then break down the response percentage per question, per course. In the example below I'm trying to sum 6+1, 5+2, 5+2, 4+3, etc. But I have hundreds of course names, each with question IDs ranging from 1 to 26. </p>\n\n<p><img src=\"https://i.stack.imgur.com/xxpn9.png\" alt=\"Example\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1549381472, "post_id": 54537951, "comment_id": 95877516, "body": "You cannot <code>Then Goto Next i</code> Next i is not a label. You cannot have a Else with an inline If."}], "answers": [{"tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": true, "score": 4, "last_activity_date": 1549381393, "creation_date": 1549381393, "answer_id": 54538056, "question_id": 54537951, "link": "https://stackoverflow.com/questions/54537951/skip-iteration-column/54538056#54538056", "title": "Skip Iteration Column", "body": "<p>Don't use a <code>Goto</code> statement to skip iterations in a loop. use the opposite operator and only execute the code in the loop when the conditions are <code>True</code>.</p>\n\n<pre><code>For i = 1 To c\n\n    If vInputs(1, i) &gt; 22 Then \n        'set values\n        Range(\"j16\") = vInputs(1, i)\n        Range(\"n12\") = vInputs(4, i)\n\n        'copy output values into RESULTS array\n        vResults(1, i) = Range(\"h41\")\n        vResults(2, i) = Range(\"k41\")\n        vResults(3, i) = Range(\"z14\")\n    End if\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10941915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f509c168ce1bd5a67b09f88ab1bba35?s=128&d=identicon&r=PG&f=1", "display_name": "z-siddiqi", "link": "https://stackoverflow.com/users/10941915/z-siddiqi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 54538056, "answer_count": 1, "score": 0, "last_activity_date": 1549381460, "creation_date": 1549381009, "last_edit_date": 1549381460, "question_id": 54537951, "link": "https://stackoverflow.com/questions/54537951/skip-iteration-column", "title": "Skip Iteration Column", "body": "<p>The thing I am trying to do is if <code>vInputs(1, i)</code> is less than 22 I want the code to go to the next iteration column and if it's greater than 22 to just continue with the code.</p>\n\n<p>The problem is in the <code>If vInputs(1, i)...</code> line. Not sure what I am doing wrong:</p>\n\n<pre><code>Sub CreateTestResultTableV2()\n\nApplication.ScreenUpdating = False 'helps the code run faster\n\n\nDim vInputs, vResults()\nDim c As Integer, i As Integer\n\n'create INPUTS array\nc = Range(\"b5\").End(xlToRight).Column\nvInputs = Range(\"b5\", Cells(8, c))\n    'determine last value in the column\n    c = UBound(vInputs, 2)\n\n'create RESULTS array\nReDim vResults(1 To 3, 1 To c)\n\nFor i = 1 To c\n\n    If vInputs(1, i) &lt;= 22 Then GoTo Next i\n    Else\n        'set values\n        Range(\"j16\") = vInputs(1, i)\n        Range(\"n12\") = vInputs(4, i)\n\n            'copy output values into RESULTS array\n            vResults(1, i) = Range(\"h41\")\n            vResults(2, i) = Range(\"k41\")\n            vResults(3, i) = Range(\"z14\")\n\nNext i\n\nRange(\"e47\").Resize(3, c) = vResults\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "sum", "sumifs"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1549381138, "post_id": 54537909, "comment_id": 95877310, "body": "If you manually sort then a simple formula will get you the values."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1549381827, "post_id": 54538065, "comment_id": 95877706, "body": "Combo of yours and mine is probably the shortest: <code>=IF(OR(A2&lt;&gt;A3,B2&lt;&gt;B3),SUMIFS(C:C,A:A,A2,B:B,B2),&quot;&quot;)</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1549383579, "post_id": 54538065, "comment_id": 95878734, "body": "@ScottCraner Ah yes, of course, if we assume sorted data. I was assuming non sorted data."}, {"owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1549392899, "post_id": 54538065, "comment_id": 95883619, "body": "I&#39;m trying to put this in a macro using VBA code, will this still work for workbooks that have 80,000 lines and some of the sorted combinations may be up to 200 instances?  I&#39;m not going to know where a grouping will start and stop."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1549393350, "post_id": 54538065, "comment_id": 95883843, "body": "@BonnieZ I think you misunderstood how this site works. This is no code writing service. If you need it in VBA you will need to write that code yourself. But I recommend to use the formula (it will work for many rows, maybe takes some time to calculate, but it will work), then copy the total column and paste it as values in the same place (which converts formulas into values). Then filter by total column to get only the rows with a value <code>&gt;0</code> (in column total) and copy/past the filtered data into a new sheet. done."}, {"owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1549393451, "post_id": 54538065, "comment_id": 95883899, "body": "Also, forgot to add that once the like combos are summed Inam going to need to delete all but the last line of the grouping where the summation is noted to reduce the total lines to just one line  per grouping.  So il n this example I would end up with. 1350.  210.  12 for the 1st group.  1350. 100.  3 for 2nd group,  1352 105 10 for 3rd group, ect.  (Sorry for poor format, I&#39;m typing this on my phone. Hope you get the idea though. )"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1549393541, "post_id": 54538065, "comment_id": 95883956, "body": "@BonnieZ See my comment above. And please also review your old questions and mark the answers that helped you as solution. You might benefit from taking the <a href=\"https://stackoverflow.com/tour\">tour</a> to see how this site works. Grouping is done by sorting!"}, {"owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 1, "creation_date": 1549434095, "post_id": 54538065, "comment_id": 95895700, "body": "I apologize, I wasn&#39;t intending to treat this as a code writing service, I just wasn&#39;t sure how to translate the code into the RC format that VBA was needing but didn&#39;t realize that if I used the record macro option that it would change the letter/number cells references to the RC references in the formula.  I appreciate the help, the formula worked perfectly."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1549381425, "creation_date": 1549381425, "answer_id": 54538065, "question_id": 54537909, "link": "https://stackoverflow.com/questions/54537909/summing-a-variable-range/54538065#54538065", "title": "Summing a variable range", "body": "<p>Use this formula in D2 and pull it down:</p>\n\n<pre><code>=IF(COUNTIFS(A3:$A$1048576,A2,B3:$B$1048576,B2)=0,SUMIFS(C:C,A:A,A:A,B:B,B:B),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/sZLr8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sZLr8.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1549381651, "creation_date": 1549381651, "answer_id": 54538135, "question_id": 54537909, "link": "https://stackoverflow.com/questions/54537909/summing-a-variable-range/54538135#54538135", "title": "Summing a variable range", "body": "<p>IN D2 and pull down:</p>\n\n<pre><code>=IF(OR(A2&lt;&gt;A3,B2&lt;&gt;B3),SUM($C$2:C2)-SUM($D$1:D1),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/FDw5S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FDw5S.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "accepted_answer_id": 54538065, "answer_count": 2, "score": 0, "last_activity_date": 1549381651, "creation_date": 1549380882, "last_edit_date": 1549381481, "question_id": 54537909, "link": "https://stackoverflow.com/questions/54537909/summing-a-variable-range", "title": "Summing a variable range", "body": "<p>I'm needing to figure out how to sum a count who's length changes depending on criteria from other columns. I'm combining results from multiple spreadsheets.  There will be duplicates in Columns A &amp; B that I need to group then add the Count in Columns C together to get a total for both and the total needs to be reflected on the last line of the grouping.   Source example:</p>\n\n<pre><code>Building#     Room#   Count    \n1350          210      4    \n1350          210      6    \n1350          210      2    \n1350          100      3    \n1352          105      7    \n1352          105      3    \n1352          201      10\n</code></pre>\n\n<p>The results that I need to get needs to look like the below:</p>\n\n<pre><code>Building#     Room#   Count    Total    \n1350          210      4    \n1350          210      6    \n1350          210      2        12    \n1350          100      3         3    \n1352          105      7    \n1352          105      3        10    \n1352          201      10       10\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 3680803, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8f0124df588aa09bb16727605c936a81?s=128&d=identicon&r=PG&f=1", "display_name": "arooney88", "link": "https://stackoverflow.com/users/3680803/arooney88"}, "edited": false, "score": 1, "creation_date": 1549395456, "post_id": 54537985, "comment_id": 95884815, "body": "This worked perfectly. Didn&#39;t even think about the global aspect of the form. I will check into the MVC framework, thanks for the links!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1549381467, "last_edit_date": 1549381467, "creation_date": 1549381135, "answer_id": 54537985, "question_id": 54537796, "link": "https://stackoverflow.com/questions/54537796/excel-userform-run-time-error-when-trying-to-launch-a-2nd-time-after-initial-ca/54537985#54537985", "title": "Excel Userform Run-Time Error when trying to launch a 2nd time after initial &#39;Cancel&#39; or close on red &#39;X&#39;", "body": "<p>This is the <strong>easiest quick and dirty</strong> solution:</p>\n\n<p>Delete <code>Public form As New CheckOutForm</code> from the code. Then add it in the <code>testFormOptions()</code>:</p>\n\n<pre><code>Sub testFormOptions()\n    Dim form As New CheckOutForm\n    form.Show\nEnd Sub\n</code></pre>\n\n<p>Some not-that-good VBA books/tutorials would even go a bit like this, but this is brutal:</p>\n\n<pre><code>Sub testFormOptions()\n    CheckOutForm.Show\nEnd Sub\n</code></pre>\n\n<p>Anyway, now the problem with the predefined values in the form is solved. </p>\n\n<hr>\n\n<p>For the <strong>clean and not-so-easy solution</strong>, consider writing a MVC framework around the form:</p>\n\n<ul>\n<li><p><a href=\"https://codereview.stackexchange.com/questions/154401/handling-dialog-closure-in-a-vba-user-form\">https://codereview.stackexchange.com/questions/154401/handling-dialog-closure-in-a-vba-user-form</a></p></li>\n<li><p><a href=\"https://www.vitoshacademy.com/vba-the-perfect-userform-in-vba/\" rel=\"nofollow noreferrer\">this blogpost</a> (disclaimer - mine!), which pretty much says what the above link proposes, but it does not have the errors from the question.</p></li>\n<li><p><a href=\"https://riptutorial.com/vba/example/19036/best-practices\" rel=\"nofollow noreferrer\">the old StackOverflow tutorial for UserForms</a></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1549381553, "creation_date": 1549381553, "answer_id": 54538110, "question_id": 54537796, "link": "https://stackoverflow.com/questions/54537796/excel-userform-run-time-error-when-trying-to-launch-a-2nd-time-after-initial-ca/54538110#54538110", "title": "Excel Userform Run-Time Error when trying to launch a 2nd time after initial &#39;Cancel&#39; or close on red &#39;X&#39;", "body": "<p>If you execute <code>Unload</code>, you destroy the form object. With other words, your (global) variable <code>form</code> gets invalid and if you issue a new <code>form.show</code>, you get the runtime error.<br>\nWhen, on the other hand, you just <code>unhide</code> the form, the form-object stays valid (it's just currently not visible) and all controls keep their value.</p>\n\n<p>Either you do some housekeeping by resetting all controls when a form is displayed (use the <code>UserForm_Activate</code>-event), or you have to create a new form-object every time you want to display it (I would strongly advice not to use the name <code>form</code> as variable name to avoid confusion).</p>\n\n<pre><code>Sub testFormOptions()\n    dim myForm as CheckOutForm\n    myForm.Show\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 3680803, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8f0124df588aa09bb16727605c936a81?s=128&d=identicon&r=PG&f=1", "display_name": "arooney88", "link": "https://stackoverflow.com/users/3680803/arooney88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 54537985, "answer_count": 2, "score": 1, "last_activity_date": 1549381767, "creation_date": 1549380523, "last_edit_date": 1549381767, "question_id": 54537796, "link": "https://stackoverflow.com/questions/54537796/excel-userform-run-time-error-when-trying-to-launch-a-2nd-time-after-initial-ca", "title": "Excel Userform Run-Time Error when trying to launch a 2nd time after initial &#39;Cancel&#39; or close on red &#39;X&#39;", "body": "<p>Problem: I am building a Userform that has a 'Submit' and 'Cancel' button. I want the entire form to clear any entered data and close the form if the user hits the 'Cancel' button but I also am trying to build in the same functionality if the user hits the red 'X' in the top right corner. I'm unclear where I need to unload the form. I currently have it placed within the <code>btnCancel_Click()</code> method and I'm able to launch the form, enter some data and hit Cancel and it will close the form down. </p>\n\n<p>But when I try to re-launch the form a 2nd time I get an error (I attached a picture of that message) that says</p>\n\n<blockquote>\n  <p>\"Run-Time error '-2177418105 (80010007): Automation Error - The Callee (server [not server application]) is not available and disappeared; all connections are invalid. The call may have executed.</p>\n</blockquote>\n\n<p>If I remove <code>Unload Me</code> from <code>btnCancel_Click()</code> then the form can close and re-open just fine, but any data I entered the first time will still be on the form and isn't cleared properly. I'm wondering if this is an <code>Unload Me</code> error or do I need to reset all form controls when I initialize the form?</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n  ' how was the form closed?\n  ' vbFormControlMenu = X in corner of title bar\n  If CloseMode = vbFormControlMenu Then\n    ' cancel normal X button behavior\n    Cancel = True        \n    ' run code for click of Cancel button\n    btnCancel_Click\n  End If\nEnd Sub\n'******************************************************************\nPrivate Sub btnCancel_Click()\n    mbCancel = True\n    Me.Hide\n    Unload Me\n\nEnd Sub\n'*********************************************************************\nPrivate Sub UserForm_Initialize()\n'Populate values for 2 combo boxes\nlastEmp = Sheets(\"Form_Ref\").Cells(Rows.Count, 1).End(xlUp).Row\nMe.cmbBoxEmpName.List = Sheets(\"Form_Ref\").Range(\"A2:A\" &amp; lastEmp).Value\n\nlastBld = Sheets(\"Form_Ref\").Cells(Rows.Count, 2).End(xlUp).Row\nMe.cmbBoxBuildingName.List = Sheets(\"Form_Ref\").Range(\"B2:B\" &amp; lastBld).Value\n\nEnd Sub\n'******************************************************************\nPublic form As New CheckOutForm\nSub testFormOptions()\n'Button pressed within Excel will start program and show the userform\nform.Show\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/oOSx7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oOSx7.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 74, "user_id": 10676702, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ADp6rVVBQj0/AAAAAAAAAAI/AAAAAAAAA9Y/EEEltLR0pag/photo.jpg?sz=128", "display_name": "Rodrigo Moraes", "link": "https://stackoverflow.com/users/10676702/rodrigo-moraes"}, "edited": false, "score": 0, "creation_date": 1549379713, "post_id": 54537323, "comment_id": 95876395, "body": "Hi Mustafa, I generally use Userform_Activate(), that execute the code everytime Userform.Show is called, better than Userform_Load... to close the form, I use Me.Hide, try to check if you don\u2019t renamed the form CommandButton_1 my clue is because generally is Private Sub when you click in a button"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 3, "creation_date": 1549379863, "post_id": 54537323, "comment_id": 95876503, "body": "Are you sure you haven&#39;t changed the name of CommandButton1?"}, {"owner": {"reputation": 3, "user_id": 2074059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbe2a978efdf936cba5bf067e8047f7?s=128&d=identicon&r=PG", "display_name": "Mustafa Sinasi Erol", "link": "https://stackoverflow.com/users/2074059/mustafa-sinasi-erol"}, "edited": false, "score": 0, "creation_date": 1549396465, "post_id": 54537323, "comment_id": 95885270, "body": "Yes, I am sure, I did not change the name. I only changed the caption."}, {"owner": {"reputation": 3, "user_id": 2074059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbe2a978efdf936cba5bf067e8047f7?s=128&d=identicon&r=PG", "display_name": "Mustafa Sinasi Erol", "link": "https://stackoverflow.com/users/2074059/mustafa-sinasi-erol"}, "edited": false, "score": 0, "creation_date": 1549397642, "post_id": 54537323, "comment_id": 95885808, "body": "I will try it. Thanks for the hint/recomendation."}, {"owner": {"reputation": 3, "user_id": 2074059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbe2a978efdf936cba5bf067e8047f7?s=128&d=identicon&r=PG", "display_name": "Mustafa Sinasi Erol", "link": "https://stackoverflow.com/users/2074059/mustafa-sinasi-erol"}, "edited": false, "score": 0, "creation_date": 1549441921, "post_id": 54537323, "comment_id": 95898850, "body": "Hi, someone from my office offered to build a new form (UserForm3) then create all controls and empty subs there and copy my existing code into those subs. This was funny but I gave it a chance. There is no logical explanation for this but UserForm3 is doing exactly as expected.      Rodrigo Moraes thanks for your recommendation I will also try it."}], "owner": {"reputation": 3, "user_id": 2074059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbe2a978efdf936cba5bf067e8047f7?s=128&d=identicon&r=PG", "display_name": "Mustafa Sinasi Erol", "link": "https://stackoverflow.com/users/2074059/mustafa-sinasi-erol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1549437347, "creation_date": 1549379071, "last_edit_date": 1549437347, "question_id": 54537323, "link": "https://stackoverflow.com/questions/54537323/can-not-run-commandbutton1-click-in-excel-vba", "title": "can not run CommandButton1_Click in excel VBA", "body": "<p>I am almost a newbie for Excel VBA. \nI am trying to display values of some cells from a worksheet on the UserForm2 and unload the form when user clicks the CommandButton1.\nTo avoid building a class for my controls, I am starting with a draft UserForm where all the components I will need are placed on it.\nI set the positions of the text boxes, fill them in, set the position of the CommandButton1. These are all Ok, all shows up as expected/planned.\nwhen I click the CommandButton1 on form I hear a \"Ding\" and the \"clicked CB1\" message - which I expect to see - is not displayed.\nWhat is that I am doing wrong or what is missing?</p>\n\n<pre><code>Option Explicit\nPublic leftOfForm As Long\nPublic topOfForm As Long\nPublic widthOfForm As Long\nPublic heightOfForm As Long\n' ***********************************\nDim numInfoMessages  As Long\nDim heightBox As Long\nDim lengthTextbox As Long\nDim lengthCommandButton As Long\nDim numberOfScreenRows As Long\nDim horizantalPadding As Long\nDim verticalPadding As Long\nDim indexLoop As Integer\nDim contr As Control\nDim theFontSize As Integer\n\nPublic Sub CommandButton1_Click()\n'\n'   Just to confirm it is ok --- current userform will be unloaded\n'\n    MsgBox \"clicked CB1\"\nEnd Sub\n\nPublic Sub UserForm_initialize()\n'\n'   Save forms current info - not needed in fact\n'\n    theFontSize = 12\n    leftOfForm = UserForm2.Left\n    topOfForm = UserForm2.top\n    widthOfForm = UserForm2.Width\n    heightOfForm = UserForm2.Height\n    numInfoMessages = 6\n'\n'  Calculate userform size based on number of lines to be displayed\n'\n    heightBox = 25\n    lengthTextbox = 500\n    lengthCommandButton = 90\n    verticalPadding = 20\n    horizantalPadding = 15\n    numberOfScreenRows = (numInfoMessages + 1) * 2 + 1\n'\n'   Resize form according to the results\n'\n    UserForm2.Width = horizantalPadding * 3 + lengthTextbox + 10\n    UserForm2.Height = verticalPadding * (numberOfScreenRows + 2)\n    UserForm2.top = 0\n    UserForm2.Left = 0             \n'\n'   Fill in and allocate the text boxes\n'\n    indexLoop = 1\n    For Each contr In UserForm2.Controls\n        If TypeName(contr) = \"TextBox\" Then\n            contr.top = (indexLoop) * 2 * verticalPadding\n            contr.Left = horizantalPadding\n            contr.Width = lengthTextbox\n            contr.Height = heightBox\n            contr.BorderStyle = 1\n            contr.Text = ThisWorkbook.Worksheets(ThisWorkbook.messagesPageName).Range(\"B\" &amp; indexLoop + 1).Value\n            contr.WordWrap = False\n            contr.MultiLine = False\n            contr.Font.Size = theFontSize\n            indexLoop = 1 + indexLoop\n        End If\n    Next\n'\n'   Allocate the command button\n'\n    For Each contr In UserForm2.Controls\n        If TypeName(contr) = \"CommandButton\" Then\n            contr.top = (indexLoop) * 2 * verticalPadding\n            contr.Width = lengthCommandButton\n            contr.Height = heightBox\n            contr.Width = lengthCommandButton\n            contr.Left = UserForm2.Width / 2 - contr.Width / 2\n            contr.top = (indexLoop) * 2 * verticalPadding\n            contr.Font.Size = theFontSize\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1549380211, "post_id": 54537162, "comment_id": 95876725, "body": "Also note that you can remove <code>If i = lastRow + 1 Then Stop</code> because this will never happen in this loop."}], "answers": [{"tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": false, "score": 2, "last_activity_date": 1549380242, "last_edit_date": 1549380242, "creation_date": 1549379408, "answer_id": 54537430, "question_id": 54537162, "link": "https://stackoverflow.com/questions/54537162/macro-to-duplicate-rows-previously-worked-now-not-working-but-no-error-message/54537430#54537430", "title": "macro to duplicate rows previously worked, now not working but no error message?", "body": "<p>You're never entering the loop due to the fact that </p>\n\n<pre><code>For i = 2 to i = lastRow Step 2\n</code></pre>\n\n<p>is functionally the same as </p>\n\n<pre><code>For i = 2 to False Step 2\n</code></pre>\n\n<p>Since <code>False</code> evaluates to 0, it's really saying </p>\n\n<pre><code>For i = 2 to 0 Step 2\n</code></pre>\n\n<p>and so it never enters the loop.</p>\n\n<p>Just change it to</p>\n\n<pre><code>For i = 2 To lastRow Step 2\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Just for clarity, whether the statement evaluates <code>True</code> or <code>False</code>, it still won't enter the loop as <code>False</code> evaluates <code>0</code> and <code>True</code> evaluates <code>-1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1549398267, "creation_date": 1549398267, "answer_id": 54542475, "question_id": 54537162, "link": "https://stackoverflow.com/questions/54537162/macro-to-duplicate-rows-previously-worked-now-not-working-but-no-error-message/54542475#54542475", "title": "macro to duplicate rows previously worked, now not working but no error message?", "body": "<h1>Fill Every Other Row with Previous</h1>\n\n<h2>The Code</h2>\n\n<pre><code>Sub FillEveryOther()\n\n    Const cCol As Variant = 12    ' Last-Row-Column Letter/Number\n    Const cFirstRow As Long = 2   ' First Row Number\n\n    Dim lastRow As Long   ' Last Row Number\n    Dim i As Long         ' Cell (Row) Counter\n\n    ' Calculate Last Row Number in Last-Row-Column.\n    lastRow = Cells(Rows.Count, cCol).End(xlUp).Row\n\n    ' Loop through every other cell (row) of Last-Row-Column.\n    For i = cFirstRow To lastRow Step 2\n        ' Copy current row to the row below.\n        Rows(i).Copy Rows(i + 1)\n    Next\n\nEnd Sub\n</code></pre>\n\n<h2>An Improvement?</h2>\n\n<p>The following code allows the rows not to strictly be even (2,4,6...) and there can be more than one empty row below. But there always has to be data in the cells of <code>cCol</code> or a formula in them (<code>IsEmpty</code>).</p>\n\n<pre><code>Sub CopyNotEmpty()\n\n    Const cCol As Variant = 12    ' Last-Row-Column Letter/Number\n    Const cFirstRow As Long = 2   ' First Row Number\n\n    Dim lastRow As Long   ' Last Row Number\n    Dim i As Long         ' Cell (Row) Counter\n\n    ' Calculate Last Row Number in Last-Row-Column.\n    lastRow = Cells(Rows.Count, cCol).End(xlUp).Row\n\n    ' Loop through cells (rows) of Last-Row-Column.\n    For i = cFirstRow To lastRow\n        ' Check if there is data in current cell.\n        If Not IsEmpty(Cells(i, cCol)) Then\n            ' Copy current row a row below.\n            Rows(i).Copy Rows(i + 1)\n            ' Increase Cell (Row) Counter, because we don't want to copy\n            ' the already copied row.\n            i = i + 1\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11018237, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ud0buSnxs6o/AAAAAAAAAAI/AAAAAAAAnwc/-DEeh_LJ36M/photo.jpg?sz=128", "display_name": "Waverley Birch", "link": "https://stackoverflow.com/users/11018237/waverley-birch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1549398267, "creation_date": 1549378584, "last_edit_date": 1549378650, "question_id": 54537162, "link": "https://stackoverflow.com/questions/54537162/macro-to-duplicate-rows-previously-worked-now-not-working-but-no-error-message", "title": "macro to duplicate rows previously worked, now not working but no error message?", "body": "<p>I am using the following macro to duplicate information from one row into a blank one (that I've already generated) below. This macro worked ~ a month ago, but when I run it now, nothing happens, despite there being no error message.</p>\n\n<pre><code>Sub FillEveryOther()\n\nDim lastRow As Long\nDim i As Long\n\nlastRow = Cells(Rows.Count, 12).End(xlUp).Row\n\nFor i = 2 To i = lastRow Step 2\n        Rows(i).EntireRow.Select\n        Selection.Copy\n        Rows(i + 1).EntireRow.Select\n        ActiveSheet.Paste\n     If i = lastRow + 1 Then Stop\nNext i\n\nEnd Sub\n</code></pre>\n"}]