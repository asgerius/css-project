[{"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "edited": false, "score": 0, "creation_date": 1496876825, "post_id": 44424027, "comment_id": 75846705, "body": "Try maybe EndDate = #11/01/2017#? From here I can&#39;t tell if this is DD/MM/YYYY, or MM/DD/YYYY. Maybe try a different date where the day is bigger than 12?"}, {"owner": {"reputation": 57, "user_id": 7728119, "user_type": "registered", "profile_image": "https://graph.facebook.com/766037816887218/picture?type=large", "display_name": "Brian Michael", "link": "https://stackoverflow.com/users/7728119/brian-michael"}, "reply_to_user": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "edited": false, "score": 0, "creation_date": 1496917968, "post_id": 44424027, "comment_id": 75863814, "body": "Thank you for you response. I will attempt your suggestion and hope it works."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7728119, "user_type": "registered", "profile_image": "https://graph.facebook.com/766037816887218/picture?type=large", "display_name": "Brian Michael", "link": "https://stackoverflow.com/users/7728119/brian-michael"}, "edited": false, "score": 0, "creation_date": 1496917901, "post_id": 44424924, "comment_id": 75863764, "body": "Thanks for your response. CodeName is hard-coded because I am testing for a unique case. Only one of these CodeNames is relevant for my purposes, it being Macan.   I&#39;ve tried putting the date directly in the Dmin() function, but if I remember correctly the error then notified me that I need an Object, or that the Object was not defined. This is a table that I want filtered by CodeName and Date, so I was unsure what the Object would be."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1496883371, "last_edit_date": 1496883371, "creation_date": 1496882793, "answer_id": 44424924, "question_id": 44424027, "link": "https://stackoverflow.com/questions/44424027/syntax-error-in-vba/44424924#44424924", "title": "Syntax error in VBA", "body": "<p>Remove quote marks around <code>And</code>. Try # delimiters.</p>\n\n<p><code>Target = DMin(\"Price\", \"qryPrice\", \"[CodeName]='Macan' And [MyDate] &lt;=#\" &amp; EndDate &amp; \"#\")</code></p>\n\n<p>Why hard-coded date? Could just put the date directly in the DMin() expression.</p>\n\n<p>Shouldn't CodeName and EndDate be dynamic?</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1496922738, "creation_date": 1496922738, "answer_id": 44435047, "question_id": 44424027, "link": "https://stackoverflow.com/questions/44424027/syntax-error-in-vba/44435047#44435047", "title": "Syntax error in VBA", "body": "<p>You should always format your date values to string expressions when concatenating:</p>\n\n<pre><code>Target = DMin(\"Price\", \"qryPrice\", \"[CodeName]='\" &amp; [SomeCodeName] &amp; \"' And [MyDate] &lt;= #\" &amp; Format([EndDate], \"yyyy\\/mm\\/dd\") &amp; \"#\")\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7728119, "user_type": "registered", "profile_image": "https://graph.facebook.com/766037816887218/picture?type=large", "display_name": "Brian Michael", "link": "https://stackoverflow.com/users/7728119/brian-michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 44424924, "answer_count": 2, "score": 0, "last_activity_date": 1500664810, "creation_date": 1496876133, "last_edit_date": 1500664810, "question_id": 44424027, "link": "https://stackoverflow.com/questions/44424027/syntax-error-in-vba", "title": "Syntax error in VBA", "body": "<p>I have a syntax challenge that is returning a \"Data Mismatch\" error</p>\n\n<p>Basically, I am using the VBA <code>DMin</code> function to target a range of prices using two criteria, one string and one date.</p>\n\n<p>The code:</p>\n\n<pre><code>EndDate = #11/1/2017#\n\nTarget = DMin(\"Price\", \"qryPrice\", \" [CodeName]='Macan'\" And \" [MyDate] &lt;=\" &amp; EndDate)\n</code></pre>\n\n<p>I can't seem to figure out the syntax in order to use both of the different criteria data types. <code>[CodeName]</code> is string, <code>[MyDate]</code> is date/time</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1975091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec152e218921e16ef06e88f62f09c9d?s=128&d=identicon&r=PG", "display_name": "user1975091", "link": "https://stackoverflow.com/users/1975091/user1975091"}, "edited": false, "score": 0, "creation_date": 1496877010, "post_id": 44424072, "comment_id": 75846763, "body": "Thanks, RADO.  It didn&#39;t want to run with the &quot;ThisWorkbook&quot; prefix in the name for some reason.  I removed that part of the prefix, but then it still didn&#39;t want to reiterate over the columns.  However, I substituted &quot;Range&quot; selection with the &quot;Application.Union&quot; and it worked!"}], "tags": [], "owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1496876378, "creation_date": 1496876378, "answer_id": 44424072, "question_id": 44423866, "link": "https://stackoverflow.com/questions/44423866/selecting-different-columns-with-vba/44424072#44424072", "title": "Selecting different columns with VBA", "body": "<p>Try:</p>\n\n<pre><code>Sub CashFlowColumnTabSplit()\nDim Source_Sheet As Worksheet\nDim Target_Sheet As Worksheet\nDim i As Long\n\n    Set Source_Sheet = ThisWorkbook.Sheets(\"Main\")\n\n    For i = 3 To 22\n        Set Target_Sheet = ThisWorkbook.Sheets.Add(After:=Source_Sheet)\n        Application.Union(Source_Sheet.Columns(1), Source_Sheet.Columns(i)).Copy\n        Target_Sheet.Range(\"A1\").PasteSpecial xlPasteAll\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1975091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec152e218921e16ef06e88f62f09c9d?s=128&d=identicon&r=PG", "display_name": "user1975091", "link": "https://stackoverflow.com/users/1975091/user1975091"}, "is_accepted": false, "score": 0, "last_activity_date": 1496877114, "creation_date": 1496877114, "answer_id": 44424181, "question_id": 44423866, "link": "https://stackoverflow.com/questions/44423866/selecting-different-columns-with-vba/44424181#44424181", "title": "Selecting different columns with VBA", "body": "<p>The code below did the trick:</p>\n\n<pre><code>Sub CashFlowColumnTabSplit2()\n\nActiveSheet.Name = \"Main\"\n\nFor i = 3 To 22\n    Application.Union(Columns(1), Columns(i)).Copy\n    Sheets.Add After:=ActiveSheet\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n    Sheets(\"Main\").Select\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 1975091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec152e218921e16ef06e88f62f09c9d?s=128&d=identicon&r=PG", "display_name": "user1975091", "link": "https://stackoverflow.com/users/1975091/user1975091"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1496877114, "creation_date": 1496875078, "last_edit_date": 1531164843, "question_id": 44423866, "link": "https://stackoverflow.com/questions/44423866/selecting-different-columns-with-vba", "title": "Selecting different columns with VBA", "body": "<p>I have a worksheet with 22 columns of data and I need to copy and paste the first column and individual columns starting at column 3 to new worksheets in the same workbook.  For example, I would select column A and column C and copy those two columns to a new worksheet.  Then, I would go back to the initial worksheet and select column A and column D and copy just those two columns to a new worksheet, etc.  </p>\n\n<p>The code below iterates over all of the columns but it always selects a continuous range instead of just column A and the next column in the series.  My initial code is below:</p>\n\n<pre><code>Sub CashFlowColumnTabSplit()\n\nActiveSheet.Name = \"Main\"\n\nFor i = 3 To 22\n    Range(Columns(1), Columns(i)).Select\n    Selection.Copy\n    Sheets.Add After:=ActiveSheet\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n    Sheets(\"Main\").Select\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "performance", "excel", "debugging"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1496872296, "post_id": 44423308, "comment_id": 75845115, "body": "Have you tried turning off screen updating, using cursor = xlWait, etc?"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496873440, "post_id": 44423308, "comment_id": 75845583, "body": "@dwirony Thanks for the comment. <code>ScreenUpdating</code> and <code>Calculation</code> are set to false and manual. <code>Cursor</code> no, but that would improve the run time significantly? Apart from that, what is the reason that causing this, which would be resolved by those suggestion?"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496873543, "post_id": 44423308, "comment_id": 75845625, "body": "@dwirony Basically I tried <a href=\"https://stackoverflow.com/documentation/excel-vba/9798/excel-vba-optimization/30179/disabling-worksheet-updating#t=201706072212105588749\">typical optimization techniques</a>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496874225, "post_id": 44423308, "comment_id": 75845869, "body": "Your code would be significantly improved though the use of a few workbook/sheet variables and completely avoiding select/activate unless necessary (and it typically isn&#39;t necessary)"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496875145, "post_id": 44423308, "comment_id": 75846169, "body": "@masoud it&#39;s not always the case but sometimes the cursor flickering can slow down processes significantly (especially if you&#39;re using select a lot). Add Application.Cursor = xlWait to the top and switch it back to xlDefault at the end. Can&#39;t hurt"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496876747, "post_id": 44423308, "comment_id": 75846678, "body": "@TimWilliams Thank you Tim. I knew I would get this advice so I included in my question that I know it&#39;s not typically necessary to use select/activate but I need to have that and that&#39;s not an option. Not offended tho. thanks for taking a look."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1496878602, "post_id": 44423308, "comment_id": 75847232, "body": "Do you set any Application properties like <code>Application.ScreenUpdating</code> before calling the Sub? What usually slows down Excel VBA code are the many calls between VBA and Excel."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1496878697, "post_id": 44423308, "comment_id": 75847258, "body": "@Slai Thanks for the comment. This is part of bigger module and yes I set them to false."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1496878885, "post_id": 44423308, "comment_id": 75847312, "body": "@Slai Look at the latest update and the link included to documentation to know what Application properties I set."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 2, "creation_date": 1496879280, "post_id": 44423308, "comment_id": 75847408, "body": "I would recommend profiling the code to find what parts are slowest and how their time changes after pausing in the code execution <a href=\"https://stackoverflow.com/documentation/excel-vba/861/debugging-and-troubleshooting/6187/use-timer-to-find-bottlenecks-in-performance\">stackoverflow.com/documentation/excel-vba/861/&hellip;</a>. You can also try checking the application properties that are set after stopping in the debugger, because I think the pause might be changing some of them."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1496879350, "post_id": 44423308, "comment_id": 75847425, "body": "@Slai That&#39;s a good idea. thanks. Will try and report back."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1496880214, "post_id": 44423308, "comment_id": 75847648, "body": "@Masoud - Really, avoiding select, paste etc will yield faster results, I don&#39;t see how there could be any arguement against that. In any event I&#39;d suggest putting Debug.Print Now() in various places throughout the code so you can see which sections are taking up the time"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1496880381, "post_id": 44423308, "comment_id": 75847689, "body": "@Absinthe Thanks for bringing up the argument once again. I know that, I described in the <b>Important Note</b> that it would not resolve the issue and Slai already suggested the second point. thanks tho."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1496891534, "post_id": 44423308, "comment_id": 75850237, "body": "Have you tried <b>starting</b> the macro from the immediate window?  (I am just wondering whether the worksheet / workbook Select and Activate will be being processed differently when the VBE is active, e.g. when you press F5 or run it from the Immediate Window, than when Excel itself is active.)"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496892455, "post_id": 44423308, "comment_id": 75850436, "body": "@YowE3K I will give it a shot. Thanks."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1497016264, "post_id": 44423308, "comment_id": 75915334, "body": "@YowE3K thanks for your suggestion. It helped me a lot. If you can explain about differences between running from sheet and vb itself I&#39;d appreciate."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1497016303, "post_id": 44423308, "comment_id": 75915368, "body": "@Slai Thanks for the suggestion. It helped to dig into the problem."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1497023558, "post_id": 44423308, "comment_id": 75920528, "body": "can you share what the problem is? I am a bit curious, and might be something helpful to know."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1497023693, "post_id": 44423308, "comment_id": 75920604, "body": "@Slai I posted an answer. Look below."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1501070550, "post_id": 44423308, "comment_id": 77614344, "body": "By chance, is any of your code in a userform?  I had a similar issue in MS Word and found that calling standard module code from a userform was very slow. See here for details: <a href=\"https://stackoverflow.com/questions/45326012/why-does-vba-code-run-faster-when-called-from-a-standard-module-instead-of-a-us\" title=\"why does vba code run faster when called from a standard module instead of a us\">stackoverflow.com/questions/45326012/&hellip;</a>"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1501075131, "post_id": 44423308, "comment_id": 77617926, "body": "@SlowLearner I have buttons (form control) that may cause the same behavior."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1501075355, "post_id": 44423308, "comment_id": 77618111, "body": "It would be interesting to know if your issue can also be solved the same way as mine... was your original code in a userform / classModule or just a standard module?"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1501075473, "post_id": 44423308, "comment_id": 77618191, "body": "@SlowLearner All of them are in the standard module. It may jump from one workbook to another one, but still in the modules."}], "answers": [{"comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1497025121, "post_id": 44459531, "comment_id": 75921454, "body": "Interesting. What would make more sense to me is if the difference doesn&#39;t depend on the VBA Editor, but on if the Excel Application/Workbook/Sheet is activated or visible. For example <code>Application.WindowState = xlMinimized</code> or the more risky <code>Application.Visible = False</code>. xlsb usually makes load time a bit faster, so that seems a bit puzzling too."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1497028504, "post_id": 44459531, "comment_id": 75923395, "body": "@Slai Indeed it is bizarre and is only happening on my machine (xlsb). I am also getting <code>Can&#39;t find project or library</code> once in a while when opening my workbook. About the <code>WindowState</code> option I think you&#39;re right. I will try that one too to see if that&#39;s the case but worth telling that I can see the workbook on the second screen so maybe <code>Visible</code> property would be a better shot. I need to keep digging into this. Thanks."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1497037978, "post_id": 44459531, "comment_id": 75928256, "body": "My <b>guess</b> is that, when running in the VBE environment, all your <code>Activate</code> and <code>Select</code> statements are not doing what they would do in an Excel environment - i.e. all they do is change the pointers to which sheet/cell is active, but they don&#39;t hand control of responding to any user-initiated events over to that sheet/cell.  So I suspect the short answer is (and you aren&#39;t going to like it) ... avoid the use of <code>Select</code> and <code>Activate</code>."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1497038443, "post_id": 44459531, "comment_id": 75928463, "body": "@YowE3K haha. I know I should not. I wish I had any control over it. But when your senior engineer insists on keeping the macro as is cause it&#39;s been working for a while then you have to find a way around. Thanks for your help and comments."}], "tags": [], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "is_accepted": true, "score": 1, "last_activity_date": 1573583251, "last_edit_date": 1573583251, "creation_date": 1497016175, "answer_id": 44459531, "question_id": 44423308, "link": "https://stackoverflow.com/questions/44423308/pausing-vba-and-re-running-it-causes-faster-execution/44459531#44459531", "title": "Pausing VBA and re-running it causes faster execution", "body": "<p>After spending fair amount of time on the problem I want to report back on the issue;</p>\n\n<p>As <a href=\"https://stackoverflow.com/users/1383168/slai\">@Slai</a> suggested I tried to find the bottleneck of  the code by printing time between each process. It turned out that there is a lag between each step of the <code>for</code> loop that then disappears after <code>Debug/Continue</code>.</p>\n\n<p>Also <code>Application</code> properties are not changing before and after <code>Debug/Continue</code>.</p>\n\n<p>What <a href=\"https://stackoverflow.com/users/6535336/yowe3k\">@YowE3K</a> proposed about running the macro from the <em>Immediate Window</em> actually resolved the issue. Somehow, it seems <strong>activated VBE is the solution</strong>.</p>\n\n<p>I also tried saving my main workbook as * <em>.xlsb</em> which resolves the issue. However, it causes slower loading of the file at the beginning but in total overhead time-cost is not substantial.</p>\n\n<p>What I know about immediate window is its difference in scope. It assumes global (<code>Public</code>) scope if nothing is running. Otherwise, it will be in the Application scope. I would appreciate if someone can add to this and explain in detail that in what way activated VBE is different from running the macro from a command button.</p>\n\n<p>For a reference, I want to also include in the answer that not disabling <code>Application.ScreenUpdating</code> can affect time of execution significantly. FWIW, <code>select</code>, <code>activate</code> and similar practices should be avoided if possible (programming-wise they are always avoidable).</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14194381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c2c6b60c3f876a6131da4333f3e197?s=128&d=identicon&r=PG&f=1", "display_name": "jdsouza", "link": "https://stackoverflow.com/users/14194381/jdsouza"}, "is_accepted": false, "score": 1, "last_activity_date": 1617796913, "last_edit_date": 1617796913, "creation_date": 1617782768, "answer_id": 66981932, "question_id": 44423308, "link": "https://stackoverflow.com/questions/44423308/pausing-vba-and-re-running-it-causes-faster-execution/66981932#66981932", "title": "Pausing VBA and re-running it causes faster execution", "body": "<p>I had a similar issue with Microsoft 365 (64-bit Windows 10 Pro, i5 9th gen. processor, 16GB RAM. Excel file size 4MB, heavy use of VBA. 64-bit Excel).</p>\n<p>Code Sub length - around 770 lines and it called several functions and branched to several subs.</p>\n<p>The trouble being the software worked/works fine when using Office 2010 (32-bit Excel on the same machine - and for that matter, on my previous machine of considerably lower specs).</p>\n<p>On the MS365 machine. At Runtime, code would stall for between 30 to 300 or more seconds at random places in the code but never if in debug mode.</p>\n<p>I tried all the suggested tips like inserting DoEvents and adding Waits of one or two seconds at various locations in the code.  Even uninstalled MS365 and reinstalled with 32-bit.</p>\n<p>To cut a long story short, I broke the code into smaller parts and called them from within the original code block as in the sample below ...</p>\n<pre><code>Sub xyz()\n.....\n.....\nCall SetDoCalcPages\nCall SetDoCalcPages1(r, ACellAddr, errStr, NowStr, errAddr)\nCall SetDoCalcPages2(temWatch, fYoung, temYoung, doneonce, fK4, ACellAddr, goQT)\n.....\n.....\nEnd Sub\n</code></pre>\n<p>Around 70 lines of code were shifted to the three subs mentioned above.</p>\n<p>I cannot say why, but this resolved the issue.  At runtime, the computation is done at great speed.</p>\n<p>One thing is sure.  The code activates sheets and cells and sets the colour and fonts - all of which are frowned upon by suggestions on many forums.  I can confirm that these do not have any bearing on the symptom - which was random long stalls in the execution of macro code at run time.</p>\n"}], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1691, "favorite_count": 0, "accepted_answer_id": 44459531, "answer_count": 2, "score": 3, "last_activity_date": 1617796913, "creation_date": 1496871932, "last_edit_date": 1592644375, "question_id": 44423308, "link": "https://stackoverflow.com/questions/44423308/pausing-vba-and-re-running-it-causes-faster-execution", "title": "Pausing VBA and re-running it causes faster execution", "body": "<p>We have a macro for some analysis that for the reason that we want to be able to look at the process, for a reason that will be out of scope here, we are forced to use <code>Activate</code> and <code>Select</code> in the macro. Both my colleagues and I are aware of downsides of using such method. Meanwhile, it has been tested that explicit coding and avoiding from selecting and activating is not the main reason.</p>\n<p>In one of the <em><strong>sub-modules</strong></em>, that I am posting the (pseudo-)code of it below, we basically get the data from a sheet and copying it over to another one.</p>\n<h1>Problem</h1>\n<p>The problem is that this process is so slow but when I pause the macro(<KBD>Esc</KBD>), hit debugging, step through (<KBD>F8</KBD>) one or two steps of <code>for-loop</code> and run again (<KBD>F5</KBD>) it runs much faster.</p>\n<p>This does not happen around specific steps of my for loop or for a specific sheet so has nothing to do with my data and how it is structured.</p>\n<p><strong>Question:</strong> What are the possible reasons for this? Does pausing/step running cause something like memory to clear or any other possible scenario that makes this to run faster? And how I can fix this (Make it run as fast without the need to pause and so on.)?</p>\n<h1>Important Note</h1>\n<p>As stated above, using <code>Select</code> and <code>Activate</code> is not the main reason that slowing down the process. I am sorry to post this but need to let you know that I know how to use explicit option, set ranges, set values instead of copying, etc. I have already changed my code to avoid from selecting and see if that resolve the issue but was not the case. It was still running slow until pausing, stepping through and running again. I would appreciate if you take a closer look at the problem and describe the reason behind the issue. Or at least let me know why this, by this I mean this specific issue that will be resolved after pausing and running again, is happening and why it has something to do with <code>Select/Activate</code>.</p>\n<p>This is part of a bigger main module that runs a program as a whole but this is the part that causes the issue. I have used some optimizing techniques in the main module.</p>\n<pre><code>Sub Copy_ModelInputs(RootDir, FileName, TranID, ModOutDir, Angle, x, y, Method, TypeN)\n'For each 150 storms, step through model event tabs and copy into runup tabs\nFileName = RootDir &amp; &quot;NWM\\&quot; &amp; FileName\nFileName_output = ModOutDir &amp; TranID &amp; &quot;_Outputs.xlsm&quot;\nWorkbooks.Open (FileName)\nFileName = ActiveWorkbook.Name\nWorkbooks.Open (FileName_output)\nFilename2 = ActiveWorkbook.Name\n\n'copy the angle into the doc sheet\nWindows(FileName).Activate\nSheets(&quot;doc&quot;).Select\nRange(&quot;c12&quot;).Select\nActiveCell.value = Angle\n\n'File Transect ID\nRange(&quot;c6&quot;).Select\nActiveCell.value = TranID\nActiveCell.Offset(1, 0).Select\nActiveCell.value = FileName_output\nRange(&quot;I4&quot;).Select\nActiveCell.value = Now\nRange(&quot;d8&quot;).Select\nActiveCell.value = x\nActiveCell.Offset(0, 2).Select\nActiveCell.value = y\n\n\n'copy model output to input into excel spreadsheets\n\nFor i = 1 To 150\n    'input SWELs\n    Windows(Filename2).Activate\n    Sheets(&quot;Event&quot; &amp; i).Select\n    Range(&quot;B2:B300&quot;).Select\n    'Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n                    \n\n    Windows(FileName).Activate\n    Sheets(&quot;Event&quot; &amp; i).Select\n    Range(&quot;B7&quot;).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n                    \n    'input H\n    Windows(Filename2).Activate\n    Range(&quot;C2:C300&quot;).Select\n    'Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n                    \n    'Open runup template spreadsheet, copy H0\n    Windows(FileName).Activate\n    Range(&quot;D7&quot;).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n                \n        'input T\n        Windows(Filename2).Activate\n        Range(&quot;D2:D300&quot;).Select\n        'Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n                    \n    'Open template\n    Windows(FileName).Activate\n    Range(&quot;G7&quot;).Select\n     Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    \n    If TypeN = 1 Or TypeN = 3 Then\n    \n        'input deep\n        Windows(Filename2).Activate\n        Range(&quot;E2:E300&quot;).Select\n        'Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n                        \n        'Open template\n        Windows(FileName).Activate\n        Range(&quot;H7&quot;).Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n    End If\n    \n    'input local\n    Windows(Filename2).Activate\n    'If Method = 2 Then\n    If TypeN = 2 Then\n        Range(&quot;G2:G300&quot;).Select\n        Selection.Copy\n            'Open template\n            Windows(FileName).Activate\n            Range(&quot;I7&quot;).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n        'input model\n        Windows(Filename2).Activate\n        Range(&quot;F2:F300&quot;).Select\n        Selection.Copy\n            'Open template\n            Windows(FileName).Activate\n            Range(&quot;H7&quot;).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n        'input length\n        Windows(Filename2).Activate\n        Range(&quot;J2:J300&quot;).Select\n        Selection.Copy\n            'Open template\n            Windows(FileName).Activate\n            Range(&quot;J7&quot;).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n        'input data\n        Windows(Filename2).Activate\n        Range(&quot;I2:I300&quot;).Select\n        Selection.Copy\n            'Open template\n            Windows(FileName).Activate\n            Range(&quot;K7&quot;).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n    End If\n\n    \n    'input sheet\n    Windows(Filename2).Activate\n    If TypeN = 3 Then\n        Range(&quot;H2:H300&quot;).Select\n        Selection.Copy\n            'Open template\n            Windows(FileName).Activate\n            Range(&quot;S7&quot;).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n    End If\n\n    Windows(Filename2).Activate\n\n    Application.StatusBar = &quot;Model Output copied Event &quot; &amp; i\nNext i\n\nActiveWorkbook.Save\nActiveWindow.Close\nActiveWorkbook.Save\nActiveWindow.Close\n\nSheets(&quot;Summary&quot;).Select\nEnd Sub\n</code></pre>\n<p><strong>P.S.:</strong> I also wonder if <code>Application.Cursor = xlWait</code> would significantly benefit me in addition to other Application properties.</p>\n<p><strong>P.P.S.</strong> Please do not bring up <code>Select</code>, <code>Activate</code> and <code>Copy</code> <code>Paste</code> argument. It has been already covered numerous times in the lines above and comments.</p>\n"}, {"tags": ["vba", "for-loop", "nested"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 1, "creation_date": 1496873824, "post_id": 44423233, "comment_id": 75845729, "body": "Show your data. A picture would be enough."}, {"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "reply_to_user": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1496933618, "post_id": 44423233, "comment_id": 75875697, "body": "Hi Masoud, how do you add a picture? Thanks :)"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1496933687, "post_id": 44423233, "comment_id": 75875746, "body": "<a href=\"https://meta.stackexchange.com/questions/83096/how-to-place-an-image-in-a-stack-overflow-question\" title=\"how to place an image in a stack overflow question\">meta.stackexchange.com/questions/83096/&hellip;</a>"}, {"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "reply_to_user": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1496935351, "post_id": 44423233, "comment_id": 75877008, "body": "I think I might be able to use YowE3K&#39;s code to get to what I need. Thanks everyone !"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1496935295, "post_id": 44423815, "comment_id": 75876957, "body": "This is really helpful !! When there&#39;re 3 loops, does it finish the most inner loop and start the first loop all over again? Or does it move to the second loop? Thank you ! :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1496936328, "post_id": 44423815, "comment_id": 75877792, "body": "@JBB - each time a <code>Next</code> statement is reached, the counter for that loop is incremented and then control returns to first statement within the loop (if you haven&#39;t exceeded the end value) or to the following statement (if you have).  So after the innermost loop ends in the example above, control moves to the <code>Next</code> of the middle loop and its counter is incremented and the innermost loop will possibly be executed again.  Once the innermost loop ends for the last time in the middle loop, the outermost loop&#39;s counter is incremented, and the middle loop starts again, etc."}, {"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1496936997, "post_id": 44423815, "comment_id": 75878249, "body": "I see. Thank you!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1496937190, "post_id": 44423815, "comment_id": 75878398, "body": "@JBB I just added a very simple example to the end of the answer - try running it (or even better, stepping through it line-by-line using F8) and it may help you understand loops better."}, {"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1496938929, "post_id": 44423815, "comment_id": 75879570, "body": "oh nice! Thank you :)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 3, "last_activity_date": 1496937117, "last_edit_date": 1496937117, "creation_date": 1496874825, "answer_id": 44423815, "question_id": 44423233, "link": "https://stackoverflow.com/questions/44423233/3-nested-for-loop-in-macro/44423815#44423815", "title": "3 Nested for loop in macro", "body": "<p>Given the number of loops you have, it sounds like you would be better off just using a counter for your output row.</p>\n\n<pre><code>Dim FirstPlan As Long:  FirstPlan = 0\nDim LastPlan As Long:   LastPlan = 5\nDim Plan As Long\n\nDim FirstArea As Long:  FirstArea = 0\nDim LastArea As Long:   LastArea = 6\nDim Area As Long\n\nDim FirstRow As Long:   FirstRow = 2\nDim LastRow As Long:    LastRow = 10\nDim myRow As Long    ' Avoid \"Row\" as a variable name\nDim OutputRow As Long\n\nOutputRow = 2 'Specify first row to be written to\n\n'List out all areas for all plans\nFor Plan = FirstPlan To LastPlan\n\n    'List out all areas within a plan\n    For Area = FirstArea To LastArea\n\n        'List out one Area\n        For myRow = FirstRow To LastRow                \n            'I'm guessing at this line\n            Sheets(\"S\").Cells(OutputRow, \"A\").Value = _\n                   Sheets(\"S\").Cells(Plan - FirstPlan + 2, \"AD\").Value\n\n            Sheets(\"S\").Cells(OutputRow, \"B\").Value = _\n                   Sheets(\"S\").Cells(Area - FirstArea + 2, \"AE\").Value\n\n            'I'm guessing at this line\n            Sheets(\"S\").Cells(OutputRow, \"C\").Value = _\n                   Sheets(\"S\").Cells(myRow - FirstRow + 2, \"AF\").Value\n\n            'Set up ready for the next row to be written\n            OutputRow = OutputRow + 1\n        Next\n    Next\nNext\n</code></pre>\n\n<hr>\n\n<p>Alternatively <code>OutputRow</code> could be calculated every time it is needed:</p>\n\n<pre><code>Dim FirstPlan As Long:  FirstPlan = 0\nDim LastPlan As Long:   LastPlan = 5\nDim Plan As Long\n\nDim FirstArea As Long:  FirstArea = 0\nDim LastArea As Long:   LastArea = 6\nDim Area As Long\n\nDim FirstRow As Long:   FirstRow = 2\nDim LastRow As Long:    LastRow = 10\nDim myRow As Long    ' Avoid \"Row\" as a variable name\nDim OutputRow As Long\n\n'List out all areas for all plans\nFor Plan = FirstPlan To LastPlan\n\n    'List out all areas within a plan\n    For Area = FirstArea To LastArea\n\n        'List out one Area\n        For myRow = FirstRow To LastRow                \n            OutputRow = ((Plan - FirstPlan) * (LastArea - FirstArea + 1) + _\n                         (Area - FirstArea)) * (LastRow - FirstRow + 1) + _\n                         (myRow - FirstRow) + 2\n\n            'I'm guessing at this line\n            Sheets(\"S\").Cells(OutputRow, \"A\").Value = _\n                   Sheets(\"S\").Cells(Plan - FirstPlan + 2, \"AD\").Value\n\n            Sheets(\"S\").Cells(OutputRow, \"B\").Value = _\n                   Sheets(\"S\").Cells(Area - FirstArea + 2, \"AE\").Value\n\n            'I'm guessing at this line\n            Sheets(\"S\").Cells(OutputRow, \"C\").Value = _\n                   Sheets(\"S\").Cells(myRow - FirstRow + 2, \"AF\").Value\n\n        Next\n    Next\nNext\n</code></pre>\n\n<hr>\n\n<p>If you are not used to the control flow of loops, try running the following example in an empty worksheet:</p>\n\n<pre><code>Dim colA As Long, colB As Long, colC As Long\nDim r As Long\nWith ActiveSheet\n    For colA = 11 To 12\n        For colB = 21 To 23\n            For colC = 31 To 34\n                r = r + 1\n                .Cells(r, \"A\").Value = colA\n                .Cells(r, \"B\").Value = colB\n                .Cells(r, \"C\").Value = colC\n            Next colC\n'The following statement will be executed AFTER processing colC as 34\n        Next colB\n'The following statement will be executed AFTER processing colB as 23\n    Next colA\n'The following statement will be executed AFTER processing colA as 12\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1410, "favorite_count": 0, "accepted_answer_id": 44423815, "answer_count": 1, "score": 0, "last_activity_date": 1496937117, "creation_date": 1496871615, "last_edit_date": 1496934481, "question_id": 44423233, "link": "https://stackoverflow.com/questions/44423233/3-nested-for-loop-in-macro", "title": "3 Nested for loop in macro", "body": "<p><a href=\"https://i.stack.imgur.com/Mmu3G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Mmu3G.png\" alt=\"enter image description here\"></a>I'm trying to list out all the plans in column A, and all the areas for each plan in column B. So it would be plan 1 with area 1 and 2, plan 2 with area 1 and 2, etc. My codes currently list out plan 1, plan 2, etc in column A, but it only lists out area 1 and 2 for plan 1, and it stops there. How do you make it to keep going and list out Area 1 and 2 for the rest of the plans? Thank you :))</p>\n\n<p>So Column A would have plan 1, plan 2, etc in order. And, column B would be area 1, area 2, area 1, area 2, etc</p>\n\n<pre><code>  'List out all areas for all plans\n\nFor Plan = 0 To 5\n\n    'List out all areas within a plan\n\nFor Area = 0 To 6\n\n    'List out one Area\n\n    For Row = 2 To 10\n        Sheets(\"S\").Cells(Area * 51 + Row, 2) = Sheets(\"S\").Cells(Area + 2, 31)\n        Next Row\nNext Area\nNext Plan\n</code></pre>\n\n<p>(The one on the left in picture is what I have now, and I'm trying to get to the picture on the right. Thanks :))</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11, "user_id": 8079088, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8G21ATO1G0w/AAAAAAAAAAI/AAAAAAAAAG0/se7EY_-wYIc/photo.jpg?sz=128", "display_name": "GT0028", "link": "https://stackoverflow.com/users/8079088/gt0028"}, "edited": false, "score": 0, "creation_date": 1496957801, "post_id": 44423207, "comment_id": 75889535, "body": "@dominic111 can you help please?"}, {"owner": {"reputation": 11, "user_id": 8079088, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8G21ATO1G0w/AAAAAAAAAAI/AAAAAAAAAG0/se7EY_-wYIc/photo.jpg?sz=128", "display_name": "GT0028", "link": "https://stackoverflow.com/users/8079088/gt0028"}, "edited": false, "score": 0, "creation_date": 1496972759, "post_id": 44423207, "comment_id": 75893351, "body": "@a.s.h Can you help?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8079088, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8G21ATO1G0w/AAAAAAAAAAI/AAAAAAAAAG0/se7EY_-wYIc/photo.jpg?sz=128", "display_name": "GT0028", "link": "https://stackoverflow.com/users/8079088/gt0028"}, "edited": false, "score": 0, "creation_date": 1496877859, "post_id": 44423938, "comment_id": 75847025, "body": "the files are not big . max of 300 rows with only one sheet in them. All i need is to copy the whole sheet and paste it in the master workbook as a sheet with the source filename as sheet name. Sorry very new to VBA"}, {"owner": {"reputation": 11, "user_id": 8079088, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8G21ATO1G0w/AAAAAAAAAAI/AAAAAAAAAG0/se7EY_-wYIc/photo.jpg?sz=128", "display_name": "GT0028", "link": "https://stackoverflow.com/users/8079088/gt0028"}, "edited": false, "score": 0, "creation_date": 1496884974, "post_id": 44423938, "comment_id": 75848728, "body": "@A.S.H can you help?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8127890"}, "is_accepted": false, "score": 0, "last_activity_date": 1496875578, "creation_date": 1496875578, "answer_id": 44423938, "question_id": 44423207, "link": "https://stackoverflow.com/questions/44423207/vba-to-copy-sheets-from-all-files-in-folder-and-copy-it-to-master/44423938#44423938", "title": "VBA to copy sheets from all files in folder and copy it to master", "body": "<p>so the part you need help with is how to copy/paste a range from a worksheet in one file to a common worksheet in a destination file?</p>\n\n<p>set up a variable to track the last empty row in the destination sheet</p>\n\n<p>look up how to determine what the last row is in each source sheet, select that source range, copy it into the clipboard, and then paste it at the last empty row in the destination sheet, and reset the destination variable to the new first blank row in the destination sheet</p>\n\n<hr>\n\n<p>an alternative way of doing it would be to open an output CSV file, and parse each row and build up a string and write it to the file without closing the output CSV file until the loop is over</p>\n\n<hr>\n\n<p>if the files are large tho, it would be much better to use VB.NET instead as it is much faster at dealing with large files</p>\n\n<hr>\n\n<p>you could also read each file/row into an in-memory datatable and then output the datatable to a CSV file, or to the destination Excel file</p>\n\n<p>which method would you prefer?</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8079088, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8G21ATO1G0w/AAAAAAAAAAI/AAAAAAAAAG0/se7EY_-wYIc/photo.jpg?sz=128", "display_name": "GT0028", "link": "https://stackoverflow.com/users/8079088/gt0028"}, "edited": false, "score": 0, "creation_date": 1496888089, "post_id": 44425443, "comment_id": 75849468, "body": "thanks fo rthis. It works however it fails after 2 workbooks saying&quot; this name is already taken&quot; . i need to use the file name as the sheetname ."}, {"owner": {"reputation": 73, "user_id": 8105686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd3cfbcf5fcc3743f415f7b8e14305d?s=128&d=identicon&r=PG&f=1", "display_name": "dominic111", "link": "https://stackoverflow.com/users/8105686/dominic111"}, "reply_to_user": {"reputation": 11, "user_id": 8079088, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8G21ATO1G0w/AAAAAAAAAAI/AAAAAAAAAG0/se7EY_-wYIc/photo.jpg?sz=128", "display_name": "GT0028", "link": "https://stackoverflow.com/users/8079088/gt0028"}, "edited": false, "score": 0, "creation_date": 1496891015, "post_id": 44425443, "comment_id": 75850112, "body": "Then immediately change the name after pasting. If you have twice the same sheet name, it will obviously not work."}], "tags": [], "owner": {"reputation": 73, "user_id": 8105686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd3cfbcf5fcc3743f415f7b8e14305d?s=128&d=identicon&r=PG&f=1", "display_name": "dominic111", "link": "https://stackoverflow.com/users/8105686/dominic111"}, "is_accepted": false, "score": 0, "last_activity_date": 1496886934, "creation_date": 1496886934, "answer_id": 44425443, "question_id": 44423207, "link": "https://stackoverflow.com/questions/44423207/vba-to-copy-sheets-from-all-files-in-folder-and-copy-it-to-master/44425443#44425443", "title": "VBA to copy sheets from all files in folder and copy it to master", "body": "<p>You could simply copy your sheet in the new workbook, following this code:</p>\n\n<p><code>Sheets(\"SheetToCopy\").Copy Before:=Workbooks(\"WorkbookToPasteIn\").Sheets(SheetIndex)</code></p>\n\n<p>And then, rename the sheet to fit your means. </p>\n"}], "owner": {"reputation": 11, "user_id": 8079088, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8G21ATO1G0w/AAAAAAAAAAI/AAAAAAAAAG0/se7EY_-wYIc/photo.jpg?sz=128", "display_name": "GT0028", "link": "https://stackoverflow.com/users/8079088/gt0028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6429, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1496952537, "creation_date": 1496871477, "last_edit_date": 1496952537, "question_id": 44423207, "link": "https://stackoverflow.com/questions/44423207/vba-to-copy-sheets-from-all-files-in-folder-and-copy-it-to-master", "title": "VBA to copy sheets from all files in folder and copy it to master", "body": "<p>I have a folder full of multiple excel files and all of the files have a specific sheet that i need to copy into my master. </p>\n\n<p>I need macro to open all files in that folder one by one and copy the specific sheet to the master file using the source file name as sheet name in the master workbook. Excel 2013.</p>\n\n<p>I tried searching online and have the following code: </p>\n\n<pre><code>Option Explicit\n\nSub test()\n\nDim wkbDest As Workbook\nDim wksDest As Worksheet\nDim wkbSource As Workbook\nDim wksSource As Worksheet\nDim MyPath As String\nDim MyFile As String\n\nApplication.ScreenUpdating = False\n\nSet wkbDest = ThisWorkbook\nSet wksDest = wkbDest.Worksheets(\"Sheet1\") 'change the destination sheet name accordingly\n\nMyPath = \"H:\\Cutover\\\"\n\nIf Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n\nMyFile = Dir(MyPath &amp; \"*.xls\")\n\nDo While Len(MyFile) &gt; 0\n    Set wkbSource = Workbooks.Open(MyPath &amp; MyFile)\n    Set wksSource = wkbSource.Worksheets(\"Sheet1\") 'change the source sheet name accordingly\n    'Your copy/paste code here (((((need help here please))))))))\n    wkbSource.Close savechanges:=False\n    MyFile = Dir\nLoop\n\nApplication.ScreenUpdating = True\n\nMsgBox \"Completed...\", vbInformation\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>So i manage to get to the below however its still not working properly. It doesn't rename the sheet to the source filename. Can someone please help?</p>\n\n<p>Option Explicit</p>\n\n<p>Sub test()</p>\n\n<pre><code>Dim wkbDest As Workbook\nDim wksDest As Worksheet\nDim wkbSource As Workbook\nDim wksSource As Worksheet\nDim MyPath As String\nDim MyFile As String\n\nApplication.ScreenUpdating = False\n\nSet wkbDest = ThisWorkbook\nSet wksDest = wkbDest.Worksheets(\"Sheet1\") 'change the destination sheet name accordingly\n\nMyPath = \"H:\\Cutover\\\"\n\nIf Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n\nMyFile = Dir(MyPath &amp; \"*.xlsx\")\n\nDo While Len(MyFile) &gt; 0\n    Set wkbSource = Workbooks.Open(MyPath &amp; MyFile)\n    Set wksSource = wkbSource.Worksheets(\"Sheet1\") 'change the source sheet name accordingly\n    Sheets(\"SheetToCopy\").Copy Before:=Workbooks(\"WorkbookToPasteIn\").Sheets(SheetIndex)\n    wkbSource.Close savechanges:=False\n    MyFile = Dir\nLoop\n\nApplication.ScreenUpdating = True\n\nMsgBox \"Completed...\", vbInformation\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1496872504, "post_id": 44423034, "comment_id": 75845191, "body": "Your sub <code>CreateNamedRanges</code> worked for me for some simple test cases --- comments worked too. Maybe <code>str_comment</code> has something Excel doesn&#39;t like. Maybe Excel munges names is special cases so that <code>ThisWorkbook.Names(str_rngname)</code> fails. You could try <code>Dim nm as Name</code> followed by <code>Set nm = ThisWorkbook.Names.Add(...)</code> and <code>nm.Comment = ...</code>."}, {"owner": {"reputation": 1, "user_id": 8128000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781e32576d2064f7ef59792d62e0e871?s=128&d=identicon&r=PG&f=1", "display_name": "llbb", "link": "https://stackoverflow.com/users/8128000/llbb"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1496874256, "post_id": 44423034, "comment_id": 75845881, "body": "xidgel, thank you for your response. Unfortunately, I still receive the error. Could it have anything to do with me using a non-English Excel version. When I used the macro recorder and change the string &quot;Test&quot; in <code>.Comment = &quot;Test&quot;</code> it works. However, trying to pass it through a variable fails. The error message says something like &quot;there is an error in the formula. This is not a formula?...&quot; ."}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1496875212, "post_id": 44423034, "comment_id": 75846186, "body": "can you post the content of  &quot;var_formula&quot; variable?"}, {"owner": {"reputation": 1, "user_id": 8128000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781e32576d2064f7ef59792d62e0e871?s=128&d=identicon&r=PG&f=1", "display_name": "llbb", "link": "https://stackoverflow.com/users/8128000/llbb"}, "edited": false, "score": 0, "creation_date": 1496899078, "post_id": 44423034, "comment_id": 75852240, "body": "RADO, var_formula = <code>&quot;=OFFSET(Master!$A$1,1,,s_CountData-1,1)&quot;</code>"}], "owner": {"reputation": 1, "user_id": 8128000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781e32576d2064f7ef59792d62e0e871?s=128&d=identicon&r=PG&f=1", "display_name": "llbb", "link": "https://stackoverflow.com/users/8128000/llbb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496870718, "creation_date": 1496870718, "last_edit_date": 1531161705, "question_id": 44423034, "link": "https://stackoverflow.com/questions/44423034/vba-add-comments-to-a-named-range-passed-through-a-variable", "title": "Vba: Add comments to a Named Range passed through a variable", "body": "<p>Could not find an answer to the '1004' Run time error I receive when I try to assign a comment to a named range.\nI am trying to create from a list in a spreadsheet named ranges. In the spreadsheet I provide \"Name\", \"Range\", \"Comment\" in 3 columns, where \"Name\" and \"Comment\" are strings and \"Range\" is a formula, usually containing OFFSET.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uyOU1.png\" rel=\"nofollow noreferrer\">Sample</a></p>\n\n<pre><code>Sub FromListCreateNamedRanges()\n    Dim wks As Worksheet\n    Dim i As Long\n    Set wks = ThisWorkbook.Worksheets(\"Settings\")\n    For i = 2 To LastRow2(wks, 5)\n        CreateNamedRanges wks.Cells(i, 5), wks.Cells(i, 6).Formula, wks.Cells(i, 7)\n    Next\nEnd Sub\n\nSub CreateNamedRanges(str_rngname As String, var_formula As Variant, Optional str_comment As String)\n    ThisWorkbook.Names.Add Name:=str_rngname, RefersTo:=var_formula\n    ThisWorkbook.Names(str_rngname).Comment = str_comment\nEnd Sub\n</code></pre>\n\n<p>LastRow2 is a user function to determine the last row of a given column. Everything works without using </p>\n\n<pre><code>ThisWorkbook.Names(str_rngname).Comment = str_comment\n</code></pre>\n\n<p>With the above line I receive an error message. I would appreciate your help, suggestions and ideas.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1496871260, "post_id": 44423030, "comment_id": 75844740, "body": "just <code>CheckAttendance</code> without <code>Sheets(&quot;Occurences&quot;).</code>"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1496877775, "post_id": 44423030, "comment_id": 75846994, "body": "in addition to @Slai&#39;s comment: 1) it should be a sub, not function; 2) you need to provide a proper reference to Cells in your code (explicitly reference workbook and worksheet, otherwise your code might be unstable)"}, {"owner": {"reputation": 11, "user_id": 8128071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cd72248016280309252b33bd606f3a2?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Graves", "link": "https://stackoverflow.com/users/8128071/christopher-graves"}, "reply_to_user": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1496924280, "post_id": 44423030, "comment_id": 75868190, "body": "@RADO Thanks for your comment. My understanding of your comment compared to the A.S.H. answer is that I have two different options: make the worksheet a parameter, which allows the sub to be called on different worksheets, OR I can make it more specific, so that it only works on my Occurences sheet. Am I understanding that correctly, or are those options not mutually exclusive like I think they are?"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 1, "creation_date": 1496928141, "post_id": 44423030, "comment_id": 75871211, "body": "A.S.H. gave you a solid advice. I was referring to the fact that your code contained unqualified reference to Cells(), which is dangerous because it essentially means: ActiveBook.ActiveSheet.Cells(). If your code starts running in non-active book, or your sheet is no longer active, it will either crash or lead to unexpected results. If you look at A.S.H code, he preceds every Cell with ws. (worksheet object). Re: parameter or hard-coded sheet name - the choice is dictated by your goals. If you need to do the same operation on many sheets, use parameter. Otherwise, just use the sheet name."}, {"owner": {"reputation": 11, "user_id": 8128071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cd72248016280309252b33bd606f3a2?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Graves", "link": "https://stackoverflow.com/users/8128071/christopher-graves"}, "edited": false, "score": 0, "creation_date": 1497367116, "post_id": 44423030, "comment_id": 76042822, "body": "Thanks for clarifying this! Much appreciated."}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "edited": false, "score": 0, "creation_date": 1501799245, "post_id": 44423030, "comment_id": 77952512, "body": "Don&#39;t forget to accept the best, correct answer. In addition to rewarding the answerer with reputation, your also get +2 added to yours."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8128071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cd72248016280309252b33bd606f3a2?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Graves", "link": "https://stackoverflow.com/users/8128071/christopher-graves"}, "edited": false, "score": 0, "creation_date": 1496923705, "post_id": 44424464, "comment_id": 75867794, "body": "Thanks a bunch. With the Variables--Dim vs. Public: I was under the impression that you should use Public if you want to be able to use the variable in other macros in the same book. In my mind VBA-Public = python-global.  Is that correct? What is the rationale for making all the variables local?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 11, "user_id": 8128071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cd72248016280309252b33bd606f3a2?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Graves", "link": "https://stackoverflow.com/users/8128071/christopher-graves"}, "edited": false, "score": 0, "creation_date": 1496924265, "post_id": 44424464, "comment_id": 75868185, "body": "@ChristopherGraves we have no public variables in this snippet, only locals. Public/global variables are declared <i>outside routine</i> and aim to be accessible by many routines. By the principles of <i>data hiding</i> (aka encapsulation), they are to avoid unless really necessary. Why? because they tend to make the code more difficult to track and maintain."}, {"owner": {"reputation": 11, "user_id": 8128071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cd72248016280309252b33bd606f3a2?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Graves", "link": "https://stackoverflow.com/users/8128071/christopher-graves"}, "edited": false, "score": 0, "creation_date": 1497367161, "post_id": 44424464, "comment_id": 76042860, "body": "Thank you for your help!"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1496879539, "last_edit_date": 1496879539, "creation_date": 1496879171, "answer_id": 44424464, "question_id": 44423030, "link": "https://stackoverflow.com/questions/44423030/how-to-debug-my-simple-excel-vba-macro/44424464#44424464", "title": "How to debug my simple Excel VBA macro?", "body": "<p>It seems that you want to parametrize your <code>CheckAttendance</code> routine so that it can be called on different worksheets. To do that, make it a <code>Sub</code> that takes a worksheet as parameter. Moreover</p>\n\n<ul>\n<li>qualify you cells and ranges in the code</li>\n<li>dim your variables and use <code>Option Explicit</code></li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub CheckAttendance(ws As Worksheet)\n    Dim DaysSinceOcc As Long, lastRow As Long, today As Long\n    lastRow = ws.Cells(ws.Rows.count, 1).End(xlUp).row\n\n    'gets current date\n    today = Date\n\n    'subtracts last cell in specified column from today's date.\n    DaysSinceOcc = today - ws.Cells(lastRow, 1).Value2\n\n    'writes what I want written in the cells I want it written in.\n    If DaysSinceOcc &gt; 29 Then\n        ws.Cells(lastRow + 1, 1) = today\n        ws.Cells(lastRow + 1, 2) = \"winback\"\n        ws.Cells(lastRow + 1, 3) = -0.5\n        ws.Cells(lastRow + 1, 5) = \"Earned back 0.5 pts for 30 days perfect attendance (AutoGenerated)\"\n        ws.Cells(lastRow + 1, 6) = \"AUTO\"\n    End If\nEnd Sub\n\nSub Attendance()\n    CheckAttendance Sheets(\"Occurences\") ' &lt;-- this is how you call it on any worksheet\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8128071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cd72248016280309252b33bd606f3a2?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Graves", "link": "https://stackoverflow.com/users/8128071/christopher-graves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496882206, "creation_date": 1496870707, "last_edit_date": 1496882206, "question_id": 44423030, "link": "https://stackoverflow.com/questions/44423030/how-to-debug-my-simple-excel-vba-macro", "title": "How to debug my simple Excel VBA macro?", "body": "<p>I'm just trying to check the latest Date cell, which is in Column A, against the current date. If the difference is 30 days, I write a new row.</p>\n\n<p>When I execute, it says I can't call CheckAttendance on Sheet(\"Occurences\"). But why? </p>\n\n<pre><code>    Option Explicit\n\n    Public LastCell As Long\n    Public today As Date\n\n\n    Function CheckAttendance()\n\n        Dim DaysSinceOcc As Integer\n\n        'returns last occupied row\n        LastCell = Cells(Rows.Count, 1).End(xlUp).Row\n\n        'gets current date\n        today = Date\n\n        'subtracts last cell in specified column from today's date.\n        DaysSinceOcc = today - Cells(LastCell, 1).Value\n\n        'writes what I want written in the cells I want it written in.        \n        If DaysSinceOcc &gt; 29 Then\n            Cells(LastCell, 1).Offset(1, 1) = \"winback\"\n            Cells(LastCell, 1).Offset(1, 2) = -0.5\n            Cells(LastCell, 1).Offset(1, 4) = \"Earned back 0.5 pts for 30 days perfect attendance (AutoGenerated)\"\n            Cells(LastCell, 1).Offset(1, 5) = \"AUTO\"\n            Cells(LastCell, 1).Offset(1, 0) = today\n        Else\n\n        End If\n\n\n    End Function\n\n    Sub Attendance()\n\n        Sheets(\"Occurences\").CheckAttendance\n        'yes Occurences is suppose to be spelled like that (don't ask)\n\n    End Sub\n</code></pre>\n\n<p>edit: there are probably multiple problems with this. I fixed a lot of things, but then got stuck.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "where-clause"], "comments": [{"owner": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1496870577, "post_id": 44422895, "comment_id": 75844427, "body": "have you tried IN ... where userid in (....)"}, {"owner": {"reputation": 56, "user_id": 7963903, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10158444008745411/picture?type=large", "display_name": "Matthew Cochrane", "link": "https://stackoverflow.com/users/7963903/matthew-cochrane"}, "reply_to_user": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1496876811, "post_id": 44422895, "comment_id": 75846701, "body": "by using the IN or NOT IN clause I do not get a return into the next Combobox."}, {"owner": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1496878733, "post_id": 44422895, "comment_id": 75847270, "body": "can you show us your updated script with NOT IN?"}, {"owner": {"reputation": 56, "user_id": 7963903, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10158444008745411/picture?type=large", "display_name": "Matthew Cochrane", "link": "https://stackoverflow.com/users/7963903/matthew-cochrane"}, "reply_to_user": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1496884314, "post_id": 44422895, "comment_id": 75848588, "body": "Me.Worker4.RowSource = &quot;&quot; Worker4STR = &quot;SELECT T1Workers.NonUserID, T1Workers.[FirstName] &amp; &quot;&quot; &quot;&quot; &amp; [LastName] AS FullName FROM T1Workers WHERE T1Workers.NonUserID NOT IN&quot; &amp; _               Me.Worker1.Value &amp; &quot; , &quot; &amp; Me.Worker2.Value &amp; &quot; , &quot; &amp; Me.Worker3.Value Me.Worker4.RowSource = Worker4STR"}, {"owner": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1496884390, "post_id": 44422895, "comment_id": 75848607, "body": "so obviously you are missing the &quot;(&quot; and &quot;)&quot;"}, {"owner": {"reputation": 56, "user_id": 7963903, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10158444008745411/picture?type=large", "display_name": "Matthew Cochrane", "link": "https://stackoverflow.com/users/7963903/matthew-cochrane"}, "reply_to_user": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1496890557, "post_id": 44422895, "comment_id": 75850009, "body": "Yes, yes you have it, I was missing the open and close Paren.&#39;s"}], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 7963903, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10158444008745411/picture?type=large", "display_name": "Matthew Cochrane", "link": "https://stackoverflow.com/users/7963903/matthew-cochrane"}, "edited": false, "score": 0, "creation_date": 1496876730, "post_id": 44423332, "comment_id": 75846675, "body": "By using the &quot;IN&quot; or &quot;NOT IN&quot; Clauses the code now returns nothing in the next ComboBox. Is there another method?"}, {"owner": {"reputation": 56, "user_id": 7963903, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10158444008745411/picture?type=large", "display_name": "Matthew Cochrane", "link": "https://stackoverflow.com/users/7963903/matthew-cochrane"}, "edited": false, "score": 0, "creation_date": 1496890592, "post_id": 44423332, "comment_id": 75850018, "body": "Thank you BOTH! I was missing the Parenthesis that has done the trick!"}], "tags": [], "owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "is_accepted": true, "score": 0, "last_activity_date": 1496872044, "creation_date": 1496872044, "answer_id": 44423332, "question_id": 44422895, "link": "https://stackoverflow.com/questions/44422895/multiple-or-in-sql-string-variable-vba/44423332#44423332", "title": "Multiple OR in SQL string Variable, VBA", "body": "<p>Your clause:</p>\n\n<pre><code>X &lt;&gt; A OR B OR C\n</code></pre>\n\n<p>Is not valid SQL.  You can use <code>NOT IN</code> instead:</p>\n\n<pre><code>\"WHERE T1Workers.NonUserID NOT IN (\" &amp; _\n              Me.Worker1.Value &amp; \" , \" &amp; _\n              Me.Worker2.Value &amp; \" , \" &amp; _ \n              Me.Worker3.Value &amp; \" ) \"\n</code></pre>\n\n<p>Note that if the values are strings they at a minimum need to be enclosed in quotes.  A <em>much better</em> solution is to use SQL parameters instead, but I do not know if that's possible with whatever <code>Worker4</code> is.</p>\n"}], "owner": {"reputation": 56, "user_id": 7963903, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10158444008745411/picture?type=large", "display_name": "Matthew Cochrane", "link": "https://stackoverflow.com/users/7963903/matthew-cochrane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 44423332, "answer_count": 1, "score": 0, "last_activity_date": 1496872044, "creation_date": 1496870141, "question_id": 44422895, "link": "https://stackoverflow.com/questions/44422895/multiple-or-in-sql-string-variable-vba", "title": "Multiple OR in SQL string Variable, VBA", "body": "<p>I am using a bit a code to Adjust form length and an SQL variable to modify the names that show up in a Combobox. I want to make sure that the names in the Comboboxes above the one that is being worked on, do not show any names. \nSo if Combo1 has 40 names then Combo2 will only have 39 and so on. \nMy problem seems to be when I use multiple \"OR\" within the WHERE Clause of the SQL String. Can anyone advice?</p>\n\n<pre><code>Private Sub Worker3_Change()\nDim Worker4STR As String\n\n'Shows Worker 4\n\nMe.Worker4.RowSource = \"\"\nWorker4STR = \"SELECT T1Workers.NonUserID, T1Workers.[FirstName] &amp; \"\" \"\" &amp; [LastName] AS FullName FROM T1Workers WHERE T1Workers.NonUserID &lt;&gt;\" &amp; _\n              Me.Worker1.Value &amp; \" OR \" &amp; Me.Worker2.Value &amp; \" Or \" &amp; Me.Worker3.Value\nMe.Worker4.RowSource = Worker4STR\n\nMe.Worker4.AllowValueListEdits = False\nMe.Worker4.ColumnCount = 2\nMe.Worker4.ColumnWidths = \"0, \"\n\nMe.Worker4.Visible = True\nMe.Activity4.Visible = True\nMe.w4a1s.Visible = True\nMe.w4a1d.Visible = True\nMe.w4a1o.Visible = True\nMe.w4a2s.Visible = True\nMe.w4a2o.Visible = True\nMe.w4a2d.Visible = True\nMe.w4a3s.Visible = True\nMe.w4a3o.Visible = True\nMe.w4a3d.Visible = True\nMe.w4a4s.Visible = True\nMe.w4a4o.Visible = True\nMe.w4a4d.Visible = True\nMe.w4a5s.Visible = True\nMe.w4a5o.Visible = True\nMe.w4a5d.Visible = True\nMe.InsideHeight = 1440 * 4.6\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in Advance.\n-Matt</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496870268, "post_id": 44422727, "comment_id": 75844297, "body": "What error are you getting?"}, {"owner": {"reputation": 23, "user_id": 8088194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed1608e1d93a9351afb695cd70e6c1b?s=128&d=identicon&r=PG&f=1", "display_name": "Landon Wright", "link": "https://stackoverflow.com/users/8088194/landon-wright"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496870584, "post_id": 44422727, "comment_id": 75844430, "body": "When I select &quot;run&quot; for the macro, the macro sheet comes up and the macros are not listed for a selection to run."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496870781, "post_id": 44422727, "comment_id": 75844528, "body": "Well first off, <code>Worksheet_Change</code> is an event, and I believe it needs to remain the name <code>Worksheet_Change</code> (You can just add more underneath that one macro). And this type of macro is placed in the specific sheet in Excel, and whenever something changes in your worksheet, it might or might not trigger this macro."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496870885, "post_id": 44422727, "comment_id": 75844568, "body": "In short, there&#39;s no need to go to Macros and click &quot;run&quot; - nothing will happen, because this macro isn&#39;t made to do anything unless a change is made to your sheet."}, {"owner": {"reputation": 23, "user_id": 8088194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed1608e1d93a9351afb695cd70e6c1b?s=128&d=identicon&r=PG&f=1", "display_name": "Landon Wright", "link": "https://stackoverflow.com/users/8088194/landon-wright"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496870903, "post_id": 44422727, "comment_id": 75844576, "body": "Okay, I will try and test that out real quickly. Thank you."}, {"owner": {"reputation": 23, "user_id": 8088194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed1608e1d93a9351afb695cd70e6c1b?s=128&d=identicon&r=PG&f=1", "display_name": "Landon Wright", "link": "https://stackoverflow.com/users/8088194/landon-wright"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496871269, "post_id": 44422727, "comment_id": 75844745, "body": "@dwiorny, I made some changes and adjusted the cells a bit but the pages are still present. Is there a different way to code this instead so that <i>if</i> they put a value into the box, then the tab will appear? I guess that could make the code a little easier."}, {"owner": {"reputation": 23, "user_id": 8088194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed1608e1d93a9351afb695cd70e6c1b?s=128&d=identicon&r=PG&f=1", "display_name": "Landon Wright", "link": "https://stackoverflow.com/users/8088194/landon-wright"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496871791, "post_id": 44422727, "comment_id": 75844922, "body": "Hi @dwiorny, thank you for speaking with me about this. I realized I was making the process too complicated and made a different sub that answered my questions!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496872035, "post_id": 44422727, "comment_id": 75845017, "body": "Glad to hear. Good luck on the rest of your project-"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 8088194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed1608e1d93a9351afb695cd70e6c1b?s=128&d=identicon&r=PG&f=1", "display_name": "Landon Wright", "link": "https://stackoverflow.com/users/8088194/landon-wright"}, "is_accepted": true, "score": 0, "last_activity_date": 1496871743, "creation_date": 1496871743, "answer_id": 44423266, "question_id": 44422727, "link": "https://stackoverflow.com/questions/44422727/vba-reduce-number-of-active-sheets-based-on-cell-values/44423266#44423266", "title": "VBA | Reduce Number of Active Sheets Based on Cell Values", "body": "<pre><code>Sub DataSheetsShown()\n'Test whether or not the cell value is present\n'If value is present, show field\n    If IsEmpty(Range(\"P2\").Value) = True Then\n        Sheets(\"1\").Visible = False\n    End If\n    If IsEmpty(Range(\"P3\").Value) = True Then\n        Sheets(\"2\").Visible = False\n    End If\n    If IsEmpty(Range(\"P4\").Value) = True Then\n        Sheets(\"3\").Visible = False\n    End If\n    If IsEmpty(Range(\"P5\").Value) = True Then\n        Sheets(\"4\").Visible = False\n    End If\n    If IsEmpty(Range(\"P6\").Value) = True Then\n        Sheets(\"5\").Visible = False\n    End If\n    If IsEmpty(Range(\"P7\").Value) = True Then\n        Sheets(\"6\").Visible = False\n    End If\n    If IsEmpty(Range(\"P8\").Value) = True Then\n        Sheets(\"7\").Visible = False\n    End If\n    If IsEmpty(Range(\"P9\").Value) = True Then\n        Sheets(\"8\").Visible = False\n    End If\n    If IsEmpty(Range(\"P10\").Value) = True Then\n        Sheets(\"9\").Visible = False\n    End If\n    If IsEmpty(Range(\"P11\").Value) = True Then\n        Sheets(\"10\").Visible = False\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8088194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed1608e1d93a9351afb695cd70e6c1b?s=128&d=identicon&r=PG&f=1", "display_name": "Landon Wright", "link": "https://stackoverflow.com/users/8088194/landon-wright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 44423266, "answer_count": 1, "score": 1, "last_activity_date": 1496871743, "creation_date": 1496869420, "last_edit_date": 1496871198, "question_id": 44422727, "link": "https://stackoverflow.com/questions/44422727/vba-reduce-number-of-active-sheets-based-on-cell-values", "title": "VBA | Reduce Number of Active Sheets Based on Cell Values", "body": "<p>I am creating a user interface that allows users to use a maximum of 10 data tabs. On most occasions, the user will use less tabs (lets say 3). I am interested in a code that operates off of a value within the range [P2:P11] for the ten tabs. If a data tab is in use, the box returns \"True\" but when a tab is not in use, it returns the value of \"False.\"</p>\n\n<p>I would like the user to not have the burden of seeing the other data tabs (4-10) if they only use 1, 2 and 3. (The data tabs are actually labeled 1, 2, 3 etc. for convenience). This macro is meant to operate on a page called \"HIDE_ME\" that will be hidden when the program is sent out to users. I have created the code for the event below but I cannot get them to operate. Can anyone assist me in locating my error? Many thanks.</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\nIf [P2] = \"True\" Then\nSheets(\"1\").Visible = True\nElse\nSheets(\"1\").Visible = False\nEnd If\n\nIf [P3] = \"True\" Then\nSheets(\"2\").Visible = True\nElse\nSheets(\"2\").Visible = False\nEnd If\n\nIf [P4] = \"True\" Then\nSheets(\"3\").Visible = True\nElse\nSheets(\"3\").Visible = False\nEnd If\n\nIf [P5] = \"True\" Then\nSheets(\"4\").Visible = True\nElse\nSheets(\"4\").Visible = False\nEnd If\n\nIf [P6] = \"True\" Then\nSheets(\"5\").Visible = True\nElse\nSheets(\"5\").Visible = False\nEnd If\n\nIf [P7] = \"True\" Then\nSheets(\"6\").Visible = True\nElse\nSheets(\"6\").Visible = False\nEnd If\n\nIf [P8] = \"True\" Then\nSheets(\"7\").Visible = True\nElse\nSheets(\"7\").Visible = False\nEnd If\n\nIf [P9] = \"True\" Then\nSheets(\"8\").Visible = True\nElse\nSheets(\"8\").Visible = False\nEnd If\n\nIf [P10] = \"True\" Then\nSheets(\"9\").Visible = True\nElse\nSheets(\"9\").Visible = False\nEnd If\n\nIf [P11] = \"True\" Then\nSheets(\"10\").Visible = True\nElse\nSheets(\"10\").Visible = False\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496867870, "post_id": 44422272, "comment_id": 75843202, "body": "Sounds like you need this code placed in a <code>Worksheet_Change</code> macro. How have you been calling this code so far?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496872652, "post_id": 44422272, "comment_id": 75845254, "body": "Is G39 on the same sheet as you are making visible/invisible?  If so, once the sheet is invisible, how are the users changing the value of G39?  (If it is by a formula in G39 which references the other cell containing the dropdown, it is that other worksheet which will need to have the <code>Worksheet_Change</code> and the code will need to check if the <code>Target</code> is the cell which the user is actually changing - not G39 on the sheet that is being hidden/unhidden.)"}, {"owner": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 0, "creation_date": 1497006997, "post_id": 44422272, "comment_id": 75908951, "body": "I am using it as a Worksheet_Change, and it is not on the same worksheet that I am hiding or un-hiding. It is on a separate sheet when they enter the yes value I want the sheet to appear."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 0, "creation_date": 1497007539, "post_id": 44422402, "comment_id": 75909308, "body": "This is still not working correctly. It is hidden all the time and does not become un-hidden when the selection is &quot;yes&quot;."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 0, "creation_date": 1497235647, "post_id": 44422402, "comment_id": 75975434, "body": "Are you using a dropdown list for the yes/no selection?"}, {"owner": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 0, "creation_date": 1497277995, "post_id": 44422402, "comment_id": 75997744, "body": "I am actually using a dropdown yes. The list is located on another sheet."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 0, "creation_date": 1497278340, "post_id": 44422402, "comment_id": 75998000, "body": "So when you select yes from the dropdown and hit the tab key, what happens?"}, {"owner": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 0, "creation_date": 1497289206, "post_id": 44422402, "comment_id": 76004497, "body": "Nothing. I see the same tabs the one that I have hidden stays hidden."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 0, "creation_date": 1497289333, "post_id": 44422402, "comment_id": 76004556, "body": "And you&#39;re certain that you have this code placed under the sheet specific tab under Microsoft Excel Objects?"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1496868152, "creation_date": 1496868152, "answer_id": 44422402, "question_id": 44422272, "link": "https://stackoverflow.com/questions/44422272/excel-vba-for-unhiding-or-hiding-a-worksheet-conditionally-based-on-cell-value/44422402#44422402", "title": "Excel VBA for Unhiding or Hiding a Worksheet Conditionally Based on Cell Value", "body": "<p>Place this under your main sheet in Microsoft Excel Objects</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$G$39\" Then\n        'Change Sheet1 to the name of your main sheet\n        If ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"G39\").Value = \"YES\" Then\n            Sheets(\"Prop. Pres. Notes 206-261\").Visible = True\n        Else\n            Sheets(\"Prop. Pres. Notes 206-261\").Visible = False\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 0, "creation_date": 1497278068, "post_id": 44478750, "comment_id": 75997797, "body": "What would lower case do for me exactly? Just curious. The yes is on Sheet 1 in a drop down list, and it is capitalized."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 0, "creation_date": 1497279105, "post_id": 44478750, "comment_id": 75998517, "body": "In your description and comments you didn&#39;t mention it was capitalized, you used <b>&quot;yes&quot;</b>, so I was covering all possibilities; also, I&#39;m not sure how the drop down list was created so I would go a step further and use <code>Trim(LCase(Sheets(1).Range(&quot;G39&quot;).Value2)) = &quot;yes&quot;</code> as well"}, {"owner": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 0, "creation_date": 1497289532, "post_id": 44478750, "comment_id": 76004665, "body": "I have a sheet with different lists on it for multiple different drop down lists, but the drop down for that is in there as well. I will try the trim, but there were no spaces around &quot;YES&quot;. It is also spelled in all capitals."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 0, "creation_date": 1497324170, "post_id": 44478750, "comment_id": 76016392, "body": "Then it might be something else, but it would be helpful if we can compare the exact same values that VBA is comparing (maybe do Debug.Print for each value like <code>Debug.Print &quot;&gt;&quot; &amp; Sheets(1).Range(&quot;G39&quot;).Value2 &amp; &quot;&lt;&quot;</code> and the same for the drop down value)"}, {"owner": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "edited": false, "score": 1, "creation_date": 1498220528, "post_id": 44478750, "comment_id": 76424812, "body": "I was able to use this type of code, but I found the glitch had to do with some of the cells that I was referencing not being set up exactly the way I thought. Thank you for all the help!"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1497134582, "creation_date": 1497134582, "answer_id": 44478750, "question_id": 44422272, "link": "https://stackoverflow.com/questions/44422272/excel-vba-for-unhiding-or-hiding-a-worksheet-conditionally-based-on-cell-value/44478750#44478750", "title": "Excel VBA for Unhiding or Hiding a Worksheet Conditionally Based on Cell Value", "body": "<p>You haven't mentioned what sheet <code>Range(\"G39\")</code> is on<br>\nIf it's on Sheet1 try comparing lower case strings:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sheets(\"Prop. Pres. Notes 206-261\").Visible = LCase(Sheets(1).Range(\"G39\").Value2) = \"yes\"\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7674623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04bc1eadde16659fba551e98b257f9c0?s=128&d=identicon&r=PG&f=1", "display_name": "BigCat", "link": "https://stackoverflow.com/users/7674623/bigcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2355, "favorite_count": 1, "accepted_answer_id": 44478750, "answer_count": 2, "score": 0, "last_activity_date": 1497134582, "creation_date": 1496867669, "last_edit_date": 1531161705, "question_id": 44422272, "link": "https://stackoverflow.com/questions/44422272/excel-vba-for-unhiding-or-hiding-a-worksheet-conditionally-based-on-cell-value", "title": "Excel VBA for Unhiding or Hiding a Worksheet Conditionally Based on Cell Value", "body": "<p>I have attempted many different times to formulate a code for this and even tried a few strings of code I found on this site, but I have been unable to find a resolution.</p>\n\n<p>My goal is to have a hidden worksheet pop up as unhidden when the user selects \"yes\" from the dropdown in a cell on another worksheet for the user to enter their notes on then if the cell is populated at N/A or (Select) have the sheet remain hidden.</p>\n\n<p>Could anyone help with this? </p>\n\n<p>Here is the most recent code I attempted:</p>\n\n<pre><code>Sheets(\"Prop. Pres. Notes 206-261\").Activate\nIf Range(\"G39\").Value = \"YES\" Then\nSheets(\"Prop. Pres. Notes 206-261\").Visible = True\nElse\nSheets(\"Prop. Pres. Notes 206-261\").Visible = False\nEnd If\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496867454, "post_id": 44422173, "comment_id": 75842984, "body": "Are you sure that is the exact value of <code>X</code>?  I just tested and got <code>False</code> for all tests.  (FWIW - <code>X &lt;&gt; CStr(X)</code> is implicitly equal to <code>CStr(X) &lt;&gt; CStr(X)</code> because VBA will need to perform a type conversion before performing the comparison.)"}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496868459, "post_id": 44422283, "comment_id": 75843477, "body": "Hi. Problem actually is that the actual value of x is <code>36.0418746812314 + 2.1316282072803E-14</code> but it displays as <code>36.0418746812314</code>... and <code>Val(x)</code> truncates it back to what is displayed. (even with US locale) :(. I am trying to figure out how to display <code>x</code> with more precision."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1496885748, "post_id": 44422283, "comment_id": 75848911, "body": "@A.S.H Use <code>CDec</code>"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 1, "last_activity_date": 1496867709, "creation_date": 1496867709, "answer_id": 44422283, "question_id": 44422173, "link": "https://stackoverflow.com/questions/44422173/vba-val-function-changing-value/44422283#44422283", "title": "VBA Val Function Changing Value?", "body": "<p>The <code>CDbl</code> function is relative to your regional settings. The <code>Val</code> function is relative to US regional settings.</p>\n\n<p>If you provide a value in your local regional settings to the <code>Val</code> function, it will be interpreted as if it is in US format (period for decimal separator, comma for thousands separator etc).</p>\n\n<p>My PC is set to EN-AU settings (which are similar to EN-US settings), and <code>Val(36.0418746812314) = 36.0418746812314</code> returns <code>True</code>, or in your syntax, <code>Val(36.0418746812314) &lt;&gt; 36.0418746812314</code> returns <code>False</code></p>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496873108, "post_id": 44422693, "comment_id": 75845448, "body": "It looks like a <b>LOT</b> of effort has gone into research for that answer - well done!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496873756, "post_id": 44422693, "comment_id": 75845705, "body": "@YowE3K Thanks mate. More importantly I have learned a few &quot;huge&quot; things today. We never stop learning, even when we start loosing our hair..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496875033, "post_id": 44422693, "comment_id": 75846134, "body": "I&#39;m definitely losing braincells, but haven&#39;t yet started to lose my hair (much to my barber&#39;s disgust - keeps complaining that my hair is too thick and will need to charge me extra to sharpen the scissors :( )"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1496876698, "post_id": 44422693, "comment_id": 75846666, "body": "And, of course, the other thing to be wary of is the attempt to use a <code>Double</code> in <b>any</b> sort of equality / inequality comparison - e.g. <code>49 * CDbl(1 &#47; 49) = 1</code> is <code>False</code> due to the rounding of the final bit.  (If it was just <code>49 * (1 &#47; 49) = 1</code> you would get <code>True</code> - not sure whether that is due to optimisation, or whether it stores extra bits in the intermediate calcs)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496877370, "post_id": 44422693, "comment_id": 75846876, "body": "Ah... another curious result."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 2, "creation_date": 1496885191, "post_id": 44422693, "comment_id": 75848768, "body": "Why not just use <code>CDec</code> instead of <code>CDbl</code>, and retain the printed precision? <code>Debug.Print CDec(36.0418746812314) + CDec(2.1316282072803E-14) &#39;Prints  36.041874681231421316282072803 </code>"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1496885481, "post_id": 44422693, "comment_id": 75848847, "body": "I suppose the take-away is that you should <i>only</i> ever use <code>Val</code> in very specific situations, where: <b>A.</b> The input is a string, and <b>B.</b> The string is in US format, and <b>C.</b> The precision of the string is expressible as a Double?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1496886886, "post_id": 44422693, "comment_id": 75849192, "body": "@ThunderFrame perfect, <code>CDec + CDec</code> shows the difference in decimal form. But not <code>CDec(x)</code> though, we fall back into the same problem with <code>Val(x)</code>, as if <code>x</code> was first converted to string before passed to <code>CDec</code>??? Although <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278896.aspx\" rel=\"nofollow noreferrer\">this page</a> says <i>&quot;expression argument is any string expression or numeric expression&quot;</i>, it seems that an implicit conversion of the parameter (<code>x</code>, double) to string did occur :/"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1496887147, "post_id": 44422693, "comment_id": 75849263, "body": "@ThunderFrame I agree on the flaw of using <code>Val</code>. Good advice."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496921084, "post_id": 44422693, "comment_id": 75865813, "body": "@YowE3K I think it depends on if the expression can be calculated at compile time. For example <code>49 * (1 &#47; 49) = 1</code> is False if any of the numbers is replaced with a variable."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1496938800, "post_id": 44422693, "comment_id": 75879475, "body": "@Slai If it was &quot;compile-time v run-time&quot; then constants would give <code>True</code>, but <code>Const a As Double = 1 &#47; 49: Const b As Double = a * 49: Const c As Double = 49 * (1 &#47; 49): Debug.Print b = 1, c = 1</code> will give <code>False  True</code>, so I still think that intermediate expressions are being calculated with greater precision than a <code>Double</code>, or code is being optimised by rearranging expressions."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 6, "last_activity_date": 1496872824, "last_edit_date": 1496872824, "creation_date": 1496869315, "answer_id": 44422693, "question_id": 44422173, "link": "https://stackoverflow.com/questions/44422173/vba-val-function-changing-value/44422693#44422693", "title": "VBA Val Function Changing Value?", "body": "<p>Consider this MCVE:</p>\n\n<pre><code>Sub TestingVal()\n  Dim x As Double, y As Double\n  x = 36.0418746812314 + 2.1316282072803E-14\n  y = Val(x)\n  Debug.Print x, y, x &lt;&gt; y       ' 36.0418746812314  36.0418746812314  True\nEnd Sub\n</code></pre>\n\n<p>Both x and Y <strong>display</strong> the same way, due to the <strong>displaying precision</strong>. But their actual values (binary representations) are different.</p>\n\n<p>For info, here are the binary representations of x and y in the <code>IEEE-754</code> format:</p>\n\n<pre><code>0100000001000000000001010101110000100110010010010011010110101110\n0100000001000000000001010101110000100110010010010011010110101011\n'                                                            ^^^\n</code></pre>\n\n<p>Only the last 3 bits (of the mantissa) differ! This difference was not big enough to show when they are displayed in base 10 with 14 decimal digits.</p>\n\n<p>Now consider the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264296.aspx\" rel=\"noreferrer\">Val Function</a>:</p>\n\n<blockquote>\n  <p>Returns the numbers contained in a string as a numeric value of appropriate type</p>\n</blockquote>\n\n<p>That means, in <code>Val(x)</code>, the number <code>x</code> was first converted to a <code>String</code> to match the parameter type of the function. This resulted in its <em>displayed value</em> in Base 10. Then <code>Val</code> converted it back to a number and we stored it in <code>y</code>. Since in the first phase the displayed value was not the <em>exact</em> value, some bits of precision were lost and we got <code>x &lt;&gt; Val(x)</code>.</p>\n\n<p>As conclusion, when precision matters to the last bit in your calculations, dont apply <code>Val</code> on a number. Even if you dont know whether your initial variant is a double or a string, use <code>CDbl</code> which works well in both cases.</p>\n"}], "owner": {"reputation": 425, "user_id": 5145161, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4e9dd1ff076c662d46051f374911783a?s=128&d=identicon&r=PG&f=1", "display_name": "NOYB", "link": "https://stackoverflow.com/users/5145161/noyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 0, "accepted_answer_id": 44422693, "answer_count": 2, "score": 2, "last_activity_date": 1496883066, "creation_date": 1496867228, "last_edit_date": 1496883066, "question_id": 44422173, "link": "https://stackoverflow.com/questions/44422173/vba-val-function-changing-value", "title": "VBA Val Function Changing Value?", "body": "<p>An equation produces this value as Variant/Double X: 36.0418746812314</p>\n\n<p>But:<br>\nX &lt;> Val(X) is true<br>\nX &lt;> CStr(X) is false<br>\nX &lt;> CDdl(X) is false<br></p>\n\n<p>How is Val() changing the value?<br>\nWhen viewed in the watch list applying X = Val(X) does not appear to change the value or type of X.  But somehow it is different.</p>\n\n<p>For instance:<br>\nA = X - Val(X) is very small, but not zero (2.1316282072803E-14).<br>\nB = X - CStr(X) is very small, but not zero (2.1316282072803E-14).<br>\nC = X - CDbl(X) is zero.<br></p>\n\n<p>Update:\nThanks everyone for your replies and answers.  Here is some additional background.</p>\n\n<p>Formula for dividend adjusted close price.  Reportedly used by Yahoo Finance.<br>\nA1 = A0 + A0 * (((P1 / S) - P0 - D) / P0)</p>\n\n<p>Split and Dividend Adjusted Close Price<br>\nTicker Symbol: INTC<br>\nDate: Friday, August 29, 1980<br>\n0.306757021582758 (Yahoo Finance calculated)<br>\n0.306757021582704 (My VBA calculation)<br></p>\n\n<p>Converting A1 to string CStr(A1) or applying Val(A1), then my VBA result matches the Yahoo Finance calculated value.<br>\nIt's not really a material difference but nice to understand why and how to make it match for purpose of formula validation.<br></p>\n\n<p>Formula source, components details and explanation.<br>\n\"How Yahoo Calculates the Adjusted Closing Price\"<br>\n<a href=\"http://marubozu.blogspot.com/2006/09/how-yahoo-calculates-adjusted-closing.html\" rel=\"nofollow noreferrer\">http://marubozu.blogspot.com/2006/09/how-yahoo-calculates-adjusted-closing.html</a><br></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496866797, "post_id": 44421930, "comment_id": 75842649, "body": "I would try to find the last used row on the sheet, add 1 or 50 to that number (however many rows you need) and paste it there.  Search find last used row in column.  Put the lastUsedRow in a variable, and change your code to L = .Range(&quot;c&quot; &amp; lastUsedRow + 50).Left   and T = .Range(&quot;c&quot; + 50).Top"}, {"owner": {"reputation": 15, "user_id": 8122377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffd1ffda951f169460960ff4400f3203?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelCodak", "link": "https://stackoverflow.com/users/8122377/raphaelcodak"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496872989, "post_id": 44421930, "comment_id": 75845381, "body": "This sound like it would work!! I apologize i&#39;m fairly new to VBA. Would it be to much to ask to give this to me in the way I should add it exactly? Could you use my current code and put the added code you are suggesting? Thank you (I will try to figure out based on what you already commented on how and where to add this."}, {"owner": {"reputation": 15, "user_id": 8122377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffd1ffda951f169460960ff4400f3203?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelCodak", "link": "https://stackoverflow.com/users/8122377/raphaelcodak"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496875104, "post_id": 44421930, "comment_id": 75846154, "body": "This is what I added to my code based on what you suggested:    After this line:  Dim L As Long, T As Long     <code>Dim lastUsedRow As Variant</code> And changed Ranges to:     <code>With ws</code>         <code>W = 30</code>                  &#39;&lt;~~ Width        ` H = 11`                  &#39;&lt;~~ Height         <code>L = .Range(&quot;c&quot; &amp; lastUsedRow + 50).Left</code>   &#39;&lt;~~ Left Position for image         <code>T = .Range(&quot;c&quot; + 50).Top</code>    &#39;&lt;~~ Top Position for image"}, {"owner": {"reputation": 15, "user_id": 8122377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffd1ffda951f169460960ff4400f3203?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelCodak", "link": "https://stackoverflow.com/users/8122377/raphaelcodak"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496875185, "post_id": 44421930, "comment_id": 75846179, "body": "I receive the following error: Runtime Error &#39;13&#39;: Type Mismatch and it highlights the following line of code: <code>T = .Range(&quot;c&quot; + 50).Top</code>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8122377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffd1ffda951f169460960ff4400f3203?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelCodak", "link": "https://stackoverflow.com/users/8122377/raphaelcodak"}, "edited": false, "score": 0, "creation_date": 1497041757, "post_id": 44438244, "comment_id": 75929913, "body": "Wow! this is the closest it is gotten to work! sometimes it works and when I change to <code>newRowNumb = myArr(UBound(myArr)) + 1</code> it pastes in same cell. Then If I change it back to <code>+2</code> it works and if I change it back to <code>+1</code> for about three or four tries it goes back to pasting on same cell. (so it seems to only work with the <code>+2</code> code that you originally gave me). Also sometimes even if there is an object already in place it gives me a  Runtime Error 1004: Object defined or Application defined Error. on this code: <code>If myArrCounter = 1 And wshape.TopLeftCell.Column = 3 Then</code>"}, {"owner": {"reputation": 15, "user_id": 8122377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffd1ffda951f169460960ff4400f3203?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelCodak", "link": "https://stackoverflow.com/users/8122377/raphaelcodak"}, "edited": false, "score": 0, "creation_date": 1497041989, "post_id": 44438244, "comment_id": 75929992, "body": "Am I doing something wrong?  Ideally like I mentioned on my initial post the first InkPicture should insert on column 3 row 3 and go down from there but this code starts at row 1 is there a workaround this?"}, {"owner": {"reputation": 15, "user_id": 8122377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffd1ffda951f169460960ff4400f3203?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelCodak", "link": "https://stackoverflow.com/users/8122377/raphaelcodak"}, "edited": false, "score": 0, "creation_date": 1497041999, "post_id": 44438244, "comment_id": 75929996, "body": "I really appreciate this!"}, {"owner": {"reputation": 15, "user_id": 8122377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffd1ffda951f169460960ff4400f3203?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelCodak", "link": "https://stackoverflow.com/users/8122377/raphaelcodak"}, "edited": false, "score": 0, "creation_date": 1497043556, "post_id": 44438244, "comment_id": 75930512, "body": "Don&#39;t know if this has anything to do with this but in the same sheet Rows 1 and 2 are Locked/fixed headers and Columns 1,2,4,5,6,7 have other different formulas that are meant to create other calculations (none of these interact or utilize or reference column C for anything) but figured I should share just in case."}, {"owner": {"reputation": 15, "user_id": 8122377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffd1ffda951f169460960ff4400f3203?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelCodak", "link": "https://stackoverflow.com/users/8122377/raphaelcodak"}, "edited": false, "score": 0, "creation_date": 1497048764, "post_id": 44438244, "comment_id": 75932028, "body": "While in Debug of the highlighted code it recognizes the <code>myArrCounter = 1</code> and returns a positive count but then it says that <code>wshape.TopLeftCell.Column = 3</code> returns this: , <i>&lt;Subscript out of Range&gt;</i>"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": true, "score": 0, "last_activity_date": 1496931446, "creation_date": 1496931446, "answer_id": 44438244, "question_id": 44421930, "link": "https://stackoverflow.com/questions/44421930/how-to-make-my-userform-code-change-the-output-cell-of-the-code-every-time-i-run/44438244#44438244", "title": "How to make my UserForm code change the output cell of the code every time I run said UserForm in Excel", "body": "<p>I must have misunderstood your question.  Instead of the \"last used row\" you need to find the last row in column \"C\" that has a shape in it.  This changed code will find the last row with a shape in column C, then it will add 2 rows to that number, and then place the image two rows beneath the lowest one.  You can change those rows to however many you need.  You might get an error if there are no shapes on the sheet when this is run.  If so then you will have to create an error capture for that.</p>\n\n<pre><code>Private Sub CommandButton4_Click()\n\nDim ws As Worksheet\nDim ImgPath As String\nDim W As Double, H As Double\nDim L As Long, T As Long\nDim myArr() As Variant, myArrCounter As Long\nDim newRowNumb As Long\n\nSet ws = ThisWorkbook.Sheets(\"Mobile POS Log Sheet\")\n\n'////////////////////////////////////////   This section will find the row of the bottom most shape in Column C\nReDim myArr(1 To 1)\nmyArrCounter = 0\n\nFor Each wshape In ws.Shapes\n    myArrCounter = myArrCounter + 1\n    If myArrCounter = 1 And wshape.TopLeftCell.Column = 3 Then\n        myArr(myArrCounter) = wshape.TopLeftCell.row\n    Else:\n        If wshape.TopLeftCell.Column = 3 And wshape.TopLeftCell.row &gt; myArr(UBound(myArr)) Then\n            ReDim Preserve myArr(1 To myArrCounter)\n            myArr(myArrCounter) = wshape.TopLeftCell.row\n        End If\n    End If\nNext wshape\nnewRowNumb = myArr(UBound(myArr)) + 2 ' this adds two rows to place the new picure.  Change the \"2\" to how many rows you need\n\n\n\n'~~&gt; This is my current pic file path\nImgPath = \"C:\\Users\\raphaelo\\Downloads\\test.gif\"\n\n\n    With ws\n        W = 30                  '&lt;~~ Width\n        H = 11                  '&lt;~~ Height\n        L = .Range(\"c\" &amp; newRowNumb).Left   '&lt;~~ This is what should be changing each time I run the command\n        T = .Range(\"c\" &amp; newRowNumb).Top    '&lt;~~ This is what should be changing each time I run the command\n         '&lt;~~ Both the L and T Range entries should change to the next cell (C3 to C4 to C5 and so on) One digit up every time I run the Command Code\n         '&lt;~~ Unless it's the Placement entry below?\n        With .Pictures.Insert(ImgPath)\n            With .ShapeRange\n                .LockAspectRatio = msoTrue\n                .Width = W\n                .Height = H\n            End With\n            .Left = L\n            .Top = T\n            .Placement = 1 '&lt;~~ Not sure if this is the one that should change one digit up each time I run the Command instead?\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8122377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffd1ffda951f169460960ff4400f3203?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelCodak", "link": "https://stackoverflow.com/users/8122377/raphaelcodak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 44438244, "answer_count": 1, "score": 0, "last_activity_date": 1496931446, "creation_date": 1496866196, "question_id": 44421930, "link": "https://stackoverflow.com/questions/44421930/how-to-make-my-userform-code-change-the-output-cell-of-the-code-every-time-i-run", "title": "How to make my UserForm code change the output cell of the code every time I run said UserForm in Excel", "body": "<p>I have researched the web but can't find the solution that helps me. </p>\n\n<p>I have a Excel Sheet and have created a UserForm that has a InkPicture Box and is set to allow a person to open the user form and draw their signature. There is a CommandButton assigned to take the signature and save it from the clipboard onto the PC. I Have another CommandButton assigned to retrieve said saved picture from the PC path and bring it back to a specific sheet in my workbook and insert it at a specific cell. </p>\n\n<p>My need is the following:\nI need the Code I'm using to update what cell it will insert the image at every time I click on the button. (In other words. I need the code to go from C3 to C50 on one digit increase every time I push the button and after it reaches revert back to C3)</p>\n\n<p>Can this be done?</p>\n\n<p>This code brings the image back to my sheet but every time the CommandButton is clicked the image gets inserted in C3(therefore all images are on top of each other as opposed to below each other):</p>\n\n<pre><code>Private Sub CommandButton4_Click()\n\nDim ws As Worksheet\nDim ImgPath As String\nDim W As Double, H As Double\nDim L As Long, T As Long\n\nSet ws = ThisWorkbook.Sheets(\"Mobile POS Log Sheet\")\n\n'~~&gt; This is my current pic file path\nImgPath = \"C:\\Users\\raphaelo\\Downloads\\test.gif\"\n\nWith ws\n    W = 30                  '&lt;~~ Width\n    H = 11                  '&lt;~~ Height\n    L = .Range(\"c3\").Left   '&lt;~~ This is what should be changing each time I run the command\n    T = .Range(\"c3\").Top    '&lt;~~ This is what should be changing each time I run the command\n     '&lt;~~ Both the L and T Range entries should change to the next cell (C3 to C4 to C5 and so on) One digit up every time I run the Command Code\n     '&lt;~~ Unless it's the Placement entry below?\n    With .Pictures.Insert(ImgPath)\n        With .ShapeRange\n            .LockAspectRatio = msoTrue\n            .Width = W\n            .Height = H\n        End With\n        .Left = L\n        .Top = T\n        .Placement = 1 '&lt;~~ Not sure if this is the one that should change one digit up each time I run the Command instead?\n    End With\nEnd With\n</code></pre>\n\n<p>Please guide me in the right direction! What would be the code that automatically re-calculates itself to assign the Output to a different cell in a column every time it's ran?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496866074, "post_id": 44421769, "comment_id": 75842263, "body": "Please include your code in the question.  (I will downvote you if the picture is still in the question next time I look at it.)  And you reference a range by, for instance, saying <code>Set myvariable = </code> and then placing a <code>Range</code> object to the right of the <code>=</code>.  The <code>Range.Select</code> method does not return a <code>Range</code> object.  And you can&#39;t use &quot;A4:A&quot; as a range address.  So you need something like <code>Set dataRangeA = Range(&quot;A:A&quot;)</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496866584, "post_id": 44421769, "comment_id": 75842545, "body": "The other advantage (besides avoiding downvotes) of placing code, and not just pictures of code, into the question is that people can help you fix the other mistakes without having to retype your whole code from scratch."}, {"owner": {"reputation": 69, "user_id": 3614131, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/h0uO5.png?s=128&g=1", "display_name": "Obie_One", "link": "https://stackoverflow.com/users/3614131/obie-one"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496868605, "post_id": 44421769, "comment_id": 75843552, "body": "I&#39;m just now seeing this part. I will fix."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496869122, "post_id": 44421769, "comment_id": 75843796, "body": "I have put the code back to how I remember seeing it originally, so that it doesn&#39;t &quot;invalidate&quot; the existing answers."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 3614131, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/h0uO5.png?s=128&g=1", "display_name": "Obie_One", "link": "https://stackoverflow.com/users/3614131/obie-one"}, "edited": false, "score": 0, "creation_date": 1496866672, "post_id": 44421950, "comment_id": 75842594, "body": "Your response makes logical sense, but when I make that change I then get an &quot;Object Required&quot; Runtime error in the same location. Which I don&#39;t understand that because I declared the Ranges above."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496866675, "post_id": 44421950, "comment_id": 75842597, "body": "You still need to put a <code>Range</code> object as the RHS in your <code>Set</code> statement"}], "tags": [], "owner": {"reputation": 30, "user_id": 7324747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfe3ca8c5cf3e5a05b8984bba9c4b2fa?s=128&d=identicon&r=PG&f=1", "display_name": "Meerweten", "link": "https://stackoverflow.com/users/7324747/meerweten"}, "is_accepted": true, "score": 0, "last_activity_date": 1496866275, "creation_date": 1496866275, "answer_id": 44421950, "question_id": 44421769, "link": "https://stackoverflow.com/questions/44421769/cant-get-my-ranges-set-up-from-my-spreadsheet-using-vba/44421950#44421950", "title": "Can&#39;t get my Ranges set up from my spreadsheet using VBA", "body": "<p>try this:</p>\n\n<pre><code>Set dataRangeA = Range(\"A:A\").Select\nSet dataRangeB = Range(\"B:B\").Select\nSet dataRangeI = Range(\"I:I\").Select\n\nFor i = 4 To dataRangeA.Rows.Count\n    dataA.Add Key:=i, Item:=dataRangeA.Cells.Value\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496868291, "post_id": 44422399, "comment_id": 75843404, "body": "Which is why I said to include your code into the question - I would have posted an answer fixing that for you as well if I wasn&#39;t forced to retype your entire code to do so.  (And if you included enough code so that we could see what you were doing with the Dictionary. we may have been able to avoid your loop as well.)"}, {"owner": {"reputation": 69, "user_id": 3614131, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/h0uO5.png?s=128&g=1", "display_name": "Obie_One", "link": "https://stackoverflow.com/users/3614131/obie-one"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496868536, "post_id": 44422399, "comment_id": 75843523, "body": "Sorry, I didn&#39;t see your response about the code. I will fix it now."}, {"owner": {"reputation": 69, "user_id": 3614131, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/h0uO5.png?s=128&g=1", "display_name": "Obie_One", "link": "https://stackoverflow.com/users/3614131/obie-one"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496869279, "post_id": 44422399, "comment_id": 75843880, "body": "Thanks for the &quot;posting&quot; help. Got to learn how to post properly."}], "tags": [], "owner": {"reputation": 69, "user_id": 3614131, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/h0uO5.png?s=128&g=1", "display_name": "Obie_One", "link": "https://stackoverflow.com/users/3614131/obie-one"}, "is_accepted": false, "score": 0, "last_activity_date": 1496868137, "creation_date": 1496868137, "answer_id": 44422399, "question_id": 44421769, "link": "https://stackoverflow.com/questions/44421769/cant-get-my-ranges-set-up-from-my-spreadsheet-using-vba/44422399#44422399", "title": "Can&#39;t get my Ranges set up from my spreadsheet using VBA", "body": "<p>After removing the .Select, my ranges were accepted.</p>\n\n<pre><code>Set dataRangeA = Range(\"A:A\")\nSet dataRangeB = Range(\"B:B\")\nSet dataRangeI = Range(\"I:I\")\n\nFor i = 4 To dataRangeA.Rows.Count\n   dataA.Add Key:=i, Item:=dataRangeA.Cells.Value\nNext i\n</code></pre>\n\n<p>Thanks for the input <strong>YowE3k</strong>. Now I have to think on how I want my loop to end. Because doing it the way I have it above will cause it to run out of memory. The spreadsheet will not have a \"predefined\" number of rows. I guess I will have to have the user type \"End\" in the cell of the last row or something.</p>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1496871167, "last_edit_date": 1496871167, "creation_date": 1496870321, "answer_id": 44422930, "question_id": 44421769, "link": "https://stackoverflow.com/questions/44421769/cant-get-my-ranges-set-up-from-my-spreadsheet-using-vba/44422930#44422930", "title": "Can&#39;t get my Ranges set up from my spreadsheet using VBA", "body": "<p>Your problems with the particular line throwing the error are caused by two things:</p>\n\n<ol>\n<li><p><code>\"A4:A\"</code> is not a valid address in Excel.  You can either use <code>\"A:A\"</code> for the entire column or define the end of the range, e.g. <code>\"A4:A272\"</code>.</p></li>\n<li><p>The <code>Range.Select</code> method does not return an object, so <code>Set dataRangeA = Range(\"A4:A\").Select</code> is effectively <code>Set dataRangeA =</code>.</p></li>\n</ol>\n\n<p>To fix your specific error, you could do something like:</p>\n\n<pre><code>Set dataRangeA = Range(\"A4\", Cells(Rows.Count, \"A\").End(xlUp))\n</code></pre>\n\n<hr>\n\n<p>However, using unqualified <code>Cells</code> and <code>Range</code> and <code>Rows</code> is a dangerous habit to get into once you have more than one worksheet / workbook being used in your code, because those objects default to referring to the <code>ActiveSheet</code> in the <code>ActiveWorkbook</code> and that may not be the one you are expecting it to be.</p>\n\n<p>The code below ensures that each object is qualified, plus makes some other improvements to your code (such as the inevitable out-of-memory error that would arise in populating the Dictionary).</p>\n\n<pre><code>Sub Transfer2NewWorkbook()\n  Dim currentsheet As String\n  Dim newsheet As String\n  Dim analysisDate As String\n  Dim initial As String\n  Dim aInitial() As String\n  Dim analystInit As String\n  Dim batchNo As String\n\n  Dim wb As Object\n  Dim dataRangeA As Range, dataRangeB As Range, dataRangeI As Range\n  Dim dataA As Object ' declare this, unless you have declared it at a higher\n                      ' level scope\n\n  Set dataA = CreateObject(\"Scripting.Dictionary\")\n\n  ' Grab and Create filenames\n  currentsheet = ActiveWorkbook.Name\n  newsheet = currentsheet &amp; \"-\" &amp; \"uploadable\"\n\n  'Use a With block to avoid having to constantly refer\n  ' to \"ActiveWorkbook.Sheets(1)\"\n  With ActiveWorkbook.Sheets(1)\n    ' Grab data from original spreadsheet\n    analysisDate = .Cells(1, 9).Value\n\n    initial = .Cells(1, 2).Value\n    aInitial = Split(initial, \"/\")\n    analystInit = aInitial(1)\n\n    Set dataRangeA = .Range(\"A4\", .Cells(.Rows.Count, \"A\").End(xlUp))\n    Set dataRangeB = .Range(\"B4\", .Cells(.Rows.Count, \"B\").End(xlUp))\n    Set dataRangeI = .Range(\"I4\", .Cells(.Rows.Count, \"I\").End(xlUp))\n\n    'This loop is making every entry in the Dictionary contain the value of \n    'every cell in the range - i.e. each of the 1048573 entries in the Dictionary\n    'would have contained an array which was dimensioned As (1 To 1048573, 1 To 1)\n    'For i = 1 To dataRangeA.Rows.Count\n    '  dataA.Add Key:=i, Item:=dataRangeA.Cells.Value\n    'Next i\n    Dim cel As Range\n    For Each cel in dataRangeA\n      dataA.Add Key:=cel.Row, Item:=cel.Value\n      'or \n      'dataA.Add Key:=cel.Row - 3, Item:=cel.Value\n      'if you wanted A4's value to have a key of 1\n    Next\n\n    'Note: If you just wanted an array of values, you could have used\n    '  Dim dataA As Variant\n    '  dataA = Application.Transpose(.Range(\"A4\", .Cells(.Rows.Count, \"A\").End(xlUp)))\n    'and then access each value using dataA(1) for the value from A4,\n    'dataA(2) for the value from A5, etc.\n    'This then gets rid of the need for dataRangeA, and the need for a\n    ' dictionary object, and the need for the loop populating the dictionary.\n  End With\n\n  Set wb = Workbooks.Add(\"C:\\Users\\dalythe\\documents\\uploadtemp.xlsx\")\n  With wb.Worksheets(1)\n\n    .Cells(3, 2).Value = analysisDate\n    .Cells(3, 4).Value = analystInit\n\n  End With\n  wb.SaveAs newsheet &amp; \".xlsx\"\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 3614131, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/h0uO5.png?s=128&g=1", "display_name": "Obie_One", "link": "https://stackoverflow.com/users/3614131/obie-one"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 44421950, "answer_count": 3, "score": 0, "last_activity_date": 1496871167, "creation_date": 1496865609, "last_edit_date": 1531164843, "question_id": 44421769, "link": "https://stackoverflow.com/questions/44421769/cant-get-my-ranges-set-up-from-my-spreadsheet-using-vba", "title": "Can&#39;t get my Ranges set up from my spreadsheet using VBA", "body": "<p>My overall goal here is to grab the values and row indices of three different columns on the original spreadsheet, evaluate them, and then save them to a new spreadsheet. I am wanted to accomplish this by using a macro initiated by a button on the original spreadsheet. </p>\n\n<p>The plan to accomplish this was to </p>\n\n<ul>\n<li>create a Range for each column</li>\n<li>Loop through the most significant Range to grab and evaluate the each cell      value</li>\n<li>perform nested loops within the first loop to further evaluate the other two Ranges and grab their values</li>\n<li>assign values to variables</li>\n<li>create the new spreadsheet from a template</li>\n<li>write the values to the respective columns </li>\n<li>save the new spreadsheet</li>\n</ul>\n\n<p>When I run the code below I get the error listed below. I'm confused because I thought this is how you reference an entire column:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZJbMk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZJbMk.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Transfer2NewWorkbook()\n  Dim currentsheet As String\n  Dim newsheet As String\n  Dim analysisDate As String\n  Dim initial As String\n  Dim aInitial() As String\n  Dim analystInit As String\n  Dim batchNo As String\n\n  Dim wb As Object\n  Dim dataRangeA As Range, dataRangeB As Range, dataRangeI As Range\n  Set dataA = CreateObject(\"Scripting.Dictionary\")\n\n\n  ' Grab and Create filenames\n  currentsheet = ActiveWorkbook.Name\n  newsheet = currentsheet &amp; \"-\" &amp; \"uploadable\"\n\n  ' Grab data from original spreadsheet\n  analysisDate = ActiveWorkbook.Sheets(1).Cells(1, 9).Value\n\n  initial = ActiveWorkbook.Sheets(1).Cells(1, 2).Value\n  aInitial = Split(initial, \"/\")\n  analystInit = aInitial(1)\n\n  Set dataRangeA = Range(\"A4:A\").Select ' &lt;-- Line causing error\n  Set dataRangeB = Range(\"B4:B\").Select\n  Set dataRangeI = Range(\"I4:I\").Select\n\n  For i = 1 To dataRangeA.Rows.Count\n    dataA.Add Key:=i, Item:=dataRangeA.Cells.Value\n  Next i\n\n  Set wb = Workbooks.Add(\"C:\\Users\\dalythe\\documents\\uploadtemp.xlsx\")\n\n  ActiveWorkbook.Sheets(1).Cells(3, 2).Value = analysisDate\n  ActiveWorkbook.Sheets(1).Cells(3, 4).Value = analystInit\n\n\n  ActiveWorkbook.SaveAs (newsheet &amp; \".xlsx\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1496865003, "post_id": 44421566, "comment_id": 75841712, "body": "You do not use <code>Address</code> when setting a range: <code>Set rng = ws.Cells(lRow, lCol)</code> then you can do <code>msgbox rng.Address(1,1)</code>"}, {"owner": {"reputation": 131, "user_id": 2917409, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ea9d4c8f990fb53df031c6e3dbafd2?s=128&d=identicon&r=PG&f=1", "display_name": "Sol_Kralj", "link": "https://stackoverflow.com/users/2917409/sol-kralj"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1496866199, "post_id": 44421566, "comment_id": 75842321, "body": "@ScottCraner The MsgBox was just to verify what I was doing. I need to be able to substitute with the Range (&quot;$A$1:RANGE&quot;)."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1496866421, "post_id": 44421566, "comment_id": 75842454, "body": "it would be <code>Range(&quot;A1&quot;,rng)</code>"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1496866637, "post_id": 44421566, "comment_id": 75842573, "body": "You don&#39;t need Range (&quot;$A$1:RANGE&quot;). Just set your range to the target directly. See my answer."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 2917409, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ea9d4c8f990fb53df031c6e3dbafd2?s=128&d=identicon&r=PG&f=1", "display_name": "Sol_Kralj", "link": "https://stackoverflow.com/users/2917409/sol-kralj"}, "edited": false, "score": 0, "creation_date": 1496866969, "post_id": 44421789, "comment_id": 75842739, "body": "Thank you for both making me feel dumb AND giving me the right answer!  Works perfectly. Enjoy the rest of your day!"}], "tags": [], "owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1496866546, "last_edit_date": 1496866546, "creation_date": 1496865702, "answer_id": 44421789, "question_id": 44421566, "link": "https://stackoverflow.com/questions/44421566/excel-vba-convert-cells-to-range-using-address/44421789#44421789", "title": "Excel VBA: Convert Cells to Range using Address", "body": "<p>If your goal is to set a range to the used range on a sheet, it can be done simpler:</p>\n\n<pre><code>Set rng = ws.UsedRange\n</code></pre>\n\n<p>Obviously, you need to make sure that the usedrange on that sheet properly represents your imported data.</p>\n\n<p>To convert the range to a table:</p>\n\n<pre><code>Dim Import_Table As ListObject\nSet Import_Table = ws.ListObjects.Add(SourceType:=xlSrcRange, Source:=rng, XlListObjectHasHeaders:=xlYes)\nImport_Table.Name = \"Import\"\n</code></pre>\n\n<p>Note: the code is for Excel 2010. For later versions, replace XlListObjectHasHeaders with HasHeaders</p>\n"}], "owner": {"reputation": 131, "user_id": 2917409, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ea9d4c8f990fb53df031c6e3dbafd2?s=128&d=identicon&r=PG&f=1", "display_name": "Sol_Kralj", "link": "https://stackoverflow.com/users/2917409/sol-kralj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2825, "favorite_count": 0, "accepted_answer_id": 44421789, "answer_count": 1, "score": 0, "last_activity_date": 1496866546, "creation_date": 1496864822, "last_edit_date": 1531161705, "question_id": 44421566, "link": "https://stackoverflow.com/questions/44421566/excel-vba-convert-cells-to-range-using-address", "title": "Excel VBA: Convert Cells to Range using Address", "body": "<p>I am building a module to import text into an Excel workbook. After it imports, I want to format the data as a table. The problem I have is that the import will never have the same range. </p>\n\n<p>I'm using the following code, but it throws an error, Run-time error '424': Object required.</p>\n\n<pre><code>Sub ImportRange()\n\n  Dim ws As Worksheet\n  Dim lRow As Long\n  Dim lCol As Long\n  Dim rng As Range\n\n  Set ws = ThisWorkbook.Worksheets(\"Import\")\n\n  lRow = ws.UsedRange.Row - 1 + ws.UsedRange.Rows.Count\n  lCol = ws.UsedRange.Column - 1 + ws.UsedRange.Columns.Count\n\n  Set rng = ws.Cells(lRow, lCol).Address(True, True)\n\n  'MsgBox Cells(lRow, lCol).Address(True, True)\n\nEnd Sub\n</code></pre>\n\n<p>I've done quite a bit of searching, but I have been unable to find an answer or figure out how I should be doing this.</p>\n\n<p>The end result would look something like this in the code with the start of the range always being set to $A$1:</p>\n\n<pre><code>ws.ListObjects.Add(xlSrcRange, Range(\"$A$1:$AM$90\"), , xlYes).Name = _\n    \"Import\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1496865581, "post_id": 44421474, "comment_id": 75842028, "body": "I would suggest not using &quot;Row&quot; as a variable name."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496866490, "post_id": 44421474, "comment_id": 75842485, "body": "Question:  Are you trying to put the same data from range(&quot;AE2&quot;) into all 50 spaces?  Or are you trying to put  range(&quot;AE2&quot;)  into range(&quot;B2&quot;) , range(&quot;AE3&quot;)  into range(&quot;B3&quot;) , range(&quot;AE4&quot;)  into range(&quot;B4&quot;) , etc?"}, {"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496866874, "post_id": 44421474, "comment_id": 75842688, "body": "Thank you !! :))"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496871421, "post_id": 44421474, "comment_id": 75844807, "body": "I have done a rollback to the question as your latest changes invalidate the answers provided.  Please post a new question instead."}, {"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1496871598, "post_id": 44421474, "comment_id": 75844862, "body": "oh ok. Thanks !"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1496870158, "post_id": 44421533, "comment_id": 75844241, "body": "Thank you for your help!"}], "tags": [], "owner": {"reputation": 190, "user_id": 5927134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872d62710be12a87366b857a314b52c3?s=128&d=identicon&r=PG&f=1", "display_name": "SuShuang", "link": "https://stackoverflow.com/users/5927134/sushuang"}, "is_accepted": false, "score": 1, "last_activity_date": 1496864675, "creation_date": 1496864675, "answer_id": 44421533, "question_id": 44421474, "link": "https://stackoverflow.com/questions/44421474/simple-nested-for-loop/44421533#44421533", "title": "Simple Nested For Loop", "body": "<p>One way to do this is creating another variable and increment it, in second loop, each time +1. Like this:</p>\n\n<pre><code>For Area = 1 To 2\n    For Row = 1 To 50\n        myRow = myRow + 1\n        Sheets(\"A\").Cells(myRow, 2) = Sheets(\"A\").Cells(2, 31)\n        Next Row       \nNext Area\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1496866896, "post_id": 44421768, "comment_id": 75842704, "body": "Thank you! That was really helpful! : ))"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1496865604, "creation_date": 1496865604, "answer_id": 44421768, "question_id": 44421474, "link": "https://stackoverflow.com/questions/44421474/simple-nested-for-loop/44421768#44421768", "title": "Simple Nested For Loop", "body": "<p>There are many ways to do this.  A few of them would be:</p>\n\n<pre><code>For Area = 1 To 2\n    For Row = 1 To 50\n        Sheets(\"A\").Cells((Area - 1) * 50 + Row, 2) = Sheets(\"A\").Cells(2, 31)\n    Next Row       \nNext Area\n</code></pre>\n\n<p>or</p>\n\n<pre><code>For Area = 1 To 2\n    For Row = (Area - 1) * 50 + 1 To (Area - 1) * 50 + 50\n        Sheets(\"A\").Cells(Row, 2) = Sheets(\"A\").Cells(2, 31)\n    Next Row       \nNext Area\n</code></pre>\n\n<p>or changing <code>Area</code> to be zero-based</p>\n\n<pre><code>For Area = 0 To 1\n    For Row = 1 To 50\n        Sheets(\"A\").Cells(Area * 50 + Row, 2) = Sheets(\"A\").Cells(2, 31)\n    Next Row       \nNext Area\n</code></pre>\n\n<p>or avoiding loops</p>\n\n<pre><code>Sheets(\"A\").Cells(1, 2).Resize(50, 1) = Sheets(\"A\").Cells(2, 31)\nSheets(\"A\").Cells(51, 2).Resize(50, 1) = Sheets(\"A\").Cells(2, 31)\n</code></pre>\n\n<p>or, because you are copying the same value to the destination cells, simply</p>\n\n<pre><code>Sheets(\"A\").Cells(1, 2).Resize(100, 1) = Sheets(\"A\").Cells(2, 31)\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 44421768, "answer_count": 2, "score": 0, "last_activity_date": 1496871361, "creation_date": 1496864399, "last_edit_date": 1531164843, "question_id": 44421474, "link": "https://stackoverflow.com/questions/44421474/simple-nested-for-loop", "title": "Simple Nested For Loop", "body": "<p>I'm trying to paste \"Area1\" 50 times, and \"Area2\" 50 time right below \"Area1\" in the same column. My codes run the first 50 times, and replace the first 50 rows when running Area=2. How do I make \"Area2\" start on a new row, under \"Area1\"? Thank you :))</p>\n\n<pre><code>For Area = 1 To 2\n    For Row = 1 To 50\n        Sheets(\"A\").Cells(Row, 2) = Sheets(\"A\").Cells(2, 31)\n        Next Row       \nNext Area\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1496864654, "post_id": 44421289, "comment_id": 75841495, "body": "Why not post a self-contained sub or function? As it is, you have all sorts of undefined variables. It isn&#39;t even clear what <code>DataSet</code> is. Is it a VBA array? Collection? Range? How are <code>LowConf</code> and <code>HighConf</code> defined? The code given is too fragmentary. It is better if you can post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 45, "user_id": 8121747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1474783212587754/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/8121747/nick"}, "edited": false, "score": 0, "creation_date": 1496864846, "post_id": 44421289, "comment_id": 75841616, "body": "Got it. DataArray is Variant"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1496865078, "post_id": 44421289, "comment_id": 75841751, "body": "Tangential point: there is almost never a reason to use <code>Integer</code> or <code>Single</code> rather than <code>Long</code> or <code>Double</code>. <code>Integer</code> is asking for an overflow error sooner or later and <code>Single</code> is asking for less precision than can be easily obtained."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1496885267, "post_id": 44421289, "comment_id": 75848786, "body": "Warning warning: <code>UBound(DataSet) - mean)</code>, <code>LBound(DataSet) - mean</code>, these don&#39;t make sense. You are comparing <b>indices</b> to <b>values</b>. These are two different worlds. <code>mean</code> is derived from <i>values</i> in the array, <code>UBound</code> and <code>LBound</code> are the extreme indices (say addresses) of the array."}, {"owner": {"reputation": 45, "user_id": 8121747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1474783212587754/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/8121747/nick"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496927882, "post_id": 44421289, "comment_id": 75870999, "body": "@A.S.H is there a way to retrieve the value from the UBound and LBound of the data set first then I could store those and substitute them into those statements?"}, {"owner": {"reputation": 45, "user_id": 8121747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1474783212587754/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/8121747/nick"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496929621, "post_id": 44421289, "comment_id": 75872403, "body": "@A.S.H I substituted UBound(DataSet) - mean for application.worksheetfunction.max(DataSet) and then for the minima. It seems to work"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496931258, "post_id": 44421289, "comment_id": 75873794, "body": "Yes it works, because fortunately you are in the unidimensional world of numbers. If your data points were <i>multidimensional</i> then you should calculate Euclidean distances from the mean. anyway, now that you can have the extreme outliers, you can find their indices by using <code>Application.Match(Application.Max(DataSet))</code> and <code>Application.Match(Application.Min(DataSet))</code>."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8121747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1474783212587754/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/8121747/nick"}, "edited": false, "score": 0, "creation_date": 1496943438, "post_id": 44439750, "comment_id": 75882112, "body": "Thanks! I figured there was a way to shorten that, I lack the experience to know what to do for that. As for your strategy I will try it out and see what I can come up with. Is there a specific function that removes something from an array?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 45, "user_id": 8121747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1474783212587754/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/8121747/nick"}, "edited": false, "score": 0, "creation_date": 1496949894, "post_id": 44439750, "comment_id": 75885584, "body": "@Nick Arrays don&#39;t have a remove method so you have to implement your own way -- perhaps write a function which takes an array and returns a smaller array obtained by copying the elements that you want to keep. <code>Range</code> objects have a <code>Delete</code> method which is a more direct."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1496935794, "last_edit_date": 1496935794, "creation_date": 1496935378, "answer_id": 44439750, "question_id": 44421289, "link": "https://stackoverflow.com/questions/44421289/analyze-data-in-array-delete-then-re-analyze-vba/44439750#44439750", "title": "Analyze Data in array, delete, then re-analyze VBA", "body": "<p>This addresses the part of the question about how to clean up the code. Including white space, you have nearly 300 lines of code (determining the conf levels) which can be compressed into about a dozen or so. First, define a function:</p>\n\n<pre><code>Function ConfLevels(n As Long) As Variant\n    Dim i As Long\n    Dim cutpoints As Variant, lowconfs As Variant, highconfs As Variant\n\n    cutpoints = Array(5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 35, 40, 45, 50, 60, 70, 80, 90, 100, 150, 200, 300, 400, 500)\n    lowconfs = Array(1.72, 1.89, 2.02, 2.13, 2.21, 2.29, 2.36, 2.41, 2.46, 2.51, 2.55, 2.59, 2.62, 2.65, 2.68, 2.71, 2.73, 2.76, 2.78, 2.8, 2.82, 2.84, 2.86, 2.88, 2.89, 2.91, 2.98, 3.04, 3.09, 3.13, 3.2, 3.26, 3.31, 3.35, 3.38, 3.52, 3.61, 3.72, 3.8, 3.86)\n    highconfs = Array(1.76, 1.97, 2.14, 2.28, 2.39, 2.48, 2.56, 2.64, 2.7, 2.75, 2.81, 2.85, 2.9, 2.93, 2.97, 3#, 3.03, 3.06, 3.08, 3.11, 3.14, 3.16, 3.18, 3.2, 3.22, 3.24, 3.32, 3.38, 3.44, 3.48, 3.56, 3.62, 3.67, 3.72, 3.75, 3.89, 3.98, 4.09, 4.17, 4.32)\n    i = 0\n    Do While n &gt; cutpoints(i)\n        i = i + 1\n    Loop\n    ConfLevels = Array(lowconfs(i), highconfs(i)) \nEnd Function\n</code></pre>\n\n<p>Then in the main sub replace all that code by:</p>\n\n<pre><code>Dim levels As Variant 'in the declaration part, use a different name if you want\n\n'if n &gt; 500, handle error and exit sub\nlevels = ConfLevels(n)\nLowConf = levels(0)\nHignConf = levels(1)\n</code></pre>\n\n<p>You could even skip the variables <code>LowConf</code> and <code>HighConf</code> and use <code>levels(0)</code> and <code>levels(1)</code> directly.</p>\n\n<p>If you explained the heuristic you used, it might be able to shorten this even more by using worksheet functions such as <code>T.Inv.2T</code>. Where did these numbers come from?</p>\n\n<p>As far as the rest of your code goes, a reasonable strategy would be to write a recursive function which is fed a VBA array and returns a VBA array with all outliers removed (with the basis case being one which returns the array unchanged because there are no more outliers to remove). The main sub (which actually interacts with the spreadsheet and the user) could be relatively small. </p>\n"}], "owner": {"reputation": 45, "user_id": 8121747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1474783212587754/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/8121747/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1496952230, "creation_date": 1496863766, "last_edit_date": 1531164843, "question_id": 44421289, "link": "https://stackoverflow.com/questions/44421289/analyze-data-in-array-delete-then-re-analyze-vba", "title": "Analyze Data in array, delete, then re-analyze VBA", "body": "<p>As the code is now, I can analyze the DataSet and detect outliers according to values stored in LowConf and HighConf which are based on the size of DataSet. However, I can only determine one outlier in this. I want to expand the code or add to it so I can do the following:</p>\n\n<ol>\n<li>Identify the MOST outlying element first</li>\n<li>Determine if it is an outlier, if so, delete that element from DataSet, if not, end the program.</li>\n<li>Alter the sample size (subtract 1) and analyze the DataSet again for the next MOST outlying element and loop that k times.</li>\n</ol>\n\n<p>My idea is to make a new array that is the distance (absolute value) from each DataSet element from the mean and then find the UBound of that and analyze that in the If statements below. My question is that once i determine whether or not it is an outlier, how do I get back to the corresponding element in DataSet and delete that? If so, is there an easier way to go about this? Also, I am new to coding so any tips on acceptable format / how to clean up the code is also appreciated.</p>\n\n<pre><code>Sub CalculateOutliers()\n\n    Dim n As Integer\n    Dim mean As Double\n    Dim SD As Double\n    Dim k As Integer\n    Dim DataSet As Variant\n    Dim LowConf As Single\n    Dim HighConf As Single\n\n\n'--------------------------------------------------------\n    DataSet = Selection.Value\n'Copies highlighted data into DataSet variable\n'Cell A1 is (1,1) Because it starts at 0 which is out of range\n'--------------------------------------------------------\n\n\n\n'--------------------------------------------------------\n    n = Selection.CountLarge\n'Counts number of entries\n'--------------------------------------------------------\n\n\n\n'--------------------------------------------------------\n 'DEFINES 95(LowConf) AND 99(HighConf) PERCENT CONFIDENCES BASED ON\n 'SAMPLE SIZE\n\n        If n &lt;= 5 Then\n\n            LowConf = 1.72\n            HighConf = 1.76\n    End If\n\n        If n = 6 Then\n\n            LowConf = 1.89\n            HighConf = 1.97\n\n    End If\n\n        If n = 7 Then\n\n            LowConf = 2.02\n            HighConf = 2.14\n\n    End If\n\n        If n = 8 Then\n\n            LowConf = 2.13\n            HighConf = 2.28\n\n    End If\n\n        If n = 9 Then\n\n            LowConf = 2.21\n            HighConf = 2.39\n\n    End If\n\n        If n = 10 Then\n\n            LowConf = 2.29\n            HighConf = 2.48\n\n    End If\n\n        If n = 11 Then\n\n            LowConf = 2.36\n            HighConf = 2.56\n\n    End If\n\n        If n = 12 Then\n\n            LowConf = 2.41\n            HighConf = 2.64\n\n    End If\n\n        If n = 13 Then\n\n            LowConf = 2.46\n            HighConf = 2.7\n\n    End If\n\n        If n = 14 Then\n\n            LowConf = 2.51\n            HighConf = 2.75\n\n    End If\n\n        If n = 15 Then\n\n            LowConf = 2.55\n            HighConf = 2.81\n\n    End If\n\n        If n = 16 Then\n\n            LowConf = 2.59\n            HighConf = 2.85\n\n    End If\n\n        If n = 17 Then\n\n            LowConf = 2.62\n            HighConf = 2.9\n\n    End If\n\n        If n = 18 Then\n\n            LowConf = 2.65\n            HighConf = 2.93\n\n    End If\n\n        If n = 19 Then\n\n            LowConf = 2.68\n            HighConf = 2.97\n\n    End If\n\n        If n = 20 Then\n\n            LowConf = 2.71\n            HighConf = 3\n\n    End If\n\n        If n = 21 Then\n\n            LowConf = 2.73\n            HighConf = 3.03\n\n    End If\n\n        If n = 22 Then\n\n            LowConf = 2.76\n            HighConf = 3.06\n\n    End If\n\n        If n = 23 Then\n\n            LowConf = 2.78\n            HighConf = 3.08\n\n    End If\n\n        If n = 24 Then\n\n            LowConf = 2.8\n            HighConf = 3.11\n\n    End If\n\n        If n = 25 Then\n\n            LowConf = 2.82\n            HighConf = 3.14\n\n    End If\n\n        If n = 26 Then\n\n            LowConf = 2.84\n            HighConf = 3.16\n\n    End If\n\n        If n = 27 Then\n\n            LowConf = 2.86\n            HighConf = 3.18\n\n    End If\n\n        If n = 28 Then\n\n            LowConf = 2.88\n            HighConf = 3.2\n\n    End If\n\n        If n = 29 Then\n\n            LowConf = 2.89\n            HighConf = 3.22\n\n    End If\n\n        If n = 30 Then\n\n            LowConf = 2.91\n            HighConf = 3.24\n\n    End If\n\n        If n &lt;= 35 And n &gt; 30 Then\n\n            LowConf = 2.98\n            HighConf = 3.32\n\n    End If\n\n        If n &lt;= 40 And n &gt; 35 Then\n\n            LowConf = 3.04\n            HighConf = 3.38\n\n    End If\n\n        If n &lt;= 45 And n &gt; 40 Then\n\n            LowConf = 3.09\n            HighConf = 3.44\n\n    End If\n\n        If n &lt;= 50 And n &gt; 45 Then\n\n            LowConf = 3.13\n            HighConf = 3.48\n\n    End If\n\n        If n &lt;= 60 And n &gt; 50 Then\n\n            LowConf = 3.2\n            HighConf = 3.56\n\n    End If\n\n        If n &lt;= 70 And n &gt; 60 Then\n\n            LowConf = 3.26\n            HighConf = 3.62\n\n    End If\n\n        If n &lt;= 80 And n &gt; 70 Then\n\n            LowConf = 3.31\n            HighConf = 3.67\n\n    End If\n\n        If n &lt;= 90 And n &gt; 80 Then\n\n            LowConf = 3.35\n            HighConf = 3.72\n\n    End If\n\n        If n &lt;= 100 And n &gt; 90 Then\n\n            LowConf = 3.38\n            HighConf = 3.75\n\n    End If\n\n        If n &lt;= 150 And n &gt; 100 Then\n\n            LowConf = 3.52\n            HighConf = 3.89\n\n    End If\n\n        If n &lt;= 200 And n &gt; 150 Then\n\n            LowConf = 3.61\n            HighConf = 3.98\n\n    End If\n\n        If n &lt;= 300 And n &gt; 200 Then\n\n            LowConf = 3.72\n            HighConf = 4.09\n\n    End If\n\n        If n &lt;= 400 And n &gt; 300 Then\n\n            LowConf = 3.8\n            HighConf = 4.17\n\n    End If\n\n        If n &lt;= 500 And n &gt; 400 Then\n\n            LowConf = 3.86\n            HighConf = 4.32\n\n    End If\n\n        If n &gt; 500 Then\n\n            MsgBox \"Sample size cannot exceed 500.\"\n\n    End If\n'--------------------------------------------------------\n\n\n\n'--------------------------------------------------------\n        If n &lt; 50 Then\n\n            k = Int(n / 10)\n\n        Else\n\n            k = 5\n\n    End If\n'determines k = number of possible outliers\n'--------------------------------------------------------\n\n\n\n'--------------------------------------------------------\n    mean = Application.WorksheetFunction.Average(DataSet)\n'Calculates mean of Data Set\n'--------------------------------------------------------\n\n\n\n'--------------------------------------------------------\n    SD = Application.WorksheetFunction.StDev(DataSet)\n'Calculates Standard Deviation of Data Set\n'--------------------------------------------------------\n\n\n\n'--------------------------------------------------------\n\n\n        For Each element In DataSet\n\n\n            If (Abs(element - mean) / SD) &gt; LowConf Then\n\n                MsgBox \"95% outlier: \" &amp; element\n\n\n        End If\n\n            If (Abs(element - mean) / SD) &gt; HighConf Then\n\n                MsgBox \"99% outlier: \" &amp; element\n\n\n        End If\n\n\n        Next element\n'--------------------------------------------------------\n\n\nEnd Sub\n</code></pre>\n\n<p>UPDATE: I have figured out the following chunk of code. This loop should work  but now I just need to figure out how to delete Suspect from the DataSet. Once it is deleted it will loop back and recalculate mean and SD and Suspect. I realize I have no code for when UBound is equal to LBound but that is something I will deal with after this. With this code, Suspect keeps showing a value of 1. I am not sure why this is nor am I sure if the DataSet.Remove(Suspect) works.</p>\n\n<pre><code>Dim i As Long\n\n    For i = 1 To k\n\n\n'--------------------------------------------------------\n    mean = Application.WorksheetFunction.Average(DataSet)\n'Calculates mean of Data Set\n'--------------------------------------------------------\n\n\n\n'--------------------------------------------------------\n    SD = Application.WorksheetFunction.StDev(DataSet)\n'Calculates Standard Deviation of Data Set\n'--------------------------------------------------------\n\n\n\n'--------------------------------------------------------\n    Dim Suspect As Double\n        If (Abs(UBound(DataSet) - mean)) &gt; (Abs(LBound(DataSet) - mean)) Then\n            Suspect = UBound(DataSet)\n        End If\n        If (Abs(UBound(DataSet) - mean)) &lt; (Abs(LBound(DataSet) - mean)) Then\n            Suspect = LBound(DataSet)\n        End If\n'Defines what the most outlying value is\n'--------------------------------------------------------\n\n\n\n'--------------------------------------------------------\n    Dim Retest As Boolean\n\n            If (Abs(Suspect - mean) / SD) &gt; LowConf Then\n\n                MsgBox \"95% outlier: \" &amp; Suspect\n                Retest = True\n\n        End If\n\n            If (Abs(Suspect - mean) / SD) &gt; HighConf Then\n\n                MsgBox \"99% outlier: \" &amp; Suspect\n                Retest = True\n\n        End If\n\n            If Retest = True Then\n                DataSet.Remove (Suspect)\n            End If\n   MsgBox Suspect\n'--------------------------------------------------------\nNext i\n</code></pre>\n\n<p>UPDATE: I have changed the portion a bit. I can apply this to the minimum but How can i specify the position of Suspect and use that as the range for the delete and shift up?</p>\n\n<pre><code>                        Dim Retest As Boolean\n\n                        If (Abs(Suspect - mean) / SD) &gt; LowConf Then\n\n                            MsgBox \"95% outlier: \" &amp; Suspect\n                            Retest = True\n\n                    End If\n\n                        If (Abs(Suspect - mean) / SD) &gt; HighConf Then\n\n                            MsgBox \"99% outlier: \" &amp; Suspect\n                            Retest = True\n\n                    End If\n                    Dim pos As Range\n\n                        Set pos = Application.Match(Suspect, DataSet)\n                        MsgBox pos\n                        If Retest = True And Suspect = Application.WorksheetFunction.Max(DataSet) Then\n\n                           Range(pos).Delete Shift:=xlUp\n\n                        End If\n</code></pre>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1496864174, "post_id": 44421259, "comment_id": 75841234, "body": "I&#39;ve never used named parameters on the Range call, so I am just giving you the simplest solution for most situations. <code>Set rngcellsItemSKu = ThisWorkbook.Worksheets(&quot;V&quot;).Range(&quot;A10:A15&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 8116886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/993acec80aed9bad4a5dff6136fec0e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ken ", "link": "https://stackoverflow.com/users/8116886/ken"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1496866117, "post_id": 44421259, "comment_id": 75842281, "body": "Still returns no value for rngcellsItemSKu Not sure what is going on."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1496875044, "post_id": 44421259, "comment_id": 75846138, "body": "What do you mean by <i>&quot;returns no value&quot;</i>? The method suggested by @MacroMarc to access the range is correct if you are running VBA from Excel. Are you running VBA from <code>Access</code> or <code>Excel</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8116886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/993acec80aed9bad4a5dff6136fec0e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ken ", "link": "https://stackoverflow.com/users/8116886/ken"}, "edited": false, "score": 0, "creation_date": 1496865219, "post_id": 44421454, "comment_id": 75841833, "body": "i am more than willing to use a different way to accomplish my goal.  What I am trying to do is assign a range-name to each column, so I can use SQL SELECT language to select &quot;fields&quot; where columns are the fields.  From what I have been reading, I thought assigning Range-Names which will be used in place of fiends, because the first row in my spreadsheet are not the column names.  So if there is a better way to do that, I will scrap the above code! Thx."}, {"owner": {"reputation": 1, "user_id": 8116886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/993acec80aed9bad4a5dff6136fec0e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ken ", "link": "https://stackoverflow.com/users/8116886/ken"}, "edited": false, "score": 0, "creation_date": 1496866062, "post_id": 44421454, "comment_id": 75842255, "body": "BTW, this is a result of reading over 50 web links so I am more confused than ever! I am doing my best not to bother people with my questions, but I am now rereading links, so i can&#39;t find solutions to these problems! I need HELP! :-\\"}], "tags": [], "owner": {"reputation": 190, "user_id": 5927134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872d62710be12a87366b857a314b52c3?s=128&d=identicon&r=PG&f=1", "display_name": "SuShuang", "link": "https://stackoverflow.com/users/5927134/sushuang"}, "is_accepted": false, "score": 0, "last_activity_date": 1496864339, "creation_date": 1496864339, "answer_id": 44421454, "question_id": 44421259, "link": "https://stackoverflow.com/questions/44421259/why-is-variable-empty-for-set-range-issue-has-become-moot-and-resolution-no-lo/44421454#44421454", "title": "Why is variable empty for Set Range? [ISSUE HAS BECOME MOOT AND RESOLUTION NO LONGER NEEDED]", "body": "<p>Woah, what a strange method you're using :) First time see sth like that :)</p>\n\n<p>Try this:</p>\n\n<pre><code>Dim rngcellsItemSKu As Range\nDim rngnameItemSKU\nDim rngnameItemSKUAsString As String\n\nSet rngcellsItemSKu = Sheets(\"V\").Range(\"A10:A15\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8116886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/993acec80aed9bad4a5dff6136fec0e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ken ", "link": "https://stackoverflow.com/users/8116886/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1496924391, "creation_date": 1496863633, "last_edit_date": 1496924391, "question_id": 44421259, "link": "https://stackoverflow.com/questions/44421259/why-is-variable-empty-for-set-range-issue-has-become-moot-and-resolution-no-lo", "title": "Why is variable empty for Set Range? [ISSUE HAS BECOME MOOT AND RESOLUTION NO LONGER NEEDED]", "body": "<p>NOTE: I added some code below to provide a better idea of what I am attempting to do.  If there is a better way to do this, please share.</p>\n\n<p>Although this is about the same project, it is a different topic, so I am starting a new thread.  The issue with the other thread still is unresolved.</p>\n\n<p>This issue is a possible path towards the solution to the other problem, but the issue is totally different and will effect other parts of this project.  </p>\n\n<pre><code>Dim rngcellsItemSKu As Excel.Range\nDim rngnameItemSKU\nDim rngnameItemSKUAsString As String\nDim ST as Recordset\nDim db as Database\n\nSet rngcellsItemSKu = Excel.Range(Cell1:=\"V!A10:A15\")\n\nrngnameItemSKU = rngcellsItemSKu\n\nrngcellsItemSKu.Name = \"ItemSKU\"\nrngnameItemSKU = rngcellsItemSKu.Name\n\nset db = DBEngine.OpenDatabase([DBFILENAME], False, False, \"Excel 12.0;\")\n\nST = \"SELECT * FROM [V$] WHERE \"\" &amp; rngnameItemSKU &amp; \"\" IS NOT NULL\"\nSet rst = db.OpenRecordset(ST)\n</code></pre>\n\n<p>The <code>set rng****</code> line where the issue starts.  When I am in debug mode, it has no value.  When I place the mouse cursor over the <code>rngcellsItemSKu</code> variable it shows nothing.  Later on when I attempt to name the range so I can refer to it, the code crashes.  Why is this happening?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1496863913, "creation_date": 1496863913, "answer_id": 44421332, "question_id": 44421139, "link": "https://stackoverflow.com/questions/44421139/vba-if-value-in-range-1-then-value-in-range-2-multiple-by-1/44421332#44421332", "title": "VBA if value in range 1 then value in range 2 multiple by -1", "body": "<p>to do it without loops:</p>\n\n<pre><code>Sub change()\nDim rng As Range\nDim rngsear As Range\nDim lastrow As Long\nWith ActiveSheet\n    lastrow = .Range(\"D\" &amp; .Rows.Count).End(xlUp).Row\n    Set rng = .Range(\"D15:D\" &amp; lastrow)\n    Set rngsear = .Range(\"C15:C\" &amp; lastrow)\n    rngsear.Value = .Evaluate(\"IF((\" &amp; rng.Address &amp; \" &gt;= 40000)*(\" &amp; rng.Address &amp; \" &lt; 60000),\" &amp; rngsear.Address &amp; \" * -1,\" &amp; rngsear.Address &amp; \")\")\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 44421332, "answer_count": 1, "score": 2, "last_activity_date": 1496863913, "creation_date": 1496863236, "question_id": 44421139, "link": "https://stackoverflow.com/questions/44421139/vba-if-value-in-range-1-then-value-in-range-2-multiple-by-1", "title": "VBA if value in range 1 then value in range 2 multiple by -1", "body": "<p>This is columns C and G in excel </p>\n\n<pre><code>($12,843.63)    40100\n($9,584.60)     53450\n($67,933.38)    53500\n($2,615.56)     54900\n$43,378.11      72100\n$607.91         72100\n$14,843.94      72400\n$286.62         72440\n$3,283.73       72500\n$46.50          72500\n$9,392.28       75400\n$3,754.16       81100\n$540.00         81300\n$6,186.20       82110\n$4,658.21       82140\n$13,576.61      82160\n$35,467.33      82200\n$196.18         82600\n$10.83          83100\n$34.84          83140\n$22,535.60      85240\n$691.47         85260\n$145.00         85300\n($45.00)        85980\n$1,010.00       86500\n$32,249.97      99150\n($8,992.44)     99200\n$0.00           72100\n</code></pre>\n\n<p>'If the value in the second range is between 40000 and 60000 then the value in the first range is multiplied by -1</p>\n\n<pre><code>Dim rng As Range\nDim rngsear As Range\nSet rng = Range(\"D15:D\" &amp; lastrow)\nSet rngsear = Range(\"C15:C\" &amp; lastrow)\nIf rng.Value &gt;= (40000 &lt; 60000) Then\nrngsear.Value = -rngsear.Value\nEnd If\n</code></pre>\n\n<p>It says I have a run-time error '91'\nObject variable or With block variable not set\nI'm not sure how to make it loop properly.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31, "user_id": 8127613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b772f951c144accb88961c798f7f00b?s=128&d=identicon&r=PG&f=1", "display_name": "Marek01", "link": "https://stackoverflow.com/users/8127613/marek01"}, "edited": false, "score": 0, "creation_date": 1496865182, "post_id": 44421077, "comment_id": 75841807, "body": "What I want to do is application with something like menu to many different excel sheet. So user can find and have access to all excel files in one place."}], "owner": {"reputation": 31, "user_id": 8127613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b772f951c144accb88961c798f7f00b?s=128&d=identicon&r=PG&f=1", "display_name": "Marek01", "link": "https://stackoverflow.com/users/8127613/marek01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496865708, "creation_date": 1496862999, "last_edit_date": 1496865708, "question_id": 44421077, "link": "https://stackoverflow.com/questions/44421077/display-excel-sheet-with-macro-inside-form", "title": "Display Excel sheet with macro inside form", "body": "<p>I got application in .net and I would like to display excel sheet with macro inside my form. I found code that display excel file inside panel and everything works ok but once I run macro its frozen. If I will not run macro Its work fine.</p>\n\n<pre><code>Imports excel = Microsoft.office.interop.excel\nImports office = Microsoft.office.core\n\n\n\nPublic Class Form1\n   Declare Auto Function SetParent Lib \"user32.dll\" (ByVal hWndChild As IntPtr, ByVal hWndNewParent As IntPtr) As Integer\n    Declare Auto Function SendMessage Lib \"user32.dll\" (ByVal hWnd As IntPtr, ByVal Msg As Integer, ByVal wParam As Integer, ByVal lParam As Integer) As Integer\n    Private Const WM_SYSCOMMAND As Integer = 274\n    Private Const SC_MAXIMIZE As Integer = 61488\n    Private Sub btnShowExcel_Click(sender As Object, e As EventArgs) Handles btnShowExcel.Click\n        Dim sExcelFileName = \"D:\\123.xlsm\"\n        Dim oExcel As New Excel.Application\n        oExcel.DisplayAlerts = False\n        oExcel.Workbooks.Open(sExcelFileName)\n        oExcel.Application.WindowState = excel.XlWindowState.xlNormal\n        oExcel.Visible = True\n        SetParent(oExcel.Hwnd, pnlExcel.Handle)\n        SendMessage(oExcel.Hwnd, WM_SYSCOMMAND, SC_MAXIMIZE, 0)\n    End Sub\n\n\nEnd Class\n</code></pre>\n\n<p>Could anyone help me to change this code or find different one so I could display excel file with macro and macro will work without any problem.</p>\n\n<p>Thanks \nRegards\nMark</p>\n"}, {"tags": ["vba", "copy-paste", "powerpoint", "publisher"], "owner": {"reputation": 11, "user_id": 8126779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3387a8efe09e770425a96eba1c7bc970?s=128&d=identicon&r=PG&f=1", "display_name": "mgczy", "link": "https://stackoverflow.com/users/8126779/mgczy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496862745, "creation_date": 1496862745, "question_id": 44420989, "link": "https://stackoverflow.com/questions/44420989/is-it-possible-to-use-vba-code-to-copy-and-paste-individual-ppt-slides-into-a-pu", "title": "Is it possible to use VBA code to copy and paste individual ppt slides into a publisher document?", "body": "<p>I am trying to copy many ppt slides (from the same ppt) onto an existing publisher document. I've been trying to piece a code together to do this but I can't figure it out due to lack of experience.</p>\n\n<p>I preferably want to only copy the shape on each ppt slide and be able to update the publisher document if any changes are made to the ppt. To complicate things is there a way to initially position all the slides in rows and columns when copying them into the publisher document? </p>\n\n<p>This is what I have so far.</p>\n\n<pre><code>Sub PPTSlidesToPublisher()\n'Copy/Paste Power Point slides Into an existing Publisher document\n\n'Copy Range from PPT\nSet rng = ActivePresentation.Slides.Range\n\nDim appPub As New Publisher.Application\n\nappPub.Open FileName:=\"filename.pub\", _\nReadOnly:=False, AddToRecentFiles:=False, _\nSaveChanges:=pbPromptToSaveChanges\nappPub.ActiveWindow.Visible = True\n\nDim myDocument As Object\nDim myPage As Object\nDim myShape As Object\n\n\n'Add a page to the Documenet\nDim shpSlide As Shape\nSet rng = OLEObject\nSet shpSlide = ActiveDocument.Pages(3).Shapes.AddOLEObject _\n(Left:=2, Top:=5, ClassName:=\"Publisher.Application\")\n\nshpSlide.OLEFormat.Activate\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496863105, "post_id": 44420869, "comment_id": 75840589, "body": "<code>Worksheets(&quot;JE&quot;).Range(&quot;F:F&quot;).Value = ActiveCell.Value</code> - do you really want to fill that value in the whole column F ?  What is <code>ActivateCell</code> here?"}, {"owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496863344, "post_id": 44420869, "comment_id": 75840737, "body": "@TimWilliams I don&#39;t want to fill it into the whole column. Just the row the user is using. I tried that to see what would happen and it didn&#39;t result in what I was looking for."}, {"owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1497015930, "post_id": 44420869, "comment_id": 75915103, "body": "@TimWilliams I&#39;m still having some issues getting cell values being clicked on in a sheet, to populate in the original form. When I try to click on multiple values to populate the C column of the original form, The value just overwrites the first one, staying in cell C7. Do you know how I can get it so if the user clicks on 3 values to be in the C column it will know to go to next available row in the C column? I&#39;ll post my code in my question. Thanks for any help!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1497026540, "post_id": 44420869, "comment_id": 75922269, "body": "C column, or F column?  If you want to be able to fill down by clicking multiple values then whenever the user triggers the double-click use something like <code>Set sourceRange = sourceRange.Offset(1, 0)</code> to move the destination cell down one row"}, {"owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1497033458, "post_id": 44420869, "comment_id": 75926070, "body": "@TimWilliams The C column. I inputted that code under the double-click event and it didn&#39;t seem to work. I was hoping to be able to add many values in the C column (C7:C446). So, if I already have a value in cell C7 and I want to also add more values to the C column, I am able to. As of right now, I can only add values to the C7. I&#39;m unsure of the syntax to execute that or where to put that snip it of code. Any additional help would be awesome. I realize its probably a small fix but I am not familiar with VBA at all."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1497036411, "post_id": 44420869, "comment_id": 75927527, "body": "I&#39;m having problem visualizing what you&#39;re describing.  There&#39;s no reference to ColC in your original code or updates: you state that double-clicking a value in ColA should populate the F column back on the JE sheet, so where does ColC come in to this?  Might be time to start a new question for this part..."}, {"owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1497036955, "post_id": 44420869, "comment_id": 75927776, "body": "@TimWilliams You&#39;re right. I did a poor job of describing what I&#39;m looking for. I&#39;ll start a new question. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "edited": false, "score": 0, "creation_date": 1496863909, "post_id": 44421106, "comment_id": 75841074, "body": "should the code inside the macro sheets be what I just added to my original code?   <code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)  If Target.Column = 1 Then Worksheets(&quot;JE&quot;).Range(&quot;F&quot; &amp; Target.Row &amp; &quot;:F&quot; &amp; Target.Row).Value = ActiveCell.ValueCancel = True End If End Sub</code>"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1496863134, "creation_date": 1496863134, "answer_id": 44421106, "question_id": 44420869, "link": "https://stackoverflow.com/questions/44420869/excel-vba-how-to-populate-values-from-different-sheets/44421106#44421106", "title": "Excel VBA how to populate values from different sheets", "body": "<p>Have you tried using the Target argument? It will tell you the row and column that is being double clicked, and you can use that to construct the range more specifically.</p>\n\n<pre><code>Worksheets(\"JE\").Range(\"F\" &amp; Target.Row &amp; \":F\" &amp; Target.Row).Value = ActiveCell.Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "edited": false, "score": 0, "creation_date": 1496929253, "post_id": 44422543, "comment_id": 75872114, "body": "When I go to double-click the values in the A column in &quot;other Sheet&quot;, in the macros, I get an Object-Required for the <code>If Not JE.sourceRange Is Nothing Then</code> statement. Any idea why? My guess is because the <code>JE.sourceRange</code> hasn&#39;t been set to anything?"}, {"owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "edited": false, "score": 0, "creation_date": 1496932699, "post_id": 44422543, "comment_id": 75874978, "body": "How can the code in the macros (&quot;Other Sheets&quot;) change the color of the F column cells in the JE sheet? The code I edited in my original post show how I&#39;ve tried to do that. Could you provide feedback as to how I can go about that?"}, {"owner": {"reputation": 683, "user_id": 7047935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wCtAP.jpg?s=128&g=1", "display_name": "smartobelix", "link": "https://stackoverflow.com/users/7047935/smartobelix"}, "reply_to_user": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "edited": false, "score": 0, "creation_date": 1496934417, "post_id": 44422543, "comment_id": 75876326, "body": "<code>JE.sourceRange.Cells.Interior.ColorIndex = 0</code>. If you have Object -Required message for line <code>If Not JE.sourceRange Is Nothing Then</code> means your JE Sheet has different name - look in VBA editor how it is named in VBA - after typing JE and dot Intelli Sense should advice sourceRange"}], "tags": [], "owner": {"reputation": 683, "user_id": 7047935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wCtAP.jpg?s=128&g=1", "display_name": "smartobelix", "link": "https://stackoverflow.com/users/7047935/smartobelix"}, "is_accepted": false, "score": 1, "last_activity_date": 1496868667, "creation_date": 1496868667, "answer_id": 44422543, "question_id": 44420869, "link": "https://stackoverflow.com/questions/44420869/excel-vba-how-to-populate-values-from-different-sheets/44422543#44422543", "title": "Excel VBA how to populate values from different sheets", "body": "<p>You need to store somwhere original <code>Range</code> active before user switch to different worksheet. Then you will be able to write there value.</p>\n\n<p>How to do it:</p>\n\n<p>1) Add public variable on worksheet JE (just after line Option Explicit)</p>\n\n<pre><code>Public sourceRange As Range\n</code></pre>\n\n<p>2) In event <code>Worksheet_SelectionChange</code> on worksheet JE add just after first if code to set variable to current <code>Range</code> - please also notice first line with setting variable to Nothing - it is required to avoid remembering last range forever:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n  Set sourceRange = Nothing ' Set it to nothing to avoid too long remembering\n  If Target.Column = 6 And Target.Cells.Count = 1 And Target.Interior.ColorIndex = 3 Then\n      Set sourceRange = Target ' Remember source cell\n      'Cancel = True\n</code></pre>\n\n<p>3) Now it is easy - just use variable in double click event on other sheet:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nIf Target.Column = 1 Then\n    If Not JE.sourceRange Is Nothing Then\n        JE.sourceRange.Value = ActiveCell.Value\n    End If\n</code></pre>\n\n<p>Please note rest of code should stay like it is - for clarity I put only fragments where you need to change something.</p>\n"}], "owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1792, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1497016078, "creation_date": 1496862350, "last_edit_date": 1497016078, "question_id": 44420869, "link": "https://stackoverflow.com/questions/44420869/excel-vba-how-to-populate-values-from-different-sheets", "title": "Excel VBA how to populate values from different sheets", "body": "<p>I have a sheet that I want to be able to transport cell values being double-clicked by users to another sheet/form called JE. </p>\n\n<p><strong><em>Example</em></strong>: user clicks on cell F10 in sheet JE, that takes the user to a different sheet (containing a macro), once the user is at that sheet, I want the user to be able to double-click any cell in the A column and the cell value being clicked, fills cell F10 back in sheet JE. So, after being navigated to a macro/different sheet, If the user double clicks on cell A7 and the value \"123ABC\" is in A7, I would like \"123ABC\" to populate cell F10 in sheet JE. Similarly, if the user clicks cell F25 on sheet JE, and still chooses to double-click A7 in a different sheet, I would like the value \"123ABC\" to fill F25 in sheet JE. I would also like the cell in column F to turn to a no-fill background once a value is present in the cell. </p>\n\n<p>The issue I am having now is that my code is set up in such a way that no matter which row the user is using on sheet JE, the values in column A of the macros are only filling the first cell in column F(F7) Whereas, I want the value being double-clicked on in the macro to fill in the F column cell that is active, not the first cell in the F column. Also, when double-clicked, the values in column A of the macros, are not changing the background color of the red cell in column F to a no fill, white background. </p>\n\n<p>This code is the code associated with sheet JE (The main form users are filling out)</p>\n\n<pre><code>Option Explicit\nPublic sourceRange As Range\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n'  If Not Intersect(Target, Range(\"C7:D446\")) Is Nothing Then\n      Dim c As Range: Set c = Range(\"D7:D446\")\n'     For Each c In Target\n For Each c In c.Cells\n          Select Case c.Value\n              Case \"1000GP\", \"1000MM\", \"19FEST\", \"20IEDU\", \"20ONLC\", \"20PART\", \"20PRDV\", \"20SPPR\", \"22DANC\", \"22LFLC\", \"22MEDA\", \"530CCH\", \"60POUBL\", \"74GA01\", \"74GA17\", \"74GA99\", \"78REDV\"\n                  Cells(c.Row, \"F\").Interior.ColorIndex = 3\n              Case Else\n                 Cells(c.Row, \"F\").Interior.ColorIndex = 0\n          End Select\n      Next c\n' End If\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n  Set sourceRange = Nothing ' Set it to nothing to avoid too long remembering\n  If Target.Column = 6 And Target.Cells.Count = 1 And Target.Interior.ColorIndex = 3 Then\n      Set sourceRange = Target ' Remember source cell\n      'Cancel = True\n      Select Case Target.Offset(0, -2).Value2\n        Case \"1000GP\": gotoref1\n        Case \"1000MM\": gotoref2\n        Case \"19FEST\": gotoref3\n        Case \"20IEDU\": gotoref4\n        Case \"20ONLC\": gotoref5\n        Case \"20PART\": gotoref6\n        Case \"20PRDV\": gotoref7\n        Case \"20SPPR\": gotoref8\n        Case \"22DANC\": gotoref9\n        Case \"22LFLC\": gotoref10\n        Case \"22MEDA\": gotoref11\n        Case \"530CCH\": gotoref12\n        Case \"60PUBL\": gotoref13\n        Case \"74GA01\": gotoref14\n        Case \"74GA17\": gotoref15\n        Case \"74GA99\": gotoref16\n        Case \"78REDV\": gotoref17\n      End Select\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This is the code that lies in all of the macro sheets which the user is brought to when clicking on the cells in the F column in Sheet JE.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n'Set JE.sourceRange = Target.Value\nIf Target.Column = 1 Then\n   If Not JE.sourceRange Is Nothing Then\n        JE.sourceRange.Value = ActiveCell.Value\n        Cells(c.Row, \"F\").Interior.ColorIndex = 0\n\nEnd If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I am also having trouble getting values for the C column to populate multiple rows. For example, if I already have a value in C7 and want to add a value being clicked on in a sheet to the C column as well, If i click on a value, it will overwrite the value in C7 rather than populating cell C8. Here is the code I have for that sheet:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nIf Target.Column = 1 Then\n'Sheet2.Range(\"F\" &amp; Target.Row &amp; \":F\" &amp; Target.Row).Value = ActiveCell.Value\nSheet2.sourceRange.Value = ActiveCell.Value\nWorksheets(\"JE\").Activate\n'Sheet2.Activate\n\n'Cells(c.Row, \"F\").Interior.ColorIndex = 3\nCancel = True\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "password-protection", "vba"], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 2756792, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7387491454a6a7e25fdcc14adffa5ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi", "link": "https://stackoverflow.com/users/2756792/vamsi"}, "edited": false, "score": 0, "creation_date": 1496869229, "post_id": 44421009, "comment_id": 75843854, "body": "Nope, I&#39;m password protecting the workbook (not the VBA code) for structure using the following code in VBA- ActiveWorkbook.Protect Password = &quot;xyz&quot;, Structure:=True, Windows:=False  and when I try to unprotect the sheet by entering &quot;xyz&quot; it says password is wrong"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1496862799, "creation_date": 1496862799, "answer_id": 44421009, "question_id": 44420753, "link": "https://stackoverflow.com/questions/44420753/excel-protect-password-not-compatible-with-vba-password/44421009#44421009", "title": "Excel: Protect password not compatible with VBA password?", "body": "<p>If I am understanding your question correctly, it happens because each password is protecting something different. They are not the same thing. You can have a workbook that is not password protected but the VBA code <strong>is</strong> password protected.</p>\n"}, {"tags": [], "owner": {"reputation": 462, "user_id": 2756792, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7387491454a6a7e25fdcc14adffa5ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi", "link": "https://stackoverflow.com/users/2756792/vamsi"}, "is_accepted": true, "score": 1, "last_activity_date": 1496873773, "creation_date": 1496873773, "answer_id": 44423649, "question_id": 44420753, "link": "https://stackoverflow.com/questions/44420753/excel-protect-password-not-compatible-with-vba-password/44423649#44423649", "title": "Excel: Protect password not compatible with VBA password?", "body": "<p>After some analysis, I figured out what the issue is in my code -</p>\n\n<pre><code>ActiveWorkbook.Protect Password = \"xyz\", Structure:=True, Windows:=False\n</code></pre>\n\n<p>The password option was assigned with an \"=\" sign instead of a \":=\". This code still protects the sheet but with an empty password. When I use a similar Unprotect code like, </p>\n\n<pre><code>ActiveWorkbook.Unprotect Password = \"xyz\"\n</code></pre>\n\n<p>the unprotect code is passing on an empty password. Hence, if I try a manual password of \"xyz\" it throws an error.</p>\n\n<p>The correct code that solves the issue is </p>\n\n<pre><code>ActiveWorkbook.Protect Password:= \"xyz\", Structure:=True, Windows:=False\nActiveWorkbook.Unprotect Password:= \"xyz\n</code></pre>\n"}], "owner": {"reputation": 462, "user_id": 2756792, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7387491454a6a7e25fdcc14adffa5ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi", "link": "https://stackoverflow.com/users/2756792/vamsi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 0, "accepted_answer_id": 44423649, "answer_count": 2, "score": 0, "last_activity_date": 1496873773, "creation_date": 1496861900, "last_edit_date": 1531161705, "question_id": 44420753, "link": "https://stackoverflow.com/questions/44420753/excel-protect-password-not-compatible-with-vba-password", "title": "Excel: Protect password not compatible with VBA password?", "body": "<p>I know of the 2 possible ways to password-protect sheets in Excel -</p>\n\n<ol>\n<li>Manual Password protect</li>\n<li>Password protect using VBA</li>\n</ol>\n\n<p>This is where I'm stumped. I have password-protected a sheet using VBA and then tried to unprotect it manually with the same password used in VBA. But Excel throws an error saying that the password provided is incorrect. I tried the opposite as well - Protected the file manually and then tried to unprotect using VBA providing the right password in the code; same error. Any ideas why this is happening?</p>\n"}, {"tags": ["database", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1496862274, "creation_date": 1496862274, "answer_id": 44420853, "question_id": 44419985, "link": "https://stackoverflow.com/questions/44419985/data-type-mismatch-on-a-join-using-dates/44420853#44420853", "title": "Data type mismatch on a join using dates", "body": "<p>Those type of joins are not supported in Access. Try to set the dates in criteria.</p>\n\n<pre><code>SELECT cc.cred_id,  lastday(DateAdd(\"m\", 5, Date())) As [due],\n       lastday(DateAdd(\"m\", 36, a.activity_date)) As [report]\nFROM cred_core as cc INNER JOIN activity As a ON (a.cred_id = cc.cred_id)\nWHERE a.activity_type = \"recred sent\" \n  AND lastday(DateAdd(\"m\", 5, date())) = lastday(DateAdd(\"m\", 36, a.activity_date));\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496862274, "creation_date": 1496859199, "question_id": 44419985, "link": "https://stackoverflow.com/questions/44419985/data-type-mismatch-on-a-join-using-dates", "title": "Data type mismatch on a join using dates", "body": "<p>I have a function, <em>lastday</em>, that returns the last day of a given month. Code below...</p>\n\n<pre><code>Function lastday(dteAny As Date) As Date\nlastday = DateSerial(Year(dteAny), Month(dteAny) + 1, 1) - 1\nEnd Function\n</code></pre>\n\n<p>I am attempting to run a query you see below..</p>\n\n<pre><code>Select cc.cred_id,  lastday(dateadd(\"m\", 5, date())) as [due], \nlastday(dateadd(\"m\", 36, a.activity_date)) as [report]\n\nfrom cred_core as cc\n\ninner join activity as a on (a.cred_id = cc.cred_id and a.activity_type = \n\"recred sent\" and lastday(dateadd(\"m\", 5, date())) = lastday(dateadd(\"m\", \n36, a.activity_date)) ) \n</code></pre>\n\n<p>I get an error alerting me of a data type mismatch on the second half of the join, where I use the lastday function.</p>\n\n<p>I tried surrounding the lastday function with the # delimeters hoping that it would convert it to something it could actually compare, but I assume those delimeters don't work on functions?</p>\n\n<p>Any idea what I can do to solve this problem? activity_date is, of course, a date/time data type. Using Access 2007-2013.</p>\n"}, {"tags": ["excel", "google-places-api", "vba"], "owner": {"reputation": 11, "user_id": 8126506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4d4d769ffa7a6ae426e0e9a6e9c2f16?s=128&d=identicon&r=PG&f=1", "display_name": "LEv", "link": "https://stackoverflow.com/users/8126506/lev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 727, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496858090, "creation_date": 1496858090, "last_edit_date": 1531164843, "question_id": 44419656, "link": "https://stackoverflow.com/questions/44419656/google-places-api-using-vba-in-excel-want-to-return-an-address-of-a-nearby-lo", "title": "Google places API using VBA in excel -- want to return an address of a nearby location based on keyword input and starting location", "body": "<p>I'm a newbie to coding. I'm working on an excel spreadsheet where I have a few dozen locations defined as \"latitude,longitude\" and for each of those inputs I want to find the address of the nearest store based on a keyword (i.e., \"Staples\", \"CVS\", etc.).</p>\n\n<p>I put together some code based on what I've been able to pick up from this forum and a few other places, but the result is showing as \"-1\" no matter what I input.</p>\n\n<p>I think the problem might be with how I'm defining the output \"regex.Pattern = \"\"\"value\"\".*?([0-9]+)\" this worked for me when I was writing a VBA to use Google's Distance API. Ideally what I want to have is the PlaceID or lat,long coordinates for the single closest location.</p>\n\n<p>Here's the code I have (I omitted my API key from the code below, but have it in my version):</p>\n\n<pre><code>Public Function GetPlace(location As String, keyword As String)\n    Dim firstVal As String, secondVal As String, thirdVal As String, lastVal \nAs String\n    firstVal = \"https://maps.googleapis.com/maps/api/place/nearbysearch/json?\"\n    secondVal = \"&amp;location=\"\n    thirdVal = \"&amp;keyword=\"\n    lastVal = \"&amp;rankby=distance&amp;sensor=false&amp;key=[my API key]\"\n    Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n    URL = firstVal &amp; secondVal &amp; Replace(location, \" \", \"+\") &amp; thirdVal &amp; \n    Replace(keyword, \" \", \"+\") &amp; lastVal\n    objHTTP.Open \"GET\", URL, False\n    objHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\nobjHTTP.send (\"\")\n    If InStr(objHTTP.responseText, \"\"\"place\"\" : {\") = 0 Then GoTo ErrorHandl\n    Set regex = CreateObject(\"VBScript.RegExp\"): regex.Pattern = \"\"\"value\"\".*?([0-9]+)\": regex.Global = False\n    Set matches = regex.Execute(objHTTP.responseText)\n    tmpVal = Replace(matches(0).SubMatches(0), \".\", \n    Application.International(xlListSeparator))\n    GetPlace = CDbl(tmpVal)\n    Exit Function\nErrorHandl:\n    GetPlace = -1\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496857988, "post_id": 44419471, "comment_id": 75837758, "body": "You need to tell us what <code>RangetoHTML</code> is."}, {"owner": {"reputation": 11, "user_id": 8127207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FMeSO0g0hGw/AAAAAAAAAAI/AAAAAAAAAN0/1WN6UpqEDB4/photo.jpg?sz=128", "display_name": "Jv Fernandez", "link": "https://stackoverflow.com/users/8127207/jv-fernandez"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496858256, "post_id": 44419471, "comment_id": 75837895, "body": "It is a UDF made by Ron de Bruin. I&#39;m not sure if there are other codes that I can use that why I&#39;m using &quot;RangetoHTML&quot;. Please let me know."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1496886687, "post_id": 44419471, "comment_id": 75849137, "body": "You need to tell us what RangetoHTML is.  <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1496861335, "creation_date": 1496861335, "answer_id": 44420609, "question_id": 44419471, "link": "https://stackoverflow.com/questions/44419471/how-to-paste-mulple-excel-range-as-picture-to-outlook-at-the-same-time/44420609#44420609", "title": "How to paste mulple excel range as picture to outlook at the same time", "body": "<p>This line of code is what defines your range.</p>\n\n<pre><code> Set rng = Range(\"C4:D8\").SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>You can simply define another range :</p>\n\n<pre><code>Dim rng2 As Range     \nSet rng2 = Range(\"J4:N8\").SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>and then make another call to RangetoHTML() using that second range:</p>\n\n<pre><code>RangetoHTML(rng2)\n</code></pre>\n\n<p>which will return another string of html which you can then concatenate like this:</p>\n\n<pre><code> .HTMLBody = StrBody &amp; RangetoHTML(rng) &amp; \"&lt;br&gt;\" &amp; RangetoHTML(rng2)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8127207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FMeSO0g0hGw/AAAAAAAAAAI/AAAAAAAAAN0/1WN6UpqEDB4/photo.jpg?sz=128", "display_name": "Jv Fernandez", "link": "https://stackoverflow.com/users/8127207/jv-fernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497080868, "creation_date": 1496857468, "last_edit_date": 1497080868, "question_id": 44419471, "link": "https://stackoverflow.com/questions/44419471/how-to-paste-mulple-excel-range-as-picture-to-outlook-at-the-same-time", "title": "How to paste mulple excel range as picture to outlook at the same time", "body": "<p>please help me fix this. I'm new to this area and I would like to paste multiple set of range from excel and paste it onto an outlook email with modified size. Please help me. Thanks in advance! </p>\n\n<p>Here's my current code:</p>\n\n<pre><code>Sub EmailSend()\n\n    Dim rng As Range\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim StrBody As String\n\n    StrBody = \"Please see our current Report\"\n\n    Set rng = Nothing\n    On Error Resume Next\n    'Only the visible cells in the selection\n    'Set rng = Selection.SpecialCells(xlCellTypeVisible)\n    'You can also use a fixed range if you want\n    Set rng = Range(\"C4:D8\").SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    If rng Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n               vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n        Exit Sub\n    End If\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n\n    With OutMail\n        .To = \"x\"\n        .CC = \"x\"\n        .BCC = \"x\"\n        .Subject = \"RRF for Vendor Sourcing - \" &amp; Cells(3, 2)\n        .HTMLBody = StrBody &amp; RangetoHTML(rng)\n        .Display   'or use .Display\n    End With\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "calculated-field", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1496856380, "post_id": 44419052, "comment_id": 75836886, "body": "are <code>pivot</code> variables string type? . Also remove extra <code>&quot;</code> after <code>pivot12&quot;</code>"}, {"owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1496856488, "post_id": 44419052, "comment_id": 75836934, "body": "Yes, they are string type.  Sorry, I should have included that."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1496856528, "post_id": 44419052, "comment_id": 75836960, "body": "see my 2nd sentence. just edited comment"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1496856651, "post_id": 44419052, "comment_id": 75837033, "body": "actually, you have more syntax issues. Try this:     <code>ActiveSheet.PivotTables(&quot;Pivot Table 1&quot;).CalculatedFields.Add &quot;Total&quot;, &quot;=&quot; &amp; pivot1 _         &amp; &quot; + &quot; &amp; pivot2 &amp; &quot; + &quot; &amp; pivot3 &amp; &quot; + &quot; &amp; pivot4 &amp; &quot; + &quot; &amp; pivot5 &amp; &quot; + &quot; &amp; pivot6 _         &amp; &quot; + &quot; &amp; pivot7 &amp; &quot; + &quot; &amp; pivot8 &amp; &quot; + &quot; &amp; pivot9 &amp; &quot; + &quot; &amp; pivot10 &amp; &quot; + &quot; &amp; pivot11 _         &amp; &quot; + &quot; &amp; pivot12, True</code>"}, {"owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1496857537, "post_id": 44419052, "comment_id": 75837506, "body": "That worked beautifully.  Thank you!"}], "owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 683, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496855982, "creation_date": 1496855982, "last_edit_date": 1531164843, "question_id": 44419052, "link": "https://stackoverflow.com/questions/44419052/excel-vba-pivot-table-calculated-field-creation-using-variables", "title": "Excel VBA Pivot Table Calculated Field Creation Using Variables", "body": "<p>I have looked around SO and haven't found an answer to this type of question.  It is probably something trivial that I am doing wrong, but I have tried several different formats of the below with no success.  I have a very long VBA script which uses calculations to determine which fields to include in the pivot.  I then take the variable fields returned and turn them into variables (pivot1, pivot2, etc.).  I can't name the fields specifically in the addition of the calculated field, as I don't know what they will be.  The second segment of code throws off the error \"Unable to get the PivotFields property of the PivotTable class\".  Any help with this would be much appreciated.</p>\n\n<pre><code>ActiveSheet.PivotTables(\"Pivot Table 1\").CalculatedFields.Add \"Total\", \"= pivot1 _\n    &amp; \" + \" &amp; pivot2 &amp; \" + \" &amp; pivot3 &amp; \" + \" &amp; pivot4 &amp; \" + \" &amp; pivot5 &amp; \" + \" &amp; pivot6 _\n    &amp; \" + \" &amp; pivot7 &amp; \" + \" &amp; pivot8 &amp; \" + \" &amp; pivot9 &amp; \" + \" &amp; pivot10 &amp; \" + \" &amp; pivot11 _\n    &amp; \" + \"&amp; pivot12\", True\nActiveSheet.PivotTables(\"Pivot Table 1\").AddDataField ActiveSheet.PivotTables _\n    (\"Pivot Table 1\").PivotFields(\"Total\"), \"Grand Total\", xlSum\n</code></pre>\n"}, {"tags": ["vba", "tuples", "increment"], "answers": [{"comments": [{"owner": {"reputation": 408, "user_id": 8126904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K9ToU.jpg?s=128&g=1", "display_name": "programmar", "link": "https://stackoverflow.com/users/8126904/programmar"}, "edited": false, "score": 0, "creation_date": 1496924468, "post_id": 44418730, "comment_id": 75868329, "body": "thank you, this is the almost perfect solution. unfortunately it doesn&#39;t work for empty cells in column B. in this case it would always put zero. see remarks here: <a href=\"https://support.office.com/en-us/article/COUNTIFS-function-dda3dc6e-f74e-4aee-88bc-aa8c2a866842\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1496854842, "creation_date": 1496854842, "answer_id": 44418730, "question_id": 44418692, "link": "https://stackoverflow.com/questions/44418692/excel-vba-run-increments-in-same-column-depending-on-neighbouring-column/44418730#44418730", "title": "Excel-VBA: run increments in same column depending on neighbouring column", "body": "<p>Use COUNTIFS()</p>\n\n<p>Put this in C1:</p>\n\n<pre><code>=COUNTIFS($A$1:A1,A1,$B$1:B1,B1)\n</code></pre>\n\n<p>Then copy down</p>\n"}], "owner": {"reputation": 408, "user_id": 8126904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K9ToU.jpg?s=128&g=1", "display_name": "programmar", "link": "https://stackoverflow.com/users/8126904/programmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 44418730, "answer_count": 1, "score": 0, "last_activity_date": 1496891245, "creation_date": 1496854701, "last_edit_date": 1496891245, "question_id": 44418692, "link": "https://stackoverflow.com/questions/44418692/excel-vba-run-increments-in-same-column-depending-on-neighbouring-column", "title": "Excel-VBA: run increments in same column depending on neighbouring column", "body": "<p>it's sounds tricky and it is!</p>\n\n<p>I have an example. I am trying to fill out the red values automatically\n<img src=\"https://i.stack.imgur.com/wIbpf.png\" alt=\"image\"></p>\n\n<p>As you can see, column A and column B make a tuple and these tuples need to get incremented numbers. </p>\n\n<p>While coding I feel like I am running out of functions to do this. I would be glad for hints, about even how to approach this problem the best! </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1496857845, "post_id": 44418671, "comment_id": 75837663, "body": "Welcome to SO. You&#39;ve only mentioned what you like your code to do. You have not shown how you have tried to accomplish it nor where you are stuck. Effectively, you haven&#39;t asked an <i>actual question</i>. Read <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a> to get more effective help."}, {"owner": {"reputation": 11, "user_id": 8126864, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212494147564820/picture?type=large", "display_name": "Brent Amenell", "link": "https://stackoverflow.com/users/8126864/brent-amenell"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1497457897, "post_id": 44418671, "comment_id": 76090859, "body": "This was my first post here.  Sorry for not posting correctly.  After working on this for a few days, I have found a solution.             ** Private Sub Worksheet_Change(ByVal Target As Range)   If ActiveCell.Column = 131 And ActiveCell.Offset(-1, -124) = &quot;FED&quot; Then         Sheet6.Activate        Else      If ActiveCell.Column = 131 And ActiveCell.Offset(-1, -124) = &quot;UPS&quot; Then        Sheet5.Activate                     End If   End If   ThisWorkbook.Save End Sub**"}], "owner": {"reputation": 11, "user_id": 8126864, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212494147564820/picture?type=large", "display_name": "Brent Amenell", "link": "https://stackoverflow.com/users/8126864/brent-amenell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496857417, "creation_date": 1496854655, "last_edit_date": 1531164843, "question_id": 44418671, "link": "https://stackoverflow.com/questions/44418671/worksheet-change-moving-between-sheets", "title": "Worksheet_Change Moving Between Sheets", "body": "<p>I have a workbook that I use to collect shipping data.  I have a Worksheet_Change macro that moves the active cell based on its location.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If ActiveCell.Column = 4 Then\n    ActiveCell.Offset(-1, -1).Select\n  ElseIf ActiveCell.Column = 3 Then\n    ActiveCell.Offset(0, 1).Select\n    Sheet2.Activate\n    Call Sheet5.Last_Row_Range\n    ThisWorkbook.Save\n  End If\nEnd Sub\n</code></pre>\n\n<p>The changes are initiated by scanning a number into an active cell.\nI would now like the code to look at an adjacent cell, after the scan, and based on that cells content, select another Worksheet.  Ie; if <code>ActiveCell.Offset=x</code> select sheet1 else if <code>ActiveCell.Offset=y</code> select sheet2.</p>\n\n<p>Thanks for taking the time to read this.</p>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 1867, "user_id": 6535663, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PdSpK.png?s=128&g=1", "display_name": "David Lee", "link": "https://stackoverflow.com/users/6535663/david-lee"}, "edited": false, "score": 0, "creation_date": 1496868313, "post_id": 44418575, "comment_id": 75843413, "body": "You mention VBA, what type of backend are you using? Web Forms? ASP MVC?"}, {"owner": {"reputation": 31, "user_id": 7378773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/553521bfa1a1ba5643845c72fe7db7b7?s=128&d=identicon&r=PG&f=1", "display_name": "floow", "link": "https://stackoverflow.com/users/7378773/floow"}, "reply_to_user": {"reputation": 1867, "user_id": 6535663, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PdSpK.png?s=128&g=1", "display_name": "David Lee", "link": "https://stackoverflow.com/users/6535663/david-lee"}, "edited": false, "score": 0, "creation_date": 1496936171, "post_id": 44418575, "comment_id": 75877646, "body": "I&#39;m not entirely sure what you mean, as I am quite new to it. I&#39;m using Excel 2010 and IE 11."}], "owner": {"reputation": 31, "user_id": 7378773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/553521bfa1a1ba5643845c72fe7db7b7?s=128&d=identicon&r=PG&f=1", "display_name": "floow", "link": "https://stackoverflow.com/users/7378773/floow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496860317, "creation_date": 1496854302, "last_edit_date": 1496860317, "question_id": 44418575, "link": "https://stackoverflow.com/questions/44418575/check-aria-status-of-html-website-via-vba", "title": "Check Aria Status of HTML Website via VBA", "body": "<p>I am working on a VBA algorithm in order to automate an interaction with a website. The automation works quite well, except one little problem, which has been causing me quite a lot of headaches (also I am relatively new to this web-automation programming). It is an internal website, so I cannot post a link, but I'll try to make it as transparent as I can.</p>\n\n<p><strong>Here is what I do:</strong> </p>\n\n<p>I am inputting a name on a website into an element via <code>GetElementByID(\"ID\").value = \"Name\"</code>. Then the website needs time to process that information and does not allow me to enter information into another element until this part is completed. While the website is processing the information a popup basically freezes the website. </p>\n\n<p><strong>Here is my Problem:</strong> </p>\n\n<p>The time it takes the website to process the information can vary from 2 seconds to 2 minutes. So I am trying to figure out a way how I can get going with my program in the shortest timeframe, after the processing is complete.</p>\n\n<p><strong>What I have tried:</strong> </p>\n\n<p>1) <code>application.wait</code> ; rather obvious, but the very least elegant way and not very reliable, because the processing time varies considerably. </p>\n\n<p>2) <code>IE.ReadyState = 4</code> or <code>IE.busy</code>; does not work, because the website it fully loaded whilst this processing takes place. </p>\n\n<p>3) I built a function which basically loops, whilst the innerhtml of the element is not the name. I thought this would be a cool solution, but the issue is that the innerhtml change is sometimes already completed, whilst the popup is still there. (The function works in other parts of the code). </p>\n\n<p>4) I built a function that loops until it cannot find the popup via <code>GetElementByID(\"waitingPopUp\")</code>. Did not work, because the element is technically always there.</p>\n\n<p><strong>What I think should work:</strong> </p>\n\n<p>So this popup this the main problem. The only thing is that whilst the popup is visible the status is on <code>aria-hidden=\"false\"</code>, otherwise <code>aria-hidden=\"true\"</code>. Hence my question is if there is a way I can access this aria status via VBA? Ideally I'd like to build a function a long the lines of \"loop while element(\"popup\") is on <code>aria-hidden=\"false\"</code>\". Is that possible?</p>\n\n<p>Regards</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1496854471, "post_id": 44418563, "comment_id": 75835892, "body": "all cells? so it might be anywhere within the 65K*256 cells?"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1496854740, "post_id": 44418563, "comment_id": 75836045, "body": "Use ActiveSheet.Cells.Interior.Color = RGB(217, 217, 217)"}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496855547, "post_id": 44418824, "comment_id": 75836464, "body": "Will this still work if his cells are red due to conditional formatting? If that&#39;s the case, he might need <code>.DisplayFormat</code>"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496855661, "post_id": 44418824, "comment_id": 75836525, "body": "<a href=\"https://stackoverflow.com/questions/28541950/get-a-background-color-with-vba-excel-function\" title=\"get a background color with vba excel function\">stackoverflow.com/questions/28541950/&hellip;</a> this might help. But OP did not tell anything about conditional formatting"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1496855963, "post_id": 44418824, "comment_id": 75836674, "body": "I&#39;m saying if the cells are red due to conditional formatting, no, this would not satisfy the IF condition. Because he didn&#39;t say whether or not they&#39;re red due to that I thought I&#39;d just add that :)"}, {"owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "edited": false, "score": 0, "creation_date": 1496856295, "post_id": 44418824, "comment_id": 75836840, "body": "Can you give me an example of range I can provide for I and J?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496856665, "post_id": 44418824, "comment_id": 75837036, "body": "@dwirony <code>.DisplayFormat</code> can&#39;t be changed, but the conditional formatting color can."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "edited": false, "score": 0, "creation_date": 1496901863, "post_id": 44418824, "comment_id": 75853501, "body": "@MaxBridge it depends on your sheet&#39;s data range. If you have just 10 rows and 5 columns with data, give 10 and 5 respectively"}], "tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": true, "score": 1, "last_activity_date": 1496855216, "creation_date": 1496855216, "answer_id": 44418824, "question_id": 44418563, "link": "https://stackoverflow.com/questions/44418563/checkbox-to-switch-interior-color-of-all-cells/44418824#44418824", "title": "CheckBox to switch interior color of all cells", "body": "<p>Try this macro,</p>\n\n<pre><code>Sub colorSwitch()\nDim i As Long, j As Long\nFor i = 1 To Rows.Count\nFor j = 1 To Columns.Count\n    If Cells(i, j).Interior.Color = RGB(252, 252, 250) Then\n        Cells(i, j).Interior.Color = RGB(217, 217, 217)\n    End If\nNext j\nNext i\nEnd Sub\n</code></pre>\n\n<p>But this would take a while to execute as it loops through all cells in the sheet. It would be better if you have a short range, which you can provide with the <code>i</code> and <code>j</code> variant for the macro to execute faster.</p>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1496860588, "creation_date": 1496860588, "answer_id": 44420361, "question_id": 44418563, "link": "https://stackoverflow.com/questions/44418563/checkbox-to-switch-interior-color-of-all-cells/44420361#44420361", "title": "CheckBox to switch interior color of all cells", "body": "<p>You can Record Macro of <a href=\"http://chandoo.org/wp/2008/04/04/change-cell-formats-with-find-replace-in-excel/\" rel=\"nofollow noreferrer\">Replace Format</a>:</p>\n\n<pre><code>Application.FindFormat.Clear\nApplication.FindFormat.Interior.Color = RGB(252, 252, 250)\nApplication.ReplaceFormat.Clear\nApplication.ReplaceFormat.Interior.Color = RGB(217, 217, 217)\n\nCells.Replace \"\", \"\", SearchFormat:=True, ReplaceFormat:=True\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 44418824, "answer_count": 2, "score": -1, "last_activity_date": 1496860588, "creation_date": 1496854265, "last_edit_date": 1531164843, "question_id": 44418563, "link": "https://stackoverflow.com/questions/44418563/checkbox-to-switch-interior-color-of-all-cells", "title": "CheckBox to switch interior color of all cells", "body": "<p>Hi I want to make a macro that switch the backgroung color of all cells with a specific color RGB(252, 252, 250) to another color RGB(217, 217, 217) in entire workbook</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1496854785, "post_id": 44418479, "comment_id": 75836063, "body": "<code>One</code> and <code>Two</code> cannot &quot;see&quot; <code>fNameAndPath</code> as it is defined within <code>GetFile</code>.  Variables defined within a sub/function are said to be local to that sub/function.  You can either pass the variable as a parameter or move the declaration outside of <code>GetFile</code>.  Generally speaking, you want to restrict the number of vars declared at the module level (or above).  They can be hard to keep track of."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8114624, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/55bcf822abe4b4b7297e94cc210035aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mazura_", "link": "https://stackoverflow.com/users/8114624/mazura"}, "edited": false, "score": 0, "creation_date": 1496856142, "post_id": 44418543, "comment_id": 75836765, "body": "Thank you very much. That works. One thing I don&#39;t understand though, how does &quot;one fNameAndPath&quot; work in the main sub, what does it do?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "reply_to_user": {"reputation": 5, "user_id": 8114624, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/55bcf822abe4b4b7297e94cc210035aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mazura_", "link": "https://stackoverflow.com/users/8114624/mazura"}, "edited": false, "score": 0, "creation_date": 1496856457, "post_id": 44418543, "comment_id": 75836921, "body": "it calls <code>one</code> passing <code>fNameAndPath</code> as an argument. <a href=\"https://msdn.microsoft.com/en-us/library/aa263527(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa263527(v=vs.60).aspx</a>"}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 2, "last_activity_date": 1496854814, "last_edit_date": 1496854814, "creation_date": 1496854195, "answer_id": 44418543, "question_id": 44418479, "link": "https://stackoverflow.com/questions/44418479/using-module-variables-for-workbooks-selected-by-user/44418543#44418543", "title": "Using module variables for workbooks selected by user", "body": "<p>Its best practice to restrict the scope of a variable (where its visible) to the smallest area as possible - in this case send the variable as an argument, that way the variable lives only within the subs that declare or use it.</p>\n\n<pre><code>If fNameAndPath = False Then Exit Sub\n\none fNameAndPath \ntwo fNameAndPath \n\nEnd Sub\n</code></pre>\n\n<p>And receive them as:</p>\n\n<pre><code>Sub one(fNameAndPath as Variant)\n///\n\nSub two(fNameAndPath as Variant)\n///\n</code></pre>\n\n<p>(<code>With fNameAndPath</code> is not valid as <code>fNameAndPath</code> is a string not an object)</p>\n"}], "owner": {"reputation": 5, "user_id": 8114624, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/55bcf822abe4b4b7297e94cc210035aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mazura_", "link": "https://stackoverflow.com/users/8114624/mazura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496854814, "creation_date": 1496853957, "question_id": 44418479, "link": "https://stackoverflow.com/questions/44418479/using-module-variables-for-workbooks-selected-by-user", "title": "Using module variables for workbooks selected by user", "body": "<p>Haven't really had the chance to use module variables before and unfortunately even after reading about them I can't seem to make it work.</p>\n\n<p>My issues is that I'm trying to use a variable assigned as a workbook which the user browses for and use it in different subs. </p>\n\n<p>As an example code of what I mean:</p>\n\n<pre><code>Sub GetFile()\n\nDim fNameAndPath As Variant\n\nfNameAndPath = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.XLS), *.XLS\", Title:=\"Select File To Be Opened\")\nIf fNameAndPath = False Then Exit Sub\n\n    Call one\n    Call two\n\nEnd Sub\n\nSub one()\n\n    With fNameAndPath\n\n        'do stuff\n\n    End With\n\nEnd Sub\n\nSub two()\n\n    With fNameAndPath\n\n        'do stuff\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8126609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ad4ef393302e7fa763db3fa8c27430?s=128&d=identicon&r=PG&f=1", "display_name": "SeedySea", "link": "https://stackoverflow.com/users/8126609/seedysea"}, "edited": false, "score": 0, "creation_date": 1496859683, "post_id": 44418748, "comment_id": 75838630, "body": "Thanks so much for your response. Is there a way to include this functionality in the above mentioned Macro? Or maybe to at least function similarly to this script?  <code>Private Sub Worksheet_Calculate()Dim rCell As Range For Each rCell In Range(&quot;A45:R45&quot;) rCell.EntireColumn.Hidden = (rCell.Value = &quot;HIDE&quot;) Next rCell End Sub</code> That one seems to run constantly in the background and modifies the worksheet when values are changed. I&#39;m trying to minimize keystrokes as much as possible. Sorry if this should be obvious, as I said, I am very much an Excel/VBA novice."}, {"owner": {"reputation": 16, "user_id": 8119646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc07779108cbd4519a75648e624e88cf?s=128&d=identicon&r=PG&f=1", "display_name": "Crossarchus Obscurus", "link": "https://stackoverflow.com/users/8119646/crossarchus-obscurus"}, "reply_to_user": {"reputation": 15, "user_id": 8126609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ad4ef393302e7fa763db3fa8c27430?s=128&d=identicon&r=PG&f=1", "display_name": "SeedySea", "link": "https://stackoverflow.com/users/8126609/seedysea"}, "edited": false, "score": 0, "creation_date": 1496863874, "post_id": 44418748, "comment_id": 75841052, "body": "@SeedySea If you copy paste the CleanRange sub into a module, it becomes available, then you can call it with the line &quot;Call CleanRange...&quot; above. You have to put this call with the correct argument in any place where you want it to happen (maybe inside Worksheet_Calculate, if you wish)."}, {"owner": {"reputation": 15, "user_id": 8126609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ad4ef393302e7fa763db3fa8c27430?s=128&d=identicon&r=PG&f=1", "display_name": "SeedySea", "link": "https://stackoverflow.com/users/8126609/seedysea"}, "edited": false, "score": 0, "creation_date": 1496928745, "post_id": 44418748, "comment_id": 75871690, "body": "So, if I wanted to add this to the Macro above and have it be the first function that executed, would I add the call this way? <code>...ActiveWorkbook.Worksheets(&quot;Panel1&quot;).Sort.SortFields.Add Key:=Range(&quot;C1:C18&quot;) _     , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal With Call CleanRange(Range(&quot;A1:C8&quot;), &quot;2&quot;) End With...</code> Also, I&#39;m not entirely sure what you meant with <code>Cells(I, K).Value</code> For this worksheet I want it to only look in Column B for the exact text string RTA, so how would that look? Also, if I wanted to modify it to search, for example, Columns B and C to find"}, {"owner": {"reputation": 15, "user_id": 8126609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ad4ef393302e7fa763db3fa8c27430?s=128&d=identicon&r=PG&f=1", "display_name": "SeedySea", "link": "https://stackoverflow.com/users/8126609/seedysea"}, "edited": false, "score": 0, "creation_date": 1496928817, "post_id": 44418748, "comment_id": 75871750, "body": "and delete rows that contain the numeral 0 in either of those specific columns, how would that look? Sorry, I don&#39;t mean to be difficult, I&#39;m just really trying to understand how all of this functions. I really appreciate your assistance."}], "tags": [], "owner": {"reputation": 16, "user_id": 8119646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc07779108cbd4519a75648e624e88cf?s=128&d=identicon&r=PG&f=1", "display_name": "Crossarchus Obscurus", "link": "https://stackoverflow.com/users/8119646/crossarchus-obscurus"}, "is_accepted": true, "score": 0, "last_activity_date": 1496949750, "last_edit_date": 1496949750, "creation_date": 1496854917, "answer_id": 44418748, "question_id": 44418330, "link": "https://stackoverflow.com/questions/44418330/excel-vba-add-function-to-macro-to-delete-rows-containing-specific-text/44418748#44418748", "title": "Excel VBA - Add Function to Macro to Delete Rows Containing Specific Text", "body": "<p>You may try this. The sub will look for a specific string in a given range and remove all lines (and whole lines) that contain the string.</p>\n\n<pre><code>Sub CleanRange(R As Range, T As String)\nDim I As Long, F As Object\nDim M As Long, N As Long, P As Long, Q As Long\nM = R.Row\nN = R.Column\nP = M + R.Rows.Count - 1\nQ = N + R.Columns.Count - 1\nI = M\nWhile I &lt;= P\n    Set F = Range(Cells(I, N), Cells(I, Q)).Find(T, LookIn:=xlValues)\n    If F Is Nothing Then\n        I = I + 1\n    Else\n        Rows(I).Delete\n        P = P - 1\n    End If\nWend\nEnd Sub\n</code></pre>\n\n<p>Call for instance</p>\n\n<pre><code>Call CleanRange(Range(\"A1:C8\"), \"2\")\n</code></pre>\n\n<p>If you are looking for T in a single column, you may simplify and use Cells(I, K).Value directly.</p>\n\n<p>It's possible to adapt this to operate on several sheets, or to look for several strings.</p>\n\n<hr>\n\n<p>If you are always looking in column B, you can write</p>\n\n<pre><code>Sub CleanRange(R As Range, T As String)\nDim I As Long\nDim M As Long, N As Long, P As Long, Q As Long\nM = R.Row\nN = R.Column\nP = M + R.Rows.Count - 1\nQ = N + R.Columns.Count - 1\nI = M\nWhile I &lt;= P\n    If Cells(I, 2).Value = T Then\n        Rows(I).Delete\n        P = P - 1\n    Else\n        I = I + 1\n    End If\nWend\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Or even</p>\n\n<pre><code>Sub CleanRange(R1 As Long, R2 As Long, T As String)\nDim I As Long\nDim M As Long, N As Long, P As Long, Q As Long\nM = R1\nP = R2\nI = M\nWhile I &lt;= P\n    If Cells(I, 2).Value = T Then\n        Rows(I).Delete\n        P = P - 1\n    Else\n        I = I + 1\n    End If\nWend\nEnd Sub\n</code></pre>\n\n<p>Notice the While is important, instead of the more obvious For loop, because as you delete rows, the last row to visit moves up, so the limit of the loop is reduced (that's why there is P = P - 1).</p>\n\n<hr>\n\n<p>Then, if you want to call this sub in another sub, you will have</p>\n\n<pre><code>Sub Something(...)\n!Declarations\n!Do whatever you want here (initialisation...)\n\n!Then do the call, with the appropriate range and string, here is an example\nCall CleanRange(Range(\"A1:C100\"), \"2\")\n\n!Do whatever you want\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8126609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ad4ef393302e7fa763db3fa8c27430?s=128&d=identicon&r=PG&f=1", "display_name": "SeedySea", "link": "https://stackoverflow.com/users/8126609/seedysea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "accepted_answer_id": 44418748, "answer_count": 1, "score": 0, "last_activity_date": 1496949750, "creation_date": 1496853402, "last_edit_date": 1496864851, "question_id": 44418330, "link": "https://stackoverflow.com/questions/44418330/excel-vba-add-function-to-macro-to-delete-rows-containing-specific-text", "title": "Excel VBA - Add Function to Macro to Delete Rows Containing Specific Text", "body": "<p>I'm new to this site, and to Excel. I've been working on creating a spreadsheet, and fumbling my way through automating it as much as I can in order to streamline it for myself and the other members of my team. It performs most of the tasks I would like it to, but there are still a few remaining. Here is my code as it stands currently:</p>\n\n<pre><code>Sub Setup()\n'\n' Setup Macro\n'\n' Keyboard Shortcut: Ctrl+e\n'\nRows(\"1:3\").Select\nApplication.CutCopyMode = False\nSelection.delete Shift:=xlUp\nCells.Select\nActiveWorkbook.Worksheets(\"Panel1\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Panel1\").Sort.SortFields.Add Key:=Range(\"C1:C18\") _\n    , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Panel1\").Sort\n    .SetRange Range(\"A1:Q18\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nColumns(\"B:B\").Select\nCells.Replace What:=\"RTA\", Replacement:=\"DELETE\", LookAt:=xlWhole, _\n    SearchOrder:=xlByRows, MatchCase:=True, SearchFormat:=False, _\n    ReplaceFormat:=False\nColumns(\"C:C\").Select\nSelection.Copy\nActiveWindow.ScrollColumn = 2\nActiveWindow.ScrollColumn = 3\nActiveWindow.ScrollColumn = 4\nActiveWindow.ScrollColumn = 5\nColumns(\"O:O\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nSelection.TextToColumns Destination:=Range(\"O1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True\nColumns(\"O:P\").Select\nWith Selection\n    .VerticalAlignment = xlCenter\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .MergeCells = False\nEnd With\nSelection.Borders(xlDiagonalDown).LineStyle = xlNone\nSelection.Borders(xlDiagonalUp).LineStyle = xlNone\nWith Selection.Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlInsideVertical)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlInsideHorizontal)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nColumns(\"N:N\").Select\nActiveWindow.LargeScroll ToRight:=-1\nColumns(\"A:N\").Select\nRange(\"N1\").Activate\nSelection.EntireColumn.Hidden = True\nEnd Sub\n</code></pre>\n\n<p>The thing I'm currently struggling with the most is adding a function to this Macro which will find a specific text string, and delete the entire row which contains it. I've seen a lot of people suggest using Autofilter, but I need the row to be deleted entirely, not just hidden. I've also found a lot of really great standalone solutions, but I can't seem to figure out how to integrate them into this Macro, only how to make them a new Module. And I've also attempted to incorporate a Delete Sheet Rows action into the Macro thinking that if I did a Find and Replace first, that it would only delete that particular row, but it ended up deleting my entire worksheet.</p>\n\n<p>As I stated, what it does now is a Find (RTA) and Replace (DELETE), as I was attempting to go the Delete Sheet Rows route, but ultimately all I need it to do is search Column B for the text RTA and delete the row(s) which contain it.</p>\n\n<p>Additionally, is there a way to have this run on two worksheets (Panel1, Panel2) simultaneously, or will it need to be executed on both independently?</p>\n\n<p>Thanks so much for any and all help, I am incredibly grateful. I would continue trying to work the solution out myself, but apparently I've been spending too much time on this task...</p>\n"}, {"tags": ["excel", "vba", "counter"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1496865431, "post_id": 44418188, "comment_id": 75841946, "body": "How are you streaming live data without VBA?"}, {"owner": {"reputation": 1, "user_id": 8126868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a657fea7aa2ef1856561eefb72841312?s=128&d=identicon&r=PG&f=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/8126868/ryanb"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1496865962, "post_id": 44418188, "comment_id": 75842208, "body": "DDE link of live stock market data.  So the cell has a function like... =XYZ(AAPL, Last Price) and shows the current price"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8126868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a657fea7aa2ef1856561eefb72841312?s=128&d=identicon&r=PG&f=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/8126868/ryanb"}, "edited": false, "score": 0, "creation_date": 1496853844, "post_id": 44418394, "comment_id": 75835566, "body": "Thanks, also lets say if I have a cell C1 and D1, and for each change event I want to set a counter to compare if C1=D1 at each update/change, what would that look like?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 1, "user_id": 8126868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a657fea7aa2ef1856561eefb72841312?s=128&d=identicon&r=PG&f=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/8126868/ryanb"}, "edited": false, "score": 0, "creation_date": 1496854076, "post_id": 44418394, "comment_id": 75835689, "body": "I&#39;ve edited my answer for what I think you&#39;re looking for. If C1 changes and it equals the value in D1, the counter would go up. Otherwise, nothing happens and the counter stays the same."}, {"owner": {"reputation": 1, "user_id": 8126868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a657fea7aa2ef1856561eefb72841312?s=128&d=identicon&r=PG&f=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/8126868/ryanb"}, "edited": false, "score": 0, "creation_date": 1496863343, "post_id": 44418394, "comment_id": 75840736, "body": "I entered the first block of code as a macro under the applicable sheet, and the output cells are Z1 &amp; Z2, but Im not seeing a count output in Z2.  I changed &quot;Sheet1&quot; to the sheet name, do I need to change &quot;Activeworkbook&quot; to my file name?  any other edits Im not seeing?"}, {"owner": {"reputation": 1, "user_id": 8126868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a657fea7aa2ef1856561eefb72841312?s=128&d=identicon&r=PG&f=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/8126868/ryanb"}, "edited": false, "score": 0, "creation_date": 1496865847, "post_id": 44418394, "comment_id": 75842154, "body": "Cant get it to work as is, but If I put the iteration for the count in a separate macro that I call, it works once, showing a &quot;1&quot; on the first change, then stops working"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 1, "user_id": 8126868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a657fea7aa2ef1856561eefb72841312?s=128&d=identicon&r=PG&f=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/8126868/ryanb"}, "edited": false, "score": 0, "creation_date": 1496866147, "post_id": 44418394, "comment_id": 75842295, "body": "No you can leave ActiveWorkbook as is - You need to have 3 cells referenced: z1 as the cell that&#39;s changing, z2 as the cell that it&#39;s checking against to see if it matches, and z3 (or whatever else) to place the counter."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1496854035, "last_edit_date": 1496854035, "creation_date": 1496853618, "answer_id": 44418394, "question_id": 44418188, "link": "https://stackoverflow.com/questions/44418188/excel-counter-for-when-a-cell-with-streaming-data-increases/44418394#44418394", "title": "Excel counter for when a Cell with streaming data increases?", "body": "<p>Put this in your sheet under Microsoft Excel Objects. Set the first cell to be the one that's changing, and the second cell to where you want the counter.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'First cell\n    If Target.Address = \"$A$1\" Then\n        'Second cell\n        ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"B1\").Value = ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"B1\").Value + 1\n    End If\nEnd Sub\n</code></pre>\n\n<p>EDIT: For if C1 equals D1 on change. If it doesn't equal it, the counter doesn't go up.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$C$1\" Then\n        If ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"C1\").Value = ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"D1\").Value Then\n            ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"D2\").Value = ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"D2\").Value + 1\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496853688, "post_id": 44418399, "comment_id": 75835486, "body": "Beat you by 6 seconds ;)"}, {"owner": {"reputation": 1, "user_id": 8126868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a657fea7aa2ef1856561eefb72841312?s=128&d=identicon&r=PG&f=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/8126868/ryanb"}, "edited": false, "score": 0, "creation_date": 1496976177, "post_id": 44418399, "comment_id": 75894130, "body": "This only works if I input a change myself , then click enter.  What if the cell (1,1) is a reference to a different cell, Say A1 = Indirect(&quot;B7&quot;).  The code doesn&#39;t work in this case.  For my spreadsheet, A1 is a function."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1496853624, "creation_date": 1496853624, "answer_id": 44418399, "question_id": 44418188, "link": "https://stackoverflow.com/questions/44418188/excel-counter-for-when-a-cell-with-streaming-data-increases/44418399#44418399", "title": "Excel counter for when a Cell with streaming data increases?", "body": "<p>This should work in the worksheet_Change event.\nIn this example, the streaming data would be in cell(14,9) and the counter would be in cell(1,1)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If Target.Row = 14 And Target.Column = 9 Then\n    Range(\"A1\").Value = Range(\"A1\").Value + 1\n  End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8126868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a657fea7aa2ef1856561eefb72841312?s=128&d=identicon&r=PG&f=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/8126868/ryanb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496854035, "creation_date": 1496852940, "question_id": 44418188, "link": "https://stackoverflow.com/questions/44418188/excel-counter-for-when-a-cell-with-streaming-data-increases", "title": "Excel counter for when a Cell with streaming data increases?", "body": "<p>I have a single cell that streams live data.  I'm trying to add a counter to another cell, such that each time the single streaming data cell changes, the counter increases.  (The data coming in is only increasing, so each time it increases, the counter should increase).</p>\n\n<p>Any way to do this w/o a VBA macro?  Otherwise VBA code will help.  thanks</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1496860669, "creation_date": 1496860669, "answer_id": 44420380, "question_id": 44418131, "link": "https://stackoverflow.com/questions/44418131/running-a-macro-from-a-non-activex-button/44420380#44420380", "title": "Running a macro from a non-activeX button", "body": "<p>Yes. First, make sure the subroutine containing the code is declared as Public.</p>\n\n<p>Then add an Action Setting to your circle/other shape.  Set the action setting to Run Macro: [choose the macro to run]</p>\n\n<p>Note: you can also do this, which is sometimes quite useful:</p>\n\n<p>Public Sub MyMacro (oSh as Shape)\n   Msgbox \"You clicked a shape called \" &amp; oSh.Name _\n   &amp; VbCRLF _\n   &amp; \"on slide \" &amp; Cstr(oSh.Parent.SlideIndex)\nEnd Sub</p>\n\n<p>By getting a reference to the shape, you can find out what slide it's on or, depending on the shape type or name or any of a number of other attributes, perform different actions.</p>\n\n<p>This is broken on Mac PPT.  There's a way around it described on my PPT FAQ site, here:</p>\n\n<p>Determine which shape was clicked\n<a href=\"http://www.pptfaq.com/FAQ00141_Determine_which_shape_was_clicked.htm\" rel=\"nofollow noreferrer\">http://www.pptfaq.com/FAQ00141_Determine_which_shape_was_clicked.htm</a></p>\n"}], "owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593730220, "creation_date": 1496852713, "last_edit_date": 1593730220, "question_id": 44418131, "link": "https://stackoverflow.com/questions/44418131/running-a-macro-from-a-non-activex-button", "title": "Running a macro from a non-activeX button", "body": "<p>Is it possible to run a macro in Powerpoint from a non-ActiveX button? For instance just a circle shape I place on the slide? I haven't found a way to connect a macro to anything but an ActiveX button. However there are some smart people here that may know a work around.</p>\n"}, {"tags": ["vba", "excel", "loops", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1496852720, "post_id": 44417652, "comment_id": 75834905, "body": "Please take a look at <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Your question is currently rather unclear."}, {"owner": {"reputation": 31, "user_id": 8125690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39b8e52778a921a1eb57411d915a4321?s=128&d=identicon&r=PG&f=1", "display_name": "dubstep22", "link": "https://stackoverflow.com/users/8125690/dubstep22"}, "edited": false, "score": 0, "creation_date": 1496853273, "post_id": 44417652, "comment_id": 75835253, "body": "I&#39;ve edit my problem description"}, {"owner": {"reputation": 31, "user_id": 8125690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39b8e52778a921a1eb57411d915a4321?s=128&d=identicon&r=PG&f=1", "display_name": "dubstep22", "link": "https://stackoverflow.com/users/8125690/dubstep22"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1496909390, "post_id": 44417652, "comment_id": 75857991, "body": "Is there a way to call all objects in a Word document (this is what I mean with WordDocument.Objects) to loop through them and check if it is a table or shape?"}, {"owner": {"reputation": 31, "user_id": 8125690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39b8e52778a921a1eb57411d915a4321?s=128&d=identicon&r=PG&f=1", "display_name": "dubstep22", "link": "https://stackoverflow.com/users/8125690/dubstep22"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1496925487, "post_id": 44417652, "comment_id": 75869084, "body": "No one has any hints or suggestions? Or is there still something unclear?"}], "owner": {"reputation": 31, "user_id": 8125690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39b8e52778a921a1eb57411d915a4321?s=128&d=identicon&r=PG&f=1", "display_name": "dubstep22", "link": "https://stackoverflow.com/users/8125690/dubstep22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2402, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1496903770, "creation_date": 1496851232, "last_edit_date": 1531164843, "question_id": 44417652, "link": "https://stackoverflow.com/questions/44417652/vba-loop-through-all-objects-within-a-word-document", "title": "vba loop through all objects within a word document", "body": "<p>I need to loop through all objects within a Word document to find all tables and copy paste them into an Excel sheet. Problem is that some of the tables are within shapes. So I ended up with writing one loop for tables and one for the tables in shapes. So now I have them unordered in my Excel sheet of course. But for my final solution I need to order both (the tables and the tables in shapes) into the right order like they appear in the Word document.</p>\n\n<p>Does anyone has some suggestions. Even small hints are welcome after googling the whole day</p>\n\n<p>What I have so far with two Loops:</p>\n\n<pre><code>Dim Appwd As Word.Application\nSet Appwd = CreateObject(\"Word.Application\")\nAppwd.Visible = True\nDim wdDoc As Word.Document\nSet wdDoc = Appwd.Documents.Open(\"U:\\path\\to\\test.docx\")\n\nDim Tb As Table\nDim Shp As Object\nDim tab_anz As Integer \nDim lz As Integer \nDim i As Integer\nlz = 1\n\nFor Each Tb In wdDoc.Tables\n    Tb.range.Copy\n    Sheets(1).Cells(lz + 2, 1).PasteSpecial Paste:=xlPasteValues\n    lz = Sheets(1).UsedRange.SpecialCells(xlCellTypeLastCell).Row\nNext Tb\n\n\nFor Each Shp In wdDoc.Shapes\n    With Shp.TextFrame\n        If .HasText Then\n            Shp.TextFrame.TextRange.Copy\n            Sheets(1).Cells(lz + 2, 1).PasteSpecial Paste:=xlPasteValues\n            lz = Sheets(1).UsedRange.SpecialCells(xlCellTypeLastCell).Row\n        End If\n    End With\n    DoEvents\nNext Shp\n</code></pre>\n\n<p>What kind it should look like:</p>\n\n<pre><code>For Each Object In WordDocument.Objects\n    If Object.type == Table Then\n        Copy into Excel sheet\n    Elseif Object.type == Shapes\n        If Table in Shape Then copy into Excel sheet\n    End If  ' Only for tables or tables in shapes\nNext Object\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "edited": false, "score": 0, "creation_date": 1496854838, "post_id": 44418487, "comment_id": 75836087, "body": "Yea it&#39;s the reference. Before I had Me.Controls(varVisibleList).visible. But the same error occurred. EventType is the dropdown menu from the form. i&#39;ll give your code a try. Thanks"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "edited": false, "score": 0, "creation_date": 1496855064, "post_id": 44418487, "comment_id": 75836207, "body": "You want to set visibility for 30 controls? See edits to answer."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 1, "last_activity_date": 1496855634, "last_edit_date": 1496855634, "creation_date": 1496853995, "answer_id": 44418487, "question_id": 44417477, "link": "https://stackoverflow.com/questions/44417477/access-for-loop-hide-objects/44418487#44418487", "title": "Access For Loop Hide Objects", "body": "<p>Which line triggers the error? Suspect it is reference to the subform that is flawed. Never seen code like that to loop through an array. Suggest naming subform container different from the object it holds, such as ctrEvent. What is EventType - a textbox/field on the form? Consider code:</p>\n\n<pre><code>Dim aryFields As Variant\nDim x As Integer\naryFields = Split(\"VisitDate_Event,VisitTime_Event,VisitSite_Event,VisitStaff_Event,VisitMeet_Event\", \",\")\nFor x = 0 To UBound(aryFields)\n    Me.ctrEvent.Form.Controls(aryFields(x)).Visible = Me.EventType = 3\nNext\n</code></pre>\n\n<p>Alternative methods not using array:</p>\n\n<p>Set control Tag property then code loops through all controls on form and sets visibility for those that have particular value in Tag. </p>\n\n<pre><code>Dim ctrl As Control\nFor Each ctrl in Me.ctrEvent.Form.Controls\n    If ctrl.Tag = \"something\" Then ctrl.Visibility = Me.EventType = 3\nNext\n</code></pre>\n\n<p>Another is to give controls similar names, like: Visit1, Visit2, etc. Then code:</p>\n\n<pre><code>Dim x As Integer\nFor x = 1 to 30\n    Me.ctrEvent.Form.Controls(\"Visit\" &amp; x).Visible = Me.EventType = 3\nNext \n</code></pre>\n\n<p>Advise no spaces or punctuation/special characters (underscore only exception) in naming convention.</p>\n"}, {"tags": [], "owner": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1496857428, "creation_date": 1496857428, "answer_id": 44419462, "question_id": 44417477, "link": "https://stackoverflow.com/questions/44417477/access-for-loop-hide-objects/44419462#44419462", "title": "Access For Loop Hide Objects", "body": "<p>You are trying to iterate over an array of strings.</p>\n\n<pre><code>Dim VisibleVisitFields() As String\n</code></pre>\n\n<p>You need to declare the array to contain variants (which can still contain strings)</p>\n\n<pre><code>Dim VisibleVisitFields() As Variant\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496857428, "creation_date": 1496850770, "question_id": 44417477, "link": "https://stackoverflow.com/questions/44417477/access-for-loop-hide-objects", "title": "Access For Loop Hide Objects", "body": "<p>I'm trying to hide/unhide around 30 objects on my form when the user selects certain values from a dropdown menu. I tried the loop below, however I receive the following error: 'Object doesn't support this property or method.' I have this code running on the 'AfterUpdate' of the dropdown menu object. </p>\n\n<pre><code>Dim VisibleVisitFields() As String\nDim VisibleVisitFieldlist As String\nDim varVisibleVisit As Variant\nVisibleVisitFieldlist = \"VisitDate_Event,VisitTime_Event,VisitSite_Event,VisitStaff_Event,VisitMeet_Event\"\nVisibleVisitFields = Split(VisibleVisitFieldlist, \",\")\n\nIf (EventType = 3) Then\n    For Each varVisibleVisit In VisibleVisitFields\n    [Forms]![subFRM_TBL_Event-All in One].Controls(varVisibleVisit).visible = True\n    Exit For\nNext\nElse\nIf (EventType &lt;&gt; 3) Then\n    For Each varVisibleVisit In VisibleVisitFields\n    [Forms]![subFRM_TBL_Event-All in One].Controls(varVisibleVisit).visible = False\n    Exit For\nNext\nEnd If\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8126573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11aacf516f7fcb8150894e725ef75b9?s=128&d=identicon&r=PG&f=1", "display_name": "Seun", "link": "https://stackoverflow.com/users/8126573/seun"}, "edited": false, "score": 0, "creation_date": 1496938937, "post_id": 44417592, "comment_id": 75879575, "body": "Thanks for the reply! If that&#39;s the case, do I need to change anything in the following code:   Set myStyle = ActiveDocument.Styles.Add(Name:=&quot;Headings_Sub&quot;, _  Type:=wdStyleTypeCharacter) With myStyle.Font  .Bold = True  .Italic = False  .Name = &quot;Times New Roman&quot;  .Size = 12  .AllCaps = True   End With"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 8126573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11aacf516f7fcb8150894e725ef75b9?s=128&d=identicon&r=PG&f=1", "display_name": "Seun", "link": "https://stackoverflow.com/users/8126573/seun"}, "edited": false, "score": 0, "creation_date": 1496939397, "post_id": 44417592, "comment_id": 75879843, "body": "It would help to edit your question to explain exactly what you&#39;re trying to do. I can&#39;t tell from looking at your code what the aim is. Why do you need to use <code>GetObject()</code> when you can just reference the built-in <code>Application</code> object?"}, {"owner": {"reputation": 11, "user_id": 8126573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11aacf516f7fcb8150894e725ef75b9?s=128&d=identicon&r=PG&f=1", "display_name": "Seun", "link": "https://stackoverflow.com/users/8126573/seun"}, "edited": false, "score": 0, "creation_date": 1496946428, "post_id": 44417592, "comment_id": 75883714, "body": "I&#39;m using GetObject() based on another programmer&#39;s recommendation. Essentially, I want the code to automatically highlight any paragraphs/text that meets the font criteria, then copy that text into an Excel spreadsheet. Ideally, each line of text would be its own row when pasted into the Excel sheet."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 8126573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11aacf516f7fcb8150894e725ef75b9?s=128&d=identicon&r=PG&f=1", "display_name": "Seun", "link": "https://stackoverflow.com/users/8126573/seun"}, "edited": false, "score": 0, "creation_date": 1496954043, "post_id": 44417592, "comment_id": 75887728, "body": "If you&#39;re running this in Word then you don&#39;t need <code>GetObject()</code>.  If you&#39;re running this in Excel then there are other issues.  There also seems to be a bunch of code missing: for example you declare <code>p</code> but never set it to anything."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1496851056, "creation_date": 1496851056, "answer_id": 44417592, "question_id": 44417184, "link": "https://stackoverflow.com/questions/44417184/method-or-data-member-not-found-vba-word/44417592#44417592", "title": "&quot;Method or data member not found&quot; (VBA Word)", "body": "<p><code>myStyle</code> is not a property of the Paragraph object</p>\n\n<p>Try:</p>\n\n<pre><code>If p.Style = \"Headings_Sub\" Then\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8126573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11aacf516f7fcb8150894e725ef75b9?s=128&d=identicon&r=PG&f=1", "display_name": "Seun", "link": "https://stackoverflow.com/users/8126573/seun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496864206, "creation_date": 1496849972, "last_edit_date": 1496864206, "question_id": 44417184, "link": "https://stackoverflow.com/questions/44417184/method-or-data-member-not-found-vba-word", "title": "&quot;Method or data member not found&quot; (VBA Word)", "body": "<p>I have this portion of code below that keeps receiving the \"Method or data \n    member not found\" error message:</p>\n\n<pre><code>If p.myStyle = \"Headings_Sub\" Then\np.Range.Select\n\nEnd If\n</code></pre>\n\n<p>Not sure how to solve. Here is the complete code for reference:</p>\n\n<pre><code>Sub testCopyPasteVBA()\n\ntestCopyPasteVBA Macro\n\nDim wordDoc As Object\nDim oXL As Excel.Application\nDim DocTarget As Word.Document\nDim Target As Excel.Workbook\nDim tSheet As Excel.Worksheet\nDim StrTxt As String\nDim oRng As Word.Range\nDim p As Paragraph\nDim myStyle As Style\n\nSet oRng = ActiveDocument.Range\noRng.Start = ActiveDocument.Bookmarks(\"D_Start\").Range.End\noRng.End = ActiveDocument.Bookmarks(\"D_End\").Range.Start\n\nSet wordDoc = GetObject(, \"word.application\")\noRng.Select\n\nSet myStyle = ActiveDocument.Styles.Add(Name:=\"Headings_Sub\", _\nType:=wdStyleTypeCharacter)\nWith myStyle.Font\n.Bold = True\n.Italic = False\n.Name = \"Times New Roman\"\n.Size = 12\n.AllCaps = True\n\nEnd With\n\nIf p.myStyle = \"Headings_Sub\" Then\np.Range.Select\n\nEnd If\n\nSelection.Copy\n\n'If Excel is running\nOn Error Resume Next\nSet oXL = GetObject(, \"Excel.Application\")\n\nIf Err Then\nExcelWasNotRunning = True\nSet oXL = New Excel.Application\n\nEnd If\n\noXL.Visible = True\nSet Target = oXL.Workbooks.Add\nSet tSheet = Target.Sheets(1)\ntSheet.Paste\n\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["sql", "vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1496850195, "post_id": 44417058, "comment_id": 75833297, "body": "Looks like the issue is in the join: <a href=\"https://stackoverflow.com/questions/170578/operation-must-use-an-updatable-query-error-3073-microsoft-access\" title=\"operation must use an updatable query error 3073 microsoft access\">stackoverflow.com/questions/170578/&hellip;</a> Some different recommendations here--one is to insert into a temp table then select from it. That seems like it would work for you."}, {"owner": {"reputation": 15, "user_id": 8061189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242d87aeb17fa8bafd4148b07725121f?s=128&d=identicon&r=PG&f=1", "display_name": "bcbrwk", "link": "https://stackoverflow.com/users/8061189/bcbrwk"}, "reply_to_user": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1496850460, "post_id": 44417058, "comment_id": 75833455, "body": "@JacobH so instead of referencing the query, I should make a dummy table for <code>qryAllData</code> to insert into and then reference that with <code>qrySelData</code>?"}, {"owner": {"reputation": 15, "user_id": 8061189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242d87aeb17fa8bafd4148b07725121f?s=128&d=identicon&r=PG&f=1", "display_name": "bcbrwk", "link": "https://stackoverflow.com/users/8061189/bcbrwk"}, "reply_to_user": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1496858500, "post_id": 44417058, "comment_id": 75838034, "body": "@JacobH I am still having trouble. So I have a temp table that is being referenced; how do I execute the query that I am using to paste data into the temp table? That seems to be my main issue currently."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1496880345, "post_id": 44417058, "comment_id": 75847680, "body": "What is your overall goal? You do not mention it anywhere. Classic <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>. Don&#39;t just tell us your attempted <i>Y solution</i>, tell us your <i>X problem</i>."}], "answers": [{"tags": [], "owner": {"reputation": 683, "user_id": 7047935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wCtAP.jpg?s=128&g=1", "display_name": "smartobelix", "link": "https://stackoverflow.com/users/7047935/smartobelix"}, "is_accepted": false, "score": 0, "last_activity_date": 1496871438, "creation_date": 1496871438, "answer_id": 44423194, "question_id": 44417058, "link": "https://stackoverflow.com/questions/44417058/vba-excel-access-query-not-updateable/44423194#44423194", "title": "VBA Excel - Access Query not updateable", "body": "<p>The first query is not updatable because you are using function (cvdate) in select column list. Remove this column or function and it should work.</p>\n\n<p>Second query (seems to be completly different) have missing join condition between <code>[Process Info]</code> and <code>[Complete Data]</code>. This means Access tries to produce carthesian product and simply have not enough memory... </p>\n\n<p>On first look I would say in second query you should remove <code>[Complete Data]</code> from FROM clause (if you anyway don't join those tables).</p>\n"}], "owner": {"reputation": 15, "user_id": 8061189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242d87aeb17fa8bafd4148b07725121f?s=128&d=identicon&r=PG&f=1", "display_name": "bcbrwk", "link": "https://stackoverflow.com/users/8061189/bcbrwk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496871438, "creation_date": 1496849676, "question_id": 44417058, "link": "https://stackoverflow.com/questions/44417058/vba-excel-access-query-not-updateable", "title": "VBA Excel - Access Query not updateable", "body": "<p>I am getting an error trying to run a query through VBA in Excel.</p>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>Run-time error '3073':\n  Operation must use an updateable query.</p>\n</blockquote>\n\n<p>I have a query that is fetching data from one table in Excel.</p>\n\n<p>qryAllData:</p>\n\n<pre><code>SELECT ID, Field1 AS [Date], Field9 AS [Alarm Init], Field5 AS [Alarm End], CVDate(Field2) AS [Time]\nFROM [Jet Info]\nWHERE (Field3 LIKE 'ALARM' OR Field8 LIKE 'ALARM:') AND Field5 NOT LIKE 'Program' AND (Field9 NOT LIKE 'Program' OR ISNULL(Field9));\n</code></pre>\n\n<p>I originally had been directly referencing this query in Excel but was still getting the above error, so I tried referencing the query instead.</p>\n\n<p>qrySelData:</p>\n\n<pre><code>SELECT DISTINCTROW TOP 1 a.*\nFROM [Process Info] AS a, [Complete Data] AS b\nWHERE (((a.Date) Not In (SELECT [Date] FROM [Complete Data])) AND ((a.[Start Time]) Not In (SELECT [Start Time] FROM [Complete Data])));\n</code></pre>\n\n<p>Here is my VBA code:</p>\n\n<pre><code> Private Sub CommandButton1_Click()\n     Refresh_Data\n     Dim objAccess As Object\n\n     Set objAccess = GetObject(\"C:\\Users\\******\\Documents\\Database21.accdb\")\n\n     objAccess.Visible = False\n\n     objAccess.DoCmd.OpenQuery (\"qrySelData\")\n\n     objAccess.Quit\n     Set objAccess = Nothing\n End Sub\n</code></pre>\n\n<p>Running the sub in VBA throws error 3072 on the <code>objAccess.DoCmd.OpenQuery (\"qrySelData\")</code> line.</p>\n\n<p>Any help would be appreciated - if you need more info let me know.</p>\n"}, {"tags": ["vba", "excel", "ms-word", "ole"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1496849871, "post_id": 44416817, "comment_id": 75833084, "body": "Not sure what you mean by &quot;... macro works when running in piecemeal ...&quot; --- can you give more details? Is there a particular line of code that&#39;s producing the error?"}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1496850126, "post_id": 44416817, "comment_id": 75833251, "body": "Hi @xidgel ---I mean that I can get the macro to copy over to the report template each piece of workbook content in question separately (except for the charts actually), but not when all their copy-paste commands are commented-in, running altogether. Thanks for your help."}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1496850220, "post_id": 44416817, "comment_id": 75833311, "body": "Also, no line of code produces an error. Excel simply notifies of the incomplete OLE action every 90 seconds or so."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1496850704, "post_id": 44416817, "comment_id": 75833635, "body": "Searching the web for &quot;waiting for another application to complete an ole action&quot; returned some possible helpful things like <a href=\"https://social.technet.microsoft.com/Forums/en-US/91f940bd-491f-40fa-9c44-7283a19663c5/microsoft-excel-is-waiting-for-another-application-to-complete-an-ole-action?forum=officeitpro\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1496851152, "post_id": 44416817, "comment_id": 75833931, "body": "Thanks @xidgel ---I have tried the solution you linked to, to no avail unfortunately."}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1496851334, "post_id": 44416817, "comment_id": 75834043, "body": "This is sort of a nebulous question I&#39;m asking here, I know. Hope perhaps someone has dealt with this before and can offer advice as to how to troubleshoot it and/or insight into how they solved the problem."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1496854232, "post_id": 44418000, "comment_id": 75835774, "body": "Hi @TimWilliams ---Thanks for your help. Restructuring the error handle did well to mitigate the perpetual OLE action.  Now that the code can proceed past the hold-up, I get error &#39;1004&#39; (application- or object-defined error) on this line: <code>ThisWorkbook.Sheets(&quot;Chart 1 Worksheet Name&quot;).ChartObjects(1).Copy</code>  Any idea on this one? Syntax I imagine.."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1496854632, "post_id": 44418000, "comment_id": 75835979, "body": "Do you have a worksheet named &quot;Chart 1 Worksheet Name&quot; (seems an unlikely name for a worksheet) and if Yes is it a worksheet (not a Chart sheet) and does it have at least one embedded chart on it ?"}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1496855275, "post_id": 44418000, "comment_id": 75836320, "body": "&quot;Chart 1 Worksheet Name&quot; is a placeholder for the actual sheet name, which is correct in the actual code. Is in fact a chart sheet.."}, {"owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1496855545, "post_id": 44418000, "comment_id": 75836462, "body": "But the next instance of this: <code>ThisWorkbook.Sheets(&quot;Chart 2 Worksheet Name&quot;).ChartObjects(1).Copy</code> (&#39;Chart 2 Worksheet&#39; being a worksheet, not chart sheet) also throws an error (method &#39;Copy&#39; of &#39;ChartObject&#39; failed). There are technically two charts on that sheet (grouped together); I&#39;m hoping to copy-paste them at once, together."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "edited": false, "score": 0, "creation_date": 1496856569, "post_id": 44418000, "comment_id": 75836987, "body": "If your charts are grouped then you need to copy the group - you can&#39;t copy an individual chart.  Click on the group - you should see its name in the &quot;name&quot; box top-left of the worksheet. You need something like <code>ThisWorkbook.Sheets(&quot;Chart 2 Worksheet Name&quot;).Shapes(&quot;Group 3&quot;).Copy</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1496857314, "last_edit_date": 1496857314, "creation_date": 1496852298, "answer_id": 44418000, "question_id": 44416817, "link": "https://stackoverflow.com/questions/44416817/generating-a-microsoft-word-report-from-excel-application-waiting-for-ole-action/44418000#44418000", "title": "Generating a Microsoft Word Report from Excel\u2014Application Waiting for OLE Action? (VBA)", "body": "<p>Try modifying your Word application creation script - this is all you need:    </p>\n\n<pre><code>On Error Resume Next\nSet WordApplication = GetObject(class:=\"Word.Application\")\nOn Error GoTo 0\n\nIf WordApplication Is Nothing Then\n    Set WordApplication = CreateObject(class:=\"Word.Application\")\nEnd If\n</code></pre>\n\n<p>It may be that Word is waiting for some input from you but you're not seeing it because you didn't make the instance visible, so try also adding:</p>\n\n<pre><code>WordApplication.Visible = True\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6524777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5679254bd8823b8784d68fbb7abe660?s=128&d=identicon&r=PG&f=1", "display_name": "PBG", "link": "https://stackoverflow.com/users/6524777/pbg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "accepted_answer_id": 44418000, "answer_count": 1, "score": 0, "last_activity_date": 1497030852, "creation_date": 1496849020, "last_edit_date": 1531164843, "question_id": 44416817, "link": "https://stackoverflow.com/questions/44416817/generating-a-microsoft-word-report-from-excel-application-waiting-for-ole-action", "title": "Generating a Microsoft Word Report from Excel\u2014Application Waiting for OLE Action? (VBA)", "body": "<p>I'm trying to write a macro that will generate a Microsoft Word 'report' from an Excel file. I want for the macro to navigate to bookmarks in a Word template for the report, and insert at each certain content or a chart from the native Excel file. The macro works when running in piecemeal, but altogether fails to execute, with Excel repeating over and over that \"[It] is waiting for another application to complete an OLE action.\"</p>\n\n<p>To clarify also, the macro first clears a certain 'data dump' region in the workbook (its native file) and repopulates it with new data from a specified file. This file (its location path) and the various 'target row' and 'identifier' variables you see in the code are inputted by the user to a sort of interface (just a worksheet in the native workbook), where each is labeled manually as a (named) range to be easily fed into to be used by the code. The macro then creates the report by going through the different sheets of the workbook, copying certain content, and turning to Word to paste the copied content at template locations indicated by bookmarks.</p>\n\n<p>I'm completely perplexed by the 'OLE error'. Any ideas about this/the code otherwise? Please share. Thanks for your help!</p>\n\n<pre><code>Sub GenerateReport()\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\nDim myWorkbook As Excel.Workbook\nSet myWorkbook = ThisWorkbook\nDim myWorksheet As Excel.Worksheet\nSet myWorksheet = myWorkbook.Sheets(\"Sheet1\")\nDim myWorksheet2 As Excel.Worksheet\nSet myWorksheet2 = myWorkbook.Sheets(\"Sheet2\")\nDim myWorksheet3 As Excel.Worksheet\nSet myWorksheet3 = myWorkbook.Sheets(\"Sheet3\")\n\nDim FileName As String\nFileName = myWorksheet.Range(\"FileName\")\nDim FilePath As String\nFilePath = myWorksheet.Range(\"FilePath\")\nDim TargetSheetName As String\nTargetSheetName = myWorksheet.Range(\"TargetSheetName\")\nDim PasteSheetName As String\nPasteSheetName = myWorksheet.Range(\"PasteSheetName\")\n\nDim Identifier As String\nIdentifier = myWorksheet.Range(\"Identifier\")\nDim Identifier2 As String\nIdentifier2 = myWorksheet.Range(\"Identifier2\")\nDim TargetRow As String\nTargetRow = myWorksheet.Range(\"TargetRow\")\nDim TargetRow2 As String\nTargetRow2 = myWorksheet.Range(\"TargetRow2\")\nDim PasteIdentifier As String\nPasteIdentifier = myWorksheet.Range(\"PasteIdentifier\")\nDim PasteIdentifier2 As String\nPasteIdentifier2 = myWorksheet.Range(\"PasteIdentifier2\")\nDim PasteTargetRow As String\nPasteTargetRow = myWorksheet.Range(\"PasteTargetRow\")\nDim PasteTargetRow2 As String\nPasteTargetRow2 = myWorksheet.Range(\"PasteTargetRow2\")\n\nDim Text As String\nText = myWorksheet.Range(\"Text\")\nDim Text2 As String\nText2 = myWorksheet.Range(\"Text2\")\nDim Text3 As String\nText3 = myWorksheet.Range(\"Text3\")\n\nDim ReportTemplateFilePath As String\nReportTemplateFilePath = myWorksheet.Range(\"ReportTemplateFilePath\")\nDim ReportTemplateFileName As String\nReportTemplateFileName = myWorksheet.Range(\"ReportTemplateFileName\")\nDim SaveToLocation As String\nSaveToLocation = myWorksheet.Range(\"SaveToLocation\")\n\nDim SourceTargetSheet As Excel.Worksheet\nSet SourceTargetSheet = myWorkbook.Sheets(PasteSheetName)\nDim TargetWorkbook As Excel.Workbook\nSet TargetWorkbook = Workbooks.Open(FilePath)\nDim TargetSheet As Excel.Worksheet\nSet TargetSheet = TargetWorkbook.Sheets(TargetSheetName)\n\n'Clear old info\nDim UpperLeftHandCornerOfClear As String\nUpperLeftHandCornerOfClear = \"A\" &amp; PasteTargetRow\nDim LowerRightHandCornerOfClear As String\nLowerRightHandCornerOfClear = \"XFD\" &amp; PasteTargetRow2\nSourceTargetSheet.Range(UpperLeftHandCornerOfClear, LowerRightHandCornerOfClear).ClearContents\n\n'Copy new info for pasting\nDim StartingColumnAsRange As Range\nSet StartingColumnAsRange = TargetSheet.Cells.Find(Identifier, LookIn:=xlValues, LookAt:=xlPart)\nIf Not StartingColumnAsRange Is Nothing Then\n    Dim StartingColumn As String\n    StartingColumn = Split(StartingColumnAsRange.Address, \"$\")(1)\nEnd If\nDim EndingColumnAsRange As Range\nSet EndingColumnAsRange = TargetSheet.Cells.Find(Identifier2, LookIn:=xlValues, LookAt:=xlPart)\nIf Not EndingColumnAsRange Is Nothing Then\n    Dim EndingColumn As String\n    EndingColumn = Split(EndingColumnAsRange.Address, \"$\")(1)\nEnd If\nDim UpperLeftHandCornerOfCopy As String\nUpperLeftHandCornerOfCopy = StartingColumn &amp; TargetRow\nDim LowerRightHandCornerOfCopy As String\nLowerRightHandCornerOfCopy = EndingColumn &amp; TargetRow2\nTargetSheet.Range(UpperLeftHandCornerOfCopy, LowerRightHandCornerOfCopy).Copy\nDim PastePasteTarget As String\nPastePasteTarget = \"A\" &amp; PasteTargetRow\nSourceTargetSheet.Range(PastePasteTarget).PasteSpecial Paste:=xlPasteValues\n\n'Create a Microsoft Word object (instance of Word to control)\nDim WordApplication As Word.Application\nSet WordApplication = CreateObject(\"Word.Application\")\n\n'Error handle if Microsoft Word is open\nOn Error Resume Next\n    Set WordApplication = GetObject(class:=\"Word.Application\")\n    Err.Clear\n    If WordApplication Is Nothing Then\n        Set WordApplication = CreateObject(class:=\"Word.Application\")\n    End If\nOn Error GoTo 0\n\n'Error handle if report template is specifically already open\nOn Error Resume Next\nApplication.DisplayAlerts = False\nDocuments(ReportTemplateFileName).Close SaveChanges:=wdDoNotSaveChanges\nOn Error GoTo 0\nApplication.DisplayAlerts = True\n\nDim WordDocument As Word.Document\nSet WordDocument = WordApplication.Documents.Open(ReportTemplateFilePath)\n\n'Content from 'myWorksheet'\nWith WordDocument\n    .Bookmarks(\"Bookmark1\").Range.Text = myWorksheet.Range(\"Text1\")\n    .Bookmarks(\"Bookmark2\").Range.Text = myWorksheet.Range(\"Text2\")\n    .Bookmarks(\"Bookmark3\").Range.Text = myWorksheet.Range(\"Text3\")\n    .Bookmarks(\"Bookmark4\").Range.Text = myWorksheet.Range(\"Text4\")\nEnd With\n\n'Content from 'myWorksheet2'\nWith WordDocument\n    .Bookmarks(\"Bookmark5\").Range.Text = myWorksheet2.Range(\"Text5\")\n    .Bookmarks(\"Bookmark6\").Range.Text = myWorksheet2.Range(\"Text6\")\n    .Bookmarks(\"Bookmark7\").Range.Text = myWorksheet2.Range(\"Text7\")\n    .Bookmarks(\"Bookmark8\").Range.Text = myWorksheet2.Range(\"Text8\")\n    .Bookmarks(\"Bookmark9\").Range.Text = myWorksheet2.Range(\"Text9\")\n    .Bookmarks(\"Bookmark10\").Range.Text = myWorksheet3.Range(\"Text10\")\nEnd With\n\n'Chart (alone on worksheet)\nWordApplication.Selection.Goto What:=wdGoToBookmark, Name:=\"Chart1\"\nThisWorkbook.Sheets(\"Chart 1 Worksheet Name\").ChartObjects(1).Copy\nWordApplication.Selection.Paste\nWordApplication.Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter\n\n'Two charts grouped together\nWordApplication.Selection.Goto What:=wdGoToBookmark, Name:=\"Chart2\"\nThisWorkbook.Sheets(\"Chart 2 Worksheet Name\").ChartObjects(1).Copy\nWordApplication.Selection.Paste\nWordApplication.Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter\n\nWith WordDocument\n    .SaveAs FileName:=SaveToLocation &amp; \" \" &amp; Text3, _\n            FileFormat:=wdFormatDocumentDefault\n    .Close\nEnd With\n\nWordApplication.Quit\nSet WordApplication = Nothing\nSet WordDocument = Nothing\n\nApplication.ScreenUpdating = True\n'Application.DisplayAlerts = True\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\n\nmyWorksheet.Activate\nMsgBox \"Report successfully generated.\", vbInformation, \"Completed!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "selenium-webdriver", "vba"], "answers": [{"tags": [], "owner": {"reputation": 326, "user_id": 1480143, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/963f238f2da633547f19064d72f88233?s=128&d=identicon&r=PG", "display_name": "Sanjoy", "link": "https://stackoverflow.com/users/1480143/sanjoy"}, "is_accepted": true, "score": 1, "last_activity_date": 1496985806, "creation_date": 1496985806, "answer_id": 44449864, "question_id": 44416743, "link": "https://stackoverflow.com/questions/44416743/firefox-profile-for-portable-firefox-excel-vba-in-selenium/44449864#44449864", "title": "Firefox Profile for Portable Firefox - Excel VBA in Selenium", "body": "<p>After lot of experiment I found that adding a true at the end works. So the code looks like </p>\n\n<pre><code> driver.SetBinary (\"X:\\Path\\FirefoxPortable37\\Data\\profile\"),True\n</code></pre>\n"}], "owner": {"reputation": 326, "user_id": 1480143, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/963f238f2da633547f19064d72f88233?s=128&d=identicon&r=PG", "display_name": "Sanjoy", "link": "https://stackoverflow.com/users/1480143/sanjoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "accepted_answer_id": 44449864, "answer_count": 1, "score": 1, "last_activity_date": 1496985862, "creation_date": 1496848838, "last_edit_date": 1531164843, "question_id": 44416743, "link": "https://stackoverflow.com/questions/44416743/firefox-profile-for-portable-firefox-excel-vba-in-selenium", "title": "Firefox Profile for Portable Firefox - Excel VBA in Selenium", "body": "<p>Hi I am using firefox potable version which works fine. However I am not able to set the profile as the profile directory is being ignored. Would if anyone has used this. </p>\n\n<blockquote>\n  <p>Declarations as under</p>\n</blockquote>\n\n<pre><code> Private assert As New assert\n Private driver As New Selenium.FirefoxDriver\n Private elms As Selenium.WebElements\n Private elm As Selenium.WebElement\n</code></pre>\n\n<p>Portable Firefox Location. as per the help. I also tried to to put profile directory after set binary, but still the results are same.</p>\n\n<pre><code> driver.SetProfile (\"G:\\Software - Portable\\FirefoxPortable37\\Data\\profile\")\n driver.SetBinary (\"G:\\Software -Portable\\FirefoxPortable37\\FirefoxPortable.exe\")\n</code></pre>\n\n<blockquote>\n  <p>This runs the firefox portable version 37, but ignores the profile with extensions.</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1496848451, "post_id": 44416545, "comment_id": 75832092, "body": "<i>I cant seem to locate the issue with i</i> - have you run the code step-by-step to debug and see what the behavior is versus what is expected? If you have not, please do that but remove <code>On Error Resume Next</code> first."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1496848513, "post_id": 44416545, "comment_id": 75832139, "body": "What happens when you try <code>For i = 2 To UBound(myarr) -1</code>"}, {"owner": {"reputation": 1, "user_id": 8098591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2330a5f7411e1e4c03de8f8234ebebbb?s=128&d=identicon&r=PG&f=1", "display_name": "arron", "link": "https://stackoverflow.com/users/8098591/arron"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1496848744, "post_id": 44416545, "comment_id": 75832294, "body": "@ScottHoltzman i have and it does not produce any error. the code runs fine, it just has some kind of bug in it"}, {"owner": {"reputation": 1, "user_id": 8098591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2330a5f7411e1e4c03de8f8234ebebbb?s=128&d=identicon&r=PG&f=1", "display_name": "arron", "link": "https://stackoverflow.com/users/8098591/arron"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496848784, "post_id": 44416545, "comment_id": 75832324, "body": "@SiddharthRout it produces 2 extra sheets"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1496848856, "post_id": 44416545, "comment_id": 75832377, "body": "@arron. <i>it does not product any error</i> - Remove <code>On Error Resume Next</code>. Also, step through <b>line-by-line</b> and look at expected behavoir versus what actually happens. The issue is not an actual error, but that your code is not behaving they way you expect. Testing each line as you go is the only way to figure out why. All that said .... Maybe try <code>For i = 2 to UBound(myarr) - 3</code>. Reason being that you are not starting your counter at 0 (where the array starts), but at 2, so you need to subtract 3 to equalize the loop, or account for the difference some other way."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1496848969, "post_id": 44416545, "comment_id": 75832446, "body": "Then in that case you need to revisit the line <code>myarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).Spe&zwnj;&#8203;cialCells(xlCellType&zwnj;&#8203;Constants))</code> and check what does the array actually has. No point subtracting 1 or 2 or 3 from <code>UBound(myarr)</code>"}, {"owner": {"reputation": 1, "user_id": 8098591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2330a5f7411e1e4c03de8f8234ebebbb?s=128&d=identicon&r=PG&f=1", "display_name": "arron", "link": "https://stackoverflow.com/users/8098591/arron"}, "edited": false, "score": 0, "creation_date": 1496849186, "post_id": 44416545, "comment_id": 75832606, "body": "sorry, i didnt see that half of the comment. its giving me &quot;application-defined or object-defined error&quot; at  { If ws.Cells(i, vcol) &lt;&gt; &quot;&quot; And Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then }"}, {"owner": {"reputation": 1, "user_id": 8098591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2330a5f7411e1e4c03de8f8234ebebbb?s=128&d=identicon&r=PG&f=1", "display_name": "arron", "link": "https://stackoverflow.com/users/8098591/arron"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496849658, "post_id": 44416545, "comment_id": 75832941, "body": "@SiddharthRout what exactly do you mean. im still quite new to VBA so im not entirely sure what im doing"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496850096, "post_id": 44416545, "comment_id": 75833233, "body": "Did you not write this code? If you did then you should know why you have the line <code>Application.WorksheetFunction.Transpose(ws.Columns(icol).Spe&zwnj;&#8203;\u200c\u200bcialCells(xlCellTy&zwnj;&#8203;pe\u200c\u200bConstants))</code> there and what it should accomplish :)"}, {"owner": {"reputation": 1, "user_id": 8098591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2330a5f7411e1e4c03de8f8234ebebbb?s=128&d=identicon&r=PG&f=1", "display_name": "arron", "link": "https://stackoverflow.com/users/8098591/arron"}, "edited": false, "score": 0, "creation_date": 1496850333, "post_id": 44416545, "comment_id": 75833376, "body": "a significant amount of it was dictated to me by a friend who was trying to help me learn and i had just filled in what i could. he explained the code as we wrote it but i forgot most of it"}], "owner": {"reputation": 1, "user_id": 8098591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2330a5f7411e1e4c03de8f8234ebebbb?s=128&d=identicon&r=PG&f=1", "display_name": "arron", "link": "https://stackoverflow.com/users/8098591/arron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496848327, "creation_date": 1496848327, "last_edit_date": 1531161705, "question_id": 44416545, "link": "https://stackoverflow.com/questions/44416545/excel-macro-creates-more-work-sheets-than-is-intended", "title": "Excel macro creates more work sheets than is intended", "body": "<p>I'm working on a piece of code that I use in multiple workbooks. The macro scans each row in a column, creates a new sheet for each unique value and copies all of the corresponding rows into said sheet. When I run the macro, it does its job but creates an extra 3 blank worksheets. If I run it again, it makes even more and I cant seem to locate the issue with it. \nI would also appreciate any other optimisations to my code. Dummy data is provided below\n<a href=\"https://i.stack.imgur.com/woGEl.png\" rel=\"nofollow noreferrer\">data being separated</a></p>\n\n<pre><code>   Private Sub CommandButton1_Click()\nApplication.ScreenUpdating = False\nDim LR As Long\nDim ws As Worksheet\nDim vcol, i As Integer\nDim icol As Long\nDim myarr As Variant\nDim title As String\nDim titlerow As Integer\nvcol = 1\nSet ws = Sheets(\"Sheet1\")\nLR = ws.Cells(ws.Rows.Count, vcol).End(xlUp).Row\ntitle = \"A1:G1\"\ntitlerow = ws.Range(title).Cells(1).Row\nicol = ws.Columns.Count\nws.Cells(1, icol) = \"Unique\"\nFor i = 2 To LR\nOn Error Resume Next\nIf ws.Cells(i, vcol) &lt;&gt; \"\" And Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then\nws.Cells(ws.Rows.Count, icol).End(xlUp).Offset(1) = ws.Cells(i, vcol)\nEnd If\nNext\nmyarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).SpecialCells(xlCellTypeConstants))\nws.Columns(icol).Clear\nFor i = 2 To UBound(myarr)\nws.Range(title).AutoFilter field:=vcol, Criteria1:=myarr(i) &amp; \"\"\nIf Not Evaluate(\"=ISREF('\" &amp; myarr(i) &amp; \"'!A1)\") Then\nSheets.Add(After:=Worksheets(Worksheets.Count)).Name = myarr(i) &amp; \"\"\nElse\nSheets(myarr(i) &amp; \"\").Move After:=Worksheets(Worksheets.Count)\nEnd If\nws.Range(\"A\" &amp; titlerow &amp; \":A\" &amp; LR).EntireRow.Copy Sheets(myarr(i) &amp; \"\").Range(\"A1\")\nSheets(myarr(i) &amp; \"\").Columns.AutoFit\nNext\nws.AutoFilterMode = False\nws.Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1496848343, "post_id": 44416444, "comment_id": 75832004, "body": "<code>fieldName1</code> when inside double quotes behaves like a string. Here it is behaving like a variable which was never declared or assigned. Best to use <code>Option Explicit</code> at the top of the code. . Change<code>Range(&quot;C8&quot;).Value = fieldName1</code> to <code>Range(&quot;C8&quot;).Value = fieldName(1)</code> I guess you want to pull value from the array?"}, {"owner": {"reputation": 11, "user_id": 7447655, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b9Ge-kXyGN8/AAAAAAAAAAI/AAAAAAAAKp0/dkYUaVHbhKY/photo.jpg?sz=128", "display_name": "JayRyGeo", "link": "https://stackoverflow.com/users/7447655/jayrygeo"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496849095, "post_id": 44416444, "comment_id": 75832537, "body": "Oh, I left something important out then. Thank you for bringing attention to it.  I have declared fieldName1, fieldName2 etc. as String. The array is to iterate through those value names so each will get set to a value pulled from the recordset. So no, I am not pulling data out of the array, I am using the array to set values. Give me one second to update my code to reflect this."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1496849223, "post_id": 44416444, "comment_id": 75832623, "body": "Okay where do you assign a value to <code>fieldName1</code>?"}, {"owner": {"reputation": 11, "user_id": 7447655, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b9Ge-kXyGN8/AAAAAAAAAAI/AAAAAAAAKp0/dkYUaVHbhKY/photo.jpg?sz=128", "display_name": "JayRyGeo", "link": "https://stackoverflow.com/users/7447655/jayrygeo"}, "edited": false, "score": 0, "creation_date": 1496849262, "post_id": 44416444, "comment_id": 75832646, "body": "I wanted to assign a value from the line:     fieldName(I) = recordSet.Fields(counter).Value"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496849370, "post_id": 44416444, "comment_id": 75832735, "body": "<code>I have declared fieldName1, fieldName2 etc. as String. The array is to iterate through those value names so each will get set to a value pulled from the recordset.</code> You cant declare variables in a loop :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496849445, "post_id": 44416444, "comment_id": 75832796, "body": "That is not the way it works.  See @SiddharthRout first comment for the answer."}, {"owner": {"reputation": 11, "user_id": 7447655, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b9Ge-kXyGN8/AAAAAAAAAAI/AAAAAAAAKp0/dkYUaVHbhKY/photo.jpg?sz=128", "display_name": "JayRyGeo", "link": "https://stackoverflow.com/users/7447655/jayrygeo"}, "edited": false, "score": 0, "creation_date": 1496849618, "post_id": 44416444, "comment_id": 75832922, "body": "Ah, thank you guys.  My fault for not understanding.  I have done it in Python so I assumed that it was applicable here."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1496849642, "post_id": 44416444, "comment_id": 75832933, "body": "FWIW <code>fieldName1</code> is declared as an implicit <code>Variant</code>, not a <code>String</code>. It&#39;s also never assigned, hence being empty. Also there&#39;s no need to <code>.Select</code> anything, and the smallest possible scope in VBA is procedure level."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7447655, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b9Ge-kXyGN8/AAAAAAAAAAI/AAAAAAAAKp0/dkYUaVHbhKY/photo.jpg?sz=128", "display_name": "JayRyGeo", "link": "https://stackoverflow.com/users/7447655/jayrygeo"}, "is_accepted": true, "score": 1, "last_activity_date": 1496849681, "creation_date": 1496849681, "answer_id": 44417063, "question_id": 44416444, "link": "https://stackoverflow.com/questions/44416444/if-then-loop-not-setting-value-correctly/44417063#44417063", "title": "IF THEN loop not setting Value correctly", "body": "<p>From Siddharth:</p>\n\n<blockquote>\n  <p>I have declared fieldName1, fieldName2 etc. as String. The array is to iterate through those value names so each will get set to a value pulled from the recordset. </p>\n</blockquote>\n\n<p>You cant declare variables in a loop :)</p>\n"}], "owner": {"reputation": 11, "user_id": 7447655, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b9Ge-kXyGN8/AAAAAAAAAAI/AAAAAAAAKp0/dkYUaVHbhKY/photo.jpg?sz=128", "display_name": "JayRyGeo", "link": "https://stackoverflow.com/users/7447655/jayrygeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 44417063, "answer_count": 1, "score": 0, "last_activity_date": 1496862854, "creation_date": 1496848084, "last_edit_date": 1496849358, "question_id": 44416444, "link": "https://stackoverflow.com/questions/44416444/if-then-loop-not-setting-value-correctly", "title": "IF THEN loop not setting Value correctly", "body": "<p>I have an If...Then loop nested inside of a For loop that is supposed to assign values from an SQL recordset to VBA values so they can be assigned to excel cells.  I have verified that the recordset has values, and that what I am trying to do can be done without the For and If..Then loops.  However, the values seem to be empty whenever the loop runs through.</p>\n\n<p>Here is my block of code:</p>\n\n<pre><code>Dim counter as Integer\nDim fieldName1, fieldName2, etc. As String\nDim fieldName() As Variant\n\nfieldName = Array(\"fieldName1\", \"fieldName2\", \"etc.\")\ncounter = 0\n\nFor I = 0 To UBound(fieldName())\n        If Not IsNull(recordSet.Fields(counter)) Then\n            fieldName(I) = recordSet.Fields(counter).Value\n            counter = counter + 1\n        Else : fieldName(I) = \"\"\n            counter = counter + 1\n        End If\nNext I\n</code></pre>\n\n<p>After this executes, which it does successfully without any errors, and I try to assign a value to a cell, it is a blank string.</p>\n\n<p>This will result in an empty string:</p>\n\n<pre><code>Range(\"C8\").Select\n    With Range(\"C8\")\n        Range(\"C8\").Value = fieldName1\n    End With\n</code></pre>\n\n<p>Yet this will successfully enter a value into a cell:</p>\n\n<pre><code>Range(\"C8\").Select\n    With Range(\"C8\")\n        Range(\"C8\").Value = recordSet.Fields(4).Value\n    End With\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-office"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1496845580, "post_id": 44415158, "comment_id": 75829750, "body": "If there is a Runtime error, what is the exact error message?"}, {"owner": {"reputation": 325, "user_id": 3480989, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/38a0c369578ceadf6669af5fca71c5be?s=128&d=identicon&r=PG&f=1", "display_name": "mak", "link": "https://stackoverflow.com/users/3480989/mak"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1496851129, "post_id": 44415158, "comment_id": 75833917, "body": "No specific error at all, only something like &quot;Microsoft Access encountered a runtime error and has to be finished&quot; (translated from German). That&#39;s what it makes so much difficult for me to find the error. The code which is behind the button where it occurs is pretty simple: DoCmd.OpenForm &quot;frmKunden&quot;"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1496852548, "post_id": 44415158, "comment_id": 75834803, "body": "A screenshot of the error (even if it is in German) may help, it shows the type of error."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1496871861, "post_id": 44415158, "comment_id": 75844949, "body": "Does your VBA code compile? Please post the code for open/onload event trigger of the form, <i>frmKunden</i>. Except for very subtle design quirks and newer data types, most Access apps should be runnable across OS&#39;s, bit/versions, Office versions."}, {"owner": {"reputation": 325, "user_id": 3480989, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/38a0c369578ceadf6669af5fca71c5be?s=128&d=identicon&r=PG&f=1", "display_name": "mak", "link": "https://stackoverflow.com/users/3480989/mak"}, "edited": false, "score": 0, "creation_date": 1496931880, "post_id": 44415158, "comment_id": 75874318, "body": "Yes code has been compiled on dev machine as on customers machine I use accde. BTW I used the &quot;old&quot; program version which has been running in Win7 with A2010 RT for many years. So there was no change in the program at all."}], "answers": [{"tags": [], "owner": {"reputation": 325, "user_id": 3480989, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/38a0c369578ceadf6669af5fca71c5be?s=128&d=identicon&r=PG&f=1", "display_name": "mak", "link": "https://stackoverflow.com/users/3480989/mak"}, "is_accepted": false, "score": 0, "last_activity_date": 1496997065, "creation_date": 1496997065, "answer_id": 44452967, "question_id": 44415158, "link": "https://stackoverflow.com/questions/44415158/access-2010-rt-crashes-on-access-2016-machine/44452967#44452967", "title": "Access 2010 RT crashes on Access 2016 machine", "body": "<p>I found the error, but it had nothing to do with Access versions 2010 or 2016 or 32/64 bit.</p>\n\n<p>I made a change on a table in SQL server but did not refresh the links to the tables in Access and did not create a new accde.</p>\n\n<p>The reason, why the error did not pop up earlier was most probably, because no user entered data into this tab. So I assumed that the error was due to the change of OS and new Access version. It was only a coincidence of some changes.\nSorry and thanks for your participation on this thread.\nMichael</p>\n"}], "owner": {"reputation": 325, "user_id": 3480989, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/38a0c369578ceadf6669af5fca71c5be?s=128&d=identicon&r=PG&f=1", "display_name": "mak", "link": "https://stackoverflow.com/users/3480989/mak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496997065, "creation_date": 1496844828, "last_edit_date": 1496864109, "question_id": 44415158, "link": "https://stackoverflow.com/questions/44415158/access-2010-rt-crashes-on-access-2016-machine", "title": "Access 2010 RT crashes on Access 2016 machine", "body": "<p>Without giving notice an administrator changed from Win 7 64 bit with Office 2010 32 bit to Win 10 64 bit with Office 2016 64 bit on a certain machine.</p>\n\n<p>Now, our production database application based on Access 2010 Runtime 32 bit does not work anymore, ALTHOUGH I installed the neccessary program and let the application start with A2010 RT.</p>\n\n<p>I checked all references, if they are available and not broken (IsBroken = false), but cannot find the cause for the Runtime error which determins the program.</p>\n\n<p>Any other ideas to detect and solve the problem??</p>\n\n<p>Does deinstallation of only Access 2016 64 bit could bring the solution??\n(I found out that deinstallation of any Office 2016 app is not that easy but will try it with Office Deployment Tool).</p>\n\n<p>Thanks your help!\nMichael  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1496844863, "post_id": 44414981, "comment_id": 75829196, "body": "Do you want to set the formula of the cell as <code>=&quot;&gt;&quot;&amp;DATE(2017,6,8)</code> ?"}, {"owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1496844933, "post_id": 44414981, "comment_id": 75829248, "body": "@RobinMackenzie I want to set the formula of the cell as this, but with the year, month and day that I write on my form."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1496844973, "post_id": 44414981, "comment_id": 75829277, "body": "What would be your end result? You have problems in string concatenation."}, {"owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1496845076, "post_id": 44414981, "comment_id": 75829368, "body": "@ManishChristian yes, I guess the concatenation is my problem. The result that I want is to set the value of a cell with =&quot;&gt;&quot;&amp;DATE(year,month,date)."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1496845097, "post_id": 44414981, "comment_id": 75829382, "body": "should <code>= &quot;=&quot; &lt;= &quot;</code> be <code>= &quot;=&lt;= &quot;</code>"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1496845212, "post_id": 44414981, "comment_id": 75829477, "body": "Replace all <code>&quot;</code> around <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code> with <code>&quot;&quot;</code>."}, {"owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1496845622, "post_id": 44414981, "comment_id": 75829800, "body": "@ManishChristian I tried that, but it doesn&#39;t seem to work"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1496845969, "post_id": 44414981, "comment_id": 75830119, "body": "On the face of things, one of the referenced controls should not exist. The error message doesn&#39;t indicate anything wrong with your concatenations. I know this looks unlikely, but you did make a mistake in writing <code>Maior</code> twice and missing <code>Menor</code>, so why not have one more type? Does <code>Compdata</code> exit by that name?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1496846011, "post_id": 44414981, "comment_id": 75830147, "body": "@OP so far it looks like an XY problem. First of all, what uou will get in the destination cell is something like <code>&gt;42893</code>, that is, the resulting date will show as a number. To understand the ultimate purpose, would you show a <i>concrete example</i> of what you want to <b>see</b> in the cell?"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1496846221, "post_id": 44414981, "comment_id": 75830334, "body": "Also your <code>If</code> and first <code>ElseIf</code> conditions are same."}, {"owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1496846287, "post_id": 44414981, "comment_id": 75830399, "body": "@Variatus Yes, you&#39;re right. I corrected that, thank you."}, {"owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1496846358, "post_id": 44414981, "comment_id": 75830449, "body": "@ManishChristian Yes, you were right. Now everything was corrected and it&#39;s working, thank you."}], "answers": [{"comments": [{"owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "edited": false, "score": 0, "creation_date": 1496845304, "post_id": 44415242, "comment_id": 75829548, "body": "It still doesn&#39;t work... I edited the question with the highlighted part."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "edited": false, "score": 0, "creation_date": 1496845501, "post_id": 44415242, "comment_id": 75829685, "body": "So if you replace all your <code>Worksheets(&quot;CONSULTA&quot;)...</code> statements in your code with my answer - do you still get that error?"}, {"owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "edited": false, "score": 0, "creation_date": 1496845585, "post_id": 44415242, "comment_id": 75829756, "body": "Yes, I did this in the first place."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "edited": false, "score": 0, "creation_date": 1496845918, "post_id": 44415242, "comment_id": 75830076, "body": "Are the textboxes actually called <code>Dia</code>, <code>Mes</code> and <code>Ano</code> ?"}, {"owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "edited": false, "score": 0, "creation_date": 1496846222, "post_id": 44415242, "comment_id": 75830336, "body": "I&#39;m sorry, it&#39;s working perfectly, thank you! I don&#39;t know what happened, I re-opened the file and everything was fine."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "edited": false, "score": 0, "creation_date": 1496846544, "post_id": 44415242, "comment_id": 75830590, "body": "++ With what Robin suggested it has to work :D Reopening the file will never fix these kind of issues. @paulinhax"}, {"owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496846692, "post_id": 44415242, "comment_id": 75830703, "body": "@SiddharthRout No, I mean... I tried Robin solution and I didn&#39;t know why was not working out, so I close everything and open again and everything was fine."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "edited": false, "score": 0, "creation_date": 1496846760, "post_id": 44415242, "comment_id": 75830772, "body": "ah ok... :D @paulinhax"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1496845054, "creation_date": 1496845054, "answer_id": 44415242, "question_id": 44414981, "link": "https://stackoverflow.com/questions/44414981/excel-concatenate-values-from-userform/44415242#44415242", "title": "excel: concatenate values from userform", "body": "<p>If you want to set the formula of <code>K23</code> to <code>=\"&gt;\"&amp;DATE(2017,6,8)</code> then you would code:</p>\n\n<pre><code>Worksheets(\"CONSULTA\").Range(\"K23\").Formula = \"=\"\"&gt;\"\"&amp;DATE(\" &amp; CompData.Ano.Value &amp; \",\" &amp; CompData.Mes.Value &amp; \",\" &amp; CompData.Dia.Value &amp; \")\"\n</code></pre>\n\n<p>Note the double <code>\"\"</code> where you want to include a <code>\"</code> within a string.</p>\n"}], "owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 44415242, "answer_count": 1, "score": 1, "last_activity_date": 1496845252, "creation_date": 1496844415, "last_edit_date": 1496845252, "question_id": 44414981, "link": "https://stackoverflow.com/questions/44414981/excel-concatenate-values-from-userform", "title": "excel: concatenate values from userform", "body": "<p>I have this UserForm called <code>CompData</code> and it seems like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/L3kmz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L3kmz.png\" alt=\"enter image description here\"></a></p>\n\n<p>The main objective of this form is to update a cell in the CONSULTA sheet with this string <code>=\"&gt;\" &amp; DATE(year, month, day)</code> (or variations) where the values of DATE and the correct math symbol come from the form.</p>\n\n<p>In the \"Inserir\" (it's my insert button) I associated this code:</p>\n\n<pre><code>Private Sub Inserir_Click()\n\nIf Maior.Value = True Then\n\n    Worksheets(\"CONSULTA\").Range(\"K23\") = \"=\" &gt; \" &amp; DATE(CompData.Ano.Value, CompData.Mes.Value, CompData.Dia.Value)\"\n\nElseIf Maior.Value = True Then\n\n    Worksheets(\"CONSULTA\").Range(\"K23\") = \"=\" &lt; \" &amp; DATE(CompData.Ano.Value, CompData.Mes.Value, CompData.Dia.Value)\"\n\nElseIf MaiorIgual.Value = True Then\n\n    Worksheets(\"CONSULTA\").Range(\"K23\") = \"=\" &gt;= \" &amp; DATE(CompData.Ano.Value, CompData.Mes.Value, CompData.Dia.Value)\"\n\nElseIf MenorIgual.Value = True Then\n\n    Worksheets(\"CONSULTA\").Range(\"K23\") = \"=\" &lt;= \" &amp; DATE(CompData.Ano.Value, CompData.Mes.Value, CompData.Dia.Value)\"\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Maior, Menor, MaiorIgual and MenorIgual are the names of my option buttons.</p>\n\n<p>Anyway, when I run the code, it gives me:</p>\n\n<blockquote>\n  <p>Run-time error 461:\n  Method or data member not found</p>\n</blockquote>\n\n<p>And highlights this part:</p>\n\n<pre><code>Private Sub Inserir_Click()\n</code></pre>\n\n<p>I know that exists a <code>CONCATENATE</code> function, but I don't think it will work on my VBA  code.</p>\n\n<p>I don't know if I'm concatenating it right, but I really don't know how to fix this.</p>\n"}, {"tags": ["vba", "ms-access", "listbox", "concatenation"], "answers": [{"comments": [{"owner": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "edited": false, "score": 0, "creation_date": 1496847329, "post_id": 44415164, "comment_id": 75831236, "body": "Thanks Andre. I&#39;ve c/p your syntax but it doesn&#39;t work either. I&#39;ve added a couple of pictures to the post hoping it would make things clearer."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "edited": false, "score": 0, "creation_date": 1496847653, "post_id": 44415164, "comment_id": 75831484, "body": "Oh, this is in a macro. <code>.Column()</code> might not be available there. I suggest you convert this macro to VBA and we&#39;ll see if that works. It should become a <code>Docmd.FindRecord</code> command. @Barbara"}, {"owner": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "edited": false, "score": 0, "creation_date": 1496848415, "post_id": 44415164, "comment_id": 75832069, "body": "Do you know where I can look out for an example and where I would place the code? I know literally nothing about VBA. Btw, I&#39;ve replaced the default code with just =&quot;[nOrdine] = &quot; &amp; &quot;&#39;&quot; &amp; [Screen].[ActiveControl].[Column](0) &amp; &quot;&#39;&quot; so I guess &quot;column&quot; is available somehow, I just don&#39;t know how to make it work. :p"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1496844849, "creation_date": 1496844849, "answer_id": 44415164, "question_id": 44414965, "link": "https://stackoverflow.com/questions/44414965/access-listbox-search-for-more-than-one-field/44415164#44415164", "title": "Access listbox - Search for more than one field", "body": "<p>Not sure where you use the expression you are building, but the <code>AND</code> must be part of the string.</p>\n\n<pre><code>=\"[workOrder] = '\" &amp; [Screen].[ActiveControl].[Column](0) &amp; \"' AND [partNumber] = '\" &amp; [Screen].[ActiveControl].[Column](1) &amp; \"'\"\n</code></pre>\n\n<p>If <code>workOrder</code> is a number column, remove the <code>''</code> around the first part.</p>\n\n<p>Note how the syntax coloring is showing what is part of the string and what is not.</p>\n"}], "owner": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496847144, "creation_date": 1496844367, "last_edit_date": 1496847144, "question_id": 44414965, "link": "https://stackoverflow.com/questions/44414965/access-listbox-search-for-more-than-one-field", "title": "Access listbox - Search for more than one field", "body": "<p>I have a listbox on a form that searches for different records. \nI need to modify the after update event macro so that the Where Condition matches 2 fields in the same record. In this case both the work order and the part number.</p>\n\n<pre><code>WO  | PN\n----|-----\n123 | red\n123 | green\n123 | blue\n456 | red\n456 | yellow\n</code></pre>\n\n<p>The default access code is:</p>\n\n<pre><code>=\"[workOrder] = \" &amp; \"'\" &amp; [Screen].[ActiveControl] &amp; \"'\"\n</code></pre>\n\n<p>so right now it matches only the first column (work order).</p>\n\n<p>I want to modify this listbox to search for both [workOrder] and another text field called [partNumber].</p>\n\n<p>I've tried:</p>\n\n<pre><code>=\"[workOrder] = \" &amp; \"'\" &amp; [Screen].[ActiveControl].[Column](0) &amp; \"'\" AND \"[partNumber] = \" &amp; \"'\" &amp; [Screen].[ActiveControl].[Column](1) &amp; \"'\"\n</code></pre>\n\n<p>but it doesn't work. Found <a href=\"https://access-programmers.co.uk/forums/showthread.php?t=290067\" rel=\"nofollow noreferrer\">this</a> but it doesn't work either.</p>\n\n<p>edited to add details:</p>\n\n<p>The main form: see how the work order matches the selection on the left but the part number doesn't.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CXTGN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CXTGN.png\" alt=\"enter image description here\"></a></p>\n\n<p>The macro in the after update event of the listbox with the default code created by the access wizard. (CercaRecord = FindRecord)</p>\n\n<p><a href=\"https://i.stack.imgur.com/dw3tF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dw3tF.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "combobox"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1496846320, "post_id": 44414898, "comment_id": 75830425, "body": "Well aside from you not being 100% clear about what you&#39;re looking to do - combo boxes are generally used for displaying present data. care to elaborate on what exactly you need?"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1496851855, "last_edit_date": 1496851855, "creation_date": 1496851375, "answer_id": 44417693, "question_id": 44414898, "link": "https://stackoverflow.com/questions/44414898/ms-access-setup-combobox-to-allow-input-of-data-not-in-the-tables/44417693#44417693", "title": "MS Access - setup combobox to allow input of data not in the tables", "body": "<p>That's what I have done. Wanted to allow free entry but still assist the user if value already exists. </p>\n\n<p>One option is to use the data table as source for the combobox RowSource. Set the combobox LimitToList property to No. Then the combobox RowSource would be like:</p>\n\n<p><code>SELECT DISTINCT fieldname FROM tablename WHERE NOT fieldname IS NULL ORDER BY fieldname;</code></p>\n\n<p>However, if you want a new value to be available for next record for a continuous or datasheet form, the record must be committed to table and then requery the combobox. Record is committed when: 1. close table/query/form; or 2. move to another record; or 3. run code to save. So code in the form Current event like:\n<code>Me.comboboxname.Requery</code></p>\n\n<p>Another option is to have lookup table for the combobox RowSource and set the comobobox LimitToList property to Yes. Then code in the combobox NotInList event to allow new value input by user to be saved to lookup table. Review: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff845736.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff845736.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8126074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3838e119dbb075a1e7e23cfb0f8e4d41?s=128&d=identicon&r=PG&f=1", "display_name": "Busi", "link": "https://stackoverflow.com/users/8126074/busi"}, "is_accepted": false, "score": 0, "last_activity_date": 1497012378, "creation_date": 1497012378, "answer_id": 44458228, "question_id": 44414898, "link": "https://stackoverflow.com/questions/44414898/ms-access-setup-combobox-to-allow-input-of-data-not-in-the-tables/44458228#44458228", "title": "MS Access - setup combobox to allow input of data not in the tables", "body": "<p>Apologies for not being clear... i have however managed to fix this by pointing  the row source to a table. This has allowed me to be able to do a selection on existing entries on the table and also \"allow\" adding new data using the same combobox. </p>\n\n<p>thanks. </p>\n"}], "owner": {"reputation": 1, "user_id": 8126074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3838e119dbb075a1e7e23cfb0f8e4d41?s=128&d=identicon&r=PG&f=1", "display_name": "Busi", "link": "https://stackoverflow.com/users/8126074/busi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1497012378, "creation_date": 1496844201, "question_id": 44414898, "link": "https://stackoverflow.com/questions/44414898/ms-access-setup-combobox-to-allow-input-of-data-not-in-the-tables", "title": "MS Access - setup combobox to allow input of data not in the tables", "body": "<p>I need help with MS Access 2010.</p>\n\n<p>One of the client's requirement is they need to be able to input new data and also be able to have a drop down list of the data existing in the table for selecting using a combobox. Im very new to MS Access, only managed to work around it using online tutorials. Im not too clued up with VBA coding. I have tried swicthng around the properties components, still not working. </p>\n\n<p>please assist.\nthanks  </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1496913284, "post_id": 44414857, "comment_id": 75860513, "body": "if 10 controls have no data, you can&#39;t put the focus on all 10 of them. Finish your loop with coloring it and then just before exit set focus to the first or last control."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 3182198, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8db44b341082517335c38aa765ec38de?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/3182198/mark"}, "edited": false, "score": 0, "creation_date": 1496935845, "post_id": 44416567, "comment_id": 75877395, "body": "Hi Krish, I managed to resolve this myself but I cannot answer my posts yet because of some restrictions, I am not sure how to get these restrictions lifted. I would like to post my code that I wrote! so that it may help others if they have a similar situation, Basically i passed the tab control and form to another function and if the color of that control was red then I alliterated the page number and set focus to page and the control that needed data."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1496848372, "creation_date": 1496848372, "answer_id": 44416567, "question_id": 44414857, "link": "https://stackoverflow.com/questions/44414857/how-do-i-programatically-find-the-exact-place-of-a-control-on-a-form-page/44416567#44416567", "title": "How do i programatically find the exact place of a control on a form/page", "body": "<p>You have to call SetFocus twice: once to set the focus to the subform (on the main form), and once to set the focus to the control on the subform.</p>\n"}], "owner": {"reputation": 89, "user_id": 3182198, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8db44b341082517335c38aa765ec38de?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/3182198/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496848372, "creation_date": 1496844109, "last_edit_date": 1496845103, "question_id": 44414857, "link": "https://stackoverflow.com/questions/44414857/how-do-i-programatically-find-the-exact-place-of-a-control-on-a-form-page", "title": "How do i programatically find the exact place of a control on a form/page", "body": "<pre class=\"lang-vb prettyprint-override\"><code>Function RequiredFieldsMissing(frm As Form) As Boolean\nDim foundEmpty As Boolean\nDim txt As TextBox\nDim cmb As ComboBox\nDim pge As Page\nDim Ctrl As Control\nDim formName As String`\n\n    foundEmpty = False\n    formName = frm.Name\n    For Each Ctrl In frm.Controls\n        If Len(Ctrl.Name) &gt; 6 Then\n            If left(Ctrl.Name, 3) = \"txt\" And right(Ctrl.Name, 3) = \"Req\" Then\n                Set txt = Ctrl\n                If IsNull(txt.value) Then\n                    foundEmpty = True\n                    txt.BackColor = constLngRed\n                    'Form_Clients.TabClientData.Pages(1).SetFocus\n                    txt.SetFocus\n                Else\n                    If Len(txt.value) = 0 Then\n                        foundEmpty = True\n                        txt.BackColor = constLngRed\n                    End If\n                End If\n            End If\n            If left(Ctrl.Name, 3) = \"cmb\" And right(Ctrl.Name, 3) = \"Req\" Then\n                Set cmb = Ctrl\n                If IsNull(cmb.value) Then\n                    foundEmpty = True\n                    cmb.BackColor = constLngRed\n                Else\n                    If Len(cmb.value) = 0 Then\n                        foundEmpty = True\n                        cmb.BackColor = constLngRed\n                    End If\n                End If\n            End If\n        End If\n    Next Ctrl\n\n    RequiredFieldsMissing = foundEmpty\nEnd Function\n</code></pre>\n\n<p>The function above will colour and highlight the control that does not have data...the problem is that i need to set focus to the control but sometimes the control resides on a sub form and on a page.\nIf i do txt.setfocus, then it will set focus to that control but not move to the residing page. Also the only variable I pass is the form.</p>\n\n<p>My question is as follows...</p>\n\n<p>How can i set focus to that control that resides on a page when i only pass the form name?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 2, "creation_date": 1496843945, "post_id": 44414482, "comment_id": 75828393, "body": "There are no events for opening or closing tables in VBA."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1496847699, "post_id": 44414482, "comment_id": 75831517, "body": "You could use the <code>Workbook_BeforeClose</code> event. From your question: <code>On the close of the table (or workbook),</code>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1496852263, "post_id": 44414482, "comment_id": 75834627, "body": "Users should not interact directly with tables and queries, only forms and reports. Forms and reports have Open and Close events."}], "answers": [{"tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": false, "score": 0, "last_activity_date": 1496853002, "creation_date": 1496853002, "answer_id": 44418209, "question_id": 44414482, "link": "https://stackoverflow.com/questions/44414482/running-macro-on-close-of-table/44418209#44418209", "title": "Running Macro on Close of Table", "body": "<p>One approach would be to 'wrap' your table in a form.  Then you can respond to the Close event and do whatever logic you need.</p>\n\n<pre><code>Private Sub Form_Close()\n   'put your code here to change the status\nEnd Sub\n</code></pre>\n\n<p>How would you do this?  Here are some steps to get you started:</p>\n\n<ol>\n<li>Create a form and set the Default View to Datasheet</li>\n<li>Set the Record Source to your table</li>\n<li>Create the Event as shown above</li>\n</ol>\n"}], "owner": {"reputation": 485, "user_id": 7169895, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zJNlL.png?s=128&g=1", "display_name": "David Frick", "link": "https://stackoverflow.com/users/7169895/david-frick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496853002, "creation_date": 1496843178, "question_id": 44414482, "link": "https://stackoverflow.com/questions/44414482/running-macro-on-close-of-table", "title": "Running Macro on Close of Table", "body": "<p>I did not see any questions of this sort, so I thought I'd ask. I want users to update a table where they add their name to handling an issue. On the close of the table (or workbook), I'd like a macro to run to change the status of the issue with assignees to \"In Process\".</p>\n\n<p>So, for example,</p>\n\n<pre><code>1b235d Jose \"In Process\"\n1dhjfj      \"New\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496842054, "post_id": 44413960, "comment_id": 75826955, "body": "Can you please show us what code you&#39;ve tried so far?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496842067, "post_id": 44413960, "comment_id": 75826963, "body": "The problem is very well stated. But still, you need to show some code that you have tried with a comprehensive description of the encountered problem."}, {"owner": {"reputation": 13, "user_id": 8125620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf0b77eaf8de3e7cff3f0da8481e9119?s=128&d=identicon&r=PG&f=1", "display_name": "A317", "link": "https://stackoverflow.com/users/8125620/a317"}, "edited": false, "score": 0, "creation_date": 1496850715, "post_id": 44413960, "comment_id": 75833647, "body": "Thank you for your answers. I added my dead end below."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8125620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf0b77eaf8de3e7cff3f0da8481e9119?s=128&d=identicon&r=PG&f=1", "display_name": "A317", "link": "https://stackoverflow.com/users/8125620/a317"}, "edited": false, "score": 1, "creation_date": 1496923378, "post_id": 44421906, "comment_id": 75867529, "body": "Thank you! Eventually I&#39;d managed to solve my problem myself by tweaking my original code minutes before I&#39;ve seen your answer, but that&#39;s so clean. Works faster and doesn&#39;t need any additional columns. Thank you for that new perspective!"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1496876942, "last_edit_date": 1496876942, "creation_date": 1496866119, "answer_id": 44421906, "question_id": 44413960, "link": "https://stackoverflow.com/questions/44413960/excel-vba-copy-and-divide-rows-based-on-date-time-criteria/44421906#44421906", "title": "Excel VBA: copy and divide rows based on date/time criteria", "body": "<p>You can try this macro to split the rows by shift. Uses only columns A-C without using your additional helper columns. It can handles durations that can span many days, because it handles the dates and calculates the shifts precisely using a dedicated function (see the utility function <code>shifEnd</code> below).</p>\n\n<pre><code>Sub SplitShifts()\n  Application.ScreenUpdating = False: Application.EnableEvents = False\n  On Error GoTo Cleanup\n\n  Dim r As Range: Set r = Sheet1.Range(\"A2:F2\")\n  Do Until Len(Trim(r(1))) = 0 ' loop until row is empty\n    If shiftEnd(r(2)) &gt;= r(3) Then\n      Set r = r.Offset(1) ' no split needed, next row\n    Else ' insert new row and split shifts\n      r.Copy: r.Insert Shift:=xlDown\n      r(2) = shiftEnd(r(2))\n      r(0, 3) = r(2)\n    End If\n  Loop\n\nCleanup:\n  Application.ScreenUpdating = True: Application.EnableEvents = True: Application.CutCopyMode = False\nEnd Sub\n\nFunction shiftEnd(ByVal d As Date) As Date\n  Select Case Hour(d)\n    Case 0 To 6: shiftEnd = Int(d) + TimeSerial(7, 0, 0)\n    Case 7 To 14: shiftEnd = Int(d) + TimeSerial(15, 0, 0)\n    Case 15 To 22: shiftEnd = Int(d) + TimeSerial(23, 0, 0)\n    Case 23: shiftEnd = Int(d) + 1 + TimeSerial(7, 0, 0) ' Next day 7:00\n  End Select\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>Testing</strong></p>\n\n<pre><code>Event   Start date      End date\nA       5/18/17 4:30    5/18/17 21:18\nB       5/20/17 18:54   5/22/17 2:06\nC       5/22/17 11:42   5/23/17 6:54\nD       5/25/17 16:30   5/26/17 6:54\nE       5/26/17 4:30    5/26/17 18:54\nF       5/27/17 4:30    5/28/17 14:06\nG       5/30/17 16:30   5/31/17 23:42\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/yePJG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yePJG.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 8125620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf0b77eaf8de3e7cff3f0da8481e9119?s=128&d=identicon&r=PG&f=1", "display_name": "A317", "link": "https://stackoverflow.com/users/8125620/a317"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 44421906, "answer_count": 1, "score": 0, "last_activity_date": 1496908049, "creation_date": 1496841825, "last_edit_date": 1496908049, "question_id": 44413960, "link": "https://stackoverflow.com/questions/44413960/excel-vba-copy-and-divide-rows-based-on-date-time-criteria", "title": "Excel VBA: copy and divide rows based on date/time criteria", "body": "<p>I am trying to transform a file with a log of operations in a three-shift production environment to be able to group them by shifts (const 7-15, 15-23, 23-7), i.e. if both the start date/time and the end date/time of the record are not within the same shift then duplicate the row below and change the original end date/time and duplicated end date/time to the corresponding shift end.</p>\n\n<pre><code>Event   Start date/time    End date/time      Shift Start    Shift End\nA       18/05/2017 4:30    18/05/2017 11:45   Mid (23-7)     Day (7-15)\n</code></pre>\n\n<p><em>transforming to:</em></p>\n\n<pre><code>Event   Start date/time    End date/time      Shift Start    Shift End\nA       18/05/2017 4:30    18/05/2017 7:00    Mid (23-7)     Mid (23-7)\nA       18/05/2017 7:00    18/05/2017 11:45   Day (7-15)     Day (7-15)\n</code></pre>\n\n<hr>\n\n<p>Unfortunately I am not good enough with VBA, so at the beginning I was trying to solve that using solely excel formulas, and added a column that shows how many shifts the event lasted (what is equal to the X number of rows that have to be doubled), that may be helpful with iterations.</p>\n\n<pre><code>Event    Start date/time    End date/time     Shift Start    Shift End    X\nA        18/05/2017 4:30    18/05/2017 23:30  Mid (23-7)     Mid (23-7)   3\n</code></pre>\n\n<p><em>Logic behind:</em>                 </p>\n\n<pre><code>Event    Start date/time    End date/time     Shift Start    Shift End    X\nA        18/05/2017 4:30    18/05/2017 7:00   Mid (23-7)     Mid (23-7)   \"\"\nA        18/05/2017 7:00    18/05/2017 23:30  Day (7-15)     Mid (23-7)   2\n</code></pre>\n\n<p><em>expected result:</em>                  </p>\n\n<pre><code>Event    Start date/time    End date/time     Shift Start    Shift End    X\nA        18/05/2017 4:30    18/05/2017 7:00   Mid (23-7)     Mid (23-7)   \"\"\nA        18/05/2017 7:00    18/05/2017 15:00  Day (7-15)     Day (7-15)   \"\"\nA        18/05/2017 15:00   18/05/2017 23:00  Aft (15-23)    Aft (15-23)  \"\"\nA        18/05/2017 23:00   18/05/2017 23:30  Mid (23-7)     Mid (23-7)   \"\"\n</code></pre>\n\n<p>I\u2019ve been trying to solve that for hours sourcing the internet, and eventually I have only been able to duplicate the row X-number of times below leaving column F blank, but I feel like it\u2019s a dead end. Any assistance would be appreciated!</p>\n\n<p>Thanks!</p>\n\n<p><strong>EDIT</strong></p>\n\n<pre><code>Sub duplicate()\nDim lngRow As Long, copyRows As Integer\n\nApplication.ScreenUpdating = False\nlngRow = 2 '1. header\nDo Until IsEmpty(Range(\"A\" &amp; lngRow))\n    If Range(\"F\" &amp; lngRow).Value &gt;= 1 Then 'check if the row should be duplicate\n        copyRows = Range(\"F\" &amp; lngRow).Value\n        Range(\"F\" &amp; lngRow + 1 &amp; \":F\" &amp; lngRow + copyRows).EntireRow.Insert\n        Range(\"A\" &amp; lngRow &amp; \":F\" &amp; (lngRow + copyRows)).FillDown 'was just testing the code. here I think I should work on cells and defined const. do I need an array to solve that problem?\n        Range(\"F\" &amp; lngRow &amp; \":F\" &amp; (lngRow + copyRows)).Value = \"\"\n        lngRow = lngRow + copyRows\n    End If\n    lngRow = lngRow + 1\nLoop\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT 2</strong> <em>this is my first code I have ever written, sorry for any mistakes. I know it's not the cleanest code, but I try my best.</em></p>\n\n<pre><code>Sub duplicate2()\nDim lngRow As Long, copyRows As Integer\n\nApplication.ScreenUpdating = False\nlngRow = 2 '1. header\nDo Until IsEmpty(Range(\"A\" &amp; lngRow))\n    If Range(\"F\" &amp; lngRow).Value &gt;= 1 Then 'check if the row should be duplicated\n        copyRows = Range(\"F\" &amp; lngRow).Value 'ok\n        Range(\"F\" &amp; lngRow + 1 &amp; \":F\" &amp; lngRow + 1).EntireRow.Insert 'insert a row below\n        Range(\"F\" &amp; lngRow + 1 &amp; \":F\" &amp; lngRow + 1).Value = copyRows - 1 'decrease X by 1\n        Range(\"F\" &amp; lngRow &amp; \":F\" &amp; lngRow).Value = \"\" 'clean original X\n        Range(\"A\" &amp; lngRow + 1 &amp; \":E\" &amp; lngRow + 1).FillDown 'duplicate row\n\n        'here I should work on cells and defined const. do I need an array to solve that problem?\n\n    End If\n    lngRow = lngRow + 1\nLoop\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub duplicate()\nDim lngRow As Long, copyRows As Integer\n\nApplication.ScreenUpdating = False\nlngRow = 2 '1. header\nDo Until IsEmpty(Range(\"A\" &amp; lngRow))\n    If Range(\"F\" &amp; lngRow).Value &gt;= 1 Then 'check if the row should be duplicate\n        copyRows = Range(\"F\" &amp; lngRow).Value\n        Range(\"F\" &amp; lngRow + 1 &amp; \":F\" &amp; lngRow + copyRows).EntireRow.Insert\n        Range(\"A\" &amp; lngRow &amp; \":F\" &amp; (lngRow + copyRows)).FillDown 'was just testing the code. here I think I should work on cells and defined const. do I need an array to solve that problem?\n        Range(\"F\" &amp; lngRow &amp; \":F\" &amp; (lngRow + copyRows)).Value = \"\"\n        lngRow = lngRow + copyRows\n    End If\n    lngRow = lngRow + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1496842943, "post_id": 44413947, "comment_id": 75827615, "body": "Not sure of your specific problem, but you can avoid creating the table by having a temporary table pre-made that you just empty before populating with data from Excel (<code>DELETE * FROM TestTable</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1500481905, "last_edit_date": 1500481905, "creation_date": 1496849139, "answer_id": 44416857, "question_id": 44413947, "link": "https://stackoverflow.com/questions/44413947/currentproject-vs-currentdb/44416857#44416857", "title": "CurrentProject vs CurrentDb", "body": "<p>IIRC, <code>CurrentDb.Execute</code> supports a different ANSI SQL standard, I think ANSI 89, although I could be wrong. <code>CurrentProject.Connection.Execute</code> supports ANSI 92, which allows that statement to execute correctly. It's a different spec of the SQL language. If you've ever used or will use SQL server this becomes obvious pretty quickly.</p>\n\n<p>You should notice that your SQL statement won't work either trying to run it as a plain SQL query either. To run this successfully as a query, one option is to enable ANSI 92 as it isn't enabled by default in Access. See below for the relevant option to toggle.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WwhUr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WwhUr.jpg\" alt=\"Setting in Access for ANSI 92\"></a></p>\n\n<p>That being said, changing the SQL standard may be less than ideal if you are familiar with Access' SQL syntax, however it might be very helpful if you already have experience with SQL Server. Also worth noting, changing the ANSI option in Access won't change how <code>CurrentDB.Execute</code> runs executes SQL statements in VBA, you'll still need the current approach, or running a stored query.</p>\n"}], "owner": {"reputation": 3, "user_id": 7685468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2b1f7221ac59e2aa8eb78f0c32bd3f?s=128&d=identicon&r=PG&f=1", "display_name": "ntuni", "link": "https://stackoverflow.com/users/7685468/ntuni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 390, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500481905, "creation_date": 1496841804, "question_id": 44413947, "link": "https://stackoverflow.com/questions/44413947/currentproject-vs-currentdb", "title": "CurrentProject vs CurrentDb", "body": "<p>I'm new to VBA and very new to SQL so I don't quite understand why I am having this problem. I'm trying to import excel files into an access database. For a few reasons I have to store my excel data into an array and then upload that array into a temporary table and then append the pertinent parts of the table. To my current understanding, the best way to get my data from my array into a new temporary table would be to create that table and then populate it row by row using SQL. My problem is that when I try to create the table, I get an error. I've simplified my code, I believe this contains what you need to know.</p>\n\n<pre><code>Dim strSQL As String\nstrSQL = \"CREATE TABLE TestTable (`Value` VARCHAR(20))\"\nCurrentDb.Execute strSQL\n</code></pre>\n\n<p>This works fine</p>\n\n<pre><code>Dim strSQL As String\nstrSQL = \"CREATE TABLE TestTable (`Value` DECIMAL(4,2))\"\nCurrentDb.Execute strSQL\n</code></pre>\n\n<p>This results in run-time error 3292 \"Syntax error in field definition\"</p>\n\n<pre><code>Dim strSQL As String\nstrSQL = \"CREATE TABLE TestTable (`Value` DECIMAL(4,2))\"\nCurrentProject.Connection.Execute strSQL\n</code></pre>\n\n<p>This works fine</p>\n\n<p>Is there a reason why I should ever use one over the other? Simply changing to CurrentProject seems to fix any problems I have but I just want to understand what is happening here. I have done my own research but any answer I find goes over my head (again, I am relatively new to VBA). I apologize in advance, there may be no answer that I am currently able to comprehend</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496848274, "post_id": 44413301, "comment_id": 75831953, "body": "I suggest always to use <code>Worksheets</code> instead of <code>Sheets</code> unless sheets is really needed. The worksheets collection only contains worksheets but the sheets collection also contains charts etc. Therefore your code <code>Sheets(s).Range</code> would fail if the workbook contains a chart, because a chart doesn&#39;t have a range object."}], "tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": true, "score": 0, "last_activity_date": 1496840150, "creation_date": 1496840150, "answer_id": 44413301, "question_id": 44413047, "link": "https://stackoverflow.com/questions/44413047/formatting-macro-doesnt-work-on-all-worksheets/44413301#44413301", "title": "Formatting Macro doesnt work on all worksheets", "body": "<p>When you select all the sheets like that the code has no way to determine which sheet you want the code to run on (though your approach is logical VBA just doesn't work like that, in fact nearly all programming languages require you to specify the object you want to use), so it uses the first in the selection. </p>\n\n<p>Use a <a href=\"http://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">for loop</a> to move through the sheets. Also, you don't need to select something to act on it and you can use a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264723.aspx\" rel=\"nofollow noreferrer\">With block</a> to shorten the code a bit:</p>\n\n<pre><code>For s = 1 To Sheets.Count\n\n    With Sheets(s).Range(Cells(100, 2), Cells(142, MarketRangeColumn + 10))\n        .Style = \"Comma\"\n        .NumberFormat = \"_(* #,##0.0_);_(* (#,##0.0);_(* \"\"-\"\"??_);_(@_)\"\n        .NumberFormat = \"_(* #,##0_);_(* (#,##0);_(* \"\"-\"\"??_);_(@_)\"\n    End With\n\n    Sheets(s).Range(Cells(143, 2), Cells(146, MarketRangeColumn + 10)).Style = \"Percent\"\n\nNext s\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7167728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62704ec783dcfb13446e5ea660366d16?s=128&d=identicon&r=PG&f=1", "display_name": "noob_coder", "link": "https://stackoverflow.com/users/7167728/noob-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 44413301, "answer_count": 1, "score": 0, "last_activity_date": 1496844606, "creation_date": 1496839551, "last_edit_date": 1496844606, "question_id": 44413047, "link": "https://stackoverflow.com/questions/44413047/formatting-macro-doesnt-work-on-all-worksheets", "title": "Formatting Macro doesnt work on all worksheets", "body": "<p>Below is part of my code that deals with formatting the output generated. So, to put it concisely, my macro pulls data from various sources, compares them and generates statistics like Market variance and catch-up etc. in multiple worksheets. What I need it to do is a format a range of cells as \"Percentage\" in all worksheets. What's happening is that the formatting only applies itself in the first worksheet generated and not in the subsequent worksheets. The part of code that formats into \"comma\" works fine on all sheets but not percentage.\nI'm not really sure what the problem is. I've tried tweaking but with no success. I'm really pressed for time and need this to work as soon as possible, so I apologize in advance if this question exists already.\nPFB code snippet:</p>\n\n<pre><code>ActiveWorkbook.Sheets.Select\nRange(Cells(100, 2), Cells(142, MarketRangeColumn + 10)).Select\nSelection.Style = \"Comma\"\nSelection.numberformat = \"_(* #,##0.0_);_(* (#,##0.0);_(* \"\"-\"\"??_);_(@_)\"\nSelection.numberformat = \"_(* #,##0_);_(* (#,##0);_(* \"\"-\"\"??_);_(@_)\"\nRange(Cells(143, 2), Cells(146, MarketRangeColumn + 10)).Select\nSelection.Style = \"Percent\"\n</code></pre>\n\n<p>Thanks in advance guys!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1496839697, "post_id": 44412973, "comment_id": 75825026, "body": "???? <a href=\"https://stackoverflow.com/questions/44410667/vba-code-that-finds-first-row-in-column-with-integers-and-stores-rownum-as-varia\" title=\"vba code that finds first row in column with integers and stores rownum as varia\">stackoverflow.com/questions/44410667/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1496839795, "post_id": 44412973, "comment_id": 75825110, "body": "aha sorry I am still confused!"}], "answers": [{"comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496842273, "post_id": 44413954, "comment_id": 75827109, "body": "The test loop will only find the last cell with a number in a continuous range, it will not find the last cell with a number in <code>Range(&quot;J7:J100&quot;)</code> if there are error or string values in between the first and last cell with a number."}, {"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1496843263, "post_id": 44413954, "comment_id": 75827845, "body": "Hi @JonWittmer thank you very much for the help.  I am still a tad confused as I will be using this macro on different workbooks and the StartRow will change depending on where the first integer is in that column (the column is likely to stay the same).  Would you be able to help me create a variable for this?"}, {"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496843336, "post_id": 44413954, "comment_id": 75827887, "body": "@RikSportel thank you, there are no error messages between the first and last integer"}, {"owner": {"reputation": 33, "user_id": 6431850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e0fbc7cabdcb6115bcb92f30ac0940?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Wittmer", "link": "https://stackoverflow.com/users/6431850/jon-wittmer"}, "reply_to_user": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1496843496, "post_id": 44413954, "comment_id": 75828011, "body": "@Y.Ono Use the code you provided to find the StartRow each time you run the macro. Put that before the code I provided inside the same procedure."}, {"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1496888955, "post_id": 44413954, "comment_id": 75849662, "body": "@JonWittmer  the following line of code keeps on returning &#39;Application or Object Defined Error&#39;  &#39;StartRow = Range(&quot;J7:J100&quot;).SpecialCells(xlCellTypeConstants, xlNumbers).Cells(1, 1).Row&#39;"}, {"owner": {"reputation": 33, "user_id": 6431850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e0fbc7cabdcb6115bcb92f30ac0940?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Wittmer", "link": "https://stackoverflow.com/users/6431850/jon-wittmer"}, "reply_to_user": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1497009638, "post_id": 44413954, "comment_id": 75910713, "body": "@Y.Ono That line works fine for me. Are you sure there is a cell with a number in the specified range? A less elegant solution would be to modify the original loop I gave you to look for the cell with a number in it."}, {"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1497432917, "post_id": 44413954, "comment_id": 76072349, "body": "There is a number but it starts from cell J45 onwards, However I won&#39;t the startcell across wrkbooks. @riksportel is this what you meant when you said it had to be a continuous range?"}], "tags": [], "owner": {"reputation": 33, "user_id": 6431850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e0fbc7cabdcb6115bcb92f30ac0940?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Wittmer", "link": "https://stackoverflow.com/users/6431850/jon-wittmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1496843315, "last_edit_date": 1496843315, "creation_date": 1496841816, "answer_id": 44413954, "question_id": 44412973, "link": "https://stackoverflow.com/questions/44412973/variable-for-rownum-of-first-and-last-integer-in-a-column-and-creating-a-range-b/44413954#44413954", "title": "Variable for RowNum of first and last integer in a column and creating a range between the 2", "body": "<p>First, you should use:</p>\n\n<pre><code>Set JRange = sht.Range(sht.Cells(StartRow,10),sht.Cells(LastRow,10))\n</code></pre>\n\n<p>Second, don't use the <code>Set</code> keyword with <code>Integer</code> or other value types. The <code>Set</code> keyword is only for use with objects. If you are not familiar with object vs. value types, you should do some research on that. Here are some Excel VBA examples:</p>\n\n<pre><code>Dim i     As Integer\nDim j     As Double\ndim str   as String\nDim coll  As Collection\ndim sht   As Worksheet\ndim rng   As Range\n\ni = 1\nj = 2.4\nstr = \"This is a string of text, also a value type\"\nSet coll = ThisWorkbook.Sheets    'Note that ThisWorkbook.Sheets is a Collection\nSet sht = coll(1)    'sets sht to the first Sheet in coll\nSet rng = sht.Range(\"A1\")\n</code></pre>\n\n<p>If you just care whether a number is in the cell and not necessarily an integer, you can do something like this</p>\n\n<pre><code>'Use Double instead of Integer because the possible range of values is larger. \n'This reduces risk of error\nDim LastRow     As Double  \nDim UpperLimit  As Double \n\n'Assuming you already have StartRow\nLastRow = StartRow + 1\n\n'Use UpperLimit to ensure you don't go into an infinite loop\n'Set UpperLimit to an appropriately high value\nUpperLimit = 100000\n\n'Test Loop\nDo While IsNumeric(sht.Cells(LastRow,10).Value) and LastRow &lt;= UpperLimit\n    LastRow = LastRow + 1\nLoop\n\n'Check if it exceeded upper limit\nIf LastRow &gt; UpperLimit Then\n    MsgBox \"Exceeded Limit\"\n    Exit Sub\nEnd If\n\nLastRow = LastRow - 1    'Because the sht.Cells(LastRow,10).value is non-numeric\n\n'Now set ranges\n</code></pre>\n\n<p>If you care whether it is actually an integer, you can use the above code, but put a conditional statement inside the loop to test whether the number is indeed an integer. There are many resources on the web that give code for determining whether value is an integer.</p>\n\n<p>Also, you should make sure you set the <code>sht</code> variable before you use it.</p>\n\n<pre><code>Set sht = ThisWorkbook.Sheets(1)\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Set sht = ThisWorkbook.Sheets(\"MySheetName\")\n</code></pre>\n\n<p>Hope this helps.</p>\n\n<p>EDIT:\nIf the range is not continuous with integers, reverse the loop:</p>\n\n<pre><code>LastRow = UpperLimit\nDo Until IsNumeric(sht.Cells(lastRow,10).Value)) Or LastRow = StartRow\n    LastRow = LastRow - 1\nLoop\n</code></pre>\n\n<p>If you do this, remove the <code>LastRow = LastRow-1</code> from the end of the code as the value you are looking for is already in LastRow.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1496845630, "post_id": 44414610, "comment_id": 75829805, "body": "Thank you for the help.  I will read up on what you suggested. I get &quot;Application or object defined error&quot; on the following line of code   StartRow = Range(&quot;J7:J100&quot;).SpecialCells(xlCellTypeConstants, xlNumbers).Cells(1, 1).Row"}, {"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1496847150, "post_id": 44414610, "comment_id": 75831091, "body": "many thanks for the help, for some reason that line of code still comes up with an error message.... not quite sure what is wrong with it"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1496847361, "post_id": 44414610, "comment_id": 75831264, "body": "Do you actually have the sheet on which you wish to check column J activated when you run the code? And are there any numbers in range J7:J100? If there aren&#39;t any, you won&#39;t get anything returned and you&#39;ll receive an error."}, {"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1496847857, "post_id": 44414610, "comment_id": 75831648, "body": "Yes I have the sheet open and there are percentages in row J but not in all of the cells in the range J7:J100,  I just picked J7 as one of the first empty cells in column J to look down from to find the first integer"}, {"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1497433100, "post_id": 44414610, "comment_id": 76072500, "body": "The code works when there is a value in J7. However I will not know which row the values start in over differing spreadsheets.  Is there anyway I can edit the code to take into account this.  I just need to find the first cell with a value in in row J.  In this case it is J45... but again, It will change."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1497434125, "post_id": 44414610, "comment_id": 76073278, "body": "Change the range to J:J"}, {"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1497438675, "post_id": 44414610, "comment_id": 76076627, "body": "I still get the error message &quot;application-defined or object defined error&quot;.  It works when I put a figure in J7 but as soon as I take it out it will not run. Strange!"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1497442999, "post_id": 44414610, "comment_id": 76079907, "body": "Does it happen to be a 1004 error? If the macro doesn&#39;t find any cells of the specified type it will throw this error. Since it doesn&#39;t find any cells, it cannot set the <code>StartRow</code> variable. There needs to be at least one numeric value indeed. If there are cases in which this doesn&#39;t apply, you&#39;d have to code around that."}, {"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1497491375, "post_id": 44414610, "comment_id": 76104744, "body": "Understood.  It is exactly a 1004 error.  However I do have integers in cells J46 - J245, so surely the code should still run seeing as I used &quot;J:J&quot;"}, {"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1497492153, "post_id": 44414610, "comment_id": 76104926, "body": "I changed the code so I am not looping and so I can run through the code.  It seems as though the following line is the problem:         With .SeriesCollection.NewSeries             .Values = JRange             .XValues = DRange"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1497509543, "post_id": 44414610, "comment_id": 76110283, "body": "That&#39;s a new question."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1496845753, "last_edit_date": 1496845753, "creation_date": 1496843482, "answer_id": 44414610, "question_id": 44412973, "link": "https://stackoverflow.com/questions/44412973/variable-for-rownum-of-first-and-last-integer-in-a-column-and-creating-a-range-b/44414610#44414610", "title": "Variable for RowNum of first and last integer in a column and creating a range between the 2", "body": "<p>There's a bunch of issues with your code:\n<code>Set StartRow</code> - You only use <code>Set</code> when you're creating an object.\nAlso there's an issue with referencing the cells. There are a bunch of different ways to do this, I suggest to read up on this.</p>\n\n<p>The following will take the first row with a number and the last row with a number, even if there are Non-number values in between. It will run on the currently active sheet.</p>\n\n<pre><code>Sub test()\nDim StartRow As Integer\nDim LastRow As Integer\n\nDim JRange As Range\nDim DRange As Range\nDim RangeForLoop As Range\n\nStartRow = Range(\"J7:J100\").SpecialCells(xlCellTypeConstants, xlNumbers).Cells(1, 1).Row\nFor Each RangeForLoop In Range(\"J7:J100\").SpecialCells(xlCellTypeConstants, xlNumbers).Cells\n    LastRow = RangeForLoop.Row\nNext RangeForLoop\n\nSet JRange = Range(\"J\" &amp; StartRow &amp; \":J\" &amp; LastRow)\nSet DRange = Range(\"D\" &amp; StartRow &amp; \":D\" &amp; LastRow)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1496845753, "creation_date": 1496839386, "question_id": 44412973, "link": "https://stackoverflow.com/questions/44412973/variable-for-rownum-of-first-and-last-integer-in-a-column-and-creating-a-range-b", "title": "Variable for RowNum of first and last integer in a column and creating a range between the 2", "body": "<p>I want to create two variables, one for the row number of the first integer in column J  and one for the last integer in column J (after this there are many rows of #N A N A).  I then would like to use these two points to create a range for column J but also for column D (using the same variables) \nI just started using vba earlier this week, understand the simplicity and I have found similar answers elsewhere but none quite so specific.  Any help would be much appreciated.  What I have so far:</p>\n\n<pre><code>Dim StartRow As Integer\nDim sht As Worksheet\nDim LastRow As Integer\nDim JRange As Range\nDim DRange As Range\n\nSet StartRow = Range(\"j7:j100\").SpecialCells(xlCellTypeConstants, xlNumbers).Cells(1, 1).Row\nLastNonRow = sht.Cells(sht.Rows.Count, 8).End(xlUp).Row (I fear this includes the #N A N A rows too)\n\nSet JRange = sht.Range(StartRow,10,sht.Cells(LastRow,10))\nSet DRange = sht.Range(StartRow,4,sht.Cells(LastRow,4))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496839509, "post_id": 44412652, "comment_id": 75824891, "body": "If the value in column A is not empty or &quot;SELECT ONE&quot;, before the workbook is closed, it should generate a pop-up if one of column B:I is not populated, correct?"}, {"owner": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496840902, "post_id": 44412652, "comment_id": 75826007, "body": "correct Rik, with the exception of Select One, I have a ADD, Delete, and other in the drop downbox"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496841386, "post_id": 44413244, "comment_id": 75826413, "body": "thank you for the information, I added the code. I am a newcomer to VBA, that I did was right click on the sheet, view code, paste the code, I changed &quot;SheetToCheck&quot; to &quot;Sheet1&quot;, did I follow the correct procedures. Nothing is happening when I attempt to save????"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496841449, "post_id": 44413244, "comment_id": 75826473, "body": "You should open the visual basic editor (ALT+F11), double click on &quot;ThisWorkbook&quot; and paste the code there."}, {"owner": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496842365, "post_id": 44413244, "comment_id": 75827183, "body": "Rik, I am did ALT+F11, the window opened but I don&#39;t see anything with &quot;ThisWorkbook&quot; to double click on?     I do see a dropdown for this worksheet."}, {"owner": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496842587, "post_id": 44413244, "comment_id": 75827355, "body": "eureka i found it, THANKS RIK"}, {"owner": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496843305, "post_id": 44413244, "comment_id": 75827869, "body": "Rik Sportel The code is working, with the exception of : I entered the required fields but the missing data popup will not allow me to save."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496843646, "post_id": 44413244, "comment_id": 75828141, "body": "How did you alter it? The reference in  <code>For Each CellToCheck In .Range(&quot;B&quot; &amp; i &amp; &quot;:I&quot; &amp; i)</code> will basically say &quot;B2:I2&quot; - If you need column L instead of I change it to <code>...&amp; &quot;:L&quot; &amp; i)</code> You might actually be validating cells you do not wish to validate - if column i doesn&#39;t require values and it&#39;s up to H, then change that i to H."}, {"owner": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496844300, "post_id": 44413244, "comment_id": 75828692, "body": "Rik the only modification I made was the sheet information. I was looking in my book for setting ranges (the cell range I need is B11:K11) and so on B12:K12 etc.."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496845204, "post_id": 44413244, "comment_id": 75829469, "body": "See edited answer. It will now check each row, each cell column B to K."}, {"owner": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496845749, "post_id": 44413244, "comment_id": 75829911, "body": "will merged cells cause a problem I am getting &quot;missing data in cell$D$2)"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496845836, "post_id": 44413244, "comment_id": 75829994, "body": "Merged cells are the work of satan. Yes, they can cause problems."}, {"owner": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496846249, "post_id": 44413244, "comment_id": 75830370, "body": "LOL, I am unmerging the cells to see if the problem persist, (still not working) how can I skip the cell that are merged which are  C,D,E,F (columns)  from my initial post snapshot of my form which are &quot;To Termini From&quot;  I rather skip those columns"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "edited": false, "score": 0, "creation_date": 1496846706, "post_id": 44413244, "comment_id": 75830721, "body": "Just check each cell in <code>Range(&quot;B&quot; &amp; i &amp; &quot;,G&quot; &amp; i &amp; &quot;:K&quot; &amp; i)</code> (So columns B and G until K) - Please read up on cell referencing in VBA, since these are already different questions."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1496845157, "last_edit_date": 1496845157, "creation_date": 1496840023, "answer_id": 44413244, "question_id": 44412652, "link": "https://stackoverflow.com/questions/44412652/vba-coed-mandatory-fields-based-off-of-specific-data/44413244#44413244", "title": "VBA coed mandatory fields based off of specific data", "body": "<p>This should do it. Set \"SheetToCheck\" to the sheet you wish to Check.\nIt will stop looping as soon as it has found a missing value and the MsgBox will give the 1st Range where it found a missing value.</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim ws As Worksheet\n    Dim lastrow As Integer\n    Dim CellToCheck As Range\n    Dim exitLoops As Boolean\n    Set ws = Worksheets(\"SheetToCheck\")\n\n    lastrow = ws.UsedRange.Rows.Count\n    exitLoops = False\n\n    With ws\n        'Loop over rows:\n        For i = 2 To lastrow\n            If exitLoops = True Then Exit For\n\n            If .Range(\"A\" &amp; i).value &lt;&gt; \"\" And .Range(\"A\" &amp; i).value &lt;&gt; \"SELECT ONE\" Then\n\n                'Loop over cells in row:\n                For Each CellToCheck In .Range(\"B\" &amp; i &amp; \":K\" &amp; i)\n                    If exitLoops = True Then Exit For\n                    If CellToCheck.value = \"\" Then\n                        Cancel = True\n                        MsgBox \"Missing Data in cell \" &amp; CellToCheck.Address\n                        exitLoops = True\n                    End If\n                Next CellToCheck\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8125546, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e-MJAlcvjso/AAAAAAAAAAI/AAAAAAAAAFs/plpcPyP-BE0/photo.jpg?sz=128", "display_name": "Babb Babb", "link": "https://stackoverflow.com/users/8125546/babb-babb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1496845157, "creation_date": 1496838572, "last_edit_date": 1531164843, "question_id": 44412652, "link": "https://stackoverflow.com/questions/44412652/vba-coed-mandatory-fields-based-off-of-specific-data", "title": "VBA coed mandatory fields based off of specific data", "body": "<p>I have created a form using Excel in column A11 I have a dropdown box with three options.  If one of these options are selected the entire row is required.  I have searched everywhere and cant find the right code. I am new to using VBA</p>\n\n<p><img src=\"https://i.stack.imgur.com/t3m4K.jpg\" alt=\"enter image description here\"></p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n     Dim rsave As Range\n     Dim cell As Range\n\n     Set rsave = Sheet1.Range(\"B11)]\")\n\n     For Each cell In rsave\n\n          If cell.Value &lt;&gt; \"\" And cell.Offset(0, 1).Value = \"\" Then\n\n          Dim missdata\n          missdata = MsgBox(\"Missing Data - Enter the Date for WorkBook to Save\", vbOKOnly, \"Missing Data\")\n          Cancel = True\n          cell.Offset(0, 1).Select\n\n      Exit For\n\n      End If\n\n      Next cell\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "ssas", "pivot-grid", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1496841879, "post_id": 44412263, "comment_id": 75826833, "body": "You can have a look at the MSDN site to see what events are available for pivot tables: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198138.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff198138.aspx</a>"}, {"owner": {"reputation": 13, "user_id": 5814472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3085d820bf97636ab1153d76dca10222?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Ponkratenko", "link": "https://stackoverflow.com/users/5814472/dmitry-ponkratenko"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1496846373, "post_id": 44412263, "comment_id": 75830466, "body": "already did it, but problem isn&#39;t in finding event to be fired (it fires), but determine fact of clearing cell contents (press delete, or paste empty value). PivotGrid, in contrast to regular cell, don&#39;t clear value in this case, just discard any unapproved changes.  i need override this logic."}], "owner": {"reputation": 13, "user_id": 5814472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3085d820bf97636ab1153d76dca10222?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Ponkratenko", "link": "https://stackoverflow.com/users/5814472/dmitry-ponkratenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496837404, "creation_date": 1496837404, "last_edit_date": 1531161705, "question_id": 44412263, "link": "https://stackoverflow.com/questions/44412263/determine-clear-value-event-in-pivottableaftervaluechange", "title": "determine clear value event in PivotTableAfterValueChange", "body": "<p>I have an excel pivotgrid (connected to writeback enabled SSAS cube).</p>\n\n<p>When i clear contents (select range &amp; press DEL) of cells it fires PivotTableAfterValueChange event, but Value property of affected cells stil contained old value.</p>\n\n<p>Moreover, CellChanged property stays xlCellNotChanged.</p>\n\n<p>Is there any way to determine such clear event, to override existing behaviour?</p>\n"}, {"tags": ["c#", "vba", "excel"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1496841091, "post_id": 44412140, "comment_id": 75826174, "body": "What line do you get the error on?"}, {"owner": {"reputation": 101, "user_id": 6445386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17e02afe95f464237be6c4937295cea8?s=128&d=identicon&r=PG&f=1", "display_name": "Zhang", "link": "https://stackoverflow.com/users/6445386/zhang"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1496841264, "post_id": 44412140, "comment_id": 75826317, "body": "On excel.excel_run(&quot;Macro1&quot;);  excel_run is just a method that contains this.excelApp.Run(macro);"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496844673, "post_id": 44412140, "comment_id": 75829021, "body": "Error 13 Type Mismatch is native to VBA. I suspect there&#39;s some type mismatch between a value in the excel file and the variable in Macro1 that this value is being parsed into. I don&#39;t see anything wrong with your C# code."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496846369, "post_id": 44412140, "comment_id": 75830460, "body": "Can you share what is in <code>Macro1</code>?"}, {"owner": {"reputation": 101, "user_id": 6445386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17e02afe95f464237be6c4937295cea8?s=128&d=identicon&r=PG&f=1", "display_name": "Zhang", "link": "https://stackoverflow.com/users/6445386/zhang"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496848347, "post_id": 44412140, "comment_id": 75832008, "body": "@SiddharthRout Sorry, I can&#39;t really share it... I edited my question with one line from Macro1 (where I get the error). I hope there are no errors after this one."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496848419, "post_id": 44412140, "comment_id": 75832076, "body": "The code you shared is good enough :) <code>HB = Worksheets(&quot;INPUT_DATA&quot;).Range(&quot;H_B_souflage&quot;) &#47; 1000: HB = HB &#47; NF</code> How is <code>HB</code> Declared?"}, {"owner": {"reputation": 101, "user_id": 6445386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17e02afe95f464237be6c4937295cea8?s=128&d=identicon&r=PG&f=1", "display_name": "Zhang", "link": "https://stackoverflow.com/users/6445386/zhang"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496849311, "post_id": 44412140, "comment_id": 75832696, "body": "@SiddharthRout Sorry, took me some time to look at it (very new to VBA) and I asked my tutor, he said HB is not declared... Btw, what does &#39;:&#39; means in VBA, he doesn&#39;t know either"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496849979, "post_id": 44412140, "comment_id": 75833153, "body": "<code>1</code> &quot;:&quot; is used when you want to put two or more lines of code in one line <code>2</code>: You will get a <code>Error 13 Type Mismatch</code> when the variable or property isn&#39;t of the correct type. For example, a variable that requires an integer value can&#39;t accept a string value unless the whole string can be recognized as an integer."}, {"owner": {"reputation": 101, "user_id": 6445386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17e02afe95f464237be6c4937295cea8?s=128&d=identicon&r=PG&f=1", "display_name": "Zhang", "link": "https://stackoverflow.com/users/6445386/zhang"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496908392, "post_id": 44412140, "comment_id": 75857430, "body": "@SiddharthRout I get it now I guess. So since HB is not declared before, HB takes the type when it is initialized, just like variable in... JavaScript ? I tried to replace <code>Worksheets(&quot;INPUT_DATA&quot;).Range(&quot;H_B_souflage&quot;)</code> by its value (2000) and It works (I get test4). But that doesn&#39;t explain why with the old method it works without changing the VBA code."}, {"owner": {"reputation": 101, "user_id": 6445386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17e02afe95f464237be6c4937295cea8?s=128&d=identicon&r=PG&f=1", "display_name": "Zhang", "link": "https://stackoverflow.com/users/6445386/zhang"}, "edited": false, "score": 0, "creation_date": 1496908718, "post_id": 44412140, "comment_id": 75857613, "body": "Also, by removing <code>&#47;1000</code> it works too. So I&#39;m guessing <code>Worksheets(&quot;INPUT_DATA&quot;).Range(&quot;H_B_souflage&quot;)</code> returns something that can&#39;t be cast to a integer. But again that doesn&#39;t explain why it works before..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496912296, "post_id": 44412140, "comment_id": 75859858, "body": "Are you 100% sure that <code>HB</code> has not been declared as <code>Integer?</code> Declare it s <code>Long</code> or <code>Double</code>. Also see what does the value <code>Worksheets(&quot;INPUT_DATA&quot;).Range(&quot;H_B_souflage&quot;)</code> returns? Ideally the line should be written as  <code>HB = Val(Worksheets(&quot;INPUT_DATA&quot;).Range(&quot;H_B_souflage&quot;).Value) &#47; 1000</code>"}, {"owner": {"reputation": 101, "user_id": 6445386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17e02afe95f464237be6c4937295cea8?s=128&d=identicon&r=PG&f=1", "display_name": "Zhang", "link": "https://stackoverflow.com/users/6445386/zhang"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496913845, "post_id": 44412140, "comment_id": 75860904, "body": "@SiddharthRout You need the key word <code>Dim HB As type</code>right? I searched in the entire code and it is not here. <code>Worksheets(&quot;INPUT_DATA&quot;).Range(&quot;H_B_souflage&quot;)</code> returns 2000 (in fact the cell <code>H_B_souflage</code> is equal to a function that takes one parameter and returns an integer value. I can put the code for this function if it may help. Also, I tried what you said and I still get the same error at the same line."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496920853, "post_id": 44412140, "comment_id": 75865653, "body": "Do this split <code>HB = Worksheets(&quot;INPUT_DATA&quot;).Range(&quot;H_B_souflage&quot;) &#47; 1000: HB = HB &#47; NF</code> in two lines <code>HB = Worksheets(&quot;INPUT_DATA&quot;).Range(&quot;H_B_souflage&quot;) &#47; 1000</code> and then in the next line <code>HB = HB &#47; NF</code> NOw can you tell me which line is giving the error?"}, {"owner": {"reputation": 101, "user_id": 6445386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17e02afe95f464237be6c4937295cea8?s=128&d=identicon&r=PG&f=1", "display_name": "Zhang", "link": "https://stackoverflow.com/users/6445386/zhang"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496921457, "post_id": 44412140, "comment_id": 75866072, "body": "@SiddharthRout Yes, this is what I was doing. And the error comes from the first line. But when I replace ` Worksheets(&quot;INPUT_DATA&quot;).Range(&quot;H_B_souflage&quot;)` by its value from the cell ( 2000) I have <code>HB = 2000 &#47; 1000</code> then I have no error and <code>HB &#47; NF</code>works too."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496921552, "post_id": 44412140, "comment_id": 75866141, "body": "<code>I can put the code for this function if it may help</code> I would love that :D"}, {"owner": {"reputation": 101, "user_id": 6445386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17e02afe95f464237be6c4937295cea8?s=128&d=identicon&r=PG&f=1", "display_name": "Zhang", "link": "https://stackoverflow.com/users/6445386/zhang"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496921772, "post_id": 44412140, "comment_id": 75866301, "body": "@SiddharthRout When I run the macro manually from the Excel calculation file (without user&#39;s date; with default data) it works without problem. So, after the <code>copy()</code> I saved the Excel file and ran the macro manually (instead of during it in C#) again and this time I got the error 13. But when I replace the problematic cell with the same value (I just rewrite it) and run the macro manually, this time it works (I don&#39;t know if I&#39;m clear...)"}, {"owner": {"reputation": 101, "user_id": 6445386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17e02afe95f464237be6c4937295cea8?s=128&d=identicon&r=PG&f=1", "display_name": "Zhang", "link": "https://stackoverflow.com/users/6445386/zhang"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1496925084, "post_id": 44412140, "comment_id": 75868769, "body": "@SiddharthRout LOL since rewriting the value makes the macro to work... I change a little bit my Calculation1 method. After copying data from user&#39;s file to calculation file, I add <code>string val = excel.excel_getvalue(&quot;E&quot;, 7);</code> and <code>excel.excel_setvalue(&quot;E&quot;, 7, val);</code> before calling the macro and it works... I still don&#39;t know why, guess magic. Thank you, by talking to you it helped me very much :)"}], "owner": {"reputation": 101, "user_id": 6445386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17e02afe95f464237be6c4937295cea8?s=128&d=identicon&r=PG&f=1", "display_name": "Zhang", "link": "https://stackoverflow.com/users/6445386/zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496923208, "creation_date": 1496837021, "last_edit_date": 1496923208, "question_id": 44412140, "link": "https://stackoverflow.com/questions/44412140/c-excel-macro-error-13-type-mismatch-after-copying-data-from-one-worksheet-to-a", "title": "c# Excel macro error 13 type mismatch after copying data from one worksheet to another", "body": "<p>I am currently working on a web application where users can download an Excel file, fill the file with their data, upload the file and start some calculation.<br>\nTo do so, the old method was to open user's file and to copy all the data in an array of string then open the Excel calculation file where the macro is and paste the date. It works....<br>\nNow, Instead of during that, I use the method Copy().</p>\n\n<pre><code>public class ExcelCtrl\n    {\n        private Excel.Application excelApp = null;\n        private Excel.Workbook srcworkbook = null;\n        private Excel.Workbook destworkbook = null;\n\npublic void excel_init(String srcpath, String destpath)\n    {\n        //Open Excel\n        this.excelApp = new Excel.Application();\n        //Open user's file\n        this.srcworkbook = excelApp.Workbooks.Open(srcpath);\n        Excel.Worksheet srcworksheet = (Excel.Worksheet)srcworkbook.Worksheets.get_Item(1);\n\n        //Open calculation file\n        this.destworkbook = excelApp.Workbooks.Open(destpath);\n        Excel.Worksheet destworksheet = (Excel.Worksheet)destworkbook.Worksheets.get_Item(1);\n\n        //Range of copy\n        Excel.Range from = srcworksheet.get_Range(\"A1:Z100\");\n        Excel.Range to = destworksheet.get_Range(\"A1:Z100\");\n\n        //Copy\n        from.Copy(to);\n\n        //Close user's file\n        srcworkbook.Close();\n\n        //Open Xla file\n        excelApp.Workbooks.Open(\"someXlaFile.xla\");\n        excelApp.Workbooks.Open(\"AnotherXlaFile.xla\");  \n    }\n</code></pre>\n\n<p>And I use it like this :</p>\n\n<pre><code>public static string Calculation1(String InputFileName, String CurDir)\n    {\n        //The Excel calculation file and its path\n        string filename = \"CalculationFile.xls\";\n        string path_server = ExcelCtrl.DossierCalcs + filename;\n\n        ExcelCtrl excel = new ExcelCtrl();\n\n        excel.excel_init(CurDir + \"\\\\\" + InputFileName, ExcelCtrl.DossierCalcs + filename);\n\n        //Run the macro : where the problem is\n        excel.excel_run(\"Macro1\");\n\n        //The rest is not important\n        path_server = CurDir + \"\\\\Resultats - \" + InputFileName;\n\n        excel.excel_run(\"AnotherMacro\", path_server);\n\n        excel.excel_close();\n\n        return path_server;\n</code></pre>\n\n<p>So I got an error 13: Type mismatch when I run Macro1 ( I did not put the code for excel_run(), it is just a simple method that calls Application.run()).<br>\nI use this code for other calculations and all work fine except this one. Of course, Macro change from one Excel calculation file to another but it works before with the copy paste method and I dont think I should change the VBA code.  </p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Thanks to the mighty printf I think I know where is the problem...</p>\n\n<pre><code>2450 If W0 = 1 Then GoTo 2470 Else\nMsgBox (\"test3\")\nHB = Worksheets(\"INPUT_DATA\").Range(\"H_B_souflage\") / 1000: HB = HB / NF\nMsgBox (\"test4\")\n</code></pre>\n\n<p>The original code is like that : </p>\n\n<pre><code>2450 If W0 = 1 Then GoTo 2470 Else: HB = Worksheets(\"INPUT_DATA\").Range(\"H_B_souflage\") / 1000: HB = HB / NF\n</code></pre>\n\n<p>I just split it after the Else.<br>\nWhen I run Macro1, I have test3 then error 13.</p>\n\n<p>Below is the original method, maybe it can help.</p>\n\n<pre><code>public static string Calculation1(String InputFileName, String CurDir)\n{\n        //the string used to store the date\n        string[] my_input_array = new string[21];\n\n        //Open user's file\n        ExcelCtrl.excel_init(CurDir + \"\\\\\" + InputFileName);\n        //Call the method to initialize the array\n        my_input_array = file_input_copy(my_input_array);\n        ExcelCtrl.excel_close();\n\n        //Open calculation file\n        ExcelCtrl.excel_init(path_server);\n        //Call the method to paste the data to the calculation file\n        file_input_write(my_input_array);\n\n        //run macro : the same as above\n        ExcelCtrl.appExcel.Run(\"macro1\");\n\n        //the rest is not important\n        path_server = CurDir + \"\\\\Resultats - \" + InputFileName; \n        ExcelCtrl.appExcel.Run(\"AnotherMacro\", path_server);\n        ExcelCtrl.excel_close();\n        return path_server;\n</code></pre>\n\n<p>You may notice that excel_init is different (it was a static class before) but I dont think that the problem come from this class.</p>\n\n<p>The code to initialize the array string :<br>\nSorry if you have to read a lot of code. I think this two method below are not very important, just a classic while loop. But I want to put it here because of the method : convert.toDouble()</p>\n\n<pre><code>    private static string[] file_input_copy(string[] my_input_array)\n    {\n        int i = 0;\n        int row = 5;\n        string str = \"E\" + row;\n\n        while (i &lt; my_input_array.Length)\n        {\n            str = \"E\" + row;\n            my_input_array[i] = ExcelCtrl.excel_getValue(str);\n            //excel_getValue is just a method that return get_Range(cellname).get_Value().ToString()\n            row++;\n            if (row == 23)\n                row++;\n            i++;\n        }\n        return my_input_array;\n    }\n</code></pre>\n\n<p>And the code to paste : </p>\n\n<pre><code>    private static void file_input_write(string[] my_input_array)\n    {\n        Excel.Range aRange;\n        int i = 0;\n        int row = 5;\n        string str = \"E\" + row;\n\n        while (i &lt; my_input_array.Length)\n        {\n            str = \"E\" + row;\n            aRange = ExcelCtrl.objsheet.get_Range(str, str);\n            try\n            {\n                aRange.Value2 = Convert.ToDouble(my_input_array[i]);\n            }\n            catch (FormatException)\n            {\n                aRange.Value2 = my_input_array[i];\n            }\n            row++;\n            if (row == 23)\n                row++;\n            i++;\n        }\n    }\n</code></pre>\n\n<p>When I use this code to copy paste the data, it works...<br>\nWhat I don't understand is that those two methods are used in other calculations class (with a slight variation) to copy the data and when I change for what I did, it works.<br>\nMaybe those two methods are doing something copy() is not doing.</p>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>The cell H_B_souflage is equal to =Hauteur_prod(PREFmax) and PREFmax is equal to !DATA_ALL!E7. DATA_ALL is a sheet where I copy paste user's data. E7 is the problematic cell.<br>\nThe code for Hauteur_prod() : </p>\n\n<pre><code>Function Hauteur_prod(Production)\nDim prod(10), haut(10)\nFor i = 1 To 8\nprod(i) = Worksheets(\"Parameters\").Range(\"Prod_t_hm\").Cells(i)\nhaut(i) = Worksheets(\"Parameters\").Range(\"Height_m\").Cells(i)\nNext\nIf Production &gt;= prod(8) Then\nElseIf Production &gt;= prod(8) Then\nHauteur_prod = haut(8)\nElseIf Production &gt;= prod(7) Then\nHauteur_prod = haut(7)\nElseIf Production &gt;= prod(6) Then\nHauteur_prod = haut(6)\nElseIf Production &gt;= prod(5) Then\nHauteur_prod = haut(5)\nElseIf Production &gt;= prod(4) Then\nHauteur_prod = haut(4)\nElseIf Production &gt;= prod(3) Then\nHauteur_prod = haut(3)\nElseIf Production &gt;= prod(2) Then\nHauteur_prod = haut(2)\nElseIf Production &gt;= prod(1) Then\nHauteur_prod = haut(1)\nElse\nHauteur_prod = haut(1)\nEnd If\nHauteur_prod = Hauteur_prod * 1000 'mm\nEnd Function\n</code></pre>\n\n<p>Prod_t_hm and Height_m are array of integers with 8 values.</p>\n\n<p>Just like what I said in comment. The macro from Excel calculation file with default values works. When I upload the data file with my test values, for instance I put 39 inside cell E7 and use my code to copy my data to the calculation file without running the macro. Then I run manually the macro by openning my Excel file, it crashed with error 13 but after changing the cell E7 to, let's say 40, the macro works.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496839675, "post_id": 44411389, "comment_id": 75825000, "body": "You can have a look here: <a href=\"http://www.excel-university.com/vlookup-on-two-or-more-criteria-columns\" rel=\"nofollow noreferrer\">VLOOKUP on Two or More Criteria Columns</a> or you need to show what you have already tried: Therefore <a href=\"https://stackoverflow.com/posts/44411389/edit\">edit</a> your question add your VBA code and tell us where you got stuck."}, {"owner": {"reputation": 45, "user_id": 7924700, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92b18a5b8daae1e13ffaabd9eea3227b?s=128&d=identicon&r=PG&f=1", "display_name": "Divya", "link": "https://stackoverflow.com/users/7924700/divya"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496895763, "post_id": 44411389, "comment_id": 75851193, "body": "Thanks for your feedback."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496902204, "post_id": 44411389, "comment_id": 75853672, "body": "Now you just posted a function. No one knows anything about it because you didn&#39;t tell us anything. Tell us what your code does, where it fails, what you expect it to do and so on (as detailed as possible). &quot;<i>need to lookup two columns</i>&quot; is just not enough information. Try to post a full working <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and tell us which values the parameters of the function have. Remember we are here to help you to <i>solve your issue yourself</i> not to <i>solve the issue for you</i>."}, {"owner": {"reputation": 45, "user_id": 7924700, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92b18a5b8daae1e13ffaabd9eea3227b?s=128&d=identicon&r=PG&f=1", "display_name": "Divya", "link": "https://stackoverflow.com/users/7924700/divya"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496903152, "post_id": 44411389, "comment_id": 75854176, "body": "By this code I can able to get the C column in Sheet1 to Sheet2 by the lookup reference Column A. It directly do the lookup function with the A (P.No.) column. Now I need to include the B column also as a input to get the C column in sheet2. It should lookup both A &amp; B. I don&#39;t know how to use the for loop for this operation."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7924700, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92b18a5b8daae1e13ffaabd9eea3227b?s=128&d=identicon&r=PG&f=1", "display_name": "Divya", "link": "https://stackoverflow.com/users/7924700/divya"}, "edited": false, "score": 0, "creation_date": 1496897051, "post_id": 44413660, "comment_id": 75851522, "body": "Thanks for your reply. If you can help me with my code I&#39;ve added now, Kindly help me."}, {"owner": {"reputation": 433, "user_id": 5502774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aba8abc7a3b79679db892c5e58267ec?s=128&d=identicon&r=PG&f=1", "display_name": "Wils Mils", "link": "https://stackoverflow.com/users/5502774/wils-mils"}, "reply_to_user": {"reputation": 45, "user_id": 7924700, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92b18a5b8daae1e13ffaabd9eea3227b?s=128&d=identicon&r=PG&f=1", "display_name": "Divya", "link": "https://stackoverflow.com/users/7924700/divya"}, "edited": false, "score": 0, "creation_date": 1496971480, "post_id": 44413660, "comment_id": 75893079, "body": "@Divya have you tried my code? I tested it using your example data and it works ok.  I suggest that you try it first and then if you have questions how it works, we can answer them for you."}], "tags": [], "owner": {"reputation": 433, "user_id": 5502774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aba8abc7a3b79679db892c5e58267ec?s=128&d=identicon&r=PG&f=1", "display_name": "Wils Mils", "link": "https://stackoverflow.com/users/5502774/wils-mils"}, "is_accepted": false, "score": 0, "last_activity_date": 1496841105, "creation_date": 1496841105, "answer_id": 44413660, "question_id": 44411389, "link": "https://stackoverflow.com/questions/44411389/need-to-lookup-2-columns-in-vba-function/44413660#44413660", "title": "Need to lookup 2 columns in VBA Function", "body": "<p>Try to use this function:</p>\n\n<pre><code>    Function LookupTwoCriteria(strPNo As String, strRev As String)\n\n      LookupTwoCriteria = Evaluate(\"=INDEX(Sheet1!C:C,MATCH(1,(Sheet1!A:A=\" &amp; _\n        strPNo &amp; \")*(Sheet1!B:B=\" &amp; strRev &amp; \"),0))\")\n\n    End Function\n</code></pre>\n\n<p>It uses array formula that tries to match two criteria: strPNo &amp; strRev.  Use this in your cell like:</p>\n\n<pre><code>    =LookupTwoCriteria(A1, B1)\n</code></pre>\n\n<p>If it does not find a match, it will exhibit #VALUE! so guard it with:</p>\n\n<pre><code>    =IFERROR(LookupTwoCriteria(A4,B4),0)\n</code></pre>\n\n<p>if you desire so.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 7924700, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92b18a5b8daae1e13ffaabd9eea3227b?s=128&d=identicon&r=PG&f=1", "display_name": "Divya", "link": "https://stackoverflow.com/users/7924700/divya"}, "edited": false, "score": 0, "creation_date": 1496913047, "post_id": 44429256, "comment_id": 75860339, "body": "Thanks for your reply. But the code returns only &quot;no recent inward&quot;. It doesn&#39;t work with 2 lookup values."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 45, "user_id": 7924700, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92b18a5b8daae1e13ffaabd9eea3227b?s=128&d=identicon&r=PG&f=1", "display_name": "Divya", "link": "https://stackoverflow.com/users/7924700/divya"}, "edited": false, "score": 0, "creation_date": 1496916662, "post_id": 44429256, "comment_id": 75862974, "body": "@Divya Please show how you call <code>SingleCellExtractInward</code> and add the expected output. I used <code>Debug.Print SingleCellExtractInward(2918, 1, Sheet1.Range(&quot;A1:C5&quot;), 3)</code> in my test and it returned <code>50</code> (using the data table of your question). And please tell if <code>REV</code> values are formatted as number with leading zero or if formatted as text?"}, {"owner": {"reputation": 45, "user_id": 7924700, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92b18a5b8daae1e13ffaabd9eea3227b?s=128&d=identicon&r=PG&f=1", "display_name": "Divya", "link": "https://stackoverflow.com/users/7924700/divya"}, "edited": false, "score": 0, "creation_date": 1497855415, "post_id": 44429256, "comment_id": 76233680, "body": "Hello Peh, Sorry for the late reply. REV values has to be in text format. I have tried the formula,          =SingleCellExtractInward(B4,D4,&#39;INWARDLIST&#39;!$B$5:$F$26,5,FAL&zwnj;&#8203;SE) .                                                                               It shows #Value error. if you find a solution, kindly help me."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 45, "user_id": 7924700, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92b18a5b8daae1e13ffaabd9eea3227b?s=128&d=identicon&r=PG&f=1", "display_name": "Divya", "link": "https://stackoverflow.com/users/7924700/divya"}, "edited": false, "score": 0, "creation_date": 1497857316, "post_id": 44429256, "comment_id": 76234803, "body": "@Divya you have 5 parameters in your formula but my function only has 4 parameters."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1496907381, "last_edit_date": 1496907381, "creation_date": 1496906802, "answer_id": 44429256, "question_id": 44411389, "link": "https://stackoverflow.com/questions/44411389/need-to-lookup-2-columns-in-vba-function/44429256#44429256", "title": "Need to lookup 2 columns in VBA Function", "body": "<ol>\n<li><p>Therefore you just need to extend your function by a second <code>lookupvalue</code>, so we have <code>lookupValueA</code> and <code>lookupValueB</code>:</p>\n\n<pre><code>Function SingleCellExtractInward(lookupValueA As String, lookupValueB As String, _\n                                 lookupRange As Range, ColumnNumber As Long)\n</code></pre>\n\n<p><em>Note that I changed <code>Integer</code> to <code>Long</code>. Always use <code>Long</code> instead of <code>Integer</code> unless you need to communicate with old APIs (<a href=\"https://stackoverflow.com/a/26409520/3219613\">see explanation here</a>).</em></p></li>\n<li><p>You need to check if both criteria are met:</p>\n\n<pre><code>If lookupRange.Cells(i, 1).Value = lookupValueA And _\n   lookupRange.Cells(i, 2).Value = lookupValueB Then\n</code></pre>\n\n<p><strong>Alternative:</strong> If you want to be able to additionally look only for one criteria A or B if the other one is empty then instead use:</p>\n\n<pre><code>If (lookupRange.Cells(i, 1).Value = lookupValueA Or lookupValueA = vbNullString) And _\n   (lookupRange.Cells(i, 2).Value = lookupValueB Or lookupValueB = vbNullString) Then\n</code></pre>\n\n<p><em>In this case you can leave one of the <code>lookupValue</code> a <code>vbNullString</code> (same as <code>\"\"</code>) and it only looks up one criteria (like your original function).</em></p></li>\n</ol>\n\n<hr>\n\n<p>The following is just improvement and removing unnecessary code that I recommend:</p>\n\n<ol>\n<li><p><code>i</code> should be <code>Long</code> not <code>Double</code>:</p>\n\n<pre><code>Dim i As Long\n</code></pre></li>\n<li><p><code>If Result2 = Empty Then</code> is always true at this point. So we don't even need <code>Result2</code>.<br>\nThe following \u2026</p>\n\n<pre><code>Dim Result2 As String\n\nIf Result2 = Empty Then\n    Result2 = \"no recent inward\"\n    SingleCellExtractInward = Result2\nEnd If\n</code></pre>\n\n<p>Can be reduced to one line \u2026</p>\n\n<pre><code>SingleCellExtractInward = \"no recent inward\"   'Default return value if nothing matches.\n</code></pre></li>\n</ol>\n\n<hr>\n\n<p>So we would end up with something like that:</p>\n\n<pre><code>Option Explicit\n\nFunction SingleCellExtractInward(lookupValueA As String, lookupValueB As String, _\n                                 lookupRange As Range, ColumnNumber As Long)\n    Dim i As Long\n    Dim Result As String\n\n    SingleCellExtractInward = \"no recent inward\"\n\n    For i = 1 To lookupRange.Columns(1).Cells.Count\n        If (lookupRange.Cells(i, 1).Value = lookupValueA Or lookupValueA = vbNullString) And _\n           (lookupRange.Cells(i, 2).Value = lookupValueB Or lookupValueB = vbNullString) Then\n            Result = Result &amp; \" \" &amp; lookupRange.Cells(i, ColumnNumber) &amp; \",\"\n            SingleCellExtractInward = Left(Result, Len(Result) - 1)\n        End If\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7924700, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92b18a5b8daae1e13ffaabd9eea3227b?s=128&d=identicon&r=PG&f=1", "display_name": "Divya", "link": "https://stackoverflow.com/users/7924700/divya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1536, "favorite_count": 0, "accepted_answer_id": 44429256, "answer_count": 2, "score": -2, "last_activity_date": 1496907775, "creation_date": 1496834854, "last_edit_date": 1531164843, "question_id": 44411389, "link": "https://stackoverflow.com/questions/44411389/need-to-lookup-2-columns-in-vba-function", "title": "Need to lookup 2 columns in VBA Function", "body": "<p>I need to use to lookup columns in from another sheet and return in a single cell VBA. My Data in Sheet1 is,</p>\n\n<pre><code>P.No.  REV   Qty \n2918   01    50   \n2918   02    44\n2919   01    72\n</code></pre>\n\n<p>In Sheet2, It should return the <code>Qty</code>, by looking both the <code>P.No.</code> and <code>REV</code> columns. Kindly help me on this.</p>\n\n<p>My code to lookup one column is below. In this I need to lookup two columns. </p>\n\n<pre><code>Function SingleCellExtractInward(lookupvalue As String, lookuprange As Range, ColumnNumber As Integer)\n    Dim i As Double\n    Dim Result1 As String\n    Dim Result2 As String\n\n    If Result2 = Empty Then\n        Result2 = \"no recent inward\"\n        SingleCellExtractInward = Result2\n    End If\n\n    For i = 1 To lookuprange.Columns(1).Cells.Count\n        If lookuprange.Cells(i, 1) = lookupvalue Then\n            Result1 = Result1 &amp; \" \" &amp; lookuprange.Cells(i, ColumnNumber) &amp; \",\"\n            SingleCellExtractInward = Left(Result1, Len(Result1) - 1)\n        End If\n    Next i\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1496834210, "post_id": 44411042, "comment_id": 75820954, "body": "Hi @Nathan, thanks for the help.  I wish to store this row number as a variable on it&#39;s own so that I can use it for the starting point in column D also.  And then create a variable for the end point of column J, which is basically the last integer in that column, and use these two variables to create a range for the values between startpoint and end point"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "edited": false, "score": 0, "creation_date": 1496834456, "post_id": 44411042, "comment_id": 75821131, "body": "You&#39;ll have a look at the properties of the specialcells, it returns a range, then look at the properties of a range, so <code>row</code> <code>cells.count</code> etc."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1496835315, "last_edit_date": 1496835315, "creation_date": 1496833862, "answer_id": 44411042, "question_id": 44410667, "link": "https://stackoverflow.com/questions/44410667/vba-code-that-finds-first-row-in-column-with-integers-and-stores-rownum-as-varia/44411042#44411042", "title": "VBA code that finds first row in column with integers and stores rownum as variable", "body": "<p><code>range(\"j7:j100\").SpecialCells(xlCellTypeConstants,xlnumbers).Cells(1,1).row</code></p>\n"}], "owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496835315, "creation_date": 1496832859, "last_edit_date": 1496833111, "question_id": 44410667, "link": "https://stackoverflow.com/questions/44410667/vba-code-that-finds-first-row-in-column-with-integers-and-stores-rownum-as-varia", "title": "VBA code that finds first row in column with integers and stores rownum as variable", "body": "<p>I know this is really simple but I am new to VBA and I really don't know what I am doing</p>\n\n<pre><code>Dim StartRow As Range\nDim Sht As Worksheet\nDim TotalRows As Long\nDim StartCell As Integer    \n\nSet StartRow = Sht.Range(\"J7\").End(xlDown)  'I just need to create a variable for the first\n' row with numerical figures in column J and then use this as a starting point for my\n' data in column D as well.\n</code></pre>\n\n<p>In the end I want VBA code that will select two ranges (one in column D and one in J) but where the starting point between the two will be the same, but it will be different across spreadsheets, hence the End(XlDown) function.  The range just needs to select all the data going down until it his the #N A N A signs.</p>\n"}, {"tags": ["vba", "colors"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8124989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771acbe8a3226f3b1e3642dae7949e6b?s=128&d=identicon&r=PG&f=1", "display_name": "pati", "link": "https://stackoverflow.com/users/8124989/pati"}, "edited": false, "score": 0, "creation_date": 1496838721, "post_id": 44410817, "comment_id": 75824347, "body": "Thats right i want to check if D1 = &quot;OW&quot; , D2 = &quot;OL&quot; and D3 = &quot;OA&quot; if yes than do no colouring and if not than colour. For excample if           D1 = &quot;OW&quot; , D2 = &quot;OL&quot; and D3 = &quot;OL&quot;. I really dont understand it because when i run the macro it colours every cell..."}, {"owner": {"reputation": 170, "user_id": 8058170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8aaeabec474615ad538294859c0cae?s=128&d=identicon&r=PG&f=1", "display_name": "Alluton", "link": "https://stackoverflow.com/users/8058170/alluton"}, "reply_to_user": {"reputation": 1, "user_id": 8124989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771acbe8a3226f3b1e3642dae7949e6b?s=128&d=identicon&r=PG&f=1", "display_name": "pati", "link": "https://stackoverflow.com/users/8124989/pati"}, "edited": false, "score": 0, "creation_date": 1496839127, "post_id": 44410817, "comment_id": 75824617, "body": "D1 = &quot;OW&quot; , D2 = &quot;OL&quot; and D3 = &quot;OL&quot;.  You are not checking for that. Your code only doesn&#39;t color when the 3 cells have OW OL and OA in that specific order."}], "tags": [], "owner": {"reputation": 170, "user_id": 8058170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8aaeabec474615ad538294859c0cae?s=128&d=identicon&r=PG&f=1", "display_name": "Alluton", "link": "https://stackoverflow.com/users/8058170/alluton"}, "is_accepted": false, "score": 0, "last_activity_date": 1496833289, "creation_date": 1496833289, "answer_id": 44410817, "question_id": 44410566, "link": "https://stackoverflow.com/questions/44410566/cell-coloring-vba-excel/44410817#44410817", "title": "Cell coloring vba excel", "body": "<pre><code>If Cells(Z, 4) = \"OW\" And Cells(Z + 1, 4) = \"OL\" And Cells(Z + 2, 4) = \"OA\"\n</code></pre>\n\n<p>Your code checks (I even tested it) if 3 consecutive cells in a column have the values \"OW\", \"OL\" and \"OA\". For example if D1 = \"OW\" , D2 = \"OL\" and D3 = \"OA\" then the cell D1 won't get colored. In every other case it will.</p>\n\n<p>If this isn't what you are looking for then try to elaborate your goal.</p>\n"}], "owner": {"reputation": 1, "user_id": 8124989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771acbe8a3226f3b1e3642dae7949e6b?s=128&d=identicon&r=PG&f=1", "display_name": "pati", "link": "https://stackoverflow.com/users/8124989/pati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496835170, "creation_date": 1496832565, "last_edit_date": 1496835170, "question_id": 44410566, "link": "https://stackoverflow.com/questions/44410566/cell-coloring-vba-excel", "title": "Cell coloring vba excel", "body": "<p>I tried to write code to colour all cells in column D which are not in the format ow,ol,od.  However my code coloured all cells, regardless of the cell value. I could need your help.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Bk1wU.jpg\" rel=\"nofollow noreferrer\">Data Column D</a></p>\n\n<pre><code>Sub colour()\n\nFor Z = 1 To ActiveSheet.UsedRange.Rows.Count\n  If Cells(Z, 4) = \"OW\" And Cells(Z + 1, 4) = \"OL\" And Cells(Z + 2, 4) = \"OA\" Then\n    Else\n    Cells(Z, 4).Interior.ColorIndex = 7\n  End If\nNext Z\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8125037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6558bb00daf63c6b79738fa904adacf8?s=128&d=identicon&r=PG&f=1", "display_name": "JamesMcS", "link": "https://stackoverflow.com/users/8125037/jamesmcs"}, "edited": false, "score": 0, "creation_date": 1496839882, "post_id": 44411702, "comment_id": 75825179, "body": "Thanks very much, I&#39;ll give this a go"}, {"owner": {"reputation": 19, "user_id": 8125037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6558bb00daf63c6b79738fa904adacf8?s=128&d=identicon&r=PG&f=1", "display_name": "JamesMcS", "link": "https://stackoverflow.com/users/8125037/jamesmcs"}, "edited": false, "score": 0, "creation_date": 1496840427, "post_id": 44411702, "comment_id": 75825620, "body": "Have just tried this, I din&#39;t know about &quot;names&quot; - but it&#39;s taking the workbook name, print area etc into the array, which is causing problems down the line. Any thoughts?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 19, "user_id": 8125037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6558bb00daf63c6b79738fa904adacf8?s=128&d=identicon&r=PG&f=1", "display_name": "JamesMcS", "link": "https://stackoverflow.com/users/8125037/jamesmcs"}, "edited": false, "score": 0, "creation_date": 1496842663, "post_id": 44411702, "comment_id": 75827411, "body": "@JamesMcS  You need to test for them......after all, <code>PrintArea</code> is a valid group of cells, just like any other user-defined Named Range !"}, {"owner": {"reputation": 17424, "user_id": 278842, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/df6877d3f05e542ca5975b4670600f2e?s=128&d=identicon&r=PG", "display_name": "Christopher Oezbek", "link": "https://stackoverflow.com/users/278842/christopher-oezbek"}, "reply_to_user": {"reputation": 19, "user_id": 8125037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6558bb00daf63c6b79738fa904adacf8?s=128&d=identicon&r=PG&f=1", "display_name": "JamesMcS", "link": "https://stackoverflow.com/users/8125037/jamesmcs"}, "edited": false, "score": 0, "creation_date": 1605564053, "post_id": 44411702, "comment_id": 114684165, "body": "@JamesMcS: Did you find any way to exclude them well? I am building a small template exporter for word using Named Ranges and it would be good to exclude built-in fields <a href=\"https://github.com/coezbek/office-automation-excel2word-document-properties\" rel=\"nofollow noreferrer\">github.com/coezbek/&hellip;</a>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1496835834, "creation_date": 1496835834, "answer_id": 44411702, "question_id": 44410511, "link": "https://stackoverflow.com/questions/44410511/read-named-range-names-into-vba-array/44411702#44411702", "title": "Read Named Range Names into VBA array", "body": "<p>Something like:</p>\n\n<pre><code>Sub listum()\n    Dim ary(1 To 3) As String\n    With ActiveWorkbook\n        If .Names.Count &gt; 0 Then\n            For i = 1 To .Names.Count\n                MsgBox (i &amp; \"  \" &amp; .Names(i).Name &amp; \"  \" &amp; Range(.Names(i)).Address)\n                ary(i) = .Names(i).Name\n            Next\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>will display them and put them into an array.</p>\n\n<p>Size the array to suit your needs.<br>Insure that there are no <em>non-Range</em> Names in the workbook.</p>\n"}, {"comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1496839211, "post_id": 44411948, "comment_id": 75824691, "body": "Though rare I have seen workbooks with more than 32767 names so best to use a Long rather than an integer. Since use of an Integer do not offer any advantage over Long I&#39;d advise to always use Long to avoid problems like this."}, {"owner": {"reputation": 19, "user_id": 8125037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6558bb00daf63c6b79738fa904adacf8?s=128&d=identicon&r=PG&f=1", "display_name": "JamesMcS", "link": "https://stackoverflow.com/users/8125037/jamesmcs"}, "edited": false, "score": 0, "creation_date": 1496839859, "post_id": 44411948, "comment_id": 75825158, "body": "Thanks very much! I&#39;ll give this a go"}, {"owner": {"reputation": 433, "user_id": 5502774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aba8abc7a3b79679db892c5e58267ec?s=128&d=identicon&r=PG&f=1", "display_name": "Wils Mils", "link": "https://stackoverflow.com/users/5502774/wils-mils"}, "reply_to_user": {"reputation": 19, "user_id": 8125037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6558bb00daf63c6b79738fa904adacf8?s=128&d=identicon&r=PG&f=1", "display_name": "JamesMcS", "link": "https://stackoverflow.com/users/8125037/jamesmcs"}, "edited": false, "score": 0, "creation_date": 1496843406, "post_id": 44411948, "comment_id": 75827942, "body": "@JamesMcS please give it an up.  I am just starting :-) thank you."}], "tags": [], "owner": {"reputation": 433, "user_id": 5502774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aba8abc7a3b79679db892c5e58267ec?s=128&d=identicon&r=PG&f=1", "display_name": "Wils Mils", "link": "https://stackoverflow.com/users/5502774/wils-mils"}, "is_accepted": false, "score": 0, "last_activity_date": 1496841226, "last_edit_date": 1496841226, "creation_date": 1496836460, "answer_id": 44411948, "question_id": 44410511, "link": "https://stackoverflow.com/questions/44410511/read-named-range-names-into-vba-array/44411948#44411948", "title": "Read Named Range Names into VBA array", "body": "<p>My version is I used dynamic array:</p>\n\n<pre><code>    Sub TestNamedRange()\n    Dim i As Long\n    Dim intCount As Long\n    Dim NameArray() As String\n    'count number of named ranges\n    intCount = ThisWorkbook.Names.Count\n    ReDim NameArray(intCount)  'for dynamic number of named ranges\n    'assign all names to each array element\n    For i = 1 To intCount\n      NameArray(i) = ThisWorkbook.Names(i).Name 'remove .Name if you want address range only\n    Next\n   'check array elements\n   For Each ele In NameArray\n     Debug.Print ele\n   Next\n  'manipulate your array here\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8125037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6558bb00daf63c6b79738fa904adacf8?s=128&d=identicon&r=PG&f=1", "display_name": "JamesMcS", "link": "https://stackoverflow.com/users/8125037/jamesmcs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1605474772, "creation_date": 1496832418, "last_edit_date": 1605474772, "question_id": 44410511, "link": "https://stackoverflow.com/questions/44410511/read-named-range-names-into-vba-array", "title": "Read Named Range Names into VBA array", "body": "<p>I'm trying to figure out how I can get the names of ranges in a given worksheet into an array. I've got as far as the listnames function but that seems to list them all in one go. Any ideas?</p>\n"}, {"tags": ["arrays", "vba", "dynamic-arrays"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1496835281, "post_id": 44410380, "comment_id": 75821735, "body": "Can you define &quot;POINT TO OTHER SET OF VALUES&quot;?  Are you trying to copy values from array 1 to array 2?  Or from the cells B2:I43 to B44:I85?"}, {"owner": {"reputation": 1, "user_id": 8124956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807f6743ae59435a6035a1b4d7d16aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Mathur", "link": "https://stackoverflow.com/users/8124956/mehul-mathur"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1496836400, "post_id": 44410380, "comment_id": 75822573, "body": "First  I want to compare B2:I43  to B44:I85 after then I want to compare B2:I43 TO B86:I127( next 42 rows) and so on. So Initially array2 range is (  B44:I85) after that array2 range is (B86:I127) and so on.."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1496909910, "post_id": 44410380, "comment_id": 75858304, "body": "So is this a case of adding an outer loop, outside of the two for..next statements?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8124956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807f6743ae59435a6035a1b4d7d16aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Mathur", "link": "https://stackoverflow.com/users/8124956/mehul-mathur"}, "edited": false, "score": 0, "creation_date": 1496833322, "post_id": 44410604, "comment_id": 75820341, "body": "I have to develop it in VBA. All I need is after completing the comparison with one array, array2 will point to another array of same size"}, {"owner": {"reputation": 1, "user_id": 8124956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807f6743ae59435a6035a1b4d7d16aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Mathur", "link": "https://stackoverflow.com/users/8124956/mehul-mathur"}, "edited": false, "score": 0, "creation_date": 1496895207, "post_id": 44410604, "comment_id": 75851064, "body": "Thank you very much for your help. It totally worked."}, {"owner": {"reputation": 1, "user_id": 8124956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807f6743ae59435a6035a1b4d7d16aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Mathur", "link": "https://stackoverflow.com/users/8124956/mehul-mathur"}, "edited": false, "score": 0, "creation_date": 1497249258, "post_id": 44410604, "comment_id": 75979043, "body": "Hello, Can you please help me in defining the dynamic row for the same code. Instead of hard coding the rows (total_rows =42) is there any way the code can take no. of rows automatically, Now I have the data with no fixed numbers of rows."}], "tags": [], "owner": {"reputation": 713, "user_id": 4715656, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/6wq0Q.jpg?s=128&g=1", "display_name": "Gowire", "link": "https://stackoverflow.com/users/4715656/gowire"}, "is_accepted": false, "score": 0, "last_activity_date": 1496840227, "last_edit_date": 1496840227, "creation_date": 1496832702, "answer_id": 44410604, "question_id": 44410380, "link": "https://stackoverflow.com/questions/44410380/array-comparision/44410604#44410604", "title": "Array Comparision", "body": "<p>Have you tried to use Conditional formatting instead? Your suggested VBA code can easily be solved with conditional formatting by comparing each cell in array2 with the same cell in array1 and use colours to mark if the cells are equal or not</p>\n\n<p><strong>Edit</strong>\nI have modified your code. Instead of using two ranges I have used an \"row offset\" for each array you have on your sheet. It then compares the cells from your source array (array1 in your code) with the cells that are found <em>next_array_offset</em> rows down. When the comparison has been made, the offset is increased with 42. The loop ends when there are no more values to be found.</p>\n\n<p>Is this what you was looking for?</p>\n\n<pre><code>Sub driver()\n    Dim r As Integer\n    Dim c As Integer\n    Dim source_row As Integer\n    Dim source_col As Integer\n    Dim total_rows As Integer\n    Dim total_cols As Integer\n    Dim next_array_offset As Integer\n\n    source_row = 2   ' row B\n    source_col = 2   ' col 2\n    total_rows = 42\n    total_cols = 8\n    next_array_offset = 42  ' distance in rows to next array\n\n    Do Until IsEmpty(Cells(source_row + next_array_offset, source_col).Value)\n        For r = 0 To total_rows - 1\n            For c = 0 To total_cols - 1\n                If Cells(source_row + r, source_col + c) = Cells(source_row + next_array_offset + r, source_col + c) Then\n                    Cells(source_row + next_array_offset + r, source_col + c).Interior.ColorIndex = 0\n                Else\n                    Cells(source_row + next_array_offset + r, source_col + c).Interior.ColorIndex = 3\n                End If\n            Next\n        Next\n        next_array_offset = next_array_offset + 42\n    Loop\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8124956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807f6743ae59435a6035a1b4d7d16aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Mathur", "link": "https://stackoverflow.com/users/8124956/mehul-mathur"}, "edited": false, "score": 0, "creation_date": 1496895249, "post_id": 44413833, "comment_id": 75851081, "body": "Thank you for your help."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1496841854, "last_edit_date": 1496841854, "creation_date": 1496841476, "answer_id": 44413833, "question_id": 44410380, "link": "https://stackoverflow.com/questions/44410380/array-comparision/44413833#44413833", "title": "Array Comparision", "body": "<p>Your main task is to define the ranges accurately. In the code below I've assumed it's every 42 rows until end of data. You simply iterate your 42-row test arrays and compare against the reference array. To do this you basically need two row variables: one for your test array and one for your reference array.</p>\n\n<p>The quickest way would be to read the test data just once into one big array and to create two ranges (one with matches and one with mis-matches) and then colour them at the end of the routine.</p>\n\n<p>I don't know your colour palette (and therefore the color indexes) so I've used the <code>.Color</code> property. You can adjust this to suit.</p>\n\n<pre><code>Const ROW_COUNT As Long = 42\nConst COL_COUNT As Long = 8\nConst START_ROW As Long = 2\nDim refArray As Variant, testArray As Variant\nDim rowSize As Long, r As Long, c As Long, i As Long\nDim cell As Range, yesRng As Range, noRng As Range\n\n'Read data into arrays\nWith Sheet1\n    'Find last row of data\n    rowSize = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n    'Adjust last row to be multiple of 42\n    rowSize = Int((rowSize - START_ROW) / ROW_COUNT) * ROW_COUNT\n\n    refArray = .Cells(START_ROW, \"B\").Resize(ROW_COUNT, COL_COUNT).Value2\n    testArray = .Cells(START_ROW + ROW_COUNT, \"B\").Resize(rowSize, COL_COUNT).Value2\nEnd With\n\n'Compare test array with reference array\ni = 1 'refArray row index\nFor r = 1 To UBound(testArray, 1)\n    For c = 1 To UBound(testArray, 2)\n        Set cell = Sheet1.Cells(r + START_ROW + ROW_COUNT - 1, c + 1)\n        If testArray(r, c) = refArray(i, c) Then\n            'It's a match so add to yes range\n            If yesRng Is Nothing Then\n                Set yesRng = cell\n            Else\n                Set yesRng = Union(yesRng, cell)\n            End If\n        Else\n            'It's a miss so add to no range\n            If noRng Is Nothing Then\n                Set noRng = cell\n            Else\n                Set noRng = Union(noRng, cell)\n            End If\n        End If\n    Next\n    'Increment ref row index or set back to 1 if at 42\n    i = IIf(i &lt; ROW_COUNT, i + 1, 1)\nNext\n\n'Colour the ranges\nIf Not yesRng Is Nothing Then yesRng.Interior.Color = vbGreen\nIf Not noRng Is Nothing Then noRng.Interior.Color = vbRed\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8124956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807f6743ae59435a6035a1b4d7d16aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Mathur", "link": "https://stackoverflow.com/users/8124956/mehul-mathur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496914602, "creation_date": 1496832023, "last_edit_date": 1496914602, "question_id": 44410380, "link": "https://stackoverflow.com/questions/44410380/array-comparision", "title": "Array Comparision", "body": "<p>I have a array with 8 columns and 42 rows B2 TO I43. I have to compare this array with other arrays in the same sheet so that every array have same values. I defined array1 Rang('B2;I43\") and need to compare every other array of same size. how to that in VBA.\nMy code is </p>\n\n<pre><code>Sub driver()\nDim array1, array2, m, n\nSet array1 = Range(\"B2,I43\")\ntotal_rows = 42\ntotal_cols = 8\nSet array2 = Range(\"B44:I85\")\n\nFor i = 1 To total_rows\nFor j = 1 To total_cols\n    If array1(i, j) = array2(i, j) Then\n    array2.Cells(i, j).Interior.ColorIndex = 0\n    ElseIf array1(i, j) &lt;&gt; array2(i, j) Then\n    array2.Cells(i, j).Interior.ColorIndex = 3   \n    End If\n    Next j\n    Next i          \nEnd Sub\n</code></pre>\n\n<p>I want <code>array2</code> to point to other set of values. Every array start after 42 rows.</p>\n"}, {"tags": ["vb.net", "vba", "office-interop", "excel-interop"], "comments": [{"owner": {"reputation": 159, "user_id": 6739798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65239314f099af94a2b28c7813497ea3?s=128&d=identicon&r=PG&f=1", "display_name": "Gulam Husain Ansari", "link": "https://stackoverflow.com/users/6739798/gulam-husain-ansari"}, "edited": false, "score": 0, "creation_date": 1496831603, "post_id": 44409918, "comment_id": 75819107, "body": "Can you share the code which you using to convert word to PDF, this will provide help to make PDF from excel as well."}, {"owner": {"reputation": 159, "user_id": 6739798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65239314f099af94a2b28c7813497ea3?s=128&d=identicon&r=PG&f=1", "display_name": "Gulam Husain Ansari", "link": "https://stackoverflow.com/users/6739798/gulam-husain-ansari"}, "edited": false, "score": 0, "creation_date": 1496838315, "post_id": 44409918, "comment_id": 75824039, "body": "Thank for code Please take solution code I have given in my answer"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3829502, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000144188185/picture?type=large", "display_name": "Adrian Ilie", "link": "https://stackoverflow.com/users/3829502/adrian-ilie"}, "edited": false, "score": 0, "creation_date": 1496843001, "post_id": 44411915, "comment_id": 75827659, "body": "This does not answer my question. It obviously exports a PDF, but I&#39;ve explicitly asked for PDF/A."}], "tags": [], "owner": {"reputation": 159, "user_id": 6739798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65239314f099af94a2b28c7813497ea3?s=128&d=identicon&r=PG&f=1", "display_name": "Gulam Husain Ansari", "link": "https://stackoverflow.com/users/6739798/gulam-husain-ansari"}, "is_accepted": false, "score": 0, "last_activity_date": 1496836387, "creation_date": 1496836387, "answer_id": 44411915, "question_id": 44409918, "link": "https://stackoverflow.com/questions/44409918/save-file-as-pdf-a-using-office-interop-excel/44411915#44411915", "title": "Save file as PDF/A using Office.Interop.Excel", "body": "<p>Use below method for converting the excel to pdf and mark as answer if it works</p>\n\n<pre><code>Public Function ExportWorkbookToPdf(ByVal workbookPath As String, ByVal outputPath As String) As Boolean\n\n    ' If either required string is null or empty, stop and bail out\n    If String.IsNullOrEmpty(workbookPath) OrElse String.IsNullOrEmpty(outputPath) Then\n        Return False\n    End If\n\n    ' Create COM Objects\n    Dim excelApplication As Microsoft.Office.Interop.Excel.Application\n    Dim excelWorkbook As Microsoft.Office.Interop.Excel.Workbook\n\n    ' Create new instance of Excel\n    excelApplication = New Microsoft.Office.Interop.Excel.Application()\n\n    ' Make the process invisible to the user\n    excelApplication.ScreenUpdating = False\n\n    ' Make the process silent\n    excelApplication.DisplayAlerts = False\n\n    ' Open the workbook that you wish to export to PDF\n    excelWorkbook = excelApplication.Workbooks.Open(workbookPath)\n\n    ' If the workbook failed to open, stop, clean up, and bail out\n    If excelWorkbook Is Nothing Then\n        excelApplication.Quit()\n\n        excelApplication = Nothing\n        excelWorkbook = Nothing\n\n        Return False\n    End If\n\n    Dim exportSuccessful = True\n    Try\n        ' Call Excel's native export function (valid in Office 2007 and Office 2010, AFAIK)\n        excelWorkbook.ExportAsFixedFormat(Microsoft.Office.Interop.Excel.XlFixedFormatType.xlTypePDF, outputPath)\n    Catch ex As System.Exception\n        ' Mark the export as failed for the return value...\n\n        ' Do something with any exceptions here, if you wish...\n        ' MessageBox.Show...        \n        exportSuccessful = False\n    Finally\n        ' Close the workbook, quit the Excel, and clean up regardless of the results...\n        excelWorkbook.Close()\n        excelApplication.Quit()\n\n        excelApplication = Nothing\n        excelWorkbook = Nothing\n    End Try\n\n    ' You can use the following method to automatically open the PDF after export if you wish\n    ' Make sure that the file actually exists first...\n    If System.IO.File.Exists(outputPath) Then\n        System.Diagnostics.Process.Start(outputPath)\n    End If\n\n    Return exportSuccessful\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 3829502, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000144188185/picture?type=large", "display_name": "Adrian Ilie", "link": "https://stackoverflow.com/users/3829502/adrian-ilie"}, "edited": false, "score": 1, "creation_date": 1497255104, "post_id": 44489554, "comment_id": 75982154, "body": "This is the only useful answer. Not pretty, as you said, but I could not find another way."}], "tags": [], "owner": {"reputation": 240, "user_id": 4245856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c406c172f93eea2e46c7a4ff6b363cd6?s=128&d=identicon&r=PG&f=1", "display_name": "BenZinra", "link": "https://stackoverflow.com/users/4245856/benzinra"}, "is_accepted": true, "score": 4, "last_activity_date": 1497222561, "creation_date": 1497222561, "answer_id": 44489554, "question_id": 44409918, "link": "https://stackoverflow.com/questions/44409918/save-file-as-pdf-a-using-office-interop-excel/44489554#44489554", "title": "Save file as PDF/A using Office.Interop.Excel", "body": "<p>Excel allows the user to choose whether or not to save the file as PDF/A in the options of the save dialog. This setting is stored in the Registry as LastISO19005-1 (REG_DWORD) under HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Common\\FixedFormat. (Replace 12.0 with the right version.) The ExportAsFixedFormat function also respects this setting. You can set this value to 1 before calling ExportAsFixedFormat to get Excel to export the file as PDF/A.</p>\n\n<p>I know this solution is not pretty as it uses global state to address a local problem. Consider restoring the previous value when you're done.</p>\n"}], "owner": {"reputation": 35, "user_id": 3829502, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000144188185/picture?type=large", "display_name": "Adrian Ilie", "link": "https://stackoverflow.com/users/3829502/adrian-ilie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3462, "favorite_count": 2, "accepted_answer_id": 44489554, "answer_count": 2, "score": 3, "last_activity_date": 1591864738, "creation_date": 1496830885, "last_edit_date": 1496842833, "question_id": 44409918, "link": "https://stackoverflow.com/questions/44409918/save-file-as-pdf-a-using-office-interop-excel", "title": "Save file as PDF/A using Office.Interop.Excel", "body": "<p>How can I export an <strong>Excel</strong> spreadsheet to PDF/<strong>A</strong> (ISO 19005-1)?</p>\n\n<p>EDIT: I'm asking for PDF/A, and <strong>not</strong> plain old PDF 1.5 as it exports by default. I've even emphasized the <strong>A</strong> in my original question.</p>\n\n<p>I can already export Word and PowerPoint documents to PDF/A, using the <code>ExportAsFixedFormat()</code> function, since the Word and PowerPoint functions both have an optional <code>UseISO19005_1</code> parameter, but the Excel version is very different, and is missing lots of parameters.</p>\n\n<p>I can't seem to find any way to export a PDF/<strong>A</strong> using the COM Interop.</p>\n\n<p>Here's the code I use to export from a docx:</p>\n\n<pre><code>Dim ExportFormat As WdExportFormat = WdExportFormat.wdExportFormatPDF\nDim OpenAfterExport As Boolean = False\nDim OptimizeFor As WdExportOptimizeFor = WdExportOptimizeFor.wdExportOptimizeForPrint\nDim Range As WdExportRange = WdExportRange.wdExportAllDocument\nDim Item As WdExportItem = WdExportItem.wdExportDocumentWithMarkup\nDim IncludeDocProps As Boolean = True\nDim KeepIRM As Boolean = False\nDim CreateBookmarks As WdExportCreateBookmarks = WdExportCreateBookmarks.wdExportCreateWordBookmarks\nDim DocStructureTags As Boolean = True\nDim BitmapMissingFonts As Boolean = True\nDim UseISO19005_1 As Boolean = False\n\nIf exportPDFA Then\n    UseISO19005_1 = True\n    Dim wordApp As New Word.Application()\n    Dim doc As Word.Document = wordApp.Documents.Open(FileName)\n    doc.ExportAsFixedFormat(pathToDestFile, ExportFormat, OpenAfterExport, OptimizeFor, Range, 0, 0, Item, IncludeDocProps, KeepIRM, CreateBookmarks, DocStructureTags, BitmapMissingFonts, UseISO19005_1)\nEnd If\n</code></pre>\n\n<p>But for xlsx, the <code>ExportAsFixedFormat()</code> function accepts very different parameters (this was taken directly from the Microsoft.Office.Interop.Excel class):</p>\n\n<pre><code>Sub ExportAsFixedFormat(Type As XlFixedFormatType, Optional Filename As Object = Nothing, Optional Quality As Object = Nothing, Optional IncludeDocProperties As Object = Nothing, Optional IgnorePrintAreas As Object = Nothing, Optional From As Object = Nothing, Optional [To] As Object = Nothing, Optional OpenAfterPublish As Object = Nothing, Optional FixedFormatExtClassPtr As Object = Nothing)\n</code></pre>\n"}, {"tags": ["vba", "excel", "class", "userform"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496831416, "post_id": 44409871, "comment_id": 75818978, "body": "<code>ComboBoxEvents.Value</code> returns the value. You could do a select case on that value and then use the second combobox <code>.addItem</code> method to add the items you need. To clear the items in the second one on forehand, use <code>.clear</code>"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496831790, "post_id": 44409871, "comment_id": 75819246, "body": "Ah I see you also declare the comboboxes in the userform with <code>Dim</code>. Use <code>Public</code> instead for the second array (Dim behaves the same as private) In that case you can access the comboboxes from your class through <code>User_form.ItemCBArr(0)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1496834892, "post_id": 44410821, "comment_id": 75821443, "body": "Thanks a lot for the answer, it works nicely. How do you make it work for an array of Combo-boxes of each type ? I have 5 <code>TriggerBox</code> and 5 <code>DependBox</code> (it will be dynamic at the end)"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1496836190, "post_id": 44410821, "comment_id": 75822395, "body": "Add an array of this custom class and pass the index 0 for each of the two boxes to index 0 in the custom class array, etc."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1496836351, "post_id": 44410821, "comment_id": 75822530, "body": "I tried, but couldn&#39;t get it to work, can you just add that section to your second code approach ?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1496837377, "post_id": 44410821, "comment_id": 75823347, "body": "See update. You&#39;ll still have to figure out some way to set the values for each of the dependent boxes of course. You could give the class a Lookup range property or something, which is then used to populate the DependBox based on the value of the TriggerBox. However - that&#39;s another question."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1496837529, "post_id": 44410821, "comment_id": 75823447, "body": "It is another question, I&#39;ll give it a tray later on. In the meantime, thanks a lot for all your help :)"}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 3, "last_activity_date": 1496837305, "last_edit_date": 1496837305, "creation_date": 1496833294, "answer_id": 44410821, "question_id": 44409871, "link": "https://stackoverflow.com/questions/44409871/dynamic-created-user-form-with-2-dependent-combo-boxes/44410821#44410821", "title": "Dynamic created User-Form, with 2 dependent Combo-Boxes", "body": "<p>Alright, here's the basics.\nYour class <strong>cCombobox</strong> I replicated as follows:</p>\n\n<pre><code>Private WithEvents ComboBoxEvents As MsForms.ComboBox\nPrivate Sub ComboBoxEvents_Change()\n    Select Case ComboBoxEvents.value\n        Case \"1\":\n            UserForm1.DependentBox.Clear\n            UserForm1.DependentBox.AddItem \"3\"\n            UserForm1.DependentBox.AddItem \"4\"\n        Case \"2\":\n            UserForm1.DependentBox.Clear\n            UserForm1.DependentBox.AddItem \"5\"\n            UserForm1.DependentBox.AddItem \"6\"\n        Case Default:\n            'Do Nothing\n    End Select\nEnd Sub\nPublic Property Let box(value As MsForms.ComboBox)\n    Set ComboBoxEvents = value\nEnd Property\nPublic Property Get box() As MsForms.ComboBox\n    Set box = ComboBoxEvents\nEnd Property\n</code></pre>\n\n<p>Next, I created a <strong>UserForm1</strong> that adds 2 comboboxes, one of which I add to a local variable of type cComboBox.</p>\n\n<pre><code>Public DependentBox As MsForms.ComboBox\nPrivate InitialBox As cComboBox\nPrivate Sub UserForm_Initialize()\n    Dim cBox As MsForms.ComboBox\n    Set InitialBox = New cComboBox\n\n    Set cBox = Me.Controls.Add(\"Forms.ComboBox.1\", \"initial\", True)\n    With cBox\n        .Left = 6\n        .Width = 100\n        .Height = 25\n        .Top = 6\n        .AddItem \"1\"\n        .AddItem \"2\"\n    End With\n    InitialBox.box = cBox\n\n    Set DependentBox = Me.Controls.Add(\"Forms.ComboBox.1\", \"dependent\", True)\n    With DependentBox\n        .Top = 6\n        .Left = 126\n        .Height = 25\n        .Width = 100\n    End With\nEnd Sub\n</code></pre>\n\n<p>Even though this works, the above approach is not very clean, since your class is not self-contained - It has to be aware of the UserForm. A better way would be to link the boxes in the class already and then just pass them from the Userform when you initialize your arrays of controls.\nThen it would be:</p>\n\n<p><strong>cComboBox</strong> class:</p>\n\n<pre><code>Private WithEvents p_ComboBoxEvents As MSForms.ComboBox\nPrivate p_DependBox As MSForms.ComboBox\nPrivate Sub p_ComboBoxEvents_Change()\n    Select Case p_ComboBoxEvents.value\n        Case \"1\":\n            p_DependBox.Clear\n            p_DependBox.AddItem \"3\"\n            p_DependBox.AddItem \"4\"\n        Case \"2\":\n            p_DependBox.Clear\n            p_DependBox.AddItem \"5\"\n            p_DependBox.AddItem \"6\"\n        Case Default:\n            'Do Nothing\n    End Select\nEnd Sub\nPublic Property Let TriggerBox(value As MSForms.ComboBox)\n    Set p_ComboBoxEvents = value\nEnd Property\nPublic Property Get TriggerBox() As MSForms.ComboBox\n    Set TriggerBox = p_ComboBoxEvents\nEnd Property\nPublic Property Let DependBox(value As MSForms.ComboBox)\n    Set p_DependBox = value\nEnd Property\nPublic Property Get DependBox() As MSForms.ComboBox\n    Set DependBox = p_DependBox\nEnd Property\n</code></pre>\n\n<p>Here you see you already link the boxes in a self-contained class. \nIn the event handler you could create a lookup for the values, etc.\nThen in the <strong>UserForm1</strong> code you initialize them as follows:</p>\n\n<pre><code>Option Explicit\nPrivate LinkedComboBox As cComboBox\nPrivate Sub UserForm_Initialize()\n    Dim cBox As MSForms.ComboBox\n    Set LinkedComboBox = New cComboBox\n\n    Set cBox = Me.Controls.Add(\"Forms.ComboBox.1\", \"initial\", True)\n    With cBox\n        .Left = 6\n        .Width = 100\n        .Height = 25\n        .Top = 6\n        .AddItem \"1\"\n        .AddItem \"2\"\n    End With\n    LinkedComboBox.TriggerBox = cBox\n\n    Set cBox = Me.Controls.Add(\"Forms.ComboBox.1\", \"dependent\", True)\n    With cBox\n        .Top = 6\n        .Left = 126\n        .Height = 25\n        .Width = 100\n    End With\n    LinkedComboBox.DependBox = cBox\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong>\nBased on the fact that it needs to be an array, you can amend the userform as follows:</p>\n\n<pre><code>Option Explicit\nPrivate LinkedComboBox(0 To 4) As cComboBOx\nPrivate Sub UserForm_Initialize()\n    Dim cBox As MSForms.ComboBox\n    Dim i As Integer\n\n    For i = 0 To 4\n        Set LinkedComboBox(i) = New cComboBOx\n        Set cBox = Me.Controls.Add(\"Forms.ComboBox.1\", \"initial\", True)\n        With cBox\n            .Left = 6\n            .Width = 100\n            .Height = 25\n            .Top = 6 + (i * 25)\n            .AddItem \"1\"\n            .AddItem \"2\"\n        End With\n        LinkedComboBox(i).TriggerBox = cBox\n\n        Set cBox = Me.Controls.Add(\"Forms.ComboBox.1\", \"dependent\", True)\n        With cBox\n            .Top = 6 + (i * 25)\n            .Left = 126\n            .Height = 25\n            .Width = 100\n        End With\n        LinkedComboBox(i).DependBox = cBox\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>In the array you can access each box as <code>LinkedComboBox(i).DependBox</code> and <code>LinkedComboBox(i).TriggerBox</code>. You won't need the two seperate arrays anymore, since everything is already contained in this <code>LinkedComboBox</code> array</p>\n"}], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 1, "accepted_answer_id": 44410821, "answer_count": 1, "score": 0, "last_activity_date": 1496837305, "creation_date": 1496830749, "last_edit_date": 1531164843, "question_id": 44409871, "link": "https://stackoverflow.com/questions/44409871/dynamic-created-user-form-with-2-dependent-combo-boxes", "title": "Dynamic created User-Form, with 2 dependent Combo-Boxes", "body": "<p>I am trying to create a dynamic User_form, where all the <code>Controls</code> are created at Run-Time.</p>\n\n<p>I have 2 array of Combo-Boxes, first array of Combo-Boxes is \"Catgeory\" (<code>CatCBArr</code>) , and the second array of Combo-Boxes is \"Item\" (<code>ItemCBArr</code>).</p>\n\n<p>I want, that once I select a value from the first Combo-Box of \"Category\", let's say <code>CatCBArr(0)</code>, that only the related Items in <code>ItemCBArr(0)</code> will be displayed.</p>\n\n<p><strong>Issue</strong>: I can't figure out how to modify the second Combo-box (<code>ItemCBArr(0)</code>) according to the value selected in the first Combo-box (<code>CatCBArr(0)</code>) </p>\n\n<p><strong><em>User_Form</em> Code</strong> (relevant section)</p>\n\n<pre><code>Option Explicit\n\nDim ItemsNumofRows As Long    \nDim QtyTB As MSForms.TextBox\nDim CatCB As MSForms.ComboBox\nDim ItemCB As MSForms.ComboBox\n\nDim Key As Variant\n\n' dynamic Form controls (related to new Classes)\nDim CatCBArr()                     As New cComboBox\nDim ItemCBArr()                    As New cComboBox    \nDim QtyTBArr()                     As New cTextBox         \n\nPrivate Sub UserForm_Initialize()\n\n' reset flags\nItemsNumofRows = 5\nTasksNamesUpd = False\nTasksColUpd = False\n\nItemsRows_ControlsInit '&lt;-- upload all Controls at run-time\nCheck_FormHeight\n\nEnd Sub\n\n'======================================================\n\nPrivate Sub ItemsRows_ControlsInit()\n\nFor ItemRow = 0 To ItemsNumofRows\n\n    ' add Category Combo-boxes\n    Set CatCB = Me.Controls.Add(\"Forms.ComboBox.1\", \"Cb\" &amp; ItemRow, True)\n    With CatCB\n        ' loop through Dictionay items (view category)\n        For Each Key In Dict.Keys\n            .AddItem Key\n        Next Key\n\n        .SpecialEffect = fmSpecialEffectSunken\n        .Left = 40\n        .Width = 100\n        .Height = 18\n        .Top = 54 + 20 * ItemRow\n\n        ReDim Preserve CatCBArr(0 To ItemRow)\n        Set CatCBArr(ItemRow).ComboBoxEvents = CatCB\n    End With\n\n    ' add Item Combo-boxes\n    Set ItemCB = Me.Controls.Add(\"Forms.ComboBox.1\", \"Cb_\" &amp; ItemRow, True)\n    With ItemCB\n\n        .SpecialEffect = fmSpecialEffectSunken\n        .Left = 160\n        .Width = 100\n        .Height = 18\n        .Top = 54 + 20 * ItemRow\n\n        ReDim Preserve ItemCBArr(0 To ItemRow)\n        Set ItemCBArr(ItemRow).ComboBoxEvents = ItemCB\n    End With    \nNext ItemRow\n\nEnd Sub\n</code></pre>\n\n<p><strong><em>cComboBox</em> Class Code</strong></p>\n\n<pre><code>Public WithEvents ComboBoxEvents As MSForms.ComboBox\n\nPrivate Sub ComboBoxEvents_Change()\n\nDim CBIndex                            As Long\n\n' get for ID number (row number), from third character in String Name.\n' e.g \"Cb1\" will result 1)\nCBIndex = CInt(Mid(ComboBoxEvents.Name, 3))\n\n' ??? How do I get the Value, and update the second combo-box Items\n\nSelect Case ComboBoxEvents.Value\n\n\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p><strong><em>GUI User_Form</strong> screen-shot</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/zh9ox.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zh9ox.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496830752, "post_id": 44409810, "comment_id": 75818509, "body": "This is normal behaviour. Try manual copy-paste of 3 cells into a selection of 9 cells: You&#39;ll get three copies. Replace <code>wsDataUpdated2.Range(&quot;A1:AG10150&quot;)</code> with <code>wsDataUpdated2.Range(&quot;A1&quot;)</code>, that should do the trick I think."}, {"owner": {"reputation": 178, "user_id": 8013180, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cee29fffd3a2bfac21056f92777cd5ce?s=128&d=identicon&r=PG&f=1", "display_name": "Clement B", "link": "https://stackoverflow.com/users/8013180/clement-b"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496831093, "post_id": 44409810, "comment_id": 75818745, "body": "It works. I thought about that but I was like &quot;The first time it works, why not now ?&quot; but it&#39;s because the first time, my Sheet is full of zeros."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496831134, "post_id": 44409810, "comment_id": 75818776, "body": "I&#39;ll add this as answer. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 433, "user_id": 5502774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aba8abc7a3b79679db892c5e58267ec?s=128&d=identicon&r=PG&f=1", "display_name": "Wils Mils", "link": "https://stackoverflow.com/users/5502774/wils-mils"}, "is_accepted": false, "score": 3, "last_activity_date": 1496830934, "creation_date": 1496830934, "answer_id": 44409928, "question_id": 44409810, "link": "https://stackoverflow.com/questions/44409810/pastespecial-is-pasting-multiple-times/44409928#44409928", "title": "PasteSpecial is pasting multiple times", "body": "<p>Have you tried pasting it only on the first cell?</p>\n\n<pre><code>     wsDataUpdated2.Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 3, "last_activity_date": 1496831141, "creation_date": 1496831141, "answer_id": 44410022, "question_id": 44409810, "link": "https://stackoverflow.com/questions/44409810/pastespecial-is-pasting-multiple-times/44410022#44410022", "title": "PasteSpecial is pasting multiple times", "body": "<p>This is normal behaviour. Try manual copy-paste of 3 cells into a selection of 9 cells: You'll get three copies. Replace </p>\n\n<pre><code>wsDataUpdated2.Range(\"A1:AG10150\") \n</code></pre>\n\n<p>with </p>\n\n<pre><code>wsDataUpdated2.Range(\"A1\")\n</code></pre>\n\n<p>That should do the trick.</p>\n"}], "owner": {"reputation": 178, "user_id": 8013180, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cee29fffd3a2bfac21056f92777cd5ce?s=128&d=identicon&r=PG&f=1", "display_name": "Clement B", "link": "https://stackoverflow.com/users/8013180/clement-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "accepted_answer_id": 44410022, "answer_count": 2, "score": 1, "last_activity_date": 1496831141, "creation_date": 1496830549, "last_edit_date": 1531164843, "question_id": 44409810, "link": "https://stackoverflow.com/questions/44409810/pastespecial-is-pasting-multiple-times", "title": "PasteSpecial is pasting multiple times", "body": "<p><strong>My goal is</strong> : to filter some rows, copy those filtered rows and paste it on another sheet.\nI'm doing it twice : the first time, it's working well but the second time, not at all. \nBefore my sample of code, you need to know : wsData ---filter--> wsDataUpdated --- filter ---> wsDataUpdated2 . </p>\n\n<p><strong>The problem is</strong> : the second filter is quite ok, but the paste is like awkward : it's pasting all over the range, I mean : if I have only 2 rows after the filter, and i'm pasting it on the wsDataUpdated2 with the range : (\"A1:A100\") it'll paste it 50 times !! The awkward part is that it's exactly the same code of my first filter, and on my first filter, even if I have less rows than my range, it's not pasting twice or more... By the way, with some breakpoints, I've seen that the filtered part and the copy part is perfect. The paste part is not okay at all.</p>\n\n<p>Here's a sample of my code : </p>\n\n<pre><code>    wsDataUpdated.Range(\"B4\").CurrentRegion.AdvancedFilter xlFilterInPlace, wsCriteria2.Range(\"A1\").CurrentRegion\n    wsDataUpdated.Range(\"A1:AG10150\").SpecialCells(xlCellTypeVisible).Copy\n    wsDataUpdated2.Range(\"A1:AG10150\").PasteSpecial Paste:=xlPasteValues\n    wsDataUpdated2.Range(\"A1:AG10150\").PasteSpecial Paste:=xlPasteFormats\n</code></pre>\n"}, {"tags": ["excel", "cobol", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1496829334, "post_id": 44409158, "comment_id": 75817412, "body": "Yes it is possible. But please understand that Stack Overflow is not a free code writing service, therefore you will need to show what you have already tried (<a href=\"https://stackoverflow.com/posts/44409158/edit\">edit</a> your question and add your code) and ask a <i>specific</i> question to your code. Including any error messages and where they occur in your code and where you get stuck."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1496830338, "post_id": 44409158, "comment_id": 75818202, "body": "you always want to search based on cursor position? and only once?"}, {"owner": {"reputation": 8847, "user_id": 624463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/995rN.png?s=128&g=1", "display_name": "cschneid", "link": "https://stackoverflow.com/users/624463/cschneid"}, "edited": false, "score": 0, "creation_date": 1496849745, "post_id": 44409158, "comment_id": 75833006, "body": "So you&#39;re only looking for paragraphs and plan to ignore sections?"}, {"owner": {"reputation": 9, "user_id": 7023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ead55a179902a6c30bb8b41d34be83cb?s=128&d=identicon&r=PG&f=1", "display_name": "Myplanet", "link": "https://stackoverflow.com/users/7023636/myplanet"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496922225, "post_id": 44409158, "comment_id": 75866608, "body": "@Peh I don&#39;t know much of Vba. I tried recording a macro but it did not work at all."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496922380, "post_id": 44409158, "comment_id": 75866716, "body": "@Myplanet That&#39;s ok but you cannot expect anyone writing the code for you. People usually are here to help <i>you to solve the issue yourself</i> and not to solve the issue <i>for you</i>."}, {"owner": {"reputation": 9, "user_id": 7023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ead55a179902a6c30bb8b41d34be83cb?s=128&d=identicon&r=PG&f=1", "display_name": "Myplanet", "link": "https://stackoverflow.com/users/7023636/myplanet"}, "reply_to_user": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1496922392, "post_id": 44409158, "comment_id": 75866726, "body": "@GowthamShiva yes always based on cursor position. If we can search more than one level It would be great."}, {"owner": {"reputation": 9, "user_id": 7023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ead55a179902a6c30bb8b41d34be83cb?s=128&d=identicon&r=PG&f=1", "display_name": "Myplanet", "link": "https://stackoverflow.com/users/7023636/myplanet"}, "reply_to_user": {"reputation": 8847, "user_id": 624463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/995rN.png?s=128&g=1", "display_name": "cschneid", "link": "https://stackoverflow.com/users/624463/cschneid"}, "edited": false, "score": 0, "creation_date": 1496922569, "post_id": 44409158, "comment_id": 75866875, "body": "@cschneid yes, locating the paragraph will be enough for basic analysis"}, {"owner": {"reputation": 9, "user_id": 7023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ead55a179902a6c30bb8b41d34be83cb?s=128&d=identicon&r=PG&f=1", "display_name": "Myplanet", "link": "https://stackoverflow.com/users/7023636/myplanet"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496922685, "post_id": 44409158, "comment_id": 75866973, "body": "@peh thanks for the response. I will try to write it myself."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1496922846, "post_id": 44409158, "comment_id": 75867114, "body": "@Myplanet have a look at the answer below. You will find most of what you need there. If you run into issues <a href=\"https://stackoverflow.com/posts/44409158/edit\">edit</a> your question, post your actual code and tell where you got stuck to get more help from people here."}], "answers": [{"tags": [], "owner": {"reputation": 433, "user_id": 5502774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aba8abc7a3b79679db892c5e58267ec?s=128&d=identicon&r=PG&f=1", "display_name": "Wils Mils", "link": "https://stackoverflow.com/users/5502774/wils-mils"}, "is_accepted": false, "score": 1, "last_activity_date": 1496833959, "creation_date": 1496833959, "answer_id": 44411073, "question_id": 44409158, "link": "https://stackoverflow.com/questions/44409158/cobol-analysis-using-excel-sheet-need-script-to-locate-paragraphs/44411073#44411073", "title": "COBOL analysis using Excel sheet. Need script to locate paragraphs", "body": "<p>Try to connect dots with these:</p>\n\n<p>I have copied a COBOL program in to Excel sheet. I want write a macro and assign keys. So when I press the assigned keys it should do the following thing. For example, when the cursor is at the row PERFORM 001-PARA-ADD it should store the row value (line no 2) in a variable</p>\n\n<pre><code>   strValue = ActiveCell.Value\n   Sheets(\"Sheet2\").Range(\"A1\") = ActiveCell.Address 'save your cell address into a scratch sheet\n</code></pre>\n\n<p>and copy only para name  001-PARA-ADD </p>\n\n<pre><code>   arrayValue = Split(strValue, \" \")\n   For Each val In arrayValue\n        If Instr(val, \"PARA\") &gt; 0 Then\n            strPara = val\n            Goto ProcessNext\n        End If\n   Next\n\n   ProcessNext:\n</code></pre>\n\n<p>and add . at the end of the string</p>\n\n<pre><code>   strPara = strPara &amp; \".\"\n</code></pre>\n\n<p>and strip out the other characters in the line</p>\n\n<pre><code>   strPara = Trim(strPara)  \n</code></pre>\n\n<p>and search for string 001-PARA-ADD. and move the control to the line 7 where the string 001-PARA-ADD. is present</p>\n\n<pre><code>get the code from this link &lt;https://stackoverflow.com/questions/11813720/search-a-string-in-a-worksheet-in-vba&gt;!\n</code></pre>\n\n<p>and when I press the keys again it should comeback to the initial location line 2.</p>\n\n<pre><code>   'create another macro for this\n   ActiveSheet.Range(Sheets(\"Sheet2\").Range(\"A1\").Value).Activate\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7023636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ead55a179902a6c30bb8b41d34be83cb?s=128&d=identicon&r=PG&f=1", "display_name": "Myplanet", "link": "https://stackoverflow.com/users/7023636/myplanet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496833959, "creation_date": 1496828928, "last_edit_date": 1531161705, "question_id": 44409158, "link": "https://stackoverflow.com/questions/44409158/cobol-analysis-using-excel-sheet-need-script-to-locate-paragraphs", "title": "COBOL analysis using Excel sheet. Need script to locate paragraphs", "body": "<p>I have copied a COBOL program in to Excel sheet. I want write a macro and assign keys. So when I press the assigned keys it should do the following thing. For example, when the cursor is at the row <code>PERFORM 001-PARA-ADD</code> it should store the row value (line no 2) in a variable and copy only para name <code>001-PARA-ADD</code> and add <code>.</code> at the end of the string and strip out the other characters in the line and search for string <code>001-PARA-ADD.</code> and move the control to the line 7 where the string <code>001-PARA-ADD.</code> is present and when I press the keys again it should comeback to the initial location line 2. </p>\n\n<p>Please tell me if it possible. Please let me know if more details need about the requirement.</p>\n\n<pre><code> IF A &gt; B\n345    PERFORM 001-PARA-ADD 12345\n     IF A &lt; B\n        PERFORM 002-PARA-SUB\n     END-IF\n    END-IF\n    001-PARA-ADD.\n       COMPUTE A = A+B.\n    .\n    002-PARA-SUB.\n       COMPUTE B = B-A.\n    .\n</code></pre>\n\n<p>Image of the program:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2Kje5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2Kje5.png\" alt=\"image of the program\"></a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1496829205, "post_id": 44409104, "comment_id": 75817303, "body": "What result do you get if you add <code>Debug.Print UserForm1.TextBox1.value,myRange</code> before the <code>Application.WorksheetFunction</code> line?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1496830439, "post_id": 44409104, "comment_id": 75818277, "body": "I&#39;d suggest <code>Set myRange = wb.Worksheets(&quot;Users&quot;).Range(&quot;A2:F1000&quot;)</code>"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1496854563, "post_id": 44409104, "comment_id": 75835946, "body": "If the answer helped you <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">please consider accepting it</a>. Accepting answers rewards the contributor and helps others to find working answers.  If the answer didn&#39;t help add a comment.  Maybe it can be fixed."}, {"owner": {"reputation": 11, "user_id": 8124629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb4ac6c83b8d522aeff5935235b7ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Ltee", "link": "https://stackoverflow.com/users/8124629/ltee"}, "edited": false, "score": 0, "creation_date": 1496925059, "post_id": 44409104, "comment_id": 75868751, "body": "i have used this method already and it result in same error"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8124629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb4ac6c83b8d522aeff5935235b7ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Ltee", "link": "https://stackoverflow.com/users/8124629/ltee"}, "edited": false, "score": 0, "creation_date": 1496930630, "post_id": 44411074, "comment_id": 75873274, "body": "my broblem really is not error handling, but it is as though my code is not or rather it is not working.  i have tried your option B, its given me the same error. i checked my data sheet and the data i want pulled to the userform is there."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "reply_to_user": {"reputation": 11, "user_id": 8124629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb4ac6c83b8d522aeff5935235b7ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Ltee", "link": "https://stackoverflow.com/users/8124629/ltee"}, "edited": false, "score": 0, "creation_date": 1496931001, "post_id": 44411074, "comment_id": 75873580, "body": "If the value of <code>UserForm1.TextBox1</code> appears within <code>Users!A2:F1000</code> then it could be a data type error.  Vlookups won&#39;t match integers with strings, example: 1 &lt;&gt; &quot;1&quot;.  What value are you looking up, when the code fails?"}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": false, "score": 0, "last_activity_date": 1496833960, "creation_date": 1496833960, "answer_id": 44411074, "question_id": 44409104, "link": "https://stackoverflow.com/questions/44409104/pull-data-from-a-closed-workbook-to-a-userform-using-vlookup/44411074#44411074", "title": "Pull data from a closed workbook to a userform using Vlookup", "body": "<p><a href=\"https://support.office.com/en-gb/article/VLOOKUP-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1\" rel=\"nofollow noreferrer\">VLookup</a> will raise an error, when called via the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow noreferrer\">Application.WorksheetFunction</a> object, if it cannot find the value you are looking for.  You can handle this by adding error trapping to your function:</p>\n\n<p><strong>Test Data</strong></p>\n\n<pre><code>Row/Col     A   B\n1           x   XXX\n2           y   YYY\n3           z   ZZZ\n</code></pre>\n\n<p><strong>Example A</strong></p>\n\n<pre><code>Public Sub XX()\nOn Error Resume Next    ' Ignore errors.  WARNING: Will ignore **all** errors.\nDim result As Variant   ' Holds result of vlookup.\n\n    ' Can find value, no error.\n    result = Application.WorksheetFunction.VLookup(\"x\", Range(\"Sheet1!A1:B3\"), 2, False)\n    MsgBox result\n\n    ' Cannot find value, raises an error.\n    result = Application.WorksheetFunction.VLookup(\"a\", Range(\"Sheet1!A1:B3\"), 2, False)\n\n    ' Check for error.\n    ' 1004 = cannot find value.\n    ' Make sure you handle all other errors.\n    If Err.Number = 1004 Then\n\n        MsgBox \"Cannot find value\"\n        Err.Clear\n    Else\n\n        MsgBox Err.Description\n        Err.Clear\n    End If\nEnd Sub\n</code></pre>\n\n<p>An alternative approach allows you to call VLookup directly.  This method does not require error trapping:</p>\n\n<p><strong>Example B</strong></p>\n\n<pre><code>Dim Result As Variant\n\n' Value XXX wrote to Result.\nResult = [Vlookup(\"x\", Sheet1!A1:B3, 2, False)]\n\n' Value Error 2042 wrote to Result.\nResult = [Vlookup(\"a\", Sheet1!A1:B3, 2, False)]\n</code></pre>\n\n<p>I prefer the second approach.  Ignoring errors can make it hard to debug your code later.</p>\n\n<p>For more on using VLookup via VBA I'd recommend reading this <a href=\"http://www.microsofttraining.net/b/use-vlookup-function-excel-vba/\" rel=\"nofollow noreferrer\">blog post</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 8124629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb4ac6c83b8d522aeff5935235b7ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Ltee", "link": "https://stackoverflow.com/users/8124629/ltee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496833960, "creation_date": 1496828815, "last_edit_date": 1496829544, "question_id": 44409104, "link": "https://stackoverflow.com/questions/44409104/pull-data-from-a-closed-workbook-to-a-userform-using-vlookup", "title": "Pull data from a closed workbook to a userform using Vlookup", "body": "<p>In the following code, I copy a value from a closed-spreadsheet to a user-form, but it fails with <code>error 1004</code>.</p>\n\n<blockquote>\n  <p>\"Unable to get the Vlookup propoerty\". </p>\n</blockquote>\n\n<p>My code is as follows:</p>\n\n<pre><code>If TextBox1.Value = \"\" Then\n   MsgBox \"Enter Employee Number\", vbExclamation, \"Error Message\"\n\n   Exit Sub\n\nEnd If\n\nSet wb = Workbooks.Open(\"Z:\\PROD  - Production related info\\QUALITY\\KAIZEN TEAM\\Weekly Rejects\\Dropdown_List_Database\\Dropdown_Lists.xlsx\")\n\nDim myRange As Range\nSet myRange = Worksheets(\"Users\").Range(\"A2:F1000\")\n\nUserForm1.TextBox2.Value = \nApplication.WorksheetFunction.VLookup(UserForm1.TextBox1.Value, myRange, 2, False)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1496840378, "post_id": 44409090, "comment_id": 75825575, "body": "Are you creating multiple accounts?? <a href=\"https://stackoverflow.com/questions/44413047/formatting-macro-doesnt-work-on-all-worksheets\" title=\"formatting macro doesnt work on all worksheets\">stackoverflow.com/questions/44413047/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1496830071, "creation_date": 1496830071, "answer_id": 44409638, "question_id": 44409090, "link": "https://stackoverflow.com/questions/44409090/percent-style-formatting-in-excel-vba/44409638#44409638", "title": "&quot;Percent&quot; Style Formatting in Excel-VBA", "body": "<p>If you have multiple sheets selected, applying a Style only affects the cells on the active sheet. Applying a NumberFormat will affect all sheets, so you should use that rather than the Style, or loop through each sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1496839468, "creation_date": 1496839468, "answer_id": 44413007, "question_id": 44409090, "link": "https://stackoverflow.com/questions/44409090/percent-style-formatting-in-excel-vba/44413007#44413007", "title": "&quot;Percent&quot; Style Formatting in Excel-VBA", "body": "<p>all sheets  selected method</p>\n\n<pre><code>Sub test()\n    Dim vName()\n    Dim Ws As Worksheet, n As Integer\n    For Each Ws In Worksheets\n        n = n + 1\n        ReDim Preserve vName(1 To n)\n        vName(n) = Ws.Name\n    Next Ws\n    Sheets(vName).Select\n    Range(Cells(143, 2), Cells(146, MarketRangeColumn + 10)).Select\n    Selection.Style = \"Percent\"\n    Range(Cells(100, 2), Cells(142, MarketRangeColumn + 10)).Select\n    Selection.Style = \"Comma\"\n    Selection.NumberFormat = \"_(* #,##0.0_);_(* (#,##0.0);_(* \"\"-\"\"??_);_(@_)\"\n    Selection.NumberFormat = \"_(* #,##0_);_(* (#,##0);_(* \"\"-\"\"??_);_(@_)\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8124365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14e47cd7521286da2b2c1125f9e9b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Kavi", "link": "https://stackoverflow.com/users/8124365/kavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2572, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496839468, "creation_date": 1496828780, "last_edit_date": 1531164843, "question_id": 44409090, "link": "https://stackoverflow.com/questions/44409090/percent-style-formatting-in-excel-vba", "title": "&quot;Percent&quot; Style Formatting in Excel-VBA", "body": "<p>Have n sheets which have been selected and I am trying to apply the \"percent' style to all for a range of cell selection. \nHowever only the  first sheet gets formatted. Other formatting styles that I am using work perfectly on all sheets. Only \"percent\" seems to be working only in the first sheet! Is there a specific reason for this? Pasting my Code snippet below: Thanks in advance for your help</p>\n\n<pre><code>Range(Cells(143, 2), Cells(146, MarketRangeColumn + 10)).Select\nSelection.Style = \"Percent\"\nRange(Cells(100, 2), Cells(142, MarketRangeColumn + 10)).Select\nSelection.Style = \"Comma\"\nSelection.numberformat = \"_(* #,##0.0_);_(* (#,##0.0);_(* \"\"-\"\"??_);_(@_)\"\nSelection.numberformat = \"_(* #,##0_);_(* (#,##0);_(* \"\"-\"\"??_);_(@_)\"\n</code></pre>\n"}, {"tags": ["vba", "performance", "loops", "if-statement"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1496830895, "post_id": 44408943, "comment_id": 75818604, "body": "Why didn&#39;t you perform a runtime test yourself? I believe this can also depend on how your data looks like. So there may be no general answer beside testing it on your own."}, {"owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496832557, "post_id": 44408943, "comment_id": 75819795, "body": "Okay, I was mostly curious about whether there was a general tendency/rule and not regarding a specific piece of code."}, {"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1496833781, "post_id": 44408943, "comment_id": 75820635, "body": "@Sebastian Koefoed, 1) <code>VBA</code> doesn&#39;t have a &quot;short-circuit&quot;ing, so your <code>OR</code> statement will evaluate anyway, hence your idea is reasonable, why not? 2) It&#39;s a <b>must</b>, but it&#39;s only a habit in general. About question: There&#39;re no rules, no one will blame you (except employers, coleagues and internet code crusaders) for your coding habits. While you sufficient with code - use it and try to learn something new. Repeat. (<i>So there may be no general answer</i> @Peh)"}], "owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496828355, "creation_date": 1496828355, "question_id": 44408943, "link": "https://stackoverflow.com/questions/44408943/if-or-statement-faster-than-two-if-statements", "title": "IF OR/&amp; statement faster than two if statements?", "body": "<p>I was wondering if there was a general rule regarding the sequence of several <code>IF</code> statements, taking <code>OR</code>statements and <code>&amp;</code> combination into consideration.</p>\n\n<p>e.g. below is my initial thought about the fastest way</p>\n\n<pre><code>Dim DataRCntr As Long\nDim MyRange As Range\nDim Target As String\nDim DataArr() As Variant\nDim StrArr() As Variant\n\nDataArr = MyRange.Value\n\nStrArr = Array(Target, \"High\", \"Major\", Target &amp; \"High\", Target &amp; \"Major\")\n\nFor DataRCntr = LBound(DataArr, 1) To UBound(DataArr, 1)\n\n    If DataArr(DataRCntr, 4) &amp; DataArr(DataRCntr, 11) = StrArr(2) Or _\n    DataArr(DataRCntr, 4) &amp; DataArr(DataRCntr, 11) = StrArr(3) Then\n\n        If DataArr(DataRCntr, 20) &lt; 0.9 Then\n\n        'Do Something\n\n        End If\n\n    End If\n\nNext DataRCntr\n</code></pre>\n\n<p>Example of a few things i was thinking about:</p>\n\n<ol>\n<li>In first <code>IF</code> statement, you could split it up in two so you first check for <code>DataArr(DataRCntr, 4)=StrArr(1)</code> to avoid the <code>OR</code> statement if the first doesn't match</li>\n<li>You could create a String combining <code>DataArr(DataRCntr, 4) &amp; DataArr(DataRCntr, 11)</code>before the <code>IF</code> statement</li>\n</ol>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1496828465, "post_id": 44408575, "comment_id": 75816776, "body": "... and probably remove the last character after the end of the loop using <code>Left(X, Len(X) - 1)</code>?  (To get rid of the final LF and avoid the cell thus displaying one blank &quot;row&quot; at the end.)  Or, probably easier, put the LF at the start of the concatenation and just use <code>Mid(x, 2)</code> when placing the value into the cell."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496863295, "post_id": 44408575, "comment_id": 75840707, "body": "Your <code>Mid(X, Len(X), 1) = vbNullString</code> doesn&#39;t actually do anything, because the length of <code>vbNullString</code> is 0.  Assigning something to the <code>Mid</code> of a string only changes the number of characters determined by the lesser of the length parameter, the number of characters in the replacement string, and the number of characters to the end of the string.  You need to use <code>X = Left(X, Len(X) - 1)</code> to actually get rid of a character from <code>X</code>."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 1, "creation_date": 1497005228, "post_id": 44408575, "comment_id": 75907817, "body": "Yes, the Operator trick didn&#39;t work for the null replacement (poor testing). Opted for the string Left$ over the slower variant Left."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 5, "last_activity_date": 1496914214, "last_edit_date": 1496914214, "creation_date": 1496827326, "answer_id": 44408575, "question_id": 44408417, "link": "https://stackoverflow.com/questions/44408417/excel-vba-char10-with-special-string-value/44408575#44408575", "title": "excel vba char(10) with special string value", "body": "<p>Try this</p>\n\n<pre><code>X = X &amp; \"-\" &amp; cell.Value &amp; Chr(10)\n</code></pre>\n\n<p>in full:</p>\n\n<pre><code>Sub ab_notsonull()\nDim X As String, cell As Range\nFor Each cell In Range(\"A1:A3\")\n  If (Len(cell.Value) &gt; 0) Then\n  X = X &amp; (\"-\" &amp; cell.Value &amp; Chr(10))\nEnd If\nNext\nRange(\"B2\").Value = Left$(X, Len(X) - 1)\nRange(\"B2\").WrapText = True\nRange(\"B2\").Columns.AutoFit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2680, "favorite_count": 0, "accepted_answer_id": 44408575, "answer_count": 1, "score": 3, "last_activity_date": 1496914214, "creation_date": 1496826901, "question_id": 44408417, "link": "https://stackoverflow.com/questions/44408417/excel-vba-char10-with-special-string-value", "title": "excel vba char(10) with special string value", "body": "<p>I have a range with data and I am concatenating with line function and I want the output as follow</p>\n\n<p>Range(\"A1:A3\") has A,B,C and I want the output in single cell as</p>\n\n<pre><code>-A\n-B\n-C\n</code></pre>\n\n<p>I am using following code; somehow it is not giving me desired output. Can anyone look into this and assist?</p>\n\n<pre><code>Dim X As String,cell as Range\nFor Each Cell in Range(\"A1:A3\")\n  If(Len(cell.value)&gt;0) Then\n  X=\"-\" &amp; X &amp; CHAR(10) &amp; Cell.Value\nEnd If\nNext\nRange(\"B1\").Value= X\n\nRange(\"B1\").WrapText = True\nRange(\"B1\").Columns.AutoFit\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496827428, "post_id": 44408275, "comment_id": 75816036, "body": "yes because you <code>exit for</code> after the first click, so the loop stops here. Remove it and put your code that handles everything that should be run after a click instead of <code>exit for</code>"}, {"owner": {"reputation": 1, "user_id": 8119546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c7vmN.png?s=128&g=1", "display_name": "gokanayz", "link": "https://stackoverflow.com/users/8119546/gokanayz"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496832504, "post_id": 44408275, "comment_id": 75819748, "body": "thank you for the answer"}, {"owner": {"reputation": 1, "user_id": 8119546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c7vmN.png?s=128&g=1", "display_name": "gokanayz", "link": "https://stackoverflow.com/users/8119546/gokanayz"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496833214, "post_id": 44408275, "comment_id": 75820262, "body": "Sorry, unresolved"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496835343, "post_id": 44408275, "comment_id": 75821779, "body": "&quot;<i>Sorry, unresolved</i>&quot; isn&#39;t useful to anyone. If you really expect help from anyone I suggest you to <a href=\"https://stackoverflow.com/posts/44408275/edit\">edit</a> your question and add exactly where your code fails and describe <i>detailed</i> what you are trying to achieve. Your question is very unclear (at least to me)."}], "answers": [{"comments": [{"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1496943181, "post_id": 44431583, "comment_id": 75881959, "body": "<b>From review queue:</b> May I request you to please add some more context around your answer. Code-only answers are difficult to understand. It will help the asker and future readers both if you can add more information in your post."}, {"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1496943199, "post_id": 44431583, "comment_id": 75881967, "body": "Please have a look at <a href=\"http://stackoverflow.com/help/self-answer\">Can I answer my own question?</a> and come back two days later and check as answered."}], "tags": [], "owner": {"reputation": 1, "user_id": 8119546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c7vmN.png?s=128&g=1", "display_name": "gokanayz", "link": "https://stackoverflow.com/users/8119546/gokanayz"}, "is_accepted": false, "score": 0, "last_activity_date": 1496966090, "last_edit_date": 1496966090, "creation_date": 1496913548, "answer_id": 44431583, "question_id": 44408275, "link": "https://stackoverflow.com/questions/44408275/excel-and-ie11-vba-automation/44431583#44431583", "title": "Excel and IE11 VBA Automation", "body": "<p>Solution:</p>\n\n<pre><code>y = 0\nFor Each ele In ob.document.getElementById(\"MainContent_lbl_YakinBilgi\").getElementsByTagName(\"a\")\n    y = y + 1\n    If y = 2 Then\n    Cells(i, 34).Value = ele.outerHTML\n    End If\n\nNext ele\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8119546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c7vmN.png?s=128&g=1", "display_name": "gokanayz", "link": "https://stackoverflow.com/users/8119546/gokanayz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496966090, "creation_date": 1496826548, "last_edit_date": 1531164843, "question_id": 44408275, "link": "https://stackoverflow.com/questions/44408275/excel-and-ie11-vba-automation", "title": "Excel and IE11 VBA Automation", "body": "<p>I'm new in VBA and i'm trying to automate a web Explorer navigation but with many difficolties. I've composed a script that navigate into a web page and search for a code. the result is a table (\"table\") with one row that contains the searched item (\"TCKNodanSorgula.aspx?tckno=27497556158\") displayed as a link to another page. Here the code of that table:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"table\"&gt;\r\n\r\n\t&lt;span id=\"MainContent_lbl_YakinBilgi\"&gt;\r\n\t  &lt;div class=\"th\"&gt;\r\n\t     &lt;div class=\"tdmini\"&gt;&amp;nbsp;&lt;/div&gt;\r\n\t     &lt;div class=\"td\"&gt;T.C. Kimlik No&lt;/div&gt;\r\n\t     &lt;div class=\"tdmidi\"&gt;B.S. No&lt;/div&gt; \r\n\t     &lt;div class=\"td\"&gt;Yak\u0131nl\u0131k&lt;/div&gt; \r\n\t     &lt;div class=\"td\"&gt;Ad\u0131&lt;/div&gt; \r\n\t     &lt;div class=\"td\"&gt;Do\u011fum Tarihi&lt;/div&gt; \r\n\t     &lt;div class=\"td\"&gt;Durumu&lt;/div&gt; \r\n\t     &lt;div style=\"clear: both;\"&gt;&lt;/div&gt;\r\n\t   &lt;/div&gt;\r\n\t&lt;div class=\"tr\"&gt; \r\n\t &lt;div class=\"tdmini\"&gt;\r\n\t  &lt;a href=\"TCKNodanSorgula.aspx?tckno=27461667396\" title=\"Sorgula\"&gt;\r\n\t   &lt;img alt=\"Sorgula\" src=\"images/openLink.gif\"&gt;\r\n\t  &lt;/a&gt;\r\n\t &lt;/div&gt; \r\n\t     &lt;div class=\"td\"&gt;27461077396&lt;/div&gt; \r\n\t     &lt;div class=\"tdmidi\"&gt;34&lt;/div&gt; \r\n\t     &lt;div class=\"td\"&gt;Kendisi&lt;/div&gt; \r\n\t     &lt;div class=\"td\"&gt;SEVG\u0130&lt;/div&gt; \r\n\t     &lt;div class=\"td\"&gt;25/10/1960&lt;/div&gt; \r\n\t     &lt;div class=\"td\"&gt;A\u00e7\u0131k&lt;/div&gt; \r\n\t     &lt;div style=\"clear: both;\"&gt;&lt;/div&gt;\r\n          &lt;/div&gt;\r\n        &lt;div class=\"tr\"&gt; \r\n\t &lt;div class=\"tdmini\"&gt;\r\n\t  &lt;a href=\"TCKNodanSorgula.aspx?tckno=27497556158\" title=\"Sorgula\"&gt;\r\n\t   &lt;img alt=\"Sorgula\" src=\"images/openLink.gif\"&gt;\r\n\t&lt;/a&gt;\r\n       &lt;/div&gt;\r\n\t    &lt;div class=\"td\"&gt;27497076158&lt;/div&gt; \r\n\t    &lt;div class=\"tdmidi\"&gt;19&lt;/div&gt; \r\n\t    &lt;div class=\"td\"&gt;Babas\u0131&lt;/div&gt; \r\n\t    &lt;div class=\"td\"&gt;\u015eEK\u0130&lt;/div&gt; \r\n\t    &lt;div class=\"td\"&gt;01/12/1932&lt;/div&gt; \r\n\t    &lt;div class=\"td\"&gt;\u00d6l\u00fcm&lt;/div&gt; \r\n\t    &lt;div style=\"clear: both;\"&gt;&lt;/div&gt;\r\n\t &lt;/div&gt;\r\n       &lt;div class=\"tr\"&gt; \r\n\t&lt;div class=\"tdmini\"&gt;\r\n\t &lt;a href=\"TCKNodanSorgula.aspx?tckno=27470145004\" title=\"Sorgula\"&gt;\r\n\t  &lt;img alt=\"Sorgula\" src=\"images/openLink.gif\"&gt;\r\n\t &lt;/a&gt;\r\n        &lt;/div&gt; \r\n\t   &lt;div class=\"td\"&gt;27470077004&lt;/div&gt; \r\n\t   &lt;div class=\"tdmidi\"&gt;30&lt;/div&gt; \r\n\t   &lt;div class=\"td\"&gt;Annesi&lt;/div&gt; \r\n\t   &lt;div class=\"td\"&gt;Y\u00dcKEL&lt;/div&gt; \r\n\t   &lt;div class=\"td\"&gt;11/09/1937&lt;/div&gt; \r\n\t   &lt;div class=\"td\"&gt;A\u00e7\u0131k&lt;/div&gt; \r\n\t   &lt;div style=\"clear: both;\"&gt;\r\n\t&lt;/div&gt;\r\n     &lt;/div&gt;\r\n  &lt;/span&gt;\r\n                \r\n&lt;/div&gt;  </code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Here my code:</p>\n\n<pre><code>For Each t\u0131k In ob.document.getElementsByTagName(\"a\")\n    If t\u0131k.innertext = href Then\n        t\u0131k.Click\n        Exit For\n    End If\nNext t\u0131k\n</code></pre>\n\n<p>I can find but I can't execute the code in order to press the second href button. I'm using IE 11.</p>\n\n<p>Thanks for your patience!.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1496825563, "post_id": 44407639, "comment_id": 75814617, "body": "What does &quot;unique position&quot; mean? Fill in the screenshot with the desired results and explain the logic that leads to the result. -- How about adding a column with a unique number and then creating a pivot table with &quot;minimum&quot; as the aggregate? Anyway, it&#39;s not clear what you want to achieve. Edit <b>your question</b> to provide these details. Do NOT post details in comments."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496825603, "post_id": 44407639, "comment_id": 75814654, "body": "Welcome to SO. Would be nice if you could include a screenshot of the expected result. Of Course that is posible with VBA."}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1496826121, "creation_date": 1496826121, "answer_id": 44408125, "question_id": 44407639, "link": "https://stackoverflow.com/questions/44407639/identifying-the-number-of-positions-then-outputting-the-positions-and-number-in/44408125#44408125", "title": "Identifying the Number of Positions then Outputting the Positions and Number in another Column", "body": "<p>I feel you may be over-complicating things and asking for VBA because you may not know that things can be done without VBA. As I understand the question, you want a count of each position in column A. That can easily be done with a pivot table, without re-inventing the wheel with VBA. Pivot tables are much more powerful and much faster than conventional formulas and DEFINITELY faster than any VBA that you can come up with. </p>\n\n<p>Consider this screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pbigF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pbigF.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've turned column A into an Excel Table object with Insert > Table (or Ctrl-T), so the data can grow easily, but that is optional. </p>\n\n<p>Then I've inserted a pivot table and pulled the Position into the Rows area and pulled it again into the values area, where it is aggregated with a count. </p>\n\n<p>No formulas, no VBA.</p>\n\n<p>If that is not what you need, edit your question and clarify. Otherwise, feel free to mark this as the answer. </p>\n"}, {"tags": [], "owner": {"reputation": 433, "user_id": 5502774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aba8abc7a3b79679db892c5e58267ec?s=128&d=identicon&r=PG&f=1", "display_name": "Wils Mils", "link": "https://stackoverflow.com/users/5502774/wils-mils"}, "is_accepted": false, "score": 0, "last_activity_date": 1496828043, "creation_date": 1496828043, "answer_id": 44408826, "question_id": 44407639, "link": "https://stackoverflow.com/questions/44407639/identifying-the-number-of-positions-then-outputting-the-positions-and-number-in/44408826#44408826", "title": "Identifying the Number of Positions then Outputting the Positions and Number in another Column", "body": "<p>Create \"Temp\" sheet first then execute this VBA below:</p>\n\n<pre><code>    Sub ExtractUnique()\n    Dim sh As Worksheet\n    Dim shTemp As Worksheet\n    Dim LastRow As Long\n\n    Set sh = ActiveSheet 'or change to your sheet name Sheets(\"your sheet\")\n    LastRow = sh.Cells(sh.Rows.Count, \"A\").End(xlUp).Row\n\n   'temporary sheet\n   Set shTemp = ThisWorkbook.Sheets(\"Temp\") 'MAKE SURE YOU CREATE 'Temp' sheet first!!!\n\n   'copy your positions to temporary sheet for manipulation\n   sh.Range(\"A1:A\" &amp; LastRow).Copy\n   shTemp.Range(\"A1\").PasteSpecial xlValues\n   Application.CutCopyMode = False\n\n   'remove duplicates\n   shTemp.Range(\"A1:A\" &amp; LastRow).RemoveDuplicates Columns:=Array(1), Header:=xlYes\n\n   'copy it back to J1 of your original sheet\n   'first check the last row of unique position list\n   LastRow = shTemp.Cells(sh.Rows.Count, \"A\").End(xlUp).Row\n\n   shTemp.Range(\"A1:A\" &amp; LastRow).Copy\n   sh.Range(\"J1\").PasteSpecial xlValues\n   Application.CutCopyMode = False\n\n   'set the formula to count the number of positions\n   sh.Range(\"K2:K\" &amp; LastRow).Formula = \"=COUNTIF(A:A,J2)\"\n\n   End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8124261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688c8025f1d4cf935103a35d44f88b2b?s=128&d=identicon&r=PG&f=1", "display_name": "Terminus", "link": "https://stackoverflow.com/users/8124261/terminus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496828043, "creation_date": 1496824749, "last_edit_date": 1531164843, "question_id": 44407639, "link": "https://stackoverflow.com/questions/44407639/identifying-the-number-of-positions-then-outputting-the-positions-and-number-in", "title": "Identifying the Number of Positions then Outputting the Positions and Number in another Column", "body": "<p><a href=\"https://i.stack.imgur.com/8qCjy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8qCjy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hi everyone, Im new to VBA and StackOverflow. Currently, I am trying to use VBA to create a process to summarise the data that I have collected.The above photo is a part of the long macro process that I am facing issues with. I need to find the number of unique positions in column \"A\" (new positions can be added in over time), then output the unique positions into the positions column in column \"J\". After that, in column \"K\", I would need to count the number of each unique rank.</p>\n\n<p>As of now, I have the following code to find for a position.</p>\n\n<pre><code>Sub test ()\nDim Manager as Integer\nSheets(\"Sheet1\").Select\nManager = Application.WorksheetFunction.CountIf(Range(\"A:A\"), \"Manager\")\n'Output the Manager value anywhere as require\nEnd Sub\n</code></pre>\n\n<p>However, I face challenges in identifying the unique positions, counting the unique positions and then outputting the number of unique positions beside the position. Is this even possible in VBA?</p>\n\n<p>Thanks so much</p>\n"}, {"tags": ["excel", "isnumeric", "vba"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496826314, "post_id": 44407545, "comment_id": 75815192, "body": "Cannot use dropbox here - Could you provide a screenshot or sample &quot;client block&quot; that needs to be transposed? Thank you in advance."}, {"owner": {"reputation": 9, "user_id": 8124131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0413559c90ebc8edfe1212255c4fc2f2?s=128&d=identicon&r=PG&f=1", "display_name": "ansav", "link": "https://stackoverflow.com/users/8124131/ansav"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1497516909, "post_id": 44407545, "comment_id": 76115003, "body": "@RikSportel thanks for the response. I have now added a sample screenshot. Please let me know of your thoughts on this. Thank you"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1512070227, "post_id": 44407545, "comment_id": 82119795, "body": "Just came across this old question today.  Did you solve the problem?  Or do you still need assistance?  If so, do you want to also delete the blank rows, so the entries are contiguous?"}], "owner": {"reputation": 9, "user_id": 8124131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0413559c90ebc8edfe1212255c4fc2f2?s=128&d=identicon&r=PG&f=1", "display_name": "ansav", "link": "https://stackoverflow.com/users/8124131/ansav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512070085, "creation_date": 1496824506, "last_edit_date": 1531164843, "question_id": 44407545, "link": "https://stackoverflow.com/questions/44407545/sort-cells-based-on-cell-content", "title": "Sort cells based on cell content", "body": "<p><a href=\"https://i.stack.imgur.com/rdSng.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rdSng.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What I currently have is clients\u2019 information (name, address, landline or mobile number), all in column A with blank cells in between, and some notes on each client on columns F &amp; G.</p>\n\n<p>What I am looking to do is move the info relevant of each client to the same row as the name (e.g. name @ A1, then address @B1, number (if landline) @ C1 (else @ C2)) and combine the notes of the client into one cell in the same row (F1 = F1 &amp; F2).</p>\n\n<p>We are talking about thousands of rows and multiple workbooks so this needs to be done through VBA.<br>\nPlease find what I have tried so far below:</p>\n\n<pre><code>Sub SORT()\n' Keyboard Shortcut: Ctrl+Shift+M\nDim i As Long, j As Boolean\ni = 1\nj = IsNumeric(ActiveCell.Range(\"A1\"))\nDo\n    If j = True Then    'Check if cell content is numeric\n        If ActiveCell.Range(\"A1\") &lt; 3000000000# Then    'Then if it's a landline\n            Selection.Cut\n            ActiveCell.Offset(-3, 2).Range(\"A1\").Select 'Put it in column C\n            ActiveSheet.Paste\n            ActiveCell.Offset(1, -2).Range(\"A1\").Select 'Go to Address Cell\n        Else\n            Selection.Cut                   'If it is a mobile\n            ActiveCell.Offset(-3, 3).Range(\"A1\").Select 'Put it in column D\n            ActiveSheet.Paste\n            ActiveCell.Offset(1, -3).Range(\"A1\").Select 'Go to Address Cell\n        End If\n        Selection.Cut                   \n        ActiveCell.Offset(-1, 1).Range(\"A1\").Select\n        ActiveSheet.Paste                   'Put the Address to column B\n        ActiveCell.Offset(4, -1).Range(\"A1\").Select     'Go to next cell\n        i = i + 4\n    Else\n        ActiveCell.Offset(1, 0).Range(\"A1\").Select      'If Check if cell content is not numeric, go to next cell\n        i = i + 1\n    End If\nLoop While i &lt;= 100\nEnd Sub\n</code></pre>\n\n<p>Sample File: <a href=\"https://www.dropbox.com/s/uf9yh6fnxl54j55/SAMPLE.xlsx?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/uf9yh6fnxl54j55/SAMPLE.xlsx?dl=0</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1496824360, "post_id": 44407413, "comment_id": 75813821, "body": "A1 probably has value &quot;0&quot; with cell formatting enabled to show &quot;0.00000&quot;, am I right?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496824784, "post_id": 44407413, "comment_id": 75814082, "body": "So 0.0000 is a bad example, excel automatically converts it to 0 for me at least. If i have a cell format with 0.00.. it works just fine. Maybe try <code>Format(i, &quot;#.#####0&quot;)</code> ."}, {"owner": {"reputation": 47, "user_id": 5700602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MiR1PpaLpkk/AAAAAAAAAAI/AAAAAAAAIGk/Es3-pfwL6ps/photo.jpg?sz=128", "display_name": "Dipin ", "link": "https://stackoverflow.com/users/5700602/dipin"}, "edited": false, "score": 0, "creation_date": 1496828092, "post_id": 44407413, "comment_id": 75816524, "body": "Yes, becasue of formatting. So I want to get the same value in vba"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 3, "last_activity_date": 1496824378, "creation_date": 1496824378, "answer_id": 44407502, "question_id": 44407413, "link": "https://stackoverflow.com/questions/44407413/how-to-return-value-from-a-cell-same-as-it-is-in-vba/44407502#44407502", "title": "How to return value from a cell same as it is in vba?", "body": "<p>You are confusing the <em>value</em> of a cell with the <em>textural</em> representation of the value.</p>\n\n<p>If you want the latter then use</p>\n\n<pre><code>Dim s as String\ns = Range(\"A1\").Text\n</code></pre>\n\n<p>But note that a number is simply a number. The quantity of zeros after the decimal separator or the number of zeros before the number does not change the <em>value</em> of that number.</p>\n"}], "owner": {"reputation": 47, "user_id": 5700602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MiR1PpaLpkk/AAAAAAAAAAI/AAAAAAAAIGk/Es3-pfwL6ps/photo.jpg?sz=128", "display_name": "Dipin ", "link": "https://stackoverflow.com/users/5700602/dipin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 44407502, "answer_count": 1, "score": 1, "last_activity_date": 1496826640, "creation_date": 1496824092, "last_edit_date": 1496826640, "question_id": 44407413, "link": "https://stackoverflow.com/questions/44407413/how-to-return-value-from-a-cell-same-as-it-is-in-vba", "title": "How to return value from a cell same as it is in vba?", "body": "<p>How to return value from a cell same as it is in VBA?</p>\n\n<p>For example:<br>\nA1 has \"0.00000\" But when I create a double and store this value in that, it stores as \"0\" But I want it with the same format.</p>\n\n<pre><code>Dim i as Double \ni = Range(\"A1\").Value\n</code></pre>\n\n<p>Result: <code>i = 0</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1496824541, "post_id": 44407391, "comment_id": 75813942, "body": "Can you show us what code you have so far and point out specifically where you are stuck? Is it the Save As? Is it the file format? Is it the automation? Right now your question is too broad, because you don&#39;t show any code and ask about three different aspects."}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "is_accepted": false, "score": 0, "last_activity_date": 1496824906, "creation_date": 1496824906, "answer_id": 44407705, "question_id": 44407391, "link": "https://stackoverflow.com/questions/44407391/vba-convert-xls-to-csv-and-save-it-in-a-certain-path/44407705#44407705", "title": "VBA: convert xls to csv and save it in a certain path", "body": "<p>So far I only got the code below that only converts to csv and saves it in the same location as the original file. <br>\nAlso for some unknown reason it converts HALF of the dates to 05/31/2017 for exemple (and the original format is 31.05.2017).</p>\n\n<pre><code>Sub ConvertXLSToCSV()\n\n    Dim InputPath As String\n\n    Dim PowershellCommand As String\n\n\n\n    ' To suppress excel prompts and alert messages while the macro is running.\n\n    Application.DisplayAlerts = False\n\n    Do\n\n        ' Taking the input excel file path which needs to be converted to .csv format.\n\n        InputPath = InputBox(\"Enter the full path of the input excel file.\", \"Convert XLS to CSV\")\n\n        If Trim(InputPath) &lt;&gt; \"\" Then\n\n            If Dir(InputPath) = vbNullString Then\n\n                MsgBox \"File: '\" &amp; InputPath &amp; \"' doesn't exists.\", vbOKOnly + vbCritical, \"Convert XLS to CSV\"\n\n            ElseIf Split(Dir(InputPath), \".\")(1) = \"xlsx\" Or Split(Dir(InputPath), \".\")(1) = \"xls\" Then\n\n                InputPath = Trim(InputPath)\n\n                ' Opening the input excel file and saving it in .csv using powershell.\n\n                PowershellCommand = \"$ExcelWB = new-object -comobject excel.application\" &amp; vbNewLine\n\n                PowershellCommand = PowershellCommand &amp; \"$ExcelWB = new-object -comobject excel.application\" &amp; vbNewLine\n\n                PowershellCommand = PowershellCommand &amp; \"$ExcelWB.Visible = $false\" &amp; vbNewLine &amp; \"$ExcelWB.DisplayAlerts = $false\" &amp; vbNewLine\n\n                PowershellCommand = PowershellCommand &amp; \"$Workbook = $ExcelWB.Workbooks.Open('\" &amp; InputPath &amp; \"')\" &amp; vbNewLine\n\n                PowershellCommand = PowershellCommand &amp; \"$Workbook.SaveAs('\" &amp; Left(InputPath, (InStrRev(InputPath, \".\", -1, vbTextCompare) - 1)) &amp; \".csv',6)\" &amp; vbNewLine\n\n                PowershellCommand = PowershellCommand &amp; \"$Workbook.Close($false)\" &amp; vbNewLine\n\n                PowershellCommand = PowershellCommand &amp; \"$ExcelWB.quit()\" &amp; vbNewLine\n\n                PowershellCommand = \"Powershell.exe -command \" &amp; PowershellCommand\n\n                Set WshShell = CreateObject(\"WScript.Shell\")\n\n                WshShell.Exec (PowershellCommand)\n\n                Exit Do\n\n            Else:\n\n                MsgBox \"Input file is not in excel (.xlsx/.xls) format.\", vbOKOnly + vbCritical, \"Convert XLS to CSV\"\n\n            End If\n\n        ElseIf StrPtr(InputPath) &lt;&gt; 0 Then MsgBox \"Please enter the full path of the input excel file.\", vbOKOnly + vbExclamation, \"Convert XLS to CSV\"\n\n        End If\n\n    Loop Until StrPtr(InputPath) = 0\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496824906, "creation_date": 1496824030, "last_edit_date": 1531164843, "question_id": 44407391, "link": "https://stackoverflow.com/questions/44407391/vba-convert-xls-to-csv-and-save-it-in-a-certain-path", "title": "VBA: convert xls to csv and save it in a certain path", "body": "<p>Please help me.\nI'm trying to convert a .xls/.xlsx placed on a certain path on a server (let's say one\\test\\1.xls) file to .csv (without damageing the date format or any other info) and save it in a fixed path (let's say one\\result\\1.csv). This process must repeat itself automatically every 24 hours.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "edited": false, "score": 0, "creation_date": 1496825360, "post_id": 44407462, "comment_id": 75814474, "body": "I tried it! It didn&#39;t work! same as the beggining, no error message and no changes :("}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "edited": false, "score": 0, "creation_date": 1496826121, "post_id": 44407462, "comment_id": 75815040, "body": "Hm that&#39;s strange. This runs perfectly here. You&#39;re not on a mac, are you?"}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "edited": false, "score": 0, "creation_date": 1496826633, "post_id": 44407462, "comment_id": 75815425, "body": "It was my mistake :) I have wrote <code>saveChanges:= False</code> so the changes haven&#39;t been saved lol"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "edited": false, "score": 0, "creation_date": 1496826799, "post_id": 44407462, "comment_id": 75815544, "body": "Hahaha yeah happens. Glad you found it."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 1, "last_activity_date": 1496826051, "last_edit_date": 1496826051, "creation_date": 1496824238, "answer_id": 44407462, "question_id": 44407236, "link": "https://stackoverflow.com/questions/44407236/loop-to-unfilter-multiple-excel-workbooks-vba/44407462#44407462", "title": "Loop to unfilter multiple excel workbooks VBA", "body": "<p>The Workbook.Open() method needs a full path and the filename.</p>\n\n<p>Replace </p>\n\n<pre><code> Set y = Workbooks.Open(path)\n</code></pre>\n\n<p>With </p>\n\n<pre><code>Set y = Workbooks.Open(FolderPath &amp; myfile)\n</code></pre>\n\n<p>and you should be good to go.\nYou don't need the path variable.</p>\n\n<p>Edit: I minimized your whole script to the bare minimum to loop through all \"<em>.xls</em>\" files and open all off them within a folder:</p>\n\n<pre><code>Sub OpenWorkbooks()\nDim y As Workbook\nDim myfile As String\nDim FolderPath As String\n\nFolderPath = \"C:\\TestDirectory\\\"\nmyfile = Dir(FolderPath &amp; \"*.xls*\")\n\nDo While myfile &lt;&gt; \"\"\n    Set y = Workbooks.Open(FolderPath &amp; myfile) \n    myfile = Dir()\nLoop\nEnd Sub\n</code></pre>\n\n<p>The above opens each Excel file in <code>C:\\TestDirectory\\</code> on my machine.\nN.b. make sure you have the \"\\\" at the end of the <code>FolderPath</code> variable, otherwise it'll look for <code>C:\\TestDirectorySomeFileName.xlsx</code> which is not going to work.</p>\n"}], "owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496826051, "creation_date": 1496823575, "question_id": 44407236, "link": "https://stackoverflow.com/questions/44407236/loop-to-unfilter-multiple-excel-workbooks-vba", "title": "Loop to unfilter multiple excel workbooks VBA", "body": "<p>I am trying to do a loop to unfilter the column A for all the workbooks (as they are the same, alwyas column A).\nI want to show all the cells as the filter romve the empty cells.\nI have many of folders ( more than 50) so the loop is very useful and important for the next step of my code.</p>\n\n<p>I have a code that works for one folder:</p>\n\n<pre><code>`Sub unfilterr()\nDim y As Workbook, myfile, FolderPath, path\nDim ws As Excel.Worksheet\nSet y = Workbooks.Open(\"Z:\\VBA\\Copie de Devis_65 Version \navec G35.xlsx\")\nWith y.Worksheets(\"Para RF\")\n    If Not y.Worksheets(\"Para RF\").AutoFilter Is Nothing Then\n            y.Sheets(\"Para RF\").Range(\"A1\").AutoFilter Field:=1\n    End If\nEnd With\nEnd Sub`\n</code></pre>\n\n<p>and now trying to do the loop:</p>\n\n<pre><code>`Sub unfilter1()\nDim y As Workbook, myfile, FolderPath, path\nDim ws As Excel.Worksheet\n\n'## Open workbooks first:\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\n\n\nFolderPath = \"Z:\\VBA\\Test\\\"\npath = FolderPath &amp; \"*.xls*\"\nmyfile = Dir(FolderPath &amp; \"*.xls*\")\n\nDo While myfile &lt;&gt; \"\"\n\nSet y = Workbooks.Open(path) 'I put path instead of myfile because I have error if I put myfile\n\nSet ws = y.Worksheets(\"Para RF\")\n'With ws\n    If Not ws.AutoFilter Is Nothing Then\n            y.Sheets(\"Para RF\").Range(\"A1\").AutoFilter Field:=1\n    End If\n'End With\n\nmyfile = Dir()\ny.Close saveChanges:=True\nLoop\n\n\nMsgBox (\"Task Complete\")\nEnd Sub\n</code></pre>\n\n<p>can you please tell what is the problem with this loop!?\nI am trying it on 4 workbooks in the test folder! only the first one is unfiltered while the others are not. It seems like the loop is repeting on only the first workbook in the folder.</p>\n\n<p>So with this loop no error message but the result is unsatisfing.</p>\n\n<p>Thank you a lot for your help.</p>\n\n<p>cheers!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 178, "user_id": 8013180, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cee29fffd3a2bfac21056f92777cd5ce?s=128&d=identicon&r=PG&f=1", "display_name": "Clement B", "link": "https://stackoverflow.com/users/8013180/clement-b"}, "edited": false, "score": 0, "creation_date": 1496822908, "post_id": 44406953, "comment_id": 75812863, "body": "Try to compare <code>Var_Type</code> of <code>strike</code>, <code>Var_Type</code> of <code>.Cells(k, 7).Value</code> , and also <code>Var_Type</code> of <code>sum</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1496823043, "post_id": 44406953, "comment_id": 75812956, "body": "Side note: You need to specify a type for <b>every</b> variable. In <code>Dim sum, price, strike As Double</code> only the last is <code>Double</code> the first two are <code>Variant</code>. Use <code>Dim sum As Double, price As Double, strike As Double</code> instead."}, {"owner": {"reputation": 389, "user_id": 3855618, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/21a524b87e592d42280eeb44daf9add6?s=128&d=identicon&r=PG&f=1", "display_name": "Gannicus", "link": "https://stackoverflow.com/users/3855618/gannicus"}, "reply_to_user": {"reputation": 178, "user_id": 8013180, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cee29fffd3a2bfac21056f92777cd5ce?s=128&d=identicon&r=PG&f=1", "display_name": "Clement B", "link": "https://stackoverflow.com/users/8013180/clement-b"}, "edited": false, "score": 0, "creation_date": 1496823513, "post_id": 44406953, "comment_id": 75813270, "body": "Thanks Peh I applied your advice. @Clement B, if I print the Var_Type of .Cells(k,7).Value it seems to be &quot;Empty&quot;, I don&#39;t understand why."}, {"owner": {"reputation": 178, "user_id": 8013180, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cee29fffd3a2bfac21056f92777cd5ce?s=128&d=identicon&r=PG&f=1", "display_name": "Clement B", "link": "https://stackoverflow.com/users/8013180/clement-b"}, "edited": false, "score": 0, "creation_date": 1496823770, "post_id": 44406953, "comment_id": 75813446, "body": "Try using Sheets(&quot;Feuille1&quot;) instead of Worksheets. I don&#39;t know if it&#39;ll work. If not, show me the column 7 of your worksheet."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1496823923, "post_id": 44406953, "comment_id": 75813536, "body": "Is there a header in Sheet &quot;Feuille1&quot; range &quot;G1&quot;? In that case you&#39;re trying to add a string to the sum, which will lead to type mismatch. If the digits start at row 2, then change to <code>For k = 2 to 5000</code>"}, {"owner": {"reputation": 389, "user_id": 3855618, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/21a524b87e592d42280eeb44daf9add6?s=128&d=identicon&r=PG&f=1", "display_name": "Gannicus", "link": "https://stackoverflow.com/users/3855618/gannicus"}, "edited": false, "score": 0, "creation_date": 1496824230, "post_id": 44406953, "comment_id": 75813737, "body": "It does seem like the problem comes from the k in Cells, since when I replace it with 3 for instance it works."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 178, "user_id": 8013180, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cee29fffd3a2bfac21056f92777cd5ce?s=128&d=identicon&r=PG&f=1", "display_name": "Clement B", "link": "https://stackoverflow.com/users/8013180/clement-b"}, "edited": false, "score": 1, "creation_date": 1496824232, "post_id": 44406953, "comment_id": 75813738, "body": "@ClementB Avoid using <code>Sheets()</code> unless you know why. The <code>worksheets</code> collection only contains worksheets but the <code>sheets</code> object also contains charts etc. So it doesn&#39;t make any sense to use <code>sheets</code> here!"}, {"owner": {"reputation": 389, "user_id": 3855618, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/21a524b87e592d42280eeb44daf9add6?s=128&d=identicon&r=PG&f=1", "display_name": "Gannicus", "link": "https://stackoverflow.com/users/3855618/gannicus"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1496824628, "post_id": 44406953, "comment_id": 75813983, "body": "Thanks to all of you, @Rik Sportel you were right, there was a header in G1. If you want to answer I would accept it."}], "answers": [{"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 1, "last_activity_date": 1496825213, "creation_date": 1496825213, "answer_id": 44407805, "question_id": 44406953, "link": "https://stackoverflow.com/questions/44406953/where-the-type-mismatch-error-13-comes-from-in-this-case/44407805#44407805", "title": "Where the type mismatch error 13 comes from in this case?", "body": "<p>Is there a header in Sheet \"Feuille1\" range \"G1\"? \nIn that case you're trying to add a string to the sum, which will lead to type mismatch. If the digits start at row 2, then change your loop to</p>\n\n<pre><code>For k = 2 to 5000\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 3855618, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/21a524b87e592d42280eeb44daf9add6?s=128&d=identicon&r=PG&f=1", "display_name": "Gannicus", "link": "https://stackoverflow.com/users/3855618/gannicus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 44407805, "answer_count": 1, "score": 0, "last_activity_date": 1496825213, "creation_date": 1496822732, "last_edit_date": 1531164843, "question_id": 44406953, "link": "https://stackoverflow.com/questions/44406953/where-the-type-mismatch-error-13-comes-from-in-this-case", "title": "Where the type mismatch error 13 comes from in this case?", "body": "<p>One of my Excel worksheets contains many data and the cells are in number format. (for instance it is filled with numbers like 1,02458) </p>\n\n<p>In another worksheet I am trying to do some calculus based on the first worksheet, and for this I am using VBA code:</p>\n\n<pre><code>Dim sum, price, strike As Double\nsum= 0\nstrike = 0.02\n\nFor k = 1 To 5000\n\nsum= sum+ Worksheets(\"Feuille1\").Cells(k, 7).Value - strike\n\n\nNext k\n</code></pre>\n\n<p>When I try to run this the line with the sum corresponds to the error 13 type mismatch.</p>\n\n<p>I have tried things such as changing the cell format, and even using Variant instead of Double but it changed nothing. How to avoid the type mismatch ?</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1496823282, "post_id": 44406914, "comment_id": 75813111, "body": "If the user selects the city name from a drop-down why not use that value rather than changing the code?  Store the selected value in a variable and use the variable in the line of code rather than a static value."}, {"owner": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1496823976, "post_id": 44406914, "comment_id": 75813583, "body": "Actually, I remember why now! haha The user does not have to select a city each time the PPT starts up. If they select it once, I need it to be remembered and saved with the PPT file."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1496824424, "post_id": 44406914, "comment_id": 75813866, "body": "Not sure how to store values in PPT, but still must be a better way than changing the code.  How about writing it to a hidden textbox on a slide?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1496860108, "post_id": 44406914, "comment_id": 75838849, "body": "To save values to a PPT file, use Tags.  For example:  ActivePresentation.Tags.Add &quot;CityName&quot;, &quot;Paris&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "edited": false, "score": 0, "creation_date": 1496825676, "post_id": 44407695, "comment_id": 75814697, "body": "That&#39;s a good idea. Like you said, there is probably a better way, but this will definitely do the job. Thanks a lot!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1496824874, "creation_date": 1496824874, "answer_id": 44407695, "question_id": 44406914, "link": "https://stackoverflow.com/questions/44406914/vba-replace-code-in-another-module-using-vba-code/44407695#44407695", "title": "VBA Replace Code in Another Module Using VBA Code", "body": "<p>Add a combo box and a text box to your slide.</p>\n\n<p>With ComboBox1 and TextBox1 on Slide 1 this code moves the value from the combobox to the the textbox:</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    Dim oComboBox As ComboBox\n    Dim oTextBox As TextBox\n\n    Set oComboBox = ActivePresentation.Slides(\"Slide1\").Shapes(\"ComboBox1\").OLEFormat.Object\n    Set oTextBox = ActivePresentation.Slides(\"Slide1\").Shapes(\"TextBox1\").OLEFormat.Object\n\n    oTextBox.Value = oComboBox.Value\n\n    'or\n\n    Slide1.TextBox1.Value = Slide1.ComboBox1.Value\n\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong> Powerpoint isn't my forte so there may be a \"proper\" way to store values in PPT.</p>\n\n<p>You can now retrieve the value from the textbox after the presentation has been saved, closed and re-opened (saying that - the combobox also retained the value when I re-opened it) and use that value in elsewhere in your code.</p>\n"}], "owner": {"reputation": 363, "user_id": 2635559, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/61cb3e93e315799b5227faca6e0eebc1?s=128&d=identicon&r=PG", "display_name": "hunter21188", "link": "https://stackoverflow.com/users/2635559/hunter21188"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 44407695, "answer_count": 1, "score": 0, "last_activity_date": 1496824874, "creation_date": 1496822640, "question_id": 44406914, "link": "https://stackoverflow.com/questions/44406914/vba-replace-code-in-another-module-using-vba-code", "title": "VBA Replace Code in Another Module Using VBA Code", "body": "<p>I have a line of code in one module:</p>\n\n<pre><code>City = \"Paris\"\n</code></pre>\n\n<p>Within a separate module I need to change the name of the city based on what a user selects from a dropdown. I have code that will change the entire line as follows:</p>\n\n<pre><code>Sub ChangeUserCity()\nCall Dictionary.CityLocation\nDim UserChosenCity As String\nDim SL As Long, EL As Long, SC As Long, EC As Long\nDim S As String\nDim Found As Boolean\n\nComboBoxList = Array(CStr(CityName)) 'This is the name of the combodropdown box with the list of city names.\n\nFor Each Ky In ComboBoxList\n'On Error Resume Next\n\nUserChosenCity = dict4.Item(Ky)(0) 'This refers to the dictionary that has the list of city names. It grabs the string (the name of the city).\n\nWith ActivePresentation.VBProject.VBComponents(\"Dictionary\").CodeModule\nSL = 1\nSC = 1\nEL = -1\nEC = -1\nFound = .Find(\"City = \" &amp; \"\"\"\" &amp; \"Paris\" &amp; \"\"\"\", SL, SC, EL, EC, True, False, False)\nIf Found = True Then\nS = .Lines(SL, 1)\nS = Replace(S, \"City = \" &amp; \"\"\"\" &amp; \"Paris\" &amp; \"\"\"\", \"City= \" &amp; \"\"\"\" &amp; UserChosenCity &amp; \"\"\"\")\n.ReplaceLine SL, S\nEnd If\nEnd With\nNext Ky\nEnd Sub\n</code></pre>\n\n<p>The problem with the way this code works is that the city name will not always be \"Paris\". It could be any string (i.e. any city name). So what I really need the code to do is just replace the city name between the quotes with the UserChosenCity. Any idea on how to accomplish this? Thank you!</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 683, "user_id": 7047935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wCtAP.jpg?s=128&g=1", "display_name": "smartobelix", "link": "https://stackoverflow.com/users/7047935/smartobelix"}, "edited": false, "score": 1, "creation_date": 1496823020, "post_id": 44406861, "comment_id": 75812934, "body": "Do you really need to recalculate in each iteration of loop? At first sight it looks like most time consuming part. Isn&#39;t it sufficient to recalculate after operations are done?"}, {"owner": {"reputation": 129, "user_id": 5596201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be81c8c0992c151be4b21c5b81f3ff86?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/5596201/david"}, "reply_to_user": {"reputation": 683, "user_id": 7047935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wCtAP.jpg?s=128&g=1", "display_name": "smartobelix", "link": "https://stackoverflow.com/users/7047935/smartobelix"}, "edited": false, "score": 0, "creation_date": 1496823501, "post_id": 44406861, "comment_id": 75813258, "body": "The range I&#39;m copying is the result of changes in the workbook. So after every iteration in my simulation I want to save the results. The stupid part is that I need to transpose the range, due to make it analog to other result files and the &quot;simulation functions&quot; is easier to work with the way they are rather than transposing the calculations."}, {"owner": {"reputation": 683, "user_id": 7047935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wCtAP.jpg?s=128&g=1", "display_name": "smartobelix", "link": "https://stackoverflow.com/users/7047935/smartobelix"}, "edited": false, "score": 1, "creation_date": 1496828007, "post_id": 44406861, "comment_id": 75816452, "body": "But could you just comment operation <code>Application.Calculate</code> just to see if it is not main reason of slow down? It make no sense to optimize something what is not most time-consuming part. Could be also helpful if you can post some sample of data or at least screenshot presenting what are trying to achieve. BTW in second solution you can for sure move <code>Application.Calculate</code> to outer loop."}, {"owner": {"reputation": 129, "user_id": 5596201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be81c8c0992c151be4b21c5b81f3ff86?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/5596201/david"}, "reply_to_user": {"reputation": 683, "user_id": 7047935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wCtAP.jpg?s=128&g=1", "display_name": "smartobelix", "link": "https://stackoverflow.com/users/7047935/smartobelix"}, "edited": false, "score": 0, "creation_date": 1496829402, "post_id": 44406861, "comment_id": 75817469, "body": "@smartobelix Of course you&#39;re right, it makes little sense optimize something that&#39;s not the most time-consuming part. I&#39;ll look into re-building my model to make it less dependant on <code>Application.Calculate</code>. Also moved out the calculation-operation to the outer loop in the exemples."}], "owner": {"reputation": 129, "user_id": 5596201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be81c8c0992c151be4b21c5b81f3ff86?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/5596201/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496864216, "creation_date": 1496822474, "last_edit_date": 1496829990, "question_id": 44406861, "link": "https://stackoverflow.com/questions/44406861/excel-vba-fastest-way-to-copy-and-transpose-vector", "title": "Excel VBA - Fastest way to copy and transpose vector", "body": "<p>I want to copy and transpose a range multiple times and looking for the fastest way to do this. Have written to different ways which both are quite slow. They look like this:</p>\n\n<pre><code>...\nFor i = 1 To nrofSims\n    simNr = i\n    Application.Calculate\n    Range(Sim.Range(\"Res3Top\").Offset(1, 0), Sim.Range(\"Res3Top\").Offset(simMonths, 0)).Copy\n    Res3.Range(\"A4\").Offset(i, 1).PasteSpecial Paste:=xlPasteValues, Transpose:=True\nNext i\n...\n</code></pre>\n\n<p>and</p>\n\n<pre><code>...\nFor i = 1 To nrofSims\n    simNr = i\n    Application.Calculate\n    For j = 1 To simMonths\n        Res3.Range(\"A4\").Offset(i, j) = Sim.Range(\"Res3Top\").Offset(j, 0).Value\n    Next j\nNext i\n...\n</code></pre>\n\n<p>Is it possible to do something like <code>rangePaste.value = rangeCopy.value</code> and transposing the vector?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Changed to the following code instead which is a little faster. But, as written in the comments, I maybe need the change the way my model is working right now.</p>\n\n<pre><code>...\nDim res3Sim As Range, res3Store As Range\nSet res3Sim = Range(Sim.Range(\"Res3Top\").Offset(1, 0), Sim.Range(\"Res3Top\").Offset(simMonths, 0))\nSet res3Store = Range(Res3.Range(\"A4\"), Res3.Range(\"A4\").Offset(0, simMonths - 1))\n\nDim i As Integer\nFor i = 1 To nrofSims\n    simNr = i\n    Application.Calculate\n    res3Store.Offset(i, 1).Value2 = Application.Transpose(res3Sim.Value2)\nNext i\n...\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496821726, "post_id": 44406536, "comment_id": 75812098, "body": "Can&#39;t you just replace the &quot;H&quot; with whatever column letter the user types into the textbox?"}], "answers": [{"tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 0, "last_activity_date": 1496821842, "creation_date": 1496821842, "answer_id": 44406660, "question_id": 44406536, "link": "https://stackoverflow.com/questions/44406536/set-any-range-with-userform/44406660#44406660", "title": "Set any range with userform", "body": "<pre><code>ws.Range(Var &amp; \"2:\" &amp; Var &amp; lastrow)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8123993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e9a628cc507be43fb31784f4a58c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Svenson", "link": "https://stackoverflow.com/users/8123993/sven-svenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 44406660, "answer_count": 1, "score": 0, "last_activity_date": 1496822029, "creation_date": 1496821480, "last_edit_date": 1496822029, "question_id": 44406536, "link": "https://stackoverflow.com/questions/44406536/set-any-range-with-userform", "title": "Set any range with userform", "body": "<p>I am currently looking for a way to assign a range via UserForm. I've often encountered the example with the RefEdit, which unfortunately does not fit 100% to my problem.</p>\n\n<p>Is there a way where the enduser can assigns a range with a textbox? The User should be asked in which column in his sheet the relevant numerical values are and on that basis, the macro should adjust the range. </p>\n\n<p>For example: \nThe user types the range is in column H and there for the macro adjust to: </p>\n\n<pre><code>ws.Range(\"H2: H\" &amp; lastrow)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1496818200, "post_id": 44405393, "comment_id": 75809942, "body": "yes you can. Do you know the printer name? have you tried any code so fare?"}, {"owner": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1496908056, "post_id": 44405393, "comment_id": 75857219, "body": "Thank you very much. I think I&#39;ve found the way to do it :D"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "edited": false, "score": 0, "creation_date": 1496828452, "post_id": 44406278, "comment_id": 75816767, "body": "Thank you very much! I have tested the code, it works greatly for me. But because I want to choose the default printer by choosing from a list in excel without opening the code and make changes to it every time,  I stored my printer&#39;s names to a variable and tried to replace it with &quot;HP LaserJet 3000&quot;, but it cant work and the com ask me to check the printer&#39;s name... is there any way I can make this right?"}, {"owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "reply_to_user": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "edited": false, "score": 0, "creation_date": 1496831616, "post_id": 44406278, "comment_id": 75819117, "body": "How do you add it to the string? You should concatenate the string like this: <code>............&quot; &amp; PrinterNameVariable &amp; &quot;............</code>"}, {"owner": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "edited": false, "score": 0, "creation_date": 1496886753, "post_id": 44406278, "comment_id": 75849157, "body": "I used the following line:"}, {"owner": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "edited": false, "score": 0, "creation_date": 1496886875, "post_id": 44406278, "comment_id": 75849189, "body": "Sub PrinterSetup()"}, {"owner": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "edited": false, "score": 0, "creation_date": 1496886886, "post_id": 44406278, "comment_id": 75849193, "body": "Dim Printer As String"}, {"owner": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "edited": false, "score": 0, "creation_date": 1496886898, "post_id": 44406278, "comment_id": 75849199, "body": "Printer = range(&quot;c18&quot;).Value"}, {"owner": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "edited": false, "score": 0, "creation_date": 1496886906, "post_id": 44406278, "comment_id": 75849203, "body": "Shell (&quot;RUNDLL32 PRINTUI.DLL,PrintUIEntry /y /n &quot; &amp; Printer &amp; &quot;&quot;)"}, {"owner": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "edited": false, "score": 0, "creation_date": 1496887824, "post_id": 44406278, "comment_id": 75849401, "body": "Just to add: i think maybe the problem is that my printer name contains spaces and the string variable cannot pass the spaces properly so that the code only take the first part of the name before the space......"}, {"owner": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "edited": false, "score": 0, "creation_date": 1496887891, "post_id": 44406278, "comment_id": 75849421, "body": "As i tried one other function and the name mentioned in the msgbox popped up is exactly the first part of my printer&#39;s name"}, {"owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "reply_to_user": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "edited": false, "score": 1, "creation_date": 1496908067, "post_id": 44406278, "comment_id": 75857228, "body": "You need to enclose your printer name in quotes if it contains spaces: <code>Shell &quot;RUNDLL32 PRINTUI.DLL,PrintUIEntry &#47;y &#47;n &quot;&quot;&quot; &amp; Printer &amp; &quot;&quot;&quot;...</code> Note the <b>double quotes.</b>"}], "tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": true, "score": 5, "last_activity_date": 1496821726, "last_edit_date": 1496821726, "creation_date": 1496820669, "answer_id": 44406278, "question_id": 44405393, "link": "https://stackoverflow.com/questions/44405393/how-to-change-the-system-default-printer-using-excel-vba/44406278#44406278", "title": "how to change the system default printer using Excel VBA?", "body": "<p>Yes, it's possible. You need to execute a shell script from your VBA code:</p>\n\n<pre><code>Sub ChangePrinter()\n    Shell \"RUNDLL32 PRINTUI.DLL,PrintUIEntry /y /n \"\"HP LaserJet 3000\"\"\"\nEnd Sub\n</code></pre>\n\n<p>(change <code>HP LaserJet 3000</code> to whatever your printer name is).</p>\n\n<p>If your printer is on network location (e.g. <code>HP LaserJet 3000 on 192.168.1.100</code>) use this syntax:</p>\n\n<pre><code>Shell \"RUNDLL32 PRINTUI.DLL,PrintUIEntry /y /n \"\"\\\\192.168.1.100\\HP LaserJet 3000\"\"\"\n</code></pre>\n\n<p>Also it's possible to change printer settings, but you will need a <code>.dat</code> file with necessary settings.</p>\n\n<p>To get the current settings from printer:</p>\n\n<pre><code>Shell \"RUNDLL32 PRINTUI.DLL,PrintUIEntry /Ss /n \"\"HP LaserJet 3000\"\" /a \"\"C:\\your_settings.dat\"\" u\"\n</code></pre>\n\n<p>To feed the settings file to your printer's driver:</p>\n\n<pre><code>Shell \"RUNDLL32 PRINTUI.DLL,PrintUIEntry /Sr /n \"\"HP LaserJet 3000\"\" /a \"\"C:\\your_settings.dat\"\" u\"\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7450973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ba200021548b25e6fa527e9b2e5289?s=128&d=identicon&r=PG&f=1", "display_name": "Jiaming Yang", "link": "https://stackoverflow.com/users/7450973/jiaming-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2732, "favorite_count": 1, "accepted_answer_id": 44406278, "answer_count": 1, "score": 0, "last_activity_date": 1496821726, "creation_date": 1496817950, "question_id": 44405393, "link": "https://stackoverflow.com/questions/44405393/how-to-change-the-system-default-printer-using-excel-vba", "title": "how to change the system default printer using Excel VBA?", "body": "<p>is there any way in which I can use VBA to change the system default printer? As well as changing its settings? Or is it too much to ask from VBA T-T</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1496825510, "creation_date": 1496825510, "answer_id": 44407900, "question_id": 44405326, "link": "https://stackoverflow.com/questions/44405326/vba-add-text-box-by-clicking-button/44407900#44407900", "title": "vba add text box by clicking button", "body": "<p>You could use code similar to this in your <em>click</em> event of the button:</p>\n\n<pre><code>Me!TextBoxB.Visible = Not IsNull(Me!TextBoxA.Value)\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8062937, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/655dfbcc5bca69c8730796e2c1735924?s=128&d=identicon&r=PG&f=1", "display_name": "jangho yoon", "link": "https://stackoverflow.com/users/8062937/jangho-yoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 44407900, "answer_count": 1, "score": -1, "last_activity_date": 1594639818, "creation_date": 1496817728, "last_edit_date": 1594639818, "question_id": 44405326, "link": "https://stackoverflow.com/questions/44405326/vba-add-text-box-by-clicking-button", "title": "vba add text box by clicking button", "body": "<p>In vba, I need to add textbox by clicking 'Add' button. Is it possible in VBA?\nIf it is, could you possible to share source code?\n<a href=\"https://i.stack.imgur.com/euW3n.png\" rel=\"nofollow noreferrer\">Click here to see more description</a>\nIn the image, after fill in first textbox, which is A, and then click 'Add button', below textbox which is marked as 'B' should appear. \nI know that this kind of thing is possible in web using jquery, but I am new to vba, so I don't know if it is possible or not. \nAny comments would be greatly helpful</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 2303, "user_id": 1716574, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/dcxFb.jpg?s=128&g=1", "display_name": "Picard", "link": "https://stackoverflow.com/users/1716574/picard"}, "edited": false, "score": 2, "creation_date": 1496816380, "post_id": 44404829, "comment_id": 75808853, "body": "Welcome to Stack Overflow, please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Adding your code as a linked screen shot is not a good practice here and makes it difficult to debug and eventually help."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496817447, "post_id": 44404829, "comment_id": 75809472, "body": "The <code>Item</code> argument here is a reference to the email that was sent - you can maybe just display that"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496817526, "post_id": 44404829, "comment_id": 75809513, "body": "@TimWilliams no you can&#39;t, see my answer (the note). The email isn&#39;t sent before the <code>Application_ItemSend</code> event but after."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1496817857, "post_id": 44404829, "comment_id": 75809717, "body": "@Peh - noted, thanks"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7834369, "user_type": "registered", "profile_image": "https://graph.facebook.com/1276580479078248/picture?type=large", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/7834369/ganesh"}, "edited": false, "score": 0, "creation_date": 1496818227, "post_id": 44405238, "comment_id": 75809954, "body": "I got your point.  Please tell me how can I achieve this without itemsend event..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 43, "user_id": 7834369, "user_type": "registered", "profile_image": "https://graph.facebook.com/1276580479078248/picture?type=large", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/7834369/ganesh"}, "edited": false, "score": 0, "creation_date": 1496819642, "post_id": 44405238, "comment_id": 75810816, "body": "@Ganesh As there is no event for <b>after</b> sending an email there is no built-in way but you can try the workaround I added."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1496819945, "last_edit_date": 1496819945, "creation_date": 1496817449, "answer_id": 44405238, "question_id": 44404829, "link": "https://stackoverflow.com/questions/44404829/open-email-after-sending/44405238#44405238", "title": "Open email after sending", "body": "<p>This is the answer <strong>why</strong> this won't work with the <code>Application_ItemSend</code> event:</p>\n\n<p><code>Application_ItemSend</code> is called <strong>before</strong> the email is sent. You can see that because it has a <code>Cancel</code> parameter. This means the email only gets sent if <code>Cancel = False</code> else the email is dropped.</p>\n\n<p>So you just cannot display the email because it isn't sent at this time in the <code>Application_ItemSend</code> event. It gets sent after the <code>Application_ItemSend</code> is finished.</p>\n\n<p><em>Note: If you put a break point within the <code>Application_ItemSend</code> you will see that the \"New Email\" window remains open/visible until the <code>ItemSend</code> event is finished. Therefore you cannot open that email within that event.</em></p>\n\n<hr>\n\n<p><strong>Workaround</strong><br>\nYou might try the following code. This creates an event for the default folder of sent items which is called when an item is added to this folder.</p>\n\n<blockquote>\n  <p>A restart of Outlook might be needed after adding the code (or at least running the <code>Application_Startup</code> procedure once).</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nPublic WithEvents myOlItems As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Set myOlItems = Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderSentMail).Items\nEnd Sub\n\nPrivate Sub myOlItems_ItemAdd(ByVal Item As Object)\n    Item.Display\nEnd Sub\n</code></pre>\n\n<p>If the folder where your sent items are moved to is not the default Outlook sent mail folder then you need to find the right folder to set it in <code>Application_Startup</code>.</p>\n"}], "owner": {"reputation": 43, "user_id": 7834369, "user_type": "registered", "profile_image": "https://graph.facebook.com/1276580479078248/picture?type=large", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/7834369/ganesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1593073162, "creation_date": 1496815990, "last_edit_date": 1593073162, "question_id": 44404829, "link": "https://stackoverflow.com/questions/44404829/open-email-after-sending", "title": "Open email after sending", "body": "<p>Why am I facing the below problem?</p>\n\n<p>I have written a code to open sent email after sending email. The VBA code doesn't open the latest sent email but the previous one.</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    Dim myItem As MailItem\n    Dim myNamespace As NameSpace\n    Dim myFolder As Folder\n\n    Set myNamespace = Application.GetNamespace(\"MAPI\")\n    Set myFolder = myNamespace.GetDefaultFolder(olFolderSentMail)\n    Set myItem = myFolder.Items(myFolder.Items.Count)\n\n    myItem.Display\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1496815312, "post_id": 44404605, "comment_id": 75808313, "body": "All explained clearly here: <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">cpearson.com/excel/errorhandling.htm</a>"}, {"owner": {"reputation": 371, "user_id": 7975744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3299b2920c8c47f5c7d4e63613b54275?s=128&d=identicon&r=PG&f=1", "display_name": "Quint", "link": "https://stackoverflow.com/users/7975744/quint"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496815727, "post_id": 44404605, "comment_id": 75808519, "body": "@TimWilliams So <code>Resume</code> Would be a working solution instead of <code>GoTo AskAgianLoop</code>? In your link there is a section that says &quot;you must ensure that your error handling block fixed the problem that caused the initial error. Otherwise, your code will enter an endless loop, jumping between the line of code that caused the error and the error handling block.&quot;. This is what I want to happen."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496815839, "post_id": 44404605, "comment_id": 75808572, "body": "Don&#39;t you need some way to exit that loop, in case it gets stuck ?  You could add a counter, to exit after some number of tries..."}, {"owner": {"reputation": 371, "user_id": 7975744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3299b2920c8c47f5c7d4e63613b54275?s=128&d=identicon&r=PG&f=1", "display_name": "Quint", "link": "https://stackoverflow.com/users/7975744/quint"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496816227, "post_id": 44404605, "comment_id": 75808762, "body": "@TimWilliams I want it to prompt them untill they click open. I just test <code>Resume</code> and it does get stuck in a loop and does not prompt agian. Not what I want to happen. How is <code>Resume &lt;label&gt;</code> used?"}, {"owner": {"reputation": 371, "user_id": 7975744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3299b2920c8c47f5c7d4e63613b54275?s=128&d=identicon&r=PG&f=1", "display_name": "Quint", "link": "https://stackoverflow.com/users/7975744/quint"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496816874, "post_id": 44404605, "comment_id": 75809143, "body": "@TimWilliams <code>Resume AskAgianLoop:</code> Works perfectly. Thank you for the link."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496817107, "post_id": 44404605, "comment_id": 75809280, "body": "Good to hear - I always forget exactly how it goes, and that&#39;s a good reference for checking my thoughts..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496821456, "post_id": 44404605, "comment_id": 75811929, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/44364013/on-error-goto-label-incorrectly-works\">On Error goto &lt;label&gt; (incorrectly works)</a>"}, {"owner": {"reputation": 371, "user_id": 7975744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3299b2920c8c47f5c7d4e63613b54275?s=128&d=identicon&r=PG&f=1", "display_name": "Quint", "link": "https://stackoverflow.com/users/7975744/quint"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496822390, "post_id": 44404605, "comment_id": 75812503, "body": "@YowE3K What did you seach for to find this? Edit: Never mind seen that it is your answer lol."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496827632, "post_id": 44404605, "comment_id": 75816190, "body": "Yes - I remembered answering that question a day or two ago so I knew this question could definitely be classed as a duplicate of it.  There are a lot more that could be found by googling <code>site:stackoverflow.com excel-vba error handler not working</code>."}], "answers": [{"tags": [], "owner": {"reputation": 371, "user_id": 7975744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3299b2920c8c47f5c7d4e63613b54275?s=128&d=identicon&r=PG&f=1", "display_name": "Quint", "link": "https://stackoverflow.com/users/7975744/quint"}, "is_accepted": true, "score": 0, "last_activity_date": 1496816933, "creation_date": 1496816933, "answer_id": 44405087, "question_id": 44404605, "link": "https://stackoverflow.com/questions/44404605/error-handler-not-catching-error/44405087#44405087", "title": "Error handler not catching Error", "body": "<p>Changing <code>GoTo AskAgianLoop</code> to <code>Resume AskAgianLoop:</code> Fixed the issue.</p>\n"}], "owner": {"reputation": 371, "user_id": 7975744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3299b2920c8c47f5c7d4e63613b54275?s=128&d=identicon&r=PG&f=1", "display_name": "Quint", "link": "https://stackoverflow.com/users/7975744/quint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 44405087, "answer_count": 1, "score": 0, "last_activity_date": 1594655250, "creation_date": 1496815063, "last_edit_date": 1594655250, "question_id": 44404605, "link": "https://stackoverflow.com/questions/44404605/error-handler-not-catching-error", "title": "Error handler not catching Error", "body": "<p>This issue I am having is my Error handler is not catching an error if it occurs more then 2 times. This is what im useing.</p>\n\n<pre><code>Private Sub DBBackUp()\nOn Error GoTo ErrHandler:\nIf FSO.FolderExists(DBBackupFolderDir) = True And FSO.FileExists(DBDir) = True Then\n\nAskAgianLoop:\n\n    Application.CompactRepair DBDir, CARDBBackupFileDir, True\nEnd if\n\n\nErrHandler:\nIf Err.Number = 58 Or Err.Number = 31523 Then\n    GoTo AskAgianLoop\nElse\n  errMsg = \"Error number: \" &amp; Str(Err.Number) &amp; vbNewLine &amp; _\n           \"Source: \" &amp; Err.Source &amp; vbNewLine &amp; _\n           \"Description: \" &amp; Err.Description\nDebug.Print errMsg\nErr.Clear\nEnd If\nExit Sub\nEnd Sub\n</code></pre>\n\n<p>The above will prompt, with a security warning, the user 2 times each time its ran. If the user clicks cancel on one of them instead of open it will throw an error code with the value of <code>31523</code>. It is then moved to the ErrHandler. Which will then ask the user again with the same security prompt. If the user presses cancel more than 2 times an error message with the value of <code>31523</code> shows and does not get caught by the Error handler.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3333, "user_id": 3138531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a9a9881a8fedbbd3048ebdfced5ef3a?s=128&d=identicon&r=PG", "display_name": "serakfalcon", "link": "https://stackoverflow.com/users/3138531/serakfalcon"}, "edited": false, "score": 1, "creation_date": 1496815061, "post_id": 44404565, "comment_id": 75808200, "body": "You can&#39;t; this operating as expected to prevent code from executing without users consent. You can mark the document as trusted &amp; educate users to click the button."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496816750, "post_id": 44404565, "comment_id": 75809085, "body": "Or you can digitally sign your VBA codes with a certificate and trust this certificate in Windows. See <a href=\"https://support.office.com/en-us/article/Digitally-sign-a-macro-project-6e5de679-01d4-4387-85e0-92e3e9a49483\" rel=\"nofollow noreferrer\">Microsoft support: Digitally sign a macro project</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496815398, "post_id": 44404632, "comment_id": 75808350, "body": "That&#39;s right. Someone had the problem that it still didnt work after disabling, then just add the folder with your file to trusted locations. Didnt want to post another answer."}], "tags": [], "owner": {"reputation": 7304, "user_id": 750250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DlSqt.jpg?s=128&g=1", "display_name": "Conrad Lotz", "link": "https://stackoverflow.com/users/750250/conrad-lotz"}, "is_accepted": false, "score": 1, "last_activity_date": 1496815494, "last_edit_date": 1496815494, "creation_date": 1496815159, "answer_id": 44404632, "question_id": 44404565, "link": "https://stackoverflow.com/questions/44404565/how-to-open-excel-with-vba-macros-without-warning/44404632#44404632", "title": "How to open Excel with VBA Macros without warning", "body": "<p>One can go to Excel Options -> Trust Center on the Trust Center button -> under External Content choose the Enable All Data Connections option.\n<a href=\"https://i.stack.imgur.com/4CmeM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4CmeM.png\" alt=\"enter image description here\"></a></p>\n\n<p>In Excel go to Options -> Trust Center -> Protected View and disable all three options\n<a href=\"https://i.stack.imgur.com/Bia3x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Bia3x.png\" alt=\"enter image description here\"></a></p>\n\n<p>Last option is to enable all macro content<a href=\"https://i.stack.imgur.com/aZnq2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aZnq2.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 29, "user_id": 6288806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5ba2c1bbd08e66fc55c33c4226895e?s=128&d=identicon&r=PG&f=1", "display_name": "Neetha", "link": "https://stackoverflow.com/users/6288806/neetha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2802, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1496815494, "creation_date": 1496814880, "last_edit_date": 1531161705, "question_id": 44404565, "link": "https://stackoverflow.com/questions/44404565/how-to-open-excel-with-vba-macros-without-warning", "title": "How to open Excel with VBA Macros without warning", "body": "<p>I created Excel using VBA macros but for opening this .xls sheet it is asking permission like enable content before opening. </p>\n\n<p>Please check the screen shot where I marked with red color.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IwVyr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IwVyr.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want avoid that warning from code or back end, So please suggest something how to avoid it. </p>\n"}, {"tags": ["vba", "checkbox", "ms-word"], "comments": [{"owner": {"reputation": 29, "user_id": 7706732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9e27a0bb91ce3f7d4945389f84d596d?s=128&d=identicon&r=PG&f=1", "display_name": "Damon M", "link": "https://stackoverflow.com/users/7706732/damon-m"}, "edited": false, "score": 0, "creation_date": 1496815354, "post_id": 44404382, "comment_id": 75808329, "body": "see above code for desired end result haha. sorry the code just wont look nice in here."}, {"owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "edited": false, "score": 0, "creation_date": 1496815380, "post_id": 44404382, "comment_id": 75808347, "body": "Could you not just uncheck any other checkbox, once you find one checked?"}, {"owner": {"reputation": 29, "user_id": 7706732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9e27a0bb91ce3f7d4945389f84d596d?s=128&d=identicon&r=PG&f=1", "display_name": "Damon M", "link": "https://stackoverflow.com/users/7706732/damon-m"}, "reply_to_user": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "edited": false, "score": 0, "creation_date": 1496815555, "post_id": 44404382, "comment_id": 75808434, "body": "basically I want  checkboxa=false (checkbox 1, 2 and 3 greyed out) checkboxb=false (checkbox 4, 5 and 6 greyed out) etc. I want checkboxa+b to ungrey the other checkboxes if they =true."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496815659, "post_id": 44404382, "comment_id": 75808486, "body": "It&#39;s not clear what the problem is here.  What is meant by &quot;with the correct terms&quot; ?"}, {"owner": {"reputation": 29, "user_id": 7706732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9e27a0bb91ce3f7d4945389f84d596d?s=128&d=identicon&r=PG&f=1", "display_name": "Damon M", "link": "https://stackoverflow.com/users/7706732/damon-m"}, "edited": false, "score": 0, "creation_date": 1496815881, "post_id": 44404382, "comment_id": 75808590, "body": "Don&#39;t worry -.-&#39;&#39; the code works now but didn&#39;t 5 minutes ago. I hate coding."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7706732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9e27a0bb91ce3f7d4945389f84d596d?s=128&d=identicon&r=PG&f=1", "display_name": "Damon M", "link": "https://stackoverflow.com/users/7706732/damon-m"}, "edited": false, "score": 0, "creation_date": 1496882669, "post_id": 44406015, "comment_id": 75848230, "body": "Nah the code I posted above works now but it wasn&#39;t working before and I couldn&#39;t figure out why. thank you for posting the above code though can use that somewhere for sure! :)"}], "tags": [], "owner": {"reputation": 713, "user_id": 4715656, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/6wq0Q.jpg?s=128&g=1", "display_name": "Gowire", "link": "https://stackoverflow.com/users/4715656/gowire"}, "is_accepted": true, "score": 1, "last_activity_date": 1496819933, "creation_date": 1496819933, "answer_id": 44406015, "question_id": 44404382, "link": "https://stackoverflow.com/questions/44404382/grey-out-checkbox2-and-checkbox3-unless-checkbox1-true/44406015#44406015", "title": "grey out checkbox2 and checkbox3 unless checkbox1 = true", "body": "<p>Is this what you're asking for? When checkbox1 is true, the other will be grey... and vice versa... </p>\n\n<pre><code>Private Sub CheckBox1_Click()\n    If CheckBox1.Value = True Then\n        CheckBox2.Enabled = False\n        CheckBox3.Enabled = False\n    Else\n        CheckBox2.Enabled = True\n        CheckBox3.Enabled = True\n    End If        \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7706732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9e27a0bb91ce3f7d4945389f84d596d?s=128&d=identicon&r=PG&f=1", "display_name": "Damon M", "link": "https://stackoverflow.com/users/7706732/damon-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 44406015, "answer_count": 1, "score": 0, "last_activity_date": 1496819933, "creation_date": 1496814148, "last_edit_date": 1496815519, "question_id": 44404382, "link": "https://stackoverflow.com/questions/44404382/grey-out-checkbox2-and-checkbox3-unless-checkbox1-true", "title": "grey out checkbox2 and checkbox3 unless checkbox1 = true", "body": "<p>Another VBA dilemma for you.</p>\n\n<p>I have checkbox1, checkbox2 and checkbox3.\nI would like checkbox2 and checkbox3 to be greyed out if checkbox1=true\nI have used a code similar for greying out a textbox</p>\n\n<pre><code>    Private Sub CheckBox1_Click()\n    Dim en As Boolean\n    en = Not CheckBox1.Value\n    EnableControls Array(tbappgn, tbappfn), en\n\n'utility sub: enable/disable controls\nPrivate Sub EnableControls(cons, bEnable As Boolean)\n    Dim con\n    For Each con In cons\n        With con\n            .Enabled = bEnable\n            .BackColor = IIf(bEnable, vbWhite, RGB(200, 200, 200))\n        End With\n    Next con\nEnd Sub\n</code></pre>\n\n<p>Just having an issue with getting the same code to work on other checkboxes.</p>\n\n<p>Can add the checkbox numbers to the code above but I don't want that checkbox to be the trigger to grey/un grey the other checkboxes</p>\n\n<p>something like this but with the correct terms.</p>\n\n<pre><code>Private Sub CheckBox11_Click()\n Dim en As Boolean\n   en = Not CheckBox11.Value\n    EnableControls Array(checkbox12, checkbox13), en\n\n    Private Sub CheckBox15_Click()\n    Dim en As Boolean\n    en = Not CheckBox15.Value\n    EnableControls Array(checkbox16, checkbox17), en\n\nPrivate Sub EnableControls(cons, bEnable As Boolean)\n    Dim con\n    For Each con In cons\n        With con\n            .Enabled = bEnable\n            .BackColor = IIf(bEnable, vbWhite, RGB(200, 200, 200))\n        End With\n    Next con\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8106575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0f77e25313d5e6fa59644559f39bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Danger.Close", "link": "https://stackoverflow.com/users/8106575/danger-close"}, "edited": false, "score": 0, "creation_date": 1496872453, "post_id": 44404335, "comment_id": 75845168, "body": "Hi Sid, thank you so much for lightning fast response ONCE AGAIN. In fact, that is the first thing I tried. I did stumble across this link from msdn. Since, I wasn&#39;t sure, i tried all option in screenshot above, one by one. Problem I face is, unlike in your perfect screenshot, after macro is done pasting the data in word, I see blue dotted lines i.e a tabular format and it doesn&#39;t wrap up the text. Cell range that I&#39;m trying to paste from excel has lot of text. After pasting to word, it doesn&#39;t wrap up the text; instead, pastes it as table (half visible text). See attached please."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25, "user_id": 8106575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0f77e25313d5e6fa59644559f39bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Danger.Close", "link": "https://stackoverflow.com/users/8106575/danger-close"}, "edited": false, "score": 0, "creation_date": 1496897105, "post_id": 44404335, "comment_id": 75851543, "body": "I dont see anything attached?"}, {"owner": {"reputation": 25, "user_id": 8106575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0f77e25313d5e6fa59644559f39bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Danger.Close", "link": "https://stackoverflow.com/users/8106575/danger-close"}, "edited": false, "score": 0, "creation_date": 1496917369, "post_id": 44404335, "comment_id": 75863402, "body": "Here&#39;s a screenshot link. Sorry, I couldn&#39;t find a way to attach it here through comments. <a href=\"https://prnt.sc/fhc58m\" rel=\"nofollow noreferrer\">prnt.sc/fhc58m</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25, "user_id": 8106575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0f77e25313d5e6fa59644559f39bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Danger.Close", "link": "https://stackoverflow.com/users/8106575/danger-close"}, "edited": false, "score": 0, "creation_date": 1496921565, "post_id": 44404335, "comment_id": 75866147, "body": "Strange. I do not get those lines."}, {"owner": {"reputation": 25, "user_id": 8106575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0f77e25313d5e6fa59644559f39bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Danger.Close", "link": "https://stackoverflow.com/users/8106575/danger-close"}, "edited": false, "score": 0, "creation_date": 1496964519, "post_id": 44404335, "comment_id": 75891485, "body": "Hi, apologies for delay in responding. Just came back from work. No worries. Possibly because I&#39;m using excel 2007. I shall consider it as resolved. Thank you once again for your help."}, {"owner": {"reputation": 25, "user_id": 8106575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0f77e25313d5e6fa59644559f39bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Danger.Close", "link": "https://stackoverflow.com/users/8106575/danger-close"}, "edited": false, "score": 0, "creation_date": 1496976670, "post_id": 44404335, "comment_id": 75894264, "body": "Hi Siddhath, I mange to sort it by hit and trial. Posting few solutions that may work for other fellow users. Problem: Somehow, after running macro to paste excel cells to word, it was pasting it as a table (table1). Below solution helped me wrap up text, adjust table height and width, fit to window etc. Those blue lines in screenshot that I pasted above are simply print layout view (default in word 2007). It doesn&#39;t appear in print outs though. Print layout option is word 2007 is in view tab."}, {"owner": {"reputation": 25, "user_id": 8106575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0f77e25313d5e6fa59644559f39bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Danger.Close", "link": "https://stackoverflow.com/users/8106575/danger-close"}, "edited": false, "score": 0, "creation_date": 1496976922, "post_id": 44404335, "comment_id": 75894329, "body": "Also, you may want to check your word options and fiddle around with following: Word round button on top left &gt; Word option &gt; Advanced &gt; Cut, Copy and paste section &gt; Pasting from other program + check smart cut &amp; paste + settings nexting to smart cut &amp; paste (there are options here as well). Code that helped me wrap up my table 1 within A6 paper size and allowed me to define table height and width is as follows:"}, {"owner": {"reputation": 25, "user_id": 8106575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0f77e25313d5e6fa59644559f39bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Danger.Close", "link": "https://stackoverflow.com/users/8106575/danger-close"}, "edited": false, "score": 0, "creation_date": 1496977147, "post_id": 44404335, "comment_id": 75894388, "body": "Range(&quot;L19:L38&quot;).Copy With objWord .Selection.PasteSpecial Link:=False, DataType:=wdPasteHTML, Placement:=wdInLine, DisplayAsIcon:=False  With ActiveDocument.Tables(1) .PreferredWidthType = wdPreferredWidthPoints .PreferredWidth = 230 HeightRule = wdRowHeightAtLeast ActiveDocument.Tables(1).Rows.Height = 8 ActiveDocument.Tables(1).Rows.WrapAroundText = True ActiveDocument.Range.ParagraphFormat.SpaceAfter = 0  End With  Useful: .PreferredWidthType = wdPreferredWidthPoints .PreferredWidth = 230 .AutoFitBehavior wdAutoFitWindow HeightRule = wdRowHeightAuto"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25, "user_id": 8106575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0f77e25313d5e6fa59644559f39bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Danger.Close", "link": "https://stackoverflow.com/users/8106575/danger-close"}, "edited": false, "score": 0, "creation_date": 1496984953, "post_id": 44404335, "comment_id": 75896384, "body": "I would recommend posting it as an answer :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 3, "last_activity_date": 1496813906, "creation_date": 1496813906, "answer_id": 44404335, "question_id": 44404160, "link": "https://stackoverflow.com/questions/44404160/paste-data-from-excel-to-word/44404335#44404335", "title": "Paste data from Excel to Word", "body": "<p><code>wdPasteText</code> is supposed to copy across just text. It doesn't copy across any formatting. <code>Bold</code> and <code>Underline</code> are part of formatting. If you want the formatting to be copied across then you can use <code>wdPasteHTML</code>. </p>\n\n<pre><code>With objWord\n    .Selection.PasteSpecial Link:=False, DataType:=wdPasteHTML, _\n    Placement:=wdInLine, DisplayAsIcon:=False\nEnd With\n</code></pre>\n\n<p><strong>Screenshot</strong>\n<a href=\"https://i.stack.imgur.com/Q6mQ7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q6mQ7.png\" alt=\"enter image description here\"></a></p>\n\n<p>For other option see this KB article</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff197265.aspx\" rel=\"nofollow noreferrer\">WdPasteDataType Enumeration (Word)</a>\n<a href=\"https://i.stack.imgur.com/ybAzU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ybAzU.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 8106575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0f77e25313d5e6fa59644559f39bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Danger.Close", "link": "https://stackoverflow.com/users/8106575/danger-close"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "accepted_answer_id": 44404335, "answer_count": 1, "score": 1, "last_activity_date": 1496814013, "creation_date": 1496813096, "last_edit_date": 1496814013, "question_id": 44404160, "link": "https://stackoverflow.com/questions/44404160/paste-data-from-excel-to-word", "title": "Paste data from Excel to Word", "body": "<p>I have been searching this site and there appears to be numerous articles on <code>datatype:=wdpastetext</code>. However, I couldn't still find solution for issue that I have encountered with part of my code.</p>\n\n<p>I'm copying data from excel to word <code>L19 to L38</code> as text. However, some of the rows from <code>L19</code> to <code>L38</code> are bold and underlined and I would like to retain that formatting. Code below is simply pasting it as normal text without bold or underline.</p>\n\n<p>Any help would be appreciated.</p>\n\n<pre><code>Range(\"L19:L38\").Copy\nWith objWord\n    .Selection.PasteSpecial Link:=False, DataType:=wdPasteText, _\n     Placement:=wdInLine, DisplayAsIcon:=False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 319, "user_id": 8114542, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-dpU-0jvdTqA/AAAAAAAAAAI/AAAAAAAABnA/0LoYJHQQnZ4/photo.jpg?sz=128", "display_name": "kanav anand", "link": "https://stackoverflow.com/users/8114542/kanav-anand"}, "edited": false, "score": 0, "creation_date": 1496812849, "post_id": 44404087, "comment_id": 75807321, "body": "i have used  Application.WorksheetFunction.VLookup but it gives an error when the value is not present in sheet,"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1496813762, "post_id": 44404087, "comment_id": 75807644, "body": "Use <code>Application.VLookup</code> instead an you can test the return value using <code>IsError()</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496814748, "post_id": 44404087, "comment_id": 75808049, "body": "I am sorry I did not understand this <code>excel file which is opened in a loop is not present</code> Are you referring to <code>sheetname</code> ? You will have to show more code especially where you are opening the file and assigning <code>sheetname</code>"}, {"owner": {"reputation": 319, "user_id": 8114542, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-dpU-0jvdTqA/AAAAAAAAAAI/AAAAAAAABnA/0LoYJHQQnZ4/photo.jpg?sz=128", "display_name": "kanav anand", "link": "https://stackoverflow.com/users/8114542/kanav-anand"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496815494, "post_id": 44404087, "comment_id": 75808402, "body": "@SiddharthRout suppose i am working on sheet A. there is a folder which contain multiple files, in every loop there is a excel file B which gets opened from that folder a now i lookup a value from file A to File B."}, {"owner": {"reputation": 319, "user_id": 8114542, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-dpU-0jvdTqA/AAAAAAAAAAI/AAAAAAAABnA/0LoYJHQQnZ4/photo.jpg?sz=128", "display_name": "kanav anand", "link": "https://stackoverflow.com/users/8114542/kanav-anand"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496815853, "post_id": 44404087, "comment_id": 75808576, "body": "@SiddharthRout one more thing, the value i am looking up(selrow) is a string. it is always showing zero in the cell(2,&quot;q&quot;). suppose Selrow =&quot;DZ1024&quot; when i =2 the cell( 2,&quot;q&quot;) is showing <b>=IFERROR(VLOOKUP(DZ1024,&#39;[0601 Stock Dump.xlsb]Sheet1&#39;!$A$4:$B$4656,2,FALSE),0)</b> it must show &quot;DZ1024&quot; in order to achieve true value"}], "owner": {"reputation": 319, "user_id": 8114542, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-dpU-0jvdTqA/AAAAAAAAAAI/AAAAAAAABnA/0LoYJHQQnZ4/photo.jpg?sz=128", "display_name": "kanav anand", "link": "https://stackoverflow.com/users/8114542/kanav-anand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496812729, "creation_date": 1496812729, "question_id": 44404087, "link": "https://stackoverflow.com/questions/44404087/formula-inside-loop", "title": "Formula inside loop?", "body": "<p>i have applied this formlua where a particular sheet gets opened from a <strong>file</strong> and a particular value which is <strong>selrow</strong> gets looked up in that sheet.\nthis whole thing is in loop so <strong>file</strong> and selrow both are changing as the i changes.\nand sometimes it also possible that <strong>selrow</strong> is not there in sheet or may be the excel <strong>file</strong> which is opened in a loop is not present,in that case i want the value to be zero.</p>\n\n<pre><code>Cells(i, \"q\").Formula = \"=IFERROR(VLOOKUP(\" &amp;selrow&amp; \"\",\"'[\" &amp;sheetname&amp; \"]Sheet1'!$A$4:$B$4656,2,FALSE),0)\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496814058, "post_id": 44403708, "comment_id": 75807767, "body": "&quot;doesn&#39;t work&quot; is not a very useful description of your problem. What happens when you run your code?"}, {"owner": {"reputation": 41, "user_id": 4282278, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/659182315/picture?type=large", "display_name": "Wilson M&#233;ndez Pe&#241;alosa", "link": "https://stackoverflow.com/users/4282278/wilson-m%c3%a9ndez-pe%c3%b1alosa"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496846971, "post_id": 44403708, "comment_id": 75830949, "body": ".Border properties aren&#39;t applied. The edge top border color of the cell is not changed after the macro is played."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496857028, "post_id": 44403708, "comment_id": 75837238, "body": "Your border formatting lines work for me.  Are you sure they&#39;re getting executed?  If you place a break on one of those lines does the code stop there?"}, {"owner": {"reputation": 41, "user_id": 4282278, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/659182315/picture?type=large", "display_name": "Wilson M&#233;ndez Pe&#241;alosa", "link": "https://stackoverflow.com/users/4282278/wilson-m%c3%a9ndez-pe%c3%b1alosa"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496965431, "post_id": 44403708, "comment_id": 75891696, "body": "Yes the macro is executed. Code lines before and after <code>.Border</code> properties are executed. If I place a break the code stop there."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4282278, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/659182315/picture?type=large", "display_name": "Wilson M&#233;ndez Pe&#241;alosa", "link": "https://stackoverflow.com/users/4282278/wilson-m%c3%a9ndez-pe%c3%b1alosa"}, "edited": false, "score": 0, "creation_date": 1496969072, "post_id": 44447394, "comment_id": 75892549, "body": "Yes, now I see it works! The problem is that my table starts at row # 8, so the correct reference for the <code>DataBodyRange </code> is <code>ultima fila - 8</code>. Thank you!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1496966972, "creation_date": 1496966972, "answer_id": 44447394, "question_id": 44403708, "link": "https://stackoverflow.com/questions/44403708/change-border-color-of-a-single-cell-inside-a-table/44447394#44447394", "title": "Change border color of a single cell inside a Table", "body": "<p>With this test code:</p>\n\n<pre><code>Sub Test()\n\n    With ActiveSheet.ListObjects(1).ListColumns(1).DataBodyRange(6, 1).Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 3\n        .Weight = xlThick\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I get this result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2lNIc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2lNIc.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, your formatting code works fine for me.<br>\nDo you maybe have some Conditional Formatting or some other formatting applied to that sheet? </p>\n"}], "owner": {"reputation": 41, "user_id": 4282278, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/659182315/picture?type=large", "display_name": "Wilson M&#233;ndez Pe&#241;alosa", "link": "https://stackoverflow.com/users/4282278/wilson-m%c3%a9ndez-pe%c3%b1alosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1231, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496966972, "creation_date": 1496810806, "last_edit_date": 1531164843, "question_id": 44403708, "link": "https://stackoverflow.com/questions/44403708/change-border-color-of-a-single-cell-inside-a-table", "title": "Change border color of a single cell inside a Table", "body": "<p>I have a named table as range (list object) and I need to change the edge top border color of one cell but the code doesn\u00b4t works, i need some help. Here is part of the code:</p>\n\n<pre><code>With ws\n    .Unprotect Password:=\"pAtRiCiA\"\n\n    For Each ctrl In Me.Controls\n        If Left(ctrl.Name, 5) = \"texto\" Then\n            If ultimafila - 1 &lt;&gt; 8 Then\n                If ctrl.Name = \"textoCausas\" Then\n                    If Not IsError(Application.Match(Me.textoCausas.Value, ws.ListObjects(ActiveSheet.Name).ListColumns(1).DataBodyRange, 0)) Then\n                        .Cells(ultimafila, ctrl.TabIndex) = \"\"\n                        .ListObjects(ActiveSheet.Name).ListColumns(1).DataBodyRange(ultimafila, 1).Borders(xlEdgeTop).LineStyle = xlContinuous\n                        .ListObjects(ActiveSheet.Name).ListColumns(1).DataBodyRange(ultimafila, 1).Borders(xlEdgeTop).ColorIndex = 3\n                        .ListObjects(ActiveSheet.Name).ListColumns(1).DataBodyRange(ultimafila, 1).Borders(xlEdgeTop).Weight = xlThick\n                    Else\n                        .Cells(ultimafila, ctrl.TabIndex) = ctrl.Value\n                    End If\n                Else\n                    .Cells(ultimafila, ctrl.TabIndex) = ctrl.Value\n                End If\n            Else\n                .Cells(ultimafila, ctrl.TabIndex) = ctrl.Value\n            End If\n        End If\n    Next ctrl\n    .Cells(ultimafila, 2) = txtControles.Value\n\n    .Rows(ultimafila).AutoFit\n    .Rows(ultimafila).RowHeight = .Cells(ultimafila, 1).Height + 12\n    .Protect Password:=\"pAtRiCiA\", DrawingObjects:=True, Contents:=True, Scenarios:=True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496811948, "post_id": 44403538, "comment_id": 75807018, "body": "Try <a href=\"https://stackoverflow.com/questions/19659224/pivotcaches-add-errors-out\">THIS</a> Specally how you change it to R1C1 <code>MyPivotRangeName = &quot;&#39;&quot; &amp; ws.Name &amp; &quot;&#39;!&quot; &amp; MyPivotRange.Address(ReferenceStyle = xlR1C1)</code> and then use that"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496822536, "post_id": 44403538, "comment_id": 75812597, "body": "Code runs fine here, the above as well as the reference style that Siddarth suggests. See <a href=\"https://msdn.microsoft.com/en-us/library/aa264979(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa264979(v=vs.60).aspx</a> for Type Mismatch error generic info."}], "owner": {"reputation": 97, "user_id": 8106719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a1d02c026f5e2c924fe1f8872373b58f?s=128&d=identicon&r=PG&f=1", "display_name": "AmadeusNing", "link": "https://stackoverflow.com/users/8106719/amadeusning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496809822, "creation_date": 1496809822, "question_id": 44403538, "link": "https://stackoverflow.com/questions/44403538/vba-error-type-mismatch-when-create-a-pivot-table", "title": "VBA Error (Type MIsmatch) when create a pivot table", "body": "<p>Hi I'm working on my VBA code to set a range based on the last row in my source data and then create a pivot table on that range.  The messagebox gives me the right last row number in source data. However the last line here goes wrong when I run the code with error (Error type mismatch).Could you please help me to fix? thanks. </p>\n\n<pre><code>Dim PvtTbl As pivotTable\nDim wsData As Worksheet\nDim rngData As Range\nDim PvtTblCache As PivotCache\nDim wsPvtTbl As Worksheet\nDim pvtFld As PivotField\n\n\nSet wsData = Worksheets(\"Task List Data Export\")\n\nSet wsPvtTbl = Worksheets(\"Summary\")\n\nwsPvtTbl.Cells.Clear\nwsPvtTbl.Cells.ColumnWidth = 10\n\nFor Each PvtTbl In wsPvtTbl.PivotTables\nIf MsgBox(\"Delete existing PivotTable!\", vbYesNo) = vbYes Then\nPvtTbl.TableRange2.Clear\nEnd If\nNext PvtTbl\n\nDim last As Long\n\nWith Worksheets(\"Task List Data Export\")\n    last = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\nEnd With\nMsgBox last\n\nSet rngData = Nothing\n\nWith wsData\nSet rngData = wsData.Range(.Cells(1, 1), .Cells(last, 15))\nEnd With\n\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=rngData, Version:=xlPivotTableVersion12).CreatePivotTable TableDestination:=wsPvtTbl.Range(\"B25\"), TableName:=\"PivotTable1\", DefaultVersion:=xlPivotTableVersion12\n</code></pre>\n\n<p>This code worked perfectly with my original data source. However I generated the source file today (updated) and then the code is no longer working. I don't think there is a big problem with the source data because I can still create pivot table manually with defined range. </p>\n\n<p>Any ideas? Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496810246, "post_id": 44403390, "comment_id": 75806435, "body": "(a) Are you using VB.Net or VBA?  Update the tag if it isn&#39;t VB.Net.  (b) Post your current code so that we can help you (c) The macros tag says &quot;<b><i>DO NOT USE for VBA / MS-Office languages. Use the respective [vba] tags instead.</i></b> A macro is a rule or pattern that specifies how a certain input sequence (often a sequence of characters) should be mapped to an output sequence (also often a sequence of characters) according to a defined procedure.&quot; - are you sure that tag is appropriate?"}, {"owner": {"reputation": 7, "user_id": 6006421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wNeVyf1uDWI/AAAAAAAAAAI/AAAAAAAAAMM/k13sz6RdwVg/photo.jpg?sz=128", "display_name": "Will", "link": "https://stackoverflow.com/users/6006421/will"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496820397, "post_id": 44403390, "comment_id": 75811256, "body": "I am new to stack overflow..it got auto selected. I dont hv the code ready with me to put here...I am trying to get something... kindly help!!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496821185, "post_id": 44403390, "comment_id": 75811748, "body": "It&#39;s very hard to help you fix your code until we can see your code.  Hopefully someone will notice the edit go through when you <b>do</b> have the code with you so that you can paste it in, and be able to help you then.  But from what I have seen, you get more people wanting to help you in the first hour after the question is posted than you do in the rest of its life on the site."}], "owner": {"reputation": 7, "user_id": 6006421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wNeVyf1uDWI/AAAAAAAAAAI/AAAAAAAAAMM/k13sz6RdwVg/photo.jpg?sz=128", "display_name": "Will", "link": "https://stackoverflow.com/users/6006421/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496821210, "creation_date": 1496808975, "last_edit_date": 1531164843, "question_id": 44403390, "link": "https://stackoverflow.com/questions/44403390/macro-for-sorting-and-sumif", "title": "Macro for sorting and Sumif", "body": "<p>In a worksheet, I have 5 columns, 1st column contain the file name. I have to split the file name in team,branch,location and week wise in preceding columns. after that have to apply filter and first filter on week from Oldest to newest then on location A to Z. I have 3 weeks data in each report. At the end of the last row, I want to add 3 more row of respective weeks and sum the respective weeks data.i.e eq. for 22-May-17, the next column should add only the data of the row of the same date.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bj9bh.png\" rel=\"nofollow noreferrer\">table image</a></p>\n"}, {"tags": ["excel", "batch-file", "thunderbird", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496809512, "post_id": 44403125, "comment_id": 75806236, "body": "<code>... customer\\&quot; &amp; Range(&quot;M4&quot;).Text &amp; &quot;\\&quot; &amp; Range(&quot;J4&quot;).Text &amp; &quot;.pdf ....</code> but I&#39;m not sure where that should go in your code because the code doesn&#39;t appear to match the question."}, {"owner": {"reputation": 13, "user_id": 8122951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/277dc7884fbe61b699c113b53918e256?s=128&d=identicon&r=PG&f=1", "display_name": "Dalton", "link": "https://stackoverflow.com/users/8122951/dalton"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496839528, "post_id": 44403125, "comment_id": 75824906, "body": "Yeah, I had things changed as I was testing and needed to also change stuff for posting online.  Thanks for your response."}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1496815122, "creation_date": 1496815122, "answer_id": 44404624, "question_id": 44403125, "link": "https://stackoverflow.com/questions/44403125/email-attachment-only-working-when-statically-coded-excel-visual-basic/44404624#44404624", "title": "Email Attachment only working when statically coded - Excel Visual Basic", "body": "<p>Add this before that line</p>\n\n<pre><code>Dim FlName As String\n\nFlName = \"C:\\Users\\Desktop2017\\Desktop\\customer\\\" &amp; Range(\"M4\").Value &amp; \"\\\" &amp; Range(\"J4\").Value &amp; \".pdf\"\n</code></pre>\n\n<p>and then change the line</p>\n\n<pre><code>\"&amp;#44&lt;BR&gt;&lt;BR&gt;Please see attached.&lt;BR&gt;&lt;BR&gt;Thanks&amp;#44 Dalton.&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;Contact Info Text Line 1&lt;BR&gt;Contact Info Text Line 2&lt;BR&gt;Contact Info Text Line 3&lt;/BODY&gt;&lt;/HTML&gt;\"\",attachment=C:\\Users\\Desktop2017\\Desktop\\test\\script\\someFile.txt\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>\"&amp;#44&lt;BR&gt;&lt;BR&gt;Please see attached.&lt;BR&gt;&lt;BR&gt;Thanks&amp;#44 Dalton.&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;Contact Info Text Line 1&lt;BR&gt;Contact Info Text Line 2&lt;BR&gt;Contact Info Text Line 3&lt;/BODY&gt;&lt;/HTML&gt;\"\",attachment=\" &amp; FlName\n</code></pre>\n\n<p><strong>Note</strong>: To concatenate strings, use <code>&amp;</code> instead of <code>+</code></p>\n"}], "owner": {"reputation": 13, "user_id": 8122951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/277dc7884fbe61b699c113b53918e256?s=128&d=identicon&r=PG&f=1", "display_name": "Dalton", "link": "https://stackoverflow.com/users/8122951/dalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 44404624, "answer_count": 1, "score": 1, "last_activity_date": 1496815122, "creation_date": 1496807186, "last_edit_date": 1531164843, "question_id": 44403125, "link": "https://stackoverflow.com/questions/44403125/email-attachment-only-working-when-statically-coded-excel-visual-basic", "title": "Email Attachment only working when statically coded - Excel Visual Basic", "body": "<p>Everything is working for me in sending an email with an attachment from Excel using Visual Basic via Thunderbird when the attachment path is hard-coded. </p>\n\n<pre><code>attachment=C:\\Users\\Desktop2017\\Desktop\\customer\\customerNumber\\invoiceNumber.pdf\"\n</code></pre>\n\n<p>But I need to change part of the file path for attachment based on what's in cell M4 and have the file name change based on what's in cell J4.</p>\n\n<p>Example: M4 value is currently 101.  J4 value is currently 2000-01. The output should be \"C:\\Users\\Desktop2017\\Desktop\\customer\\101\\2000-01.pdf\"</p>\n\n<p>I have tried using 'Range' to get the value and setting a string but instead of getting the data from the cell or string it just outputs whatever I have after the equals sign.</p>\n\n<p>I've tried adding and moving quotation marks around but nothing has worked at this point.</p>\n\n<p>Thanks in advance for any help, Dalton.</p>\n\n<p>PS: Sorry for hobbled together code.</p>\n\n<pre><code>Private Sub EmailInvoice_Click()\n\nDim FileNumber As Integer\nDim retVal As Variant\nDim strName As String\nDim strFile As String\nDim wsCustomer As Worksheet\n\n\nstrName = Range(\"Q2\").Value\nstrFile = Dir(strFolder &amp; \"*.xlsx\")\nConst MY_FILENAME = \"C:\\Users\\Desktop2017\\Dropbox\\temp\\invoice.BAT\"\n\n\nFileNumber = FreeFile\n\n 'create batch file\nOpen MY_FILENAME For Output As #FileNumber\nPrint #FileNumber, \"cd \"\"C:\\Program Files (x86)\\Mozilla Thunderbird\"\"\"\nPrint #FileNumber, \"thunderbird -compose\"; _\n\" to=\" + ThisWorkbook.Sheets(\"hourlyInvoice01\").Range(\"N21\") _\n+ \",subject=Invoice \" + ThisWorkbook.Sheets(\"hourlyInvoice01\").Range(\"J4\") + \",format=\"; 1; _\n\",body=\"\"&lt;HTML&gt;&lt;BODY&gt;Hello    \"; ThisWorkbook.Sheets(\"hourlyInvoice01\").Range(\"N20\") _\n+ \"&amp;#44&lt;BR&gt;&lt;BR&gt;Please see attached.&lt;BR&gt;&lt;BR&gt;Thanks&amp;#44 Dalton.&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;Contact Info Text Line 1&lt;BR&gt;Contact Info Text Line 2&lt;BR&gt;Contact Info Text Line 3&lt;/BODY&gt;&lt;/HTML&gt;\"\",attachment=C:\\Users\\Desktop2017\\Desktop\\test\\script\\someFile.txt\"\n\nPrint #FileNumber, \"exit\"\nClose #FileNumber\n\n 'run batch file\nretVal = Shell(MY_FILENAME, vbNormalFocus)\n\n ' NOTE THE BATCH FILE WILL RUN, BUT THE CODE WILL CONTINUE TO RUN.\nIf retVal = 0 Then\n    MsgBox \"An Error Occured\"\n    Close #FileNumber\n    End\nEnd If\n\n 'Delete batch file\n'Kill MY_FILENAME\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "concatenation"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8122934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7dfd84dcda0e44ad88f18854f422b7?s=128&d=identicon&r=PG&f=1", "display_name": "deeproyalblue", "link": "https://stackoverflow.com/users/8122934/deeproyalblue"}, "edited": false, "score": 0, "creation_date": 1496837725, "post_id": 44408166, "comment_id": 75823586, "body": "Thank you - This got rid of the error, but then I got the same error in the outer loop on the  ~ID_prev = rs_source![ConcatID].Value~ line.  I added an ~If rs_source.EOF~ to that and that seems to have solved it.  It seems like it is ignoring the EOF conditionals.  Any idea why?  Thanks for your help"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 41, "user_id": 8122934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7dfd84dcda0e44ad88f18854f422b7?s=128&d=identicon&r=PG&f=1", "display_name": "deeproyalblue", "link": "https://stackoverflow.com/users/8122934/deeproyalblue"}, "edited": false, "score": 0, "creation_date": 1496838423, "post_id": 44408166, "comment_id": 75824125, "body": "OK, great. No, it is not ignoring it, but both conditions are validated. Thus, if any fails, so will the complete expression."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1496826256, "creation_date": 1496826256, "answer_id": 44408166, "question_id": 44402851, "link": "https://stackoverflow.com/questions/44402851/access-vba-run-time-error-3021-no-current-record-concatenating-multiple-rows/44408166#44408166", "title": "Access VBA Run-time error &#39;3021&#39; No current record - Concatenating multiple rows into one row", "body": "<p>That's because a record can't be read when the recordset reaches EOF. Thus:</p>\n\n<pre><code>    Do While Not rs_source.EOF\n        If ID_prev = rs_source![ConcatID].Value Then\n            Exit Do\n        Else\n            MajorList = rs_source![Major].Value &amp; \"; \" &amp; MajorList 'concatenate majors\n            rs_source.MoveNext\n        End If\n    Loop\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8122934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7dfd84dcda0e44ad88f18854f422b7?s=128&d=identicon&r=PG&f=1", "display_name": "deeproyalblue", "link": "https://stackoverflow.com/users/8122934/deeproyalblue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 547, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594651086, "creation_date": 1496804926, "last_edit_date": 1594651086, "question_id": 44402851, "link": "https://stackoverflow.com/questions/44402851/access-vba-run-time-error-3021-no-current-record-concatenating-multiple-rows", "title": "Access VBA Run-time error &#39;3021&#39; No current record - Concatenating multiple rows into one row", "body": "<p>For each \"ConcatID\", I want to concatenate \"Major\" into one row separated by a \";\"</p>\n\n<pre><code>Source table:\nConcatID    Major\nA           Math\nA           English\nA           Theatre\nB           Math\nC           Biology\n\nTarget table:\nA           Math; English; Theatre\nB           Math\nC           Biology\n</code></pre>\n\n<p>The code runs and performs what I need it to do, but I get this error \"Run-time error '3021' No current record\" on this line of code </p>\n\n<pre><code>Do While (ID_prev = rs_source![ConcatID].Value And Not (rs_source.EOF))\n</code></pre>\n\n<p>.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nSub Concat()\n    Dim dbs As DAO.Database\n\n    Dim rs_source As DAO.Recordset\n    Dim rs_target As DAO.Recordset\n\n    Dim MajorList As String 'Placeholder for concatenating list of college majors\n    Dim ID_prev As String 'Retains ID from previous record\n\n    Set dbs = CurrentDb\n    Set rs_source = dbs.OpenRecordset(\"tbl_ConcatMajorsSource\") 'many records per student/college\n    Set rs_target = dbs.OpenRecordset(\"tbl_ConcatMajorsTarget\") 'one record per student/college\n    dbs.Execute (\"DELETE * FROM tbl_ConcatMajorsTarget\") 'clear out table\n\n    ID_prev = rs_source![ConcatID].Value ' set equal to first ID\n    MajorList = rs_source![Major].Value ' set equal to first major\n    rs_source.MoveNext ' move to the second record\n\n    Do While Not (rs_source.EOF)\n        Do While (ID_prev = rs_source![ConcatID].Value And Not (rs_source.EOF))\n            MajorList = rs_source![Major].Value &amp; \"; \" &amp; MajorList 'concatenate majors\n            rs_source.MoveNext\n        Loop\n        rs_target.AddNew ' add new record in target table\n        rs_target![ConcatID].Value = ID_prev ' populate ID\n        rs_target![Major].Value = MajorList ' populate MajorList\n        rs_target.Update\n        ID_prev = rs_source![ConcatID].Value ' set ID_prev to the new ID\n        MajorList = \"\" 'blank out MajorList\n    Loop\n\n    rs_source.Close\n    rs_target.Close\n    Set rs_source = Nothing\n    Set rs_target = Nothing\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "sum", "decimal", "vba"], "comments": [{"owner": {"reputation": 3333, "user_id": 3138531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a9a9881a8fedbbd3048ebdfced5ef3a?s=128&d=identicon&r=PG", "display_name": "serakfalcon", "link": "https://stackoverflow.com/users/3138531/serakfalcon"}, "edited": false, "score": 0, "creation_date": 1496804094, "post_id": 44402723, "comment_id": 75805084, "body": "Use the <code>Round</code> function"}], "answers": [{"tags": [], "owner": {"reputation": 514, "user_id": 6646873, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f3UWOhUpbzo/AAAAAAAAAAI/AAAAAAAAABc/bfsXmNsu_fo/photo.jpg?sz=128", "display_name": "Anderson Marques", "link": "https://stackoverflow.com/users/6646873/anderson-marques"}, "is_accepted": true, "score": 1, "last_activity_date": 1496804418, "creation_date": 1496804418, "answer_id": 44402797, "question_id": 44402723, "link": "https://stackoverflow.com/questions/44402723/how-can-i-get-this-value-to-2-decimal-places/44402797#44402797", "title": "How can I get this value to 2 decimal places?", "body": "<p>Try:</p>\n\n<pre><code>dub = Round(Application.Sum(wb.Sheets(\"Sheet1\").range(\"A:A\")),2)\n</code></pre>\n\n<p>Round(number, precision) function rounds numbers according to the specified precision. </p>\n\n<p>Hope I have helped you! </p>\n"}], "owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3552, "favorite_count": 0, "accepted_answer_id": 44402797, "answer_count": 1, "score": 0, "last_activity_date": 1496804418, "creation_date": 1496803939, "last_edit_date": 1531164843, "question_id": 44402723, "link": "https://stackoverflow.com/questions/44402723/how-can-i-get-this-value-to-2-decimal-places", "title": "How can I get this value to 2 decimal places?", "body": "<p>dub = Application.Sum(wb.Sheets(\"Sheet1\").range(\"A:A\"))</p>\n\n<p>I have tried .numberformat \"0.00\" and setting the variable type as double with no luck.  </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 97, "user_id": 8106719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a1d02c026f5e2c924fe1f8872373b58f?s=128&d=identicon&r=PG&f=1", "display_name": "AmadeusNing", "link": "https://stackoverflow.com/users/8106719/amadeusning"}, "edited": false, "score": 0, "creation_date": 1496805432, "post_id": 44402637, "comment_id": 75805406, "body": "************************Update*************************"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496805434, "post_id": 44402637, "comment_id": 75805407, "body": "Always qualify <code>Cells</code>, etc, to specify which sheet it is referring to - that last line is effectively <code>Set rngData = Worksheets(&quot;Task List Data Export&quot;).Range(ActiveSheet.Cells(1, 1), ActiveSheet.Cells(last, 15))</code> and you can&#39;t find a range on one worksheet between the cells on a different worksheet."}, {"owner": {"reputation": 97, "user_id": 8106719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a1d02c026f5e2c924fe1f8872373b58f?s=128&d=identicon&r=PG&f=1", "display_name": "AmadeusNing", "link": "https://stackoverflow.com/users/8106719/amadeusning"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496805584, "post_id": 44402637, "comment_id": 75805432, "body": "@YowE3K Hi Thank you very much for your tips. This is so useful to clear up my confusion :)"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 8106719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a1d02c026f5e2c924fe1f8872373b58f?s=128&d=identicon&r=PG&f=1", "display_name": "AmadeusNing", "link": "https://stackoverflow.com/users/8106719/amadeusning"}, "edited": false, "score": 0, "creation_date": 1496805365, "post_id": 44402871, "comment_id": 75805394, "body": "Thank you. This fixed. However when I go to the next line (updated above) which is used to generate the pivot table, Error(Type mismatch) appears. Do you have any ideas? thanks."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 97, "user_id": 8106719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a1d02c026f5e2c924fe1f8872373b58f?s=128&d=identicon&r=PG&f=1", "display_name": "AmadeusNing", "link": "https://stackoverflow.com/users/8106719/amadeusning"}, "edited": false, "score": 0, "creation_date": 1496805584, "post_id": 44402871, "comment_id": 75805431, "body": "@AmadeusNing - Please don&#39;t change the question after someone has successfully answered it.  If you have a new problem, you should raise a new question."}, {"owner": {"reputation": 97, "user_id": 8106719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a1d02c026f5e2c924fe1f8872373b58f?s=128&d=identicon&r=PG&f=1", "display_name": "AmadeusNing", "link": "https://stackoverflow.com/users/8106719/amadeusning"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496805998, "post_id": 44402871, "comment_id": 75805508, "body": "@YowE3K hi thank you for you advice. However I can only raise one question within 90 minutes."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1496805103, "creation_date": 1496805103, "answer_id": 44402871, "question_id": 44402637, "link": "https://stackoverflow.com/questions/44402637/vba-error-occurs-when-set-a-range-1004-application-defined-error/44402871#44402871", "title": "VBA Error occurs when set a range - 1004 Application Defined Error", "body": "<p>the code would be like this</p>\n\n<pre><code>With Worksheets(\"Task List Data Export\")\n    Set rngData = .Range(.Cells(1, 1), .Cells(last, 15))\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 8106719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a1d02c026f5e2c924fe1f8872373b58f?s=128&d=identicon&r=PG&f=1", "display_name": "AmadeusNing", "link": "https://stackoverflow.com/users/8106719/amadeusning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496805510, "creation_date": 1496803319, "last_edit_date": 1496805510, "question_id": 44402637, "link": "https://stackoverflow.com/questions/44402637/vba-error-occurs-when-set-a-range-1004-application-defined-error", "title": "VBA Error occurs when set a range - 1004 Application Defined Error", "body": "<p>Hi I'm working on my VBA code to set a range based on the last row in my source data and then create a pivot table on that range. However the last line here goes wrong when I run the code with error 1004 (application defined error). I feel all the variables have been defined and should be alright. The messagebox also gives me the right last row number in source data. Could you please help me to fix? thanks. </p>\n\n<pre><code>    Dim PvtTbl As pivotTable\n    Dim wsData As Worksheet\n    Dim rngData As Range\n    Dim PvtTblCache As PivotCache\n    Dim wsPvtTbl As Worksheet\n    Dim pvtFld As PivotField\n\n    Set wsData = Worksheets(\"Task List Data Export\")\n    Set wsPvtTbl = Worksheets(\"Summary\")\n\n    wsPvtTbl.Cells.Clear\n    wsPvtTbl.Cells.ColumnWidth = 10\n\n    For Each PvtTbl In wsPvtTbl.PivotTables\n    If MsgBox(\"Delete existing PivotTable!\", vbYesNo) = vbYes Then\n    PvtTbl.TableRange2.Clear\n    End If\n    Next PvtTbl\n\n    Dim last As Long\n\n    With Worksheets(\"Task List Data Export\")\n        last = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    End With\n    MsgBox last\n    Set rngData = Worksheets(\"Task List Data Export\").Range(Cells(1, 1), Cells(last, 15))\n</code></pre>\n\n<p>************************Update************************\nHi I applied Dy.Lee's code and this error finally disappeared. However my next line goes wrong again (Error type mismatch)</p>\n\n<pre><code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=rngData, Version:=xlPivotTableVersion12).CreatePivotTable TableDestination:=wsPvtTbl.Range(\"B25\"), TableName:=\"PivotTable1\", DefaultVersion:=xlPivotTableVersion12\n</code></pre>\n\n<p>Any Ideas? Thanks again</p>\n"}, {"tags": ["excel", "unix", "awk", "vba"], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 2234431, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4df82aefd70646edef646fafcdc3dc4c?s=128&d=identicon&r=PG", "display_name": "Gan", "link": "https://stackoverflow.com/users/2234431/gan"}, "edited": false, "score": 0, "creation_date": 1496807317, "post_id": 44402870, "comment_id": 75805754, "body": "Thanks alot Akshay, i will check this one soon."}, {"owner": {"reputation": 167, "user_id": 2234431, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4df82aefd70646edef646fafcdc3dc4c?s=128&d=identicon&r=PG", "display_name": "Gan", "link": "https://stackoverflow.com/users/2234431/gan"}, "edited": false, "score": 0, "creation_date": 1496807425, "post_id": 44402870, "comment_id": 75805771, "body": "Suppose if i have differnt values for the same filed.like below, how can i change the script @akshay Hegde  5,Brand,Running 5,Brand,Running1  Output: 5,Running/Running1,,,,,,,,M"}, {"owner": {"reputation": 167, "user_id": 2234431, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4df82aefd70646edef646fafcdc3dc4c?s=128&d=identicon&r=PG", "display_name": "Gan", "link": "https://stackoverflow.com/users/2234431/gan"}, "edited": false, "score": 0, "creation_date": 1496807838, "post_id": 44402870, "comment_id": 75805851, "body": "Sorry i have modified the question to include duplicate Scenarios."}], "tags": [], "owner": {"reputation": 14904, "user_id": 3161993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56e8M.png?s=128&g=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3161993/akshay"}, "is_accepted": false, "score": 0, "last_activity_date": 1496805609, "last_edit_date": 1496805609, "creation_date": 1496805091, "answer_id": 44402870, "question_id": 44402557, "link": "https://stackoverflow.com/questions/44402557/convert-the-columns-into-horizontal-pivot/44402870#44402870", "title": "convert the columns into Horizontal PIVOT", "body": "<p><strong>Input</strong></p>\n\n<pre><code>akshay@db-3325:/tmp$ cat data.txt \n1,Brand,sports\n1,Color,White\n1,Gender,Male\n1,Logo,yes\n1,width,10\n4,Brand,Running\n4,width,12\n4,Fits,Lose\n3,catgegory,shoe\n3,Color,blue\n3,primarycolor,blue\n5,size,M\n5,Brand,Running\n</code></pre>\n\n<p><strong>Script</strong></p>\n\n<pre><code>akshay@db-3325:/tmp$ cat pivot.awk \n{   \n     id=$1; name=$2; value=$3\n     ids[id]; \n     # this is to retain order\n     if(!(name in tmp)){ tmp[name]; names[++c]=name; }\n     values[id,name] = value\n}\nEND {\n     # comment below line if you hide \"id\"\n     printf \"id\"\n\n     for (name in names) {\n         printf \"%s%s\",OFS,names[name]\n     }\n     print \"\"\n     for (id in ids) {\n         printf \"%s\",id\n         for (name in names) {\n             printf \"%s%s\",OFS,values[id,names[name]]\n         } print \"\"\n     }\n}\n</code></pre>\n\n<p><strong>Execution and Output</strong></p>\n\n<pre><code>akshay@db-3325:/tmp$ awk -v FS=, -v OFS=, -f pivot.awk data.txt \nid,Brand,Color,Gender,Logo,width,Fits,catgegory,primarycolor,size\n1,sports,White,Male,yes,10,,,,\n3,,blue,,,,,shoe,blue,\n4,Running,,,,12,Lose,,,\n5,Running,,,,,,,,M\n</code></pre>\n\n<p><strong>This produces o/p same as expected o/p including order</strong></p>\n\n<pre><code>akshay@db-3325:/tmp$ cat pivot_with_order.awk \n{   \n     id=$1; name=$2; value=$3\n\n     # this is to retain order\n     if(!(id in itmp)){ itmp[id]; ids[++i]=id; } \n     if(!(name in tmp)){ tmp[name]; names[++c]=name; }\n\n     values[id,name] = value\n}\nEND {\n     # uncomment below line if you want to display \"id\"\n     # printf \"id\"\n\n     for (name in names) {\n         printf \"%s%s\",OFS,names[name]\n     }\n     print \"\"\n     for (id in ids) {\n         printf \"%s\",ids[id]\n         for (name in names) {\n             printf \"%s%s\",OFS,values[ids[id],names[name]]\n         } print \"\"\n     }\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>akshay@db-3325:/tmp$ awk -v FS=, -v OFS=, -f pivot_with_order.awk data.txt \n,Brand,Color,Gender,Logo,width,Fits,catgegory,primarycolor,size\n1,sports,White,Male,yes,10,,,,\n4,Running,,,,12,Lose,,,\n3,,blue,,,,,shoe,blue,\n5,Running,,,,,,,,M\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1496816986, "creation_date": 1496816986, "answer_id": 44405097, "question_id": 44402557, "link": "https://stackoverflow.com/questions/44402557/convert-the-columns-into-horizontal-pivot/44405097#44405097", "title": "convert the columns into Horizontal PIVOT", "body": "<p>Excel VBA:</p>\n\n<pre><code>Sub Pivot()\n\n    Dim rngData, rngOut, r, c, dR, dC\n    Set dR = CreateObject(\"scripting.dictionary\")\n    Set dC = CreateObject(\"scripting.dictionary\")\n\n    Set rngData = ActiveSheet.Range(\"A2:C2\") '&lt;&lt; first row of input\n    Set rngOut = ActiveSheet.Range(\"G2\")     '&lt;&lt; where to put output\n\n    Do While Application.CountA(rngData) &gt; 0\n        r = rngData(1)\n        c = rngData(2)\n        If Not dR.exists(r) Then\n            dR.Add r, dR.Count + 1\n            rngOut.Offset(dR.Count, 0) = r\n        End If\n        If Not dC.exists(c) Then\n            dC.Add c, dC.Count + 1\n            rngOut.Offset(0, dC.Count) = c\n        End If\n\n        With rngOut.Offset(dR(r), dC(c))\n            'if already has a value, add a newline separator\n            .Value = .Value &amp; IIf(.Value &lt;&gt; \"\", vbLf, \"\") &amp; rngData(3)\n        End With\n        Set rngData = rngData.Offset(1, 0)\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 321, "user_id": 3219646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bSFOB.png?s=128&g=1", "display_name": "g.kov", "link": "https://stackoverflow.com/users/3219646/g-kov"}, "is_accepted": false, "score": 0, "last_activity_date": 1496872936, "creation_date": 1496872936, "answer_id": 44423509, "question_id": 44402557, "link": "https://stackoverflow.com/questions/44402557/convert-the-columns-into-horizontal-pivot/44423509#44423509", "title": "convert the columns into Horizontal PIVOT", "body": "<p><strong>Python 2.7</strong></p>\n\n<p>Assuming that <code>list.csv</code> is:</p>\n\n<pre><code>1,Brand,sports\n1,Color,White\n1,Gender,Male\n1,Logo,yes\n1,width,10\n4,Brand,Running\n4,width,12\n4,Fits,Lose\n3,catgegory,shoe\n3,Color,blue\n3,Color,white\n3,primarycolor,blue\n5,size,M\n5,Brand,Sports\n5,Brand,Running\n</code></pre>\n\n<p>Python code in <code>un.py</code>:</p>\n\n<pre><code># up.py\n#\nimport csv\nrowid={};  colid={};  tab={};  rowTitle=[];  colTitle=[]\nwith open('list.csv', 'rb') as csvfile:\n  v = csv.reader(csvfile)\n  for row in v:\n    rowid[row[0]]=1;  colid[row[1]]=1;  k=row[0]+\"@\"+row[1]\n    if tab.has_key(k):\n      tab[k]=tab[k]+\"/\"+row[2]        \n    else:\n      tab[k]=row[2]\n\nrowTitle=rowid.keys(); colTitle=colid.keys()\nrowTitle.sort();  colTitle.sort();\n\ns=\"\"\nfor j in colTitle: s=s+\",\"+j \nprint s\nfor i in rowTitle:\n  s=i\n  for j in colTitle:\n    k=i+\"@\"+j\n    s=s+\",\"\n    if tab.has_key(k):\n      s=s+tab[k]  \n  print s\n</code></pre>\n\n<p><code>py un.py</code> output is:</p>\n\n<pre><code>,Brand,Color,Fits,Gender,Logo,catgegory,primarycolor,size,width\n1,sports,White,,Male,yes,,,,10\n3,,blue/white,,,,shoe,blue,,\n4,Running,,Lose,,,,,,12\n5,Sports/Running,,,,,,,M,\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 2234431, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4df82aefd70646edef646fafcdc3dc4c?s=128&d=identicon&r=PG", "display_name": "Gan", "link": "https://stackoverflow.com/users/2234431/gan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1496872936, "creation_date": 1496802745, "last_edit_date": 1531161705, "question_id": 44402557, "link": "https://stackoverflow.com/questions/44402557/convert-the-columns-into-horizontal-pivot", "title": "convert the columns into Horizontal PIVOT", "body": "<p>I have 3 column file with ID,name and value .</p>\n\n<pre><code>1,Brand,sports\n1,Color,White\n1,Gender,Male\n1,Logo,yes\n1,width,10\n4,Brand,Running\n4,width,12\n4,Fits,Lose\n3,catgegory,shoe\n3,Color,blue\n3,Color,white\n3,primarycolor,blue\n5,size,M\n5,Brand,Sports\n5,Brand,Running\n</code></pre>\n\n<p>I'm trying to convert this into a horizontal format based on the column 1 and column 2.</p>\n\n<p>It's similar to the Pivot table with text values printed, it can't be done using Excel pivot it will allow only sum/count of values.</p>\n\n<p>Can this be generated in UNIX?</p>\n\n<pre><code>,Brand,Color,Gender,Logo,width,Fits,catgegory,primarycolor,size\n1,sports,White,Male,yes,10,,,,\n4,Running,,,,12,Lose,,,\n3,,blue/white,,,,,shoe,blue,\n5,Sports/Running,,,,,,,,M\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5979186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/463e7e1aeb81d9e6e407caaa49804b90?s=128&d=identicon&r=PG&f=1", "display_name": "yael", "link": "https://stackoverflow.com/users/5979186/yael"}, "edited": false, "score": 0, "creation_date": 1496804941, "post_id": 44402463, "comment_id": 75805304, "body": "I tried it, and has no errors, but there&#39;s no data appearing on the other workbook"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 5, "user_id": 5979186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/463e7e1aeb81d9e6e407caaa49804b90?s=128&d=identicon&r=PG&f=1", "display_name": "yael", "link": "https://stackoverflow.com/users/5979186/yael"}, "edited": false, "score": 0, "creation_date": 1496805788, "post_id": 44402463, "comment_id": 75805466, "body": "match your the other workbook.name and  sheet name in code."}, {"owner": {"reputation": 5, "user_id": 5979186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/463e7e1aeb81d9e6e407caaa49804b90?s=128&d=identicon&r=PG&f=1", "display_name": "yael", "link": "https://stackoverflow.com/users/5979186/yael"}, "edited": false, "score": 0, "creation_date": 1496829218, "post_id": 44402463, "comment_id": 75817319, "body": "I got the portion where I will change the workbook name, but where will I change the sheet name?"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 5, "user_id": 5979186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/463e7e1aeb81d9e6e407caaa49804b90?s=128&d=identicon&r=PG&f=1", "display_name": "yael", "link": "https://stackoverflow.com/users/5979186/yael"}, "edited": false, "score": 0, "creation_date": 1496835912, "post_id": 44402463, "comment_id": 75822202, "body": "With wb.Sheets(&quot;your sheet name&quot;)"}, {"owner": {"reputation": 5, "user_id": 5979186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/463e7e1aeb81d9e6e407caaa49804b90?s=128&d=identicon&r=PG&f=1", "display_name": "yael", "link": "https://stackoverflow.com/users/5979186/yael"}, "edited": false, "score": 0, "creation_date": 1496881486, "post_id": 44402463, "comment_id": 75847939, "body": "silly me, haha, I got it, and it worked perfectly, thanks for that. Hmm may I ask another one? what if I want the data to be save in the same workbook and in the other workbook. When I encode a data and run the macro, the data will be saved in the &quot;database&quot; sheet in the same workbook and in the &quot;database&quot; sheet on the other workbook at the same time?"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 5, "user_id": 5979186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/463e7e1aeb81d9e6e407caaa49804b90?s=128&d=identicon&r=PG&f=1", "display_name": "yael", "link": "https://stackoverflow.com/users/5979186/yael"}, "edited": false, "score": 0, "creation_date": 1496914497, "post_id": 44402463, "comment_id": 75861375, "body": "Ysmael Cailon,I modified my code , the data be inable to save in the same workbook and in the other workbook at the same time."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 0, "last_activity_date": 1496914218, "last_edit_date": 1496914218, "creation_date": 1496802096, "answer_id": 44402463, "question_id": 44402264, "link": "https://stackoverflow.com/questions/44402264/save-encoded-data-to-another-workbook/44402463#44402463", "title": "Save encoded data to another workbook", "body": "<p>Maybe, code would be like this..</p>\n\n<pre><code>Sub RoundedRectangle1_Click()\nDim i As Long, lastrow As Long, n As Long\nDim vResult()\nDim myWs As Worksheet\n\nSet myWs = ThisWorkbook.Sheets(\"Database\")\n\nIf ActiveSheet.Range(\"d6\") = \"\" Or ActiveSheet.Range(\"g6\") = \"\" Or ActiveSheet.Range(\"c9\") = \"\" Then\nMsgBox \"Please complete all fields!\"\nExit Sub\nEnd If\n\n'lastrow = Sheets(\"database\").Cells(Cells.Rows.Count, 2).End(xlUp).Row + 1\ni = 9\nDo While Cells(i, 3) &lt;&gt; \"\" And i &lt; 29\n    n = n + 1\n    ReDim Preserve vResult(1 To 8, 1 To n)\n    vResult(1, n) = ActiveSheet.Range(\"g6\") ' Date\n    vResult(2, n) = ActiveSheet.Range(\"d6\") ' Ref\n    vResult(3, n) = ActiveSheet.Cells(i, 3) ' Code\n    vResult(4, n) = ActiveSheet.Cells(i, 4) ' Description\n    vResult(5, n) = ActiveSheet.Cells(i, 5) ' U/M\n    vResult(6, n) = ActiveSheet.Cells(i, 6) ' Qty\n    vResult(7, n) = ActiveSheet.Cells(i, 7) ' Price\n    vResult(8, n) = \"IN\" ' Transaction\n    i = i + 1\n\nLoop\n\nDim wb As Workbook\n'chage workbook name as  your workbook.name\nSet wb = Workbooks(\"another.xlsx\")\nWith wb.Sheets(\"Database\")\n    .Range(\"b\" &amp; Rows.Count).End(xlUp)(2).Resize(n, 8) = WorksheetFunction.Transpose(vResult)\nEnd With\nmyWs.Range(\"b\" &amp; Rows.Count).End(xlUp)(2).Resize(n, 8) = WorksheetFunction.Transpose(vResult)\n\nMsgBox \"Saved Succesfully!\"\nThisWorkbook.Save\nCall RoundedRectangle2_Click\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5979186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/463e7e1aeb81d9e6e407caaa49804b90?s=128&d=identicon&r=PG&f=1", "display_name": "yael", "link": "https://stackoverflow.com/users/5979186/yael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 44402463, "answer_count": 1, "score": 0, "last_activity_date": 1496914218, "creation_date": 1496800554, "last_edit_date": 1496802814, "question_id": 44402264, "link": "https://stackoverflow.com/questions/44402264/save-encoded-data-to-another-workbook", "title": "Save encoded data to another workbook", "body": "<p>I have a macro code here in which saves the encoded data to another sheet within the same workbook. But I want to make some modification in this macro, I want the encoded data saves to another workbook, here is my code:  </p>\n\n<pre><code>Sub RoundedRectangle1_Click()\nDim i, lastrow As Long\nIf ActiveSheet.Range(\"d6\") = \"\" Or ActiveSheet.Range(\"g6\") = \"\" Or ActiveSheet.Range(\"c9\") = \"\" Then\nMsgBox \"Please complete all fields!\"\nExit Sub\nEnd If\n\nlastrow = Sheets(\"database\").Cells(Cells.Rows.Count, 2).End(xlUp).Row + 1\ni = 9\nDo While Cells(i, 3) &lt;&gt; \"\" And i &lt; 29\nSheets(\"Database\").Cells(lastrow, 2) = ActiveSheet.Range(\"g6\") ' Date\nSheets(\"Database\").Cells(lastrow, 3) = ActiveSheet.Range(\"d6\") ' Ref\nSheets(\"Database\").Cells(lastrow, 4) = ActiveSheet.Cells(i, 3) ' Code\nSheets(\"Database\").Cells(lastrow, 5) = ActiveSheet.Cells(i, 4) ' Description\nSheets(\"Database\").Cells(lastrow, 6) = ActiveSheet.Cells(i, 5) ' U/M\nSheets(\"Database\").Cells(lastrow, 7) = ActiveSheet.Cells(i, 6) ' Qty\nSheets(\"Database\").Cells(lastrow, 8) = ActiveSheet.Cells(i, 7) ' Price\nSheets(\"Database\").Cells(lastrow, 9) = \"IN\" ' Transaction\ni = i + 1\nlastrow = lastrow + 1\nLoop\nMsgBox \"Saved Succesfully!\"\nThisWorkbook.Save\nCall RoundedRectangle2_Click\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2013", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8122645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73c37b3474eaaf3644adb1ed66e2593?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/8122645/phil"}, "edited": false, "score": 0, "creation_date": 1496989173, "post_id": 44407290, "comment_id": 75898068, "body": "Generic or not, this is not so simple to grasp for the uninitiated.  Nonetheless, thank you very much, it has accomplished exactly what I needed.  Merci!"}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 0, "last_activity_date": 1496823722, "last_edit_date": 1525816189, "creation_date": 1496823722, "answer_id": 44407290, "question_id": 44402009, "link": "https://stackoverflow.com/questions/44402009/find-and-replace-current-cell-value-with-cell-number/44407290#44407290", "title": "Find and replace current cell value with cell number", "body": "<p>Basically, you loop through the cells in the used range on the current sheet and replace the cell values. Below is the code that will do what you're after. I commented each line to make clear what exactly is happening.</p>\n\n<pre><code>Sub Test()\n'Range variable to use for looping\nDim rng As Range \n\n'String variable for finding the values.\nDim searchvalue As String \n\n'We'll loop on the current sheet\nWith ActiveSheet\n\n    'You need to have a single cell selected, if that's not the case we exit the macro.\n    If Selection.Count &gt; 1 Then Exit Sub \n\n    'Get the value to search for\n    searchvalue = Selection.value \n\n    'Loop over all cells in the sheet that have values.\n    For Each rng In .UsedRange \n\n        'We do not want to overwrite the range from where we search (the selection)\n        If Intersect(rng, Selection) Is Nothing Then \n\n             'And if we find the value that was in the selection\n            If rng.value = searchvalue Then\n\n                Then create the =cell we selected formula.\n                rng.value = \"=\" &amp; Selection.Address '\n            End If\n        End If\n\n    'Next cell in the loop\n    Next rng\n\n'And we don't need the activesheet anymore.\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Since this is quite generic stuff, I'd suggest you read up on Excel VBA programming in general. Some great resources are:</p>\n\n<ul>\n<li><a href=\"http://www.ozgrid.com/VBA\" rel=\"nofollow noreferrer\">Ozgrid</a></li>\n<li><a href=\"http://www.rondebruin.nl/\" rel=\"nofollow noreferrer\">Rondebruin</a> his website</li>\n<li><a href=\"http://www.cpearson.com/Excel/topic.aspx\" rel=\"nofollow noreferrer\">Chip Pearson</a> his website</li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 8122645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73c37b3474eaaf3644adb1ed66e2593?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/8122645/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "accepted_answer_id": 44407290, "answer_count": 1, "score": -1, "last_activity_date": 1496823722, "creation_date": 1496798273, "last_edit_date": 1531164843, "question_id": 44402009, "link": "https://stackoverflow.com/questions/44402009/find-and-replace-current-cell-value-with-cell-number", "title": "Find and replace current cell value with cell number", "body": "<p>I'm very new to VBA.  I've tried recording my Macro and still can't seem to figure it out.</p>\n\n<p>I want the macro to the following:</p>\n\n<p>On the selected cell I want to search the value and replace what is found by the selected cell \"number\".</p>\n\n<p>Example : Say I select Cell A1 and its value is 666 I want it to search and replace all Cells on the sheet that contain 666 with \"=A1\".</p>\n\n<p>In essence I want them all to point to the initial cell.</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["vba", "pattern-matching", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496807055, "post_id": 44401859, "comment_id": 75805705, "body": "FindText:=&quot;&#91;[0-9]{1,2}&#93;&quot;  See #7 here - <a href=\"http://wordmvp.com/FAQs/General/UsingWildcards.htm\" rel=\"nofollow noreferrer\">wordmvp.com/FAQs/General/UsingWildcards.htm</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1496815174, "creation_date": 1496815174, "answer_id": 44404637, "question_id": 44401859, "link": "https://stackoverflow.com/questions/44401859/word-vba-findtext-pattern-with-an-optional-character-find-method/44404637#44404637", "title": "Word VBA: Findtext pattern with an optional character (Find method)", "body": "<pre><code>Sub SearchNumbersInSqBrackets()\n\n    Dim rng\n    Set rng = ActiveDocument.Range\n\n    With rng.Find\n        .Text = \"\\[[0-9]{1,2}\\]\"\n        .MatchWildcards = True\n\n        Do While .Execute(Forward:=True)\n            Debug.Print rng.Text\n        Loop\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>See #7 here - <a href=\"http://wordmvp.com/FAQs/General/UsingWildcards.htm\" rel=\"nofollow noreferrer\">http://wordmvp.com/FAQs/General/UsingWildcards.htm</a></p>\n"}], "owner": {"reputation": 113, "user_id": 1620304, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/da506b4ba194edb865f772e86d9f847e?s=128&d=identicon&r=PG", "display_name": "rayvd", "link": "https://stackoverflow.com/users/1620304/rayvd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 44404637, "answer_count": 1, "score": 0, "last_activity_date": 1496815174, "creation_date": 1496796890, "question_id": 44401859, "link": "https://stackoverflow.com/questions/44401859/word-vba-findtext-pattern-with-an-optional-character-find-method", "title": "Word VBA: Findtext pattern with an optional character (Find method)", "body": "<p>I have what should be a simple question. I am searching a document for occurrences of bracketed numbers, e.g.  <code>[4]</code> or <code>[14]</code> etc. I can write a pattern to find either a single digit or a double digit, but how do I use a single <code>FindText</code> pattern that matches both cases?</p>\n\n<p>Here is my working code for the single digit case:</p>\n\n<pre><code>set fnd=ActiveDocument.Range.Find\nWhile (fnd.Execute(FindText:=\"\\[[0-9]\\]\", MatchWildcards:=True))\n    ...\n    Do Stuff\n    ...\nWend\n</code></pre>\n\n<p>How can I adapt this to include the possibility of a second digit? Thanks for your help!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "edited": false, "score": 0, "creation_date": 1497040087, "post_id": 44401619, "comment_id": 75929221, "body": "If you add debug.print strSQL after assigning it you will see that your query string is badly formed. You are missing the space before the word SET. (BTW your Hungarian notation &quot;strMyCombo&quot; is misleading for a Boolean!)"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1496826532, "creation_date": 1496826532, "answer_id": 44408267, "question_id": 44401619, "link": "https://stackoverflow.com/questions/44401619/i-got-syntax-error-in-update-statement-run-time-error-3144-i-am-using-the-follo/44408267#44408267", "title": "I got syntax error in update statement.Run-time error: 3144 I am using the following code", "body": "<p>Try this:</p>\n\n<pre><code>Dim strMyTable As String \nDim strMyField As String \nDim strMyCombo As String\nDim strSQL As String  \n\nstrMyTable = \"ItemDetails\"  '(or whatever the true names are...) \nstrMyField = \"Chk\" \nstrMyCombo = \"False\"  \nstrSQL = \"UPDATE \" &amp; strMyTable &amp; \" SET \" &amp; strMyField &amp; \"=\" &amp; strMyCombo &amp; \";\"          \nApplication.CurrentDb.Execute strSQL  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8122543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3747fba18cf0cf1f4858df51b4c28874?s=128&d=identicon&r=PG&f=1", "display_name": "Engr. Zakiuddin", "link": "https://stackoverflow.com/users/8122543/engr-zakiuddin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1594639789, "creation_date": 1496794742, "last_edit_date": 1594639789, "question_id": 44401619, "link": "https://stackoverflow.com/questions/44401619/i-got-syntax-error-in-update-statement-run-time-error-3144-i-am-using-the-follo", "title": "I got syntax error in update statement.Run-time error: 3144 I am using the following code", "body": "<pre class=\"lang-vb prettyprint-override\"><code>Dim strMyTable As String \nDim strMyField As String \nDim strMyCombo As Boolean \nDim strSQL As String  \nstrMyTable = \"ItemDetails\"  '(or whatever the true names are...) \nstrMyField = \"Chk\" \nstrMyCombo = False  \nstrSQL = \"UPDATE \" &amp; strMyTable _ &amp; \"SET \" &amp; strMyField &amp; \"=\" &amp; strMyCombo &amp; \";\"          \nApplication.CurrentDb.Execute strSQL  \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1496863588, "creation_date": 1496863588, "answer_id": 44421242, "question_id": 44401346, "link": "https://stackoverflow.com/questions/44401346/excel-macro-i-would-like-to-add-one-column-to-a-range-and-call-a-function-to-fi/44421242#44421242", "title": "Excel Macro: I would like to add one column to a range and call a function to fill it", "body": "<p>If the \"new\" column that you are wanting to populate is after the end of your copied data, you aren't really adding a column - you are just populating an existing empty column.</p>\n\n<p>If so, you can just say something like</p>\n\n<pre><code>NewSh.Cells(Rcount, \"Q\").Formula = \"=whatever_formula_you_want\"\n</code></pre>\n\n<p>(or use FormulaR1C1 if that is easier).</p>\n\n<p>Or, if you only want to insert a value there (which you are calculating in your VBA code), it is just</p>\n\n<pre><code>NewSh.Cells(Rcount, \"Q\").Value = the_value_I_want\n</code></pre>\n"}], "owner": {"reputation": 1115, "user_id": 564810, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7a5ebfc98dc69621291ef7bfc6ffda99?s=128&d=identicon&r=PG", "display_name": "JustJohn", "link": "https://stackoverflow.com/users/564810/justjohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 44421242, "answer_count": 1, "score": 0, "last_activity_date": 1496863588, "creation_date": 1496792648, "last_edit_date": 1496793404, "question_id": 44401346, "link": "https://stackoverflow.com/questions/44401346/excel-macro-i-would-like-to-add-one-column-to-a-range-and-call-a-function-to-fi", "title": "Excel Macro: I would like to add one column to a range and call a function to fill it", "body": "<p>Below is a macro we use to build a worksheet with a subset of a larger worksheet.\nWhen the loop finds a match in our array of server names, it copies it over to the new worksheet.\nI would like to add a new column to the new worksheet during the copy process. And after getting that working, I would like to fill this field by calling a function. We are trying to have a column that shows whether a server is a \"critical\" server. Simple y/n returns from a function that would look in an array of critical servers. I don't need the function, just how to add a column and fill it during the loop.</p>\n\n<p>I will paste the big loop farther down, but here is the individual line of code that would copy over a range if found to a new worksheet. It is here I would like to add or copy one more column filled by a function:</p>\n\n<pre><code> Rcount = Rcount + 1\n Source.Range(\"A\" &amp; Rng.Row &amp; \":R\" &amp; Rng.Row).Copy NewSh.Range(\"A\" &amp; Rcount &amp; \":R\" &amp; Rcount)\n</code></pre>\n\n<p>Here is the big loop for inquiring minds. It might be useful or at least prove this code is being used:</p>\n\n<pre><code>With Source.Range(\"A1:R9000\")\n\n    'Find where the actual data we need starts\n    Set Rng = .Find(What:=\"Client\", _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlFormulas, _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n\n    intColorMatch = 0\n\n    If Not Rng Is Nothing Then\n        FirstAddress = Rng.Address\n        Do\n            Set Rng = .FindNext(Rng)\n            If (Rng.Interior.Color = 13421772) Then\n                intColorMatch = intColorMatch + 1\n            End If\n\n            If (intColorMatch &lt; 2) = False Then\n                StartRow = Rng.Row\n                Exit Do\n            End If\n\n        Loop While Not Rng Is Nothing And Rng.Address &lt;&gt; FirstAddress\n    End If\n\n\n    Source.Range(\"A\" &amp; StartRow &amp; \":R\" &amp; StartRow + 1).Copy NewSh.Range(\"A1:R2\")\n\n    Rcount = 2\n    FirstAddress = 0\n\n    For I = LBound(MyArr) To UBound(MyArr)\n\n        'If you use LookIn:=xlValues it will also work with a\n        'formula cell that evaluates to \"@\"\n        'Note : I use xlPart in this example and not xlWhole\n        Set Rng = .Find(What:=MyArr(I), _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlFormulas, _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        If Not Rng Is Nothing Then\n            FirstAddress = Rng.Address\n            Do\n                If Rng.Row &gt;= StartRow Then\n                    Rcount = Rcount + 1\n                    Source.Range(\"A\" &amp; Rng.Row &amp; \":R\" &amp; Rng.Row).Copy NewSh.Range(\"A\" &amp; Rcount &amp; \":R\" &amp; Rcount)\n\n              ' Use this if you only want to copy the value\n                    ' NewSh.Range(\"A\" &amp; Rcount).Value = Rng.Value\n                End If\n\n                Set Rng = .FindNext(Rng)\n            Loop While Not Rng Is Nothing And Rng.Address &lt;&gt; FirstAddress\n        End If\n    Next I\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1496794240, "post_id": 44401278, "comment_id": 75802846, "body": "show us what you have written so far"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1496796878, "post_id": 44401278, "comment_id": 75803405, "body": "If you don&#39;t know where to start, look at literally any of the &quot;related&quot; posts on this page. NB: you&#39;ll need to do this in reverse order. Start with <a href=\"https://stackoverflow.com/questions/41023377/remove-duplicate-rows-excel-vba?rq=1\">this</a> and see if that points you in the right direction."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496807034, "post_id": 44401278, "comment_id": 75805699, "body": "To piggyback off David - There is at least one post a day made asking for code to delete rows containing certain text. You can almost certainly find a working example around here somewhere."}], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1496807564, "creation_date": 1496807564, "answer_id": 44403183, "question_id": 44401278, "link": "https://stackoverflow.com/questions/44401278/vba-scripting-on-excel-to-delete-rows-with-specific-strings/44403183#44403183", "title": "VBA scripting on excel to delete rows with specific strings", "body": "<p>I use this code.</p>\n\n<pre><code>Sub test()\n    Dim rngDB As Range, rngU As Range, rngF As Range\n    Dim vColor, i As Integer, Adr As String\n\n    Set rngDB = ActiveSheet.UsedRange\n    vColor = Array(\"red\", \"yellow\", \"blue\")\n\n    For i = 0 To UBound(vColor)\n        With rngDB\n            Set rngF = .Find(vColor(i), LookIn:=xlValues, Lookat:=xlWhole)\n            If rngF Is Nothing Then\n            Else\n                Adr = rngF.Address\n                Do\n                    If rngU Is Nothing Then\n                        Set rngU = rngF\n                    Else\n                        Set rngU = Union(rngU, rngF)\n                    End If\n                    Set rngF = .FindNext(rngF)\n                Loop Until Adr = rngF.Address Or rngF Is Nothing\n            End If\n        End With\n    Next i\n    If rngU Is Nothing Then\n    Else\n        rngU.EntireRow.Delete\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8122420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0db6e56d131c7e86c72e40e77135c99?s=128&d=identicon&r=PG&f=1", "display_name": "Kev5ter", "link": "https://stackoverflow.com/users/8122420/kev5ter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1496807564, "creation_date": 1496792054, "last_edit_date": 1496794669, "question_id": 44401278, "link": "https://stackoverflow.com/questions/44401278/vba-scripting-on-excel-to-delete-rows-with-specific-strings", "title": "VBA scripting on excel to delete rows with specific strings", "body": "<p>I'm currently in the process of writing a macro on excel that deletes an entire row which includes a specific string. I am doing some data analytics and would like to filter out a spreadsheet with not needed information. </p>\n\n<p>An arbitrary example: </p>\n\n<p><img src=\"https://i.imgur.com/oR0kE1z.png\" alt=\"\"></p>\n\n<p>How would I go about making a script that deletes rows that include the color red, blue, and yellow? </p>\n"}]