[{"tags": ["vba", "object", "wildcard", "named-ranges"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528936088, "post_id": 50847786, "comment_id": 88699350, "body": "Seeing all of your code would probably help here"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528938637, "post_id": 50847786, "comment_id": 88699835, "body": "@urdearboy at first I thought the same, ...except it <i>is</i> all the context we need after all."}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528938716, "post_id": 50848231, "comment_id": 88699848, "body": "This was driving me crazy.  (+1)"}, {"owner": {"reputation": 89, "user_id": 1708515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1f937f6b17541ab4ea602b65a6787e2f?s=128&d=identicon&r=PG", "display_name": "Reece Edwards", "link": "https://stackoverflow.com/users/1708515/reece-edwards"}, "edited": false, "score": 0, "creation_date": 1528946736, "post_id": 50848231, "comment_id": 88701248, "body": "Thanks for that answer. However, I have multiple sheets all with the same name so I&#39;ve had to sheet-scope them to avoid naming errors. It allows me to run the script on multiple sheets without changing too much of my code (apparently). I&#39;m going to mark you response as the answer. I think I&#39;m going to have to take the sheet name and replace it with &#39;nothing&#39; in the string variable itself.  Thank you!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1528938186, "creation_date": 1528938186, "answer_id": 50848231, "question_id": 50847786, "link": "https://stackoverflow.com/questions/50847786/name-object-returning-sheetname/50848231#50848231", "title": "Name Object Returning SheetName", "body": "<p>The <code>Name</code> is worksheet-scoped. Delete it and make a new one with the same <code>RefersTo</code> range, making sure it's at <code>Workbook</code> scope:</p>\n\n<p><img src=\"https://i.stack.imgur.com/rWedW.png\" alt=\"&quot;New Name&quot; Excel dialog showing Scope field in a red circle\"></p>\n\n<p>Sheet-scoped names have the sheet's name in their... name.</p>\n\n<p><img src=\"https://i.stack.imgur.com/LqBca.png\" alt=\"debug output of names(&quot;the name&quot;).Name values: Sheet1!SheetScopeTest1 and BookScopeTest1\"></p>\n"}], "owner": {"reputation": 89, "user_id": 1708515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1f937f6b17541ab4ea602b65a6787e2f?s=128&d=identicon&r=PG", "display_name": "Reece Edwards", "link": "https://stackoverflow.com/users/1708515/reece-edwards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 50848231, "answer_count": 1, "score": 2, "last_activity_date": 1528938186, "creation_date": 1528933711, "question_id": 50847786, "link": "https://stackoverflow.com/questions/50847786/name-object-returning-sheetname", "title": "Name Object Returning SheetName", "body": "<p>I am trying to loop through all my Named Ranges and set them as a string if they contain a certain substring using a wildcard operator and <code>LIKE</code>. Finding the correct Named Range is working as it should.</p>\n\n<p>However, when I set the string to the name of the range, I am getting the full sheet name and not just the Range Name.</p>\n\n<p><code>\"'SheetName'!Range Name\"</code> should be <code>\"Range Name\"</code>. When using the string later on in the code, it is producing errors because of the sheetname. I could trim and replace, but thought there might be a more direct method to solving the problem. </p>\n\n<pre><code>Dim nm as Name\nDim CurrentRange as String   \n\nIf nm.Name Like \"*Name\" Then\n    CurrentRange = nm.Name\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 2, "last_activity_date": 1530013695, "last_edit_date": 1530013695, "creation_date": 1528932847, "answer_id": 50847698, "question_id": 50847447, "link": "https://stackoverflow.com/questions/50847447/vba-copy-if-last-row-is-not-equal-to/50847698#50847698", "title": "VBA - Copy if last row is not equal to", "body": "<p>Just check <code>lrs</code> is great than 11 before copying, and do the same before pasting.</p>\n\n<pre><code>Option Explicit\nSub test()\n    For i = 1 To Sheets.count\n        If Sheets(i).Name &lt;&gt; \"Import\" And Sheets(i).Name &lt;&gt; \"Cover page\" And Sheets(i).Name &lt;&gt; \"Introduction\" And Sheets(i).Name &lt;&gt; \"Additional Fuels\" Then\n            With Sheets(i)\n                lrs = .Cells(.Rows.count, \"S\").End(xlUp).Row 'Column S = \"Specific Claim Language\"\n                If lrs &gt; 11 Then\n                    .Range(.Cells(11, \"B\"), .Cells(lrs, \"U\")).Copy 'Data of interest exists from B to U\n                End if\n            End With\n            If lrs &gt; 11 Then\n                With Sheets(\"Import\")\n                    lrd = .Cells(.Rows.count, \"A\").End(xlUp).Row\n                    .Range(.Cells(lrd + 1, \"A\"), .Cells(lrd + 1 + lrs, \"AA\")).PasteSpecial xlValues 'Only pasting data relevant to columns B:U on source, A:T on destination\n                End With\n            End If\n        End If\n    Next i \nEnd Sub\n</code></pre>\n\n<p>Alternatively just jump out after the &lt;12 check and resume</p>\n\n<pre><code>Option Explicit\nSub test()\n    For i = 1 To Sheets.count\n        If Sheets(i).Name &lt;&gt; \"Import\" And Sheets(i).Name &lt;&gt; \"Cover page\" And Sheets(i).Name &lt;&gt; \"Introduction\" And Sheets(i).Name &lt;&gt; \"Additional Fuels\" Then\n            With Sheets(i)\n                lrs = .Cells(.Rows.count, \"S\").End(xlUp).Row 'Column S = \"Specific Claim Language\"\n                If lrs &lt; 12 Then GoTo nextsheet:\n                .Range(.Cells(11, \"B\"), .Cells(lrs, \"U\")).Copy 'Data of interest exists from B to U\n            End With\n            With Sheets(\"Import\")\n                lrd = .Cells(.Rows.count, \"A\").End(xlUp).Row\n                .Range(.Cells(lrd + 1, \"A\"), .Cells(lrd + 1 + lrs, \"AA\")).PasteSpecial xlValues 'Only pasting data relevant to columns B:U on source, A:T on destination\n            End With\n        End If\nnextsheet:\n    resume nextsheet2:\nnextsheet2:\n    Next i \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9882821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7be3b40a026d688717013c8cb027b6a?s=128&d=identicon&r=PG&f=1", "display_name": "arobNYC", "link": "https://stackoverflow.com/users/9882821/arobnyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 50847698, "answer_count": 1, "score": 1, "last_activity_date": 1530013695, "creation_date": 1528930653, "question_id": 50847447, "link": "https://stackoverflow.com/questions/50847447/vba-copy-if-last-row-is-not-equal-to", "title": "VBA - Copy if last row is not equal to", "body": "<p>I'm working on copying and pasting various sheets to a central \"Import\" tab within a workbook. The sheets are each a template, and some have been filled out while others have not. Regardless, because cells are filled by the template, there is never a truly \"empty\" sheet. I want to only bring in the data that has been added (beyond the template). If there has been no data added, the source last row = 11. How can I best modify my code to not copy the sheet if lrs=11 (but copy the data if lrs > 11), and move on to the next sheet instead?</p>\n\n<pre><code>For i = 1 To Sheets.Count\n    If Sheets(i).Name &lt;&gt; \"Import\" And Sheets(i).Name &lt;&gt; \"Cover page\" And Sheets(i).Name &lt;&gt; \"Introduction\" And Sheets(i).Name &lt;&gt; \"Additional Fuels\" Then\n        With Sheets(i)\n            lrs = .Cells(.Rows.Count, \"S\").End(xlUp).Row 'Column S = \"Specific Claim Language\"\n            .Range(.Cells(11, \"B\"), .Cells(lrs, \"U\")).Copy 'Data of interest exists from B to U\n        End With\n        With Sheets(\"Import\")\n            lrd = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            .Range(.Cells(lrd + 1, \"A\"), .Cells(lrd + 1 + lrs, \"AA\")).PasteSpecial xlValues 'Only pasting data relevant to columns B:U on source, A:T on destination\n        End With\n    End If\nNext i\n</code></pre>\n\n<p></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9938653, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lETFZmwFnds/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ON94JELSBUMhEBZrvdLu6wKu67g/mo/photo.jpg?sz=128", "display_name": "Asrakh", "link": "https://stackoverflow.com/users/9938653/asrakh"}, "edited": false, "score": 0, "creation_date": 1528931373, "post_id": 50847357, "comment_id": 88698432, "body": "Rewrote the second index/match as below, getting error 13, type mismatch as an error on the i.value line."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 23, "user_id": 9938653, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lETFZmwFnds/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ON94JELSBUMhEBZrvdLu6wKu67g/mo/photo.jpg?sz=128", "display_name": "Asrakh", "link": "https://stackoverflow.com/users/9938653/asrakh"}, "edited": false, "score": 0, "creation_date": 1528960086, "post_id": 50847357, "comment_id": 88705725, "body": "Did you try the above full script?"}, {"owner": {"reputation": 23, "user_id": 9938653, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lETFZmwFnds/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ON94JELSBUMhEBZrvdLu6wKu67g/mo/photo.jpg?sz=128", "display_name": "Asrakh", "link": "https://stackoverflow.com/users/9938653/asrakh"}, "edited": false, "score": 0, "creation_date": 1528993191, "post_id": 50847357, "comment_id": 88726342, "body": "Thanks, ran the revised code separately, worked perfectly, but when I copied it over to the full scrip got a compile error, duplicate declaration. Once I figure out what it is, the script will be perfect, thanks again for the help!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 23, "user_id": 9938653, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lETFZmwFnds/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ON94JELSBUMhEBZrvdLu6wKu67g/mo/photo.jpg?sz=128", "display_name": "Asrakh", "link": "https://stackoverflow.com/users/9938653/asrakh"}, "edited": false, "score": 0, "creation_date": 1528993324, "post_id": 50847357, "comment_id": 88726417, "body": "Hi, then you have made an error when copying. Did you have some code already in the module? If you copy exactly as above and ensure you do not have option explicit twice for example you should be fine. Does it highlight a line with this error? Which one?"}, {"owner": {"reputation": 23, "user_id": 9938653, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lETFZmwFnds/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ON94JELSBUMhEBZrvdLu6wKu67g/mo/photo.jpg?sz=128", "display_name": "Asrakh", "link": "https://stackoverflow.com/users/9938653/asrakh"}, "edited": false, "score": 0, "creation_date": 1528993406, "post_id": 50847357, "comment_id": 88726464, "body": "Yeah, got some code already in, but decided to take the lazy way out, and just called the &#39;test&#39; sub at the end of script, everything is working now :)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1528931933, "last_edit_date": 1528931933, "creation_date": 1528930032, "answer_id": 50847357, "question_id": 50847252, "link": "https://stackoverflow.com/questions/50847252/runtime-error-1004-unable-to-get-the-match-property-when-using-two-index-match/50847357#50847357", "title": "Runtime error 1004 unable to get the match property when using two index/match", "body": "<p>Most likely a match was not found. Test for a match not found first. If you use <code>Application.Match</code> you can use the error returned in a test to see if a match was found before attempting to get your <code>i.value</code>. Do the same for both Match attempts.</p>\n\n<pre><code>With Application.WorksheetFunction\n    Dim test As Variant\n    test = Application.Match(Range(\"E\" &amp; count), Worksheets(\"Area\").Range(\"a:a\"), 0)\n    If Not IsError(test) Then\n        i.Value = .Index(Worksheets(\"Area\").Range(\"c:c\"), test)\n    End If\nEnd With\n</code></pre>\n\n<p>I would probably re-write as:</p>\n\n<pre><code>With sht\n    Dim test As Variant\n    test = Application.Match(.Range(\"E\" &amp; count), Worksheets(\"Area\").Range(\"A:A\"), 0)\n    If Not IsError(test) Then\n        i.Value = Application.WorksheetFunction.Index(Worksheets(\"Area\").Range(\"C:C\"), test)\n    End If\nEnd With\n</code></pre>\n\n<p>I would also look to work with smaller ranges than entire columns i.e. not \"C:C\" for example. Find the used range/last row and work up to that.</p>\n\n<p>Fuller version:</p>\n\n<pre><code>Option Explicit\nSub test()\n\n    Dim sht As Worksheet\n    Dim LastRow As Long\n    Dim count As Long\n    Set sht = ActiveSheet\n    LastRow = sht.Cells(sht.Rows.count, \"A\").End(xlUp).Row\n\n    With sht\n        count = 2\n        Dim i As Range, test As Variant\n        For Each i In .Range(\"F2:F\" &amp; LastRow)\n            test = Application.Match(.Range(\"E\" &amp; count), Worksheets(\"Area\").Range(\"A:A\"), 0)\n            If Not IsError(test) Then\n                i.Value = Application.WorksheetFunction.Index(Worksheets(\"Area\").Range(\"C:C\"), test)\n            End If\n            count = count + 1\n        Next\n        count = 2\n        Dim test2 As Variant\n        For Each i In .Range(\"H2:H\" &amp; LastRow)\n            test2 = Application.Match(.Range(\"G\" &amp; count), Worksheets(\"Park reason\").Range(\"A:A\"))\n            If Not IsError(test2) Then\n                i.Value = Application.WorksheetFunction.Index(Worksheets(\"Park reason\").Range(\"C:C\"), test2)\n            End If\n            count = count + 1\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528994354, "post_id": 50862121, "comment_id": 88726916, "body": "Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!  Good to know that you figured it out with the help of others.  Be sure to give credit to those who have assisted you: Don&#39;t forget to <b><code>\u2713 Accept</code></b> an answer that helped solve your problem, and once you reach 15 rep you can also <b><code>\u25b2 Upvote</code></b> any answers that are well written.  Generally you don&#39;t need to re-post an answer that your were given as a separate answer  Also be sure to check out the <a href=\"https://stackoverflow.com/tour\">tour</a> (where you&#39;ll earn a badge!)  Also see &quot;<a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>.&quot;"}], "tags": [], "owner": {"reputation": 23, "user_id": 9938653, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lETFZmwFnds/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ON94JELSBUMhEBZrvdLu6wKu67g/mo/photo.jpg?sz=128", "display_name": "Asrakh", "link": "https://stackoverflow.com/users/9938653/asrakh"}, "is_accepted": false, "score": 0, "last_activity_date": 1528993860, "creation_date": 1528993860, "answer_id": 50862121, "question_id": 50847252, "link": "https://stackoverflow.com/questions/50847252/runtime-error-1004-unable-to-get-the-match-property-when-using-two-index-match/50862121#50862121", "title": "Runtime error 1004 unable to get the match property when using two index/match", "body": "<p>Full code btw, not sure why I got a duplication error when copied into the cleanup sub, but with the workaround it's working.</p>\n\n<pre><code>Sub Cleanup()\n\nDim sToday As String\nsToday = Format(Date, \"mm-dd-yyyy\")\n\nActiveSheet.Copy Before:=Worksheets(\"Park Reason\")\nRows(\"1:12\").Select\nSelection.Delete Shift:=xlUp\nRange(\"G:H\").Select\nSelection.UnMerge\nColumns(\"H:H\").Select\nSelection.Delete Shift:=xlToLeft\nRows(\"1:1\").Select\nRange(\"A:I\").AutoFilter Field:=6, Criteria1:=\"Yes\"\nColumns(\"G:G\").EntireColumn.AutoFit\nRange(\"A:I\").AutoFilter Field:=7, Criteria1:=Array(\"1\" _\n    , \"11\", \"12\", \"13\", \"14\", \"15\", \"16\", \"30\", \"40\", \"50\", \"51\", \"99\"), Operator:= _\n    xlFilterValues\nRange(\"A:I\").AutoFilter Field:=1, Criteria1:=Array( _\n    *removed*), Operator:=xlFilterValues\nRange(\"A:I\").RemoveDuplicates Columns:=2, Header:= _\n    xlYes\n\nFor Each i In Range(Range(\"G2\"), Range(\"G2\").End(xlDown))\n    If IsNumeric(i) Then\n        i.Value = CDec(i.Value)\n    End If\nNext\n\nFor Each i In Range(Range(\"B2\"), Range(\"B2\").End(xlDown))\n     If IsNumeric(i) Then\n        i.Value = CDec(i.Value)\n    End If\nNext\n\nColumns(\"F:F\").Select\nSelection.Delete ' Shift:=xlToLeft\nSelection.Insert ' Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"F1\").Value = \"Area\"\nColumns(\"H:H\").Insert\nRange(\"H1\").Value = \"Parking Reason\"\nActiveSheet.Name = sToday\n\ntest\n\nEnd Sub\n\nSub test()\n\nDim sht As Worksheet\nDim LastRow As Long\nDim count As Long\nSet sht = ActiveSheet\nLastRow = sht.Cells(sht.Rows.count, \"A\").End(xlUp).Row\n\nWith sht\n    count = 2\n    Dim i As Range, test As Variant\n    For Each i In .Range(\"F2:F\" &amp; LastRow)\n        test = Application.Match(.Range(\"E\" &amp; count), Worksheets(\"Area\").Range(\"A:A\"), 0)\n        If Not IsError(test) Then\n            i.Value = Application.WorksheetFunction.Index(Worksheets(\"Area\").Range(\"C:C\"), test)\n        End If\n        count = count + 1\n    Next\n    count = 2\n    Dim test2 As Variant\n    For Each i In .Range(\"H2:H\" &amp; LastRow)\n        test2 = Application.Match(.Range(\"G\" &amp; count), Worksheets(\"Park reason\").Range(\"A:A\"))\n        If Not IsError(test2) Then\n            i.Value = Application.WorksheetFunction.Index(Worksheets(\"Park reason\").Range(\"C:C\"), test2)\n        End If\n        count = count + 1\n    Next\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9938653, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lETFZmwFnds/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0ON94JELSBUMhEBZrvdLu6wKu67g/mo/photo.jpg?sz=128", "display_name": "Asrakh", "link": "https://stackoverflow.com/users/9938653/asrakh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 50847357, "answer_count": 2, "score": 1, "last_activity_date": 1528993860, "creation_date": 1528929372, "last_edit_date": 1531164843, "question_id": 50847252, "link": "https://stackoverflow.com/questions/50847252/runtime-error-1004-unable-to-get-the-match-property-when-using-two-index-match", "title": "Runtime error 1004 unable to get the match property when using two index/match", "body": "<p>Trying to make the below code work, but unfortunately the second index/match throws an error. The code works if I remove the \"count\" variable from the second part (works fine in the first index/match), and refer to a single cell, no idea why. </p>\n\n<p>Tried initing a new counter variable, part 2 still throws an error. Also, is there a better way to refer to cells in a range, in a for loop, instead of the ghetto solution I used?</p>\n\n<p>Thanks!</p>\n\n<pre><code>Dim sht As Worksheet\nDim LastRow As Long\nDim count As Integer\n\nSet sht = ActiveSheet\nLastRow = sht.Cells(sht.Rows.count, \"A\").End(xlUp).Row\n\ncount = 2\n\n    For Each i In Range(\"f2:f\" &amp; LastRow)\n        With Application.WorksheetFunction\n            i.Value = .Index(Worksheets(\"Area\").Range(\"c:c\"), .Match(Range(\"E\" &amp; count), Worksheets(\"Area\").Range(\"a:a\")))\n        End With\n        count = count + 1\n    Next\n\ncount = 2\n\n    For Each i In Range(\"h2:h\" &amp; LastRow)\n    i.Value = count\n        With Application.WorksheetFunction\n            i.Value = .Index(Worksheets(\"Park reason\").Range(\"C:C\"), .Match(Range(\"G\" &amp; count), Worksheets(\"Park reason\").Range(\"A:A\")))\n        End With\n        count = count + 1\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528930297, "post_id": 50847188, "comment_id": 88698175, "body": "Can you be more specific with what isn&#39;t working? &quot;It doesn&#39;t work&quot; can range from your computer is not turned on to a piece of bad coding. I would hazard a guess that there is an issue opening the files but with <code>DisplayAlerts</code> disable you would never know. Enable those three things and step through the code using F8 to see what its doing."}, {"owner": {"reputation": 57, "user_id": 9732558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118f9c26c2244b0c32a7a45c25e5f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9732558/adam"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528930996, "post_id": 50847188, "comment_id": 88698348, "body": "Apparently there&#39;s a break somewhere. The yellow highlighted part skips the parts after Do While and goes straight to Application.DisplayAlerts at the end"}, {"owner": {"reputation": 57, "user_id": 9732558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118f9c26c2244b0c32a7a45c25e5f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9732558/adam"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528931254, "post_id": 50847188, "comment_id": 88698412, "body": "There&#39;s no highlighted part. Just doesn&#39;t run. When i press F8, it stops at Do while, skips the part underneath and goes to the end"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 9732558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118f9c26c2244b0c32a7a45c25e5f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9732558/adam"}, "edited": false, "score": 0, "creation_date": 1528931745, "post_id": 50847509, "comment_id": 88698509, "body": "Yeah, this works. Next error is  If wsDst.Name = wsSrc.Name Then  --- do you know why it gets stuck here?"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "reply_to_user": {"reputation": 57, "user_id": 9732558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118f9c26c2244b0c32a7a45c25e5f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9732558/adam"}, "edited": false, "score": 0, "creation_date": 1528932067, "post_id": 50847509, "comment_id": 88698590, "body": "Need to be more specific, does it just skip this line or is there an error?"}], "tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 0, "last_activity_date": 1528931187, "creation_date": 1528931187, "answer_id": 50847509, "question_id": 50847188, "link": "https://stackoverflow.com/questions/50847188/vba-copies-content-from-each-file-in-the-folder-to-the-corresponding-worksheet-i/50847509#50847509", "title": "VBA copies content from each file in the folder to the corresponding worksheet in the master workbook", "body": "<p>I think you have an incomplete string.</p>\n\n<pre><code>MyPath = \"C:\\Users\\Adam\\Desktop\\6D6 files\" \nstrFilename = Dir(MyPath &amp; \"*.xls*\", vbNormal)\n</code></pre>\n\n<p>Will be returning C:\\Users\\Adam\\Desktop\\6D6 filessomefile.xls</p>\n\n<pre><code>MyPath = \"C:\\Users\\Adam\\Desktop\\6D6 files\\\"  'with the extra slash\nstrFilename = Dir(MyPath &amp; \"*.xls*\", vbNormal)\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 9732558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118f9c26c2244b0c32a7a45c25e5f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9732558/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 50847509, "answer_count": 1, "score": 0, "last_activity_date": 1528931187, "creation_date": 1528928982, "last_edit_date": 1531164843, "question_id": 50847188, "link": "https://stackoverflow.com/questions/50847188/vba-copies-content-from-each-file-in-the-folder-to-the-corresponding-worksheet-i", "title": "VBA copies content from each file in the folder to the corresponding worksheet in the master workbook", "body": "<p>I need some help on the following code, basically i have about 50 excel files in a folder and i want to copy data from each excel file to the master file. There are 3 worksheets in each file with the name 6D6 Cash, 6D6 Position and 6D6 Transactions and masterworkbook also has those tabs so for example macro will copy all the data from 6D6 cash worksheet in each excel file to the 6D6 cash worksheet in the master workbook and the new data will go below the last filled row. Also the row in each excel file has the header so that won't go in obviously. </p>\n\n<p>For some reason, it's not working, as in the code is not working at all. What could be the reason?</p>\n\n<pre><code>Sub Adam1()\nDim wbDst As Workbook\nDim wsDst As Worksheet\nDim wbSrc As Workbook\nDim wsSrc As Worksheet\nDim MyPath As String\nDim strFilename As String\nDim lLastRow As Long\n\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nSet wbDst = ThisWorkbook\n\nMyPath = \"C:\\Users\\Adam\\Desktop\\6D6 files\"\nstrFilename = Dir(MyPath &amp; \"*.xls*\", vbNormal)\n\nDo While strFilename &lt;&gt; \"\"\n\n        Set wbSrc = Workbooks.Open(MyPath &amp; strFilename)\n\n        'loop through each worksheet in the source file\n        For Each wsSrc In wbSrc.Worksheets\n            'Find the corresponding worksheet in the destination with the same name as the source\n            On Error Resume Next\n            Set wsDst = wbDst.Worksheets(wsSrc.Name)\n            On Error GoTo 0\n            If wsDst.Name = wsSrc.Name Then\n                lLastRow = wsDst.UsedRange.Rows(wsDst.UsedRange.Rows.Count).Row + 1\n                wsSrc.UsedRange.Copy\n                wsDst.Range(\"A\" &amp; lLastRow).PasteSpecial xlPasteValues\n            End If\n        Next wsSrc\n\n        wbSrc.Close False\n        strFilename = Dir()\nLoop\n\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "loops", "for-loop", "sumifs", "vba"], "comments": [{"owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528929608, "post_id": 50847109, "comment_id": 88697961, "body": "No it changes dynamically which is why I have the nRowMax function in there. The photo is a small sample of a pivot that could go hundreds of rows down. Currently being done by hand takes awhile"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1528933733, "post_id": 50847109, "comment_id": 88698922, "body": "This would probably be much easier if you look at the pivot&#39;s data source rather than basically making a &quot;pivot of a pivot&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1528985742, "post_id": 50849069, "comment_id": 88721824, "body": "Yeah maybe I need to mention in my question that the pivot dynamically changes so one month the BEVGR might be 5 rows and another month be 15 rows. So having a static formula will not work"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 1, "creation_date": 1528989337, "post_id": 50849069, "comment_id": 88724090, "body": "@GabeCarvajal - that&#39;s a simple fix: instead of using <code>$F$4:$F$11</code>, just use <code>$F:$F</code>"}, {"owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1528992623, "post_id": 50849069, "comment_id": 88726079, "body": "If I do that than its going to do a subtotal of the entire pivot table... I am trying to sum each group not the whole pivot table. If i were to collapse the whole pivot table there would be 26 groups so i need 26 different totals. Your solution would just get me one total."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1529101674, "post_id": 50849069, "comment_id": 88768821, "body": "@GabeCarvajal - no. it will only sum the group you are after since you are also checking against column D in the SUMIF (which captures the group)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1528945889, "creation_date": 1528945889, "answer_id": 50849069, "question_id": 50847109, "link": "https://stackoverflow.com/questions/50847109/sumif-loop-through-data-groups-vba/50849069#50849069", "title": "Sumif loop through data groups vba", "body": "<p>This can be done without VBA by writing formulas directly on the datasource as @ashleedawg stated, and that would probably be your easiest option, or by writing them directly off the pivot. I have done a mock-up example below that will work for the case you provided:</p>\n\n<p>Here's a screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/l0wjT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l0wjT.png\" alt=\"enter image description here\"></a></p>\n\n<ol>\n<li>Change the Pivot Table Layout as I have instructed in the picture in cell D1</li>\n<li>Use the formula in cell H4: <code>=SUM(SUMIFS($F$4:$F$11,$D$4:$D$11,D4,$E$4:$E$11,{\"A\",\"B\"}))</code></li>\n<li>Drag down as needed.</li>\n</ol>\n\n<p>Now, it's late for me and I did this quick, so I realize it's repetitive and a bit messy. For that you can simply organize a list of single elements and write the formulas off that list.</p>\n\n<p>Alternatively, you can write the formulas directly off the data source by modifying the range arguments of the formula I provided.</p>\n"}], "owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528985987, "creation_date": 1528928485, "last_edit_date": 1531161705, "question_id": 50847109, "link": "https://stackoverflow.com/questions/50847109/sumif-loop-through-data-groups-vba", "title": "Sumif loop through data groups vba", "body": "<p>If this is answered elsewhere please advise...</p>\n\n<p>I am trying to come up with a sumif that will sum column D if Column A criteria = \"PL211010\" &amp; \"PL203000\". The problem is that I need the macro to sum by groups rather than the whole sheet (see pic)<a href=\"https://i.stack.imgur.com/oVhzo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oVhzo.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Not sure where to even start, should i be using a For Next loop? or is a loop even necessary?</p>\n\n<p><em>Important note</em> This pivot dynamically changes month to month. The accounts are not static, they can either increase or decrease. So placing a static formula will not work...</p>\n\n<p>The code below is my attempt to get this to work, just trying to give a baseline.</p>\n\n<pre><code>Dim nRowMax, nRowNow As Integer\n\nApplication.ScreenUpdating = False\n\nCells(4, 1).Select\nSelection.End(xlDown).Select\nnRowMax = Selection.Row\n\nFor i = nRowMax To 4 Step -1\nIf Left(Cells(i, 1), 8) = \"PL211010\" &amp; \"PL203000\" Then\n        WorksheetFunction.SumIf (Cells(i, 4))\nEnd If\nNext i\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1528926938, "post_id": 50846813, "comment_id": 88697215, "body": "Remove the <code>MonthName</code> part <code>Month(DateAdd(&quot;m&quot;, -2, Date))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1528931207, "creation_date": 1528931207, "answer_id": 50847513, "question_id": 50846813, "link": "https://stackoverflow.com/questions/50846813/getting-my-numeric-value-of-two-months-ago-and-attaching-it-to-a-string/50847513#50847513", "title": "Getting my numeric value of two months ago and attaching it to a string", "body": "<p>You can also use</p>\n\n<pre><code>Month(Application.WorksheetFunction.EoMonth(Date, -2))\n</code></pre>\n"}], "owner": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528931207, "creation_date": 1528926706, "question_id": 50846813, "link": "https://stackoverflow.com/questions/50846813/getting-my-numeric-value-of-two-months-ago-and-attaching-it-to-a-string", "title": "Getting my numeric value of two months ago and attaching it to a string", "body": "<p>I am currently trying to get this date:</p>\n\n<pre><code> oldDate2 = MonthName(Month(DateAdd(\"m\", -2, Date)), True) \n</code></pre>\n\n<p>which as of today June 13, returns me Apr; to return me just the numeric value for April, i.e.\"4\". is this possible? </p>\n"}, {"tags": ["http", "ms-access", "xmlhttprequest", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528927048, "post_id": 50846755, "comment_id": 88697246, "body": "There is error text. It is in the response which is printed to the immediate window (Ctrl + G). x-amzn-ErrorType: UnauthorizedException"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528960266, "post_id": 50846755, "comment_id": 88705827, "body": "You actually receive access unauthorised."}, {"owner": {"reputation": 25, "user_id": 9898726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f68818a0464ff529f4ce51b1c399e8e?s=128&d=identicon&r=PG&f=1", "display_name": "U70115", "link": "https://stackoverflow.com/users/9898726/u70115"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1529003108, "post_id": 50846755, "comment_id": 88731008, "body": "I saw the error and I corrected it.    I had to remove the &quot;Basic &quot; out of the .setRequest header.    It then send data."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1529005625, "post_id": 50846755, "comment_id": 88732240, "body": "Please remember to post as answer as it may help others."}], "owner": {"reputation": 25, "user_id": 9898726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f68818a0464ff529f4ce51b1c399e8e?s=128&d=identicon&r=PG&f=1", "display_name": "U70115", "link": "https://stackoverflow.com/users/9898726/u70115"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 800, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594634123, "creation_date": 1528926395, "last_edit_date": 1594634123, "question_id": 50846755, "link": "https://stackoverflow.com/questions/50846755/http-get-request-using-vb-or-vba", "title": "HTTP GET Request Using VB or VBA", "body": "<p>I seen a post \"Trying to integrate an HTTP GET request in MS-Access\".</p>\n\n<p>I used a very similar code, except I entered the authorization key code.</p>\n\n<p>I am unable to determine if the program connected and fail or anything???   I get no responds.</p>\n\n<p>This is my code below, but it doesn't seems to work and no error:\nDo you see any wrong with my code below??? I am also using it with VBA Access.\nOnce I can get in, there is a \"Response Body\" box what has Json data and I want to put it into a temp file and copy it to an text file.</p>\n\n<p>I was going to use what the other post used to capturing the data.</p>\n\n<pre><code>Sub Test()\n    Dim sUrl As String, sAuth As String\n\n    sUrl = \"https://api.ngs.nfl.com/tracking/game/play?gameKey=57444&amp;playId=51\"\n    sAuth = \"NGS AKIAIX2CQ7IEOKPOTKDQ:uNniaOp4jH8jcK9i/EtQhurlilc=\"\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", sUrl, False\n        .setRequestHeader \"Authorization\", \"Basic \" &amp; sAuth\n        .send\n        Debug.Print .responseText\n        Debug.Print .getAllResponseHeaders\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1528925867, "post_id": 50846611, "comment_id": 88696806, "body": "What is your question exactly? What is your code lacking that you need?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528927361, "post_id": 50846611, "comment_id": 88697352, "body": "Also, you need to re-activate <code>ScreenUpdating</code> at some point in your code"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1528927875, "last_edit_date": 1528927875, "creation_date": 1528926307, "answer_id": 50846737, "question_id": 50846611, "link": "https://stackoverflow.com/questions/50846611/add-an-open-file-name-to-a-cell-in-new-workbook-so-i-can-use-it-as-headers-use/50846737#50846737", "title": "Add an open file name to a cell in new workbook so I can use it as headers &amp; use File 1 and File 2 to name my newly added workbook", "body": "<p>I believe you are looking for the <code>.Name</code> property. </p>\n\n<p>It can be used as follows to return the name of Workbooks, Sheets, etc. You need this for the workbook, so you may use as follows. </p>\n\n<pre><code>MsgBox Replace(ThisWorkbook.Name, \".xlsx\", \"\")\nMsgBox Replace(ActiveWorkbook.Name, \".xlsx\", \"\") \n</code></pre>\n\n<p>You can implement it in your code as such:  </p>\n\n<pre><code>Dim WBook1 as String\nDim WBook2 as String\nWBook1 = Replace(ThisWorkbook.Name, \".xlsx\", \"\")\nWBook2 = Replace(ActiveWorkbook.Name, \".xlsx\", \"\") \n</code></pre>\n\n<p>You can then just reference <code>WBook1</code> &amp; <code>WBook2</code> whenever you need to</p>\n"}, {"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 9938430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f193a9c0baaae97246b997e19f7da8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe", "link": "https://stackoverflow.com/users/9938430/chloe"}, "edited": false, "score": 0, "creation_date": 1528986861, "post_id": 50848162, "comment_id": 88722521, "body": "For example <code>sht.Range(&quot;A1&quot;).Value = nm1</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1528937380, "creation_date": 1528937380, "answer_id": 50848162, "question_id": 50846611, "link": "https://stackoverflow.com/questions/50846611/add-an-open-file-name-to-a-cell-in-new-workbook-so-i-can-use-it-as-headers-use/50848162#50848162", "title": "Add an open file name to a cell in new workbook so I can use it as headers &amp; use File 1 and File 2 to name my newly added workbook", "body": "<p>Tested:</p>\n\n<pre><code>Option Explicit\n\nSub ImportSalesData()\n\n    Dim Wb1 As Workbook\n    Dim Wb2 As Workbook\n    Dim wbNew As Workbook\n    Dim sht As Worksheet, nm1 As String, nm2 As String\n\n    'choose the workbooks\n    Set Wb1 = ChooseWorkbook(\"Select the first sales month\")\n    If Wb1 Is Nothing Then Exit Sub\n\n    Set Wb2 = ChooseWorkbook(\"Select the second sales month\")\n    If Wb2 Is Nothing Then Exit Sub\n\n    'get the names, ignoring the extension\n    nm1 = Split(Wb1.Name, \".\")(0)\n    nm2 = Split(Wb2.Name, \".\")(0)\n\n    Set wbNew = Workbooks.Add()\n    Set sht = wbNew.Sheets(1)\n\n    sht.Name = \"Compare Sales\"\n\n    'probably should not use full-column ranges....\n    sht.Range(\"A:M\").Value = Wb1.Sheets(1).Range(\"A:M\").Value\n    sht.Range(\"O:AA\").Value = Wb2.Sheets(1).Range(\"A:M\").Value\n\n    sht.UsedRange.EntireColumn.AutoFit\n\n    Wb1.Close False 'close source workbooks without saving\n    Wb2.Close False\n\n    wbNew.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; nm1 &amp; \" and \" &amp; nm2 &amp; \".xlsx\"\n\nEnd Sub\n\n'let the user pick a file...\n' Returns Nothing if no selection\nFunction ChooseWorkbook(sTitle As String)\n    Dim rv As Workbook\n    With Application.FileDialog(msoFileDialogFilePicker)\n        .AllowMultiSelect = False\n        .Title = sTitle\n        .Filters.Clear\n        If .Show = True Then Set rv = Workbooks.Open(.SelectedItems(1))\n    End With\n    Set ChooseWorkbook = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9938430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f193a9c0baaae97246b997e19f7da8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe", "link": "https://stackoverflow.com/users/9938430/chloe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528937380, "creation_date": 1528925666, "last_edit_date": 1531164843, "question_id": 50846611, "link": "https://stackoverflow.com/questions/50846611/add-an-open-file-name-to-a-cell-in-new-workbook-so-i-can-use-it-as-headers-use", "title": "Add an open file name to a cell in new workbook so I can use it as headers &amp; use File 1 and File 2 to name my newly added workbook", "body": "<p>I am using msoFileDialogFilePicker to open two files to import data into a new workbook to compare. I would like to use the file names as headers in my new workbook PLUS use the file names to name my new workbook. For example, February Sales vs March Sales.xlsx and also as headings in my sheet tabs. File 1 in cell A1 and File Name 2 in cell O2. In advance, thank you!</p>\n\n<p>Sub ImportSalesData()\n       Application.DisplayAlerts = False</p>\n\n<pre><code>   Dim directory As String, Filename As String, sheet As Worksheet, total As \n         Integer\n   Dim fd As Office.FileDialog\n   Dim wb As Workbook\n   Dim Wb2 As Workbook\n   Dim sht As Worksheet\n\n\n\n   Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n   With fd\n    .AllowMultiSelect = False\n    .Title = \"Select the first sales month\"\n    .Filters.Clear\n\n\n    If .Show = True Then\n      Filename = Dir(.SelectedItems(1))\n\n    End If\n   End With\n\n    Workbooks.Open (Filename)\n\n    Set range1 = Range(\"A:M\")\n    range1.Copy\n\n    Set newbook = Workbooks.Add\n    ActiveSheet.Name = \"Compare Sales\"\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues\n    ActiveWorkbook.SaveAs ThisWorkbook.Path &amp; \"Name of File 1  and Name of File 2\", xlWorkbookNormal\n\n\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n   With fd\n    .AllowMultiSelect = False\n    .Title = \"Select the second sales month\"\n    .Filters.Clear\n\n\n    If .Show = True Then\n      Filename = Dir(.SelectedItems(1))\n\n    End If\n   End With\n\n\n   Workbooks.Open (Filename)\n\n\n\nSet range2 = Range(\"A:M\")\nrange2.Copy\nWorkbooks(\"Name of File 1  and Name of File 2\").Activate\nSheets(\"Compare Sales\").Activate\nRange(\"O1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues\nThisWorkbook.Worksheets(\"Compare Sales\").Cells.EntireColumn.AutoFit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "lookup", "lookup-tables", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528935236, "post_id": 50846495, "comment_id": 88699202, "body": "Yes you can use VBA for this.  Are you having a specific problem using it?"}, {"owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528952181, "post_id": 50846495, "comment_id": 88702449, "body": "I think I can be able to work out the VBA for the current way I update. What I am looking for is the code to search new lines only and add these. Copying and pasting all the data is pretty slow"}, {"owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528952607, "post_id": 50846495, "comment_id": 88702581, "body": "What about copying all the data across and running a macro to remove duplicates? Is there a way to remove the duplicates from the bottom up so to speak thus leaving the original in place?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528953611, "post_id": 50846495, "comment_id": 88702902, "body": "You can loop over the new file and use Find or Match to see if they&#39;re in the old file.  If not, copy them over."}], "answers": [{"tags": [], "owner": {"reputation": 234, "user_id": 6418109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3feb28dbc24648307695697d147c76a4?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/6418109/the-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1528966980, "creation_date": 1528966980, "answer_id": 50853634, "question_id": 50846495, "link": "https://stackoverflow.com/questions/50846495/updating-table-with-new-lines/50853634#50853634", "title": "Updating Table with New Lines", "body": "<p>Use the Remove Duplicates feature in Excel on the Data tab.\nThis feature, allowing one to choose which column to use as the comparison factor is easiest.</p>\n\n<p>If you need to write a macro, there are faster ways to code it than looping through 3000+ values to look for a duplicate or using FIND to locate duplicates.\nI had a similar problem and wrote a macro to eliminate duplicates using a loop for 2000+ rows of data. It took 2 minutes to execute. The method referenced below took 2 seconds to execute!\nCheck out Rick Rothstein's code at \n<a href=\"https://www.mrexcel.com/forum/excel-questions/574917-fast-duplicate-check-large-data-sets-using-vba.html\" rel=\"nofollow noreferrer\">Fast Duplicate Check For Large Data Sets Using VBA</a>\nI used and modified his code and it is the fastest solution I have found.</p>\n"}], "owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528966980, "creation_date": 1528925117, "last_edit_date": 1531161705, "question_id": 50846495, "link": "https://stackoverflow.com/questions/50846495/updating-table-with-new-lines", "title": "Updating Table with New Lines", "body": "<p>I have a 3500+ row table that each week 250 old lines are removed and 250 new lines are added, say on a Sunday. Throughout the course of the week, columns Y and Z are used to write comments (Y via a drop down box). These comments are to stay with the associated row.</p>\n\n<p>My problem is updating the table with the new 250 lines. The new lines will be released as a new table (so mixed amongst the 3000 rows that are not removed). Previously I copied all the data into another worksheet, performed a vlookup and then copy and pasted over the old table. Is there a better or quicker way? Open to using VBA/Macros.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel", "autocad", "autocad-plugin"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 2, "creation_date": 1528925630, "post_id": 50846447, "comment_id": 88696701, "body": "Have you tried any <b>basic debugging</b>? Adding breakpoints inside loops and inspecting objects?  Even basic <code>Debug.Print</code> statements to determine how far into your loops the code is getting into? Start by changing <code>On Error Resume Next</code> to <code>On Error Goto 0</code>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1528929500, "post_id": 50846447, "comment_id": 88697933, "body": "this line... <code>Acad.Application.Update</code> - why are you not using your <code>ACADApp</code> object?"}, {"owner": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "edited": false, "score": 0, "creation_date": 1530074189, "post_id": 50846447, "comment_id": 89099939, "body": "Can\u2019t you just add a reference to the Autocad Library and avoid the need for the GetObject calls? And as per comments, use the debugger and follow it step by step."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 11213720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JsfICKL03Ms/AAAAAAAAAAI/AAAAAAAAAJc/VLYaUQvkNEY/photo.jpg?sz=128", "display_name": "tracciatura.net", "link": "https://stackoverflow.com/users/11213720/tracciatura-net"}, "is_accepted": false, "score": 0, "last_activity_date": 1553221621, "last_edit_date": 1553221621, "creation_date": 1553205249, "answer_id": 55289829, "question_id": 50846447, "link": "https://stackoverflow.com/questions/50846447/how-can-i-refer-to-autocad-block/55289829#55289829", "title": "How can I refer to AutoCAD block", "body": "<p>Have you tried adding the reference library?</p>\n\n<p>You can go to: </p>\n\n<blockquote>\n  <p>Tools->References </p>\n</blockquote>\n\n<p>And add: </p>\n\n<blockquote>\n  <p>[<strong>AutoCAD 20xx Type Library</strong>]</p>\n</blockquote>\n"}], "owner": {"reputation": 23, "user_id": 9938359, "user_type": "registered", "profile_image": "https://graph.facebook.com/414701052330525/picture?type=large", "display_name": "Kirill Kriachenko", "link": "https://stackoverflow.com/users/9938359/kirill-kriachenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 427, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1553221621, "creation_date": 1528924849, "question_id": 50846447, "link": "https://stackoverflow.com/questions/50846447/how-can-i-refer-to-autocad-block", "title": "How can I refer to AutoCAD block", "body": "<p>I having autocad project where is 1 dynamic block which I'm trying to change from excel. \nHere is vba script which I'm using to change block:</p>\n\n<pre><code>Dim dybprop As Variant, i As Integer\nDim bobj As AcadEntity\n\nFor Each bobj In ACADApp.ModelSpace\n    If bobj.ObjectName = \"AcDbBlockReference\" Then\n        If bobj.IsDynamicBlock Then\n            If bobj.EffectiveName = \"AdjBlock\" Then\n                dybprop = bobj.GetDynamicBlockProperties\n                For i = LBound(dybprop) To UBound(dybprop)\n                    If dybprop(i).PropertyName = \"Distance1\" Then\n                        dybprop(i).Value = 50.75\n                        Acad.Application.Update\n                    End If\n                Next i\n            End If\n        End If\n    End If\nNext\n\nEnd With\n</code></pre>\n\n<p>When I'm running it in AutoCAD VBA it works excellent. Than I'm creating Excel VBA project and copying this code. Before running it I creating connection to existing AutoCad project like this:</p>\n\n<pre><code>  On Error Resume Next\n\n   Dim ACADApp As AcadApplication\n   Dim a As Object\n\n   Set a = GetObject(, \"AutoCAD.Application\")\n\n   If a Is Nothing Then\n      Set a = CreateObject(\"AutoCAD.Application\")\n\n      If a Is Nothing Then\n         MsgBox \"AutoCAD must be running before performing this action.\", vbCritical\n         Exit Sub\n      End If\n   End If\n\n   Set ACADApp = a\n\n   Set ACADApp.ActiveDocument = ACADApp.Documents.Open(\"c:\\KIRILL\\Programming\\Drawing1_VBATest.dwg\")\n</code></pre>\n\n<p>When I'm running it from Excel VBA - AutoCAD project appears but nothing change. Honestly I don't have any idea why in Excel VBA it doesn't works while in AutoCAD it work. May be somebody had this problem before? Thanks in advance.</p>\n\n<p>P.S. Full Excel VBA code:</p>\n\n<pre><code>Sub Button9_Click()\n\n  On Error Resume Next\n\n   Dim ACADApp As AcadApplication\n   Dim a As Object\n\n   Set a = GetObject(, \"AutoCAD.Application\")\n\n   If a Is Nothing Then\n      Set a = CreateObject(\"AutoCAD.Application\")\n\n      If a Is Nothing Then\n         MsgBox \"AutoCAD must be running before performing this action.\", vbCritical\n         Exit Sub\n      End If\n   End If\n\n   Set ACADApp = a\n\n   Set ACADApp.ActiveDocument = ACADApp.Documents.Open(\"c:\\KIRILL\\Programming\\Drawing1_VBATest.dwg\")\n\nDim dybprop As Variant, i As Integer\nDim bobj As AcadEntity\n\nFor Each bobj In ACADApp.ModelSpace\n    If bobj.ObjectName = \"AcDbBlockReference\" Then\n        If bobj.IsDynamicBlock Then\n            If bobj.EffectiveName = \"AdjBlock\" Then\n                dybprop = bobj.GetDynamicBlockProperties\n                For i = LBound(dybprop) To UBound(dybprop)\n                    If dybprop(i).PropertyName = \"Distance1\" Then\n                        dybprop(i).Value = 50.75\n                        Acad.Application.Update\n                    End If\n                Next i\n            End If\n        End If\n    End If\nNext\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "vba"], "answers": [{"comments": [{"owner": {"reputation": 804, "user_id": 4829915, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/cf430a1257828409df788e154a5c8dea?s=128&d=identicon&r=PG&f=1", "display_name": "LWC", "link": "https://stackoverflow.com/users/4829915/lwc"}, "edited": false, "score": 0, "creation_date": 1530258580, "post_id": 51091166, "comment_id": 89181243, "body": "As mentioned <i>&quot;For example, if I want to change a field only those pivot tables have.&quot;</i>"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 804, "user_id": 4829915, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/cf430a1257828409df788e154a5c8dea?s=128&d=identicon&r=PG&f=1", "display_name": "LWC", "link": "https://stackoverflow.com/users/4829915/lwc"}, "edited": false, "score": 1, "creation_date": 1530295104, "post_id": 51091166, "comment_id": 89201282, "body": "Cool. You should be good to go with my code. If you&#39;re planning on doing any filtering to those PivotFields, be sure to set the PivotTable.ManualUpdate property to TRUE before you filter, and then FALSE afterwards. I wrote a post on this some time back at <a href=\"http://dailydoseofexcel.com/archives/2013/11/14/filtering-pivots-based-on-external-ranges/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2013/11/14/&hellip;</a> that discusses this in further detail."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 804, "user_id": 4829915, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/cf430a1257828409df788e154a5c8dea?s=128&d=identicon&r=PG&f=1", "display_name": "LWC", "link": "https://stackoverflow.com/users/4829915/lwc"}, "edited": false, "score": 0, "creation_date": 1530572450, "post_id": 51091166, "comment_id": 89273610, "body": "@LWC Can you accept my answer if it solves the problem?"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 2, "last_activity_date": 1530219686, "creation_date": 1530219686, "answer_id": 51091166, "question_id": 50846439, "link": "https://stackoverflow.com/questions/50846439/looping-through-all-pivot-tables-that-use-a-certain-pivotcache/51091166#51091166", "title": "Looping through all pivot tables that use a certain pivotcache", "body": "<p>There's strangely no direct way to get this from the PivotCache. Instead, you need to loop through every PT in the workbook, and see if it's PivotCache is the same as the one you're interested in, like this:</p>\n\n<pre><code>Option Explicit\n\nSub Loop_PivotCache(ptExample As PivotTable)\nDim pt As PivotTable\nDim pc As PivotCache\n\nSet pc = ptExample.PivotCache\n\nFor Each wks In ActiveWorkbook.Worksheets\n    For Each pt In wks.PivotTables\n        If pt.PivotCache.Index = pc.Index Then\n            Debug.Print pt.Name\n        End If\n    Next pt\nNext wks\nEnd Sub\n</code></pre>\n\n<p>Call that sub like so:</p>\n\n<pre><code>Sub Caller()\nLoop_PivotCache Worksheets(\"SomeWorksheet\").PivotTables(\"SomePivotTable\")\nEnd Sub\n</code></pre>\n\n<p>Question: What are you wanting to actually do to each PivotTable? Depending on what you're trying to do, there are some things you probably need to know from an efficiency perspective. </p>\n"}], "owner": {"reputation": 804, "user_id": 4829915, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/cf430a1257828409df788e154a5c8dea?s=128&d=identicon&r=PG&f=1", "display_name": "LWC", "link": "https://stackoverflow.com/users/4829915/lwc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "accepted_answer_id": 51091166, "answer_count": 1, "score": 0, "last_activity_date": 1530219686, "creation_date": 1528924812, "last_edit_date": 1531164843, "question_id": 50846439, "link": "https://stackoverflow.com/questions/50846439/looping-through-all-pivot-tables-that-use-a-certain-pivotcache", "title": "Looping through all pivot tables that use a certain pivotcache", "body": "<p>If a workbook has multiple worksheets with multiple pivot tables with multiple pivotcaches, how can I loop through only pivot tables that use a specific pivotcache? For example, if I want to change a field only those pivot tables have.</p>\n\n<p>I can obviously loop through every single pivot table in the workbook and check its SourceData, but I wonder if there's something like:</p>\n\n<pre><code>For Each pt In ThisWorkbook.PivotCaches(\"this\").pivottables_list\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel", "save-as", "illegal-characters"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1528924740, "post_id": 50846340, "comment_id": 88696368, "body": "Maybe there are illegal characters in <code>G2</code>?  It would be a good idea if you posted at actual error message and some sample data"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1528924996, "post_id": 50846340, "comment_id": 88696459, "body": "before the save line, do a msgbox line to see if the results are correct.<code>msgbox  WBPath &amp; &quot;\\BOM_&quot; &amp; Range(&quot;G2&quot;) &amp; &quot;_&quot; &amp; WkbName &amp; &quot;.xlsx&quot;</code> if it is incorect, you will know where to edit your string."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1528939023, "post_id": 50848245, "comment_id": 88699898, "body": "<code>strSpecialChars(i)</code> doesn&#39;t work in VBA.  Use <code>Mid$(strSpecialChars, i, 1)</code> instead"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1528939608, "post_id": 50848245, "comment_id": 88699982, "body": "Thanks Chris - that&#39;s what happen when you are working on multiple languages. Sometime I code in C# too. Correcting the code. Thanks a heap for pointing out."}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 1, "creation_date": 1529411593, "post_id": 50848245, "comment_id": 88855878, "body": "edited post to include original error message and the one after using your function and code edit @jainashish"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 1, "creation_date": 1529412571, "post_id": 50848245, "comment_id": 88856554, "body": "Edited my post again - need to add the provision to include square brackets too!"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1529413363, "post_id": 50848245, "comment_id": 88857107, "body": "odd. I had to restart excel 2 times but its working now. Thanks for your help"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1529413719, "post_id": 50848245, "comment_id": 88857349, "body": "also any chance there is an easy method to check for sheets2 &amp; 3 before deleting them? <code>&#39; delete extra sheets Sheets(Array(&quot;Sheet2&quot;, &quot;Sheet3&quot;)).Select     ActiveWindow.SelectedSheets.Delete</code>"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 1, "creation_date": 1529452082, "post_id": 50848245, "comment_id": 88874925, "body": "Visit this link: <a href=\"https://stackoverflow.com/questions/18594223/how-to-delete-a-blank-sheet-in-a-workbook-using-vba\" title=\"how to delete a blank sheet in a workbook using vba\">stackoverflow.com/questions/18594223/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "is_accepted": true, "score": 13, "last_activity_date": 1529412609, "last_edit_date": 1529412609, "creation_date": 1528938339, "answer_id": 50848245, "question_id": 50846340, "link": "https://stackoverflow.com/questions/50846340/remove-illegal-characters-while-saving-workbook-excel-vba/50848245#50848245", "title": "Remove illegal characters while saving workbook Excel VBA", "body": "<p>Because there could be more illegal characters in the filename. Your approach is right but it's not comprehensive list of illegal characters to remove or replace from the filename before saving it. For eg. these characters are missing from the array in your code -> : &amp; . However it is advised to keep filename rid of other allowed special characters too.</p>\n\n<p>Below, I am providing the function which returns a safe string that can be used to produce filename before saving.</p>\n\n<pre><code>Function ReplaceIllegalCharacters(strIn As String, strChar As String) As String\n    Dim strSpecialChars As String\n    Dim i As Long\n    strSpecialChars = \"~\"\"#%&amp;*:&lt;&gt;?{|}/\\[]\" &amp; Chr(10) &amp; Chr(13)\n\n    For i = 1 To Len(strSpecialChars)\n        strIn = Replace(strIn , Mid$(strSpecialChars, i, 1), strChar)\n    Next\n\n    ReplaceIllegalCharacters = strIn \nEnd Function\n</code></pre>\n\n<p>Specifically, in your code, replace the ActiveWorkbook.SaveAs line with this line:</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:= _\n   WBPath &amp; \"\\BOM_\" &amp; Range(\"G2\").Value2 &amp; \"_\" &amp; ReplaceIllegalCharacters(Range(\"H2\").Value2, \"_\") &amp; \".xlsx\" _\n    , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9815, "favorite_count": 1, "accepted_answer_id": 50848245, "answer_count": 1, "score": 5, "last_activity_date": 1529412609, "creation_date": 1528924276, "last_edit_date": 1529411531, "question_id": 50846340, "link": "https://stackoverflow.com/questions/50846340/remove-illegal-characters-while-saving-workbook-excel-vba", "title": "Remove illegal characters while saving workbook Excel VBA", "body": "<p>this code basically reformats an xls file and saves it as an xlsx. however it uses <code>G2</code> &amp; <code>H2</code> to grab the filename for the newly formatted file. \nSo that means certain characters can't be in the file name. I added a chunk of code to replace those characters ( </p>\n\n<pre><code>' Remove/Replace Invalid File Name Characters\n WkbName = Range(\"H2\")\n    MyArray = Array(\"&lt;\", \"&gt;\", \"|\", \"/\", \"*\", \"\\\", \".\", \"?\", \"\"\"\")\n    For X = LBound(MyArray) To UBound(MyArray)\n        WkbName = Replace(WkbName, MyArray(X), \"_\", 1)\n            Next X\n                'MsgBox WkbName     'dispaly file name with illegal characters removed\n\n    ActiveWorkbook.SaveAs Filename:= _\n       WBPath &amp; \"\\BOM_\" &amp; Range(\"G2\") &amp; \"_\" &amp; WkbName &amp; \".xlsx\" _\n        , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False \n</code></pre>\n\n<p>)\nactiveworkbook.saves as is where the debugger always takes me</p>\n\n<p>I'm getting an error message saying there's always an illegal character even if its just normal text in <code>h2</code>, am I missing something?</p>\n\n<p>full code below</p>\n\n<pre><code>Sub FormatBOMExport()\n'\n' FormatBOMExportPnV Macro\n'\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n' delete extra sheets\nSheets(Array(\"Sheet2\", \"Sheet3\")).Select\n    ActiveWindow.SelectedSheets.Delete\n\nWBPath = Application.ActiveWorkbook.Path\nOrgFile = Application.ActiveWorkbook.FullName\n\n        Range(\"B1\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n\n    Columns(\"A:M\").Select\n    Selection.Replace What:=\"\" &amp; Chr(10) &amp; \"\", Replacement:=\"\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n\n    Selection.Columns.AutoFit\n    Selection.Rows.AutoFit\n\n    Columns(\"J:J\").Select\n        With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n\n'    Columns(\"J:J\").Select\n'        Columns(\"J:J\").ColumnWidth = 100\n'            Selection.Rows.AutoFit\n\n    Columns(\"G:G\").EntireColumn.AutoFit\n        Range(\"G2\").Select\n\n' Remove/Replace Invalid File Name Characters\n WkbName = Range(\"H2\")\n    MyArray = Array(\"&lt;\", \"&gt;\", \"|\", \"/\", \"*\", \"\\\", \".\", \"?\", \"\"\"\")\n    For X = LBound(MyArray) To UBound(MyArray)\n        WkbName = Replace(WkbName, MyArray(X), \"_\", 1)\n            Next X\n                'MsgBox WkbName     'dispaly file name with illegal characters removed\n\n    ActiveWorkbook.SaveAs Filename:= _\n       WBPath &amp; \"\\BOM_\" &amp; Range(\"G2\") &amp; \"_\" &amp; WkbName &amp; \".xlsx\" _\n        , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n\n    If Len(Dir$(OrgFile)) &gt; 0 Then\n        Kill OrgFile\n            End If\n\n  Application.DisplayAlerts = True\n\nApplication.ScreenUpdating = True\n\n ' MsgBox OrgFile &amp; \" has been deleted and saved as \" &amp; \"BOM_\" &amp; Range(\"G2\") &amp; \"_\" &amp; Range(\"H2\") &amp; \".xlsx\"\n\nEnd Sub\n`\n</code></pre>\n\n<p>please excuse my notes and random crap in the code. I always clean it up before I give it to others</p>\n\n<p><a href=\"https://i.stack.imgur.com/EMvJ2.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/EMvJ2.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "batch-file", "command-line"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 5, "creation_date": 1528923904, "post_id": 50846182, "comment_id": 88696015, "body": "That is not wise. It should be a policy level decision in general regarding macro security settings. Bypassing security that protects a user and forces macros to run would not be a good thing IMHO."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1528957032, "creation_date": 1528957032, "answer_id": 50850781, "question_id": 50846182, "link": "https://stackoverflow.com/questions/50846182/run-excel-with-macro-enabled/50850781#50850781", "title": "Run Excel with macro enabled", "body": "<p>Sign your code with a digital certificate that is trusted as code publisher in your company computers.\nThen set via group policy for all clients <em>\"disable all macros except digitally signed\"</em>. \nAfter that Excel will never ask again to enable macros for your digitally signed codes.</p>\n\n<p>Alternatively set via group policy that some folders are trusted locations, so that VBA code in these locations is automatically trusted. See <a href=\"https://support.office.com/en-us/article/add-remove-or-change-a-trusted-location-7ee1cdc2-483e-4cbb-bcb3-4e7c67147fb4\" rel=\"nofollow noreferrer\">Add, remove, or change a trusted location</a>. But I recommend to do this via group policy: <a href=\"https://www.urtech.ca/2016/11/solved-gpo-to-block-macros-on-local-pc-but-not-file-shares/\" rel=\"nofollow noreferrer\">GPO To Block Macro\u2019s On Local PC But Not File Shares</a>.</p>\n"}], "owner": {"reputation": 607, "user_id": 9073241, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad17ee95cc6886df8e31abeb84bd50f2?s=128&d=identicon&r=PG&f=1", "display_name": "Heap of Pinto Beans", "link": "https://stackoverflow.com/users/9073241/heap-of-pinto-beans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "closed_date": 1528969706, "answer_count": 1, "score": -1, "last_activity_date": 1528957032, "creation_date": 1528923559, "last_edit_date": 1528956584, "question_id": 50846182, "link": "https://stackoverflow.com/questions/50846182/run-excel-with-macro-enabled", "closed_reason": "Duplicate", "title": "Run Excel with macro enabled", "body": "<p>I am forcing my user to run a batch file to run an Excel VBA Application because it is run as a different user that has rights to certain resources that the user doesn't have direct access to.</p>\n\n<p>The batch file is shown below and works great.  The only thing I don't like is that because the file is run as a different user, it always asks you to enable macros when you hit excel.</p>\n\n<p>Is there a way to run the Exel in the batch file such that it doesn't ask you to enable macros--that they are forced enabled?</p>\n\n<p>The account I am using to run is a service account.  It has no log in privileges.  It only has rights to read and write to certain folders.</p>\n\n<p><strong>HERE IS MY BAT FILE:</strong></p>\n\n<pre><code>runas /user:ALLIEDFIT\\teammtr /savecred \"C:\\Program Files (x86)\\Microsoft Office\\Office15\\Excel.exe \\\"\\\\afhoufile02\\User_Folders\\Allied MTRS\\Allied MTRS Auto\\Z_Dev\\_Prod_Push.xlsm\\\"\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 2, "creation_date": 1528923971, "post_id": 50846082, "comment_id": 88696050, "body": "Unfortunately, you can&#39;t do that."}, {"owner": {"reputation": 253, "user_id": 7200174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/702664a039a535a32704cd9a023239de?s=128&d=identicon&r=PG&f=1", "display_name": "Yahtzee", "link": "https://stackoverflow.com/users/7200174/yahtzee"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1528924011, "post_id": 50846082, "comment_id": 88696063, "body": "Bummer, thanks for letting me know @Davesexcel"}], "answers": [{"comments": [{"owner": {"reputation": 253, "user_id": 7200174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/702664a039a535a32704cd9a023239de?s=128&d=identicon&r=PG&f=1", "display_name": "Yahtzee", "link": "https://stackoverflow.com/users/7200174/yahtzee"}, "edited": false, "score": 0, "creation_date": 1528923911, "post_id": 50846225, "comment_id": 88696021, "body": "Thank you for your answer - this would work if the actual cells were being filtered.  However, I&#39;m trying to reference the values in the filter itself.  I&#39;ve updated my question for clarity."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1528923729, "creation_date": 1528923729, "answer_id": 50846225, "question_id": 50846082, "link": "https://stackoverflow.com/questions/50846082/vba-get-values-from-autofilter/50846225#50846225", "title": "VBA Get Values from AutoFilter", "body": "<p>You can extract the visible cells in to an array. Say your total range (without filter) is <code>A2:A10000</code>.  Run your filter, then you can run this macro:</p>\n\n<pre><code>Sub t()\nDim arr() As Variant\narr = Range(\"A2:A10000\").SpecialCells(xlCellTypeVisible)\n\nDim i As Long\nFor i = LBound(arr) To UBound(arr)\n    Debug.Print (arr(i, 1))\n    ' Do things with each entry in array\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1528924502, "creation_date": 1528924502, "answer_id": 50846384, "question_id": 50846082, "link": "https://stackoverflow.com/questions/50846082/vba-get-values-from-autofilter/50846384#50846384", "title": "VBA Get Values from AutoFilter", "body": "<p>You can use advanced filter, it's pretty darn quick. I tried it with 127k rows, the results were instant.</p>\n\n<pre><code>    Columns(\"A:A\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range(\"D1\"), Unique:=True\n</code></pre>\n"}], "owner": {"reputation": 253, "user_id": 7200174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/702664a039a535a32704cd9a023239de?s=128&d=identicon&r=PG&f=1", "display_name": "Yahtzee", "link": "https://stackoverflow.com/users/7200174/yahtzee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5253, "favorite_count": 0, "accepted_answer_id": 50846384, "answer_count": 2, "score": 0, "last_activity_date": 1528924502, "creation_date": 1528923099, "last_edit_date": 1528923836, "question_id": 50846082, "link": "https://stackoverflow.com/questions/50846082/vba-get-values-from-autofilter", "title": "VBA Get Values from AutoFilter", "body": "<p>Let's say I have very large set of data with over 100,000+ rows.  In Column A, I want to find each unique number.</p>\n\n<p>I understand this can be done using the .Find feature and Collections/Arrays but those seem to take a good bit of time - especially with 100,000+ rows.</p>\n\n<p>However, after AutoFiltering Column A, when I hit the down arrow it displays only unique variables.  Is it possible to simply extract those values out of the selections in this way?</p>\n\n<pre><code>'pseudocode\nfilter.Count\nDim X As Long\nFor x = 2 to filter.Count\n   Cells(x, 14) = filter(x)\nNext x\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528923030, "post_id": 50846022, "comment_id": 88695658, "body": "Record a macro then review what code you have when you&#39;ve done what you described above."}, {"owner": {"reputation": 121, "user_id": 9938320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a369500fc8e72b4deccd9666238f3324?s=128&d=identicon&r=PG&f=1", "display_name": "TDJ", "link": "https://stackoverflow.com/users/9938320/tdj"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528923411, "post_id": 50846022, "comment_id": 88695815, "body": "I have the framework for the code. The only issue I run into is being able to search the entire column and match those dates with the date on another sheet."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528923465, "post_id": 50846022, "comment_id": 88695839, "body": "If you have the code please post it in your question highlighting which bit isn&#39;t working."}, {"owner": {"reputation": 121, "user_id": 9938320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a369500fc8e72b4deccd9666238f3324?s=128&d=identicon&r=PG&f=1", "display_name": "TDJ", "link": "https://stackoverflow.com/users/9938320/tdj"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528925177, "post_id": 50846022, "comment_id": 88696521, "body": "There it is sorry"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528926098, "post_id": 50846022, "comment_id": 88696907, "body": "If you need to replace i to 500 with a column I don&#39;t understand why you&#39;re looping through the whole column to then overwrite it?"}, {"owner": {"reputation": 121, "user_id": 9938320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a369500fc8e72b4deccd9666238f3324?s=128&d=identicon&r=PG&f=1", "display_name": "TDJ", "link": "https://stackoverflow.com/users/9938320/tdj"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528926280, "post_id": 50846022, "comment_id": 88696979, "body": "What I mean that instead of searching i to 500, I need to search the entire column. Originally I only needed to search the first 500 cells, but the document size is going to grow over time now and I need it to search through the whole column in order to account for the growth of the document in the future."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 1, "creation_date": 1528926461, "post_id": 50846022, "comment_id": 88697042, "body": "<a href=\"https://stackoverflow.com/questions/14931700/how-to-find-a-value-in-an-excel-column-by-vba-code-cells-find\" title=\"how to find a value in an excel column by vba code cells find\">stackoverflow.com/questions/14931700/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 2, "last_activity_date": 1534012160, "last_edit_date": 1534012160, "creation_date": 1528931652, "answer_id": 50847572, "question_id": 50846022, "link": "https://stackoverflow.com/questions/50846022/vba-numeric-value-find-overwrite-data/50847572#50847572", "title": "VBA Numeric Value Find / Overwrite data", "body": "<p>You do not want to run a loop down your entire column (slightly over 1 mil X). Instead, find your last row form the bottom, and loop through that range.  </p>\n\n<p>If your goal is to run a second Macro when you do find a match, you can get rid of your <code>msgbox</code> and <code>Exit Sub</code> and replace with <code>Call SecondMacro</code>, where \"SecondMacro\" is the name you assigned to your sub of course. Just an option ~ </p>\n\n<pre><code>Sub FindMatchingValue()\n\nDim i As Integer, ValueToFind As Integer, LRow as Integer\nintValueToFind = Sheet8.Range(\"L6\")\n\nLRow = Range(\"A\" &amp; Rows.Count).End(XlUp).Row\n\nFor i = 1 To LRow\n    If Cells(i, 1).Value = intValueToFind Then\n        MsgBox (\"Found value on row \" &amp; i)\n        Exit Sub\n    End If\nNext i\n\nMsgBox (\"Value not found in the range!\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 9938320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a369500fc8e72b4deccd9666238f3324?s=128&d=identicon&r=PG&f=1", "display_name": "TDJ", "link": "https://stackoverflow.com/users/9938320/tdj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 50847572, "answer_count": 1, "score": 2, "last_activity_date": 1534012160, "creation_date": 1528922832, "last_edit_date": 1528924108, "question_id": 50846022, "link": "https://stackoverflow.com/questions/50846022/vba-numeric-value-find-overwrite-data", "title": "VBA Numeric Value Find / Overwrite data", "body": "<p>I am in the process of writing a macro that allows me to update data monthly. However, I realized that sometimes I will need to overwrite the data from the same month when there is a correction issued to the data. I am trying to come up with a macro that will allow me to search the entire column and if there is a match with the data, allow me to run another macro to overwrite the old data with the new data. Any ideas of how to go about this?</p>\n\n<p>Here is what I have so far. I need to replace to i to 500 with the entire column.</p>\n\n<pre><code>Sub FindMatchingValue()\nDim i As Integer, ValueToFind As Integer\nintValueToFind = Sheet8.Range(\"L6\")\nFor i = 1 To 500    ' This needs to be the entire column\n    If Cells(i, 1).Value = intValueToFind Then\n        MsgBox (\"Found value on row \" &amp; i)\n        Exit Sub\n    End If\nNext i\n\nMsgBox (\"Value not found in the range!\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1529012131, "post_id": 50865433, "comment_id": 88734933, "body": "Is there a way to split the rules up? Say I want to execute rules Half the rules in one folder and then run the other half in a different folder.The code you provided worked fine since the last rules in the list were applicable to the folder I was in. Other than having to hold down &#39;enter&#39; till all the rules finished running."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "edited": false, "score": 0, "creation_date": 1529019005, "post_id": 50865433, "comment_id": 88736660, "body": "You can use the <code>for</code> loop instead of <code>For Each</code> and iterate over first half and then on the second. The <code>myRules.Count</code> property will help you with that task."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1529008032, "creation_date": 1529008032, "answer_id": 50865433, "question_id": 50846007, "link": "https://stackoverflow.com/questions/50846007/running-all-client-only-outlook-rules/50865433#50865433", "title": "Running All Client Only Outlook Rules", "body": "<p>You shouldn't check the rule name each time you iterate over all rules in the collection:</p>\n\n<pre><code>Sub RunAllInboxRules()\n Dim st As Outlook.Store\n Dim myRules As Outlook.rules\n Dim rl As Outlook.Rule\n Dim rulelist As String\n Set st = Application.Session.DefaultStore\n Set myRules = st.GetRules\n Set cf = Application.ActiveExplorer.CurrentFolder\n For Each rl In myRules\n    rl.Execute ShowProgress:=True, Folder:=cf\n    ruleList = \"Rule was executed correctly:\" &amp; vbCrLf &amp; rl.Name\n    MsgBox ruleList, vbInformation, \"Macro: Whatever_Finished\"\n Next     \n Set rl = Nothing\n Set st = Nothing\n Set myRules = Nothing\nEnd Sub\n</code></pre>\n\n<p>You may find the <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2010/ee814736(v=office.14)\" rel=\"nofollow noreferrer\">Getting Started with VBA in Outlook 2010</a> article helpful. </p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1529338250, "creation_date": 1529338250, "answer_id": 50913572, "question_id": 50846007, "link": "https://stackoverflow.com/questions/50846007/running-all-client-only-outlook-rules/50913572#50913572", "title": "Running All Client Only Outlook Rules", "body": "<p>You can apply client-only rules with <code>.IsLocalRule</code>.</p>\n\n<pre><code>Private Sub RunClientOnlyRules()\n\nDim st As store\nDim myRules As rules\nDim myFolder As Folder\nDim rl As Rule\n\nSet st = Session.DefaultStore\nSet myRules = st.GetRules\nSet myFolder = ActiveExplorer.CurrentFolder\n\nFor Each rl In myRules\n    If rl.RuleType = olRuleReceive Then\n        If rl.IsLocalRule Then\n            rl.Execute ShowProgress:=True, Folder:=myFolder\n        End If\n    End If\nNext\n\nExitRoutine:\n    Set st = Nothing\n    Set myRules = Nothing\n    Set myFolder = Nothing\n    Set rl = Nothing\n\nMsgBox \"Done.\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9592984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9374201eb7c81ac439172efcf12f66?s=128&d=identicon&r=PG&f=1", "display_name": "BlankB", "link": "https://stackoverflow.com/users/9592984/blankb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592986202, "creation_date": 1528922729, "last_edit_date": 1592986202, "question_id": 50846007, "link": "https://stackoverflow.com/questions/50846007/running-all-client-only-outlook-rules", "title": "Running All Client Only Outlook Rules", "body": "<p>Goal: Run all my client only rules. Total of 269.</p>\n\n<p>Problem: Code runs a single rule at a time not all.</p>\n\n<p>Solution Attempts/Ideas Tried: An array for my rules to run in a list. Ran into a few issues as I don't have much experience in compiling arrays. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub RunAllInboxRules()\nDim st As Outlook.Store\nDim myRules As Outlook.rules\nDim rl As Outlook.Rule\nDim runrule As String\nDim rulename As String\n'Rule name intended to run\nrulename = \"ABC 123\"\n\nSet st = Application.Session.DefaultStore\nSet myRules = st.GetRules\nSet cf = Application.ActiveExplorer.CurrentFolder\nFor Each rl In myRules\nIf rl.RuleType = olRuleReceive Then\nIf rl.name = rulename Then\nrl.Execute ShowProgress:=True, Folder:=cf\nrunrule = rl.name\nEnd If\nEnd If\nNext\nruleList = \"Rule was executed correctly:\" &amp; vbCrLf &amp; runrule\nMsgBox ruleList, vbInformation, \"Macro: Whatever_Finished\"\nSet rl = Nothing\nSet st = Nothing\nSet myRules = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9938140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9eb21ca04d7cf40413aaded3ad36211?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cain", "link": "https://stackoverflow.com/users/9938140/j-cain"}, "edited": false, "score": 0, "creation_date": 1528920888, "post_id": 50845381, "comment_id": 88694565, "body": "I am only looking to copy the values! I definitely do not want to copy the formulas."}, {"owner": {"reputation": 13, "user_id": 9938140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9eb21ca04d7cf40413aaded3ad36211?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cain", "link": "https://stackoverflow.com/users/9938140/j-cain"}, "edited": false, "score": 0, "creation_date": 1528921652, "post_id": 50845381, "comment_id": 88694988, "body": "This worked great for me so far. Would you also be able to help me change where the row is inserted on the Documentation page? It is putting it at the top, but I would like to save the top row for titles for tables so I can sort the history."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 13, "user_id": 9938140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9eb21ca04d7cf40413aaded3ad36211?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cain", "link": "https://stackoverflow.com/users/9938140/j-cain"}, "edited": false, "score": 0, "creation_date": 1528922198, "post_id": 50845381, "comment_id": 88695268, "body": "@J.Cain where do you want it inserted?"}, {"owner": {"reputation": 13, "user_id": 9938140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9eb21ca04d7cf40413aaded3ad36211?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cain", "link": "https://stackoverflow.com/users/9938140/j-cain"}, "edited": false, "score": 0, "creation_date": 1528922406, "post_id": 50845381, "comment_id": 88695376, "body": "I would like it to insert a new row at A2 rather than A1, i.e. a new second row."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 13, "user_id": 9938140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9eb21ca04d7cf40413aaded3ad36211?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cain", "link": "https://stackoverflow.com/users/9938140/j-cain"}, "edited": false, "score": 0, "creation_date": 1528924242, "post_id": 50845381, "comment_id": 88696166, "body": "@J.Cain Also, are you the J.Cain that I know?"}, {"owner": {"reputation": 13, "user_id": 9938140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9eb21ca04d7cf40413aaded3ad36211?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cain", "link": "https://stackoverflow.com/users/9938140/j-cain"}, "edited": false, "score": 0, "creation_date": 1528999012, "post_id": 50845381, "comment_id": 88729108, "body": "Okay haha well I hope you find your J. Cain. Thanks for the help!"}], "tags": [], "owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "is_accepted": false, "score": 1, "last_activity_date": 1528923264, "last_edit_date": 1528923264, "creation_date": 1528920329, "answer_id": 50845381, "question_id": 50845277, "link": "https://stackoverflow.com/questions/50845277/editing-the-code-for-a-recorded-macro/50845381#50845381", "title": "Editing the code for a recorded Macro", "body": "<p>Add this line before your first <code>.Select</code>:</p>\n\n<pre><code>r = ActiveCell.Row\n</code></pre>\n\n<p>then you want to change this line:</p>\n\n<pre><code>Range(\"A3:S3\").Select\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>Range(\"A\" &amp; Cstr(r) &amp; \":S\" &amp; Cstr(r)).Select\n</code></pre>\n\n<p>I think that that should do it. </p>\n\n<hr>\n\n<p>NOTE:  Using <code>.Select</code> is slow and has some other reliability/interaction problems, so we usually advise against it.  However, it's hard to do a true Copy operation without it, so it's probably OK in this case.  <em>However</em>, if you don't <em>really</em> need a true copy (formats, formulas, et. al.), but only want the value, then there's a better way to do this.</p>\n\n<hr>\n\n<p>Here's a better way, since you only need the data.  I have broken it into individual lines so that you can see how it is done.</p>\n\n<pre><code>Sub RecordTracker()\n'RecordTracker Macro\n'Records the updated row as a history row in Documentation Sheet\n'Keyboard Shortcut: Ctrl r\n\n    ' get the worksheet objects\n    Dim wsDoc As Worksheet, wsTrak As Worksheet\n    Set wsDoc = Sheets(\"Documentation\")\n    Set wsTrak = Sheets(\"Tracker\")\n\n    ' get the source (current) row\n    Dim r As Long\n    r = ActiveCell.Row\n\n    'Make the output row\n    wsDoc.Range(\"A2\").EntireRow.Insert shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove '.Range(\"A2:S2\").Select\n\n    ' get the source data\n    Dim dat() As Variant\n    dat = wsTrak.Range(\"A\" &amp; CStr(r) &amp; \":S\" &amp; CStr(r))\n\n    ' set the output range\n    Dim outRng As Range\n    Set outRng = wsDoc.Range(\"A2:S2\")\n\n    ' copy data to the output range\n    outRng = dat\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9938140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9eb21ca04d7cf40413aaded3ad36211?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cain", "link": "https://stackoverflow.com/users/9938140/j-cain"}, "edited": false, "score": 0, "creation_date": 1528922096, "post_id": 50845617, "comment_id": 88695220, "body": "Just to clarify, I right click on Documentation, show code, and paste there?"}, {"owner": {"reputation": 13, "user_id": 9938140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9eb21ca04d7cf40413aaded3ad36211?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cain", "link": "https://stackoverflow.com/users/9938140/j-cain"}, "edited": false, "score": 0, "creation_date": 1528922723, "post_id": 50845617, "comment_id": 88695511, "body": "Fantastic, thank you. Should I be deleting what I have on VBE for the Tracker sheet? If so, how to I get this process to run? Thank you!"}, {"owner": {"reputation": 13, "user_id": 9938140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9eb21ca04d7cf40413aaded3ad36211?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cain", "link": "https://stackoverflow.com/users/9938140/j-cain"}, "edited": false, "score": 0, "creation_date": 1528923142, "post_id": 50845617, "comment_id": 88695702, "body": "I meant how to add a shortcut to run the macro as I will be having multiple people using the sheet, but I can definitely figure that out! :)  Unfortunately, when I run the macro I run into an error that reads: 400"}, {"owner": {"reputation": 13, "user_id": 9938140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9eb21ca04d7cf40413aaded3ad36211?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cain", "link": "https://stackoverflow.com/users/9938140/j-cain"}, "edited": false, "score": 0, "creation_date": 1528923825, "post_id": 50845617, "comment_id": 88695983, "body": "Ah no worries! Works like a charm now, thank you so much!"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1528924393, "last_edit_date": 1528924393, "creation_date": 1528921184, "answer_id": 50845617, "question_id": 50845277, "link": "https://stackoverflow.com/questions/50845277/editing-the-code-for-a-recorded-macro/50845617#50845617", "title": "Editing the code for a recorded Macro", "body": "<ol>\n<li>Will Insert a new Row on sheet <code>Documentation</code> from (<code>A2</code>)</li>\n<li>Copy the row you have selected (from sheet <code>Tracker</code>, Range <code>A:S</code>)</li>\n<li>Paste values onto <code>Documentation</code> <code>A2</code> (which is your newly created row) </li>\n</ol>\n\n<p>This will need to be pasted in VBE on your sheet <code>Tracker</code> to execute</p>\n\n<p>Notice that your code can be greatly reduced (as far as lines go) by avoiding the <code>.Select</code> method. You can find some useful information <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here</a> </p>\n\n<pre><code>Sub StoreChanges()\n\n    Sheets(\"Documentation\").Range(\"A2\").EntireRow.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Sheets(\"Tracker\").Range(Cells(ActiveCell.Row, \"A\"), Cells(ActiveCell.Row, \"S\")).Copy\n    Sheets(\"Documentation\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 6385519, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RbOJRXD2bLk/AAAAAAAAAAI/AAAAAAAAABA/ruuOJOoS05s/photo.jpg?sz=128", "display_name": "Suraj Shourie", "link": "https://stackoverflow.com/users/6385519/suraj-shourie"}, "is_accepted": false, "score": 0, "last_activity_date": 1528922448, "creation_date": 1528922448, "answer_id": 50845942, "question_id": 50845277, "link": "https://stackoverflow.com/questions/50845277/editing-the-code-for-a-recorded-macro/50845942#50845942", "title": "Editing the code for a recorded Macro", "body": "<p>I am assuming that in the datasheet (Tracker) you want the selected range/row to be pasted and not just the third row <code>A3:S3</code></p>\n\n<blockquote>\n  <p>I recorded a macro where when I press cntrl+r,it copies the first row from my data sheet, inserts a row onto the\n  history page, and then copies the data onto that new row</p>\n</blockquote>\n\n<p>Try removing the <code>Range(\"A3:S3\").Select</code> line of code. Now when you select a row in the sheet <strong>Tracker</strong> manually, that row should be used in the code <code>Selection.Copy</code></p>\n\n<pre><code>Sheets(\"Documentation\").Select\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nSheets(\"Tracker\").Select\n## removed Range(\"a3:s3\").select\nSelection.Copy\nSheets(\"Documentation\").Select\n</code></pre>\n\n<p>And if you want to add a new row second row onwards, just add <code>Sheets(\"Documentation\").Rows(\"2:2\").Select</code> before the code <code>Selection.Insert</code></p>\n"}], "owner": {"reputation": 13, "user_id": 9938140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9eb21ca04d7cf40413aaded3ad36211?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cain", "link": "https://stackoverflow.com/users/9938140/j-cain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 50845617, "answer_count": 3, "score": 0, "last_activity_date": 1528957541, "creation_date": 1528919820, "last_edit_date": 1528957541, "question_id": 50845277, "link": "https://stackoverflow.com/questions/50845277/editing-the-code-for-a-recorded-macro", "title": "Editing the code for a recorded Macro", "body": "<p>I am brand new to using macros and code, and am running into a small problem. I have a sheet where I update values along a row. Since these updates are part of a process, I want excel to record my row as a sort of history in next sheet in my workbook. I recorded a macro where when I press cntrl+r, it copies the first row from my data sheet, inserts a row onto the history page, and then copies the data onto that new row. THe only problem I that my data sheet will have multiple rows of data, and I would like the macro to copy my selected row, not just the first row everytime. I have put the code below.</p>\n\n<p>Thank you!</p>\n\n<pre><code>Sub RecordTracker()\nRecordTracker Macro\nRecords the updated row as a history row in Documentation Sheet\nKeyboard Shortcut: Ctrl+r\n\n    Sheets(\"Documentation\").Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Sheets(\"Tracker\").Select\n    Range(\"A3:S3\").Select\n    Selection.Copy\n    Sheets(\"Documentation\").Select\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nEnd Sub\n</code></pre>\n\n<p>Sorry if my formatting of the code is a little off. First post!</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1528924876, "post_id": 50845007, "comment_id": 88696416, "body": "Please show the <code>Dim</code> lines of sub so we can see your Excel objects."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1528925301, "post_id": 50845007, "comment_id": 88696566, "body": "Also, I wonder about your error handling as you might have an <code>On Error Resume Next</code> suppressing informative errors. Please post a fuller code example for us to help."}, {"owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1528977744, "post_id": 50845007, "comment_id": 88716607, "body": "@Parfait This is the entire sub, I don&#39;t have any error handling here because I like using the debugger to point to problem lines. I use global variables (bad practice, I know...) but I will include the Dim and Set statements at the top."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1528985662, "post_id": 50845007, "comment_id": 88721774, "body": "Please post even the Public Sub/Function lines. I cannot see how <code>ActiveChart</code> is recognized by Access. Are you sure this is in an MS Access standalone module or run inside Excel?"}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1528919440, "post_id": 50845134, "comment_id": 88693855, "body": "yes, most likely access thinks <code>ActiveChart</code> is the active chart in the access application itself and the object needs to be tied explicitly to the excel chart."}, {"owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "edited": false, "score": 0, "creation_date": 1528919914, "post_id": 50845134, "comment_id": 88694092, "body": "Thanks for your reply. Unfortunately, declaring <code>chrt</code> as a <code>Chart</code> gives a type mismatch. I tried to declare it as an <code>Excel.Chart</code>, but this also results in a type mismatch. I had assumed that since I have the <code>.Select</code> line right beforehand, the activeChart would be the one I just selected. Anyways, the <code>.SetSourceData</code> line works with the ActiveChart"}, {"owner": {"reputation": 98, "user_id": 4149567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pz5qBr6wLc8/AAAAAAAAAAI/AAAAAAAAAQU/fIwvtXwYtqM/photo.jpg?sz=128", "display_name": "mx5_craig", "link": "https://stackoverflow.com/users/4149567/mx5-craig"}, "edited": false, "score": 0, "creation_date": 1528920878, "post_id": 50845134, "comment_id": 88694557, "body": "OK fair enough, I must confess to being completely unfamiliar with the Access object model.  It does seem like those objects are not supported.  Also, did you try  &#39;dim chrt as Graph.Chart&#39; ?"}], "tags": [], "owner": {"reputation": 98, "user_id": 4149567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pz5qBr6wLc8/AAAAAAAAAAI/AAAAAAAAAQU/fIwvtXwYtqM/photo.jpg?sz=128", "display_name": "mx5_craig", "link": "https://stackoverflow.com/users/4149567/mx5-craig"}, "is_accepted": false, "score": 1, "last_activity_date": 1528919267, "creation_date": 1528919267, "answer_id": 50845134, "question_id": 50845007, "link": "https://stackoverflow.com/questions/50845007/access-vba-creating-and-formatting-chart-macro-works-in-excel-but-not-in-access/50845134#50845134", "title": "Access VBA Creating and formatting chart macro works in Excel but not in Access", "body": "<p>Perhaps the active chart is not the chart you just created? Try something like:</p>\n\n<pre><code>dim chrt as Chart\nset chrt = ws.Shapes.AddChart2(201, xlColumnClustered)\nchrt.SetSourceData Source:=Range(\"Results_Table[#All]\")\n</code></pre>\n\n<p>replacing active chart with chrt.</p>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "edited": false, "score": 0, "creation_date": 1528978153, "post_id": 50846736, "comment_id": 88716839, "body": "Thanks for your reply Parfait. I attempted to set myChart as an object, but an error is thrown on the first .fullSeriesCollection line saying &#39;Object does not support this property&#39;"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1528979444, "post_id": 50846736, "comment_id": 88717613, "body": "Also worth pointing out that if you&#39;re using <i>late binding</i> Access won&#39;t have a clue what <code>xlColumnClustered</code> or <code>xlColumnStacked</code> means.  They&#39;ll need replacing with their numerical equivalents - 51 &amp; 52.  To find the numbers just type <code>?xlColumnStacked</code> into Excels immediate window."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1528986050, "post_id": 50846736, "comment_id": 88722016, "body": "I missed the <code>.SetSourceData</code> line. Try again."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1528985964, "last_edit_date": 1528985964, "creation_date": 1528926290, "answer_id": 50846736, "question_id": 50845007, "link": "https://stackoverflow.com/questions/50845007/access-vba-creating-and-formatting-chart-macro-works-in-excel-but-not-in-access/50846736#50846736", "title": "Access VBA Creating and formatting chart macro works in Excel but not in Access", "body": "<p>Essentially, your issue is accessing Excel objects outside of Excel. In MS Office applications when you do not qualify methods with a named object, it is assumed you are accessing objects within the host application. See below illustration with the workbook object</p>\n\n<pre><code>Dim xlApp As Excel.Application          ' UNNECESSARY IF INSIDE MS EXCEL\n\nSet wb = xlApp.Workbooks.Open(...)      ' ASSIGN EXCEL WORKBOOK EXTERNALLY\n\nSet wb = Workbooks.Open(...)            ' ASSIGN EXCEL WORKBOOK INTERNALLY\n</code></pre>\n\n<p>Hence, your <code>ActiveChart</code> is pointing to an MS Access <code>ActiveChart</code> object which may be its OLEDB Chart form/report object or your code <em>is</em> error-ing out but you are suppressing message (i.e., <code>On Error Resume Next</code>) as this does not sound like an MS Access object.</p>\n\n<p>But to access Excel's <em>Chart</em> object, assign it to a defined object with <code>Set</code> operator:</p>\n\n<pre><code>Dim myChart As Object                 ' LATE BINDING \n'Dim myChart As Excel.Chart           ' EARLY BINDING\n...\n\nws.Range(\"Results_Table[#All]\").Select\n\nSet myChart = ws.Shapes.AddChart2(201, xlColumnClustered)\nmyChart.SetSourceData Source:=ws.Range(\"Results_Table[#All]\")\n\nmyChart.Select\nmyChart.FullSeriesCollection(1).ChartType = xlColumnStacked\nmyChart.FullSeriesCollection(1).AxisGroup = 1\n...\n</code></pre>\n\n<p>Alternatively use the <code>With...End With</code> block and a DRY-er code with a loop</p>\n\n<pre><code>Dim xlApp As Excel.Application\nDim i As Integer\n...\n\nws.Shapes.AddChart2(201, xlColumnClustered).Select\n\nWith xlApp.ActiveChart\n    .SetSourceData Source:=ws.Range(\"Results_Table[#All]\")\n\n    For i = 1 To 14\n       .FullSeriesCollection(i).ChartType = xlColumnStacked\n       .FullSeriesCollection(i).AxisGroup = 1\n    Next i\n\n    ...\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "accepted_answer_id": 50846736, "answer_count": 2, "score": 0, "last_activity_date": 1528985964, "creation_date": 1528918736, "last_edit_date": 1528977850, "question_id": 50845007, "link": "https://stackoverflow.com/questions/50845007/access-vba-creating-and-formatting-chart-macro-works-in-excel-but-not-in-access", "title": "Access VBA Creating and formatting chart macro works in Excel but not in Access", "body": "<p>I have a module in Access that makes a new Excel spreadsheet, makes a new table, and copies data from the database into the table. I want to create a chart out of this table and format it. The sub to create the chart is below.</p>\n\n<pre><code>    Dim xlapp as Excel.Application\n    Dim wb as Excel.Workbook\n    Dim ws as Excel.Worksheet\n    Set xlapp = New Excel.Application\n    Set wb = 'created new workbook\n    Set ws = wb.Worksheets(1)\n\n    ws.Range(\"Results_Table[#All]\").Select\n    ws.Shapes.AddChart2(201, xlColumnClustered).Select\n    ActiveChart.SetSourceData Source:=Range(\"Results_Table[#All]\")\n\n    ActiveChart.FullSeriesCollection(1).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(1).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(2).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(2).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(3).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(3).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(4).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(4).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(5).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(5).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(6).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(6).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(7).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(7).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(8).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(8).AxisGroup = 2\n    ActiveChart.FullSeriesCollection(9).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(9).AxisGroup = 2\n    ActiveChart.FullSeriesCollection(10).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(10).AxisGroup = 2\n    ActiveChart.FullSeriesCollection(11).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(11).AxisGroup = 2\n    ActiveChart.FullSeriesCollection(12).ChartType = xlColumnStacked\n    ActiveChart.FullSeriesCollection(12).AxisGroup = 2\n    ActiveChart.FullSeriesCollection(13).ChartType = xlXYScatterLines\n    ActiveChart.FullSeriesCollection(13).AxisGroup = 2\n    ActiveChart.FullSeriesCollection(14).ChartType = xlXYScatter\n    ActiveChart.FullSeriesCollection(14).AxisGroup = 2\n\n    ActiveChart.ChartGroups(2).Overlap = 100\n    ActiveChart.ChartGroups(2).GapWidth = 475\n\n    ActiveChart.ChartGroups(1).GapWidth = 159\n</code></pre>\n\n<p>In access, this code can successfully create a chart of the 'Column Clustered' type. However, that's all. Everything below where I attempt to change some parts into stacked columns or scatters does nothing. I can put a print statement at the bottom of it all that registers, so I know the code actually reaches that point. </p>\n\n<p>I can also copy and paste this exact code (changing <code>ws</code> to <code>ActiveSheet</code>) and it works perfect, creating the chart I want and formatting it exactly as it is supposed to.</p>\n\n<p>I am unsure why these commands work in Excel but not in the Access module.</p>\n"}, {"tags": ["vba", "parsing"], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1528964320, "post_id": 50846524, "comment_id": 88708274, "body": "It perfectly does the job. Few months back I used to think handling lazyload in vba might not be possible (in an efficient manner). However, it is doing great nowadays exceeding the expectation in most of the cases."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1528964867, "post_id": 50846524, "comment_id": 88708598, "body": "@SIM I wasn\u2019t sure if I should also credit you. I remember you sent me a link to a script where you did the above as well! I am happy to add in and add a link to that script (it was different site though)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1528964918, "post_id": 50846524, "comment_id": 88708631, "body": "It also has the \u201cfeel\u201d of some of your coding style."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1528965228, "post_id": 50846524, "comment_id": 88708811, "body": "I made the comment because it feels good to see what is possible in python can also be possible in vba (most of the cases). Thanks."}, {"owner": {"reputation": 3, "user_id": 9938044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb9a8f29042a24ba9cb23a950e8eaa92?s=128&d=identicon&r=PG&f=1", "display_name": "grrmisfit", "link": "https://stackoverflow.com/users/9938044/grrmisfit"}, "edited": false, "score": 0, "creation_date": 1528979033, "post_id": 50846524, "comment_id": 88717330, "body": "Thank you for the help! when i run it, chrome opens up and has &quot;data;&quot; in the address bar, and then vba gives me a runtime error &#39;0&#39; automation error the operation completed successfully. and nothing else happens. It never goes past the .get in the code"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528980285, "post_id": 50846524, "comment_id": 88718192, "body": "Can it open any page e.g. driver.get &quot;<a href=\"https://www.google.co.uk/\" rel=\"nofollow noreferrer\">google.co.uk</a>&quot; ? Also, do you have any security restrictions that might impact on automated browsers? I am guessing not if you were able to install selenium basic."}, {"owner": {"reputation": 3, "user_id": 9938044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb9a8f29042a24ba9cb23a950e8eaa92?s=128&d=identicon&r=PG&f=1", "display_name": "grrmisfit", "link": "https://stackoverflow.com/users/9938044/grrmisfit"}, "edited": false, "score": 0, "creation_date": 1528980999, "post_id": 50846524, "comment_id": 88718704, "body": "Fixed my issue, chromedriver was outdated. downloaded new driver and all is good. thank you again!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1528925210, "creation_date": 1528925210, "answer_id": 50846524, "question_id": 50844935, "link": "https://stackoverflow.com/questions/50844935/parsing-website-that-doesnt-fully-load-vba/50846524#50846524", "title": "Parsing website that doesnt fully load VBA", "body": "<p>Using <a href=\"http://florentbr.github.io/SeleniumBasic/\" rel=\"nofollow noreferrer\">selenium basic</a> and using the technique by <a href=\"https://stackoverflow.com/a/50510657/6241235\">@Hubisan</a> to handle lazy loading pages and scrolling until everything loaded:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetNamesAndPrices()\n    Dim driver As New ChromeDriver, prevlen As Long, curlen As Long\n    Dim prices As Object, price As Object, name As Object, names As Object\n    Dim timeout As Long, startTime As Double\n\n    timeout = 10                                 ' set the timeout to 10 seconds\n\n    Application.ScreenUpdating = False\n\n    With driver\n        .get \"https://www.thevinylspectrum.com/siser-heat-transfer-vinyl/siser-easyweed/12in-x-59in-rolls/\"\n        prevlen = .FindElementsByCss(\".price.product-price\").Count\n\n        startTime = Timer                        ' set the initial starting time\n\n        Do\n            .ExecuteScript (\"window.scrollTo(0, document.body.scrollHeight);\")\n            Set prices = .FindElementsByCss(\".price.product-price\")\n            Set names = .FindElementsByCss(\".product-name\")\n            curlen = prices.Count\n            If curlen &gt; prevlen Then\n                startTime = Timer\n                prevlen = curlen\n            End If\n        Loop While Round(Timer - startTime, 2) &lt;= timeout\n\n        Dim r As Long\n        With ActiveSheet\n            For Each name In names\n                r = r + 1: .Cells(r, 1) = name.Text\n            Next\n            r = 0\n            For Each price In prices\n                r = r + 1: .Cells(r, 2) = price.Text\n            Next\n        End With\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Some example output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EP3Yb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EP3Yb.png\" alt=\"Example output\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 9938044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb9a8f29042a24ba9cb23a950e8eaa92?s=128&d=identicon&r=PG&f=1", "display_name": "grrmisfit", "link": "https://stackoverflow.com/users/9938044/grrmisfit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 50846524, "answer_count": 1, "score": -1, "last_activity_date": 1528925210, "creation_date": 1528918394, "last_edit_date": 1528920446, "question_id": 50844935, "link": "https://stackoverflow.com/questions/50844935/parsing-website-that-doesnt-fully-load-vba", "title": "Parsing website that doesnt fully load VBA", "body": "<p>Trying my hand at a simple web parse, my problem is the page doesnt fully load until you scroll down. Google search has come up with possibly using selenium but as I have no idea how to use it I figured I would ask here</p>\n\n<p>Code im using</p>\n\n<pre><code>Sub gfquote()\n\nDim oHttp As MSXML2.XMLHTTP\nDim sURL As String\nDim HTMLDoc As HTMLDocument\nDim dequote As String\nDim driver As New Webd\n' Create an XMLHTTP object\nSet oHttp = New MSXML2.XMLHTTP\n    Dim oElement As Object\n' get the URL to open\nsURL = \"https://www.thevinylspectrum.com/siser-heat-transfer-vinyl/siser-easyweed/12in-x-59in-rolls/\"\n\n' open socket and get website html\noHttp.Open \"GET\", sURL, False\noHttp.send\nSet HTMLDoc = New HTMLDocument\nWith HTMLDoc\n    ' assign the returned text to a HTML document\n    .body.innerHTML = oHttp.responseText\n    dastring = oHttp.responseText\n    ' parse the result\n  UserForm1.TextBox1.Text = dastring\n\n\n   Set prices = .getElementsByClassName(\"price product-price\")\n    For Each oElement In prices\n    Sheets(\"Sheet1\").Range(\"A\" &amp; i + 1) = prices(i).innerText\n    i = i + 1\nNext oElement\n\n\n\nEnd With\n\n'Clean up\nSet oHttp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528917267, "post_id": 50844536, "comment_id": 88692693, "body": "Why are quotes in quotes not allowed?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 2, "creation_date": 1528917319, "post_id": 50844536, "comment_id": 88692730, "body": "@TimWilkinson Because he said so, geez!! /s :)"}], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 9621551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4D9XE.jpg?s=128&g=1", "display_name": "Analyst123456789", "link": "https://stackoverflow.com/users/9621551/analyst123456789"}, "edited": false, "score": 0, "creation_date": 1528917693, "post_id": 50844613, "comment_id": 88692914, "body": "Yes! Thank you Bruce, I was unaware of the &quot;&quot;&gt;0&quot;&quot; double quotes in quotes in quotes as an option. This is perfect!!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1528917045, "creation_date": 1528917045, "answer_id": 50844613, "question_id": 50844536, "link": "https://stackoverflow.com/questions/50844536/averageif-in-vba-with-dynamic-range/50844613#50844613", "title": "AverageIF in VBA with dynamic range", "body": "<p>When using quotes in a formula within VBA, simply \"double up\":</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=AVERAGEIF(RC2:RC[-2],\"\"&gt;0\"\")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": false, "score": 2, "last_activity_date": 1528917593, "creation_date": 1528917593, "answer_id": 50844741, "question_id": 50844536, "link": "https://stackoverflow.com/questions/50844536/averageif-in-vba-with-dynamic-range/50844741#50844741", "title": "AverageIF in VBA with dynamic range", "body": "<p>You can double up quotes to use within VBA. And as a side note you can put a lot of your lines together to avoid using select all the time</p>\n\n<pre><code>With Range(\"A6\").End(xlToRight)\n    .Offset(0, 1).Value = \"Average\"\n    .Offset(0, 2).Value = \"Median\"\n    .Offset(1, 1).FormulaR1C1 = \"=AVERAGEIF(RC2:RC[-2],\"\"&gt;0\"\")\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 172, "user_id": 9621551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4D9XE.jpg?s=128&g=1", "display_name": "Analyst123456789", "link": "https://stackoverflow.com/users/9621551/analyst123456789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1302, "favorite_count": 0, "closed_date": 1528917729, "accepted_answer_id": 50844613, "answer_count": 2, "score": -1, "last_activity_date": 1528917593, "creation_date": 1528916778, "question_id": 50844536, "link": "https://stackoverflow.com/questions/50844536/averageif-in-vba-with-dynamic-range", "closed_reason": "Duplicate", "title": "AverageIF in VBA with dynamic range", "body": "<p>I have a VBA Code that creates a pivot table and then finds the average based on the dynamic range (as the size of the pivot table is always changing)</p>\n\n<p>I would like to use AVERAGEIF function instead of average so that I can average all values where \">0\". The problem I have is that Excel does not allow quotes inside of quotes, so I can't put the criteria \">0\" in the function. My current code is:</p>\n\n<pre><code>Sub BuildLaborTable()\n'\n'This procedure builds the labor table and finds the average of the rows\n\nActiveWorkbook.ShowPivotTableFieldList = True\nWith ActiveSheet.PivotTables(\"Pivot ZP2P\").PivotFields(\"Notif Service product\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\n\nActiveSheet.PivotTables(\"Pivot ZP2P\").AddDataField ActiveSheet.PivotTables( _\n    \"Pivot ZP2P\").PivotFields(\"Actual Qty\"), \"Sum of Actual Qty\", xlSum\n\nWith ActiveSheet.PivotTables(\"Pivot ZP2P\").PivotFields(\"Notifctn\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With                     \n\nRange(\"A6\").Select\nSelection.End(xlToRight).Select\nActiveCell.Offset(0, 1).Select\nActiveCell.FormulaR1C1 = \"Average\"\nActiveCell.Offset(0, 1).Select\nActiveCell.FormulaR1C1 = \"Median\"\nActiveCell.Offset(1, -1).Select\nActiveCell.FormulaR1C1 = \"=AVERAGE(RC2:RC[-2])\"\n\nEnd Sub\n</code></pre>\n\n<p>I would like to use the formula AVERAGEIF(RC2:RC[-2],\">0\") , but the issue is this requires the quotes inside of quotes which is not allowed.</p>\n"}, {"tags": ["vba", "image-resizing", "powerpoint2016"], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 2, "last_activity_date": 1528919548, "creation_date": 1528919548, "answer_id": 50845209, "question_id": 50844525, "link": "https://stackoverflow.com/questions/50844525/vba-code-to-adjust-image-size-in-powerpoint-2016/50845209#50845209", "title": "VBA code to adjust image size in PowerPoint 2016", "body": "<p>Okay, so this macro will adjust the details of every picture within your powerpoint.</p>\n\n<pre><code>Sub AdjustImages()\n\n    Dim curSlide As Slide\n    Dim curShape As Shape\n\n    For Each curSlide In ActivePresentation.Slides\n        For Each curShape In curSlide.Shapes\n            With curShape\n\n                'size:\n                ''1 inch = 72 points\n                .Height = 72 * 3.39\n                .Width = 72 * 6.67\n\n                .ScaleHeight 0.62, msoTrue\n                .ScaleWidth 0.62, msoTrue\n\n                .LockAspectRatio = msoTrue\n\n\n                'position:\n                .Rotation = 0\n\n                .Left = 0\n                .Top = 2.06\n\n                'Relative to original picture size = true\n\n            End With\n        Next curShape\n    Next curSlide\n\nEnd Sub\n</code></pre>\n\n<p>The only part of your question that I don't really understand is when you mention it being \"relative to original picture size = true\". I can't seem to find an attribute that matches that.</p>\n"}, {"comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1605475195, "post_id": 51013509, "comment_id": 114655213, "body": "While it&#39;s not necessary to remove both of the .Select statements, neither of them is necessary, and without them, your code will run more quickly."}], "tags": [], "owner": {"reputation": 41, "user_id": 9816367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a7ac855b0444b7c4596eebdf8f8128?s=128&d=identicon&r=PG&f=1", "display_name": "PSR", "link": "https://stackoverflow.com/users/9816367/psr"}, "is_accepted": false, "score": 1, "last_activity_date": 1529870422, "creation_date": 1529870422, "answer_id": 51013509, "question_id": 50844525, "link": "https://stackoverflow.com/questions/50844525/vba-code-to-adjust-image-size-in-powerpoint-2016/51013509#51013509", "title": "VBA code to adjust image size in PowerPoint 2016", "body": "<p>Below is the code that worked for me.  Thanks for the support.</p>\n\n<pre><code>Sub ResizeAll()\nFor Each tSlide In ActiveWindow.Presentation.Slides\n    tSlide.Select\n    With tSlide.Shapes.Item(1)\n    'assume a blank slide with one image added only\n        .Select\n        .Height = 72 * 3.39\n        .Width = 72 * 6.67\n    'algin middle (Horizontal Center)\n        .Left = 0\n        .Top = ActivePresentation.PageSetup.SlideHeight / 3.25\n    End With\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9816367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a7ac855b0444b7c4596eebdf8f8128?s=128&d=identicon&r=PG&f=1", "display_name": "PSR", "link": "https://stackoverflow.com/users/9816367/psr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9783, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1604658005, "creation_date": 1528916742, "last_edit_date": 1563797350, "question_id": 50844525, "link": "https://stackoverflow.com/questions/50844525/vba-code-to-adjust-image-size-in-powerpoint-2016", "title": "VBA code to adjust image size in PowerPoint 2016", "body": "<p>I am in my first week of learning VBA, and I am looking for a VBA code that will help me resize and reposition pictures pasted into PowerPoint 2016.  The desired picture format details are below:</p>\n\n<p>Size<br>\n - Height = 3.39\"<br>\n - Width = 6.67\"<br>\n - Rotation = 0<br>\n - Scale Height = 62%<br>\n - Scale Width = 62%<br>\n - Aspect Ratio = Locked<br>\n - Relative to original picture size = true</p>\n\n<p>Position<br>\n - Horizontal position = 0<br>\n - Top Left Corner<br>\n - Vertical position = 2.06<br>\n - Top Left Corner</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528993300, "post_id": 50844235, "comment_id": 88726405, "body": "Your question isn&#39;t totally clear - I&#39;m missing some example we could use for testing... But if you&#39;re already finding everything that&#39;s capitalized, why not add these words to an array, or write them to a file - whatever. Then loop through that list and use Find to search every instance of the terms, but NOT capitalized (using MatchCase) and replace with the capitalized version?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4174836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2be8259bcdf9fd31847780cbeab1f2?s=128&d=identicon&r=PG&f=1", "display_name": "user4174836", "link": "https://stackoverflow.com/users/4174836/user4174836"}, "edited": false, "score": 0, "creation_date": 1529008752, "post_id": 50861662, "comment_id": 88733606, "body": "This solution works for me. Its enough for me to be able to know if there are a few missed words which I could than enter myself. I will probably try this in a couple of days when I get the chance. Thanks!"}], "tags": [], "owner": {"reputation": 350, "user_id": 9686485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8549235061a10c547739aa876210ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Chip R.", "link": "https://stackoverflow.com/users/9686485/chip-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1528992126, "creation_date": 1528992126, "answer_id": 50861662, "question_id": 50844235, "link": "https://stackoverflow.com/questions/50844235/check-for-consistent-capitalization-in-word/50861662#50861662", "title": "Check for consistent capitalization in word?", "body": "<p>The solution to this doesn't exactly seem quick. But, I think I would approach the problem with basically three steps:</p>\n\n<ol>\n<li>Use regex to pull all words that are NOT the beginning of a\nsentence, and build a dictionary object of those words (with the\nword as the key and... anything as the value, more on this later).\nIt would probably involve sub steps:\n\n<ul>\n<li>make a copy of your file</li>\n<li>because VBA regex doesn't implement lookbehind, do a regex replace with all first words in a sentence (regex string would be something like this: \"(([?!.] )|^)\\w+'?\\w*\"), and replace with the null character</li>\n<li>then use a regex (like \"'?\\b[\\w']+\\b'?\") to match all words and put them in the dictionary</li>\n</ul></li>\n<li>Make a sorted list from the collection. This might be easiest by pasting your collection into a range in excel. This has the\nadvantage of then being able to do the rest through formulas and not\nany more VBA/code. I don't know of any in-built way to sort a\ndictionary object alphabetically by key in VBA... so you'd have to\ncode one or find one.</li>\n<li>Finally, now that you have the sorted list, go through and compare entries next to each other. If they are the same doing a\ncase-insensitive compare, but different doing a case-sensitive\ncompare, then add it to your final output.</li>\n</ol>\n\n<p>Regarding the dictionary object: at first glance, the collection object seems better. But, I think the collection object in VBA is case-insensitive, with no way to make it case-sensitive. Dictionaries in VBA are case-sensitive by default (with a property that lets you set it to case-insensitive if you want).</p>\n\n<p>Finally, I don't like my solution. But it's the only way I could think of to do it in VBA. Another option, not in VBA, would be to use something like Python with one of the ms office packages. This would let you use the negative lookbehind in your regex, and would also allow easier sorting of the list.</p>\n"}], "owner": {"reputation": 21, "user_id": 4174836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2be8259bcdf9fd31847780cbeab1f2?s=128&d=identicon&r=PG&f=1", "display_name": "user4174836", "link": "https://stackoverflow.com/users/4174836/user4174836"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528992126, "creation_date": 1528915662, "last_edit_date": 1528920683, "question_id": 50844235, "link": "https://stackoverflow.com/questions/50844235/check-for-consistent-capitalization-in-word", "title": "Check for consistent capitalization in word?", "body": "<p>I am trying to come up with some sort of macro to help me verify that I am consistently capitalizing words in my documents. I already use this macro to highlight the words that are capitalized, but it doesn't help me in verifying that all instances of that word are capitalized:</p>\n\n<pre><code>Sub Capitals()\n\nDim oRng As range\nSet oRng = ActiveDocument.range\nWith oRng.Find\n    Do While .Execute(FindText:=\"([A-Z])\", MatchWildcards:=True)\n        oRng.HighlightColorIndex = wdYellow\n        oRng.Collapse 0\n    Loop\nEnd With\n\nDim oRng1 As range\nSet oRng1 = ActiveDocument.range\nWith oRng1.Find\n    Do While .Execute(FindText:=\"([.\\!?]) [A-Z]*&gt;\", MatchWildcards:=True)\n        oRng1.HighlightColorIndex = wdNoHighlight\n        oRng1.Collapse 0\n    Loop\nEnd With\n</code></pre>\n\n<p>I am not even sure how to begin approaching this. Does anyone have an idea?</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1528916531, "post_id": 50844191, "comment_id": 88692350, "body": "Take a look at <a href=\"https://stackoverflow.com/a/40916500/4717755\">this answer</a> for some help."}, {"owner": {"reputation": 1, "user_id": 9937830, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-i2Ooz0VoVZc/AAAAAAAAAAI/AAAAAAAABGE/tOqKU4RSWA8/photo.jpg?sz=128", "display_name": "Jorge Guevara", "link": "https://stackoverflow.com/users/9937830/jorge-guevara"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1528925792, "post_id": 50844191, "comment_id": 88696774, "body": "Hi Peter, thanks for commenting. That helps me a little in terms of knowing how to declare something (powerpoint.shape vs shape) but it doesn&#39;t help me in determining how to tell vba to write into a textbox then duplicate into a blank cell."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528935622, "post_id": 50844191, "comment_id": 88699262, "body": "You&#39;re making 400 copies of the slide but you have 514 cells to copy over?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9954532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d0ff6b2a035bdd1b96d6a0f364301f?s=128&d=identicon&r=PG&f=1", "display_name": "Justanewbie", "link": "https://stackoverflow.com/users/9954532/justanewbie"}, "is_accepted": false, "score": 0, "last_activity_date": 1530162624, "creation_date": 1530162624, "answer_id": 51075084, "question_id": 50844191, "link": "https://stackoverflow.com/questions/50844191/excel-vba-to-powerpoint-copying-a-cell-to-textbox-in-an-existing-slide/51075084#51075084", "title": "Excel VBA to Powerpoint: Copying a cell to textbox in an existing slide", "body": "<p>Do you mean the following?</p>\n\n<p>When you have duplicated a PP slide with already a textbox defined in it, that you want to fill in the value of an excel cell into the textbox of your PP slide?</p>\n\n<p>That is if the textbox in every slide has the same name, you can check it by going to Powerpoint, select your object (textbox), go to Format, Selection Pane, and there you can see the name of your textbox. In this case it is \"Title 1\"</p>\n\n<pre><code>Dim pp As PowerPoint.Application\nDim PPPres As PowerPoint.Presentation\nDim PPSlide As PowerPoint.slide\nSet pp = CreateObject(\"PowerPoint.Application\")\n\nSet PPPres = pp.Presentations.Open (\"Filenamehere\")\nSet PPSlide = PPPres.Slides.Add(Slidestart, ppLayoutTitleOnly)\n\nSheets(\"SHEET NAME OF EXCEL\").Activate\nPPSlide.Shapes(\"Title 1\").TextFrame.TextRange.Text = cells(i,j).text\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9937830, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-i2Ooz0VoVZc/AAAAAAAAAAI/AAAAAAAABGE/tOqKU4RSWA8/photo.jpg?sz=128", "display_name": "Jorge Guevara", "link": "https://stackoverflow.com/users/9937830/jorge-guevara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1834, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530162624, "creation_date": 1528915516, "last_edit_date": 1528916034, "question_id": 50844191, "link": "https://stackoverflow.com/questions/50844191/excel-vba-to-powerpoint-copying-a-cell-to-textbox-in-an-existing-slide", "title": "Excel VBA to Powerpoint: Copying a cell to textbox in an existing slide", "body": "<p>I'm a beginning to excel vba exporting and control information to other programs. </p>\n\n<p>The task: Nameplates need to be printed and distributed to personnel to label their equipment. We have a huge equipment masterlist, the necessary information (machine ID) is only in one column of the excel sheet. The template for the sticker is in powerpoint. </p>\n\n<p>The steps are: </p>\n\n<ol>\n<li><p>PowerPoint should open the template</p></li>\n<li><p>Excel should give one cell of information into one slide. </p></li>\n<li>A duplicate slide should be made of the template slide</li>\n<li>Step number 2 should be repeated except now the program has moved onto a different slide and different cell to copy and paste.</li>\n</ol>\n\n<p>Here is my code so far:</p>\n\n<pre><code>    Sub Sammple()\n   'Declaring Variables\n    Dim TemplateName As String\n    Dim pptpres As Object\n    Dim mySlide As Object\n    Dim myPresentation As Presentation\n    Dim TextBox As Object\n    Dim i As Integer\n    Dim j As Integer\n\n    Set pptpres = CreateObject(\"Powerpoint.Application\")\n       With pptpres\n            .Visible = True\n           .Presentations.Open (\"FileNameHere\")\n            For i = 1 To 400\n                .ActivePresentation.Slides(1).Duplicate.Item (1)\n                Next\n            For j = 3 To 514\n                Cells(j, 4).Copy\n                Next\n        End With\n\n\nEnd Sub\n</code></pre>\n\n<p>As you can tell, I've gotten the code down for excel to make 400 duplicate slides. I can't quite understand how to make excel copy text from the cell to a textbox into powerpoint then do it over and over until it reaches the end of the column range. </p>\n\n<p>Any help pointing in the right direction would be great. You'd be saving me over 1000 copy and paste clicks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1528915601, "post_id": 50844059, "comment_id": 88691906, "body": "<i>When I try to run the macro, it is blank</i> - providing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> will help us help you a lot more effectively (and you may solve the issue by actually building the mcve). That said, I don&#39;t see anywhere in your code we you actually set the <code>.Body</code> or <code>.HTMLBody</code> (which you&#39;ll need to display the range of cells in the email) in the code."}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1528979355, "post_id": 50844059, "comment_id": 88717556, "body": "Why do you create outApp and outMail twice?"}], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 7499014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cd9cb72d37fb8ffa70e0bfe7f05c09?s=128&d=identicon&r=PG&f=1", "display_name": "Denyo", "link": "https://stackoverflow.com/users/7499014/denyo"}, "is_accepted": false, "score": 0, "last_activity_date": 1528978939, "creation_date": 1528978939, "answer_id": 50857457, "question_id": 50844059, "link": "https://stackoverflow.com/questions/50844059/excel-macro-to-send-selected-cells-in-email-not-working/50857457#50857457", "title": "Excel macro to send selected cells in email not working", "body": "<p>you should use \"on error resume next\" with more caution. You dont see the exception that occurs.</p>\n\n<p>your failure is that you want to get the value of the cells D7 and A7 (string) but you take instead the range (object).</p>\n\n<p>Try the following:</p>\n\n<pre><code>With OutMail\n    .To = Range(\"D7\").Value\n    .CC = \"yourname@email.com\"\n    .BCC = \"\"\n    .Subject = \"Finance Request #\" &amp; Range(\"A7\").Value\n    ' This section adds Voting buttons\n    .Display   'or use .Send to automatically send without giving opportunity to review final product\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9937694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432fd2b886d89829dcb3bc58abd56221?s=128&d=identicon&r=PG&f=1", "display_name": "ryzenismyname", "link": "https://stackoverflow.com/users/9937694/ryzenismyname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 561, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528978939, "creation_date": 1528914960, "last_edit_date": 1531164843, "question_id": 50844059, "link": "https://stackoverflow.com/questions/50844059/excel-macro-to-send-selected-cells-in-email-not-working", "title": "Excel macro to send selected cells in email not working", "body": "<p>I'm trying to automate a report by being able to send a selected range of cells, that includes hidden cells, by making a macro. When I try to run the macro, it is blank. Please note that the text not written as a code are instructions. Macro is shown below:</p>\n\n<pre><code>Sub SendforApproval()\n'\n' SendforApproval Macro\n'\n\n' Generate Email\n\nDim OutApp As Object\nDim OutMail As Object\nDim strbody As String\nDim rng As Range\n\nIf ActiveWorkbook.Path &lt;&gt; \"\" Then\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n    Set myOlApp = CreateObject(\"Outlook.Application\")\n\n    'This is where the body of the email is populated - you can point to cells in your worksheet to pull text from them\n\nstrbody = \"&lt;font size=\"\"3\"\" face=\"\"Cambria\"\"&gt;\" &amp; _\n               \"Hi \" &amp; Range(\"B5\") &amp; \",&lt;br&gt;\" &amp; _\n               \"&lt;br&gt;Please note finance request #\" &amp; Range(\"a7\") &amp; \" has been accepted. Upon review, please use voting buttons to Approve or Send for Rework.&lt;br&gt;\"\n\n\n' The range belows designates which portion of your sheet will be inserted in the body of the email\n\nSet rng = Sheets(\"SheetName\").Range(\"A7:T22\").SpecialCells(xlCellTypeVisible)\n\n'You can also use a fixed range if you want or flex range\n'Set rng = Sheets(\"YourSheet\").Range(\"D4:D12\").SpecialCells(xlCellTypeVisible)\n'Set rng = Range(\"f7\").Resize(Application.CountA(Range(\"f7:f\" &amp; Rows.Count)), 12)\nOn Error GoTo 0\n\nIf rng Is Nothing Then\n    MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n           vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n    Exit Sub\nEnd If\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\n\n' This section defines receipants, Subject\n    On Error Resume Next\n    With OutMail\n\n        .To = Range(\"D7\")\n        .CC = \"yourname@email.com\"\n        .BCC = \"\"\n        .Subject = \"Finance Request #\" &amp; Range(\"a7\")\n\n  ' This section adds Voting buttons\n\n        .Display   'or use .Send to automatically send without giving opportunity to review final product\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n ' End of email process\n\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1528912522, "creation_date": 1528912522, "answer_id": 50843430, "question_id": 50843260, "link": "https://stackoverflow.com/questions/50843260/find-smallest-number-in-calculated-field/50843430#50843430", "title": "Find smallest number in calculated field", "body": "<p>Nope, but you can make one really easily, using a <code>ParamArray</code>:</p>\n\n<pre><code>Public Function SmallestValue(ParamArray Values())\n    Dim Value\n    For Each Value In Values\n        If IsEmpty(SmallestValue) Or SmallestValue &gt; Value Then\n            SmallestValue = Value\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>A paramarray takes any input, and puts it into an array. You iterate over that array, and test if things are larger or smaller.</p>\n\n<p>This works with any input, e.g.: <code>SmallestValue(2,1,3,4)</code> returns <code>1</code>, <code>SmallestValue(Now(), Date(), #1/1/2001#)</code> returns <code>#1/1/2001#</code>, <code>SmallestValue(\"banana\", \"apple\", \"pear\")</code> returns <code>\"apple\"</code></p>\n"}], "owner": {"reputation": 293, "user_id": 5366091, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/1029941630378984/picture?type=large", "display_name": "Robert Kendall", "link": "https://stackoverflow.com/users/5366091/robert-kendall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 50843430, "answer_count": 1, "score": 1, "last_activity_date": 1594022954, "creation_date": 1528911864, "last_edit_date": 1594022954, "question_id": 50843260, "link": "https://stackoverflow.com/questions/50843260/find-smallest-number-in-calculated-field", "title": "Find smallest number in calculated field", "body": "<p>In a MSAccess report, I have fields like:  CurrentHours, Insp1DueTime, Insp2DueTime...Inspn3DueTime, etc. I want a calculated field which outputs the smallest value of (Insp1DueTime-CurrentHours), (Insp2DueTime-Currenthours), (Insp3DueTime-CurrentHours), etc.</p>\n\n<p>Is there a VBA command which will do this, similar to '<em>smallestvalue</em>'((currenthours-insp1duetime), (Currenthours-insp2duetime),...(currenthour-InspnDueTime))</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1528911615, "post_id": 50843181, "comment_id": 88689947, "body": "Each time you click you want to cycle through A1:A10 putting the current value in B5? What should B5 contain? I think you need to clarify the question. Maybe show some data and expected result."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528911959, "post_id": 50843181, "comment_id": 88690132, "body": "look into <a href=\"https://stackoverflow.com/a/29520313/2727437\">this solution</a> to see a problem similar to yours"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1528914216, "post_id": 50843181, "comment_id": 88691224, "body": "Consider <a href=\"https://stackoverflow.com/posts/50843181/edit\">edit</a>ing your post so that the question title is easier to search, for people having similar problems and looking for a solution. Current title isn&#39;t quite SEO-optimal, to say the least."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528914827, "post_id": 50843181, "comment_id": 88691531, "body": "At the moment you are copying 20 cells from one sheet and pasting starting B5 in a different sheet. How is this different from what you actually want? Show an example because I am still at a loss as to what you hope to see happen as you mention A1:A10, you want to change just B5 and yet you are copying 20 cells A1:A20. And  printing what file?"}, {"owner": {"reputation": 9, "user_id": 9933385, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JVZrK6BeEz8/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2RG4POvam-K61a1TgoQ8MQ42m9rA/mo/photo.jpg?sz=128", "display_name": "d123", "link": "https://stackoverflow.com/users/9933385/d123"}, "edited": false, "score": 0, "creation_date": 1528915652, "post_id": 50843181, "comment_id": 88691928, "body": "QHarr, I simply what the button to change cell B5 based on data on a separate sheet, as you mentioned before like a cycle going through A1:A10, B5 should just contain one cell value at a time (A1) until I click on the button then it should replace the value going down the list (A2) and so on."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528916974, "post_id": 50843181, "comment_id": 88692555, "body": "To achieve what you want is quite simple, one approach would be to get the value of B5, search through your A1:A10 range, and return the cell beneath. Add a handler to say if the cell beneath is empty go back to the start of the list. However this isn&#39;t a code for me site so a bit of research on searching in vba and using offset and <code>if</code> statements and you should be set!"}], "answers": [{"tags": [], "owner": {"reputation": 542, "user_id": 7099906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JfvZO.png?s=128&g=1", "display_name": "Taylor Scott", "link": "https://stackoverflow.com/users/7099906/taylor-scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1528916540, "last_edit_date": 1528916540, "creation_date": 1528916042, "answer_id": 50844350, "question_id": 50843181, "link": "https://stackoverflow.com/questions/50843181/vba-excel-macro-button-change-only-a-specific-cell-replacing-with-different-da/50844350#50844350", "title": "vba excel macro button, change only a specific cell, replacing with different data in other sheet", "body": "\n\n<p>It think that this is about what you are looking for.</p>\n\n<p>The subroutine below sets the value of cell <code>B5</code> on sheet 2 to be the value of the cell that corresponds to the index, iterating over down columns then rows (<code>A1, A2, ... A20, B1, B2, B20</code> in the example below)</p>\n\n<p>You can learn more about the <code>static</code> statement, which makes this work <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/static-statement\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> Sub iterateStatic(Optional Reset As Boolean = False)\n    Static index    As Integer\n    Dim fromRng     As Range, _\n        targetRng   As Range\n    If Reset Then index = 0\n    Let index = index + 1\n    Set fromRng = Sheets(1).Range(\"A1:B20\")\n    Set targetRng = Sheets(2).Range(\"B5\")\n    Let targetRng.Value = fromRng.Cells.Item( _\n            RowIndex:=index Mod fromRng.Rows.Count, _\n            ColumnIndex:=-Int(-index / fromRng.Rows.Count)).Value\n\n'    ''  Debug to show how the function iterates over the range\n'\n'    Debug.Print fromRng.Cells.Item( _\n'            RowIndex:=index Mod fromRng.Rows.Count, _\n'            ColumnIndex:=-Int(-index / fromRng.Rows.Count)).Address\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9933385, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JVZrK6BeEz8/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2RG4POvam-K61a1TgoQ8MQ42m9rA/mo/photo.jpg?sz=128", "display_name": "d123", "link": "https://stackoverflow.com/users/9933385/d123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528916540, "creation_date": 1528911489, "last_edit_date": 1528915667, "question_id": 50843181, "link": "https://stackoverflow.com/questions/50843181/vba-excel-macro-button-change-only-a-specific-cell-replacing-with-different-da", "title": "vba excel macro button, change only a specific cell, replacing with different data in other sheet", "body": "<p>How do I get a button to change one cell value each time the button is pressed,  </p>\n\n<p>lets say cell B5 is the active cell and I want this value to changed every time I click the button based on the values in a different sheet A1:A10,just going down the list.</p>\n\n<pre><code>Sub Button2_Click()\nSheets(\"data\").Range(\"A1:A10\").Copy\nSheets(\"printing\").Range(\"B5\").PasteSpecial xlPasteValues\nEnd Sub\n</code></pre>\n\n<p>I want to create a sort of loop, example I'm printing the same file many times but changing the names(in a cell), I have a list of names in a sheet called data, every time I click the button I want the (different sheet called printing) cell B5 to change.</p>\n\n<p>I can simply do this with copy and paste however its about 250 names I was hoping for a simpler solution.</p>\n"}, {"tags": ["arrays", "vba", "if-statement"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1528911136, "post_id": 50843087, "comment_id": 88689711, "body": "Yep. After the line that says <code>report.Cells(i, 19) = Date - CDate(Mid(annualArray1(Z, 19), 16, 10))</code> in your <code>If</code> block, just stick a <code>Exit For</code> and it will exit your <code>Z</code> loop."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528911500, "post_id": 50843087, "comment_id": 88689892, "body": "You&#39;re still writing to individual cells in a loop..."}, {"owner": {"reputation": 27, "user_id": 7959876, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wr-nZgjklNY/AAAAAAAAAAI/AAAAAAAANCI/BXNUVdBHXuU/photo.jpg?sz=128", "display_name": "Josh Hudson", "link": "https://stackoverflow.com/users/7959876/josh-hudson"}, "edited": false, "score": 0, "creation_date": 1528911518, "post_id": 50843087, "comment_id": 88689901, "body": "PERFECT! Thanks!"}, {"owner": {"reputation": 27, "user_id": 7959876, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wr-nZgjklNY/AAAAAAAAAAI/AAAAAAAANCI/BXNUVdBHXuU/photo.jpg?sz=128", "display_name": "Josh Hudson", "link": "https://stackoverflow.com/users/7959876/josh-hudson"}, "edited": false, "score": 0, "creation_date": 1528911546, "post_id": 50843087, "comment_id": 88689914, "body": "Mathieu im new to arrays, how do i not do that"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1528911613, "post_id": 50843087, "comment_id": 88689945, "body": "<code>annualArray1</code> is being overwritten with the same identical values at every single iteration of the <code>Z</code> loop, for one. Consider putting up the actual full procedure scope &amp; context on <a href=\"https://codereview.stackexchange.com\">Code Review</a> if you want help making it more efficient &amp; better in every aspect - that&#39;s precisely what CR does."}, {"owner": {"reputation": 27, "user_id": 7959876, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wr-nZgjklNY/AAAAAAAAAAI/AAAAAAAANCI/BXNUVdBHXuU/photo.jpg?sz=128", "display_name": "Josh Hudson", "link": "https://stackoverflow.com/users/7959876/josh-hudson"}, "edited": false, "score": 0, "creation_date": 1528911729, "post_id": 50843087, "comment_id": 88690013, "body": "How would I get it to go through each one without the loop"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1528915469, "post_id": 50843087, "comment_id": 88691846, "body": "@JoshHudson Just move <code>annualArray1 = Worksheets(&quot;Annual&quot;).Range(&quot;B1:T2000&quot;).Value</code> outside of your loops and put it under the <code>Set</code>s - you&#39;re wasting run-time by assigning that value every single iteration of your <code>Z</code> loop."}, {"owner": {"reputation": 27, "user_id": 7959876, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wr-nZgjklNY/AAAAAAAAAAI/AAAAAAAANCI/BXNUVdBHXuU/photo.jpg?sz=128", "display_name": "Josh Hudson", "link": "https://stackoverflow.com/users/7959876/josh-hudson"}, "edited": false, "score": 0, "creation_date": 1528919958, "post_id": 50843087, "comment_id": 88694114, "body": "You guys have been great. Looks like just about everything is working. But now when i run the below i get a subscript out of range error when it hits the last row in the array and a match inst found      If report.Cells(y, 19) = &quot;&quot; And report.Cells(y, 3) &lt;&gt; &quot;LOW&quot; Then     If CLng(report.Cells(y, 1)) = myArray(r, 1) Then     report.Cells(y, 19) = Date - DateValue(myArray(r, 2))     Exit For      End if     End if  Next y Next r"}], "owner": {"reputation": 27, "user_id": 7959876, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wr-nZgjklNY/AAAAAAAAAAI/AAAAAAAANCI/BXNUVdBHXuU/photo.jpg?sz=128", "display_name": "Josh Hudson", "link": "https://stackoverflow.com/users/7959876/josh-hudson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528911076, "creation_date": 1528911076, "question_id": 50843087, "link": "https://stackoverflow.com/questions/50843087/array-not-helping-speed", "title": "Array not helping speed", "body": "<p>I created an array to speed up this but it seems to take forever to run still. Is there are way to say once the first If is satisfied move to next i? It seems to find the match (always only one) but still search through all of the annualArray.</p>\n\n<p>Do give detail i have ID's on one table and want to find the matching ID on another table, then pull the date from the second table and put it into the first table (and subtract by todays date)</p>\n\n<pre><code>Set report = ActiveWorkbook.Worksheets(\"Report\")\nSet uwat = ActiveWorkbook.Worksheets(\"UWAT\")\n\nFor i = 2 To report.UsedRange.Rows.Count\nFor Z = 2 To annual.UsedRange.Rows.Count\nannualArray1 = Worksheets(\"Annual\").Range(\"B1:T2000\").Value\n\nIf CLng(report.Cells(i, 1)) = annualArray1(Z, 1) And annualArray1(Z, 19) &lt;&gt; \"\" Then\n       report.Cells(i, 19) = Date - CDate(Mid(annualArray1(Z, 19), 16, 10))\n    End If\n\nNext Z\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1528912788, "post_id": 50842958, "comment_id": 88690533, "body": "<i>I need a dynamic range under the formulas</i> - can you be more specific, please?"}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 9937462, "user_type": "registered", "profile_image": "https://graph.facebook.com/874602652730096/picture?type=large", "display_name": "Lovekush Chauhan", "link": "https://stackoverflow.com/users/9937462/lovekush-chauhan"}, "edited": false, "score": 0, "creation_date": 1528984397, "post_id": 50843808, "comment_id": 88720904, "body": "Glad to hear it. Perhaps you could accept the answer please."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1528914034, "creation_date": 1528914034, "answer_id": 50843808, "question_id": 50842958, "link": "https://stackoverflow.com/questions/50842958/vba-query-for-dynamic-range-in-excel-formulas/50843808#50843808", "title": "VBA Query for dynamic range in excel formulas", "body": "<p>I'm guessing, but if you mean you want the formula to refer to rng1, perhaps this. Use the Address property of a range and remove it from the quotes.</p>\n\n<pre><code>rng.Offset(1, -1).Formula = \"=CONCATENATE(\"\"WK-\"\",IF((WEEKNUM(LEFT(\" &amp; rng1.address &amp; \",9),2)-40)&lt;=0,(WEEKNUM(LEFT(\" &amp; rng1.address &amp; \",9),2)-40)+53,WEEKNUM(LEFT(\" &amp; rng1.address &amp; \",9),2)-40))\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9937462, "user_type": "registered", "profile_image": "https://graph.facebook.com/874602652730096/picture?type=large", "display_name": "Lovekush Chauhan", "link": "https://stackoverflow.com/users/9937462/lovekush-chauhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1528914034, "creation_date": 1528910536, "last_edit_date": 1531164843, "question_id": 50842958, "link": "https://stackoverflow.com/questions/50842958/vba-query-for-dynamic-range-in-excel-formulas", "title": "VBA Query for dynamic range in excel formulas", "body": "<p>The formula is giving the value in excel by this VBA code but the range in below formula is fix:</p>\n\n<pre><code>Private Sub Formula update()\nDim rng As Range\nDim rng1 As Range\n\n    Set rng = Range(\"B1\").End(xlDown)\nrng.Offset(1, 0).Formula = \"=TEXT(RIGHT(**B9**,9)+3,\"\"DDMMMYYYY\"\")&amp;\"\" - \"\"&amp;TEXT(RIGHT(*B9*,9)+7,\"\"DDMMMYYYY\"\")\"\nrng.Offset(1, -1).Formula = \"=CONCATENATE(\"\"WK-\"\",IF((WEEKNUM(LEFT(**B10**,9),2)-40)&lt;=0,(WEEKNUM(LEFT(**B10**,9),2)-40)+53,WEEKNUM(LEFT(**B10**,9),2)-40))\"\n\nEnd Sub\n</code></pre>\n\n<p>however in below mentioned code I need a dynamic range under the formulas.</p>\n\n<p>Can someone resolved it.</p>\n\n<pre><code>Private Sub FormulaValue_paste()\nDim rng As Range\nDim rng1 As Range\n\n    Set rng = Range(\"B1\").End(xlDown)\nrng.Offset(1, 0).Formula = \"=TEXT(RIGHT(rng,9)+3,\"\"DDMMMYYYY\"\")&amp;\"\" - \"\"&amp;TEXT(RIGHT(rng,9)+7,\"\"DDMMMYYYY\"\")\"\n        Set rng1 = rng.Offset(1, 0)\nrng.Offset(1, -1).Formula = \"=CONCATENATE(\"\"WK-\"\",IF((WEEKNUM(LEFT(rng1,9),2)-40)&lt;=0,(WEEKNUM(LEFT(rng1,9),2)-40)+53,WEEKNUM(LEFT(rng1,9),2)-40))\"\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance for your kind support.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1528910287, "post_id": 50842870, "comment_id": 88689263, "body": "IT&#39;s because you don&#39;t have a space between <code>unitcp_qual_var.qualified_id</code> and <code>WHERE</code> after those two lines concatenate.  Just stick an extra space in there so it concatenates properly <code>&quot; WHERE (qualified_data.....</code>"}, {"owner": {"reputation": 23, "user_id": 9937464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eae617a747de0bac6dff5473289ce90?s=128&d=identicon&r=PG&f=1", "display_name": "bailey", "link": "https://stackoverflow.com/users/9937464/bailey"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1528910447, "post_id": 50842870, "comment_id": 88689358, "body": "Thank you so much!"}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1528910762, "creation_date": 1528910762, "answer_id": 50843022, "question_id": 50842870, "link": "https://stackoverflow.com/questions/50842870/i-keep-an-error-around-the-sign-in-the-where-line-and-i-cant-figure-it-out/50843022#50843022", "title": "I keep an error around the &#39;=&#39; sign in the WHERE line and I can&#39;t figure it out", "body": "<p>Here's a quick rewrite adding the required space between your <code>ON</code> conditions and your <code>WHERE</code> clause as well as incorporating the <code>ORDER BY</code>. I'm adding a variable to hold the SQL string so it can be dumped to your immediate/debug window so you can see the output and test instead of dealing with tricky error messages:</p>\n\n<pre><code>strSQL=\"SELECT unitcp_qual_var.instance_id, *\" &amp; _\n  \" FROM qualified_data INNER JOIN unitcp_qual_var ON qualified_data.unit_id = unitcp_qual_var.unit_id AND qualified_data.baseline_id = unitcp_qual_var.baseline_id AND qualified_data.qualified_id = unitcp_qual_var.qualified_id\" &amp; _\n  \" WHERE (qualified_data.unit_id = 19419) AND (unitcp_qual_var.port_id = 1) AND (qualified_data.unit_id = 19419) AND (qualified_data.baseline_id = 2) AND (qualified_data.mdu_id = 622) AND (unitcp_qual_var.instance_id = 2)\" &amp; _\n  \" ORDER BY qualified_data.das_time Asc;\"\n\n'dump out to immediate window/pane (View&gt;&gt;Immediate  to activate)\ndebug.print strSQL\n\n'Run the sql into rs recordset\nSet rs = conn.Execute(strSQL)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9937464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eae617a747de0bac6dff5473289ce90?s=128&d=identicon&r=PG&f=1", "display_name": "bailey", "link": "https://stackoverflow.com/users/9937464/bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528910762, "creation_date": 1528910185, "last_edit_date": 1531164843, "question_id": 50842870, "link": "https://stackoverflow.com/questions/50842870/i-keep-an-error-around-the-sign-in-the-where-line-and-i-cant-figure-it-out", "title": "I keep an error around the &#39;=&#39; sign in the WHERE line and I can&#39;t figure it out", "body": "<pre><code>Set rs = conn.Execute(\"SELECT unitcp_qual_var.instance_id,\" &amp; _\n                          \"*FROM qualified_data INNER JOIN unitcp_qual_var ON qualified_data.unit_id = unitcp_qual_var.unit_id AND qualified_data.baseline_id = unitcp_qual_var.baseline_id AND qualified_data.qualified_id = unitcp_qual_var.qualified_id\" &amp; _\n                          \"WHERE (qualified_data.unit_id = 19419) AND (unitcp_qual_var.port_id = 1) AND (qualified_data.unit_id = 19419) AND (qualified_data.baseline_id = 2) AND (qualified_data.mdu_id = 622) AND (unitcp_qual_var.instance_id = 2);\")\n                          ' \"ORDER BY qualified_data.das_time Asc;\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528912266, "post_id": 50842854, "comment_id": 88690272, "body": "So is the explicit question: How do I format the first row in blue and the entire table in white with continuous borders? First row of table? Blue background?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1528912864, "post_id": 50842854, "comment_id": 88690571, "body": "Is the typo in the line <code>Path = FolderPath...</code> accidental or is it also apparent in your code? (Note it should be <code>... &amp; nday &amp;  Southern_Europe &amp; &quot;.xlsx&quot;</code>"}, {"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1528966672, "post_id": 50842854, "comment_id": 88709700, "body": "@BruceWayne is just a typo!"}, {"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528966738, "post_id": 50842854, "comment_id": 88709743, "body": "@QHarr exactly! the color is not important, blue white or black, i can modify it later. The important thing is the syntax"}], "owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528910129, "creation_date": 1528910129, "question_id": 50842854, "link": "https://stackoverflow.com/questions/50842854/automatically-format-row-columns-vba", "title": "automatically format row/columns vba", "body": "<p>I am writing this code and I encounter difficulties to format automatically rows and columns. The problem is at the AUTOFIT comment below. I want to format the first row (headers) and then the entire table automatically. I am able to do it by the range function (typing the exact range of the cells), but i would like to do automatically as I did for the copy paste in the middle of the code. In particular I would like to format the first row in blue and the entire table in white with continuous borders.</p>\n\n<p>I tried many different commands but everytimes it gives me an error. Some clue?</p>\n\n<pre><code>   Option Explicit\n    Public wkbk As Workbook\n    Public mybook As Workbook\n\n    Sub Opentrading()\n\n    Dim FolderPath As String\n    Dim Path As String\n    Dim nyear As String\n    Dim nmont As String\n    Dim nday As String\n    Dim LastRow As Long\n    Dim LastColumn As Long\n\n    Dim StartCell As Range\n    Dim sht As Worksheet\n\n    FolderPath = \"filename\"\n    nyear = Sheet6.Range(\"J3\")\n    nmont = Sheet6.Range(\"J5\")\n    nday = Sheet6.Range(\"J7\")\n    Path = FolderPath &amp; \"\\\" &amp; nyear &amp; \"-\" &amp; nmont &amp; \"-\" &amp; nday &amp;  Southern_Europe\" &amp; \".xlsx\"\n    Set mybook = ThisWorkbook\n    mybook.Worksheets(\"Data\").UsedRange.ClearContents\n    mybook.Worksheets(\"Data\").Cells.ClearFormats\n    Set wkbk = Workbooks.Open(Path)\n    Set sht = wkbk.Sheets(\"Southern_Europe\")\n\n    'Find Last Row and Column\n    Set StartCell = sht.Range(\"D1\")\n      LastRow = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).Row\n      LastColumn = sht.Cells(StartCell.Row, sht.Columns.Count).End(xlToLeft).Column\n\n    'Copy paste\n     wkbk.Worksheets(\"Southern_Europe\").Range(StartCell, sht.Cells(LastRow, LastColumn - 5)).Copy mybook.Worksheets(\"Data\").Range(\"A1\")\n\n    'Autofit\n     With mybook.Worksheets(\"Data\")\n                .UsedRange.Columns.AutoFit\n                .Range(\"A1:S1\").Interior.Color = RGB(0, 0, 0)\n    '            .Range(StartCell, sht.Cells(LastRow, LastColumn - 5)).BorderAround LineStyle:=xlContinuous\n    '            .Range(StartCell, sht.Cells(LastRow, LastColumn - 5)).Borders(xlInsideHorizontal).LineStyle = xlContinuous\n        End With\n\n      wkbk.Close\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528993072, "post_id": 50842742, "comment_id": 88726286, "body": "And how is the current code not working? You apparently already know about Instr, Right and Left functions, so why not check whether the seventh character is a <code>.</code> or a space and branch your code accordingly?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1529023546, "post_id": 50842742, "comment_id": 88737625, "body": "I&#39;ve completed my answer."}], "answers": [{"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": -1, "last_activity_date": 1529050232, "last_edit_date": 1529050232, "creation_date": 1528914951, "answer_id": 50844052, "question_id": 50842742, "link": "https://stackoverflow.com/questions/50842742/extract-first-n-characters-based-on-predefined-delimiter/50844052#50844052", "title": "Extract first n characters based on predefined delimiter", "body": "<p>I would suggest you consider <a href=\"https://stackoverflow.com/a/22542835/111794\">using regular expressions</a> for this. (The link is for using regular expressions in VBA hosted under Excel, but most of the information applies to VBA hosted under Word as well.)</p>\n\n<hr>\n\n<p>A short introduction to regular expressions:</p>\n\n<ul>\n<li>Define a pattern</li>\n<li>Find one or more matches to the pattern in a string</li>\n</ul>\n\n<hr>\n\n<p>You could use the following pattern to match all the variations:</p>\n\n<pre><code>^\\d{6}(?:\\.\\d{2}) - .*(?:\\.doc|\\.docx)$\n</code></pre>\n\n<p>Add a reference (<strong>Tools</strong> -> <strong>References...</strong>) to the <strong>Microsoft VBScript Regular Expressions 5.5</strong> library. Then you can use something like the following:</p>\n\n<pre><code>Sub FooterFields2(myFooterHL, myTotalPageCount, myFooterBold)\n    Dim re As New RegExp\n    re.Pattern = \"^(\\d{6}(?:\\.\\d{2})) - (.*)(?:\\.doc|\\.docx)$\"\n    re.IgnoreCase = True\n\n    Dim matches As MatchCollection\n    Set matches = re.Execute(ActiveDocument.Name)\n    If matches.Count = 0 Then\n        MsgBox \"Document name doesn't match\"\n        Exit Sub\n    End If\n\n    Dim match As match\n    Set match = matches(0)\n\n    Dim code As String, title As String\n    code = match.SubMatches(0)\n    title = match.SubMatches(1)\n\n    'insert code and title in the appropriate location\n\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h3>Explanation</h3>\n\n<p><img src=\"https://i.stack.imgur.com/oVX1I.png\" alt=\"Output of Expresso\"></p>\n\n<p><code>\\d</code> -- matches a single digit character<br>\n<code>\\d{6}</code> -- matches exactly 6 digits</p>\n\n<p><code>\\.</code> -- matches a <code>.</code>. Because the <code>.</code> is a part of regular expression syntax, it has to be escaped with a <code>\\</code><br>\n<code>\\.\\d{2}</code> -- matches a <code>.</code> followed by (as before) exactly two digits<br>\n<code>(?:\\.\\d{2})</code> -- groups <code>\\.\\d{2}</code> so we can apply an operator. Grouping with <code>(?:</code> (as opposed to with <code>(</code>) does not store the value within the group to be referenced separately<br>\n<code>(?:\\.\\d{2})?</code>-- matches zero or one instances of <code>(?:\\.\\d{2})</code>, because the title might have the decimal and two successive digits, or it might not  </p>\n\n<p><code>- .*</code> -- matches a space, a dash, and a space, followed by any number (<code>*</code>) of any character (<code>.</code>)</p>\n\n<p><code>\\.doc|\\.docx</code> -- matches either <code>.doc</code> or <code>.docx</code><br>\n<code>(?:\\.doc|\\.docx)</code> -- groups together the different variants of the extension, but doesn't save the extension for further use</p>\n\n<hr>\n\n<p>In order to extract the digits and the title after we've matched against the regular epression, we need to use capturing groups, which are indicated by parentheses -- <code>()</code>. In this case we want the numeric code (first capturing group) and the title (second capturing group):</p>\n\n<pre><code>(\\d{6}(?:\\.\\d{2})) - (.*)(?:\\.doc|\\.docx)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/iDiNq.png\" alt=\"Output of Expresso, with capturing groups\"></p>\n"}], "owner": {"reputation": 1, "user_id": 9937378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581a9656395b2c698aa92e35bbe03d96?s=128&d=identicon&r=PG&f=1", "display_name": "gnola", "link": "https://stackoverflow.com/users/9937378/gnola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1529050232, "creation_date": 1528909708, "last_edit_date": 1528925418, "question_id": 50842742, "link": "https://stackoverflow.com/questions/50842742/extract-first-n-characters-based-on-predefined-delimiter", "title": "Extract first n characters based on predefined delimiter", "body": "<p>I currently have a cope snippet that allows me to extract the first 6 characters of a filename to insert in the right of a document footer and the file title (not including extension) in the left of the footer. It was all based on character position and had served its purpose. However, a complexity has been introduced. </p>\n\n<p>Our previous file naming structure was solely <code>\"###### - [Title]\"</code> (where we had 6 digits, a space, dash, a space, a title). We now have additional file names of the format <code>\"######.## - [TITLE]\"</code>. I don't believe I can rely solely on character position to achieve extraction and insertion. I'm looking for some assistance in how I might be able to setup the code to determine whether the 7th character is a decimal or a space and proceed accordingly with inserting <code>#####</code> versus <code>######.##</code> into the footer. The flip side would also be true where I would need to determine the actual title (not relying on the position since it would be dependent on the first case.</p>\n\n<p>Any assistance is appreciated. Below is the current code. It might not be the cleanest, but it gets the job done:</p>\n\n<pre><code>Sub FooterFields(myFooterHL, myTotalPageCount, myFooterBold)\n\n    sTitle = ActiveDocument.Name\n    J = InStrRev(sTitle, \".\")\n    If J &gt; 0 Then\n        sTitle = Left(sTitle, J - 9)\n        If Len(sTitle) &gt; 5 Then\n            sTitle = Left(sTitle, 9)\n        End If\n\n        Dim specTitle As String\n        Dim specTitle2 As String\n        Dim specTitleInt As String\n\n        specTitle = ActiveDocument.Name\n        If Right(specTitle, 5) = \".docx\" Then\n            specTitleInt = Left(specTitle, Len(specTitle) - 5)\n            specTitle2 = Right(specTitleInt, Len(specTitleInt) - 9)\n        ElseIf Right(specTitle, 4) = \".doc\" Then\n            specTitleInt = Left(specTitle, Len(specTitle) - 4)\n            specTitle2 = Right(specTitleInt, Len(specTitleInt) - 9)\n        Else\n        End If\n\n        sDiv = ActiveDocument.Name\n        K = InStrRev(sDiv, \".\")\n        If K &gt; 0 Then\n            sDivIntermediate = Right(sDiv, K - 6)\n            sDivFinal = specTitle2\n            If Len(sDiv) &gt; 5 Then\n                sDivIntermediate = Right(sDiv, K - 6)\n                sDivFinal = specTitle2\n            End If\n\n            If ActiveWindow.View.SplitSpecial &lt;&gt; wdPaneNone Then\n                ActiveWindow.Panes(2).Close\n            End If\n            If ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _\n               ActivePane.View.Type = wdOutlineView Then\n                ActiveWindow.ActivePane.View.Type = wdPrintView\n            End If\n            ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter\n            Selection.WholeStory\n            Selection.Delete\n            Selection.Font.AllCaps = True\n\n            With Selection\n                .Range.Text = sTitle\n                .Range.InsertAlignmentTab wdRight, wdMargin\n                .EndKey Unit:=wdLine\n                .Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:=\"PAGE  \",\n                PreserveFormatting:=True\n\n                If myTotalPageCount = vbYes Then\n                    .TypeText Text:=\"/\"\n                    .Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty,\n                    Text:=\"NUMPAGES  \", PreserveFormatting:=True\n                Else\n                End If\n\n                .HomeKey Unit:=wdLine\n                .Range.Text = sDivFinal\n\n            End With\n\n            PageNumberAlignment:=wdAlignPageNumberRight, FirstPage:=True\n\n\n            ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument\n        Else\n            MsgBox \"Document has no filename extension.\"\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "math", "nonlinear-functions", "newtons-method"], "comments": [{"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1528910311, "post_id": 50842666, "comment_id": 88689280, "body": "You might have text in one of the cells. Btw, why is <code>x</code> of type <code>Long</code> and not a floating point number?"}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1528910453, "post_id": 50842666, "comment_id": 88689360, "body": "@NicoSchertler it was originally of type <code>single</code> but I was troubleshooting and I guess never changed it back. I will try making x of another type. What is the equivalent to <code>float</code>? Do you know?"}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1528910681, "post_id": 50842666, "comment_id": 88689475, "body": "I double-checked, there is no text in one of the cells. @NicoSchertler"}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1528911039, "post_id": 50842666, "comment_id": 88689655, "body": "Then try to store the values in some variables first and you will see if there is a conversion error. E.g. <code>Dim B As Single : B = Range(...)</code>. This will make your code cleaner, anyway."}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1528911672, "post_id": 50842666, "comment_id": 88689975, "body": "so I changed <code>x = sht.Cells(rw, 48)</code> to ` Dim x As Single: x = sht.Cells(rw, 48)`... is that what you meant? because it is still giving me the same error, same location. In Column AU I have a range of radians values from pi to -pi"}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1528911818, "post_id": 50842666, "comment_id": 88690059, "body": "Yes, this is what I meant (for all the variables in your code). If the error is still in the formula for <code>fx</code>, then it is probably not a parsing error. You can try to split the formula into separate parts and check what the problematic one is."}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1528911971, "post_id": 50842666, "comment_id": 88690144, "body": "So, I split it up, doing this: <code>fx1 = Application.Acos((Range(&quot;O9&quot;) - Range(&quot;AI5&quot;) * Cos(x)) &#47; Range(&quot;AL5&quot;))</code>  <code>fx2 = -Application.Asin((Range(&quot;AI5&quot;) * Sin(x) - Range(&quot;P9&quot;)) &#47; Range(&quot;AL5&quot;))</code>  <code>fx = fx1 + fx2</code> and the problem is in fx2"}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1528912328, "post_id": 50842666, "comment_id": 88690303, "body": "Why aren&#39;t you using the variables instead of all these <code>Range</code>  calls? That was the whole purpose of the first check."}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1528912457, "post_id": 50842666, "comment_id": 88690364, "body": "Because the variables may change in different instances. I will however for this purpose change the <code>range</code> to the variables"}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1528912581, "post_id": 50842666, "comment_id": 88690435, "body": "It still gives me the same error message on fx2 when I change the range cells to their variables"}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1528912910, "post_id": 50842666, "comment_id": 88690590, "body": "Make sure those values are in radians, not degrees.  Trig functions in every language accept radians as their argument.  Check ranges for inverse functions as well.  Odd looking NR implementation."}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "reply_to_user": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1528913070, "post_id": 50842666, "comment_id": 88690659, "body": "All the values are in radians @duffymo. I thought I mentioned that in the question, but I guess not. I will add it right now. Judging by your comment there, it seems as though you&#39;ve seen a better way to code the NR method, could you show me that way?"}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1528913513, "post_id": 50842666, "comment_id": 88690869, "body": "Breaking news: when I hover over fx1, a text box shows: fx1= Error 2036. Does this mean anything to you? @NicoSchertler"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528914196, "post_id": 50842666, "comment_id": 88691209, "body": "That suggests an error value in one of your cells."}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1528914421, "post_id": 50842666, "comment_id": 88691331, "body": "Yes, I&#39;ve seen it done properly for 1D and mutlidimensional problems in Numerical Recipes.  I&#39;m guessing that your problem is for root finding of 1D functions, not for linear algebra solution of nonlinear problems."}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "edited": false, "score": 0, "creation_date": 1528914626, "post_id": 50842666, "comment_id": 88691428, "body": "It is of a 2D function... do i have something majorly wrong here?"}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1528914875, "post_id": 50842666, "comment_id": 88691559, "body": "I didn&#39;t read your link.  I don&#39;t know.  Take a look at Numerical Recipes.  You will have to translate C to VB."}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "reply_to_user": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1528915783, "post_id": 50842666, "comment_id": 88692000, "body": "@duffymo it seems to me that I have to subscribe to this Numerical Recipes information source in order to access that information. Could you post the code that you have seen work as an answer?"}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1528916601, "post_id": 50842666, "comment_id": 88692380, "body": "Nope.  I&#39;m not going to break their licensing agreement.  I bought the book.  Maybe you could, too.  If you really want to persist with the code you have, why would you not step through in a debugger and figure out where you went wrong?  You could have fixed it by now."}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "edited": false, "score": 0, "creation_date": 1528916945, "post_id": 50842666, "comment_id": 88692546, "body": "Okay. I would if I could, however, I am at work and my boss isn&#39;t going to approve of a debugger for one problem that I have. Furthermore not everyone has the funds to be spending $50+ on a book that they may only need once."}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "edited": false, "score": 1, "creation_date": 1528918690, "post_id": 50842666, "comment_id": 88693450, "body": "it has been solved"}], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "edited": false, "score": 0, "creation_date": 1528923695, "post_id": 50846014, "comment_id": 88695930, "body": "When I try to execute it, Run-Time error &#39;424&#39;: Object Required pops up when going through <code>SetFunctionCoefficientss()</code> <code>FuncCoeffX = .Range(&quot;O9&quot;)</code> however there is a value in O9."}, {"owner": {"reputation": 46, "user_id": 7463843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d410c1245cc1bcca1a0eca65bba589?s=128&d=identicon&r=PG&f=1", "display_name": "PaulDragoonM", "link": "https://stackoverflow.com/users/7463843/pauldragoonm"}, "reply_to_user": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "edited": false, "score": 0, "creation_date": 1528924552, "post_id": 50846014, "comment_id": 88696290, "body": "Ok. I updated the answer with <code>sht = Application.ThisWorkbook.Worksheets(1)</code> in <code>SetExcelVariables</code>. Could you check whether this would solve the error?"}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "edited": false, "score": 0, "creation_date": 1528925643, "post_id": 50846014, "comment_id": 88696706, "body": "The same error pops up... are you wanting me to insert the new code into a new module?"}, {"owner": {"reputation": 46, "user_id": 7463843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d410c1245cc1bcca1a0eca65bba589?s=128&d=identicon&r=PG&f=1", "display_name": "PaulDragoonM", "link": "https://stackoverflow.com/users/7463843/pauldragoonm"}, "reply_to_user": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "edited": false, "score": 0, "creation_date": 1528927495, "post_id": 50846014, "comment_id": 88697389, "body": "Yes please paste all the codes into a new module. If it still fails, try pasting the codes into a new Workbook to avoid any variable naming conflicts."}, {"owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "edited": false, "score": 0, "creation_date": 1528984899, "post_id": 50846014, "comment_id": 88721237, "body": "So when I place the macros into a new module in a new work book, no errors appear, however, I am populating O9 P9 AI5 AL5... what other cells need to be populated in order for this to work??"}, {"owner": {"reputation": 46, "user_id": 7463843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d410c1245cc1bcca1a0eca65bba589?s=128&d=identicon&r=PG&f=1", "display_name": "PaulDragoonM", "link": "https://stackoverflow.com/users/7463843/pauldragoonm"}, "reply_to_user": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "edited": false, "score": 0, "creation_date": 1528987494, "post_id": 50846014, "comment_id": 88722925, "body": "You may choose which cells to fill by modifying the cell address in the <code>SetFunctionCoefficients</code> procedure. In the <code>Main()</code> procedure, you can also modify the cell address of <code>rngTarget</code> and <code>rngResult</code>."}, {"owner": {"reputation": 46, "user_id": 7463843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d410c1245cc1bcca1a0eca65bba589?s=128&d=identicon&r=PG&f=1", "display_name": "PaulDragoonM", "link": "https://stackoverflow.com/users/7463843/pauldragoonm"}, "reply_to_user": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "edited": false, "score": 0, "creation_date": 1528987787, "post_id": 50846014, "comment_id": 88723117, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/173160/discussion-between-pauldragoonm-and-jakek\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 46, "user_id": 7463843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d410c1245cc1bcca1a0eca65bba589?s=128&d=identicon&r=PG&f=1", "display_name": "PaulDragoonM", "link": "https://stackoverflow.com/users/7463843/pauldragoonm"}, "is_accepted": false, "score": 1, "last_activity_date": 1528924472, "last_edit_date": 1528924472, "creation_date": 1528922769, "answer_id": 50846014, "question_id": 50842666, "link": "https://stackoverflow.com/questions/50842666/error-when-implementing-newton-raphson-method-to-vba/50846014#50846014", "title": "Error when implementing Newton Raphson method to vba", "body": "<p>I split your codes into multiple subroutines and removed some unused variables. Run the Sub Main() will give the final results.</p>\n\n<p>VBA itself has the sin and cos functions. You can use them as <code>VBA.sin()</code> and <code>VBA.cos()</code>, or simply <code>sin()</code> and <code>cos()</code>. The Acos and Asin are included in <code>Application.WorksheetFunction</code>, so you can use them as <code>Application.WorksheetFunction.Acos</code> and <code>Application.WorksheetFunction.Asin</code>.</p>\n\n<p>In your original code of fprimex, there is an occurrence of <code>Range(\"Cos(x)\")</code>, which is not the valid syntax for the <code>Worksheet.Range</code> property, unless you have a Range that has the name of \"Cos(x)\". Also, please check whether my version of fprimex matches yours since I haven't done calculus for some time.</p>\n\n<p>You should be careful with cases when <code>fPrimeX = 0</code>, or <code>abs(x) &gt;= 1</code> when <code>sqr(1-x^2)</code> is on the denominator. Crude exit options for the above cases are include in the attached codes.</p>\n\n<pre><code>Option Explicit\n\nConst ep As Double = 1E-23: Const iMax As Long = 100\n\nPrivate FuncCoeffB As Double\nPrivate FuncCoeffS As Double\nPrivate FuncCoeffX As Double\nPrivate FuncCoeffY As Double\n\nPrivate sht As Worksheet\nPrivate wksFunc As WorksheetFunction\n\nPrivate Sub SetExcelVariables()\n    Set sht = Application.ThisWorkbook.Worksheets(1)\n    ' Set sht = Sheets(\"Sheet1\")\n    Set wksFunc = Application.WorksheetFunction\nEnd Sub\n\nPrivate Sub SetFunctionCoefficients()\n    With sht\n        FuncCoeffX = .Range(\"O9\")\n        FuncCoeffY = .Range(\"P9\")\n\n        FuncCoeffB = .Range(\"AI5\")\n        FuncCoeffS = .Range(\"AL5\")\n    End With\nEnd Sub\n\nPrivate Function fx(ArgX As Double) As Double\n    Dim fx1 As Double\n    Dim fx2 As Double\n\n    If VBA.Abs((FuncCoeffX - FuncCoeffB * VBA.Cos(ArgX)) / FuncCoeffS) &gt; 1 Or _\n        VBA.Abs((-FuncCoeffY + FuncCoeffB * VBA.Sin(ArgX)) / FuncCoeffS) &gt; 1 Then\n\n        Exit Function\n    End If\n\n    fx1 = wksFunc.Acos((FuncCoeffX - FuncCoeffB * VBA.Cos(ArgX)) / FuncCoeffS)\n    fx2 = -wksFunc.Asin((-FuncCoeffY + FuncCoeffB * VBA.Sin(ArgX)) / FuncCoeffS)\n\n    fx = fx1 + fx2\nEnd Function\n\nPrivate Function fPrimeX(ArgX As Double) As Double\n    Dim fPrimeX1 As Double\n    Dim fPrimeX2 As Double\n\n    If (((FuncCoeffX - FuncCoeffB * VBA.Cos(ArgX)) / FuncCoeffS) ^ 2) &gt;= 1 Or _\n        (((-FuncCoeffY + FuncCoeffB * VBA.Sin(ArgX)) / FuncCoeffS) ^ 2) &gt;= 1 Then\n\n        Exit Function\n    End If\n\n    fPrimeX1 = _\n        -FuncCoeffB / FuncCoeffS * VBA.Sin(ArgX) / _\n        VBA.Sqr( _\n            1 - ((FuncCoeffX - FuncCoeffB * VBA.Cos(ArgX)) / FuncCoeffS) ^ 2)\n\n    fPrimeX2 = _\n        -FuncCoeffB / FuncCoeffS * VBA.Cos(ArgX) / _\n        VBA.Sqr( _\n            1 - ((-FuncCoeffY + FuncCoeffB * VBA.Sin(ArgX)) / FuncCoeffS) ^ 2)\n\n    fPrimeX = fPrimeX1 + fPrimeX2\nEnd Function\n\nPrivate Function NewtonRaphson(ByVal ArgX As Double) As Variant\n    Dim ResFx As Double\n    Dim ResFPrimeX As Double\n\n    Dim xNew As Double\n    Dim er As Double\n\n    Dim iIter As Long\n    Dim Converged As Boolean\n    Dim Failed As Boolean\n\n    Dim ReturnValue As Variant\n    ReDim ReturnValue(1 To 1, 1 To 2) ' An array with a size of 1-by-2.\n\n    Do\n        ResFx = fx(ArgX)\n        ResFPrimeX = fPrimeX(ArgX)\n\n        If ResFPrimeX = 0 Then\n            Failed = True\n        Else\n            xNew = ArgX - ResFx / ResFPrimeX\n        End If\n\n        If xNew + ArgX = 0 Then\n            Failed = True\n        Else\n            er = VBA.Abs(2 * (xNew - ArgX) / (xNew + ArgX))\n        End If\n\n        If er &lt; ep Then\n            Converged = True\n        ElseIf iIter &gt;= iMax Then\n            Failed = True\n        Else\n            iIter = iIter + 1\n            ArgX = xNew\n        End If\n    Loop Until Converged Or Failed\n\n    If Failed Then\n        ReturnValue(1, 1) = \"Iteration failed\"\n    Else\n        ReturnValue(1, 1) = xNew\n    End If\n\n    ReturnValue(1, 2) = iIter\n\n    NewtonRaphson = ReturnValue\nEnd Function\n\nSub Main()\n    Dim rw As Long\n    Dim rngTarget As Excel.Range\n    Dim rngResult As Excel.Range\n    Dim xValue As Double\n\n    Call SetExcelVariables\n    Call SetFunctionCoefficients\n\n    For rw = 2 To 12\n        Set rngTarget = sht.Cells(rw, 48)\n        xValue = rngTarget.Value\n\n        Set rngResult = rngTarget.Offset(0, 2).Resize(1, 2)\n        rngResult.Value = NewtonRaphson(xValue)\n    Next rw\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 76, "user_id": 9808557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a4559f48494ac2698591c43d1bc22?s=128&d=identicon&r=PG&f=1", "display_name": "JakeK", "link": "https://stackoverflow.com/users/9808557/jakek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1528924472, "creation_date": 1528909438, "last_edit_date": 1528923226, "question_id": 50842666, "link": "https://stackoverflow.com/questions/50842666/error-when-implementing-newton-raphson-method-to-vba", "title": "Error when implementing Newton Raphson method to vba", "body": "<p>This is a long one I know but I would really appreciate the help.\nI am trying to code the <a href=\"https://en.wikipedia.org/wiki/Newton%27s_method\" rel=\"nofollow noreferrer\">Newton Raphson method</a> into VBA, Code shown below: </p>\n\n<h2>Code:</h2>\n\n<pre><code>'Code illustrating Newton-Raphson scheme for the equation:\n' f(x) = arcCos((x-BCos(H))/S)-arcSin((Bsin(H)-y)/S)\n\nConst ep = 1E-23: Const imax = 100\nPrivate x As Long: Private xnew As Single: Private xl As Single\nPrivate xu As Single: Private xm As Single: Private xmold As Single: Private A As Single: Private B As Single\nPrivate C As Single: Private D As Single\nPrivate i As Integer\nPrivate Failed As Boolean: Private Converged As Boolean\n\nSub Setup()\nFailed = False\nConverged = False\ni = 0\nEnd Sub\n\nSub NRRoot()\nSet sht = Sheets(\"Sheet1\")\nFor rw = 2 To 3601\n\nx = sht.Cells(rw, 48)\n\nSetup\nDo\nDim fx As Single: Dim fprimex As Single\nfx = Application.Acos((Range(\"O9\") - Range(\"AI5\") * Cos(x)) / Range(\"AL5\")) - Application.Asin((Range(\"AI5\") * Sin(x) - Range(\"P9\")) / Range(\"AL5\"))\nfprimex = -(Range(\"AI5\") * Sin(x) * Range(\"AL5\")) / (Range(\"AL5\") * Sqr((Range(\"AL5\") ^ 2) - (Range(\"O9\") ^ 2) + 2 * Range(\"O9\") * Range(\"AI5\") * Cos(x) - (Range(\"AI5\") ^ 2) * (Cos(x) ^ 2))) - (Range(\"AI5\") * Cos(x) * Range(\"AL5\")) / (Range(\"AL5\") * Sqr((Range(\"AL5\") ^ 2) - (Range(\"AI5\") ^ 2) * (Sin(x) ^ 2) + 2 * Range(\"P9\") * Range(\"AI5\") * Sin(x) - (Range(\"P9\") ^ 2)))\nxnew = x - fx / fprimex\nDim er As Single\ner = Abs(2 * (xnew - x) / (xnew + x))\nIf er &lt; ep Then\nConverged = True\nElseIf i &gt;= imax Then\nFailed = True\nElse\ni = i + 1\nx = xnew\nEnd If\nLoop Until Converged Or Failed\nIf Failed Then\nsht.Cells(rw, 50).Value = \"Iteration failed\"\nElse\nsht.Cells(rw, 50).Value = xnew\nEnd If\nsht.Cells(rw, 51).Value = i\nNext\n\nEnd Sub\n</code></pre>\n\n<h2>Problem:</h2>\n\n<p>I am getting the error message: \"Run-time error'13': Type Mismatch\", and using the debugger it is shown on this line of code:</p>\n\n<pre><code>fx = Application.Acos((Range(\"O9\") - Range(\"AI5\") * Cos(x)) / Range(\"AL5\")) - Application.Asin((Range(\"AI5\") * Sin(x) - Range(\"P9\")) / Range(\"AL5\"))\n</code></pre>\n\n<p><em>I think</em> it has something to do with the <code>Application.Acos</code> &amp; <code>Application.Asin</code>, however I am not too sure. I was having troubles with it for a while and I did some searching and found <a href=\"https://www.mrexcel.com/forum/excel-questions/60646-acos-function-not-defined.html\" rel=\"nofollow noreferrer\">This</a> showing that I have to put <code>Application.Acos</code> or <code>Application.WorksheetFunction</code>. The values being put in are all in radians from -pi to pi.</p>\n\n<p>If it isn't because of the above text, then <em>I think</em> it could have something to do with the parameters that I am defining... right at the top there it says <code>Private x As Long</code> where maybe it has to be something else. I have tried troubleshooting, but it never really worked :( <br></p>\n\n<p>The values in cells O9, P9, AI5, and AL5 are listed respectively: 2000, 3000, 5700, 2924.99</p>\n\n<p>P.S. \nThe reason why I am needing to use this method is because I am trying to calculate the angles of 2 sticks when given a certain point x,y (O9,P9). I need these angles to be able to calculate the center of mass of the two sticks. Once I have the center of mass I can then finish my calculations for the project I am doing. I know there are other (much better) methods to do this problem, like wolfram mathematica, however there are other parts to the project that need to be on excel. Therefore to run everything as smooth as possible, sadly, I need to do all of this on excel. </p>\n\n<p>P.P.S.\nThis is not my code by the way, I copied it from <a href=\"http://www.vbforums.com/showthread.php?798121-RESOLVED-VBA-code-to-apply-Newton-Raphson-method-to-ith-number-of-rows\" rel=\"nofollow noreferrer\">Here</a>, however I think it does actually solve the Newton Raphson Method.</p>\n\n<h2>Solution</h2>\n\n<p>I had the numbers for arcSin starting at pi and going to -pi  instead of 90 going to -90...</p>\n\n<p>If I can figure out a better way to program the Newton Raphson Method, I will be sure to make a new post about it.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9883235, "user_type": "registered", "profile_image": "https://graph.facebook.com/1527093800733456/picture?type=large", "display_name": "Jessica Christensen", "link": "https://stackoverflow.com/users/9883235/jessica-christensen"}, "edited": false, "score": 0, "creation_date": 1528910621, "post_id": 50842888, "comment_id": 88689435, "body": "I swear I tried that before... oh well, it&#39;s working great now! Thanks!"}], "tags": [], "owner": {"reputation": 573, "user_id": 506017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jnsvp.png?s=128&g=1", "display_name": "Eliot K", "link": "https://stackoverflow.com/users/506017/eliot-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1528910248, "creation_date": 1528910248, "answer_id": 50842888, "question_id": 50842599, "link": "https://stackoverflow.com/questions/50842599/assigning-names-of-multiple-selected-workbooks-to-column/50842888#50842888", "title": "Assigning names of multiple selected workbooks to column", "body": "<p>You are overwriting the value of <code>wbName</code> without putting it into your sheet. You need to change <code>wbName = rngdest.Value</code> to <code>rngdest.Value = wbName</code>.</p>\n\n<pre><code>Sub FileNameExtraction()\n\nDim filenames As Variant\nDim wb As Workbook\nDim i As Long\nDim wbName As String\nDim rngdest As Range\n\nSet rngdest = ThisWorkbook.ActiveSheet.Range(\"A1\") '&lt;&lt; results start storing in this cell\nfilenames = Application.GetOpenFilename( _\nFileFilter:=\"Excel Filter(*xlsx), *.xlsx\", MultiSelect:=True)\nIf TypeName(filenames) = \"Boolean\" Then Exit Sub 'if nothing is selected, routine ends\n\nFor i = 1 To UBound(filenames) 'i counts the files selected\n\n    Set wb = Workbooks.Open(filenames(i))\n    wbName = wb.Name\n    rngdest.Value = wbName '&lt;== change here\n    Set rngdest = rngdest.Offset(1, 0)\n\n    wb.Close False 'closes workbook without saving changes\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9883235, "user_type": "registered", "profile_image": "https://graph.facebook.com/1527093800733456/picture?type=large", "display_name": "Jessica Christensen", "link": "https://stackoverflow.com/users/9883235/jessica-christensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 50842888, "answer_count": 1, "score": 0, "last_activity_date": 1607424899, "creation_date": 1528909188, "last_edit_date": 1607424899, "question_id": 50842599, "link": "https://stackoverflow.com/questions/50842599/assigning-names-of-multiple-selected-workbooks-to-column", "title": "Assigning names of multiple selected workbooks to column", "body": "<p>I would like to select multiple files and have their names appear in a column in one main workbook.</p>\n<p>My code runs but the filenames aren't showing up like I want.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub FileNameExtraction()\n    \n    Dim filenames As Variant\n    Dim wb As Workbook\n    Dim i As Long\n    Dim wbName As String\n    Dim rngdest As Range\n    \n    Set rngdest = ThisWorkbook.ActiveSheet.Range(&quot;A1&quot;) '&lt;&lt; results start storing in this cell\n    filenames = Application.GetOpenFilename( _\n    FileFilter:=&quot;Excel Filter(*xlsx), *.xlsx&quot;, MultiSelect:=True)\n    If TypeName(filenames) = &quot;Boolean&quot; Then Exit Sub 'if nothing is selected, routine ends\n    \n    For i = 1 To UBound(filenames) 'i counts the files selected\n        \n        Set wb = Workbooks.Open(filenames(i))\n        wbName = wb.Name\n        wbName = rngdest.Value\n        Set rngdest = rngdest.Offset(1, 0)\n        \n        wb.Close False 'closes workbook without saving changes\n        \n    Next i\n    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1528909296, "post_id": 50842569, "comment_id": 88688704, "body": "I think you would have to aim more generically for your class. A class for &quot;Properties&quot; like a name/value pair that your generic &quot;Row&quot; class could instantiate as many times as their is columns and fill. That or perhaps your &quot;Row&quot; class could just store the properties (column header and value) in a dictionary?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528910422, "post_id": 50842569, "comment_id": 88689344, "body": "Whiteboard design questions are usually better suited for <a href=\"https://softwareengineering.stackexchange.com\">Software Engineering</a>. Please review their /help/on-topic page to make sure it&#39;s on-topic before posting there though."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528910498, "post_id": 50842569, "comment_id": 88689380, "body": "@MathieuGuindon Oh! I had no idea. I guess it can be closed in keeping with the votes."}, {"owner": {"reputation": 18637, "user_id": 220984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UTpcd.jpg?s=128&g=1", "display_name": "Doc Brown", "link": "https://stackoverflow.com/users/220984/doc-brown"}, "edited": false, "score": 0, "creation_date": 1528917965, "post_id": 50842569, "comment_id": 88693056, "body": "@Brian: I think your question could be on-topic here as well as on SE, but since you already deleted your crossposted question there, just let it here."}, {"owner": {"reputation": 18637, "user_id": 220984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UTpcd.jpg?s=128&g=1", "display_name": "Doc Brown", "link": "https://stackoverflow.com/users/220984/doc-brown"}, "edited": false, "score": 0, "creation_date": 1528918108, "post_id": 50842569, "comment_id": 88693135, "body": "... first you wrote <i>&quot;I have a custom class&quot;</i>, and then <i>&quot;a typical class for a table would use a row as an object with the column headers as the properties&quot;</i> - so what do you actually have implemented so far, and what is only on your whiteboard?"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 18637, "user_id": 220984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UTpcd.jpg?s=128&g=1", "display_name": "Doc Brown", "link": "https://stackoverflow.com/users/220984/doc-brown"}, "edited": false, "score": 0, "creation_date": 1528971419, "post_id": 50842569, "comment_id": 88712805, "body": "@DocBrown I don&#39;t have a whiteboard, which is probably my first mistake. I still consider myself a rookie developer (self taught). What I have implemented is an <code>agenda</code> class with five read/write properties. In a <code>model</code> class I use VBA functions to get the value for each property before adding the <code>agenda</code> class object to the collection. Then I send the collection to the controller which sends it to the view to build the new table. So my <code>model</code> class is the raw data and my <code>agenda</code> class is the table I am building."}], "answers": [{"comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1528979970, "post_id": 50857495, "comment_id": 88717993, "body": "Thanks for the answer. I actually already have something that does this. My <code>model</code> class initialize event populates a collection of ranges with the header value as the <code>key</code>. But each end user might choose different columns to print the table. In other words, they choose whatever columns from the raw data and create a different table. But it&#39;s not a copy/paste. The data rows of the new table are based on <code>CountIfs()</code> or <code>Index(Match())</code> criteria on the raw data. So I don&#39;t see how I can use an <code>Agenda</code> class with header properties if the columns are not known at runtime."}, {"owner": {"reputation": 18637, "user_id": 220984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UTpcd.jpg?s=128&g=1", "display_name": "Doc Brown", "link": "https://stackoverflow.com/users/220984/doc-brown"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1528984750, "post_id": 50857495, "comment_id": 88721136, "body": "@Brian: I don&#39;t understand where exactly your problem is. Your program gets a list of column names from your users as strings (how exactly does not matter). Then you can use a function like the one above to query the values from the dictionary. Why do you insist on using <i>&quot;an Agenda class with header properties&quot;</i>? That sounds not like what I suggested."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 1, "creation_date": 1528995666, "post_id": 50857495, "comment_id": 88727500, "body": "I think I understand what you are saying now. Get rid of the <code>Agenda</code> class entirely and use the collection/Dictionary object to get the column address for the VBA function. I think that answers my main question."}], "tags": [], "owner": {"reputation": 18637, "user_id": 220984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UTpcd.jpg?s=128&g=1", "display_name": "Doc Brown", "link": "https://stackoverflow.com/users/220984/doc-brown"}, "is_accepted": true, "score": 1, "last_activity_date": 1528984655, "last_edit_date": 1528984655, "creation_date": 1528979072, "answer_id": 50857495, "question_id": 50842569, "link": "https://stackoverflow.com/questions/50842569/create-table-with-variable-number-of-columns/50857495#50857495", "title": "Create table with variable number of columns", "body": "<blockquote>\n  <p>But a typical class for a table would use a row as an object with the column headers as the properties</p>\n</blockquote>\n\n<p>If your table has really more than 100 columns, or if the column names are only known a runtime, you should probably approach this different. One object per row is fine, but your class could provide a method for accessing all column values by their name. In VBA syntax:</p>\n\n<pre><code>  Function GetValue(byval columnName as string) as Variant\n  '...\n</code></pre>\n\n<p>As you see, you have to sacrifice some type safety here, but that is typically a small price to pay for getting this solved in a sensible manner.</p>\n\n<p>Internally, your objects can store the values in some <code>Dictionary</code> (in VBA available through the MS Scripting Runtime), indexed by the column names. This leads to </p>\n\n<pre><code>  Function GetValue(byval columnName as string) as Variant\n      if valueDict.ContainsKey(columnName) then\n           GetValue = valueDict(columnName)\n      else\n           '... add some error handling here\n      end if\n  End Function\n</code></pre>\n\n<p>For populating the dictionary, any database has possibilities to determine column names for a table, just google for \" get column names programmatically\" to find some example code.</p>\n"}], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 50857495, "answer_count": 1, "score": 1, "last_activity_date": 1528984655, "creation_date": 1528909075, "last_edit_date": 1528980337, "question_id": 50842569, "link": "https://stackoverflow.com/questions/50842569/create-table-with-variable-number-of-columns", "title": "Create table with variable number of columns", "body": "<p>I am hoping to get a few ideas for something to push me in the right direction. I have a custom class that stores data from a table based on criteria. The raw data (consisting of over 100 columns and varying between 10-1000 rows) is on a worksheet. My code does the following:</p>\n\n<blockquote>\n  <p>1 - Creates an object from the custom class<br>\n  2 - Adds a value to the properties of the object<br>\n  3 - Adds the object to a collection<br>\n  4 - Returns the collection to the controller which sends it to the view to build the table</p>\n</blockquote>\n\n<p>The following will build a collection of column ranges from the raw data, at least:</p>\n\n<pre><code>Private mcolColumnAddresses As Collection\n\nPrivate Sub Class_Initialize()   \n    Set mcolColumnAddresses = New Collection\n    Dim vHeader As Variant\n    For Each vHeader In mwksReport.Range(mwksReport.Cells(1, 1), mwksReport.Cells(1, mlLastColumn))\n        mcolColumnAddresses.Add vHeader.Offset(1, 0).Resize(mlLastRow - 1), vHeader.value\n    Next vHeader\nEnd Sub\n</code></pre>\n\n<p>The end users want the ability to choose the columns they want for building the new table. But a typical class for a table would use a row as an object with the column headers as the properties. How would I build a table using class properties when the columns are not known until run-time? I hope that makes sense. </p>\n\n<p><em>Note</em>: I am not asking for code but for suggestions. Has anybody else had this requirement? If so, how did you approach it? An example is welcome, too.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1528908217, "post_id": 50842208, "comment_id": 88688155, "body": "Why not just use something like <code>For each Cell in MyRange&#39; loop, where </code>MyRange` is declared before entering your loop?"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 1, "creation_date": 1528908290, "post_id": 50842208, "comment_id": 88688186, "body": "Rng_ is already set then you&#39;re trying to append a new range to it each time. <code>ActiveWorkbook.Sheets(&quot;Sheet1&quot;).range(&quot;testrange&quot;)(i + 1, j+ 1)</code> is not a valid range."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528909417, "post_id": 50842208, "comment_id": 88688783, "body": "<code>#N&#47;A</code> is an <code>Error</code> value, of type <code>Error</code>. Error values can&#39;t be compared to strings, numbers, or anything - hence &quot;type mismatch&quot;. Use <code>IsError</code> to test whether a cell contains any error, or if you need to specifically handle <code>#N&#47;A</code>, then test for it with <code>If [the range value] = CVErr(xlErrNA) Then</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528908776, "post_id": 50842423, "comment_id": 88688436, "body": "This will need to be adjusted if your range is not strictly limited to numbers and <code>#N&#47;A</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1528909154, "post_id": 50842423, "comment_id": 88688626, "body": "No need for <code>WorksheetFunction.IsError</code> to get involved, there&#39;s a VBA-native <code>IsError</code> function for this."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528909634, "post_id": 50842423, "comment_id": 88688901, "body": "This answer is correct so I&#39;m not going to post another, but consider completing it with information from <a href=\"https://stackoverflow.com/questions/50842208/replacing-a-cell-with-error-with-zeroe-using-using-vba-macro#comment88688783_50842208\">this comment</a> for a more thorough explanation and fine-tuned solution (although, handling <code>IsError</code> is probably a better idea than only handling <code>#N&#47;A</code>)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528910494, "post_id": 50842423, "comment_id": 88689378, "body": "Actually the type mismatch was more likely occurring on <code>rng_(i + 1, j + 1) &lt;&gt; &quot;&quot;</code>, where <code>&lt;&gt; &quot;&quot;</code> isn&#39;t a legal comparison against an <code>Error</code> value."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1528910699, "last_edit_date": 1528910699, "creation_date": 1528908558, "answer_id": 50842423, "question_id": 50842208, "link": "https://stackoverflow.com/questions/50842208/replacing-a-cell-with-error-with-zeroe-using-using-vba-macro/50842423#50842423", "title": "Replacing a cell with error with zeroe using using VBA macro", "body": "<p>This can be reduced to the below code (assuming you want to check every cell in some predetermined range named <code>testrange</code>)</p>\n\n<p><strong>Also, change</strong> <code>IsErr</code> <strong>to</strong> <code>IsError</code><strong>:</strong>  </p>\n\n<p><code>IsErr</code> will capture all errors EXCEPT <code>#N/A</code><br>\n<code>IsError</code> will capture all errors  </p>\n\n<p>Thus, your <code>Error 13: Type Mismatch</code> was likely due to feeding a <code>#N/A</code> or <code>&lt;&gt; \"\"</code> into the <code>IsErr</code> function </p>\n\n<pre><code>Sub TestSub_()\nDim rng_ As Range\nDim mycell As Range\nSet rng_ = ActiveWorkbook.Sheets(\"Sheet1\").Range(\"testrange\")\n\nFor Each mycell In rng_\n    If IsError(mycell) Then\n        mycell.Value = 0\n    Else\n        mycell = mycell.Value + 1\n    End If\nNext mycell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9937219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqMqq.jpg?s=128&g=1", "display_name": "acchan94", "link": "https://stackoverflow.com/users/9937219/acchan94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528910699, "creation_date": 1528907675, "last_edit_date": 1531161705, "question_id": 50842208, "link": "https://stackoverflow.com/questions/50842208/replacing-a-cell-with-error-with-zeroe-using-using-vba-macro", "title": "Replacing a cell with error with zeroe using using VBA macro", "body": "<p>I have a piece of code that runs over a specific range. I want it to  replace an error value, more specifically an #NA value, with zero and add 1 to non-error cells.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub TestSub_()\n    Dim i As Integer\n    Dim j As Integer\n    Dim rng_ As range\n\n    Set rng_ = ActiveWorkbook.Sheets(\"Sheet1\").range(\"testrange\")\n\n    i = 0\n    j = 0\n\n    While rng_(i + 1, j + 1) &lt;&gt; \"\"\n        While rng_(i + 1, j + 1) &lt;&gt; \"\"\n            If WorksheetFunction.IsErr(rng_(i + 1, j + 1)) Then\n                rng_(i + 1, j + 1).ClearContents\n                rng_(i+1,j+1) = 0\n                'enter code here\n            Else\n                rng_(i + 1, j + 1) = rng_(i + 1, j + 1) + 1\n            End If\n            j = j + 1\n        Wend\n        j = 0\n        i = i + 1\n    Wend\nEnd Sub\n</code></pre>\n\n<p>I run into an \"Error 13: Type mismatch\" error when I run the macro. However, I don't see any mismatches in data types.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 1, "creation_date": 1528908129, "post_id": 50842175, "comment_id": 88688107, "body": "please paste your code  so we can analyze through it"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528908908, "post_id": 50842175, "comment_id": 88688498, "body": "I made a little mockup where I filled in <code>A2:A11</code> and then filtered out all but the first and last row. using <code>Range(&quot;A2:A11&quot;).Copy Destination:=Range(&quot;A15&quot;)</code>, it only copied the visible cells, so this might be an option for you. The good thing is that in the &quot;Destination&quot; you can specify a different sheet&#39;s range"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528920214, "post_id": 50842175, "comment_id": 88694238, "body": "you might also consider <code>Range(&quot;&quot;).SpecialCells(xlCellTypeVisible)</code> to select only visible cells, but i&#39;m rather sure the previous method i mentioned will already work"}, {"owner": {"reputation": 53, "user_id": 7983092, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wBTnBjgRn4k/AAAAAAAAAAI/AAAAAAAAABo/P9Y5_y1iLwY/photo.jpg?sz=128", "display_name": "Joe Cross", "link": "https://stackoverflow.com/users/7983092/joe-cross"}, "edited": false, "score": 0, "creation_date": 1528928193, "post_id": 50842175, "comment_id": 88697590, "body": "I can post my code if you want, but I&#39;m not sure that gets you anything. I have working code that is very slow. I am trying to go in a different direction to speed things up, but I have this design problem in that I don&#39;t know if there is a way to do what I want.   From the picture I have above, I would like code which would allow me to select A1150:E1197, copy it over, and then do the same thing with F1150:L1197."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1529072623, "post_id": 50842175, "comment_id": 88757015, "body": "did you try my suggestions?"}, {"owner": {"reputation": 53, "user_id": 7983092, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wBTnBjgRn4k/AAAAAAAAAAI/AAAAAAAAABo/P9Y5_y1iLwY/photo.jpg?sz=128", "display_name": "Joe Cross", "link": "https://stackoverflow.com/users/7983092/joe-cross"}, "edited": false, "score": 0, "creation_date": 1529082115, "post_id": 50842175, "comment_id": 88761973, "body": "Marcucciboy2 I didn&#39;t think copy was what I was looking for, but it worked! Thanks! I will post an answer using your suggestion."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 7983092, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wBTnBjgRn4k/AAAAAAAAAAI/AAAAAAAAABo/P9Y5_y1iLwY/photo.jpg?sz=128", "display_name": "Joe Cross", "link": "https://stackoverflow.com/users/7983092/joe-cross"}, "is_accepted": true, "score": 0, "last_activity_date": 1529082494, "creation_date": 1529082494, "answer_id": 50880005, "question_id": 50842175, "link": "https://stackoverflow.com/questions/50842175/vba-select-visible-range-in-filtered-list-based-upon-selection-and-pre-determine/50880005#50880005", "title": "VBA Select visible range in filtered list based upon selection and pre-determined columns", "body": "<p>Thanks to Marcucciboy2 for the suggestion.</p>\n\n<p>Here is the code I used to copy the left block, then just different columns for the right block.</p>\n\n<pre><code>Private Function CopyBlocks()\nDim firstRow As Integer\nDim lastRow As Integer\n\nfirstRow = ActiveCell.row\nlastRow = ActiveCell.row + Selection.Rows.Count - 1\n\n'copy left block\nRange(\"A\" &amp; firstRow, \"E\" &amp; lastRow).SpecialCells(xlCellTypeVisible).Copy\n\n'Switch workbooks &amp; paste\n'copy right block\n'switch workbooks and paste\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7983092, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wBTnBjgRn4k/AAAAAAAAAAI/AAAAAAAAABo/P9Y5_y1iLwY/photo.jpg?sz=128", "display_name": "Joe Cross", "link": "https://stackoverflow.com/users/7983092/joe-cross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "accepted_answer_id": 50880005, "answer_count": 1, "score": 0, "last_activity_date": 1529082494, "creation_date": 1528907524, "question_id": 50842175, "link": "https://stackoverflow.com/questions/50842175/vba-select-visible-range-in-filtered-list-based-upon-selection-and-pre-determine", "title": "VBA Select visible range in filtered list based upon selection and pre-determined columns", "body": "<p>I assume there is a simple solution for this, but I have been unable to figure it out.</p>\n\n<p>I have a filtered list which I am trying to copy and paste the visible rows I have selected to another worksheet. I am pasting in two separate blocks, so I can't paste the whole row at a time. </p>\n\n<p><a href=\"https://i.stack.imgur.com/lYVIi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lYVIi.png\" alt=\"Example Table\"></a></p>\n\n<p>I am working with something like this. I have several rows selected, and I want to run this macro to copy A1150:E1197, grabbing only the visible rows, and then copy F1150:L1197. It would be best if it did not require E to be the column selected.</p>\n\n<p>My initial design used a for each loop. For each individual row, it copied the left block, switched to the other worksheet and pasted, rinse and repeat for the right block. It ended up being very slow, taking about 15 seconds for 10 rows or so. I believe switching between the workbooks was the major portion that slowed things down, so I am now trying to copy the left and right blocks each in one go.</p>\n\n<p>Appreciate any help!</p>\n"}, {"tags": ["html", "json", "vba"], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1528908028, "creation_date": 1528908028, "answer_id": 50842293, "question_id": 50842029, "link": "https://stackoverflow.com/questions/50842029/retrieving-the-text-between-the-div-with-vba/50842293#50842293", "title": "Retrieving the text between the &lt;div&gt; with VBA", "body": "<pre><code>Dim elaval as Variant\nelaval = Trim(Doc.getElementsByTagName(\"div\")(X).innerText)\nmsgbox elaval\n</code></pre>\n\n<p>Where X is the instance of your class <code>div</code></p>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "edited": false, "score": 0, "creation_date": 1528915011, "post_id": 50843088, "comment_id": 88691617, "body": "Its giving me a type mismatch error on &#39;Set eleval = objIE.Document.querySelector(&quot;.outputValue&quot;)&#39;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "edited": false, "score": 0, "creation_date": 1528915091, "post_id": 50843088, "comment_id": 88691651, "body": "Is eleval declared as Dim eleval As Object ?"}, {"owner": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "edited": false, "score": 0, "creation_date": 1528915405, "post_id": 50843088, "comment_id": 88691812, "body": "It is now, I had commented it out be mistake, but now it says &quot;Object Required&quot; error"}, {"owner": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "edited": false, "score": 1, "creation_date": 1528915579, "post_id": 50843088, "comment_id": 88691900, "body": "Wait, it works now, it turns out the subform on the page wasn&#39;t fully loaded, and my readystate checker couldn&#39;t check that, thanks!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1528911414, "last_edit_date": 1528911414, "creation_date": 1528911079, "answer_id": 50843088, "question_id": 50842029, "link": "https://stackoverflow.com/questions/50842029/retrieving-the-text-between-the-div-with-vba/50843088#50843088", "title": "Retrieving the text between the &lt;div&gt; with VBA", "body": "<p>With <code>.querySelector</code> method, make sure page if fully loaded before attempting.\nExample delays can be added with <code>Application.Wait Now + TimeSerial(h,m,s)</code></p>\n\n<pre><code>Set eleval = objIE.Document.querySelector(\"div[class=\"outputValue\"]\")\nDebug.Print eleval.innerText\n</code></pre>\n\n<p>If it is the first of its className on the page you could also use:</p>\n\n<pre><code>Set eleval = objIE.Document.querySelector(\".outputValue\")\n</code></pre>\n\n<p>If there is more than one and it is at a later index you can use</p>\n\n<pre><code>Set eleval = objIE.Document.querySelectorAll(\".outputValue\")\n</code></pre>\n\n<p>And then access items from the nodeList returned with </p>\n\n<pre><code>Debug.Print eleval.Item(0).innerText 'or replace 0 with the appropriate index.\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 50843088, "answer_count": 2, "score": 0, "last_activity_date": 1529299145, "creation_date": 1528907037, "last_edit_date": 1529299145, "question_id": 50842029, "link": "https://stackoverflow.com/questions/50842029/retrieving-the-text-between-the-div-with-vba", "title": "Retrieving the text between the &lt;div&gt; with VBA", "body": "<p>I am trying to get a text string from inside a div on a webpage, but I can't seem to figure out how it is stored in the element.</p>\n\n<pre><code>Set eleval = objIE.Document.getElementsByClassName(\"outputValue\")(0)\nDebug.Print (eleval.innerText)\n</code></pre>\n\n<p>I have tried this and variations thereof, but my string just reads as \"\".</p>\n\n<p>I mainly need help on how is this type of data is referenced in VBA.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"outputValue\"&gt;\"text data that I want\"&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Here is a screenshot of the page in question, I cannot give a link since it requires a company login to reach.</p>\n\n<p><img src=\"https://i.stack.imgur.com/rOGOB.png\" alt=\"Here is a screenshot\"></p>\n"}, {"tags": ["excel", "vba", "hide"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1528906732, "post_id": 50841748, "comment_id": 88687394, "body": "Are the sheet names in Column C?"}, {"owner": {"reputation": 13, "user_id": 9937019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c335457ba0230c8e16e43b5d43884496?s=128&d=identicon&r=PG&f=1", "display_name": "Buzzlastyear", "link": "https://stackoverflow.com/users/9937019/buzzlastyear"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1528906823, "post_id": 50841748, "comment_id": 88687449, "body": "Yes the sheet names are in column C"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9937019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c335457ba0230c8e16e43b5d43884496?s=128&d=identicon&r=PG&f=1", "display_name": "Buzzlastyear", "link": "https://stackoverflow.com/users/9937019/buzzlastyear"}, "edited": false, "score": 0, "creation_date": 1528907833, "post_id": 50842022, "comment_id": 88687962, "body": "This looks like what I&#39;m looking for but I&#39;m receiving the error &quot;Object doesn&#39;t support this property or method&quot; for the following line:      ThisWorkbook.Sheets(cel.Value).Hidden = True"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 13, "user_id": 9937019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c335457ba0230c8e16e43b5d43884496?s=128&d=identicon&r=PG&f=1", "display_name": "Buzzlastyear", "link": "https://stackoverflow.com/users/9937019/buzzlastyear"}, "edited": false, "score": 0, "creation_date": 1528907966, "post_id": 50842022, "comment_id": 88688024, "body": "@Buzzlastyear <code>.Hidden</code>?? Also, do you want a standalone <code>Sub</code> or do you want to use the <code>Worksheet_Change</code> event?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 9937019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c335457ba0230c8e16e43b5d43884496?s=128&d=identicon&r=PG&f=1", "display_name": "Buzzlastyear", "link": "https://stackoverflow.com/users/9937019/buzzlastyear"}, "edited": false, "score": 0, "creation_date": 1528908407, "post_id": 50842022, "comment_id": 88688248, "body": "@Buzzlastyear - See my edit, that should be <code>.Visible</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1528909313, "post_id": 50842022, "comment_id": 88688716, "body": "@BigBen - Bah, I didn&#39;t catch the <code>Worksheet Change</code>"}, {"owner": {"reputation": 13, "user_id": 9937019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c335457ba0230c8e16e43b5d43884496?s=128&d=identicon&r=PG&f=1", "display_name": "Buzzlastyear", "link": "https://stackoverflow.com/users/9937019/buzzlastyear"}, "edited": false, "score": 0, "creation_date": 1528909661, "post_id": 50842022, "comment_id": 88688921, "body": "@BruceWayne Great that works! Standalone sub should suffice! Thanks for your help"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1528907018, "creation_date": 1528907018, "answer_id": 50842022, "question_id": 50841748, "link": "https://stackoverflow.com/questions/50841748/hide-multiple-sheets-if-value-in-column-is-no-50columns-sheets-using-loop/50842022#50842022", "title": "Hide Multiple Sheets if Value in Column is No (50+Columns/Sheets) Using Loop", "body": "<p>If your data is set up with the sheet name next to column D (or anywhere really, just adjust the script), you can just loop through.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1agP0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1agP0.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub hide_Sheets()\nDim mainWS As Worksheet\nDim rng As Range\n\nSet mainWS = ThisWorkbook.Sheets(\"Sheet1\")\nSet rng = mainWS.Range(\"C2:C5\") ' Change range as needed\n\nDim cel As Range\nFor Each cel In rng\n    If cel.Offset(0, 1).Value = \"Yes\" Then\n        ThisWorkbook.Sheets(cel.Value).Visible = True\n    Else\n        ThisWorkbook.Sheets(cel.Value).Visible = False\n    End If\nNext cel\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1528909023, "creation_date": 1528909023, "answer_id": 50842550, "question_id": 50841748, "link": "https://stackoverflow.com/questions/50841748/hide-multiple-sheets-if-value-in-column-is-no-50columns-sheets-using-loop/50842550#50842550", "title": "Hide Multiple Sheets if Value in Column is No (50+Columns/Sheets) Using Loop", "body": "<p>Using the <code>Worksheet_Change</code> event you started out with:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range\n    Set rng = Range(Range(\"D2\"), Range(\"D2\").End(xlDown))\n\n    If Not Intersect(Target, rng) Is Nothing Then\n        If Target.Count = 1 Then\n            On Error GoTo ErrorHandler\n            If Target = \"Yes\" Then\n                Sheets(Target.Offset(, -1).Value).Visible = True\n            Else\n                Sheets(Target.Offset(, -1).Value).Visible = False\n            End If\n        End If\n    End If\n\n    Exit Sub\n\nErrorHandler:\n    MsgBox \"The sheet '\" &amp; Target.Offset(, -1) &amp; \"' does not exist!\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9937019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c335457ba0230c8e16e43b5d43884496?s=128&d=identicon&r=PG&f=1", "display_name": "Buzzlastyear", "link": "https://stackoverflow.com/users/9937019/buzzlastyear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 50842550, "answer_count": 2, "score": 1, "last_activity_date": 1528909023, "creation_date": 1528906113, "question_id": 50841748, "link": "https://stackoverflow.com/questions/50841748/hide-multiple-sheets-if-value-in-column-is-no-50columns-sheets-using-loop", "title": "Hide Multiple Sheets if Value in Column is No (50+Columns/Sheets) Using Loop", "body": "<p>I have a master sheet (Sheet 1) that contains 50+ rows of specific items. I have a sheet corresponding to each item and named as such (ie. item 1 = \"Clearing\" so sheet 2 is named \"Clearing\"). I have a drop down menu for each item in Column D that displays \"Yes\" or \"No\". </p>\n\n<p>I currently have a basic code that hides Sheets based on if my \"Column D\" drop down menus for 50+ rows = \"No\" (ie. Item 1 marked as \"No\" so sheet 2 is hidden).</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf [D2] = \"Yes\" Then\n    Sheets(\"Clearing\").Visible = True\nElse\n    Sheets(\"Clearing\").Visible = False\nEnd If\n\nIf [D3] = \"Yes\" Then\n    Sheets(\"Grubbing\").Visible = True\nElse\n    Sheets(\"Grubbing\").Visible = False\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I want to be able to run this in a loop for all 50+ items by using a range of cells D2:D50+ without having to enter in each sheet name as I've done above. I haven't been able to figure out how to manage this by looking at other's examples.</p>\n\n<p>Any help is much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1528906932, "post_id": 50841848, "comment_id": 88687507, "body": "What is <code>FileIdx</code>?"}, {"owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1528907198, "post_id": 50841848, "comment_id": 88687668, "body": "@GMalc that has to be a typo, He&#39;s trying to get the Next FileCount.  I have a pending edit"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1528907332, "post_id": 50841848, "comment_id": 88687733, "body": "Updated and should work as expected (just now tested)"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1528907379, "last_edit_date": 1528907379, "creation_date": 1528906446, "answer_id": 50841848, "question_id": 50841673, "link": "https://stackoverflow.com/questions/50841673/rename-the-only-worksheet-in-multiple-workbooks-in-a-chosen-directory/50841848#50841848", "title": "Rename the only worksheet in multiple workbooks in a chosen directory", "body": "<ol>\n<li>Open File Dialog (Pick which books to modify)</li>\n<li>Change sheet name to wbName (your code here)</li>\n<li>Close File (Save)</li>\n<li>Repeat 2 - 3 for all selected books</li>\n</ol>\n\n<p>This will need modification if there is more than 1 sheet on any of the workbooks selected. IF there is only one sheet, <code>ActiveSheet</code> will suffice. </p>\n\n<pre><code>    Sub RenameSheet()\n\n    Dim CurrentBook As Workbook\n    Dim ImportFiles As FileDialog\n    Dim FileCount As Long 'Count of workbooks selected\n    Dim wbName As String\n\n    'Open File Picker\n    Set ImportFiles = Application.FileDialog(msoFileDialogOpen)\n    With ImportFiles\n        .AllowMultiSelect = True\n        .Title = \"Pick Files to Adjust\"\n        .ButtonName = \"\"\n        .Filters.Clear\n        .Filters.Add \".xlsx files\", \"*.xlsx\"\n        .Show\n    End With\n\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n\n    'Cycle through books\n    For FileCount = 1 To ImportFiles.SelectedItems.Count\n        Set CurrentBook = Workbooks.Open(ImportFiles.SelectedItems(FileCount))\n            wbName = Replace(CurrentBook.Name, \".xlsx\", \"\")\n            CurrentBook.Activate\n            ActiveSheet.Name = wbName\n            CurrentBook.Close True\n    Next FileCount\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528907884, "post_id": 50842203, "comment_id": 88687991, "body": "I made an edit to mine. I had <code>DisplayAlerts</code> on twice. One needs to be <code>ScreenUpdating</code> which will make this run faster."}, {"owner": {"reputation": 3, "user_id": 9936890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bb0fd8d1db24f9251f8aa0b71e89b4?s=128&d=identicon&r=PG", "display_name": "Heath Orr", "link": "https://stackoverflow.com/users/9936890/heath-orr"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528908380, "post_id": 50842203, "comment_id": 88688236, "body": "Thank you again urdearboy.  I have adjusted with your changes."}], "tags": [], "owner": {"reputation": 3, "user_id": 9936890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bb0fd8d1db24f9251f8aa0b71e89b4?s=128&d=identicon&r=PG", "display_name": "Heath Orr", "link": "https://stackoverflow.com/users/9936890/heath-orr"}, "is_accepted": false, "score": 0, "last_activity_date": 1528907660, "creation_date": 1528907660, "answer_id": 50842203, "question_id": 50841673, "link": "https://stackoverflow.com/questions/50841673/rename-the-only-worksheet-in-multiple-workbooks-in-a-chosen-directory/50842203#50842203", "title": "Rename the only worksheet in multiple workbooks in a chosen directory", "body": "<p>I had to tweak a couple of lines but this works beautifully.  Thank you urdearboy.</p>\n\n<pre><code>    Sub RenameSheet()\n\nDim CurrentBook As Workbook\nDim ImportFiles As FileDialog\nDim FileCount As Long 'Count of workbooks selected\nDim wbName As String\n\n'Open File Picker\nSet ImportFiles = Application.FileDialog(msoFileDialogOpen)\nWith ImportFiles\n    .AllowMultiSelect = True\n    .Title = \"Pick Files to Adjust\"\n    .ButtonName = \"\"\n    .Filters.Clear\n    .Filters.Add \".xlsx files\", \"*.xlsx\"\n    .Show\nEnd With\n\nApplication.DisplayAlerts = False\nApplication.DisplayAlerts = False\n\n'Cycle through books\nFor FileCount = 1 To ImportFiles.SelectedItems.Count\n    Set CurrentBook = Workbooks.Open(ImportFiles.SelectedItems(FileCount))\n        wbName = Replace(CurrentBook.Name, \".xlsx\", \"\") ' had to rework this line to the original\n        CurrentBook.Activate\n        ActiveSheet.Name = wbName\n        CurrentBook.Close True\nNext FileCount ' had to change this to FileCount to remove the error \"invalid next control variable\"\n\nApplication.DisplayAlerts = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9936890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bb0fd8d1db24f9251f8aa0b71e89b4?s=128&d=identicon&r=PG", "display_name": "Heath Orr", "link": "https://stackoverflow.com/users/9936890/heath-orr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1283, "favorite_count": 0, "accepted_answer_id": 50841848, "answer_count": 2, "score": 0, "last_activity_date": 1528907660, "creation_date": 1528905834, "question_id": 50841673, "link": "https://stackoverflow.com/questions/50841673/rename-the-only-worksheet-in-multiple-workbooks-in-a-chosen-directory", "title": "Rename the only worksheet in multiple workbooks in a chosen directory", "body": "<p>I am at my wits end and have come to you for your help.</p>\n\n<p>What I am trying to accomplish is to rename a single worksheet (the only worksheet), in multiple workbooks, in a chosen directory to the workbook file name in Excel.</p>\n\n<p>I have found code that will work within a single workbook, however I do not know how to get it to work on multiple workbooks in a directory chosen by the user or ran from a batch/vbs file in the same directory.</p>\n\n<p>Here is the code I was using on a single workbook:</p>\n\n<pre><code>Sub RenameSheet()\nDim wbname\nwbname = Replace(ActiveWorkbook.Name, \".xlsx\", \"\")\n    ActiveSheet.Select\n    ActiveSheet.Name = wbname\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>I want to be able to do this for all files in a folder chosen by the user or files in the same directory as a batch file/vbs executable file if there is a way to execute this from running either a batch or vbs file?</p>\n\n<p>If there are questions or I have missing something, please let me know and I will answer to the best of my ability.</p>\n\n<p>Any help will be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1528915189, "post_id": 50841586, "comment_id": 88691709, "body": "SUMIFS() does not work for you?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1528915204, "post_id": 50841586, "comment_id": 88691714, "body": "Or a Pivot Table?"}], "owner": {"reputation": 1, "user_id": 9926947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s0Gr6nJ8MkQ/AAAAAAAAAAI/AAAAAAAAAAA/dxbf8CtEwo4/photo.jpg?sz=128", "display_name": "Matt Heise", "link": "https://stackoverflow.com/users/9926947/matt-heise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528905568, "creation_date": 1528905568, "last_edit_date": 1531164843, "question_id": 50841586, "link": "https://stackoverflow.com/questions/50841586/combine-and-sum-based-on-multpile-criteria", "title": "Combine and Sum Based on Multpile Criteria", "body": "<p>I have a data set with 3 columns A, B, C. A and B and labels (product type and city, for example) with column C as numerical data.</p>\n\n<p>I have used the following to combine and sum either A or B for C:</p>\n\n<pre><code>Sub combineandsum1()\n'Update 20130829\nDim WorkRng As Range\nDim Dic As Variant\nDim arr As Variant\nOn Error Resume Next\nxTitleId = \"KutoolsforExcel\"\nSet WorkRng = Application.Selection\nSet WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\nSet Dic = CreateObject(\"Scripting.Dictionary\")\narr = WorkRng.Value\nFor i = 1 To UBound(arr, 1)\n    Dic(arr(i, 1)) = Dic(arr(i, 1)) + arr(i, 2)\nNext\nApplication.ScreenUpdating = False\nWorkRng.ClearContents\nWorkRng.Range(\"A1\").Resize(Dic.Count, 1) = Application.WorksheetFunction.Transpose(Dic.keys)\nWorkRng.Range(\"B1\").Resize(Dic.Count, 1) = Application.WorksheetFunction.Transpose(Dic.items)\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>But that only works for a single criteria. How can I alter this macro so it reads:</p>\n\n<p>If A is a duplicate in column A AND B is a duplicate in column B, then combine and sum C.</p>\n\n<p>Having a real brainfart here, could use the help. Thanks!</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528909245, "post_id": 50841552, "comment_id": 88688681, "body": "check out the <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-send-event-outlook\" rel=\"nofollow noreferrer\">MailItem.Send</a> event. You can then set your alarm to only be created when an email is sent"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1528926661, "post_id": 50841552, "comment_id": 88697111, "body": "You could move the reminder code into Outlook in an ItemAdd event for the SentItems folder <a href=\"https://stackoverflow.com/questions/11263483/how-do-i-trigger-a-macro-to-run-after-a-new-mail-is-received-in-outlook\" title=\"how do i trigger a macro to run after a new mail is received in outlook\">stackoverflow.com/questions/11263483/&hellip;</a>.  I suggest you could set up a specific subject, text, userproperty to indicate the email to be processed. You could try to keep all the code in Excel like this <a href=\"https://stackoverflow.com/questions/28610291/how-to-trap-outlook-events-from-excel-application\" title=\"how to trap outlook events from excel application\">stackoverflow.com/questions/28610291/&hellip;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1529210966, "creation_date": 1529210966, "answer_id": 50893795, "question_id": 50841552, "link": "https://stackoverflow.com/questions/50841552/set-reminder-after-e-mail-is-sent/50893795#50893795", "title": "Set Reminder after e-mail is sent", "body": "<p>First of all, there is no need to create a new Outlook Application instance in each method.</p>\n\n<p>Ideally, you could hook up the <code>ItemAdd</code> event on the <code>Sent Items</code> folder in Outlook. But items may be deleted after sending without being saved to the <code>Sent Items</code> folder. The <a href=\"https://msdn.microsoft.com/en-us/VBA/outlook-vba/articles/mailitem-deleteaftersubmit-property-outlook?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vbaol11.chm1333)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv16)%26rd%3Dtrue%26f%3D255%26MSPPError%3D-2147217396\" rel=\"nofollow noreferrer\">DeleteAfterSubmit</a> property allows to set a Boolean value that is True if a copy of the mail message is not saved upon being sent, and False if a copy is saved in Sent Items folder.</p>\n\n<p>So, I'd suggest handling the <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/application-itemsend-event-outlook\" rel=\"nofollow noreferrer\">ItemSend</a> event of the Application class which is fired whenever an Microsoft Outlook item is sent, either by the user through an Inspector (before the inspector is closed, but after the user clicks the Send button) or when the Send method for an Outlook item, such as MailItem , is used in a program. In the event handler you will get access to the item being sent and can create a new task for it.</p>\n"}], "owner": {"reputation": 1, "user_id": 9936829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25c8d55a3d6faaf92257cfbed8e2df6b?s=128&d=identicon&r=PG&f=1", "display_name": "Petrulli", "link": "https://stackoverflow.com/users/9936829/petrulli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529210966, "creation_date": 1528905451, "last_edit_date": 1528931233, "question_id": 50841552, "link": "https://stackoverflow.com/questions/50841552/set-reminder-after-e-mail-is-sent", "title": "Set Reminder after e-mail is sent", "body": "<p>Is there a way to set a reminder <strong>after</strong> sending e-mail?</p>\n\n<p>I have VBA code that creates an e-mail and sets a reminder.</p>\n\n<pre><code>Sub RendaFixaAplica\u00e7\u00e3o()\n\nDim texto As String\n\nDim OutApp As Object\nDim OutMail As Object\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\ntexto = Range(\"J2\").Value &amp; \",insert some text here\"\n\nWith OutMail\n    .Display\n    .to = Range(\"J3\").Value\n    .CC = Range(\"J4\").Value\n    .Subject = \"Insert a subject here \" &amp; Range(\"E2\").Value\n    .HTMLBody = texto &amp; .HTMLBody\nEnd With\nOn Error GoTo 0\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nCall alerta1\n\nEnd Sub\n</code></pre>\n\n<p>The reminder is made with the \"Call alerta1\" at the end of the code and is programmed like this:</p>\n\n<pre><code>Sub alerta1()\nDim objOutlookApp As Outlook.Application\nDim objTask As Outlook.TaskItem\nDim hora As String\nDim wd As WorksheetFunction\nSet wd = Application.WorksheetFunction\nDim diautil As Date\ndiautil = wd.WorkDay(Date, 1)\n\nIf Time &gt; \"15:00:00\" Then\n    hora = diautil &amp; \" 14:00:00\"\nElse\n    If Time &lt; \"14:00:00\" Then\n        hora = Date &amp; \" 14:00:00\"\n    Else\n        hora = Date &amp; \" 14:45:00\"\n    End If\nEnd If\n\nSet objOutlookApp = CreateObject(\"Outlook.Application\")\nSet objTask = objOutlookApp.CreateItem(olTaskItem)\nobjTask.Subject = \"Insert a Subject Here - \" &amp; Range(\"E2\").Value\nobjTask.Display\n\nobjTask.body = \"Cliente: \" &amp; Range(\"K2\").Value &amp; vbNewLine &amp; \"Email cliente: \" &amp; Range(\"J3\").Value\nobjTask.ReminderSet = True\nobjTask.ReminderTime = hora\nobjTask.DueDate = hora\nobjTask.Close (olSave)\n\nEnd Sub\n</code></pre>\n\n<p>It sets the reminder whether I send the e-mail or not.</p>\n\n<p>I can't use .Send on the e-mail because there needs to be some editing in the e-mail.</p>\n\n<p>Is there a way to make Excel wait for the e-mail to be sent then run the \"alerta1\"?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528905309, "post_id": 50841377, "comment_id": 88686550, "body": "Could you show some data? You want to reference the last row in sheet 2 or sheet 1? Where are the formulas going? You can get last row with .Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row but are you sure you want a fixed number? Would be helpful to see data and expected result."}, {"owner": {"reputation": 13, "user_id": 9937006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1742342182515116/picture?type=large", "display_name": "Ryan Rea", "link": "https://stackoverflow.com/users/9937006/ryan-rea"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1529151728, "post_id": 50841377, "comment_id": 88777071, "body": "So sorry, ok on sheet 1 cell B12 should have the data which is linked to sheet 2 on column h, i designed my macro to automatically sum all the numbers on column h..so the last row would contain the sum formula...i want to link the cell formula to sheet 1 cell B12..the problem is row numbers varies..how do i do this so sorry i dont really speak codes :("}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1529151842, "post_id": 50841377, "comment_id": 88777098, "body": "you want B12 sheet 1 to link to the last populate cell in column H?"}, {"owner": {"reputation": 13, "user_id": 9937006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1742342182515116/picture?type=large", "display_name": "Ryan Rea", "link": "https://stackoverflow.com/users/9937006/ryan-rea"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1529155645, "post_id": 50841377, "comment_id": 88777952, "body": "yes thats corect"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1529155673, "post_id": 50841377, "comment_id": 88777961, "body": "See my answer below."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9937006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1742342182515116/picture?type=large", "display_name": "Ryan Rea", "link": "https://stackoverflow.com/users/9937006/ryan-rea"}, "edited": false, "score": 0, "creation_date": 1529151772, "post_id": 50841477, "comment_id": 88777081, "body": "thnak you for the information please take alook at my comment up,"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1528905239, "creation_date": 1528905239, "answer_id": 50841477, "question_id": 50841377, "link": "https://stackoverflow.com/questions/50841377/formular1c1-dynamic-reference/50841477#50841477", "title": "FormulaR1C1 Dynamic Reference", "body": "<p>Pass the number of rows as a variable like this one:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim numberOfRows As Long\n\n    numberOfRows = -12        \n    ActiveCell.FormulaR1C1 = \"=Sheet2!R[\" &amp; numberOfRows &amp; \"]C\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9937006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1742342182515116/picture?type=large", "display_name": "Ryan Rea", "link": "https://stackoverflow.com/users/9937006/ryan-rea"}, "edited": false, "score": 0, "creation_date": 1529155838, "post_id": 50887932, "comment_id": 88777994, "body": "wow!!! it worked!!! thank you so much!!!, can you explain to me  this? &quot;=Sheet2!&quot; &amp; .Range(&quot;H&quot; &amp; .Cells(.Rows.count, &quot;H&quot;).End(xlUp).Row).Address"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1529155949, "last_edit_date": 1529155949, "creation_date": 1529152286, "answer_id": 50887932, "question_id": 50841377, "link": "https://stackoverflow.com/questions/50841377/formular1c1-dynamic-reference/50887932#50887932", "title": "FormulaR1C1 Dynamic Reference", "body": "<p>Like this?</p>\n\n<pre><code>Option Explicit\nPublic Sub TEST()\n    With Worksheets(\"Sheet2\")\n        Worksheets(\"Sheet1\").Range(\"B12\").Formula = \"=Sheet2!\" &amp; .Range(\"H\" &amp; .Cells(.Rows.count, \"H\").End(xlUp).Row).Address\n    End With\nEnd Sub\n</code></pre>\n\n<p>Sheet2! is to make sure the formula references sheet2 when applied in the cell.</p>\n\n<p>Then</p>\n\n<pre><code>.Range(\"H\" &amp; .Cells(.Rows.count, \"H\").End(xlUp).Row\n</code></pre>\n\n<p>finds the last row in column H of sheet 2 by coming up from the bottom of the sheet.</p>\n"}], "owner": {"reputation": 13, "user_id": 9937006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1742342182515116/picture?type=large", "display_name": "Ryan Rea", "link": "https://stackoverflow.com/users/9937006/ryan-rea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1457, "favorite_count": 0, "accepted_answer_id": 50887932, "answer_count": 2, "score": 1, "last_activity_date": 1529155949, "creation_date": 1528904942, "last_edit_date": 1528910742, "question_id": 50841377, "link": "https://stackoverflow.com/questions/50841377/formular1c1-dynamic-reference", "title": "FormulaR1C1 Dynamic Reference", "body": "<p>I'm having a problem referencing data from Sheet 2 back to Sheet 1 (which is a summary tab).</p>\n\n<p>I want to reference the last row of column A which contains the summation back to cell A1 of Sheet 1, but the problem is that the number of rows differ (as this is dynamic) on every report.</p>\n\n<p>How can i make the following formula dynamic?</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=Sheet2!R[-23]C\"\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1528906130, "post_id": 50841032, "comment_id": 88687019, "body": "Please share the code as you&#39;re using it. In the top part, you&#39;re constructing <code>strSql</code>, but then passing only <code>strWhere</code> to the <code>CreateQueryDef</code>, and are making some more errors, and the bottom part is even more unclear to me."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1528906219, "creation_date": 1528906219, "answer_id": 50841789, "question_id": 50841032, "link": "https://stackoverflow.com/questions/50841032/creating-a-query-from-sql-where-condition/50841789#50841789", "title": "Creating A Query From SQL Where Condition", "body": "<p>A WHERE clause doesn't make a query. You need the SELECT part too.</p>\n\n<p>e.g.</p>\n\n<pre><code>strNewSql = \"SELECT * FROM otherEvents \" &amp; strWhere\nSet qdf = CurrentDb.CreateQueryDef(\"qryEvents_Search\", strNewSql)\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 2075222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b452d8cc797d2e6606429136274e1cd5?s=128&d=identicon&r=PG", "display_name": "Joseph Bupe", "link": "https://stackoverflow.com/users/2075222/joseph-bupe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 50841789, "answer_count": 1, "score": 2, "last_activity_date": 1528947842, "creation_date": 1528903759, "last_edit_date": 1528947842, "question_id": 50841032, "link": "https://stackoverflow.com/questions/50841032/creating-a-query-from-sql-where-condition", "title": "Creating A Query From SQL Where Condition", "body": "<p>I want to create a a query based on the Where condition from the previous statement in the same form, but the query is not being created when i run the button.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Dim qdf As QueryDef\n\nstrSql = \"SELECT * FROM qryEvents WHERE strWhere\"\n\n'Delete the query if it already exists\nDoCmd.DeleteObject acQuery, \"qryEvents_Search\"\n\nSet qdf = CurrentDb.CreateQueryDef(\"qryEvents_Search\", strWhere)\nDoCmd.OpenQuery \"qryEvents_Search\"\n\n'release memory\nqdf.Close\nSet qdf = Nothing\n</code></pre>\n\n<p>The Where condition part is:</p>\n\n<pre><code>If Len(strWhere) &gt; 0 Then\nIf Nz(DCount(\"*\", \"qryEvents\", Left(strWhere, Len(strWhere) - 0)), 0) &gt; 0 Then\nstrWhere = \"WHERE \" &amp; Left(strWhere, Len(strWhere) - 0)\nstrSQL = \"SELECT * FROM qryEvents \" &amp; strWhere &amp; \";\"\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1528903447, "post_id": 50840870, "comment_id": 88685451, "body": "Sorry, not an answer to your question but you really need to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1528903544, "post_id": 50840870, "comment_id": 88685519, "body": "What is <code>LastRow0</code>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1528903660, "post_id": 50840870, "comment_id": 88685586, "body": "Also see <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">this</a> for detail on how to properly find the &quot;last&quot; row or column in a sheet/range."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1528903863, "post_id": 50840870, "comment_id": 88685716, "body": "One thing you should do is this: <code>Debug.Print</code> the string value you&#39;re trying to assign to the formula. Then enter that value manually in to the cell and see what happens. Your formula must be wrong and cannot be evaluated as such, but without seeing the resulting formula, it&#39;s hard to provide further assistance."}, {"owner": {"reputation": 11, "user_id": 9936717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfddb7174a132f20def6e426026f9f42?s=128&d=identicon&r=PG&f=1", "display_name": "Enigma", "link": "https://stackoverflow.com/users/9936717/enigma"}, "edited": false, "score": 0, "creation_date": 1528904299, "post_id": 50840870, "comment_id": 88685980, "body": "SJR - I don&#39;t know why it&#39;s &quot;lastrow0&quot; , I just tried to implement a solution that apparently worked for someone else having this issue."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1528904515, "post_id": 50840870, "comment_id": 88686100, "body": "Please, please, please read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> then modify your recorded code and dozens of experts will fight over the right to assist you;"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1528904861, "post_id": 50840870, "comment_id": 88686291, "body": "Well it will error if you use a variable in your code but haven&#39;t defined it in this context. As you haven&#39;t included it in your posted code, it&#39;s hard to know how it should be used. There is plenty online about how to define the last used row."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528904960, "post_id": 50840870, "comment_id": 88686360, "body": "Or refer to David Zemens&#39;s comment, which I missed."}, {"owner": {"reputation": 11, "user_id": 9936717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfddb7174a132f20def6e426026f9f42?s=128&d=identicon&r=PG&f=1", "display_name": "Enigma", "link": "https://stackoverflow.com/users/9936717/enigma"}, "edited": false, "score": 0, "creation_date": 1528905132, "post_id": 50840870, "comment_id": 88686448, "body": "Thanks David Zemens. No one is more noob than me at this - I&#39;m a market researcher and have never made a macro before...  I did try to tweak it by manually entering the number of rows but something is still wrong. No error, but it&#39;s not taking the full set into account."}], "owner": {"reputation": 11, "user_id": 9936717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfddb7174a132f20def6e426026f9f42?s=128&d=identicon&r=PG&f=1", "display_name": "Enigma", "link": "https://stackoverflow.com/users/9936717/enigma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1528903601, "creation_date": 1528903280, "last_edit_date": 1531161705, "question_id": 50840870, "link": "https://stackoverflow.com/questions/50840870/excel-vba-vlookup-for-a-variable-number-of-rows-within-a-macro", "title": "Excel VBA - vlookup for a variable number of rows within a macro", "body": "<p>I've created a macro to organize a data set and compile into another sheet in a way that makes more sense for doing analyses. The set originally is comprised of columns for user, timestamp and 3 possible events. The user could appear on multiple rows but I wanted to look at this data set by user and have a separate column for each timestamp. The macros I've made can successfully clean, filter by event type, and separate by event type into separate worksheets (no matter how many rows of data) but <strong>I'm having trouble with compiling data into one sheet using vlookup AND accounting for a variable number of rows.</strong> I have looked at other answers to this question and tried this:</p>\n\n<p>ActiveCell.FormulaR1C1 = \"=VLOOKUP(RC[-2],'Email Opened'!R1C1:R\" &amp; LastRow0 &amp; \"C3,2,FALSE)\"</p>\n\n<p>... but it keeps giving me errors.</p>\n\n<p>What I have below (Vlookup_events2) works but just not for the entire variable number of rows.<strong>Please help me adjust the code for the vlookup so it will work no matter how many rows.</strong> </p>\n\n<p>Here is the code below for separating data (just for reference), then the problem macro - compiling it with vlookup. I would really appreciate some help, I know there's an amazing VBA expert out there!</p>\n\n<pre><code>    Sheets.Add\n    Sheets(\"Sheet1\").Name = \"Email Sent\"\n    ActiveSheet.Next.Select\n    Selection.AutoFilter\n    ActiveCell.Offset(0, 2).Range(\"A1\").Select\n    ActiveSheet.Range(\"$A$1:$D$1000000\").AutoFilter Field:=3, Criteria1:= _\n        \"=Campaign Created\", Operator:=xlOr, Criteria2:=\"=Email Sent\"\n    ActiveCell.Offset(0, -2).Range(\"A1:D2355\").Select\n    ActiveCell.Activate\n    Selection.Copy\n    ActiveSheet.Previous.Select\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n    ActiveSheet.Next.Select\n    Range(\"A1\").Select\n    ActiveSheet.Range(\"$A$1:$D$1000000\").AutoFilter Field:=3, Criteria1:= _\n        \"=Campaign Created\", Operator:=xlOr, Criteria2:=\"=Email Opened\"\n    Sheets.Add\n    Sheets(\"Sheet2\").Name = \"Email Opened\"\n    ActiveSheet.Next.Select\n    ActiveCell.Range(\"A1:D1000000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    ActiveSheet.Previous.Select\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n    ActiveCell.Offset(0, 3).Range(\"A1\").Select\n    Application.CutCopyMode = False\n    Selection.ClearContents\n    ActiveCell.Columns(\"A:A\").EntireColumn.Select\n    Selection.Delete Shift:=xlToLeft\n    Sheets.Add\n    Sheets(\"Sheet3\").Name = \"Clicked Link\"\n    ActiveSheet.Next.Select\n    ActiveSheet.Next.Select\n    ActiveCell.Offset(0, 2).Range(\"A1\").Select\n    ActiveSheet.Range(\"$A$1:$D$1000000\").AutoFilter Field:=3, Criteria1:= _\n        \"=Campaign Created\", Operator:=xlOr, Criteria2:=\"=Clicked Link\"\n    ActiveCell.Offset(0, -2).Range(\"A1:D1000000\").Select\n    ActiveCell.Activate\n    Selection.Copy\n    ActiveSheet.Previous.Select\n    ActiveSheet.Previous.Select\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n    ActiveCell.Offset(0, 3).Columns(\"A:A\").EntireColumn.Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlToLeft\n    Range(\"A1\").Select\nEnd Sub\nSub Vlookup_events2()\n' Vlookup_events2 Macro\n\n    ActiveSheet.Previous.Select\n    Range(\"A2\").Select\n    ActiveCell.FormulaR1C1 = \"user\"\n    Range(\"A3\").Select\n    ActiveSheet.Next.Select\n    Range(\"A2\").Select\n    ActiveCell.FormulaR1C1 = \"user\"\n    Range(\"A3\").Select\n    ActiveSheet.Next.Select\n    Range(\"A2\").Select\n    ActiveCell.FormulaR1C1 = \"user\"\n    Range(\"A3\").Select\n    Sheets.Add\n    Sheets(\"Sheet4\").Name = \"Compiled Events\"\n    ActiveSheet.Previous.Select\n    ActiveSheet.Previous.Select\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    ActiveSheet.Next.Select\n    ActiveSheet.Next.Select\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n    Columns(\"C:D\").Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlToLeft\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"Email Sent Time\"\n    Range(\"C1\").Select\n    ActiveCell.FormulaR1C1 = \"Email Opened Time\"\n    Range(\"D1\").Select\n    ActiveCell.FormulaR1C1 = \"Clicked Link Time\"\n    Range(\"A1\").Select\n    Application.Goto Reference:=\"R2C3\"\n    ActiveCell.FormulaR1C1 = \"=VLOOKUP(RC[-2],'Email Opened'!R1C1:R601C3,2,FALSE)\"\n    Range(\"C3\").Select\n    Range(Selection, Selection.End(xlUp)).Select\n    Columns(\"C:C\").Select\n    Selection.FormulaR1C1 = \"=VLOOKUP(RC[-2],'Email Opened'!R1C1:R601C3,2,FALSE)\"\n    Columns(\"D:D\").Select\n    Selection.FormulaR1C1 = \"=VLOOKUP(RC[-3],'Clicked Link'!R1C1:R56C3,2,FALSE)\"\n    Columns(\"C:C\").Select\n    Selection.NumberFormat = \"m/d/yyyy h:mm\"\n    Columns(\"D:D\").Select\n    Selection.NumberFormat = \"m/d/yyyy h:mm\"\n    Range(\"C1\").Select\n    ActiveCell.FormulaR1C1 = \"Email Opened Time\"\n    Range(\"D1\").Select\n    ActiveCell.FormulaR1C1 = \"Clicked Link Time\"\n    Range(\"C2\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 5, "creation_date": 1528903383, "post_id": 50840843, "comment_id": 88685409, "body": "&quot;Exponentially decreasing&quot;?! What does this mean? Looks ok to me, though you should post all relevant code so we know what&#39;s going on."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528904084, "post_id": 50840843, "comment_id": 88685839, "body": "What&#39;s the value of lastCol?"}, {"owner": {"reputation": 45, "user_id": 9898425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d0c06aa994ddf59b921919ffac96102?s=128&d=identicon&r=PG&f=1", "display_name": "Aysee", "link": "https://stackoverflow.com/users/9898425/aysee"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528904341, "post_id": 50840843, "comment_id": 88686007, "body": "it&#39;s just the number of the last column (7)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528904738, "post_id": 50840843, "comment_id": 88686215, "body": "I can&#39;t replicate the example in your pics. Anyway, have you tried Jeeped&#39;s answer."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528905209, "post_id": 50841055, "comment_id": 88686488, "body": "Not sure if the OP&#39;s use of colour in the pics is significant, but if it is, the colour of the last column will not be duplicated."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1528903854, "creation_date": 1528903854, "answer_id": 50841055, "question_id": 50840843, "link": "https://stackoverflow.com/questions/50840843/inserting-alternating-columns/50841055#50841055", "title": "Inserting Alternating Columns", "body": "<p>Try,</p>\n\n<pre><code>Dim iCol As long, lCol as long\n\nwith ThisWorkbook.Worksheets(\"Sheet4\")\n    lcol = .cells(1, .columns.count).end(xltoleft).column\n\n    For iCol = lcol to 3 Step -1\n        .Columns(iCol).Insert\n    Next\nend with\n</code></pre>\n\n<p>There has to be something in row 1 for .end(xltoleft) to 'catch'.</p>\n"}], "owner": {"reputation": 45, "user_id": 9898425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d0c06aa994ddf59b921919ffac96102?s=128&d=identicon&r=PG&f=1", "display_name": "Aysee", "link": "https://stackoverflow.com/users/9898425/aysee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 50841055, "answer_count": 1, "score": -1, "last_activity_date": 1528903854, "creation_date": 1528903211, "last_edit_date": 1528903686, "question_id": 50840843, "link": "https://stackoverflow.com/questions/50840843/inserting-alternating-columns", "title": "Inserting Alternating Columns", "body": "<p>I'm trying to add blank columns in between columns with information in them, but I'm confused as to why my code adds exponentially decreasing amounts of columns starting with the second column.</p>\n\n<pre><code>Dim iCol As Integer\n\nFor iCol = lastCol + 2 To 3 Step -1\n    ThisWorkbook.Worksheets(\"Sheet4\").Columns(iCol).Insert\nNext\n</code></pre>\n\n<p>What I start with:\n<a href=\"https://i.stack.imgur.com/UsOsW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UsOsW.png\" alt=\"\"></a></p>\n\n<p>What I end with after running my macro:\n<a href=\"https://i.stack.imgur.com/IPr4p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IPr4p.png\" alt=\"\"></a></p>\n"}, {"tags": ["vba", "save", "runtime-error", "ms-word"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1528902436, "post_id": 50840496, "comment_id": 88684848, "body": "What specific error is thrown? Note that you are showing the open, not the save statement."}, {"owner": {"reputation": 45, "user_id": 8411789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ClvF.png?s=128&g=1", "display_name": "Niteraleph", "link": "https://stackoverflow.com/users/8411789/niteraleph"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1528902568, "post_id": 50840496, "comment_id": 88684928, "body": "Sorry I have mistakenly pasted the wrong line (sincere apologies!). Will edit to be correct. As for the error - I will paste tommorow as my boss is gone and the error cannot be reproduced on my computer. We have error handling so it only showed the messaged we prepared (for situations where the filename is wrong, but it should be ok in our test)"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1528902583, "post_id": 50840496, "comment_id": 88684940, "body": "Does the affected username have a space or special character in any of the variable names? You could try wrapping the file in double quoted double quotes."}, {"owner": {"reputation": 45, "user_id": 8411789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ClvF.png?s=128&g=1", "display_name": "Niteraleph", "link": "https://stackoverflow.com/users/8411789/niteraleph"}, "edited": false, "score": 0, "creation_date": 1528902666, "post_id": 50840496, "comment_id": 88684997, "body": "It is a letter + number so technically it does not. Beside all of our logins are the same except for different digits in the username so I doubt it&#39;s that."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1528902802, "post_id": 50840496, "comment_id": 88685079, "body": "Check for security issues. Does the logged-in user have permission to perform the save operation? Do the folders exist?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1528903001, "post_id": 50840496, "comment_id": 88685194, "body": "Are you sure the directory exists on the target machine? A better approach might be using specialfolders. Try something like: <code>FilePath = CreateObject(&quot;WScript.Shell&quot;).SpecialFolders(&quot;mydocuments&quot;) &amp; &quot;\\Project\\&quot; &amp; CompanyName &amp; &quot;\\&quot; &amp; Filename &amp; &quot;.docx&quot;</code>"}, {"owner": {"reputation": 45, "user_id": 8411789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ClvF.png?s=128&g=1", "display_name": "Niteraleph", "link": "https://stackoverflow.com/users/8411789/niteraleph"}, "edited": false, "score": 0, "creation_date": 1528935709, "post_id": 50840496, "comment_id": 88699278, "body": "Will try tommorow"}], "answers": [{"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1528990469, "post_id": 50859920, "comment_id": 88724800, "body": "Your code probably would have worked correctly, regardless of the setting on the machine, if you&#39;d also specify the <code>FileFormat:=wdFormatDocument</code> parameter, not just the <code>FileName</code>. That will override the default setting on the machine."}], "tags": [], "owner": {"reputation": 45, "user_id": 8411789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ClvF.png?s=128&g=1", "display_name": "Niteraleph", "link": "https://stackoverflow.com/users/8411789/niteraleph"}, "is_accepted": true, "score": 0, "last_activity_date": 1528986677, "creation_date": 1528986677, "answer_id": 50859920, "question_id": 50840496, "link": "https://stackoverflow.com/questions/50840496/vba-macro-throws-error-when-attempting-to-save-but-only-on-one-computer/50859920#50859920", "title": "VBA macro throws error when attempting to save (but only on one computer)", "body": "<p>Okay, so the issue was resolved. The problem was with the MS Office settings, specifically in the save tab, where the default save setting was set to Open Document format instead of Word Format (.docx)</p>\n\n<p>Surprisingly, editing the line to:</p>\n\n<pre><code>.SaveAs fileName:=\"C:\\Users\\\" &amp; userName &amp; \"\\Documents\\Project\\\" &amp; companyName &amp; \"\\\" &amp; fileName &amp; \".doc\"\n</code></pre>\n\n<p>helped and made it work. However, instead of editing our macro like this, we simply switched the setting to save default in word format and since then it worked properly.\nI find it surprising and quite 'stupid' that a VBA macro depends on this setting, but in case anyone encounters the same problem, changing the setting OR the extension to .doc should fix it</p>\n"}], "owner": {"reputation": 45, "user_id": 8411789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ClvF.png?s=128&g=1", "display_name": "Niteraleph", "link": "https://stackoverflow.com/users/8411789/niteraleph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 50859920, "answer_count": 1, "score": 0, "last_activity_date": 1528986677, "creation_date": 1528902211, "last_edit_date": 1528902596, "question_id": 50840496, "link": "https://stackoverflow.com/questions/50840496/vba-macro-throws-error-when-attempting-to-save-but-only-on-one-computer", "title": "VBA macro throws error when attempting to save (but only on one computer)", "body": "<p>We have written a VBA macro for MS Word. The macro seems to work properly on my and my coworker's computer. It also works on computers of our other coworkers, but when ran on our boss' computer (all have Windows 7 as operating system) it does not.</p>\n\n<p>The specific error occurs when trying to save with: </p>\n\n<pre><code>.SaveAs fileName:=\"C:\\Users\\\" &amp; userName &amp; \"\\Documents\\Project\\\" &amp; companyName &amp; \"\\\" &amp; fileName &amp; \".docx\"\n</code></pre>\n\n<p>For some strange reason it cannot save only on one system. I have checked Trust Center setting but they do not seem different. Any ideas?</p>\n\n<p><em>note: userName is simply a string holding the user name of the user</em></p>\n"}, {"tags": ["vba", "ms-word", "whitespace"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1528903196, "post_id": 50840231, "comment_id": 88685312, "body": "Your requirement isn&#39;t clear. Please describe the problem exactly. What you have, what you need, and what you get (including any errors) - with example(s). Try to do it in the Word UI, first."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1528937557, "post_id": 50840231, "comment_id": 88699635, "body": "Open the document in Word, and then Save As to convert to a plain text file. It will remove all of the formatting and font information. Then go from there."}, {"owner": {"reputation": 1, "user_id": 9936437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb15f7698e388bdb65c11c4d7142997?s=128&d=identicon&r=PG&f=1", "display_name": "M. Wid&#233;n", "link": "https://stackoverflow.com/users/9936437/m-wid%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1528962134, "post_id": 50840231, "comment_id": 88706853, "body": "I edited my text so hopefully it will be easier to understand.  Ken I will try that"}, {"owner": {"reputation": 1, "user_id": 9936437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb15f7698e388bdb65c11c4d7142997?s=128&d=identicon&r=PG&f=1", "display_name": "M. Wid&#233;n", "link": "https://stackoverflow.com/users/9936437/m-wid%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1528964923, "post_id": 50840231, "comment_id": 88708633, "body": "I solved everything exept the replacement of <code>.Text = &quot;X-axis\\(PCS\\-)&quot;   .Replacement.Text = &quot;X-axis\\(PCS\\)^t- &quot;</code>  The problem was that  <code>.Text = &quot;[ ]{22,}&quot;</code> has to be <code>.Text = &quot;[ ]{22;}&quot; </code>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528990593, "post_id": 50840231, "comment_id": 88724888, "body": "Have you edited your question to reflect the new situation? I get the impression not..."}, {"owner": {"reputation": 1, "user_id": 9936437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb15f7698e388bdb65c11c4d7142997?s=128&d=identicon&r=PG&f=1", "display_name": "M. Wid&#233;n", "link": "https://stackoverflow.com/users/9936437/m-wid%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1529302545, "post_id": 50840231, "comment_id": 88806827, "body": "Now everything is solved, Thanks so much for all help!"}], "owner": {"reputation": 1, "user_id": 9936437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb15f7698e388bdb65c11c4d7142997?s=128&d=identicon&r=PG&f=1", "display_name": "M. Wid&#233;n", "link": "https://stackoverflow.com/users/9936437/m-wid%c3%a9n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528961909, "creation_date": 1528901425, "last_edit_date": 1528961909, "question_id": 50840231, "link": "https://stackoverflow.com/questions/50840231/how-do-i-get-convert-whitspace-to-tab", "title": "How do I get convert whitspace to tab", "body": "<p>I have a word(2010) dokument with data that looks like this:</p>\n\n<pre><code>----------------------------------------------------------------------------\n15-aug-2017 15:28                Start Template                          Page  2\n</code></pre>\n\n<p><code>-----------------------------------------------------------------------------</code>\n<code>(mm)   ACTUAL   NOMINAL  LO-TOL       HI-TOL    DEVIATION          GRAPHIC             ERROR</code></p>\n\n<p><code>-------------------------------------------------------------------------------</code>\n<code>Circle:\u00d815_H13_2</code></p>\n\n<p><code>X-axis(PCS)-74.815    74.940                        -0.125</code></p>\n\n<p><code>Y-axis(PCS)   74.975    74.940                         0.035</code></p>\n\n<p><code>Diameter      15.420    15.000    +0.000    +0.270     0.420 -*-+--&gt; \n      0.150</code>\n<code>TruePos2D      0.260                         1.770(M=0.27)   &lt;--*---</code></p>\n\n<p><code>----------------------------------------------------------------------</code></p>\n\n<p>The things I'm trying to do:</p>\n\n<ul>\n<li>delete all ---- but not when it's a negative number (-0.125) and replace with nothing.</li>\n<li>delete all +,*,>,&lt; symbols and replace with nothing</li>\n<li>Between all the numbers/words there are white spaces and I want tabs instead exampel: <code>X-axis(PCS)   74.815            74.940                   -0.125</code>  between 74.940 and -.125 there are more then 22 spaces so I want 3 tab and between 74.815 and 74.940 It's more then 12 spaces so I want 2 tabs and between (PCS) and 74.815 it is more then 2 spaces so i want only 1 tab </li>\n<li>I want to delete everything from the date to Error</li>\n<li>And the last thing is to make a tab between (PCS) an the - symbol: <code>X-axis(PCS)-</code></li>\n</ul>\n\n<p>so what I want to end up with is this:</p>\n\n<p><code>Circle:\u00d815_H13_2</code></p>\n\n<p><code>X-axis(PCS) ^t -74.815  ^t ^t 74.940  ^t         ^t       ^t   -0.125</code></p>\n\n<p><code>Y-axis(PCS)  ^t 74.975  ^t  ^t  74.940    ^t       ^t    ^t     0.035</code></p>\n\n<p><code>Diameter  ^t    15.420 ^t 15.000  ^t  0.000  ^t  0.270  ^t   0.420 ^t 0.150</code></p>\n\n<p>`TruePos2D   ^t   0.260  ^t        ^t        ^t     1.770(M=0.27)  </p>\n\n<p>The error message I get when wildcard = true: Run-time error 5560, the Find what text contains a Pattern Match expression which is not valid </p>\n\n<p>and when wildcard = false I dont get a error message but it only delets the text with templet in it and also the text page</p>\n\n<p>So I beleve wildcard=true and that I have a problem with <code>.Text = \"[ ]{22,}\"</code></p>\n\n<p>Please help me! this is the first time I'm programing </p>\n\n<pre><code>    Sub CleanUpPastedText()\n    Application.ScreenUpdating = False\n    With Selection.Range.Find\n    .ClearFormatting\n  .Replacement.ClearFormatting\n  .Forward = True\n  .Wrap = wdFindStop\n  .Format = False\n  .MatchAllWordForms = False\n  .MatchSoundsLike = False\n  .MatchWildcards = False\n  .Text = \"[ ]{22,}\"\n  .Replacement.Text = \"^t^t^t\"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"[ ]{12,}\"\n  .Replacement.Text = \"^t^t\"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"[ ]{2,}\"\n  .Replacement.Text = \"^t\"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"[-]{2,}\"\n  .Replacement.Text = \"\"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"[ ]{1,}\"\n  .Replacement.Text = \"^t\"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"                Start Template\"\n  .Replacement.Text = \"\"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"Page  \"\n  .Replacement.Text = \"\"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"\\(mm\\)          ACTUAL   NOMINAL    LO-TOL    HI-TOL DEVIATION GRAPHIC       ERROR\"\n  .Replacement.Text = \"\"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"X-axis\\(PCS\\-)\"\n  .Replacement.Text = \"X-axis\\(PCS\\)^t- \"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"[\\*]\"\n  .Replacement.Text = \"\"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"[+]\"\n  .Replacement.Text = \"\"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"[&lt;]\"\n  .Replacement.Text = \"\"\n  .Execute Replace:=wdReplaceAll\n  .Text = \"[&gt;]\"\n  .Replacement.Text = \"\"\n  .Execute Replace:=wdReplaceAll\n\n  End With\nApplication.ScreenUpdating = True\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "macos", "applescript", "powerpoint"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1528902068, "post_id": 50840111, "comment_id": 88684583, "body": "Try setting the last parameter to True. E.g. this <code>Set oTempPres = Presentations.Open(sFileName, , , True)</code>"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1528903749, "post_id": 50840111, "comment_id": 88685650, "body": "Or just leave all parameters except sFileName blank."}, {"owner": {"reputation": 438, "user_id": 3391972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YtpNm.jpg?s=128&g=1", "display_name": "Irshad", "link": "https://stackoverflow.com/users/3391972/irshad"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1528950550, "post_id": 50840111, "comment_id": 88702054, "body": "@RyanWildry Yes it will work but I don&#39;t want to open it. I just want to split the original presentation to slides."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1544795984, "post_id": 50840111, "comment_id": 94413584, "body": "Will MacPPT let you use the <code>Application.Visible = False</code> parameter? I use this to cut down on graphical refresh costs when building complicated slides. Just make the application visible again before ending the sub."}], "owner": {"reputation": 438, "user_id": 3391972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YtpNm.jpg?s=128&g=1", "display_name": "Irshad", "link": "https://stackoverflow.com/users/3391972/irshad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1528901501, "creation_date": 1528901085, "last_edit_date": 1528901501, "question_id": 50840111, "link": "https://stackoverflow.com/questions/50840111/how-to-split-a-slide-from-a-powerpoint-presentation-using-vba-or-apple-script", "title": "How to split a slide from a powerpoint presentation using VBA or Apple script", "body": "<p>How to split a slide from a presentation using VBA or Apple script. previously i used a VBA code to achieve the same but in powerpoint 16.13.1 I am getting an error as \"Mac PPT does not support opening file in window less mode.\" and it was working on previous versions of PowerPoint.</p>\n\n<pre><code>Sub SaveSlide(lSlideNum As Long, sFileName As String)\n\nDim oTempPres As Presentation\nDim x As Long\n\nActivePresentation.SaveCopyAs sFileName\n' open the saved copy windowlessly\nSet oTempPres = Presentations.Open(sFileName, , , False)\n\nFor x = 1 To lSlideNum - 1\n    oTempPres.Slides(1).Delete\nNext\n\n' What was slide number lSlideNum is now slide 1\nFor x = oTempPres.Slides.Count To 2 Step -1\n    oTempPres.Slides(x).Delete\nNext\n\noTempPres.Save\noTempPres.Close\nEnd Sub\n</code></pre>\n\n<p>In the above code I am getting error in this line</p>\n\n<pre><code>Set oTempPres = Presentations.Open(sFileName, , , False)\n</code></pre>\n\n<p>Please help me.\n<a href=\"https://i.stack.imgur.com/MEEWQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MEEWQ.png\" alt=\"this is the error which I am getting\"></a></p>\n"}, {"tags": ["arrays", "excel", "vba", "multidimensional-array"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528905580, "post_id": 50839983, "comment_id": 88686693, "body": "could you upload a screenshot of just the worksheet tab names on your screen?"}, {"owner": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528905974, "post_id": 50839983, "comment_id": 88686907, "body": "The exact names are in the Sub_Definitions, referenced as each worksheet."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528907627, "post_id": 50839983, "comment_id": 88687857, "body": "I see them written out but based on the problems with the current answers it seems like they&#39;re trying to access a worksheet that is spelled wrong/ doesnt exist/etc and a picture <i>might</i> clear things up"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "edited": false, "score": 0, "creation_date": 1528902694, "post_id": 50840134, "comment_id": 88685012, "body": "Thanks for helping out. I tried as you said but unfortunately still having the same issue."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "edited": false, "score": 0, "creation_date": 1528904404, "post_id": 50840134, "comment_id": 88686038, "body": "Are you sure the worksheet names in the array are correct?!"}, {"owner": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "edited": false, "score": 0, "creation_date": 1528905334, "post_id": 50840134, "comment_id": 88686573, "body": "yeah the names seem to be correct cause if I use With and the names themselves the macro works fine. I believe as Doug pointed out below that it is a reference to the &#39;Worksheets..&#39;"}], "tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": false, "score": 1, "last_activity_date": 1528901149, "creation_date": 1528901149, "answer_id": 50840134, "question_id": 50839983, "link": "https://stackoverflow.com/questions/50839983/array-string-not-able-to-pass-through-to-worksheets/50840134#50840134", "title": "Array string not able to pass through to &#39;Worksheets&#39;", "body": "<p>Try changing...</p>\n\n<pre><code>Dim CalcRange, FirstHeaderRow, LastColumn As Range\nDim w As Long\n\nWshtNames = Array(\"Bench_OAS_Level\", \"Bench_OAS_Change\", \"Bench_Spread_Dur\", \"Bench_Duration\", \"Bench_Convexity\")\n\n For w = LBound(WshtNames) To UBound(WshtNames)\n\n     With Worksheets(WshtNames(w))\n</code></pre>\n\n<p>To...</p>\n\n<pre><code>Dim CalcRange, FirstHeaderRow, LastColumn As Range\nDim w As variant\n\nWshtNames = Array(\"Bench_OAS_Level\", \"Bench_OAS_Change\", \"Bench_Spread_Dur\", \"Bench_Duration\", \"Bench_Convexity\")\n\n Foreach w in wshtNames\n\n     With Worksheets(w)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "edited": false, "score": 0, "creation_date": 1528903006, "post_id": 50840202, "comment_id": 88685197, "body": "thanks very much, that was very helpful. Unfortunately the subscription still seems out of range, even when I input the dimensions (1 or 2 as you highlighted for example). Any idea why that may be the case?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "edited": false, "score": 0, "creation_date": 1528903462, "post_id": 50840202, "comment_id": 88685456, "body": "If it is on the line &quot;With Worksheets(WshtNames(w))&quot;  it might be due to the fact youre not referencing which workbook contains said sheet. What I would do i set which workbook youre in and then reference wb.Sheets(WshtNames(w)). Make sense?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "edited": false, "score": 0, "creation_date": 1528903488, "post_id": 50840202, "comment_id": 88685472, "body": "Or loop through sheets. Same end different approach"}, {"owner": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "edited": false, "score": 0, "creation_date": 1528904788, "post_id": 50840202, "comment_id": 88686243, "body": "Yes it is exactly where you&#39;re pointing out that it breaks. I have now declared wb and set it = ThisWorkbook.Sheets(WshtNames(w)) but unfortunately it still throws that annoying out of range! I&#39;ve declared wb as worksheet, workbook etc but still same issue. Driving me nuts!"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "edited": false, "score": 0, "creation_date": 1528904879, "post_id": 50840202, "comment_id": 88686303, "body": "@ChefTony does that fix your issue and things run accordingly?"}, {"owner": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "edited": false, "score": 0, "creation_date": 1528906049, "post_id": 50840202, "comment_id": 88686966, "body": "referenced as pointed out but issue still there...thank you so much for your help though!"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 1, "last_activity_date": 1528905217, "last_edit_date": 1528905217, "creation_date": 1528901360, "answer_id": 50840202, "question_id": 50839983, "link": "https://stackoverflow.com/questions/50839983/array-string-not-able-to-pass-through-to-worksheets/50840202#50840202", "title": "Array string not able to pass through to &#39;Worksheets&#39;", "body": "<p>When using UBound and LBound you must use the second parameter to tell the compiler which dimension of the array that youre wanting to loop through. </p>\n\n<pre><code> example:  For w = LBound(WshtNames,1) To UBound(WshtNames,1)\n</code></pre>\n\n<p>or </p>\n\n<pre><code> example: For w = LBound(WshtNames,2) To UBound(WshtNames,2)\n</code></pre>\n\n<p>Youre getting out of range b.c the compiler doesnt knwo what/where youre trying to tell it to go. </p>\n\n<p>I ran this for fun and works as expected</p>\n\n<p><a href=\"https://i.stack.imgur.com/zOsVF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zOsVF.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the proper way to address setting workbook values</p>\n\n<pre><code>WshtNames = Array(\"Bench_OAS_Level\", \"Bench_OAS_Change\", \"Bench_Spread_Dur\", \"Bench_Duration\", \"Bench_Convexity\")\n\nset wb = Workbooks(\u201cworkbookname.filextension\u201d)\n\nFor w = LBound(WshtNames) To UBound(WshtNames)\n\n  With wb.Worksheets(WshtNames(w))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1528921160, "post_id": 50843384, "comment_id": 88694721, "body": "Don&#39;t use <code>Call</code>, it is now deprecated."}, {"owner": {"reputation": 350, "user_id": 9686485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8549235061a10c547739aa876210ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Chip R.", "link": "https://stackoverflow.com/users/9686485/chip-r"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1528924830, "post_id": 50843384, "comment_id": 88696398, "body": "Can you point me towards some MSDN documentation for that? I always thought it was a stylistic thing, and I prefer to use Call in my code. If it&#39;s deprecated, I should probably stop though. The only thing I found was <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/call-statement\" rel=\"nofollow noreferrer\">this</a>, which mentions that they&#39;re optional but no more. @AJD"}, {"owner": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "edited": false, "score": 0, "creation_date": 1528969972, "post_id": 50843384, "comment_id": 88711863, "body": "@ChipR. that is awesome! Thanks so much mate. Great insight on the dictionary too"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1529004919, "post_id": 50843384, "comment_id": 88731870, "body": "@ChipR. MSDN documentation aint what it used to be! The newer pages don&#39;t have the discussion they used to have about it being for backwards compatibility and is now deprecated. I also remember a discussion somewhere (linked from some answer here on SO) about how Call and () can affect how parameters are passed in some circumstances."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1529005246, "post_id": 50843384, "comment_id": 88732030, "body": "@ChipR.: <a href=\"https://stackoverflow.com/questions/2573597/should-i-use-call-keyword-in-vb-vba\" title=\"should i use call keyword in vb vba\">stackoverflow.com/questions/2573597/&hellip;</a>"}, {"owner": {"reputation": 350, "user_id": 9686485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8549235061a10c547739aa876210ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Chip R.", "link": "https://stackoverflow.com/users/9686485/chip-r"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1529009685, "post_id": 50843384, "comment_id": 88734005, "body": "@AJD. Thanks for the response. Interesting about the deprecation; I&#39;ll definitely keep my eye out for that. And, yes, re: Call and () parameters is exactly why I use call all the time for my subroutine calls. The short version is: I like having input parameters inside () always, and NOT using the &quot;Call&quot; keyword means you have to put parameters outside parens, after a space from the subroutine name, and delimited by commas, which I think is clunky. Using Call with all subroutines allows me to always put input parameters inside parens."}], "tags": [], "owner": {"reputation": 350, "user_id": 9686485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8549235061a10c547739aa876210ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Chip R.", "link": "https://stackoverflow.com/users/9686485/chip-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1528912332, "creation_date": 1528912332, "answer_id": 50843384, "question_id": 50839983, "link": "https://stackoverflow.com/questions/50839983/array-string-not-able-to-pass-through-to-worksheets/50843384#50843384", "title": "Array string not able to pass through to &#39;Worksheets&#39;", "body": "<p>It seems like the names of the worksheets are:</p>\n\n<ul>\n<li>Bench OAS Level </li>\n<li>Bench OAS Change</li>\n<li>Bench Spread Dur</li>\n<li>Bench Duration</li>\n<li>Bench Convexity</li>\n</ul>\n\n<p>But that you're storing them in the array as:</p>\n\n<ul>\n<li>Bench_OAS_Level</li>\n<li>Bench_OAS_Change</li>\n<li>Bench_Spread_Dur</li>\n<li>Bench_Duration</li>\n<li>Bench_Convexity</li>\n</ul>\n\n<p>(with underscores).</p>\n\n<p>Does this fix the problem?</p>\n\n<p>Also, it might be helpful to add a dictionary object to the public scope:</p>\n\n<pre><code>public worksheetDictionary as object\n</code></pre>\n\n<p>And change the definitions code to:</p>\n\n<pre><code>Sub Definitions()\n    set worksheetDictionary = CreateObject(\"Scripting.Dictionary\")\n\n    With Workbooks(\"TEST Overview Tool Barclays May 2018\")\n        Call worksheetDictionary.Add(\"Bench_OAS_Level\", .Worksheets(\"Bench OAS Level\"))\n        Call worksheetDictionary.Add(\"Bench_OAS_Change\",.Worksheets(\"Bench OAS Change\"))\n        Call worksheetDictionary.Add(\"Bench_Spread_Dur\", .Worksheets(\"Bench Spread Dur\"))\n        Call worksheetDictionary.Add(\"Bench_Duration\", .Worksheets(\"Bench Duration\"))\n        Call worksheetDictionary.Add(\"Bench_Convexity\", .Worksheets(\"Bench Convexity\"))\n\n        Set Check_Tab = Workbooks(\"TEST Overview Tool Barclays May 2018\").Worksheets(\"Check\")\n    End With\nEnd Sub\n</code></pre>\n\n<p>Then, you'd change the for loop in your main block to start like this:</p>\n\n<pre><code>For each k in worksheetDictionary.Keys\n    With worksheetDictionary(k)\n</code></pre>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 50843384, "answer_count": 3, "score": 0, "last_activity_date": 1528912332, "creation_date": 1528900748, "last_edit_date": 1528905377, "question_id": 50839983, "link": "https://stackoverflow.com/questions/50839983/array-string-not-able-to-pass-through-to-worksheets", "title": "Array string not able to pass through to &#39;Worksheets&#39;", "body": "<p>I'm trying to set up a code which essentially looks at an array of worksheets, and perform the exact same check for each of those. Unfortunately I seem to be getting the following message anytime I try to access the With... function (through which I would like the array to operate):</p>\n\n<blockquote>\n  <p>Run-time error '9': Subscription out of range</p>\n</blockquote>\n\n<p>Although the variable </p>\n\n<blockquote>\n  <p>WshtNames(w)</p>\n</blockquote>\n\n<p>does end up taking the name required, it cannot seem to store it so that it can be applied to the respective worksheet? Any help greatly appreciated. Code below:</p>\n\n<pre><code>    Option Explicit\n\nPublic Cell, WshtNames As Variant, Check_Tab, Bench_OAS_Level, Bench_OAS_Change, Bench_Spread_Dur, Bench_Duration, Bench_Convexity, ws As Worksheets, FirstHeaderColumn, LRow, LastRow As Long\n\nSub Definitions()\n\nSet Bench_OAS_Level = Workbooks(\"TEST Overview Tool Barclays May 2018\").Worksheets(\"Bench OAS Level\")\nSet Bench_OAS_Change = Workbooks(\"TEST Overview Tool Barclays May 2018\").Worksheets(\"Bench OAS Change\")\nSet Bench_Spread_Dur = Workbooks(\"TEST Overview Tool Barclays May 2018\").Worksheets(\"Bench Spread Dur\")\nSet Bench_Duration = Workbooks(\"TEST Overview Tool Barclays May 2018\").Worksheets(\"Bench Duration\")\nSet Bench_Convexity = Workbooks(\"TEST Overview Tool Barclays May 2018\").Worksheets(\"Bench Convexity\")\nSet Check_Tab = Workbooks(\"TEST Overview Tool Barclays May 2018\").Worksheets(\"Check\")\n\nEnd Sub\n\nSub Check_OOT()\n\nCall Definitions\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlManual\n\nDim CalcRange, FirstHeaderRow, LastColumn As Range\nDim w As Long\n\nWshtNames = Array(\"Bench_OAS_Level\", \"Bench_OAS_Change\", \"Bench_Spread_Dur\", \"Bench_Duration\", \"Bench_Convexity\")\n\nFor w = LBound(WshtNames) To UBound(WshtNames)\n\n  With Worksheets(WshtNames(w))\n\n    Set LastColumn = .UsedRange.Find(\"Total\", , xlValues, xlWhole)\n    Set FirstHeaderRow = .UsedRange.Find(\"Level 1\", , xlValues, xlWhole)\n    FirstHeaderColumn = FirstHeaderRow.Column + 2\n    LastRow = .Cells(Rows.Count, LastColumn.Column).End(xlUp).Row\n\n    Set CalcRange = .Range(.Cells(FirstHeaderRow.Row + 2, FirstHeaderRow.Column + 3), .Cells(LastRow, LastColumn.Column))\n\n       For Each Cell In CalcRange\n          If Not IsError(Cell) Then\n           If Cell &gt; 500 Or Cell &lt; -100 Then\n           Cell.Font.Bold = True\n           Cell.Interior.ColorIndex = 36\n           Cell.EntireRow.Copy\n              Call Copy_into_Check_Tab\n           End If\n        End If\n       Next Cell\n\n  End With\n\nNext w\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1528900876, "post_id": 50839969, "comment_id": 88683774, "body": "Apparently key can be <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/dictionary-object\" rel=\"nofollow noreferrer\">anything</a> except an array"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528900949, "post_id": 50839969, "comment_id": 88683817, "body": "Where is the collection in the above?"}, {"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528901045, "post_id": 50839969, "comment_id": 88683886, "body": "This is basically my question, I don&#39;t know how to tell VBA that for this particular dictionary the keys will be collections. I want <code>test_dict(cell.value)</code> to be a collection, hence <code>test_dict(cell.value).Add</code> in the code above."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1528901380, "post_id": 50839969, "comment_id": 88684110, "body": "Do you need the key to be a collection, or the value to which the key points to be a collection? I&#39;m under the impression that the key should be immutable because it points to an element in memory. Using concrete examples, do you need something like <code>test_dict(&quot;key1&quot;) = Collection1</code> or do you actually need <code>test_dict(collection1) = some_value</code>"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1528901727, "post_id": 50839969, "comment_id": 88684367, "body": "Keys can not be be repeating."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1528902158, "post_id": 50839969, "comment_id": 88684641, "body": "@QHarr - <i>&#39;Apparently key can be anything except an array&#39;</i> ... or a duplicate."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1528902333, "post_id": 50839969, "comment_id": 88684768, "body": "@barciewicz - in that scenario I believe the collection should be the dictionary Item, not the Key. Use the key as the idenifier and he item as the acgual data."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528902987, "post_id": 50839969, "comment_id": 88685181, "body": "@Jeeped  and OmegaStriiped: Well spotted. My bad."}], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 2, "last_activity_date": 1528901782, "creation_date": 1528901782, "answer_id": 50840360, "question_id": 50839969, "link": "https://stackoverflow.com/questions/50839969/vba-adding-to-collection-which-is-a-dictionary-value/50840360#50840360", "title": "VBA: adding to collection which is a dictionary value", "body": "<p>I think I understand what you are looking to do. Using a dictionary, you want to map a key to a collection of items. If my understanding is correct, check the below code and see if you can modify it to suit your needs. I ran a test on it, and it seems to work.</p>\n\n<pre><code>Sub LoadThem()\n    Dim coll As New Collection\n    Dim rng As Range\n    Dim cel As Range\n    Dim oDict As Object\n\n    Set oDict = CreateObject(\"Scripting.Dictionary\")\n\n    Set rng = Range(\"A1:A26\")\n\n    For Each cel In rng\n        If oDict.exists(cel.Value) Then\n            oDict(cel.Value).Add cel.Offset(, 1).Value\n        Else\n            Set coll = New Collection\n            coll.Add cel.Offset(, 1).Value\n            oDict.Add cel.Value, coll\n        End If\n    Next cel\n\n\n    For Each okey In oDict.keys\n        Debug.Print okey\n        For Each elem In oDict(okey)\n            Debug.Print \"    \" &amp; elem\n        Next elem\n    Next okey\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1528902774, "last_edit_date": 1528902774, "creation_date": 1528902062, "answer_id": 50840461, "question_id": 50839969, "link": "https://stackoverflow.com/questions/50839969/vba-adding-to-collection-which-is-a-dictionary-value/50840461#50840461", "title": "VBA: adding to collection which is a dictionary value", "body": "<p>Like the following?</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetValues()\n    Const col_1 = \"col1\", col_2 = \"col2\", col_3 = \"col3\"\n\n    Dim lists As Object: Set lists = CreateObject(\"Scripting.Dictionary\")\n\n    lists.Add col_1, New Collection\n    lists.Add col_2, New Collection\n    lists.Add col_3, New Collection\n\n    Dim currentCell As Range\n    For Each currentCell In ActiveSheet.Range(\"S2:S13\")\n        Select Case currentCell.Value\n        Case col_1\n            lists(col_1).Add currentCell.Offset(, 1).Value\n        Case col_2\n            lists(col_2).Add currentCell.Offset(, 1).Value\n        Case col_3\n            lists(col_3).Add currentCell.Offset(, 1).Value\n        End Select\n    Next\n\n    Dim key As Variant, item As Long\n\n    For Each key In lists\n        For item = 1 To lists(key).Count\n            Debug.Print lists(key)(item)\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>Data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HYv4i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HYv4i.png\" alt=\"Data\"></a></p>\n\n<p>If you don't know the keys in advance use:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetValues()\n    Dim lists As Object: Set lists = CreateObject(\"Scripting.Dictionary\")\n    Dim currentCell As Range\n    For Each currentCell In ActiveSheet.Range(\"S2:S13\")\n        If Not lists.exists(currentCell.Value) Then lists.Add currentCell.Value, New Collection\n        lists(currentCell.Value).Add currentCell.Offset(, 1).Value\n    Next\n\n    Dim key As Variant, item As Long\n    For Each key In lists\n        For item = 1 To lists(key).Count\n            Debug.Print lists(key)(item)\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1457, "favorite_count": 2, "accepted_answer_id": 50840461, "answer_count": 2, "score": 1, "last_activity_date": 1528916276, "creation_date": 1528900699, "last_edit_date": 1528916276, "question_id": 50839969, "link": "https://stackoverflow.com/questions/50839969/vba-adding-to-collection-which-is-a-dictionary-value", "title": "VBA: adding to collection which is a dictionary value", "body": "<p>Is it possible in VBA to have collection as `Scripting.Dictionary' values and then, in a loop, add new values to this collection as specific key is found?</p>\n\n<p>Something like:</p>\n\n<pre><code>Dim test_dict As New Scripting.Dictionary\n\nFor Each cell In ActiveSheet.Range(\"S2:S13\")\n    test_dict(cell.value).Add (cell.offset(1,0).value)\nNext cell\n</code></pre>\n\n<p>Also, I need to cater for the fact that the keys will be repeating.</p>\n\n<p>For example in Python I can set the dictionary to have list as value and then append to this list on every iteration:</p>\n\n<pre><code>dictionary= defaultdict(list)\n\nfor x in range(1,10):\n    dictionary[x].append(x + 100)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1528902454, "post_id": 50839643, "comment_id": 88684862, "body": "sItem is defined after error handline for GoTo NextCode; if the NextCode is determining sItem, then the filepath is getting overwritten, no?  GetFolder = sItem in NextCode.  would need to be sItem = GetFolder?"}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 8137603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d16a406ddbf1b8278db85c23d9c1204?s=128&d=identicon&r=PG&f=1", "display_name": "VBAmazing", "link": "https://stackoverflow.com/users/8137603/vbamazing"}, "edited": false, "score": 0, "creation_date": 1528905870, "post_id": 50841513, "comment_id": 88686844, "body": "This works. Thank you! I knew it had to be something simple."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1528906446, "last_edit_date": 1528906446, "creation_date": 1528905336, "answer_id": 50841513, "question_id": 50839643, "link": "https://stackoverflow.com/questions/50839643/folder-dialog-selecting-the-preceding-folder/50841513#50841513", "title": "Folder dialog selecting the preceding folder", "body": "<p>I believe what is happening is because you are using FilePath = fldr.InitialFileName, which is in essence the original folder selected in the dialogue, if you change your code to this it should work as expected:</p>\n\n<pre><code>Sub foo()\nApplication.EnableCancelKey = xlDisabled\n    Dim fldr As FileDialog, sItem As String\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n    With fldr\n        .Title = \"Select a Folder\"\n        .AllowMultiSelect = False\n        .InitialFileName = \"\\\\user\\Desktop\\Folder1\\Folder2\\Folder3\\\"\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        sItem = .SelectedItems(1)\n    End With\nFilePath = sItem\nNextCode:\n    GetFolder = sItem\n    Set fldr = Nothing\nDestinationFolder.Value = sItem\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 8137603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d16a406ddbf1b8278db85c23d9c1204?s=128&d=identicon&r=PG&f=1", "display_name": "VBAmazing", "link": "https://stackoverflow.com/users/8137603/vbamazing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 50841513, "answer_count": 1, "score": 0, "last_activity_date": 1528906446, "creation_date": 1528899805, "last_edit_date": 1531161705, "question_id": 50839643, "link": "https://stackoverflow.com/questions/50839643/folder-dialog-selecting-the-preceding-folder", "title": "Folder dialog selecting the preceding folder", "body": "<p>I am attempting to use a file dialog to select a folder that will be used later on in the code. The following is being used as a part of a Userform that calls several other macros and takes various other user inputs as strings.</p>\n\n<p>What this macro is supposed to do (later on in the code) is export a file to a folder that the user specifies with this <code>fldrpicker</code> dialog. The problem is this: The file exports to the folder <em>before</em> the one I want, and I can't figure out why. </p>\n\n<pre><code>`Public FilePath as String\nPrivate Sub folderpicker_click() 'A field in the UserForm\nApplication.EnableCancelKey = xlDisabled\n    Dim fldr As FileDialog, sItem As String\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n    With fldr\n        .Title = \"Select a Folder\"\n        .AllowMultiSelect = False\n        .InitialFileName = \"\\\\user\\Desktop\\Folder1\\Folder2\\Folder3\\\"\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        sItem = .SelectedItems(1)\n    End With\nFilePath = fldr.InitialFileName\nNextCode:\n    GetFolder = sItem\n    Set fldr = Nothing\nDestinationFolder.Value = sItem\nEnd Sub\n`\n</code></pre>\n\n<p>With this code, the file will save in <code>Folder2</code> and not <code>Folder3</code> like it I need it to. I've tried to troubleshoot with a temporary sub that uses <code>msgbox(FilePath)</code> right after this runs, but it tells me that <code>FilePath</code> is <code>\\\\user\\Desktop\\Folder1\\Folder2\\</code> so I don't think the error is exporting it (that's why I haven't included that bit of code). </p>\n"}, {"tags": ["vba", "excel", "merge", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528902453, "post_id": 50839171, "comment_id": 88684861, "body": "Note that you can use the <a href=\"https://stackoverflow.com/posts/50839171/edit\">edit</a> link below your question to add additional information to it - trying to trouble-shoot from numerous comments is very difficult. Extraneous comments can then be deleted."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1528904242, "post_id": 50839171, "comment_id": 88685945, "body": "@NPettMHallmark <code>On Error Resume Next</code> basically ignores all errors - so when you hit that line, <code>cnn.Close</code> should not throw any kind of error. But like what Cindy said, you shouldn&#39;t even be able to <i>get</i> to that line, since that only occurs in your error handling routine.."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528907079, "post_id": 50839171, "comment_id": 88687590, "body": "As I said, we need to know what line of code is triggering the error handler. Use F8 to step through the code and you should see what the last line is before the message box. Or comment out the error handling completely so that you can use Debug to see the line. FWIW my best guess would be that you&#39;ve misspelled a FormFields name..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528917275, "post_id": 50839171, "comment_id": 88692697, "body": "I&#39;m still not seeing which line triggers the display of the MsgBox... FWIW this is the problem - the cnn.close is a red herring - that&#39;s only happening because cnn is never initialized due to the error not running Set cnn... As I said, you&#39;ve probably misspelled a FormField name..."}, {"owner": {"reputation": 1, "user_id": 9936443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7c61e53a0ae55845ba3e76a6545affa?s=128&d=identicon&r=PG&f=1", "display_name": "NPettMHallmark", "link": "https://stackoverflow.com/users/9936443/npettmhallmark"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528920340, "post_id": 50839171, "comment_id": 88694299, "body": "Hi @CindyMeister, we got the code to work but it does not input into the correct cell. It is in the correct column but not in the correct row. It starts at row 10 when it should start at row 2. How do I manipulate the code so that it starts at row 2? Thanks"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528921008, "post_id": 50839171, "comment_id": 88694634, "body": "In that case, you should start a new question that specifically targets the new problem. No single person is an expert in all aspects of everything. And the way the site works (Q&amp;A, not a &quot;forum&quot;) changing topic in &quot;mid-stream&quot; is not good :-) But glad you&#39;ve made progress!"}], "owner": {"reputation": 1, "user_id": 9936443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7c61e53a0ae55845ba3e76a6545affa?s=128&d=identicon&r=PG&f=1", "display_name": "NPettMHallmark", "link": "https://stackoverflow.com/users/9936443/npettmhallmark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528921076, "creation_date": 1528898450, "last_edit_date": 1528921076, "question_id": 50839171, "link": "https://stackoverflow.com/questions/50839171/issues-setting-up-doc-merge-from-word-to-excel-using-vba", "title": "Issues setting up Doc merge from word to excel using VBA", "body": "<p>I am an amateur coder very new to VBA with a little experience in C+</p>\n\n<p>I was able to find code to execute a doc merge using macros in word but when I run it I receive these 2 errors.</p>\n\n<p>The line:</p>\n\n<p><code>MsgBox Err.Number &amp; \": \" &amp; Err.Description, _\n        vbOKOnly, \"Error\"</code></p>\n\n<p>returns the following error in an Error dialog box:</p>\n\n<p>5941: The requested member of the collection does not exist.</p>\n\n<p>The line:</p>\n\n<pre><code>cnn.Close\n</code></pre>\n\n<p>returns the following error in a Microsoft Visual Basic dialog box:</p>\n\n<p>Run-time error '91':\nObject variable or With block variable not set</p>\n\n<p>Here is the code used</p>\n\n<p>Any help anyone can provide would be greatly appreciated</p>\n\n<pre><code>Sub TransferToExcel()\n'Transfer a single record from the form fields to an Excel workbook.\n  Dim doc As Document\n  Dim strObligee As String\n  Dim strJob As String\n  Dim strSQL As String\n  Dim cnn As ADODB.Connection\n  'Get data.\n  Set doc = ActiveDocument\n  On Error GoTo ErrHandler\n  strObligee = Chr(39) &amp; doc.FormFields(\"txtObligee\").Result &amp; Chr(39)\n  strJob = Chr(39) &amp; doc.FormFields(\"txtJob\").Result &amp; Chr(39)\n  'Define sql string used to insert each record in the destination workbook.\n  'Don't omit the $ in the sheet identifier.\n  strSQL = \"INSERT INTO [Sheet1$]\" _\n    &amp; \" (Obligee, Job)\" _\n    &amp; \" VALUES (\" _\n    &amp; strObligee &amp; \", \" _\n    &amp; strJob _\n    &amp; \")\"\n  Debug.Print strSQL\n  'Define connection string and open connection to destination workbook file.\n  Set cnn = New ADODB.Connection\n  With cnn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .ConnectionString = \"Data Source=C:\\Users\\Ntrojan\\Documents\\word to excel project\\fieldheaders.xlsx;\" &amp; _\n      \"Extended Properties=Excel 8.0;\"\n    .Open\n    'Transfer data.\n    .Execute strSQL\n  End With\n  Set doc = Nothing\n  Set cnn = Nothing\n  Exit Sub\nErrHandler:\n  MsgBox Err.Number &amp; \": \" &amp; Err.Description, _\n    vbOKOnly, \"Error\"\n  On Error GoTo 0\n  On Error Resume Next\n  cnn.Close\n  Set doc = Nothing\n  Set cnn = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["jquery", "html", "vba"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "edited": false, "score": 0, "creation_date": 1528901747, "post_id": 50839789, "comment_id": 88684382, "body": "That is similar to the method I tried a few days ago, It turns out the issue was how I was opening IE, rather than how I was calling that variable."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 0, "last_activity_date": 1528900194, "creation_date": 1528900194, "answer_id": 50839789, "question_id": 50839158, "link": "https://stackoverflow.com/questions/50839158/vba-input-data-into-jquery-table-to-submit-a-search-on-a-site/50839789#50839789", "title": "VBA input data into Jquery table to submit a search on a site", "body": "<p>Without access to the site, hard to say this will work for sure, but an approach like this is one way to do what you are after.</p>\n\n<pre><code>Public Sub enterData()\n\n    'I'm assuming you already have an IE window\n\n    'Find the Object\n    Dim elements As Object\n    Dim element  As Object\n\n    'More about element selectors https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById\n    Set elements = IE.Document.getElementByID(\"params-fields\").getElementsByClassName(\"ui-autocomplete-input\")\n\n    'Iterate and check if has the 'placeholder' property with the 'Uri (required)' value\n    For Each element In elements\n\n        'see https://www.w3schools.com/jsref/met_element_getattribute.asp\n        If element.getAttribute(\"placeholder\") = \"Uri (required)\" Then\n            element.Value = \"Something goes here\"\n            Exit For\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "is_accepted": false, "score": 0, "last_activity_date": 1528902363, "last_edit_date": 1528902363, "creation_date": 1528901904, "answer_id": 50840403, "question_id": 50839158, "link": "https://stackoverflow.com/questions/50839158/vba-input-data-into-jquery-table-to-submit-a-search-on-a-site/50840403#50840403", "title": "VBA input data into Jquery table to submit a search on a site", "body": "<pre><code>Dim objIE As InternetExplorer 'special object variable representing the IE browser\nDim aEle As HTMLLinkElement 'special object variable for an &lt;a&gt; (link) element\nDim element As HTMLLinkElement\nSet objIE = New InternetExplorerMedium\nDim b64 As String\nDim stoper As Integer\n\n  'make IE browser visible (False would allow IE to run in the background)\nobjIE.Visible = True\n\n'navigate IE to this web page (a pretty neat search engine really)\nobjIE.navigate \"https://website.com\"\n'wait here a few seconds while the browser is busy\nDo While objIE.Busy = True Or objIE.READYSTATE &lt;&gt; 4: DoEvents: Loop\nobjIE.Document.getElementsByClassName(\"ui-autocomplete-input\")(0).Value = \"submission value\"\nSet objInputs = objIE.Document.getElementsByTagName(\"input\")\nFor Each element In objInputs\nIf element.id Like \"Submit\" Then\nelement.Click\nEnd If\nNext\n</code></pre>\n\n<p>Here was my solution to get it done, it was an IE calling error, I changed </p>\n\n<pre><code>Set objIE = New InternetExplorer\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Set objIE = New InternetExplorerMedium\n</code></pre>\n\n<p>which allowed my status wait to work, which in turn made the other stuff below work</p>\n"}], "owner": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 50839789, "answer_count": 2, "score": 1, "last_activity_date": 1528902363, "creation_date": 1528898428, "last_edit_date": 1528899105, "question_id": 50839158, "link": "https://stackoverflow.com/questions/50839158/vba-input-data-into-jquery-table-to-submit-a-search-on-a-site", "title": "VBA input data into Jquery table to submit a search on a site", "body": "<p>I am trying to figure out how to input data into an input box that is formatted as a Jquery table. <p>\nBelow is the html snippet of the div of the table. <p>\nI cannot figure out how to reference the cell so I can input a string and then tell VBA to <kbd>Tab</kbd> then <kbd>Enter</kbd> to submit the string as a search.\nIts not so much a question with the VBA side but how could I maybe define the value of the input box in the URL itself, if this could be done, it would make the whole process faster. I don't really have any experience with jquery format. <p></p>\n\n<p>Also there is a screenshot of the page with the console up, unfortunately I cannot provide the url as it is a site that can only be accessed with company credentials. <a href=\"https://i.stack.imgur.com/jbVaR.png\" rel=\"nofollow noreferrer\">Submission Page in Question</a>. \n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div id=\"params\" class=\"ui-tabs ui-widget ui-widget-content ui-corner-all\"&gt;\r\n  &lt;ul class=\"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all\"&gt;\r\n    &lt;li class=\"ui-state-default ui-corner-top ui-tabs-selected ui-state-active\"&gt;&lt;a href=\"#params-fields\"&gt;Fields&lt;/a&gt;&lt;/li&gt;\r\n    &lt;li class=\"ui-state-default ui-corner-top\"&gt;&lt;a href=\"#params-json\"&gt;JSON&lt;/a&gt;&lt;/li&gt;\r\n    &lt;li class=\"ui-state-default ui-corner-top\"&gt;&lt;a href=\"#params-raw\"&gt;Raw&lt;/a&gt;&lt;/li&gt;\r\n  &lt;/ul&gt;\r\n  &lt;div id=\"params-fields\" class=\"ui-tabs-panel ui-widget-content ui-corner-bottom\"&gt;\r\n    &lt;table&gt;\r\n      &lt;tbody&gt;\r\n        &lt;tr indent=\"0\" name=\"expenseReceiptUri\" parampropindex=\"0\"&gt;\r\n          &lt;th&gt;&lt;span class=\"paramLabel\" style=\"left: 0px;\"&gt;expenseReceiptUri&lt;/span&gt;&lt;/th&gt;\r\n          &lt;td&gt;&lt;span style=\"left: 0px;\"&gt;&lt;input type=\"text\" placeholder=\"Uri (required)\" class=\"ui-autocomplete-input\" autocomplete=\"off\" role=\"textbox\" aria-autocomplete=\"list\" aria-haspopup=\"true\" style=\"color: rgb(153, 153, 153);\"&gt;&lt;/span&gt;&lt;span class=\"snowman\"\r\n              style=\"left: 0px;\"&gt;\u2603&lt;/span&gt;&lt;/td&gt;\r\n        &lt;/tr&gt;\r\n        &lt;tr&gt;\r\n          &lt;th&gt;&lt;/th&gt;\r\n          &lt;td&gt;&lt;input type=\"button\" value=\"Submit\" id=\"submit\" style=\"margin-top: 5px;\"&gt;&lt;span id=\"fields-notify\" class=\"notification\" style=\"display: none;\"&gt;&lt;/span&gt;&lt;/td&gt;\r\n        &lt;/tr&gt;\r\n      &lt;/tbody&gt;\r\n    &lt;/table&gt;\r\n  &lt;/div&gt;\r\n  &lt;div id=\"params-json\" class=\"ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide\"&gt; &lt;/div&gt;\r\n  &lt;div id=\"params-raw\" class=\"ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide\"&gt; &lt;textarea id=\"rawParams\"&gt;&lt;/textarea&gt;&lt;input type=\"button\" value=\"Submit\" id=\"submitRaw\"&gt;&lt;input type=\"button\" value=\"Format\" id=\"formatRaw\"&gt;&lt;input type=\"button\" value=\"From Fields \u2192\" id=\"fromFields\"&gt;&lt;input type=\"button\" value=\"\u2190 To Fields\" id=\"toFields\"&gt;\r\n    &lt;div\r\n      style=\"height:25px;\"&gt;\r\n      &lt;div id=\"raw-notify\" class=\"notification\" style=\"display: none;\"&gt;$nbsp;&lt;/div&gt;\r\n  &lt;/div&gt;\r\n&lt;/div&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "list", "loops", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1528899369, "post_id": 50839046, "comment_id": 88682697, "body": "you would want to write a standard for each or for loop to iterate through your cells (for i = 1 to lastrow) and ensure that there is a <i>wait</i> between steps, as the ie pages need time to load.  use your input code, wait, followed by your scrape code (not present in post, but assuming you have some), wait, then iterate through loop,"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 2, "last_activity_date": 1528899396, "creation_date": 1528899396, "answer_id": 50839494, "question_id": 50839046, "link": "https://stackoverflow.com/questions/50839046/how-to-loop-cell-values-from-excel-into-a-websites-text-box-with-vba/50839494#50839494", "title": "How to loop cell values from excel into a websites text box with VBA?", "body": "<p>How about something like below, this will open up your URL in internet explorer, then loop from A2 to your last cell on Column A with data and enter that value into the \"Txt Box ID\", it will then click on the button, then you can get the values you require before going back to the initial URL to repeat the process until the last row is reached:</p>\n\n<pre><code>Enum READYSTATE\n    READYSTATE_UNINITIALIZED = 0\n    READYSTATE_LOADING = 1\n    READYSTATE_LOADED = 2\n    READYSTATE_INTERACTIVE = 3\n    READYSTATE_COMPLETE = 4\nEnd Enum\n\nSub Test()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\") 'set the Sheet you are using here\nDim ie As New InternetExplorer\nDim HTML As HTMLDocument\nDim i As Long\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n'get the last row with a value in column A\nstrURL = \"https://www.xxxxxxxxxxxx.com\" 'set your initial URL here\n\nie.Visible = True\nie.navigate strURL\n\nDo While (ie.Busy Or ie.READYSTATE &lt;&gt; READYSTATE.READYSTATE_COMPLETE)\n  DoEvents\nLoop\n\nSet HTML = ie.document\n\nFor i = 2 To LastRow 'loop from row 2 to Last\n\n    Set svalue1 = HTML.getElementById(\"Txt Box ID\")\n\n    svalue1.Value = ws.Cells(i, 1).Value 'enter the value from currect cell\n\n    HTML.getElementsByName(\"Button Name\").Item.Click\n\n\n    Do While (ie.Busy Or ie.READYSTATE &lt;&gt; READYSTATE.READYSTATE_COMPLETE)\n      DoEvents\n    Loop\n\n\n    'Do your data scrapping here, then below go back to your initial URL to repeat the process\n\n    ie.navigate strURL\n\n    Do While (ie.Busy Or ie.READYSTATE &lt;&gt; READYSTATE.READYSTATE_COMPLETE)\n      DoEvents\n    Loop\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9765734"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 1, "accepted_answer_id": 50839494, "answer_count": 1, "score": 1, "last_activity_date": 1528899396, "creation_date": 1528898108, "last_edit_date": 1531164843, "question_id": 50839046, "link": "https://stackoverflow.com/questions/50839046/how-to-loop-cell-values-from-excel-into-a-websites-text-box-with-vba", "title": "How to loop cell values from excel into a websites text box with VBA?", "body": "<p>I have a list in excel that has roughly 1800 values in it (numbers, letters, etc.) I have to enter each one individually into a website with vba. Is there a way to loop these values starting with cell <strong>A1</strong>, then <strong>A2</strong>...<strong>A1800</strong> into the website one at a time?</p>\n\n<pre><code>Set svalue1 = ie.document.getElementById(\"Txt Box ID\")\n svalue1.Value = \"9B\"\n\nie.document.getElementsByName(\"Button Name\").Item.Click\n</code></pre>\n\n<p>Above is how I enter one value into that text box then click submit to get the data I need. I then have to return to the homepage after the data is scraped for value <strong>A1</strong>, copy <strong>cell</strong> <strong>A2</strong> and overwrite the textbox to input <strong>A2</strong> then scrape the data for that value too. That process needs to be repeated 1800 times All help is appreciated!</p>\n"}, {"tags": ["excel", "csv", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 4, "creation_date": 1528897765, "post_id": 50838901, "comment_id": 88681558, "body": "Please share your code. It&#39;s not easy to help without knowing how you are importing the data now."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1528897804, "post_id": 50838901, "comment_id": 88681590, "body": "Show us what you already have."}], "owner": {"reputation": 29, "user_id": 9684967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alok Nagar", "link": "https://stackoverflow.com/users/9684967/alok-nagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528897678, "creation_date": 1528897678, "last_edit_date": 1531164843, "question_id": 50838901, "link": "https://stackoverflow.com/questions/50838901/how-to-import-dynamic-numbers-of-csv-files-in-excel", "title": "How to import dynamic numbers of CSV files in Excel?", "body": "<p>I have created a macro which takes input as only a \"certain defined number\" of CSV files. But in case the number of CSV files vary then it creates an issue.</p>\n\n<p>E.g. in a current month I have 6 CSV files to import but next month it may be more than 6 . In that case, it only imports only 6 files.</p>\n\n<p>Can you please help me with a dynamic code which can import a different number of CSV files.</p>\n\n<p>Regards,\nAlok</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 4, "creation_date": 1528896881, "post_id": 50838508, "comment_id": 88680984, "body": "what is the error that you are getting?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1528902055, "post_id": 50838508, "comment_id": 88684572, "body": "Your code doesn&#39;t even compile."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 1, "creation_date": 1528906341, "post_id": 50838508, "comment_id": 88687165, "body": "Please read <a href=\"//meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1528906374, "post_id": 50838508, "comment_id": 88687192, "body": "@DavidZemens Yeah that&#39;s kind of hinted at already by OP saying &quot;it does not run&quot;."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1528907143, "post_id": 50838508, "comment_id": 88687631, "body": "@TylerH fair enough, and obvious enough to hopefully most of us, but &quot;it does not run&quot; isn&#39;t really a clear/unambiguous problem statement whereas &quot;I get a compile error&quot; removes all uncertainty."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1528907205, "post_id": 50838508, "comment_id": 88687675, "body": "@Zeta the basic code you need for this solution can be produced from the Macro Recorder if you simply perform the actions and record the macro. Please try that, and it can be modified if needed."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1528907290, "post_id": 50838508, "comment_id": 88687716, "body": "@DavidZemens I agree the question is too broad and needs more detail, but that&#39;s a separate matter best handled by close voting (not answering...)"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1528906587, "last_edit_date": 1528906587, "creation_date": 1528902622, "answer_id": 50840631, "question_id": 50838508, "link": "https://stackoverflow.com/questions/50838508/vba-macro-copying-worksheets-from-one-excel-file-to-another/50840631#50840631", "title": "VBA Macro: Copying worksheets from one Excel file to another", "body": "<p>Instead of <code>Sheets...</code> and <code>Copy ...</code> as two lines, try a single line: </p>\n\n<p><code>Sheets(Array(\"Sheet1\", \"Sheet2\")).Copy After:=Workbooks(\"w2.xlsm\").Sheets(Sheets.Count)</code></p>\n\n<p>This probably still won't work, or at least not reliably, because <code>Sheets.Count</code> may exceed the count of sheets in the destination workbook, so it is better to fully qualify all of your objects:</p>\n\n<pre><code>Sub Code()\n\nDim w1 as Workbook, w2 as Workbook\nSet w1 = Workbooks.Open(Filename:=\"C:\\Users\\xxx\\Desktop\\w1.xlsm\")\nSet w2 = Workbooks.Open(Filename:=\"C:\\Users\\xxx\\Desktop\\w2.xlsm\")  '## Modify as needed\n\nw1.Sheets(Array(\"Sheet1\", \"Sheet2\")).Copy After:=w2.Sheets(w2.Sheets.Count)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9936207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d5798c93cc60f53a2255a35b810b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Zeta", "link": "https://stackoverflow.com/users/9936207/zeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1528906587, "creation_date": 1528896542, "last_edit_date": 1528906316, "question_id": 50838508, "link": "https://stackoverflow.com/questions/50838508/vba-macro-copying-worksheets-from-one-excel-file-to-another", "title": "VBA Macro: Copying worksheets from one Excel file to another", "body": "<p>I need help on copying worksheets from one excel workbook to another. Currently, this is my code but it does not run:</p>\n\n<pre><code>Sub Code()\n\nWorkbooks.Open Filename:=\"C:\\Users\\xxx\\Desktop\\w1.xlsm\"\nSheets (Array(\"Sheet1\", \"Sheet2\"))\nCopy after:=Workbooks(\"w2.xlsm\").Sheets(Sheets.Count)\nWorkbooks(\"Client Info Template.xlsm\").Close savechanges:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1528898531, "post_id": 50839038, "comment_id": 88682112, "body": "Where should I parse your code? I removed the last two lines of the function and put it there. When running the code I get an error on &quot;rng As Word.Range&quot;. The error is &quot;User-defined type not defined&quot;. EDIT: I had to add the Word object library."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1528898865, "post_id": 50839038, "comment_id": 88682365, "body": "Or use <code>Dim rng as Object</code>  if you don&#39;t want to have a reference."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 2, "last_activity_date": 1528898093, "creation_date": 1528898093, "answer_id": 50839038, "question_id": 50838286, "link": "https://stackoverflow.com/questions/50838286/writing-bullet-list-in-word-from-excel-vba/50839038#50839038", "title": "Writing bullet list in Word, from Excel VBA", "body": "<p>Word has an AutoFormat functionality that can do this. AutoFormat can be applied to the entire document, or a Range. I recommend you write the content to a Range object, not a Selection, so that you can be sure of what's being affected.</p>\n\n<p>AutoFormat can do a lot of things, so it's necessary to specify what you want and don't want. I've included only the option for bulleted lists, below. Conceivably, you might want to turn other options off. You can find the entire listing in the Word language reference. Note that there's AutoFormat as well as AutoFormatAsYouType settings. You don't need to worry about the latter, but pay attention because some of the AutoFormat settings are listed alphabetically after AutoFormatAsYouType.</p>\n\n<pre><code>Dim rng as Word.Range\nSet rng = objWord.Selection.Range\nrng.Text = strEvap\nobjWord.Options.AutoFormatApplyBulletedLists = True\nrng.AutoFormat\n</code></pre>\n\n<p>*Although, if you use <code>.TypeText</code> it could conceivably work with AutoFormatAsYouType settings. But I personally prefer to <em>not</em> work with Selection and TypeText.</p>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1555, "favorite_count": 0, "accepted_answer_id": 50839038, "answer_count": 1, "score": 2, "last_activity_date": 1528898093, "creation_date": 1528895839, "question_id": 50838286, "link": "https://stackoverflow.com/questions/50838286/writing-bullet-list-in-word-from-excel-vba", "title": "Writing bullet list in Word, from Excel VBA", "body": "<p>I am adding words to a multi-line String <code>strEvap</code> in Excel. Some of the lines start with bullet points (the Bullet character \u2022). Example string:</p>\n\n<pre><code>3 Evaporateurs\n\u00c9vaporateur de type mural, mod\u00e8le --, \u00e0 installer et raccorder au condenseur, complet avec :\n\u2022 Alimentation \u00e9lectrique par l\u2019unit\u00e9 de condensation via un c\u00e2ble 14/3+Gnd\n\u2022 Moteurs ECM\n</code></pre>\n\n<p>Once my string is complete, I create a Word document and write the string to the Word document using the following code:</p>\n\n<pre><code>Function FnWriteToWordDoc(strEvap As String, strCond As String)\n   Dim objWord\n   Dim objDoc\n   Dim objSelection\n\n   Set objWord = CreateObject(\"Word.Application\")\n   Set objDoc = objWord.Documents.Add\n   objWord.Visible = True\n   Set objSelection = objWord.Selection\n   objSelection.TypeText (strEvap)\nEnd Function\n</code></pre>\n\n<p>This works fine. At this point, I have a Word document with the string written in the same style as my example above.</p>\n\n<p>MY QUESTION:</p>\n\n<p>How do I format the lines that start with a bullet to be recognized as part of a bullet list in Word? Ideally it would be done as I write to the document but I don't mind if it goes over all lines and makes them a bullet list if applicable at the end.</p>\n\n<p>So far I have the following piece of code that turns a selected line into a bullet list. It works on its own, but has to be used from the Word document, not my Excel code.</p>\n\n<pre><code>Sub RendreBulletDansWord()\n    Selection.Range.ListFormat.ApplyListTemplateWithLevel ListTemplate:= _\n        ListGalleries(wdBulletGallery).ListTemplates(1), ContinuePreviousList:= _\n        False, ApplyTo:=wdListApplyToWholeList, DefaultListBehavior:= _\n        wdWord10ListBehavior\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1528895697, "post_id": 50838142, "comment_id": 88680129, "body": "How many rows are you working with here?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1528895773, "post_id": 50838142, "comment_id": 88680184, "body": "Why do you create/get and destroy the Outlook application within your loop instead of outside it?"}, {"owner": {"reputation": 3, "user_id": 9777074, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joshua Toliver", "link": "https://stackoverflow.com/users/9777074/joshua-toliver"}, "edited": false, "score": 0, "creation_date": 1528896166, "post_id": 50838142, "comment_id": 88680466, "body": "RE: how many rows: around 60 it will be variable between 40 and 80 depending on the month. Each row is a new email,  Re: Create and destroy: kinda a novice to email procedures, that was how i got it to execute without error every time, can&#39;t recall the error that was like 2 days ago haha, I am open to suggestions."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1528896341, "post_id": 50838142, "comment_id": 88680612, "body": "Try these two: (1.) <code>For i = 1 To 10</code> instead of  Lastrow and (2.) delete <code>Set olMail = Nothing</code> and <code>Set olApp = Nothing</code>."}, {"owner": {"reputation": 3, "user_id": 9777074, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joshua Toliver", "link": "https://stackoverflow.com/users/9777074/joshua-toliver"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1528896691, "post_id": 50838142, "comment_id": 88680847, "body": "@Vityata: when you say 10, do you mean just make it a standard number like 80, in case there are 80 rows. We may have over 150 at some point? Why would lastrow cause an error in outlook?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1528896847, "post_id": 50838142, "comment_id": 88680960, "body": "@JoshuaToliver - I mean that is is a good idea to try with some small number to see whether the problem is somewhere else."}, {"owner": {"reputation": 3, "user_id": 9777074, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joshua Toliver", "link": "https://stackoverflow.com/users/9777074/joshua-toliver"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1528897111, "post_id": 50838142, "comment_id": 88681142, "body": "@vityata - no the code works, tested with 20 emails. It is something about having to open the 60ish emails with data and html formating, I ran it with and without the set olMail and set olApp = to nothing, no difference, still crashed excel."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9777074, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joshua Toliver", "link": "https://stackoverflow.com/users/9777074/joshua-toliver"}, "edited": false, "score": 0, "creation_date": 1528902613, "post_id": 50839401, "comment_id": 88684963, "body": "What does .close 1 mean?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 3, "user_id": 9777074, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joshua Toliver", "link": "https://stackoverflow.com/users/9777074/joshua-toliver"}, "edited": false, "score": 0, "creation_date": 1528903349, "post_id": 50839401, "comment_id": 88685390, "body": "@JoshuaToliver more detail <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-close-method-outlook\" rel=\"nofollow noreferrer\">here</a>. Note that you can simplify <code>.Save</code> and <code>.Close 1</code> to just <code>.Close olSave</code>."}, {"owner": {"reputation": 3, "user_id": 9777074, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joshua Toliver", "link": "https://stackoverflow.com/users/9777074/joshua-toliver"}, "edited": false, "score": 0, "creation_date": 1528909975, "post_id": 50839401, "comment_id": 88689083, "body": "Okay, I added that code in with something else, I added a send feature depending if there is a recipient (email recipient) in my list and it will save as a draft if there is no email recipient. Now I get an error on .send"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 3, "user_id": 9777074, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joshua Toliver", "link": "https://stackoverflow.com/users/9777074/joshua-toliver"}, "edited": false, "score": 0, "creation_date": 1528930610, "post_id": 50839401, "comment_id": 88698251, "body": "@JoshuaToliver if the question has been answered you may accept the answer. Regardless of acceptance, if you have a new question generate a new question post."}, {"owner": {"reputation": 117, "user_id": 7499014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cd9cb72d37fb8ffa70e0bfe7f05c09?s=128&d=identicon&r=PG&f=1", "display_name": "Denyo", "link": "https://stackoverflow.com/users/7499014/denyo"}, "edited": false, "score": 0, "creation_date": 1528975517, "post_id": 50839401, "comment_id": 88715182, "body": ".Close olSave does not worked for my excel version 2010. thats why i used .save and .close 1"}], "tags": [], "owner": {"reputation": 117, "user_id": 7499014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cd9cb72d37fb8ffa70e0bfe7f05c09?s=128&d=identicon&r=PG&f=1", "display_name": "Denyo", "link": "https://stackoverflow.com/users/7499014/denyo"}, "is_accepted": true, "score": 1, "last_activity_date": 1528899141, "creation_date": 1528899141, "answer_id": 50839401, "question_id": 50838142, "link": "https://stackoverflow.com/questions/50838142/excel-vba-code-generates-emails-but-crashes-outlook/50839401#50839401", "title": "Excel VBA code generates emails but crashes Outlook", "body": "<p>Out of memory issue, when it relies on the amount of email you generate.\nAdd a save and a close into your loop to avoid getting out of memory.</p>\n\n<p>For my version of Excel (2010) the following worked fine reducing memory usage:</p>\n\n<pre><code>With olMail\n   .To = Cells(i, 2).Value\n   .Subject = Format(MonthName(Month(Now))) &amp; \" - Margin Leak - \" &amp; Cells(i, 1).Value\n   .display\n   .HTMLBody = MailMessage\n   .Attachments.Add (\"C:\\Users\\u\\Desktop\\test.xls\")\n   .Save\n   .Close 1\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9777074, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joshua Toliver", "link": "https://stackoverflow.com/users/9777074/joshua-toliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 0, "accepted_answer_id": 50839401, "answer_count": 1, "score": 0, "last_activity_date": 1528899141, "creation_date": 1528895428, "last_edit_date": 1531164843, "question_id": 50838142, "link": "https://stackoverflow.com/questions/50838142/excel-vba-code-generates-emails-but-crashes-outlook", "title": "Excel VBA code generates emails but crashes Outlook", "body": "<p>This code below creates (it does not send because they need visual verification) several emails (about 60) with 2 attachments, one is 209KB pptx ( I compressed it down as far as I could) and an .xlsb file (30Kb - 700kb depending).\nText is in HTML just cause we require some highlighting. I thought this would be better than calling a template out of outlook but if thats wrong let me know, I cant find any info about that.</p>\n\n<p>The issue is while it will generate all the emails and attach all the files, it freezes my outlook to the point I have to close everything and restart from the task manager. I have waiting on it for over an hour to see if it works but it just generates the emails and then freezes. I can see the emails through my taskbar but i can't select them or my outlook inbox.</p>\n\n<p>Any idea how to over come this?</p>\n\n<pre><code>Sub email()\nDim olApp As Outlook.Application\nDim olMail As Outlook.MailItem\nDim MailMessage As String\nDim CusName As String\nDim Lastrow As Long\nDim i As Long\n\nApplication.ScreenUpdating = False\n\nCall getemails\n\n\nMailMessage = \"&lt;HTML&gt;&lt;BODY&gt; Hello, &lt;br&gt;&lt;br&gt;\" _\n        &amp; \"Attached you will find your trailing 12 month (TTM) margin leak \nreport which was discussed on the Best Practices call in August. (Deck from \nmeeting attached as well)&lt;br&gt;&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"&lt;li&gt; Tab 1 shows margin leak by item&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"&lt;li&gt;Tab 2 shows margin leak by vendor then by item&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"&lt;li&gt;Tab 3 is data tab where you can see all the data&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"Tab 1 and 2 includes a filter at the top so you can look at or \nexclude specific PCATs.&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"&lt;b&gt;Key definitions of fields on data tab:&lt;/b&gt;&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"&lt;li&gt;Base Price, Base Cost, Base Margin \u2013 Price, Cost and Margin \ndollars prior to margin leak&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"Thank you,&lt;br&gt;&lt;br&gt;\" _\n\n\nLastrow = Range(\"A\" &amp; rows.Count).End(xlUp).Row\nFor i = 1 To Lastrow\nSet olApp = GetObject(Class:=\"Outlook.Application\")\n\nIf olApp Is Nothing Then\n\nSet olApp = CreateObject(Class:=\"outlook.application\")\n\nEnd If\n\nSet olMail = olApp.CreateItem(0)\n\nWith olMail\n    .To = Cells(i, 2).Value\n    .Subject = Format(MonthName(Month(Now))) &amp; \" - Margin Leak - \" &amp; Cells(i, \n1).Value\n    .display\n    .HTMLBody = MailMessage\n    .Attachments.Add (\"C:\\Linking_Files\\Best Practices Margin Leak.pptx\")\n    .Attachments.Add (\"C:\\Desktop\\June\\\" &amp; Cells(i, 1).Value &amp; \".xlsb\")\n\nEnd With\n\nSet olMail = Nothing\nSet olApp = Nothing\n\nNext i\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 3, "last_activity_date": 1528919736, "last_edit_date": 1528919736, "creation_date": 1528896296, "answer_id": 50838427, "question_id": 50838029, "link": "https://stackoverflow.com/questions/50838029/extract-heading-from-word-to-excel/50838427#50838427", "title": "Extract Heading from Word to Excel", "body": "<p>You can get the Heading (defined by having applied one of nine possible Heading styles) for a particular location using a built-in bookmark having the name <code>\\HeadingLevel</code>. For this to work, the selection needs to be at that Range. This returns the <em>entire text under the heading</em>, so it needs to be collapsed to its starting point, then the code works with that paragraph to get the ListString (numbering) and the text.</p>\n\n<p>The Range of a comment in a document is the <code>Comment.Reference</code>.</p>\n\n<p>Building on your code the following works in my test environment (Word):</p>\n\n<pre><code>Dim rngComment As Word.Range, rngHeading As Word.Range\n\nSet rngComment = oComment.Reference\nrngComment.Select\nSet rngHeading = ActiveDocument.Bookmarks(\"\\HeadingLevel\").Range\nrngHeading.Collapse wdCollapseStart\nSet rngHeading = rngHeading.Paragraphs(1).Range\nDebug.Print rngHeading.ListFormat.ListString &amp; \" \" &amp; rngHeading.Text\n</code></pre>\n\n<p>I can't duplicate your environment, but the following should work</p>\n\n<pre><code> For i = 1 To wDoc.Comments.Count\n   Set oComment = wDoc.Comments(i)\n   Set rngComment = oComment.Reference\n   rngComment.Select\n   Set rngHeading = wDoc.Bookmarks(\"\\HeadingLevel\").Range\n   rngHeading.Collapse wdCollapseStart\n   Set rngHeading = rngHeading.Paragraphs(1).Range\n  .Offset(i, 0) = oComment.Index\n  .Offset(i, 1) = oComment.Reference.Information(wdActiveEndAdjustedPageNumber)\n  .Offset(i, 2) = oComment.Initial    \n  .Offset(i, 3) = oComment.Author\n  .Offset(i, 4) = Format(oComment.Date, \"mm/dd/yyyy\")\n  .Offset(i, 5) = oComment.Range\n  .Offset(i, 6) = rngHeading.ListFormat.ListString &amp; \" \" &amp; rngHeading.Text\nNext i\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7242409"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1257, "favorite_count": 0, "accepted_answer_id": 50838427, "answer_count": 1, "score": 2, "last_activity_date": 1528921242, "creation_date": 1528895113, "last_edit_date": 1528918071, "question_id": 50838029, "link": "https://stackoverflow.com/questions/50838029/extract-heading-from-word-to-excel", "title": "Extract Heading from Word to Excel", "body": "<p>I have a word document that contains comments. I have written a script to extract to Excel:</p>\n\n<ol>\n<li>Comment Number</li>\n<li>Page Number</li>\n<li>Commenter's First Initial</li>\n<li>Commenter's Last Name</li>\n<li>The Date the comment was written</li>\n<li>The Actual Comment</li>\n</ol>\n\n<p>The issue I can't figure out is I need to also extract the Heading number and the text of that heading. I need a 7th column for the Heading that the comment is located in. For example, let's say I had a comment in a section that was under Heading \"4.1 This is a heading\". I need Heading number (4.1) and Heading Text (This is a heading) to be extracted along with the related comment. </p>\n\n<p>To create Headings, I utilized the Headings function within Word on the Home tab of the Ribbon under Styles, .</p>\n\n<p>Here's what i've written so far:</p>\n\n<pre><code> Sub Export_Comments()\n\n' Purpose: Search for comments in any text that's been pasted into\n' this document, then export them into a new Excel spreadsheet.\n' Requires reference to Microsoft Excel 15.0 Object Library in VBA,\n' which should already be saved with as part of the structure of\n' this .docm file.\n\nDim bResponse As Integer\n\n' Exit routine if no comments have been found.\nIf ActiveDocument.Comments.Count = 0 Then\n  MsgBox (\"No comments found in this document\")\n  Exit Sub\nElse\n  bResponse = MsgBox(\"Do you want to export all comments to an Excel worksheet?\", _\n              vbYesNo, \"Confirm Comment Export\")\n  If bResponse = 7 Then Exit Sub\nEnd If\n\n' Create a object to hold the contents of the\n' current document and its text. (Shorthand\n' for the ActiveDocument object.\nDim wDoc As Document\nSet wDoc = ActiveDocument\n\n' Create objects to help open Excel and create\n' a new workbook behind the scenes.\nDim xlApp As Excel.Application\nDim xlWB As Excel.Workbook\n\nDim i As Integer\nDim oComment As Comment         'Comment object\n\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = False\n\n' Create a new Workbook. Shouldn't interfere with\n' other Workbooks that are already open. Will have\n' at least one worksheet by default.\nSet xlWB = xlApp.Workbooks.Add\n\nWith xlWB.Worksheets(1).Range(\"A1\")\n\n  ' Create headers for the comment information\n  .Offset(0, 0) = \"Comment Number\"\n  .Offset(0, 1) = \"Page Number\"\n  .Offset(0, 2) = \"Reviewer Initials\"\n  .Offset(0, 3) = \"Reviewer Name\"\n  .Offset(0, 4) = \"Date Written\"\n  .Offset(0, 5) = \"Comment Text\"\n\n  ' Export the actual comments information\n  For i = 1 To wDoc.Comments.Count\n\n    Set oComment = wDoc.Comments(i)\n    .Offset(i, 0) = oComment.Index                                                'Comment Number\n    .Offset(i, 1) = oComment.Reference.Information(wdActiveEndAdjustedPageNumber) 'Page Number\n    .Offset(i, 2) = oComment.Initial                                              'Author Initials\n    .Offset(i, 3) = oComment.Author                                               'Author Name\n    .Offset(i, 4) = Format(oComment.Date, \"mm/dd/yyyy\")                           'Date of Comment\n    .Offset(i, 5) = oComment.Range                                                'Actual Comment\n  Next i\n\nEnd With\n\n' Make the Excel workbook visible\nxlApp.Visible = True\n\n' Clean up our objects\nSet oComment = Nothing\nSet xlWB = Nothing\nSet xlApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1528894965, "post_id": 50837973, "comment_id": 88679661, "body": "Which line errors?"}, {"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528895218, "post_id": 50837973, "comment_id": 88679811, "body": "run-time error &#39;1004&#39;: application-defined or object-defined error"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1528895263, "post_id": 50837973, "comment_id": 88679848, "body": "Saverio, the question of SJR was on which line is the error."}, {"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "edited": false, "score": 0, "creation_date": 1528895322, "post_id": 50837973, "comment_id": 88679878, "body": "immediately after the wkbk=open(path)  as soon as the program opens the file (either with f8 or running the entire code), it gives the error"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1528895397, "post_id": 50837973, "comment_id": 88679923, "body": "@Saverio - does the worksheet <code>&quot;Southern_Europe&quot;</code> exist?"}, {"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "edited": false, "score": 0, "creation_date": 1528895516, "post_id": 50837973, "comment_id": 88679999, "body": "Vityata below spotted the error! thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1528895139, "creation_date": 1528895139, "answer_id": 50838043, "question_id": 50837973, "link": "https://stackoverflow.com/questions/50837973/copy-paste-automatic-range-from-one-workbook-to-another/50838043#50838043", "title": "copy paste automatic range from one workbook to another", "body": "<p>Change:</p>\n\n<pre><code>Set StartCell = Range(\"D1\")\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Set StartCell = sht.Range(\"D1\")\n</code></pre>\n\n<p>You are using the <code>StartCell</code> here:</p>\n\n<pre><code>wkbk.Worksheets(\"Southern_Europe\").Range(StartCell, sht.Cells(LastRow, LastColumn - 5)).Copy\n</code></pre>\n\n<p>And if the <code>StartCell</code> is not declared correctly, it does not belong to the worksheet \"Southern_Europe\". On the contrary, it takes the <code>ActiveSheet</code> or the worksheet in which it is currently.</p>\n"}], "owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 50838043, "answer_count": 1, "score": 1, "last_activity_date": 1528895139, "creation_date": 1528894903, "question_id": 50837973, "link": "https://stackoverflow.com/questions/50837973/copy-paste-automatic-range-from-one-workbook-to-another", "title": "copy paste automatic range from one workbook to another", "body": "<p>So I am trying to perform a copy past from one book to another. i searched everywhere in the web but, i must admin, I am not that into VBA so to understand properly the solutions people are providing. The code I wrote is this. \nStep by step:\nI define the variables. Define the ranges from where to take the year, month and day corresponding to the file i want to open. I open the file. I set the destination book as my current book (where i put the button). Then I want to find the automatic range of my tab (since everyday changes) and i perform a counting of columns (-5 since i do not need the last 5 columns) and rows as discussed in various courses. But.. the code stops after I open the book (wkbk). Why is that? The error that comes out is: application defined or object defined error.</p>\n\n<pre><code>    Sub Opentrading()\n\nDim FolderPath As String\nDim Path As String\nDim nyear As String\nDim nmont As String\nDim nday As String\nDim wkbk As Workbook\nDim mybook As Workbook\nDim LastRow As Long\nDim LastColumn As Long\nDim StartCell As Range\nDim sht As Worksheet\n\nFolderPath = \"F:\\FICM\\Trading Runs\\Daily Trading Runs\"\nnyear = Sheet6.Range(\"J3\")\nnmont = Sheet6.Range(\"J5\")\nnday = Sheet6.Range(\"J7\")\nPath = FolderPath &amp; \"\\\" &amp; nyear &amp; \"-\" &amp; nmont &amp; \"-\" &amp; nday &amp; \" Trading - Southern_Europe\" &amp; \".xlsx\"\nSet mybook = ThisWorkbook\nSet wkbk = Workbooks.Open(Path)\nSet sht = wkbk.Sheets(\"Southern_Europe\")\n\n'Find Last Row and Column\nSet StartCell = Range(\"D1\")\n  LastRow = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).Row\n  LastColumn = sht.Cells(StartCell.Row, sht.Columns.Count).End(xlToLeft).Column\n\n'Select Range\n wkbk.Worksheets(\"Southern_Europe\").Range(StartCell, sht.Cells(LastRow, LastColumn - 5)).Copy mybook.Worksheets(\"Prova\").Range(\"Z1\")\n\n  wkbk.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1528900520, "post_id": 50837952, "comment_id": 88683509, "body": "You don&#39;t need the Load statement<a href=\"https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-basic-6/aa445825(v%3dvs.60)\" rel=\"nofollow noreferrer\">see remark here</a> . You shouldn&#39;t need to use <code>.Hide</code> after unloading it either."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1528901234, "post_id": 50837952, "comment_id": 88684016, "body": "Thank you, that&#39;s useful to know! However, it doesn&#39;t solve the issue I&#39;m describing."}], "answers": [{"comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1528896842, "post_id": 50838490, "comment_id": 88680954, "body": "Thank you for your answer! No, it&#39;s a bare naked fresh excel 2016 installation."}], "tags": [], "owner": {"reputation": 3, "user_id": 9777074, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joshua Toliver", "link": "https://stackoverflow.com/users/9777074/joshua-toliver"}, "is_accepted": false, "score": 0, "last_activity_date": 1528896490, "creation_date": 1528896490, "answer_id": 50838490, "question_id": 50837952, "link": "https://stackoverflow.com/questions/50837952/unresponsive-ribbon-after-opening-new-workbook-excel-2016-vba/50838490#50838490", "title": "Unresponsive ribbon after opening new workbook Excel 2016 VBA", "body": "<p>Do you have any Add-Ins enabled on your Excel outside of the standard. For Example I use a Utility product called ASAP and the executable files that trigger events overwrite each other when i start up my excel. It will lock the ribbon the first time i open excel so i create a new excel everytime after i open my first excel</p>\n"}, {"comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1549625459, "post_id": 54590280, "comment_id": 95979206, "body": "Thank you for your answer! In my case this issue stopped randomly. If however it starts coming up again, I will make sure to try your solution!"}], "tags": [], "owner": {"reputation": 11, "user_id": 11033016, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/4ef11b411fab56fdf29847472fa63b8f?s=128&d=identicon&r=PG", "display_name": "Teo", "link": "https://stackoverflow.com/users/11033016/teo"}, "is_accepted": false, "score": 1, "last_activity_date": 1549621300, "creation_date": 1549621300, "answer_id": 54590280, "question_id": 50837952, "link": "https://stackoverflow.com/questions/50837952/unresponsive-ribbon-after-opening-new-workbook-excel-2016-vba/54590280#54590280", "title": "Unresponsive ribbon after opening new workbook Excel 2016 VBA", "body": "<p>I faced the same issue on a stock excel when opening only 1 workbook. Ribbons will be enabled again when adding this after Workbooks.open :</p>\n\n<pre><code>    ThisWorkbook.Activate\n    Workbooks(\"*openedWorkbookName*\").Activate\n</code></pre>\n\n<p>Btw, some older code lead to runtime errors when selecting a Cell in a Worksheet which is not currently activated. This helped for that issue as well.  </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11214742, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/646e3515b58e9dad8a321c4afa845b5a?s=128&d=identicon&r=PG", "display_name": "Rob Gair", "link": "https://stackoverflow.com/users/11214742/rob-gair"}, "is_accepted": false, "score": 0, "last_activity_date": 1552784908, "creation_date": 1552784908, "answer_id": 55202998, "question_id": 50837952, "link": "https://stackoverflow.com/questions/50837952/unresponsive-ribbon-after-opening-new-workbook-excel-2016-vba/55202998#55202998", "title": "Unresponsive ribbon after opening new workbook Excel 2016 VBA", "body": "<p>I am using an Excel macro to create new workbooks and populate them with data (Office 365).</p>\n\n<pre><code>Public New_Wb As Workbook\nPublic New_Book_Name as String\n\nWorkbooks.Add\nNew_Book_Name = ActiveWorkbook.Name\nSet New_Wb = ActiveWorkbook\n</code></pre>\n\n<p>I too ran into the issue that the new workbook would be partially active when the macro finished. I could work within the workbook cells, but the ribbon was inactive. Tabbing away and tabbing back to the new workbook activated the ribbon, but it was an annoyance. I noticed that right clicking within the workbook was enough to activate the ribbon. Weird, yeah. So I tracked down code to force a right and then left mouse click event once the macro was finished (below). It's a real kludge, but it happens so fast it's not visible, and leaves the ribbon in an active state.</p>\n\n<pre><code>Public Declare Sub mouse_event Lib \"user32\" (ByVal dwFlags As Long, ByVal dx As Long, ByVal dy As Long, ByVal cButtons As Long, ByVal dwExtraInfo As Long)\nPublic Const MOUSEEVENTF_LEFTDOWN = &amp;H2\nPublic Const MOUSEEVENTF_LEFTUP = &amp;H4\nPublic Const MOUSEEVENTF_RIGHTDOWN As Long = &amp;H8\nPublic Const MOUSEEVENTF_RIGHTUP As Long = &amp;H10\n</code></pre>\n\n<p>... after the workbook has been populated ...</p>\n\n<pre><code>New_Wb.activate\n\nmouse_event MOUSEEVENTF_RIGHTDOWN, 0, 0, 0, 0\nmouse_event MOUSEEVENTF_RIGHTUP, 0, 0, 0, 0\n\nmouse_event MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0\nmouse_event MOUSEEVENTF_LEFTUP, 0, 0, 0, 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13567232, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/be752cd5b8c32af3df5031e03bf0bd28?s=128&d=identicon&r=PG", "display_name": "TonMai2K", "link": "https://stackoverflow.com/users/13567232/tonmai2k"}, "is_accepted": false, "score": 1, "last_activity_date": 1589880618, "last_edit_date": 1589880618, "creation_date": 1589804736, "answer_id": 61869553, "question_id": 50837952, "link": "https://stackoverflow.com/questions/50837952/unresponsive-ribbon-after-opening-new-workbook-excel-2016-vba/61869553#61869553", "title": "Unresponsive ribbon after opening new workbook Excel 2016 VBA", "body": "<p>I know that it's past years but I think this can help someone.</p>\n\n<p>I faced to this problem too. I found answer somewhere that this problem can solve by hide userform -before- open worksheet.</p>\n\n<p>So, just re-arrange commands like this.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nUserForm1.Hide 'or Me.Hide\nIf OptionButton1 Then\n    Workbooks.Open (\"filename.xls\")\nElse\n    Workbooks.Open (\"filename1.xls\")\n    Workbooks.Open (\"filename2.xls\")\nEnd If\nUnload UserForm1 'if you still want it\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 1, "answer_count": 4, "score": 3, "last_activity_date": 1589880618, "creation_date": 1528894838, "last_edit_date": 1528901549, "question_id": 50837952, "link": "https://stackoverflow.com/questions/50837952/unresponsive-ribbon-after-opening-new-workbook-excel-2016-vba", "title": "Unresponsive ribbon after opening new workbook Excel 2016 VBA", "body": "<p>I'm quite a rookie when it comes to programming, however I have been able to build a couple of useful applications in excel, which automate some of my everyday tasks.  </p>\n\n<p>Currently I am having an annoying issue when trying to open a new workbook using <code>workbooks.open()</code> in Excel 2016.  </p>\n\n<p>I have made a workbook with a button which calls a userform. Once the form is launched, the user can select to download and open several types of .xls files. When the user clicks the form's OK button all the appropriate functions are called, the selected workbooks are opened and the form gets unloaded and hidden.  </p>\n\n<p>However, the ribbon of the last workbook that was opened, which btw is the one that is currently active, is unresponsive and the only way to overcome this, is to ALT+TAB between open windows.   </p>\n\n<p>It seems like the \"focus\" is still on the initial workbook with the button, because if I call a <code>Msgbox</code> after the form is unloaded, that's where it appears. It's worth mentioning that this happens although the initial workbook is not the one that's active!  </p>\n\n<p>After doing some experimenting I was able to solve the issue by disabling <code>Application.ScreenUpdating</code> when my function is called and then re-enabling it just before the form is unloaded.  </p>\n\n<p>This however only works when multiple workbooks are being opened at the same time. If the user chooses to open only one workbook then the problem persists.\nI came across a suggestion to make the userform modeless, which indeed solves the issue but creates other kinds of unwanted behavior.  </p>\n\n<p>A simplified version of the code which replicates the problem is as follows:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nApplication.ScreenUpdating = False 'solves the issue but only for multiple files - comment out to replicate the problem\nIf OptionButton1 Then\n    Workbooks.Open (\"http://www.admie.gr/fileadmin/user_upload/reports/DayAheadSchedulingUnitAvailabilities/20180602_DayAheadSchedulingUnitAvailabilities_01.xls\")\nElse\n    Workbooks.Open (\"http://www.admie.gr/fileadmin/user_upload/reports/DayAheadSchedulingUnitAvailabilities/20180603_DayAheadSchedulingUnitAvailabilities_01.xls\")\n    Workbooks.Open (\"http://www.admie.gr/fileadmin/user_upload/reports/DayAheadSchedulingUnitAvailabilities/20180604_DayAheadSchedulingUnitAvailabilities_01.xls\")\nEnd If\nApplication.ScreenUpdating = True 'solves the issue but only for multiple files - comment out to replicate the problem\nUnload UserForm1\nUserForm1.Hide\nMsgBox ActiveWorkbook.Name 'for debugging purposes - comment out to replicate the problem - the msgbox will be displayed on the workbook which called the userform, although it's not the active one\nEnd Sub\n\nSub Button1_Click() 'calls the userform\nUserForm1.OptionButton1.Value = True\nLoad UserForm1\nUserForm1.Show vbModeless 'comment out to replicate the problem - solves the issue but creates unwanted behavior\nEnd Sub\n</code></pre>\n\n<p>Has anyone dealt with this before?  </p>\n\n<p>What would you suggest?   </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1528893377, "post_id": 50837206, "comment_id": 88678546, "body": "I might be misunderstanding the question, but is there a reason you can&#39;t store the value of calling <code>FirstNumeric</code> into a variable, then just reference the variable?"}, {"owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1528980696, "post_id": 50837206, "comment_id": 88718483, "body": "There was nothing preventing me from doing so, my brain was fried at the time. Sometimes the most simple of answers slip away from us haha"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1528893960, "creation_date": 1528893960, "answer_id": 50837674, "question_id": 50837206, "link": "https://stackoverflow.com/questions/50837206/how-to-have-function-firstnumeric-be-run-only-once/50837674#50837674", "title": "How to have Function &quot;FirstNumeric&quot; be run only once?", "body": "<p>Hold it in a variable which you load to once, but refer to twice. - Like so:</p>\n\n<pre><code>Dim FirNum As Integer\n\n'Stop if no contract\nDo Until MyContract = \"\"\n\n        FirNum = FirstNumeric(MyContract)\n\n        'Write Office\n        Worksheets(\"Sheet1\").Range(\"F\" &amp; MyIndex) = UCase(Mid(MyContract, 1, (FirNum - 1)))\n\n        'Remove Office\n        MyContract = Mid(MyContract, FirNum)\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 50837674, "answer_count": 1, "score": 1, "last_activity_date": 1528893960, "creation_date": 1528892580, "last_edit_date": 1531164843, "question_id": 50837206, "link": "https://stackoverflow.com/questions/50837206/how-to-have-function-firstnumeric-be-run-only-once", "title": "How to have Function &quot;FirstNumeric&quot; be run only once?", "body": "<p>I'm currently writing a program in Excel using VBA that takes contract numbers (Alphanumeric string) that consists of three parts:</p>\n\n<p>Office - Two or three alpha characters at the beginning of a string (upper or Lowercase)</p>\n\n<p>Example: \"abc\" </p>\n\n<p>Base - four or five numbers in the middle of the string</p>\n\n<p>Example: \"12345\"</p>\n\n<p>Comparative - A single Alpha character at the end of the string (not all strings will have this)</p>\n\n<p>Example: \"E\"</p>\n\n<p>Example of Contract Number: \"abc12345E</p>\n\n<p>I have a column of these contract numbers in column E in a spreadsheet and I have written code to separate the \"Office\" portion in column F, \"Base\" in column G, and \"Comparative\" in column H. </p>\n\n<p>My issue is that I have a function called \"FirstNumeric\" that is used to find where in the string my numeric characters start so it can be separated at those points. But I only want to call this function once. In my code, I call it twice. How can I write this code so that the function is called only once?</p>\n\n<pre><code> Public Sub PharseContractNumber()\n    Dim MyContract As String\n    Dim MyIndex As Integer\n\n    'Set Index to first process row\n    MyIndex = 3\n\n    'Get First Contract\n    MyContract = UCase(Trim(Worksheets(\"Sheet1\").Range(\"E\" &amp; MyIndex)))  'Tells which column the original strings are in, so they can be transformed\n\n    'Stop if no contract\n    Do Until MyContract = \"\"\n\n            'Write Office\n            Worksheets(\"Sheet1\").Range(\"F\" &amp; MyIndex) = UCase(Mid(MyContract, 1, (FirstNumeric(MyContract) - 1)))\n\n            'Remove Office\n            MyContract = Mid(MyContract, (FirstNumeric(MyContract)))\n\n            'Check for Trailing Alpha Character\n            If Not (IsNumeric(Mid(MyContract, Len(MyContract)))) Then\n\n                'Write Comparative\n                Worksheets(\"Sheet1\").Range(\"H\" &amp; MyIndex) = UCase(Mid(MyContract, (Len(MyContract))))\n\n                'Remove Comparative\n                MyContract = Mid(MyContract, 1, Len(MyContract) - 1)   'removes the Comparative portion of the original string in the Base Column\n\n            End If\n\n            'Write Remaining ... Base number\n            Worksheets(\"Sheet1\").Range(\"G\" &amp; MyIndex) = UCase(MyContract) 'writes in the base number\n\n        'Advance Index\n        MyIndex = MyIndex + 1\n\n        'Get Next Contract\n        MyContract = Trim(Worksheets(\"Sheet1\").Range(\"E\" &amp; MyIndex))\n    Loop\n\n    End Sub\n\n    Private Function FirstNumeric(PassContract) As Integer\n    Dim i As Integer\n\n    FirstNumeric = 0\n\n    For i = 1 To Len(PassContract) + 1\n        If IsNumeric(Mid(PassContract, i, 1)) Then\n            FirstNumeric = i\n            Exit For\n\n        End If\n    Next\n\n    End Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 0, "creation_date": 1528891407, "post_id": 50836681, "comment_id": 88677237, "body": "So just to be clear, you want a single message box to say &quot;The ID x is used multiple times at [Location 1], [Location 2], [Location 3], [Location 4], etc...&quot;, correct?"}, {"owner": {"reputation": 153, "user_id": 3701825, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670577746/picture?type=large", "display_name": "Hris", "link": "https://stackoverflow.com/users/3701825/hris"}, "reply_to_user": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 0, "creation_date": 1528891464, "post_id": 50836681, "comment_id": 88677279, "body": "That `s right-to show all found cells"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528892171, "post_id": 50836681, "comment_id": 88677693, "body": "Why not use COUNTIF?"}, {"owner": {"reputation": 153, "user_id": 3701825, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670577746/picture?type=large", "display_name": "Hris", "link": "https://stackoverflow.com/users/3701825/hris"}, "edited": false, "score": 0, "creation_date": 1528893570, "post_id": 50836681, "comment_id": 88678682, "body": "Because I want to do it as a macro"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 3701825, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670577746/picture?type=large", "display_name": "Hris", "link": "https://stackoverflow.com/users/3701825/hris"}, "edited": false, "score": 0, "creation_date": 1528895197, "post_id": 50837896, "comment_id": 88679800, "body": "A made a msgbx: <code>MsgBox dDupeChecker(CStr(rLookAt.Value)) &amp; &quot;,&quot; &amp; rLookAt.Address</code> but it shows the second duplicate twice"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 153, "user_id": 3701825, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670577746/picture?type=large", "display_name": "Hris", "link": "https://stackoverflow.com/users/3701825/hris"}, "edited": false, "score": 0, "creation_date": 1528895253, "post_id": 50837896, "comment_id": 88679842, "body": "Yes, cause you&#39;ve added it rlookat.address, you don&#39;t need to, it&#39;s stored in the dictionary"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1528894680, "creation_date": 1528894680, "answer_id": 50837896, "question_id": 50836681, "link": "https://stackoverflow.com/questions/50836681/vba-count-and-print-every-cell-address-when-a-duplicate-value-is-found/50837896#50837896", "title": "VBA count and print every cell address when a duplicate value is found", "body": "<p>You could do something like this, calling <code>SetUpDictionary</code> first, then using the <code>CheckDupe</code> function to check</p>\n\n<pre><code>Private dDupeChecker As Scripting.Dictionary\n\nFunction CheckDupe(rCheck As Excel.Range) As String\n    If dDupeChecker.Exists(CStr(rCheck.Value)) Then\n        CheckDupe = dDupeChecker(CStr(rCheck.Value))\n    Else\n        CheckDupe = \"Ok, not a duplicate\"\n    End If\nEnd Function\n\nSub SetUpDictionary()\n\nDim rFindOn As Excel.Range\nDim rLookAt As Excel.Range\n\nSet dDupeChecker = New Scripting.Dictionary\n\nSet rFindOn = Range(\"a1:a10\")\n\nFor Each rLookAt In rFindOn.Cells\n    If dDupeChecker.Exists(CStr(rLookAt.Value)) Then\n        dDupeChecker(CStr(rLookAt.Value)) = dDupeChecker(CStr(rLookAt.Value)) &amp; \",\" &amp; rLookAt.Address\n    Else\n        dDupeChecker.Add CStr(rLookAt.Value), rLookAt.Address\n    End If\nNext rLookAt\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 3701825, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670577746/picture?type=large", "display_name": "Hris", "link": "https://stackoverflow.com/users/3701825/hris"}, "edited": false, "score": 0, "creation_date": 1528895975, "post_id": 50838071, "comment_id": 88680335, "body": "Here I received type mismatch <code>If Len(pcs) &gt; 1 Then</code>"}, {"owner": {"reputation": 153, "user_id": 3701825, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670577746/picture?type=large", "display_name": "Hris", "link": "https://stackoverflow.com/users/3701825/hris"}, "edited": false, "score": 0, "creation_date": 1528897243, "post_id": 50838071, "comment_id": 88681226, "body": "and here I think it must be <code>For Each i &quot;not k&quot; In objDic.Keys</code>"}, {"owner": {"reputation": 153, "user_id": 3701825, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670577746/picture?type=large", "display_name": "Hris", "link": "https://stackoverflow.com/users/3701825/hris"}, "edited": false, "score": 0, "creation_date": 1528956928, "post_id": 50838071, "comment_id": 88704159, "body": "But it works in printing all of the cells for every value :D"}], "tags": [], "owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "is_accepted": true, "score": 1, "last_activity_date": 1528897540, "last_edit_date": 1528897540, "creation_date": 1528895220, "answer_id": 50838071, "question_id": 50836681, "link": "https://stackoverflow.com/questions/50836681/vba-count-and-print-every-cell-address-when-a-duplicate-value-is-found/50838071#50838071", "title": "VBA count and print every cell address when a duplicate value is found", "body": "<p>So, say your list is</p>\n\n<pre><code>1\n2\n3\n1\n5\n2\n</code></pre>\n\n<p>Your expected output is:</p>\n\n<pre><code>The id '1' is used multiple times: A1, A4\nThe id '2' is used multiple times: A2, A6\n</code></pre>\n\n<p>But your actual output is</p>\n\n<pre><code>The id '1' is used multiple times: A4\nThe id '2' is used multiple times: A6\n</code></pre>\n\n<p>This is because you don't store the first encounter of the index value, only <strong>that</strong> you encounter it.</p>\n\n<p>Try something like this:</p>\n\n<pre><code>For Each C In rng1   \n    If Len(C.Value) &gt; 0 Then\n        If Not objDic.exists(C.Value) Then\n            objDic.Add C.Value, CStr(C.Address)\n        Else\n            objDic(C.Value) = objDic(C.Value) &amp; \", \" &amp; CStr(C.Address)\n        End If\n    End If\nNext\n\nDim comma As String, strMsg As String\nstrMsg = \"\"\nFor Each i In objDic.Keys\n    pcs = Split(objDic(i), \",\")\n    If Ubound(pcs) &gt; 1 Then\n        strMsg = strMsg &amp; \"The id\" &amp; i &amp; \" is used multiple times \"\n        comma = \"\"\n        For Each p In pcs\n            strMsg = strMsg &amp; comma &amp; p\n            comma = \", \"\n        Next\n        strMsg = strMsg &amp; vbNewLine\n    End If\nNext\nIf Len(strMsg) &gt; 0 Then MsgBox strMsg\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 3701825, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670577746/picture?type=large", "display_name": "Hris", "link": "https://stackoverflow.com/users/3701825/hris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1054, "favorite_count": 0, "accepted_answer_id": 50838071, "answer_count": 2, "score": 1, "last_activity_date": 1528897540, "creation_date": 1528891009, "last_edit_date": 1531164843, "question_id": 50836681, "link": "https://stackoverflow.com/questions/50836681/vba-count-and-print-every-cell-address-when-a-duplicate-value-is-found", "title": "VBA count and print every cell address when a duplicate value is found", "body": "<p>I am trying to count the number of cells where a duplicate value is found\n and then print them in a message box.\nAt the moment my code successfully finds the values but only print the cell with the second duplicate value and not all the cells with the same value . It must be something like this:</p>\n\n<p>The id \"wrong id\" is used multiple times  (\"ids\") .\n*ids of all cells, separated with comma. In this example \u201cA6, A7\u201d .Here is my code:</p>\n\n<pre><code>Sub sbFindDuplicatesInColumn()\n\nDim cell As Range\nDim mess As String\nDim rngcheck As Range\nDim rng1 As Range\nDim C As Range\nDim objDic\nDim strMsg As String\n\nSet objDic = CreateObject(\"scripting.dictionary\")\nSet rng1 = Range([a1], Cells(Rows.count, \"A\").End(xlUp))\nFor Each C In rng1\n\n    If Len(C.Value) &gt; 0 Then\n        If Not objDic.exists(C.Value) Then\n            objDic.Add C.Value, 1\n        Else\n            strMsg = strMsg &amp; \"The id\" &amp; C.Value &amp; \" is used multiple times \" &amp; C.Address(0, 0) &amp; vbNewLine\n        End If\n    End If\nNext\n    If Len(strMsg) &gt; 0 Then MsgBox strMsg\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1528891699, "post_id": 50836669, "comment_id": 88677413, "body": "Refer this link, I think it addresses the same issue and will be helpful <a href=\"https://stackoverflow.com/questions/39765110/google-script-convert-sheet-to-xlsx\" title=\"google script convert sheet to xlsx\">stackoverflow.com/questions/39765110/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 6237469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a18ef05d6f762fde79cc0fca549b040?s=128&d=identicon&r=PG&f=1", "display_name": "jdabramson", "link": "https://stackoverflow.com/users/6237469/jdabramson"}, "reply_to_user": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1528898522, "post_id": 50836669, "comment_id": 88682104, "body": "The macro should look similar to this one. However, I don&#39;t know how to program it to copy row 2 and insert an empty row in its place thus shifting all rows down.   <code>Sub Copy_One_Row_Below() With Range(Cells(ActiveCell.Row, 2), Cells(ActiveCell.Row, 16)) .Offset(1).Insert shift:=xlDown .Copy .Offset(1).PasteSpecial Paste:=xlPasteFormulasAndNumberFormats .Offset(1).PasteSpecial xlPasteFormats Application.CutCopyMode = False  End With Cells(ActiveCell.Row + 1, 2) = &quot;=&quot; &amp; Cells(ActiveCell.Row, 2).Address &amp; &quot;+1&quot; End Sub </code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6237469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a18ef05d6f762fde79cc0fca549b040?s=128&d=identicon&r=PG&f=1", "display_name": "jdabramson", "link": "https://stackoverflow.com/users/6237469/jdabramson"}, "edited": false, "score": 0, "creation_date": 1528901161, "post_id": 50839289, "comment_id": 88683971, "body": "This is close.. How does one insert the row with the formatting, data validation, and formulas while omitting the content. i.e. the inserted row should be blank."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1528901360, "post_id": 50839289, "comment_id": 88684093, "body": "<code>xlPasteFormulasAndNumberFormats</code> instead of <code>xlPasteAll</code> should work"}, {"owner": {"reputation": 384, "user_id": 9896279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mcl3F.jpg?s=128&g=1", "display_name": "BenderIO", "link": "https://stackoverflow.com/users/9896279/benderio"}, "edited": false, "score": 0, "creation_date": 1528903924, "post_id": 50839289, "comment_id": 88685761, "body": "Vincent is right, you can replace the parameter &quot;xlPasteAll&quot;, with what you need <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlpastetype-enumeration-excel\" rel=\"nofollow noreferrer\">here</a> . If you need multiple parameters you can retype the line each time as needed. In your exemple <code>Rows(&quot;2:2&quot;).PasteSpecial xlPasteFormulasAndNumberFormats</code> and next line <code>Rows(&quot;2:2&quot;).PasteSpecial xlPasteValidation</code>"}], "tags": [], "owner": {"reputation": 384, "user_id": 9896279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mcl3F.jpg?s=128&g=1", "display_name": "BenderIO", "link": "https://stackoverflow.com/users/9896279/benderio"}, "is_accepted": false, "score": 0, "last_activity_date": 1528898807, "creation_date": 1528898807, "answer_id": 50839289, "question_id": 50836669, "link": "https://stackoverflow.com/questions/50836669/macro-button-to-add-row-with-formulas-from-row-below-in-excel-while-maintainin/50839289#50839289", "title": "Macro button to add row (with formulas from row below) in Excel while maintaining headers", "body": "<p>So you just need this or I didn't understand well ?</p>\n\n<pre><code>   Sub Test()\n    Rows(\"2:2\").Insert Shift:=xlDown\n    Rows(\"3:3\").Copy\n    Rows(\"2:2\").PasteSpecial xlPasteAll\n    Application.CutCopyMode = false\n   End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6237469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a18ef05d6f762fde79cc0fca549b040?s=128&d=identicon&r=PG&f=1", "display_name": "jdabramson", "link": "https://stackoverflow.com/users/6237469/jdabramson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 714, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529303878, "creation_date": 1528890974, "last_edit_date": 1592644375, "question_id": 50836669, "link": "https://stackoverflow.com/questions/50836669/macro-button-to-add-row-with-formulas-from-row-below-in-excel-while-maintainin", "title": "Macro button to add row (with formulas from row below) in Excel while maintaining headers", "body": "<p>I am trying to duplicate a working script from Google Sheets into Excel. The goal is to copy the second row of the active sheet and paste the formatting, data validation and formulas into a new row above. This is intended to place a new (formatted with formulas and data validation) in row 2 below the headers.</p>\n<p>Here's the google script</p>\n<pre><code>// global\nvar ss = SpreadsheetApp.getActive();\n\nfunction addFirstRow() {\n    var firstRow = 2;\n    var sh = ss.getActiveSheet();\n    var lCol = sh.getLastColumn();\n    var range = sh.getRange(firstRow, 1, 1, lCol);\n    var formulas = range.getFormulas();\n    sh.insertRowsBefore(firstRow, 1);\n    var newRange = sh.getRange(firstRow, 1, 1, lCol);\n    newRange = sh.getRange(firstRow, 1, 1, lCol);\n    newRange.setFormulas(formulas);\n} \n</code></pre>\n<p>Here's a video of the google sheets in action\n<a href=\"https://youtu.be/OCinWCApypw\" rel=\"nofollow noreferrer\">https://youtu.be/OCinWCApypw</a></p>\n<h3>Screenshot</h3>\n<p><img src=\"https://i.stack.imgur.com/48KMK.png\" alt=\"Screenshot\" /></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1528888536, "creation_date": 1528888536, "answer_id": 50835840, "question_id": 50835733, "link": "https://stackoverflow.com/questions/50835733/vba-clear-content-of-rows-next-to-cells/50835840#50835840", "title": "VBA clear content of rows next to cells", "body": "<p>Try this. By the way you were missing a dot in front of the Range which you need for your With statement.</p>\n\n<pre><code>Sub clearContents()\n    Dim c As Range, c1 As Long\n    With Sheets(\"Main\")\n        For Each c In .Range(\"B1:B23\")\n            If c.Value = \"x\" Then\n                c1 = Cells(c.Row, Columns.Count).End(xlToLeft).Column\n                If c1 &gt; 2 Then c.Offset(0, 1).Resize(, c1 - 2).clearContents\n            End If\n        Next c\n     End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 5374245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fecb475bd50e5fe9c608cbba5bd767bf?s=128&d=identicon&r=PG&f=1", "display_name": "ChartProblems", "link": "https://stackoverflow.com/users/5374245/chartproblems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 50835840, "answer_count": 1, "score": 0, "last_activity_date": 1528888536, "creation_date": 1528888152, "last_edit_date": 1531164843, "question_id": 50835733, "link": "https://stackoverflow.com/questions/50835733/vba-clear-content-of-rows-next-to-cells", "title": "VBA clear content of rows next to cells", "body": "<p>Each cell in a specific column either contains an 'x' or is empty. I want to create a sub which finds all the x's and then delete the content of all cells to the right in that same row. I am not sure how to properly select and clearContents of the rows in the IF statement below. Any help is much appreciated.</p>\n\n<pre><code>    Sub clearContents()\n        With Sheets(\"Main\")\n            Dim c As Range\n            For Each c In Range(\"B1:B23\")\n                If c.Value = \"x\" Then\n                    c.Offset(0, 1).End(xlToRight).clearContents\n                End If\n            Next c\n         End With\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528888630, "post_id": 50835684, "comment_id": 88675376, "body": "Have you checked the value of RowCount?"}, {"owner": {"reputation": 361, "user_id": 2879124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa097dbc1af5cbe10119a74dbce77b02?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos80", "link": "https://stackoverflow.com/users/2879124/carlos80"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528889040, "post_id": 50835684, "comment_id": 88675660, "body": "Yes, in this example my RowCount variable is set to 91"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528889099, "post_id": 50835684, "comment_id": 88675707, "body": "Only just noticed your sytax is off, it should be <code>Cells(15,k+1)</code>."}, {"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1528890661, "post_id": 50835684, "comment_id": 88676713, "body": "Another syntax error <code>ActiveCell.Range</code> should be <code>Activesheet.Cells</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1528899070, "post_id": 50835684, "comment_id": 88682509, "body": "<code>ActiveCell.Cells(15, k+1)</code> probably isn&#39;t returning the cell you&#39;re expecting.  If the <code>ActiveCell</code> is <code>A1</code> then <code>ActiveCell.Cells(2,1)</code> will return <code>A2</code> - row 2 using the <code>ActiveCell</code> as the starting point, so <code>ActiveCell.Cells(15,k+1)</code> will return a cell address 15 rows below the ActiveCell and k+1 columns across."}, {"owner": {"reputation": 361, "user_id": 2879124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa097dbc1af5cbe10119a74dbce77b02?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos80", "link": "https://stackoverflow.com/users/2879124/carlos80"}, "edited": false, "score": 0, "creation_date": 1529071987, "post_id": 50835684, "comment_id": 88756613, "body": "Thanks for the update, correct changing this to Cells(15,K+1) does put it 15 rows down not 15 columns across as needed."}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 2879124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa097dbc1af5cbe10119a74dbce77b02?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos80", "link": "https://stackoverflow.com/users/2879124/carlos80"}, "edited": false, "score": 0, "creation_date": 1529337349, "post_id": 50838750, "comment_id": 88826725, "body": "Thanks, adding the DateSerial was a winner!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1528897261, "creation_date": 1528897261, "answer_id": 50838750, "question_id": 50835684, "link": "https://stackoverflow.com/questions/50835684/excel-vba-insert-date-where-cell-blank/50838750#50838750", "title": "Excel VBA insert date where cell blank", "body": "<p><code>RowCount</code> could be returning an incorrect count.</p>\n\n<p>A date is stored in the cell as a number - just adding <code>01/01/</code> to it does work, but is open to so many possible errors.  If, for example, a cell contained <em>SO</em> it will happily turn it to <em>01/01/SO</em>.  </p>\n\n<p>Your first run could return correct values such as <code>01/01/2018</code> and incorrect values such as <code>01/01/SO</code>.  Run it again and the code will happily give you <code>01/01/01/01/2018</code> and <code>01/01/01/01/SO</code> as it's just adding <code>01/01/</code> onto the front each time.</p>\n\n<p>I'd suggest rather than just adding <code>01/01/</code> to the value pass the year into <code>DateSerial</code> which will convert it to a real date if it can.  </p>\n\n<pre><code>Sub TurnToDate()\n\n    Dim wrkSht As Worksheet\n    Dim lLastRow As Long\n    Dim k As Long\n\n    On Error GoTo Err_Handle\n\n    Set wrkSht = ThisWorkbook.Worksheets(\"Sheet1\")\n    lLastRow = wrkSht.Cells(wrkSht.Rows.Count, 1).End(xlUp).Row\n\n    With wrkSht\n        For k = 1 To lLastRow\n            If .Cells(k, 1) = \"\" Then\n                .Cells(k, 1) = DateSerial(9999, 1, 1)\n            Else\n                'Overflow or type mismatch errors may occur here.\n               .Cells(k, 1) = DateSerial(.Cells(k, 1), 1, 1)\n            End If\n        Next k\n    End With\n\nExit Sub\n\nErr_Handle:\n\n    Select Case Err.Number\n        Case 13, 6 '13 = Type Mismatch, 6 = Overflow\n            'Occurs if text or date already exists in cell.\n            'Clears the error and resumes execution on line following error.\n            Resume Next\n        Case Else\n            MsgBox Err.Description, vbOKOnly, Err.Number\n    End Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 2879124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa097dbc1af5cbe10119a74dbce77b02?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos80", "link": "https://stackoverflow.com/users/2879124/carlos80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 50838750, "answer_count": 1, "score": 0, "last_activity_date": 1528897261, "creation_date": 1528888022, "last_edit_date": 1531164843, "question_id": 50835684, "link": "https://stackoverflow.com/questions/50835684/excel-vba-insert-date-where-cell-blank", "title": "Excel VBA insert date where cell blank", "body": "<p>I have a column in a spread sheet that is populated with date information, as it stands it is given to me as just a year. In order for it to be read properly I need to reformat the information into a proper date format and so I have attempted to do the following:</p>\n\n<pre><code>With ActiveSheet\n    RowCount = WorksheetFunction.CountA(Range(\"A5\", Range(\"A5\").End(xlDown)))\nEnd With\n\n  For k = 1 To RowCount\n\n      If ActiveCell.Range(15, k + 1).Value = \"\" Then\n            ActiveCell.Range(15, k + 1).Value = \"01/01/9999\"\n        Else\n            ActiveSheet.Range(15, k + 1).Value = \"01/01/\" &amp; ActiveSheet.Range(15, k + 1).Value\n        End If\n\nNext k\n</code></pre>\n\n<p>However none of my cells are populating, any help would be much appreciated.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "mailmerge", "docx-mailmerge", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1528895202, "creation_date": 1528895202, "answer_id": 50838062, "question_id": 50835553, "link": "https://stackoverflow.com/questions/50835553/template-based-letters-generation-programs/50838062#50838062", "title": "Template based letters generation programs", "body": "<p>The following code will export your chosen Sheet as PDF:</p>\n\n<pre><code>FPath = C:\\Users\\HomeUser\\Desktop\"\n'set path\nFName = \"NewFilename.pdf\"\n'set filename\n\n'EXPORT AS PDF\nFName = FPath &amp; \"\\\" &amp; FName\nSheets(\"Sheet1\").ExportAsFixedFormat _\nType:=xlTypePDF, _\nFilename:=FName, _\nQuality:=xlQualityStandard, _\nIncludeDocProperties:=True, _\nIgnorePrintAreas:=False, _\nOpenAfterPublish:=False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9935519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ba4466e0ada1bb4b942a47868d0270e?s=128&d=identicon&r=PG&f=1", "display_name": "Ragavendra", "link": "https://stackoverflow.com/users/9935519/ragavendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1528895202, "creation_date": 1528887649, "last_edit_date": 1531164843, "question_id": 50835553, "link": "https://stackoverflow.com/questions/50835553/template-based-letters-generation-programs", "title": "Template based letters generation programs", "body": "<p>Is there any free tool to generate pdf documents from excel data</p>\n\n<p>I found some with price (<a href=\"http://xlvba.net/excel_to_word_automation.html\" rel=\"nofollow noreferrer\">http://xlvba.net/excel_to_word_automation.html</a>) for it but not  free one, can you help ? </p>\n\n<p>Regards,\nRagavendra</p>\n"}, {"tags": ["c#", "xml", "excel", "security", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1528887624, "post_id": 50835465, "comment_id": 88674792, "body": "I always keep a backup of the original un-passworded files... Have you searched on here - this has been asked before."}, {"owner": {"reputation": 897, "user_id": 5180029, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46e32ef018597fe068a6932752eba743?s=128&d=identicon&r=PG&f=1", "display_name": "KARAN", "link": "https://stackoverflow.com/users/5180029/karan"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1528887704, "post_id": 50835465, "comment_id": 88674835, "body": "@downVoters Please at least care to comment where I am wrong"}, {"owner": {"reputation": 897, "user_id": 5180029, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46e32ef018597fe068a6932752eba743?s=128&d=identicon&r=PG&f=1", "display_name": "KARAN", "link": "https://stackoverflow.com/users/5180029/karan"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1528887855, "post_id": 50835465, "comment_id": 88674915, "body": "@SolarMike okay if someone provide the answer of this then please provide the link of an answer to me."}, {"owner": {"reputation": 10985, "user_id": 2664350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/267fd556e7bd18db2e3923939cd3dd6b?s=128&d=identicon&r=PG", "display_name": "piet.t", "link": "https://stackoverflow.com/users/2664350/piet-t"}, "edited": false, "score": 2, "creation_date": 1528887935, "post_id": 50835465, "comment_id": 88674954, "body": "What use would protecting an excel-file be if the protection could be easily removed without knowing the password?"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1528888462, "post_id": 50835465, "comment_id": 88675266, "body": "Search on here - and not doing so is probably the cause of the downvotes..."}, {"owner": {"reputation": 897, "user_id": 5180029, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46e32ef018597fe068a6932752eba743?s=128&d=identicon&r=PG&f=1", "display_name": "KARAN", "link": "https://stackoverflow.com/users/5180029/karan"}, "edited": false, "score": 0, "creation_date": 1528889177, "post_id": 50835465, "comment_id": 88675751, "body": "I have also tried so many approaches but not working then I ask a question here."}, {"owner": {"reputation": 10985, "user_id": 2664350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/267fd556e7bd18db2e3923939cd3dd6b?s=128&d=identicon&r=PG", "display_name": "piet.t", "link": "https://stackoverflow.com/users/2664350/piet-t"}, "edited": false, "score": 1, "creation_date": 1528891546, "post_id": 50835465, "comment_id": 88677334, "body": "@ADMIN if don&#39;t think you understood my comment correctly. Basically the question you ask is &quot;Is Excel file protection fundamantally flawed and utterly useless?&quot;"}, {"owner": {"reputation": 897, "user_id": 5180029, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46e32ef018597fe068a6932752eba743?s=128&d=identicon&r=PG&f=1", "display_name": "KARAN", "link": "https://stackoverflow.com/users/5180029/karan"}, "reply_to_user": {"reputation": 10985, "user_id": 2664350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/267fd556e7bd18db2e3923939cd3dd6b?s=128&d=identicon&r=PG", "display_name": "piet.t", "link": "https://stackoverflow.com/users/2664350/piet-t"}, "edited": false, "score": 0, "creation_date": 1528892709, "post_id": 50835465, "comment_id": 88678088, "body": "@piet.t I got your point but is there any way to doing this thing?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5876658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-W8Vbw6MLsG8/AAAAAAAAAAI/AAAAAAAAARc/lws9l7O6K8g/photo.jpg?sz=128", "display_name": "Denis Gladysh", "link": "https://stackoverflow.com/users/5876658/denis-gladysh"}, "edited": false, "score": 2, "creation_date": 1528914815, "post_id": 50843881, "comment_id": 88691520, "body": "Your case turned to be simple - your password is contained in dictionary &quot;1 million popular passwords&quot; - <a href=\"https://accessback.com/0916/i/dc132f.png\" rel=\"nofollow noreferrer\">accessback.com/0916/i/dc132f.png</a>"}], "tags": [], "owner": {"reputation": 11, "user_id": 5876658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-W8Vbw6MLsG8/AAAAAAAAAAI/AAAAAAAAARc/lws9l7O6K8g/photo.jpg?sz=128", "display_name": "Denis Gladysh", "link": "https://stackoverflow.com/users/5876658/denis-gladysh"}, "is_accepted": false, "score": 1, "last_activity_date": 1528914351, "creation_date": 1528914351, "answer_id": 50843881, "question_id": 50835465, "link": "https://stackoverflow.com/questions/50835465/is-there-any-way-to-remove-password-from-excel-file/50843881#50843881", "title": "Is there any way to remove password from excel file?", "body": "<p>A minute of optimism: if you know nothing about the password and use a brute-force attack, you have one chance in a billions to achieve success. ;)</p>\n\n<p>It is an Excel 2013+ file with strong protection. It is impossible to <a href=\"https://accessback.com/\" rel=\"nofollow noreferrer\">decrypt</a> such a file without the password as it was with Excel 97-2003. Only searching for variants is left. But it takes much time and there are almost no chances.</p>\n\n<p>For successful cracking you should narrow the range of searching: use a password mask, reduce the number of characters for password generation, \nuse a dictionary attack. And enable GPUs to increase the speed of searching.</p>\n\n<p>Read this <a href=\"https://passcovery.com/helpdesk/knowledgebase.php?article=47#three\" rel=\"nofollow noreferrer\">article</a> and study the <a href=\"https://passcovery.com/helpdesk/knowledgebase.php?category=6\" rel=\"nofollow noreferrer\">examples</a> of range adjustment in the knowledge base.</p>\n\n<p>But I will repeat myself: it should be a very simple password or you should know its structure.</p>\n"}], "owner": {"reputation": 897, "user_id": 5180029, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46e32ef018597fe068a6932752eba743?s=128&d=identicon&r=PG&f=1", "display_name": "KARAN", "link": "https://stackoverflow.com/users/5180029/karan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1528914351, "creation_date": 1528887405, "last_edit_date": 1531161705, "question_id": 50835465, "link": "https://stackoverflow.com/questions/50835465/is-there-any-way-to-remove-password-from-excel-file", "title": "Is there any way to remove password from excel file?", "body": "<p>Recently, I have received one excel file.</p>\n\n<p><a href=\"https://drive.google.com/open?id=1St4K3lhXNVO70AbDx9cqxivbHG2Q-TbP\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=1St4K3lhXNVO70AbDx9cqxivbHG2Q-TbP</a></p>\n\n<p>I have forgotten the password of my file and then after I tried below solution but not any single approach work</p>\n\n<ol>\n<li><p>Change File type made it .Zip and then extract that zip file but this approach not working because Microsoft made it more secure and that's why we can not able to unzip excel.</p></li>\n<li><p>I have used some software that uses some brute-force and there owns technique but it's also not working for mine.</p></li>\n<li><p>I have tried my best for fix this but unfortunately, I am not able to get any single solution.</p></li>\n</ol>\n\n<p>If anyone has found out the solution for this then can please share with a community.</p>\n\n<p>Is there any technique to remove protection?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 542, "user_id": 7099906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JfvZO.png?s=128&g=1", "display_name": "Taylor Scott", "link": "https://stackoverflow.com/users/7099906/taylor-scott"}, "edited": false, "score": 0, "creation_date": 1528886748, "post_id": 50835128, "comment_id": 88674235, "body": "You are trying to get the value of a range that holds an entire column with the <code>If rCell.Value = &quot;&quot;</code> snippet."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6695551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a65a4ee195b97f0083bdce443a620?s=128&d=identicon&r=PG&f=1", "display_name": "gbra", "link": "https://stackoverflow.com/users/6695551/gbra"}, "edited": false, "score": 0, "creation_date": 1528894257, "post_id": 50835517, "comment_id": 88679138, "body": "Thanks Taylor - I have learned a little more from you today. I have gone with this answer as it was the first one to arrive."}], "tags": [], "owner": {"reputation": 542, "user_id": 7099906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JfvZO.png?s=128&g=1", "display_name": "Taylor Scott", "link": "https://stackoverflow.com/users/7099906/taylor-scott"}, "is_accepted": true, "score": 0, "last_activity_date": 1528887565, "creation_date": 1528887565, "answer_id": 50835517, "question_id": 50835128, "link": "https://stackoverflow.com/questions/50835128/cycle-through-a-variable-range-of-cells-and-fill-empty-cells-with-a-certain-char/50835517#50835517", "title": "Cycle through a variable range of cells and fill empty cells with a certain character", "body": "<p>I think that this may do what you are looking for </p>\n\n<pre><code>Sub CBtnFillAll_Click()\n' EmptyCharacteristic Macro\n' Fills empty cells in the characteristics columns with 'N'\n'\n    Dim rCell   As Range, _\n        rRng    As Range\n\n    For Each rRng In ActiveSheet.UsedRange.Columns(\"A:A\").Cells\n        If IsEmpty(rRng) Then GoTo NextRow\n        For Each rCell In rRng.Offset(0, 7).Resize(1, 12)\n            If IsEmpty(rCell) Then rCell.Value = \"N\"\n        Next rCell\nNextRow:\n    Next rRng\n\nEnd Sub\n</code></pre>\n\n<p>If you are looking to omit the first two lines of your sheet, then you can change </p>\n\n<pre><code>For Each rRng In ActiveSheet.UsedRange.Columns(\"A:A\").Cells\n</code></pre>\n\n<p>to </p>\n\n<pre><code>For Each rRng In ActiveSheet.[A3].Resize(ActiveSheet.UsedRange.Rows.Count-2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 6695551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a65a4ee195b97f0083bdce443a620?s=128&d=identicon&r=PG&f=1", "display_name": "gbra", "link": "https://stackoverflow.com/users/6695551/gbra"}, "edited": false, "score": 0, "creation_date": 1528893877, "post_id": 50837033, "comment_id": 88678890, "body": "Thank you DirtyDeffy - I&#39;ve learned a little more today! I&#39;ve upvoted your answer but it won&#39;t show up due to my low rep!"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 53, "user_id": 6695551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a65a4ee195b97f0083bdce443a620?s=128&d=identicon&r=PG&f=1", "display_name": "gbra", "link": "https://stackoverflow.com/users/6695551/gbra"}, "edited": false, "score": 0, "creation_date": 1528894775, "post_id": 50837033, "comment_id": 88679521, "body": "Glad to help - no worries about the rep ;)"}], "tags": [], "owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "is_accepted": false, "score": 1, "last_activity_date": 1528892089, "creation_date": 1528892089, "answer_id": 50837033, "question_id": 50835128, "link": "https://stackoverflow.com/questions/50835128/cycle-through-a-variable-range-of-cells-and-fill-empty-cells-with-a-certain-char/50837033#50837033", "title": "Cycle through a variable range of cells and fill empty cells with a certain character", "body": "<p>Your approach is completely correct, but there is one thing that creates the problem:</p>\n\n<p>Change your <code>For Each</code> line to this: <code>For Each rCell in rRng</code>.  </p>\n\n<p>There are a few things I would have done differently, so here is my complete code:  </p>\n\n<pre><code>Sub test()\nApplication.ScreenUpdating = False\nDim Lastrow As Long\nDim rCell As Range\nDim aCell As Range\nDim rRng As Range\nDim Currentrow As Long\n\nLastrow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\nSet rRng = ActiveSheet.Range(\"H3:S\" &amp; Lastrow)\n\nFor Each rCell In rRng\n    Currentrow = rCell.Row\n    Set aCell = ActiveSheet.Range(\"A\" &amp; Currentrow)\n    If Not IsEmpty(aCell.Value) And IsEmpty(rCell.Value) Then\n    rCell.Value = \"N\"\n    End If\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6695551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a65a4ee195b97f0083bdce443a620?s=128&d=identicon&r=PG&f=1", "display_name": "gbra", "link": "https://stackoverflow.com/users/6695551/gbra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 50835517, "answer_count": 2, "score": 0, "last_activity_date": 1528892089, "creation_date": 1528886405, "question_id": 50835128, "link": "https://stackoverflow.com/questions/50835128/cycle-through-a-variable-range-of-cells-and-fill-empty-cells-with-a-certain-char", "title": "Cycle through a variable range of cells and fill empty cells with a certain character", "body": "<p>I am learning VBA as I go along and have managed to compile a lot of code from a range of sources but am finding it hard to solve my current problem. I have read a lot of solutions regarding working with ranges but I have been unable to adapt any of the ones that I have seen to resolve my issue.</p>\n\n<p>I would like a macro which, when a Command Button is pressed, will identify the last used row in a range of cells (which will increase in row count over time) then check each row for any empty cells within the range and filling these with the letter 'N' if there is data in the same row in Column A.</p>\n\n<p>I currently have the following code:</p>\n\n<pre><code>Private Sub CBtnFillAll_Click()\n'\n' EmptyCharacteristic Macro\n' Fills empty cells in the characteristics columns with 'N'\n'\n\nDim Lastrow As Integer\nDim rCell As Range\nDim rRng As Range\n\nLastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\nSet rRng = ActiveSheet.Range(\"$H$3:$S\" &amp; Lastrow)\n\nFor Each rCell In rRng.Rows\n    If rCell.Value = \"\" And ActiveSheet.Cells(rRng.Row, 1).Value &lt;&gt; \"\" Then\n    rCell.Value = \"N\"\n    End If\nNext rCell\n\nEnd Sub\n</code></pre>\n\n<p>I am checking Column A as there is additional data starting in Column B in rows which I do not want to include in the range. The range to check will always be between Columns H and S.</p>\n\n<p>I am currently getting a 'Type Mismatch' error in the following line:</p>\n\n<pre><code>If rCell.Value = \"\" And ActiveSheet.Cells(rRng.Row, 1).Value &lt;&gt; \"\" Then\n</code></pre>\n\n<p>Please can someone help me with the syntax in this final part?</p>\n\n<p>Many thanks in advance.</p>\n"}, {"tags": ["vba", "outlook", "meeting-request"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1528890198, "post_id": 50834695, "comment_id": 88676407, "body": "&#39;438&#39; Object does not support this property or method&quot; = AppointmentItem does not support <code>HTMLBody</code>. <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/appointmentitem-object-outlook\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/outlook-vba/articles/&hellip;</a> Use <code>.body</code> or <code>.RTFBody</code>."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1529209570, "creation_date": 1529209570, "answer_id": 50893679, "question_id": 50834695, "link": "https://stackoverflow.com/questions/50834695/not-able-to-update-email-body-in-meeting-request/50893679#50893679", "title": "Not able to update email body in Meeting Request", "body": "<p>Appointment items use the RTF markup for bodies instead of HTML (see the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff861303.aspx\" rel=\"nofollow noreferrer\">RTFBody</a> property). So, you will not find the <code>HTMLBody</code> property for appointments. You can use the Word object model if you need to paste some HTML markup to the body. See <a href=\"http://stackoverflow.com/questions/17064231/write-html-content-to-word-document-using-c-sharp\">Write HTML content to word document using C#</a> for more information. </p>\n\n<p>Starting from Outlook 2016 you can try to access the <code>PR_HTML</code> property which represents the HTML body using AppointmentItem.PropertyAccessor. The DASL name is <a href=\"http://schemas.microsoft.com/mapi/proptag/0x10130102\" rel=\"nofollow noreferrer\">http://schemas.microsoft.com/mapi/proptag/0x10130102</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 8499989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6598948c80a5fba67d0e4d4d6d96505e?s=128&d=identicon&r=PG&f=1", "display_name": "GaneshPoojary", "link": "https://stackoverflow.com/users/8499989/ganeshpoojary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529209570, "creation_date": 1528884971, "last_edit_date": 1528891437, "question_id": 50834695, "link": "https://stackoverflow.com/questions/50834695/not-able-to-update-email-body-in-meeting-request", "title": "Not able to update email body in Meeting Request", "body": "<p>I am not able to create a meeting request. I get an error on .HTMLbody line. The error which I receive is \"Run time error '438' Object does not support this property or method\" . I have also added RangeToHTML code from Ron De'Bruin.</p>\n\n<p>Please assist me with the request.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Meeting_Request()\nDim myoutlook As Object ' Outlook.Application\nDim r As Long\nDim rng As Range\nDim rng2 As Range\nDim myapt As Object ' Outlook.AppointmentItem\n\n' late bound constants\nConst olAppointmentItem = 1\nConst olBusy = 2\nConst olMeeting = 1\n\n' Create the Outlook session\nSet myoutlook = CreateObject(\"Outlook.Application\")\n\n' Start at row 18\nSheets(\"Automation\").Select\nr = 18\n\nDo Until Trim$(Cells(r, 1).Value) = \"\"\n'Adding Goals and other details in email draft\n\n\nSet rng = Nothing\nOn Error Resume Next\nSet rng = Range(\"A9:A14\").SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n\nIf rng Is Nothing Then\n    MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n           vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n    Exit Sub\nEnd If\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\n\n\n\n'Sheets(\"Automation\").Select\n' Create the AppointmentItem\n\nSet myapt = myoutlook.CreateItem(olAppointmentItem)\n' Set the appointment properties\n'Sheets(\"Automation\").Select\nWith myapt\n  .Subject = Sheets(\"Automation\").Range(\"N\" &amp; r) &amp; \" day review\"\n  .Start = Sheets(\"Automation\").Range(\"P\" &amp; r) &amp; \" \" &amp; \"7:00:00 PM\"\n  .Duration = 0\n  .Recipients.Add Sheets(\"Automation\").Range(\"C\" &amp; r).Value &amp; \";\" &amp; Sheets(\"Automation\").Range(\"K\" &amp; r).Value\n  .MeetingStatus = olMeeting\n  ' not necessary if recipients are email addresses\n  ' myapt.Recipients.ResolveAll\n  '.AllDayEvent = \"No\"\n    .BusyStatus = olBusy\n   ' .BusyStatus = Cells(r, 5).Value\n    .ReminderSet = False\n  .HTMLBody = RangetoHTML(rng)\n  .Save\n  r = r + 1\n  .Display\nEnd With\n\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 579, "user_id": 7471560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86af0401de69dad1bb3edd70a4920976?s=128&d=identicon&r=PG&f=1", "display_name": "LJ01", "link": "https://stackoverflow.com/users/7471560/lj01"}, "is_accepted": false, "score": 0, "last_activity_date": 1528886357, "creation_date": 1528886357, "answer_id": 50835112, "question_id": 50834576, "link": "https://stackoverflow.com/questions/50834576/excel-vba-to-set-pivot-table-filter-with-values-between-start-and-end-value/50835112#50835112", "title": "Excel VBA to set Pivot Table filter with values between start and end value", "body": "<p>Im not sure if this is an answer exactly, it may be a solution...</p>\n\n<p>What I usually do for this kind of problem is add a helper / filter column to the source data. Something to the effect of</p>\n\n<pre><code>if(and(source_data_col&lt;j1,source_data_col&gt;k1),true,false)  \n</code></pre>\n\n<p>Then add that column to the pivot table filter. </p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 9674137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e18977a861ecf3fc2fd9c381525cf97?s=128&d=identicon&r=PG&f=1", "display_name": "Raji", "link": "https://stackoverflow.com/users/9674137/raji"}, "edited": false, "score": 0, "creation_date": 1528892889, "post_id": 50835231, "comment_id": 88678214, "body": "WK is a Page Field in my case. Your code worked like a charm! Thanks!!"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1530222038, "post_id": 50835231, "comment_id": 89171380, "body": "Note that if it&#39;s not a PageField, then instead of looping through PivotItems (which is very slow) you can use a very quick hack using a Slicer connected to a copy of the PivotTable, as per my answer at <a href=\"https://stackoverflow.com/questions/35278918/vba-filter-error/35283084#35283084\" title=\"vba filter error\">stackoverflow.com/questions/35278918/vba-filter-error/&hellip;</a>"}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": true, "score": 2, "last_activity_date": 1528886695, "creation_date": 1528886695, "answer_id": 50835231, "question_id": 50834576, "link": "https://stackoverflow.com/questions/50834576/excel-vba-to-set-pivot-table-filter-with-values-between-start-and-end-value/50835231#50835231", "title": "Excel VBA to set Pivot Table filter with values between start and end value", "body": "<p>If PivotField \"WK\" is a <code>Row</code> or <code>Column</code> field, then you don't need to loop; you can simply apply a filter to the PivotField. It's also a good idea to qualify your range references with a worksheet.</p>\n\n<pre><code>Sub foo()\n    Dim ws As Worksheet\n    Set ws = ActiveSheet\n    With ws.PivotTables(\"PivotTable1\").PivotFields(\"WK\")\n        .ClearAllFilters\n        .PivotFilters.Add2 _\n            Type:=xlCaptionIsBetween, _\n            Value1:=ws.Range(\"J1\").Value, _\n            Value2:=ws.Range(\"K1\").Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>If PivotField \"WK\" is a <code>Page</code> field, then you do need to loop - but you are confusing your data types, and you have applied an AND operator where you mean OR. You can try this:</p>\n\n<pre><code>Sub FilterPageField()\n    Dim pt As PivotTable\n    Dim pf As PivotField\n    Dim pi As PivotItem\n    Dim lPi As Long\n    Dim lStart As Long\n    Dim lEnd As Long\n\n    lStart = CLng(ActiveSheet.Range(\"J1\").Value)\n    lEnd = CLng(ActiveSheet.Range(\"K1\").Value)\n    Set pt = Sheet1.PivotTables(\"PivotTable1\")\n    Set pf = pt.PivotFields(\"WK\")\n\n    pf.ClearAllFilters\n    For Each pi In pf.PivotItems\n        lPi = CLng(pi.Caption)\n        pi.Visible = lPi &gt;= lStart And lPi &lt;= lEnd\n    Next pi\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 9674137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e18977a861ecf3fc2fd9c381525cf97?s=128&d=identicon&r=PG&f=1", "display_name": "Raji", "link": "https://stackoverflow.com/users/9674137/raji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5136, "favorite_count": 2, "accepted_answer_id": 50835231, "answer_count": 2, "score": 0, "last_activity_date": 1528886695, "creation_date": 1528884583, "last_edit_date": 1528885458, "question_id": 50834576, "link": "https://stackoverflow.com/questions/50834576/excel-vba-to-set-pivot-table-filter-with-values-between-start-and-end-value", "title": "Excel VBA to set Pivot Table filter with values between start and end value", "body": "<p>I am trying to set filters in pivot table. The pivot table filter values range from 1 to 16. If start value=5 and end value=10, the pivot filters should be set to select the 5,6,7,8,9,10. Here is the code I have. It is selecting filter values from 1 to 10. I want the code to select 5 to 10. Please help </p>\n\n<pre><code>Sub Macro1()    \n    s = CStr(Range(\"J1\").Value) 'start\n    e = CStr(Range(\"K1\").Value) 'end    \n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"WK\")\n        .ClearAllFilters\n        .EnableMultiplePageItems = True\n        For i = 1 To .PivotItems.Count\n            MsgBox .PivotItems(i).Name\n            If .PivotItems(i).Name &lt; s And .PivotItems(i).Name &gt; e Then\n                .PivotItems(.PivotItems(i).Name).Visible = False\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1528884608, "post_id": 50834151, "comment_id": 88672948, "body": "So your <code>Join(xArr, D)</code> should result in an array?  The problems I see here are that you&#39;re the function returns a <code>String</code> - so it can never return an array and the <code>Join</code> command <i>Returns a string created by joining a number of substrings contained in an array.</i> so that can&#39;t return an array either."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1528884732, "post_id": 50834151, "comment_id": 88673041, "body": "Are you trying to take a range of cells and return it as a range equal in size but in reverse order?  Or are you trying to take the values from a range of cells and then return those values in reverse order as an array?"}, {"owner": {"reputation": 33, "user_id": 6385519, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RbOJRXD2bLk/AAAAAAAAAAI/AAAAAAAAABA/ruuOJOoS05s/photo.jpg?sz=128", "display_name": "Suraj Shourie", "link": "https://stackoverflow.com/users/6385519/suraj-shourie"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1528885066, "post_id": 50834151, "comment_id": 88673267, "body": "I am trying to return a concatenation of a range with a separator, like a space or a comma, with it (in this case the default is a space &quot; &quot;), like (1,2,3,4,5) instead of 12345 which concat function in excel would return. So the function should return a string and not a range."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1528886440, "post_id": 50834151, "comment_id": 88674066, "body": "So <code>IF($A$2:$A$5 &lt; 3, $A$2:$A$5 ,&quot;&quot;)</code> is a formula in a range of cells on the sheet.... your code should treat it as any other range. If your array formula is returning <code>&quot;&quot;,2,&quot;&quot;,1</code> across cells <code>B2:B5 </code> then the formula <code>=ReverseTextToColumns(B2:B5)</code> returns <code>, 2, , 1</code>.  I&#39;m not seeing where the problem is.  <b>NB:  I can&#39;t see the picture, so  may be missing something there</b>."}, {"owner": {"reputation": 33, "user_id": 6385519, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RbOJRXD2bLk/AAAAAAAAAAI/AAAAAAAAABA/ruuOJOoS05s/photo.jpg?sz=128", "display_name": "Suraj Shourie", "link": "https://stackoverflow.com/users/6385519/suraj-shourie"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1528887849, "post_id": 50834151, "comment_id": 88674913, "body": "And that is what&#39;s baffling me. I am getting a #VALUE error. While I am expecting it to give the output as &quot;1 2 3&quot;.   I&#39;m not really sure why the picture is not visible. Maybe try this link <a href=\"https://i.stack.imgur.com/ZHmRT.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/ZHmRT.png</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528891052, "post_id": 50834151, "comment_id": 88676971, "body": "I&#39;ve inserted the picture for you - until you get enough reputation points you can&#39;t directly insert a picture, yourself :-)"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1528891074, "post_id": 50834151, "comment_id": 88676984, "body": "@DarrenBartrup-Cook The picture is now visible in the question."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1528891538, "post_id": 50834151, "comment_id": 88677326, "body": "Sorry - should have said.  The picture isn&#39;t visible due to firewalls at my end."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6385519, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RbOJRXD2bLk/AAAAAAAAAAI/AAAAAAAAABA/ruuOJOoS05s/photo.jpg?sz=128", "display_name": "Suraj Shourie", "link": "https://stackoverflow.com/users/6385519/suraj-shourie"}, "edited": false, "score": 0, "creation_date": 1528893395, "post_id": 50836923, "comment_id": 88678560, "body": "Thanks! @DarrenBartup-Cook and @QHarr. It is working when I remove <code>.Value</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1528894279, "post_id": 50836923, "comment_id": 88679159, "body": "That confused me... hadn&#39;t refreshed the screen for a while and a deleted post had the accepted answer."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1528893742, "last_edit_date": 1528893742, "creation_date": 1528891746, "answer_id": 50836923, "question_id": 50834151, "link": "https://stackoverflow.com/questions/50834151/how-to-pass-an-array-of-results-in-a-user-defined-function-in-excel-vba/50836923#50836923", "title": "How to pass an array of results in a User defined Function in Excel-VBA?", "body": "<p>Pass in first argument as Variant and drop the <code>.Value</code></p>\n\n<pre><code>Option Explicit\nPublic Function ReverseTextToColumns(n As Variant, Optional D As String = \" \") As String\n    Dim xArr\n    xArr = Application.WorksheetFunction.Transpose((n))\n    ReverseTextToColumns = Join(xArr, D)\nEnd Function\n</code></pre>\n\n<p>Worksheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5XnbK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5XnbK.png\" alt=\"Worksheet\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6385519, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RbOJRXD2bLk/AAAAAAAAAAI/AAAAAAAAABA/ruuOJOoS05s/photo.jpg?sz=128", "display_name": "Suraj Shourie", "link": "https://stackoverflow.com/users/6385519/suraj-shourie"}, "edited": false, "score": 0, "creation_date": 1528892249, "post_id": 50836926, "comment_id": 88677754, "body": "Thanks for the reply.  NB - With the condition <code>$A$2:$A$5 &lt; 3</code> I am taking only those numbers that are less than 3 as an input to the function. Similar to how we can use <code>=SUM(IF($A$1:$A$10&lt;3,$A$1:$A$10,0))</code> as an array function. I just checked the <code>TypeName</code> of the parameter &quot;Rg&quot; when it is passed as a Variant, and it is a range - if the input to the UDF is an excel cell range (like <code>A1:A5</code>). But it is still giving the #Value error if I pass an array of results."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1528892651, "post_id": 50836926, "comment_id": 88678037, "body": "@ZevSpitz  I took the input to be an array formula within a cell:  <code>{=ReverseTextToColumns(IF($A$2:$A$5&lt;3,$A$2:$A$5,&quot;&quot;))}</code> which will work (doesn&#39;t remove blank cells though) if <code>Rg</code> is declared as a variant as you suggested, and remove <code>.Value</code> in the <code>Transpose</code> statement."}, {"owner": {"reputation": 33, "user_id": 6385519, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RbOJRXD2bLk/AAAAAAAAAAI/AAAAAAAAABA/ruuOJOoS05s/photo.jpg?sz=128", "display_name": "Suraj Shourie", "link": "https://stackoverflow.com/users/6385519/suraj-shourie"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1528893172, "post_id": 50836926, "comment_id": 88678410, "body": "@DarrenBartrup-Cook It is working when I remove <code>.Value</code>, at least it&#39;s not giving an error. I am getting the desired result by using <code>TRIM</code> and <code>SUBSTITUTE</code> ( spaces with a comma).  Thanks!"}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1528892098, "last_edit_date": 1528892098, "creation_date": 1528891763, "answer_id": 50836926, "question_id": 50834151, "link": "https://stackoverflow.com/questions/50834151/how-to-pass-an-array-of-results-in-a-user-defined-function-in-excel-vba/50836926#50836926", "title": "How to pass an array of results in a User defined Function in Excel-VBA?", "body": "<p>The problem appears to be that this condition:</p>\n\n<pre><code>$A$2:$A$5 &lt; 3\n</code></pre>\n\n<p>returns <code>FALSE</code>, which means that the empty string <code>\"\"</code> is passed into the function. This is incompatible with the type of the parameter -- <code>Range</code>; the following function:</p>\n\n<pre><code>Function TestRng(rng As Range) As Boolean\n    TestRng = True\nEnd Function\n</code></pre>\n\n<p>also returns <code>#VALUE!</code> when used in a formula like so:</p>\n\n<pre><code>=TestRng(\"\")\n</code></pre>\n\n<p>I suggest you make the parameter of type <code>Variant</code>, and use the VBA <code>TypeName</code> function within your UDF to check whether it is actually a <code>Range</code>.</p>\n\n<p>NB. What exactly are you aiming for with this condition -- <code>$A$2:$A$5 &lt; 3</code>? What does it mean to compare a range of cells against a number?</p>\n"}], "owner": {"reputation": 33, "user_id": 6385519, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RbOJRXD2bLk/AAAAAAAAAAI/AAAAAAAAABA/ruuOJOoS05s/photo.jpg?sz=128", "display_name": "Suraj Shourie", "link": "https://stackoverflow.com/users/6385519/suraj-shourie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 50836923, "answer_count": 2, "score": 1, "last_activity_date": 1528893742, "creation_date": 1528883283, "last_edit_date": 1528891003, "question_id": 50834151, "link": "https://stackoverflow.com/questions/50834151/how-to-pass-an-array-of-results-in-a-user-defined-function-in-excel-vba", "title": "How to pass an array of results in a User defined Function in Excel-VBA?", "body": "<p>I'm checking to see if there is any way to pass an array of results in an UDF. </p>\n\n<p>My function is working as expected if I pass a range, for eg - <code>$A$2:$A$5</code>, but not if I make array calculations before passing the range, for eg -  <code>IF($A$2:$A$5 &lt; 3, $A$2:$A$5 ,\"\")</code> with control + shift + enter.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZHmRT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZHmRT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's the code I'm using-</p>\n\n<pre><code>Public Function ReverseTextToColumns(Rg As Range, Optional D As String = \" \") As String\n  Dim xArr\n  xArr = Application.WorksheetFunction.Transpose((Rg.Value))\n  ReverseTextToColumns = Join(xArr, D)\nEnd Function\n</code></pre>\n\n<p>I don't want to create a complicated function and just to know how to pass an array of results in an UDF.</p>\n"}, {"tags": ["excel", "range", "refer", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528884067, "post_id": 50833874, "comment_id": 88672585, "body": "Please <a href=\"https://stackoverflow.com/posts/50833874/edit\">edit</a> your question and show the code. Otherwise we cannot help."}, {"owner": {"reputation": 21, "user_id": 9334472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edfd7e58abfac6d49cbab5b80c146917?s=128&d=identicon&r=PG&f=1", "display_name": "user9334472", "link": "https://stackoverflow.com/users/9334472/user9334472"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528885394, "post_id": 50833874, "comment_id": 88673458, "body": "Code has been added. I was hoping I could change something in the formula but I&#39;ll have to make the formula in VBA, will I?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 2, "creation_date": 1528886954, "post_id": 50833874, "comment_id": 88674370, "body": "Why don&#39;t you simply pass the original formula into a variable and once you&#39;ve finished editing columns, add the formula back to the corresponding cells?"}], "owner": {"reputation": 21, "user_id": 9334472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edfd7e58abfac6d49cbab5b80c146917?s=128&d=identicon&r=PG&f=1", "display_name": "user9334472", "link": "https://stackoverflow.com/users/9334472/user9334472"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528887027, "creation_date": 1528882492, "last_edit_date": 1531164843, "question_id": 50833874, "link": "https://stackoverflow.com/questions/50833874/vba-deletes-a-column-and-adds-a-new-column-how-to-refer-to-the-same-range-area", "title": "VBA deletes a column and adds a new column, how to refer to the same range area in a formula after these changes have been made?", "body": "<p>Image: Formula and range area</p>\n\n<p><a href=\"https://i.stack.imgur.com/5AYSK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5AYSK.png\" alt=\"Formula and range area\"></a></p>\n\n<p>So I want my formula to count the range $E$27:$S$42 but anytime the macro is run the range referred to in the formula reduces by one column. How can I keep the range $E$27:$S$42 after the macro makes changes? </p>\n\n<p>(The Macro Deletes an old week and adds a new future week by copying column R). The VBA is a for loop to make these changes to 20 blocks similar to the one as shown. </p>\n\n<p>Code: </p>\n\n<pre><code>Sub DeleteAndAddWeek()\n\n\nDim i As Integer\nFor i = 22 To 617 Step 22\nDoEvents\n\n'Select Sheet\nSheets(\"Entry Sheet\").Select\n\n'Delete Old Date in Column E\nRange(Cells(i + 1, 5), Cells(i + 20, 5)).Delete Shift:=xlToLeft\n\n'Copy column R to Column S (new Week)\nRange(Cells(i + 1, 18), Cells(i + 20, 18)).AutoFill Destination:=Range(Cells(i + 1, 18), Cells(i + 20, 19)), Type:=xlFillDefault\nRange(Cells(i + 5, 19), Cells(i + 20, 19)).ClearContents\n\n'Copy dates into Overview Sheet\nRange(Cells(23, 5), Cells(23, 19)).Copy\nSheets(\"Team Forecast Overview\").Select\nRange(\"D2:R2\").PasteSpecial xlPasteValues\n\n'Copy summary rows into Overview Sheet\nSheets(\"Entry Sheet\").Select\nRange(Cells(i + 2, 5), Cells(i + 2, 19)).Copy\nSheets(\"Team Forecast Overview\").Select\nRange(Cells(((i / 22) + 2), 4), Cells(((i / 22) + 2), 18)).PasteSpecial xlPasteValuesAndNumberFormats\n\n\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "reporting-services", "ie-automation"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528890916, "post_id": 50833706, "comment_id": 88676885, "body": "Since you&#39;re new to Stack Overflow a tip: ask only ONE question per question, otherwise it could be closed as &quot;too broad&quot;. You may want to take a moment to read how to effectively ask questions on the site in the <a href=\"https://stackoverflow.com/help\">help center</a>. You can use the <a href=\"https://stackoverflow.com/posts/50833706/edit\">edit</a> link to modfiy the question."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1528909344, "post_id": 50833706, "comment_id": 88688741, "body": "Build up a collection of <code>ActiveLink</code> classes, then iterate to find the one with Excel as the innertext and click it."}, {"owner": {"reputation": 11, "user_id": 9905984, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o6sQptI9xIc/AAAAAAAAAAI/AAAAAAAAEfA/NUzaQlNlTxs/photo.jpg?sz=128", "display_name": "Martin Smith", "link": "https://stackoverflow.com/users/9905984/martin-smith"}, "edited": false, "score": 0, "creation_date": 1528915386, "post_id": 50833706, "comment_id": 88691803, "body": "Thanks Ryan.  I wasn&#39;t sure how to do this but found the answer in a prior question you answered."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9905984, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o6sQptI9xIc/AAAAAAAAAAI/AAAAAAAAEfA/NUzaQlNlTxs/photo.jpg?sz=128", "display_name": "Martin Smith", "link": "https://stackoverflow.com/users/9905984/martin-smith"}, "edited": false, "score": 0, "creation_date": 1528904913, "post_id": 50840212, "comment_id": 88686327, "body": "Thanks for your input.  Unfortunately, I only have access to pull reports via the browser which is why I&#39;m trying to use IE Automation.  I&#39;ll check with the IT team on these options but am looking for something I can accomplish with my current access."}, {"owner": {"reputation": 451, "user_id": 2432555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d274251c72f4dc0081bfcafa9807f05b?s=128&d=identicon&r=PG&f=1", "display_name": "JonTout", "link": "https://stackoverflow.com/users/2432555/jontout"}, "reply_to_user": {"reputation": 11, "user_id": 9905984, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o6sQptI9xIc/AAAAAAAAAAI/AAAAAAAAEfA/NUzaQlNlTxs/photo.jpg?sz=128", "display_name": "Martin Smith", "link": "https://stackoverflow.com/users/9905984/martin-smith"}, "edited": false, "score": 0, "creation_date": 1528908807, "post_id": 50840212, "comment_id": 88688448, "body": "The other &quot;easy&quot; option (if Excel is allowed to import data from a web page) is to open Excel, new workbook, Click on data tab, Select &quot;From Web&quot; and paste in Report URL and follow the wizard  Try recording a macro with the above steps once you&#39;ve got a handle on how to do them."}, {"owner": {"reputation": 11, "user_id": 9905984, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o6sQptI9xIc/AAAAAAAAAAI/AAAAAAAAEfA/NUzaQlNlTxs/photo.jpg?sz=128", "display_name": "Martin Smith", "link": "https://stackoverflow.com/users/9905984/martin-smith"}, "edited": false, "score": 0, "creation_date": 1528915473, "post_id": 50840212, "comment_id": 88691849, "body": "Thanks.  That is where I started first.  I am getting some traction on subscription solution you suggested."}], "tags": [], "owner": {"reputation": 451, "user_id": 2432555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d274251c72f4dc0081bfcafa9807f05b?s=128&d=identicon&r=PG&f=1", "display_name": "JonTout", "link": "https://stackoverflow.com/users/2432555/jontout"}, "is_accepted": false, "score": 0, "last_activity_date": 1528901394, "creation_date": 1528901394, "answer_id": 50840212, "question_id": 50833706, "link": "https://stackoverflow.com/questions/50833706/excel-vba-exporting-and-saving-ssrs-report/50840212#50840212", "title": "Excel VBA - Exporting and saving SSRS report", "body": "<p>Set up a subscription to the report and Report Server will do the export to excel to a fileshare for you.</p>\n\n<p>Alternately you might want to investigate the database query behind the report and (re)create the report into Excel.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/sql/reporting-services/subscriptions/subscriptions-and-delivery-reporting-services?view=sql-server-2017\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/sql/reporting-services/subscriptions/subscriptions-and-delivery-reporting-services?view=sql-server-2017</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9905984, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o6sQptI9xIc/AAAAAAAAAAI/AAAAAAAAEfA/NUzaQlNlTxs/photo.jpg?sz=128", "display_name": "Martin Smith", "link": "https://stackoverflow.com/users/9905984/martin-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1529019011, "creation_date": 1529019011, "answer_id": 50867270, "question_id": 50833706, "link": "https://stackoverflow.com/questions/50833706/excel-vba-exporting-and-saving-ssrs-report/50867270#50867270", "title": "Excel VBA - Exporting and saving SSRS report", "body": "<p>Thanks all for the notes.  I was able to find a solution following Ryan's suggestion and checking out an answer he provided on a prior post (<a href=\"https://stackoverflow.com/questions/42741997/get-all-innertext-vba/42751800#42751800\">Get all innertext VBA</a>)</p>\n\n<p>From there it was a simple loop:</p>\n\n<pre><code>    For Each Element In Elements\n        If Element.innerText = \"Excel\" Then Element.Click\n    Next\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9905984, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o6sQptI9xIc/AAAAAAAAAAI/AAAAAAAAEfA/NUzaQlNlTxs/photo.jpg?sz=128", "display_name": "Martin Smith", "link": "https://stackoverflow.com/users/9905984/martin-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2336, "favorite_count": 0, "closed_date": 1580939100, "answer_count": 2, "score": 0, "last_activity_date": 1529019011, "creation_date": 1528882039, "last_edit_date": 1528905010, "question_id": 50833706, "link": "https://stackoverflow.com/questions/50833706/excel-vba-exporting-and-saving-ssrs-report", "closed_reason": "Duplicate", "title": "Excel VBA - Exporting and saving SSRS report", "body": "<p>Looking for help with pulling an SSRS report from an internal company site using VBA. I've read several posts on VBA automation and have been managed to successfully make all the selections and run the report, now I just need the data.</p>\n\n<p>Specifically, I need help to select the export to excel option.</p>\n\n<p>My current VBA code:</p>\n\n<pre><code>Sub macro_07()\nDim appIE As InternetExplorerMedium\n'Set appIE = Nothing\nDim objElement As Object\nDim objCollection As Object\nDim objCollection2 As Object\nDim objCollection3 As Object\nDim objCollection4 As Object\nDim objCollection5 As Object\nDim objCollection6 As Object\nDim objCollection7 As Object\nDim objCollection8 As Object\n\nSet appIE = New InternetExplorerMedium\nsURL = ThisWorkbook.Sheets(\"Control\").Range(\"IALinks\").Cells(1, 1).Value\nWith appIE\n    .Navigate sURL\n    .Visible = True\nEnd With\n\nDo While appIE.Busy Or appIE.readyState &lt;&gt; 4\n    DoEvents\nLoop\n\nSet objCollection = appIE.document.getElementById(\"ctl31_ctl04_ctl07_txtValue\")\nobjCollection.Value = Range(\"YearSlct\").Value\nSet objCollection2 = appIE.document.getElementById(\"ctl31_ctl04_ctl03_ddValue\")\nobjCollection2.selectedIndex = 4\nobjCollection2.FireEvent \"onchange\"\nApplication.Wait (Now + TimeValue(\"0:00:002\"))\nSet objCollection3 = appIE.document.getElementById(\"ctl31_ctl04_ctl05\")\nobjCollection3.Click\nSet objCollection4 = appIE.document.getElementById(\"ctl31_ctl04_ctl05_divDropDown_ctl01\")\nobjCollection4.Focus\nobjCollection4.Checked = \"checked\"\nSet objCollection5 = appIE.document.getElementById(\"ctl31_ctl04_ctl05_divDropDown_ctl03\")\nobjCollection5.Focus\nobjCollection5.Checked = \"checked\"\nobjCollection5.FireEvent \"onchange\"\n\nSet objCollection6 = appIE.document.getElementById(\"ctl31_ctl04_ctl00\")\nobjCollection6.Click\nApplication.Wait (Now + TimeValue(\"0:00:002\"))\n\nSet objCollection7 = appIE.document.getElementById(\"ctl31_ctl06_ctl04_ctl00_Button\")\nobjCollection7.Click\n\n\n  Set appIE = Nothing\nEnd Sub\n</code></pre>\n\n<p>This gets me to the point of selecting the export button but I can't figure out how to select the excel option.</p>\n\n<p>Export Menu:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jHZUK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jHZUK.png\" alt=\"Export Menu\"></a></p>\n\n<p>Here is the HTML code from the site:</p>\n\n<pre><code>&lt;table style=\"display:inline;\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n                        &lt;tbody&gt;&lt;tr&gt;\n                            &lt;td height=\"28\"&gt;&lt;div class=\"HoverButton\" id=\"ctl31_ctl06_ctl04_ctl00\"&gt;\n                                &lt;table title=\"Export\" id=\"ctl31_ctl06_ctl04_ctl00_Button\" border=\"0\"&gt;\n                                    &lt;tbody&gt;&lt;tr&gt;\n                                        &lt;td&gt;&lt;a id=\"ctl31_ctl06_ctl04_ctl00_ButtonLink\" style=\"cursor: pointer;\" href=\"javascript:void(0)\"&gt;&lt;img id=\"ctl31_ctl06_ctl04_ctl00_ButtonImg\" style=\"border-style:None;height:16px;width:16px;border-width:0px;\" src=\"/Reports/Reserved.ReportViewerWebControl.axd?OpType=Resource&amp;amp;Version=10.50.1600.1&amp;amp;Name=Microsoft.Reporting.WebForms.Icons.Export.gif\"&gt;&lt;img id=\"ctl31_ctl06_ctl04_ctl00_ButtonImgDown\" style=\"border-style:None;height:6px;width:7px;border-width:0px;margin-bottom:5px;margin-left:5px;\" src=\"/Reports/Reserved.ReportViewerWebControl.axd?OpType=Resource&amp;amp;Version=10.50.1600.1&amp;amp;Name=Microsoft.Reporting.WebForms.Icons.ArrowDown.gif\"&gt;&lt;/a&gt;&lt;/td&gt;\n                                    &lt;/tr&gt;\n                                &lt;/tbody&gt;&lt;/table&gt;\n                            &lt;/div&gt;&lt;div class=\"MenuBarBkGnd\" id=\"ctl31_ctl06_ctl04_ctl00_Menu\" style=\"padding: 1px; display: block; visibility: visible; position: absolute;\"&gt;\n                                &lt;div class=\"HoverButton\"&gt;\n                                    &lt;a class=\"ActiveLink\" style=\"padding: 3px 8px 3px 32px; text-decoration: none; display: block; white-space: nowrap;\" onclick=\"$find('ctl31').exportReport('XML');\" href=\"javascript:void(0)\"&gt;XML file with report data&lt;/a&gt;\n                                &lt;/div&gt;&lt;div class=\"DisabledButton\"&gt;\n                                    &lt;a class=\"ActiveLink\" style=\"padding: 3px 8px 3px 32px; text-decoration: none; display: block; white-space: nowrap;\" onclick=\"$find('ctl31').exportReport('CSV');\" href=\"javascript:void(0)\"&gt;CSV (comma delimited)&lt;/a&gt;\n                                &lt;/div&gt;&lt;div class=\"DisabledButton\"&gt;\n                                    &lt;a class=\"ActiveLink\" style=\"padding: 3px 8px 3px 32px; text-decoration: none; display: block; white-space: nowrap;\" onclick=\"$find('ctl31').exportReport('PDF');\" href=\"javascript:void(0)\"&gt;PDF&lt;/a&gt;\n                                &lt;/div&gt;&lt;div class=\"DisabledButton\"&gt;\n                                    &lt;a class=\"ActiveLink\" style=\"padding: 3px 8px 3px 32px; text-decoration: none; display: block; white-space: nowrap;\" onclick=\"$find('ctl31').exportReport('MHTML');\" href=\"javascript:void(0)\"&gt;MHTML (web archive)&lt;/a&gt;\n                                &lt;/div&gt;&lt;div class=\"DisabledButton\"&gt;\n                                    &lt;a class=\"ActiveLink\" style=\"padding: 3px 8px 3px 32px; text-decoration: none; display: block; white-space: nowrap;\" onclick=\"$find('ctl31').exportReport('EXCEL');\" href=\"javascript:void(0)\"&gt;Excel&lt;/a&gt;\n                                &lt;/div&gt;&lt;div class=\"DisabledButton\"&gt;\n                                    &lt;a class=\"ActiveLink\" style=\"padding: 3px 8px 3px 32px; text-decoration: none; display: block; white-space: nowrap;\" onclick=\"$find('ctl31').exportReport('IMAGE');\" href=\"javascript:void(0)\"&gt;TIFF file&lt;/a&gt;\n                                &lt;/div&gt;&lt;div class=\"DisabledButton\"&gt;\n                                    &lt;a class=\"ActiveLink\" style=\"padding: 3px 8px 3px 32px; text-decoration: none; display: block; white-space: nowrap;\" onclick=\"$find('ctl31').exportReport('WORD');\" href=\"javascript:void(0)\"&gt;Word&lt;/a&gt;\n                                &lt;/div&gt;\n                            &lt;div style=\"left: 0px; top: 0px; width: 26px; height: 149px; filter: none; position: absolute; z-index: -1; opacity: 0.05; background-color: black;\"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/td&gt;\n                        &lt;/tr&gt;\n                    &lt;/tbody&gt;&lt;/table&gt;\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 2918049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a0b5a3d6c5e96f323b09ed9a37a1b0?s=128&d=identicon&r=PG&f=1", "display_name": "user2918049", "link": "https://stackoverflow.com/users/2918049/user2918049"}, "edited": false, "score": 0, "creation_date": 1528892694, "post_id": 50836485, "comment_id": 88678075, "body": "Thanks a lot for your answer. Unfortunately it seems to be exactly the same problem. I have tried with another file and I still have the same issue..."}, {"owner": {"reputation": 25, "user_id": 2918049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a0b5a3d6c5e96f323b09ed9a37a1b0?s=128&d=identicon&r=PG&f=1", "display_name": "user2918049", "link": "https://stackoverflow.com/users/2918049/user2918049"}, "edited": false, "score": 0, "creation_date": 1528893043, "post_id": 50836485, "comment_id": 88678328, "body": "Maybe it comes from the sections(1) term ?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 25, "user_id": 2918049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a0b5a3d6c5e96f323b09ed9a37a1b0?s=128&d=identicon&r=PG&f=1", "display_name": "user2918049", "link": "https://stackoverflow.com/users/2918049/user2918049"}, "edited": false, "score": 0, "creation_date": 1528894262, "post_id": 50836485, "comment_id": 88679142, "body": "That&#39;s very strange, but when I looked more closely, you are definitely correct. I&#39;ve found and posted a workaround that avoids using the Range object for the Footer. Never seen this happen before! There does seem to be some connection to rngSel somehow being linked to its originating section, even if I assign text to it, then collapse it so that it&#39;s fully on the new page. But rngSel returns the right section Index, so I&#39;ve used that to get the correct Footer..."}, {"owner": {"reputation": 25, "user_id": 2918049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a0b5a3d6c5e96f323b09ed9a37a1b0?s=128&d=identicon&r=PG&f=1", "display_name": "user2918049", "link": "https://stackoverflow.com/users/2918049/user2918049"}, "edited": false, "score": 0, "creation_date": 1528896024, "post_id": 50836485, "comment_id": 88680373, "body": "Perfect it works. I am actually not sure to understand it all. But that&#39;s alright."}, {"owner": {"reputation": 25, "user_id": 2918049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a0b5a3d6c5e96f323b09ed9a37a1b0?s=128&d=identicon&r=PG&f=1", "display_name": "user2918049", "link": "https://stackoverflow.com/users/2918049/user2918049"}, "edited": false, "score": 0, "creation_date": 1528896291, "post_id": 50836485, "comment_id": 88680575, "body": "I had another question concerning this macro. Should I open another thread ? It&#39;s on how to include a vbCrLf after the &quot;Annexe1&quot; line and then define a new format. Even though I include it after the rngSel.Select, it adds the vbCrLf before the &quot;Annexe1&quot; line."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 25, "user_id": 2918049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a0b5a3d6c5e96f323b09ed9a37a1b0?s=128&d=identicon&r=PG&f=1", "display_name": "user2918049", "link": "https://stackoverflow.com/users/2918049/user2918049"}, "edited": false, "score": 0, "creation_date": 1528896722, "post_id": 50836485, "comment_id": 88680869, "body": "See if this helps, otherwise a new Question with full information: Do a <code>rngSelect.InsertAfter vbCr</code> followed by <code>rngSelect.Collapse wdCollapseEnd</code>. (Note: do NOT use vbCrLf in Word!) Now the focus should be in the paragraph you added and Annexe1 will be applied to that."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 25, "user_id": 2918049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a0b5a3d6c5e96f323b09ed9a37a1b0?s=128&d=identicon&r=PG&f=1", "display_name": "user2918049", "link": "https://stackoverflow.com/users/2918049/user2918049"}, "edited": false, "score": 0, "creation_date": 1528896756, "post_id": 50836485, "comment_id": 88680897, "body": "You can ask about what you don&#39;t understand and I&#39;ll be happy to amend my Answer so that it&#39;s clear(er)."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1528894160, "last_edit_date": 1528894160, "creation_date": 1528890470, "answer_id": 50836485, "question_id": 50833481, "link": "https://stackoverflow.com/questions/50833481/vba-footers-modifications-unlink-to-previous/50836485#50836485", "title": "VBA - Footers modifications - Unlink to previous", "body": "<p>It's always tricky when you work with <code>Selection</code> in VBA code - it doesn't always precisely mimic what happens when the user performs actions. This is especially an issue with Headers and Footers when <code>SeekView</code> is used.</p>\n\n<p>The following works with <code>Range</code> objects (think of a Range like an invisible selection, but you can have many Ranges in your VBA code - there can be only one selection).</p>\n\n<p>It starts off by assigning the current selection to a Range object, then goes on to insert the Section Break and compare the page orientation, just as you have.</p>\n\n<p>If the page orientation needs to be changed, the new section's footer is assigned to a <code>Footer</code> object. Then the footer's <code>Range.ParagraphFormat</code> is assigned to a <code>ParagraphFormat</code> object*. Notice how these are then used to change the settings you have in your code. The big difference is, the code doesn't put any selection in the footer: everything is done directly. This is not only faster and more accurate, it also reduces screen \"flicker\".</p>\n\n<p>At the end, the original Range (which has since moved beyond the original selection) is selected, since I assume you want to continue with text input at that point. If not, then you can remove this line.</p>\n\n<pre><code>Sub ChangePageOrientationAndTabs()\n    Dim ftr As word.HeaderFooter\n    Dim pf As word.ParagraphFormat\n    Dim rngSel As word.Range\n\n    Set rngSel = Selection.Range\n    rngSel.InsertBreak Type:=wdSectionBreakNextPage\n    If rngSel.PageSetup.Orientation = wdOrientPortrait Then\n        MsgBox \"OK\"\n    Else\n        rngSel.PageSetup.Orientation = wdOrientPortrait\n        Set ftr = ActiveDocument.Sections(rngSel.Sections(1).index).Footers(wdHeaderFooterPrimary)\n        ftr.LinkToPrevious = False\n\n        Set pf = ftr.Range.ParagraphFormat\n        pf.TabStops.ClearAll\n        pf.TabStops(CentimetersToPoints(18)).Position = _\n          CentimetersToPoints(18.5)\n        pf.TabStops.Add Position:=CentimetersToPoints(9.5), _\n          Alignment:=wdAlignTabCenter, Leader:=wdTabLeaderSpaces\n\n    End If\n\n    rngSel.Paragraphs(1).Range.style = ActiveDocument.styles(\"Annexe1\")\n    rngSel.Select\nEnd Sub\n</code></pre>\n\n<p>*It's a puzzle to me why assigning the Footer.Range to a <code>Range</code> object works on the previous section's Footer, while Footer and ParagraphFormat are correct...</p>\n"}], "owner": {"reputation": 25, "user_id": 2918049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a0b5a3d6c5e96f323b09ed9a37a1b0?s=128&d=identicon&r=PG&f=1", "display_name": "user2918049", "link": "https://stackoverflow.com/users/2918049/user2918049"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 50836485, "answer_count": 1, "score": 1, "last_activity_date": 1528894160, "creation_date": 1528881406, "last_edit_date": 1528890082, "question_id": 50833481, "link": "https://stackoverflow.com/questions/50833481/vba-footers-modifications-unlink-to-previous", "title": "VBA - Footers modifications - Unlink to previous", "body": "<p>I am trying to create a macro that creates a new page with a different orientation, and with a different tabulation.</p>\n\n<p>I have this code :</p>\n\n<pre><code>Selection.InsertBreak Type:=wdSectionBreakNextPage\nIf Selection.PageSetup.Orientation = wdOrientPortrait Then\n  MsgBox \"OK\"\nElse\n  Selection.PageSetup.Orientation = wdOrientPortrait\n\n  ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter\n  Selection.HeaderFooter.LinkToPrevious = Not Selection.HeaderFooter. _\n    LinkToPrevious\n\n  Selection.ParagraphFormat.TabStops.ClearAll\n  Selection.ParagraphFormat.TabStops(CentimetersToPoints(18)).Position = _\n    CentimetersToPoints(18.5)\n  Selection.ParagraphFormat.TabStops.Add Position:=CentimetersToPoints(9.5), _\n      Alignment:=wdAlignTabCenter, Leader:=wdTabLeaderSpaces\n  ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument\nEnd If\n\nSelection.Style = ActiveDocument.Styles(\"Annexe1\")\n</code></pre>\n\n<p>Unfortunately this changes the tabulations of the page just before.</p>\n\n<p>Is there a way i can solve this ?\nI have tried the GoTo function, with page, section,...but it doesn't do the trick.</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4713437, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/627d35b287327e6f452272e532519774?s=128&d=identicon&r=PG&f=1", "display_name": "glaziko", "link": "https://stackoverflow.com/users/4713437/glaziko"}, "edited": false, "score": 0, "creation_date": 1528883222, "post_id": 50833545, "comment_id": 88671992, "body": "Out of my Conditional Formating function, i have the exact same code as you wrote and the output is the same : black hairline. Check my Edit for an image"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1528881621, "creation_date": 1528881621, "answer_id": 50833545, "question_id": 50833375, "link": "https://stackoverflow.com/questions/50833375/how-apply-color-to-xlhairline/50833545#50833545", "title": "How Apply color to xlHairline", "body": "<p>This is a simple example:</p>\n\n<pre><code>Sub TestMe()\n\n    With Selection\n        .Borders(xlEdgeLeft).Weight = xlHairline\n        .Borders(xlEdgeRight).Weight = xlHairline\n        .Borders(xlEdgeBottom).Weight = xlHairline\n        .Borders(xlEdgeTop).Weight = xlHairline\n\n        .Borders(xlEdgeTop).ColorIndex = 3\n        .Borders(xlEdgeLeft).ColorIndex = 3\n        .Borders(xlEdgeRight).ColorIndex = 3\n        .Borders(xlEdgeBottom).ColorIndex = 3\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>In your code, if you write <code>With .Borders(xlEdgeLeft)</code> then it would work quite ok, but only for the left border. Then you have to think of a way to cover all the 4 Edges, like in example:</p>\n"}], "owner": {"reputation": 63, "user_id": 4713437, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/627d35b287327e6f452272e532519774?s=128&d=identicon&r=PG&f=1", "display_name": "glaziko", "link": "https://stackoverflow.com/users/4713437/glaziko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1528894717, "creation_date": 1528881069, "last_edit_date": 1531164843, "question_id": 50833375, "link": "https://stackoverflow.com/questions/50833375/how-apply-color-to-xlhairline", "title": "How Apply color to xlHairline", "body": "<p>I've written a small macro that formats an excel sheet and exports it to a PDF.</p>\n\n<p>I am sorting out the look&amp;feel of the PDF and I would like to modify the borders.</p>\n\n<p>I have modified the borders the way I wanted to but I would like to try it out with a <strong>XLBorderWeight</strong> of type <strong>xlHairline</strong>.</p>\n\n<p>The problem is that i would like to apply a color to my <strong>xlHairline</strong>. It comes out on my PDF in <strong>black</strong> instead of my <strong>ColorIndex(3)</strong> (it's red)</p>\n\n<p>All other <strong>XLBorderWeight</strong> get colored correctly.</p>\n\n<pre><code>With Selection.FormatConditions(1)\n    With .Font\n        .ColorIndex = 3\n    End With\n    With .Borders\n        .ColorIndex = 3\n        .Weight = xlHairline\n        .LineStyle = xlContinuous\n    End With\nEnd With\n</code></pre>\n\n<p>I have tried it also outside of <strong>Conditional Formating</strong> and the same issue appears.</p>\n\n<p>I have searched for the past 2 hours to see if it is possible or not to color an <strong>xlHairline</strong> but with no answer.</p>\n\n<p>Anyone here has an idea on how to solve this?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here is a visual of it when applied using .Borders (conditionnal formatting) or .Borders(xlBorderIndex Enumeration) </p>\n\n<p>Here the edge is <strong>xlHairline red</strong> while the inside is <strong>xlThin white</strong></p>\n\n<p>Result is the same if I use my script or Vityata's answer</p>\n\n<p><a href=\"https://i.stack.imgur.com/2rkqc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2rkqc.png\" alt=\"Black Hairline\"></a></p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1528884033, "post_id": 50833372, "comment_id": 88672562, "body": "Use the <code>.top</code> and <code>.left</code> properties of the control.  Are you talking about on the form or on the worksheet?"}], "owner": {"reputation": 23, "user_id": 9283193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d8552a548c3ae72dd10af11ab109b1?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/9283193/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1528883955, "creation_date": 1528881059, "last_edit_date": 1528883955, "question_id": 50833372, "link": "https://stackoverflow.com/questions/50833372/how-do-i-specify-a-location-of-a-combobox-value-if-a-specific-option-button-is-s", "title": "How do I specify a location of a combobox value if a specific option button is selected?", "body": "<p>I am trying to automate my timesheet for work and what I want is when I select Monday, Tuesday, Wednesday etc. the combobox (containing the number of hours worked) destination will change to a specific column. </p>\n\n<p>The code I currently have is below:</p>\n\n<pre><code>Private Sub cmdAdd_Click()\nDim LastRow As Long, ws As Worksheet\n\nSet ws = Sheets(\"Timesheet\")\n\nLastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1 row\n\nws.Range(\"B\" &amp; LastRow).Value = JobNumber.Text\nws.Range(\"C\" &amp; LastRow).Value = JobDescription.Text\n\n'clear the data\n Me.JobNumber.Value = \"\"\n Me.JobDescription.Value = \"\"\n Me.Monday.Value = \"\"\n Me.Tuesday.Value = \"\"\n Me.Wedensday.Value = \"\"\n Me.Thursday.Value = \"\"\n Me.Friday.Value = \"\"\n Me.Saturday.Value = \"\"\n Me.Sunday.Value = \"\"\n Me.NumberOfHours.Value = \"\"\n Me.JobNumber.SetFocus\n\nEnd Sub\n\nPrivate Sub cmdClear_Click()\nUnload Me\nTimesheetForm.Show\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\n JobNumber.RowSource = \"JobNumberList\"\n JobDescription.RowSource = \"JobDescriptionList\"\n\n With Me.NumberOfHours\n.AddItem \"1\"\n.AddItem \"2\"\n.AddItem \"3\"\n.AddItem \"4\"\n.AddItem \"5\"\n.AddItem \"6\"\n.AddItem \"7\"\n.AddItem \"8\"\n.AddItem \"9\"\n.AddItem \"10\"\n.AddItem \"11\"\n.AddItem \"12\"\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1528881135, "post_id": 50833191, "comment_id": 88670562, "body": "I assume you got your 5yyears, 10months and 31 days comboboxes set up using the Input Range. try to use a Cell Link and then Index formula in another cell to get a value of what was selected in the combox."}, {"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "reply_to_user": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1528884949, "post_id": 50833191, "comment_id": 88673193, "body": "it&#39;s a workaround, but it works :D"}], "owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528889511, "creation_date": 1528880540, "last_edit_date": 1528889511, "question_id": 50833191, "link": "https://stackoverflow.com/questions/50833191/connect-combobox-to-vba", "title": "Connect combobox to VBA", "body": "<p>I am new to VBA and I am trying to write a simple code that reads a particular file in my local folder. The code i wrote is:</p>\n\n<pre><code>  Sub Opentrading()\n    Dim FolderPath As String\n    Dim Path As String\n    Dim nyear As String\n    Dim nmont As String\n    Dim nday As String\n    Dim wkbk As Workbook\n\n    FolderPath = \"F:\\FICM\\Trading Runs\\Daily Trading Runs\"\n    nyear = Sheet6.Range(\"B2\")\n    nmont = Sheet6.Range(\"B3\")\n    nday = Sheet6.Range(\"B4\")\n    Path = FolderPath &amp; \"\\\" &amp; nyear &amp; \"-\" &amp; nmont &amp; \"-\" &amp; nday &amp; \" Trading - Southern_Europe\" &amp; \".xlsx\"\n    Set wkbk = Workbooks.Open(Path)\n    wkbk.Close savechanges:=False\n  End Sub\n</code></pre>\n\n<p>My files are divided by year month and day. So for example i have one file that is \"2018-06-12 Trading - Southern_Europe\". Now, If i put the exact number in the ranges B2 B3 and B4 the code works, but i need to put a combobox so i can select between years, months and days. How can i do that? I was able to prepare the combobox with 5 years, 12 months and 31 days, but i do not know how to connect to my vba code. I suppose that the range property is no more useful since, while I have positioned the combo boxes in those ranges (B2 B3 and B4) the value is empty, since the actual value is inside the combo box.</p>\n"}, {"tags": ["excel", "performance", "login", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1528880839, "post_id": 50833066, "comment_id": 88670376, "body": "Delete    <code>On Error GoTo errHandler:</code> and see where exactly the error is."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9934826, "user_type": "registered", "profile_image": "https://graph.facebook.com/1960130340678582/picture?type=large", "display_name": "Valour", "link": "https://stackoverflow.com/users/9934826/valour"}, "edited": false, "score": 0, "creation_date": 1528881209, "post_id": 50833220, "comment_id": 88670605, "body": "Wow. That was... really simple. I&#39;m relatively new to the world of coding (especially with excel) so that was really helpful. Thank you!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1528880642, "creation_date": 1528880642, "answer_id": 50833220, "question_id": 50833066, "link": "https://stackoverflow.com/questions/50833066/method-rows-of-object-global-failed-error-from-login-upon-startup/50833220#50833220", "title": "\u201cMethod &#39;Rows&#39; of object &#39;_Global&#39; failed \u201d Error from Login upon startup", "body": "<p>Write <code>Sheet3.Rows.Count</code> instead of <code>Rows.Count</code>.</p>\n\n<p>As far as this is the only place you are using <code>Rows</code>, it should be the one making the error.</p>\n"}], "owner": {"reputation": 43, "user_id": 9934826, "user_type": "registered", "profile_image": "https://graph.facebook.com/1960130340678582/picture?type=large", "display_name": "Valour", "link": "https://stackoverflow.com/users/9934826/valour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 50833220, "answer_count": 1, "score": 1, "last_activity_date": 1528880689, "creation_date": 1528880185, "last_edit_date": 1531164843, "question_id": 50833066, "link": "https://stackoverflow.com/questions/50833066/method-rows-of-object-global-failed-error-from-login-upon-startup", "title": "\u201cMethod &#39;Rows&#39; of object &#39;_Global&#39; failed \u201d Error from Login upon startup", "body": "<p>I Need a bit of help with an excel program I'm creating. What I'm trying to do is create a login userform that when opening the excel in question, the login userform is the first thing to appear before having access to the workbook. Now when I test run the below code in VBA, it works no problem. However when I attempt to open the excel and login (how its suppose to function), it gives me the error that's in the title. This is the code:</p>\n\n<p>`</p>\n\n<pre><code>    Sub LoginRun()\n    Dim AddData As Range, Current As Range\n    Dim user As Variant, Code As Variant\n    Dim PName As Variant, AName As Variant\n    Dim ws As Worksheet, ws2 As Worksheet, ws3 As Worksheet\n    Dim result As Integer\n    Dim TitleStr As String\n    Dim msg As VbMsgBoxResult\n\n    'Variables\n    user = OpeningWindow.UsernameTextbox.Value\n    Code = OpeningWindow.PasswordTextbox.Value\n    TitleStr = \"Password check\"\n    result = 0\n    Set Current = Sheet3.Range(\"B13\")\n\n    On Error GoTo errHandler:\n    Set AddData = Sheet3.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0)\n    If user &lt;&gt; \"\" And Not IsNumeric(user) And Code &lt;&gt; \"\" And IsNumeric(Code) Then\n        For Each AName In Sheet3.Range(\"AM13:AM47\")\n            If AName = CLng(Code) And AName.Offset(0, -1) = user Then ' Use this for passcode numbers only\n                MsgBox \"Welcome Back: \u2013 \" &amp; user &amp; \" \" &amp; Code\n                AddData.Value = user\n                AddData.Offset(0, 1).Value = Now\n                Current.Value = user\n                result = 1\n                MainMenuAdmin.Show\n                Unload OpeningWindow\n                Exit Sub\n            End If\n        Next AName\n    End If\n\n    If user &lt;&gt; \"\" And Not IsNumeric(user) And Code &lt;&gt; \"\" And IsNumeric(Code) Then\n        For Each PName In Sheet3.Range(\"E13:E47\")\n            If PName = Code And PName.Offset(0, -1) = user Then ' Use this for passcode numbers only\n                MsgBox \"Welcome Back: \u2013 \" &amp; user &amp; \" \" &amp; Code\n                AddData.Value = user\n                AddData.Offset(0, 1).Value = Now\n                Current.Value = user\n                result = 1\n                MainMenuUser.Show\n                Unload OpeningWindow\n                Exit Sub\n            End If\n        Next PName\n    End If\n\n    If result = 0 Then\n        Trial = Trial + 1\n        If Trial &lt; 3 Then msg = MsgBox(\"Wrong password, please try again\", vbExclamation + vbOKOnly, TitleStr)\n        OpeningWindow.UsernameTextbox.SetFocus\n        If Trial = 3 Then\n            msg = MsgBox(\"Wrong password, the form will close\u2026\", vbCritical + vbOKOnly, TitleStr)\n            ActiveWorkbook.Close False\n        End If\n    End If\n    Exit Sub\n\nerrHandler:\n MsgBox \"An Error has Occurred \" &amp; vbCrLf &amp; \"The error number is: \" _\n &amp; Err.Number &amp; vbCrLf &amp; Err.Description &amp; vbCrLf &amp; _\n \"Please notify the administrator\"\n End Sub\n</code></pre>\n\n<p>`</p>\n\n<p>and this is the code I'm using that shows the userform before having access to the workbook:</p>\n\n<p>`</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Application.ScreenUpdating = False\n    ActiveWindow.Visible = False\n    OpeningWindow.Show\n    Windows(ThisWorkbook.Name).Visible = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>`</p>\n\n<p>How this basically works is the code reads through a list on sheet3 for the corresponding username and password thats being entered and then allows me access to the workbook if the password that's inputed matches the database of its corresponding username. My theory is because the worksheet (while the work book is technically open) is hidden still, the code can't find the row/columns where the username list is, but i could be wrong (hence why i'm asking here). Is there a way to fix this? Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "is_accepted": true, "score": 0, "last_activity_date": 1528893717, "creation_date": 1528893717, "answer_id": 50837580, "question_id": 50832968, "link": "https://stackoverflow.com/questions/50832968/allow-user-to-choose-which-text-file-to-import/50837580#50837580", "title": "Allow user to choose which text file to import", "body": "<p>This will do it, I made some changes to your code.</p>\n\n<pre><code>Sub SelectFile()\n\nDim fName As Variant\n\nfName = Application.GetOpenFilename(\"txtfiles (*.txt), *.txt\")\nIf fName = False Then\nMsgBox \"No File Was Selected\"\nExit Sub\nEnd If\n\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;\" &amp; fName, Destination:=Range(\"$A$1\"))\n.Name = \"Example\"\n.FieldNames = True\n.RowNumbers = False\n.FillAdjacentFormulas = False\n.PreserveFormatting = True\n.RefreshOnFileOpen = False\n.RefreshStyle = xlInsertDeleteCells\n.SavePassword = False\n.SaveData = True\n.AdjustColumnWidth = True\n.RefreshPeriod = 0\n.TextFilePromptOnRefresh = False\n.TextFilePlatform = 850\n.TextFileStartRow = 1\n.TextFileParseType = xlDelimited\n.TextFileTextQualifier = xlTextQualifierDoubleQuote\n.TextFileConsecutiveDelimiter = False\n.TextFileTabDelimiter = False\n.TextFileSemicolonDelimiter = False\n.TextFileCommaDelimiter = False\n.TextFileSpaceDelimiter = True\n.TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \n 1, 1, 1, 1, _\n1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, \n1, 1)\n.TextFileTrailingMinusNumbers = True\n.Refresh BackgroundQuery:=False\n End With\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9513404, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KLDAgv99NDw/AAAAAAAAAAI/AAAAAAAAAA8/csf8NY61UKA/photo.jpg?sz=128", "display_name": "From bits To Chips", "link": "https://stackoverflow.com/users/9513404/from-bits-to-chips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 50837580, "answer_count": 1, "score": 0, "last_activity_date": 1528893717, "creation_date": 1528879945, "last_edit_date": 1528885058, "question_id": 50832968, "link": "https://stackoverflow.com/questions/50832968/allow-user-to-choose-which-text-file-to-import", "title": "Allow user to choose which text file to import", "body": "<p>I'm trying to create a VBA macro to allow a user to select a text file and import it into a excel spreadsheet, but i keep getting an error 1004</p>\n\n<p>Here is my code</p>\n\n<pre><code>Sub SelectFile()\n\nDim fName As String\n\nfName = Application.GetOpenFilename()\nIf fName = False Then Exit Sub\n\nSheets(\"Import sheet\").Select\nRange(\"A1\").Select\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT; \" &amp; fName, Destination:=Range(\"$A$1\"))\n    .Name = \"Example\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 850\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = False\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = True\n    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "date-formatting", "vba"], "comments": [{"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1528879905, "post_id": 50832795, "comment_id": 88669794, "body": "It&#39;s a known issue in Excel. Generally, it relates to regional settings of your system. By default, Excel picks the date from there. Check your regional settings, date format there would be mm/dd/yyyy."}, {"owner": {"reputation": 57, "user_id": 9384311, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aimee", "link": "https://stackoverflow.com/users/9384311/aimee"}, "reply_to_user": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1528880655, "post_id": 50832795, "comment_id": 88670281, "body": "@jainashish, my regional settings for short date is indeed M/d/yyyy but it won&#39;t work for me to change my regional settings because the file has to be shared across to multiple users. Thanks!"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1528881998, "post_id": 50832795, "comment_id": 88671114, "body": "Have you tried Application.International(xlDateOrder) to fetch the end user date format and then manipulating the date accordingly?"}], "answers": [{"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1528880152, "creation_date": 1528880152, "answer_id": 50833050, "question_id": 50832795, "link": "https://stackoverflow.com/questions/50832795/date-format-not-working-in-excel-vba/50833050#50833050", "title": "Date Format not working in excel vba", "body": "<p>Format probably returns the date in the format you want, but it is then transformed into a date-value which is then printed in the default format for your system. To get them stored in the format you want, you could try something like:</p>\n\n<pre><code>Option Explicit\n\nSub cmdSubmit_Click()\n    Dim StartDate As Date, EndDate As Date\n    Dim s1 As String, s2 As String\n\n    StartDate = #6/11/2018#\n    EndDate = #6/24/2018#\n\n    'StartDate = Format(StartDate, \"dd/mmm/yyyy\")\n    'EndDate = Format(EndDate, \"dd/mmm/yyyy\")\n\n    s1 = Format(StartDate, \"dd/mmm/yyyy\")\n    s2 = Format(EndDate, \"dd/mmm/yyyy\")\n\n    Debug.Print StartDate &amp; \" - \" &amp; s1          ' gave me 6/11/2018 instead of 11/Jun/2018\n    Debug.Print EndDate &amp; \" - \" &amp; s2\nEnd Sub\n</code></pre>\n\n<p>Alternately if you want them in a cell as dates, you could set the <code>NumberFormat</code>  of the range you write them to, to be in your wanted format:</p>\n\n<pre><code>Sheet1.Range(\"A1\") = StartDate\nSheet1.Range(\"A2\") = EndDate\nSheet1.Range(\"A1:A2\").NumberFormat = \"dd.mmm.yyyy\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1528880280, "creation_date": 1528880280, "answer_id": 50833102, "question_id": 50832795, "link": "https://stackoverflow.com/questions/50832795/date-format-not-working-in-excel-vba/50833102#50833102", "title": "Date Format not working in excel vba", "body": "<p>If you need to format the date in VBA you have 2 options:</p>\n\n<ol>\n<li>Change the regional settings;</li>\n<li>Write to Excel, format there and bring the <code>.Text</code>:</li>\n</ol>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim StartDate As Date\n\n    StartDate = #6/11/2018#\n    Cells(1, 1) = StartDate\n    Cells(1, 1).NumberFormat = \"DD/MMM/YYYY\"\n    Debug.Print Cells(1, 1).Text '11.Jun.2018\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "is_accepted": true, "score": 0, "last_activity_date": 1528883259, "creation_date": 1528883259, "answer_id": 50834141, "question_id": 50832795, "link": "https://stackoverflow.com/questions/50832795/date-format-not-working-in-excel-vba/50834141#50834141", "title": "Date Format not working in excel vba", "body": "<p>As per the <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/bb177675(v=office.12)\" rel=\"nofollow noreferrer\">MSDN</a> Application.International(Index) method returns information about the current country/region and international settings.</p>\n\n<p>When you apply index as xlDateOrder</p>\n\n<pre><code>0 = month-day-year\n1 = day-month-year\n2 = year-month-day\n</code></pre>\n\n<p>Hence, we will be using this property to override the system behavior. This is especially useful when the Excel-VBA project is used across geographies with various individual regional settings.</p>\n\n<p>Below, I am re-writing your code with a minor tweak. Format function returns the string but you are assigning it to a date which is causing this issue.</p>\n\n<pre><code>Sub cmdSubmit_Click()\n    Dim StartDate As Date, EndDate As Date\n    Dim strStartDate as String, strEndDate as String\n\n    StartDate = DTPickStart.Value    ' 6/11/2018\n    EndDate = DTPickEnd.Value        ' 6/24/2018\n\n    strStartDate = Format(StartDate, \"dd/mmm/yyyy\")\n    strEndDate = Format(EndDate, \"dd/mmm/yyyy\")\n\n    Debug.Print StartDate           ' It will give 11/Jun/2018\n    Debug.Print EndDate\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 9384311, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aimee", "link": "https://stackoverflow.com/users/9384311/aimee"}, "is_accepted": false, "score": 0, "last_activity_date": 1530090107, "creation_date": 1530090107, "answer_id": 51058631, "question_id": 50832795, "link": "https://stackoverflow.com/questions/50832795/date-format-not-working-in-excel-vba/51058631#51058631", "title": "Date Format not working in excel vba", "body": "<p>Thanks everyone. I managed to figure it out, but I'm giving my vote to jainashish as it's closer to how I could use the result to query my access db.</p>\n"}], "owner": {"reputation": 57, "user_id": 9384311, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aimee", "link": "https://stackoverflow.com/users/9384311/aimee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6383, "favorite_count": 0, "accepted_answer_id": 50834141, "answer_count": 4, "score": 3, "last_activity_date": 1530090107, "creation_date": 1528879420, "last_edit_date": 1531164843, "question_id": 50832795, "link": "https://stackoverflow.com/questions/50832795/date-format-not-working-in-excel-vba", "title": "Date Format not working in excel vba", "body": "<p>I'm having some difficulties with my datepicker date. StartDate and EndDate are values from DatePicker and Debug.Print will give me \"mm/dd/yyyy\". I am trying to change the date format to \"dd/mmm/yyyy\" so that I will be able to compare it with my data from MS access. But it's not working.</p>\n\n<pre><code>Sub cmdSubmit_Click()\n    Dim StartDate As Date, EndDate As Date\n\n    StartDate = DTPickStart.Value    ' 6/11/2018\n    EndDate = DTPickEnd.Value        ' 6/24/2018\n\n    StartDate = Format(StartDate, \"dd/mmm/yyyy\")\n    EndDate = Format(EndDate, \"dd/mmm/yyyy\")\n\n    Debug.Print StartDate           ' gave me 6/11/2018 instead of 11/Jun/2018\n    Debug.Print EndDate\nEnd Sub\n</code></pre>\n\n<p>Any advice on what I am doing wrong here?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1528879233, "post_id": 50832170, "comment_id": 88669408, "body": "&#39;Wordy&#39; code equals faster execution time and fewer errors. You just have to write good code."}], "answers": [{"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 1, "last_activity_date": 1528877763, "creation_date": 1528877763, "answer_id": 50832282, "question_id": 50832170, "link": "https://stackoverflow.com/questions/50832170/defining-code-on-vba-excel-to-simplify-code-writing-process/50832282#50832282", "title": "defining code on vba excel to simplify code writing process", "body": "<p>Just like in any programming language, you can <strong>use variables to store data</strong>\nFor example: </p>\n\n<p><code>Dim myrange As Range: Set myrange = Sheets(\"Sheet1\").Range(\"B5\")</code></p>\n\n<p>Alternatively, if you will be working with the <strong>same object multiple times</strong>, you can <strong>use the <code>With</code> keyword</strong>\nFor example. instead of writing you want to work with table every time on every new line you can do</p>\n\n<pre><code>With Sheets(\"Sheet1\").ListObjects(\"Table1\")\n   .ListRows.Add\n   .ListColumns(2).Range(3) = \"Hello World!\"\n   ' ... and so on\nEnd With\n</code></pre>\n\n<hr>\n\n<p>Also, please on a sidenote: Avoid using <code>Select/ActiveSheet/ActiveWorkbook</code> and so on!<br>\nMore info on how to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "is_accepted": true, "score": 0, "last_activity_date": 1528878666, "creation_date": 1528878666, "answer_id": 50832565, "question_id": 50832170, "link": "https://stackoverflow.com/questions/50832170/defining-code-on-vba-excel-to-simplify-code-writing-process/50832565#50832565", "title": "defining code on vba excel to simplify code writing process", "body": "<p>You can create functions or customized properties, which are always evaluated when called</p>\n\n<pre><code>Property Get pARng As Range\n    Set pARng = ThisWorkBook.ActiveSheet.Range\nEnd Property\n\nFunction fARng As Range\n    Set fARng = ThisWorkBook.ActiveSheet.Range\nEnd Function\n\n'Usage\nSub xxx\n\n    '...\n\n    pARng.Rows(1).Activate\n    'Same as ThisWorkBook.ActiveSheet.Range.Rows(1).Activate\n\n    fARng.Rows(1).Activate\n    'using function instead achieves same result\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9923846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/794926f73c27c76c2e19e73914eb68d9?s=128&d=identicon&r=PG&f=1", "display_name": "eeeccc17", "link": "https://stackoverflow.com/users/9923846/eeeccc17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 50832565, "answer_count": 2, "score": 1, "last_activity_date": 1528883912, "creation_date": 1528877396, "last_edit_date": 1528883912, "question_id": 50832170, "link": "https://stackoverflow.com/questions/50832170/defining-code-on-vba-excel-to-simplify-code-writing-process", "title": "defining code on vba excel to simplify code writing process", "body": "<p>I am attempting to reduce the amount of clutter on my code by creating \"shortcuts\" if you will</p>\n\n<p>For instance, I always have to type </p>\n\n<pre><code>ThisWorkBook.ActiveSheet.Range\n</code></pre>\n\n<p>Is there a way for me to define the above to create a less wordy macro? I have tried convert to range and string and the former returns an error (but I could still get intellisense recognize and attempt to autofill) while the string version doesnt work.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1528877988, "post_id": 50831966, "comment_id": 88668725, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13174916/transpose-a-range-in-vba\">Transpose a range in VBA</a>"}, {"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1528878757, "post_id": 50831966, "comment_id": 88669150, "body": "@Rawrplus The code posted by dee is the one that I used above with some changes."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1528880367, "post_id": 50831966, "comment_id": 88670081, "body": "Why not use Copy/PasteSpecial ?"}], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1528891756, "post_id": 50833959, "comment_id": 88677451, "body": "It worked. But got 1 problem. Column B &amp; C got copied perfectly with same values. But values in Column D became 0 after transposing."}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1528892632, "post_id": 50833959, "comment_id": 88678022, "body": "Like i said - if the formulas use relative cell references you are going to refer to new cells. Eg. if you have the following formula in cell <code>D4</code>: <code>=B4*C4</code> and transpose it to cell <code>C10</code> the formula will look like this: <code>=A10*B10</code>. This gives cell <code>C10</code> a new or even wrong value. You can try to use absolute cell references like this: <code>=$B$4*$C$4</code>."}, {"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1528893127, "post_id": 50833959, "comment_id": 88678383, "body": "oh.. Now it works properly. Thank you mate. Theres one thing that I want to ask. This column D which has the value, is entered by user. So if user entered formula uses relative cell references, this wont work - as said by you. So is it possible that before transposing the cells, selected cells (if it has formula), it&#39;ll be first converted into absolute cell references and then transpose ?"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1528894513, "post_id": 50833959, "comment_id": 88679329, "body": "Fortunately there is a way to do that. See my updated answer :)"}, {"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1528964087, "post_id": 50833959, "comment_id": 88708131, "body": "That worked perfectly. Thank you so much. Can you explain me the changes ?"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1528965253, "post_id": 50833959, "comment_id": 88708828, "body": "@AmanDevrath Awesome - All changes or just this last part with absolute references? :)"}, {"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1528968476, "post_id": 50833959, "comment_id": 88710850, "body": "Actually, if you have time, can you explain me the whole code ? I couldn&#39;t figure out how did that rowCounter and columnCounter worked. and also the new changes."}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1528968717, "post_id": 50833959, "comment_id": 88711015, "body": "@AmanDevrath I don&#39;t have the time right now unfortunately, but I will gladly add a full explanation when i get the time :)"}, {"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1528969811, "post_id": 50833959, "comment_id": 88711770, "body": "Sure. Whenever you get time. Thank you so much :)"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1529004864, "post_id": 50833959, "comment_id": 88731844, "body": "@AmanDevrath I&#39;ve updated my answer to include an explanation of the code. I hope I&#39;ve explained myself clearly enough for others to understand it :)"}, {"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1529307981, "post_id": 50833959, "comment_id": 88809353, "body": "wow man, you are one of the greatest. Thanx a lot. Your explanation was very helpful."}], "tags": [], "owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "is_accepted": true, "score": 1, "last_activity_date": 1529004814, "last_edit_date": 1529004814, "creation_date": 1528882717, "answer_id": 50833959, "question_id": 50831966, "link": "https://stackoverflow.com/questions/50831966/transpose-data-with-formulas-unchanged-vba/50833959#50833959", "title": "Transpose data with formulas unchanged VBA", "body": "<p>This should work:</p>\n\n<pre><code>Sub test()\nApplication.ScreenUpdating = False\n\nDim ws As Worksheet: Set ws = Worksheets(\"Sheet1\") 'Type the sheet where the data is pasted\nDim myRows As Long\nDim myColumns As Long\nDim rng As Range\nDim userInput As String\nDim Outputrng As Range\nDim rowCounter As Long\nDim columnCounter As Long\n\nmyColumns = Selection.Columns.Count\n\nuserInput = InputBox(\"Type output cell eg. B10\")\nIf userInput = vbNullString Then Exit Sub\n\nrowCounter = 0\ncolumnCounter = -1\n\nFor Each rng In Selection\n\n    columnCounter = columnCounter + 1\n\n    If columnCounter &gt; myColumns - 1 Then columnCounter = -1\n\n    If columnCounter = -1 Then\n        rowCounter = rowCounter + 1\n        columnCounter = 0\n    End If\n\n    Set Outputrng = ws.Range(userInput).Offset(columnCounter, rowCounter)\n\n        If rng.HasFormula = True Then\n           rng.Formula = Application.ConvertFormula(rng.Formula, xlA1, xlA1, 1)\n        End If\n\n    rng.Copy\n    Outputrng.PasteSpecial xlPasteFormulas\n\nNext\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Remember that if your formulas use relative cell references, you might get unexpected results.</p>\n\n<p><strong>Explanation of the code:</strong></p>\n\n<pre><code>myColumns = Selection.Columns.Count\n</code></pre>\n\n<p>The code snippet above stores the number of columns in the selected area for future use.</p>\n\n<pre><code>userInput = InputBox(\"Type output cell eg. B10\")\nIf userInput = vbNullString Then Exit Sub\n</code></pre>\n\n<p>The code snippet above prompts an <code>InputBox</code> in which the user can write the desired output cell. The output cell is going to be the top-left cell of the transposed data.\nThe <code>If</code> statement exits the <code>sub</code> if the user doesn't type a value.</p>\n\n<p>The <code>For Each rng In Selection</code> loop goes through each cell in the selected range. The code loops through columns from left to right first, then goes down a row and loops through columns again. The general idea with this loop is to identify the position of the cell and then paste it to the corresponding transposed position.</p>\n\n<p>The <code>columnCounter</code> and <code>rowCounter</code> keeps track of the position of the cell. <code>columnCounter = 0</code> and <code>rowCounter = 0</code> would be the very first cell to be transposed. This cell is pasted to the output cell specified by the user. <code>columnCounter = 1</code> and <code>rowCounter = 0</code> would be the second cell to be transposed. This cell is pasted in the same column, but one row below the output cell.</p>\n\n<p>At the beginning of each loop, the value of <code>columnCounter</code> is increased by <code>1</code>, which can be seen on the line <code>columnCounter = columnCounter + 1</code>.</p>\n\n<p>When the value of <code>columnCounter</code> becomes greater than the value of <code>myColumns</code> the value of <code>columnCounter</code> is set to <code>-1</code>. When the value of <code>columnCounter</code> is  <code>-1</code> the value of <code>rowCounter</code> is increased by <code>1</code> and the value of <code>columnCounter</code> is reset to <code>0</code>. This means that the loop has finished going through the columns in one row and is now moving on to the next row.<br>\nAll this can be seen in the following code snippet: </p>\n\n<pre><code>If columnCounter &gt; myColumns - 1 Then columnCounter = -1\n\nIf columnCounter = -1 Then\n   rowCounter = rowCounter + 1\n   columnCounter = 0\nEnd If\n</code></pre>\n\n<p>Now that the location of the cell is identified we need to paste it to the correct \"<code>output range</code>\", which is called <code>Outputrng</code> in the code. This is done in the following line:</p>\n\n<pre><code>Set Outputrng = ws.Range(userInput).Offset(columnCounter, rowCounter)\n</code></pre>\n\n<p>The basis for this line is the <code>Range(userInput)</code>. This is the original output cell specified by the user via the <code>InputBox</code>. Using <code>.Offset</code> we can work with a cell relative to the user-specified output cell. Since we need to transpose the original selection, we invert the position of the original cell using <code>columnCounter</code> and <code>rowCounter</code>.<br>\nNote that <code>columnCounter</code> is used as the <code>row offset</code> while <code>rowCounter</code> is used as the <code>column offset</code>.</p>\n\n<p>Next we check if the cell contains a formula. If it does, the formula is converted to absolute reference. This is done via the following code lines:</p>\n\n<pre><code>If rng.HasFormula = True Then\n   rng.Formula = Application.ConvertFormula(rng.Formula, xlA1, xlA1, 1)\nEnd If\n</code></pre>\n\n<p>Notice that the <code>1</code> at the end is what specifies that we want absolute reference. If we want relative reference, just change the <code>1</code> to a <code>4</code>.</p>\n\n<p>Last step is to paste the original cell to the <code>Outputrng</code>. To make sure that we paste the formulas as well, we use <code>.PasteSpecial xlPasteFormulas</code>. If the cell doesn't contain a formula, then the value is pasted. This is done on the following code lines:</p>\n\n<pre><code>rng.Copy\nOutputrng.PasteSpecial xlPasteFormulas\n</code></pre>\n\n<p>Using <code>Next</code> tells the code to go to the next cell in the selection, which is called <code>rng</code> in the code.</p>\n\n<p>This might not be the simplest or most elegant approach, but this is how I would do it - and it works! :)</p>\n"}], "owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 50833959, "answer_count": 1, "score": -1, "last_activity_date": 1529004814, "creation_date": 1528876732, "last_edit_date": 1528879157, "question_id": 50831966, "link": "https://stackoverflow.com/questions/50831966/transpose-data-with-formulas-unchanged-vba", "title": "Transpose data with formulas unchanged VBA", "body": "<p>Code :</p>\n\n<pre><code>Sub transposeTest()\n   Dim transposedVariant As Variant\n   Dim sourceRowRange As Range\n   Dim sourceRowRangeVariant As Variant\n\n   Set sourceRowRange = Selection\n   sourceRowRangeVariant = sourceRowRange.Value\n   transposedVariant = Application.Transpose(sourceRowRangeVariant)\n\n   Dim rangeFilledWithTransposedData As Range\n   Set rangeFilledWithTransposedData = Application.InputBox(\"Select cell to transpose selected data :\", \"Transpose Data\", , , , , , 8) ' eight rows, one column\n   rangeFilledWithTransposedData.Value = transposedVariant\nEnd Sub\n</code></pre>\n\n<p>Range that I need to transpose with their formulas.\n<a href=\"https://i.stack.imgur.com/712wt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/712wt.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><code>sourceRowRange</code> is the Selection done by user, example : image\n<code>RangeFilledWithTransposedData</code> is the cell that user selects for transposing the selected range. User wants the flexibility to select a range for transposing and also flexible enough to transpose data wherever they want in the current sheet.</p>\n\n<p>As you can see, <code>D3</code> is formula, which is <code>=B3*C3</code>. Similarly,formula goes for rest cells in <code>Column D</code>.</p>\n\n<p>Now, on using the above code I face 2 problems :<br>\n1. I have to select the output cell, as you can see the in the code. But when I do that, only the first value is pasted in that output cell, i.e. the value is printed as \"1\" from <code>B3</code>. But when I select a range for the output cell, for example same number of cells as my selection, then I get all the transposed columns. This means that If I select 2 cells, then only 2 cells will be transposed, if I select 10 cells, then 10 cells will be transposed. It doesnt transpose all the cells from the selection until I provide same number of cells as my selection.<br><br>\n2. The formulas don't get transposed. Only the values from <code>column D</code> gets transposed. Any way to transpose data with their respective formulas ?</p>\n"}, {"tags": ["xml", "vba", "applescript", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532544536, "post_id": 51459609, "comment_id": 90020281, "body": "Did you try this?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1532202872, "creation_date": 1532202872, "answer_id": 51459609, "question_id": 50831910, "link": "https://stackoverflow.com/questions/50831910/how-to-convert-pptx-to-xml-using-vba-or-applescript/51459609#51459609", "title": "How to convert PPTX to XML using vba or applescript?", "body": "<p>In more recent versions of Powerpoint you do not need VBA. Simply use the save as dialogue and save your pptx as powerpoint xml presentation.</p>\n\n<p><a href=\"https://i.stack.imgur.com/wYAW4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wYAW4.png\" alt=\"Dialog\"></a></p>\n\n<p><strong><a href=\"http://%20https://www.free-power-point-templates.com/articles/powerpoint-to-xml/\" rel=\"nofollow noreferrer\">Link</a></strong></p>\n"}], "owner": {"reputation": 684, "user_id": 2024276, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Ct5OH.jpg?s=128&g=1", "display_name": "Sivaprasad Km", "link": "https://stackoverflow.com/users/2024276/sivaprasad-km"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532202872, "creation_date": 1528876550, "last_edit_date": 1528886511, "question_id": 50831910, "link": "https://stackoverflow.com/questions/50831910/how-to-convert-pptx-to-xml-using-vba-or-applescript", "title": "How to convert PPTX to XML using vba or applescript?", "body": "<p>I need to export my active presentation as XMl file. Please help me to achive.\nIs it possible to do using VBA or Applescript from MAC</p>\n\n<p>There is an option in powerpoint to export pptx as xml file\nFile -> Save as -> XML file\nI need to achieve this without user interaction using vba or applescript.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1528878150, "post_id": 50831902, "comment_id": 88668813, "body": "We need the code of your entire sub you are running. It doesn&#39;t really help us, if you just show it crashed on an user-defined object."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1528878299, "post_id": 50831902, "comment_id": 88668902, "body": "@Rawrplus all the userforms crash after any one of the userforms give that error. I&#39;ll post the modules here"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1529304094, "post_id": 50831902, "comment_id": 88807445, "body": "Add error handling (<code>on error goto</code> ...) in all your Subs and you will have a clear view on where it crashes. No one can really answer your question in the actual state."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529304672, "post_id": 50831902, "comment_id": 88807714, "body": "Doesn&#39;t the errors returned by the VBE have any meaning at all though? I do not understand the depth of VBA enough to know what is happening inside"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1529310386, "post_id": 50831902, "comment_id": 88810502, "body": "If you add error handling you will know exactly on which line of code (instruction) the error occur. Which is the most important thing to know to solve your issue."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529310668, "post_id": 50831902, "comment_id": 88810638, "body": "Isn&#39;t that the similar to running through the code using F8? Also if it highlighted in yellow when the error occurs, won&#39;t <code>on error goto</code> be the same? Also I do believe this due to an old excel version since i&#39;ve never encountered it while I was using the program on my main computer with an Excel 2016. I&#39;ll test it later."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 2, "creation_date": 1529327774, "post_id": 50831902, "comment_id": 88820701, "body": "You&#39;ve shown us the error is caused by <code>VoucherEntry.Show</code> - perhaps you&#39;re not aware, but there is likely to be an event triggered by <code>.Show</code>ing the userform <code>VoucherEntry</code> - it&#39;s probably called <code>UserForm_Initialize</code> and to access it you&#39;ll need to right click on the Userform and select View Code. You can see this yourself if you F8 through the code. When the error finally occurs the VBEditor will return to the Subroutine that called the <code>.Show</code>. So - to find your error, we&#39;d need to see <i>all of the code</i> called by it."}, {"owner": {"reputation": 542, "user_id": 7099906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JfvZO.png?s=128&g=1", "display_name": "Taylor Scott", "link": "https://stackoverflow.com/users/7099906/taylor-scott"}, "edited": false, "score": 1, "creation_date": 1529344171, "post_id": 50831902, "comment_id": 88829889, "body": "It is considered bad practice to use the default instance of a userform when showing. Instead you should use a discrete instance of the userform, eg. <code>with new VoucherEntry</code> <code>.show</code> <code>End With</code>. You can read more about why <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1529398983, "post_id": 50831902, "comment_id": 88848127, "body": "@CLR All the code shown under the <code>UserForm_Initialize</code> event of my <code>VoucherEntry</code> form?"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 542, "user_id": 7099906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JfvZO.png?s=128&g=1", "display_name": "Taylor Scott", "link": "https://stackoverflow.com/users/7099906/taylor-scott"}, "edited": false, "score": 0, "creation_date": 1529399027, "post_id": 50831902, "comment_id": 88848153, "body": "@TaylorScott Thanks for the reference"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1529399760, "post_id": 50831902, "comment_id": 88848580, "body": "That&#39;s likely to be where the actual error is, @MarcSantos - or, if that calls other subroutines or functions, in one of those."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1529399931, "post_id": 50831902, "comment_id": 88848674, "body": "@CLR okay I will try running my program in a more later version of Excel first instead of the Excel 2007&#39;s. If it resolves by itself I will not step through the code anymore. Because 2007 is already obsolete and no point in trying to work around it, but if it still crashes in 2016 then i&#39;ll update on this"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1529410413, "post_id": 50831902, "comment_id": 88855127, "body": "Try to remove <code>VoucherEntry</code> form from your project (do not forget to export it before you do that) and save your Excel file. Then, change an extension for <code>VoucherEntry</code> file to <code>*.txt</code>, open Excel file again and import that form from text file. If it helps, reply me."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1529455747, "post_id": 50831902, "comment_id": 88875640, "body": "Just curious, are there any ComboBox/Controls with RowSource pointed to a Table (ListObject)? If so, clear it and add the RowSource at UserForm_Initialize."}, {"owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "edited": false, "score": 0, "creation_date": 1529470893, "post_id": 50831902, "comment_id": 88878788, "body": "@MarcSantos when you are working at the office on Excel 2007, is your file working from the PC&#39;s local drive, or from a network drive? At home, I&#39;m assuming you&#39;re only ever working from the PC&#39;s local drive, am I correct?"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "edited": false, "score": 0, "creation_date": 1529471317, "post_id": 50831902, "comment_id": 88878931, "body": "@girlvsdata Yes that is correct"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1529474413, "post_id": 50831902, "comment_id": 88880069, "body": "@PatricK I added my codes. I do not have a <code>RowSource</code> pointed to a table in the properties window of the combo box, however I have this code in the UserForm_Initialize event: <code>ListBox6.RowSource = &quot;Table!A2:D&quot; &amp; Application.WorksheetFunction.Max(Worksheets(&quot;Table&quot;).Range(&zwnj;&#8203;&quot;A&quot; &amp; Rows.Count).End(xlUp).Row, Worksheets(&quot;Table&quot;).Range(&quot;C&quot; &amp; Rows.Count).End(xlUp).Row)</code>"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529474874, "post_id": 50831902, "comment_id": 88880271, "body": "I am really not experiencing this problem when i&#39;m running it at Excel 2016. I don&#39;t know why the mods removed such valuable information from the answers. Despite <code>AutoRecover</code> or anything. It&#39;s probably a older version related error"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1529477715, "post_id": 50831902, "comment_id": 88881534, "body": "A lot of work needed to debug your partial code, and lots doesn&#39;t make sense (e.g. <code>Trim(Len(tbxNewPayee.Text)) = 0</code> should be <code>Len(Trim(tbxNewPayee.Text)) = 0</code>). Since you are using ListObjects on worksheets, you can simplify many steps. Also use <code>Option Explicit</code> for coding. Can you step through your code and note where is crash?"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "edited": false, "score": 0, "creation_date": 1529479527, "post_id": 50831902, "comment_id": 88882491, "body": "Oh you&#39;re right about that no wonder some textboxes such as the date are sometimes working a bit weird, but not much loss in functionality. Right i&#39;ll be using <code>Option Explicit</code> didn&#39;t expect the program to be large. Can you give an example of how I can simplify because i&#39;m using ListObjects? I&#39;m actually thinking if it&#39;s practical to use tables (List Objects) even with mainly VBA or better without tables. Do you suggest I do? Hold on i&#39;ll step through it after the error pops out. I timed it to be 10 minutes when the <code>AutoRecover</code> procs as @girlvsdata mentioned."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1529480137, "post_id": 50831902, "comment_id": 88882856, "body": "@PatricK I cannot run through my code after the error appears. No matter where in the module I try to step through, I get a <code>Run-time error 75 - Could not find specified object</code> all userforms will not work and it will crash when I try to double click the userform."}, {"owner": {"reputation": 1, "user_id": 11250537, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/4ec59ae0e0bd03e40b3fa0942d42bc82?s=128&d=identicon&r=PG", "display_name": "user11250537", "link": "https://stackoverflow.com/users/11250537/user11250537"}, "edited": false, "score": 0, "creation_date": 1553431824, "post_id": 50831902, "comment_id": 97374342, "body": "I have similar issue to import a file from share drive &quot;P&quot; to an application on winSVR 2012, but it only works when I add my self into the server&#39;s admin group"}], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529474063, "post_id": 50941097, "comment_id": 88879925, "body": "Can you only disable <code>AutoRecover</code> in 1 workbook though? It&#39;s impractical to disable for all. Also, the file is located at the desktop isn&#39;t that part of the main local drive?"}, {"owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529474533, "post_id": 50941097, "comment_id": 88880121, "body": "@MarcSantos If you open that option menu I mentioned in my answer, a little further down on the same page there is a checkbox &quot;Disable AutoRecover for this workbook only.&quot; Depending on your workplace, the desktop could also be a network drive (my workplace has done this in the past), but usually it is on the local drive."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529474579, "post_id": 50941097, "comment_id": 88880143, "body": "My desktop is in local disk C for the office computers. Does this invalidate the solution? Perhaps I can try the <code>AutoRecover</code> disabling for the workbook"}, {"owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529475358, "post_id": 50941097, "comment_id": 88880449, "body": "@MarcSantos it does not invalidate the solution, it just means that something else is interrupting the AutoRecover. It may be a regular system backup that occurs in your office, or a corrupt update file. I&#39;d still recommend trying the file with AutoRecover disabled, and seeing if that helps."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529475562, "post_id": 50941097, "comment_id": 88880538, "body": "Will do. Thanks going to the office to try it out now before I update our excel versions to more recent ones if all else fails"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529479968, "post_id": 50941097, "comment_id": 88882771, "body": "the error did appear on around the 11 minute mark rather than the 10 minute mark. I guess it has something to do with the <code>AutoRecover</code> as you mentioned."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529480507, "post_id": 50941097, "comment_id": 88883073, "body": "I&#39;ll try to wait another 10 minutes after restarting my file. If it crashes again very close to that time i&#39;ll disable the <code>AutoRecover</code> then if it works. Then i&#39;ll mark this as the answer."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529481273, "post_id": 50941097, "comment_id": 88883532, "body": "2nd time around took 15 minutes after restarting my file. Well i&#39;ll just try disabling it and see"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 1, "creation_date": 1529483174, "post_id": 50941097, "comment_id": 88884672, "body": "Yep disabling the <code>AutoRecover</code> did the job. It also makes sense because the error would only appear after a time delay, but I do not have any time activated codes. I&#39;ll test a bit more before awarding the bounty to make sure it really did fix it. But 30 minutes in, still haven&#39;t crashed. It&#39;s a bug of Excel 2007 and earlier, the mods removed it from the answers."}, {"owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1529483252, "post_id": 50941097, "comment_id": 88884711, "body": "@MarcSantos great news, happy to help!"}], "tags": [], "owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "is_accepted": true, "score": 7, "last_activity_date": 1529484184, "last_edit_date": 1529484184, "creation_date": 1529473772, "answer_id": 50941097, "question_id": 50831902, "link": "https://stackoverflow.com/questions/50831902/what-is-the-cause-of-the-path-file-access-error-error/50941097#50941097", "title": "What is the cause of the &quot;path/file access error&quot; error", "body": "<p>Both errors you are having, \"Path/File access error\" and \"Run Time Error 75\" are errors accessing the filepath, and they are likely being caused by the AutoRecover feature of Excel.</p>\n\n<p>When you are leaving your Excel file for 20 minutes or so, the time limit for AutoRecover is reached. AutoRecover will then attempt to save AutoRecover information, in the case of your home computer it will be saving that to the Local drive, and at the office it will be saving to the network. </p>\n\n<blockquote>\n  <p>When an Excel file is open and AutoRecover is turned on, AutoRecover does not save the file until the first change is made to the file, the AutoRecover save time interval passes, and Excel has been idle for some time (the default is 30 seconds). (<a href=\"https://support.microsoft.com/en-us/help/289273/description-of-the-autorecover-functions-in-excel\" rel=\"noreferrer\">https://support.microsoft.com/en-us/help/289273/description-of-the-autorecover-functions-in-excel</a>)</p>\n</blockquote>\n\n<p>What is likely happening is a connection with your network is being interrupted, causing the AutoRecover to fail, which you won't see until the 'ActivateWorkbook' event is triggered (which will show your userform, then crash).</p>\n\n<p>(You can check your time limit for AutoRecover in Options>Save>Save Workbooks)\n<a href=\"https://i.stack.imgur.com/OhGg5.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/OhGg5.png\" alt=\"Save Options Image\"></a></p>\n\n<p>You might be able to work around the error by: </p>\n\n<ul>\n<li>saving the file to your local drive while you are at the office, or</li>\n<li>disabling AutoRecover for the workbook</li>\n<li>increasing the amount of time before the AutoRecover is triggered.</li>\n</ul>\n\n<p>This user also found their errors were resolved by removing and repairing corrupt updates: <a href=\"https://www.mrexcel.com/forum/excel-questions/438888-intermittent-run-time-error-75-loading-form.html\" rel=\"noreferrer\">https://www.mrexcel.com/forum/excel-questions/438888-intermittent-run-time-error-75-loading-form.html</a></p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9912950, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mbuSeCTyvqA/AAAAAAAAAAI/AAAAAAAAAAA/xeubVpDKQDk/photo.jpg?sz=128", "display_name": "Rozety", "link": "https://stackoverflow.com/users/9912950/rozety"}, "is_accepted": false, "score": 1, "last_activity_date": 1577564568, "creation_date": 1577564568, "answer_id": 59514570, "question_id": 50831902, "link": "https://stackoverflow.com/questions/50831902/what-is-the-cause-of-the-path-file-access-error-error/59514570#59514570", "title": "What is the cause of the &quot;path/file access error&quot; error", "body": "<p><strong>you can just save the current workbook with this:</strong></p>\n\n<pre><code>ActiveWorkbook.Save\n</code></pre>\n\n<p><strong>or disabling auto recover with code</strong></p>\n\n<pre><code>Application.Autorecover.Enable = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 14133404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GiWNinwNU7kJVpPIVOfzalWglpQ7TA8o21vA71hhQ=k-s128", "display_name": "Patrick Mirek", "link": "https://stackoverflow.com/users/14133404/patrick-mirek"}, "is_accepted": false, "score": 0, "last_activity_date": 1599833540, "creation_date": 1599833540, "answer_id": 63848779, "question_id": 50831902, "link": "https://stackoverflow.com/questions/50831902/what-is-the-cause-of-the-path-file-access-error-error/63848779#63848779", "title": "What is the cause of the &quot;path/file access error&quot; error", "body": "<p>I had this error when using the FileCopy(Source, Destination) function. I resolved it by saving a copy of the source file under a different name</p>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8464, "favorite_count": 3, "accepted_answer_id": 50941097, "answer_count": 3, "score": 4, "last_activity_date": 1599833540, "creation_date": 1528876535, "last_edit_date": 1594003678, "question_id": 50831902, "link": "https://stackoverflow.com/questions/50831902/what-is-the-cause-of-the-path-file-access-error-error", "title": "What is the cause of the &quot;path/file access error&quot; error", "body": "<p>The hard part of this error is that it does not occur all the time, but I think it is due to the userforms. The program works as it should most of the time, but eventually <code>Error 1</code> pops out. After <code>Error 1</code> pops out, when I attempt to double click any other userform module in the VBE, <code>Error 2</code> would pop out. I believe <code>Error 1</code> occurs because the program is unable to access the user forms as shown by <code>Error 2.</code> When we attempt to save the Excel file after the error occurs, the excel file would crash. I also noticed that the errors start after a certain amount of time (even when idling and alt+tabbed) after not doing anything for example, 20 minutes, then try to select a userform, it will error (note: I do not have any time activated code for sure). Similar problems were noted in these URLs but no solutions: <a href=\"http://www.vbforums.com/showthread.php?500971-RESOLVED-Path-File-Access-Error\" rel=\"nofollow noreferrer\">Similar problem</a> and <a href=\"http://www.vbaexpress.com/forum/archive/index.php/t-34443.html\" rel=\"nofollow noreferrer\">Similar problem 2</a>. After checking google, this problem have been plaguing people for more than 10 years already. Has no one ever figured out the cause for theirs? Any help would really be much appreciated for other people as well. Update: Errors occur in Excel 2007 (both computers at the office). I've never seen the error occur to my yet at home with my Excel 2016.</p>\n\n<p>The images of the errors and debugging are shown below:</p>\n\n<p>Error 1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Fx1FF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Fx1FF.png\" alt=\"Error 1\"></a></p>\n\n<p>Error 2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/l3j71.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l3j71.png\" alt=\"Error 2\"></a></p>\n\n<p>After Error 1 occurs and try to save the file crash:\n<a href=\"https://i.stack.imgur.com/bPV46.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bPV46.png\" alt=\"Crash\"></a></p>\n\n<p>Debug (all userforms will stop working):</p>\n\n<p><a href=\"https://i.stack.imgur.com/JDIN1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JDIN1.png\" alt=\"Debug in VBE 2\"></a></p>\n"}, {"tags": ["html", "vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528880042, "post_id": 50831713, "comment_id": 88669892, "body": "The above should not be a function. It is a sub."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1528888052, "last_edit_date": 1528888052, "creation_date": 1528885676, "answer_id": 50834903, "question_id": 50831713, "link": "https://stackoverflow.com/questions/50831713/modifying-the-program-for-parsing/50834903#50834903", "title": "Modifying the program for parsing", "body": "<p>This is not particularly robust but does grab the values from the table. <code>iLoop</code> is not used.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()    \n    extractTable \"http://allscores.ru/soccer/fstats.php?champ=2604&amp;team=439&amp;team2=420&amp;tour=110\", ThisWorkbook, 1    \nEnd Sub\n\nPublic Sub extractTable(Ssilka As String, book1 As Workbook)\n    Dim oDom As Object, oTable As Object\n    Dim oHttp As Object\n    Dim oRegEx As Object\n    Dim sResponse As String\n    Set oHttp = CreateObject(\"MSXML2.XMLHTTP\")\n    oHttp.Open \"GET\", Ssilka, False\n    oHttp.send\n    sResponse = StrConv(oHttp.responseBody, vbUnicode)\n    Set oHttp = Nothing\n\n    sResponse = Mid$(sResponse, InStr(1, sResponse, \"&lt;!DOCTYPE \"))\n\n    Set oRegEx = CreateObject(\"vbscript.regexp\")\n    With oRegEx\n        .MultiLine = True\n        .Global = True\n        .IgnoreCase = False\n        .Pattern = \"&lt;(script|SCRIPT)[\\w\\W]+?&lt;/\\1&gt;\"\n        sResponse = .Replace(sResponse, \"\")\n    End With\n    Set oRegEx = Nothing\n    Set oDom = CreateObject(\"htmlFile\")\n    oDom.Write sResponse\n\n    Set oTable = oDom.getElementsByTagName(\"table\")(3)\n\n    Dim b As Object, a As Object\n    Set b = oTable.getElementsByTagName(\"TR\")    'DispHTMLElementCollection\n\n    Dim i As Long, y As Long\n    With ActiveSheet\n        For i = 3 To 17 '17-3 gives the 15 rows of interest. Start at 3 to avoid header and empty row.\n            Set a = b(i).ChildNodes\n            For y = 1 To a.Length - 1\n                .Cells(i - 2, y) = a(y).innerText\n            Next y\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 50834903, "answer_count": 1, "score": 0, "last_activity_date": 1557473249, "creation_date": 1528875944, "last_edit_date": 1557473249, "question_id": 50831713, "link": "https://stackoverflow.com/questions/50831713/modifying-the-program-for-parsing", "title": "Modifying the program for parsing", "body": "<p>There is a program that parse a certain table from the site . Works great . I want to parse another table from the site  . By the tag number \u201ctable\u201d they are the same . I am trying to use the same program , but it gives an error : Run-time error 91 in the line :</p>\n\n<pre><code>     If oRow.Cells(y).Children.Length &gt; 0 Then\n</code></pre>\n\n<p>New table : <a href=\"http://allscores.ru/soccer/fstats.php?champ=2604&amp;team=439&amp;team2=420&amp;tour=110\" rel=\"nofollow noreferrer\">http://allscores.ru/soccer/fstats.php?champ=2604&amp;team=439&amp;team2=420&amp;tour=110</a></p>\n\n<p>Old table : <a href=\"http://allscores.ru/soccer/new_ftour.php?champ=2604&amp;f_team=439\" rel=\"nofollow noreferrer\">http://allscores.ru/soccer/new_ftour.php?champ=2604&amp;f_team=439</a></p>\n\n<p>New table : in the attached picture</p>\n\n<pre><code>Function extractTable(Ssilka As String, book1 As Workbook, iLoop As Long)\n    Dim oDom As Object, oTable As Object, oRow As Object\n    Dim iRows As Integer, iCols As Integer\n    Dim x As Integer, y As Integer\n    Dim data()\n    Dim vata()\n    Dim tata()\n    Dim oHttp As Object\n    Dim oRegEx As Object\n    Dim sResponse As String\n    Dim oRange As Range\n    Dim odRange As Range\n\n   ' get page\n    Set oHttp = CreateObject(\"MSXML2.XMLHTTP\")\n    oHttp.Open \"GET\", Ssilka, False\n    oHttp.Send\n\n    ' cleanup response\n    sResponse = StrConv(oHttp.responseBody, vbUnicode)\n    Set oHttp = Nothing\n\n    sResponse = Mid$(sResponse, InStr(1, sResponse, \"&lt;!DOCTYPE \"))\n\n    Set oRegEx = CreateObject(\"vbscript.regexp\")\n    With oRegEx\n        .MultiLine = True\n        .Global = True\n        .IgnoreCase = False\n        .Pattern = \"&lt;(script|SCRIPT)[\\w\\W]+?&lt;/\\1&gt;\"\n        sResponse = .Replace(sResponse, \"\")\n    End With\n    Set oRegEx = Nothing\n\n    ' create Document from response\n    Set oDom = CreateObject(\"htmlFile\")\n    oDom.Write sResponse\n    DoEvents\n\n    ' table with results, indexes starts with zero\n    Set oTable = oDom.getelementsbytagname(\"table\")(3)\n\n    DoEvents\n\n    iRows = oTable.Rows.Length\n    iCols = oTable.Rows(1).Cells.Length\n\n    ' first row and first column contain no intresting data\n    ReDim data(1 To iRows - 1, 1 To iCols - 1)\n    ReDim vata(1 To iRows - 1, 1 To iCols - 1)\n    ReDim tata(1 To iRows - 1, 1 To iCols - 1)\n    ' fill in data array\n    For x = 1 To iRows - 1\n        Set oRow = oTable.Rows(x)\n        For y = 1 To iCols - 1\n            If oRow.Cells(y).Children.Length &gt; 0 Then\n                data(x, y) = oRow.Cells(y).getelementsbytagname(\"a\")(0).getattribute(\"href\")\n                data(x, y) = Replace(data(x, y), \"about:\", \"http://allscores.ru/soccer/\")\n                vata(x, y) = oRow.Cells(y).innerText\n            End If\n        Next y\n    Next x\n\n    Set oRow = Nothing\n    Set oTable = Nothing\n    Set oDom = Nothing\n\n    Set oRange = book1.ActiveSheet.Cells(110, 26 + (iLoop * 21)).Resize(iRows - 1, iCols - 1)\n    oRange.NumberFormat = \"@\"\n    oRange.Value = data\n\n    Set odRange = book1.ActiveSheet.Cells(34, 26 + (iLoop * 21)).Resize(iRows - 1, iCols - 1)\n    odRange.NumberFormat = \"@\"\n    odRange.Value = vata\n\n    Set oRange = Nothing\n    Set odRange = Nothing\n\nEnd Function\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/PgC2M.png\" alt=\"New Table\"></p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1528874801, "post_id": 50831129, "comment_id": 88666904, "body": "You&#39;re dealing with a situation where Target is more than a single cell.  Maybe bandaid it with <code>if target.cont &gt; 1 then exit sub</code> in the beginning of the sub or disclose what you want to happen when target is more than a single cell.&#39;"}, {"owner": {"reputation": 23, "user_id": 7107045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ce498aa605f47478823820221602e1?s=128&d=identicon&r=PG&f=1", "display_name": "PMHD", "link": "https://stackoverflow.com/users/7107045/pmhd"}, "edited": false, "score": 0, "creation_date": 1528876573, "post_id": 50831129, "comment_id": 88667917, "body": "Great call, @Jeeped! This led me to the solution. I ended up skipping the &quot;Exit Sub&quot; part so I could still activate the sub with the &quot;x&quot; in column 16. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 7107045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ce498aa605f47478823820221602e1?s=128&d=identicon&r=PG&f=1", "display_name": "PMHD", "link": "https://stackoverflow.com/users/7107045/pmhd"}, "is_accepted": false, "score": 1, "last_activity_date": 1528877324, "creation_date": 1528877324, "answer_id": 50832151, "question_id": 50831129, "link": "https://stackoverflow.com/questions/50831129/copy-paste-inadvertently-triggers-worksheet-change-sub/50832151#50832151", "title": "Copy &amp; paste inadvertently triggers Worksheet_Change sub", "body": "<p>Thanks, Jeeped. </p>\n\n<p>The problem arose due to Target referring to multiple cells. It was fixed by excluding cases where Target.Count > 1. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error Resume Next\nApplication.EnableEvents = False\n'Exclude all cases where more than one cell is Target\nIf Target.Count &gt; 1 Then\n\n'If Cell that is edited is in column P and the value is x then\nElseIf Target.Column = 16 And Target.Value = \"x\" Then\n    'Define last row on completed worksheet to know where to place the row of data\n    LrowCompleted = Sheets(\"Completed\").Cells(Rows.Count, \"A\").End(xlUp).Row\n    'Copy and paste data\n    Range(\"A\" &amp; Target.Row &amp; \":P\" &amp; Target.Row).Copy Sheets(\"Completed\").Range(\"A\" &amp; LrowCompleted + 1)\n    'Delete Row from Project List\n    Range(\"A\" &amp; Target.Row &amp; \":P\" &amp; Target.Row).Delete xlShiftUp\nEnd If\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1528897714, "creation_date": 1528897714, "answer_id": 50838912, "question_id": 50831129, "link": "https://stackoverflow.com/questions/50831129/copy-paste-inadvertently-triggers-worksheet-change-sub/50838912#50838912", "title": "Copy &amp; paste inadvertently triggers Worksheet_Change sub", "body": "<p>If you are concerned with muliple targets, deal with them; don't discard them.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n  If not intersect(target, range(\"p:p\")) is nothing then\n        on error goto meh\n        Application.EnableEvents = False\n        dim t as range, lrc as long\n        lrc = workSheets(\"Completed\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n        for each t in intersect(target, range(\"p:p\"))\n            if lcase(t.Value2) = \"x\" Then\n                intersect(columns(\"A:P\"), t.rows(t.row)).Copy _\n                    destination:=workSheets(\"Completed\").cells(lrc , \"A\")\n                lrc = lrc+1\n                'Delete Row from Project List\n                intersect(columns(\"A:P\"), t.rows(t.row)).Delete xlShiftUp\n             end if\n        next t\n    End if\n\nmeh:\n    Application.EnableEvents = true\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7107045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ce498aa605f47478823820221602e1?s=128&d=identicon&r=PG&f=1", "display_name": "PMHD", "link": "https://stackoverflow.com/users/7107045/pmhd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 50838912, "answer_count": 2, "score": 1, "last_activity_date": 1528897714, "creation_date": 1528874007, "question_id": 50831129, "link": "https://stackoverflow.com/questions/50831129/copy-paste-inadvertently-triggers-worksheet-change-sub", "title": "Copy &amp; paste inadvertently triggers Worksheet_Change sub", "body": "<p>I am having problems with a \"Worksheet_Change\" sub that copies and pastes the whole row into a second worksheet (\"Completed\") when the column \"P\" takes on the value \"x\". It reads like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error Resume Next\n    Application.EnableEvents = False\n    'If Cell that is edited is in column P and the value is x then\n    If Target.Column = 16 And Target.Value = \"x\" Then\n        'Define last row on completed worksheet to know where to place the row of data\n        LrowCompleted = Sheets(\"Completed\").Cells(Rows.Count, \"A\").End(xlUp).Row\n        'Copy and paste data\n        Range(\"A\" &amp; Target.Row &amp; \":P\" &amp; Target.Row).Copy Sheets(\"Completed\").Range(\"A\" &amp; LrowCompleted + 1)\n        'Delete Row from Project List\n        Range(\"A\" &amp; Target.Row &amp; \":P\" &amp; Target.Row).Delete xlShiftUp\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>The sub itself works fine but if I copy and paste anywhere in the worksheet, the sub is activated and the row into which I paste is send to my \"Completed\" sheet. </p>\n\n<p>I have played around with the \"if-clause\" without any luck so far. E.g.:</p>\n\n<pre><code>    If Not Target.Column = 16 And Target.Value = \"x\" Is Nothing Then\n</code></pre>\n\n<p>I fear I am missing the obvious and I am grateful for any help. </p>\n\n<p>Thanks and regards</p>\n\n<p>PMHD</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 211, "user_id": 6324295, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/cfd195de5b6bc9a189a53fb59a098a35?s=128&d=identicon&r=PG&f=1", "display_name": "HerrErik", "link": "https://stackoverflow.com/users/6324295/herrerik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1528873455, "creation_date": 1528873455, "last_edit_date": 1531164843, "question_id": 50830969, "link": "https://stackoverflow.com/questions/50830969/run-command-prompt-as-admin", "title": "Run command prompt as admin?", "body": "<p>I need the command prompt to run as admin (it doesnt right now). I've seen solutions online but they all use slightly different setups and I dare not change more than necessary as this code is used in other parts as well that i dont have access to. I also cannot wait for user input as this is part of scripts that are batched together with other script.</p>\n\n<p>Thank you for any help!</p>\n\n<p>The relevant part of my code:</p>\n\n<pre><code>    'setting up cmd as a string above this code\n\n    'Create the shell and send the python command\n    Dim wsh As Object\n    Set wsh = VBA.CreateObject(\"WScript.Shell\")\n    Dim waitOnReturn As Boolean: waitOnReturn = True\n    Dim windowStyle As Integer: windowStyle = 1\n\n    wsh.run cmd, windowStyle, waitOnReturn\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1528874736, "post_id": 50830898, "comment_id": 88666862, "body": "Can&#39;t you use pivot-tables for that?"}, {"owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "reply_to_user": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1528874842, "post_id": 50830898, "comment_id": 88666930, "body": "Pivot table wont refresh itself. And Im not sure I can calculate trim mean from Pivot table"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "edited": false, "score": 0, "creation_date": 1528879979, "post_id": 50832178, "comment_id": 88669846, "body": "I got the mean as result, not Trimmean"}, {"owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "reply_to_user": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "edited": false, "score": 0, "creation_date": 1528880275, "post_id": 50832178, "comment_id": 88670021, "body": "That&#39;s because I have used <b>0</b> as <code>TRIMMEAN</code> &#39;s parameter. You should change that part to the desired percentage such as 0.10, 0.20 etc."}, {"owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "edited": false, "score": 0, "creation_date": 1528880694, "post_id": 50832178, "comment_id": 88670297, "body": "I used like &#39;=TRIMMEAN(IF(Daily_Count!B:B=B4,Daily_Count!D:D,&quot;&quot;),0.8)&#39; still I got mean only"}, {"owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "edited": false, "score": 0, "creation_date": 1528881795, "post_id": 50832178, "comment_id": 88670979, "body": "OOPS, My bad, Took wrong column... It worked perfectly... Thanks Hakan"}], "tags": [], "owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "is_accepted": true, "score": 1, "last_activity_date": 1528880398, "last_edit_date": 1528880398, "creation_date": 1528877409, "answer_id": 50832178, "question_id": 50830898, "link": "https://stackoverflow.com/questions/50830898/calculate-trim-mean-for-different-tasks/50832178#50832178", "title": "Calculate Trim Mean for different Tasks", "body": "<p>Can you try below array formula (You should press <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd> instead of just an <kbd>Enter</kbd>):</p>\n\n<pre><code>=TRIMMEAN(IF(B2:B8=\"TK1\",C2:C8,\"\"),0)\n</code></pre>\n\n<p>Since I do not know your requirement of percentage for <code>TRIMMEAN</code> I have used 0. You may change that second parameter according to your need. You should use 0.10 for %10 trim.</p>\n"}], "owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 50832178, "answer_count": 1, "score": 0, "last_activity_date": 1528880398, "creation_date": 1528873240, "last_edit_date": 1531161705, "question_id": 50830898, "link": "https://stackoverflow.com/questions/50830898/calculate-trim-mean-for-different-tasks", "title": "Calculate Trim Mean for different Tasks", "body": "<p>I have an excel sheet with different tasks done by different people and their daily counts also. I want to calculate <strong>trim mean</strong> for each of the task. The sheet is daily updated. So the numbers are getting changed daily.</p>\n\n<pre><code>Person   Task   Count  Date\n\nP1       TK1    100    1/1/18\nP2       TK1    500    1/1/18\nP3       TK2    200    1/1/18\nP1       TK3    500    1/2/18\nP3       TK1    200    1/2/18\nP4       TK2    500    1/2/18\nP1       TK1    750    1/3/18\n</code></pre>\n\n<p>The sheet looks like above. Now I want to get trim Mean of task <strong>TK1</strong>. The trimmean() function only takes array as input. So is there any way I can the data in the following format</p>\n\n<pre><code>TK1   100   500   200  750\nTK2   200   500\nTK3   500\n</code></pre>\n\n<p>or the trim mean get calculated for each of the tasks?</p>\n\n<p>I guess the only way is VBA, but I have no clue, how to get different task data in to an array to process.</p>\n"}, {"tags": ["vba", "excel", "performance"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1528871931, "post_id": 50830464, "comment_id": 88665244, "body": "If your code already works this might be better a question for <a href=\"https://codereview.stackexchange.com/\">Stack Exchange: Code Review</a>."}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1528872358, "post_id": 50830464, "comment_id": 88665491, "body": "Note that when you Dim&#39;med your variables, only h was a Range. All the others (e,f,a,j) were variants. You need to write &quot;As Range&quot; after every one of them. Regarding the speed - have you tried copying all the cells into a 2D array before looping through the array? Working with arrays is faster than continually interacting with worksheets."}, {"owner": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "edited": false, "score": 0, "creation_date": 1528872433, "post_id": 50830464, "comment_id": 88665532, "body": "No, I have not. This is exactly the kind of input I am looking for : &quot;what have I not thought of ?&quot; Thanks!"}, {"owner": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528872825, "post_id": 50830464, "comment_id": 88665755, "body": "Thanks @P\u1d07\u029c I wouldn&#39;t say the code is working per se as it is unusuable because too slow. it only meets the conditions stated. If you think it&#39;s still considered as working and should go to Stack Exchange, I will happily transfer the post over there!"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528872908, "post_id": 50830464, "comment_id": 88665791, "body": "You have a number of undeclared variables. Also, you refer to <code>p</code> and it doesn&#39;t appear to be setup anywhere.  Add &#39;Option Explicit` to the top of [avery] module [always] to help you locate issues. There may be other issues, I&#39;m not sure"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1528873023, "post_id": 50830464, "comment_id": 88665847, "body": "&quot;fasten&quot; means &quot;close or do up securely.&quot; It doesn&#39;t mean speed up."}, {"owner": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528873073, "post_id": 50830464, "comment_id": 88665867, "body": "Yes @ashleedawg, sorry, it&#39;s because I edited the original table and code before posting. Those p were leftovers. Edited in the post !"}, {"owner": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1528873132, "post_id": 50830464, "comment_id": 88665912, "body": "Your right @Enigmativity: editing the title."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1528874284, "post_id": 50830464, "comment_id": 88666581, "body": "@AlexBrollo - LOL &quot;your&quot; should be &quot;you&#39;re&quot;. ;-)"}, {"owner": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "edited": false, "score": 1, "creation_date": 1528874468, "post_id": 50830464, "comment_id": 88666699, "body": "Wow. Damned, this one is a big one SORRY! You ARE right.=)"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "edited": false, "score": 0, "creation_date": 1528882721, "post_id": 50830963, "comment_id": 88671615, "body": "Mmh... I see what you did here, and it&#39;s a really good idea. However, in my original file, there is no single item that doesn&#39;t have a match with the first criterias (bullet point list in the post). So everything will probably have a duplicate. What I need to highlight are the lines that cancel each other (line1+line2=0). Or maybe I misunderstood :)"}, {"owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "reply_to_user": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "edited": false, "score": 0, "creation_date": 1528888064, "post_id": 50830963, "comment_id": 88675028, "body": "I don&#39;t really understand which criteria you mean. If all rows match on one of the criteria, why not drop it?"}], "tags": [], "owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "is_accepted": false, "score": 2, "last_activity_date": 1528873442, "creation_date": 1528873442, "answer_id": 50830963, "question_id": 50830464, "link": "https://stackoverflow.com/questions/50830464/speed-up-matching-program-in-excel-vba/50830963#50830963", "title": "Speed Up Matching program in Excel VBA", "body": "<p>I suggest a different approach altogether: add a temporary column to your data that contains a concatenation of each cell in the row. This way, you have:</p>\n\n<pre><code>A|B|C|D|E\n1|Mr. Smith|500|A|1Mr. Smith500A\n</code></pre>\n\n<p>Then use Excel's conditional formatting on the temporary column, highlighting duplicate values. There you have your duplicated rows. Now it's only a matter of using a filter to check which ones have amounts equal to zero.</p>\n\n<p>You can use the <a href=\"https://support.office.com/en-us/article/concatenate-function-8f8ae884-2ca8-4f7a-b093-75d702bea31d\" rel=\"nofollow noreferrer\">CONCATENATE</a> function; it requires you to specify each cell separately and you can't use a range, but in your case (comparing only some of the columns) it seems like a good fit.</p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1528883637, "post_id": 50834234, "comment_id": 88672271, "body": "You should format your code nicely, this is a mess. Have a look into the <a href=\"https://stackoverflow.com/help\">help center</a> for a how to."}, {"owner": {"reputation": 542, "user_id": 7099906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JfvZO.png?s=128&g=1", "display_name": "Taylor Scott", "link": "https://stackoverflow.com/users/7099906/taylor-scott"}, "edited": false, "score": 0, "creation_date": 1528888118, "post_id": 50834234, "comment_id": 88675063, "body": "You should also avoid copy and paste operations, as they are prone to producing errors in VBA"}], "tags": [], "owner": {"reputation": 41, "user_id": 9923807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002042275f6d9380a2bea7cb4bdcfc19?s=128&d=identicon&r=PG&f=1", "display_name": "Krishna", "link": "https://stackoverflow.com/users/9923807/krishna"}, "is_accepted": false, "score": -2, "last_activity_date": 1528890411, "last_edit_date": 1528890411, "creation_date": 1528883513, "answer_id": 50834234, "question_id": 50830464, "link": "https://stackoverflow.com/questions/50830464/speed-up-matching-program-in-excel-vba/50834234#50834234", "title": "Speed Up Matching program in Excel VBA", "body": "<p>If your data is only till column L, then use below code, I found it is taking less time to run....</p>\n\n<pre><code>Sub Duplicates()\n    Application.ScreenUpdating = False\n    Dim i As Long, lrow As Long\n    lrow = Cells(Rows.Count, 1).End(xlUp).Row\n    Range(\"O2\") = \"=A2&amp;E2&amp;F2&amp;J2&amp;L2\"\n    Range(\"P2\") = \"=COUNTIF(O:O,O2)\"\n    Range(\"O2:P\" &amp; lrow).FillDown\n    Range(\"O2:O\" &amp; lrow).Copy\n    Range(\"O2:O\" &amp; lrow).PasteSpecial xlPasteValues\n    Application.CutCopyMode = False\n    For i = 1 To lrow\n        If Cells(i, 16) = 2 Then\n            Cells(i, 16).EntireRow.Interior.Color = vbYellow\n        End If\n    Next\n    Application.ScreenUpdating = True\n    Range(\"O:P\").Delete\n    Range(\"A1\").Select\n    MsgBox \"Done\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "edited": false, "score": 0, "creation_date": 1528895240, "post_id": 50835074, "comment_id": 88679830, "body": "Thanks! I see what you did there and it should owrk, but I could get the macro to run for some reason."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "edited": false, "score": 0, "creation_date": 1528895492, "post_id": 50835074, "comment_id": 88679985, "body": "Like I mentioned in the answer, you will most likely have to adapt it a little. What part needs adapting depends what error you got (or what happened that wasn&#39;t supposed to happen)."}, {"owner": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "edited": false, "score": 0, "creation_date": 1528896657, "post_id": 50835074, "comment_id": 88680819, "body": "Yes, you&#39;re right. And I think I found the line I forgot to edit before, thanks again I managed to make it work with this solution too !"}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 1, "last_activity_date": 1528887092, "last_edit_date": 1528887092, "creation_date": 1528886232, "answer_id": 50835074, "question_id": 50830464, "link": "https://stackoverflow.com/questions/50830464/speed-up-matching-program-in-excel-vba/50835074#50835074", "title": "Speed Up Matching program in Excel VBA", "body": "<p>Maciej's answer is easy to implement (if you can add columns to your data without interrupting anything), and I would recommend it if possible.</p>\n\n<p>However, for the sake of answering your question, I will contribute a VBA solution as well. I tested it on dataset that is a bit smaller than yours, but I think it will work for you. Note that you might have to tweak it a little (which row you start on, table name, etc) to fit your workbook.   </p>\n\n<p>Most notably, the segment commented with \"Helper column\" is something you most likely will have to adjust - currently, it compares every cell between A and H for the current row, which is something you may or may not want.</p>\n\n<p>I've tried to include a little commentary in the code, but it's not much. The primary change is that I'm using in-memory processing of an array rather than iterating over a worksheet range (which for larger datasets should be exponentially faster).</p>\n\n<pre><code>Option Base 1\nOption Explicit\n' Uses ref Microsoft Scripting Runtime\n\nSub Find_Matches()\n    Dim wb As Workbook, ws As Worksheet\n    Dim xrow As Long, tCnt As Long\n    Dim e As Range, f As Range, a As Range, j As Range, h As Range\n    Dim sheetArr() As Variant, arr() As Variant\n    Dim colorTheseYellow As New Dictionary, colorResults() As String, dictItem As Variant\n    Dim arrSize As Long, i As Long, k As Long\n    Dim c As Variant\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Data\")\n    ws.Activate\n\n    tCnt = ws.UsedRange.Rows.Count\n    xrow = 2\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlManual\n\n    ' Read range into an array so we process in-memory\n    sheetArr = ws.Range(\"A2:H\" &amp; tCnt)\n    arrSize = UBound(sheetArr, 1)\n\n    ' Build new arr with \"helper column\"\n    ReDim arr(1 To arrSize, 1 To 9)\n    For i = 1 To arrSize\n        For k = 1 To 8\n            arr(i, k) = sheetArr(i, k)\n            arr(i, 9) = CStr(arr(i, 9)) &amp; CStr(arr(i, k)) ' \"Helper column\"\n        Next k\n    Next i\n\n    ' Iterate over array &amp; build collection to indicate yellow lines\n    For i = LBound(arr, 1) To UBound(arr, 1)\n        If Not colorTheseYellow.Exists(i) Then colorResults = Split(ReturnLines(arr(i, 9), arr), \";\")\n        For Each c In colorResults\n            If Not colorTheseYellow.Exists(CLng(c)) Then colorTheseYellow.Add CLng(c), CLng(c)\n        Next c\n    Next i\n\n    ' Enact row colors\n    For Each dictItem In colorTheseYellow\n        'Debug.Print \"dict: \"; dictItem\n        If dictItem &lt;&gt; 0 Then ws.ListObjects(1).ListRows(CLng(dictItem)).Range.Interior.Color = vbYellow\n    Next dictItem\nEnd Sub\n\n\nFunction ReturnLines(ByVal s As String, ByRef arr() As Variant) As String\n    ' Returns a \"Index;Index\" string indicating the index/indices where the second, third, etc. instance(s) of s was found\n    ' Returns \"0;0\" if 1 or fewer matches\n\n    Dim i As Long\n    Dim j As Long\n    Dim tmp As String\n    ReturnLines = 0\n    j = 0\n    tmp = \"0\"\n\n    'Debug.Print \"arg: \" &amp; s\n\n    For i = LBound(arr, 1) To UBound(arr, 1)\n        If arr(i, 9) = s Then\n            j = j + 1\n            'Debug.Print \"arr: \" &amp; arr(i, 9)\n            'Debug.Print \"ReturnLine: \" &amp; i\n            tmp = tmp &amp; \";\" &amp; CStr(i)\n        End If\n    Next i\n\n    'If Left(tmp, 1) = \";\" Then tmp = Mid(tmp, 2, Len(tmp) - 1)\n\n    'Debug.Print \"tmp: \" &amp; tmp\n    If j &gt;= 2 Then\n        ReturnLines = tmp\n    Else\n        ReturnLines = \"0;0\"\n    End If\nEnd Function\n</code></pre>\n\n<p>On my simple dataset, it yields this result (marked excellently with freehand-drawn color indicators):</p>\n\n<p><a href=\"https://i.stack.imgur.com/jWiL4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jWiL4.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "edited": false, "score": 1, "creation_date": 1528895385, "post_id": 50836065, "comment_id": 88679914, "body": "Yes, Thank you! That&#39;s a really cool solution and way around. My method was too straight forward (if then if then if then...) and this one is just great. It works perfectly!"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 1, "creation_date": 1528963298, "post_id": 50836065, "comment_id": 88707616, "body": "Elegant solution!"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 2, "last_activity_date": 1528889208, "creation_date": 1528889208, "answer_id": 50836065, "question_id": 50830464, "link": "https://stackoverflow.com/questions/50830464/speed-up-matching-program-in-excel-vba/50836065#50836065", "title": "Speed Up Matching program in Excel VBA", "body": "<p>This is using nested dictionaries and arrays to check all conditions</p>\n\n<p>Timer with my test data: <strong><code>Rows: 100,001; Dupes: 70,000 - Time: 14.217 sec</code></strong></p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub FindMatches()\n    Const E = 5, F = 6, A = 1, J = 10, H = 8, L = 12\n\n    Dim ur As Range, x As Variant, ub As Long, d As Object, found As Object\n\n    Set ur = ThisWorkbook.Worksheets(\"Data\").UsedRange\n    x = ur\n    Set d = CreateObject(\"Scripting.Dictionary\")\n    Set found = CreateObject(\"Scripting.Dictionary\")\n\n    Dim r As Long, rId As String, itm As Variant, dupeRows As Object\n\n    For r = ur.Row To ur.Rows.Count\n        rId = x(r, E) &amp; x(r, F) &amp; x(r, A) &amp; x(r, J) &amp; x(r, H)\n        If Not d.Exists(rId) Then\n            Set dupeRows = CreateObject(\"Scripting.Dictionary\")\n            dupeRows(r) = 0\n            Set d(rId) = dupeRows\n        Else\n            For Each itm In d(rId)\n                If x(r, L) + x(itm, L) = 0 Then\n                    found(r) = 0\n                    found(itm) = 0\n                End If\n            Next\n        End If\n    Next\n    Application.ScreenUpdating = False\n    For Each itm In found\n        ur.Range(\"A\" &amp; itm).EntireRow.Interior.Color = vbYellow\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Before</p>\n\n<p><a href=\"https://i.stack.imgur.com/dMmlG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dMmlG.png\" alt=\"Before\"></a></p>\n\n<p>After</p>\n\n<p><a href=\"https://i.stack.imgur.com/e7Qd0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e7Qd0.png\" alt=\"After\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "is_accepted": false, "score": 0, "last_activity_date": 1528899796, "last_edit_date": 1528899796, "creation_date": 1528896524, "answer_id": 50838502, "question_id": 50830464, "link": "https://stackoverflow.com/questions/50830464/speed-up-matching-program-in-excel-vba/50838502#50838502", "title": "Speed Up Matching program in Excel VBA", "body": "<p>Thanks everybody for your answers, </p>\n\n<p><a href=\"https://stackoverflow.com/users/4914662/paul-bica\">Paul Bica</a>'s solution actually worked and I am using a version of this code now.</p>\n\n<p>But, just to animate the debate, I think I also found another way around my first code, inspired by <a href=\"https://stackoverflow.com/users/7240351/maciej-lipinski\">Maciej</a>'s idea of concatenating the cells and using <strong><code>CStr</code></strong> to compare the values and, of course <a href=\"https://stackoverflow.com/users/4604845/vegard\">Vegard</a>'s in-memory processing by using arrays instead of going through the workbook :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Find_MatchesStr()\n\n    Dim AmountArr(300) As Variant\n    Dim rowArr(300) As Variant\n    Dim ws As Worksheet\n    Dim wb As Workbook\n    Set ws = ThisWorkbook.Sheets(\"Data\")\n    ws.Activate\n    Range(\"A1\").Select\n\n    rCnt = ws.Cells.SpecialCells(xlCellTypeLastCell).Row\n\n    For i = 2 To rCnt\n        If i = rCnt Then\n            Exit For\n        Else\n        intCnt = 0\n        strA = ws.Cells(i, 1).Value\n        strE = ws.Cells(i, 5).Value\n        strF = ws.Cells(i, 6).Value\n        strH = ws.Cells(i, 8).Value\n        strL = ws.Cells(i, 10).Value\n\n        For j = i To rCnt - 1\n            strSearchA = ws.Cells(j, 1).Value\n            strSearchE = ws.Cells(j, 5).Value\n            strSearchF = ws.Cells(j, 6).Value\n            strSearchH = ws.Cells(j, 8).Value\n            strSearchL = ws.Cells(j, 10).Value\n\n            If CStr(strE) = CStr(strSearchE) And CStr(strA) = CStr(strSearchA) And CStr(strF) = CStr(strSearchF) And CStr(strH) = CStr(strSearchH) And CStr(strL) = CStr(strSearchL) Then\n\n                AmountArr(k) = ws.Cells(j, 12).Value\n                rowArr(k) = j\n                intCnt = intCnt + 1\n                k = k + 1\n            Else\n                Exit For\n            End If\n        Next\n        strSum = 0\n        For s = 0 To UBound(AmountArr)\n            If AmountArr(s) &lt;&gt; \"\" Then\n                strSum = strSum + AmountArr(s)\n            Else\n                Exit For\n            End If\n        Next\n        strAppenRow = \"\"\n        For b = 0 To UBound(rowArr)\n            If rowArr(b) &lt;&gt; \"\" Then\n                strAppenRow = strAppenRow &amp; \"\" &amp; rowArr(b) &amp; \",\" &amp; AmountArr(b) &amp; \",\"\n            Else\n                Exit For\n            End If\n        Next\n\n        If intCnt = 1 Then\n\n        Else\n            If strSum = 0 Then\n                For rn = 0 To UBound(rowArr)\n                    If rowArr(rn) &lt;&gt; \"\" Then\n                        Let rRange = rowArr(rn) &amp; \":\" &amp; rowArr(rn)\n                        Rows(rRange).Select\n                        Selection.Interior.Color = vbYellow\n                    Else\n                        Exit For\n                    End If\n                Next\n            Else\n                strvar = \"\"\n                strvar = Split(strAppenRow, \",\")\n                For ik = 1 To UBound(strvar)\n                    If strvar(ik) &lt;&gt; \"\" Then\n                        strVal = CDbl(strvar(ik))\n                        For ik1 = ik To UBound(strvar)\n                            If strvar(ik1) &lt;&gt; \"\" Then\n                                strVal1 = CDbl(strvar(ik1))\n                                If strVal1 + strVal = 0 Then\n                                    Let sRange1 = strvar(ik - 1) &amp; \":\" &amp; strvar(ik - 1)\n                                    Rows(sRange1).Select\n                                    Selection.Interior.Color = vbYellow\n                                    Let sRange = strvar(ik1 - 1) &amp; \":\" &amp; strvar(ik1 - 1)\n                                    Rows(sRange).Select\n                                    Selection.Interior.Color = vbYellow\n                                End If\n                            Else\n                                Exit For\n                            End If\n                            ik1 = ik1 + 1\n                        Next\n                    Else\n                        Exit For\n                    End If\n                    ik = ik + 1\n                Next\n            End If\n        End If\n        i = i + (intCnt - 1)\n        k = 0\n        Erase AmountArr\n        Erase rowArr\n        End If\n    Next\n    Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>I still have some mistakes (rows not higlighted when they should be), the above code is not perfect, but I thought it'd be OK to give you an idea of where I was going before Paul Bica's solution came in. </p>\n\n<p>Thanks again !</p>\n"}], "owner": {"reputation": 55, "user_id": 9752795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216602470316906/picture?type=large", "display_name": "Alex Brollo", "link": "https://stackoverflow.com/users/9752795/alex-brollo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "accepted_answer_id": 50836065, "answer_count": 5, "score": 4, "last_activity_date": 1528983721, "creation_date": 1528871480, "last_edit_date": 1528983721, "question_id": 50830464, "link": "https://stackoverflow.com/questions/50830464/speed-up-matching-program-in-excel-vba", "title": "Speed Up Matching program in Excel VBA", "body": "<p>I am writing a VBA code on excel using loops to go through <strong>10000+ lines</strong>.</p>\n\n<p>Here is an example of the table</p>\n\n<p><a href=\"https://i.stack.imgur.com/aM7BH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aM7BH.png\" alt=\"Table_Matching_Example\"></a></p>\n\n<p>And here is the code I wrote :</p>\n\n<pre><code>Sub Find_Matches()\n\n    Dim wb As Workbook\n    Dim xrow As Long\n\n    Set wb = ActiveWorkbook\n    wb.Worksheets(\"Data\").Activate\n\n    tCnt = Sheets(\"Data\").UsedRange.Rows.Count\n    Dim e, f, a, j, h As Range\n    xrow = 2\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlManual\n\n    For xrow = 2 To tCnt Step 1\n        Set e = Range(\"E\" &amp; xrow)\n        Set f = e.Offset(0, 1)\n        Set a = e.Offset(0, -4)\n        Set j = e.Offset(0, 5)\n        Set h = e.Offset(0, 3)\n        For Each Cell In Range(\"E2:E\" &amp; tCnt)\n            If Cell.Value = e.Value Then\n                If Cell.Offset(0, 1).Value = f.Value Then\n                    If Cell.Offset(0, -4).Value = a.Value Then\n                        If Cell.Offset(0, 5).Value = j.Value Then\n                            If Cell.Offset(0, 3).Value = h.Value Then\n                                If (e.Offset(0, 7).Value) + (Cell.Offset(0, 7).Value) = 0 Then\n                                    Cell.EntireRow.Interior.Color = vbYellow\n                                    e.EntireRow.Interior.Color = vbYellow\n                                End If\n                            End If\n                        End If\n                    End If\n                End If\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>As you can imagine, this is taking a lot of time to go through 10000+ lines and I would like to find a faster solution. There must be a method I don't think to avoid the <em>over looping</em></p>\n\n<p>Here are the condition :</p>\n\n<blockquote>\n  <p>For each line, if another line anywhere in the file has the exact same\n  :</p>\n  \n  <ul>\n  <li>Buyer ID (col. E)</li>\n  <li>`# purchased (col. F)</li>\n  <li>Product ID (col.A)</li>\n  <li>Payment (col. J)</li>\n  <li>Date purchased (col. H)</li>\n  </ul>\n  \n  <p>Then, if the SUM of the Amount (col. L) the those two matching line is\n  0, then color both rows in yellow.</p>\n  \n  <p><em>Note that extra columns are present and not being compared (eg- col. B) but are still important for the document and cannot be deleted to ease the process.</em></p>\n</blockquote>\n\n<p>Running the previous code, in my example, row 2 &amp; 5 get highlighted :\n<a href=\"https://i.stack.imgur.com/GWIp6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GWIp6.png\" alt=\"Table_After_Running\"></a></p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528892201, "post_id": 50830027, "comment_id": 88677712, "body": "Can you be more specific? It&#39;s not clear whether you mean the first and second words in the document, or text that&#39;s literally &quot;Word 1&quot; and &quot;Word 2&quot;? You also don&#39;t give us any information as to values for f and f0."}, {"owner": {"reputation": 87, "user_id": 8847155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7892f7cc240ef1c83b1e2c2fb4276b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex27", "link": "https://stackoverflow.com/users/8847155/alex27"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528892409, "post_id": 50830027, "comment_id": 88677867, "body": "Literally &quot;Word 1&quot; and &quot;Word 2&quot;."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1529031198, "post_id": 50830027, "comment_id": 88738934, "body": "Cross-posted at: <a href=\"https://www.mrexcel.com/forum/general-excel-discussion-other-questions/1059223-search-between-specific-words-word-document.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/general-excel-discussion-other-questions/&hellip;</a> For cross-posting etiquette, please read: <a href=\"http://www.excelguru.ca/content.php?184\" rel=\"nofollow noreferrer\">excelguru.ca/content.php?184</a>"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 8847155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7892f7cc240ef1c83b1e2c2fb4276b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex27", "link": "https://stackoverflow.com/users/8847155/alex27"}, "edited": false, "score": 0, "creation_date": 1528955007, "post_id": 50838114, "comment_id": 88703368, "body": "Thanks for helping. I changed Word.Range to Object. But the macro dont paste the word i need: <code>&quot;name * book1&quot;</code>, which it should be found in the range of these words: <code>&quot;Word 1&quot;</code> and <code>&quot;Word 2&quot;</code> but paste the entire text of the document with error: <code>Run-time Error 4608 Value out of Range</code>."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 87, "user_id": 8847155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7892f7cc240ef1c83b1e2c2fb4276b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex27", "link": "https://stackoverflow.com/users/8847155/alex27"}, "edited": false, "score": 0, "creation_date": 1528995391, "post_id": 50838114, "comment_id": 88727390, "body": "I assume the problem to which you&#39;re referring occurs further down in your code. I can&#39;t speak to that since you provide absolutely no way to reproduce running that part of your code. We have no idea what <code>f</code> or <code>f0</code> are. Nor can I know what changes you may have made to the line(s) that follow. You do need to change your code following what I added - I only provided the steps to get <code>rSearch</code>. Beyond that I couldn&#39;t go since the second part is not clear. I mentioned that in my Answer."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1528895327, "creation_date": 1528895327, "answer_id": 50838114, "question_id": 50830027, "link": "https://stackoverflow.com/questions/50830027/search-between-specific-words-in-word-document/50838114#50838114", "title": "Search between specific words in Word document", "body": "<p>I'm not clear what all your code is supposed to be doing, but I changed the first part to search the two terms, then set the range to be searched to everything between the two terms (including the terms, themselves). I used multiple ranges so that it's always clear what Range refers to which content.</p>\n\n<p>I had to make some corrections to your code, for example you declared <code>r</code> as a Boolean, when it should be a Word.Range. I also had to change the object of the Word application since a Range needs to be declared using Word.Range in order to distinguish in from an Excel Range. Or you need to change these declarations to <code>Object</code> if you don't set a reference to Word's object library.</p>\n\n<p>Notice how the <code>Duplicate</code> property needs to be used in order to \"copy\" a Range to an independent Range object.</p>\n\n<pre><code>Sub test()\n    Dim wd As Object, WordDoc  As Object\n    Dim r As Word.Range, f As Boolean, fO As Long\n    Dim rStart As Word.Range, rEnd As Word.Range, rSearch As Word.Range\n\n    Set wd = CreateObject(\"Word.Application\")\n    Set WordDoc = wd.Documents.Open(Filename:=Application.ThisWorkbook.path &amp; \"\\test.docx\")\n\n    '''name'''\n    Set r = WordDoc.content\n    Set rStart = r.Duplicate\n    If Not UnifiedSearch(rStart, \"Word 1\") Then\n        Exit Sub\n    End If\n    Set rEnd = rStart.Duplicate\n    rEnd.End = r.End\n\n    If Not UnifiedSearch(rEnd, \"Word 2\") Then\n        Exit Sub\n    End If\n    Set rSearch = r.Duplicate\n    rSearch.Start = rStart.Start\n    rSearch.End = rEnd.End\n\n    Do While UnifiedSearch(rSearch, \"name*book1\")\n        If f Then\n            If r.Start = fO Then\n                Exit Do\n            End If\n        Else\n            fO = r.Start\n            f = True\n        End If\n        WordDoc.Range(r.Start + 4, r.End - 5).Copy\n        Range(\"C4\").Select\n        ActiveSheet.Paste\n        Set r = WordDoc.Range(r.End, r.End)\n    Loop\n'\n\n    WordDoc.Close\n    Set WordDoc = Nothing\n    wd.Quit\n    Set wd = Nothing\n\nEnd Sub\n\nPrivate Function UnifiedSearch(ByRef r As Range, s As String) As Boolean\n    Dim found As Boolean\n\n     With r.Find\n        .ClearFormatting\n        .Text = s\n        .Forward = True\n        .wrap = wdFindStop\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchAllWordForms = False\n        .MatchSoundsLike = False\n        .MatchWildcards = True\n        found = .Execute\n    End With\n    Debug.Print found, s\n        UnifiedSearch = found\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 8847155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7892f7cc240ef1c83b1e2c2fb4276b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex27", "link": "https://stackoverflow.com/users/8847155/alex27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528895327, "creation_date": 1528869779, "last_edit_date": 1531164843, "question_id": 50830027, "link": "https://stackoverflow.com/questions/50830027/search-between-specific-words-in-word-document", "title": "Search between specific words in Word document", "body": "<p>This macro searches for words through the Word document: <code>Set r = WordDoc.Range</code>. Is it possible to make it search only between specific words in Word document? Example: search only from \"Word1\" to \"Word2\". I know that I need to find these words and set them as Range.Start and Range.End, but i'm not good at this. Can someone help me with code?</p>\n\n<pre><code>Sub test()\nDim Word As Object, WordDoc  As Object\nDim r As Boolean, f As Boolean, fO As Long\nSet Word = CreateObject(\"Word.Application\")\nSet WordDoc = Word.Documents.Open(Filename:=Application.ThisWorkbook.path & \"\\test.docx\")\n\n'''name'''\nSet r = WordDoc.Range\nDo While UnifiedSearch(r, \"name*book1\")\n    If f Then\n        If r.Start = fO Then\n            Exit Do\n        End If\n    Else\n        fO = r.Start\n        f = True\n    End If\n    WordDoc.Range(r.Start + 4, r.End - 5).Copy\n    Range(\"C4\").Select\n    ActiveSheet.Paste\n    Set r = WordDoc.Range(r.End, r.End)\nLoop\n\nWordDoc.Close\nWord.Quit\n\nEnd Sub\n\nPrivate Function UnifiedSearch(r As Range, s As String) As Boolean\n\n     With r.Find\n        .ClearFormatting\n        .Text = s\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchAllWordForms = False\n        .MatchSoundsLike = False\n        .MatchWildcards = True\n        UnifiedSearch = .Execute\n    End With\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "criteria", "countif"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528870433, "post_id": 50830006, "comment_id": 88664550, "body": "try the last <code>MgsBox</code> with <code>CDbl(CDate(&quot;13&#47;06&#47;2018&quot;))</code> this compares the actual value of the date independent from the format."}, {"owner": {"reputation": 55, "user_id": 9923846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/794926f73c27c76c2e19e73914eb68d9?s=128&d=identicon&r=PG&f=1", "display_name": "eeeccc17", "link": "https://stackoverflow.com/users/9923846/eeeccc17"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1528870862, "post_id": 50830006, "comment_id": 88664768, "body": "@P\u1d07\u029c Works like a charm thank you.  Just for learning sake, why does Cdate not work?  If I had opted to use a date value instead of a string input, do I still need to use Cdbl?"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 9923846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/794926f73c27c76c2e19e73914eb68d9?s=128&d=identicon&r=PG&f=1", "display_name": "eeeccc17", "link": "https://stackoverflow.com/users/9923846/eeeccc17"}, "edited": false, "score": 0, "creation_date": 1528872920, "post_id": 50830496, "comment_id": 88665796, "body": "Thanks for this friend, makes alot of sense"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1528871622, "creation_date": 1528871622, "answer_id": 50830496, "question_id": 50830006, "link": "https://stackoverflow.com/questions/50830006/using-string-values-for-date-criterias-for-countif-in-vba-excel/50830496#50830496", "title": "using string values for DATE criterias for COUNTIF in vba excel", "body": "<p>You need to convert the date into a double first to compare the actual value of the date independent from the format.</p>\n\n<pre><code> \"&lt;=\" &amp; CDbl(CDate(\"13/06/2018\"))\n</code></pre>\n\n<p><strong>Why is this?</strong><br>\nIf you concatenate a <code>string</code> with a <code>date</code> like in <code>\"&lt;=\" &amp; CDate(\"13/06/2018\")</code> the <code>date</code> is converted into a <code>string</code> and the result is <code>\"&lt;=13/06/2018\"</code> (here the date is a string not a value).</p>\n\n<p>If you convert the <code>date</code> into a <code>double</code> <code>CDbl(CDate(\"13/06/2018\")</code> the result is <code>43264</code> which is the serial number that represents the date.\nDates in Excel are stored as serial numbers counting from <code>1900-01-01</code> so <code>2018-06-13</code> is day <code>43264</code> since <code>1900-01-01</code>.</p>\n\n<p>So with <code>\"&lt;=\" &amp; CDbl(CDate(\"13/06/2018\"))</code> you actually compare the cell value to <code>\"&lt;=43264\"</code>. So you compare to a value and not a text. This works because if a cell is formatted as <code>date</code> Excel actually stores the serial value but shows the formatted string for user compatibility.</p>\n\n<p><strong>Conclusion</strong><br>\nIf you want to compare dates always compare their values not their strings.</p>\n\n<p>Also see: <a href=\"https://support.microsoft.com/en-us/help/214094/how-to-use-dates-and-times-in-excel\" rel=\"nofollow noreferrer\">How to use dates and times in Excel</a>.</p>\n"}], "owner": {"reputation": 55, "user_id": 9923846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/794926f73c27c76c2e19e73914eb68d9?s=128&d=identicon&r=PG&f=1", "display_name": "eeeccc17", "link": "https://stackoverflow.com/users/9923846/eeeccc17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "accepted_answer_id": 50830496, "answer_count": 1, "score": 2, "last_activity_date": 1528871622, "creation_date": 1528869686, "last_edit_date": 1528869978, "question_id": 50830006, "link": "https://stackoverflow.com/questions/50830006/using-string-values-for-date-criterias-for-countif-in-vba-excel", "title": "using string values for DATE criterias for COUNTIF in vba excel", "body": "<p>I have 2 cells in Range B:B, which I wish to apply <code>countif</code> formula to via VBA in Excel.</p>\n\n<pre><code>27/09/2017\n13/06/2018\n</code></pre>\n\n<p>I have tried </p>\n\n<pre><code>MsgBox (WorksheetFunction.CountIf(Range(\"B:B\"), \"27/09/2017\"))\n</code></pre>\n\n<p>This returns 0</p>\n\n<pre><code>MsgBox (WorksheetFunction.CountIf(Range(\"B:B\"), CDate(\"27/09/2017\")))\n</code></pre>\n\n<p>This returns 1</p>\n\n<p>I am trying to figure out how I can get the macro to return both date values, via</p>\n\n<pre><code>MsgBox (WorksheetFunction.CountIf(Range(\"B:B\"), \"&lt;=\" &amp; CDate(\"13/06/2018\"))) \n</code></pre>\n\n<p>However this returns 0</p>\n\n<p>This seems to indicate that I do not quite understand how to filter dates in countif via strings. Would it be possible to share a alternative?</p>\n\n<p>I hope to implement a text input box where the user can input a date string which then applies the <code>countif</code> on</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "answers": [{"comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1528870317, "post_id": 50830038, "comment_id": 88664492, "body": "Do you get the new location / name of a workbook before the event you use triggers? I am pretty sure you don&#39;t which is why I used <code>Workbook_AfterSave</code> instead."}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1528870489, "post_id": 50830038, "comment_id": 88664573, "body": "Oups, you&#39;re right. Need to change to afterSave and then you can use the function."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1528870743, "post_id": 50830038, "comment_id": 88664699, "body": "If I do that, what is the benefit of your approach, instead of just doing the shorter test against <code>ThisWorkbook.FullName</code>?"}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1528871027, "post_id": 50830038, "comment_id": 88664842, "body": "You can change to .FullName if you want, the result will be the same."}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1528873595, "post_id": 50830038, "comment_id": 88666169, "body": "@eirikdaude Does the function do what you need ?"}], "tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1528873569, "last_edit_date": 1528873569, "creation_date": 1528869810, "answer_id": 50830038, "question_id": 50829713, "link": "https://stackoverflow.com/questions/50829713/change-the-protection-of-a-workbook-based-on-save-location-filename/50830038#50830038", "title": "Change the protection of a workbook based on save location / filename", "body": "<p>Add this function in a module to determine if the workbook is a final workbook :</p>\n\n<pre><code>Option Explicit\n\nPublic Function IsAWorkbookFinal() As Boolean\n\n    Dim wb As ThisWorkbook\n    Set wb = ThisWorkbook\n\n    Dim final_wb As String\n    final_wb = \"C:\\test\\final\\test_wb_save.xlsm\" 'adapt with fullname of final workbook\n\n        If wb.FullName = final_wb Then\n            IsAWorkbookFinal = True\n        Else\n            IsAWorkbookFinal = False\n        End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529058380, "creation_date": 1528868240, "last_edit_date": 1529058380, "question_id": 50829713, "link": "https://stackoverflow.com/questions/50829713/change-the-protection-of-a-workbook-based-on-save-location-filename", "title": "Change the protection of a workbook based on save location / filename", "body": "<p>I have a workbook which I have marked as final, but which I want users to be able to make a copy of which <em>isn't final</em>. However I can't figure out how to do this.</p>\n\n<p>I was thinking of putting the following code in the <code>ThisWorkbook</code>-module of the workbook, but I am hesitant since without saving the workbook again the changes made won't stick, and if I put in a <code>ThisWorkbook.Save</code> there the workbook will be saved twice (at least, I think I'd have to disable events before saving again?) every time the user saves the workbook.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_AfterSave(ByVal Success As Boolean)\n    If ThisWorkbook.FullName = \"&lt;full name of the original&gt;\" Then\n        ThisWorkbook.Final = True\n    Else\n        ThisWorkbook.Final = False\n    End If\nEnd Sub\n</code></pre>\n\n<p>Do you guys have any suggestions for a more elegant solution?</p>\n"}, {"tags": ["vba", "internet-explorer-11"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528870559, "post_id": 50829568, "comment_id": 88664607, "body": "Is URLMON an option here? Does the website provided a download link after clicking that you can use? You can then specify the download path. Otherwise, easy to add an extra script line to move the file of interest to another folder."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528870614, "post_id": 50829568, "comment_id": 88664631, "body": "Handling the open/save prompt is a common question on SO... Did none of those methods work? Which did you try?"}], "owner": {"reputation": 9, "user_id": 8481679, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155652292355967/picture?type=large", "display_name": "Joshua J Geoghegan", "link": "https://stackoverflow.com/users/8481679/joshua-j-geoghegan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528867497, "creation_date": 1528867497, "question_id": 50829568, "link": "https://stackoverflow.com/questions/50829568/internet-explorer-download-using-visual-basic", "title": "Internet Explorer download using Visual Basic", "body": "<p>I have a script that opens a URL in Internet Explorer, enters the username and password and clicks Submit. I can't get past the default Internet Explorer open/save prompt. Is this possible?</p>\n\n<pre><code>Call Main\n\nFunction Main\n    Set IE = WScript.CreateObject(\"InternetExplorer.Application\", \"IE_\")\n    IE.Visible = True\n    IE.Navigate \"https://www.blahblahblah.com\"\n    Wait IE\n    With IE.Document\n        .getElementByID(\"ctrluser\").value = \"blahblahblah\"\n        .getElementByID(\"ctrlpass\").value = \"blahblahblah\"        \n        .getElementByID(\"frmSubmit\").Click\n    End With\nEnd Function\n\nSub Wait(IE)\n  Do\n    WScript.Sleep 500\n  Loop While IE.ReadyState &lt; 4 And IE.Busy\nEnd Sub\n</code></pre>\n\n<p>Also, can you change the default download location to a specific network folder?</p>\n"}, {"tags": ["excel", "ms-word", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1528867900, "post_id": 50829018, "comment_id": 88663524, "body": "@urdearboy <code>on error resume next</code> is correctly used here. <code>GetObject</code> will throw an error if Word is not open, which <code>If w Is Nothing</code> catches.  Error handling is then immediately reset."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1528872587, "post_id": 50829817, "comment_id": 88665621, "body": "@chris second part <i>looks</i> ok, but I&#39;m not a mac user, so can&#39;t be sure.  One question though: are you sure your path and filename have <code>&quot;</code>s in them?"}, {"owner": {"reputation": 11, "user_id": 8897904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7517f696c1ec1b71de8ea9f522ff2e35?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/8897904/chris"}, "edited": false, "score": 0, "creation_date": 1528874321, "post_id": 50829817, "comment_id": 88666607, "body": "I made the changes suggested by chris and now when I run it with word running, it just cycles thru the &quot;Do while w is Nothing&quot; and never gets out of the loop."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 11, "user_id": 8897904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7517f696c1ec1b71de8ea9f522ff2e35?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/8897904/chris"}, "edited": false, "score": 0, "creation_date": 1528877911, "post_id": 50829817, "comment_id": 88668681, "body": "@chris If you have <code>Do While w is Nothing</code> then that is incorrect. The code supplied is <code>Do UNTIL w is Nothng</code>."}, {"owner": {"reputation": 11, "user_id": 8897904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7517f696c1ec1b71de8ea9f522ff2e35?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/8897904/chris"}, "edited": false, "score": 0, "creation_date": 1528942040, "post_id": 50829817, "comment_id": 88700433, "body": "That was a type on my part -  I have the code as supplied &quot;do until..&quot;"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1528872455, "last_edit_date": 1528872455, "creation_date": 1528868761, "answer_id": 50829817, "question_id": 50829018, "link": "https://stackoverflow.com/questions/50829018/vba-code-to-open-word-doc-not-working/50829817#50829817", "title": "VBA code to open word doc not working", "body": "<p>The first part of your code needs work.  </p>\n\n<ol>\n<li>It won't close all instances of Word if there are more than one running</li>\n<li>If no already open instance of Word is found, it creates one then immediately closes it.</li>\n</ol>\n\n<p>This part could be refactored as</p>\n\n<pre><code>Dim w As Object\nOn Error Resume Next\n    Set w = GetObject(, \"Word.Application\")\nOn Error GoTo 0\nDo Until w Is Nothing\n    Do Until w.Documents.Count = 0\n        w.Documents(1).Close SaveChanges:=-2\n    Loop\n    w.Quit SaveChanges:=0\n    Set w = Nothing\n    On Error Resume Next\n        Set w = GetObject(, \"Word.Application\")\n    On Error GoTo 0\nLoop\nOn Error GoTo 0\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8897904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7517f696c1ec1b71de8ea9f522ff2e35?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/8897904/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1535, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528877750, "creation_date": 1528863583, "last_edit_date": 1531164843, "question_id": 50829018, "link": "https://stackoverflow.com/questions/50829018/vba-code-to-open-word-doc-not-working", "title": "VBA code to open word doc not working", "body": "<p>I have searched thru other posts for this topic but can not find a solution. I want to run some VBA code in excel 2016 (on an imac running OS 10.13.5) to  open a word document (preferably as Read Only). \nIf an instance of word is already running, I want to close it before proceeding. (It would be nice if word is already running to be asked if I wanted to save the other instance(s) before closing them.)\nThe code I have is</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim w As Object\n' If word is already open get ahold of the running instance\n' Otherwise create a new instance\nOn Error Resume Next\nSet w = GetObject(, \"Word.Application\")\nIf w Is Nothing Then Set w = CreateObject(\"Word.Application\")  \nOn Error GoTo 0\n' Close all open files and shutdown Word\n' Loop through any open documents and close them\nDo Until w.Documents.Count = 0\n    w.Documents(1).Close\nLoop\nw.Quit False\nSet w = Nothing\n' Now that all instances of word are closed, open the template\nDim wdApp As Object\nDim wdDoc As Object\nSet wdApp = CreateObject(\"Word.application\")  \nwdApp.Visible = True\nwdApp.DisplayAlerts = False\nMYPATH = \"Volumes/256SSD/\"\"How to do stuff\"\"/\"\"myfile.docx\"\"\"\nSet wdDoc = wdApp.Documents.Open(FileName:=MYPATH)\nEnd Sub\n</code></pre>\n\n<p>When I run this with word already open, I get variable results. Sometimes the code runs thru the \"do until loop\" and seems to close the open word instances then proceeds to the last line and gives a vba runtime error \"Application-defined or object-defined error\". A word instance has been started and is awaiting input of which file to be opened.</p>\n\n<p>If I immediately run the code again, the \"do until loop\" is not entered and word come asking for file name input. VBA gives a run time error \"Automation error\". I can then select a file name from Recent Files and this is opened but the run time error remains and the file selected in MYPATH is not opened.</p>\n\n<p>I would appreciate some help on this.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5010039, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/46f64f49cdf3005da9e558db98ddfc62?s=128&d=identicon&r=PG&f=1", "display_name": "willi", "link": "https://stackoverflow.com/users/5010039/willi"}, "edited": false, "score": 0, "creation_date": 1539577684, "post_id": 52185349, "comment_id": 92537430, "body": "Thanks for your response; I have been out of action for a while."}], "tags": [], "owner": {"reputation": 1, "user_id": 10320219, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b7517707eb570b8dad7ac5663e64d21e?s=128&d=identicon&r=PG", "display_name": "Nacho", "link": "https://stackoverflow.com/users/10320219/nacho"}, "is_accepted": false, "score": 0, "last_activity_date": 1536173559, "last_edit_date": 1536173559, "creation_date": 1536151149, "answer_id": 52185349, "question_id": 50828992, "link": "https://stackoverflow.com/questions/50828992/excel-vba-detect-if-user-selects-either-a-parent-or-child-node-on-a-treeview/52185349#52185349", "title": "Excel VBA detect if user selects either a parent or child node on a treeview", "body": "<pre><code>If Userform1.TreeView1.Nodes(&lt;name of node&gt;).Parent Is Nothing Then\n    &lt;this is a parent node&gt;\nElse\n    &lt;this is a child node&gt;\nEnd If\n</code></pre>\n\n<p>You can get the name of the selected node using hittest during a \"mousedown\" event. Button, shift, x, and y are automatically populated by the event</p>\n\n<pre><code>Private Sub TreeView1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As stdole.OLE_XPOS_PIXELS, ByVal y As stdole.OLE_YPOS_PIXELS)\n\n        'hittest is looking at twips, x,y=pixels. 15 twips to a pixel (*15) to make it \n         &lt;name of node&gt; = TreeView1.HitTest(x * 15, y * 15)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5010039, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/46f64f49cdf3005da9e558db98ddfc62?s=128&d=identicon&r=PG&f=1", "display_name": "willi", "link": "https://stackoverflow.com/users/5010039/willi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536173559, "creation_date": 1528863338, "last_edit_date": 1531164843, "question_id": 50828992, "link": "https://stackoverflow.com/questions/50828992/excel-vba-detect-if-user-selects-either-a-parent-or-child-node-on-a-treeview", "title": "Excel VBA detect if user selects either a parent or child node on a treeview", "body": "<p>I have a userform containing a treeview and 2 frames each with several textboxes, labels etc. </p>\n\n<p>If  the user selects certain parents or any of their children, I want to hide 1 of the userform frames.<br>\nUsing the code below, I am able to hide the frame if the user selects a child but if the user selects a parent I get a Run Time error 91 \u201cObject variable or with block variable not set\u201d</p>\n\n<p>Changing Node.Parent to Node.Key hides the frame when the parent is selected but not when a child is selected.\nHow can I hide the frame if either is selected?\nAny guidance would be welcome.</p>\n\n<pre><code>If Node.Parent = \"North\" Or Node.Parent = \"South\" Or Node.Parent = \"East\u201d _\nor Node.Parent = \"West\" Then\nUserForm1.Frame1.Visible = False\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 1, "creation_date": 1528863794, "post_id": 50828953, "comment_id": 88662328, "body": "You need to split the string into a string array, convert each substring into a number using <code>Val</code>, <code>CDbl</code>, or <code>CSng</code> <i>(based on your requirements)</i> and then add the numbers. Have you tried anything?"}], "answers": [{"tags": [], "owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "is_accepted": true, "score": 1, "last_activity_date": 1528864411, "creation_date": 1528864411, "answer_id": 50829136, "question_id": 50828953, "link": "https://stackoverflow.com/questions/50828953/how-to-sum-a-list-of-numbers-in-vba/50829136#50829136", "title": "How to sum a list of numbers in vba?", "body": "<p>You need to split the string into a string array, convert each substring into a number using <code>Val</code>, <code>CDbl</code>, or <code>CSng</code> <em>(based on your requirements)</em> and then add the numbers.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>Dim inputStr As String\ninputStr = \"1.5, 2, 3, 5\"\nDim arr() As String\narr = Split(inputStr, \",\")\n\nDim total As Single     ' Or `Double` if you need more accuracy.\nFor Each subStr In arr\n    total = total + Val(subStr)     ' Use `Val` if you want to ignore non-numeric values.\n    'total = total + CSng(subStr)   ' Use `CSng` to break when finding non-numeric values.\n    'total = total + CDbl(subStr)   ' Use `CDbl` if you need more accuracy.\nNext\n\nMsgBox total\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1528868541, "post_id": 50829333, "comment_id": 88663769, "body": "I like that @QHarr"}, {"owner": {"reputation": 45, "user_id": 1742087, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c176d8e12dfbbded083f24f4a0104084?s=128&d=identicon&r=PG", "display_name": "Beaker McChemist", "link": "https://stackoverflow.com/users/1742087/beaker-mcchemist"}, "edited": false, "score": 0, "creation_date": 1528888556, "post_id": 50829333, "comment_id": 88675324, "body": "Unfortunately, this is for a Word macro, not Excel"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528890478, "post_id": 50829333, "comment_id": 88676576, "body": "I made a reference to Excel. Little heavy handed I admit!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528890622, "post_id": 50829333, "comment_id": 88676687, "body": "@cindymeister - Is there a method in Word for evaluating a string please? Can&#39;t seem to find one at present."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1528890894, "last_edit_date": 1528890894, "creation_date": 1528865930, "answer_id": 50829333, "question_id": 50828953, "link": "https://stackoverflow.com/questions/50828953/how-to-sum-a-list-of-numbers-in-vba/50829333#50829333", "title": "How to sum a list of numbers in vba?", "body": "<p>replace <code>\",\"</code> with <code>\"+\"</code> and use <code>Evaluate</code> formula on string. Note: Have to create reference to Excel instance which is a little heavy handed to say the least! I can't find a word equivalent of Evaluate function which seems a little odd:</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim inputStr As String, oXL As Object\n    inputStr = \"1.5, 2, 3, 5\"\n    With CreateObject(\"Excel.Application\")\n    MsgBox .Evaluate(Replace(inputStr, \",\", \"+\"))\n       .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 1742087, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c176d8e12dfbbded083f24f4a0104084?s=128&d=identicon&r=PG", "display_name": "Beaker McChemist", "link": "https://stackoverflow.com/users/1742087/beaker-mcchemist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 1, "accepted_answer_id": 50829136, "answer_count": 2, "score": 0, "last_activity_date": 1528899202, "creation_date": 1528863037, "last_edit_date": 1528899202, "question_id": 50828953, "link": "https://stackoverflow.com/questions/50828953/how-to-sum-a-list-of-numbers-in-vba", "title": "How to sum a list of numbers in vba?", "body": "<p>I have a vba function in my Word macro that returns a comma separated list of numbers as a string. For example; </p>\n\n<pre><code>var = (1.5, 2, 3, 5) \n</code></pre>\n\n<p>How  would I add them up to find the sum? </p>\n"}, {"tags": ["vba", "excel", "loops", "excel-formula", "zipfile"], "comments": [{"owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "edited": false, "score": 0, "creation_date": 1528874079, "post_id": 50828770, "comment_id": 88666451, "body": "not sure whether what you plan is feasable the way you tried. When having to work with ZIP files, I usually create a batch file as needed and let it control a tool like e.g. 7ZIP which then does the ZIP-job for you."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1528874373, "post_id": 50828770, "comment_id": 88666646, "body": "It may be easier and faster if you use vbscript and 7zip."}], "owner": {"reputation": 21, "user_id": 9933278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2eeb8983ae5ca89d6e8784458173581?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/9933278/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1708, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1528888580, "creation_date": 1528861301, "last_edit_date": 1528888580, "question_id": 50828770, "link": "https://stackoverflow.com/questions/50828770/macro-to-zip-certain-files-with-vba", "title": "Macro to zip certain files with VBA", "body": "<p>Every week I have to run this cycle count report. When the report is finished, I have to manually take about 30 files and group them by location and zip the files. I'm new with VBA and I'm trying to create a macro that will automatically group a certain set of files and zip them together. Also I need to be able to add or remove any files that are grouped together. Below is a list of the files and how I need them grouped and where I'm trying to save them to. Below is some code that I have for it. I know it's missing some things.</p>\n\n<p>Here are two files that I'm talking about. If someone can show me what to put in the macro to make this work and to group other files into other zip folders that would be great. </p>\n\n<p>Zip folder named <code>CYC 06-06-11-18</code> includes these files. <code>C06-06-11-18, C6K-06-11-18, C6M-06-11-18, C6V-06-11-18, CQU-06-11-18, CSU-06-11-18, T06-06-11-18,T6C-06-11-18, TSU-06-11-18.</code>  </p>\n\n<p>Zip folder named <code>CYC D1-06-11-18</code> includes these files. <code>CD1-06-11-18, CS1-06-11-18, TD1-06-11-18, TS1-06-11-18.</code>   </p>\n\n<p>The files are all in one folder and the zip folder can either be in the same folder or a new one. As long as the zip file can by named \"CYC 06\" or \"CYC 11\", or \"CYC T1\". I don't have to include the date on the zip folder. </p>\n\n<p>These files and the zip folders are being saved in the file path below. Which is what I would like to use if possible.</p>\n\n<pre><code>S:\\ACCT\\Inventory Control &amp; Product Costing\\Inventory Control - Reporting\\RM Cycle Count - Data Collection\\Zip Files\n</code></pre>\n\n<p>Here is the macro I've been working with. </p>\n\n<pre><code>Dim x As Integer\nDim fs o As Object\nDim result As Boolean\n\nSub Folder Info()\nApplication. Screen  Updating   = False\n'------------------------------------\n'DECLARE AND SET VARIABLES\n    Dim s t r Path As String\n    s t r  Path = \n    x = 0\n    Set fs o = Create Object    (\"Scripting. File System Object\")\n'------------------------------------\n'CHECK FOLDERS AND SUBFOLDERS\n    result = Extract File Info    (s t r Path)\n'------------------------------------\n'CLEANUP\n    Set fs o = Nothing\n    Msg Box x &amp; \" files have been zipped.\"\nApplication. Screen Updating = True\nEnd Sub\n\n\nPrivate Function Extract File Info(fs pec)\n    On Error Go To Err Handler\n'------------------------------------\n'DECLARE AND SET VARIABLES\n    Dim f l d r As Object, fi As Object, s f l d r As Object, o App As Object\n    Dim Filename, f name As String\n    Set f l d r = fs o. Get Folder(fs pec)\n'------------------------------------\n'CHECK FILES IN TOP FOLDER\n    If f l d r. Files. Count &lt;&gt; 0 Then\n        For Each fi In f l d r. Files\n            s = Split(fi, \".\")\n            If In  St r (1, fi, \"(C06)\" \u201c(CK6)\u201d \u201c(CB6)\u201d \u201c(C6M)\u201d \u201c(C6V)\u201d \u201c(CQU)\u201d \u201c(CSU)\u201d \u201c(T06)\u201d \u201c(T6C)\u201d \u201c(TQU)\u201d \u201c(TSU)\u201d, 1) &gt; 0 And U Case(Left(s(1), 2)) = \"XL\" Then\n                s = Split(fi, \".\")\n                Filename = s(0) &amp; \".zip\"\n                New Zip (CYC 06)\n                f name = fi\n                Set o App = Create Object(\"Shell. Application\")\n                o App. Name space(Filename).Copy Here s(0) &amp; \".\" &amp; s(1) 'F Name (I C t r)\n                x = x + 1\n            End If\naccess not allowed:\n        Next\n    End If\n'------------------------------------\n'CHECK SUBFOLDERS\n    If f l d r. Sub Folders. Count &gt; 0 Then\n        For Each s f l d r In f l d r. Sub Folders\n            Extract File Info (s f l d  r) 'RECURSIVE CHECK\n        Next\n    End If\n'------------------------------------\n'CLEANUP\npermission denied:\n    Extract File Info = True\n    Set f l d r = Nothing\nExit Handler:\n    Application. Screen Updating = True\n    Exit Function\n'------------------------------------\n'HANDLE RETURNED ERROR\nErr Handler:\n    If Err.Number = 70 Then 'permission denied\n        Err. Clear\n        Msg Box f spec &amp; Ch r (13) &amp; \"Permission Denied\"\n        Resume permission  denied\n    Else\n        Msg Box Err. Number &amp; \": \" &amp; Err. Description\n        Resume Exit Handler\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "is_accepted": false, "score": 0, "last_activity_date": 1528863512, "creation_date": 1528863512, "answer_id": 50829010, "question_id": 50828496, "link": "https://stackoverflow.com/questions/50828496/im-having-trouble-scraping-this/50829010#50829010", "title": "I&#39;m having trouble scraping this", "body": "<p>Try and declare \"objCollection\" as an object, strValue as string, and in the code below, replace in the first line the name of the http-request you declared:   </p>\n\n<pre><code>Document.body.innerHTML = YourHTTPRequest.responseText\nSet objCollection = Document.getElementsByClassName(\"rf_crow\")\n\n For Each objElement In objCollection\n\n     If objElement.ID = \"Y_1\" Then\n         strValue = objElement.getAttribute(\"rawvalue\")\n         Exit For\n     End If\n\n Next\n\n Cells(1, 1) = strValue\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8991350, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqUYI3TuIlw/AAAAAAAAAAI/AAAAAAAACK0/EZcM7tEjVH0/photo.jpg?sz=128", "display_name": "Abe M", "link": "https://stackoverflow.com/users/8991350/abe-m"}, "edited": false, "score": 0, "creation_date": 1528936687, "post_id": 50829696, "comment_id": 88699456, "body": "Hi QHarr, finally just sat down after work for this project. YES! Thank you!!! This was a perfect breakdown for what I was looking for, I think the major issue on my end was not knowing the use of the term &quot;outerHTML&quot;, i tried referring to the &quot;rawvalue&quot;, but it didnt do much for me used with the innertext or value key. thats what I used to scrap other pages.  Thank you so much for this. Now I&#39;m going to have to do some more work on my side to scrape the whole table! This is going to be fun!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1528870372, "last_edit_date": 1528870372, "creation_date": 1528868163, "answer_id": 50829696, "question_id": 50828496, "link": "https://stackoverflow.com/questions/50828496/im-having-trouble-scraping-this/50829696#50829696", "title": "I&#39;m having trouble scraping this", "body": "<p>The following should illuminate some of the problems you were having.</p>\n\n<hr>\n\n<p><strong>.querySelectorAll</strong></p>\n\n<p>The exact element you mention is the second index returned by <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll\" rel=\"nofollow noreferrer\"><code>.querySelectorAll</code></a> method of <code>.document</code> using the CSS selector <code>#Y_1</code>. The <a href=\"https://www.w3schools.com/CSSref/sel_id.asp\" rel=\"nofollow noreferrer\"><code>#</code></a> means Id.</p>\n\n<p>From that webpage it returns the following (sample shown - not all):</p>\n\n<p><a href=\"https://i.stack.imgur.com/GiTb3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GiTb3.png\" alt=\"CSS query\"></a></p>\n\n<p>From the above you can see the string you want is returned by the index of 2 in the result.</p>\n\n<p><strong><em>querySelectorAll with Id? Isn't Id a unique identifier for a single element?</em></strong> </p>\n\n<p>This Id, unexpectedly, is not unique to a single element on the page. It occurs a whopping 27 times:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XVQr6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XVQr6.png\" alt=\"Id\"></a></p>\n\n<p>This means you can use the <code>.querySelectorAll</code> method to return a nodeList of all matching items and take the item at index 2 to get your result.</p>\n\n<p><strong>Note:</strong></p>\n\n<p>If you want the long number next to <code>rawvalue</code>, <code>741131269</code>,  then parse the <code>outerHTML</code> of the returned element.</p>\n\n<pre><code>Debug.Print Replace(Split(Split(a.item(2).outerHTML, \"rawvalue=\")(1), \"&gt;\")(0), Chr$(34), vbNullString)\n</code></pre>\n\n<hr>\n\n<p><strong>.querySelector</strong></p>\n\n<p>Alternatively, you can target the id which is specific <code>data_i6</code> with  </p>\n\n<pre><code>.document.querySelector(\"#data_i6\")\n</code></pre>\n\n<p>This CSS selector (#data_i6) returns the entire row as it has each year within. If using <code>.querySelector</code> you will only get the first item anyway which is year 1.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y3F8t.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y3F8t.png\" alt=\"By id all years\"></a></p>\n\n<p>You can be more specific with the CSS selector and add the additional year Id to get just the year of interest:</p>\n\n<pre><code>#data_i6 #Y_1\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/08Rul.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/08Rul.png\" alt=\"Year of interest\"></a></p>\n\n<hr>\n\n<p><strong>Code: (querySelector method commented out next to querySelectorAll)</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub Get_Information()\n    Dim IE As New InternetExplorer\n\n    With IE\n        .Visible = True\n        .navigate \"http://quote.morningstar.ca/Quicktakes/Financials/is.aspx?t=GNTX&amp;region=USA&amp;culture=en-CA&amp;ops=clear\"\n        While .Busy = True Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim a As Object, exitTime As Date\n        exitTime = Now + TimeSerial(0, 0, 2)\n\n        Do\n            DoEvents\n            On Error Resume Next\n            Set a = .document.querySelectorAll(\"#Y_1\") ' .document.querySelector(\"#data_i6 #Y_1\")\n            On Error GoTo 0\n            If Now &gt; exitTime Then Exit Do\n        Loop While a Is Nothing\n\n        If a Is Nothing Then Exit Sub\n\n        Debug.Print Split(Split(a.item(2).innerText, \"rawvalue=\")(0), \"&gt;\")(0) 'Split(Split(a.innerText, \"rawvalue=\")(0), \"&gt;\")(0)\n        Debug.Print Replace(Split(Split(a.item(2).outerHTML, \"rawvalue=\")(1), \"&gt;\")(0), Chr$(34), vbNullString) 'Replace(Split(Split(a.outerHTML, \"rawvalue=\")(1), \"&gt;\")(0), Chr$(34), vbNullString)\n\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 1, "last_activity_date": 1528875060, "last_edit_date": 1528875060, "creation_date": 1528873504, "answer_id": 50830990, "question_id": 50828496, "link": "https://stackoverflow.com/questions/50828496/im-having-trouble-scraping-this/50830990#50830990", "title": "I&#39;m having trouble scraping this", "body": "<p>The solution is very easy. Just call it using it's attribute which is `rawvalue.</p>\n\n<p>This is how you can go:</p>\n\n<p>Using <code>Hardcoded delay</code> and <code>for loop</code> to check the availability of the desired value:</p>\n\n<pre><code>Sub GetValue()\n    Dim IE As New InternetExplorer, HTML As HTMLDocument, post As Object, elem As Object\n\n    With IE\n        .Visible = True\n        .Navigate \"http://quote.morningstar.ca/Quicktakes/Financials/is.aspx?t=GNTX&amp;region=USA&amp;culture=en-CA&amp;ops=clear\"\n        While .Busy = True Or .ReadyState &lt; 4: DoEvents: Wend\n        Set HTML = .Document\n    End With\n\n    ''using hardcoded delay\n    Application.Wait Now + TimeValue(\"00:00:05\")\n\n    For Each elem In HTML.getElementsByTagName(\"div\")\n        If elem.innerText = \"741\" Then MsgBox elem.getAttribute(\"rawvalue\"): Exit For\n    Next elem\nEnd Sub\n</code></pre>\n\n<p>Using <code>Explicit Wait</code>:</p>\n\n<pre><code>Sub GetValue()\n    Dim IE As New InternetExplorer, HTML As HTMLDocument, post As Object\n\n    With IE\n        .Visible = True\n        .Navigate \"http://quote.morningstar.ca/Quicktakes/Financials/is.aspx?t=GNTX&amp;region=USA&amp;culture=en-CA&amp;ops=clear\"\n        While .Busy = True Or .ReadyState &lt; 4: DoEvents: Wend\n        Set HTML = .Document\n    End With\n\n    Do: Set post = HTML.querySelector(\"#data_i6 #Y_1\"): DoEvents: Loop While post Is Nothing\n\n    MsgBox post.getAttribute(\"rawvalue\")\nEnd Sub\n</code></pre>\n\n<p>Output at this moment:</p>\n\n<pre><code>741131269\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1529849332, "creation_date": 1529849332, "answer_id": 51010695, "question_id": 50828496, "link": "https://stackoverflow.com/questions/50828496/im-having-trouble-scraping-this/51010695#51010695", "title": "I&#39;m having trouble scraping this", "body": "<p>Does this work for you?</p>\n\n<pre><code>Sub web_table_option_two()\n    Dim HTMLDoc As New HTMLDocument\n    Dim objTable As Object\n    Dim lRow As Long\n    Dim lngTable As Long\n    Dim lngRow As Long\n    Dim lngCol As Long\n    Dim ActRw As Long\n    Dim objIE As InternetExplorer\n    Set objIE = New InternetExplorer\n    objIE.Navigate \"http://quote.morningstar.ca/Quicktakes/Financials/is.aspx?t=GNTX&amp;region=USA&amp;culture=en-CA&amp;ops=clear\"\n\n    Do Until objIE.ReadyState = 4 And Not objIE.Busy\n        DoEvents\n    Loop\n    Application.Wait (Now + TimeValue(\"0:00:03\")) 'wait for java script to load\n    HTMLDoc.body.innerHTML = objIE.Document.body.innerHTML\n    With HTMLDoc.body\n        Set objTable = .getElementsByTagName(\"table\")\n        For lngTable = 0 To objTable.Length - 1\n            For lngRow = 0 To objTable(lngTable).Rows.Length - 1\n                For lngCol = 0 To objTable(lngTable).Rows(lngRow).Cells.Length - 1\n                    ThisWorkbook.Sheets(\"Sheet1\").Cells(ActRw + lngRow + 1, lngCol + 1) = objTable(lngTable).Rows(lngRow).Cells(lngCol).innerText\n                Next lngCol\n            Next lngRow\n            ActRw = ActRw + objTable(lngTable).Rows.Length + 1\n        Next lngTable\n    End With\n    objIE.Quit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8991350, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqUYI3TuIlw/AAAAAAAAAAI/AAAAAAAACK0/EZcM7tEjVH0/photo.jpg?sz=128", "display_name": "Abe M", "link": "https://stackoverflow.com/users/8991350/abe-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 1, "accepted_answer_id": 50829696, "answer_count": 4, "score": 0, "last_activity_date": 1529849332, "creation_date": 1528858790, "last_edit_date": 1528873741, "question_id": 50828496, "link": "https://stackoverflow.com/questions/50828496/im-having-trouble-scraping-this", "title": "I&#39;m having trouble scraping this", "body": "<p>I'm trying to understand why my references arent working well to scrape this data.</p>\n\n<p>Here is the site as an example:<br>\n<a href=\"http://quote.morningstar.ca/Quicktakes/Financials/is.aspx?t=GNTX&amp;region=USA&amp;culture=en-CA&amp;ops=clear\" rel=\"nofollow noreferrer\">http://quote.morningstar.ca/Quicktakes/Financials/is.aspx?t=GNTX&amp;region=USA&amp;culture=en-CA&amp;ops=clear</a></p>\n\n<p>And as a target:</p>\n\n<pre><code>&lt;div id=\"data_i6\" class=\"rf_crow\"&gt;&lt;div id=\"Y_1\" class=\"pos column6Width_noChart116px\" style=\"overflow:hidden;white-space: nowrap;\" rawvalue=\"741131269\"&gt;741&lt;/div&gt;&lt;div id=\"Y_2\" class=\"pos column6Width_noChart116px\" style=\"overflow:hidden;white-space: nowrap;\" rawvalue=\"836611464\"&gt;837&lt;/div&gt;&lt;div id=\"Y_3\" class=\"pos column6Width_noChart116px\" style=\"overflow:hidden;white-space: nowrap;\" rawvalue=\"939841654\"&gt;940&lt;/div&gt;&lt;div id=\"Y_4\" class=\"pos column6Width_noChart116px\" style=\"overflow:hidden;white-space: nowrap;\" rawvalue=\"1010472512\"&gt;1,010&lt;/div&gt;&lt;div id=\"Y_5\" class=\"pos column6Width_noChart116px\" style=\"overflow:hidden;white-space: nowrap;\" rawvalue=\"1100344312\"&gt;1,100&lt;/div&gt;&lt;div id=\"Y_6\" class=\"pos column6Width_noChart116px\" style=\"overflow:hidden;white-space: nowrap;\" rawvalue=\"1115401551\"&gt;1,115&lt;/div&gt;&lt;/div&gt;\n</code></pre>\n\n<p>What I need to extract is the actual value in rawvalue=\"741131269\" and the following is what I've gotten to work so far.</p>\n\n<pre><code>'Cells(1, 1) = Document.getElementsByClassName(\"rf_crow\")'returns the rows of data into one cell\n'Cells(1, 1) = Document.getElementById(\"Y_1\").innerText 'returns the text for the year\n'Cells(1, 1) = Document.getElementById(\"data_i1\").innerText 'returns to first row of data\n</code></pre>\n\n<p>I know the above doesn't return what I want, because the comment tells you what it extracts into Excel. The sub-element doesn't seem to work as it does in other macros I've built. I thought something like this would work:</p>\n\n<pre><code>Cells(1, 1) = Document.getElementById(\"Y_1\").getAttribute(\"rawvalue\")\n</code></pre>\n\n<p>but that doesn't work, also, I tried:</p>\n\n<pre><code>Cells(1, 1) = Document.getElementById(\"data_i6\").getElementById(\"Y_1\").innertext\n</code></pre>\n\n<p>and that doesn't work either.</p>\n"}, {"tags": ["vba", "ms-access", "insert-into"], "comments": [{"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1528858971, "post_id": 50828459, "comment_id": 88661458, "body": "What is RunSQL? If it is a custom function, please share that code as that is probably where your error is coming from.  If it&#39;s supposed to be DoCmd.RunSQL, I have no idea how it is working the first time."}, {"owner": {"reputation": 13, "user_id": 9911681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2b102585e487e74c185c4950e13dacf?s=128&d=identicon&r=PG&f=1", "display_name": "mezje", "link": "https://stackoverflow.com/users/9911681/mezje"}, "reply_to_user": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1528859336, "post_id": 50828459, "comment_id": 88661517, "body": "I do not have much database experience so please be patient with me. I am currently updating a database that has been around since 2002, I have no previous knowledge and have been referring previous code to learn.  Current buttons all define LETTERHERE_strSQL as a string and then just RunSQL LETTERHERE_strSQL."}, {"owner": {"reputation": 13, "user_id": 9911681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2b102585e487e74c185c4950e13dacf?s=128&d=identicon&r=PG&f=1", "display_name": "mezje", "link": "https://stackoverflow.com/users/9911681/mezje"}, "reply_to_user": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1528859701, "post_id": 50828459, "comment_id": 88661585, "body": "<a href=\"https://i.imgur.com/LdduhmQ.png\" rel=\"nofollow noreferrer\">Does this help clarify?</a>."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1528881281, "post_id": 50828459, "comment_id": 88670649, "body": "Did you change the ID before clicking the button a second time? If not, that would explain that it can&#39;t insert the second record (with the same ID)."}, {"owner": {"reputation": 13, "user_id": 9911681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2b102585e487e74c185c4950e13dacf?s=128&d=identicon&r=PG&f=1", "display_name": "mezje", "link": "https://stackoverflow.com/users/9911681/mezje"}, "edited": false, "score": 0, "creation_date": 1528888190, "post_id": 50828459, "comment_id": 88675103, "body": "ID will remain constant as it grabs it from the form I am in and the form doesn&#39;t change.  Tomorrow I will try hard code the ID and see how it goes"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9911681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2b102585e487e74c185c4950e13dacf?s=128&d=identicon&r=PG&f=1", "display_name": "mezje", "link": "https://stackoverflow.com/users/9911681/mezje"}, "edited": false, "score": 0, "creation_date": 1528861451, "post_id": 50828729, "comment_id": 88661908, "body": "Thanks, I found <a href=\"https://i.imgur.com/LdduhmQ.png\" rel=\"nofollow noreferrer\">this</a>. Does it clarify much? Sometimes with other things I have done errors have pointed there...  Should I be adding these to the private code for the button?"}], "tags": [], "owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "is_accepted": false, "score": 0, "last_activity_date": 1528860979, "creation_date": 1528860979, "answer_id": 50828729, "question_id": 50828459, "link": "https://stackoverflow.com/questions/50828459/insert-into-button-only-inserts-once/50828729#50828729", "title": "INSERT INTO button only inserts once", "body": "<p>This may not fix your problem, but the library being used should be specified.  Since it looks like you are using native access libraries this will be the DAO library so change the Dim statements in RunSQL as follows:</p>\n\n<pre><code>Dim dbs as DAO.Recordset\nDim qdfSQL as DAO.QueryDef\n</code></pre>\n\n<p>Sometimes not specifying the library can cause issues let me know if this changes anything.</p>\n"}], "owner": {"reputation": 13, "user_id": 9911681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2b102585e487e74c185c4950e13dacf?s=128&d=identicon&r=PG&f=1", "display_name": "mezje", "link": "https://stackoverflow.com/users/9911681/mezje"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528860979, "creation_date": 1528858498, "last_edit_date": 1528859495, "question_id": 50828459, "link": "https://stackoverflow.com/questions/50828459/insert-into-button-only-inserts-once", "title": "INSERT INTO button only inserts once", "body": "<p>Private Sub btnMissingModels_Click()</p>\n\n<pre><code>' Define variables\nDim IDToUpdate As String\nDim m_strSQL As String\n\n' Grab ID\nIDToUpdate = Me.FINLDATA_ID.Value\n\n' INSERT ID and missing model - only works once (for T300 - 0000300) and doesn't ignore 'Removed' models\nm_strSQL = \"INSERT INTO [FINLDATA MODELS] (FINLDATA_ID, MODEL)\" &amp; _\n        \"SELECT '\" &amp; IDToUpdate &amp; \"', MODEL FROM T_MODELS_LIST WHERE NOT EXISTS (SELECT MODEL FROM [FINLDATA MODELS] WHERE [FINLDATA MODELS].MODEL = T_MODELS_LIST.MODEL)\"\n\nRunSQL m_strSQL\n\n' Refresh the form display\nMe.F_EDIT_ENTRIES_MODEL_SUB.Form.Requery\n</code></pre>\n\n<p>End Sub</p>\n\n<p>The button works well however it only works once. For example, I click it, it adds the FINLDATA_ID and first MODEL which doesn't exist in FINLDATA MODELS but if I click it again it doesn't then add the next missing MODEL.</p>\n\n<p>Also I would like to add a second WHERE condition but cannot seem to get it to work using 'AND' I have tried a range of syntax but none seem to work. I thought it would work WHERE (condition 1) AND (condition 2). The second condition is: </p>\n\n<p>WHERE (((T_MODELS_LIST.REMOVED)=No)). </p>\n\n<p>This filters out all superseded models. I have used this condition in previous queries and it has worked well.</p>\n\n<p>Thank you in advance for all your help!</p>\n"}]