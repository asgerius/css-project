[{"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4996987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7764ea06ad5f8c3b8089becd303a6d15?s=128&d=identicon&r=PG", "display_name": "wongnog", "link": "https://stackoverflow.com/users/4996987/wongnog"}, "edited": false, "score": 0, "creation_date": 1433979407, "post_id": 30768979, "comment_id": 49590240, "body": "Thanks Omar! But how would I integrate that with the code I showed?  That&#39;s my main Word VBA macro, except there are many lines of .Caption linked to my Excel object exWb"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 111, "user_id": 4996987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7764ea06ad5f8c3b8089becd303a6d15?s=128&d=identicon&r=PG", "display_name": "wongnog", "link": "https://stackoverflow.com/users/4996987/wongnog"}, "edited": false, "score": 0, "creation_date": 1433979882, "post_id": 30768979, "comment_id": 49590367, "body": "@wongnog see updated answer, i didn&#39;t test yet but i will as soon i get a min."}, {"owner": {"reputation": 111, "user_id": 4996987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7764ea06ad5f8c3b8089becd303a6d15?s=128&d=identicon&r=PG", "display_name": "wongnog", "link": "https://stackoverflow.com/users/4996987/wongnog"}, "edited": false, "score": 0, "creation_date": 1433982538, "post_id": 30768979, "comment_id": 49591043, "body": "Thanks Omar, I think it&#39;s almost there!  Your code is expecting a Word document though, and doesn&#39;t like when I try and pass through an Excel file (gives a Run-time error &#39;5792&#39;: The file appears to be corrupted).  Can you please help me filter it for macro-enabled Excel files (.xlsm)? Thanks!"}, {"owner": {"reputation": 111, "user_id": 4996987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7764ea06ad5f8c3b8089becd303a6d15?s=128&d=identicon&r=PG", "display_name": "wongnog", "link": "https://stackoverflow.com/users/4996987/wongnog"}, "edited": false, "score": 0, "creation_date": 1433996690, "post_id": 30768979, "comment_id": 49594362, "body": "it lets me open any file type now, but now I get a <code>Run-time error &#39;1004&#39;: &quot;myfile.xlsm&quot; could not be found. Check the spelling of the file name, and verify that the file location is correct.</code> I&#39;m guessing there is a syntax error with the path / filename?"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1433991709, "last_edit_date": 1433991709, "creation_date": 1433978474, "answer_id": 30768979, "question_id": 30768919, "link": "https://stackoverflow.com/questions/30768919/open-file-dialog-box-to-get-excel/30768979#30768979", "title": "Open File dialog box to get Excel", "body": "<p>You could try something like this</p>\n\n<p>Replace <code>PathWork</code> and <code>CalcFile</code> with <code>Dialogbox</code></p>\n\n<pre><code>With Dialogs(wdDialogFileOpen)\n    If .Display Then\n        If .Name &lt;&gt; \"\" Then\n            Set exWb = Workbooks.Open(.Name)\n            sPath = exWb.Path\n        End If\n    Else\n        MsgBox \"No file selected\"\n    End If\nEnd With\n</code></pre>\n\n<p>Complete <kbd> <strong>CODE</strong> </kbd> should look like this </p>\n\n<pre><code>Option Explicit\n\nSub Update()\n    Dim objExcel As New Excel.Application\n    Dim exWb As Excel.Workbook\n    Dim sPath As String\n\n    '// Dialog box here to select excel file\n    With Dialogs(wdDialogFileOpen)\n        If .Display Then\n            If .Name &lt;&gt; \"\" Then\n                Set exWb = Workbooks.Open(.Name)\n                sPath = exWb.Path\n            End If\n            Set exWb = objExcel.Workbooks.Open(FileName:=sPath)\n            ActiveDocument.Date.Caption = exWb.Sheets(\"Data\").Cells(1, 1)\n        Else\n            MsgBox \"No file selected\"\n        End If\n    End With\n    Set objExcel = Nothing\n    Set exWb = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 487, "user_id": 4968719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5bDr7.jpg?s=128&g=1", "display_name": "Akif Patel - BRMS", "link": "https://stackoverflow.com/users/4968719/akif-patel-brms"}, "is_accepted": true, "score": 2, "last_activity_date": 1434021609, "last_edit_date": 1434021609, "creation_date": 1433992696, "answer_id": 30770954, "question_id": 30768919, "link": "https://stackoverflow.com/questions/30768919/open-file-dialog-box-to-get-excel/30770954#30770954", "title": "Open File dialog box to get Excel", "body": "<p>Here is a simplified macro which will allow the user to select only Macro-Enabled Excels. I couldn't comment on the previous answer as I have not earned enough reputation to comment on an answer. Please mind it.</p>\n\n<pre><code>Public Sub GetCaptionFromExcel()\n    Dim objExcel As New Excel.Application, exWb As Workbook\n    With Application.FileDialog(msoFileDialogFilePicker)\n        .Title = \"Select Macro-Enabled Excel Files\"\n        .Filters.Add \"Macro-Enabled Excel Files\", \"*.xlsm\", 1\n        If .Show &lt;&gt; -1 Then Exit Sub\n\n        Set exWb = objExcel.Workbooks.Open(.SelectedItems(1))\n        '*** Use the values from excel here***\n        MsgBox exWb.Sheets(\"Data\").Cells(1, 1)\n        '*** Close the opened Excel file\n        exWb.Close\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4996987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7764ea06ad5f8c3b8089becd303a6d15?s=128&d=identicon&r=PG", "display_name": "wongnog", "link": "https://stackoverflow.com/users/4996987/wongnog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3288, "favorite_count": 3, "accepted_answer_id": 30770954, "answer_count": 2, "score": 0, "last_activity_date": 1597304032, "creation_date": 1433978115, "last_edit_date": 1434021508, "question_id": 30768919, "link": "https://stackoverflow.com/questions/30768919/open-file-dialog-box-to-get-excel", "title": "Open File dialog box to get Excel", "body": "<p>I've written some Word VBA which takes an Excel file and updates Labels (ActiveX Control) in the Word file.  The only thing is this Excel file will change path and filename each month.  Instead of editing 2 variables each month, how do I add an Open File dialog box so the user selects the Excel file to be used?</p>\n\n<p>Here is what I have now:</p>\n\n<pre><code>Sub Update()\n    Dim objExcel As New Excel.Application\n    Dim exWb As Excel.Workbook\n\n    PathWork = \"C:\\My Documents\\2015-05 Report\\\"\n    CalcFile = \"May2015-data.xlsx\"\n\n    Set exWb=objExcel.Workbooks.Open(FileName:=PathWork &amp; CalcFile)\n    ThisDocument.date.Caption=exWb.Sheets(\"Data\").Cells(1,1)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3792, "user_id": 1467396, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e61d07f534b26dfd350412781e40bbbc?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1467396/david"}, "edited": false, "score": 0, "creation_date": 1433976519, "post_id": 30768321, "comment_id": 49589301, "body": "Not sure I understand your question entirely, but do either of these help?  <a href=\"http://stackoverflow.com/q/8072185/1467396\">stackoverflow.com/q/8072185/1467396</a>  <a href=\"http://stackoverflow.com/q/733123/1467396\">stackoverflow.com/q/733123/1467396</a> (if so, which one?)"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1433976910, "post_id": 30768321, "comment_id": 49589438, "body": "With your code, if you use <code>set rango=Range(celdactiva)</code> then  <code>rango.select</code> will select cell D2. Is that not what you want? What do you want instead? It is not clear what the problem is."}, {"owner": {"reputation": 1, "user_id": 4987481, "user_type": "registered", "profile_image": "https://graph.facebook.com/900917186613445/picture?type=large", "display_name": "Giuseppe Correal", "link": "https://stackoverflow.com/users/4987481/giuseppe-correal"}, "edited": false, "score": 0, "creation_date": 1433981953, "post_id": 30768321, "comment_id": 49590894, "body": "hi teylyn. I just need for rango to be = D2 wich is a range and not = value of celdactiva that is the original table cell."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1434063581, "post_id": 30768321, "comment_id": 49634958, "body": "I haven&#39;t used <code>ListObjects</code> in a worksheet before, it may be like Range object where the <code>.Cells(row,col).Address</code> may not be the same  Worksheet Cell you are after. ie. <code>Set oRng1 = Range(&quot;B5:H10&quot;)</code> then <code>oRng1.Cells(2,4).Address</code> is <b>E6</b>, same as <code>oRng1.Range(&quot;D2&quot;).Address</code>."}, {"owner": {"reputation": 1, "user_id": 4987481, "user_type": "registered", "profile_image": "https://graph.facebook.com/900917186613445/picture?type=large", "display_name": "Giuseppe Correal", "link": "https://stackoverflow.com/users/4987481/giuseppe-correal"}, "edited": false, "score": 0, "creation_date": 1434064766, "post_id": 30768321, "comment_id": 49635293, "body": "thanks patrick. I don&#39;t know the difference between choosing rango as range or  rango as range object."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1434064888, "post_id": 30768321, "comment_id": 49635329, "body": "shouldn&#39;t it be <code>Dim mcard as ListObject</code>? There isn&#39;t <code>objectlist</code> by default. I think you are missing the range object <code>.Range.Cells(2,4)</code>"}, {"owner": {"reputation": 1, "user_id": 4987481, "user_type": "registered", "profile_image": "https://graph.facebook.com/900917186613445/picture?type=large", "display_name": "Giuseppe Correal", "link": "https://stackoverflow.com/users/4987481/giuseppe-correal"}, "edited": false, "score": 0, "creation_date": 1434071967, "post_id": 30768321, "comment_id": 49637124, "body": "thanks patrick. I&#39;l try that"}, {"owner": {"reputation": 1, "user_id": 4987481, "user_type": "registered", "profile_image": "https://graph.facebook.com/900917186613445/picture?type=large", "display_name": "Giuseppe Correal", "link": "https://stackoverflow.com/users/4987481/giuseppe-correal"}, "edited": false, "score": 0, "creation_date": 1434074072, "post_id": 30768321, "comment_id": 49637698, "body": "I keep getting values and not range notations. thanks"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1434084455, "post_id": 30768321, "comment_id": 49640039, "body": "Don&#39;t use <code>.Cells(,).Text</code> instead use <code>[D2].Text</code> or <code>Range(&quot;D2&quot;).Text</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4987481, "user_type": "registered", "profile_image": "https://graph.facebook.com/900917186613445/picture?type=large", "display_name": "Giuseppe Correal", "link": "https://stackoverflow.com/users/4987481/giuseppe-correal"}, "edited": false, "score": 0, "creation_date": 1434070071, "post_id": 30793285, "comment_id": 49636732, "body": "thanks patrick, but keep getting the value of the cell instead the range notation&quot;d2&quot; that celdactiva has. in other words I can&#39;t give to rango a permanent range notation but only a value ."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 1, "user_id": 4987481, "user_type": "registered", "profile_image": "https://graph.facebook.com/900917186613445/picture?type=large", "display_name": "Giuseppe Correal", "link": "https://stackoverflow.com/users/4987481/giuseppe-correal"}, "edited": false, "score": 0, "creation_date": 1434088062, "post_id": 30793285, "comment_id": 49641211, "body": "can you add the edited solution (the Debug.Print) lines to show what is happening?"}, {"owner": {"reputation": 1, "user_id": 4987481, "user_type": "registered", "profile_image": "https://graph.facebook.com/900917186613445/picture?type=large", "display_name": "Giuseppe Correal", "link": "https://stackoverflow.com/users/4987481/giuseppe-correal"}, "edited": false, "score": 0, "creation_date": 1434414692, "post_id": 30793285, "comment_id": 49757331, "body": "hi. Finally could get variable celdactiva= to range notation like this:"}, {"owner": {"reputation": 1, "user_id": 4987481, "user_type": "registered", "profile_image": "https://graph.facebook.com/900917186613445/picture?type=large", "display_name": "Giuseppe Correal", "link": "https://stackoverflow.com/users/4987481/giuseppe-correal"}, "edited": false, "score": 0, "creation_date": 1434414746, "post_id": 30793285, "comment_id": 49757346, "body": "celdactiva = ActiveCell.Address                     Set rango = .Range(celdactiva)"}, {"owner": {"reputation": 1, "user_id": 4987481, "user_type": "registered", "profile_image": "https://graph.facebook.com/900917186613445/picture?type=large", "display_name": "Giuseppe Correal", "link": "https://stackoverflow.com/users/4987481/giuseppe-correal"}, "edited": false, "score": 0, "creation_date": 1434415213, "post_id": 30793285, "comment_id": 49757447, "body": "hi. Finally could get variable celdactiva= to range notation like this:                                                                                                                                                  celdactiva = ActiveCell.Address but, when I try to put it into the range  rango :        Set rango = Range(celdactiva)    &#39; shows de range value and not the same range address."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1434087979, "last_edit_date": 1434087979, "creation_date": 1434066611, "answer_id": 30793285, "question_id": 30768321, "link": "https://stackoverflow.com/questions/30768321/put-range-name-to-a-variable/30793285#30793285", "title": "put range name to a variable", "body": "<p>Try this, this should do (1) and (2):</p>\n\n<pre><code>Sub SO_30768321()\n    Dim celdactiva As String\n    Dim mcard As ListObject\n    Dim rango As Range\n\n    Set mcard = ActiveWorkbook.ActiveSheet.ListObjects(\"mcard\")\n    Debug.Print \"mcard Address: \" &amp; mcard.Range.Address\n    With mcard ' **(this is an excel objectlist that contains cell(2,4))**\n        celdactiva = .Range.Cells(2, 4).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n        Debug.Print \"celdactiva: \" &amp; celdactiva\n        '===[ You could have set rango here ]===\n        Set rango = .Range.Cells(2, 4)\n        Debug.Print \"rango address: \" &amp; rango.Address\n        'With rango.Offset(0, 1)\n        '   .Font.Bold = True\n        '   .Value = \"X\"\n        'End With\n        Set rango = Nothing\n    End With\n\n    Set rango = Range(celdactiva)\n    With rango.Offset(0, 1)\n        .Font.Bold = True\n        .Value = \"X\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4987481, "user_type": "registered", "profile_image": "https://graph.facebook.com/900917186613445/picture?type=large", "display_name": "Giuseppe Correal", "link": "https://stackoverflow.com/users/4987481/giuseppe-correal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434087979, "creation_date": 1433974935, "last_edit_date": 1433976518, "question_id": 30768321, "link": "https://stackoverflow.com/questions/30768321/put-range-name-to-a-variable", "title": "put range name to a variable", "body": "<p>I succeeded converting a numeric cell into a text cell as fallow :</p>\n\n<pre><code>dim celdactiva as string\ndim mcard as objectlist\ndim rango as range\n\nSet mcard = ActiveWorkbook.ActiveSheet.ListObjects(\"mcard\")\n\nwith mcard  **(this is an excel objectlist that contains cell(2,4))**\n\nceldactiva=.Cells(2, 4).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n\nend with\n</code></pre>\n\n<p>now i want to put celdactiva (that is just a text for now) into a variable as fallow:</p>\n\n<p>1.\nSet rango = Range(celdactiva)</p>\n\n<p>but rango gets the value of \" celdactiva\" instead the name of the range. in this case \"D2\" that belongs to the table MCARD.</p>\n\n<ol start=\"2\">\n<li>later I want to paste a bold \"X\" into rango, but next to the value of celdactiva that now is named rango.Need to know the select, copy and paste statements in vba code too.</li>\n</ol>\n\n<p>some body knows about both parts (1 &amp; 2 )?</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1433976462, "post_id": 30768145, "comment_id": 49589278, "body": "To be clear, <i>&#39;the exact last row number in which data resides within column A&#39;</i> should read <i>&#39;the exact last row number in which <b>a text value</b> resides within column A&#39;</i>. Finding the last number in a column is different."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1433977074, "post_id": 30768145, "comment_id": 49589494, "body": "re: <i>put the current date within the range AI2:AI3576 or AI2:AI4000</i>. Your code is commented to say that the date should be in AG2."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 2942794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z2jmY.jpg?s=128&g=1", "display_name": "T-Rex", "link": "https://stackoverflow.com/users/2942794/t-rex"}, "edited": false, "score": 0, "creation_date": 1434032040, "post_id": 30768929, "comment_id": 49616600, "body": "Thank you and you are totally correct in the comments above. I should have re-read for consistency. You obviously deduced quite impressively.  Thanks again."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1433978178, "creation_date": 1433978178, "answer_id": 30768929, "question_id": 30768145, "link": "https://stackoverflow.com/questions/30768145/paste-the-current-date-into-a-pre-defined-range-named-within-a-cell/30768929#30768929", "title": "Paste the current date into a pre-defined range named within a cell", "body": "<p>By successively redefining the area you are referring to using <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With...End With statements</a>, you can accomplish this without assigning a range.</p>\n\n<pre><code>Dim ws As Worksheet\n\nSet ws = Sheets(\"ILS_IMPORT\")\n\nWith ws\n    With Intersect(.Cells(1, 1).CurrentRegion, .Columns(\"A:AI\"))\n        If CBool(Application.CountA(.Offset(1, 0))) Then\n            With .Offset(1, 34).Resize(.Rows.Count - 1, 1)\n                .Cells = Date\n            End With\n        Else\n            MsgBox .Parent.Name &amp; \" columns A:AI are empty\", vbCritical\n        End If\n    End With\nEnd With\n</code></pre>\n\n<p>The primary boundaries of the data is first determined using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow\">Range.CurrentRegion property</a>, then progressive <a href=\"https://msdn.microsoft.com/en-us/library/office/aa176182%28v=office.11%29.aspx\" rel=\"nofollow\">Range.Resize</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840060.aspx\" rel=\"nofollow\">Range.Offset</a> commands shape the range to receive the current date.</p>\n"}], "owner": {"reputation": 139, "user_id": 2942794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z2jmY.jpg?s=128&g=1", "display_name": "T-Rex", "link": "https://stackoverflow.com/users/2942794/t-rex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 30768929, "answer_count": 1, "score": 0, "last_activity_date": 1433978422, "creation_date": 1433974009, "last_edit_date": 1531161705, "question_id": 30768145, "link": "https://stackoverflow.com/questions/30768145/paste-the-current-date-into-a-pre-defined-range-named-within-a-cell", "title": "Paste the current date into a pre-defined range named within a cell", "body": "<p>I have the following formula, <code>=\"AI2:AI\"&amp;MATCH(REPT(\"z\",255),ILS_IMPORT!A:A)</code>, which elicits a pre-defined column <code>AI2:AI3576</code>. In essence, the formula is providing me with the exact last row number in which data resides within column A. However, there may be a case whereby there are blanks in the end of the data set within column A, but in column B data goes down to <code>B4000</code>. The whole premise is to get the last row of data from columns A to AI, so that I can put the current date within the range <code>AI2:AI3576</code> or <code>AI2:AI4000</code> before importing the data set into the access database.  </p>\n\n<p>Two questions (Microsoft Excel 2010):<br>\n1) Does anyone have an easier formula that would capture the aforementioned range?<br>\n2) Once the range has been established, a simple paste of the current date into that predefined range using VBA would be preferred.  I imagine this being very simple since we would have the range and we have the date Now().</p>\n\n<p>As a caveat, I had this VBA code that will tell the user the row number of the last cell, but they would still have to do the copy and paste function. I would rather not have the user do these steps.</p>\n\n<pre><code>Sub LastRowofData()\nDim ws As Worksheet\nDim rng1 As Range\nSet ws = Sheets(\"ILS_IMPORT\")\nSet rng1 = ws.Columns(\"A:AI\").Find(\"*\", ws.[a1], xlValues, , xlByRows, xlPrevious)\nIf Not rng1 Is Nothing Then\n    MsgBox \"The last cell with data is \" &amp; rng1.Address(0) &amp; \" , therefore copy the current date in AG2 down to the row indicated.\"\nElse\n    MsgBox ws.Name &amp; \" columns A:AI are empty\", vbCritical\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Your thoughts and creativity are much appreciated.</p>\n"}, {"tags": ["excel", "vba", "replace", "trim", "spaces"], "comments": [{"owner": {"reputation": 5903, "user_id": 790107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4de1c480ed937e9291c4dcbf252e6d1f?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/790107/david"}, "edited": false, "score": 0, "creation_date": 1433974033, "post_id": 30768072, "comment_id": 49588409, "body": "Do you have to use VBA?  You might get performance improvements by operating on the spreadsheet externally using .Net, Python, Perl, etc."}, {"owner": {"reputation": 115, "user_id": 4985436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2779341c608fd128cf1e7d7be3b1bca?s=128&d=identicon&r=PG&f=1", "display_name": "TylerDurden", "link": "https://stackoverflow.com/users/4985436/tylerdurden"}, "edited": false, "score": 0, "creation_date": 1433974581, "post_id": 30768072, "comment_id": 49588625, "body": "why dont you use the trim function directly on the spreadsheet? should be significantly faster."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4755953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3533e12f3c2e45b7d91754f85e4cd879?s=128&d=identicon&r=PG&f=1", "display_name": "walter&#39;s human", "link": "https://stackoverflow.com/users/4755953/walters-human"}, "edited": false, "score": 0, "creation_date": 1434054433, "post_id": 30768292, "comment_id": 49631072, "body": "Gary - this is great except I was hoping for one that removes all the extra spaces and brings it to a single space. 2 to 1, 3 to 1. Like the trim function within excel."}, {"owner": {"reputation": 83, "user_id": 4755953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3533e12f3c2e45b7d91754f85e4cd879?s=128&d=identicon&r=PG&f=1", "display_name": "walter&#39;s human", "link": "https://stackoverflow.com/users/4755953/walters-human"}, "edited": false, "score": 0, "creation_date": 1434057479, "post_id": 30768292, "comment_id": 49632743, "body": "very nice! could I also use a &quot;do while&quot; to automate?"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1434060047, "post_id": 30768292, "comment_id": 49633758, "body": "Change MsgBox &quot;please run again&quot; to SpaceKiller3 and it will run until there are none."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1434061936, "post_id": 30768292, "comment_id": 49634396, "body": "@DanDonoghue  <b>YOU ARE A GENIUS !</b>  I forgot about doing it recursively!"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1434062673, "post_id": 30768292, "comment_id": 49634648, "body": "It was a quick fix, I would probably go with a Do until r is nothing for a final solution as opposed to self referencing, It&#39;s only personal opinion but I am not a fan of subs calling themselves. Great code BTW Gary&#39;s Student, I didn&#39;t think of using a replace functionality :). Also on a side note, you don&#39;t need &quot;Call&quot; there, just the sub name will suffice :)."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 4, "last_activity_date": 1434062221, "last_edit_date": 1434062221, "creation_date": 1433974758, "answer_id": 30768292, "question_id": 30768072, "link": "https://stackoverflow.com/questions/30768072/faster-way-to-remove-extra-spaces-more-than-1-from-a-large-range-of-cells-us/30768292#30768292", "title": "Faster way to remove &#39;extra&#39; spaces (more than 1) from a large range of cells using VBA for Excel", "body": "<p>The loop is killing you.  This will remove spaces in an entire column in one shot:</p>\n\n<pre><code>Sub SpaceKiller()\n   Worksheets(\"Sheet1\").Columns(\"A\").Replace _\n      What:=\" \", _\n      Replacement:=\"\", _\n      SearchOrder:=xlByColumns, _\n      MatchCase:=True\nEnd Sub\n</code></pre>\n\n<p>Adjust the range to suit.  If you want to remove <strong>double</strong> spaces, then:</p>\n\n<pre><code>Sub SpaceKiller()\n   Worksheets(\"Sheet1\").Columns(\"A\").Replace _\n      What:=\"  \", _\n      Replacement:=\" \", _\n      SearchOrder:=xlByColumns, _\n      MatchCase:=True\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>This version will replace doubles with singles and then check if there are still still doubles left!</p>\n\n<pre><code>Sub SpaceKiller3()\n   Worksheets(\"Sheet1\").Columns(\"A\").Replace _\n      What:=\"  \", _\n      Replacement:=\" \", _\n      SearchOrder:=xlByColumns, _\n      MatchCase:=True\n\n   Set r = Worksheets(\"Sheet1\").Columns(\"A\").Find(What:=\"  \")\n   If r Is Nothing Then\n      MsgBox \"done\"\n   Else\n      MsgBox \"please run again\"\n   End If\nEnd Sub\n</code></pre>\n\n<p>You can re-run until you see <strong><em>done</em></strong></p>\n\n<p><strong>EDIT#2:</strong></p>\n\n<p>based on <strong>Don Donoghue</strong>'s comment, this version will run <em>recursively</em> until all double are converted to singles:</p>\n\n<pre><code>Sub SpaceKiller3()\n   Worksheets(\"Sheet1\").Columns(\"A\").Replace _\n      What:=\"  \", _\n      Replacement:=\" \", _\n      SearchOrder:=xlByColumns, _\n      MatchCase:=True\n\n   Set r = Worksheets(\"Sheet1\").Columns(\"A\").Find(What:=\"  \")\n   If r Is Nothing Then\n      MsgBox \"done\"\n   Else\n      Call SpaceKiller3\n   End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 4755953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3533e12f3c2e45b7d91754f85e4cd879?s=128&d=identicon&r=PG&f=1", "display_name": "walter&#39;s human", "link": "https://stackoverflow.com/users/4755953/walters-human"}, "edited": false, "score": 0, "creation_date": 1434137813, "post_id": 30768300, "comment_id": 49670003, "body": "@dan_Donoghue this actually works when needing to remove all spaces after and the extra spaces in between. also very useful. thanks"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1433974808, "creation_date": 1433974808, "answer_id": 30768300, "question_id": 30768072, "link": "https://stackoverflow.com/questions/30768072/faster-way-to-remove-extra-spaces-more-than-1-from-a-large-range-of-cells-us/30768300#30768300", "title": "Faster way to remove &#39;extra&#39; spaces (more than 1) from a large range of cells using VBA for Excel", "body": "<p>Do you have a spare column next to it?</p>\n\n<pre><code>Range(\"B1:B\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Formula = \"=Trim(A1)\"\nColumns(2).copy\nRange(\"B1\").PasteSpecial xlPasteValues\nColumns(1).delete\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1505477453, "post_id": 43732972, "comment_id": 79441873, "body": "this should be the fastest, but Worksheet.Evaluate is a bit faster than Application.Evaluate <code>rng = rng.Worksheet.Evaluate(&quot;index(trim(&quot; &amp; rng.Address &amp; &quot;),)&quot;)</code>"}, {"owner": {"reputation": 139, "user_id": 5721867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e8f5150855453cc6fc345d4ca3714c?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Manuel Ferreira Benavides", "link": "https://stackoverflow.com/users/5721867/jose-manuel-ferreira-benavides"}, "edited": false, "score": 0, "creation_date": 1596991153, "post_id": 43732972, "comment_id": 111982753, "body": "Would you mind explaining how does evaluate get to iterate or expand upon the multi-cell range?   I suppose it would be part of the internal working of &quot;Evaluate&quot;. Anyway, your answer was a total life saver (which works as plug and play). You could replace the range with active selection and turn in into a button."}], "tags": [], "owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "is_accepted": false, "score": 3, "last_activity_date": 1494860611, "last_edit_date": 1494860611, "creation_date": 1493712138, "answer_id": 43732972, "question_id": 30768072, "link": "https://stackoverflow.com/questions/30768072/faster-way-to-remove-extra-spaces-more-than-1-from-a-large-range-of-cells-us/43732972#43732972", "title": "Faster way to remove &#39;extra&#39; spaces (more than 1) from a large range of cells using VBA for Excel", "body": "<p>I'm usually using <em>Evaluate</em> than loops when it comes on large range. There are so many use of this function, but i won't discuss it further here.</p>\n\n<pre><code>'change the row count as deemed necessary..\nSet rng = Range(\"C1:C\" &amp; Row.Count)\n\n   rng.value = Evaluate(\"IF(\" &amp; rng.Address &amp; \"&lt;&gt;\"\"\"\", _\n               TRIM(\" &amp; rng.Address &amp; \"),\"\"\"\")\")\n\nSet rng = Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 2, "last_activity_date": 1505736307, "creation_date": 1505736307, "answer_id": 46278839, "question_id": 30768072, "link": "https://stackoverflow.com/questions/30768072/faster-way-to-remove-extra-spaces-more-than-1-from-a-large-range-of-cells-us/46278839#46278839", "title": "Faster way to remove &#39;extra&#39; spaces (more than 1) from a large range of cells using VBA for Excel", "body": "<p>It can depend on many things, but in my case fastest was to get all values at once in array:</p>\n\n<pre><code>' Dim range As Range, r As Long, c As Long, a\na = range\nFor r = 1 To UBound(a)\n    For c = 1 To UBound(a, 2)\n        a(r, c) = Trim(a(r, c))\n    Next\nNext\nrange = a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 5156380, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-ijCwuL_0MtI/AAAAAAAAAAI/AAAAAAAAACM/b-_iMqxRTSI/photo.jpg?sz=128", "display_name": "sergio trajano", "link": "https://stackoverflow.com/users/5156380/sergio-trajano"}, "edited": false, "score": 1, "creation_date": 1609784172, "post_id": 58454080, "comment_id": 115925095, "body": "From the VBA Trim() function, I would never guess that the Application.Trim function would work differently. Thank you :)"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1612556095, "post_id": 58454080, "comment_id": 116813256, "body": ":+) for showing a mostly disregarded way @JvdV"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 2, "creation_date": 1614635031, "post_id": 58454080, "comment_id": 117440304, "body": "++ yeah agree with @T.M I rarely see people using this. :)"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 14, "last_activity_date": 1571414135, "last_edit_date": 1571414135, "creation_date": 1571413036, "answer_id": 58454080, "question_id": 30768072, "link": "https://stackoverflow.com/questions/30768072/faster-way-to-remove-extra-spaces-more-than-1-from-a-large-range-of-cells-us/58454080#58454080", "title": "Faster way to remove &#39;extra&#39; spaces (more than 1) from a large range of cells using VBA for Excel", "body": "<p>Late to the party but...</p>\n\n<p>There is no need for iteration through cells/values nor a recursive function to search and replace multiple spaces in a range.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.trim\" rel=\"noreferrer\"><code>Application.Trim</code></a> wil actually take care of multiple spaces between words (and will trim leading/trailing spaces) leaving single spaces in between words intact.</p>\n\n<p>The great thing about it, is that you can feed the function a full range (or array) to do this operation in one sweep!</p>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/jJJ4E.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/jJJ4E.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Test()\n\nDim rng As Range\nSet rng = Sheets(\"Sheet1\").Range(\"A1:A3\")\nrng.Value = Application.Trim(rng)\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7v3Th.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/7v3Th.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>The one thing to take into consideration is that this way you'll overwrite any formulas sitting in your target range with its value. But as per your question, you working with a <code>Range</code> object containing text values. There was just no need for iteration =)</p>\n"}], "owner": {"reputation": 83, "user_id": 4755953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3533e12f3c2e45b7d91754f85e4cd879?s=128&d=identicon&r=PG&f=1", "display_name": "walter&#39;s human", "link": "https://stackoverflow.com/users/4755953/walters-human"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22665, "favorite_count": 2, "accepted_answer_id": 30768292, "answer_count": 5, "score": 4, "last_activity_date": 1574587583, "creation_date": 1433973719, "last_edit_date": 1574587583, "question_id": 30768072, "link": "https://stackoverflow.com/questions/30768072/faster-way-to-remove-extra-spaces-more-than-1-from-a-large-range-of-cells-us", "title": "Faster way to remove &#39;extra&#39; spaces (more than 1) from a large range of cells using VBA for Excel", "body": "<p>How do I remove extra spaces faster, from a large range of cells containing text strings?</p>\n\n<p>Let's say 5000+ cells.</p>\n\n<p>Some ways I have tried include:</p>\n\n<pre><code>For Each c In range\n    c.Value = Trim(c.Value)\nNext c\n</code></pre>\n\n<p>and</p>\n\n<pre><code>For Each c In range\n    c = WorksheetFunction.Trim(c)\nNext c\n</code></pre>\n\n<p>and</p>\n\n<pre><code>For Each c In range\n    c.Value = Replace(c.Value, \"     \", \" \")\nNext c\n</code></pre>\n\n<p>Any ideas for speed improvement?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433975524, "post_id": 30767951, "comment_id": 49588965, "body": "Related (really a duplicate) and asked earlier today.  Take a look: <a href=\"http://stackoverflow.com/questions/30755945/excel-vba-2010-how-to-find-and-highlight-all-occurences-of-multiple-strings-w/30757304#comment49581371_30757304\" title=\"excel vba 2010 how to find and highlight all occurences of multiple strings w\">stackoverflow.com/questions/30755945/&hellip;</a>"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433975603, "post_id": 30767951, "comment_id": 49588981, "body": "Somehow you need to make a list of entries to search through.  The <code>Split</code> based on a string of entries separate by <code>|</code> or something is a good approach.  You can then iterate those with a <code>For Each...</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1433980435, "post_id": 30767951, "comment_id": 49590527, "body": "You don&#39;t really need VBA -- you could do this with conditional formatting.  Put your list of words in a contiguous range, and then use a CF Formula  This would have the advantage of being dynamic, and avoiding the necessity to clear the colors when contents change to something valid."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1433980838, "post_id": 30767951, "comment_id": 49590631, "body": "A better CF formula might be something like <code>=ISNUMBER(MATCH($B3, &lt;range with word list&gt;, 0))</code> or <code>=COUNTIF(&lt;range with word list&gt;, $B3)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1433977949, "creation_date": 1433977949, "answer_id": 30768886, "question_id": 30767951, "link": "https://stackoverflow.com/questions/30767951/excel-vba-highlight-cells-in-range-that-do-not-contain-text-from-a-list-of-words/30768886#30768886", "title": "Excel VBA Highlight Cells in Range that Do Not Contain Text from a List of Words", "body": "<p>One easy way to do this is to create a Dictionary storing the valid values and then checking to see if they're in the Dictionary:</p>\n\n<pre><code>'Requires reference to Microsoft Scripting Runtime.\nSub Orange()\n    Dim temp() As String\n\n    temp = Split(\"Flyer,Bulk Clearance,Eat In Season,Line Drive,Market Special,Push Item,Weekender\", \",\")\n\n    Dim items As New Dictionary, item As Variant\n    For Each item In temp\n        items.Add item, item\n    Next item\n\n    Dim LR As Long, i As Long\n\n    LR = ActiveSheet.Range(\"B\" &amp; Rows.Count).End(xlUp).row\n    For i = 3 To LR\n        With Range(\"B\" &amp; i)\n            If Not items.Exists(.Value) Then .Cells.Interior.ColorIndex = 45\n        End With\n    Next i\n\n    MsgBox \"The orange are not valid values.\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1433986006, "creation_date": 1433986006, "answer_id": 30770058, "question_id": 30767951, "link": "https://stackoverflow.com/questions/30767951/excel-vba-highlight-cells-in-range-that-do-not-contain-text-from-a-list-of-words/30770058#30770058", "title": "Excel VBA Highlight Cells in Range that Do Not Contain Text from a List of Words", "body": "<p>Perhaps this??</p>\n\n<pre><code>Sub HighlightFound()\nDim FoundCell As Range, MyArr As Variant, X As Long, FindRange As Range\nMyArr = Array(\"Flyer\", \"Bulk Clearance\", \"Eat In Season\", \"Line Drive\", \"Market Special\", \"Push Item\", \"Weekender\")\nSet FindRange = Range(\"B3:B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row)\nFor X = LBound(MyArr) To UBound(MyArr)\n    Set FoundCell = FindRange.Find(MyArr(X))\n    Do Until FoundCell Is Nothing\n        If FoundCell.Row &gt; FindRange.FindNext(after:=FoundCell).Row Then\n            Exit Do\n        Else\n            FoundCell.Interior.ColorIndex = 45\n            Set FoundCell = FindRange.FindNext(after:=FoundCell)\n        End If\n    Loop\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5695078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd8863aa1ad9b7a20d8406d15d4fab7f?s=128&d=identicon&r=PG&f=1", "display_name": "Aran Bates", "link": "https://stackoverflow.com/users/5695078/aran-bates"}, "is_accepted": false, "score": 0, "last_activity_date": 1450440705, "creation_date": 1450440705, "answer_id": 34355444, "question_id": 30767951, "link": "https://stackoverflow.com/questions/30767951/excel-vba-highlight-cells-in-range-that-do-not-contain-text-from-a-list-of-words/34355444#34355444", "title": "Excel VBA Highlight Cells in Range that Do Not Contain Text from a List of Words", "body": "<p>Just use conditional formatting rules. \nHome > Conditional formatting > Highlight cell rules > Text that contains</p>\n\n<p>And then just have a rule for each word where you either:\n- manually type the word\n- or use a cell reference and point it to a cell that it should look at</p>\n"}], "owner": {"reputation": 45, "user_id": 4842613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SSydno9E0O0/AAAAAAAAAAI/AAAAAAAABbY/xDgin8ojpAI/photo.jpg?sz=128", "display_name": "Matt Peharda", "link": "https://stackoverflow.com/users/4842613/matt-peharda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2506, "favorite_count": 0, "accepted_answer_id": 30768886, "answer_count": 3, "score": 0, "last_activity_date": 1450440705, "creation_date": 1433973125, "question_id": 30767951, "link": "https://stackoverflow.com/questions/30767951/excel-vba-highlight-cells-in-range-that-do-not-contain-text-from-a-list-of-words", "title": "Excel VBA Highlight Cells in Range that Do Not Contain Text from a List of Words", "body": "<p>I am trying to search column B and highlight all cells that contain text other than the words Flyer, Bulk Clearance, Eat In Season, Line Drive, Market Special, Push Item, and Weekender. I have it starting in the third row on purpose.</p>\n\n<p>The code below works for just one word (Flyer), but I'd like the macro to be able to compare the text in the cell to the list of words mentioned above and highlight if the text differs from what is in the list.</p>\n\n<pre><code>Sub Orange()\nDim LR As Long, i As Long\n\nLR = ActiveSheet.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nFor i = 3 To LR\n    With Range(\"B\" &amp; i)\n        If .Value &lt;&gt; \"Flyer\" Then .Cells.Interior.ColorIndex = 45\n    End With\nNext i\n\nMsgBox \"The orange are not valid values.\"\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 1600, "user_id": 3738061, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nCTsN.jpg?s=128&g=1", "display_name": "JustAPup", "link": "https://stackoverflow.com/users/3738061/justapup"}, "edited": false, "score": 3, "creation_date": 1433972156, "post_id": 30767623, "comment_id": 49587651, "body": "Does the message box show up?"}, {"owner": {"reputation": 35, "user_id": 4996789, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10155785079440121/picture?type=large", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/4996789/tim-swingle"}, "reply_to_user": {"reputation": 1600, "user_id": 3738061, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nCTsN.jpg?s=128&g=1", "display_name": "JustAPup", "link": "https://stackoverflow.com/users/3738061/justapup"}, "edited": false, "score": 0, "creation_date": 1434045208, "post_id": 30767623, "comment_id": 49625550, "body": "@Minh yes the message box appears. but when UserForm1.superbox.Text = &quot;Fill In Supervisor&quot; , and UserForm1.fillbox.Text = &quot;(Fill In Supervisor)&quot; or UserForm1.fillbox.Text = &quot;&quot; the program should exit sub. but it is not. its just continuing as normal."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 4996789, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10155785079440121/picture?type=large", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/4996789/tim-swingle"}, "is_accepted": true, "score": 1, "last_activity_date": 1434045789, "creation_date": 1434045789, "answer_id": 30788205, "question_id": 30767623, "link": "https://stackoverflow.com/questions/30767623/exit-sub-within-nested-if-statements-not-working/30788205#30788205", "title": "Exit Sub within nested if statements not working", "body": "<p>I messed around with it for a while and i came up with: </p>\n\n<pre><code>        'input if supervisor=fill in supervisor missing\n    Dim fis As Boolean\n        fis = False\n\n        If UserForm1.superbox.Text = \"Fill In Supervisor\" Then\n            While Not fis\n                If UserForm1.fillbox.Text = \"(Fill In Supervisor)\" Or UserForm1.fillbox.Text = \"\" Then\n                    MsgBox (\"Please Enter a Fill In Supervisor.\")\n                    Exit Sub\n                ElseIf UserForm1.fillbox.Text &lt;&gt; \"(Fill In Supervisor)\" Or UserForm1.fillbox.Text &lt;&gt; \"\" Then\n                    fis = True\n                End If\n            Wend\n    End If\n</code></pre>\n\n<p>The code works great so far!</p>\n"}], "owner": {"reputation": 35, "user_id": 4996789, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10155785079440121/picture?type=large", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/4996789/tim-swingle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 30788205, "answer_count": 1, "score": 0, "last_activity_date": 1434045789, "creation_date": 1433971710, "last_edit_date": 1433973241, "question_id": 30767623, "link": "https://stackoverflow.com/questions/30767623/exit-sub-within-nested-if-statements-not-working", "title": "Exit Sub within nested if statements not working", "body": "<p>I'm trying to write some VBA code and I have almost everything working pretty well. I just need a little help with a part.</p>\n\n<p>Here is my code: </p>\n\n<pre><code>'input if supervisor=fill in supervisor missing\nIf UserForm1.superbox.Text = \"Fill In Supervisor\" Then\n    If UserForm1.fillbox.Text = \"(Fill In Supervisor)\" or UserForm1.fillbox.Text = \"\" Then\n        MsgBox (\"Please Enter a Fill In Supervisor.\")\n        Exit Sub\n    End If\nEnd If\n</code></pre>\n\n<p>After I run it with those conditions, the <code>Exit Sub</code> fails. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "edited": false, "score": 1, "creation_date": 1433972441, "post_id": 30767607, "comment_id": 49587776, "body": "We are not here to produce code for you. Please post your code and ask specific question on what you do not understand, so we can help you understanding, what you currently do not understand."}, {"owner": {"reputation": 4461, "user_id": 4424957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3oNL.jpg?s=128&g=1", "display_name": "Blackwood", "link": "https://stackoverflow.com/users/4424957/blackwood"}, "edited": false, "score": 0, "creation_date": 1433972447, "post_id": 30767607, "comment_id": 49587782, "body": "Is this a vb.net application (created in Visual Studio) or a vba macro (created in Excel)? They are not the same thing. If it is a vba macro, please edit your question to delete the vb.net tag."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4996239, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3faCWMgpGkY/AAAAAAAAAAI/AAAAAAAAFeI/7PrIslseEfQ/photo.jpg?sz=128", "display_name": "DIPIN VARKEY", "link": "https://stackoverflow.com/users/4996239/dipin-varkey"}, "edited": false, "score": 0, "creation_date": 1433979952, "post_id": 30768702, "comment_id": 49590392, "body": "If result &gt;= &quot;01:00:00&quot; Then       ax = ax + 1                  word4 = word4 &amp; &quot; &quot; &amp; ActiveWorkbook.Sheets(&quot;Sheet4&quot;).Cells(y, 2) &amp; &quot; - &quot; &amp; ActiveWorkbook.Sheets(&quot;Sheet4&quot;).Cells(y, 5)      UserForm1.Label10.Caption = word4 UserForm1.Label11.Caption = ax  here i want to display word4 only when the result is greater than 1hr"}, {"owner": {"reputation": 11, "user_id": 4996239, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3faCWMgpGkY/AAAAAAAAAAI/AAAAAAAAFeI/7PrIslseEfQ/photo.jpg?sz=128", "display_name": "DIPIN VARKEY", "link": "https://stackoverflow.com/users/4996239/dipin-varkey"}, "edited": false, "score": 0, "creation_date": 1433980101, "post_id": 30768702, "comment_id": 49590436, "body": "so can you help me out to make the necessary changes in here"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1433976885, "creation_date": 1433976885, "answer_id": 30768702, "question_id": 30767607, "link": "https://stackoverflow.com/questions/30767607/code-for-time-subtraction/30768702#30768702", "title": "Code for time subtraction", "body": "<p><code>TimeValue()</code> returns a Double and <code>Left()</code> returns a Variant containing a String, so I'm surprised that this works at all.  You should be getting a type mismatch with this: </p>\n\n<pre><code>word5 = Left(ActiveWorkbook.Sheets(\"Sheet4\").Cells(y, 8), 11) - TimeValue(Now)\n</code></pre>\n\n<p>You need to explicitly cast to Date types:</p>\n\n<pre><code>Dim time As Date, result As Date\ntime = CDate(Left(ActiveWorkbook.Sheets(\"Sheet4\").Cells(y, 8), 11))\nresult = time - TimeValue(Now)\nDebug.Print result\n</code></pre>\n\n<p>Note that there's also an error in your If condition - you're performing a text based comparison. Consider the fact that...</p>\n\n<pre><code>Debug.Print \"10:00:00 PM\" &gt; \"11:00:00 AM\"\n</code></pre>\n\n<p>...results in False. You should be doing <em>all</em> date/time comparisons with either Doubles or Dates.</p>\n"}], "owner": {"reputation": 11, "user_id": 4996239, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3faCWMgpGkY/AAAAAAAAAAI/AAAAAAAAFeI/7PrIslseEfQ/photo.jpg?sz=128", "display_name": "DIPIN VARKEY", "link": "https://stackoverflow.com/users/4996239/dipin-varkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1434167993, "creation_date": 1433971651, "last_edit_date": 1434167993, "question_id": 30767607, "link": "https://stackoverflow.com/questions/30767607/code-for-time-subtraction", "title": "Code for time subtraction", "body": "<pre><code>If Left(ActiveWorkbook.Sheets(\"Sheet4\").Cells(y, 8), 11) &gt;= \"12:00:00\" Then\n     word5 = Left(ActiveWorkbook.Sheets(\"Sheet4\").Cells(y, 8), 11) - TimeValue(Now)\n</code></pre>\n\n<p>Here are my codes to subtract current time with Column H cells.\nThe result of this coding is in 0.69694444444444 , How can I get it to be in hours?</p>\n"}, {"tags": ["vba", "excel", "listbox", "multi-select"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4996716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0fe4a677ebd1a81103d341df5800404?s=128&d=identicon&r=PG&f=1", "display_name": "GustaCWB", "link": "https://stackoverflow.com/users/4996716/gustacwb"}, "is_accepted": false, "score": 0, "last_activity_date": 1434042892, "creation_date": 1434042892, "answer_id": 30787303, "question_id": 30767396, "link": "https://stackoverflow.com/questions/30767396/listbox-with-multiselect-property-loses-selected-items/30787303#30787303", "title": "ListBox with multiselect property loses selected items", "body": "<p>I've solved the problem. I was filling the listbox with a pivot table data and when I was changing the pivot fields filter at the any others pivot table, the listbox lost all the selected items.</p>\n\n<p>So, now I'm filling the listbox 'manually', I've made a sheet called \"Filters\" and I've filled a column with all listbox row and it has solved the problem.</p>\n\n<p>Sorry for the bad english.</p>\n"}], "owner": {"reputation": 11, "user_id": 4996716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0fe4a677ebd1a81103d341df5800404?s=128&d=identicon&r=PG&f=1", "display_name": "GustaCWB", "link": "https://stackoverflow.com/users/4996716/gustacwb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 557, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438726228, "creation_date": 1433970710, "last_edit_date": 1531164843, "question_id": 30767396, "link": "https://stackoverflow.com/questions/30767396/listbox-with-multiselect-property-loses-selected-items", "title": "ListBox with multiselect property loses selected items", "body": "<p>I need to change a filter in a PivotTable based on a ListBox with multiselect property = 1 - fmMultiSelectMulti, but when I run my VBA code items that are selected in the ListBox lose the selection.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Private Sub BtnAtualizarLiberty_Click()\n    With Sheets(\"Liberty_Data\").PivotTables(\"DinamicaLiberty1\").PivotFields(\"RSCORE_CGV6\")\n                    .EnableMultiplePageItems = True\n                    For Z = 1 To .PivotItems.Count\n                        .PivotItems(Z).Visible = False\n                        For r = 0 To ListRiscoScoreLiberty.ListCount - 1\n                            If ListRiscoScoreLiberty.Selected(r) = True And ListRiscoScoreLiberty.List(r) = .PivotItems(Z).Value Then\n                                .PivotItems(Z).Visible = True\n                            End If\n                        Next\n                    Next\n                End With\n      End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433975319, "post_id": 30767231, "comment_id": 49588894, "body": "What do you mean by <code>monitor</code>?  What do you expect the output to be?  A result for every 15 minutes?  If so, you will find <a href=\"http://stackoverflow.com/questions/30378085/search-column-a-to-match-a-number-in-column-c-if-true-return-column-b-if-false-r\">this related post helpful</a>."}, {"owner": {"reputation": 381, "user_id": 4403647, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/31dd12cf84be2ee104427942ae91937a?s=128&d=identicon&r=PG&f=1", "display_name": "medo0070", "link": "https://stackoverflow.com/users/4403647/medo0070"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434000708, "post_id": 30767231, "comment_id": 49595658, "body": "I edited the post, by word monitoring i mean getting results from output.  Expected output will &quot;collected data per minutes&quot;. While i am running the program for 60 minutes, i need to get &quot;data per minutes for first 15 minutes of my 60 minutes of running my program&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 4403647, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/31dd12cf84be2ee104427942ae91937a?s=128&d=identicon&r=PG&f=1", "display_name": "medo0070", "link": "https://stackoverflow.com/users/4403647/medo0070"}, "edited": false, "score": 1, "creation_date": 1434002467, "post_id": 30772648, "comment_id": 49596351, "body": "First of all thank you for your unswer. Yes you completely understand the problem. But i have a problem with time, the problem is the time  <b>B2</b> is not fixed to <b>B10000</b> it is variable time and i don&#39;t know its end. It maybe <b>B10000</b> or maybe less or more. The second calculations of time will be from <b>B10000:B10055</b>. Is there any way to get calculate unstable time like this in excel ?"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 381, "user_id": 4403647, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/31dd12cf84be2ee104427942ae91937a?s=128&d=identicon&r=PG&f=1", "display_name": "medo0070", "link": "https://stackoverflow.com/users/4403647/medo0070"}, "edited": false, "score": 2, "creation_date": 1434003175, "post_id": 30772648, "comment_id": 49596689, "body": "@medo0070 - See edited answer. The second interval would still use the same input range, that is what absolute referencing (using <code>$</code>) is for."}, {"owner": {"reputation": 381, "user_id": 4403647, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/31dd12cf84be2ee104427942ae91937a?s=128&d=identicon&r=PG&f=1", "display_name": "medo0070", "link": "https://stackoverflow.com/users/4403647/medo0070"}, "edited": false, "score": 0, "creation_date": 1434008573, "post_id": 30772648, "comment_id": 49599781, "body": "Thank you for your help it is helped me :)"}], "tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": true, "score": 3, "last_activity_date": 1434003116, "last_edit_date": 1434003116, "creation_date": 1434001951, "answer_id": 30772648, "question_id": 30767231, "link": "https://stackoverflow.com/questions/30767231/how-to-calculate-results-and-plot-data-depending-on-results-of-a-specific-column/30772648#30772648", "title": "How to calculate results and plot data depending on results of a specific column in excel?", "body": "<p>While the question is not completely clear/consistent, I understand you want to count the number of data for each of the first 15 intervals</p>\n\n<pre><code>10:00 &lt;= time &lt; 10:01\netc.\n</code></pre>\n\n<p>For the first interval, you can use</p>\n\n<pre><code>=SUMPRODUCT(($B$2:$B$8&gt;=TIME(10;0;0))*($B$2:$B$10000&lt;TIME(10;1;0)))\n</code></pre>\n\n<p>I assume your time data is in <code>B2:B10000</code>.\nYou can expand this range as needed, there is no problem in having an excess range (blank cells will not be counted).\nOr you could use</p>\n\n<pre><code>=SUMPRODUCT(($B:$B&gt;=TIME(10;0;0))*($B:$B&lt;TIME(10;1;0)))\n</code></pre>\n\n<p>You can easily create a column with the start time for each interval, and another column using (a modification of) this formula to for the data count.</p>\n\n<p>Then you would plot the two columns just created.</p>\n"}], "owner": {"reputation": 381, "user_id": 4403647, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/31dd12cf84be2ee104427942ae91937a?s=128&d=identicon&r=PG&f=1", "display_name": "medo0070", "link": "https://stackoverflow.com/users/4403647/medo0070"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 30772648, "answer_count": 1, "score": 1, "last_activity_date": 1434003116, "creation_date": 1433970085, "last_edit_date": 1531161705, "question_id": 30767231, "link": "https://stackoverflow.com/questions/30767231/how-to-calculate-results-and-plot-data-depending-on-results-of-a-specific-column", "title": "How to calculate results and plot data depending on results of a specific column in excel?", "body": "<p>I have a .csv file and it contains thousands of rows. I collected this data file as output of running my program for 60 minutes. This output file contains time column (in forum HH:MM:SS:MS), this time column is recording time for my outputs. I want to get plot of my other columns in my output.csv file according to my time column (taking the results for all columns every 1 minutes).</p>\n\n<p>For example:</p>\n\n<p>I have a row like this: </p>\n\n<pre><code>Data             Time\n-----                 -----\n455              10:00:00\n894              10:00:00 \n785              10:00:00\n898              10:00:01\n789              10:00:01\n748              10:00:02\n248              10:00:02\n788              10:00:02\n148              10:00:02\n742              10:00:02\n...              ...\n266              10:01:00\n...              ...\n</code></pre>\n\n<p>Is there any easy way to plot other columns with rows according to time column (taking the results for all columns every 1 minutes) ?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4871395, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a56479c2b18df6c727f2ceba1f5970e?s=128&d=identicon&r=PG&f=1", "display_name": "99problems", "link": "https://stackoverflow.com/users/4871395/99problems"}, "edited": false, "score": 0, "creation_date": 1433977378, "post_id": 30768390, "comment_id": 49589599, "body": "thanks. But how do i also add if A1 is less than 99 &quot;In progress&quot; and 100 is &quot;completed&quot;?"}, {"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 1, "creation_date": 1434029732, "post_id": 30768390, "comment_id": 49614667, "body": "<code>=IF(A1&lt;=99,&quot;In progress&quot;,&quot;Completed&quot;)</code>"}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 1, "last_activity_date": 1433975255, "creation_date": 1433975255, "answer_id": 30768390, "question_id": 30767230, "link": "https://stackoverflow.com/questions/30767230/when-cell-1-in-column-a-is-at-50-change-cell-2-in-the-b-column-to-in-progress/30768390#30768390", "title": "When cell 1 in Column A is at 50% change cell 2 in the B column to &quot;In Progress&quot;", "body": "<p>Yes. A simple formula will do </p>\n\n<pre><code>=IF(A1=0.5, \"In Progress\", \"\")\n</code></pre>\n\n<p>This assumes that 50% is stored as 0.5.  You can also do <code>&gt;=</code> if that makes more sense.</p>\n"}, {"tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1434027109, "creation_date": 1434027109, "answer_id": 30781333, "question_id": 30767230, "link": "https://stackoverflow.com/questions/30767230/when-cell-1-in-column-a-is-at-50-change-cell-2-in-the-b-column-to-in-progress/30781333#30781333", "title": "When cell 1 in Column A is at 50% change cell 2 in the B column to &quot;In Progress&quot;", "body": "<p>This doesn't require VBA (although I can explain it if you're curious). I reccomend using nested IF formulas for this type of thing. Start with the case that covers others. When the statement is false, instead of giving an answer, you can give another IF statement as an answer.</p>\n\n<pre><code>=IF(A1=100;\"completed\";IF(A1&lt;100;\"In progress\";\"Cannot be superior to 100!\"))\n'IF(A1=100; true ^    ; False ^ starts another IF\n</code></pre>\n\n<p>This way you can add as many as you want! You can add an option to write \"Not started yet\" if it is =0, as you can see I added that it could not be higher than 100 myself. If it isnt =100, and isn't lower, then it must be higher, right? I got it covered. You can also cover for negative numbers, whatever you like! Just add more IF statements.</p>\n"}], "owner": {"reputation": 71, "user_id": 4871395, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a56479c2b18df6c727f2ceba1f5970e?s=128&d=identicon&r=PG&f=1", "display_name": "99problems", "link": "https://stackoverflow.com/users/4871395/99problems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 30781333, "answer_count": 2, "score": 0, "last_activity_date": 1434027109, "creation_date": 1433970084, "last_edit_date": 1531161705, "question_id": 30767230, "link": "https://stackoverflow.com/questions/30767230/when-cell-1-in-column-a-is-at-50-change-cell-2-in-the-b-column-to-in-progress", "title": "When cell 1 in Column A is at 50% change cell 2 in the B column to &quot;In Progress&quot;", "body": "<p>I am trying to find a way to add status to my project automatically. For example, when cell 1 in Column A is at 50% then i would want to change cell 2 in the B column to \"In Progress\". Is this possible in Excel?</p>\n\n<p>please let me know.\nthanks</p>\n"}, {"tags": ["xml", "vba", "excel", "amazon-web-services"], "comments": [{"owner": {"reputation": 12626, "user_id": 1102741, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1fc8cdf0e32ee9142baa67269d426b13?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar", "link": "https://stackoverflow.com/users/1102741/oscar"}, "edited": false, "score": 0, "creation_date": 1433969667, "post_id": 30766931, "comment_id": 49586309, "body": "I don&#39;t know how you do it in VBA, but it&#39;s clear that you need to add the default xmlns namespace to your query to work."}, {"owner": {"reputation": 179, "user_id": 4996595, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d75fac6952cfdd8928302981bf94acb7?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Rohn", "link": "https://stackoverflow.com/users/4996595/sam-rohn"}, "reply_to_user": {"reputation": 12626, "user_id": 1102741, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1fc8cdf0e32ee9142baa67269d426b13?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar", "link": "https://stackoverflow.com/users/1102741/oscar"}, "edited": false, "score": 0, "creation_date": 1433970283, "post_id": 30766931, "comment_id": 49586693, "body": "Thanks for that lead ! I am pretty new to VBA. It would be great if you could elaborate on what you  said, so that I can look up how to get it done in vba."}, {"owner": {"reputation": 179, "user_id": 4996595, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d75fac6952cfdd8928302981bf94acb7?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Rohn", "link": "https://stackoverflow.com/users/4996595/sam-rohn"}, "reply_to_user": {"reputation": 12626, "user_id": 1102741, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1fc8cdf0e32ee9142baa67269d426b13?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar", "link": "https://stackoverflow.com/users/1102741/oscar"}, "edited": false, "score": 0, "creation_date": 1433970636, "post_id": 30766931, "comment_id": 49586857, "body": "Is it like doc .SetProperty &quot;SelectionNamespaces&quot;,&quot;xmlns=&quot;<a href=\"http://webservices.amazon.com/AWSECommerceService/2011-08-01\" rel=\"nofollow noreferrer\">webservices.amazon.com/AWSECom&zwnj;&#8203;merceService/2011-08&zwnj;&#8203;-01</a>&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 1, "last_activity_date": 1433977933, "creation_date": 1433977933, "answer_id": 30768884, "question_id": 30766931, "link": "https://stackoverflow.com/questions/30766931/parsing-xml-response-from-amazon-api-in-excel-vba/30768884#30768884", "title": "Parsing XML response from AMAZON API in Excel VBA", "body": "<p>There's a known issue with how MSXML2 handles default namespaces in XML in XPath queries. If you want to reference a node which is in the default namespace then you have to create a prefix for that namespace and then use that prefix in any XPath query.</p>\n\n<p>So add a namespace definition as follows (I'm using \"r\" as the prefix):</p>\n\n<pre><code>Set doc = New DOMDocument60\ndoc.Load \"C:\\Users\\Sam\\Desktop\\amazon\\offersumm.xml\"\n\ndoc.setProperty \"SelectionNamespaces\", \"xmlns:r='http://webservices.amazon.com/AWSECommerceService/2011-08-01'\"\n\nDim Variables As IXMLDOMNodeList\nDim variable As IXMLDOMNode\nSet Variables = doc.SelectNodes(\"/r:ItemLookupResponse/r:Items\")\n</code></pre>\n\n<p>More details on this issue can be found <a href=\"https://support.microsoft.com/en-us/kb/288147\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 179, "user_id": 4996595, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d75fac6952cfdd8928302981bf94acb7?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Rohn", "link": "https://stackoverflow.com/users/4996595/sam-rohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 888, "favorite_count": 0, "accepted_answer_id": 30768884, "answer_count": 1, "score": 1, "last_activity_date": 1433977933, "creation_date": 1433968959, "question_id": 30766931, "link": "https://stackoverflow.com/questions/30766931/parsing-xml-response-from-amazon-api-in-excel-vba", "title": "Parsing XML response from AMAZON API in Excel VBA", "body": "<p>I am trying to parse data from Amazon Product Advertising API XML response. I am using DOMDocument in excel vba to load the xml document and parse the resposne. This is how the XML response looks like:</p>\n\n<pre><code>&lt;ItemLookupResponse xmlns=\"http://webservices.amazon.com/AWSECommerceService/2011-08-01\"&gt;\n&lt;OperationRequest&gt;\n&lt;HTTPHeaders&gt;...&lt;/HTTPHeaders&gt;\n&lt;RequestId&gt;fd9f1314-29932-45a0-8fc4-c999276425f4&lt;/RequestId&gt;\n&lt;Arguments&gt;...&lt;/Arguments&gt;\n&lt;RequestProcessingTime&gt;0.0265880000000000&lt;/RequestProcessingTime&gt;\n&lt;/OperationRequest&gt;\n&lt;Items&gt;\n&lt;Request&gt;\n&lt;IsValid&gt;True&lt;/IsValid&gt;\n&lt;ItemLookupRequest&gt;\n&lt;IdType&gt;ASIN&lt;/IdType&gt;\n&lt;ItemId&gt;B00CSDILZI&lt;/ItemId&gt;\n&lt;ItemId&gt;B00BSN8DN4&lt;/ItemId&gt;\n&lt;ResponseGroup&gt;Offers&lt;/ResponseGroup&gt;\n&lt;VariationPage&gt;All&lt;/VariationPage&gt;\n&lt;/ItemLookupRequest&gt;\n&lt;/Request&gt;\n&lt;Item&gt;\n&lt;ASIN&gt;B00CSDILZI&lt;/ASIN&gt;\n&lt;OfferSummary&gt;\n&lt;LowestNewPrice&gt;\n&lt;Amount&gt;26761&lt;/Amount&gt;\n&lt;CurrencyCode&gt;USD&lt;/CurrencyCode&gt;\n&lt;FormattedPrice&gt;$267.61&lt;/FormattedPrice&gt;\n&lt;/LowestNewPrice&gt;\n&lt;TotalNew&gt;22&lt;/TotalNew&gt;\n&lt;TotalUsed&gt;0&lt;/TotalUsed&gt;\n&lt;TotalCollectible&gt;0&lt;/TotalCollectible&gt;\n&lt;TotalRefurbished&gt;0&lt;/TotalRefurbished&gt;\n&lt;/OfferSummary&gt;\n&lt;Offers&gt;\n&lt;TotalOffers&gt;1&lt;/TotalOffers&gt;\n&lt;TotalOfferPages&gt;1&lt;/TotalOfferPages&gt;\n&lt;MoreOffersUrl&gt;...&lt;/MoreOffersUrl&gt;\n&lt;Offer&gt;\n&lt;OfferAttributes&gt;...&lt;/OfferAttributes&gt;\n&lt;OfferListing&gt;\n&lt;OfferListingId&gt;...&lt;/OfferListingId&gt;\n&lt;Price&gt;\n&lt;Amount&gt;26761&lt;/Amount&gt;\n&lt;CurrencyCode&gt;USD&lt;/CurrencyCode&gt;\n&lt;FormattedPrice&gt;$267.61&lt;/FormattedPrice&gt;\n&lt;/Price&gt;\n&lt;AmountSaved&gt;\n&lt;Amount&gt;23841&lt;/Amount&gt;\n&lt;CurrencyCode&gt;USD&lt;/CurrencyCode&gt;\n&lt;FormattedPrice&gt;$238.41&lt;/FormattedPrice&gt;\n&lt;/AmountSaved&gt;\n&lt;PercentageSaved&gt;47&lt;/PercentageSaved&gt;\n&lt;Availability&gt;Usually ships in 1-2 business days&lt;/Availability&gt;\n&lt;AvailabilityAttributes&gt;\n&lt;AvailabilityType&gt;now&lt;/AvailabilityType&gt;\n&lt;MinimumHours&gt;24&lt;/MinimumHours&gt;\n&lt;MaximumHours&gt;48&lt;/MaximumHours&gt;\n&lt;/AvailabilityAttributes&gt;\n&lt;IsEligibleForSuperSaverShipping&gt;0&lt;/IsEligibleForSuperSaverShipping&gt;\n&lt;/OfferListing&gt;\n&lt;/Offer&gt;\n&lt;/Offers&gt;\n&lt;/Item&gt;\n&lt;Item&gt;...&lt;/Item&gt;\n&lt;/Items&gt;\n&lt;/ItemLookupResponse&gt;\n</code></pre>\n\n<p>My ultimate aim is to loop through the entire xml and extract item details like ASIN, FormattedPrice, Lowest price etc to a excel sheet.\nBut as a first step when I try to access elements from the XML tree, I am not able to do it sucessfuly. I am using Excel 2013 and have referenced to Micrsoft XML 6.0. This is how I tried:</p>\n\n<pre><code>Public Function xmlparse()\nDim doc As DOMDocument60\nSet doc = New DOMDocument60\ndoc.Load \"C:\\Users\\Sam\\Desktop\\amazon\\offersumm.xml\"\nDim Variables As IXMLDOMNodeList\nDim variable As IXMLDOMNode\nSet Variables = doc.SelectNodes(\"/ItemLookupResponse/Items\")\n\nFor Each variable In Variables\n    Debug.Print variable.SelectNodes(\"Item\").Item(0).Text\n\nNext\nEnd Function\n</code></pre>\n\n<p>But I am stuck at this point as this prints nothing in the console. Can anyone tell me how to access elements like ASIN, Amount from XML.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1433968996, "post_id": 30766726, "comment_id": 49585950, "body": "So all the text boxes should be the same color?  Are they all on the same worksheet?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1433969013, "post_id": 30766726, "comment_id": 49585955, "body": "Are you talking about textboxes on UserForm?"}, {"owner": {"reputation": 63, "user_id": 4642154, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ff60da4b8ac4053f625557903554972b?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWor1d", "link": "https://stackoverflow.com/users/4642154/hellowor1d"}, "edited": false, "score": 0, "creation_date": 1433969589, "post_id": 30766726, "comment_id": 49586271, "body": "Yes, same worksheet, and no they won&#39;t always be the same color. For example, values 10 and 15 will always make the box yellow. However, while one value is 10, another one may be 6 which would be green. (It is active X text box)"}], "answers": [{"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 0, "last_activity_date": 1433973094, "creation_date": 1433973094, "answer_id": 30767947, "question_id": 30766726, "link": "https://stackoverflow.com/questions/30766726/use-one-macro-for-multiple-instances/30767947#30767947", "title": "Use one Macro for multiple instances", "body": "<p>Some piece of your code is wrong. It's <code>Select Case ... End Select</code></p>\n\n<pre><code>Select Case Cells(50, 2).Value\n    Case 1, 6, 11, 16\n        tbxObject.BackColor = RGB(0, 255, 0)\n    Case 5\n        tbxObject.BackColor = RGB(255, 0, 0)\n    Case 0\n        tbxObject.BackColor = RGB(255, 255, 255)\n    Case 10, 15\n        tbxObject.BackColor = RGB(255, 255, 0)\nEnd Select\n</code></pre>\n\n<p>Please, see: <a href=\"https://msdn.microsoft.com/en-us/library/cy37t14y.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Select ... Case statement</a></p>\n\n<p>If some piece of code is used several times, you have to move it into single general soubroutine, which can accept <code>TextBox</code> object as input parameter. </p>\n\n<pre><code>Sub ColorMyTextBox(wsh As Worksheet, sTextBoxName As String)\n   Dim txtObject As OleObject\n\n   Set txtObject = wsh.OleObjects(sTextBoxName)\n   If TypeName(txtObject) &lt;&gt; \"TextBox\" Then Goto Exit_Sub\n\n  'here Select Case statement\n\nExit_Sub:\n\nEnd Sub\n</code></pre>\n\n<p>Got it?</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 4642154, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ff60da4b8ac4053f625557903554972b?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWor1d", "link": "https://stackoverflow.com/users/4642154/hellowor1d"}, "is_accepted": false, "score": 0, "last_activity_date": 1434044897, "creation_date": 1434044897, "answer_id": 30787892, "question_id": 30766726, "link": "https://stackoverflow.com/questions/30766726/use-one-macro-for-multiple-instances/30787892#30787892", "title": "Use one Macro for multiple instances", "body": "<p>Ok, so if I use that, how will I specify the cell numbers to use in the case statements? It won't always be cells(50,2)... And I also get errors when sending the worksheet name</p>\n"}], "owner": {"reputation": 63, "user_id": 4642154, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ff60da4b8ac4053f625557903554972b?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWor1d", "link": "https://stackoverflow.com/users/4642154/hellowor1d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529210171, "creation_date": 1433968231, "last_edit_date": 1529210171, "question_id": 30766726, "link": "https://stackoverflow.com/questions/30766726/use-one-macro-for-multiple-instances", "title": "Use one Macro for multiple instances", "body": "<p>I'm trying to use Excel VBA to control text box background colors depending on the values in certain cells. Each text box corresponds to a different cell with a value in it. I have about 60 text boxes to control and 4 possible colors for each one. Using switch statements, I would basically have to do 4 cases for each of the 60 text boxes... Assuming I use the way I have it set up now as seen below: </p>\n\n<pre><code>Select Case Cells(50, 2).Value\n        Case Is = 1, 6, 11, 16\n            .TextBox13.BackColor = RGB(0, 255, 0)\n        Case Is = 5\n            .TextBox13.BackColor = RGB(255, 0, 0)\n        Case Is = 0\n            .TextBox13.BackColor = RGB(255, 255, 255)\n        Case Is = 10, 15\n            .TextBox13.BackColor = RGB(255, 255, 0)\n    End Select\n</code></pre>\n\n<p>And so on for all 60. However, the value range is always the same, and the colors correspond with the same values for each one. I'm assuming there must be a way to build one module to actually set the colors, and just use switch statements to determine with cell to send to that module?</p>\n\n<p>EDIT: I've attached a screenshot of the workspace so you can see what I'm going for</p>\n\n<p><img src=\"https://i.stack.imgur.com/YKVdB.png\" alt=\"screenshot\"></p>\n"}, {"tags": ["excel", "powerpoint", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1433967854, "post_id": 30766394, "comment_id": 49585220, "body": "are the words Record and safety anywhere else in your code?  You may need to supply a bigger snippet then the single line."}, {"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1433968008, "post_id": 30766394, "comment_id": 49585332, "body": "RECORDS and Safety are not in the code anyplace. That is why it is weird that it gives me those errors. I even looked inside the PPT files that the program opens to see if they have VBA in them looking for something else. The PPT files are empty."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 2, "creation_date": 1433969143, "post_id": 30766394, "comment_id": 49586022, "body": "try surrounding your arg in quotes: RetVal = Shell(&quot;C:\\Program Files\\Microsoft Office\\OFFICE11\\PPTVIEW.EXE  &quot; &amp; Chr(34) &amp; ProgFile &amp; Chr(34), 1)"}, {"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1433970130, "post_id": 30766394, "comment_id": 49586592, "body": "@Sorceri THAT did the trick. Seems to work."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1434027921, "post_id": 30766394, "comment_id": 49613220, "body": "@Sorceri, write that up as an answer so you can get an upvote!"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "edited": false, "score": 0, "creation_date": 1433968265, "post_id": 30766663, "comment_id": 49585507, "body": "&#39;Forklift.ppt&#39; is actually one I JUST made to see if it was an issue with the newer version of PowerPoint. No links in that file at all. It&#39;s pristine. One frame, no links and no code."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1433968030, "creation_date": 1433968030, "answer_id": 30766663, "question_id": 30766394, "link": "https://stackoverflow.com/questions/30766394/excel-vba-wont-open-ppt-files-on-network-drive/30766663#30766663", "title": "Excel VBA won&#39;t open PPT files on network drive", "body": "<p>My guess is that <code>RECORDS</code> and <code>Safety</code> are both some sort of external files that are linked in your <code>Forklift.ppt</code> presentation. PowerPoint is notorious for breaking presentations when things get moved. If there are any links in the PPT, they will need to be updated to point to the new location on your <code>S:</code> drive.</p>\n\n<p>You can automate changing the links by writing some VBA code for it, but if this is a one-time move, it's probably not worth it - just redo them by hand.</p>\n"}, {"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 1, "last_activity_date": 1434029617, "creation_date": 1434029617, "answer_id": 30782318, "question_id": 30766394, "link": "https://stackoverflow.com/questions/30766394/excel-vba-wont-open-ppt-files-on-network-drive/30782318#30782318", "title": "Excel VBA won&#39;t open PPT files on network drive", "body": "<p>try surrounding your arg in quotes: </p>\n\n<pre><code>RetVal = Shell(\"C:\\Program Files\\Microsoft Office\\OFFICE11\\PPTVIEW.EXE \" &amp; Chr(34) &amp; ProgFile &amp; Chr(34), 1) \n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 30782318, "answer_count": 2, "score": 0, "last_activity_date": 1434029617, "creation_date": 1433967160, "last_edit_date": 1531161705, "question_id": 30766394, "link": "https://stackoverflow.com/questions/30766394/excel-vba-wont-open-ppt-files-on-network-drive", "title": "Excel VBA won&#39;t open PPT files on network drive", "body": "<p>I have a very old VBA file that was created by someone else with limited comments to explain it. The file is a training file that asks for names, and then supplies the file names you can view to train in. Variables are passed around from 5 different subroutines. </p>\n\n<pre><code>RetVal = Shell(\"C:\\Program Files\\Microsoft Office\\OFFICE11\\PPTVIEW.EXE  \" &amp; ProgFile, 1)\n</code></pre>\n\n<p>This is the line that opens the PowerPoint 4.0 files from Excel. <code>ProgFile</code> being a passed variable. </p>\n\n<p>My Problem: If I put the files in directory on the <code>C:\\</code> drive (Say <code>C:\\Training\\Forklift.ppt</code>) the file opens fine and the program does what it is supposed to do.</p>\n\n<p>HOWEVER: Putting those same PPT files on my network Drive (<code>S:\\Training\\Forklift.ppt</code>) I get three error messages as pop-ups NOT coded into the program (I suspect System errors). (Path names were changed to show as <code>S:\\</code></p>\n\n<ol>\n<li>PowerPoint Viewer Cannot find the File <code>RECORDS</code></li>\n<li>PowerPoint Viewer Cannot find the File <code>Safety</code></li>\n<li>PowerPoint Viewer Cannot find the File <code>Forklift.ppt</code></li>\n</ol>\n\n<p><code>RECORDS</code> and <code>Safety</code> are NOT files being used by any of the subroutines. Is it because of the <code>Shell</code> Function to open PowerPoint or some other mystical thing I am overlooking? </p>\n\n<p>I am trying to rewrite the Subroutines and this is part of the unchanged code that is giving me issues.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433968024, "post_id": 30766306, "comment_id": 49585341, "body": "You are going to need to make an attempt at some code and post it here.  It is difficult to help since the ways of dealing with duplicates depend on the end goal of the macro.  What is the final purpose of this code?"}, {"owner": {"reputation": 109, "user_id": 2684306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032ca34f1bf2df97a1eefb22b8691648?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi O.", "link": "https://stackoverflow.com/users/2684306/abhi-o"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433968516, "post_id": 30766306, "comment_id": 49585671, "body": "This is to identify suppliers whose terms have actually changed within a certain period. So if the terms changed more than once during that period (lets say 5 times) but ended up with what it was initially then there is effectively no change. I&#39;m basically looking for a way to cycle through a filtered data-set based on unique values in a different column of the data (not the column where the first filter is applied)."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 2684306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032ca34f1bf2df97a1eefb22b8691648?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi O.", "link": "https://stackoverflow.com/users/2684306/abhi-o"}, "edited": false, "score": 0, "creation_date": 1433971380, "post_id": 30767287, "comment_id": 49587235, "body": "Great answer - TY! Appreciate the time and effort greatly. I can&#39;t vote up (not enough rep for me to vote the answer up) but I tried your solution and it worked perfectly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 109, "user_id": 2684306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032ca34f1bf2df97a1eefb22b8691648?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi O.", "link": "https://stackoverflow.com/users/2684306/abhi-o"}, "edited": false, "score": 0, "creation_date": 1433971500, "post_id": 30767287, "comment_id": 49587308, "body": "<a href=\"http://stackoverflow.com/help/someone-answers\">Glad to hear you got sorted out quickly</a>."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433973274, "post_id": 30767287, "comment_id": 49588140, "body": "I hope some poor soul doesn&#39;t come across this and have <code>ChrW(8203)</code> in their data!  <b>1)</b> Might be clearer if you didn&#39;t use <code>vFLTR</code> as a <code>String</code> and <code>Array</code>.  That is assign <code>Split</code> to a new variable.  You could also use <code>Mid(vFLTR, 2, Len(vFLTR)-2)</code> instead of the <code>Left...Right</code> and immediately <code>Split</code> it.  <b>2)</b> Any reason using <code>Subtotal &gt; 1</code> instead of <code>.Columns(5).SpecialCells(xlCellTypeVisible).Count &gt; 1</code>?  There should be at least the header, so this won&#39;t error out.  <b>3)</b> excellent bit of code to get the job done... I was going to recommend a <code>Dictionary</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433973630, "post_id": 30767287, "comment_id": 49588275, "body": "@Byron - a) I usually don&#39;t worry about users having zero-length spaces in their worksheet data b) I tend to reuse vars whenever I can c) good point on the <code>Mid</code>; that would make nesting it into the <code>Split</code> worthwhile d) I actually usually shift down a row to the filtered region when determining visible cells; the use of subtotal was just a hangover from that practise."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433974163, "post_id": 30767287, "comment_id": 49588475, "body": "Makes sense on <code>Subtotal</code> in that case... saves an error you have to trap if nothing is found.  Just now saw the <code>With</code> below that to get past the headers.  I always like <code>Intersect(rng, rng.Offset(1))</code> to get past headers.  I was joking about <code>8203</code>... I had no idea what it was but I guess it <a href=\"http://stackoverflow.com/questions/2973698/whats-html-character-code-8203\">apparently does show up</a>. :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1433970316, "creation_date": 1433970316, "answer_id": 30767287, "question_id": 30766306, "link": "https://stackoverflow.com/questions/30766306/how-to-cycle-through-a-filtered-range-using-another-auto-filter-on-a-different-c/30767287#30767287", "title": "How to cycle through a filtered range using another auto filter on a different column?", "body": "<p>While a Scripting.Dictionary may make locating unique values a bit easier, it only takes a couple lines of extra code to duplicate the dictionary's <code>Exists</code> functionality.</p>\n\n<pre><code>Dim rng As Range, ctv As Range, f As Long, vFLTR As Variant\n\nvFLTR = ChrW(8203)\n\nWith ActiveSheet   'set this worksheet reference properly!\n    If .AutoFilterMode Then .AutoFilterMode = False\n    Set rng = .Cells(1, 1).CurrentRegion\n\n    With rng\n        .AutoFilter Field:=6, Criteria1:=\"&gt;1\"\n        If Application.Subtotal(103, .Columns(5)) &gt; 1 Then\n            With rng.Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count)\n                For Each ctv In .Columns(5).Cells.SpecialCells(xlCellTypeVisible)\n                    If Not CBool(InStr(1, vFLTR, ChrW(8203) &amp; ctv.Value &amp; ChrW(8203), vbTextCompare)) Then\n                        vFLTR = vFLTR &amp; ctv.Value &amp; ChrW(8203)\n                    End If\n                Next ctv\n                vFLTR = Left(vFLTR, Len(vFLTR) - 1): vFLTR = Right(vFLTR, Len(vFLTR) - 1)\n                vFLTR = Split(vFLTR, ChrW(8203))\n            End With\n            For f = LBound(vFLTR) To UBound(vFLTR)\n                .AutoFilter Field:=5, Criteria1:=vFLTR(f)\n                MsgBox \"pause and look\"\n                .AutoFilter Field:=5\n            Next f\n        End If\n        .AutoFilter\n    End With\nEnd With\n</code></pre>\n\n<p>I wrote that while waiting for you to provide the framework that it belongs in but you can certainly see the process of first collecting a unique set of visible values then cycling through them for a additional filtered column.</p>\n"}], "owner": {"reputation": 109, "user_id": 2684306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032ca34f1bf2df97a1eefb22b8691648?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi O.", "link": "https://stackoverflow.com/users/2684306/abhi-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 30767287, "answer_count": 1, "score": 2, "last_activity_date": 1433970316, "creation_date": 1433966881, "last_edit_date": 1433969220, "question_id": 30766306, "link": "https://stackoverflow.com/questions/30766306/how-to-cycle-through-a-filtered-range-using-another-auto-filter-on-a-different-c", "title": "How to cycle through a filtered range using another auto filter on a different column?", "body": "<p>I have a filter applied on column F based on a criteria (>1) <code>rng.AutoFilter Field:=6, Criteria1:=\"&gt;1\"</code> where rng is set for the data via VBA earlier.</p>\n\n<p>Now from the filtered rows I want to apply another filter on Col E (5) and cycle through each of the unique visible values in Col E and perform some comparisons on the data and determine whether to keep it or delete those rows- but I don't know what values would be shown - that depends on the first filter - how do I accomplish this? </p>\n\n<p>Here is the whole code so far:</p>\n\n<pre><code>Sub CashFlowReporting()\n\nDim Dest, Source As Workbook\nDim DestCell As Range\nDim sh, ws, data As Worksheet\nDim x, y, r, c, m, s As Integer\nDim fname, sname, txt As String\nDim starttime, endtime, dtDate As Date\nDim ans As VbMsgBoxResult\nDim rng, rng1 As Range\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nstarttime = Now\nfname = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.xls;*.xlsx;*.xlsm), *.xls;*.xlsx;*.xlsm\", Title:=\"Select the Term Changes Query Results file.\")\nIf fname = False Then Exit Sub\n\nans = MsgBox(\"Is \" &amp; fname &amp; \"the Term Changes Query Results excel file?\", vbYesNo)\n\nIf ans = vbYes Then\n    Workbooks.Open Filename:=fname\nElse\n    MsgBox (\"Please run the cash flow report genrator again and select the query results file.\")\n    Exit Sub\nEnd If\n\nSet Source = ActiveWorkbook\nSet sh = ActiveSheet\n\nsh.Range(\"E:F\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"E1\").Value = \"Number_Site\"\nRange(\"F1\").Value = \"Count Num_Site\"\n\nRange(\"E2\").FormulaR1C1 = \"=RC[-3]&amp;RC[-1]\"\nr = Range(\"A1\").End(xlDown).Row\nRange(\"E2\", Cells(r, \"E\")).FillDown\nColumns(\"E:F\").AutoFit\n\nSet rng = Range(\"A1\")\nSet rng = Range(rng, rng.End(xlToRight))\nSet rng = Range(rng, rng.End(xlDown))\nrng.Name = \"Data\"\n\nRange(\"A2\", Range(\"A2\").End(xlDown)).Name = \"Date\"\nRange(\"E2\", Range(\"E2\").End(xlDown)).Name = \"Num_site\"\n\nsh.Sort.SortFields.Clear\nsh.Sort.SortFields.Add Key:=Range(\"Num_site\") _\n    , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nsh.Sort.SortFields.Add Key:=Range(\"Date\") _\n    , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n\nWith sh.Sort\n    .SetRange Range(\"Data\")\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nRange(\"F2\").Formula = \"=countif($E$2:$E$1000,E2)\"\nRange(\"F2\", Cells(r, \"F\")).FillDown\n\nrng.AutoFilter field:=6, Criteria1:=\"&gt;1\"\nSet rng1 = rng.Rows.SpecialCells(xlCellTypeVisible)\nrng1.Select\n</code></pre>\n\n<p>I would now want to filter based on field 5 but for each unique value within that field (cycle through it - in this case just 2 - could be more)</p>\n\n<p>Here is a link to the screenshot screenshot of the data with the first filter applied on Col F, now I would like to cycle through the 2 unique values (in this case) in Col E based on this filter:</p>\n\n<p><img src=\"https://i.stack.imgur.com/w7oiC.png\" alt=\"data\"></p>\n\n<p>If there is a more elegant solution than filter then I am open to that - I have tried Pivots and advanced filters but could not figure out a solution.</p>\n\n<p>Thanks in advance and all help is appreciated.</p>\n"}, {"tags": ["vba", "catia"], "answers": [{"tags": [], "owner": {"reputation": 1060, "user_id": 615243, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aff09be09611bb9949fb8ac3022e91d0?s=128&d=identicon&r=PG&f=1", "display_name": "Nic", "link": "https://stackoverflow.com/users/615243/nic"}, "is_accepted": false, "score": 0, "last_activity_date": 1439376984, "last_edit_date": 1495535232, "creation_date": 1439376425, "answer_id": 31962985, "question_id": 30765861, "link": "https://stackoverflow.com/questions/30765861/catia-vba-get-catpart-and-catproduct-linked-documents/31962985#31962985", "title": "CATIA VBA, get CATPart and CATProduct linked documents", "body": "<p>A similar question was asked <a href=\"https://stackoverflow.com/questions/22823475/catia-v5-vba-get-catpart-linked-documents\">here</a>: They suggest to use CAIEngine and stiDbItems</p>\n\n<p>Personally, I am using MyProduct.GetMasterShapeRepresentationPathName and it works just fine to get CATPart linked documents.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 3560643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dc03200b72b66e20af86398311d45a0?s=128&d=identicon&r=PG&f=1", "display_name": "Anho", "link": "https://stackoverflow.com/users/3560643/anho"}, "is_accepted": false, "score": 0, "last_activity_date": 1446629372, "creation_date": 1446629372, "answer_id": 33518130, "question_id": 30765861, "link": "https://stackoverflow.com/questions/30765861/catia-vba-get-catpart-and-catproduct-linked-documents/33518130#33518130", "title": "CATIA VBA, get CATPart and CATProduct linked documents", "body": "<p>My answer was for stand alone CATIA as CAI is integrated in CATIA even without installed Smarteam. Therefore try CAIEngine and stiDbItems.</p>\n"}], "owner": {"reputation": 103, "user_id": 4996479, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iVi-U4sgkvQ/AAAAAAAAAAI/AAAAAAAAAFw/yTgpFkWUADQ/photo.jpg?sz=128", "display_name": "JetSonic", "link": "https://stackoverflow.com/users/4996479/jetsonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2170, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446629372, "creation_date": 1433965482, "last_edit_date": 1495539872, "question_id": 30765861, "link": "https://stackoverflow.com/questions/30765861/catia-vba-get-catpart-and-catproduct-linked-documents", "title": "CATIA VBA, get CATPart and CATProduct linked documents", "body": "<p>I need to have access to the list of all the Pointed Documents. (Similar to View-->Edit Links-->Pointed Documents tab)</p>\n\n<p>There exists a solution for CATDrawing but, seems there is no way for parts and products.</p>\n\n<p>Here is similar question:\n<a href=\"https://stackoverflow.com/questions/22823475/catia-v5-vba-get-catpart-linked-documents\">CATIA V5 VBA: get CATPart linked documents</a>\nbut the answer is for \"CATIA SMARTEAM Integration\", but I need it for CATIA V5R20 standalone.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1433967172, "creation_date": 1433967172, "answer_id": 30766399, "question_id": 30765599, "link": "https://stackoverflow.com/questions/30765599/digital-signature-for-excel-macro-to-get-rid-of-macro-security-warnings/30766399#30766399", "title": "Digital signature for Excel macro to get rid of macro security warnings", "body": "<p>It still hinges on the security settings on the computer which is opening the code.  There is an option in there <code>Disable all macros except digitally signed macros</code> which must be selected for the signature to matter.</p>\n\n<p><img src=\"https://i.stack.imgur.com/iGWeh.png\" alt=\"settings\"></p>\n\n<p>My current settings would still prompt for your add-in.</p>\n"}], "owner": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 30766399, "answer_count": 1, "score": 0, "last_activity_date": 1434034398, "creation_date": 1433964621, "last_edit_date": 1434034398, "question_id": 30765599, "link": "https://stackoverflow.com/questions/30765599/digital-signature-for-excel-macro-to-get-rid-of-macro-security-warnings", "title": "Digital signature for Excel macro to get rid of macro security warnings", "body": "<p>We are developing a macro to be used by customer organizations. Is it possible to get rid of the macro security warning messages by signing the macro file with a Digital signature?</p>\n\n<p>We already have a code signing certificate from Comodo but when I opened the signed macro file in another computer (an old mac) it still gave the warnings. Was it because we didn't do something right or because it is not possible to get rid of the warning at all.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433965810, "post_id": 30765791, "comment_id": 49584075, "body": "No, what I have is this <code>Set WB = Workbooks.Open(fileName:=MyFolder &amp; objFile.NameUpdateLinks:=0)</code> which I cannot use because I do not need to search for a file to open since I have already opened the file earlier in the code. Do you know how I can set a name to the opened file? I use the line <code>Workbooks.Open TDS_PATH &amp; TextBox1.Text, ReadOnly:=True</code>   to open my file  @MateJuhasz"}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433966884, "post_id": 30765791, "comment_id": 49584640, "body": "And why you can&#39;t put ` set wb=` to the beginning of the line when you open the file?"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433967168, "post_id": 30765791, "comment_id": 49584793, "body": "There are multiple things opening in the <code>Workbooks.Open</code> line.   It is taking input from a textbox, finding the same file in a folder TDS_PATH and opening it. It comes back with a <i>compile error: Expected end of statement</i> directly after <code>TDS_PATH</code> in attempted line  <code>Set wb = Workbooks.Open TDS_PATH &amp; Textbox1.Text, ReadOnly:=True</code> @MateJuhasz"}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 1, "creation_date": 1433967409, "post_id": 30765791, "comment_id": 49584955, "body": "Yes, if you want to use ` set` you need to put brackets around parameters of ` open`"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433968321, "post_id": 30765791, "comment_id": 49585540, "body": "Ah I see! Thank you! I forgot those parenthesis around it. Final solution was: <code>Set WrkBk = Workbooks.Open(TDS_PATH &amp; TextBox1.Text)</code> and then <code>WrkBk.Close</code> at the end"}], "tags": [], "owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "is_accepted": true, "score": 2, "last_activity_date": 1433967274, "last_edit_date": 1433967274, "creation_date": 1433965229, "answer_id": 30765791, "question_id": 30765575, "link": "https://stackoverflow.com/questions/30765575/vba-activate-open-file/30765791#30765791", "title": "VBA - Activate open file", "body": "<p>You already have the answer in your code:<br>\n<code>set wb=workbooks.open...</code><br>\nand when you don't need it anymore just <code>wb.close</code>. </p>\n\n<p>Another approach could be to loop through all open workbook's and check their names:<br>\n<code>For Each wb In Application.Workbooks<br>\n   If wb.name=textbox1.text Then wb.close<br>\nNext wb</code></p>\n"}], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1801, "favorite_count": 0, "accepted_answer_id": 30765791, "answer_count": 1, "score": 0, "last_activity_date": 1433967274, "creation_date": 1433964518, "question_id": 30765575, "link": "https://stackoverflow.com/questions/30765575/vba-activate-open-file", "title": "VBA - Activate open file", "body": "<p>I have a working macro that loops through folder to open files and get important info from the columns of names \"HOLDER\" and \"CUTTING TOOL\" and printing all the info to one excel document, masterfile. It also prints the file name into column 1 and the name of the \"Tooling Data Sheet\" to column 4.</p>\n\n<p>I am creating a button that runs a search on one file that you can type into a textbox. It works perfectly except it opens a file, reads it, and leaves it open. I want it to close the file but my masterfile is the active sheet. I cannot set the open file as a specific name because it needs to open whatever one file I open, not just one specific file. </p>\n\n<p>Any ideas how to switch the active sheet without a specific name?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\n'Set folder path where the file is located\nConst TDS_PATH = \"C:\\Users\\trembos\\Documents\\TDS\\progress\\\"\n\n'Clear out any info on current page\nSheets(\"Sheet1\").Range(\"A2:D7557\").Clear\n\n'TextBox1.Text = \".xlsx\"\n'TextBox1.Font.Italic = True\n\n'input checking\nIf TextBox1.Text = \"\" Then\n    MsgBox (\"Please enter a file to search for\")\nEnd If\n\n\n'Dim WB As Workbook\n'Set WB = Workbooks.Open(objFile.Name, UpdateLinks:=0)\n'Set ws = WB.ActiveSheet\n\n\n'If the File we are searching for exists in the path\nIf TextBox1.Text &lt;&gt; \"\" Then\n\n    'Disable screen updating for performance/aesthetics\n    Application.ScreenUpdating = False\n\n    'Open the workbook we searched for (ReadOnly)\n    Workbooks.Open TDS_PATH &amp; TextBox1.Text, ReadOnly:=True\n    Set Workbook = ThisWorkbook\n\n    'Copy the range we are interested in\n\n\n\n    Const ROW_HEADER As Long = 10\n\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim MyFolder As String\n    Dim StartSht As Worksheet, ws As Worksheet\n    Dim WB As Workbook\n    Dim i As Integer\n    Dim LastRow As Integer, erow As Integer\n    Dim Height As Integer\n    Dim FinalRow As Long\n    Dim f As String\n    Dim dict As Object\n    Dim hc As Range, hc1 As Range, hc2 As Range, hc3 As Range, hc4 As Range, hc5 As Range, d As Range\n\n    Set StartSht = Workbooks(\"masterfile.xlsm\").Sheets(\"Sheet1\")\n\n    MyFolder = \"C:\\Users\\trembos\\Documents\\TDS\\progress\\\"\n\n    Set hc1 = HeaderCell(StartSht.Range(\"B1\"), \"HOLDER\")\n    Set hc2 = HeaderCell(StartSht.Range(\"C1\"), \"CUTTING TOOL\")\n\n\n    'create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'get the folder object\n    Set objFolder = objFSO.GetFolder(MyFolder)\n\n    i = 2\n\n        'Set WB = Workbooks\n        Set ws = ActiveSheet\n\n        Set hc = HeaderCell(ws.Cells(ROW_HEADER, 1), \"CUTTING TOOL\")\n        If Not hc Is Nothing Then\n\n            Set dict = GetValues(hc.Offset(1, 0), \"SplitMe\")\n            If dict.count &gt; 0 Then\n                Set d = StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0)\n                'add the values to the master list, column 3\n                d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n            End If\n        Else\n            'header not found on source worksheet\n        End If\n'(4)\n        'find HOLDER on the source sheet\n        Set hc3 = HeaderCell(ws.Cells(ROW_HEADER, 1), \"HOLDER\")\n        If Not hc3 Is Nothing Then\n            Set dict = GetValues(hc3.Offset(1, 0))\n            'If InStr(ROW_HEADER, \"HOLDER\") &lt;&gt; \"\" Then\n            If dict.count &gt; 0 Then\n                Set d = StartSht.Cells(Rows.count, hc1.Column).End(xlUp).Offset(1, 0)\n                'add the values to the master list, column 2\n                d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n            End If\n            'End If\n        Else\n            'header not found on source worksheet\n        End If\n\n'(5)\n    With ws\n        'print TDS information\n                'print the file name to Column 1\n                StartSht.Cells(i, 1) = TextBox1.Text\n                StartSht.Range(StartSht.Cells(i, 1), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = TextBox1.Text\n\n                'print TDS name from J1 cell to Column 4\n                'With ws\n                    .Range(\"J1\").Copy StartSht.Cells(i, 4)\n                    .Range(\"J1\").Copy StartSht.Range(StartSht.Cells(i, 4), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 4))\n                'End With\n                i = GetLastRowInSheet(StartSht) + 1\n        'move to next file\n'(6)\n        'close, do not save any changes to the opened files\n        StartSht.d 'SaveChanges:=False\n    End With\n\nEnd If\n\n'(7)\n'turn screen updating back on\nActiveWindow.ScrollRow = 1\n\n    'Re-enable screen updating\n    Application.ScreenUpdating = True\n\n    'Let the user know if the file is not found\nIf TextBox1.Text = \"\" Then\n    MsgBox (\"File not found!\")\nEnd If\n\nEnd Sub\n\n'Private Sub TextBox1_GotFocus()\n'    TextBox1.Text = \"\"\n'    TextBox1.Font.Italic = False\n'End Sub\n\n'(8)\n'get all unique column values starting at cell c\nFunction GetValues(ch As Range, Optional vSplit As Variant) As Object\n    Dim dict As Object\n    Dim rng As Range, c As Range\n    Dim v\n    Dim spl As Variant\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n\n    For Each c In ch.Parent.Range(ch, ch.Parent.Cells(Rows.count, ch.Column).End(xlUp)).Cells\n        v = Trim(c.Value)\n        If Len(v) &gt; 0 And Not dict.exists(v) Then\n\n            'exclude any info after \";\"\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \";\")\n            v = spl(0)\n            End If\n\n            'exclude any info after \",\"\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \",\")\n            v = spl(0)\n            End If\n\n            dict.Add c.Address, v\n        End If\n    Next c\n    Set GetValues = dict\nEnd Function\n\n'(9)\n'find a header on a row: returns Nothing if not found\nFunction HeaderCell(rng As Range, sHeader As String) As Range\n    Dim rv As Range, c As Range\n    For Each c In rng.Parent.Range(rng, rng.Parent.Cells(rng.Row, Columns.count).End(xlToLeft)).Cells\n        'copy cell value if it contains some string \"holder\" or \"cutting tool\"\n        If InStr(c.Value, sHeader) &lt;&gt; 0 Then\n            Set rv = c\n            Exit For\n        End If\n    Next c\n    Set HeaderCell = rv\nEnd Function\n\n'(10)\nFunction GetLastRowInColumn(theWorksheet As Worksheet, col As String)\n    With theWorksheet\n        GetLastRowInColumn = .Range(col &amp; .Rows.count).End(xlUp).Row\n    End With\nEnd Function\n\n\n'(11)\nFunction GetLastRowInSheet(theWorksheet As Worksheet)\nDim ret\n    With theWorksheet\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            ret = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          LookAt:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            ret = 1\n        End If\n    End With\n    GetLastRowInSheet = ret\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1433964589, "post_id": 30765458, "comment_id": 49583430, "body": "There must also be a way to accomplish what I am going for by referring to the ranges where I am searching for part numbers already used without actually extending the selection to the scopes of those ranges."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1524919721, "post_id": 30765458, "comment_id": 87169494, "body": "Offtopic - PatentWookiee, your profile says you work on a &quot;Java app that downloads and annotates patent PDFs&quot;.  Is it a product available for sale, or an in-house tool?"}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1527628201, "post_id": 30765458, "comment_id": 88195305, "body": "Offtopic - cxw, it is an in-house tool in its current form. Would need further development to be a marketable product."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1527630731, "post_id": 30765458, "comment_id": 88196279, "body": "Ah well!  Thanks for letting me know.  Give me a shout IRL sometime if you&#39;d be willing to talk patent tech.  &amp;H101F7, and the first and last initials match - you already know how to find me :) ."}], "answers": [{"tags": [], "owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "is_accepted": true, "score": 6, "last_activity_date": 1433965880, "creation_date": 1433965880, "answer_id": 30765988, "question_id": 30765458, "link": "https://stackoverflow.com/questions/30765458/need-to-capture-current-scroll-position-not-cursor-position-in-ms-word/30765988#30765988", "title": "Need to capture current scroll position (not cursor position) in MS Word", "body": "<p>To capture the window scroll position use:</p>\n\n<pre><code>scrollPosition = ActiveWindow.ActivePane.VerticalPercentScrolled\n</code></pre>\n\n<p>To set it back to the original use:</p>\n\n<pre><code>ActiveWindow.ActivePane.VerticalPercentScrolled = scrollPosition\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3002, "favorite_count": 1, "accepted_answer_id": 30765988, "answer_count": 1, "score": 2, "last_activity_date": 1434008391, "creation_date": 1433964138, "last_edit_date": 1434008391, "question_id": 30765458, "link": "https://stackoverflow.com/questions/30765458/need-to-capture-current-scroll-position-not-cursor-position-in-ms-word", "title": "Need to capture current scroll position (not cursor position) in MS Word", "body": "<p>I need to get the current scroll position (I think that is the right term; i.e., where is my virtual lens pointed at the document, not where my cursor is) in a Word document, so that when I run a macro I can return to that position at the end.  </p>\n\n<p>I wrote a macro that searches backward from the current cursor position for patent application part numbers, determines a candidate next available part number as the previous max + 1, then searches a sorted list of numbers appearing below the cursor to see if the candidate part number collides with the next used number, and if it does, it adds 1 to the candidate and checks for a collision again, until it finds the smallest unused integer, to follow as closely as possible the convention of introducing parts in the body of the description sequentially by part number.                                         </p>\n\n<p>Then it inserts that number at the current cursor position.  It works fine; however, it moves the current line to the top of the viewing window, which is disorienting.  I would rather keep the scroll where it is.  Here is my code:</p>\n\n<pre><code>Sub InsertLocalNextPartNum()\n\nApplication.ScreenUpdating = False\n\nDim re As VBScript_RegExp_55.RegExp\nSet re = New VBScript_RegExp_55.RegExp\n\n\nre.pattern = \"\\b(\\d{2,3}\\b)\"\n</code></pre>\n\n<p>' 2-3 digit numbers are a bit over-inclusive for a part number, but for purposes of my question we don't need the full regular expression</p>\n\n<pre><code>re.IgnoreCase = False\nre.Global = True\n\nDim txt As String\nDim allLongMatches As MatchCollection, m As Match\nDim nums() As Long\nDim numsColl As New Collection\nDim maxNum As Long\nmaxNum = 0\nDim nextPartNum As String\nDim localNextPartNum As String\nlocalNextPartNum = 0\nDim i As Long\nDim j As Long\nDim k As Long\n\n\nSelection.HomeKey Unit:=wdStory, Extend:=wdExtend\n\ntxt = Selection.Range.text\n\nIf re.Test(txt) Then\n        Set allLongMatches = re.Execute(txt)\n         For Each m In allLongMatches\n\n         numsColl.Add (m.Value)\n\n         Next m\nEnd If\nReDim nums(1 To numsColl.Count)\n\nFor i = 1 To numsColl.Count\n    nums(i) = numsColl(i)\n    If nums(i) &gt; maxNum Then maxNum = nums(i)\nNext i\n\nlocalNextPartNum = maxNum + 1\n\n\nSelection.MoveRight\nSelection.EndKey Unit:=wdStory, Extend:=wdExtend\ntxt = Selection.text\n\nIf re.Test(txt) Then\n        Set allLongMatches = re.Execute(txt)\n        For Each m In allLongMatches\n         numsColl.Add (m.Value)\n        Next m\nEnd If\n\nReDim nums(1 To numsColl.Count)\nDim numTemp As String\nDim lngMin As Long\nDim lngMax As Long\nlngMin = LBound(nums())\nlngMax = UBound(nums())\n\nFor i = 1 To numsColl.Count\n    nums(i) = numsColl(i)\nNext i\n\nFor j = lngMin To lngMax - 1\n    For k = j + 1 To lngMax\n      If nums(j) &gt; nums(k) Then\n        numTemp = nums(j)\n        nums(j) = nums(k)\n        nums(k) = numTemp\n      End If\n    Next k\nNext j\n\nFor i = 1 To numsColl.Count\n    If localNextPartNum &lt; nums(i) Then Exit For\n   ' Debug.Print nums(i)\n    If localNextPartNum = nums(i) Then localNextPartNum = nums(i) + 1\nNext i\nSelection.MoveLeft\nSelection.InsertAfter (localNextPartNum &amp; \" \")\nSelection.MoveRight\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1433964043, "post_id": 30765118, "comment_id": 49583156, "body": "Typo - lngcounterinitiatve."}], "answers": [{"tags": [], "owner": {"reputation": 428, "user_id": 4638416, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a24776e12d0c00debee804f888f67bbb?s=128&d=identicon&r=PG", "display_name": "coder231", "link": "https://stackoverflow.com/users/4638416/coder231"}, "is_accepted": false, "score": 1, "last_activity_date": 1433964207, "creation_date": 1433964207, "answer_id": 30765482, "question_id": 30765118, "link": "https://stackoverflow.com/questions/30765118/invalid-next-control-variable-reference-error-in-excel-vba/30765482#30765482", "title": "&quot;Invalid Next Control Variable reference&quot; Error in excel vba", "body": "<p>lngcounterinitiative is spelled wrong in \"Next lngcounterinitiatve\".Try changing that.</p>\n"}], "owner": {"reputation": 381, "user_id": 1555174, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cc30edd7d7e80f910da43e03eef38e5f?s=128&d=identicon&r=PG", "display_name": "shiven", "link": "https://stackoverflow.com/users/1555174/shiven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433964207, "creation_date": 1433963055, "question_id": 30765118, "link": "https://stackoverflow.com/questions/30765118/invalid-next-control-variable-reference-error-in-excel-vba", "title": "&quot;Invalid Next Control Variable reference&quot; Error in excel vba", "body": "<p>I am trying to write a simple code that filters out data based on some condition.</p>\n\n<p>My code is below : </p>\n\n<pre><code>Public Function fGetUniqInitiative(Optional ByVal uniqInitiative As Variant, Optional ByVal filter1 As Variant, Optional ByVal filter2 As Variant, Optional ByVal filter3 As Variant, Optional ByVal vartempData As Variant) As Variant()\n\nDim lngcounterinitiatve As Long\nDim lngVarData As Long\nDim lngfilter1 As Long\nDim lngfilter2 As Long\nDim lngfilter3 As Long\nDim boolfilter1 As Boolean\nDim boolfilter2 As Boolean\nDim boolfilter3 As Boolean\nDim varUniqueList() As Variant\nDim lnguniqueinitcount As Long\nlnguniqueinitcount = 0\n\nFor lngcounterinitiative = LBound(uniqInitiative) To UBound(uniqInitiative)\n    boolfilter1 = False\n    boolfilter2 = False\n    boolfilter3 = False\n\n    For lngVarData = LBound(vartempData) To UBound(vartempData)\n\n        If uniqInitiative(lngcounterinitiative) = vartempData(lngVarData, 2) Then\n\n            For lngfilter1 = LBound(filter1) To UBound(filter1)\n                 If vartempData(lngVarData, 9) = filter1(lngfilter1) Then\n                 boolfilter1 = True\n                 Exit For\n                 End If\n            Next lngfilter1\n\n            For lngfilter2 = LBound(filter2) To UBound(filter2)\n                If vartempData(lngVarData, 10) = filter2(lngfilter2) Then\n                boolfilter2 = True\n                Exit For\n                End If\n            Next lngfilter2\n\n            For lngfilter3 = LBound(filter3) To UBound(filter3)\n                If vartempData(lngVarData, 11) = filter3(lngfilter3) Then\n                boolfilter3 = True\n                Exit For\n                End If\n            Next lngfilter3\n\n            If boolfilter1 = True Or boolfilter2 = True Or boolfilter3 = True Then\n            Exit For\n            Else\n            lnguniqueinitcount = lnguniqueinitcount + 1\n            ReDim varUniqueList(1 To lnguniqueinitcount)\n            End If\n\n        End If\n\n        Next lngVarData\n\nNext lngcounterinitiatve\n\nfGetUniqInitiative = varUniqueList\n\nEnd Function\n</code></pre>\n\n<p>However, when i try to compile the code it gives the error \"Invalid Next Control Variable reference\". I have googled it quite a bit and all the solutions say that i must be missing closing the loop which i don't think is the case in my code. Anyone could point what am i missing?</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 2, "creation_date": 1433964220, "post_id": 30764913, "comment_id": 49583249, "body": "Please provide the code you&#39;ve tried and the exact problem that you are having.  This isn&#39;t somewhere to get someone else to write code for you, but there are plenty of people who would be glad to help you troubleshoot the issues you are having while coding."}, {"owner": {"reputation": 1, "user_id": 4996233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cddc58254edfa7ec41abd3c6dbe6320f?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gerard-Little", "link": "https://stackoverflow.com/users/4996233/cory-gerard-little"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1433968657, "post_id": 30764913, "comment_id": 49585752, "body": "I added the code above; don&#39;t laugh. I have no doubt it contains redundancies and longer-than-necessary sections. My main problems at this point are the following:  How do I reference/save previously selected cell values for use later in the code? See notes above.  Is it possible for this macro to paste the clipboard contents into a &quot;Find/Replace&quot; search?   How/where would I enable the loop function I describe?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1433968764, "post_id": 30764913, "comment_id": 49585819, "body": "Edit the problems into the question.  They didn&#39;t show up in the comment."}], "answers": [{"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1433969634, "creation_date": 1433969634, "answer_id": 30767113, "question_id": 30764913, "link": "https://stackoverflow.com/questions/30764913/inserting-searching-copying-pasting-across-2-spreadsheets-in-excel/30767113#30767113", "title": "Inserting, searching, copying, pasting across 2 spreadsheets in Excel", "body": "<p>The first problems that I see are:</p>\n\n<p>1)  You don't put functions in the middle of sub routines.  If you want a function, you put it on its own as such:</p>\n\n<pre><code> Sub MySub()\n      'Do Stuff\n      x = myFunction()\n      debug.print x\n End Sub\n\n Function MyFunction() As String\n      'Do Stuff\n      MyFunction = \"Test\"\n End Function\n</code></pre>\n\n<p>2) The code you have provided won't compile for reason 1 and also because you have ended the Sub with \"End Function\" instead of End Sub.  Try running the code and you will get error messages.  Then you can research the error message and try to fix it.  Further, if you don't get error messages, you can step through the code to make sure it is working the way you intend it to.</p>\n\n<p>3)  The very first line isn't going to work.  You need to use the ENTIRE path of the file, even if it is in the same folder as the file you currently have open.  There are ways to get the directory of the file you currently have open (google will surely show you many of them), and you could just append the filename to the directory of the file you have open.</p>\n\n<p>4)  You want a loop, but you haven't put in any looping structions.  Google \"Excel VBA loop through cells\" and you can find many examples to use.</p>\n\n<p>5)  I think the biggest issue that you are having is that you are overwhelmed because you are trying to do everything all at once.  I would suggest solving one problem at a time and then putting the code together.  For instance, you want to open two files.  Start by writing code just to open one file.  Then try to get a value out of the file into the open workbook.  Then open another file.  Then get data out of that file.  Then test looping through cells in the current workbook and checking for desired criteria and pasting the results if they match.  Then combine all of these things into coherent code.  </p>\n\n<p>Nobody writes efficient code the first time they try, so even if you end up with really long code that isn't efficient, you'll learn a lot and have something.  Even experienced programmers can get stuck or write code that doesn't work the first or even tenth time.  If you get stuck, ask a specific question about a specific error message or specific issue that you can't resolve.</p>\n"}], "owner": {"reputation": 1, "user_id": 4996233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cddc58254edfa7ec41abd3c6dbe6320f?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gerard-Little", "link": "https://stackoverflow.com/users/4996233/cory-gerard-little"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1436195702, "creation_date": 1433962361, "last_edit_date": 1436195702, "question_id": 30764913, "link": "https://stackoverflow.com/questions/30764913/inserting-searching-copying-pasting-across-2-spreadsheets-in-excel", "title": "Inserting, searching, copying, pasting across 2 spreadsheets in Excel", "body": "<p>I thought I'd be able to figure this out based off an analysis of similar code we had written for something else, but code isn't my forte. </p>\n\n<p>Diving into VBA without guidance has proved to be too daunting for me to proceed. </p>\n\n<p>Forgive my terminology if I use the wrong language, I'm happy to learn and be corrected. </p>\n\n<p>This shouldn't be difficult for someone that knows what they're doing, I just don't at all.</p>\n\n<p>I'm trying to create a macro enabled workbook that does the following:</p>\n\n<ul>\n<li><p>Open \"Data.csv\" from a folder called \"Data\" in the same directory as the macro. We'll call this workbook A - wbA.</p></li>\n<li><p>Insert a column on wbA after Column C titled \"Group Image Name.\" This Column D is where we want data to end up.</p></li>\n<li><p>Open \"Groups.csv\" from a folder called \"Groups\" in the same directory as the macro. We'll call this workbook B - wkB.</p></li>\n</ul>\n\n<p>(This next part needs to be a loop that starts at C1 on wbA and proceeds down the column until the end of the spreadsheet)</p>\n\n<ul>\n<li>Copy value from selected cell in Column C  on wbA </li>\n<li>Search Column C on wbB for copied value. When found, move selection over to corresponding cell in Column A. (If C2, then A2)</li>\n<li>Copy contents of the column A value from wbB to column D cell on wbA that corresponds to the original starting point on wbA. </li>\n</ul>\n\n<p>Basically in plain language: Search for Column C contents from wbA on Column C of wbB. When found, move to Column A of same cell # on wbB, copy contents, and paste into cell # of Column D on wbA that corresponds to cell # of starting point from Column C.</p>\n\n<p>I hope that's clear; please feel free to ask for more details if necessary. Thanks for anyone's help in advance!</p>\n\n<p>Here is my terrible code I'm working with at the moment:</p>\n\n<pre><code>    Sub OpenDataAddGroupImageTitleColumn()\n\nChDir \"C:\\[RealCodeHasCorrectFilepath..]\\Desktop\\TEST\"\nWorkbooks.Open Filename:=\"C:\\[RealCodeHasCorrectFilepath..]\\Desktop\\TEST\\DATA.csv\"\nColumns(\"D:D\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nCells.Select\nCells.EntireColumn.AutoFit\nRange(\"D1\").Select\nActiveCell.FormulaR1C1 = \"Group Image Title\"\nRange(\"C2\").Select\n'Variables for storing Row, Column Location, and Value here\nDim GROUPNAME As String\nDim RowLocationX As Long\nDim ColumnLocationZ As Integer\nGROUPNAME = ActiveCell.Value\nRowLocationX = ActiveCell.Row\nColumnLocationZ = ActiveCell.Column\nWorkbooks.Open Filename:=\"C:\\[RealCodeHasCorrectFilepath..]\\Desktop\\GROUPS.csv\"\nColumns(\"C:C\").Select\nSelection.Find(What:=\"GROUPNAME\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n    False, SearchFormat:=False).Activate\nEnd Sub\n</code></pre>\n\n<p>The current snag I can't figure out after much googling is this: Is it possible to search for my variable GROUPNAME using the Find/Replace feature? Or should I be taking a different approach using something involving copying to clipboard?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1433962553, "post_id": 30764899, "comment_id": 49582309, "body": "Before the current date, after the current date or absolute closest? Are the dates sorted?"}], "answers": [{"tags": [], "owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "is_accepted": false, "score": 0, "last_activity_date": 1433962640, "creation_date": 1433962640, "answer_id": 30764985, "question_id": 30764899, "link": "https://stackoverflow.com/questions/30764899/find-closest-date-to-current-date-in-vba/30764985#30764985", "title": "Find closest date to current date in VBA", "body": "<p>You will have to loop and evaluate every other date in the column (since the closets date might be in the farthest cell). Assuming that you have two dates in the column that are equally \"close\", you could then pick the nearest one (cell-wise).</p>\n\n<p>There is no way to do this with the <code>Find</code> method. You'll have to create loop through each cell in the column.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 4996307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f5af6e4c12f024d60518cf5718e40d?s=128&d=identicon&r=PG&f=1", "display_name": "jslice25", "link": "https://stackoverflow.com/users/4996307/jslice25"}, "edited": false, "score": 0, "creation_date": 1449792832, "post_id": 30765690, "comment_id": 56172758, "body": "This worked great for the first sheet in the workbook, but when I added a sheet and needed to perform the same search it gave me an error at the &quot;b.Select&quot; part towards the end. I thought ActiveSheet at the beginning would allow me to use the code throughout the workbook, but there seems to be a problem extending it to other sheets beyond the initial one. Any suggestions?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 15, "user_id": 4996307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f5af6e4c12f024d60518cf5718e40d?s=128&d=identicon&r=PG&f=1", "display_name": "jslice25", "link": "https://stackoverflow.com/users/4996307/jslice25"}, "edited": false, "score": 0, "creation_date": 1449794552, "post_id": 30765690, "comment_id": 56173316, "body": "You would need some sort of loop outside the <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a>. Something like <code>for w = 1 to sheets.count</code> then <code>with worksheets(w)</code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1433964906, "creation_date": 1433964906, "answer_id": 30765690, "question_id": 30764899, "link": "https://stackoverflow.com/questions/30764899/find-closest-date-to-current-date-in-vba/30765690#30765690", "title": "Find closest date to current date in VBA", "body": "<p>Rather than looping through a progressive series of additions and subtractions to the current date, a short sub section of your procedure can determine the date that you are looking for.</p>\n\n<pre><code>Sub nearest_date()\n    Dim b As Range, lr As Long, iMaxDiff As Long, d As Long, fndDate\n\n    With ActiveSheet  'set this worksheet properly!\n        With .Range(.Cells(6, 2), .Cells(Rows.Count, 2).End(xlUp))\n            iMaxDiff = Application.Min(Abs(Application.Max(.Cells) - Date), Abs(Date - Application.Min(.Cells)))\n            For d = 0 To iMaxDiff\n                If CBool(Application.CountIf(.Cells, Date + d)) Then\n                    fndDate = Date + d\n                    Exit For\n                ElseIf CBool(Application.CountIf(.Cells, Date - d)) Then\n                    fndDate = Date - d\n                    Exit For\n                End If\n            Next d\n            Set b = .Find(What:=fndDate, After:=Range(\"B6\"), LookIn:=xlFormulas, _\n                          LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                          MatchCase:=False, SearchFormat:=False)\n\n            'do something with the closest date. I do NOT recommend using .Select for anything beyond demonstration purposes\n            b.Select\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>This is a passive way to determine the closest date. Once found, we know it is there and questionable coding practices like <code>On Error Resume Next</code> can be avoided. TBH, once you <em>know</em> is it there, an <code>application.Match</code> could locate it just as easily.</p>\n"}], "owner": {"reputation": 15, "user_id": 4996307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f5af6e4c12f024d60518cf5718e40d?s=128&d=identicon&r=PG&f=1", "display_name": "jslice25", "link": "https://stackoverflow.com/users/4996307/jslice25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4000, "favorite_count": 0, "accepted_answer_id": 30765690, "answer_count": 2, "score": 0, "last_activity_date": 1433964906, "creation_date": 1433962323, "question_id": 30764899, "link": "https://stackoverflow.com/questions/30764899/find-closest-date-to-current-date-in-vba", "title": "Find closest date to current date in VBA", "body": "<p>I am trying to create a macro that activates the first cell that is the current date or closest to it in a column.</p>\n\n<p>I tried this:</p>\n\n<pre><code>Cells.Find(What:=Date, After:=Range(\"B6\"), LookIn:=xlFormulas, _\n    LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate\n</code></pre>\n\n<p>Which works only if the current date is somewhere in the column, but if it is not then I get an error. How do I modify it to keep searching until it find the closest date to the current date?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013", "datasheet"], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1433964687, "creation_date": 1433964687, "answer_id": 30765611, "question_id": 30764789, "link": "https://stackoverflow.com/questions/30764789/ms-access-programmatically-edit-a-datasheet-cell-value/30765611#30765611", "title": "MS Access programmatically edit a datasheet cell value", "body": "<p>The code runs the following statement when <code>Me.ABC</code> is Null ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.ABC= \" \" + Me.ABC\n</code></pre>\n\n<p>My impression is you expect that statement to store a space in <code>Me.ABC</code>, but it actually stores Null.</p>\n\n<p>The reason is that adding Null to something gives you Null.  It doesn't matter whether <em>something</em> is a number or a text string; <strong>adding</strong> Null still gives you Null.</p>\n\n<p>However if you <strong>concatenate</strong> (with the <code>&amp;</code> operator) Null with a text string, you get the text string back.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.ABC= \" \" &amp; Me.ABC\n</code></pre>\n\n<p>But since you know <code>Me.ABC</code> is Null at that time, there is not really any benefit from concatenation.  Assign just the space character ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.ABC = \" \"\n</code></pre>\n"}], "owner": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 0, "accepted_answer_id": 30765611, "answer_count": 1, "score": 2, "last_activity_date": 1433964707, "creation_date": 1433961954, "last_edit_date": 1433964707, "question_id": 30764789, "link": "https://stackoverflow.com/questions/30764789/ms-access-programmatically-edit-a-datasheet-cell-value", "title": "MS Access programmatically edit a datasheet cell value", "body": "<p>I'm validating my datasheet  programmatically because it's not possible to do it the \"normal\" way (linked tables). The \"normal\" way to tell the user they entered a badness is to punish them with MsgBox popups - I want to display a message in a label on my form (this works) and change the background color of the offending cell. I can only change cell colors through Conditional Formatting (this works), so I set up some rules to highlight cells with leading spaces.</p>\n\n<p>So now the last piece of the puzzle is to change the value of offending cells with a leading space so it gets highlighted via Conditional Formatting. But that part isn't working. When I change the value of the cell, nothing happens. I feel as if my datasheet needs to be told to update itself with my new values.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\n    Dim isValid As Boolean\n    isValid = myDataSheetRow_IsValid()\n    ' if the page is valid, don't cancel the update\n    Cancel = Not isValid\nEnd Sub\n\nPrivate Function myDataSheetRow_IsValid() As Boolean\n    ' validate our data as it cannot be validated in the GUI due to the way linked tables work\n    myDataSheetRow_IsValid = True\n    Dim myErrMsg As String\n    myErrMsg = \"\"\n\n    'evaluate my column called ABC\n    If (IsNull(Me.ABC)) Then\n        myErrMsg = myErrMsg + \"ABC cannot be blank\" + vbNewLine\n\n        '---------------------\n        'PROBLEM START\n        '---------------------\n        'Set the cell value to what it was plus a leading space\n        'Because I have set up conditional formatting on the datasheet\n        'So that leading spaces highlights the cell for attention\n\n        Me.ABC= \" \" + Me.ABC 'trigger conditional formatting ??\n        '---------------------\n        'PROBLEM END\n        '---------------------\n    End If\n    ' ... more validating ...\n    ' done validating\n    Call Me.Parent.UpdateErrorMsgArea(myErrMsg)\n    If (Len(myErrMsg) &gt; 1) Then\n        myDataSheetRow_IsValid= False\n    End If\nEnd Function\n</code></pre>\n\n<p><strong>How do I set the value of a datasheet cell programmatically?</strong> </p>\n\n<p>I've tried it this way and it's not working - nothing is changed on the datasheet, it's as if the datasheet isn't updating itself to display my new programmatically changed value.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 202, "user_id": 4979789, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/064fbb3d6fc8c5a4d3fe3577be4ffc8e?s=128&d=identicon&r=PG&f=1", "display_name": "ZealousHypocrites", "link": "https://stackoverflow.com/users/4979789/zealoushypocrites"}, "edited": false, "score": 0, "creation_date": 1433974379, "post_id": 30766351, "comment_id": 49588550, "body": "Byron: I just read this post and I am very exciting to begin testing it right now. I will report back/edit this post with results. :) Also yes column Q only contains a number that needs to be increased/decreased."}, {"owner": {"reputation": 202, "user_id": 4979789, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/064fbb3d6fc8c5a4d3fe3577be4ffc8e?s=128&d=identicon&r=PG&f=1", "display_name": "ZealousHypocrites", "link": "https://stackoverflow.com/users/4979789/zealoushypocrites"}, "edited": false, "score": 0, "creation_date": 1433975524, "post_id": 30766351, "comment_id": 49588966, "body": "Well there is a time limit on edits it seems but oh well...  ...it works perfectly! Thank you SO much I would never be able to piece this together on my own that code is a whole other language to me! (Well, it obviously literally is, but you get the point.)"}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1433967001, "creation_date": 1433967001, "answer_id": 30766351, "question_id": 30764752, "link": "https://stackoverflow.com/questions/30764752/change-value-in-adjacent-cell-via-click-vba-right/30766351#30766351", "title": "Change Value in Adjacent Cell Via Click (VBA right?)", "body": "<p>I think I understand your question, if this doesn't do it, please add a picture and we'll get there.</p>\n\n<p>Changing the <code>Value</code> based on <code>Value</code> is straightforward.</p>\n\n<p><strong>Code</strong> shows how to handle clicks (or arrow movements) into columns <code>P</code> or <code>R</code>.  Going into <code>P</code> will decrease the value (with the wraparound like you mention).  Going into <code>R</code> will go up.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n  Application.EnableEvents = False\n  If Target.Cells.Count = 1 Then\n    If Not Intersect(Target, Range(\"P3:P500\")) Is Nothing Then\n\n        If Target.Offset(0, 1).Value &gt; 0.5 Then\n            Target.Offset(0, 1).Value = Target.Offset(0, 1).Value - 0.1\n        Else\n            Target.Offset(0, 1).Value = 1.5\n        End If\n\n        Target.Offset(0, 1).Select\n    End If\n\n    If Not Intersect(Target, Range(\"R3:R500\")) Is Nothing Then\n\n        If Target.Offset(0, -1).Value &lt; 1.5 Then\n            Target.Offset(0, -1).Value = Target.Offset(0, -1).Value + 0.1\n        Else\n            Target.Offset(0, -1).Value = 0.5\n        End If\n\n        Target.Offset(0, -1).Select\n    End If\n\n\n  End If\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>The main idea is to check the value in column <code>Q</code> and add or subtract or wrap around depending on column and value.  This code can be simplified and cleaned up, but it works which may be all you need.</p>\n\n<p><em>I am assuming that you have a number in column <code>Q</code> and are trying to increase or decrease that?  If not, please add more detail.</em></p>\n\n<p><strong>The nice part of this code is that it puts the selection back into column <code>Q</code>. This means that you can repeatedly hit the right or left arrow to increase or decrease, respectively</strong>.  This works because the selection changes but then is immediately put back in the center.  You can type fast and increment or decrement as needed.</p>\n\n<p><strong>Picture</strong> shows the assumption of data in column <code>Q</code>.  I used the code a couple times to change values to what is shown.</p>\n\n<p><img src=\"https://i.stack.imgur.com/9T6BT.png\" alt=\"results\"></p>\n"}], "owner": {"reputation": 202, "user_id": 4979789, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/064fbb3d6fc8c5a4d3fe3577be4ffc8e?s=128&d=identicon&r=PG&f=1", "display_name": "ZealousHypocrites", "link": "https://stackoverflow.com/users/4979789/zealoushypocrites"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2029, "favorite_count": 0, "accepted_answer_id": 30766351, "answer_count": 1, "score": 1, "last_activity_date": 1433967001, "creation_date": 1433961825, "question_id": 30764752, "link": "https://stackoverflow.com/questions/30764752/change-value-in-adjacent-cell-via-click-vba-right", "title": "Change Value in Adjacent Cell Via Click (VBA right?)", "body": "<p>This is the first time I have ever really worked with VBA stuff (the code I found is VBA right? :P ) so please forgive my inability to just...understand it by looking at it. :) I have experience with macros and know /some/ of that code is compatible, but I don't know how to write it...only know how to record it then use the bits I know work.</p>\n\n<p>The Puzzle: I have a column which will adjust the weighted values of the row it is in (either makes the values slightly more or less, or leaves them alone), but the weights are entirely subjective so only need to be changed manually usually.</p>\n\n<p>The issue is when needing to change a lot of them at once because it is tons of clicking each cell and changing the value one at a time by \"guessing\" which weights we need by entering numbers until it \"looks good\" (like I said subjective), so I found this:</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/51933-changing-cell-value-clicking-cell.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/51933-changing-cell-value-clicking-cell.html</a></p>\n\n<p>Made some tiny changes to the version at the bottom of the page and have this right now:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n  Application.EnableEvents = False\n  If Target.Cells.Count = 1 Then\n    If Not Intersect(Target, Range(\"Q3:Q500\")) Is Nothing Then\n      Select Case Target.Value\n      Case \"\"\n        Target.Value = \"+\"\n      Case \"+\"\n        Target.Value = \"-\"\n      Case \"-\"\n        Target.Value = \"\"\n      Case Else\n        Target.Value = \"+\"\n      End Select\n        ActiveCell.Offset(0, 2).Range(\"A1\").Select\n    End If\n  End If\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Almost perfect, except the range of numbers will be slightly larger than \"\", +, or -. In fact the range will likely be 0.5 to 1.5 (50% to 150%).</p>\n\n<p>It would be best if they could go up or down. I guess I could just create a huge list of replacements so instead of \"\", +, or - it would just be the numbers (Case 0.5 > Case 0.6 > Case 0.7 >>> Case 1 > Case 1.1 >>> Etc.) but obviously that would probably be a huge nightmare and /less/ efficient when having to click the cell 10 times to cycle through the numbers.</p>\n\n<p>So there are two things I need to make it work perfectly:</p>\n\n<ol>\n<li>For it to change the NEXT cell over, either to the left or right by one. </li>\n<li>Instead of simple replacements, is it possible for it to do some math?</li>\n</ol>\n\n<p>The idea is that clicking in column P to the left of Q will decrease the weight (by say 0.1), and by clicking in column R to the right of Q it will increase the weight slightly. And if they reach the bottom/top it will go to the other end (0.5 decreased will take the value up to 1.5, vice versa).</p>\n\n<p>I tried tinkering a little with what I know about macros and tried adding the \"ActiveCell.Offset(0, 1).Range(\"A1\").Select\" bit here and there, which will be nice for the end of the code so I can choose where the cursor is left afterwards...but putting it anywhere earlier...I see the active cell move to P or R before changes are made, but it still changes the original column Q.</p>\n\n<p>I recognize I will need two copies of the code, one for Column R (decreasing) and one for Column P (increasing) but so long as I have at least one side I should be able to make the changes to mirror it. Also I know Data Validation might seem like a simple solution, but having an obscene amount of drop down arrows covering most of the sheet will make it illegible...</p>\n\n<p>Thank you so much to anyone spending any time on helping to solve this puzzle,\nCorinne :)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "edited": false, "score": 0, "creation_date": 1433963366, "post_id": 30764907, "comment_id": 49582781, "body": "I have other code/tasks in between when I open it and when I want to close it. Would I have to name the file path or just kill?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "edited": false, "score": 0, "creation_date": 1433963926, "post_id": 30764907, "comment_id": 49583088, "body": "@FruitUser just kill it."}, {"owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "edited": false, "score": 0, "creation_date": 1434549604, "post_id": 30764907, "comment_id": 49826865, "body": "Thanks for all your help guys, but I decided to ditch the idea since it was getting really complicated. (@Omar I tried send keys but it ended up closing my workbook, even placing the command after code to show/open the folder window)"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": -1, "last_activity_date": 1433963833, "last_edit_date": 1433963833, "creation_date": 1433962344, "answer_id": 30764907, "question_id": 30764615, "link": "https://stackoverflow.com/questions/30764615/excel-vba-open-and-close-a-folder/30764907#30764907", "title": "Excel VBA Open and close a Folder", "body": "<p>You can use the Process ID, stored in <code>vPID</code>, to kill the application when you\u2019re done with it. all you have to do is invoke the <code>TaskKill</code> command with the same <code>Shell function</code>.</p>\n\n<pre><code>Dim vPID As Variant\nvPID = Shell \"Explorer.exe *file path*\"\n\n'Perform actions here\n\n'// Kill file\nCall Shell(\"TaskKill /F /PID \" &amp; CStr(vPID))\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519118111, "creation_date": 1433961342, "question_id": 30764615, "link": "https://stackoverflow.com/questions/30764615/excel-vba-open-and-close-a-folder", "title": "Excel VBA Open and close a Folder", "body": "<p>So I know how to open a folder within an excel vba macro, but I want to be able to close it as well. Any thoughts? This is what I'm using to open the folder:</p>\n\n<pre><code>Shell \"Explorer.exe *file path*\"\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1433962515, "post_id": 30764603, "comment_id": 49582285, "body": "If you narrow down your question to particular issues you come across while developing this system you will get better results. Generally when people read &quot;How do I make this system?&quot; type questions, they will just skip right over it."}, {"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1434133778, "post_id": 30764603, "comment_id": 49667887, "body": "Thanks, I&#39;ll try to be more specific next time around."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1434047457, "post_id": 30766460, "comment_id": 49626987, "body": "Thanks for the response.  Attempted the suggestion and got the error, see above."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1433967389, "creation_date": 1433967389, "answer_id": 30766460, "question_id": 30764603, "link": "https://stackoverflow.com/questions/30764603/populate-data-on-access-2010-table-using-vba/30766460#30766460", "title": "Populate Data on Access 2010 table using VBA", "body": "<p>You can use the method here to locate and fill in the gaps: <a href=\"http://rdsrc.us/5BiQeL\" rel=\"nofollow\">Fill in missing date gaps in Access table</a></p>\n\n<p>You can easily modify it to copy the fields you need.</p>\n"}], "owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 30766460, "answer_count": 1, "score": 0, "last_activity_date": 1435218753, "creation_date": 1433961298, "last_edit_date": 1433963244, "question_id": 30764603, "link": "https://stackoverflow.com/questions/30764603/populate-data-on-access-2010-table-using-vba", "title": "Populate Data on Access 2010 table using VBA", "body": "<p>I'm new to MS Access and am having a hard time trying to come up with a more efficient solution.  I have a table with a lot more data which contains something similar to the table below.  </p>\n\n<p>I want to be able to populate the data, which contains missing Dates (or user input).  I'm essentially trying to copy the row of the last known data into the the range of missing dates or data.  For instance, for the missing dates below (ID# 9 thru 10 or dates 1/8/2015 thru 1/9/2015), I want to copy all of the information from 1/7/2015 into the two missing dates.  I want to create a code that will search through the whole file and populate all the missing dates.</p>\n\n<p>The easiest solution for me right now is to export the table into MS Excel and to manually backfill the missing dates, but this is a little time consuming.  I can write a macro and/or create a number of queries to copy a subset of tables but this seems like it would be more tedious to do and only be customized for my one table.  I tried to research for ways to do this in VBA but haven't seen a straightforward way to do it.  Any help would be appreciated.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>ID | DateLog | HourLog | K1_J_Int_Gen_ | K1_StationPower_Integr | K1_J_Int_Gen_Adj | \r\nK1_StationPower_Integr_Adj | GrossKW | AuxKW | NetKW \r\n-------------------------------------------------------------------------------------------\r\n1 | 12/31/2014 | 1 | 5633.6 | 9890.4 | 5633.60009765625 | 9890.400390625  | 0 | 0    | 0 \r\n2 | 1/1/2015   | 1 | 5633.6 | 9898.1 | 5633.60009765625 | 9898.099609375  | 0 | 770  | -770 \r\n3 | 1/2/2015   | 1 | 5633.6 | 9905.7 | 5633.60009765625 | 9905.7001953125 | 0 |  760 | -760 \r\n4 | 1/3/2015   | 1 | 5633.6 | 9914.2 | 5633.60009765625 | 9914.2001953125 | 0 | 850  | -850 \r\n5 | 1/4/2015   | 1 | 5633.6 | 9922.5 | 5633.60009765625 | 9922.5          | 0 | 830  | -830 \r\n6 | 1/5/2015   | 1 | 5633.6 | 9932.8 | 5633.60009765625 | 9932.7998046875 | 0 | 1030 | -1030 \r\n7 | 1/6/2015   | 1 | 5633.6 | 9941.9 | 5633.60009765625 | 9941.900390625  | 0 | 910  | -910 \r\n8 | 1/7/2015   | 1 | 5633.6 | 9950.4 | 5633.60009765625 | 9950.400390625  | 0 | 850  | -850 \r\n11 | 1/10/2015 | 1 | 5633.6 | 9974.7 | 5633.60009765625 | 9974.7001953125 | 0 | 0    | 0 \r\n12 | 1/11/2015 | 1 | 5633.6 | 9983.1 | 5633.60009765625 | 9983.099609375  | 0 | 840  | -840 \r\n13 | 1/12/2015 | 1 | 5633.6 | 9991   | 5633.60009765625 | 9991            | 0 | 790  | -790 \r\n14 | 1/13/2015 | 1 | 5633.6 | 9998.5 | 5633.60009765625 | 9998.5          | 0 | 750  | -750\u200b</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1433960590, "post_id": 30764278, "comment_id": 49581107, "body": "Are the values in column A actually a 4 digit text value that looks like a number representing a year or are they dates that may be formatted to display <i>yyyy</i>? Have you considered <a href=\"https://support.office.com/en-au/article/Use-a-formula-to-apply-conditional-formatting-fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f\" rel=\"nofollow noreferrer\">Conditional Formatting</a>?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 1, "creation_date": 1433960709, "post_id": 30764278, "comment_id": 49581187, "body": "<code>for each worksheet in thisworkbook.sheets</code> will loop through the sheets"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 1, "creation_date": 1433960887, "post_id": 30764278, "comment_id": 49581299, "body": "@Raystafarian - That sounds like you are encouraging the use of <code>.Select</code> to transfer worksheet control. -1."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1433961048, "post_id": 30764278, "comment_id": 49581408, "body": "@Jeeped I guess it might, huh? I wasn&#39;t paying much attention, I wouldn&#39;t use <code>select</code> as I also wouldn&#39;t use cases like this."}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 4768222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01a95e0c39b1991cb1e7f2f85d820ca4?s=128&d=identicon&r=PG&f=1", "display_name": "Kdean571", "link": "https://stackoverflow.com/users/4768222/kdean571"}, "is_accepted": false, "score": 0, "last_activity_date": 1433961375, "creation_date": 1433961375, "answer_id": 30764627, "question_id": 30764278, "link": "https://stackoverflow.com/questions/30764278/loop-macro-through-all-worksheets/30764627#30764627", "title": "loop macro through all worksheets", "body": "<p><a href=\"https://support.microsoft.com/en-us/kb/142126\" rel=\"nofollow\">Here</a> is your answer...you need a variable to count the sheets then put your loop inside another \"for\" to go through all the sheets.</p>\n\n<p>Or you could probably use a while if you wanted.. </p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1433962374, "last_edit_date": 1495541677, "creation_date": 1433962065, "answer_id": 30764822, "question_id": 30764278, "link": "https://stackoverflow.com/questions/30764278/loop-macro-through-all-worksheets/30764822#30764822", "title": "loop macro through all worksheets", "body": "<p>There are a few ways to loop through the worksheets in a workbook. I prefer the worksheet index method which simply identifies the worksheet according to its position in the worksheet queue.</p>\n\n<pre><code>Sub ExpirationYeartoColors()\n    Dim w As Long, lr As Long, r As Long, vVAL As Variant\n\n    For w = 1 To Worksheets.Count\n        With Worksheets(w)\n            lr = .Cells(Rows.Count, \"A\").End(xlUp).Row\n            For r = 2 To lr\n                vVAL = .Range(\"A\" &amp; r)\n                If IsNumeric(vVAL) Then\n                    'treat numbers as numbers!!!\n                    vVAL = Int(vVAL)   'maybe vVAL = Year(vVAL) ?\n                    Select Case vVAL\n                        Case 2015\n                            .Range(\"A\" &amp; r).Interior.Color = RGB(181, 189, 0)\n                        Case 2016\n                            .Range(\"A\" &amp; r).Interior.Color = RGB(0, 56, 101)\n                        Case 2017\n                            .Range(\"A\" &amp; r).Interior.Color = RGB(0, 147, 178)\n                        Case 2018\n                            .Range(\"A\" &amp; r).Interior.Color = RGB(155, 211, 221)\n                        Case 2019\n                            .Range(\"A\" &amp; r).Interior.Color = RGB(254, 222, 199)\n                        Case 2020\n                            .Range(\"A\" &amp; r).Interior.Color = RGB(238, 242, 210)\n                        Case 2021 To 2080\n                            .Range(\"A\" &amp; r).Interior.Color = RGB(238, 242, 210)\n                        Case Else\n                            .Range(\"A\" &amp; r).Interior.Pattern = xlNone\n                    End Select\n                Else\n                    Select Case vVAL\n                        Case Is = \"Unknown\"\n                            .Range(\"A\" &amp; r).Interior.Color = RGB(197, 200, 203)\n                        Case Is = \"Available\"\n                            .Range(\"A\" &amp; r).Interior.Color = RGB(247, 150, 91)\n                        Case Is = \"CommonArea\"\n                            .Range(\"A\" &amp; r).Interior.Color = RGB(230, 230, 230)\n                        Case Else\n                            .Range(\"A\" &amp; r).Interior.Pattern = xlNone\n                    End Select\n                End If\n            Next r\n        End With\n    Next w\n\n\nOn Error GoTo ErrorHandler\n   ' Insert code that might generate an error here\n   Exit Sub\nErrorHandler:\n   ' Insert code to handle the error here\n   Resume Next\n\nEnd Sub\n</code></pre>\n\n<p>There are a number of unanswered questions; particularly about the nature of the data. However, you should be treating numbers as numbers especially if you want to use them in something like <code>Case \"2020\" To \"2080\"</code>. I've tried to determine the nature of the values and treated text and numbers separately. This compiles but with no sample data or answers to the comments posed I cannot guarantee its validity.</p>\n\n<p>Setting the <em>.pattern</em> to xlNone removes the interior fill rather than painting it white.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</p>\n"}, {"comments": [{"owner": {"reputation": 474, "user_id": 4974853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eb5e04f840c39e06ce7a16fc83de8e08?s=128&d=identicon&r=PG&f=1", "display_name": "nirmalraj17", "link": "https://stackoverflow.com/users/4974853/nirmalraj17"}, "edited": false, "score": 0, "creation_date": 1434073275, "post_id": 30765152, "comment_id": 49637467, "body": "Dear All, Please let me know why my solution was downvoted so that I can correct those in future. As per the question, I have created the excel with the necessary data for simulation and tested. And after successful results only I have posted my reply."}], "tags": [], "owner": {"reputation": 474, "user_id": 4974853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eb5e04f840c39e06ce7a16fc83de8e08?s=128&d=identicon&r=PG&f=1", "display_name": "nirmalraj17", "link": "https://stackoverflow.com/users/4974853/nirmalraj17"}, "is_accepted": false, "score": 1, "last_activity_date": 1433970591, "last_edit_date": 1433970591, "creation_date": 1433963162, "answer_id": 30765152, "question_id": 30764278, "link": "https://stackoverflow.com/questions/30764278/loop-macro-through-all-worksheets/30765152#30765152", "title": "loop macro through all worksheets", "body": "<p>I have calculated the count of number of worksheets available on the workbook and stored to a variable. Then used a for loop to loop through the entire workbook till the last worksheet. <br/></p>\n\n<p>The blocked code is the modified part on your code.</p>\n\n<p>Also I see for the case 2020 - 2080, the formatting color is same. </p>\n\n<pre><code>Sub ExpirationYeartoColors()\nDim num As Integer, lr As Long, r As Long\n</code></pre>\n\n<blockquote>\n<pre><code>t = ActiveWorkbook.Worksheets.Count\ni = 0\nFor i = 1 To t\nWorksheets(\"sheet\" &amp; i).Activate\n</code></pre>\n</blockquote>\n\n<pre><code>lr = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nActiveSheet.Select\n\nFor r = 2 To lr\n\nSelect Case Range(\"A\" &amp; r).Value\n    Case Is = \"2015\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(181, 189, 0)\n    Case Is = \"2016\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(0, 56, 101)\n    Case Is = \"2017\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(0, 147, 178)\n    Case Is = \"2018\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(155, 211, 221)\n    Case Is = \"2019\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(254, 222, 199)\n    Case Is = \"2020\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(238, 242, 210)\n    Case \"2021\" To \"2080\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(238, 242, 210)\n    Case Is = \"Unknown\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(197, 200, 203)\n    Case Is = \"Available\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(247, 150, 91)\n    Case Is = \"CommonArea\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(230, 230, 230)\n    Case Else\n    Range(\"A\" &amp; r).Interior.Color = RGB(255, 255, 255)\nEnd Select\nNext r\n</code></pre>\n\n<blockquote>\n<pre><code>Next i\n</code></pre>\n</blockquote>\n\n<pre><code>On Error GoTo ErrorHandler\n   ' Insert code that might generate an error here\n   Exit Sub\nErrorHandler:\n   ' Insert code to handle the error here\n   Resume Next\n\nEnd Sub\n</code></pre>\n\n<p>This will loop through all the sheets and do the formatting. The code is tested and is working fine</p>\n"}, {"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1437929308, "creation_date": 1437929308, "answer_id": 31639493, "question_id": 30764278, "link": "https://stackoverflow.com/questions/30764278/loop-macro-through-all-worksheets/31639493#31639493", "title": "loop macro through all worksheets", "body": "<p>There is an alternative approach using conditional formatting (CF).</p>\n\n<p>The advantage is that once the CF is set up, th formatting of cells will respond to any values that are changed.</p>\n\n<p>You could use VBA code to add CF to all sheets by looping through all sheets in the workbook and running VBA code to add it.  OR you could add it manually as follows.  </p>\n\n<p>I understand you might need to write VBA code for other reasons and if you do the other answers are good, but I suspect this might work for you.</p>\n\n<pre><code>Select all rows on a sheet (or as many as you need).\n\nRibbon&gt;HOME&gt;Conditional formatting\nChoose: \"Use a Formula to determine which cells to format\"\n\nEnter this formula  \"=AND($A1=2010,$A1&gt;0)\"\n(it assume your data value is in column A\n it assumes the first row you selected was row 1)\n\nEnter the formatting you want for the whole row when year in column A=2010\n</code></pre>\n\n<p>Add one conditional formatting for every year.</p>\n\n<p>I recommend you record a macro and just change it as needed to add CF for every year to every sheet.</p>\n\n<p>Sometimes simple is best.</p>\n\n<p>Harvey</p>\n"}], "owner": {"reputation": 1, "user_id": 4996149, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-C-mdEXzsnYk/AAAAAAAAAAI/AAAAAAAAABM/lyTQTtf1-ao/photo.jpg?sz=128", "display_name": "Sam Gerlach", "link": "https://stackoverflow.com/users/4996149/sam-gerlach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1437929308, "creation_date": 1433960300, "last_edit_date": 1433966146, "question_id": 30764278, "link": "https://stackoverflow.com/questions/30764278/loop-macro-through-all-worksheets", "title": "loop macro through all worksheets", "body": "<p>Im trying to loop this macro, which changes the color of the row based upon year, through all of my worksheets in a current workbook and can't seem to figure out how to do so. I've tried to piece some stuff together from other questions and answers to no avail. Any help would be appreciated. Here is the code:</p>\n\n<pre><code>Sub ExpirationYeartoColors()\nDim num As Integer, lr As Long, r As Long\nlr = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nActiveSheet.Select\n\nFor r = 2 To lr\n\nSelect Case Range(\"A\" &amp; r).Value\n    Case Is = \"2015\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(181, 189, 0)\n    Case Is = \"2016\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(0, 56, 101)\n    Case Is = \"2017\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(0, 147, 178)\n    Case Is = \"2018\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(155, 211, 221)\n    Case Is = \"2019\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(254, 222, 199)\n    Case Is = \"2020\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(238, 242, 210)\n    Case \"2020\" To \"2080\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(238, 242, 210)\n    Case Is = \"Unknown\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(197, 200, 203)\n    Case Is = \"Available\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(247, 150, 91)\n    Case Is = \"CommonArea\"\n    Range(\"A\" &amp; r).Interior.Color = RGB(230, 230, 230)\n    Case Else\n    Range(\"A\" &amp; r).Interior.Color = RGB(255, 255, 255)\nEnd Select\nNext r\n\nOn Error GoTo ErrorHandler\n   ' Insert code that might generate an error here\n   Exit Sub\nErrorHandler:\n   ' Insert code to handle the error here\n   Resume Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "edited": false, "score": 0, "creation_date": 1433967014, "post_id": 30766207, "comment_id": 49584708, "body": "Would I just replace <code>DeleteObject</code> with something that closes it? Or is it more involved than that?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "edited": false, "score": 0, "creation_date": 1433967865, "post_id": 30766207, "comment_id": 49585227, "body": "You can&#39;t do that. Just make sure your application hasn&#39;t the table open or a query or form that uses it as source is open."}, {"owner": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "edited": false, "score": 0, "creation_date": 1433968534, "post_id": 30766207, "comment_id": 49585685, "body": "Nothing else is open, just the re-map form. Also- I&#39;m not replacing an Excel file, I&#39;m trying to map a new one; three instead of two."}, {"owner": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "edited": false, "score": 0, "creation_date": 1434027519, "post_id": 30766207, "comment_id": 49612922, "body": "It doesn&#39;t actually flag an error. It just does to the error handler."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "edited": false, "score": 0, "creation_date": 1434034333, "post_id": 30766207, "comment_id": 49618338, "body": "Yes. Comment out the line: <code>On Error GoTo Error_Handler:</code>."}, {"owner": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "edited": false, "score": 0, "creation_date": 1434034573, "post_id": 30766207, "comment_id": 49618534, "body": "It flags an error at <code>DoCmd.TransferSpreadsheet acLink, acSpreadsheetTypeExcel9, strTableName, strPath, True, rs!ExcelRange</code>."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "edited": false, "score": 0, "creation_date": 1434036054, "post_id": 30766207, "comment_id": 49619650, "body": "It should Work for xls files, not xlsx files.Try to call the line on its own. Also, make sure the file is not already opened by Excel or other apps."}, {"owner": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "edited": false, "score": 0, "creation_date": 1434043152, "post_id": 30766207, "comment_id": 49624339, "body": "All the files are xlsm and the two that were originally mapped work fine. I did some fiddling with the linking to make the additional sheet more like the other two, and now it&#39;s giving me <code>Error 2498: Wrong data type</code> in the same place."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "edited": false, "score": 0, "creation_date": 1434053945, "post_id": 30766207, "comment_id": 49630803, "body": "Try using <code>acSpreadsheetTypeExcel12</code>. The code works so the issue is about reading the data."}, {"owner": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "edited": false, "score": 0, "creation_date": 1434054167, "post_id": 30766207, "comment_id": 49630916, "body": "I tried that, and I&#39;m still getting the same error."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "edited": false, "score": 0, "creation_date": 1434054730, "post_id": 30766207, "comment_id": 49631255, "body": "OK. This can&#39;t be debugged remotely. You&#39;ll have to study the Excel file and find out why it fails. For a start, create a new xlsx file with a Named Range titled the same as the offending one."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1433966564, "creation_date": 1433966564, "answer_id": 30766207, "question_id": 30764233, "link": "https://stackoverflow.com/questions/30764233/linking-excel-tables-in-access-gives-read-only-error/30766207#30766207", "title": "Linking Excel Tables in Access Gives Read-Only Error", "body": "<p>You don't need to delete and recreate the link to the Excel file. Just close the linked table (if open) and replace the Excel file with the new copy.</p>\n\n<p>When you open the linked table, it will read from the new file.</p>\n"}], "owner": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "accepted_answer_id": 30766207, "answer_count": 1, "score": 1, "last_activity_date": 1434030680, "creation_date": 1433960212, "last_edit_date": 1434030680, "question_id": 30764233, "link": "https://stackoverflow.com/questions/30764233/linking-excel-tables-in-access-gives-read-only-error", "title": "Linking Excel Tables in Access Gives Read-Only Error", "body": "<p>I have a couple of Excel 2010 files that are mapped and linked to an Access 2010 database. I need to add another file so that three are mapped instead of two. I linked the excel file from the <em>Import and Link</em> tab under <em>External Database</em>. That seems to be okay. But when I run the code that re-maps the excel file, it gives me a runtime error <code>3027: Database or Object is read only.</code> None of the files or database are read-only.</p>\n\n<p>This is the code to re-map the files from a new location (ex. from the X-drive to the mail W-drive), which would also add the new excel file. Should something be added here to let me add new files?</p>\n\n<pre><code>Private Sub cmdAcceptPath_Click()\n\nDim db As DAO.Database\nDim rs As DAO.Recordset\nDim strSQL As String\nDim strPath As String\nDim strFileName As String\nDim strSourceDB As String\nDim strTableName As String\nDim sList As String\nDim gMsgBoxTitle As String\nOn Error GoTo Error_Handler:\n\nDoCmd.SetWarnings False\nstrSourceDB = Me.tExcelPath.Value\nSet db = CurrentDb\nstrSQL = \"update tblBackendFiles set setting=\" &amp; setData(strSourceDB) &amp; \" where code='SourceExcel'\"\nDoCmd.RunSQL strSQL\n\n'-- Verify linked tables by refreshing\nstrSQL = \"select setting, ExcelPath, ExcelRange from tblBackendFiles where code='SourceExcelWB'\"\nSet rs = db.OpenRecordset(strSQL, dbOpenDynaset)\n\n'Open remapprogress\nDoCmd.OpenForm \"frmReMapProgress\"\n\nsList = \"\"\nrs.MoveFirst\nWhile Not rs.EOF\n    strTableName = rs!Setting\n    sList = sList &amp; vbNewLine &amp; \"Deleting Table: \" &amp; strTableName\n    Forms!frmReMapProgress.tbProgress = sList\n    If TableExists(strTableName) Then\n        DoCmd.DeleteObject acTable, strTableName\n    End If\n    rs.MoveNext\nWend\n\nsList = \"\"\n'-- Relink inventory database\nrs.MoveFirst\nWhile Not rs.EOF\n    sList = sList &amp; vbNewLine &amp; \"Linking Table: \" &amp; strTableName\n    Forms!frmReMapProgress.tbProgress = sList\n    Forms!frmReMapProgress.Refresh\n    strTableName = rs!Setting\n    strPath = strSourceDB &amp; \"\\\" &amp; rs!ExcelPath\n    Debug.Print strPath\n    DoCmd.TransferSpreadsheet acLink, acSpreadsheetTypeExcel9, strTableName, strPath, True, rs!ExcelRange\n    rs.MoveNext\nWend\nrs.Close\nMsgBox \"Re-Mapping Excel Links is Complete!\"\n\nGoTo exit_sub:\n\n'If error occurs\nError_Handler:\n    MsgBox Err.number &amp; \": \" &amp; Err.Description, vbInformation + vbOKOnly, gMsgBoxTitle\n\nexit_sub:\nSet db = Nothing\nSet rs = Nothing\nDoCmd.SetWarnings True\n\nDoCmd.Close acForm, \"frmReMapProgress\"\nDoCmd.Close acForm, \"frmReMapExcel\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-office", "ms-word"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1434003073, "post_id": 30764086, "comment_id": 49596633, "body": "please move your solution from Question to Answer. Next, mark your question as solved."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4025310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252aaccacc63b3208a7afa934669cd?s=128&d=identicon&r=PG&f=1", "display_name": "thenextbigthing", "link": "https://stackoverflow.com/users/4025310/thenextbigthing"}, "is_accepted": true, "score": 1, "last_activity_date": 1435166927, "creation_date": 1435166927, "answer_id": 31033184, "question_id": 30764086, "link": "https://stackoverflow.com/questions/30764086/macro-in-word-to-underline-each-paragraph-in-document-less-than-x-characters-lon/31033184#31033184", "title": "Macro in Word to Underline each paragraph in document less than X characters long", "body": "<hr>\n\n<p>EDIT SOLUTION FOUND</p>\n\n<p>For posterity ... </p>\n\n<p>This code finds all paragraphs with less than 100 characters (assumes a heading) and underlines them:</p>\n\n<pre><code>Sub Underline_Header()\n\nDim numOfParagraphs As Integer\nnumOfParagraphs = ActiveDocument.BuiltInDocumentProperties(\"NUMBER OF PARAGRAPHS\")\nSelection.HomeKey Unit:=wdStory\nFor x1 = 1 To numOfParagraphs\n\nSelection.Paragraphs(1).Range.Select\n\nchar_count = Len(Selection.Paragraphs(1).Range)\n\nIf char_count &lt; 100 Then\nSelection.Font.Underline = True\nEnd If\n\nSelection.MoveDown Unit:=wdParagraph, Count:=1\n\nNext x1\n\n\nEnd Sub\n</code></pre>\n\n<p>fwiw</p>\n"}], "owner": {"reputation": 51, "user_id": 4025310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252aaccacc63b3208a7afa934669cd?s=128&d=identicon&r=PG&f=1", "display_name": "thenextbigthing", "link": "https://stackoverflow.com/users/4025310/thenextbigthing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 31033184, "answer_count": 1, "score": 0, "last_activity_date": 1435166927, "creation_date": 1433959749, "last_edit_date": 1435166901, "question_id": 30764086, "link": "https://stackoverflow.com/questions/30764086/macro-in-word-to-underline-each-paragraph-in-document-less-than-x-characters-lon", "title": "Macro in Word to Underline each paragraph in document less than X characters long", "body": "<p>I have a word doc of several pages. There are many lines in the document that are short headings, then the carriage return, then a descriptive paragraph. Not front page news.</p>\n\n<p>eg</p>\n\n<blockquote>\n  <p>Condition Subsequent</p>\n  \n  <p>A condition subsequent is often used in a legal context as a marker bringing an end to one's legal rights or duties. A condition subsequent may be either an event or a state of affairs that must either (1) occur or (2) fail to continue to occur.</p>\n</blockquote>\n\n<p>This sort of thing goes on down to the bitter end of the long document, with over 100 headings - that need to be underlined!</p>\n\n<p>I have used this code to look for all <em>lines</em> less than 100 characters to underline, which works, but if the last line of a paragraph is less than 100 characters that also gets underlined, which I dont want:</p>\n\n<pre><code>Sub Underline_Header()\n    Dim numOfLines As Integer\n    numOfLines = ActiveDocument.BuiltInDocumentProperties(\"NUMBER OF LINES\")\n    Selection.HomeKey Unit:=wdStory\n\n    For x1 = 1 To numOfLines\n        Selection.HomeKey Unit:=wdLine\n        Selection.EndKey Unit:=wdLine, Extend:=wdExtend\n        char_count = Len(Selection.Range.Text)\n        If char_count &lt; 100 Then\n            Selection.Font.Underline = True\n        End If\n        Selection.MoveDown Unit:=wdLine, Count:=1\n    Next x1\nEnd Sub\n</code></pre>\n\n<p>But when I try this (below) to look for <em>paragraphs</em> and count the number of characters in the <em>paragraph</em>, Word throws an error at the two lines highlighted below:</p>\n\n<pre><code>Sub Underline_Header()\n    Dim numOfParagraphs As Integer\n    numOfParagraphs = ActiveDocument.BuiltInDocumentProperties(\"NUMBER OF PARAGRAPHS\")\n    Selection.HomeKey Unit:=wdStory\n\n    For x1 = 1 To numOfParagraphs\n        *&gt;&gt;Selection.HomeKey Unit:=wdParagraph\n        &gt;&gt;Selection.EndKey Unit:=wdParagraph, Extend:=wdExtend*\n        char_count = Len(Selection.Range.Text)\n        If char_count &lt; 100 Then\n            Selection.Font.Underline = True\n        End If\n        Selection.MoveDown Unit:=wdParagraph, Count:=1\n    Next x1\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 1, "creation_date": 1433958660, "post_id": 30763683, "comment_id": 49579899, "body": "What sort of issues are you running into when using that line of code?"}, {"owner": {"reputation": 23, "user_id": 4965735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e60d493bfbe96a2782255a8cf5e629?s=128&d=identicon&r=PG&f=1", "display_name": "santh821", "link": "https://stackoverflow.com/users/4965735/santh821"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1433958734, "post_id": 30763683, "comment_id": 49579951, "body": "Sorry, I totally forgot to include that. Editing now."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1433958886, "post_id": 30763683, "comment_id": 49580051, "body": "Is [Search Form] open when you are trying to do this?"}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1433958907, "post_id": 30763683, "comment_id": 49580067, "body": "You need to make sure that <code>Forms![Search Form]!Subform1.SourceObject</code> is in scope. Can you verify that?"}, {"owner": {"reputation": 23, "user_id": 4965735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e60d493bfbe96a2782255a8cf5e629?s=128&d=identicon&r=PG&f=1", "display_name": "santh821", "link": "https://stackoverflow.com/users/4965735/santh821"}, "edited": false, "score": 0, "creation_date": 1433959236, "post_id": 30763683, "comment_id": 49580277, "body": "What is the scope of a form reference? I&#39;m using it within the same database, but it is on the report, and it is initially used (the same reference) on Search Form"}, {"owner": {"reputation": 23, "user_id": 4965735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e60d493bfbe96a2782255a8cf5e629?s=128&d=identicon&r=PG&f=1", "display_name": "santh821", "link": "https://stackoverflow.com/users/4965735/santh821"}, "edited": false, "score": 0, "creation_date": 1433959645, "post_id": 30763683, "comment_id": 49580494, "body": "And yes [Search Form] is open. But focus is going to the report. There is a button on Search Form that opens the Report (it does this first) and then calls that line of code."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4965735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e60d493bfbe96a2782255a8cf5e629?s=128&d=identicon&r=PG&f=1", "display_name": "santh821", "link": "https://stackoverflow.com/users/4965735/santh821"}, "edited": false, "score": 0, "creation_date": 1433960073, "post_id": 30764120, "comment_id": 49580779, "body": "Ok, so that mostly fixed things. Now it successfully opens the report, but in design view. The macro is set to open the report in report view, but it goes to design view."}, {"owner": {"reputation": 23, "user_id": 4965735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e60d493bfbe96a2782255a8cf5e629?s=128&d=identicon&r=PG&f=1", "display_name": "santh821", "link": "https://stackoverflow.com/users/4965735/santh821"}, "edited": false, "score": 0, "creation_date": 1433961923, "post_id": 30764120, "comment_id": 49581933, "body": "The issue there being I want to set the record source of the report to the source object of the subform, which varies depending on what the user is doing."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 23, "user_id": 4965735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e60d493bfbe96a2782255a8cf5e629?s=128&d=identicon&r=PG&f=1", "display_name": "santh821", "link": "https://stackoverflow.com/users/4965735/santh821"}, "edited": false, "score": 0, "creation_date": 1433962147, "post_id": 30764120, "comment_id": 49582072, "body": "You know how to get the subform <code>SourceObject</code>: <code>Forms![Search Form]!Subform1.SourceObject</code>  Then use it for the report&#39;s <code>RecordSource</code>.  Where is the problem?"}, {"owner": {"reputation": 23, "user_id": 4965735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e60d493bfbe96a2782255a8cf5e629?s=128&d=identicon&r=PG&f=1", "display_name": "santh821", "link": "https://stackoverflow.com/users/4965735/santh821"}, "edited": false, "score": 0, "creation_date": 1433962873, "post_id": 30764120, "comment_id": 49582482, "body": "If I use that path to the source object, it goes to design view. The macro is also what calls the code from the button."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1433963566, "last_edit_date": 1433963566, "creation_date": 1433959854, "answer_id": 30764120, "question_id": 30763683, "link": "https://stackoverflow.com/questions/30763683/access-setting-a-source-object-to-another-source-object-path/30764120#30764120", "title": "Access: Setting a source object to another source object path", "body": "<p>A report does not have a <code>SourceObject</code> property.  That is the reason Access throws error #2465, <em>\"Application-defined or object-defined error\"</em> when you attempt to reference it.</p>\n\n<p>Here is an Immediate window example from my system:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>' first demonstrate the report is accessible ...\nDebug.Print Reports!rptFoo.Name\nrptFoo \n' now when referencing SourceObject ...\nDebug.Print Reports!rptFoo.SourceObject ' &lt;-- error 2465\n</code></pre>\n\n<p>Perhaps you want to alter the report's <code>RecordSource</code> instead:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' current RecordSource ...\nDebug.Print Reports!rptFoo.RecordSource\nSELECT rmy.id, rmy.reportDate, rmy.gainOrLoss FROM record_matYields AS rmy;\n' change RecordSource to a saved query ...\nReports!rptFoo.RecordSource = \"qryBar\"\n' confirm RecordSource was altered ...\nDebug.Print Reports!rptFoo.RecordSource\nqryBar\n</code></pre>\n\n<p>The report displayed 6 rows with the original <code>RecordSource</code>.  The saved query includes a <code>WHERE</code> condition which limits the results to only 2 of those rows.  So altering the <code>RecordSource</code> as above caused the report to display only those 2 rows without forcing the report into design mode, unlike the macro approach you mentioned in your comment.</p>\n\n<p>Unfortunately I don't know enough about macros to help you fix yours.  I mostly avoid macros.  </p>\n"}], "owner": {"reputation": 23, "user_id": 4965735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e60d493bfbe96a2782255a8cf5e629?s=128&d=identicon&r=PG&f=1", "display_name": "santh821", "link": "https://stackoverflow.com/users/4965735/santh821"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 0, "accepted_answer_id": 30764120, "answer_count": 1, "score": 2, "last_activity_date": 1433963566, "creation_date": 1433958397, "last_edit_date": 1433959884, "question_id": 30763683, "link": "https://stackoverflow.com/questions/30763683/access-setting-a-source-object-to-another-source-object-path", "title": "Access: Setting a source object to another source object path", "body": "<p>I'm trying something crazy again. I would like to use this line of code:</p>\n\n<pre><code>Reports![PrntRep].SourceObject = Forms![Search Form]!Subform1.SourceObject\n</code></pre>\n\n<p>The source object of subform1 is dynamically depending on which query you need to search. I want the source of the report to be set to the same query, so that I don't need to make a bunch of different reports. \nIt throws error 2465, application defined or object defined error.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433966238, "post_id": 30763455, "comment_id": 49584309, "body": "If you add a breakpoint and go line by line (hitting <code>F8</code> to advance), what line gives the error?"}, {"owner": {"reputation": 105, "user_id": 4398364, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0532d0d102d947dcf649ff139ddd23a5?s=128&d=identicon&r=PG&f=1", "display_name": "SKP", "link": "https://stackoverflow.com/users/4398364/skp"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433993283, "post_id": 30763455, "comment_id": 49593543, "body": "The fourth line gives error when I use breakpoint. ActiveSheet.PivotTables(&quot;PVT1&quot;).PivotFields(&quot;Project Name&quot;).CurrentPage = Range(&quot;Y1&quot;).Text"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434031573, "post_id": 30763455, "comment_id": 49616230, "body": "Are you using <code>All</code> or <code>(All)</code>?  The latter is the correct version."}, {"owner": {"reputation": 105, "user_id": 4398364, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0532d0d102d947dcf649ff139ddd23a5?s=128&d=identicon&r=PG&f=1", "display_name": "SKP", "link": "https://stackoverflow.com/users/4398364/skp"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434092406, "post_id": 30763455, "comment_id": 49643080, "body": "I did use (All) and it did not help. The code that I am trying to create is in the Report Filter and it is not the Row or Column Filter. So I am using 9 pivot tables, all of them have Report filters as [Project], [Customer], [Country]."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434114893, "post_id": 30763455, "comment_id": 49656354, "body": "I am really struggling to see where the issue could be.  One workaround could be to surround them all with an <code>If... Then</code> to avoid the filter if it is <code>All</code>.  Something like <code>If Range(&quot;Y1&quot;).Text &lt;&gt; &quot;All&quot; Then : &#39;filtering code : End If</code>.  A picture of the combobox might also help.  When you debug, does the expected value come through at <code>Range(&quot;Y1&quot;).Text</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 0, "last_activity_date": 1434031319, "creation_date": 1434031319, "answer_id": 30783041, "question_id": 30763455, "link": "https://stackoverflow.com/questions/30763455/combo-box-to-change-filters-on-excel-pivot-table/30783041#30783041", "title": "combo box to change filters on excel pivot table", "body": "<p>Since the first three lines of code go without issue, I will assume that the Pivot Table <code>PVT1</code> and the Field <code>Project Name</code> all exist.  This places the error somewhere after that.</p>\n\n<p>For the call to <code>.CurrentPage</code> you will get a 1004 error for the following reasons:</p>\n\n<ul>\n<li>Using this to try and filter any field that is not set as a <code>Report Filter</code>.  You cannot use the <code>CurrentPage</code> to filter any rows or columns</li>\n<li>Setting a value which does not exist in the list of possible values</li>\n</ul>\n\n<p>On the second point, this is where the call to <code>Range</code> might be relevant.</p>\n\n<ul>\n<li>Verify that the value there exists in the list of possible ones.</li>\n<li>Also be aware you are using <code>.Text</code> which will use the <em>display</em> value of the cell and not its underlying <code>.Value</code></li>\n</ul>\n\n<p>To resolve these issues, there are a couple of options:</p>\n\n<ul>\n<li>For the case where you want to filter data that is on the row or column (and not in the filters section) you can go through <code>PivotItems</code> and set <code>Visible = True/False</code></li>\n<li>You can also set a label filter from VBA if you want that instead of the manual filter</li>\n<li>If you want to check for a value existing in the <code>CurrentPage</code>, you can iterate the <code>PivotItems</code> for that <code>PivotField</code> and check that one matches.  The code for that is very similar to the <code>For Each</code> loop with the check on value, just don't set <code>Visible</code>.</li>\n</ul>\n\n<p><strong>Code</strong> for setting a filter on a row or column</p>\n\n<pre><code>Sub FilterPivotField()\n\n    Dim pt As PivotTable\n    Set pt = ActiveSheet.PivotTables(\"PVT1\")\n\n    Dim pf As PivotField\n    Set pf = pt.PivotFields(\"C\")\n\n    pf.ClearAllFilters\n\n    'slow iterates all items and sets Visible (manual filter)\n    Dim pi As PivotItem\n    For Each pi In pf.PivotItems\n        pi.Visible = (pi.Name = Range(\"J2\"))\n    Next\n\n    'fast way sets a label filter\n    pf.PivotFilters.Add2 Type:=xlCaptionEquals, Value1:=Range(\"J2\")\n\nEnd Sub\n</code></pre>\n\n<p><strong>Picture of ranges</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/U2iYX.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 105, "user_id": 4398364, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0532d0d102d947dcf649ff139ddd23a5?s=128&d=identicon&r=PG&f=1", "display_name": "SKP", "link": "https://stackoverflow.com/users/4398364/skp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4821, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1434031319, "creation_date": 1433957711, "last_edit_date": 1531164843, "question_id": 30763455, "link": "https://stackoverflow.com/questions/30763455/combo-box-to-change-filters-on-excel-pivot-table", "title": "combo box to change filters on excel pivot table", "body": "<p>Excel 2013. I am using 3 combo boxes to change filters on the pivot table. \nMy first combo box has \"Project1\", \"Project2\" &amp; All. \nMy second combo box has \"Customer1\", \"Customer2\" &amp; All. \nMy third combo box has \"Country1\", \"Country2\" &amp; All.</p>\n\n<p>I am using 9 pivot tables, all of them have filters as [Project], [Customer], [Country]. </p>\n\n<p>My intention is to change first combo box to Project1 &amp; all the pivot tables filter should change as Project1.I am successfully able to do that. </p>\n\n<p>However when I select the first combo box as \"All\". First Combo box cell link to Y1. I get VBA Run time error 1004: Application-defined or object-defined error.</p>\n\n<pre><code>Sub ProjectName()\n\nActiveSheet.PivotTables(\"PVT1\").PivotFields(\"Project Name\").ClearAllFilters\nActiveSheet.PivotTables(\"PVT2\").PivotFields(\"Project Name\").ClearAllFilters\nActiveSheet.PivotTables(\"PVT3\").PivotFields(\"Project Name\").ClearAllFilters\n\n    ActiveSheet.PivotTables(\"PVT1\").PivotFields(\"Project Name\").CurrentPage = Range(\"Y1\").Text\n    ActiveSheet.PivotTables(\"PVT2\").PivotFields(\"Project Name\").CurrentPage = Range(\"Y1\").Text\n    ActiveSheet.PivotTables(\"PVT3\").PivotFields(\"Project Name\").CurrentPage = Range(\"Y1\").Text \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1433958667, "post_id": 30763428, "comment_id": 49579904, "body": "Without reviewing your full code my suggestion would be to use the <code>.find</code> method and grab the offset. IE <code>ValueYouNeed = Range(YourRange).Find(What:=&quot;TOOLING DATA SHEET (TDS):&quot;, LookAt:=xlWhole, LookIn:=xlValues).Offset(, 1).Value</code> Regards,"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1433960773, "post_id": 30763428, "comment_id": 49581222, "body": "Okay, I have written that as a function so I can access it in my main code.. do you know how I would reference it? Currently trying to write it as <code>StartSht.Cells(i,4) = GetTDSName(ws, 1)</code> in order to get the TDS Name from the worksheet and print it to column 4 of the StartSht @nbayly I have edited my question to include the function I am now working on"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1433960992, "post_id": 30763428, "comment_id": 49581363, "body": "Depends how you are returning the results from your <code>GetTDSName</code> function. If you are returning the value as string you can just make <code>StartSht.Cells(i,4).Value2 = GetTDSName(ws, 1)</code>. If your returning as a range then <code>StartSht.Cells(i,4).Value2 = GetTDSName(ws, 1).Value2</code>. Untested but hopefully pushing you in the right direction."}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1433961693, "post_id": 30763428, "comment_id": 49581790, "body": "When I do that, it highlights TDSName and gives back the error wrong number of arguments or invalid property assignment @nbayly"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1434030366, "post_id": 30763428, "comment_id": 49615199, "body": "Any suggestions? @nbayly"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1434056674, "post_id": 30763428, "comment_id": 49632332, "body": "Can you clarify what the error states and on what line? A couple of things I note: when you do <code>.find</code> it returns a Range object but you have not declares <code>ret</code> as a range object and you would need to do <code>Set ret = Range(&quot;...</code>; also in your <code>.find</code> your search range only has 1 cell and should have the complete searchable range. Change those couple of things and if you continue having errors post them here and we&#39;ll gladly assist you. Cheers,"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1434117047, "post_id": 30763428, "comment_id": 49657879, "body": "thank you for your help @nbayly . I really appreciate it. I figured out the solution and posted it below"}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1434117020, "creation_date": 1434117020, "answer_id": 30804773, "question_id": 30763428, "link": "https://stackoverflow.com/questions/30763428/vba-search-for-cell-grab-contents-to-the-right-of-cell/30804773#30804773", "title": "VBA - Search for cell, grab contents to the right of cell", "body": "<p><strong>SOLUTION:</strong>            </p>\n\n<pre><code>'print TDS name\n            If Not Range(\"A1:K1\").Find(What:=\"TOOLING DATA SHEET (TDS):\", LookAt:=xlWhole, LookIn:=xlValues) Is Nothing Then\n                Set TDS = Range(\"A1:K1\").Find(What:=\"TOOLING DATA SHEET (TDS):\", LookAt:=xlWhole, LookIn:=xlValues).Offset(, 1)\n                StartSht.Range(StartSht.Cells(i, 1), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = TDS\n            Else\n                StartSht.Range(StartSht.Cells(i, 1), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = \"NO TDS VALUE!\"\n            End If\n            i = GetLastRowInSheet(StartSht) + 1\n    End With\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1434117020, "creation_date": 1433957646, "last_edit_date": 1433960931, "question_id": 30763428, "link": "https://stackoverflow.com/questions/30763428/vba-search-for-cell-grab-contents-to-the-right-of-cell", "title": "VBA - Search for cell, grab contents to the right of cell", "body": "<p>I have a working macro that loops through folder to open files and get important info from the columns of names \"HOLDER\" and \"CUTTING TOOL\" and printing all the info to one excel document, masterfile. It also prints the file name into column 1 and the name of the \"Tooling Data Sheet\" to column 4. I currently have that set up as printing cell J1. </p>\n\n<p>This only works some of the time as the information is not always in J1. What I want to do is search for the header <strong>\"TOOLING DATA SHEET (TDS):\"</strong> as i have done with \"HOLDER\" and \"CUTTING TOOL\" but grab the contents in <strong>one cell to the right of that header</strong> and print it to the masterfile (as it currently works but instead of just printing J1, print cell to right of header). Any ideas?</p>\n\n<p><em>The information for the \"TOOLING DATA SHEET\" is printed in the second half of section (5). The major commented out sections in my code have been my attempts at solving this issue.</em></p>\n\n<p><strong>FULL CODE</strong></p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughDirectory()\n\n    Const ROW_HEADER As Long = 10\n\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim MyFolder As String\n    Dim StartSht As Worksheet, ws As Worksheet\n    Dim WB As Workbook\n    Dim i As Integer\n    Dim LastRow As Integer, erow As Integer\n    Dim Height As Integer\n    Dim FinalRow As Long\n    Dim f As String\n    Dim dict As Object\n    Dim hc As Range, hc1 As Range, hc2 As Range, hc3 As Range, hc4 As Range, hc5 As Range, d As Range\n\n\n    Set StartSht = Workbooks(\"masterfile.xlsm\").Sheets(\"Sheet1\")\n\n    'turn screen updating off - makes program faster\n    Application.ScreenUpdating = False\n\n    'location of the folder in which the desired TDS files are\n    MyFolder = \"C:\\Users\\trembos\\Documents\\TDS\\progress\\\"\n\n    'find the headers on the sheet\n    Set hc1 = HeaderCell(StartSht.Range(\"B1\"), \"HOLDER\")\n    Set hc2 = HeaderCell(StartSht.Range(\"C1\"), \"CUTTING TOOL\")\n    Set hc4 = HeaderCell(StartSht.Range(\"D1\"), \"TOOLING DATA SHEET (TDS):\")\n\n    'create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'get the folder object\n    Set objFolder = objFSO.GetFolder(MyFolder)\n    i = 2\n\n\n    'loop through directory file and print names\n'(1)\n    For Each objFile In objFolder.Files\n        If LCase(Right(objFile.Name, 3)) = \"xls\" Or LCase(Left(Right(objFile.Name, 4), 3)) = \"xls\" Then\n'(2)\n            'Open folder and file name, do not update links\n            Set WB = Workbooks.Open(fileName:=MyFolder &amp; objFile.Name, UpdateLinks:=0)\n            Set ws = WB.ActiveSheet\n'(3)\n                'find CUTTING TOOL on the source sheet\n                Set hc = HeaderCell(ws.Cells(ROW_HEADER, 1), \"CUTTING TOOL\")\n                If Not hc Is Nothing Then\n\n                    Set dict = GetValues(hc.Offset(1, 0), \"SplitMe\")\n                    If dict.count &gt; 0 Then\n                        Set d = StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0)\n                        'add the values to the master list, column 3\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                    End If\n                Else\n                    'header not found on source worksheet\n                End If\n'(4)\n                'find HOLDER on the source sheet\n                Set hc3 = HeaderCell(ws.Cells(ROW_HEADER, 1), \"HOLDER\")\n                If Not hc3 Is Nothing Then\n                    Set dict = GetValues(hc3.Offset(1, 0))\n                    'If InStr(ROW_HEADER, \"HOLDER\") &lt;&gt; \"\" Then\n                    If dict.count &gt; 0 Then\n                        Set d = StartSht.Cells(Rows.count, hc1.Column).End(xlUp).Offset(1, 0)\n                        'add the values to the master list, column 2\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                    End If\n                    'End If\n                Else\n                    'header not found on source worksheet\n                End If\n\n'''(4)\n'                'find TDS on the source sheet\n'                Set hc5 = HeaderCell2(ws.Cells(ROW_HEADER, 1), \"TOOLING DATA SHEET (TDS):\")\n'                If Not hc5 Is Nothing Then\n'                    Set dict = GetValues(hc5.Offset(1, 0))\n'                    'If InStr(ROW_HEADER, \"HOLDER\") &lt;&gt; \"\" Then\n'                    If dict.count &gt; 0 Then\n'                        Set d = StartSht.Cells(Rows.count, hc4.Column).End(xlUp).Offset(1, 0)\n'                        'add the values to the master list, column 2\n'                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n'                    End If\n'                    'End If\n'                Else\n'                    'header not found on source worksheet\n'                End If\n\n\n'(5)\n            With WB\n               'print TDS information\n                For Each ws In .Worksheets\n                        'print the file name to Column 1\n                        StartSht.Cells(i, 1) = objFile.Name\n                        StartSht.Range(StartSht.Cells(i, 1), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = objFile.Name\n\n                        'print TDS name from J1 cell to Column 4\n                        With ws\n                            .Range(\"J1\").Copy StartSht.Cells(i, 4)\n                            .Range(\"J1\").Copy StartSht.Range(StartSht.Cells(i, 4), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 4))\n                        End With\n                        i = GetLastRowInSheet(StartSht) + 1\n                'move to next file\n                Next ws\n'(6)\n                'close, do not save any changes to the opened files\n                .Close SaveChanges:=False\n            End With\n        End If\n    '(7)\n    'move to next file\n    Next objFile\n    'turn screen updating back on\n    Application.ScreenUpdating = True\n    ActiveWindow.ScrollRow = 1\nEnd Sub\n\n'(8)\n'get all unique column values starting at cell c\nFunction GetValues(ch As Range, Optional vSplit As Variant) As Object\n    Dim dict As Object\n    Dim rng As Range, c As Range\n    Dim v\n    Dim spl As Variant\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n\n    For Each c In ch.Parent.Range(ch, ch.Parent.Cells(Rows.count, ch.Column).End(xlUp)).Cells\n        v = Trim(c.Value)\n        If Len(v) &gt; 0 And Not dict.exists(v) Then\n\n            'exclude any info after \";\"\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \";\")\n            v = spl(0)\n            End If\n\n            'exclude any info after \",\"\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \",\")\n            v = spl(0)\n            End If\n\n            dict.Add c.Address, v\n        End If\n    Next c\n    Set GetValues = dict\nEnd Function\n\n'(9)\n'find a header on a row: returns Nothing if not found\nFunction HeaderCell(rng As Range, sHeader As String) As Range\n    Dim rv As Range, c As Range\n    For Each c In rng.Parent.Range(rng, rng.Parent.Cells(rng.Row, Columns.count).End(xlToLeft)).Cells\n        'copy cell value if it contains some string \"holder\" or \"cutting tool\"\n        If InStr(c.Value, sHeader) &lt;&gt; 0 Then\n            Set rv = c\n            Exit For\n        End If\n    Next c\n    Set HeaderCell = rv\nEnd Function\n\n''(9)\n''find a header on a row: returns Nothing if not found\n'Function HeaderCell2(rng As Range, sHeader As String) As Range\n'    Dim rv As Range, c As Range\n'    For Each c In rng.Parent.Range(rng, rng.Parent.Cells(rng.Row, Columns.count).End(xlToRight)).Cells\n'        'copy cell value if it contains some string \"holder\" or \"cutting tool\"\n'        If InStr(c.Value, sHeader) &lt;&gt; 0 Then\n'            Set rv = c\n'            Exit For\n'        End If\n'    Next c\n'    Set HeaderCell2 = rv\n'End Function\n\n'(10)\nFunction GetLastRowInColumn(theWorksheet As Worksheet, col As String)\n    With theWorksheet\n        GetLastRowInColumn = .Range(col &amp; .Rows.count).End(xlUp).Row\n    End With\nEnd Function\n\n\n'(11)\nFunction GetLastRowInSheet(theWorksheet As Worksheet)\nDim ret\n    With theWorksheet\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            ret = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            ret = 1\n        End If\n    End With\n    GetLastRowInSheet = ret\nEnd Function\n</code></pre>\n\n<p><strong>EDIT</strong>\nCurrent code attempt creating a function to call: </p>\n\n<pre><code>Function GetTDSName(theWorksheet As Worksheet)\nDim ret\n    With theWorksheet\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            ret = Range(\"J1\").Find(What:=\"TOOLING DATA SHEET (TDS):\", LookAt:=xlWhole, LookIn:=xlValues).Offset(, 1).Value\n        Else\n            ret = 1\n        End If\n    End With\n    GetTDSName = ret\nEnd Function\n</code></pre>\n"}, {"tags": ["c++", "excel", "vba", "dll", "mpi"], "comments": [{"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1433959568, "post_id": 30763407, "comment_id": 49580448, "body": "Are you sure you really want to use MPI? Unless you want to target clusters and supercomputers, and those running Windows are really few, perhaps OpenMP, Intel TBB, or the Concurency Runtime will be much more suitable choices."}, {"owner": {"reputation": 99, "user_id": 2662434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea9c4ca7b48e3ea43acc5942f391aaa6?s=128&d=identicon&r=PG", "display_name": "user2662434", "link": "https://stackoverflow.com/users/2662434/user2662434"}, "reply_to_user": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1433960974, "post_id": 30763407, "comment_id": 49581355, "body": "Because the end user only has excel on windows system. I need to develop this dll for them to use in Excel Vba."}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 1, "creation_date": 1434004674, "post_id": 30763407, "comment_id": 49597395, "body": "I don&#39;t think you understand my question. MPI (Message Passing Interface) is a technique for programming distributed memory systems, i.e. systems that consist of multiple compute nodes with no shared memory, addressable by all nodes. If you just want to use the power of a single multicore/multisocket computer, then MPI is not the right choice."}], "owner": {"reputation": 99, "user_id": 2662434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea9c4ca7b48e3ea43acc5942f391aaa6?s=128&d=identicon&r=PG", "display_name": "user2662434", "link": "https://stackoverflow.com/users/2662434/user2662434"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1503042037, "creation_date": 1433957585, "last_edit_date": 1434035242, "question_id": 30763407, "link": "https://stackoverflow.com/questions/30763407/excel-vba-call-dll-developed-using-mpi", "title": "Excel VBA call DLL developed using MPI", "body": "<p>I am new to C++. And I want to develop a dll of a function applying Monte Carlo Simulation using VS C++ 2013. I want to enhance the monte carlo capacity. So I want to use Microsoft MS-MPI and HPC 2008 to do parallel computing within this dll. Then, I need to call this dll in Excel VBA.</p>\n\n<ul>\n<li>Is it possible to do it?</li>\n<li>When excuting a C++ code using ms-mpi, I can use \"mpiexec.exe\" to tell computer how many cores to run. If in Excel Vba, I want the dll to run on multiple cores, how do I do that?</li>\n</ul>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1433958402, "post_id": 30763180, "comment_id": 49579738, "body": "Have you tried using the Solver wizard to confirm if there is a valid solution to your query? If there is can you run the code line by line by pressing <code>F8</code> and review what if anything the code is doing? Regards."}], "answers": [{"tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": true, "score": 0, "last_activity_date": 1433958469, "creation_date": 1433958469, "answer_id": 30763697, "question_id": 30763180, "link": "https://stackoverflow.com/questions/30763180/excel-vba-solver-equation-isnt-solving/30763697#30763697", "title": "Excel VBA solver. Equation isn&#39;t solving", "body": "<p>If you set maxMinVal to 3, you are saying you want it to converge to a particular value. But then in your code you haven't said what that value is. I see you're implying it with the constraint you then add, but I doubt it guesses it from that. I'd suggest getting rid of the constraint and ammending the SolverOk line as follows:</p>\n\n<pre><code>Sub solveTest2()\n\n    Worksheets(\"Sheet1\").Activate\n    SolverReset\n    SolverOptions precision:=0.001\n    SolverOK setCell:=Range(\"C1\"), maxMinVal:=3, valueof:=Range(\"B1\").Value, byChange:=Range(\"A1\")\n    SolverSolve userFinish:=True\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://support.microsoft.com/en-us/kb/843304\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/843304</a></p>\n"}], "owner": {"reputation": 17, "user_id": 959541, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f29d5c152ed0fe74fd57e04f4d0bb15f?s=128&d=identicon&r=PG", "display_name": "Hammer", "link": "https://stackoverflow.com/users/959541/hammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 30763697, "answer_count": 1, "score": 0, "last_activity_date": 1433958469, "creation_date": 1433956927, "question_id": 30763180, "link": "https://stackoverflow.com/questions/30763180/excel-vba-solver-equation-isnt-solving", "title": "Excel VBA solver. Equation isn&#39;t solving", "body": "<p>this is probably a very simple question to someone that knows what they are doing, but I am new to using VBA solver function and it is proving to be a pain.</p>\n\n<p>I have this formula is cell C1 =3*A1^2-2*A1^3 and have a set number in B1, let\u2019s say 0.5.</p>\n\n<p>I\u2019d like to use Solver to change cell A1, currently set as 0, until C1 = B1</p>\n\n<p>I have tried playing with sample code but no joy, I currently stand with the code below but it does nothing</p>\n\n<pre><code>Sub solveTest()\n\nWorksheets(\"Sheet3\").Activate\nSolverReset\nSolverOptions precision:=0.001\nSolverOK setCell:=Range(\"C1\"), maxMinVal:=3, byChange:=Range(\"A1\")\nSolverAdd cellRef:=Range(\"B1\"), relation:=2, formulaText:=Range(\"C1\")\nSolverSolve userFinish:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "db2"], "comments": [{"owner": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 0, "creation_date": 1433959821, "post_id": 30762986, "comment_id": 49580607, "body": "How do you define a &quot;working day&quot;? Do you need to account for holidays?"}, {"owner": {"reputation": 107, "user_id": 4933529, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/bf1e5dcfde761b3026a21ab7b93f6376?s=128&d=identicon&r=PG&f=1", "display_name": "Tommeck37", "link": "https://stackoverflow.com/users/4933529/tommeck37"}, "reply_to_user": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 0, "creation_date": 1433961622, "post_id": 30762986, "comment_id": 49581750, "body": "working days are defined as from Monday til Friday"}, {"owner": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 0, "creation_date": 1433968091, "post_id": 30762986, "comment_id": 49585396, "body": "In that case the solution offered below should work (after being rewritten to DB2 SQL, taking into account the DB2 version and platform you work with)."}, {"owner": {"reputation": 107, "user_id": 4933529, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/bf1e5dcfde761b3026a21ab7b93f6376?s=128&d=identicon&r=PG&f=1", "display_name": "Tommeck37", "link": "https://stackoverflow.com/users/4933529/tommeck37"}, "reply_to_user": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 0, "creation_date": 1433968212, "post_id": 30762986, "comment_id": 49585470, "body": "Would you please be able to rewrite it into Db2?"}, {"owner": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 0, "creation_date": 1433968451, "post_id": 30762986, "comment_id": 49585630, "body": "Not without the necessary details."}, {"owner": {"reputation": 107, "user_id": 4933529, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/bf1e5dcfde761b3026a21ab7b93f6376?s=128&d=identicon&r=PG&f=1", "display_name": "Tommeck37", "link": "https://stackoverflow.com/users/4933529/tommeck37"}, "reply_to_user": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 0, "creation_date": 1433998004, "post_id": 30762986, "comment_id": 49594749, "body": "Tell me what details you need"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 4933529, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/bf1e5dcfde761b3026a21ab7b93f6376?s=128&d=identicon&r=PG&f=1", "display_name": "Tommeck37", "link": "https://stackoverflow.com/users/4933529/tommeck37"}, "edited": false, "score": 0, "creation_date": 1433958151, "post_id": 30763054, "comment_id": 49579564, "body": "the problem is that people that are supposed to use it are not able to do any manipulations with code like this The need is for the code to always calculate one working day back without human intervention"}, {"owner": {"reputation": 1023, "user_id": 2480139, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f2112ee2428f229cabdc37d4d6b85d43?s=128&d=identicon&r=PG&f=1", "display_name": "Brian H", "link": "https://stackoverflow.com/users/2480139/brian-h"}, "reply_to_user": {"reputation": 107, "user_id": 4933529, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/bf1e5dcfde761b3026a21ab7b93f6376?s=128&d=identicon&r=PG&f=1", "display_name": "Tommeck37", "link": "https://stackoverflow.com/users/4933529/tommeck37"}, "edited": false, "score": 0, "creation_date": 1433958710, "post_id": 30763054, "comment_id": 49579941, "body": "@Tommeck37 I don&#39;t understand what the problem is. I changed the example i provided in hopes that it is more applicable now. It can be simplified but I left it fairly verbose so it&#39;s easier to understand"}, {"owner": {"reputation": 107, "user_id": 4933529, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/bf1e5dcfde761b3026a21ab7b93f6376?s=128&d=identicon&r=PG&f=1", "display_name": "Tommeck37", "link": "https://stackoverflow.com/users/4933529/tommeck37"}, "edited": false, "score": 0, "creation_date": 1433958881, "post_id": 30763054, "comment_id": 49580044, "body": "I must have written post at the same time as you were amending it. Thank you Brian. Now it seems more applicable for me. I will keep you posted once I&#39;ve tried it at work"}, {"owner": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 0, "creation_date": 1433959837, "post_id": 30763054, "comment_id": 49580623, "body": "That&#39;s not really DB2 SQL, is it?"}, {"owner": {"reputation": 107, "user_id": 4933529, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/bf1e5dcfde761b3026a21ab7b93f6376?s=128&d=identicon&r=PG&f=1", "display_name": "Tommeck37", "link": "https://stackoverflow.com/users/4933529/tommeck37"}, "edited": false, "score": 0, "creation_date": 1434003620, "post_id": 30763054, "comment_id": 49596886, "body": "Yes it seems to me it is not Db2 as query does not work"}], "tags": [], "owner": {"reputation": 1023, "user_id": 2480139, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f2112ee2428f229cabdc37d4d6b85d43?s=128&d=identicon&r=PG&f=1", "display_name": "Brian H", "link": "https://stackoverflow.com/users/2480139/brian-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1433958652, "last_edit_date": 1433958652, "creation_date": 1433956539, "answer_id": 30763054, "question_id": 30762986, "link": "https://stackoverflow.com/questions/30762986/1-working-day-back-in-sql-db2/30763054#30763054", "title": "1 Working Day Back In SQL DB2", "body": "<p>Check what day of the week it is and change accordingly</p>\n\n<pre><code>select * from table_x where timestamp_x &gt; (select PREV_WEEKDAY from(select sysdate as current_date,\n       case when to_char(sysdate,'D') in (1,2,7)\n            then next_day(sysdate-7,'Friday')\n            else sysdate-1 end as prev_weekday\nfrom dual))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 4933529, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/bf1e5dcfde761b3026a21ab7b93f6376?s=128&d=identicon&r=PG&f=1", "display_name": "Tommeck37", "link": "https://stackoverflow.com/users/4933529/tommeck37"}, "edited": false, "score": 0, "creation_date": 1434012705, "post_id": 30775752, "comment_id": 49602452, "body": "It works thank you very much. I only had to remove the notes inside the code."}], "tags": [], "owner": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "is_accepted": true, "score": 2, "last_activity_date": 1434012041, "creation_date": 1434012041, "answer_id": 30775752, "question_id": 30762986, "link": "https://stackoverflow.com/questions/30762986/1-working-day-back-in-sql-db2/30775752#30775752", "title": "1 Working Day Back In SQL DB2", "body": "<pre><code>select * \nfrom mytable \nwhere mydate = current date - \n    (case when dayofweek(current date) = 1 then 2 -- sonntag\n          when dayofweek(current date) = 2 then 3 -- montag\n          else 1 end) days\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 4933529, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/bf1e5dcfde761b3026a21ab7b93f6376?s=128&d=identicon&r=PG&f=1", "display_name": "Tommeck37", "link": "https://stackoverflow.com/users/4933529/tommeck37"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 30775752, "answer_count": 2, "score": 2, "last_activity_date": 1434012041, "creation_date": 1433956306, "question_id": 30762986, "link": "https://stackoverflow.com/questions/30762986/1-working-day-back-in-sql-db2", "title": "1 Working Day Back In SQL DB2", "body": "<p>I need to select data from database with a date that is one day back into the past but on working day. Is there a specific function for that ( Excel has got formula =Workday)?</p>\n\n<p>I am downloading data from DB2 to excel with VBA instructions.</p>\n\n<p>Here is the piece of code I use for calendar day.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>strSQL = \"SELECT *\"\r\nstrSQL = strSQL &amp; \" FROM PDB2I.DI_HIS_EXH_RAT_01\"\r\nstrSQL = strSQL &amp; \" WHERE CAR_DT = CURRENT DATE - 1 DAY\"</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Thanks in advance for any directions</p>\n"}, {"tags": ["string", "excel", "date", "vba"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1433955882, "post_id": 30762693, "comment_id": 49578182, "body": "What does <code>pass through a range of cells</code> mean?  Can you provide an example of expected output?  Are you just overwriting the existing data within cells?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1433955988, "post_id": 30762693, "comment_id": 49578248, "body": "What range of cells?  Soemthing like <code>Range(&quot;A1:A10&quot;).Value = TheDate</code> should do it..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1433956184, "post_id": 30762693, "comment_id": 49578385, "body": "If you are looking to ignore blanks in <i>a range of cells in a specific column</i> then use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\">Range.SpecialCells method</a>."}, {"owner": {"reputation": 2276, "user_id": 2464865, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PG1SL.png?s=128&g=1", "display_name": "Jared Newnam", "link": "https://stackoverflow.com/users/2464865/jared-newnam"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433956310, "post_id": 30762693, "comment_id": 49578456, "body": "@Byron - You are on the right track. Overwriting the current data is what I&#39;m trying to do."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433956594, "post_id": 30762693, "comment_id": 49578635, "body": "All the answers put the value somewhere.  If you want to only touch cells with existing data (avoid blanks maybe), you can use <code>Range.SpecialCells(xlCellTypeConstants).Value = TheDate</code> where <code>Range</code> is defined in the various ways people are doing down below.  I don&#39;t want to add a 4th nearly identical answer."}], "answers": [{"comments": [{"owner": {"reputation": 2276, "user_id": 2464865, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PG1SL.png?s=128&g=1", "display_name": "Jared Newnam", "link": "https://stackoverflow.com/users/2464865/jared-newnam"}, "edited": false, "score": 0, "creation_date": 1433959442, "post_id": 30762911, "comment_id": 49580378, "body": "How would I set the range to cover all the cells with data. I don&#39;t want to leave it at just those 10 cells... Make sense?"}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 1, "last_activity_date": 1433956053, "creation_date": 1433956053, "answer_id": 30762911, "question_id": 30762693, "link": "https://stackoverflow.com/questions/30762693/pass-date-input-string-to-cell-range/30762911#30762911", "title": "Pass date input string to cell range", "body": "<p>You have some logic wrong so i fixed it, ie using dateString but no declaration and checking it when no value was set (assuming you fixed it as it is no longer showing in your code).  Other than that you just need to define the range and set the value.  Example below</p>\n\n<pre><code>Sub dateInput()\nDim r As Range\nSet r = Cells.Range(Cells(1, 1), Cells(10, 1))\n\n\n    Dim TheString As String, TheDate As Date\n    TheString = Application.InputBox(\"Enter Certificate Date\")\n    If IsDate(TheString) Then\n        TheDate = DateValue(TheString)\n    Else\n        MsgBox \"That's not good!\"\n    End If\n\n    r.Value = TheDate\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2276, "user_id": 2464865, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PG1SL.png?s=128&g=1", "display_name": "Jared Newnam", "link": "https://stackoverflow.com/users/2464865/jared-newnam"}, "edited": false, "score": 0, "creation_date": 1433957491, "post_id": 30762938, "comment_id": 49579176, "body": "How can I set the range to fill cells with data. I don&#39;t necessarily want it to stop at B10. Make sense?"}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "reply_to_user": {"reputation": 2276, "user_id": 2464865, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PG1SL.png?s=128&g=1", "display_name": "Jared Newnam", "link": "https://stackoverflow.com/users/2464865/jared-newnam"}, "edited": false, "score": 0, "creation_date": 1434016165, "post_id": 30762938, "comment_id": 49604847, "body": "I think you already got your answer below but if you still have problems please let me know."}, {"owner": {"reputation": 2276, "user_id": 2464865, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PG1SL.png?s=128&g=1", "display_name": "Jared Newnam", "link": "https://stackoverflow.com/users/2464865/jared-newnam"}, "edited": false, "score": 0, "creation_date": 1434115039, "post_id": 30762938, "comment_id": 49656455, "body": "Based on your answer above, I would like to know how to set that range to go from A1:? - meaning set the end range to unlimited so that it carries through all cells that contain data."}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "reply_to_user": {"reputation": 2276, "user_id": 2464865, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PG1SL.png?s=128&g=1", "display_name": "Jared Newnam", "link": "https://stackoverflow.com/users/2464865/jared-newnam"}, "edited": false, "score": 0, "creation_date": 1434350890, "post_id": 30762938, "comment_id": 49721879, "body": "sorry for late reply. Please see updated code to find and use all the used range in the worksheet."}], "tags": [], "owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "is_accepted": true, "score": 2, "last_activity_date": 1434350853, "last_edit_date": 1434350853, "creation_date": 1433956160, "answer_id": 30762938, "question_id": 30762693, "link": "https://stackoverflow.com/questions/30762693/pass-date-input-string-to-cell-range/30762938#30762938", "title": "Pass date input string to cell range", "body": "<p>You can use following sample to replace all the non empty cells in the range with the date:</p>\n\n<pre><code>Sub dateInput()\n    Dim dateString As String, TheDate As Date\n    Dim rng As Range\n    Dim LastRow As Long\n    Dim LastCol As Long\n    Dim ws As Worksheet\n    Dim wb As Workbook\n\n    Set wb = ActiveWorkbook '&lt;-- Workbook you are working in\n    Set ws = wb.ActiveSheet '&lt;-- Worksheet you are working in\n\n\n    With ws\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then '&lt;-- Finding last row used\n            LastRow = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n             '&lt;-- Finding last column used\n            LastCol = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByColumns, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Column\n        Else\n            LastCol = 1 '&lt;-- Selecting first column if nothing found\n            LastRow = 1 '&lt;-- Selecting first row if nothing found\n        End If\n    End With\n\n    Set rng = ActiveSheet.Range(Cells(1, 1), Cells(LastRow, LastCol)) '&lt;-- You can set your range here\n\n    dateString = Application.InputBox(\"Enter Certificate Date\")\n    If IsDate(dateString) Then\n        TheDate = DateValue(dateString)\n\n        For Each c In rng.Cells\n            If c.Value &lt;&gt; \"\" Then\n                c.Value = TheDate\n            End If\n        Next\n    Else\n        MsgBox \"That's not good!\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433956803, "post_id": 30762968, "comment_id": 49578752, "body": "Like this one most.  Could replace the loop with a <code>r.SpecialCells(xlCellTypeConstants).Value = TheDate</code> and get rid of <code>Intersect</code> also.  That assumes there are no formulas and current data is <code>Constant</code> but that seems safe-ish."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433972423, "post_id": 30762968, "comment_id": 49587766, "body": "@Byron Nice suggestion!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1433956261, "creation_date": 1433956261, "answer_id": 30762968, "question_id": 30762693, "link": "https://stackoverflow.com/questions/30762693/pass-date-input-string-to-cell-range/30762968#30762968", "title": "Pass date input string to cell range", "body": "<p>This will allow the user to pick the column:</p>\n\n<pre><code>Sub dateInput()\n        Dim dateString As String, TheDate As Date, r As Range\n        dateString = Application.InputBox(\"Enter Certificate Date\")\n        If IsDate(dateString) Then\n            TheDate = DateValue(dateString)\n        Else\n            MsgBox \"That's not good!\"\n        End If\n\n   Set r = Application.InputBox(\"O.K.  Now pick a column\", Type:=8)\n   For Each rr In Intersect(r, ActiveSheet.UsedRange)\n      If rr.Value &lt;&gt; \"\" Then\n         rr.Value = TheDate\n      End If\n   Next rr\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2276, "user_id": 2464865, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PG1SL.png?s=128&g=1", "display_name": "Jared Newnam", "link": "https://stackoverflow.com/users/2464865/jared-newnam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 30762938, "answer_count": 3, "score": 0, "last_activity_date": 1434350853, "creation_date": 1433955405, "last_edit_date": 1531161705, "question_id": 30762693, "link": "https://stackoverflow.com/questions/30762693/pass-date-input-string-to-cell-range", "title": "Pass date input string to cell range", "body": "<p>I am trying to pass the date entered in this input box through a range of cells in a specific column. The range isn't specific but must fill all the cells that currently contain data in that column.</p>\n\n<pre><code>'Date input box\n    Sub dateInput()\n        Dim dateString As String, TheDate As Date\n        dateString = Application.InputBox(\"Enter Certificate Date\")\n        If IsDate(dateString) Then\n            TheDate = DateValue(dateString)\n        Else\n            MsgBox \"That's not good!\"\n        End If\n    End Sub\n</code></pre>\n\n<p>This is as far as I've gotten, but I can't seem to feed the entered date into the range of cells. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 3, "user_id": 4995812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dc292b4678d1893c27a89e003490f6f?s=128&d=identicon&r=PG&f=1", "display_name": "broncos1120", "link": "https://stackoverflow.com/users/4995812/broncos1120"}, "edited": false, "score": 0, "creation_date": 1434027616, "post_id": 30762649, "comment_id": 49612994, "body": "You&#39;re welcome. You may want to use a more descriptive variable name than <code>rng1</code> and <code>rng2</code>. I wasn&#39;t feeling particularly creative yesterday, so I went with the simple. You know your data, so give it a meaningful name to make your future life (or the life of the next maintainer) a bit easier."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 1, "last_activity_date": 1433955282, "last_edit_date": 1495540275, "creation_date": 1433955282, "answer_id": 30762649, "question_id": 30762451, "link": "https://stackoverflow.com/questions/30762451/vba-checking-a-number-in-an-array-and-proceeding-when-not-present/30762649#30762649", "title": "VBA: Checking a number in an array and proceeding when not present", "body": "<p>You need to capture the result of the <code>.Find()</code> then test to see if you found anything:</p>\n\n<pre><code>Sub InsertLines()\n\nDim vBUsort As Variant\nDim vSheet As Worksheet\nDim i As Integer\nDim rng1 as Range\nDim rng2 as Range\n  vBUsort = Array(\"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\")\n  For Each vSheet In ThisWorkbook.Worksheets\n        Range(\"A1\").Select\n        Set rng1 = Application.ActiveSheet.Range(\"1:2\").Find(What:=\"BU Sort Priority\", _\n                    LookIn:=xlValues, _\n                    LookAt:=xlWhole, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False).Select\n        If not Rng1 = Nothing Then \n          With ActiveCell.EntireColumn.Select\n            For i = LBound(vBUsort) To UBound(vBUsort)\n              Set rng2 = Selection.Find(What:=vBUsort(i), After:=ActiveCell, _\n                LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, _\n                MatchCase:=False)\n                if not rng2 = Nothing then\n                  rng2.select\n                    ActiveCell.EntireRow.Insert\n                    ActiveCell.EntireRow.Interior.Color = 6697728\n                End If\n            Next i\n          End With\n        End If\n  Next vSheet\n\nEnd Sub\n</code></pre>\n\n<p>Also, <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a></p>\n"}], "owner": {"reputation": 3, "user_id": 4995812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dc292b4678d1893c27a89e003490f6f?s=128&d=identicon&r=PG&f=1", "display_name": "broncos1120", "link": "https://stackoverflow.com/users/4995812/broncos1120"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 30762649, "answer_count": 1, "score": 0, "last_activity_date": 1433955282, "creation_date": 1433954682, "last_edit_date": 1531164843, "question_id": 30762451, "link": "https://stackoverflow.com/questions/30762451/vba-checking-a-number-in-an-array-and-proceeding-when-not-present", "title": "VBA: Checking a number in an array and proceeding when not present", "body": "<p>I am fairly new to VBA.  In the below code, I am attempting to search the list of numbers in the array in a dynamic column. If the number is found, then a new line is inserted.  However, I get an error when the number in the array is not found. If there is a more efficient way to do the same thing, I would be happy to change the code. Any help is greatly appreciated.</p>\n\n<pre><code>Sub InsertLines()\n\nDim vBUsort As Variant\nDim vSheet As Worksheet\nDim i As Integer\nvBUsort = Array(\"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\")\n\n    For Each vSheet In ThisWorkbook.Worksheets\n        Range(\"A1\").Select\n        Application.ActiveSheet.Range(\"1:2\").Find(What:=\"BU Sort Priority\", _\n                    LookIn:=xlValues, _\n                    LookAt:=xlWhole, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False).Select\n\n        With ActiveCell.EntireColumn.Select\n\n        For i = LBound(vBUsort) To UBound(vBUsort)\n\n            Selection.Find(What:=vBUsort(i), After:=ActiveCell, _\n                LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, _\n                MatchCase:=False).Activate\n                ActiveCell.EntireRow.Insert\n                ActiveCell.EntireRow.Interior.Color = 6697728\n\n        Next i\n        End With\n    Next vSheet\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1433954882, "post_id": 30762400, "comment_id": 49577552, "body": "Do you mean the problem is that the values contained in <code>Me.CausaleMov</code> and <code>Me.txt_tipomov</code> do not get changed?"}, {"owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1433956323, "post_id": 30762400, "comment_id": 49578463, "body": "no no, not that, if Me.CausaleMov and Me.txt_tipomov get value and value match the case &quot;ARMI&quot; then all mentioned field to be update that are in if statements."}], "answers": [{"tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 0, "last_activity_date": 1433958383, "creation_date": 1433958383, "answer_id": 30763675, "question_id": 30762400, "link": "https://stackoverflow.com/questions/30762400/about-field-update-using-function-with-case/30763675#30763675", "title": "about field update using function with case", "body": "<p>When you say: </p>\n\n \n\n<pre class=\"lang-vb prettyprint-override\"><code>If Me.txtMatricola = \"\" Then r = \"Matricola\"\n</code></pre>\n\n<p>What you are doing is assigning the value: <code>\"Matricola\"</code> to the variable:<code>r</code>. Instead what I think you want is this: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Me.txtMatricola = \"\" Then Me.txtMatricola  = \"Matricola\" \n</code></pre>\n\n<p>This actually sets the value of the field: <code>txtMatricola</code> to <code>\"Matricola\"</code>.  This goes for all of the fields that are in your <code>Case</code> statements. </p>\n"}], "owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1436299191, "creation_date": 1433954526, "last_edit_date": 1436299191, "question_id": 30762400, "link": "https://stackoverflow.com/questions/30762400/about-field-update-using-function-with-case", "title": "about field update using function with case", "body": "<p>I'm trying to update some field value depending two string field using a function with <code>If</code> and <code>Case</code>, function below:</p>\n\n \n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Function checkDATI(tipotransazione As String, tipovendita As String) As String\n\nDim r As String\nr = \"\"\nIf tipotransazione = \"VENDITA\" Then\n    Select Case tipovendita\n        Case \"ARMI\"\n            If Me.txtMatricola = \"\" Then r = \"Matricola\"\n            If Me.txtModello = \"\" Then r = \"Modello\"\n            If Me.txtCalibro = \"\" Then r = \"Calibro\"\n            If Me.txtTipoArma = \"\" Then r = \"Tipo Arma\"\n            If Me.txtFabrica = \"\" Then r = \"Fabbrica\"\n        Case \"VENDITA ARMI/MUNIZIONI\"\n        Case \"MUNIZIONI\"\n    End Select\nEnd If\n\nIf tipotransazione = \"ACQUISTO\" Then\n    Select Case tipovendita\n        Case \"ARMI\"\n            If Me.txtMatricola = \"\" Then r = \"Matricola\"\n            If Me.txtModello = \"\" Then r = \"Modello\"\n            If Me.txtCalibro = \"\" Then r = \"Calibro\"\n            If Me.txtTipoArma = \"\" Then r = \"Tipo Arma\"\n            If Me.txtFabrica = \"\" Then r = \"Fabbrica\"\n        Case \"VENDITA ARMI/MUNIZIONI\"\n        Case \"MUNIZIONI\"\n    End Select\nEnd If\n\ncheckDATI = r\n\nEnd Function\n</code></pre>\n\n<p>And then when I call this function in a command button event as:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>MsgBox (checkDATI(Me.CausaleMov, Me.txt_tipomov))\n</code></pre>\n\n<p>It's not updating that field. What is wrong?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4793927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-htfTTycgtcY/AAAAAAAAAAI/AAAAAAAADRE/AWfETYPt0yA/photo.jpg?sz=128", "display_name": "ChiHam", "link": "https://stackoverflow.com/users/4793927/chiham"}, "edited": false, "score": 0, "creation_date": 1433962730, "post_id": 30763845, "comment_id": 49582405, "body": "<code>Sub combine() Dim MyFile As String Dim erow Dim Filepath As String Dim wbkOne As Workbook Dim wbkTwo As Workbook Filepath = &quot;T:\\NetSpend Supervisors\\SHARED QA\\&quot; MyFile = Dir(Filepath)  Set wbkOne = Workbooks.Open(&quot;T:\\NetSpend Supervisors\\SHARED QA\\QA_ana.xlsx&quot;) Set wbkTwo = Workbooks.Open(&quot;T:\\NetSpend Supervisors\\SHARED QA\\QA_carol.xlsx&quot;)      wbkTwo.Open     Range(&quot;A2:O2&quot;).Copy     ActiveWorkbook.Close         erow = combine.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row     ActiveSheet.Paste Destination:=Worksheets(&quot;combine&quot;).Range(Cells(erow, 1), Cells(erow, 4))     MyFile = Dir End Sub</code>"}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": true, "score": 0, "last_activity_date": 1433959039, "creation_date": 1433959039, "answer_id": 30763845, "question_id": 30761980, "link": "https://stackoverflow.com/questions/30761980/merge-3-workbooks-into-1-master-workbook-excel/30763845#30763845", "title": "Merge 3 Workbooks into 1 master workbook Excel", "body": "<p>If you've only got three specific files you want to open, I wouldn't bother looping through everything. Just use:</p>\n\n<pre><code>Dim wbkOne as workbook\nDim wbkTwo as workbook\netc\n\nset wbkOne = workbooks.Open(\"C:\\QA\\QA_ana.xlsm\")\nset wbkTwo = workbooks.Open(\"C:\\QA\\QA_carol.xlsm\")\netc\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4793927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-htfTTycgtcY/AAAAAAAAAAI/AAAAAAAADRE/AWfETYPt0yA/photo.jpg?sz=128", "display_name": "ChiHam", "link": "https://stackoverflow.com/users/4793927/chiham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 30763845, "answer_count": 1, "score": 0, "last_activity_date": 1433959039, "creation_date": 1433953250, "last_edit_date": 1531161705, "question_id": 30761980, "link": "https://stackoverflow.com/questions/30761980/merge-3-workbooks-into-1-master-workbook-excel", "title": "Merge 3 Workbooks into 1 master workbook Excel", "body": "<p>I have xls files that I want to merge in a master file called QA.xls, all the workbooks have the same columns. Want for it to look for a specific file in a directory, which names are:\n<strong>1. QA_ana  2. QA_carol  3. QA_vane</strong> I found the following code:</p>\n\n<pre><code>Sub LoopThroughDirectory()\nDim MyFile As String\nDim erow\nDim Filepath As String\nFilepath = \"C:\\QA\\\"\nMyFile = Dir(Filepath)\nDo While Len(MyFile) &gt; 0\n    If MyFile = \"QA.xlsm\" Then\n    Exit Sub\n    End If\n\n    Workbooks.Open (Filepath &amp; MyFile)\n    Range(\"A2:D2\").Copy\n    ActiveWorkbook.Close\n    erow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    ActiveSheet.Paste Destination:=Worksheets(\"Sheet1\").Range(Cells(erow, 1), Cells(erow, 4))\n\n    MyFile = Dir\nLoop\nEnd Sub\n</code></pre>\n\n<p>Can you please help me edit that code to use the files specific file names in a specific directory.</p>\n\n<p>regards</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "excel-2007", "vba"], "answers": [{"tags": [], "owner": {"reputation": 610, "user_id": 4453367, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Bab6s.jpg?s=128&g=1", "display_name": "newishuser", "link": "https://stackoverflow.com/users/4453367/newishuser"}, "is_accepted": false, "score": 0, "last_activity_date": 1434574012, "creation_date": 1434574012, "answer_id": 30902081, "question_id": 30761481, "link": "https://stackoverflow.com/questions/30761481/how-do-i-populate-an-excel-field-with-changing-web-data/30902081#30902081", "title": "How do I populate an Excel field with changing web data?", "body": "<p>You could get external data from the web, using Excel's inbuild ability to do so. However this would be extremely time consuming.</p>\n\n<p>If you did this for your example above you would have to create a worksheet with CNN's Alexa page linked to it. Then you would have to find the cell that contained the text \"Global rank iconX Y\" where X and Y are numeric values. These values are the Global ranking and change in the last 3 months respectively.</p>\n\n<p>In this example the cell is A87. Then it's just of cleaning up the redundant data from the cell using a formula like: </p>\n\n<p><code>=LEFT(SUBSTITUTE(A87, \"Global rank icon\", \"\"), FIND(\" \", SUBSTITUTE(A87, \"Global rank icon\", \"\")))</code></p>\n\n<p>This leaves you just needing to create a macro on the workbook open event:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    ActiveWorkbook.RefreshAll\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4995624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb3dd18d7cb72cdf28c05bd10756e87b?s=128&d=identicon&r=PG&f=1", "display_name": "Hedi", "link": "https://stackoverflow.com/users/4995624/hedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434574012, "creation_date": 1433951918, "last_edit_date": 1531161705, "question_id": 30761481, "link": "https://stackoverflow.com/questions/30761481/how-do-i-populate-an-excel-field-with-changing-web-data", "title": "How do I populate an Excel field with changing web data?", "body": "<p>I'm building a list on Excel 2011 (mac version). The first column is a list of websites. The second column is a list of corresponding Alexa Global ranks.</p>\n\n<p>The Problem: Alexa rankings change on a daily basis and my list needs to stay up-to-date. Can I link Excel to Alexa, so that each time a website's Alexa rank changes, it's corresponding Excel field changes accordingly? </p>\n\n<p>Ex of a website's Alexa page: <a href=\"http://www.alexa.com/siteinfo/cnn.com\" rel=\"nofollow\">http://www.alexa.com/siteinfo/cnn.com</a></p>\n"}, {"tags": ["vba", "autofilter"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433955235, "post_id": 30761460, "comment_id": 49577749, "body": "Do you get a runtime error?  If so, what does it say?  Does it give you the choice to <code>Debug or Continue</code>?  If <code>Debug</code> what line does it show the error?  If you can&#39;t debug, add a breakpoint to the first line and step through with F8 until you get an error.  What line is that on?  Please <a href=\"http://stackoverflow.com/posts/30761460/edit\">edit these details into your question</a>.  If it&#39;s not an actual error, can you tell us what it is doing/not doing vs. what is expected?"}, {"owner": {"reputation": 31, "user_id": 4784432, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0621df2c450114df668a602e452ed3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4784432/brian"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433959608, "post_id": 30761460, "comment_id": 49580474, "body": "There is no error, what is happening is that the filter dosent select everything except 0. So Either it will select all when I remove the criteria, or will not select anything in the check-box"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433959702, "post_id": 30761460, "comment_id": 49580535, "body": "Should the second one be <code>Criteria2</code> instead of <code>Criteria1</code>?  If that doesn&#39;t do it, I&#39;ll take a look shortly.  Also does this work outside of VBA? If you manually set the filters?"}, {"owner": {"reputation": 31, "user_id": 4784432, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0621df2c450114df668a602e452ed3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4784432/brian"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433960083, "post_id": 30761460, "comment_id": 49580787, "body": "Yes it works manually, I am trying to automate the process. So what I am trying to do is if in column B if they are zero I want to filter them out so only values are there, and then copy A to Q and get the last row from the macro ."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4784432, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0621df2c450114df668a602e452ed3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4784432/brian"}, "edited": false, "score": 0, "creation_date": 1433959512, "post_id": 30762642, "comment_id": 49580416, "body": "It the same issue as before, the filter will not select anything, so nothing is copied."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1433960488, "post_id": 30762642, "comment_id": 49581039, "body": "This should be the solution.  So something may be off up above.  What value is being returned for <code>LastValue</code>?  Using <code>SpecialCells</code> is not the best approach for this.  See <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">this discussion for alternatives</a>.  Note that <code>xlCellTypeLastCell</code> will ignore hidden rows so you want to clear any existing filter if you are coming in with one.  Inside your <code>With</code> add a <code>Debug.Print .Address</code> or <code>.Select</code> to see what range you are dealing with."}], "tags": [], "owner": {"reputation": 115, "user_id": 4985436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2779341c608fd128cf1e7d7be3b1bca?s=128&d=identicon&r=PG&f=1", "display_name": "TylerDurden", "link": "https://stackoverflow.com/users/4985436/tylerdurden"}, "is_accepted": true, "score": 1, "last_activity_date": 1433955275, "creation_date": 1433955275, "answer_id": 30762642, "question_id": 30761460, "link": "https://stackoverflow.com/questions/30761460/vba-autofilter-and-copy-visiable-data-to-another-feild/30762642#30762642", "title": "VBA - Autofilter and copy visiable data to another feild", "body": "<p>Replace</p>\n\n<pre><code>.AutoFilter Field:=2, Criteria1:=\"Select All\", Operator:=xlAnd, Criteria1:=\"&lt;&gt;0\"\n</code></pre>\n\n<p>with</p>\n\n<pre><code>.AutoFilter Field:=2, Criteria1:=\"&lt;&gt;0\", Operator:=xlAnd\n</code></pre>\n\n<p>and should work</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 4784432, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0621df2c450114df668a602e452ed3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4784432/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1434032406, "creation_date": 1434032406, "answer_id": 30783502, "question_id": 30761460, "link": "https://stackoverflow.com/questions/30761460/vba-autofilter-and-copy-visiable-data-to-another-feild/30783502#30783502", "title": "VBA - Autofilter and copy visiable data to another feild", "body": "<p>it was a very small syntax issue. below is the working code.</p>\n\n<p>The way to write the criteria so that zero is filtered out is </p>\n\n<p>Criteria1:<strong>=</strong>\"&lt;>0\". the = sign should be outside the parenthesis.</p>\n\n<pre><code>    Sub findlastrowwithvaluefilter()\nActiveWorkbook.Sheets(\"CASCADE -Offshore Upload Format\").Activate\n\nLastRow = ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row\n\n\n    With Range(\"A1:Q\" &amp; LastRow)\n        .AutoFilter\n        .AutoFilter Field:=2, Criteria1:=\"&lt;&gt;0\", Operator:=xlAnd\n        End With\n\n    Range(\"A2:Q\" &amp; LastRow).Select\n    ActiveSheet.Range(\"A1:Q1\" &amp; LastRow).Offset(1, 0).SpecialCells(xlCellTypeVisible).Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nMsgBox (LastRow)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4784432, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0621df2c450114df668a602e452ed3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4784432/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 30762642, "answer_count": 2, "score": 1, "last_activity_date": 1434032406, "creation_date": 1433951850, "question_id": 30761460, "link": "https://stackoverflow.com/questions/30761460/vba-autofilter-and-copy-visiable-data-to-another-feild", "title": "VBA - Autofilter and copy visiable data to another feild", "body": "<p>I have a dataset where I want to the VBA to do an auto-filter and in column B just unselect 0 and keep all the other values. </p>\n\n<p>Then copy the visible cells to a new sheet. Can someone help me what the error is</p>\n\n<p>Thanks</p>\n\n<pre><code>Sub findlastrowwithvaluefilter()\nActiveWorkbook.Sheets(\"CASCADE -Offshore Upload Format\").Activate\n\nLastRow = ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row\n\n    With Range(\"A1:Q\" &amp; LastRow)\n        .AutoFilter\n        .AutoFilter Field:=2, Criteria1:=\"Select All\", Operator:=xlAnd, Criteria1:=\"&lt;&gt;0\"\n\n        End With\n\n    Range(\"A2:Q\" &amp; LastRow).Select\n    ActiveSheet.Range(\"A1:Q1\" &amp; LastRow).Offset(1, 0).SpecialCells(xlCellTypeVisible).Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nMsgBox (LastRow)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "internet-explorer", "excel", "pixel"], "answers": [{"tags": [], "owner": {"reputation": 94, "user_id": 2444791, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/279d6eebc5391f30e5d35b334f617c4c?s=128&d=identicon&r=PG", "display_name": "user2444791", "link": "https://stackoverflow.com/users/2444791/user2444791"}, "is_accepted": false, "score": 0, "last_activity_date": 1445747585, "creation_date": 1445747585, "answer_id": 33326218, "question_id": 30761424, "link": "https://stackoverflow.com/questions/30761424/excel-vba-click-a-specific-pixel-location-in-an-open-ie-window/33326218#33326218", "title": "Excel VBA - Click a specific pixel location in an open IE window", "body": "<p>1, install Autoit<br>\n2, add reference to AutoitX.dll (tools--reference--browse and navigate to AutoitX.dll)<br>\n3. add this sinppet to your code  </p>\n\n<pre><code>Set x = CreateObject(\"AutoItX3.Control\")\nX.MouseClick \"left\", 500, 500\n</code></pre>\n"}], "owner": {"reputation": 504, "user_id": 1560582, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e2f2053d3cf39be2d61c25c0a3f93f00?s=128&d=identicon&r=PG", "display_name": "kamelkid2", "link": "https://stackoverflow.com/users/1560582/kamelkid2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 984, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445747585, "creation_date": 1433951779, "question_id": 30761424, "link": "https://stackoverflow.com/questions/30761424/excel-vba-click-a-specific-pixel-location-in-an-open-ie-window", "title": "Excel VBA - Click a specific pixel location in an open IE window", "body": "<p>I have an existing macro that navigates to a web page in an existing IE window. is there any way i can instruct excel to click on a specific pixel location?</p>\n\n<p>here is the plain english template for what i would like to accomplish</p>\n\n<pre><code>ie.navigate \"somesite.com\"\n\nwith ie.document\n     ie.click pixel 500,500\nend with\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "is_accepted": true, "score": 0, "last_activity_date": 1434560342, "creation_date": 1434560342, "answer_id": 30897860, "question_id": 30761420, "link": "https://stackoverflow.com/questions/30761420/vba-print-current-file-name-in-every-row/30897860#30897860", "title": "VBA - print current file name in every row", "body": "<p>ANSWER: prints 1 file name without its extension in column 4 and prints all names down column 1.</p>\n\n<pre><code>Set StartSht = Workbooks(\"name of the file you print to.xlsm\").Sheets(\"Sheet1\")\nMyFolder = \"C:\\wherever your opening files are\\\"\nSet hc4 = HeaderCell(StartSht.Range(\"A1\"), \"TOOLING DATA SHEET (TDS):\")\n...\n...\n\n'(5)\n    'print the file name to Column 4\n    StartSht.Cells(i, 4) = objFile.Name\n\n    With ws\n    'Print TDS name by searching for header\n         If Not ws.Range(\"A1:K1\").Find(What:=\"TOOLING DATA SHEET (TDS):\", LookAt:=xlWhole, LookIn:=xlValues) Is Nothing Then\n             Set TDS = ws.Range(\"A1:K1\").Find(What:=\"TOOLING DATA SHEET (TDS):\", LookAt:=xlWhole, LookIn:=xlValues).Offset(, 1)\n             StartSht.Range(StartSht.Cells(i, 1), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = TDS\n         Else\n             'print the file name wihtout the extension\n             StartSht.Range(StartSht.Cells(i, 1), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = GetFilenameWithoutExtension(objFile.Name)\n         End If\n         i = GetLastRowInSheet(StartSht) + 1\n     End With\n\n...\nEnd Sub\n...\n\n'(10)\nFunction GetLastRowInColumn(theWorksheet As Worksheet, col As String)\n    With theWorksheet\n        GetLastRowInColumn = .Range(col &amp; .Rows.count).End(xlUp).Row\n    End With\nEnd Function\n'(11)\nFunction GetLastRowInSheet(theWorksheet As Worksheet)\nDim ret\n    With theWorksheet\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            ret = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          LookAt:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            ret = 1\n        End If\n    End With\n    GetLastRowInSheet = ret\nEnd Function\n'(12)\n'get the file name without the extension\nFunction GetFilenameWithoutExtension(ByVal FileName)\n  Dim Result, i\n  Result = FileName\n  i = InStrRev(FileName, \".\")\n  If (i &gt; 0) Then\n    Result = Mid(FileName, 1, i - 1)\n  End If\n  GetFilenameWithoutExtension = Result\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 911, "favorite_count": 0, "accepted_answer_id": 30897860, "answer_count": 1, "score": 0, "last_activity_date": 1434560342, "creation_date": 1433951768, "question_id": 30761420, "link": "https://stackoverflow.com/questions/30761420/vba-print-current-file-name-in-every-row", "title": "VBA - print current file name in every row", "body": "<p>I have a working macro that loops through folder to open files and get important info from the columns of names \"HOLDER\" and \"CUTTING TOOL\" and printing all the info to one excel document, masterfile.</p>\n\n<p>I would like it to print the file name in column one in every row until the file closes so that for every entry in columns 2 and 3, there is also the file name entry in column 1, and hopefully also in column 4. </p>\n\n<p>I currently have it working so it prints the name in the first cell and the final cell, for example if column 2 had info in rows 1 thorugh 4, the file name is printed in the first column in row 1 and row 4. I need it to be all of the rows in between as well but I cannot seem to make that work. Any ideas?</p>\n\n<p><em>Section (5) is where I deal with printing to columns 1 and 4. The most recent fix was the line <code>StartSht.Cells((GetLastRowInColumn(StartSht, \"C\")), 1) = objFile.Name</code> which prints the file name to the last cell.</em></p>\n\n<p><strong>FULL CODE:</strong></p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughDirectory()\n\n    Const ROW_HEADER As Long = 10\n\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim MyFolder As String\n    Dim StartSht As Worksheet, ws As Worksheet\n    Dim WB As Workbook\n    Dim i As Integer\n    Dim LastRow As Integer, erow As Integer\n    Dim Height As Integer\n    Dim RowLast As Long\n    Dim f As String\n    Dim dict As Object\n    Dim hc As Range, hc1 As Range, hc2 As Range, hc3 As Range, d As Range\n\n\n    Set StartSht = Workbooks(\"masterfile.xlsm\").Sheets(\"Sheet1\")\n\n    'turn screen updating off - makes program faster\n    Application.ScreenUpdating = False\n\n    'location of the folder in which the desired TDS files are\n    MyFolder = \"C:\\Users\\trembos\\Documents\\TDS\\progress\\\"\n\n    'find the headers on the sheet\n    Set hc1 = HeaderCell(StartSht.Range(\"B1\"), \"HOLDER\")\n    Set hc2 = HeaderCell(StartSht.Range(\"C1\"), \"CUTTING TOOL\")\n\n    'create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'get the folder object\n    Set objFolder = objFSO.GetFolder(MyFolder)\n    i = 2\n\n\n    'loop through directory file and print names\n'(1)\n    For Each objFile In objFolder.Files\n        If LCase(Right(objFile.Name, 3)) = \"xls\" Or LCase(Left(Right(objFile.Name, 4), 3)) = \"xls\" Then\n'(2)\n            'Open folder and file name, do not update links\n            Set WB = Workbooks.Open(fileName:=MyFolder &amp; objFile.Name, UpdateLinks:=0)\n            Set ws = WB.ActiveSheet\n'(3)\n                'find CUTTING TOOL on the source sheet\n                Set hc = HeaderCell(ws.Cells(ROW_HEADER, 1), \"CUTTING TOOL\")\n                If Not hc Is Nothing Then\n\n                    Set dict = GetValues(hc.Offset(1, 0), \"SplitMe\")\n                    If dict.count &gt; 0 Then\n                        Set d = StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0)\n                        'add the values to the master list, column 3\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                    End If\n                Else\n                    'header not found on source worksheet\n                End If\n'(4)\n                'find HOLDER on the source sheet\n                Set hc3 = HeaderCell(ws.Cells(ROW_HEADER, 1), \"HOLDER\")\n                If Not hc3 Is Nothing Then\n                    Set dict = GetValues(hc3.Offset(1, 0))\n                    'If InStr(ROW_HEADER, \"HOLDER\") &lt;&gt; \"\" Then\n                    If dict.count &gt; 0 Then\n                        Set d = StartSht.Cells(Rows.count, hc1.Column).End(xlUp).Offset(1, 0)\n                        'add the values to the master list, column 2\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                    End If\n                    'End If\n                Else\n                    'header not found on source worksheet\n                End If\n'(5)\n            'print filename and TDS information\n            With WB\n                For Each ws In .Worksheets\n                        'print the file name to Column 1\n                        StartSht.Cells(i, 1) = objFile.Name\n                        StartSht.Cells((GetLastRowInColumn(StartSht, \"C\")), 1) = objFile.Name\n\n                        'print TDS name from J1 cell to Column 4\n                        With ws\n                           .Range(\"J1\").Copy StartSht.Cells(i, 4)\n                        End With\n                        i = GetLastRowInSheet(StartSht) + 1\n                'move to next file\n                Next ws\n'(6)\n                'close, do not save any changes to the opened files\n                .Close SaveChanges:=False\n            End With\n        End If\n    '(7)\n    'move to next file\n    Next objFile\n    'turn screen updating back on\n    Application.ScreenUpdating = True\n    ActiveWindow.ScrollRow = 1\nEnd Sub\n\n'(8)\n'get all unique column values starting at cell c\nFunction GetValues(ch As Range, Optional vSplit As Variant) As Object\n    Dim dict As Object\n    Dim rng As Range, c As Range\n    Dim v\n    Dim spl As Variant\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n\n    For Each c In ch.Parent.Range(ch, ch.Parent.Cells(Rows.count, ch.Column).End(xlUp)).Cells\n        v = Trim(c.Value)\n        If Len(v) &gt; 0 And Not dict.exists(v) Then\n\n            'exclude any info after \";\"\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \";\")\n            v = spl(0)\n            End If\n\n            'exclude any info after \",\"\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \",\")\n            v = spl(0)\n            End If\n\n            dict.Add c.Address, v\n        End If\n    Next c\n    Set GetValues = dict\nEnd Function\n\n'(9)\n'find a header on a row: returns Nothing if not found\nFunction HeaderCell(rng As Range, sHeader As String) As Range\n    Dim rv As Range, c As Range\n    For Each c In rng.Parent.Range(rng, rng.Parent.Cells(rng.Row, Columns.count).End(xlToLeft)).Cells\n        'copy cell value if it contains some string \"holder\" or \"cutting tool\"\n        If InStr(c.Value, sHeader) &lt;&gt; 0 Then\n            Set rv = c\n            Exit For\n        End If\n    Next c\n    Set HeaderCell = rv\nEnd Function\n\n'(10)\nFunction GetLastRowInColumn(theWorksheet As Worksheet, col As String)\n    With theWorksheet\n        GetLastRowInColumn = .Range(col &amp; .Rows.count).End(xlUp).Row\n    End With\nEnd Function\n\n\n'(11)\nFunction GetLastRowInSheet(theWorksheet As Worksheet)\nDim ret\n    With theWorksheet\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            ret = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            ret = 1\n        End If\n    End With\n    GetLastRowInSheet = ret\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 3966, "user_id": 469072, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/13ce453eb105a974aea64b2461cfc200?s=128&d=identicon&r=PG", "display_name": "joel goldstick", "link": "https://stackoverflow.com/users/469072/joel-goldstick"}, "edited": false, "score": 0, "creation_date": 1433952130, "post_id": 30761337, "comment_id": 49575791, "body": "what code have you tried?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1433954178, "post_id": 30761337, "comment_id": 49577112, "body": "So the first row would return nothing, second would return &quot;(FDLL)(731)&quot;, third row return &quot;(111)&quot;? Is that what you&#39;re looking to do?"}], "answers": [{"tags": [], "owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "is_accepted": false, "score": 1, "last_activity_date": 1433955323, "creation_date": 1433955323, "answer_id": 30762665, "question_id": 30761337, "link": "https://stackoverflow.com/questions/30761337/excel-formula-cell/30762665#30762665", "title": "Excel Formula cell", "body": "<p>Your question is not that clear however if you mean the result like in the picture below, also see the codes:</p>\n\n<p><img src=\"https://i.stack.imgur.com/yg5b5.png\" alt=\"enter image description here\"></p>\n\n<p>Cell B1:</p>\n\n<pre><code>=IFERROR(MID(A1,FIND(\"(\",A1,1)+1,FIND(\")\",A1,1)-FIND(\"(\",A1,1)-1),\"\")\n</code></pre>\n\n<p>Cell C1:</p>\n\n<pre><code>=IFERROR(MID(A1,FIND(\"(\",A1,FIND(\"(\",A1,1)+1)+1,FIND(\")\",A1,FIND(\")\",A1,1)+1)-FIND(\"(\",A1,FIND(\"(\",A1,1)+1)-1),\"\")\n</code></pre>\n\n<p>then copy both formulas to the remaining cells in the column</p>\n"}], "owner": {"reputation": 1, "user_id": 3193841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c4fdd2a71a7f94e84c05f069fd2234f?s=128&d=identicon&r=PG&f=1", "display_name": "user3193841", "link": "https://stackoverflow.com/users/3193841/user3193841"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1433955323, "creation_date": 1433951583, "last_edit_date": 1531161705, "question_id": 30761337, "link": "https://stackoverflow.com/questions/30761337/excel-formula-cell", "title": "Excel Formula cell", "body": "<pre><code>CORP_HQ-[HQ Corporate]\nFDLL_731-[FDLL(FDLL)(731)]\nFIL_111-[FIL(111)]\nSLR_MEX_HOLD_II-[ SLR Mex Hold II (S863)]\nSMART_BV_HOLD_EUR-[Smart BV Holding (260) EURO]\n</code></pre>\n\n<p>I need an Excel formula to get the values in (   ) in a new cell.\nplease help me to get it.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 4995642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcca2e0aca27fc974c28efa7189ea3b?s=128&d=identicon&r=PG&f=1", "display_name": "PurpleKaty86", "link": "https://stackoverflow.com/users/4995642/purplekaty86"}, "edited": false, "score": 0, "creation_date": 1434128079, "post_id": 30761229, "comment_id": 49664791, "body": "that is the user box code - the rest of the sheet code is     Private Sub Workbook_SheetActivate(ByVal Sh As Object)     If Sh.Name &lt;&gt; &quot;Main&quot; Then         If Sh.Name &lt;&gt; ActiveWorkbook.CustomDocumentProperties(&quot;auth&quot;).Value Then             Sh.Visible = False             MsgBox &quot;You don&#39;t have authorization to view that sheet&quot;         End If     End If End Sub"}], "owner": {"reputation": 11, "user_id": 4995642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdcca2e0aca27fc974c28efa7189ea3b?s=128&d=identicon&r=PG&f=1", "display_name": "PurpleKaty86", "link": "https://stackoverflow.com/users/4995642/purplekaty86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1433957668, "creation_date": 1433951254, "last_edit_date": 1531161705, "question_id": 30761229, "link": "https://stackoverflow.com/questions/30761229/accessing-multiple-pages-in-a-user-locked-excel-document", "title": "Accessing Multiple pages in a User locked excel document", "body": "<p>I am trying to create a budget document in which each department only has access to their particular page - I have that part working - I am having trouble allowing an ADMIN to access all of the pages.\nThis is what I have as the code for my UserForm so far: (I would like \"Scott\" to be able to open all of the pages not just \"overview\")</p>\n\n<pre><code>Dim bOK2Use As Boolean\n\nPrivate Sub btnOK_Click()\nDim bError As Boolean\nDim sSName As String\nDim ws As Worksheet\nDim p As DocumentProperty\nDim bSetIt As Boolean\n\nbOK2Use = False\nbError = True\nIf Len(txtUser.Text) &gt; 0 And Len(txtPass.Text) &gt; 0 Then\n    bError = False\n    Select Case txtUser.Text\n        Case \"Scott\"\n            sSName = \"Overview\"\n            If txtPass.Text &lt;&gt; \"act2\" Then bError = True\n        Case \"Chris\"\n            sSName = \"Run Crew\"\n            If txtPass.Text &lt;&gt; \"act2\" Then bError = True\n        Case Else\n            bError = True\n    End Select\nEnd If\nIf bError Then\n    MsgBox \"Invalid User Name or Password\"\nElse\n    'Set document property\n    bSetIt = False\n    For Each p In ActiveWorkbook.CustomDocumentProperties\n        If p.Name = \"auth\" Then\n            p.Value = sSName\n            bSetIt = True\n            Exit For\n        End If\n    Next p\n    If Not bSetIt Then\n        ActiveWorkbook.CustomDocumentProperties.Add _\n          Name:=\"auth\", LinkToContent:=False, _\n          Type:=msoPropertyTypeString, Value:=sSName\n    End If\n\n\n    bOK2Use = True\n    Unload UserForm1\nEnd If\nEnd Sub\n\nPrivate Sub UserForm_Terminate()\nIf Not bOK2Use Then\n    ActiveWorkbook.Close (False)\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1433951816, "post_id": 30761096, "comment_id": 49575573, "body": "so? what is your problem? what do you mean when you say &quot;link&quot;, instead of values you want to display something like <code>=D15</code> in the target cell?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1433954981, "post_id": 30761096, "comment_id": 49577610, "body": "If <code>link</code> means via formula then you need to use <code>Range.Formula = &quot;=&quot; &amp; Range(&quot;D15&quot;).Address</code> where <code>Range</code> is whatever cell you want to have that formula.  If they are on different sheets, then you need to add the sheet name to the formula as well: <code>&quot;=&#39;&quot; &amp; Range(&quot;D15&quot;).Parent.Name &amp; &quot;&#39;!&quot; &amp; Range(&quot;D15&quot;).Address</code>."}, {"owner": {"reputation": 23, "user_id": 3266075, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000081104406/picture?type=large", "display_name": "user3266075", "link": "https://stackoverflow.com/users/3266075/user3266075"}, "edited": false, "score": 0, "creation_date": 1434006720, "post_id": 30761096, "comment_id": 49598509, "body": "By link, I mean I want to be able to change the number at either the master or parent and both of them change. If I delete the parent sheet the   row should be deleted as well"}], "owner": {"reputation": 23, "user_id": 3266075, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000081104406/picture?type=large", "display_name": "user3266075", "link": "https://stackoverflow.com/users/3266075/user3266075"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1433950895, "creation_date": 1433950895, "question_id": 30761096, "link": "https://stackoverflow.com/questions/30761096/reference-copied-data-to-original-cells", "title": "Reference copied data to original cells", "body": "<p>I am trying to reference copied data, to the initial cell.\nMy sequence is as follows</p>\n\n<ol>\n<li>Add newsheet on button click // sheetname Load1, Load2, etc</li>\n<li>Input data into new sheet</li>\n<li>Click Add new Load.</li>\n<li>Copy specific cells</li>\n<li>Paste in summary sheet</li>\n</ol>\n\n<p><strong>6. Link pasted values to the original worksheet cells???</strong></p>\n\n<p>My Code</p>\n\n<pre><code>Sub New_Load()\n\n\nDim i As Integer\nDim ws As Worksheet\nDim sh As Worksheet\nDim x1, x2, x3, x4, x5, x6, x7, x8 As Variant ' motor loads\nDim y1, y2, y3, y4, y5 As Variant 'UPS loads ' y5 (cell C14 with white text) sheetname\n\nSet ws = Sheets(\"Tech_Form\") '\n\nSet sh = Sheets(Sheets.Count) ' This will be the last sheet in the Workbook\nApplication.ScreenUpdating = 0\n\nIf Range(\"D15\") = \"UPS\" Then\n\nFill_Blanks 'fill blanks with N/A\n\ny1 = Range(\"D15\").Value\ny2 = Range(\"E42\").Value\ny3 = Range(\"H42\").Value\ny4 = Range(\"E46\").Value\ny5 = Range(\"C15\").Value\n\n\nSheets(\"Summary\").Select\n\nRange(\"C\" &amp; Rows.Count).End(xlUp).Offset(1).Value = y1\nRange(\"E\" &amp; Rows.Count).End(xlUp).Offset(1).Value = y2\nRange(\"H\" &amp; Rows.Count).End(xlUp).Offset(1).Value = y3\nRange(\"I\" &amp; Rows.Count).End(xlUp).Offset(1).Value = y4\nRange(\"F\" &amp; Rows.Count).End(xlUp).Offset(1).Value = \"kWe\"\nRange(\"G\" &amp; Rows.Count).End(xlUp).Offset(1).Value = \"N/A\"\nRange(\"D\" &amp; Rows.Count).End(xlUp).Offset(1).Value = \"N/A\"\nRange(\"B\" &amp; Rows.Count).End(xlUp).Offset(1).Value = y5\n\n\nEnd If\n\nSheets(\"Load\").Visible = True\nSheets(\"Load\").Copy After:=sh\n\n\nSheets(Sheets.Count).Name = \"Load\" &amp; Sheets.Count - 4 ' number of static    sheets\n'ActiveSheet.Name = Range(\"D15\").Value\n\nSheets(\"Load\").Visible = False\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "events", "textbox"], "comments": [{"owner": {"reputation": 19518, "user_id": 968969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802303aaa5f03f4cec652171dffcbc7?s=128&d=identicon&r=PG", "display_name": "Tony Hopkinson", "link": "https://stackoverflow.com/users/968969/tony-hopkinson"}, "edited": false, "score": 1, "creation_date": 1433950822, "post_id": 30760956, "comment_id": 49574878, "body": "Quick and dirty solution is to just store that is has run somewhere (hidden cell say), then check that value in the other routine. Don&#39;t forget to think about whether you need to reset it though"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4500893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91a0611b2998d4f10df63e1bc4417adc?s=128&d=identicon&r=PG", "display_name": "Mabes", "link": "https://stackoverflow.com/users/4500893/mabes"}, "edited": false, "score": 0, "creation_date": 1434022573, "post_id": 30761934, "comment_id": 49609223, "body": "Gary&#39;s Student thanks for the reply. Will a Global variable work for userform events as well?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1434024697, "last_edit_date": 1495542118, "creation_date": 1433953099, "answer_id": 30761934, "question_id": 30760956, "link": "https://stackoverflow.com/questions/30760956/can-i-run-a-sub-based-on-whether-another-sub-has-run/30761934#30761934", "title": "Can I run a Sub based on whether another Sub has run?", "body": "<p>Use a <strong>Global</strong> variable to allow the two subs to communicate:</p>\n\n<pre><code>Public ImDone As Boolean\n\nSub ShouldRunFirst()\n   ImDone = True\nEnd Sub\n\nSub ShouldRunSecond()\n   If ImDone Then\n      MsgBox \"first macro has been run\"\n   Else\n      MsgBox \"first macro has not run yet\"\n   End If\nEnd Sub\n</code></pre>\n\n<p>EDIT#1:</p>\n\n<p>We need to make the <em>communication</em> variable visible across the board:</p>\n\n<ul>\n<li><em>Dim</em> it in a standard module</li>\n<li>Put the declaration at the top of the module</li>\n<li>Declare it a <em>Public</em></li>\n</ul>\n\n<p>It should then be \"visible\" to subs, and events.  See some of the answers <a href=\"https://stackoverflow.com/questions/2722146/how-do-i-declare-a-global-variable-in-vba\">Here</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14474924, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1PKUbfZXCAQ/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckMJ2G0ZkWWh2tsudU1nNSGLRekeQ/s96-c/photo.jpg?sz=128", "display_name": "Efiresites", "link": "https://stackoverflow.com/users/14474924/efiresites"}, "is_accepted": false, "score": 1, "last_activity_date": 1611869831, "creation_date": 1611869831, "answer_id": 65945586, "question_id": 30760956, "link": "https://stackoverflow.com/questions/30760956/can-i-run-a-sub-based-on-whether-another-sub-has-run/65945586#65945586", "title": "Can I run a Sub based on whether another Sub has run?", "body": "<p>SOLVED!</p>\n<p>My Workbook_Open code wouldn't work if I had a cocktail of other excel files open.  It wasn't connected to the conditional formatting you read about around this issue.  I'm really not sure how this got around it because I tried the .activate and also the EVENT time delay, but neither of those would work when the glitch appeared.  In this example the MSG box never opens for me to confirm the re-run was successful, however the issue has been resolved with the addition of the following code.  Just substitute your code where I put the 'Comments sections</p>\n<p>/CODE\nPublic ImDone As Boolean</p>\n<p>Public Sub Workbook_Open()</p>\n<p>ImDone = True\n'Run Code\nEnd Sub</p>\n<p>Public Sub BoolCheck()\nIf ImDone = True Then\nMsgBox &quot;code has run&quot;\nElse\n're-run code\nEnd Sub\n/Code</p>\n"}], "owner": {"reputation": 25, "user_id": 4500893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91a0611b2998d4f10df63e1bc4417adc?s=128&d=identicon&r=PG", "display_name": "Mabes", "link": "https://stackoverflow.com/users/4500893/mabes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3647, "favorite_count": 0, "accepted_answer_id": 30761934, "answer_count": 2, "score": 1, "last_activity_date": 1612019499, "creation_date": 1433950534, "last_edit_date": 1612019499, "question_id": 30760956, "link": "https://stackoverflow.com/questions/30760956/can-i-run-a-sub-based-on-whether-another-sub-has-run", "title": "Can I run a Sub based on whether another Sub has run?", "body": "<p>I have a userform with two text boxes to search a worksheet based on the value in either text box. The form populates other boxes based on the active cell.</p>\n<p>How can each sub check if the other has executed?</p>\n<p>Pseudocode:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Sub StatusTextBox_AfterUpdate()\n    'Check if TransitTextBox_AfterUpdate() has run\n    If yes Then End Sub\n    If No Then Carry on with the rest of StatusTextBox_AfterUpdate()\n</code></pre>\n<p>This would change the value of the <code>TransitTextBox</code> to pull from the worksheet, and I want to prevent the <code>TransitTextBox_AfterUpdate()</code> from running.</p>\n<p>As soon as the <code>TransitTextBox</code> is populated the <code>AfterUpdate</code> event runs and the two conflict. Is there a way of preventing this?</p>\n"}, {"tags": ["excel", "combinations", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4137543, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-rmzrahp446o/AAAAAAAAAAI/AAAAAAAAAD8/mLXBv8yUSdY/photo.jpg?sz=128", "display_name": "akshat khetan", "link": "https://stackoverflow.com/users/4137543/akshat-khetan"}, "edited": false, "score": 0, "creation_date": 1434026809, "post_id": 30764668, "comment_id": 49612399, "body": "Thank you so much John for your first answer on this platform which works like a charm :) . Thanks Again for the help!"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1433961529, "creation_date": 1433961529, "answer_id": 30764668, "question_id": 30760930, "link": "https://stackoverflow.com/questions/30760930/to-find-all-possible-combinations-of-strings-present-in-a-column-range-order-do/30764668#30764668", "title": "To find all possible combinations of strings present in a column range (order does not matter ,repetition not allowed)", "body": "<p>This is my first Stack Overflow answer:</p>\n\n<p>This might not be the most elegant approach, but it works. First eliminate any repetitions in the data. My inclination is to use a VBScript dictionary for that -- but you can do it in pure VBA like this. If you have n distinct items -- count from 0 to 2^n -1 in base 2, each of which corresponds to a combination (subset). You seem to want to throw out subsets of size less than 2. I wrote a function which does this, as well as a sub to test it with. The sub assumes that the data starts in A1 and is contiguous. It prints the results in column B:</p>\n\n<pre><code>Sub AddItem(C As Collection, x As Variant)\n    Dim i As Long\n    For i = 1 To C.Count\n        If C(i) = x Then Exit Sub\n    Next i\n    C.Add (x)\nEnd Sub\n\nFunction Base2(number As Long, width As Long) As String\n    'assumes that width is long enough to hold number\n    Dim n As Long, i As Long, r As Long, s As String\n    Dim bits As Variant\n    ReDim bits(1 To width)\n    n = number\n    i = width\n    Do While n &gt; 0\n        r = n Mod 2\n        n = Int(n / 2)\n        If r &gt; 0 Then bits(i) = 1\n        i = i - 1\n    Loop\n    For i = 1 To width\n        s = s &amp; IIf(bits(i) &gt; 0, \"1\", \"0\")\n    Next i\n    Base2 = s\nEnd Function\n\n'in what follows items is a variant array of strings\n'it returns a variant array of strings consiting\n'of combinations (of size &gt; 1) of strings\nFunction Combos(items As Variant) As Variant\n    Dim i As Long, j As Long, k As Long, m As Long, n As Long\n    Dim b As String, s As String\n    Dim oneCount As Long\n    Dim itemSet As New Collection\n    Dim retArray As Variant\n    For i = LBound(items) To UBound(items)\n        AddItem itemSet, items(i)\n    Next i\n    n = itemSet.Count\n    ReDim retArray(1 To 2 ^ n - n - 1)\n    i = 0\n    For j = 3 To 2 ^ n - 1\n        b = Base2(j, n)\n        oneCount = 0\n        s = \"\"\n        For k = 1 To n\n            If Mid(b, k, 1) = \"1\" Then\n                s = s &amp; itemSet(k)\n                oneCount = oneCount + 1\n            End If\n        Next k\n        If oneCount &gt; 1 Then\n            i = i + 1\n            retArray(i) = s\n        End If\n    Next j\n    Combos = retArray\nEnd Function\n\nSub test()\n    Dim r As Range, v As Variant, i As Long, n As Long\n    Set r = Range(\"A1\", Range(\"A1\").End(xlDown))\n    n = r.Cells.Count\n    ReDim v(1 To n)\n    For i = 1 To n\n        v(i) = r.Cells(i)\n    Next i\n    v = Combos(v)\n    For i = 1 To UBound(v)\n        Range(\"B:B\").Cells(i).Value = v(i)\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4137543, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-rmzrahp446o/AAAAAAAAAAI/AAAAAAAAAD8/mLXBv8yUSdY/photo.jpg?sz=128", "display_name": "akshat khetan", "link": "https://stackoverflow.com/users/4137543/akshat-khetan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 0, "accepted_answer_id": 30764668, "answer_count": 1, "score": 0, "last_activity_date": 1433961529, "creation_date": 1433950478, "last_edit_date": 1531161705, "question_id": 30760930, "link": "https://stackoverflow.com/questions/30760930/to-find-all-possible-combinations-of-strings-present-in-a-column-range-order-do", "title": "To find all possible combinations of strings present in a column range (order does not matter ,repetition not allowed)", "body": "<p>I want to get all possible combinations of certain values present in a column range and print them in an excel sheet:</p>\n\n<p>Please note that the order of combination does not matter i.e AB=BA</p>\n\n<p>Here is an example of data in column1 for which combinations are to be found:</p>\n\n<pre><code>F1\nF2\nF3\nF4\n</code></pre>\n\n<p>The possible combinations of these are :</p>\n\n<pre><code>F1F2\nF1F3\nF1F4\nF2F3\nF2F4\nF3F4\nF1F2F3\nF1F2F4\nF1F3F4\nF2F3F4\nF1F2F3F4\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 336, "user_id": 3708261, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2f3fb7ab686d3b7847effa3ef4a3c970?s=128&d=identicon&r=PG&f=1", "display_name": "Othya", "link": "https://stackoverflow.com/users/3708261/othya"}, "edited": false, "score": 0, "creation_date": 1433949964, "post_id": 30760642, "comment_id": 49574280, "body": ".Value of a cell doesn&#39;t return the type &quot;time&quot; unless you convert it first. I&#39;d create new variables instead."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1433950049, "creation_date": 1433950049, "answer_id": 30760764, "question_id": 30760642, "link": "https://stackoverflow.com/questions/30760642/how-to-add-times-in-vba-getting-type-mismatch/30760764#30760764", "title": "How to add times in VBA? Getting Type Mismatch", "body": "<p>Replace:</p>\n\n<pre><code>Time(0, 5, 0)\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>TimeSerial(0, 5, 0)\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 4994901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/825a3433502c12cd9c905ed897b241e6?s=128&d=identicon&r=PG&f=1", "display_name": "mataxu", "link": "https://stackoverflow.com/users/4994901/mataxu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 30760764, "answer_count": 1, "score": 0, "last_activity_date": 1433950049, "creation_date": 1433949729, "question_id": 30760642, "link": "https://stackoverflow.com/questions/30760642/how-to-add-times-in-vba-getting-type-mismatch", "title": "How to add times in VBA? Getting Type Mismatch", "body": "<p>Below is some of my code in which I'm trying to add time to a value as part of a For loop. The sheet Par\u00e1metros has a cell B1 that only accepts Times (I made sure using the Data Validation tool). So I'm confused why I keep getting the error of \"Type Mismatch.\" I also want to convert the time to a string so that I can concatenate it with some text, and I'm not sure how to do that either.. Any help is appreciated :)</p>\n\n<pre><code>Sheets(\"Par\u00e1metros\").Range(\"B1\").Value = Sheets(\"Par\u00e1metros\").Range(\"B1\").Value + Time(0, 5, 0)\n</code></pre>\n"}, {"tags": ["excel", "vba", "rates"], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1433953400, "creation_date": 1433953400, "answer_id": 30762028, "question_id": 30760456, "link": "https://stackoverflow.com/questions/30760456/vba-pull-changing-exchange-rates-from-oanda/30762028#30762028", "title": "VBA - Pull changing exchange rates from Oanda", "body": "<p>Arrange the data how you want it and then use the Excel macro recorder to record the actions that you want to take. That will give you a good starting point. You can then examine the code, work out what it is doing and change it as required.</p>\n"}], "owner": {"reputation": 1, "user_id": 4995537, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vVOXFQmBe3Q/AAAAAAAAAAI/AAAAAAAAAQ8/yLuuqU1apnI/photo.jpg?sz=128", "display_name": "Alex Koford", "link": "https://stackoverflow.com/users/4995537/alex-koford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 691, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433953400, "creation_date": 1433949211, "last_edit_date": 1433950102, "question_id": 30760456, "link": "https://stackoverflow.com/questions/30760456/vba-pull-changing-exchange-rates-from-oanda", "title": "VBA - Pull changing exchange rates from Oanda", "body": "<p>I'm doing a project and need help getting started.</p>\n\n<p>Essentially what I am doing is pulling data with changing parameters every single day and need the exchange rate for the average period.</p>\n\n<p>Example: Today is June 10th. I need the Period Average from June 1st to June 9th of various exchange rates.</p>\n\n<p>The difficult part is that every day, I need to update the period range and change the exchange rates being viewed. So tomorrow, the 11th, I will need the PA from the 1st to the 10th.</p>\n\n<p>Anyone have any ideas on how to get started?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1433949350, "post_id": 30760193, "comment_id": 49573859, "body": "Have you tried a Sub like this <code>Call test3 Call test3b</code> to execute them both in the same run?"}, {"owner": {"reputation": 77, "user_id": 4755869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad510cbdc79c8c1de004caf18257de29?s=128&d=identicon&r=PG&f=1", "display_name": "Kenneth Berg", "link": "https://stackoverflow.com/users/4755869/kenneth-berg"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1433950721, "post_id": 30760193, "comment_id": 49574798, "body": "Sub test()                             &#39; added this to ThisOutlookSession       MsgBox CStr(varTest)       &#39; displays 0       Call test3       MsgBox CStr(varTest)       &#39; displays 42       Call test3b       MsgBox CStr(varTest)       &#39; displays 42     End Sub"}, {"owner": {"reputation": 77, "user_id": 4755869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad510cbdc79c8c1de004caf18257de29?s=128&d=identicon&r=PG&f=1", "display_name": "Kenneth Berg", "link": "https://stackoverflow.com/users/4755869/kenneth-berg"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1433951260, "post_id": 30760193, "comment_id": 49575184, "body": "But I need to have some variable values persist throughout ThisOutlookSession as well as accessible from Module1."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1433952074, "post_id": 30760193, "comment_id": 49575760, "body": "So apparently, it is only lasting during a run... Maybe you will have to store these values elsewhere (text file, xml, ...), but I&#39;m pretty disappointed too, it&#39;s not clean... I&#39;ll look into my outlook code and see if I had something like this to solve!"}, {"owner": {"reputation": 77, "user_id": 4755869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad510cbdc79c8c1de004caf18257de29?s=128&d=identicon&r=PG&f=1", "display_name": "Kenneth Berg", "link": "https://stackoverflow.com/users/4755869/kenneth-berg"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1433957211, "post_id": 30760193, "comment_id": 49579008, "body": "See my self answer below.  Essentially you just need to declare the Public variables and constants in a module and not in ThisOutlookSession."}, {"owner": {"reputation": 77, "user_id": 4755869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad510cbdc79c8c1de004caf18257de29?s=128&d=identicon&r=PG&f=1", "display_name": "Kenneth Berg", "link": "https://stackoverflow.com/users/4755869/kenneth-berg"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1434197681, "post_id": 30760193, "comment_id": 49683529, "body": "R3uK, typical use is for the user to start Outlook and leave it running while they are logged in.  But, should the user close and re-open Outlook, you would be correct that the values would be lost, and if that is not what is desired the program would need to store values in files, or Windows global variables, or the Registry.  For my application this was not an issue as only persistence within a login session was required.,"}], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1433959939, "post_id": 30761486, "comment_id": 49580687, "body": "OK Nice! I didn&#39;t know that! You can validate your own answer I think! ;)"}], "tags": [], "owner": {"reputation": 77, "user_id": 4755869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad510cbdc79c8c1de004caf18257de29?s=128&d=identicon&r=PG&f=1", "display_name": "Kenneth Berg", "link": "https://stackoverflow.com/users/4755869/kenneth-berg"}, "is_accepted": true, "score": 2, "last_activity_date": 1434010732, "last_edit_date": 1592644375, "creation_date": 1433951934, "answer_id": 30761486, "question_id": 30760193, "link": "https://stackoverflow.com/questions/30760193/outlook-2013-vba-public-variable-doesnt-persist/30761486#30761486", "title": "Outlook 2013 VBA Public Variable Doesn&#39;t Persist", "body": "<p>After much more searching, I found the following by <a href=\"http://www.outlookbanter.com/outlook-vba/49010-global-variables-session-variables.html\" rel=\"nofollow noreferrer\">Sue Mosher, Outlook MVP</a>:</p>\n<blockquote>\n<p>Remember that <strong>ThisOutlookSession is a class module</strong>.</p>\n<p>You need to <strong>add at least one regular code module</strong> to the project and <strong>declare your global variables in it</strong>, not in ThisOutlookSession, by using the <strong>Public\nkeyword</strong> instead of plain old Dim</p>\n</blockquote>\n<p>Sure enough when I move the Public variable definitions to a Module, the persistence issue is resolved.</p>\n"}], "owner": {"reputation": 77, "user_id": 4755869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad510cbdc79c8c1de004caf18257de29?s=128&d=identicon&r=PG&f=1", "display_name": "Kenneth Berg", "link": "https://stackoverflow.com/users/4755869/kenneth-berg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1497, "favorite_count": 1, "accepted_answer_id": 30761486, "answer_count": 1, "score": 0, "last_activity_date": 1593513988, "creation_date": 1433948545, "last_edit_date": 1593513988, "question_id": 30760193, "link": "https://stackoverflow.com/questions/30760193/outlook-2013-vba-public-variable-doesnt-persist", "title": "Outlook 2013 VBA Public Variable Doesn&#39;t Persist", "body": "<p>At the top of ThisOutlookSession I define:                                      </p>\n\n<pre><code>Option Explicit\nPublic varTest As Long\n</code></pre>\n\n<p>I have a couple of test programs also in ThisOutlookSession.</p>\n\n<p>Using debug I run this test3 program:</p>\n\n<pre><code>Sub test3()\n  varTest = 42\nEnd Sub\n</code></pre>\n\n<p>I then run test3b, but instead of varTest displaying a value of 42, its value shows as zero.</p>\n\n<pre><code>Sub test3b()\n  MsgBox varTest\nEnd Sub\n</code></pre>\n\n<p>Obviously I have some misconception about scope or persistence.  What am I doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 4961616, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/236d4743970ba0e02a4136545932cace?s=128&d=identicon&r=PG&f=1", "display_name": "BLkrn", "link": "https://stackoverflow.com/users/4961616/blkrn"}, "edited": false, "score": 0, "creation_date": 1434142264, "post_id": 30760189, "comment_id": 49672017, "body": "is it possible to not only copy but also the format as well?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1433948538, "creation_date": 1433948538, "answer_id": 30760189, "question_id": 30760038, "link": "https://stackoverflow.com/questions/30760038/copy-and-paste-entire-sheet-from-different-workbook/30760189#30760189", "title": "Copy and paste entire sheet from different workbook", "body": "<pre><code>wb2.Worksheets(1).Cells.Copy wb.Worksheets(2).Range(\"A1\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1433950305, "creation_date": 1433950305, "answer_id": 30760865, "question_id": 30760038, "link": "https://stackoverflow.com/questions/30760038/copy-and-paste-entire-sheet-from-different-workbook/30760865#30760865", "title": "Copy and paste entire sheet from different workbook", "body": "<p>Why not directly copy the first sheet into the second workbook :</p>\n\n<pre><code>wb2.Sheets(1).Copy Before:=wb.Sheets(2)\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 4961616, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/236d4743970ba0e02a4136545932cace?s=128&d=identicon&r=PG&f=1", "display_name": "BLkrn", "link": "https://stackoverflow.com/users/4961616/blkrn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1488362261, "creation_date": 1433948217, "last_edit_date": 1488362261, "question_id": 30760038, "link": "https://stackoverflow.com/questions/30760038/copy-and-paste-entire-sheet-from-different-workbook", "title": "Copy and paste entire sheet from different workbook", "body": "<p>Does anyone help me with copying the WHOLE sheet instead of C3:D4?</p>\n\n<pre><code>wb.Worksheets(2).Range(\"C3:D4\").Value = wb2.Worksheets(1).Range(\"A1:B2\").Value\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "answers": [{"comments": [{"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 1, "creation_date": 1433948013, "post_id": 30759807, "comment_id": 49572781, "body": "Just to expand slightly - if you had some value (say, from a text field on your form) with which you want to filter your query, then your <code>DLookup</code> would look something like: DLookup(&quot;[Total]&quot;, &quot;QryGetTotalTransactionsInManagement&quot;, &quot;[someParameterName] = &quot; &amp; Me.someFieldName.Value) if integer. If string you need to add single quotation marks (&#39;someString&#39;), if date hashtags (#date#)."}, {"owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "edited": false, "score": 0, "creation_date": 1433949292, "post_id": 30759807, "comment_id": 49573821, "body": "I am trying to do what @hansup suggested but receiving an &quot;object required&quot; error. Maybe I am doing this backwards.   Dlookup(&quot;[Total]&quot;, &quot;QryGetTotalTransactionsPotential&quot;) = [Form_Portfolio Status].TotalInPotential_txt.Value"}, {"owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "edited": false, "score": 0, "creation_date": 1433949591, "post_id": 30759807, "comment_id": 49574028, "body": "Nevermind @HansUp got it after looking at the Dlookup link you had posted.  Final solution:   <code>Dim Varx As Variant</code>  <code>Varx = Dlookup(&quot;[Total]&quot;, &quot;QryGetTotalTransactionsPotential&quot;)</code>  <code>[Form_Portfolio Status].TotalInPotential_txt.Value = Varx</code>"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1433948069, "last_edit_date": 1433948069, "creation_date": 1433947647, "answer_id": 30759807, "question_id": 30759662, "link": "https://stackoverflow.com/questions/30759662/is-there-a-more-efficient-way-to-display-multiple-query-results-in-different-tex/30759807#30759807", "title": "Is there a more efficient way to display multiple query results in different text boxes on a Form", "body": "<p>In each of those two examples, you're retrieving a single value from a saved query.  So <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834404.aspx\" rel=\"nofollow\">DLookup</a> could get the values with less code.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>DLookup(\"[Total]\", \"QryGetTotalTransactions\")\nDLookup(\"[Total]\", \"QryGetTotalTransactionsInManagement\")\n</code></pre>\n\n<p>You could assign the <code>DLookup</code> return value to a text box's <code>.Value</code> property ... like you were doing with the recordset value.  Or you could use the <code>DLookup</code> expression as the text box <em>Control Source</em>.</p>\n\n<p>Regarding efficiency, <code>DLookup</code> performance is not likely to be faster than the recordset approach.  But you wouldn't need all that code to manage DAO objects.  So perhaps there could be savings in developer time, which should count for something.  :-)</p>\n"}], "owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 30759807, "answer_count": 1, "score": 3, "last_activity_date": 1433950080, "creation_date": 1433947314, "last_edit_date": 1433950080, "question_id": 30759662, "link": "https://stackoverflow.com/questions/30759662/is-there-a-more-efficient-way-to-display-multiple-query-results-in-different-tex", "title": "Is there a more efficient way to display multiple query results in different text boxes on a Form", "body": "<p>I have a form with several different text boxes. Each text box is populated with the result of a different query. I'm not very familiar with VBA / Access (I am teaching myself) and am not sure if what I'm doing is the most efficient. I was hoping someone could suggest maybe a less cumbersome way of populating text boxes on a form with different queries, or perhaps even suggest a better variable naming convention.</p>\n\n<p>*edit - I think there is a way to place a formula directly in a text box rather than doing it through VBA but I received a #name error. </p>\n\n<pre><code>Private Sub Form_Load()\nDim db As DAO.Database\nDim qdf As QueryDef\nDim rst As Recordset\n\nDim qdf2 As QueryDef\nDim rst2 As Recordset\n\nSet db = CurrentDb()\n\nSet qdf = db.QueryDefs(\"QryGetTotalTransactions\")\nSet rst = qdf.OpenRecordset\n\nSet qdf2 = db.QueryDefs(\"QryGetTotalTransactionsInManagement\")\nSet rst2 = qdf2.OpenRecordset\n\n[Form_Portfolio Status].TotalTransaction_txt.Value = rst![Total]\n[Form_Portfolio Status].TotalInManagement_txt.Value = rst2![Total]\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 137, "user_id": 4994901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/825a3433502c12cd9c905ed897b241e6?s=128&d=identicon&r=PG&f=1", "display_name": "mataxu", "link": "https://stackoverflow.com/users/4994901/mataxu"}, "reply_to_user": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "edited": false, "score": 0, "creation_date": 1433947011, "post_id": 30759454, "comment_id": 49571923, "body": "Thank you! It works perfectly now :D"}], "answers": [{"tags": [], "owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "is_accepted": true, "score": 1, "last_activity_date": 1433951047, "last_edit_date": 1495541732, "creation_date": 1433947284, "answer_id": 30759655, "question_id": 30759454, "link": "https://stackoverflow.com/questions/30759454/vba-match-function-method-match-of-object-worksheetfunction-failed/30759655#30759655", "title": "VBA Match Function &quot;Method &#39;Match&#39; of Object &#39;WorksheetFunction&#39; Failed&quot;", "body": "<p>You should refer to <code>Range</code> as</p>\n\n<pre><code>Range(\"A1:A100\")\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>Range(\"A1,A100\")\n</code></pre>\n\n<p>Using comma you refer to <code>A1</code> and <code>A100</code> only.</p>\n\n<p>Also, if you are not sure if there is a match or not, you can use <code>Application.Match</code> and store the result in a <code>Variant</code> variable instead. The difference is that <code>Application.Match</code> returns an error when it fails, and then you can check if it has failed or not.</p>\n\n<p>Example (check <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835873.aspx\" rel=\"nofollow noreferrer\">MSDN</a> for full code):</p>\n\n<pre><code>Dim var As Variant\n\nvar = Application.Match(Cells(iRow, 1).Value, Worksheets(iSheet).Columns(1), 0)\n\nIf Not IsError(var) Then\n    Debug.Print \"There is actually a match\"\nElse\n    Debug.Print \"No match found\"\nEnd IF\n</code></pre>\n\n<p>A word of warning: If you match after row <code>32,767</code> <a href=\"https://stackoverflow.com/questions/10558540/vba-macro-crashes-after-32000-rows\">your code will not run</a>, because it exceeds the range of <code>Integer</code>. I suggest using <code>Long</code> instead of <code>Integer</code>. <a href=\"https://msdn.microsoft.com/en-us/library/office/aa164506(v=office.10).aspx\" rel=\"nofollow noreferrer\">Using Long is better practice in <code>VBA</code></a> anyway.</p>\n\n<p>Finally, note that if someone changes the name of the worksheet, this code will not run. <a href=\"https://stackoverflow.com/questions/27169070/identifying-a-worksheet-other-than-by-its-name/27169154#27169154\">It is safer to refer to the worksheet by using its sheet ID instead of its name</a> (Disclaimer: I have written the accepted response to that question).</p>\n"}], "owner": {"reputation": 137, "user_id": 4994901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/825a3433502c12cd9c905ed897b241e6?s=128&d=identicon&r=PG&f=1", "display_name": "mataxu", "link": "https://stackoverflow.com/users/4994901/mataxu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1491, "favorite_count": 1, "accepted_answer_id": 30759655, "answer_count": 1, "score": 0, "last_activity_date": 1433951047, "creation_date": 1433946777, "question_id": 30759454, "link": "https://stackoverflow.com/questions/30759454/vba-match-function-method-match-of-object-worksheetfunction-failed", "title": "VBA Match Function &quot;Method &#39;Match&#39; of Object &#39;WorksheetFunction&#39; Failed&quot;", "body": "<p>I'm trying to use the Match VBA function in a programming project in Excel to get the first row number with a \"1\" in it. The code I'm using is:</p>\n\n<pre><code>Dim BorradorVar As Integer\nBorradorVar = WorksheetFunction.Match(1, Sheets(\"Usuarios\").Range(\"A1,A100\"), 0)\n</code></pre>\n\n<p>Can someone explain what I'm doing wrong? Thanks! </p>\n"}, {"tags": ["vba", "excel", "function", "replace"], "comments": [{"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 1, "creation_date": 1433946974, "post_id": 30759204, "comment_id": 49571894, "body": "Please clarify your business logic: do you want the B2 content replacement based on the match found in B1 in the same Worksheet, like &quot;Sony Entertainement;Sony Pictures;Playstation&quot; to become just &quot;Sony&quot;? Thanks and regards,"}, {"owner": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "reply_to_user": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1433947622, "post_id": 30759204, "comment_id": 49572439, "body": "@AlexBell I&#39;ve made a mistake, the &quot;B2&quot; I wrote = C1 actually ^^&#39; I&#39;m gonna edit my post to correct this. Yes, I want &quot;Sony Entertainement&quot;, &quot;Sony Pictures&quot; and &quot;Playstation&quot; (C1) to be replaced by &quot;Sony&quot; (B1). Here is the <a href=\"http://img11.hostingpics.net/pics/403257dictionnary.png\" rel=\"nofollow noreferrer\">start of my first dictionnary</a>. Hope it helped you ! Regards,"}, {"owner": {"reputation": 2364, "user_id": 4347337, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xu2hN.jpg?s=128&g=1", "display_name": "Brino", "link": "https://stackoverflow.com/users/4347337/brino"}, "edited": false, "score": 0, "creation_date": 1433948724, "post_id": 30759204, "comment_id": 49573359, "body": "please show us an example of your expected output after the macro is run"}, {"owner": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "reply_to_user": {"reputation": 2364, "user_id": 4347337, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xu2hN.jpg?s=128&g=1", "display_name": "Brino", "link": "https://stackoverflow.com/users/4347337/brino"}, "edited": false, "score": 0, "creation_date": 1434012648, "post_id": 30759204, "comment_id": 49602411, "body": "@Brino I edited my question for that. ;)"}], "answers": [{"tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": false, "score": 1, "last_activity_date": 1433949664, "last_edit_date": 1433949664, "creation_date": 1433948335, "answer_id": 30760099, "question_id": 30759204, "link": "https://stackoverflow.com/questions/30759204/extract-cells-content-in-the-first-excel-file-based-on-worksheet-in-another-file/30760099#30760099", "title": "Extract Cells content in the first Excel File based on Worksheet in another File", "body": "<p>Based on your clarification, you can complete this task using Excel Formula like, for example <code>=IF(ISERROR(SEARCH(B1,C1)),C1,B1)</code> entered in cell D1 (returns \"Sony\" as per your sample data):</p>\n\n<pre><code>B           C                                               D\nSony        Sony Entertainement;Sony Pictures;Playstation   Sony\nPanasonic   Panasonic Corporation; Matsushita               Panasonic\nSamsung     Samsung Group;SamsungGalaxy;SamsungApps         Samsung\n</code></pre>\n\n<p>You can extend the Formula to entire Range, so column D will display the \"clean\" trimmed data. Also, you can automate this procedure via Excel VBA upon necessity.</p>\n\n<p><em>NOTE</em>: Pertinent to the 2nd answer posted, which include VBA iteration, you can use similar VBA formula using VBA <code>InStr()</code> function instead of <code>Split()</code> and <code>Replace()</code>, like:</p>\n\n<pre><code>For i = 1 To wsD.Range(\"C\" &amp; wsD.Rows.Count).End(xlUp).Row\n    For k = 1 To wsC.Range(\"C\" &amp; wsC.Rows.Count).End(xlUp).Row\n      If (InStr(wsC.Cells(k,3).Value, wsD.Cells(i,2).Value)&gt;0 Then \n          'you can assign the value to the Cell in Column C: wsC.Cells(k,3) \n          wsC.Cells(k,4) = wsD.Cells(i,2)  \n      End If\n    Next k\nNext i\n</code></pre>\n\n<p>Hope this may help.</p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "edited": false, "score": 0, "creation_date": 1434011648, "post_id": 30760132, "comment_id": 49601738, "body": "Hi, thank you for your answer ! However it doesn&#39;t work, I&#39;ve got an &quot;error &#39;9&#39; &quot;. I&#39;ve opened my file <code>TestVBA.xlsm</code>, which is in <code>D:\\Users\\maw\\Desktop\\excel` and saved your macro. My dictionnary was in the same folder and named </code>Dict.xlsx<code>, so I just renamed the 2 &quot;Workbooks&quot; by the name of the file, but still doesn&#39;t work. Ideally my dictionnary would be closed, and the path would be : </code>D:\\Users\\maw\\Documents\\resources\\Dict.xlsx`. Thank you !"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "edited": false, "score": 0, "creation_date": 1434013194, "post_id": 30760132, "comment_id": 49602763, "body": "Ok try the updated version, (don&#39;t forget to rename the Sheets as I don&#39;t know what their names are (here <code>Name1</code> and <code>Name2</code>)) which should open your Dictionnary and close it after (so don&#39;t open it or it may throw an error)"}, {"owner": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "edited": false, "score": 0, "creation_date": 1434013979, "post_id": 30760132, "comment_id": 49603314, "body": "When I try it I have an error 9 at the line : <code>Set wbC = Workbooks(&quot;TestVBA&quot;)</code>, so I replaced &quot;TestVBA&quot; with &quot;TestVBA.xslm&quot;, and now I have an error 9 at : <code>If LCase(DicC(1, l)) &lt;&gt; Trim(LCase(Dic(k))) Then</code>. I have made a <a href=\"http://img11.hostingpics.net/pics/559233error9.png\" rel=\"nofollow noreferrer\">screen capture</a>, maybe it&#39;ll be clearer. ^^"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "edited": false, "score": 0, "creation_date": 1434014214, "post_id": 30760132, "comment_id": 49603474, "body": "Ok my bad, I forgot to specify which dimension in the L_Ubound of DicC which has 2 dim, so it should work now! :)"}, {"owner": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "edited": false, "score": 0, "creation_date": 1434014781, "post_id": 30760132, "comment_id": 49603880, "body": "Now it works quite good ! :D The problem is that it doesn&#39;t replace the entire content of the cell when it matches, but only the expression itself. Example : <code>The new Sony Pictures movie</code> is now replaced by <code>The new Sony movie</code>, but I just want to hold <code>Sony</code> in the cell. Is that possible ? :D"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "edited": false, "score": 0, "creation_date": 1434018095, "post_id": 30760132, "comment_id": 49606197, "body": "Here you go! ;) It was just the Worksheet function replace that wasn&#39;t adapted ;)"}, {"owner": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "edited": false, "score": 0, "creation_date": 1434018460, "post_id": 30760132, "comment_id": 49606483, "body": "OK I solved the problem, I replaced the line <code>Cells.Replace What:=Trim(DicC(0, l)), _</code> by <code>Cells.Replace What:=&quot;*&quot; &amp; Trim(DicC(0, l)) &amp; &quot;*&quot;, _</code>. Now I have 2 minor things : 1- Can I tell the macro just to &quot;ignore&quot; the A column of my &quot;TestVBA&quot; file ? 2- I have some patterns like &quot;EU&quot; ==&gt; European Union, but the problem is that when EU is in a word (example : &quot;deuce&quot;), it counts it as a match. Basically in Java I&#39;d use a regex like : &quot;[^a-zA-Z]&quot;+Trim(word)+&quot;[^a-zA-Z]&quot;, what is the equivalent in VBA ?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "edited": false, "score": 0, "creation_date": 1434025546, "post_id": 30760132, "comment_id": 49611396, "body": "If you use my code, it&#39;ll work properly for your column C. For regex VBA : <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a> . For your other issue : <code>LookAt:=xlWhole</code> and <code>SearchOrder:=xlByColumns</code> in the replace that you posted first!"}, {"owner": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "edited": false, "score": 0, "creation_date": 1434117768, "post_id": 30760132, "comment_id": 49658357, "body": "I tried your solution with xlWhole and xlColumn, but it still takes into account my A column, is there a simple way to tell my macro &quot;Don&#39;t touch to my column A&quot;, or should I re-write all the Replace field ?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "edited": false, "score": 0, "creation_date": 1435585985, "post_id": 30760132, "comment_id": 50248158, "body": "To increase efficiency, use a Scripting Dictionary instead of the array DicC(), start with <code>Dim DicC</code> then <code>DicC = CreateObject(&quot;Scripting.Dictionnary&quot;)</code> and the for the rest, you&#39;ll find details all over the web, give it a try. If you don&#39;t succeed, post another question with a link to this one and my code with your replacements using the dictionnary so that people will take a look at the code to help you make it work!"}, {"owner": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "edited": false, "score": 0, "creation_date": 1435665997, "post_id": 30760132, "comment_id": 50286047, "body": "Haha I had just forgotten to remove the first &quot;For&quot; loop, so it treated the whole document for every line of my excel file &gt;&lt; Thank you very much anyway :p"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1434018061, "last_edit_date": 1434018061, "creation_date": 1433948422, "answer_id": 30760132, "question_id": 30759204, "link": "https://stackoverflow.com/questions/30759204/extract-cells-content-in-the-first-excel-file-based-on-worksheet-in-another-file/30760132#30760132", "title": "Extract Cells content in the first Excel File based on Worksheet in another File", "body": "<p>This is the literal translation of what you shown :</p>\n\n<pre><code>Sub MacroClear()\n\nDim wbD As Workbook, _\n    wbC As Workbook, _\n    wsD As Worksheet, _\n    wsC As Worksheet, _\n    Dic() As String\n'Replace the names in here with yours\nSet wbD = Workbooks(\"Dictionnary\")\nSet wbC = Workbooks(\"FileToClean\")\nSet wsD = wbD.Worksheets(\"Name1\")\nSet wsC = wbC.Worksheets(\"Name2\")\n\nFor i = 1 To wsD.Range(\"C\" &amp; wsD.Rows.Count).End(xlUp).Row\n    Dic = Split(wsD.Cells(i, 3), \";\")\n    For k = 1 To wsC.Range(\"C\" &amp; wsC.Rows.Count).End(xlUp).Row\n       Cells.Replace What:=Trim(Dic(i)), _\n            Replacement:=Trim(wsD.Cells(i, 2)), _\n            LookAt:=xlPart, _\n            SearchOrder:=xlByRows, _\n            MatchCase:=False, _\n            SearchFormat:=False, _\n            ReplaceFormat:=False\n    Next k\nNext i\n\nSet wbD = Nothing\nSet wbC = Nothing\nSet wsD = Nothing\nSet wsC = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>And the updated version :</p>\n\n<pre><code>Sub MacroClear()\n\nDim wbD As Workbook, _\n    wbC As Workbook, _\n    wsD As Worksheet, _\n    wsC As Worksheet, _\n    DicC() As Variant, _\n    Dic() As String, _\n    ValToReplace As String, _\n    IsInDic As Boolean, _\n    rCell As Range\n\n'Replace the names in here with yours\nSet wbD = Workbooks.Open(\"D:\\Users\\maw\\Documents\\resources\\Dict.xlsx\", ReadOnly:=True)\nSet wbC = Workbooks(\"TestVBA\")\nSet wsD = wbD.Worksheets(\"Name1\")\nSet wsC = wbC.Worksheets(\"Name2\")\n'Set global dictionnary dimension\nReDim DicC(1, 0)\n\nFor i = 1 To wsD.Range(\"C\" &amp; wsD.Rows.Count).End(xlUp).Row\n    Dic = Split(wsD.Cells(i, 3), \";\")\n    ValToReplace = Trim(wsD.Cells(i, 2))\n    For k = LBound(Dic) To UBound(Dic)\n        IsInDic = False\n        For l = LBound(DicC, 2) To UBound(DicC, 2)\n            If LCase(DicC(1, l)) &lt;&gt; Trim(LCase(Dic(k))) Then\n                'No match\n            Else\n                'Match\n                IsInDic = True\n                Exit For\n            End If\n        Next l\n        If IsInDic Then\n            'Don't add to DicC\n        Else\n            DicC(0, UBound(DicC, 2)) = Trim(Dic(k))\n            DicC(1, UBound(DicC, 2)) = ValToReplace\n            ReDim Preserve DicC(UBound(DicC, 1), UBound(DicC, 2) + 1)\n        End If\n    Next k\nNext i\n\nReDim Preserve DicC(UBound(DicC, 1), UBound(DicC, 2) - 1)\nwbD.Close\nErase Dic\n\n\nFor Each rCell In wsC.Range(\"C2:C\" &amp; wsC.Range(\"C\" &amp; wsC.Rows.Count).End(xlUp).Row).End(xlUp).Row\n    For l = LBound(DicC, 2) To UBound(DicC, 2)\n        If InStr(1, rCell.Value2, DicC(0, l)) &lt;&gt; 0 Then\n            rCell.Value2 = DicC(1, l)\n        Else\n            'Not found\n        End If\n    Next l\nNext rCell\n\n\nErase DicC\nSet wbD = Nothing\nSet wbC = Nothing\nSet wsD = Nothing\nSet wsC = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 4759193, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/81a43d88e3303b9a6cd6f3b9e376e536?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/4759193/malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 30760132, "answer_count": 2, "score": 0, "last_activity_date": 1488363115, "creation_date": 1433946214, "last_edit_date": 1488363115, "question_id": 30759204, "link": "https://stackoverflow.com/questions/30759204/extract-cells-content-in-the-first-excel-file-based-on-worksheet-in-another-file", "title": "Extract Cells content in the first Excel File based on Worksheet in another File", "body": "<p>In a first Excel File multiple Cells in Column C contains the address and the name of a company; I want to keep only the company name. For that, I have another Excel file (I'll call it \"Dictionary\"), which has a particular structure like the following:</p>\n\n<pre><code>Column B : Name that I want to keep.\nColumn C : Various Patterns of the name, delimited with \";\".\nExample : B1 = \"Sony\", C1=\"Sony Entertainement;Sony Pictures;Playstation\"\n</code></pre>\n\n<p>I need VBA macro reading Dictionary File, then for each pattern (surrounded with anything) replace it with the word I want to keep.</p>\n\n<p>My macro would look like :</p>\n\n<pre><code>Sub MacroClear()\n\n   &lt;For each line of my dictionnary&gt;\n        arrayC = split(&lt;cell C of my line&gt;, \";\")\n        &lt;For i in range arrayC&gt;\n           Cells.Replace What:=\"*\"&amp;Trim(arrayC(i))&amp;\"*\", Replacement:=Trim(&lt;cell B of my line&gt;), LookAt:= _\n              xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n              ReplaceFormat:=False\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT - UPDATE</strong> : I made a capture of my first Dictionary, it'll be easier to understand the structure :</p>\n\n<p><a href=\"http://img11.hostingpics.net/pics/403257dictionnary.png\" rel=\"nofollow noreferrer\">dictionnary http://img11.hostingpics.net/pics/403257dictionnary.png</a></p>\n\n<p><strong>EDIT - UPDATE 2</strong> : I made a screen cap of a \"non-cleaned\" file, then the result I want at the end.</p>\n\n<p>Not cleaned : <a href=\"http://img11.hostingpics.net/pics/418501notcleaned.png\" rel=\"nofollow noreferrer\">noclean http://img11.hostingpics.net/pics/418501notcleaned.png</a></p>\n\n<p>Cleaned :\u00a0\u00a0\u00a0\u00a0 <a href=\"http://img11.hostingpics.net/pics/221530cleaned.png\" rel=\"nofollow noreferrer\">clean http://img11.hostingpics.net/pics/221530cleaned.png</a></p>\n\n<p><strong>PS</strong> : I know my macro as it is would analyze all the cells of my worksheet, is it possible \"easily\" to tell her to ignore column A ?</p>\n\n<p><strong>EDIT - UPDATE 3</strong> : My macro runs well with small dictionaries, but when it grows bigger, my macro doesn't stop running and I have to close excel with Ctrl + Alt + Suppr. :x Is there a way to tell her to stop when reaching a point ?</p>\n\n<p>For example, using <code>xlByRows</code> and writing \"END\" at the first cell after my last row.</p>\n"}, {"tags": ["vba", "vsto", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": false, "score": 0, "last_activity_date": 1434003720, "creation_date": 1434003720, "answer_id": 30773116, "question_id": 30759075, "link": "https://stackoverflow.com/questions/30759075/ms-word-paragraph-mark-shows-in-equation-mode-how-to-change-normal-mode/30773116#30773116", "title": "MS-Word paragraph mark (&#182;) shows in equation mode, how to change normal mode", "body": "<p>To hide paragraph symbols you could trigger the following line of code (VBA):</p>\n\n<pre><code>ActiveWindow.ActivePane.View.ShowAll = False\n</code></pre>\n\n<p>However, I am not sure if this solves your problem as you could see the symbol as a part of your equation (it would not be paragraph ending mark but just a symbol). To remove it in such situation you could just try to use <code>Replace function</code>:</p>\n\n<pre><code>Replace(\"your string here with \u00b6\", Chr(182), \"\") \n</code></pre>\n\n<p>where <strong>Chr(182) == \u00b6</strong>.</p>\n"}], "owner": {"reputation": 1, "user_id": 4136847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21CfH.jpg?s=128&g=1", "display_name": "Dakshinamoorthy", "link": "https://stackoverflow.com/users/4136847/dakshinamoorthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459762045, "creation_date": 1433945918, "last_edit_date": 1459762045, "question_id": 30759075, "link": "https://stackoverflow.com/questions/30759075/ms-word-paragraph-mark-shows-in-equation-mode-how-to-change-normal-mode", "title": "MS-Word paragraph mark (&#182;) shows in equation mode, how to change normal mode", "body": "<p>I have did MS-Word automation to convert OOML (Word-Equation) to MathML, but some cases word paragraph symbol (\u00b6) shows in equation mode.\nMy question is how to do automation, to change those symbol into normal mode using VSTO/VBA.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2655, "user_id": 1677285, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1utos.png?s=128&g=1", "display_name": "realbart", "link": "https://stackoverflow.com/users/1677285/realbart"}, "edited": false, "score": 0, "creation_date": 1433946316, "post_id": 30759073, "comment_id": 49571328, "body": "You might want to edit your question and start with telling you&#39;re not just writing a macro, but an Excel-macro."}, {"owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 1, "creation_date": 1433946412, "post_id": 30759073, "comment_id": 49571415, "body": "The tags didn&#39;t give it away?"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433946836, "post_id": 30759366, "comment_id": 49571758, "body": "Yes InStr is definitely what I have been trying to use but I cannot figure out how to apply it to my code since there is a lot going on and whenever I have tried to implement it, it doesn&#39;t work and it messes up another section of my code. Do you think you could help me figure out how to use it given my code? @AndresFelipeMartinez"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433947438, "post_id": 30759366, "comment_id": 49572280, "body": "Okay, I implemented it like this (I am not very familiar with VBA if that helps you understand why I&#39;m not great at executing this code) but I do not think this is probably how you meant it.. it came back with error on the If InStr line of type mismatch <a href=\"http://pastie.org/10233602\" rel=\"nofollow noreferrer\">pastie.org/10233602</a> @AndresFelipeMartinez"}, {"owner": {"reputation": 313, "user_id": 4785983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153768040479638/picture?type=large", "display_name": "Andres Felipe Martinez", "link": "https://stackoverflow.com/users/4785983/andres-felipe-martinez"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433947611, "post_id": 30759366, "comment_id": 49572424, "body": "No, that wouldn&#39;t work. Be careful with the variable types.  FIrst off, the ROW_HEADER is a constant. It is also a Long type, which means it contains a number.  So, you are looking for a string inside a number-- type mismatch.  Also, your if compares to a string (&lt;&gt; &quot;&quot;), which is a no no, since the result from InStr is a number. Type mismatch. See @KevenDenen suggestion."}], "tags": [], "owner": {"reputation": 313, "user_id": 4785983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153768040479638/picture?type=large", "display_name": "Andres Felipe Martinez", "link": "https://stackoverflow.com/users/4785983/andres-felipe-martinez"}, "is_accepted": false, "score": 2, "last_activity_date": 1433946584, "creation_date": 1433946584, "answer_id": 30759366, "question_id": 30759073, "link": "https://stackoverflow.com/questions/30759073/vba-copy-value-if-cell-contains-certain-value-rather-than-equal-to-or-not-equa/30759366#30759366", "title": "VBA - Copy value if cell CONTAINS certain value rather than equal to or not equal to", "body": "<p>Well, <code>InStr</code> helps finding out whether or not a substring is contained in a string. Basically, what it returns is what is the position of substring in the string; so, a line like:</p>\n\n<pre><code>Instr (\"hello world!\", \"h\")\n</code></pre>\n\n<p>will return 1\nFirst parameter is the string where you want to look, and the second is the substring you want to look for.</p>\n\n<p>So, if the return is different from zero, you know the substring is contained. You would check like this:</p>\n\n<pre><code>If InStr(string, substring) &lt;&gt; 0 then\n'do code\nEnd If\n</code></pre>\n\n<p>Also, for the case-sensitive scenario:</p>\n\n<p>You may want to put the cell value into a string variable, but converted to Upper Case; then check against \"HOLDER\" and whatnot. This won't change the value in the cell, it's just for comparison sake.\nJust do:</p>\n\n<pre><code>dim uString as String\n\nuString = UCase(c.Value)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433948155, "post_id": 30759452, "comment_id": 49572900, "body": "That worked beatuifully! Thank you so much. I didn&#39;t realize the problem was in an entirely different section"}], "tags": [], "owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "is_accepted": true, "score": 1, "last_activity_date": 1433946775, "creation_date": 1433946775, "answer_id": 30759452, "question_id": 30759073, "link": "https://stackoverflow.com/questions/30759073/vba-copy-value-if-cell-contains-certain-value-rather-than-equal-to-or-not-equa/30759452#30759452", "title": "VBA - Copy value if cell CONTAINS certain value rather than equal to or not equal to", "body": "<p>The part that needs adjusting is the part that searches your header row, comparing the values. It looks like this is in the HeaderCell function. The specific line that looks to do the comparison is:</p>\n\n<pre><code>If Trim(c.Value) = sHeader Then\n</code></pre>\n\n<p>This is comparing the contents of each cell in the header row to the passed in value (in your case sHeader = \"Holder\").</p>\n\n<p>You would be better off doing a test to see if sHeader is in the cell value, not equal to the cell value. The InStr function is perfect for this. Something along the lines of (untested air code):</p>\n\n<pre><code>If InStr(c.Value, sHeader) &lt;&gt; 0 Then\n</code></pre>\n\n<p>This will search the contents of each cell in your header row, looking to see if the value passed in to sHeader is anywhere in the value.</p>\n"}], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1599, "favorite_count": 0, "accepted_answer_id": 30759452, "answer_count": 2, "score": 1, "last_activity_date": 1433946775, "creation_date": 1433945908, "last_edit_date": 1433946668, "question_id": 30759073, "link": "https://stackoverflow.com/questions/30759073/vba-copy-value-if-cell-contains-certain-value-rather-than-equal-to-or-not-equa", "title": "VBA - Copy value if cell CONTAINS certain value rather than equal to or not equal to", "body": "<p>I have a working macro that loops through folder to open files and get important info from the columns of names \"HOLDER\" and \"CUTTING TOOL\" and printing all the info to one excel document, masterfile.</p>\n\n<p>I have run into the problem that in the \u201cHOLDER\u201d column, sometimes there is extra information like \u201cHolder / Toolbox\u201d but it is not consistent. I have it working with \u201cHOLDER\u201d but I was wondering if it was possible to still do that regardless of if there is that extra text in the HOLDER header name or if it is lowercase rather than all capitals. Thank you for any help you can provide!</p>\n\n<p>This is the code that deals with the <strong>\"HOLDER\" section</strong>. Below that is the full code for better reference (section 4 regards the section I am tinkering with and section 8 is the function it references).</p>\n\n<pre><code>'find the headers on the sheet\nSet hc1 = HeaderCell(StartSht.Range(\"B1\"), \"HOLDER\")\n\n...\n\n'(4)\n            'find HOLDER on the source sheet\n            Set hc3 = HeaderCell(ws.Cells(ROW_HEADER, 1), \"HOLDER\")\n            If Not hc3 Is Nothing Then\n\n                Set dict = GetValues(hc3.Offset(1, 0))\n                If dict.count &gt; 0 Then\n                    Set d = StartSht.Cells(Rows.count, hc1.Column).End(xlUp).Offset(1, 0)\n                    'add the values to the master list, column 2\n                    d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                End If\n            Else\n                'header not found on source worksheet\n            End If\n\n...\n\n'(8)\n'get all unique column values starting at cell c\nFunction GetValues(ch As Range, Optional vSplit As Variant) As Object\n    Dim dict As Object\n    Dim rng As Range, c As Range\n    Dim v\n    Dim spl As Variant\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n\n    For Each c In ch.Parent.Range(ch, ch.Parent.Cells(Rows.count, ch.Column).End(xlUp)).Cells\n        v = Trim(c.Value)\n        If Len(v) &gt; 0 And Not dict.exists(v) Then\n\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \";\")\n\n            v = spl(0)\n            End If\n\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \",\")\n\n            v = spl(0)\n            End If\n            dict.Add c.Address, v\n        End If\n    Next c\n    Set GetValues = dict\nEnd Function\n</code></pre>\n\n<p><strong>FULL CODE</strong></p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughDirectory()\n\n    Const ROW_HEADER As Long = 10\n\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim MyFolder As String\n    Dim StartSht As Worksheet, ws As Worksheet\n    Dim WB As Workbook\n    Dim i As Integer\n    Dim LastRow As Integer, erow As Integer\n    Dim Height As Integer\n    Dim RowLast As Long\n    Dim f As String\n    Dim dict As Object\n    Dim hc As Range, hc1 As Range, hc2 As Range, hc3 As Range, d As Range\n\n    Set StartSht = Workbooks(\"masterfile.xlsm\").Sheets(\"Sheet1\")\n\n    'turn screen updating off - makes program faster\n    Application.ScreenUpdating = False\n\n    'location of the folder in which the desired TDS files are\n    MyFolder = \"C:\\Users\\trembos\\Documents\\TDS\\progress\\\"\n\n    'find the headers on the sheet\n    Set hc1 = HeaderCell(StartSht.Range(\"B1\"), \"HOLDER\")\n    Set hc2 = HeaderCell(StartSht.Range(\"C1\"), \"CUTTING TOOL\")\n\n    'create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'get the folder object\n    Set objFolder = objFSO.GetFolder(MyFolder)\n    i = 2\n\n\n    'loop through directory file and print names\n'(1)\n    For Each objFile In objFolder.Files\n        If LCase(Right(objFile.Name, 3)) = \"xls\" Or LCase(Left(Right(objFile.Name, 4), 3)) = \"xls\" Then\n'(2)\n            'Open folder and file name, do not update links\n            Set WB = Workbooks.Open(fileName:=MyFolder &amp; objFile.Name, UpdateLinks:=0)\n            Set ws = WB.ActiveSheet\n'(3)\n                'find CUTTING TOOL on the source sheet\n                Set hc = HeaderCell(ws.Cells(ROW_HEADER, 1), \"CUTTING TOOL\")\n                If Not hc Is Nothing Then\n\n                    Set dict = GetValues(hc.Offset(1, 0), \"SplitMe\")\n                    If dict.count &gt; 0 Then\n                        Set d = StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0)\n                        'add the values to the master list, column 3\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                    End If\n                Else\n                    'header not found on source worksheet\n                End If\n'(4)\n                'find HOLDER on the source sheet\n                Set hc3 = HeaderCell(ws.Cells(ROW_HEADER, 1), \"HOLDER\")\n                If Not hc3 Is Nothing Then\n\n                    Set dict = GetValues(hc3.Offset(1, 0))\n                    If dict.count &gt; 0 Then\n                        Set d = StartSht.Cells(Rows.count, hc1.Column).End(xlUp).Offset(1, 0)\n                        'add the values to the master list, column 2\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                    End If\n                Else\n                    'header not found on source worksheet\n                End If\n'(5)\n            'print filename and TDS information\n            With WB\n                For Each ws In .Worksheets\n                        'print the file name to Column 1\n                        StartSht.Cells(i, 1) = objFile.Name\n                        StartSht.Cells((GetLastRowInColumn(StartSht, \"C\")), 1) = objFile.Name\n\n                        'print TDS name from J1 cell to Column 4\n                        With ws\n                            .Range(\"J1\").Copy StartSht.Cells(i, 4)\n                        End With\n                        i = GetLastRowInSheet(StartSht) + 1\n                'move to next file\n                Next ws\n'(6)\n                'close, do not save any changes to the opened files\n                .Close SaveChanges:=False\n            End With\n        End If\n    'move to next file\n    Next objFile\n    'turn screen updating back on\n    Application.ScreenUpdating = True\n    ActiveWindow.ScrollRow = 1\n'(7)\nEnd Sub\n\n'(8)\n'get all unique column values starting at cell c\nFunction GetValues(ch As Range, Optional vSplit As Variant) As Object\n    Dim dict As Object\n    Dim rng As Range, c As Range\n    Dim v\n    Dim spl As Variant\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n\n    For Each c In ch.Parent.Range(ch, ch.Parent.Cells(Rows.count, ch.Column).End(xlUp)).Cells\n        v = Trim(c.Value)\n        If Len(v) &gt; 0 And Not dict.exists(v) Then\n\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \";\")\n\n            v = spl(0)\n            End If\n\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \",\")\n\n            v = spl(0)\n            End If\n            dict.Add c.Address, v\n        End If\n    Next c\n    Set GetValues = dict\nEnd Function\n\n'(9)\n'find a header on a row: returns Nothing if not found\nFunction HeaderCell(rng As Range, sHeader As String) As Range\n    Dim rv As Range, c As Range\n    For Each c In rng.Parent.Range(rng, rng.Parent.Cells(rng.Row, Columns.count).End(xlToLeft)).Cells\n        If Trim(c.Value) = sHeader Then\n            Set rv = c\n            Exit For\n        End If\n    Next c\n    Set HeaderCell = rv\nEnd Function\n\n'(10)\nFunction GetLastRowInColumn(theWorksheet As Worksheet, col As String)\n    With theWorksheet\n        GetLastRowInColumn = .Range(col &amp; .Rows.count).End(xlUp).Row\n    End With\nEnd Function\n\n\n'(11)\nFunction GetLastRowInSheet(theWorksheet As Worksheet)\nDim ret\n    With theWorksheet\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            ret = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            ret = 1\n        End If\n    End With\n    GetLastRowInSheet = ret\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1433952248, "post_id": 30758797, "comment_id": 49575878, "body": "Are you sure that <b>all</b> documents have the Custom properties &quot;Date&quot; and &quot;Issue&quot;? It could be those after all. Also please state the Word version."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1433952465, "post_id": 30758797, "comment_id": 49576019, "body": "P.S: I just managed to create a table in a Word document without that table to appear in the ActiveDocument.Tables collection! How? ==&gt; By putting it in a text box..."}, {"owner": {"reputation": 19, "user_id": 4995098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a84589a7d6e8af37078012c13a9a461c?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Chediex", "link": "https://stackoverflow.com/users/4995098/alejandro-chediex"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1433956244, "post_id": 30758797, "comment_id": 49578422, "body": "The document properties are updated and the last row is inserted in the table, the macro stops when it tries to insert the text in the first Cell."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1433958029, "post_id": 30758797, "comment_id": 49579486, "body": "Fascinating! Gotta play a little with this tomorrow. Last row contains merged cells perhaps? Paragraph style with set page break after/before? That just <i>might</i> cause the new row to actually create a new table. :-? Something seems to screw up the Cells collection of that new row."}, {"owner": {"reputation": 19, "user_id": 4995098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a84589a7d6e8af37078012c13a9a461c?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Chediex", "link": "https://stackoverflow.com/users/4995098/alejandro-chediex"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1433959499, "post_id": 30758797, "comment_id": 49580406, "body": "Thanks, you nailed it. The table had rows where the last cell was split. I merged the rows and the macro is now working."}], "answers": [{"tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1433967595, "creation_date": 1433967595, "answer_id": 30766525, "question_id": 30758797, "link": "https://stackoverflow.com/questions/30758797/runtime-error-91-object-variable-or-with-block-variable-not-set/30766525#30766525", "title": "Runtime error 91: object variable or with block variable not set", "body": "<p>Nested tables mess up the cells collection. Once you manually merge/split cells on the last row and then add a new row, things become... <em>different</em>. Save as rtf, look at the code, and scratch your head. </p>\n\n<p>Use one (the first? second?) \"standard\" row to count the columns and adjust the code in case the column count / cells count of the last row differs from that \"norm\". Use \"Selection\" and a breakpoint to investigate the troublesome table to learn how to handle these special cases.</p>\n"}], "owner": {"reputation": 19, "user_id": 4995098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a84589a7d6e8af37078012c13a9a461c?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Chediex", "link": "https://stackoverflow.com/users/4995098/alejandro-chediex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 676, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1433967595, "creation_date": 1433945293, "last_edit_date": 1433946541, "question_id": 30758797, "link": "https://stackoverflow.com/questions/30758797/runtime-error-91-object-variable-or-with-block-variable-not-set", "title": "Runtime error 91: object variable or with block variable not set", "body": "<p>I'm running a macro in Word which, among other things, adds a line to the bottom of a table already existing in the document and fills certain cells. The odd thing is that for the majority of the documents it Works, however there are a couple of documents for which I receive the Run Time error 91.</p>\n\n<pre><code>'Update the document properties, updates the header, updates the table of contents,\n' and adds a file to the Version History table.\nSub zzAddVersionHistory(strUsuario As String, strDescripcion As String)\n    Dim newDate As String\n    Dim rowNumber As Integer\n    Dim rowNew As Row\n    Dim strIssue As String\n    Dim ascIssue As Integer\n\n    'Updates the Date property\n    newDate = Format(Date, \"dd/MM/yyyy\")\n    ActiveDocument.CustomDocumentProperties(\"Date\").Value = newDate\n\n    'Finds the version from the Issue property and updates the version\n    If DocPropertyExists(\"Issue\") = True Then\n        strIssue = ActiveDocument.CustomDocumentProperties(\"Issue\").Value\n        ascIssue = (Asc(strIssue)) + 1 'Convierte el Issue en ascii y le suma uno\n        strIssue = Chr(ascIssue)       'Convierte el ascii en caracter\n        ActiveDocument.CustomDocumentProperties(\"Issue\").Value = strIssue\n    End If\n\n    'Updates Header and footer\n    zzActualizarHeaderFooter\n\n    'Updates Fields\n    zzActualizarCampos\n\n    'Accepts changes in header y footer\n    zzAcceptChangesInHeaderFooter\n\n    'Adds a row to the table\n    rowNumber = Application.ActiveDocument.Tables(1).Rows.Count\n    Set rowNew = Application.ActiveDocument.Tables(1).Rows.Add\n\n    'Inserts KTC Issue In first cell of the new row\n    rowNew.Cells(1).Range.InsertAfter (strIssue) ''' Runtime-error here\n    'Inserts Issued By in the third cell of the new row\n    rowNew.Cells(3).Range.InsertAfter (strUsuario)\n    'Inserts the Date in the fourth cell of the new row\n    rowNew.Cells(4).Range.InsertAfter (newDate)\n    'Inserts Description of Changes in the fifth cell of the new row\n    rowNew.Cells(5).Range.InsertAfter (strDescripcion)\n\n    'Updates the Table of Contents\n    zzActualizarIndices\nEnd Sub\n</code></pre>\n\n<p>If needed I can provide the subs and functions called by the macro, but I don't think they have anything to do with the issue. \nI believe the problem is somewhere in those documents, in the table format, but I could not find an explanation anywhere nor I can find any difference with the tables in other documents.</p>\n"}, {"tags": ["vba", "formatting", "editing"], "answers": [{"tags": [], "owner": {"reputation": 8689, "user_id": 2543416, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/49d22ba9f6a73aa755e76c2caabb967e?s=128&d=identicon&r=PG", "display_name": "Gary_W", "link": "https://stackoverflow.com/users/2543416/gary-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1433945960, "creation_date": 1433945960, "answer_id": 30759090, "question_id": 30758738, "link": "https://stackoverflow.com/questions/30758738/how-to-edit-text-in-columns/30759090#30759090", "title": "How to edit text in columns?", "body": "<p>Unless there's a tricky way I am not aware of, you'll need to write a macro that loops through the rows in the column, checking for the value to change.  Pseudocode:</p>\n\n<pre><code>set a compare variable to null\nloop through cells in the column\n  read cell\n  if cell value != compare variable\n    compare = new value\n    - leave cell value there\n  else if cell = compare\n    cell value = NULL\nend loop\n</code></pre>\n\n<p>Let us know what you come up with.</p>\n"}], "owner": {"reputation": 1, "user_id": 4995145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--jFKJdBleL8/AAAAAAAAAAI/AAAAAAAAADY/PkPJcM3yUQ8/photo.jpg?sz=128", "display_name": "URNOTGONAALIKETHIS", "link": "https://stackoverflow.com/users/4995145/urnotgonaalikethis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1433947363, "creation_date": 1433945169, "last_edit_date": 1433947363, "question_id": 30758738, "link": "https://stackoverflow.com/questions/30758738/how-to-edit-text-in-columns", "title": "How to edit text in columns?", "body": "<p>The data in my column is listed as i have stated below.</p>\n\n<pre><code>A  B\n1  N  \n2  N  \n3  N        \n4  Y   \n5  Y   \n6  N   \n7  N   \n8  Y    \n9  Y   \n10 Y    \n11 Y   \n12 Y   \n13 N   \n14 N   \n</code></pre>\n\n<p>I want to automate and list the first n and no other n till y appears and list the first y till the next n appears.\nLike this :</p>\n\n<pre><code>A  B\n1  N  \n2   \n3          \n4  Y   \n5     \n6  N   \n7     \n8  Y    \n9     \n10     \n11    \n12    \n13 N   \n14  \n</code></pre>\n\n<p>Any help is apreciated. </p>\n"}, {"tags": ["vba", "excel", "variables", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 3722976, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/118c37fdb598f16d9bfc1db8182894dc?s=128&d=identicon&r=PG&f=1", "display_name": "dHumphrey", "link": "https://stackoverflow.com/users/3722976/dhumphrey"}, "edited": false, "score": 0, "creation_date": 1433948652, "post_id": 30759273, "comment_id": 49573290, "body": "Thanks FreeMan. Hows this sound... If I create a textbox on the first page that contains the projId entered by the userInput, could I save id that way and reference it from within the subroutine?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 307, "user_id": 3722976, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/118c37fdb598f16d9bfc1db8182894dc?s=128&d=identicon&r=PG&f=1", "display_name": "dHumphrey", "link": "https://stackoverflow.com/users/3722976/dhumphrey"}, "edited": false, "score": 0, "creation_date": 1433949668, "post_id": 30759273, "comment_id": 49574086, "body": "Absolutely! that&#39;s what <code>a hidden (background color = foreground color) field on the first slide of the PPT</code> was referring to. <a href=\"http://stackoverflow.com/a/30759891/2344413\">Steve</a>&#39;s suggestion about using a <code>.tag</code> will work quite well, also."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 2, "last_activity_date": 1433949775, "last_edit_date": 1433949775, "creation_date": 1433946360, "answer_id": 30759273, "question_id": 30758524, "link": "https://stackoverflow.com/questions/30758524/replacing-a-variable-in-vba-powerpoint/30759273#30759273", "title": "Replacing a variable in vba powerpoint", "body": "<p>If <code>CommentConnect()</code> is called <em>after</em> <code>ChangeProjID()</code>, the line <code>projId = 617</code> will override any value the user entered in <code>ChangeProjID()</code>.</p>\n\n<p>I see a couple of options for fixing this. </p>\n\n<ol>\n<li>Change the signature of <code>ChangeProjID()</code> to:<br><code>Function ChangeProjID() as Integer</code><br>then change the line in <code>CommentConnect to:</code><br><code>projId = ChangeProjID()</code></li>\n<li>Change the line in <code>CommentConnect()</code> to:<br><code>If projId = 0 then</code><br>&nbsp;&nbsp;<code>projId = 617 'use this value as a default</code><br><code>End If</code></li>\n</ol>\n\n<p>For option 1, the complete, changed code would look like:</p>\n\n<pre><code>Function ChangeProjID() As Integer\n    Dim strProjId As String\n    Dim intProjId As Integer\n\n    strProjId = InputBox(\"Enter the Project ID given by example:\", \"Project ID Input\")\n\n    On Error GoTo NotValidID\n    intProjId = CInt(strProjId)\n    MsgBox \" Your new project ID will be set to \" &amp; intProjId &amp; \" until changed again\"\n    ChangeProjID = intProjId\n\n    Exit Sub\n\nNotValidID:\n    MsgBox \" You must enter a valid integer\"\nEnd Sub\n\nPublic Sub CommentConnect(control As IRibbonControl)\n    Dim URL As String\n    projId = ChangeProjID\n    URL = \"example.com/prID=\"\n    ActivePresentation.FollowHyperlink (URL &amp; projId)\nEnd Sub\n</code></pre>\n\n<p>The complete, changed code for option 2 would be:</p>\n\n<pre><code>Public Sub CommentConnect(control As IRibbonControl)\n\n\n    Dim URL As String\n    if projId = 0 then\n      projId = 617           'use project 617 as the default\n    End If\n    URL = \"example.com/prID=\"\n\n\n    ActivePresentation.FollowHyperlink (URL &amp; projId)\n\nEnd Sub\n</code></pre>\n\n<p>Note that whatever you do, <code>projId</code> will default to <code>0</code> when you first open the PPTX - that's the nature of variables, they have a default value when the application starts until set otherwise.</p>\n\n<p>If you want, you can create some sort of mechanism for storing the <code>projId</code> in non-volatile memory (a text file, the registry, a hidden (background color = foreground color) field on the first slide of the PPT, etc). Or you can have some sort of initialization for <code>projId</code> so that it always gets set to some known, non-zero value when your code is launched, but it will <em>not</em> retain its last set value all by itself.</p>\n"}, {"comments": [{"owner": {"reputation": 307, "user_id": 3722976, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/118c37fdb598f16d9bfc1db8182894dc?s=128&d=identicon&r=PG&f=1", "display_name": "dHumphrey", "link": "https://stackoverflow.com/users/3722976/dhumphrey"}, "edited": false, "score": 0, "creation_date": 1433949151, "post_id": 30759891, "comment_id": 49573719, "body": "Steve, How would I reference that tag from inside vba?"}, {"owner": {"reputation": 307, "user_id": 3722976, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/118c37fdb598f16d9bfc1db8182894dc?s=128&d=identicon&r=PG&f=1", "display_name": "dHumphrey", "link": "https://stackoverflow.com/users/3722976/dhumphrey"}, "edited": false, "score": 0, "creation_date": 1433950212, "post_id": 30759891, "comment_id": 49574462, "body": "It worked!! Thanks so much guys! You all are life savers. I wish I could give you both a check!"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 2, "last_activity_date": 1433947874, "creation_date": 1433947874, "answer_id": 30759891, "question_id": 30758524, "link": "https://stackoverflow.com/questions/30758524/replacing-a-variable-in-vba-powerpoint/30759891#30759891", "title": "Replacing a variable in vba powerpoint", "body": "<p>FreeMan's got the right idea ... store the value in non-volatile memory.  </p>\n\n<p>Luckily, PowerPoint has a feature that's perfect for this:  Tags.</p>\n\n<pre><code>With ActivePresentation\n  .Tags.Add \"ProjectID\", Cstr(intProjID)\nEnd With\n</code></pre>\n\n<p>The string version of intProjID is now a permanent \"tag\" attached to the presentation object.  To retrieve it:</p>\n\n<pre><code>MsgBox ActivePresentation.Tags(\"ProjectID\")\n</code></pre>\n\n<p>Each presentation, slide and shape can have pretty much as many of these tags as you like.</p>\n"}], "owner": {"reputation": 307, "user_id": 3722976, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/118c37fdb598f16d9bfc1db8182894dc?s=128&d=identicon&r=PG&f=1", "display_name": "dHumphrey", "link": "https://stackoverflow.com/users/3722976/dhumphrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 30759891, "answer_count": 2, "score": 0, "last_activity_date": 1433949775, "creation_date": 1433944669, "last_edit_date": 1531164843, "question_id": 30758524, "link": "https://stackoverflow.com/questions/30758524/replacing-a-variable-in-vba-powerpoint", "title": "Replacing a variable in vba powerpoint", "body": "<p>I am trying to replace and save an integer in VBA Powerpoint. </p>\n\n<p>I have a variable in 1 Subroutine named projectId. At the moment, the variable is set to 617. In another subroutine I am running a user input method that prompts the user for a new projectId and stores the new projectId to replace the \"617\". The only issue is the projectId go to 0 when I close the PowerPoint and reopen it. </p>\n\n<p>Is there any way to physically replace the code <code>projectId = 617</code> with <code>projectId = 699</code> for this example. </p>\n\n<p>Below is the code Im working with, notice that <strong><code>projId</code></strong> is a global veriable:</p>\n\n<pre><code>    Dim projId As Integer\n</code></pre>\n\n<hr>\n\n<pre><code>Sub ChangeProjID()\n    Dim strProjId As String\n\n    Dim intProjId As Integer\n\n    strProjId = InputBox(\"Enter the Project ID given by example:\", \"Project ID Input\")\n\n    On Error GoTo NotValidID\n    intProjId = CInt(strProjId)\n    projId = intProjId\n    MsgBox \" Your new project ID will be set to \" &amp; intProjId &amp; \" until changed again\"\n\n    Exit Sub\n\nNotValidID:\n\n    MsgBox \" You must enter a valid integer\"\n\n    End Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub CommentConnect(control As IRibbonControl)\n\n\n    Dim URL As String\n    projId = 617\n    URL = \"example.com/prID=\"\n\n\n    ActivePresentation.FollowHyperlink (URL &amp; projId)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "user-defined-functions", "udf", "vba"], "comments": [{"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1433947914, "post_id": 30758254, "comment_id": 49572690, "body": "<code>A612002_MDC_308</code> there are 2 underscores here. Up until which one do you intend to extract?"}, {"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "reply_to_user": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1433948738, "post_id": 30758254, "comment_id": 49573367, "body": "I would wish to extract A612002"}, {"owner": {"reputation": 671, "user_id": 2527301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beff722d35f0a85f1150880ba432fd0?s=128&d=identicon&r=PG", "display_name": "Aleksey F.", "link": "https://stackoverflow.com/users/2527301/aleksey-f"}, "edited": false, "score": 0, "creation_date": 1433960269, "post_id": 30758254, "comment_id": 49580902, "body": "@SeanBailey You get <code>A612002</code> :-) See my answer."}], "answers": [{"comments": [{"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1433949009, "post_id": 30760046, "comment_id": 49573585, "body": "I tried to format your code, someone it&#39;s not working. Try to format it."}, {"owner": {"reputation": 671, "user_id": 2527301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beff722d35f0a85f1150880ba432fd0?s=128&d=identicon&r=PG", "display_name": "Aleksey F.", "link": "https://stackoverflow.com/users/2527301/aleksey-f"}, "reply_to_user": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1433951199, "post_id": 30760046, "comment_id": 49575139, "body": "@bonCodigo I&#39;ve fixed some misstakes. But the autoformatting in VBA style still does not working also as in other posts. I don&#39;t know why."}, {"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1434014476, "post_id": 30760046, "comment_id": 49603675, "body": "Hi Aleksey, This seems to work really well and overcomes the issue I was having with the &quot;_&quot;, Isit possible to ammend this code so if the 7th character is a letter to return blank?"}, {"owner": {"reputation": 671, "user_id": 2527301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beff722d35f0a85f1150880ba432fd0?s=128&d=identicon&r=PG", "display_name": "Aleksey F.", "link": "https://stackoverflow.com/users/2527301/aleksey-f"}, "reply_to_user": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1434031261, "post_id": 30760046, "comment_id": 49615984, "body": "@SeanBailey Yes, it is possible."}], "tags": [], "owner": {"reputation": 671, "user_id": 2527301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beff722d35f0a85f1150880ba432fd0?s=128&d=identicon&r=PG", "display_name": "Aleksey F.", "link": "https://stackoverflow.com/users/2527301/aleksey-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1434031479, "last_edit_date": 1434031479, "creation_date": 1433948235, "answer_id": 30760046, "question_id": 30758254, "link": "https://stackoverflow.com/questions/30758254/slight-adaptation-of-a-user-defined-function/30760046#30760046", "title": "Slight adaptation of a User Defined Function", "body": "<p>Add <code>Microsoft VBScript Regular Expressions 5.5</code> to project references. Use the following code to test matching and extracting with Xtractor:</p>\n\n<pre><code>Public Function Xtractor(ByVal p_val As String) As String\n  Xtractor = \"\"\n  Dim ary As String, v_re As New VBScript_RegExp_55.RegExp, Matches\n  v_re.Pattern = \"^([SAC][^_]{1,6})_?\"\n  Set Matches = v_re.Execute(p_val)\n  If Matches.Count &gt; 0 Then Xtractor = Matches(0).SubMatches(0) Else Xtractor = \"\"\nEnd Function\nSub test_Xtractor(p_cur As Range, p_val As String, p_expected As String)\n  Dim v_cur As Range, v_res As Range\n  p_cur.Value = p_val\n  Set v_cur = p_cur.Offset(columnOffset:=1)\n  v_cur.FormulaR1C1 = \"='\" &amp; ThisWorkbook.Name &amp; \"'!Xtractor(RC[-1])\"\n  Set v_res = v_cur.Offset(columnOffset:=1)\n  v_res.FormulaR1C1 = \"=RC[-1]=\"\"\" &amp; p_expected &amp; \"\"\"\"\n  Debug.Print p_val; \"-&gt;\"; v_cur.Value; \":\"; v_res.Value\nEnd Sub\nSub test()\n  test_Xtractor ActiveCell, \"A612002_MDC_308\", \"A612002\"\n  test_Xtractor ActiveCell.Offset(1), \"B612002_MDC_308\", \"\"\n  test_Xtractor ActiveCell.Offset(2), \"SUTP038_MDC_3\", \"SUTP038\"\n  test_Xtractor ActiveCell.Offset(3), \"KUTP038_MDC_3\", \"\"\nEnd Sub\n</code></pre>\n\n<p>Choose the workbook and cell for writing test fixture, then run <code>test</code> from the VBA Editor.<br>\nOutput in the Immediate window (Ctrl+G):</p>\n\n<pre><code>A612002_MDC_308-&gt;A612002:True\nB612002_MDC_308-&gt;:True\nSUTP038_MDC_3-&gt;SUTP038:True\nKUTP038_MDC_3-&gt;:True\n</code></pre>\n\n<p>UPD</p>\n\n<blockquote>\n  <p>Isit possible to ammend this code so if the 7th character is a letter to return blank?</p>\n</blockquote>\n\n<p>Replace line with assign to <code>v_re</code> by the following:</p>\n\n<pre><code>v_re.Pattern = \"^([SAC](?![^_]{5}[A-Z]_?)[^_]{1,6})_?\"\nv_re.IgnoreCase = True\n</code></pre>\n\n<p>And add to the <code>test</code> suite:</p>\n\n<pre><code>test_Xtractor ActiveCell.Offset(4), \"SUTP03A_MDC_3\", \"\"\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>A612002_MDC_308-&gt;A612002:True\nB612002_MDC_308-&gt;:True\nSUTP038_MDC_3-&gt;SUTP038:True\nKUTP038_MDC_3-&gt;:True\nSUTP03A_MDC_3-&gt;:True\n</code></pre>\n\n<p>I inserted negative lookahead subrule <code>(?![^_]{5}[A-Z]_?)</code> to reject <code>SUTP03A_MDC_3</code>. But pay attention: the rejecting rule is applied exactly to the 7th character. Now <code>v_re.IgnoreCase</code> set to <code>True</code>, but if only capitalized characters are allowed, set it to <code>False</code>. See also <a href=\"https://msdn.microsoft.com/en-us/library/ae5bf541%28v=vs.90%29.aspx\" rel=\"nofollow\">Regular Expression Syntax</a> on MSDN.</p>\n"}, {"comments": [{"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1434015007, "post_id": 30761334, "comment_id": 49604049, "body": "Thanks this works really well, Do you know how I could leave the result blank if the 7th character returned a letter? Your help is much appreciated!"}, {"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "reply_to_user": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1434027849, "post_id": 30761334, "comment_id": 49613166, "body": "@SeanBailey I had the impression the above code is yours. I had no idea that your above code is from Vasily, by the previous post. I see that&#39;s why you have a hard time adapting different solutions."}, {"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1434359812, "post_id": 30761334, "comment_id": 49726604, "body": "The seems to work perfectly! Thanks for all your help! :)"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 0, "last_activity_date": 1434377998, "last_edit_date": 1434377998, "creation_date": 1433951574, "answer_id": 30761334, "question_id": 30758254, "link": "https://stackoverflow.com/questions/30758254/slight-adaptation-of-a-user-defined-function/30761334#30761334", "title": "Slight adaptation of a User Defined Function", "body": "<p>try this <br></p>\n\n<pre><code>ary = Split(Replace(r.Text, \"_\", \" \"))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ary = Split(Replace(r.Text, \"_\", \" \"),\" \")\n</code></pre>\n\n<p>result will be same for both variants</p>\n\n<p>test</p>\n\n<p><img src=\"https://i.stack.imgur.com/3odU5.png\" alt=\"enter image description here\"></p>\n\n<p><strong>update</strong></p>\n\n<blockquote>\n  <p>Do you know how I could leave the result blank if the 7th character returned a letter?</p>\n</blockquote>\n\n<pre><code>Public Function Xtractor(r As Range) As String\nDim a, ary\nary = Split(Replace(r.Text, \"_\", \" \"))\n    For Each a In ary\n        If Len(a) = 7 And a Like \"[SAC]*\" And IsNumeric(Mid(a, 7, 1)) Then\n            Xtractor = a\n            Exit Function\n        End If\n    Next a\nXtractor = \"\"\nEnd Function\n</code></pre>\n\n<p><em>test</em></p>\n\n<p><img src=\"https://i.stack.imgur.com/d1EnI.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 30761334, "answer_count": 2, "score": 1, "last_activity_date": 1434377998, "creation_date": 1433944049, "last_edit_date": 1531161705, "question_id": 30758254, "link": "https://stackoverflow.com/questions/30758254/slight-adaptation-of-a-user-defined-function", "title": "Slight adaptation of a User Defined Function", "body": "<p>I would like to extract a combination of text and numbers from a larger string located within a column within excel. </p>\n\n<p>The constants I have to work with is that each Text string will</p>\n\n<p>\u2022either start with a A, C or S, and\n\u2022will always be 7 Characters long \n\u2022the position of he string I would like to extract varies</p>\n\n<p>The code I have been using which has been working efficiently is; </p>\n\n<pre><code>Public Function Xtractor(r As Range) As String\nDim a, ary\nary = Split(r.Text, \" \")\n    For Each a In ary\n        If Len(a) = 7 And a Like \"[SAC]*\" Then\n            Xtractor = a\n            Exit Function\n        End If\n    Next a\nXtractor = \"\"\nEnd Function\n</code></pre>\n\n<p>However today I have learnt that sometimes my data may include scenarios like this; </p>\n\n<p><img src=\"https://i.stack.imgur.com/e7zd6.png\" alt=\"enter image description here\"> </p>\n\n<p>What I would like is to adapt my code so If the 8th character is \"Underscore\" and the 1st character of the 7 characters is either S, A or C please extract up until the \"Underscore\"</p>\n\n<p>Secondly I would like to exclude commons words like \"Support\" &amp; \"Collect\" from being extracted. </p>\n\n<p>Finally the 7th letter should be a number</p>\n\n<p>Any ideas around this would be much appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1433944144, "post_id": 30758235, "comment_id": 49569666, "body": "IIRC, its a Range, ... Though then you should be using Set on it.  Try a Variant, that should work."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 1, "creation_date": 1433945433, "post_id": 30758235, "comment_id": 49570684, "body": "@RBarryYoung : It isn&#39;t a range, it is an array : <a href=\"https://msdn.microsoft.com/library/office/ff835873.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/library/office/ff835873.aspx</a>"}, {"owner": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "edited": false, "score": 0, "creation_date": 1433945595, "post_id": 30758235, "comment_id": 49570799, "body": "I tried Dim Level As Variant but I get &quot;Run-time error &#39;1004&#39;: Application-defined or object-defined error&quot;"}, {"owner": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "reply_to_user": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1433947177, "post_id": 30758235, "comment_id": 49572074, "body": "@bonCodigo - I&#39;m erroring out      <code>Level = WorksheetFunction.Match(&quot;Level&quot;, .Rows(&quot;1:1&quot;), 0)</code>"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1433947686, "post_id": 30758235, "comment_id": 49572490, "body": "@R3uK You are correct, it is not a Range, however, the doc you link to also says that it is not an array either, but rather a <code>Double</code>."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "edited": false, "score": 0, "creation_date": 1433945620, "post_id": 30758807, "comment_id": 49570816, "body": "Hey R3uk, I tried Dim Level As Variant but I get Run-time error &#39;1004&#39;"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "edited": false, "score": 0, "creation_date": 1433945982, "post_id": 30758807, "comment_id": 49571076, "body": "On the <code>Level = ...</code> line?"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1433945328, "last_edit_date": 1592644375, "creation_date": 1433945328, "answer_id": 30758807, "question_id": 30758235, "link": "https://stackoverflow.com/questions/30758235/option-explicit-not-sure-how-to-dim-this/30758807#30758807", "title": "Option Explicit - Not sure how to dim this", "body": "<p>Looking on <a href=\"https://msdn.microsoft.com/library/office/ff835873.aspx\" rel=\"nofollow noreferrer\">MSDN</a>, I found this :</p>\n<blockquote>\n<p>MATCH returns the position of the matched value within lookup_array, not the value itself.</p>\n<p>For example, MATCH(&quot;b&quot;,{&quot;a&quot;,&quot;b&quot;,&quot;c&quot;},0) returns 2, the relative position of &quot;b&quot; within the array {&quot;a&quot;,&quot;b&quot;,&quot;c&quot;}.</p>\n</blockquote>\n<p>So my guess is that you should use <code>Dim Level As Variant</code></p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "edited": false, "score": 0, "creation_date": 1433947010, "post_id": 30759141, "comment_id": 49571920, "body": "Hi Keven, thanks for responding.  I just tried setting Level As Double but I am still getting the &quot;Run-time error &#39;1004&#39; &quot;"}, {"owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "reply_to_user": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "edited": false, "score": 0, "creation_date": 1433947102, "post_id": 30759141, "comment_id": 49572002, "body": "Double is the correct data type here. Error 1004 is totally unrelated to the data type you are setting. Check <a href=\"https://support.microsoft.com/en-us/kb/818808\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/818808</a> for documentation on error 1004."}, {"owner": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "edited": false, "score": 1, "creation_date": 1433947507, "post_id": 30759141, "comment_id": 49572335, "body": "Keven, bonCodigo, R3uk I found the issue.  Keven was right, Double is the correct variable to use here.  The 1004 error I&#39;m receiving is due to an incorrect header in my dataset.  Thank you!"}, {"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "reply_to_user": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "edited": false, "score": 0, "creation_date": 1433947742, "post_id": 30759141, "comment_id": 49572548, "body": "@xslyx, post that <a href=\"http://stackoverflow.com/help/self-answer\">as the answer as per site rules here.</a> So it helps future visitors."}], "tags": [], "owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "is_accepted": true, "score": 2, "last_activity_date": 1433946084, "creation_date": 1433946084, "answer_id": 30759141, "question_id": 30758235, "link": "https://stackoverflow.com/questions/30758235/option-explicit-not-sure-how-to-dim-this/30759141#30759141", "title": "Option Explicit - Not sure how to dim this", "body": "<p>As you type the WorksheetFunction.Match part, the VBA editor should pop up and give you a clue to the return type. It should say something like:</p>\n\n<pre><code>Match(Arg1, Arg2, [Arg3]) as Double\n</code></pre>\n\n<p>The \"As Double\" part tells you the return type of the Match function. This is the type you should use to declare your Level variable.</p>\n"}], "owner": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 30759141, "answer_count": 2, "score": 0, "last_activity_date": 1433966530, "creation_date": 1433943999, "last_edit_date": 1433966530, "question_id": 30758235, "link": "https://stackoverflow.com/questions/30758235/option-explicit-not-sure-how-to-dim-this", "title": "Option Explicit - Not sure how to dim this", "body": "<p>I have an existing macro that I use to format columns.  I've been using this without problems.  Now, I'm looking to learn how to use Option Explicit and I am running into a problem with defining my variable.</p>\n\n<p>What should I be dim'ing Level as?  I tried Dim Level As String but that didn't work.  I'm trying to get a better understanding so any feedback would be appreciated.</p>\n\n<pre><code>Option Explicit\n\nSub adviseformat()\n\nDim Form As Worksheet\n\nSet Form = Sheets(\"Formatting\")\n\nWith Form\nLevel = WorksheetFunction.Match(\"Level\", .Rows(\"1:1\"), 0)\n\n\n.Columns(Level).Delete\n.Columns(\"D:E\").Delete\n.Range(\"U:U\").Value = Range(\"E:E\").Value\n.Columns(\"E\").EntireColumn.Delete\n.Columns(\"F:I\").Delete\n.Columns(\"I\").Delete\n.Columns(\"L\").Delete\n.Columns(\"M\").Delete\n\nForm.Range(\"A:B\").EntireColumn.Insert\nForm.Range(\"A1\").Value = \"Owner\"\nForm.Range(\"B1\").Value = \"Comment\"\nForm.Range(\"A1\").Interior.Color = 65535\nForm.Range(\"B1\").Interior.Color = 65535\nForm.Range(\"O1\").Interior.Color = 65535\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "excel", "vba", "fluent"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1433944874, "post_id": 30758134, "comment_id": 49570272, "body": "Rename your <code>xlsm</code> file into a <code>zip</code> file and unzip it, you&#39;ll have access to your custom ribbon in XML ;)"}, {"owner": {"reputation": 11, "user_id": 4995123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c0eb37dce26c018271a8ed25c17b7c9?s=128&d=identicon&r=PG&f=1", "display_name": "coo", "link": "https://stackoverflow.com/users/4995123/coo"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1433951332, "post_id": 30758134, "comment_id": 49575225, "body": "I can access my xml either using the Custom UI Editor for MS Office (i found on Rob De Bruin&#39;s site) or re-labelling the .docm file with a .zip suffix.  My problem is then finding a working snippet of xml to trigger the hyperlink within the ribbon customUI14.xml file."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1433954163, "post_id": 30758134, "comment_id": 49577103, "body": "You will still ultimately need to write VBA code for the events to work if you want to stay in the VBA/Ribbon Editor world.  You could create an add-in (xlam) instead of the normal macro workbook (xlsm) and then add that to the users&#39; normal add-ins.  In that case, the code (and Ribbon) would live outside the documents your users are editing.  Your only problem there is keeping the add-in enabled, but if it is user critical, they would have little reason to disable.  I have done this on a intranet location as a read-only file.  Just hit &quot;No&quot; when adding the add-in on the copy question."}, {"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "edited": false, "score": 0, "creation_date": 1505331302, "post_id": 30758134, "comment_id": 79374343, "body": "The bigger question is, why do your users feel the need to save the file as .xlsx? Do you want to stop them from doing that, or enable them to do it?"}], "owner": {"reputation": 11, "user_id": 4995123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c0eb37dce26c018271a8ed25c17b7c9?s=128&d=identicon&r=PG&f=1", "display_name": "coo", "link": "https://stackoverflow.com/users/4995123/coo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1433943705, "creation_date": 1433943705, "question_id": 30758134, "link": "https://stackoverflow.com/questions/30758134/replace-vba-driven-hyperlinks-with-ribbon-xml-only-code-excel-2010-2013", "title": "Replace VBA driven hyperlinks with Ribbon xml only code Excel 2010 &amp; 2013?", "body": "<p>I currently have various custom ribbon buttons in a custom tab that launch macros which are all hyperlinks to; other worksheets, work docs, mailto and webpages.\nIs there any way to have native ribbon only code as users keep saving the files as xlsx files which dumps the macros?\nI am currently building the custom tab and buttons in unofficial customUI tool.\nI was hoping to be able to use the xml in this to somehow trigger the hyperlinks.\nOr will I have to use visual studios?</p>\n\n<p>Excel 2010 &amp; 2013</p>\n\n<p>Any info gratefully received thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 4, "last_activity_date": 1433944740, "creation_date": 1433944740, "answer_id": 30758554, "question_id": 30757897, "link": "https://stackoverflow.com/questions/30757897/vba-converting-csv-files-in-a-folder-to-xlsx-files/30758554#30758554", "title": "VBA converting csv Files in a folder to xlsx Files", "body": "<p>Using the macro recoder, the file format for an <code>xlsx</code> workbook is <code>FileFormat:=xlOpenXMLWorkbook</code></p>\n\n<p>So here is your code : </p>\n\n<pre><code>Private Sub CommandButton2_Click()\nDim CSVfolder As String, _\n    XlsFolder As String, _\n    fname As String, _\n    wBook As Workbook\n\n CSVfolder = \"C:\\csv\\\"\n XlsFolder = \"C:\\Charts\\\"\n\n fname = Dir(CSVfolder &amp; \"*.csv\")\n\n Do While fname &lt;&gt; \"\"\n    Set wBook = Workbooks.Open(CSVfolder &amp; fname, Format:=6, Delimiter:=\",\")\n    wBook.SaveAs XlsFolder &amp; Replace(fname, \".csv\", \"\"), xlOpenXMLWorkbook\n    wBook.Close False\n    fname = Dir\n Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23714, "favorite_count": 1, "accepted_answer_id": 30758554, "answer_count": 1, "score": 2, "last_activity_date": 1487251721, "creation_date": 1433943111, "last_edit_date": 1487251721, "question_id": 30757897, "link": "https://stackoverflow.com/questions/30757897/vba-converting-csv-files-in-a-folder-to-xlsx-files", "title": "VBA converting csv Files in a folder to xlsx Files", "body": "<p>I have this code.</p>\n\n<p>This code converts to xlsm files.</p>\n\n<p>I want to convert to xlsx files.</p>\n\n<p>How?</p>\n\n<p>I tried by changing \n</p>\n\n<pre><code>wBook.SaveAs XlsFolder &amp; Replace(fname, \".csv\", \"\"), ThisWorkbook.FileFormatTO\nwBook.SaveAs XlsFolder &amp; Replace(fname, \".csv\", \".xlsx\")\n</code></pre>\n\n<p>It didn't worked.\n</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nDim CSVfolder As String\n Dim XlsFolder As String\n Dim fname As String\n Dim wBook As Workbook\n\n CSVfolder = \"C:\\csv\\\"\n XlsFolder = \"C:\\Charts\\\"\n\n fname = Dir(CSVfolder &amp; \"*.csv\")\n\n Do While fname &lt;&gt; \"\"\n    Set wBook = Workbooks.Open(CSVfolder &amp; fname, Format:=6, Delimiter:=\",\")\n    wBook.SaveAs XlsFolder &amp; Replace(fname, \".csv\", \"\"), ThisWorkbook.FileFormat\n    wBook.Close False\n fname = Dir\n Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 0, "creation_date": 1433945174, "post_id": 30757830, "comment_id": 49570501, "body": "Please, Ryan, be more specific in your example and correct in your wording."}, {"owner": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "reply_to_user": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 0, "creation_date": 1433948522, "post_id": 30757830, "comment_id": 49573186, "body": "I dont understand how to be more specific. In the picture, it shows in the top 8 frozen panes were i want the info from another sheet placed. When F:3 and I:3 show a certain size and interface, i want it to pull the price info for that specific size and interface in E4, E5, E6, E7."}, {"owner": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "reply_to_user": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 0, "creation_date": 1433949009, "post_id": 30757830, "comment_id": 49573584, "body": "So this particular example (screenshot) would pull info from G2, G3, G4, G5 from Price Sheeet. (added another picture to the OP)"}, {"owner": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "reply_to_user": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 0, "creation_date": 1433953331, "post_id": 30757830, "comment_id": 49576579, "body": "I&#39;m sorry for so many edits and comments, but this is just been a problem that ive been trying to solve for many many weeks now."}], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 1822396, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a3b453a46153384780dac5b1c824148f?s=128&d=identicon&r=PG", "display_name": "goodfella", "link": "https://stackoverflow.com/users/1822396/goodfella"}, "is_accepted": false, "score": 0, "last_activity_date": 1433955570, "creation_date": 1433955570, "answer_id": 30762751, "question_id": 30757830, "link": "https://stackoverflow.com/questions/30757830/excel-2010-lookup-multiple-values-on-other-sheets-in-response-to-clicking-a-ce/30762751#30762751", "title": "Excel 2010 - Lookup multiple values on other sheets in response to clicking a cell", "body": "<p>Not sure if i'm understanding your question correctly...But you mentioned you want to transfer data from one sheet to another based on a value in a specific cell. You could use a simple IF statement formula to locate value in cell and transfer another cells data over. Just make sure you use Relative Cell References as needed($). </p>\n\n<p>=IF(Sheet1!$C$4=859,Sheet1!$A2,\"\")</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "edited": false, "score": 0, "creation_date": 1433961394, "post_id": 30763343, "comment_id": 49581623, "body": "Ok, It&#39;s not searching for Row. I used the 2nd code you gave me, and put my sheet name in it as i did for the first, and it didnt work. (The first one did)"}, {"owner": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "edited": false, "score": 0, "creation_date": 1433961832, "post_id": 30763343, "comment_id": 49581881, "body": "My sheet is named PriceSheeet so i would replace your &quot;Prices!&quot; with &quot;PriceSheeet!&quot; correct? It keeps showing me an #N/A"}, {"owner": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "edited": false, "score": 0, "creation_date": 1433962552, "post_id": 30763343, "comment_id": 49582308, "body": "I figured out the Row part."}], "tags": [], "owner": {"reputation": 504, "user_id": 1560582, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e2f2053d3cf39be2d61c25c0a3f93f00?s=128&d=identicon&r=PG", "display_name": "kamelkid2", "link": "https://stackoverflow.com/users/1560582/kamelkid2"}, "is_accepted": true, "score": 0, "last_activity_date": 1433957416, "creation_date": 1433957416, "answer_id": 30763343, "question_id": 30757830, "link": "https://stackoverflow.com/questions/30757830/excel-2010-lookup-multiple-values-on-other-sheets-in-response-to-clicking-a-ce/30763343#30763343", "title": "Excel 2010 - Lookup multiple values on other sheets in response to clicking a cell", "body": "<p>I think it would be best to use regular functions in this case</p>\n\n<p>the strategy I would use in this case is to first search for the column that your GB resides in.</p>\n\n<pre><code>=MATCH(F3,Prices!1:1,0)\n</code></pre>\n\n<p>for 20gb, this would return \"7\" meaning it is in the 7th column from the left (column G)</p>\n\n<p>i would then search for the interface row. i see you have a choice between 2.5 and 3.5 options so a simple if statement would need to be made (but that isn't included in your example sheet so im assuming 3.5)</p>\n\n<pre><code>=MATCH(I3,Prices!A:A,0)\n</code></pre>\n\n<p>in your example, it would return 3 (row 3). since we now have the x and y it is pretty easy to reference that cell and there are a number of different ways to do it.</p>\n\n<p>one way is to do an offset. in your 'price' cell you would want something like this:</p>\n\n<pre><code>=OFFSET(Prices!A1,MATCH(I3,Prices!A:A,0)-1,MATCH(F3,Prices!1:1,0)-1)\n</code></pre>\n\n<p>what this does is look at cell a1 in the prices worksheet (your reference), and tells it to move 3-1 rows down (rows operator), and tells it to move 7-1 rows to the right (columns operator)</p>\n\n<p>you could then adjust your row offset to fit your other fields like cost accept, and decline. cost would be -1, accept = +1, decline = +2</p>\n\n<p>cost = </p>\n\n<pre><code>=OFFSET(Prices!A1,MATCH(I3,Prices!A:A,0)-2,MATCH(F3,Prices!1:1,0)-1)\n</code></pre>\n\n<p>you could set this logic up for 3.5 and 2.5 situations and do a logical test that if product = 2.5, then use 2.5 model. else use 3.5 model. but you may need to tweak your existing book to do that</p>\n\n<p>additionally, you may need to tweak this to actually fit your book since i had to recreate the data and may have some of my columns misaligned</p>\n"}], "owner": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 30763343, "answer_count": 2, "score": -1, "last_activity_date": 1433957416, "creation_date": 1433942935, "last_edit_date": 1531161705, "question_id": 30757830, "link": "https://stackoverflow.com/questions/30757830/excel-2010-lookup-multiple-values-on-other-sheets-in-response-to-clicking-a-ce", "title": "Excel 2010 - Lookup multiple values on other sheets in response to clicking a cell", "body": "<p>I am trying to take specific information from one sheet, and have it show in another according to what a specific cell is showing. </p>\n\n<p>What i have so far:\nWhen i click any cell in my work sheet, it shows the information for that given row in D3-I3.</p>\n\n<p>What i want:\nTake the information from F3 and I3 and reference the prices in another sheet (Price Sheeet), and show them in E4-E7. This way i can update only my price page, and it will show that price on my inventory sheets. \nI want them to change as i click around, same as the code does already.</p>\n\n<p>Code im using thus far.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Row &gt; 0 And Target.Column &gt; 0 Then\n        Range(\"D2\").Value = Cells(Target.Row, 4).Value\n        Range(\"E2\").Value = Cells(Target.Row, 5).Value\n        Range(\"F2\").Value = Cells(Target.Row, 3).Value\n        Range(\"G2\").Value = Cells(Target.Row, 7).Value\n        Range(\"H2\").Value = Cells(Target.Row, 8).Value\n        Range(\"I2\").Value = Cells(Target.Row, 10).Value\n    End If\nEnd Sub\n</code></pre>\n\n<p>I rearranged where I want my prices to show, and how I would like it to look in the image linked below. (Mock Inventory sheet)\n <a href=\"http://i.stack.imgur.com/YAKSH.png\" rel=\"nofollow\">http://i.stack.imgur.com/YAKSH.png</a></p>\n\n<p>and here's a mock of my price sheet.\n<a href=\"http://i.stack.imgur.com/hEq95.png\" rel=\"nofollow\">http://i.stack.imgur.com/hEq95.png</a></p>\n\n<p>Please read comment replys.</p>\n"}, {"tags": ["vba", "excel", "csv", "import"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1433944135, "post_id": 30757711, "comment_id": 49569658, "body": "It sounds like it&#39;s never entering the Do While loop. Is it? Do you know how to step through the code using the <code>F8</code> key?"}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1433947161, "post_id": 30757711, "comment_id": 49572062, "body": "When I step through the code it highlights the Do While loop and the next step is end-sub. First time stepping through the code, so im not sure what that means."}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1433947542, "post_id": 30757711, "comment_id": 49572363, "body": "Meanwhile for some reason the same file works normally on the computer it was created on. Mine."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1433948993, "post_id": 30757711, "comment_id": 49573571, "body": "It means the condition isn&#39;t true. Can you actually see a file with a CSV extension in that folder on their computer? Maybe they have file extensions turned off in Windows Explorer - I can&#39;t remember if that would be an issue."}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1433949546, "post_id": 30757711, "comment_id": 49573994, "body": "So the computer that holds the working version doesn&#39;t even need to display file extensions. Nonetheless adding that feature didn&#39;t change anything."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1433954135, "post_id": 30757711, "comment_id": 49577081, "body": "If your answer to my question above is &quot;yes&quot; then I&#39;m out of ideas. For some reason the code isn&#39;t seeing any CSV files in that folder on that computer. Good luck!"}, {"owner": {"reputation": 1355, "user_id": 4121920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/183acca97aee37decce653048e68f307?s=128&d=identicon&r=PG&f=1", "display_name": "Coder375", "link": "https://stackoverflow.com/users/4121920/coder375"}, "edited": false, "score": 0, "creation_date": 1434010923, "post_id": 30757711, "comment_id": 49601238, "body": "Are you actually telling it what folder to look in? because if not it will use the current directory which may well be different (you&#39;d never assume the current directory, always set it)."}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1434035361, "post_id": 30757711, "comment_id": 49619156, "body": "I included a specific directory in FName = Dir(&quot;\\something*.csv&quot;) This allowed the code to run into the loop, but now we are stuck on the .Refresh command at the end of the ImportCsvFile FName section of the loop."}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1434035593, "post_id": 30757711, "comment_id": 49619321, "body": "And &quot;Yes&quot; I can see CSV file extensions in the folder. The weird thing is that (Before I added a specific path directory) my co-workers run of the code pulled a csv file from another random folder. After adding the specific directory they are all stuck on the .Refresh."}], "owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1433942658, "creation_date": 1433942658, "last_edit_date": 1531164843, "question_id": 30757711, "link": "https://stackoverflow.com/questions/30757711/vba-csv-import-code-in-shared-network-not-working-on-co-workers-connections", "title": "VBA CSV Import Code in Shared Network not working on co-workers connections", "body": "<p>I have coded a csv import file that imports and sorts information, but the import section of the code is being skipped with no errors on a co-workers computer and not mine. We both access the same file in the same folder on the same shared network, but for some reason we are not running the code the same. </p>\n\n<p>There are no error codes, and we set up his connection to the shared network using the same network folder: N:\\12ABC\\PROGRAM\\Main (Put CSVs Here)</p>\n\n<pre><code> Sub ImportAllCSV()\n  Dim FName As Variant, R As Long\n  R = 1\n  FName = Dir(\"*.csv\")\n  Do While FName &lt;&gt; \"\"\n    ImportCsvFile FName, ActiveSheet.Cells(R, 1)\n    R = ActiveSheet.UsedRange.Rows.count + 1\n    FName = Dir\n  Loop\nEnd Sub\n\nSub ImportCsvFile(FileName As Variant, Position As Range)\n  With ActiveSheet.QueryTables.Add(Connection:= _\n      \"TEXT;\" &amp; FileName _\n      , Destination:=Position)\n      .Name = Replace(FileName, \".csv\", \"\")\n      .FieldNames = True\n      .RowNumbers = False\n      .FillAdjacentFormulas = False\n      .RefreshOnFileOpen = False\n      .BackgroundQuery = True\n      .RefreshStyle = xlInsertDeleteCells\n      .SavePassword = False\n      .SaveData = True\n      .AdjustColumnWidth = True\n      .TextFilePromptOnRefresh = False\n      .TextFilePlatform = xlMacintosh\n      .TextFileStartRow = 1\n      .TextFileParseType = xlDelimited\n      .TextFileTextQualifier = xlTextQualifierDoubleQuote\n      .TextFileConsecutiveDelimiter = False\n      .TextFileTabDelimiter = True\n      .TextFileSemicolonDelimiter = False\n      .TextFileCommaDelimiter = False\n      .TextFileSpaceDelimiter = False\n      .TextFileOtherDelimiter = \",\"\n      .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n      .Refresh BackgroundQuery:=False\n  End With\nEnd Sub\n</code></pre>\n\n<p>Please help! Thank you</p>\n"}, {"tags": ["vba", "ms-word", "word-2010"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1433953932, "post_id": 30757697, "comment_id": 49576968, "body": "Are those actual tables?  Do they give the <code>Table</code> menu in the Ribbon when you click in them?  Do they give the crosshairs in the corner when you hover on them?  You can do a lot with borders and columns to deceive someone.  Also is <code>ActiveDocument</code> what you think it is?  You can do <code>?ActiveDocument.Name</code> in the immediate window to test."}, {"owner": {"reputation": 45, "user_id": 3549674, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/20724322/picture?type=large", "display_name": "VBA novice Ryan", "link": "https://stackoverflow.com/users/3549674/vba-novice-ryan"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433956350, "post_id": 30757697, "comment_id": 49578476, "body": "I came back to answer and you&#39;re right. I guess I had two different sessions of word running. The code was in one but the tables were in the other. I&#39;ll keep that ActiveDocument.Name test handy in the future. That was it. Thanks!"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433956402, "post_id": 30757697, "comment_id": 49578511, "body": "Add your resolution as an actual answer below and accept."}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 3549674, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/20724322/picture?type=large", "display_name": "VBA novice Ryan", "link": "https://stackoverflow.com/users/3549674/vba-novice-ryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1434107388, "creation_date": 1434107388, "answer_id": 30801598, "question_id": 30757697, "link": "https://stackoverflow.com/questions/30757697/activedocument-tables-count-returns-0-but-there-are-4-tables/30801598#30801598", "title": "ActiveDocument.Tables.Count returns 0 but there are 4 tables", "body": "<p>I had two different sessions of word running. The code was in one but the tables were in the other.</p>\n"}], "owner": {"reputation": 45, "user_id": 3549674, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/20724322/picture?type=large", "display_name": "VBA novice Ryan", "link": "https://stackoverflow.com/users/3549674/vba-novice-ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 567, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593903946, "creation_date": 1433942624, "last_edit_date": 1593903946, "question_id": 30757697, "link": "https://stackoverflow.com/questions/30757697/activedocument-tables-count-returns-0-but-there-are-4-tables", "title": "ActiveDocument.Tables.Count returns 0 but there are 4 tables", "body": "<p>Issue Resolved: I had two different sessions of word running. The code was in one but the tables were in the other. </p>\n\n<hr>\n\n<p>There are 4 tables in the document but ActiveDocument.Tables.Count isn't working. Any ideas?</p>\n\n<p><img src=\"https://i.imgur.com/nqKZzmW.png\" alt=\"Two of tables in document.\"></p>\n"}, {"tags": ["excel", "vba", "outlook", "screenshot"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4994972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056079c3b3aed4b67183355f2a8df21c?s=128&d=identicon&r=PG&f=1", "display_name": "Speckled_Hen", "link": "https://stackoverflow.com/users/4994972/speckled-hen"}, "edited": false, "score": 0, "creation_date": 1433952204, "post_id": 30758220, "comment_id": 49575852, "body": "I do not want to include the screen shot as an attachment but to include it within the email."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 11, "user_id": 4994972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056079c3b3aed4b67183355f2a8df21c?s=128&d=identicon&r=PG&f=1", "display_name": "Speckled_Hen", "link": "https://stackoverflow.com/users/4994972/speckled-hen"}, "edited": false, "score": 0, "creation_date": 1433953757, "post_id": 30758220, "comment_id": 49576862, "body": "You can add a hidden attachment. It will not be visible for users. But the image will be displayed in the body. See <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/68b657c8-d150-4a84-94cd-be18784c6029/how-to-hide-attachment-in-outlook\" rel=\"nofollow noreferrer\">how to hide attachment in outlook</a>."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1433943954, "creation_date": 1433943954, "answer_id": 30758220, "question_id": 30757320, "link": "https://stackoverflow.com/questions/30757320/visual-basic-screen-shot-then-insert-into-email/30758220#30758220", "title": "Visual Basic - Screen shot then insert into email", "body": "<p>I see the two possible solutions:</p>\n\n<ol>\n<li>Outlook uses Word for rendering/editing message bodies. So, you can use the Word object model for pasting images from the clipboard. The WordEditor property of the Inspector class returns an instance of the Document class from the Word object model which represents the message body. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840284.aspx\" rel=\"nofollow\">Paste</a> or <a href=\"https://msdn.microsoft.com/en-us/library/office/ff191763.aspx\" rel=\"nofollow\">PasteSpecial</a> methods of the Selection class insert the contents of the Clipboard. See <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a> for more information.</li>\n<li>Save the screenshot as a file on the disk and then attach it to the mail item as an attachment. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869553.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Add</a> method of the Attachments class creates a new attachment in the Attachments collection. Then you can mention it in the message body. Note, you need to assign cid attribute to the attached image to add a reference in the body.</li>\n</ol>\n\n<p>For example:</p>\n\n<pre><code>  Attachment attachment = newMail.Attachments.Add(@\"E:\\Pictures\\image001.jpg\", OlAttachmentType.olEmbeddeditem, null, \"Some image display name\");\n\n  string imageCid = \"image001.jpg@123\";\n\n  attachment.PropertyAccessor.SetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x3712001E\", imageCid);\n\n newMail.HTMLBody = String.Format(\"&lt;body&gt;&lt;img src=\\\"cid:{0}\\\"&gt;&lt;/body&gt;\", imageCid);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4994972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056079c3b3aed4b67183355f2a8df21c?s=128&d=identicon&r=PG&f=1", "display_name": "Speckled_Hen", "link": "https://stackoverflow.com/users/4994972/speckled-hen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3717, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593155166, "creation_date": 1433941742, "last_edit_date": 1593155166, "question_id": 30757320, "link": "https://stackoverflow.com/questions/30757320/visual-basic-screen-shot-then-insert-into-email", "title": "Visual Basic - Screen shot then insert into email", "body": "<p>I am new to using Visual Basic.  I am using Visual Basic in MS Excel.  I am struggling to work out have to paste the screen shot into the email.  I have the following, could you please tell what I need to enter.</p>\n\n<p>Thanks</p>\n\n<pre><code>    Sub AddToNaughtyList()\n '\n    ' AddToNaughtyList Macro\n    '\n    Range(\"Y3:Z3\").Select\n    Application.CutCopyMode = False\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"U2:V2\").Select\n    Selection.Copy\n    Range(\"Y3:Z3\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"E2\").Select\n\n    Dim aOutlook As Object\n    Dim aEmail As Object\n    Dim StudentName As String\n    Dim SendAddress As String\n\n ' copy picture\n\n    Range(\"C6:S39\").Select\n    Selection.CopyPicture Appearance:=xlScreen, Format:=xlBitmap\n\n'setup email\n\n    Set aOutlook = CreateObject(\"Outlook.Application\")\n    Set aEmail = aOutlook.CreateItem(0)\n    StudentName = ActiveCell.Value\n    SendAddress = Range(\"D5\")\n\n\n'Cells(1, \"A\").Value\n\n'Set Address\n\n    aEmail.To = SendAddress\n\n'Set Subject\n\n    aEmail.Subject = \"Weekly Progress Report for \" &amp; StudentName\n\n'Set Body for mail\n\n    aEmail.HTMLBody = \"&lt;font face=calibri&gt;&lt;html&gt;&lt;body&gt;Nat's *Student needs to attend Friday Detention* text goes here.&lt;/font&gt;&lt;br /&gt;&lt;br /&gt;\" _\n\n'paste into email???????????\n\naEmail.Display\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1433941501, "post_id": 30757019, "comment_id": 49567482, "body": "To activate a Cell, use <code>.Activate</code> rather than <code>ActiveCell.Offset(1, 0).Select</code> and Generally, i declare my split result like this : <code>Dim name() As String</code>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4896275, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/98633db7c3d9f09539078afd706f3e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/4896275/dylan"}, "edited": false, "score": 0, "creation_date": 1433945992, "post_id": 30757292, "comment_id": 49571084, "body": "Thanks for the answer @R3uK but unfortunately it still isnt working. With the debugger, I can see the code after the Do Untill and before Loop are not run. Do you think its the incorrect use of the Loop?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 25, "user_id": 4896275, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/98633db7c3d9f09539078afd706f3e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/4896275/dylan"}, "edited": false, "score": 0, "creation_date": 1433946791, "post_id": 30757292, "comment_id": 49571708, "body": "Nope I check the loop is working properly, but you will not enter it if your active cell is empty! So be careful when you launch the procedure! I updated the code as every splitted cell was written in Row 1 and so you only saw the last one splitted."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1433946660, "last_edit_date": 1433946660, "creation_date": 1433941668, "answer_id": 30757292, "question_id": 30757019, "link": "https://stackoverflow.com/questions/30757019/using-a-split-function-in-a-loop-not-working/30757292#30757292", "title": "Using a split function in a Loop not working", "body": "<p>This should solve your problems :</p>\n\n<pre><code>Sub spliter()\n\nDim vText As String, _\n    vName() As String, _\n    wRow  As Integer\n\nwRow = 1\nIf IsEmpty(ActiveCell) Or ActiveCell.Value2 = vbNullString Then\n    MsgBox \"ActiveCell is empty!\", vbCritical + vbOKOnly\nElse\n    Do Until IsEmpty(ActiveCell) Or ActiveCell.Value2 = vbNullString\n        vText = ActiveCell.Value\n        vName = Split(vText, \" \")\n           For a = LBound(vName) To UBound(vName)\n              Cells(wRow, a + 1).Value = vName(a)\n           Next a\n        ActiveCell.Offset(1, 0).Activate\n        wRow = wRow + 1\n    Loop\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1433941953, "creation_date": 1433941953, "answer_id": 30757410, "question_id": 30757019, "link": "https://stackoverflow.com/questions/30757019/using-a-split-function-in-a-loop-not-working/30757410#30757410", "title": "Using a split function in a Loop not working", "body": "<p>I'm not sure where you're trying to put the data - you get the data from the ActiveCell which may be anywhere on the sheet and you paste it on row 1 of the same sheet.</p>\n\n<p>This code will take the ActiveCell and cells below that and split the text string by the space and place each word next to the original sentence.</p>\n\n<pre><code>Sub Splitter()\n\nDim sText As String\nDim x As Integer\nDim vName As Variant\n\nDo Until IsEmpty(ActiveCell)\n    sText = ActiveCell.Value\n    vName = Split(sText, \" \")\n    ActiveCell.Offset(, 1).Resize(, UBound(vName) + 1) = vName\n    ActiveCell.Offset(1, 0).Select\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4896275, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/98633db7c3d9f09539078afd706f3e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/4896275/dylan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 30757410, "answer_count": 2, "score": 0, "last_activity_date": 1487250239, "creation_date": 1433940925, "last_edit_date": 1487250239, "question_id": 30757019, "link": "https://stackoverflow.com/questions/30757019/using-a-split-function-in-a-loop-not-working", "title": "Using a split function in a Loop not working", "body": "<p>I am receiving no output from the following code:</p>\n\n<pre><code>Sub spliter()\n\nDim text As String\nDim a As Integer\nDim name As Variant\n\nDo Until IsEmpty(ActiveCell)\n     text = ActiveCell.Value\n     name = Split(text, \" \")\n             For a = 0 To UBound(name)\n             Cells(1, a + 1).Value = name(a)\n\n\n             Next a\n    ActiveCell.Offset(1, 0).Select\nLoop\nEnd Sub\n</code></pre>\n\n<p>Using the 'run to' debugger, I can see the loops working fine. This was build originally as a splitter sub, with the Loop function shelled into it. The splitter sub works fine with 1 cell and by itself, but as I incorporated the Loop, the splitter function delivers nothing. I think this may be a array in an array issue.</p>\n"}, {"tags": ["vba", "excel", "filenames"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433940460, "post_id": 30756649, "comment_id": 49566628, "body": "Okay. That makes a lot of sense. Thank you for explaining what you mean. Where would I implement this? Because in order to use GetLastRowInColumn.. it would have to get that last row from column 2 or 3 and then print it to 1..since 1 contains information only in the first cell. @Verzweifler"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433940933, "post_id": 30756649, "comment_id": 49566980, "body": "Oh wait okay I understand what your line of code means now but still not sure where to implement it. I was trying to put in in replace of <code>StartSht.Cells(i, 1) = objFile.Name</code> in section 5 but that caused an error in section (10) function saying the GetLastRowInColumn line was out of range"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433942151, "post_id": 30756649, "comment_id": 49567985, "body": "I have tried creating another same function but replacing theWorksheet with StartSht ... but GetLastRowInColumn is still out of range and I cannot figure it out @Verzweifler"}, {"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 1, "creation_date": 1433943093, "post_id": 30756649, "comment_id": 49568753, "body": "@Taylor: I&#39;m sorry, I didn&#39;t see that the function <code>GetLastRowInColumn</code> requires a String as Column argument! In this case, replace <code>GetLastRowInColumn(StartSht, 3)</code> with <code>GetLastRowInColumn(StartSht, &quot;C&quot;)</code>  Alternatively, you can use the <code>GetLastRowInSheet</code>-function and only pass <code>StartSht</code> as argument."}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433943638, "post_id": 30756649, "comment_id": 49569216, "body": "Okay, now the name prints in the first cell and last cell i want it to print in, but not all of the cells inbetween. Did I leave something out? @Verzweifler"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433943682, "post_id": 30756649, "comment_id": 49569254, "body": "Also could you explain what you mean about GetLastRowInSheet a little further? I&#39;d like to know how to utilize that too for any future reference and for hopefully using it to do the same to column 4. Thank you!"}, {"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 1, "creation_date": 1433955763, "post_id": 30756649, "comment_id": 49578104, "body": "This has two parts; I&#39;ll start with <code>GetLastRowInSheet</code>: The function utilizes the Cells.find()-function to find the last cell of the sheet, and then gets the <code>.row</code> of it. Personally, I find the <code>GetLastRowInColumn</code>-function more intuitive.  Please make sure you use the line <code>StartSht.Range(StartSht.Cells(i, 1), StartSht.Cells(GetLastRowInColumn(StartSht, 3), 1))</code> as it is, to avoid addressing two separate cells - the <code>Range()</code>-operator around the two inner cell addresses is important!"}], "tags": [], "owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "is_accepted": true, "score": 1, "last_activity_date": 1433940033, "creation_date": 1433940033, "answer_id": 30756649, "question_id": 30756090, "link": "https://stackoverflow.com/questions/30756090/vba-print-file-name-in-each-row-until-the-file-closes/30756649#30756649", "title": "VBA \u2013 print file name in each row until the file closes", "body": "<p>Since you already have a way of figuring out the last used row at a time, you are very close to a solution. What you want to do is to write the <code>objFile.Name</code> not only to <code>StartSht.Cells(i, 1)</code>, but to <code>StartSht.Range(StartSht.Cells(i, 1), StartSht.Cells(GetLastRowInColumn(StartSht, 3), 1))</code>.</p>\n\n<p>To break it down:</p>\n\n<p><code>StartSht.Range()</code> addresses a rectangular area in your Sheet <code>StartSht</code>. You specify this area by providing the corners: <code>StartSht.Cells(i, 1)</code> is the upper corner that you already know, <code>GetLastRowInColumn(StartSht, 3)</code> gets you the last row of the data you just wrote in section (3) and (4). Thus, <code>StartSht.Cells(GetLastRowInColumn(StartSht, 3), 1)</code> finalizes your area and writes the value of <code>objFile.Name</code>.</p>\n\n<p>You can then do the same thing with your copy-command.</p>\n"}], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 30756649, "answer_count": 1, "score": 0, "last_activity_date": 1433940033, "creation_date": 1433938530, "question_id": 30756090, "link": "https://stackoverflow.com/questions/30756090/vba-print-file-name-in-each-row-until-the-file-closes", "title": "VBA \u2013 print file name in each row until the file closes", "body": "<p>I have a working macro that loops through folder to open files and get important info from the columns of names \"HOLDER\" and \"CUTTING TOOL\" and printing all the info to one excel document, masterfile.</p>\n\n<p>It currently looks like picture 1. I would like it to print the file name in column one in every row until the file closes so that for every entry in columns 2 and 3, there is also the file name entry in column one, looking like picture 2.</p>\n\n<p>I would like to apply the same thing to column 4, printing the name in every row. I don\u2019t know if this information helps since getting the information for columns 1 and 4 is written in the same code block in section (5).</p>\n\n<p>Could someone help me figure out how to solve this problem? I have been trying to implement some sort of \u201ci++\u201d in that section (5) of code\u2026but have not been successful. Thank you for any suggestions!</p>\n\n<p><img src=\"https://i.stack.imgur.com/luo7W.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/UX8uI.png\" alt=\"enter image description here\"></p>\n\n<p><strong>FULL CODE</strong> <em>section (5) deals with the naming of the files in columns 1 and 4 of the masterfile.</em></p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughDirectory()\n\n    Const ROW_HEADER As Long = 10\n\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim MyFolder As String\n    Dim StartSht As Worksheet, ws As Worksheet\n    Dim WB As Workbook\n    Dim i As Integer\n    Dim LastRow As Integer, erow As Integer\n    Dim Height As Integer\n    Dim RowLast As Long\n    Dim f As String\n    Dim dict As Object\n    Dim hc As Range, hc1 As Range, hc2 As Range, hc3 As Range, d As Range\n\n    Set StartSht = Workbooks(\"masterfile.xlsm\").Sheets(\"Sheet1\")\n\n    'turn screen updating off - makes program faster\n    Application.ScreenUpdating = False\n\n    'location of the folder in which the desired TDS files are\n    MyFolder = \"C:\\Users\\trembos\\Documents\\TDS\\progress\\\"\n\n    'find the headers on the sheet\n    Set hc1 = HeaderCell(StartSht.Range(\"B1\"), \"HOLDER\")\n    Set hc2 = HeaderCell(StartSht.Range(\"C1\"), \"CUTTING TOOL\")\n\n    'create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'get the folder object\n    Set objFolder = objFSO.GetFolder(MyFolder)\n    i = 2\n\n\n    'loop through directory file and print names\n'(1)\n    For Each objFile In objFolder.Files\n        If LCase(Right(objFile.Name, 3)) = \"xls\" Or LCase(Left(Right(objFile.Name, 4), 3)) = \"xls\" Then\n'(2)\n\n            'Open folder and file name, do not update links\n            Set WB = Workbooks.Open(fileName:=MyFolder &amp; objFile.Name, UpdateLinks:=0)\n            Set ws = WB.ActiveSheet\n'(3)\n                'find CUTTING TOOL on the source sheet\n                Set hc = HeaderCell(ws.Cells(ROW_HEADER, 1), \"CUTTING TOOL\")\n                If Not hc Is Nothing Then\n\n                    Set dict = GetValues(hc.Offset(1, 0), \"SplitMe\")\n                    If dict.count &gt; 0 Then\n                        Set d = StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0)\n                        'add the values to the master list, column 3\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                    End If\n                Else\n                    'header not found on source worksheet\n                End If\n'(4)\n                'find HOLDER on the source sheet\n                Set hc3 = HeaderCell(ws.Cells(ROW_HEADER, 1), \"HOLDER\")\n                If Not hc3 Is Nothing Then\n\n                    Set dict = GetValues(hc3.Offset(1, 0))\n                    If dict.count &gt; 0 Then\n                        Set d = StartSht.Cells(Rows.count, hc1.Column).End(xlUp).Offset(1, 0)\n                        'add the values to the master list, column 2\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                    End If\n                Else\n                    'header not found on source worksheet\n                End If\n'(5)\n            With WB\n               'print TDS information\n                For Each ws In .Worksheets\n                        'print the file name to Column 1\n                        StartSht.Cells(i, 1) = objFile.Name\n                        'print TDS name from J1 cell to Column 4\n                        With ws\n                            .Range(\"J1\").Copy StartSht.Cells(i, 4)\n                        End With\n                        i = GetLastRowInSheet(StartSht) + 1\n                'move to next file\n                Next ws\n'(6)\n                'close, do not save any changes to the opened files\n                .Close SaveChanges:=False\n            End With\n        End If\n    'move to next file\n    Next objFile\n    'turn screen updating back on\n    Application.ScreenUpdating = True\n    ActiveWindow.ScrollRow = 1\n'(7)\nEnd Sub\n\n'(8)\n'get all unique column values starting at cell c\nFunction GetValues(ch As Range, Optional vSplit As Variant) As Object\n    Dim dict As Object, rng As Range, c As Range, v\n    Dim spl As Variant\n    Set dict = CreateObject(\"scripting.dictionary\")\n    For Each c In ch.Parent.Range(ch, ch.Parent.Cells(Rows.count, ch.Column).End(xlUp)).Cells\n        v = Trim(c.Value)\n        If Len(v) &gt; 0 And Not dict.exists(v) Then\n\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \";\")\n\n            v = spl(0)\n            End If\n\n            If Not IsMissing(vSplit) Then\n            spl = Split(v, \",\")\n\n            v = spl(0)\n            End If\n\n\n            dict.Add c.Address, v\n        End If\n    Next c\n    Set GetValues = dict\nEnd Function\n\n'(9)\n'find a header on a row: returns Nothing if not found\nFunction HeaderCell(rng As Range, sHeader As String) As Range\n    Dim rv As Range, c As Range\n    For Each c In rng.Parent.Range(rng, rng.Parent.Cells(rng.Row, Columns.count).End(xlToLeft)).Cells\n        If Trim(c.Value) = sHeader Then\n            Set rv = c\n            Exit For\n        End If\n    Next c\n    Set HeaderCell = rv\nEnd Function\n\n'(10)\nFunction GetLastRowInColumn(theWorksheet As Worksheet, col As String)\n    With theWorksheet\n        GetLastRowInColumn = .Range(col &amp; .Rows.count).End(xlUp).Row\n    End With\nEnd Function\n\n'(11)\nFunction GetLastRowInSheet(theWorksheet As Worksheet)\nDim ret\n    With theWorksheet\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            ret = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            ret = 1\n        End If\n    End With\n    GetLastRowInSheet = ret\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1433938548, "post_id": 30755961, "comment_id": 49565190, "body": "To all other workbooks or all other sheets? Your code seems to deal with sheets, if you want to copy to all other workbooks you need some kind of code to decide which workbooks shall be included."}, {"owner": {"reputation": 15, "user_id": 2857795, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/183e517b9f47acbcd577b2f05240e680?s=128&d=identicon&r=PG&f=1", "display_name": "user2857795", "link": "https://stackoverflow.com/users/2857795/user2857795"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1433938584, "post_id": 30755961, "comment_id": 49565216, "body": "Sheets, sorry for the confusion"}], "answers": [{"tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 1, "last_activity_date": 1433940463, "last_edit_date": 1433940463, "creation_date": 1433939091, "answer_id": 30756302, "question_id": 30755961, "link": "https://stackoverflow.com/questions/30755961/copy-formulae-of-range-of-cells-to-same-range-in-other-sheets/30756302#30756302", "title": "Copy formulae of range of cells to same range in other sheets", "body": "<p>Why not bypass copy and paste all together?\nthis should do the job</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"A9:B250\").Formula = Sheets(\"Sheet2\").Range(\"A9:B250\").Formula\n</code></pre>\n\n<p>Your code would look something like...</p>\n\n<pre><code>Sub CopyAll()\nDim sht As Worksheet\nFor Each sht In Worksheets\n    sht.Range(\"A9:B250\").Formula = Sheets(\"Albert\").Range(\"A9:B250\").Formula\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": false, "score": 1, "last_activity_date": 1433941170, "last_edit_date": 1433941170, "creation_date": 1433939396, "answer_id": 30756408, "question_id": 30755961, "link": "https://stackoverflow.com/questions/30755961/copy-formulae-of-range-of-cells-to-same-range-in-other-sheets/30756408#30756408", "title": "Copy formulae of range of cells to same range in other sheets", "body": "<p>When working with <code>Copy &gt;&gt; Paste</code> of formula you can use the following solution:</p>\n\n<pre><code>'.....\nSheets(\"Albert\").Range(\"A9:B250\").Copy\n'.....\nsht.Range(\"A9:B250\").PasteSpecial xlPasteFormulas\n'.....\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 2857795, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/183e517b9f47acbcd577b2f05240e680?s=128&d=identicon&r=PG&f=1", "display_name": "user2857795", "link": "https://stackoverflow.com/users/2857795/user2857795"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1433941170, "creation_date": 1433938203, "last_edit_date": 1433938610, "question_id": 30755961, "link": "https://stackoverflow.com/questions/30755961/copy-formulae-of-range-of-cells-to-same-range-in-other-sheets", "title": "Copy formulae of range of cells to same range in other sheets", "body": "<p>I'm trying to figure out how to copy the formulae of a range of cells to all other or selected sheets.</p>\n\n<p>For example, I want the Formulae of Sheet1.A9:B250 copied to all other Sheets (SheetX.A9:B250)</p>\n\n<p>I tried the following but it seems pretty off</p>\n\n<pre><code>Sub CopyAll()\nDim sht As Worksheet\nSheets(\"Albert\").Range(\"A9:B250\").Formula.Copy\nFor Each sht In Worksheets\nsht.Range(\"A9:B250\").Formula.PasteSpecial xlPasteValues\nNext\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>Is there an elegant solution to this? Thank you in advance</p>\n"}, {"tags": ["vba", "excel", "for-loop", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1433961004, "post_id": 30757304, "comment_id": 49581371, "body": "Agreed, this will solve the problem.  Worth noting: it looks like OP was trying to use <code>Union</code> to build a <code>Range</code> and do a single highlight at the end.  If so, the problem there is the use of <code>Set rng=FoundCell</code> which runs for every <code>i</code>.  This would work if it was <code>Set rng = Union(rng, FoundCell)</code>.  The problem is that the first <code>Union</code> will fail since <code>rng is Nothing</code>.  This could be resolved by wrapping that with <code>If rng is Nothing Then : Set rng = FoundCell : Else : ...union... : End If</code>."}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": true, "score": 3, "last_activity_date": 1433941713, "creation_date": 1433941713, "answer_id": 30757304, "question_id": 30755945, "link": "https://stackoverflow.com/questions/30755945/how-to-find-and-highlight-all-occurrences-of-multiple-strings-within-the-actives/30757304#30757304", "title": "How to find and highlight all occurrences of multiple strings within the ActiveSheet?", "body": "<p>It's because you're only doing the highlight once at the very end of the code, and the last choice in your array happens to be osnabruck.</p>\n\n<p>You need to move</p>\n\n<pre><code>If Not rng Is Nothing Then\n    rng.EntireRow.Interior.ColorIndex = 3\nEnd If\n</code></pre>\n\n<p>just before</p>\n\n<pre><code>next i\n</code></pre>\n\n<p>so that it'll do if for each element in the array.</p>\n"}], "owner": {"reputation": 85, "user_id": 4990954, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-0jSJjVf_5XU/AAAAAAAAAAI/AAAAAAAAADo/qOX84FfGczk/photo.jpg?sz=128", "display_name": "Hugo Cavalini Agudelo", "link": "https://stackoverflow.com/users/4990954/hugo-cavalini-agudelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 0, "accepted_answer_id": 30757304, "answer_count": 1, "score": 3, "last_activity_date": 1435669143, "creation_date": 1433938168, "last_edit_date": 1495540681, "question_id": 30755945, "link": "https://stackoverflow.com/questions/30755945/how-to-find-and-highlight-all-occurrences-of-multiple-strings-within-the-actives", "title": "How to find and highlight all occurrences of multiple strings within the ActiveSheet?", "body": "<p>I've found a solution already but the code would be too long. Then i decided to search a way of inserting all the words I want to find and highlight into a single Find Method. I came across some ideas of using Arrays to do so and used these 3 codes to write mine (<a href=\"http://www.thespreadsheetguru.com/the-code-vault/2014/10/30/highlight-all-cells-containing-a-specific-value\" rel=\"nofollow noreferrer\">this</a>, <a href=\"http://www.mrexcel.com/forum/excel-questions/610926-find-multiple-values-visual-basic-applications.html\" rel=\"nofollow noreferrer\">this</a>, and <a href=\"https://stackoverflow.com/questions/26595189/vba-find-multiple-strings-in-column-then-delete-rows\">this</a>) but I am a new user of VBA so my final code have a problem, it highlights just the last String of the Array. I think the problem is logic but I don't know the basics of VBA so I have no idea how to correct it.</p>\n\n<p>My actual code:</p>\n\n<pre><code>Sub Sample()\nDim fnd As String\nDim MyAr\nDim i As Long\nDim rng As Range, FoundCell As Range, LastCell As Range, myRange As Range\n\nSet myRange = ActiveSheet.UsedRange\nSet LastCell = myRange.Cells(myRange.Cells.Count)\n\nfnd = \"hugo/vw/osnabr\u00fcck\"\n\nMyAr = Split(fnd, \"/\")\n\n    For i = LBound(MyAr) To UBound(MyAr)\n\n        Set FoundCell = myRange.Find(what:=MyAr(i), after:=LastCell)\n\n        If Not FoundCell Is Nothing Then\n            FirstFound = FoundCell.Address\n        End If\nSet rng = FoundCell\n            Do Until FoundCell Is Nothing\n                Set FoundCell = myRange.FindNext(after:=FoundCell)\n                    Set rng = Union(rng, FoundCell)\n                If FoundCell.Address = FirstFound Then Exit Do\n            Loop\n    Next i\n\nIf Not rng Is Nothing Then\n    rng.EntireRow.Interior.ColorIndex = 3\nEnd If\nEnd Sub\n</code></pre>\n\n<p>For example with this code I can find and highlight all the \"Osnabr\u00fcck\" but it doesn't highlight any Hugo or VW.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4994714"}, "edited": false, "score": 0, "creation_date": 1433938433, "post_id": 30755756, "comment_id": 49565114, "body": "Sorry to add a little more detail I want it to tell the difference using a search function.  So the newest documents are all stored on a separate drive so I would like the program to search that drive for QRS-RTY-006 and then tell me what comes after that in the text box.  I hope everything is clear please ask for further clarification if needed."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1433939418, "post_id": 30755756, "comment_id": 49565842, "body": "How would you manage to know the last version the user read??? And what do you mean a separate drive? The opened file is not in the same folder than other versions?"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1433939280, "creation_date": 1433939280, "answer_id": 30756359, "question_id": 30755756, "link": "https://stackoverflow.com/questions/30755756/i-am-trying-to-write-a-program-in-vba-that-when-a-document-is-open-a-message-box/30756359#30756359", "title": "I am trying to write a program in VBA that when a document is open a message box will appear that asks for user input to continue.?", "body": "<p>This should be a good start :</p>\n\n<pre><code>Private Sub Document_Open()\n\nDim dName As String, _\n    dVersion As String, _\n    mAnswer As Integer, _\n    SrcFile As String, _\n    PossFiles As String\n\ndName = Left(ActiveDocument.Name, 7)\ndVersion = Right(Left(ActiveDocument.Name, Len(ActiveDocument.Name) - 5), 5)\n\nmAnswer = MsgBox(\"You have opened : \" &amp; dName &amp; \", Revision : \" &amp; dVersion &amp; \".\" &amp; Chr(13) &amp; _\n        \"The last revision you read was ___.\" &amp; Chr(13) &amp; _\n        \"The current revision is  \" &amp; dVersion &amp; Chr(13) &amp; _\n        Chr(13) &amp; Chr(13) &amp; \"Would you like to compare? \", vbYesNo)\n\nIf mAnswer &lt;&gt; vbYes Then\n    'vbNo : They don't want to compare\nElse\n    'vbYes : They want to compare\n    scrFile = Dir(ActiveDocument.Path &amp; \"\\\" &amp; dName &amp; \"*.docm\")\n    Do While scrFile &lt;&gt; \"\"\n        PossFiles = PossFiles &amp; Dir &amp; Chr(13)\n        scrFile = Dir\n    Loop\n    If PossFiles &lt;&gt; vbNullString Then\n        MsgBox PossFiles\n    Else\n        MsgBox \"No other files found\"\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4994714"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433939280, "creation_date": 1433937704, "last_edit_date": 1433939238, "question_id": 30755756, "link": "https://stackoverflow.com/questions/30755756/i-am-trying-to-write-a-program-in-vba-that-when-a-document-is-open-a-message-box", "title": "I am trying to write a program in VBA that when a document is open a message box will appear that asks for user input to continue.?", "body": "<p>In this box it will say what document was opened, the last version that you read of it, and the current up to date version of the document.  The documents are named differently and are separated by 3 factors: an example of this would be QRS-RTY-006.G.docm, where QRS-RTY- is the same for all the documents, 006.G is the portion where you tell what version is available that I need to use to identify the current and last read version, and the .docm stays the same for each document.  </p>\n\n<p>Current Code:</p>\n\n<pre><code>    Dim A As String\n    Dim B As String = Name\n\n    Dim C As String\n    Dim D As String = Name\n\n    A = Split(B, \"_\")(0)\n    C = Split(D, \"_\")(1)\n\n    MsgBox(\"You have opened \" &amp; A &amp; \" Revision \" &amp; C &amp; \" . The last revision you read was ___. The current revision is  ___. Would you like to compare? \", vbYesNo)\n    If vbYes Then\n\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1433937737, "post_id": 30755727, "comment_id": 49564647, "body": "Remove the <code>.Value</code> - <code>colString</code> is an array, not an object."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433937852, "post_id": 30755727, "comment_id": 49564734, "body": "It&#39;s always the simple oversights... sigh. Thanks for the help!"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433953656, "post_id": 30755727, "comment_id": 49576796, "body": "@Rory or vsoraas, can you add an answer and accept?  That helps everyone in some way."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1434018763, "post_id": 30755727, "comment_id": 49606705, "body": "@Rory if you post the answer, I&#39;ll give you a checkmark. Until then, I&#39;ve posted one."}], "answers": [{"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 1, "last_activity_date": 1434018742, "creation_date": 1434018742, "answer_id": 30778381, "question_id": 30755727, "link": "https://stackoverflow.com/questions/30755727/invalid-qualifier-when-writing-to-cell-from-string-array/30778381#30778381", "title": "&quot;Invalid Qualifier&quot; when writing to cell from string array", "body": "<pre><code> .Value = colString(i, 1)\n</code></pre>\n\n<p>Arrays cannot take .Value.</p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1434019547, "creation_date": 1434019547, "answer_id": 30778629, "question_id": 30755727, "link": "https://stackoverflow.com/questions/30755727/invalid-qualifier-when-writing-to-cell-from-string-array/30778629#30778629", "title": "&quot;Invalid Qualifier&quot; when writing to cell from string array", "body": "<p>Your array is typed as String, not any sort of Object, so its items don't have properties or methods. You therefore need to remove the <code>.Value</code> (and use it as you did in the following line):</p>\n\n<pre><code>With Cells(1, i)\n    .Value = colString(i, 1)\n    .Interior.ColorIndex = CInt(colString(i, 2))\n    .Font.Color = vbWhite\n    '.Font.Bold\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 30778629, "answer_count": 2, "score": 1, "last_activity_date": 1434019547, "creation_date": 1433937643, "question_id": 30755727, "link": "https://stackoverflow.com/questions/30755727/invalid-qualifier-when-writing-to-cell-from-string-array", "title": "&quot;Invalid Qualifier&quot; when writing to cell from string array", "body": "<p>I have a simple macro to set some common headers and formatting:</p>\n\n<pre><code>Dim colString(1 To 17, 1 To 2) As String\nDim i As Integer\n\ncolString(1, 1) = \"NA\" ' Column header\ncolString(1, 2) = \"23\" ' Column background color index\ncolString(2, 1) = \"NB\"\ncolString(2, 2) = \"1\"\n\n' etc, until (17, 2)\n\nFor i = 1 To 17\n    With Cells(1, i)\n        .Value = colString(i, 1).Value\n        .Interior.ColorIndex = CInt(colString(i, 2))\n        .Font.Color = vbWhite\n        '.Font.Bold\n    End With\nNext i\n</code></pre>\n\n<p>I get an error at this line:  </p>\n\n<pre><code> .Value = colString(i, 1).Value\n</code></pre>\n\n<p>The error reads \"invalid qualifier\" with \"colString\" highlighted.</p>\n\n<p>I don't understand why I get this error, or how to change it. Since I'm iterating over a single row, using Cells seems like the easiest route? Google, MrExcel and SO turns up nothing.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1433938176, "post_id": 30755564, "comment_id": 49564946, "body": "Share an example data of both tables. What is it exactly you want to calculate? You just mentioned the data."}], "answers": [{"tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 1, "last_activity_date": 1433938667, "creation_date": 1433938667, "answer_id": 30756150, "question_id": 30755564, "link": "https://stackoverflow.com/questions/30755564/most-efficient-way-to-create-a-comparative-table-with-excel/30756150#30756150", "title": "Most efficient way to create a comparative table with Excel?", "body": "<p>If these are structured tables (let us say their worksheet names being <code>Planned</code> and <code>Actual</code>) in Excel I would <strong>create a MS Query</strong> like this:</p>\n\n<pre><code>SELECT Plan.Employee, Plan.Project, SUM(Plan.PlannedHrs), SUM(Act.ActualHrs),SUM(Act.ActualHrs) / SUM(Plan.PlannedHrs)\nFROM [Planned$] as Plan \nINNER JOIN [Actual$] as Act \nON Plan.Project = Act.Project AND Plan.Employee=Act.Employee\nGROUP BY Plan.Employee, Plan.project, Act.Project, Act.Employee\n</code></pre>\n\n<p><strong>The above query will compare hrs per project (Planned vs Actual). This is just an example as you can calculate other metrics.</strong></p>\n\n<p>Using MS Queries?: <code>Data-&gt;From Other Sources-&gt;From Microsoft Query</code>\nor use my SQL AddIn (just to create the query): <a href=\"http://www.analystcave.com/excel-tools/excel-sql-add-in-free/\" rel=\"nofollow\">http://www.analystcave.com/excel-tools/excel-sql-add-in-free/</a></p>\n"}], "owner": {"reputation": 57, "user_id": 3779627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/604d1d66ee2def20c56c86c9103db74c?s=128&d=identicon&r=PG&f=1", "display_name": "user3779627", "link": "https://stackoverflow.com/users/3779627/user3779627"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 30756150, "answer_count": 1, "score": 0, "last_activity_date": 1433938667, "creation_date": 1433937207, "question_id": 30755564, "link": "https://stackoverflow.com/questions/30755564/most-efficient-way-to-create-a-comparative-table-with-excel", "title": "Most efficient way to create a comparative table with Excel?", "body": "<p>using Excel (mostly the VBA part), I would like to do the following:</p>\n\n<p>I have two different tables with different kind of data, but they both have at least the 4 following columns in common: </p>\n\n<ul>\n<li>the name of the employee</li>\n<li>the name of the project he worked on</li>\n<li>the day he worked on it</li>\n<li>the number of hour in that day that he worked on it.</li>\n</ul>\n\n<p>One of the table represents the planified working time (by instance this employee should work x hours on project A and y hours on project B on the 5th of May...) and the other table represents the actual working time, i. e. the time the employee actually spent working on a project.  </p>\n\n<p>The actual project on which the employee worked on may differ from what was planified, or it may be the same but he might have spent a different amount of time on it.</p>\n\n<p>Being new to Excel I was wondering if any of you could give me ideas on the most efficient way to do this.  Since I have a lot of rows, I'm a bit reticent at the idea of using too many loops.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1433937770, "creation_date": 1433937770, "answer_id": 30755793, "question_id": 30755458, "link": "https://stackoverflow.com/questions/30755458/excel-vba-2010-looking-up-for-a-value-in-a-random-sized-multidimentional-array/30755793#30755793", "title": "Excel VBA 2010 Looking up for a value in a random sized multidimentional array", "body": "<p>You need to:</p>\n\n<ol>\n<li>define the range</li>\n<li>use the <strong>.Find</strong> method to locate the data:</li>\n</ol>\n\n<p><br>Here is an example for columns <strong>A</strong> through <strong>D</strong> for an unknown number of rows.</p>\n\n<pre><code>Sub qwerty()\n   Dim rng As Range, N As Long\n   N = Cells(Rows.Count, \"A\").End(xlUp).Row\n   Set rng = Range(\"A1:D\" &amp; N)\n   addy = rng.Find(What:=\"happiness\", After:=rng(1)).Address\n   MsgBox addy\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4874750, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/305b88ca5dc6b91bfdddde5e1336f9c1?s=128&d=identicon&r=PG&f=1", "display_name": "Athrika", "link": "https://stackoverflow.com/users/4874750/athrika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433937770, "creation_date": 1433936944, "last_edit_date": 1531164843, "question_id": 30755458, "link": "https://stackoverflow.com/questions/30755458/excel-vba-2010-looking-up-for-a-value-in-a-random-sized-multidimentional-array", "title": "Excel VBA 2010 Looking up for a value in a random sized multidimentional array", "body": "<p>Is there a way to look up for certain values in an multidimensional array. </p>\n\n<p>Say for an example: There is an array with 4 columns and say 500 or some number of rows that changes every time(the size of the array is dynamic and varies from time to time, so basically a loop with fixed number like i = 1 to 500 and j = 1 to 4 won't work) . </p>\n\n<p>Now I design an Userform and feed a value. Is there a function like filter() that can look up for this value in this multi-dimentional array? Is there any other way to do this.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1433933104, "post_id": 30753926, "comment_id": 49561687, "body": "Hmm, is this code contained in a module?"}, {"owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "reply_to_user": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1433933224, "post_id": 30753926, "comment_id": 49561769, "body": "Yes, all of this is contained in a single module and it is the only module in this file"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433937252, "post_id": 30753926, "comment_id": 49564320, "body": "See this previous question: <a href=\"http://stackoverflow.com/questions/19845944/dynamic-function-calls-in-excel-vba\" title=\"dynamic function calls in excel vba\">stackoverflow.com/questions/19845944/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 14761, "user_id": 290072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/ITEsv.png?s=128&g=1", "display_name": "Almo", "link": "https://stackoverflow.com/users/290072/almo"}, "edited": false, "score": 0, "creation_date": 1433950703, "post_id": 30754124, "comment_id": 49574785, "body": "This popped up in the Low Quality Post queue. I&#39;m hitting skip, but I think this could use a teeny bit more explanation. :)"}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1433964097, "last_edit_date": 1495542820, "creation_date": 1433933335, "answer_id": 30754124, "question_id": 30753926, "link": "https://stackoverflow.com/questions/30753926/call-a-vba-sub-using-a-string-value/30754124#30754124", "title": "Call a VBA sub using a string value", "body": "<p>Using GetRef, you give the reference to the sub.\nSee my question <a href=\"https://stackoverflow.com/questions/10741292/vbscript-getref-with-parameter?s=51%7C5.0118\">here</a> for example</p>\n\n<p>EDIT: following the suggestions in the comments, here part of the solution to this question.</p>\n\n<pre><code>sub one(para)\n  WScript.Echo para &amp; \" from one\"\nend sub\n\nsub two(para)\n  WScript.Echo para &amp; \" from two\"\nend sub\n\nsub main(subname, para)\n  Dim f : Set f = GetRef(subname)\n  f para\nend sub\n\nmain \"one\", \"test\" '=&gt;test from one\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59637, "user_id": 61989, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/23d0af63ab371e90fa713a96d3066d59?s=128&d=identicon&r=PG", "display_name": "Patrick McDonald", "link": "https://stackoverflow.com/users/61989/patrick-mcdonald"}, "edited": false, "score": 0, "creation_date": 1433934565, "post_id": 30754131, "comment_id": 49562522, "body": "<code>Application.Run &quot;Module1.msg1&quot;</code> worked too.  Weirdly, I can&#39;t even run the msg1 macro from the Macros dialog"}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": true, "score": 3, "last_activity_date": 1433933360, "creation_date": 1433933360, "answer_id": 30754131, "question_id": 30753926, "link": "https://stackoverflow.com/questions/30753926/call-a-vba-sub-using-a-string-value/30754131#30754131", "title": "Call a VBA sub using a string value", "body": "<p>just ran it over here. msg1 seems to be a reserved word... change it to something else and it works fine =)</p>\n"}], "owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1702, "favorite_count": 0, "closed_date": 1433937370, "accepted_answer_id": 30754131, "answer_count": 2, "score": 6, "last_activity_date": 1434035601, "creation_date": 1433932688, "last_edit_date": 1495535208, "question_id": 30753926, "link": "https://stackoverflow.com/questions/30753926/call-a-vba-sub-using-a-string-value", "closed_reason": "Duplicate", "title": "Call a VBA sub using a string value", "body": "<p>This is my test code</p>\n\n<pre><code>Sub dotask()\n\n    Dim qusub As String\n    qusub = Worksheets(\"Task List\").Range(\"C2\").Value\n\n    MsgBox qusub\n    Application.Run qusub\n\nEnd Sub\n\nSub msg1()\n\n    MsgBox \"sub msg1\"\n\nEnd Sub\n\nSub msg2()\n\n    MsgBox \"sub msg2\"\n\nEnd Sub\n\nSub msg3()\n\n    MsgBox \"sub msg3\"\n\nEnd Sub\n\nSub msg4()\n\n    MsgBox \"sub msg4\"\n\nEnd Sub\n</code></pre>\n\n<p>All of this is contained in a single standard module. I've read <a href=\"https://stackoverflow.com/questions/15969796/trying-to-call-a-sub-with-a-string-vba\">Trying to call a Sub with a String - VBA</a> and wrote my code according to what I found there (i.e. using Application.Run). Cell C2 of Task List worksheet contains \"msg3\" at the moment. When I execute sub \"dotask\" I first get a message box saying \"msg3\" as I want but then I get the following error message:</p>\n\n<blockquote>\n  <p>Run-time error '1004':</p>\n  \n  <p>Cannot run the macro 'msg3'. The macro may not be available in this workbook or all macros may be disabled.</p>\n</blockquote>\n\n<p>I'm working on Excel 2010 and the file is <code>.xlsm</code> - what should I do to get my code to execute as I want it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1433929851, "post_id": 30752737, "comment_id": 49559576, "body": "Find the last row and increment it by 1 and then write to the next row. Repeat that in the loop. <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">THIS</a> will get you started"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1433936236, "last_edit_date": 1433936236, "creation_date": 1433930578, "answer_id": 30753163, "question_id": 30752737, "link": "https://stackoverflow.com/questions/30752737/excel-vba-select-one-row-down-in-a-loop/30753163#30753163", "title": "Excel VBA: select one row down in a loop", "body": "<p>You need to recalculate last row in the loop wtih <code>End()</code> function.</p>\n\n<p>Like this for range <code>.Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1, 0)</code></p>\n\n<p>Or to have an integer <code>.Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1, 0).Row</code></p>\n\n<hr>\n\n<p>Give this a try :</p>\n\n<pre><code>Sub getData()\nApplication.ScreenUpdating = False\n\nDim XL As Excel.Application, _\n    WBK As Excel.Workbook, _\n    MS As Worksheet, _\n    scrFile As String, _\n    myPath As String\n\n'Sheet name in the master file is \"Sh\"\nSet MS = ThisWorkbook.Sheets(\"Sh\")\n'The source folder\nmyPath = ThisWorkbook.Path &amp; \"\\db\\\"\nMS.Range(\"A1\").Value = \"Column 1\"\nMS.Range(\"B1\").Value = \"Column 2\"\n\nSet XL = CreateObject(\"Excel.Application\")\n\nscrFile = Dir(myPath &amp; \"*.xlsx\")\nDo While scrFile &lt;&gt; \"\"\n\n    Set WBK = XL.Workbooks.Open(scrFile)\n\n    ' Here should be the code to save the values of A10 and C5 of the given file\n    'in the loop in next available row of the master file.\n    With MS\n        .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1, 0).Value = WBK.ActiveSheet.Range(\"A10\").Value\n        .Range(\"B\" &amp; .Rows.Count).End(xlUp).Offset(1, 0).Value = WBK.ActiveSheet.Range(\"C5\").Value\n    End With\n\n    WBK.Close False\n    scrFile = Dir\nLoop\nXL.Quit\nSet XL = Nothing\nSet MS = Nothing\nSet WBK = Nothing\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 575, "user_id": 2286047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qdfsh.jpg?s=128&g=1", "display_name": "Asayat", "link": "https://stackoverflow.com/users/2286047/asayat"}, "edited": false, "score": 0, "creation_date": 1433932361, "post_id": 30753170, "comment_id": 49561236, "body": "Thank you very much for all given advices! :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 575, "user_id": 2286047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qdfsh.jpg?s=128&g=1", "display_name": "Asayat", "link": "https://stackoverflow.com/users/2286047/asayat"}, "edited": false, "score": 1, "creation_date": 1433936168, "post_id": 30753170, "comment_id": 49563525, "body": "@Asayat : More importantly than not opening another Excel (personally, I prefer to do it when I have a lot of files to open), get it out of the loop because you will open a new one for each files if you let it in. And rather than just referencing just the workbook, use an object variable to reference the sheet you are going to write in. Take a look at my answer, you&#39;ll see how it is done properly."}], "tags": [], "owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "is_accepted": true, "score": 3, "last_activity_date": 1433930599, "creation_date": 1433930599, "answer_id": 30753170, "question_id": 30752737, "link": "https://stackoverflow.com/questions/30752737/excel-vba-select-one-row-down-in-a-loop/30753170#30753170", "title": "Excel VBA: select one row down in a loop", "body": "<p>For simplicity, just use a counter:  </p>\n\n<pre><code>scrFile = Dir(myPath &amp; \"*.xlsx\")\nn = 1  ' skip the first row with headers\nDo While scrFile &lt;&gt; \"\"\n    n = n + 1\n    Set XL = CreateObject(\"Excel.Application\")\n    Set WBK = XL.Workbooks.Open(scrFile)\n\n    ' save the values of A10 and C5 of the given file in the next row\n    ThisWorkbook.Sheets(\"Sh\").Range(\"A\" &amp; n).Value = WBK.ActiveSheet.Range(\"A10\").Value\n    ThisWorkbook.Sheets(\"Sh\").Range(\"B\" &amp; n).Value = WBK.ActiveSheet.Range(\"C5\").Value\n\n    WBK.Close False\n    Set XL = Nothing\n\n    scrFile = Dir\nLoop\nmsgbox n &amp; \" files imported.\"\n</code></pre>\n\n<p>BTW, you don't need to start a second Excel instance (CreateObject(\"Excel.Application\")) just to open a second workbook. This will slow down your code a lot. Just open, read and close it. Address your master workbook not by <code>ThisWorkbook</code> but assign a varible to it:  </p>\n\n<pre><code>Dim masterWB As Excel.Workbook\nset masterWB = ThisWorkbook\n...\nmasterWB.Sheets(\"Sh\").Range(\"A\" &amp; n).Value = WBK.ActiveSheet.Range(\"A10\").Value    \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8315954, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c0b170645cfc507916294ea3103ed3b9?s=128&d=identicon&r=PG", "display_name": "Joe Maskell", "link": "https://stackoverflow.com/users/8315954/joe-maskell"}, "is_accepted": false, "score": 0, "last_activity_date": 1500252784, "last_edit_date": 1500252784, "creation_date": 1500224991, "answer_id": 45131296, "question_id": 30752737, "link": "https://stackoverflow.com/questions/30752737/excel-vba-select-one-row-down-in-a-loop/45131296#45131296", "title": "Excel VBA: select one row down in a loop", "body": "<p>I actually have a code here that will loop through each file and deposit the code into your main file. You are also able to choose the directory of the target folder. </p>\n\n<pre><code>Sub GatherData()\nDim sFolder As String\n\n    Application.ScreenUpdating = True\n\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .InitialFileName = Application.DefaultFilePath &amp; \"\\\"\n        .Title = \"Please select a folder...\"\n        .Show\n        If .SelectedItems.Count &gt; 0 Then\n            sFolder = .SelectedItems(1) &amp; \"\\\"\n        Else\n            Exit Sub\n        End If\n    End With\n\n    Call Consolidate(sFolder, ThisWorkbook)\nEnd Sub\n\nPrivate Sub Consolidate(sFolder As String, wbMaster As Workbook)\n    Dim wbTarget As Workbook\nDim objFso As Object\n    Dim objFiles As Object\n    Dim objSubFolder As Object\n    Dim objSubFolders As Object\n    Dim objFile As Object\n    Dim ary(3) As Variant\n    Dim lRow As Long\n\n    'Set Error Handling\n    On Error GoTo EarlyExit\n\n    'Create objects to enumerate files and folders\n    Set objFso = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFiles = objFso.GetFolder(strFolder).Files\n    Set objSubFolders = objFso.GetFolder(strFolder).subFolders\n\n    'Loop through each file in the folder\n    For Each objFile In objFiles\n        If InStr(1, objFile.Path, \".xls\") &gt; 0 Then\n            Set wbTarget = Workbooks.Open(objFile.Path)\n            With wbTarget.Worksheets(1)\n                ary(0) = .Range(\"B8\") 'here you can change the cells you need the data from\n                ary(1) = .Range(\"B12\")\n                ary(2) = .Range(\"B14\")\n            End With\n\n            With wbMaster.Worksheets(1)\n                lRow = .Range(\"E\" &amp; .Rows.Count).End(xlUp).Offset(1, 0).Row 'here you can change the row the data is deposited in\n                .Range(\"E\" &amp; lRow &amp; \":G\" &amp; lRow) = ary\n            End With\n\n            wbTarget.Close savechanges:=False\n        End If\n    Next objFile\n\n    'Request count of files in subfolders\n    For Each objSubFolder In objSubFolders\n        Consolidate objSubFolder.Path, wbMaster\n    Next objSubFolder\n\nEarlyExit:\n    'Clean up\n    On Error Resume Next\n    Set objFile = Nothing\n    Set objFiles = Nothing\n    Set objFso = Nothing\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 575, "user_id": 2286047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qdfsh.jpg?s=128&g=1", "display_name": "Asayat", "link": "https://stackoverflow.com/users/2286047/asayat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2474, "favorite_count": 0, "accepted_answer_id": 30753170, "answer_count": 3, "score": 0, "last_activity_date": 1500252784, "creation_date": 1433929428, "question_id": 30752737, "link": "https://stackoverflow.com/questions/30752737/excel-vba-select-one-row-down-in-a-loop", "title": "Excel VBA: select one row down in a loop", "body": "<p>I have a source folder that contains many xls files. I want to create a master file - collect all information into one database from all files in the given source.</p>\n\n<p>The following code creates 2 columns in master file and enters 2 values from the given source file (one file):</p>\n\n<pre><code>Sub getData()\n\nDim XL As Excel.Application\n\nDim WBK As Excel.Workbook\nDim scrFile As String\nDim myPath As String\n\nmyPath = ThisWorkbook.path &amp; \"\\db\\\" 'The source folder\nscrFile = myPath &amp; \"1.xlsx\"  'Select first file\n ' Sheet name in the master file is \"Sh\"\nThisWorkbook.Sheets(\"Sh\").Range(\"A1\").Value = \"Column 1\"\nThisWorkbook.Sheets(\"Sh\").Range(\"B1\").Value = \"Column 2\"\n\nSet XL = CreateObject(\"Excel.Application\")\nSet WBK = XL.Workbooks.Open(scrFile)\n\nThisWorkbook.Sheets(\"Sh\").Range(\"A2\").Value = WBK.ActiveSheet.Range(\"A10\").Value\nThisWorkbook.Sheets(\"Sh\").Range(\"B2\").Value = WBK.ActiveSheet.Range(\"C5\").Value\n\nWBK.Close False\nSet XL = Nothing\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Now I want to loop through all files and save the values from cells \"A10\" and \"C5\" from each file in one database, so the loop should select the next row to save new values.</p>\n\n<p>I have an idea how to loop through all files, but don't know how to switch to the next row:</p>\n\n<pre><code>scrFile = Dir(myPath &amp; \"*.xlsx\")\nDo While scrFile &lt;&gt; \"\"\n\n    Set XL = CreateObject(\"Excel.Application\")\n    Set WBK = XL.Workbooks.Open(scrFile)\n\n    ' Here should be the code to save the values of A10 and C5 of the given file \n    'in the loop in next available row of the master file.\n\n    WBK.Close False\n    Set XL = Nothing\n\n    scrFile = Dir\n  Loop\n</code></pre>\n\n<p>Any help will be highly appreciated! :)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 41, "user_id": 3764484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/facf87bf075dc69095b32b80f6b6ac06?s=128&d=identicon&r=PG&f=1", "display_name": "user3764484", "link": "https://stackoverflow.com/users/3764484/user3764484"}, "edited": false, "score": 0, "creation_date": 1433932379, "post_id": 30752620, "comment_id": 49561249, "body": "Could mark some of your questions(all 6 of them?) as complete?"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 41, "user_id": 3764484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/facf87bf075dc69095b32b80f6b6ac06?s=128&d=identicon&r=PG&f=1", "display_name": "user3764484", "link": "https://stackoverflow.com/users/3764484/user3764484"}, "edited": false, "score": 0, "creation_date": 1434019814, "post_id": 30752620, "comment_id": 49607448, "body": "You need 15 to vote up. not mark it as the answer, under the up/down vote arrows there should be a tick box?"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 1, "last_activity_date": 1433929110, "creation_date": 1433929110, "answer_id": 30752620, "question_id": 30752559, "link": "https://stackoverflow.com/questions/30752559/how-do-i-incorporate-a-variable-into-a-range-reference/30752620#30752620", "title": "How do I incorporate a variable into a range-reference", "body": "<p>Both of the below will use the value in a</p>\n\n<pre><code>range(\"A\" &amp; a)\n\nCells(a,1)\n</code></pre>\n\n<p>If you wanted to use it in a range you could do something like </p>\n\n<pre><code>range(\"A1:A\" &amp; a )\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 3764484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/facf87bf075dc69095b32b80f6b6ac06?s=128&d=identicon&r=PG&f=1", "display_name": "user3764484", "link": "https://stackoverflow.com/users/3764484/user3764484"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433939892, "creation_date": 1433928950, "last_edit_date": 1433939892, "question_id": 30752559, "link": "https://stackoverflow.com/questions/30752559/how-do-i-incorporate-a-variable-into-a-range-reference", "title": "How do I incorporate a variable into a range-reference", "body": "<p>I store a number in a variable <code>a</code>, like this:</p>\n\n<pre><code>a = Worksheets(\"MySheet\").UsedRange.Rows.Count\n</code></pre>\n\n<p>How do I incorporate this value in a Range-function in Excel-VBA? If <code>a</code> for instance holds 3, how do I use it to refer to Range(\"A3\")?</p>\n"}, {"tags": ["vba", "ms-word", "passwords", "password-recovery"], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 1, "last_activity_date": 1433939665, "creation_date": 1433939665, "answer_id": 30756512, "question_id": 30752525, "link": "https://stackoverflow.com/questions/30752525/i-forgot-the-password-to-open-a-word-document-how-can-i-retrieve-the-password/30756512#30756512", "title": "I forgot the password to open a Word document. How can I retrieve the password?", "body": "<p>Use <code>SendKeys \"{ESC}\"</code> immediately before you try to open the file.</p>\n"}, {"tags": [], "owner": {"reputation": 13325, "user_id": 2641576, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/K9yqy.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2641576/matt"}, "is_accepted": true, "score": 5, "last_activity_date": 1460621074, "creation_date": 1460621074, "answer_id": 36617122, "question_id": 30752525, "link": "https://stackoverflow.com/questions/30752525/i-forgot-the-password-to-open-a-word-document-how-can-i-retrieve-the-password/36617122#36617122", "title": "I forgot the password to open a Word document. How can I retrieve the password?", "body": "<p>The file needs to be in <code>.docx</code> format, if it is <code>.doc</code> convert it to <code>.docx</code>:</p>\n\n<ol>\n<li>Create a back-up copy of the file.</li>\n<li>Change the extension from <code>.docx</code> to <code>.zip</code>. </li>\n<li>Open new <code>.zip</code> file and extract all files.</li>\n<li>In the extracted folder go to to <code>word\\settings.xml</code>.</li>\n<li>Open <code>settings.xml</code> and remove the code from <code>&lt;w:documentProtection</code> to <code>/&gt;</code> and save the file.</li>\n<li>Copy the new <code>settings.xml</code> to the original <code>.zip</code> file and overwrite the old one.</li>\n<li>Rename the <code>.zip</code> to <code>.docx</code> and open file which is now protection free!</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9534168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e728c5e1b98ad112e7a74f2faacde5f?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/9534168/leon"}, "is_accepted": false, "score": 0, "last_activity_date": 1521716285, "creation_date": 1521716285, "answer_id": 49426892, "question_id": 30752525, "link": "https://stackoverflow.com/questions/30752525/i-forgot-the-password-to-open-a-word-document-how-can-i-retrieve-the-password/49426892#49426892", "title": "I forgot the password to open a Word document. How can I retrieve the password?", "body": "<p>As \"Matt\" said simply converting the file extension to .zip and then editing the .xml file using notepad or notepad++, removing the entire line after w:documentprotection all the way to /> and then resaving the new .xml file inside the .zip folder will remove the password protection. Tried and tested in Word 2016. Just don't forget to rename the now edited zip folder back to .docx so its readable in Word. All credit to Matt.</p>\n"}, {"tags": [], "owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "is_accepted": false, "score": 0, "last_activity_date": 1549476804, "creation_date": 1549476804, "answer_id": 54560044, "question_id": 30752525, "link": "https://stackoverflow.com/questions/30752525/i-forgot-the-password-to-open-a-word-document-how-can-i-retrieve-the-password/54560044#54560044", "title": "I forgot the password to open a Word document. How can I retrieve the password?", "body": "<p>I adjusted your original code, so it's not dependent on the password being a certain length. Also it will now move from left to right, adding a new character with each pass, and prevents the popups when trying to open the document. This can be used for workbooks as well.</p>\n\n<p>WARNING** The brute force method is really not even worth it. It takes a very long time to run. If it is an encrypted password, then this may be the best option without downloading a third party password breaker.</p>\n\n<pre><code>Sub PasswordBreakerWord()\nDim WordApp As Object\nDim WordDoc As Object\nDim strPath As String\nDim passAtmp As String\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nSet WordApp = CreateObject(\"Word.Application\")\nSet WordDoc = CreateObject(\"Word.Document\")\nstrPath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\blah.docx\"\n\nDim i1 As Integer, i2 As Integer, i3 As Integer\nDim i4 As Integer, i5 As Integer, i6 As Integer\nDim i7 As Integer, i8 As Integer, i9 As Integer\nDim i10 As Integer, i11 As Integer, i12 As Integer\n\nFor i1 = 31 To 126: For i2 = 31 To 126: For i3 = 31 To 126\nFor i4 = 31 To 126: For i5 = 31 To 126: For i6 = 31 To 126\nFor i7 = 31 To 126: For i8 = 31 To 126: For i9 = 31 To 126\nFor i10 = 31 To 126: For i11 = 31 To 126: For i12 = 31 To 126\n\npassAtmp = Chr(i12) &amp; Chr(i11) &amp; Chr(i10) &amp; Chr(i9) &amp; Chr(i8) &amp; Chr(i7) &amp; Chr(i6) &amp; Chr(i5) &amp; Chr(i4) &amp; Chr(i3) &amp; Chr(i2) &amp; Chr(i1)\nDebug.Print passAtmp\n\nOn Error Resume Next\nSet WordDoc = WordApp.Documents.Open(strPath, , True, , passAtmp)\nIf Err &lt;&gt; 0 Then\n    On Error GoTo 0\nElse\n    MsgBox \"password is: \" &amp; passAtmp\n    Debug.Print passAtmp\n    WordApp.Quit\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = False\n    Exit Sub\nEnd If\n\nNext: Next: Next: Next: Next: Next\nNext: Next: Next: Next: Next: Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21921, "favorite_count": 5, "protected_date": 1549542108, "accepted_answer_id": 36617122, "answer_count": 4, "score": 3, "last_activity_date": 1549476804, "creation_date": 1433928826, "last_edit_date": 1460621264, "question_id": 30752525, "link": "https://stackoverflow.com/questions/30752525/i-forgot-the-password-to-open-a-word-document-how-can-i-retrieve-the-password", "title": "I forgot the password to open a Word document. How can I retrieve the password?", "body": "<p>I have a word document that prompts the user for a password to open it, the dialogue box is like below.</p>\n\n<pre><code>\"Enter Password to open file\" \n</code></pre>\n\n<p>I found some code to break a password using brute force which is below (written it from with Excel). The only issue is when I use Documents.Open if the password is wrong word shows the dialogue box - is there anyway to get round this?</p>\n\n<pre><code>Private Sub PasswordBreakerWord()\n'Author unknown but submitted by brettdj of www.experts-exchange.com\n\n\nDim objWord As Word.Application\nDim objDoc As Word.Document\nDim strPath As String\nDim passAtmp As String\n\nstrPath = \"H:\\My_Path\\\"\n\nSet objWord = CreateObject(\"word.Application\")\nobjWord.Visible = True\n\nDim i As Integer, j As Integer, k As Integer\nDim l As Integer, m As Integer, n As Integer\nDim i1 As Integer, i2 As Integer, i3 As Integer\nDim i4 As Integer, i5 As Integer, i6 As Integer\nOn Error Resume Next\nFor i = 65 To 66: For j = 65 To 66: For k = 65 To 66\nFor l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66\nFor i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66\nFor i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126\n\n  passAtmp = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)\n\n On Error Resume Next\n  Set objDoc = objWord.Documents.Open(Filename:=strPath &amp; \"High Yield FMA Procedures.doc\", PasswordTemplate:=passAtmp)\n If Err &lt;&gt; 0 Then\n    On Error GoTo 0\n Else\n    MsgBox \"password is: \" &amp; passAtmp\n    Debug.Print passAtmp\n    Exit Sub\nEnd If\n\nNext: Next: Next: Next: Next: Next\nNext: Next: Next: Next: Next: Next\n\nSet objWord = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4994070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c8109c5b952b371b8a1ee23c0f1e064?s=128&d=identicon&r=PG&f=1", "display_name": "hammidge", "link": "https://stackoverflow.com/users/4994070/hammidge"}, "edited": false, "score": 0, "creation_date": 1434027540, "post_id": 30753253, "comment_id": 49612941, "body": "Thanks for your help, however, this seems to replace all occurrences of &lt;tn&gt;, not just the third and fourth etc in any one line. Sorry if I am sending confusing signals, first timer you see."}, {"owner": {"reputation": 487, "user_id": 4968719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5bDr7.jpg?s=128&g=1", "display_name": "Akif Patel - BRMS", "link": "https://stackoverflow.com/users/4968719/akif-patel-brms"}, "reply_to_user": {"reputation": 1, "user_id": 4994070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c8109c5b952b371b8a1ee23c0f1e064?s=128&d=identicon&r=PG&f=1", "display_name": "hammidge", "link": "https://stackoverflow.com/users/4994070/hammidge"}, "edited": false, "score": 0, "creation_date": 1434100729, "post_id": 30753253, "comment_id": 49647621, "body": "Code Updated to replace &lt;tn&gt; from each para instead of whole doc. Find the change marked between **. Hope this is what you are looking for."}], "tags": [], "owner": {"reputation": 487, "user_id": 4968719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5bDr7.jpg?s=128&g=1", "display_name": "Akif Patel - BRMS", "link": "https://stackoverflow.com/users/4968719/akif-patel-brms"}, "is_accepted": false, "score": 0, "last_activity_date": 1434100687, "last_edit_date": 1434100687, "creation_date": 1433930823, "answer_id": 30753253, "question_id": 30752194, "link": "https://stackoverflow.com/questions/30752194/word-vba-search-for-tn-if-tn-is-active-more-than-3-times-in-a-paragraph-cha/30753253#30753253", "title": "word vba search for &lt;tn&gt;, If &lt;tn&gt; is active more than 3 times in a paragraph change all to &lt;FRED&gt; i.e. FRED&lt;tn&gt;Wilma&lt;tn&gt;Pebbles&lt;tn&gt;BamBam&lt;tn&gt;Dino", "body": "<p>Here is a small macro which will do the work for you. Happy VBA :-)</p>\n\n<pre><code>Public Sub ReplaceTN()\n**Dim J As Integer\nFor J = 1 To ActiveDocument.Paragraphs.Count**\n    ActiveDocument.Paragraphs(J).Range.Select\n    If UBound(Split(Selection.Text, \"&lt;tn&gt;\")) &gt; 2 Then\n        With Selection.Find\n            .Text = \"&lt;tn&gt;\"\n            .Replacement.Text = \"&lt;NEST&gt;\"\n            .Forward = True\n            .Wrap = wdFindContinue\n        End With\n        Selection.Find.Execute Replace:=wdReplaceAll\n    End If\n**Next J** End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4994070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c8109c5b952b371b8a1ee23c0f1e064?s=128&d=identicon&r=PG&f=1", "display_name": "hammidge", "link": "https://stackoverflow.com/users/4994070/hammidge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434100687, "creation_date": 1433927967, "question_id": 30752194, "link": "https://stackoverflow.com/questions/30752194/word-vba-search-for-tn-if-tn-is-active-more-than-3-times-in-a-paragraph-cha", "title": "word vba search for &lt;tn&gt;, If &lt;tn&gt; is active more than 3 times in a paragraph change all to &lt;FRED&gt; i.e. FRED&lt;tn&gt;Wilma&lt;tn&gt;Pebbles&lt;tn&gt;BamBam&lt;tn&gt;Dino", "body": "<p>I need to search and replace <code>&lt;tn&gt;</code> with <code>&lt;NEST&gt;</code>, but only those that appear more than twice in each paragraph/line:\ni.e. \nFlintstones<code>&lt;tn&gt;</code>Fred<code>&lt;tn&gt;</code>Wilma (leave this paragraph as is)</p>\n\n<p>Flintstones<code>&lt;tn&gt;</code>Fred<code>&lt;tn&gt;</code>Wilma<code>&lt;tn&gt;</code>Pebbles<code>&lt;tn&gt;</code>BamBam<code>&lt;tn&gt;</code>Dino (change to)\nFlintstones<code>&lt;NEST&gt;</code>Fred<code>&lt;NEST&gt;</code>Wilma<code>&lt;NEST&gt;</code>Pebbles<code>&lt;NEST&gt;</code>BamBam<code>&lt;NEST&gt;</code>Dino</p>\n\n<p>I have tried, but my knowledge is very limited.\nThanks in Advance for Help you may give.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1433928023, "post_id": 30752132, "comment_id": 49558276, "body": "Try debugging your code. Click on the margin of the line that calls your form 2 (this should come up with a brown highlight. When you go back to your form and click the button, the control will go to the VBA code, now manually walk through the code using <code>F8</code> button, you will know where the error occurs."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1433928446, "post_id": 30752132, "comment_id": 49558573, "body": "I don&#39;t even get to the point where I can start stepping through the code. I have tried commenting out lines of code, but in order for it to open the form without an error message, I need to comment out the entire sub!"}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1433928498, "post_id": 30752132, "comment_id": 49558612, "body": "The best place to start (as mentioned in my comment) <code>the line that calls your form 2</code>."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1433928800, "post_id": 30752132, "comment_id": 49558845, "body": "i am calling Form2 using the On Click Event Property in Form1 using a macro (not VBA Code, but the built in ones you create using Macro Tools)... so, as I said, I don&#39;t get to a first line of code."}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1433930061, "post_id": 30752132, "comment_id": 49559727, "body": "Open-up the VBA editor (alt+F11) and look at Tools &gt; References... Is there anything listed as &quot;MISSING&quot;? I&#39;d also consider redoing your macro expression (either as macro or in VBA if you can) and maybe do decompile as well - take a backup first so you can get back to what you had if it doesn&#39;t help."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1433935253, "post_id": 30752132, "comment_id": 49562921, "body": "@Matt Hall no nothing is missing in the references. I have actually already tried redoing the code. I attempted to do it all in VBA, but I get the same error message. I think it has to do with MS Access&#39; inability to find the code one I attempt to run it. strange thing is, that if I go to form properties and click the &quot;...&quot; button in the property field it takes me to the correct line of code!??"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 2, "creation_date": 1433935672, "post_id": 30752132, "comment_id": 49563208, "body": "When you did it in VBA did you catch the line of code it was highlighting the error on? The other thing you can do is Debug &gt; Compile and see if breaks somewhere (if it does, tell us where). Can you walk us through the line <code>Call modAdvisoryFactSheet.FactSheetSelection(sFund)</code>."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1433935972, "post_id": 30752132, "comment_id": 49563397, "body": "Running the compiler I have finally gotten an error message that pointed at a line of code... in the module you are asking about there was a variable that was not defined! Now it works... thank you so much for that idea!"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1433935993, "post_id": 30752132, "comment_id": 49563409, "body": "Please put it as an answer so that I can mark it as correct!"}], "answers": [{"comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 1, "creation_date": 1434037782, "post_id": 30779693, "comment_id": 49621000, "body": "That&#39;s ok.. I didn&#39;t have answers, just suggestions to try.. glad it works now :)"}, {"owner": {"reputation": 772, "user_id": 1780849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5d11f6020ddeb62912e115bac686a2?s=128&d=identicon&r=PG", "display_name": "srbhattarai", "link": "https://stackoverflow.com/users/1780849/srbhattarai"}, "edited": false, "score": 0, "creation_date": 1477491052, "post_id": 30779693, "comment_id": 67789550, "body": "My problem got worked after following this link <a href=\"http://stackoverflow.com/questions/10637622/communicating-with-the-ole-server-or-activex-control\" title=\"communicating with the ole server or activex control\">stackoverflow.com/questions/10637622/&hellip;</a> . Please refer to the comments suggested by Abu Hassan on the link. Thanks :)"}], "tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": true, "score": 2, "last_activity_date": 1434022621, "creation_date": 1434022621, "answer_id": 30779693, "question_id": 30752132, "link": "https://stackoverflow.com/questions/30752132/microsoft-access-click-event-on-form-produces-error/30779693#30779693", "title": "Microsoft Access Click Event on Form produces error", "body": "<p>This answer really belongs to Matt Hall. Matt, if you want to answer it, I'd be happy to give you the checkmark. For the time being, I'll put this up so it's clear what the solution was:</p>\n\n<p>I had to run Debug>Compile in order to see the line that caused the error. It turned out that I had a Variable in a Sub several level down, that wasn't properly defined.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4250225, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4madNNTzmH8/AAAAAAAAAAI/AAAAAAAAAAA/oNRgtI0Zm3I/photo.jpg?sz=128", "display_name": "Otha Stubblefield", "link": "https://stackoverflow.com/users/4250225/otha-stubblefield"}, "is_accepted": false, "score": 2, "last_activity_date": 1484061814, "creation_date": 1484061814, "answer_id": 41572283, "question_id": 30752132, "link": "https://stackoverflow.com/questions/30752132/microsoft-access-click-event-on-form-produces-error/41572283#41572283", "title": "Microsoft Access Click Event on Form produces error", "body": "<p>This did not quite cover the problem but I wanted to share my really simple solution.  I have an Access 2010 Split DB that runs a form on startup.  Occasionally, I'll get \"The Expression X you entered as the event property produced the following error...\".  Since this occurs at start up, X initially = \"On Load\".  </p>\n\n<p>Clicking through the dialog box will bring up the form, but then ALL the other controls will produce the same error with X being the event that would normally be handled (On Click, Dbl Click, After Update, etc.).</p>\n\n<p>A temporary fix occurs by just opening the Visual Basic window through Database Tools or switching to Design View and then View Code.  The form will then work until you close the DB.  When you reopen it, the error occurs again.  </p>\n\n<p>A longer fix occurs by opening the Visual Basic window and making ANY change. By any, I do mean adding a space or deleting one.  Saving the form and exiting fixes the problem DB until.....it decides to happen again.</p>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10362, "favorite_count": 0, "accepted_answer_id": 30779693, "answer_count": 2, "score": 3, "last_activity_date": 1484061814, "creation_date": 1433927792, "question_id": 30752132, "link": "https://stackoverflow.com/questions/30752132/microsoft-access-click-event-on-form-produces-error", "title": "Microsoft Access Click Event on Form produces error", "body": "<p>I created two forms in Microsoft Access 2010: let's call them Form1 and Form2.</p>\n\n<p>A Button on Form1 is supposed to call Form2. Form2 has two option buttons that are inside and optiongroup form, and two buttons, one of which is cancel. I created the following code which worked perfectly for a while: </p>\n\n<pre><code>Private Sub cmdCancel_Click()\n    DoCmd.Close acForm, Me.Name\nEnd Sub\n\nPrivate Sub cmdCreateFactsheet_Click()\nDim sFund As String\n\nIf Me.OptionGroup = 2 Then\n    On Error Resume Next\n        sFund = Me.ComboFundliste.Value\n    On Error GoTo 0\n    If sFund = \"\" Then\n        MsgBox (\"Please select a Fund\")\n        End\n    Else\n        Call modAdvisoryFactSheet.FactSheetSelection(sFund)\n    End If\nEnd If\n\nEnd Sub\n\nPrivate Sub frmSelection_Open()\n    Me.OptionGroup.DefaultValue = 1\nEnd Sub\n\nPrivate Sub OptOneFund_GotFocus()\n    If Me.OptionGroup = 2 Then\n        Me.ComboFundliste.Enabled = True\n    End If\nEnd Sub\n\nPrivate Sub OptAllFunds_GotFocus()\n    If Me.OptionGroup = 1 Then\n        Me.ComboFundliste.Value = \"\"\n        Me.ComboFundliste.Enabled = False\n    End If\nEnd Sub\n</code></pre>\n\n<p>Now, every single Sub produces an error when I try to open form2, or if I open form2 manually, when I try to klick on any of the controls.</p>\n\n<p>The message is always the same: <strong>The expression On Click you entered as the event property setting produced the following error: variable not defined</strong></p>\n\n<p>I realize this must have something to do with how I reference the form, but I don't understand why this worked well and then suddenly stopped working. I didn't change anything as far as I can remember and I don't see what is wrong!</p>\n\n<p>Any help appreciated.</p>\n"}, {"tags": ["excel", "vba", "cell"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433927171, "post_id": 30751603, "comment_id": 49557688, "body": "What line are you getting the error on?"}, {"owner": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433927199, "post_id": 30751603, "comment_id": 49557709, "body": "I have comment it in above code"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1433927243, "post_id": 30751603, "comment_id": 49557742, "body": "Maybe <code>ActiveWorkbook.Sheets(2)</code>is not a worksheet but a diagram sheet?"}, {"owner": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "edited": false, "score": 0, "creation_date": 1433927265, "post_id": 30751603, "comment_id": 49557763, "body": "No, it is a worksheet"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433927274, "post_id": 30751603, "comment_id": 49557765, "body": "Sorry missed that. What is in stsmenthandle when you get the error? If you do Activeworkbook.name is it the right workbook as 2 lines above you do not use activeworkbook(you could try taking activeworkbook out). what is in i when you error?"}], "answers": [{"comments": [{"owner": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "edited": false, "score": 0, "creation_date": 1433934851, "post_id": 30752092, "comment_id": 49562690, "body": "Thank you for your answer, I have another problem now. I recieve this error: <code>run time error -2147417748(80010108)  Method Value of Object Range failed</code>"}, {"owner": {"reputation": 115, "user_id": 4985436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2779341c608fd128cf1e7d7be3b1bca?s=128&d=identicon&r=PG&f=1", "display_name": "TylerDurden", "link": "https://stackoverflow.com/users/4985436/tylerdurden"}, "reply_to_user": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "edited": false, "score": 1, "creation_date": 1433935429, "post_id": 30752092, "comment_id": 49563049, "body": "Do you have in the range that your code checks cells with Error Values? Maybe that is the issue.. In this case you can add an extra if statement to ignore these. I edited my answer to include that."}, {"owner": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "edited": false, "score": 0, "creation_date": 1433935795, "post_id": 30752092, "comment_id": 49563295, "body": "I will test it. The problem is, that the process of data takes a long time then I will get such an error."}, {"owner": {"reputation": 115, "user_id": 4985436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2779341c608fd128cf1e7d7be3b1bca?s=128&d=identicon&r=PG&f=1", "display_name": "TylerDurden", "link": "https://stackoverflow.com/users/4985436/tylerdurden"}, "reply_to_user": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "edited": false, "score": 1, "creation_date": 1433936150, "post_id": 30752092, "comment_id": 49563505, "body": "when you find r ie. when the condition Cell Value = stsmenthandle why dont you exit the for loop? this will save time. Just add exit for after r = i."}, {"owner": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "edited": false, "score": 0, "creation_date": 1433938103, "post_id": 30752092, "comment_id": 49564890, "body": "Actually it is not possible, because, I would like to finde the last row (Cell), which have the same value with stsmenthandle."}, {"owner": {"reputation": 115, "user_id": 4985436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2779341c608fd128cf1e7d7be3b1bca?s=128&d=identicon&r=PG&f=1", "display_name": "TylerDurden", "link": "https://stackoverflow.com/users/4985436/tylerdurden"}, "reply_to_user": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "edited": false, "score": 0, "creation_date": 1433939049, "post_id": 30752092, "comment_id": 49565579, "body": "then change your loop to for i = lastrow to 1 step - 1 and add the exit for statement :)"}, {"owner": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "reply_to_user": {"reputation": 115, "user_id": 4985436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2779341c608fd128cf1e7d7be3b1bca?s=128&d=identicon&r=PG&f=1", "display_name": "TylerDurden", "link": "https://stackoverflow.com/users/4985436/tylerdurden"}, "edited": false, "score": 0, "creation_date": 1433939680, "post_id": 30752092, "comment_id": 49566032, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/80175/discussion-between-kaja-and-tylerdurden\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 115, "user_id": 4985436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2779341c608fd128cf1e7d7be3b1bca?s=128&d=identicon&r=PG&f=1", "display_name": "TylerDurden", "link": "https://stackoverflow.com/users/4985436/tylerdurden"}, "is_accepted": true, "score": 1, "last_activity_date": 1433935618, "last_edit_date": 1433935618, "creation_date": 1433927686, "answer_id": 30752092, "question_id": 30751603, "link": "https://stackoverflow.com/questions/30751603/method-cells-object-worksheet-failed/30752092#30752092", "title": "Method Cells object -Worksheet failed", "body": "<p>I think you need to replace</p>\n\n<pre><code>ActiveWorkbook.Worksheets(2).Cells(i, 2).Value = stsmenthandle\n</code></pre>\n\n<p>with</p>\n\n<pre><code>ActiveWorkbook.Worksheets(2).Cells(i, 2).Value = stsmenthandle\n</code></pre>\n\n<p>Sheets is a collection of Charts Sheets and Worksheets so if a chart sheet is getting picked up when you reference sheets(2) then the property .cells will not work.</p>\n\n<p>Let us know if this works, I am curious as well.</p>\n\n<p>Ignoring cells with error values:</p>\n\n<pre><code>If Not iserror(ActiveWorkbook.Worksheets(2).Cells(i, 2)) then\n     If ActiveWorkbook.Worksheets(2).Cells(i, 2).Value = stsmenthandle Then\n         r = i\n     End If\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1943, "favorite_count": 0, "accepted_answer_id": 30752092, "answer_count": 1, "score": 0, "last_activity_date": 1433935618, "creation_date": 1433926515, "last_edit_date": 1433927642, "question_id": 30751603, "link": "https://stackoverflow.com/questions/30751603/method-cells-object-worksheet-failed", "title": "Method Cells object -Worksheet failed", "body": "<p>I have a function, which should be run very often:</p>\n\n<pre><code> Public Function FindNumberofhandle(stsmenthandle As String) As Long\n Dim r As Long\n Dim LastUsedRow As Long\n LastUsedRow = Worksheets(2).Cells.Find(What:=\"*\", SearchOrder:=xlRows, SearchDirection:=xlPrevious, LookIn:=xlFormulas).Row\n For i = 1 To LastUsedRow\n     If ActiveWorkbook.Sheets(2).Cells(i, 2).Value = stsmenthandle Then 'ERROR HERE\n         r = i\n     End If\n Next i\n FindNumberofhandle = r\n End Function\n</code></pre>\n\n<p>I am getting this error:</p>\n\n<pre><code> run time error -2147417748(80010108)\n Method Cells of Object Worksheet failed\n</code></pre>\n\n<p>what should I do to solve this problem?</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433924996, "post_id": 30750977, "comment_id": 49556309, "body": "Dim j As Lond? have  you run this code at all?"}, {"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433926136, "post_id": 30750977, "comment_id": 49557012, "body": "Sorry for this, but Dim j as Long is irrelevant. I will edit it. Sorry again"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1433931604, "post_id": 30750977, "comment_id": 49560786, "body": "I suspect at least the line <code>If d1 &lt; datumPok &lt; d2 Then</code> is a big part of your problem, as you cannot use a logical statement like that in VBA. Try using <code>If d1 &lt; datumPok And datumPok &lt; d2 Then</code> instead, as that is the correct syntax. If your code still doesn&#39;t work (I only skimmed, looking for really obvious errors), could you try stating your problem a bit more succinctly, as it really isn&#39;t clear what you are asking, or where your problem is."}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "is_accepted": false, "score": 0, "last_activity_date": 1433932516, "creation_date": 1433932516, "answer_id": 30753859, "question_id": 30750977, "link": "https://stackoverflow.com/questions/30750977/check-date-based-on-startdate-and-enddate/30753859#30753859", "title": "Check date based on startDate and endDate", "body": "<p>I found the solution! </p>\n\n<p>Ordinary lookup with some mathematic formula was enough.</p>\n\n<pre><code>=LOOKUP(2,1/((G1&gt;=$A$1:$A$24)*(G1&lt;=$B$1:$B$24)),$C$1:$C$24)\n</code></pre>\n\n<p>assuming that date is in the column G1..</p>\n\n<p>Thanks to all! :)</p>\n"}], "owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1433932516, "creation_date": 1433924777, "last_edit_date": 1495540713, "question_id": 30750977, "link": "https://stackoverflow.com/questions/30750977/check-date-based-on-startdate-and-enddate", "title": "Check date based on startDate and endDate", "body": "<p>I am trying to set up a function which will be able to check dates from one sheet (sheet1) through 2 columns: startDate and endDate in Sheet2. And if there are matching then I want to copy values from one cell which is located on sheet2 into specific cell (the same row where is the cheking date) into sheet1.\n I wrote some code, but later on I've realized that my logic is not good.\nI also found <a href=\"https://stackoverflow.com/questions/20024182/vba-set-range-between-two-dates-using-search-function%20/\" title=\"this link\">this link on stackoverflow website</a>...</p>\n\n<p><a href=\"https://www.dropbox.com/s/49lfqp1rdv0ga1u/test.xlsm?dl=0\" rel=\"nofollow noreferrer\">my xls file - function is in the module 3 \"checkDate\"</a></p>\n\n<p>and here is the code..I need find function somehow..maybe I need to insert two iterators (2 for loops?)</p>\n\n<pre><code>Sub CheckDate()\n\nDim d1 As Date\nDim d2 As Date\nDim datumPok As Date\nDim s As String\nDim i As Long\n\nDim LR As Long\n\nLR = Range(\"K\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To LR\n\n    d1 = ActiveWorkbook.Worksheets(\"Glasnik\").Cells(i, 2).Value\n\n    d2 = ActiveWorkbook.Worksheets(\"Glasnik\").Cells(i, 3).Value\n\n    With .Range(\"K\" &amp; i)\n\n        datumPok = ActiveWorkbook.Worksheets(\"Spisak\").Cells(i, 11)\n\n        If d1 &lt; datumPok &lt; d2 Then\n            MsgBox \"opaaa\"\n\n            s = ActiveWorkbook.Worksheets(\"Glasnik\").Cells(i, 4).Value\n\n            ActiveWorkbook.Worksheets(\"Spisak\").Cells(i, 6).Value = s\n\n        Else\n            MsgBox \"test\"\n\n        End If\n     End With\nNext i\nEnd Sub\n</code></pre>\n\n<p>I am really into this..thanks guys! </p>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433924337, "post_id": 30750757, "comment_id": 49555903, "body": "Is that reference shown with &#39;MISSING:&#39; at the start?"}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433924467, "post_id": 30750757, "comment_id": 49555984, "body": "There isn&#39;t any. But there is a UNSAVED: VBAProject"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1433925283, "post_id": 30750757, "comment_id": 49556491, "body": "If <code>VBScript Regular Expressions 5.5</code> checked then you should able to create a <code>RegExp object</code> to use in your VBA eg: <code>Dim regEx As New VBScript_RegExp_55.RegExp</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1433924709, "post_id": 30750924, "comment_id": 49556123, "body": "Do you have <code>Option Explicit</code> on? Maybe you need to declare <code>Dim re as Object</code>. If you declared <code>re</code> in your code this is probably the case."}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1433924777, "post_id": 30750924, "comment_id": 49556181, "body": "re is defined as such : Static re As VBScript_RegExp_55.RegExp"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1433924811, "post_id": 30750924, "comment_id": 49556200, "body": "Change <code>VBScript_RegExp_55.RegExp</code> to <code>Object</code>"}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1433924871, "post_id": 30750924, "comment_id": 49556239, "body": "still the same issue."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1433924900, "post_id": 30750924, "comment_id": 49556258, "body": "Which line now? The <code>Set re = CreateObject(&quot;VBScript.RegExp&quot;)</code>?"}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1433925004, "post_id": 30750924, "comment_id": 49556317, "body": "Static re As Object Set re = CreateObject(&quot;VBScript.RegExp&quot;). It is pointing to the first line"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1433925170, "post_id": 30750924, "comment_id": 49556416, "body": "Maybe something is wrong with the dll <code>C:\\Windows\\System32\\vbscript.dll</code>? Try my code above on a fresh XLSM file. If it fails try to fix the vbscript.dll"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433928026, "post_id": 30750924, "comment_id": 49558279, "body": "If you get an error on <code>Static re as Object</code> I think you have bigger problems than references. Do you have any activex controls on worksheets?"}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1434010999, "post_id": 30750924, "comment_id": 49601288, "body": "I didnot add the analysis pak addin into my Excel Add-Ins."}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 1, "last_activity_date": 1433924857, "last_edit_date": 1433924857, "creation_date": 1433924592, "answer_id": 30750924, "question_id": 30750757, "link": "https://stackoverflow.com/questions/30750757/cant-find-project-or-library-on-regexp/30750924#30750924", "title": "Can&#39;t find project or library on RegExp", "body": "<p>Change the line:</p>\n\n<pre><code>If re Is Nothing Then Set re = New RegExp\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>If re Is Nothing Then Set re = CreateObject(\"VBScript.RegExp\")\n</code></pre>\n\n<p>Also remember to declare the <code>re</code> variable properly:</p>\n\n<pre><code>Dim re as Object\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8517487, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156569536687166/picture?type=large", "display_name": "Felix Faber", "link": "https://stackoverflow.com/users/8517487/felix-faber"}, "is_accepted": false, "score": 1, "last_activity_date": 1503676305, "creation_date": 1503676305, "answer_id": 45885191, "question_id": 30750757, "link": "https://stackoverflow.com/questions/30750757/cant-find-project-or-library-on-regexp/45885191#45885191", "title": "Can&#39;t find project or library on RegExp", "body": "<p>I was struggling with this until I noticed that <code>New rexExp</code> was being auto-corrected to <code>New RegExp</code>! The below worked for me, note the lower-case r in <code>regExp</code>:</p>\n\n<pre><code>Dim regEx As Object\nSet regEx = CreateObject(\"VBScript.regExp\")\n</code></pre>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1340, "favorite_count": 1, "accepted_answer_id": 30750924, "answer_count": 2, "score": 0, "last_activity_date": 1503676305, "creation_date": 1433924071, "last_edit_date": 1531164843, "question_id": 30750757, "link": "https://stackoverflow.com/questions/30750757/cant-find-project-or-library-on-regexp", "title": "Can&#39;t find project or library on RegExp", "body": "<p>I am running a macro in VBA that uses regular expressions. I moved a template to a new computer. </p>\n\n<p>When I try to run the project, I get an Error </p>\n\n<blockquote>\n  <p>Can't find project or library\"`</p>\n</blockquote>\n\n<p>and the line </p>\n\n<p><code>If re Is Nothing Then Set re = New RegExp\"</code></p>\n\n<p>is highlighted.</p>\n\n<p>When I open the references, it shows that <code>Microsoft VBScript Regular Expressions 5.5</code> has been ticked.</p>\n\n<p>Not sure where the issue is coming from. Need some guidance on this.</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1433921452, "post_id": 30749786, "comment_id": 49554006, "body": "open the file in one go and read it into <code>MyData</code> / <code>Array</code>. See <a href=\"http://stackoverflow.com/questions/11267459/vba-importing-text-file-into-excel-sheet/11267603#11267603\">Open the text file in memory</a>"}, {"owner": {"reputation": 891, "user_id": 1003040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3010c71435f9ebd1eb185745222d85ee?s=128&d=identicon&r=PG", "display_name": "Pepys", "link": "https://stackoverflow.com/users/1003040/pepys"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1433921687, "post_id": 30749786, "comment_id": 49554172, "body": "@SiddharthRout thanks but sometimes the file can get 2-3M characters. Isn&#39;t there a fast way to get the last row only?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1433921793, "post_id": 30749786, "comment_id": 49554261, "body": "you just can&#39;t retrieve the last character directly. Did you try the above method and check how much time is it taking?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1433922014, "post_id": 30749786, "comment_id": 49554417, "body": "In the above code <code>strData(ubound(strData))</code> will give you the last row"}, {"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1433926040, "post_id": 30749786, "comment_id": 49556961, "body": "How about deleting the last character in the excel file just before exporting as .csv, then replacing after the export?"}, {"owner": {"reputation": 891, "user_id": 1003040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3010c71435f9ebd1eb185745222d85ee?s=128&d=identicon&r=PG", "display_name": "Pepys", "link": "https://stackoverflow.com/users/1003040/pepys"}, "reply_to_user": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1433930307, "post_id": 30749786, "comment_id": 49559907, "body": "@MissPalmer but there is no semicolons in the excel file in the first place. I just save it as csv format and that adds separator itself (based on the locale settings)"}, {"owner": {"reputation": 891, "user_id": 1003040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3010c71435f9ebd1eb185745222d85ee?s=128&d=identicon&r=PG", "display_name": "Pepys", "link": "https://stackoverflow.com/users/1003040/pepys"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1433930411, "post_id": 30749786, "comment_id": 49559984, "body": "@SiddharthRout I tried this Ubound but no success and gave up quickly. Not a big priority task anyway but thanks for the help!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1433930498, "post_id": 30749786, "comment_id": 49560039, "body": "Can you post the code that you tried? It is prettry simple actually"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1433930553, "post_id": 30749786, "comment_id": 49560078, "body": "You may also want to check what <code>strData(ubound(strData)-1)</code> has?"}, {"owner": {"reputation": 891, "user_id": 1003040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3010c71435f9ebd1eb185745222d85ee?s=128&d=identicon&r=PG", "display_name": "Pepys", "link": "https://stackoverflow.com/users/1003040/pepys"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1434022744, "post_id": 30749786, "comment_id": 49609339, "body": "@SiddharthRout so I took &quot;Open the file in text memory&quot; code from your post and replaced the last row with strData() = strData(UBound(strData) - 1) Is that what you mean? I got &quot;cannot assign to array&quot; error"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1434022860, "post_id": 30749786, "comment_id": 49609413, "body": "no that is not what I meant. In that code, after the line <code>strData() = Split(MyData, vbCrLf)</code>, type <code>msgbox strData(ubound(strData))</code>. What do you get? If it is not <code>,</code> then replace the above line with <code>Msgbox strData(ubound(strData)-1)</code>. What do you get in both scenarios?"}, {"owner": {"reputation": 891, "user_id": 1003040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3010c71435f9ebd1eb185745222d85ee?s=128&d=identicon&r=PG", "display_name": "Pepys", "link": "https://stackoverflow.com/users/1003040/pepys"}, "edited": false, "score": 0, "creation_date": 1434023273, "post_id": 30749786, "comment_id": 49609724, "body": "With -1, I get the whole last row(there is extra blank row) Exactly what I need. Have to figure out how to delete the very last character of it ie. the semicolon :)"}, {"owner": {"reputation": 9494, "user_id": 128629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4f527fd568a4b80e220341067a7841?s=128&d=identicon&r=PG", "display_name": "Xavier Combelle", "link": "https://stackoverflow.com/users/128629/xavier-combelle"}, "edited": false, "score": 1, "creation_date": 1434027194, "post_id": 30749786, "comment_id": 49612680, "body": "The original cause of your problem is probably that at the end last line you have a cell with empty string in it. If you remove it (programmatly or manually you could remove the last <code>;</code>"}, {"owner": {"reputation": 891, "user_id": 1003040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3010c71435f9ebd1eb185745222d85ee?s=128&d=identicon&r=PG", "display_name": "Pepys", "link": "https://stackoverflow.com/users/1003040/pepys"}, "reply_to_user": {"reputation": 9494, "user_id": 128629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4f527fd568a4b80e220341067a7841?s=128&d=identicon&r=PG", "display_name": "Xavier Combelle", "link": "https://stackoverflow.com/users/128629/xavier-combelle"}, "edited": false, "score": 0, "creation_date": 1434029758, "post_id": 30749786, "comment_id": 49614681, "body": "@XavierCombelle you have a point. I don&#39;t have control over the file though. And changing it programatically is the same as doing it after the generation of the csv"}], "answers": [{"tags": [], "owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "is_accepted": false, "score": 1, "last_activity_date": 1438703781, "creation_date": 1438703781, "answer_id": 31813951, "question_id": 30749786, "link": "https://stackoverflow.com/questions/30749786/remove-last-character-in-csv-file-excel-vba/31813951#31813951", "title": "Remove last character in csv file, Excel vba", "body": "<pre><code>Open \"partnumbers.txt\" For Output As #2\nIf .SelectedItems.Count &lt;&gt; 0 Then\nxDirect$ = .SelectedItems(1) &amp; \"\\\"\nxFname$ = Dir(xDirect$, 7)\nDo While xFname$ &lt;&gt; \"\"\nIf Right(xFname$, 1) = \"1\" Then\n  Print #2, Left(xFname$, 13)\n  ActiveCell.Offset(xRow) = Left(xFname$, 13)\nEnd If\nxRow = xRow + 1\nxFname$ = Dir\nLoop\nEnd If\nClose #2\n</code></pre>\n\n<p>Basically you could use something like this. Here i am counting 13 characters and deleting the rest from each line in the txt; obviously this code will need to be rearanged to your needs, but you can take a look at the theory of this. Good Luck!</p>\n"}], "owner": {"reputation": 891, "user_id": 1003040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3010c71435f9ebd1eb185745222d85ee?s=128&d=identicon&r=PG", "display_name": "Pepys", "link": "https://stackoverflow.com/users/1003040/pepys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1331, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438703781, "creation_date": 1433921259, "question_id": 30749786, "link": "https://stackoverflow.com/questions/30749786/remove-last-character-in-csv-file-excel-vba", "title": "Remove last character in csv file, Excel vba", "body": "<p>I am generating a CSV file from Excel (2013) like this:</p>\n\n<pre><code>.SaveAs Filename:= _\n    filePath &amp; MyFileName, _\n    FileFormat:=xlCSV, _\n    Local:=True, _\n</code></pre>\n\n<p>That works fine but at the last row I get semicolon in the end as well:</p>\n\n<pre><code>994085;None ApS.;2;G; 12 ;31-12-2015; 40 ; -   ;Operational TB ;\n</code></pre>\n\n<p>How can I remove the last ; in that file?</p>\n\n<p>I saw it is easy in a string. I am not sure I can put the whole file into string. It is around 6-700K characters. It has to go pretty fast no matter what I implement</p>\n\n<p>Any ideas appreciated!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": true, "score": -1, "last_activity_date": 1433919396, "creation_date": 1433919396, "answer_id": 30749158, "question_id": 30748857, "link": "https://stackoverflow.com/questions/30748857/simplying-excel-vba-code/30749158#30749158", "title": "Simplying Excel VBA code", "body": "<p>Loop through worksheets:</p>\n\n<pre><code>Sub ertdfgcvb()\nDim ws As Worksheet\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nFor Each ws In ActiveWorkbook.Worksheets\n\n    If ws.FilterMode = True Then\n\n        With ActiveWorkbook 'I don't know what this view does, you might need to select the sheet beforehand\n            .CustomViews.Add ViewName:=\"Mine\", RowColSettings:=True\n            ws.AutoFilterMode = False\n            .CustomViews(\"Mine\").Show\n            .CustomViews(\"Mine\").Delete\n        End With\n\n            ws.Range(\"$A$129:$I$33602\").AutoFilter Field:=2, Criteria1:=ws.Range(\"T51\").Value\n            ws.Range(\"$A$129:$I$33602\").AutoFilter Field:=5, Criteria1:=ws.Range(\"T52\").Value\n    End If\nNext ws\n\nWith Application\n        .EnableEvents = True\n        .ScreenUpdating = True\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4993467, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcgciU_JhMQ/AAAAAAAAAAI/AAAAAAAAABo/Xci84Qy3k6A/photo.jpg?sz=128", "display_name": "eddie_ebo", "link": "https://stackoverflow.com/users/4993467/eddie-ebo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 30749158, "answer_count": 1, "score": 1, "last_activity_date": 1433919396, "creation_date": 1433918401, "last_edit_date": 1433918908, "question_id": 30748857, "link": "https://stackoverflow.com/questions/30748857/simplying-excel-vba-code", "title": "Simplying Excel VBA code", "body": "<p>I have a workbook that creates data reports for individual clients, with each client having a specific worksheet in the workbook. The raw data is stored in a sheet RawData. On each client specific worksheet, the raw data is duplicated e.g. <code>A129</code> of client worksheet says <code>=RawData!A1</code> for all relevant rows and columns.</p>\n\n<p>In each of the client worksheets the raw data is then autofiltered by the client name (<code>T51</code> in below code) and the month in question (<code>T52</code>). This is maintained by a macro (below) which is on every single client worksheet. The macro runs every time a cell is updated. Hence, once the raw data is updated it flows through automatically into the relevant client report.</p>\n\n<p>While this works wonderfully in populating only the relevant client's specific data in their report; due to there being +20 client reports, it runs slowly. After making a change to the raw data or the month needed it takes 25 mins to run through and update all the autofilters in all the spreadsheets.</p>\n\n<p>If anyone can assist, I would like to be able to put the code on one worksheet (say, the <code>RawData</code> sheet) which then loops through all the sheets and updates the autofilters that way. My guess is that doing so would make the whole process faster - by having one code run through 20 sheets successively rather than 20 trying to run at once.</p>\n\n<p>Any help or any ideas of how it could be done better would be much appreciated. Thank you.</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n    If Me.FilterMode = True Then\n        With Application\n            .EnableEvents = False\n            .ScreenUpdating = False\n        End With\n\n        With ActiveWorkbook\n            .CustomViews.Add ViewName:=\"Mine\", RowColSettings:=True\n            Me.AutoFilterMode = False\n            .CustomViews(\"Mine\").Show\n            .CustomViews(\"Mine\").Delete\n        End With\n\n        With ActiveWorkbook\n        Range(\"$A$129:$I$33602\").AutoFilter Field:=2, Criteria1:=Range(\"T51\").Value\n        Range(\"$A$129:$I$33602\").AutoFilter Field:=5, Criteria1:=Range(\"T52\").Value\n        End With\n\n        With Application\n            .EnableEvents = True\n            .ScreenUpdating = True\n        End With\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Further information: <code>T51</code> and <code>T52</code> are controlled by slicers linked to pivot chart. For example, changing the Month slicer changes all pivot tables in all client worksheets along with <code>T52</code> which then updates the filters. Same goes for <code>T51</code> and client names, although that's only worksheet specific</p>\n"}, {"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 2, "creation_date": 1433918617, "post_id": 30748689, "comment_id": 49552163, "body": "The XML is not well formed. There is an <code>&lt;&#47;Variable&gt;</code> to much before the last <code>Variable</code> element."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1433919075, "post_id": 30748689, "comment_id": 49552445, "body": "Agree with @AxelRichter. VTC"}, {"owner": {"reputation": 311, "user_id": 3275520, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c866bafd16e1257fd5d0661d3fbd3d87?s=128&d=identicon&r=PG&f=1", "display_name": "Mithun Manohar", "link": "https://stackoverflow.com/users/3275520/mithun-manohar"}, "edited": false, "score": 0, "creation_date": 1433919960, "post_id": 30748689, "comment_id": 49552982, "body": "Thanks for the quick reply !"}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 1, "creation_date": 1433920685, "post_id": 30748689, "comment_id": 49553495, "body": "A good way to investigate cases like this is to single-step through the code (F8 in the VBA editor).  Then you can interact with the objects in the immediate window (e.g. <code>debug.print Variables.Count</code> will tell you how many nodes your <code>SelectNodes</code> returned) and see what&#39;s going on."}], "answers": [{"tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 0, "last_activity_date": 1433921041, "creation_date": 1433921041, "answer_id": 30749724, "question_id": 30748689, "link": "https://stackoverflow.com/questions/30748689/parse-xml-from-vba-not-working/30749724#30749724", "title": "Parse XML from VBA not working", "body": "<p>A XML parser can only work if the XML is well formed. If not, the <code>oXMLDOMDocument.load</code> method fails.</p>\n\n<p>To check this, you could use <code>oXMLDOMDocument.parseError</code> like this:</p>\n\n<pre><code>Public Function ll()\n\n Dim oDoc As Object\n Set oDoc = CreateObject(\"MSXML2.DOMDocument\")\n oDoc.Load \"E:\\web\\cc.xml\"\n\n Dim oErr As Object\n\n If oDoc.parseError.ErrorCode &lt;&gt; 0 Then\n  Set oErr = oDoc.parseError\n  Debug.Print oErr.reason\n End If\n\n Dim oVariables As Object\n Dim oVariable As Object\n Set oVariables = oDoc.SelectNodes(\"/Environment/Variable\")\n For Each oVariable In oVariables\n  Debug.Print oVariable.SelectNodes(\"Caption\").Item(0).Text\n  Debug.Print oVariable.SelectNodes(\"Type\").Item(0).Text\n Next\n\nEnd Function\n</code></pre>\n\n<p>See: <a href=\"https://msdn.microsoft.com/en-us/library/ms762722%28v=vs.85%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms762722%28v=vs.85%29.aspx</a></p>\n"}], "owner": {"reputation": 311, "user_id": 3275520, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c866bafd16e1257fd5d0661d3fbd3d87?s=128&d=identicon&r=PG&f=1", "display_name": "Mithun Manohar", "link": "https://stackoverflow.com/users/3275520/mithun-manohar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 2, "accepted_answer_id": 30749724, "answer_count": 1, "score": 1, "last_activity_date": 1433921041, "creation_date": 1433917809, "question_id": 30748689, "link": "https://stackoverflow.com/questions/30748689/parse-xml-from-vba-not-working", "title": "Parse XML from VBA not working", "body": "<p>I am trying to parse xml file using excel vba. This is how my xml file looks like: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?&gt;\n&lt;Environment&gt;\n    &lt;Variable&gt;\n        &lt;Name&gt;&lt;/Name&gt;\n        &lt;Caption&gt;T1&lt;/Caption&gt;\n        &lt;Type&gt;TEXT&lt;/Type&gt;\n        &lt;Value&gt;V1&lt;/Value&gt;\n        &lt;Description&gt;&lt;/Description&gt;\n    &lt;/Variable&gt;\n        &lt;Variable&gt;\n        &lt;Name&gt;&lt;/Name&gt;\n        &lt;Caption&gt;T2&lt;/Caption&gt;\n        &lt;Type&gt;TEXT&lt;/Type&gt;\n        &lt;Value&gt;V2&lt;/Value&gt;\n        &lt;Description&gt;&lt;/Description&gt;\n    &lt;/Variable&gt;\n        &lt;Variable&gt;\n        &lt;Name&gt;&lt;/Name&gt;\n        &lt;Caption&gt;T3&lt;/Caption&gt;\n        &lt;Type&gt;TEXT&lt;/Type&gt;\n        &lt;Value&gt;V3&lt;/Value&gt;\n        &lt;Description&gt;&lt;/Description&gt;\n    &lt;/Variable&gt; &lt;Variable&gt;\n        &lt;Name&gt;&lt;/Name&gt;\n        &lt;Caption&gt;T4&lt;/Caption&gt;\n        &lt;Type&gt;TEXT&lt;/Type&gt;\n        &lt;Value&gt;V4&lt;/Value&gt;\n        &lt;Description&gt;&lt;/Description&gt;\n    &lt;/Variable&gt; &lt;Variable&gt;\n        &lt;Name&gt;&lt;/Name&gt;\n        &lt;Caption&gt;T5&lt;/Caption&gt;\n        &lt;Type&gt;TEXT&lt;/Type&gt;\n        &lt;Value&gt;V5&lt;/Value&gt;\n        &lt;Description&gt;&lt;/Description&gt;\n    &lt;/Variable&gt;\n    &lt;/Variable&gt; &lt;Variable&gt;\n        &lt;Name&gt;&lt;/Name&gt;\n        &lt;Caption&gt;T6&lt;/Caption&gt;\n        &lt;Type&gt;TEXT&lt;/Type&gt;\n        &lt;Value&gt;V6&lt;/Value&gt;\n        &lt;Description&gt;&lt;/Description&gt;\n    &lt;/Variable&gt;\n&lt;/Environment&gt;\n</code></pre>\n\n<p>And here is my code to parse it:</p>\n\n<pre><code>Public Function ll()\nDim doc As DOMDocument60\nSet doc = New DOMDocument60\ndoc.Load \"E:\\web\\cc.xml\"\nDim Variables As IXMLDOMNodeList\nDim variable As IXMLDOMNode\nSet Variables = doc.SelectNodes(\"/Environment/Variable\")\nFor Each variable In Variables\n    Debug.Print variable.SelectNodes(\"Caption\").Item(0).Text\n    Debug.Print variable.SelectNodes(\"Type\").Item(0).Text\nNext\nEnd Function\n</code></pre>\n\n<p>But I am not able to get this successfully run. I am using Excel 2013 and I have referenced to Microsoft XML 6.0. But nothing happens on execution. I tried to catch error with an on error statement, but it returns error number 0. Can anybody tel what I am doing wrong here.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1433920085, "post_id": 30748885, "comment_id": 49553063, "body": "why you use <code>EntireRow</code> if you already specify the row number, <code>EntireRow</code> used in case when required to determinate the row of the range, <code>Range(&quot;A1&quot;).EntireRow</code> for instance"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1433920246, "post_id": 30748885, "comment_id": 49553182, "body": "It is what is used by the OP, keeping the code as similar as possible to what is already used will make it slightly easier to understand from OP&#39;s perspective, especially as there&#39;s not really any good reason to change it. @Vasily"}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1433920798, "post_id": 30748885, "comment_id": 49553574, "body": "In this case, the code is considered as overweighted, so it mean in simple words <i>oil in oil</i>, but anyway this your answer and you can use or not use remarks from another users"}, {"owner": {"reputation": 153, "user_id": 4168707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iHV6F.png?s=128&g=1", "display_name": "kgkmeekg", "link": "https://stackoverflow.com/users/4168707/kgkmeekg"}, "edited": false, "score": 0, "creation_date": 1433921616, "post_id": 30748885, "comment_id": 49554113, "body": "Eirik your code is working. It had slipped out of my mind that i had changed the name of my sheet."}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": 4, "last_activity_date": 1433921002, "last_edit_date": 1433921002, "creation_date": 1433918503, "answer_id": 30748885, "question_id": 30748686, "link": "https://stackoverflow.com/questions/30748686/vba-delete-entire-row-in-sheet-1/30748885#30748885", "title": "VBA- Delete entire row in sheet 1", "body": "<p>You only need to specify which which sheet the row is in, in addition to specifying the row as you already do. I.e.</p>\n\n<pre><code> Worksheets(\"Sheet1\").Rows(2).EntireRow.Delete\n</code></pre>\n\n<p>Should do what you wish. If you have called the worksheet something different than \"Sheet1\", change what is inside the quotation marks. Strictly speaking you don't need to specify that it is the entire row you want to delete, as you've already said it is the row you are dealing with with <code>Rows(2)</code>, but it shouldn't do any harm in there either.</p>\n\n<p>If you additionally want to do the deletion from a different workbook (or just make sure that the deletion takes place in the correct workbook), you can also specify the workbook-name:</p>\n\n<pre><code>Workbooks(\"Workbookname.xlsm\").Worksheets(\"Sheet1\").Rows(2).EntireRow.Delete\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1433920311, "post_id": 30748922, "comment_id": 49553224, "body": "Activating the sheet instead of referencing the range you want to edit specifically <a href=\"https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/\" rel=\"nofollow noreferrer\">isn&#39;t considered good practice</a>. Neither is there any guarantee that the sheet the OP wants to work on is the one with an index of 0."}, {"owner": {"reputation": 487, "user_id": 4968719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5bDr7.jpg?s=128&g=1", "display_name": "Akif Patel - BRMS", "link": "https://stackoverflow.com/users/4968719/akif-patel-brms"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1433920405, "post_id": 30748922, "comment_id": 49553294, "body": "Agreed. However, it was just an example to show how to activate a sheet and work on it."}, {"owner": {"reputation": 153, "user_id": 4168707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iHV6F.png?s=128&g=1", "display_name": "kgkmeekg", "link": "https://stackoverflow.com/users/4168707/kgkmeekg"}, "edited": false, "score": 0, "creation_date": 1433921777, "post_id": 30748922, "comment_id": 49554251, "body": "So to activate my sheet1 named as &quot;DAT_FL&quot; do I need write          Sheets(1).Activate"}, {"owner": {"reputation": 153, "user_id": 4168707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iHV6F.png?s=128&g=1", "display_name": "kgkmeekg", "link": "https://stackoverflow.com/users/4168707/kgkmeekg"}, "edited": false, "score": 0, "creation_date": 1433921856, "post_id": 30748922, "comment_id": 49554315, "body": "Is there a way of knowing the index number of my sheet?"}, {"owner": {"reputation": 487, "user_id": 4968719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5bDr7.jpg?s=128&g=1", "display_name": "Akif Patel - BRMS", "link": "https://stackoverflow.com/users/4968719/akif-patel-brms"}, "edited": false, "score": 1, "creation_date": 1433923188, "post_id": 30748922, "comment_id": 49555135, "body": "Yes. <b>by Name</b> <code>Sheets(&quot;Sheet2&quot;).Activate</code> and  <b>get Index and activate by Index</b> <code>ind = Sheets(&quot;Sheet3&quot;).Index Sheets(ind).Activate</code>"}, {"owner": {"reputation": 153, "user_id": 4168707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iHV6F.png?s=128&g=1", "display_name": "kgkmeekg", "link": "https://stackoverflow.com/users/4168707/kgkmeekg"}, "edited": false, "score": 0, "creation_date": 1433931152, "post_id": 30748922, "comment_id": 49560509, "body": "Thanks Akif. Although activate by name is not working but activate through index works like a dream."}], "tags": [], "owner": {"reputation": 487, "user_id": 4968719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5bDr7.jpg?s=128&g=1", "display_name": "Akif Patel - BRMS", "link": "https://stackoverflow.com/users/4968719/akif-patel-brms"}, "is_accepted": false, "score": 1, "last_activity_date": 1433918624, "creation_date": 1433918624, "answer_id": 30748922, "question_id": 30748686, "link": "https://stackoverflow.com/questions/30748686/vba-delete-entire-row-in-sheet-1/30748922#30748922", "title": "VBA- Delete entire row in sheet 1", "body": "<p>If your button is in any other sheet and you wants to delete a row from another sheet, you simply have to activate that sheet. For example, you are trying to delete row from <strong>Sheet1</strong> then you can activate the sheet by this one-liner.</p>\n\n<pre><code>Sheets(0).Activate\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4168707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iHV6F.png?s=128&g=1", "display_name": "kgkmeekg", "link": "https://stackoverflow.com/users/4168707/kgkmeekg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11055, "favorite_count": 1, "accepted_answer_id": 30748885, "answer_count": 2, "score": 2, "last_activity_date": 1433921002, "creation_date": 1433917803, "question_id": 30748686, "link": "https://stackoverflow.com/questions/30748686/vba-delete-entire-row-in-sheet-1", "title": "VBA- Delete entire row in sheet 1", "body": "<p>I have been using the following to delete a row.</p>\n\n<pre><code>   Rows([2]).EntireRow.Delete\n</code></pre>\n\n<p>But this was when my workbook had only one sheet. A command button has been added in sheet2 which calls the macro present in sheet1.</p>\n\n<p>How should I modify my above code so that the VBA deletes the second row of sheet1 ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 788, "user_id": 4507149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3913c49f5baf6ef3467001151a1e6724?s=128&d=identicon&r=PG&f=1", "display_name": "TobiasR.", "link": "https://stackoverflow.com/users/4507149/tobiasr"}, "edited": false, "score": 3, "creation_date": 1433919312, "post_id": 30748548, "comment_id": 49552602, "body": "What isnt working? what is your Question?"}, {"owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "reply_to_user": {"reputation": 788, "user_id": 4507149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3913c49f5baf6ef3467001151a1e6724?s=128&d=identicon&r=PG&f=1", "display_name": "TobiasR.", "link": "https://stackoverflow.com/users/4507149/tobiasr"}, "edited": false, "score": 0, "creation_date": 1433977317, "post_id": 30748548, "comment_id": 49589575, "body": "Sorry Tobias, Silly me!  It all seems to work ok, but when the replace function copies the value in Col B for every &quot;2&quot; in Col A it then pastes over every 3 with a  number that looks like: 1.11111110+28"}, {"owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "reply_to_user": {"reputation": 788, "user_id": 4507149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3913c49f5baf6ef3467001151a1e6724?s=128&d=identicon&r=PG&f=1", "display_name": "TobiasR.", "link": "https://stackoverflow.com/users/4507149/tobiasr"}, "edited": false, "score": 0, "creation_date": 1434064337, "post_id": 30748548, "comment_id": 49635179, "body": "Sorry, this may be a very simple fix for someone on here, but I&#39;m totally lost! :(  Any help greatly appreciated!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1434340721, "post_id": 30836943, "comment_id": 49718619, "body": "Thanks Dan,  Have made the changes, but still seems the format of Col A is scientific once the macro completes."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1434342628, "post_id": 30836943, "comment_id": 49719015, "body": "What format should it be? You can set it as you loop through"}, {"owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1434349435, "post_id": 30836943, "comment_id": 49721197, "body": "It should be just a copy paste of exactly what is in Col B next the the &quot;2&quot; in Col A, until you hit the next &quot;2&quot; in Col A."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1434365164, "post_id": 30836943, "comment_id": 49729768, "body": "Okay I will take a look tomorrow, I&#39;m not at a machine right now"}, {"owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1434426093, "post_id": 30836943, "comment_id": 49759799, "body": "Thanks Dan, appreciate it! :)"}, {"owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1434517279, "post_id": 30836943, "comment_id": 49805927, "body": "Hi Dan, Any joy finding time to help a VBA novice out!?"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1434517575, "post_id": 30836943, "comment_id": 49806029, "body": "Sorry mate, I am flat out at work at the moment. Hopefully someone else jumps on this and picks it up otherwise I should have some time tomorrow."}, {"owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1435533215, "post_id": 30836943, "comment_id": 50226524, "body": "Hi Dan, Looks like no one else jumped in here. Can you try to resolve please?"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1434338891, "creation_date": 1434338891, "answer_id": 30836943, "question_id": 30748548, "link": "https://stackoverflow.com/questions/30748548/display-number-in-original-format-not-in-scientific-notation/30836943#30836943", "title": "Display number in original format not in scientific notation", "body": "<p>You don't need to loop so many times as you can use an OR in 1 loop and you don't need those variables for a one off thing really, This doesn't fix your problem but here is a much shorter and easier to manage version of your code:</p>\n\n<p>I put a couple of comments in where I am not sure what it is supposed to do.</p>\n\n<pre><code>Sub Deleterow97()\n'Macro to format text file to readable format for client\nFor i = Cells(Rows.Count, \"A\").End(xlUp).Row To 1 Step -1\n    If Cells(i, \"A\").Value = \"97\" Or Cells(i, \"A\").Value = \"98\" Or Cells(i, \"A\").Value = \"99\" Or Cells(i, \"A\").Value = \"1\" Then Cells(i, \"A\").EntireRow.Delete\nNext i\nWith Sheets(\"Sheet1\")   ' Replace Sheet1 by the name of your sheet\n    For RowCrnt = 1 To .Cells(Rows.Count, \"B\").End(xlUp).Row\n        If .Cells(RowCrnt, 1) = \"2\" Then .Range(\"A:A\").Replace What:=\"3\", Replacement:=.Cells(RowCrnt, 2), LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n    Next\n    For i = Cells(Rows.Count, \"A\").End(xlUp).Row To 2 Step -1 'I am not sure why this is in the WITH, should it be .Cells??\n        If Cells(i, \"A\").Value = \"2\" Then Cells(i, \"A\").EntireRow.Delete 'See above comment Also don't use brackets around the cells(blahblah) in the If, you don't need them\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1503803507, "creation_date": 1433917246, "last_edit_date": 1503803507, "question_id": 30748548, "link": "https://stackoverflow.com/questions/30748548/display-number-in-original-format-not-in-scientific-notation", "title": "Display number in original format not in scientific notation", "body": "<p>I have a text file, that when I import into excel looks like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/1ylBc.png\" alt=\"Raw Data\"></p>\n\n<p>I've been trying to do the following:</p>\n\n<p>Column A is the controller.<br>\nWhen a number above \"97\" appears in Col A I want to delete it.<br>\nI only want to let the first row of \"1's\" remain.<br>\nFor every \"2\" that appears, I firstly want to copy the value in Col B in the \"2\" row, and paste it over every \"3\" until I hit the next \"2\".<br>\nThen I'd like to delete the Row's with \"2\".</p>\n\n<p>So eventually the file should look like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/YMBsm.png\" alt=\"After Macro\"></p>\n\n<p>What I've got so far is:</p>\n\n<pre><code>Sub Deleterow97()\n'Macro to format text file to readable format for client\n\n    Last = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = Last To 1 Step -1\n        If (Cells(i, \"A\").Value) = \"97\" Then\n            Cells(i, \"A\").EntireRow.Delete\n        End If\n    Next i\n\n    Last = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = Last To 1 Step -1\n        If (Cells(i, \"A\").Value) = \"98\" Then\n            Cells(i, \"A\").EntireRow.Delete\n        End If\n    Next i\n\n    Last = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = Last To 1 Step -1\n        If (Cells(i, \"A\").Value) = \"99\" Then\n            Cells(i, \"A\").EntireRow.Delete\n        End If\n    Next i\n\n    Last = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = Last To 2 Step -1\n        If (Cells(i, \"A\").Value) = \"1\" Then\n            Cells(i, \"A\").EntireRow.Delete\n        End If\n    Next i\n\n    Dim CellValue As String\n    Dim RowCrnt As Integer\n    Dim RowMax As Integer\n\n    With Sheets(\"Sheet1\")   ' Replace Sheet1 by the name of your sheet\n        RowMax = .Cells(Rows.Count, \"B\").End(xlUp).Row\n        For RowCrnt = 1 To RowMax\n            If .Cells(RowCrnt, 1) = \"2\" Then\n                .Range(\"A:A\").Replace What:=\"3\", Replacement:=.Cells(RowCrnt, 2), LookAt:=xlPart, _\n                  SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n                  ReplaceFormat:=False\n            End If\n        Next\n\n        Last = Cells(Rows.Count, \"A\").End(xlUp).Row\n        For i = Last To 2 Step -1\n            If (Cells(i, \"A\").Value) = \"2\" Then\n                Cells(i, \"A\").EntireRow.Delete\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>When the replace function copies the value in Col B for every \"2\" in Col A it then pastes over every 3 with a number that looks like: 1.11111110+28</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1433918932, "post_id": 30748635, "comment_id": 49552357, "body": "thanks, one more thing, how to change such that A4 in the code is moving according to the row it is in?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1433919798, "post_id": 30748635, "comment_id": 49552888, "body": "I have updated the above post. You may have to refresh the page to see it"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1433919774, "last_edit_date": 1433919774, "creation_date": 1433917596, "answer_id": 30748635, "question_id": 30748522, "link": "https://stackoverflow.com/questions/30748522/cannot-set-the-formulaarray-property-of-the-range-vba-2003/30748635#30748635", "title": "Cannot set the FormulaArray property of the range vba 2003", "body": "<p>If I take <code>rowNum = 5</code> for testing purpose, your formula evaluates to</p>\n\n<p><code>=IF(A4=MIN(IF(MONTH(A$4:A$3)=MONTH(A4),A$4:A$3,1E+99)),A4,\")</code></p>\n\n<p>Notice, you are missing a Double Quote in the end?</p>\n\n<p>Try this</p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"AM4:AM\" &amp; (rowNum - 2)).FormulaArray = _\n                                                        \"=IF(A4=MIN(IF(MONTH(A$4:A$\" &amp; _\n                                                        (rowNum - 2) &amp; _\n                                                        \")=MONTH(A4),A$4:A$\" &amp; _\n                                                        (rowNum - 2) &amp; _\n                                                        \",1E+99)),A4,\"\"\"\")\"\n</code></pre>\n\n<p>The above formula now evaluates to</p>\n\n<p><code>=IF(A4=MIN(IF(MONTH(A$4:A$3)=MONTH(A4),A$4:A$3,1E+99)),A4,\"\")</code></p>\n\n<p><strong>Edit</strong></p>\n\n<blockquote>\n  <p>how to change such that A4 in the code is moving according to the row it is in? \u2013 </p>\n</blockquote>\n\n<p>You can't increment rows in formula array like that. To achieve what you want, enter the formula only in cell <code>AM4</code> and then fill it down. See this example</p>\n\n<pre><code>rowNum = 8\nWith Sheets(\"Sheet2\")\n    .Range(\"AM4\").FormulaArray = _\n                                \"=IF(A4=MIN(IF(MONTH(A$4:A$\" &amp; _\n                                (rowNum - 2) &amp; _\n                                \")=MONTH(A4),A$4:A$\" &amp; _\n                                (rowNum - 2) &amp; _\n                                \",1E+99)),A4,\"\"\"\")\"\n\n    .Range(\"AM4:AM\" &amp; (rowNum - 2)).FillDown\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 30748635, "answer_count": 1, "score": 1, "last_activity_date": 1433919774, "creation_date": 1433917147, "question_id": 30748522, "link": "https://stackoverflow.com/questions/30748522/cannot-set-the-formulaarray-property-of-the-range-vba-2003", "title": "Cannot set the FormulaArray property of the range vba 2003", "body": "<p>I am trying to set the FormulaArray property of a range in vba 2003. I am doing it this way,</p>\n\n<p>The code:</p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"AM4:AM\" &amp; (rowNum - 2)).FormulaArray = \"=IF(A4=MIN(IF(MONTH(A$4:A$\" &amp; (rowNum - 2) &amp; \")=MONTH(A4),A$4:A$\" &amp; (rowNum - 2) &amp; \",1E+99)),A4,\"\")\"\n</code></pre>\n\n<p>It is returning me an error '1004':</p>\n\n<pre><code>Unable to set the FormulaArray Property of the range method.\n</code></pre>\n\n<p>Not sure what the problem is. I am using the Excel 2003. Need some guidance in solving it.</p>\n"}, {"tags": ["web-services", "vba", "sharepoint", "soap", "caml"], "comments": [{"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1433914750, "post_id": 30747861, "comment_id": 49550375, "body": "What <i>do</i> you get? Anything at all? Have you looked at the response? What&#39;s in <code>.responseText</code>?"}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 1, "creation_date": 1433915318, "post_id": 30747861, "comment_id": 49550569, "body": "Unlike forum sites, we don&#39;t use &quot;Thanks&quot;, or &quot;Any help appreciated&quot;, or signatures on <a href=\"https://stackoverflow.com\">Stack Overflow</a>. See &quot;<a href=\"http://meta.stackexchange.com/questions/2950/should-hi-thanks-taglines-and-salutations-be-removed-from-posts\">Should &#39;Hi&#39;, &#39;thanks,&#39; taglines, and salutations be removed from posts?</a>."}, {"owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "reply_to_user": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1433915538, "post_id": 30747861, "comment_id": 49550666, "body": "I&#39;ve just noticed the 2nd part of ur question , .responseText contains the request text . There&#39;re already retrieved data which means that there&#39;s no errors in the syntax but may I have to organize it ?!"}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1433915616, "post_id": 30747861, "comment_id": 49550695, "body": "I think you mean it contains the response XML from SharePoint? And that the response XML does not contain the subfolders."}, {"owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "reply_to_user": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1433915743, "post_id": 30747861, "comment_id": 49550759, "body": "yeah I mean response text of my request (the result ) not the request"}], "answers": [{"comments": [{"owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "edited": false, "score": 0, "creation_date": 1433920776, "post_id": 30748535, "comment_id": 49553559, "body": "I&#39;ve added <code>&lt;rowLimit&gt;0&lt;&#47;rowLimit&gt;</code> inside queryoptions and the results are the same"}, {"owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "edited": false, "score": 0, "creation_date": 1433970654, "post_id": 30748535, "comment_id": 49586868, "body": "Upvote .. After retrieving the actual list I really used that info to get all results as I always having 30 rows only , Thanks"}], "tags": [], "owner": {"reputation": 602, "user_id": 1462690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b65b75b155884df4c40ca90bed47a842?s=128&d=identicon&r=PG", "display_name": "Sylvain Gantois", "link": "https://stackoverflow.com/users/1462690/sylvain-gantois"}, "is_accepted": false, "score": 1, "last_activity_date": 1433917208, "creation_date": 1433917208, "answer_id": 30748535, "question_id": 30747861, "link": "https://stackoverflow.com/questions/30747861/why-i-dont-get-list-subfolders-despite-using-recursiveall-option/30748535#30748535", "title": "why I don&#39;t get list subfolders despite using RecursiveAll option", "body": "<p>maybe you need to specify the \"rowLimit\" parameter for your query.</p>\n\n<p>You can set a specific number</p>\n\n<pre><code>&lt;rowLimit&gt;5000&lt;/rowLimit&gt;\n</code></pre>\n\n<p>or get all items with</p>\n\n<pre><code>&lt;rowLimit&gt;0&lt;/rowLimit&gt;\n</code></pre>\n\n<p>rowLimit is case-sensitive.</p>\n"}, {"comments": [{"owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "edited": false, "score": 0, "creation_date": 1433920715, "post_id": 30748751, "comment_id": 49553519, "body": "I&#39;ve tried adding soup1 to all tags gradually and the results are the same ,"}, {"owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "edited": false, "score": 0, "creation_date": 1433925292, "post_id": 30748751, "comment_id": 49556500, "body": "there is no results at all :("}, {"owner": {"reputation": 602, "user_id": 1462690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b65b75b155884df4c40ca90bed47a842?s=128&d=identicon&r=PG", "display_name": "Sylvain Gantois", "link": "https://stackoverflow.com/users/1462690/sylvain-gantois"}, "reply_to_user": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "edited": false, "score": 0, "creation_date": 1433928795, "post_id": 30748751, "comment_id": 49558843, "body": "how about the scope ?"}, {"owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "edited": false, "score": 0, "creation_date": 1433943345, "post_id": 30748751, "comment_id": 49568955, "body": "RecursiveAll and Recursive obtain the same results the main files and folders only"}], "tags": [], "owner": {"reputation": 602, "user_id": 1462690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b65b75b155884df4c40ca90bed47a842?s=128&d=identicon&r=PG", "display_name": "Sylvain Gantois", "link": "https://stackoverflow.com/users/1462690/sylvain-gantois"}, "is_accepted": false, "score": 0, "last_activity_date": 1433928630, "last_edit_date": 1433928630, "creation_date": 1433918023, "answer_id": 30748751, "question_id": 30747861, "link": "https://stackoverflow.com/questions/30747861/why-i-dont-get-list-subfolders-despite-using-recursiveall-option/30748751#30748751", "title": "why I don&#39;t get list subfolders despite using RecursiveAll option", "body": "<p>Try </p>\n\n<pre><code>Recursive\n</code></pre>\n\n<p>for the scope of ViewAttributes</p>\n\n<pre><code>&lt;ViewAttributes Scope='Recursive'/&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1433956476, "post_id": 30762780, "comment_id": 49578569, "body": "And what is the result of this? Why is this an answer instead of an edit to your question?"}, {"owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "reply_to_user": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1433965349, "post_id": 30762780, "comment_id": 49583817, "body": "yeah I should edit it to say that is the answer as I had the list of folders and subfolders in my list"}], "tags": [], "owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "is_accepted": true, "score": 1, "last_activity_date": 1434046125, "last_edit_date": 1434046125, "creation_date": 1433955631, "answer_id": 30762780, "question_id": 30747861, "link": "https://stackoverflow.com/questions/30747861/why-i-dont-get-list-subfolders-despite-using-recursiveall-option/30762780#30762780", "title": "why I don&#39;t get list subfolders despite using RecursiveAll option", "body": "<p>After alot of trials I've removed all extra unused tags and just checked that link on <a href=\"https://msdn.microsoft.com/en-us/library/dd964860(v=office.14).aspx\" rel=\"nofollow\">msdn</a> \nand updated my caml by adding another tag queryoptions as follows which solves my problem:</p>\n\n<pre><code>     &lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n            &lt;soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n            &lt;soap:Body&gt;\n            &lt;GetListItems xmlns=\"http://schemas.microsoft.com/sharepoint/soap/\"&gt;\n            &lt;listName&gt;listname&lt;/listName&gt;\n            &lt;FieldRef Name=\"FSObjType\" /&gt;&lt;Value Type=\"int\"&gt;1&lt;/Value&gt;\n            &lt;rowLimit&gt;0&lt;/rowLimit&gt;\n            &lt;queryOptions&gt;&lt;QueryOptions&gt;   &lt;IncludeMandatoryColumns&gt;FALSE&lt;/IncludeMandatoryColumns&gt;\n            &lt;ViewAttributes Scope=\"RecursiveAll\"&gt;&lt;/ViewAttributes&gt;&lt;/QueryOptions&gt;&lt;/queryOptions&gt;\n            &lt;/GetListItems&gt;\n            &lt;/soap:Body&gt;\n            &lt;/soap:Envelope&gt;\n</code></pre>\n"}], "owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 30762780, "answer_count": 3, "score": 1, "last_activity_date": 1434046125, "creation_date": 1433914541, "last_edit_date": 1495539821, "question_id": 30747861, "link": "https://stackoverflow.com/questions/30747861/why-i-dont-get-list-subfolders-despite-using-recursiveall-option", "title": "why I don&#39;t get list subfolders despite using RecursiveAll option", "body": "<p>This is my function why I don't get the subfolders although I'm using recursive ALL option.</p>\n\n<p>I don't even obtain 1-level subfolders I only get the main files and folders, I'm sure I've something wrong in soap request but I can't figure it out.</p>\n\n<p>I've used the same request as this <a href=\"https://stackoverflow.com/questions/6351845/sharepoint-list-getlistitems-webservice-to-return-sub-folder-contents-recursive\">question</a></p>\n\n<pre><code>Function getResults(url, xmlDoc, spreturnattribute)\n\n    request = \"&lt;?xml version='1.0' encoding='utf-8'?&gt;\" &amp; _\n            \"&lt;soap:Envelope xmlns:soap='http://www.w3.org/2003/05/soap-envelope' xmlns:soap1='http://schemas.microsoft.com/sharepoint/soap/'&gt;\" &amp; _\n            \" &lt;soap:Header/&gt;\" &amp; _\n             \" &lt;soap:Body&gt;\" &amp; _\n              \"  &lt;soap1:GetListItems&gt;\" &amp; _\n                \"  &lt;soap1:listName&gt;Documents&lt;/soap1:listName&gt;\" &amp; _\n                     \"&lt;QueryOptions&gt;\" &amp; _\n                     \"&lt;IncludeMandatoryColumns&gt;TRUE&lt;/IncludeMandatoryColumns&gt;\" &amp; _\n                      \"&lt;ViewAttributes Scope='RecursiveAll'/&gt;\" &amp; _\n                         \"&lt;DateInUtc&gt;TRUE&lt;/DateInUtc&gt;\" &amp; _\n                    \"&lt;/QueryOptions&gt;\" &amp; _\n                \"&lt;/soap1:GetListItems&gt;\" &amp; _\n                  \"&lt;/soap:Body&gt;\" &amp; _\n                \"&lt;/soap:Envelope&gt;\"\n\n\n    With CreateObject(\"Microsoft.XMLHTTP\")\n        .Open \"Get\", url, False, Null, Null\n        .setRequestHeader \"Content-Type\", \"text/xml; charset=utf-8\"\n        .setRequestHeader \"SOAPAction\", \"http://schemas.microsoft.com/sharepoint/soap/GetListItems\"\n        .send request\n\n\n\n        xmlDoc.setProperty \"SelectionLanguage\", \"XPath\"\n        xmlDoc.async = False\n        xmlDoc.validateOnParse = False\n        xmlDoc.resolveExternals = False\n        xmlDoc.setProperty \"SelectionNamespaces\", \"xmlns:s='uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/' xmlns:namespace='http://schemas.microsoft.com/sharepoint/soap/' xmlns:rs='urn:schemas-microsoft-com:rowset' xmlns:z='#RowsetSchema'\"\n        xmlDoc.LoadXML (.responseText)\n\n        Dim strQuery: strQuery = \".//z:row\"\n\n        Set colItem = xmlDoc.SelectNodes(strQuery)\n\n        For Each objItem In colItem\n        Debug.Print objItem.Attributes.getNamedItem(\"ows_LinkFilename\").Text\n        For Each queryNode In objItem.ChildNodes\n          Debug.Print queryNode.Attributes.getNamedItem(\"ows_LinkFilename\").Text\n        Next\n        Next\n\n    End With\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<h2>Edit1</h2>\n\n<p>Adding reference article</p>\n\n<h2>Edit2</h2>\n\n<p>may that due to security issue on the site ? or does setting xmldoc properties cause that?\nI'm not very good at VBA but it's an easy script and I wonder why it's not working\nand FYI my sharepoint is 2013</p>\n"}, {"tags": ["excel", "vba", "filter"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 1, "creation_date": 1433911724, "post_id": 30747014, "comment_id": 49549397, "body": "Which version of excel do you use? It&#39;s possible at least from excel 2010 to select multiple item in autofilter too without using VBA."}], "answers": [{"tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": false, "score": 1, "last_activity_date": 1433911433, "creation_date": 1433911433, "answer_id": 30747265, "question_id": 30747014, "link": "https://stackoverflow.com/questions/30747014/vba-excel-custom-text-filter-by-more-than-two-texts/30747265#30747265", "title": "VBA Excel custom text filter by more than two texts", "body": "<p>Here's some code. Just enter the values to filter by in the <code>ValuesToFilter</code> variable, select a cell somewhere in the column to filter and run the code. It works in Tables and informal lists:</p>\n\n<pre><code>Sub FilterList()\nDim ValuesToFilter As String\nDim FilterValues() As String\nDim ColNumberInFilterRange As Long\nDim FilterRange As Excel.Range\nDim InTable As Boolean\nDim CollUniqueValues As Collection\nDim i As Long\n\nValuesToFilter = \"85254,8782A,GH0012\" 'comma-separated string\nIf ActiveSheet Is Nothing Then\n    MsgBox \"No active worksheet.\"\n    Exit Sub\nEnd If\n\nWith Selection\n    If .Cells.Count = 1 And IsEmpty(ActiveCell) Then\n        MsgBox \"Please select a cell within one or more cells with data.\"\n        Exit Sub\n    End If\n    If Union(ActiveCell.EntireColumn, .EntireColumn).Address &lt;&gt; ActiveCell.EntireColumn.Address Then\n        MsgBox \"Only select from one column\"\n        Exit Sub\n    End If\n    'Set the range to be filtered depending on whether it's a Table or not\n   If Not ActiveCell.ListObject Is Nothing Then\n        Set FilterRange = ActiveCell.ListObject.Range\n        InTable = True\n    Else\n        Set FilterRange = ActiveCell.CurrentRegion\n    End If\n    If Union(Selection, FilterRange).Address &lt;&gt; FilterRange.Address Then\n        MsgBox \"Please make sure all cells are within the same table or contiguous area.\"\n        Exit Sub\n    End If\n    'If not in a table and we're filtering a different area than currently filtered\n   'then turn the existing AutoFilter off, so no error when the new area gets filtered.\n   If Not InTable And ActiveSheet.AutoFilterMode Then\n        If ActiveSheet.AutoFilter.Range.Address &lt;&gt; .CurrentRegion.Address Then\n            ActiveSheet.AutoFilterMode = False\n        End If\n    End If\n\n    FilterValues = Split(ValuesToFilter, \",\")\n    'Try to add every selected value to a collection - only unique values will succeed\n   Set CollUniqueValues = New Collection\n    For i = LBound(FilterValues) To UBound(FilterValues)\n        On Error Resume Next\n        CollUniqueValues.Add FilterValues(i)\n        On Error GoTo 0\n    Next i\n    'Transfer the collection to an array for the AutoFilter function\n   ReDim FilterValues(1 To CollUniqueValues.Count)\n    For i = LBound(FilterValues) To UBound(FilterValues)\n        FilterValues(i) = CollUniqueValues(i)\n    Next i\n    'Determine the index of the column to be filtered within the FilterRange\n   ColNumberInFilterRange = (.Column - FilterRange.Columns(1).Column) + 1\n    FilterRange.AutoFilter Field:=ColNumberInFilterRange, Criteria1:=FilterValues, Operator:=xlFilterValues\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This code is modified from this <a href=\"http://yoursumbuddy.com/filter-column-by-external-list/\" rel=\"nofollow\">post of mine</a>, where you enter the values into a userform. If you do this a lot, you might want to download the sample workbook. My <a href=\"http://yoursumbuddy.com/filter-column-by-all-selected-values/\" rel=\"nofollow\">post before that</a> is about filtering by all the selected values in a column.</p>\n"}, {"tags": [], "owner": {"reputation": 487, "user_id": 4968719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5bDr7.jpg?s=128&g=1", "display_name": "Akif Patel - BRMS", "link": "https://stackoverflow.com/users/4968719/akif-patel-brms"}, "is_accepted": true, "score": 2, "last_activity_date": 1433918280, "creation_date": 1433918280, "answer_id": 30748815, "question_id": 30747014, "link": "https://stackoverflow.com/questions/30747014/vba-excel-custom-text-filter-by-more-than-two-texts/30748815#30748815", "title": "VBA Excel custom text filter by more than two texts", "body": "<p>You can achieve the same simply by using <strong>Advanced Filter</strong> option. It is smart enough to filter your data on <strong>multiple columns and more than two values</strong>. </p>\n\n<p>You just need to create <strong>Filter Criteria</strong> section where the column names must be similar to the column names of your data range and this could be in the same sheet or another. In criteria range, you can specify any number of values and multiple columns.</p>\n\n<p>I have illustrated this in below screenshot of my example. Click OK button on advanced filter dialog and your date would be filtered out.</p>\n\n<p><img src=\"https://i.stack.imgur.com/lGRZe.png\" alt=\"using advanced filter\"></p>\n"}], "owner": {"reputation": 175, "user_id": 4772433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9472cd26845f7c8b43be8d0c1c00df42?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/4772433/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1822, "favorite_count": 0, "accepted_answer_id": 30748815, "answer_count": 2, "score": 0, "last_activity_date": 1433918280, "creation_date": 1433909819, "question_id": 30747014, "link": "https://stackoverflow.com/questions/30747014/vba-excel-custom-text-filter-by-more-than-two-texts", "title": "VBA Excel custom text filter by more than two texts", "body": "<p>I have a long table and usually I want to filter the asset numbers (The first column and rows from row 4 to row 3080) by more than one value. The excel custom text filter can't filter by more than two texts. I wonder if it is possible to filter by more than two. I know it might be possible in VBA. </p>\n\n<p>Example, filter the column A by \"85254\",\"8782A\" and \"GH0012\"</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 1, "creation_date": 1433910475, "post_id": 30746805, "comment_id": 49549046, "body": "Tevlyn&#39;s answer is good. You should note that, if you&#39;re using Excel 2007 or higher, your test above is faulty. That&#39;s because in those versions <code>QueryTables</code> most likely reside in a <code>ListObject</code>, like Worksheet.ListObject.QueryTable. Of course a table (ListObject) doesn&#39;t necessarily contain a QueryTable - if you&#39;re interested, I wrote a post about testing for them: <a href=\"http://yoursumbuddy.com/four-listobject-querytable-tests-better-last/\" rel=\"nofollow noreferrer\">yoursumbuddy.com/four-listobject-querytable-tests-better-las&zwnj;&#8203;t</a>. Dick Kusleika also wrote a definitive SO answer on the topic:<a href=\"http://stackoverflow.com/a/18069060/293078\">stackoverflow.com/a/18069060/293078</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5068, "user_id": 336470, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e77ffb7251098dcd0c029ffbeca7a42c?s=128&d=identicon&r=PG", "display_name": "Antony", "link": "https://stackoverflow.com/users/336470/antony"}, "edited": false, "score": 0, "creation_date": 1433909682, "post_id": 30746941, "comment_id": 49548816, "body": "Thanks! I was googling around, and figured out the solution independently (except I used Thisworkbook, not Activeworkbook). Good stuff. thanks. Marked yours as chosen solution."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1433909313, "creation_date": 1433909313, "answer_id": 30746941, "question_id": 30746805, "link": "https://stackoverflow.com/questions/30746805/how-to-remove-querytable-connections-not-used-in-this-workbook/30746941#30746941", "title": "How to remove QueryTable connections not used in this workbook?", "body": "<p>Maybe</p>\n\n<pre><code>Sub deleteConnections()\nDim conn As WorkbookConnection\nFor Each conn In ActiveWorkbook.Connections\n    conn.Delete\nNext conn\nEnd Sub\n</code></pre>\n\n<p>That removed a bunch of connections that were actually active in my workbook. Should also do the trick for connections that are not used. </p>\n"}], "owner": {"reputation": 5068, "user_id": 336470, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e77ffb7251098dcd0c029ffbeca7a42c?s=128&d=identicon&r=PG", "display_name": "Antony", "link": "https://stackoverflow.com/users/336470/antony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2413, "favorite_count": 0, "accepted_answer_id": 30746941, "answer_count": 1, "score": 2, "last_activity_date": 1433909313, "creation_date": 1433908484, "question_id": 30746805, "link": "https://stackoverflow.com/questions/30746805/how-to-remove-querytable-connections-not-used-in-this-workbook", "title": "How to remove QueryTable connections not used in this workbook?", "body": "<p>I only have this one workbook opened (no other worbooks were opened at the time), and noticed a bunch of Data connections listed. Upon further investigation, it shows that these connections are not \"used in this workbook\" (again, the weird thing is that I only have this workbook open, so if connections are not used here, where else are they used in?)</p>\n\n<p><img src=\"https://i.stack.imgur.com/VbPT4.png\" alt=\"Screenshot from Excel 2010\"></p>\n\n<p>Using the following code, it shows that the QueryTables.Count is all 0s in all worksheets in this workbook. So is there a way to programmatically (VBA, not C#), to remove the connections? Really would hate to individually and manually remove connections</p>\n\n<pre><code>Dim Worksheet As Object\nFor Each Worksheet In ThisWorkbook.Worksheets\n    Debug.Print (Worksheet.QueryTables.Count)\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1433919499, "post_id": 30746771, "comment_id": 49552695, "body": "It is a bit unclear what you are asking - it seems you want to check if each row of a column is empty, and if so you want to put today&#39;s date into the same row of a column in a different sheet? Am I correct in my assumptions?"}], "answers": [{"tags": [], "owner": {"reputation": 323, "user_id": 1367849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/CMoLn.gif?s=128&g=1", "display_name": "AirUp", "link": "https://stackoverflow.com/users/1367849/airup"}, "is_accepted": false, "score": 0, "last_activity_date": 1433922210, "creation_date": 1433922210, "answer_id": 30750133, "question_id": 30746771, "link": "https://stackoverflow.com/questions/30746771/how-do-i-make-a-vba-do-this/30750133#30750133", "title": "How do I make a vba do this?", "body": "<p>To answer your question directly:</p>\n\n<pre><code>Sheets(\"Table1\").Range(\"B1\").Value = \"Logging date: \" &amp; Now\n</code></pre>\n\n<p>This little snippet puts the text \"Logging date: 10.06.2015 09:30:21\" in the field at B1. Another possibility is to use Cells(rowIndex,colIndex), in this case Cells(1,2) which is less understandable in my opinion.</p>\n\n<p>As I can only guess, what your pseudocode should do, here my interpretation:</p>\n\n<pre><code>Dim row As Integer\nDim col As Integer\nrow = 1\ncol = 2\n\nIf (IsEmpty(Cells(row, col)) Or Cells(row, col).Value = \"0\") Then\n    Sheets(\"Table1\").Range(\"B1\").Value = \"Logging date: \" &amp; Now\nElse\n    'whatever you want to do otherwise\nEnd If\n</code></pre>\n\n<p>Do not expect it to be solving your problem instantly. But maybe this is a first starting point for you?</p>\n"}], "owner": {"reputation": 1, "user_id": 4993085, "user_type": "registered", "profile_image": "https://graph.facebook.com/1129851527041567/picture?type=large", "display_name": "Bryan Glauser", "link": "https://stackoverflow.com/users/4993085/bryan-glauser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433922210, "creation_date": 1433908221, "last_edit_date": 1433920701, "question_id": 30746771, "link": "https://stackoverflow.com/questions/30746771/how-do-i-make-a-vba-do-this", "title": "How do I make a vba do this?", "body": "<p>I have been building a dashboard as a tooling checkout sheet. The data output to the logbook works fine.  I have not been able to figure out how to implement my next step yet.  I want to find a way to put a \"check in\" date to the logbook to finalize the procedure. </p>\n\n<p>I want to know what an efficient way to reference sheet1;e10 to sheet2;columnB would be.</p>\n\n<p><strong>Pseudocode</strong>:</p>\n\n<pre><code>if column (i) is empty or 0 then\n  =today() in sheet2;same row column (i).\nendif\"\n</code></pre>\n\n<p>I want to assign this a macro to a button.  I did the same for the checkout procedure.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1433892610, "post_id": 30744579, "comment_id": 49544787, "body": "Your problem seems to be related to &quot;How do I reliably find the <i>last row</i> in a given range or worksheet&quot; -- see the answer linked to in the Close reason. If you have trouble implementing that solution, do ask a new question but please include the code you are using and the specific problem you&#39;re encountering. Cheers."}, {"owner": {"reputation": 2756, "user_id": 2487730, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/738346725144dd27b32670cc7316ee80?s=128&d=identicon&r=PG", "display_name": "zipzit", "link": "https://stackoverflow.com/users/2487730/zipzit"}, "edited": false, "score": 0, "creation_date": 1433892629, "post_id": 30744579, "comment_id": 49544791, "body": "Can I ask a dumb question?  Why not have a single master XL sheet with all raw data, then use VBA to generate a new tab for each employee using master data sheet.   You run the macro each time you publish. Macro copies only relevent data to employee tabs, based on now().  Only master XL sheet has master data...  (think like a database, generate reports [ employee tabs] on demand...)"}, {"owner": {"reputation": 1, "user_id": 4992194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/492qJ.jpg?s=128&g=1", "display_name": "Max MacEachern", "link": "https://stackoverflow.com/users/4992194/max-maceachern"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1433893007, "post_id": 30744579, "comment_id": 49544910, "body": "Thanks for the reply David and zipzit.  @David - I&#39;ll read through the link you posted and see if I can draw what I need from the documentation. This isn&#39;t quite the same as my situation because I am not trying to find the last row on the worksheet, but rather the last row that contains project information. There are rows beyond the last project that contain information.  zipzit - I&#39;d love that, but this is a document that managers manipulate and enter information into. I&#39;d have to get everyone on board with making such a change, which I am open to, but would take an organizational shift."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1433893252, "post_id": 30744579, "comment_id": 49544983, "body": "OK. I&#39;ll reopen the Question but I think it would behoove you to show the code you&#39;re currently using and which part of that code you need assistance with.  You may be able to use the <code>.CurrentRegion.Rows.Count</code> to resize the range from &quot;Q4&quot;."}, {"owner": {"reputation": 1, "user_id": 4992194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/492qJ.jpg?s=128&g=1", "display_name": "Max MacEachern", "link": "https://stackoverflow.com/users/4992194/max-maceachern"}, "edited": false, "score": 0, "creation_date": 1433893786, "post_id": 30744579, "comment_id": 49545119, "body": "Sounds good, I updated the original post with my code that shifts the column for each tab in the workbook. I haven&#39;t moved on writing code that clears the cells because I honestly don&#39;t know where to start.  I&#39;d post a picture if that would be more helpful, but I don&#39;t think I am allowed to given how new I am to this website. Can I post an imgur link here instead?"}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1433894296, "post_id": 30744579, "comment_id": 49545287, "body": "Yes post an image to imgur and someone will likely post it in for you.  Is there gaps in the project.  something like <code>range(&quot;Q4&quot;,range(&quot;Q4&quot;).end(xldown)).select</code> would do the same thing as putting your cursor in Q4 and pressing ctrl+shift+down which assumes there are no gaps between projects and then a gap between any other data."}, {"owner": {"reputation": 1, "user_id": 4992194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/492qJ.jpg?s=128&g=1", "display_name": "Max MacEachern", "link": "https://stackoverflow.com/users/4992194/max-maceachern"}, "edited": false, "score": 0, "creation_date": 1433953856, "post_id": 30744579, "comment_id": 49576923, "body": "Here is the imgur link: <a href=\"http://i.imgur.com/B25oJLP.png\" rel=\"nofollow noreferrer\">i.imgur.com/B25oJLP.png</a>  I want to be able to clear the information in rows 3-10 when I move the column to the next month, but the number of rows will vary depending on the number of projects someone is on."}], "answers": [{"tags": [], "owner": {"reputation": 438, "user_id": 3007188, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WbZIr.jpg?s=128&g=1", "display_name": "AndrewT", "link": "https://stackoverflow.com/users/3007188/andrewt"}, "is_accepted": false, "score": 0, "last_activity_date": 1433904599, "creation_date": 1433904599, "answer_id": 30746264, "question_id": 30744579, "link": "https://stackoverflow.com/questions/30744579/vba-looping-across-tabs-same-tab-structure-different-number-of-rows/30746264#30746264", "title": "VBA - Looping across tabs (same tab structure, different number of rows)", "body": "<p>If you are after a quick simple answer then here is my 2 cents</p>\n\n<p>To copy the range for a column of any length when you know there will not be a blank cell until the bottom then:</p>\n\n<pre><code>Range(\"a1\", Range(\"a1\").End(xlDown)).Copy\n</code></pre>\n\n<p>Basically its the same as clicking on a1 and doing Ctrl+Shift+DownArrow</p>\n\n<p>If there are going to be blank rows then a not so nice but workable solution is:</p>\n\n<pre><code>Range(\"a1\", Range(\"a100000\").End(xlUp)).Copy\n</code></pre>\n\n<p>This is just going a long way down and doing a ctrl+upArrow to get to the bottom row.</p>\n\n<p>There are probably more eloquent ideas out there but I use these all the time.</p>\n"}], "owner": {"reputation": 1, "user_id": 4992194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/492qJ.jpg?s=128&g=1", "display_name": "Max MacEachern", "link": "https://stackoverflow.com/users/4992194/max-maceachern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433904599, "creation_date": 1433892379, "last_edit_date": 1433899194, "question_id": 30744579, "link": "https://stackoverflow.com/questions/30744579/vba-looping-across-tabs-same-tab-structure-different-number-of-rows", "title": "VBA - Looping across tabs (same tab structure, different number of rows)", "body": "<p>I am just venturing into VBA, so please forgive me if I'm asking an easy question with a straightforward solution that has already been address on this site. I've searched for a solution, but I haven't found anything that helps.</p>\n\n<p>I am using a staffing spreadsheet that has a tab for each person in our department and each worksheet lists all active projects and hours allocated by month. I shift the prior month column forward to the next year on a monthly basis and I'd like to automate as much of this work as possible. </p>\n\n<p>I wrote a loop in VBA that cuts the prior month and moves it down, but I need help writing code that lets me clear the cells in a specific range in the column I am moving. The problem is each tab has a different number of projects so I can't simply write code that clears cells Q4:Q12 because the ending cell will vary from tab to tab. There is a row that is consistent across all the worksheets, but I am not sure how write in VBA to clear all cells up to that point.</p>\n\n<p>Any help would be greatly appreciated!  Thank you!</p>\n\n<p>Edit - Here is the code I am currently working with.</p>\n\n<pre><code>Sub MoveColumn()\n\n    Dim ws As Worksheet\n    For Each ws In ActiveWorkbook.Worksheets\n        If ws.Name &lt;&gt; \"Staffing Summary\" Then\n                ws.Columns(\"F:F\").Cut\n                ws.Columns(\"R:R\").Insert Shift:=xlToRight\n        End If\n    Next ws\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1434316167, "post_id": 30744397, "comment_id": 49713658, "body": "can you show what your txt file looks like?"}], "answers": [{"comments": [{"owner": {"reputation": 1189, "user_id": 804735, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ff7882872b36e55b6633301908a9bccd?s=128&d=identicon&r=PG", "display_name": "Bhavani Kannan", "link": "https://stackoverflow.com/users/804735/bhavani-kannan"}, "edited": false, "score": 0, "creation_date": 1434278357, "post_id": 30745070, "comment_id": 49702086, "body": "Omar, Thank you! I tried your code and it actually puts only the 15th text file&#39;s contents into my G2 cell. The first 14 text files contents are nowhere to be found in the worksheet. One more finding - The content of my text file is space delimited after I ran the macro. I mean, each words in the text file is put in each cell instead of putting it all in one cell."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1433921971, "last_edit_date": 1495542709, "creation_date": 1433895686, "answer_id": 30745070, "question_id": 30744397, "link": "https://stackoverflow.com/questions/30744397/import-from-text-files-to-excel/30745070#30745070", "title": "Import from text files to Excel", "body": "<blockquote>\n  <ol>\n  <li>To Read all the txt files inside the directory or to choose one file</li>\n  </ol>\n</blockquote>\n\n<p>The following code should let you choose one or multiple files you want to Import</p>\n\n<p><a href=\"http://Application.FileDialog%20Property%20(Excel)\" rel=\"nofollow noreferrer\">Application.FileDialog Property (Excel)</a></p>\n\n<pre><code>    '// Open Dailog\n    With Application.FileDialog(msoFileDialogOpen)\n        .AllowMultiSelect = True &lt;-- Allow multiple selection\n        .Show '&lt;-- display the files\n    End With\n</code></pre>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>To set Row Number for Data to Begin at G2 then next</li>\n  </ol>\n</blockquote>\n\n<p>If need update the following code </p>\n\n<pre><code>nRow = Range(\"G2\").End(xlUp).Offset(1, 0).row    \nDestination:=Range(\"$G$\" &amp; nRow))  \n</code></pre>\n\n<p><br></p>\n\n<p>See complete <KBD> <strong>CODE</strong> </KBD> with comments  </p>\n\n<pre><code>Sub Import()\n    '// Declare a variable as\n    Dim nRow            As Long\n    Dim sExtension      As String\n    Dim oFolder         As FileDialog '// FileDialog object\n    Dim vSelectedItem   As Variant\n\n    '// Stop Screen Flickering\n    Application.ScreenUpdating = False\n\n    '// Create a FileDialog object as a File Picker dialog box\n    Set oFolder = Application.FileDialog(msoFileDialogOpen)\n\n    '// Use a With...End With block to reference FileDialog.\n    With oFolder\n        '// Allow multiple selection.\n        .AllowMultiSelect = True\n        '// Use the Show method to display the files.\n        If .Show = -1 Then\n\n    '// Extension\n    sExtension = Dir(\"*.txt\")\n\n    '// Step through each SelectedItems\n    For Each vSelectedItem In .SelectedItems\n\n        '// Sets Row Number for Data to Begin\n        nRow = Range(\"G2\").End(xlUp).Offset(1, 0).row\n\n        '// Below is importing a text file\n        With ActiveSheet.QueryTables.Add(Connection:= _\n            \"TEXT;\" &amp; sExtension, Destination:=Range(\"$G$\" &amp; nRow))\n            .Name = sExtension\n            .FieldNames = True\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .TextFilePromptOnRefresh = False\n            .TextFilePlatform = 850\n            .TextFileStartRow = 1\n            .TextFileParseType = xlDelimited\n            .TextFileTextQualifier = xlTextQualifierDoubleQuote\n            .TextFileConsecutiveDelimiter = True\n            .TextFileTabDelimiter = True\n            .TextFileSemicolonDelimiter = True\n            .TextFileCommaDelimiter = True\n            .TextFileSpaceDelimiter = True\n            .TextFileOtherDelimiter = \"=\"\n            .TextFileTrailingMinusNumbers = True\n            .Refresh BackgroundQuery:=False\n        End With\n        sExtension = Dir\n    Next\n            '// If Cancel...\n            Else\n            End If\n    End With\n\n    Application.ScreenUpdating = True\n\n    '// Set object to Nothing. Object? see Link Object\n    Set oFolder = Nothing\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://&#39;https://stackoverflow.com/questions/517006/is-there-a-need-to-set-objects-to-nothing-inside-vba-functions\" rel=\"nofollow noreferrer\">Set Object = Nothing</a></p>\n"}], "owner": {"reputation": 1189, "user_id": 804735, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ff7882872b36e55b6633301908a9bccd?s=128&d=identicon&r=PG", "display_name": "Bhavani Kannan", "link": "https://stackoverflow.com/users/804735/bhavani-kannan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 1, "accepted_answer_id": 30745070, "answer_count": 1, "score": 1, "last_activity_date": 1433932100, "creation_date": 1433891427, "last_edit_date": 1433932100, "question_id": 30744397, "link": "https://stackoverflow.com/questions/30744397/import-from-text-files-to-excel", "title": "Import from text files to Excel", "body": "<p>I am trying to write a VBA macro that will prompt the user to choose a directory immediately after running it.</p>\n\n<p>Once the user chooses a directory, the macro will scan through all the <code>*.txt</code> files in it and put each of its contents in new row under column <code>G</code>. So, the contents of 1st text file will be in <code>G2</code>, second text file in <code>G3</code> and so on.</p>\n\n<p>I browsed StackOverFlow for long and found a working code</p>\n\n<pre><code>Function GetFolder() As String\n    Dim fldr As FileDialog\n    Dim sItem As String\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n    With fldr\n        .Title = \"Select a Folder\"\n        .AllowMultiSelect = False\n        .InitialFileName = Application.DefaultFilePath\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        sItem = .SelectedItems(1)\n    End With\nNextCode:\n    GetFolder = sItem\n    Set fldr = Nothing\nEnd Function\n</code></pre>\n\n<p>I also did some very poor hard-coding to import just one text file into cell <code>G2</code></p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;D:\\K\\record001_001.txt\" _\n        , Destination:=Range(\"$G$2\"))\n        .Name = \"record001_001\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\n</code></pre>\n\n<p>I do not know how to put these pieces together to have a working code that will.</p>\n\n<ol>\n<li>Read all the <code>txt</code> files inside the directory I choose.</li>\n<li>Put each of the text files content in a new row of the same worksheet (<code>G2</code>, <code>G3</code>, etc.)</li>\n</ol>\n\n<p>Each of those text files have just one or two rows of data and do not want anything to be delimited there. Just copy the whole lot of text in the <code>txt</code> file and paste it in <code>G2</code>, in a loop until all <code>txt</code> files in the selected directory are done.</p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1433927989, "post_id": 30744393, "comment_id": 49558246, "body": "Are you asking how to query a database using sql from VBA or is there some other issue?"}, {"owner": {"reputation": 17, "user_id": 4811671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/625c4134cad5f22462d1aac5dbb77efe?s=128&d=identicon&r=PG&f=1", "display_name": "amamdouh", "link": "https://stackoverflow.com/users/4811671/amamdouh"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1434184443, "post_id": 30744393, "comment_id": 49680313, "body": "I know how to do that, I am asking how to divide the long SQL query above to be used as an array for the CommandText"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1434210043, "post_id": 30744393, "comment_id": 49687214, "body": "Why do you need it as an array? Shouldn&#39;t it just be a string of SQL?"}, {"owner": {"reputation": 17, "user_id": 4811671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/625c4134cad5f22462d1aac5dbb77efe?s=128&d=identicon&r=PG&f=1", "display_name": "amamdouh", "link": "https://stackoverflow.com/users/4811671/amamdouh"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1434281163, "post_id": 30744393, "comment_id": 49702849, "body": "I removed the array and it now works, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1434284581, "creation_date": 1434284581, "answer_id": 30829299, "question_id": 30744393, "link": "https://stackoverflow.com/questions/30744393/use-long-access-sql-query-in-excel-vba/30829299#30829299", "title": "Use long Access SQL query in Excel VBA", "body": "<p>Adding an answer based on my comment. Don't try to use an array with CommandText, just pass it a string of SQL.</p>\n"}], "owner": {"reputation": 17, "user_id": 4811671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/625c4134cad5f22462d1aac5dbb77efe?s=128&d=identicon&r=PG&f=1", "display_name": "amamdouh", "link": "https://stackoverflow.com/users/4811671/amamdouh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1434284581, "creation_date": 1433891407, "last_edit_date": 1433960765, "question_id": 30744393, "link": "https://stackoverflow.com/questions/30744393/use-long-access-sql-query-in-excel-vba", "title": "Use long Access SQL query in Excel VBA", "body": "<p>I have a long Access SQL query:</p>\n\n<pre><code>SELECT Avg(Data_transmission.Forward_app_throughput) AS AvgOfForward_app_throughput\n\nFROM (Data_transmission LEFT JOIN Data_task_statistics ON Data_transmission.Record_index = Data_task_statistics.Record_index) LEFT JOIN Bin_data ON Data_transmission.Record_index = Bin_data.Record_index\n\nWHERE (((Data_task_statistics.Task_type_ID)=4) AND ((Data_task_statistics.Received_Application_byte)&gt;50000) AND ((([Data_transmission].[Forward_app_throughput]))&gt;-1) AND ((Bin_data.Protocol_id)=61));\n</code></pre>\n\n<p>I am trying to use it within Excel VBA, but I the only way I managed to do that is by using the \"Get Data from Microsoft Query\" feature in Excel, which produces this string</p>\n\n<pre><code>CommandText = Array( _\n        \"SELECT Avg(Data_transmission.Forward_app_throughput) AS AvgOfForward_app_throughput\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"FROM (Data_transmission LEFT JOIN Data_task_statistics ON Data_transmission.Record_index = Data_task_statistics.Rec\" _\n        , _\n        \"ord_index) LEFT JOIN Bin_data ON Data_transmission.Record_index = Bin_data.Record_index\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"WHERE (((Data_task_statistics.Task_type_ID)=4) AND ((Data_task_statistics.Received_Application_byte)&gt;50000) AND\" _\n        , _\n        \" ((([Data_transmission].[Forward_app_throughput]))&gt;-1) AND ((Bin_data.Protocol_id)=61));\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"\" _\n        )\n</code></pre>\n\n<p>How can I get this string without using \"Get Data from Microsoft Query\" feature, because it takes a long time and I have several queries </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1433938482, "creation_date": 1433938482, "answer_id": 30756076, "question_id": 30744318, "link": "https://stackoverflow.com/questions/30744318/how-to-use-vba-to-change-the-way-the-data-list/30756076#30756076", "title": "How to use VBA to change the way the data list?", "body": "<p>A dictionary can only store key-value pairs and so this isn't a great way of doing this. You would end up have to join and then split strings. You're better using nested loops.</p>\n\n<pre><code>Sub EquationSegment()\n\nDim caseRef As Range\nDim contentsRef As Range\nDim cell As Range\nDim outputsRef As Range\n\n    Set caseRef = ActiveSheet.Range(\"A2\")\n    Set contentsRef = ActiveSheet.Range(\"D2:AF2\")\n    Set outputsRef = ActiveSheet.Range(\"AN1\")\n    With outputsRef\n        .Value = \"Case\"\n        .Offset(ColumnOffset:=1).Value = \"Object\"\n        .Offset(ColumnOffset:=2).Value = \"Equation\"\n        .Offset(ColumnOffset:=3).Value = \"Contents\"\n    End With\n    Set outputsRef = outputsRef.Offset(RowOffset:=1)\n\n    Do While caseRef.Value &lt;&gt; \"\"\n        For Each cell In contentsRef\n            If cell.Value &lt;&gt; \"\" Then\n                With outputsRef\n                    .Value = caseRef.Value\n                    .Offset(ColumnOffset:=1).Value = caseRef.Offset(ColumnOffset:=1).Value\n                    .Offset(ColumnOffset:=2).Value = caseRef.Offset(ColumnOffset:=2).Value\n                    .Offset(ColumnOffset:=3).Value = cell.Value\n                End With\n                Set outputsRef = outputsRef.Offset(RowOffset:=1)\n            End If\n        Next cell\n        Set caseRef = caseRef.Offset(RowOffset:=1)\n        Set contentsRef = contentsRef.Offset(RowOffset:=1)\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4793824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/469dabb90e0e9a472f862f45b18c9b95?s=128&d=identicon&r=PG&f=1", "display_name": "user4793824", "link": "https://stackoverflow.com/users/4793824/user4793824"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433938482, "creation_date": 1433891047, "last_edit_date": 1433931922, "question_id": 30744318, "link": "https://stackoverflow.com/questions/30744318/how-to-use-vba-to-change-the-way-the-data-list", "title": "How to use VBA to change the way the data list?", "body": "<pre><code>Case  Object Equation                                                    Contents           \n293   asdg   D0799* (1-(S0191+S0439+S0960+S0560))   * (1-(C0121+C0122)) S0439    S0960  S0560   \n296   iknm   D0792* (1-(S0191+S0565+S0567+S0960+S0560)) S0565   S0567   S0960   S0560\n298   yiol   D0191* (1-(S0191+S0439+S2820+S0960+S0560)) S0439   S2820   S0960   S0560\n</code></pre>\n\n<p>I was trying to transfer the above data to the below one. There are going to be more rows and columns.</p>\n\n<pre><code>Case Object Equation                                                    contents\n293  asdg   D0799* (1-(S0191+S0439+S0960+S0560))   * (1-(C0121+C0122))  S0439\n293  asdg   D0799* (1-(S0191+S0439+S0960+S0560))   * (1-(C0121+C0122))  S0960\n293  asdg   D0799* (1-(S0191+S0439+S0960+S0560))   * (1-(C0121+C0122))  S0560\n296  iknm   D0792* (1-(S0191+S0565+S0567+S0960+S0560))                  S0565\n296  iknm   D0792* (1-(S0191+S0565+S0567+S0960+S0560))                  S0567\n296  iknm   D0792* (1-(S0191+S0565+S0567+S0960+S0560))                  S0960\n296  iknm   D0792* (1-(S0191+S0565+S0567+S0960+S0560))                  S0560\n298  yiol   D0191* (1-(S0191+S0439+S2820+S0960+S0560))                  S0439\n298  yiol   D0191* (1-(S0191+S0439+S2820+S0960+S0560))                  S2820\n298  yiol   D0191* (1-(S0191+S0439+S2820+S0960+S0560))                  S0960\n298  yiol   D0191* (1-(S0191+S0439+S2820+S0960+S0560))                  S0560\n</code></pre>\n\n<p>The Macro is </p>\n\n<pre><code>Sub EquationSegment()\nDim Dic As Object: Set Dic = CreateObject(\"Scripting.Dictionary\")\nDim cl As Range, Key As Variant, i&amp;\ni = 1\nFor Each cl In Range(\"c2:af\" &amp; Cells(Rows.Count, \"a\").End(xlUp).Row)\n    Dic.Add i &amp; \":\" &amp; Cells(cl.Row, 1).Value, cl.Value\n    i = i + 1\n\nNext cl\ni = 2: [an1] = \"Equation\": [ao1] = \"contents\"\nFor Each Key In Dic\n\n    Cells(i, \"an\").Value = Split(Key, \":\")(1)\n    Cells(i, \"ao\").Value = Dic(Key)\n    i = i + 1\nNext Key\nSet Dic = Nothing\nEnd Sub\n</code></pre>\n\n<p>I'm only able to transfer 2 columns. Can anyone help me fix the range issue?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1433891446, "post_id": 30744285, "comment_id": 49544406, "body": "You put that MsgBox() in the loop, so it could potentially pop-up 688 times. Correct your business logic and VBA code. Best regards,"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1433892726, "post_id": 30744285, "comment_id": 49544823, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/gg251821.aspx\" rel=\"nofollow noreferrer\">msgBox Examples</a>"}, {"owner": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "edited": false, "score": 0, "creation_date": 1433924204, "post_id": 30744285, "comment_id": 49555829, "body": "Your counter is pointless. It only repeats &quot;If statement&quot; 689 times."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1433891463, "creation_date": 1433891463, "answer_id": 30744405, "question_id": 30744285, "link": "https://stackoverflow.com/questions/30744285/msgbox-does-not-disappear-on-pressing-o-k/30744405#30744405", "title": "Msgbox() does not disappear on pressing O.K", "body": "<p>The problem is that when the <strong>If</strong> is <em>True</em> the MsgBox is displayed and ActiveCell is never incremented.  Therefore the MsgBox gets re-displayed 687 times!</p>\n"}], "owner": {"reputation": 5, "user_id": 4372982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9bf98e20d7d4e10e1e7d6a0b3dd4ec1?s=128&d=identicon&r=PG&f=1", "display_name": "unleash", "link": "https://stackoverflow.com/users/4372982/unleash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433891521, "creation_date": 1433890854, "last_edit_date": 1433891521, "question_id": 30744285, "link": "https://stackoverflow.com/questions/30744285/msgbox-does-not-disappear-on-pressing-o-k", "title": "Msgbox() does not disappear on pressing O.K", "body": "<p>I have this code where a msgbox pops up notifying a duplicate value. </p>\n\n<p>Problem is the msgbox() does not go away on clicking ok and the code gets stuck.</p>\n\n<pre><code>Dim row As Integer \nDim counter As Integer \n\nRange(\"c2\").Activate \n\nApplication.ScreenUpdating = False \n\nFor counter = 0 To 688\n\nIf ActiveCell.Value = ActiveCell.Offset(1, 0).Value And ActiveCell.Offset(0, 2).Value = ActiveCell.Offset(1, 2).Value And ActiveCell.Offset(0, 3).Value = ActiveCell.Offset(1, 3).Value And ActiveCell.Offset(0, 9).Value = ActiveCell.Offset(1, 9).Value Then\n\nMsgBox (\"Found a duplicate\")\n\nElse ActiveCell.Offset(1, 0).Activate\n\nEnd If\n\nNext counter\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1433886628, "post_id": 30743361, "comment_id": 49542684, "body": "your code looks okay to me, add <code>Option Explicit</code> on top also close the work book and reopen it see if that helps."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1433886996, "post_id": 30743361, "comment_id": 49542844, "body": "You&#39;re using lots of <code>object variables</code>; they&#39;re just not the ones you declare. <code>Columns</code>, <code>Selection</code>, and <code>ActiveCell</code> can all be not set in the code you&#39;ve posted above. The debugger can tell you which aren&#39;t. There are dozens of existing questions here about this exact error, with answers that explain how to track them down and how to resolve the problem. Did you search on that exact error message via Google?"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1433887086, "creation_date": 1433887086, "answer_id": 30743552, "question_id": 30743361, "link": "https://stackoverflow.com/questions/30743361/excel-run-time-error-91-without-object-variable/30743552#30743552", "title": "Excel run-time error 91, without object variable", "body": "<blockquote>\n  <p>I'm receiving a Run-time Error '91' Object Variable or With Block not Set for the following code.</p>\n</blockquote>\n\n<p>When working with <code>.Find</code>, check if a match was returned and then show the row if found else you will get the above error.</p>\n\n<p>Try this</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim i As Integer\n    Dim aCell As Range\n    Dim ws As Worksheet\n\n    i = 1\n\n    '~~&gt; Replace this with the relevant sheet\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    With ws\n        Set aCell = .Columns(1).Find(What:=.Cells(i, 19).Value, _\n                                     LookIn:=xlFormulas, _\n                                     LookAt:=xlPart, _\n                                     SearchOrder:=xlByRows, _\n                                     SearchDirection:=xlNext, _\n                                     MatchCase:=False, _\n                                     SearchFormat:=False)\n\n        '~~&gt; Check if the find returned a match\n        If Not aCell Is Nothing Then\n            MsgBox aCell.Row\n        Else\n            MsgBox \"Not Found\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4992211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5855e195b8d93c74a4af3e6826c1b044?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac", "link": "https://stackoverflow.com/users/4992211/isaac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 30743552, "answer_count": 1, "score": 1, "last_activity_date": 1433887086, "creation_date": 1433886148, "last_edit_date": 1433886639, "question_id": 30743361, "link": "https://stackoverflow.com/questions/30743361/excel-run-time-error-91-without-object-variable", "title": "Excel run-time error 91, without object variable", "body": "<p>I'm receiving a <strong><code>Run-time Error '91' Object Variable or With Block not Set</code></strong> for the following code. </p>\n\n<p>I'm confused as I'm not using any object variables (I don't think, I'm new to VBA). Debugging highlights the 6th row.</p>\n\n<p>My code is:</p>\n\n<pre><code>Dim i As Integer\ni = 1\nColumns(\"A:A\").Select\nSelection.Find(What:=\"\" &amp; Cells(i, 19).Value, After:=ActiveCell, LookIn:=xlFormulas, _\nLookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\nMatchCase:=False, SearchFormat:=False).Activate\nMsgBox ActiveCell.Row\n</code></pre>\n"}]