[{"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 1, "creation_date": 1535668096, "post_id": 52088398, "comment_id": 91163308, "body": "Thanks for your response.  These answers are exactly what I was looking for.  I will make the suggested changes to my code.  Regarding your comment on Clipboard....yes I am creating one long string that I will paste into the Excel file at the proper point.  This code is already working and very efficient."}, {"owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "reply_to_user": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 1, "creation_date": 1535670890, "post_id": 52088398, "comment_id": 91163957, "body": "@KaiserOtto, glad they helped. If you could mark it as answering your question, that would be great."}], "tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": true, "score": 1, "last_activity_date": 1535595778, "creation_date": 1535595778, "answer_id": 52088398, "question_id": 52087303, "link": "https://stackoverflow.com/questions/52087303/vba-word-macro-to-allow-user-to-select-and-copy-text-multiple-times/52088398#52088398", "title": "VBA Word Macro to Allow User to Select and Copy Text Multiple Times", "body": "<p>From what you stated you are running this from the ThisDocument Class Module and unless you fully qualify your references to those Public variables with the Class Name that is why you cannot access them from the UserForms Class Modules.</p>\n\n<p>If you are going to leave your \"Main Module\" code in the ThisDocument Class Module then whenever you reference those Public variable you need to add <code>ThisDocument.str_clipboard</code> to the command.</p>\n\n<p>I recommend however, to place your Main Module in a general Module such as NewModule and if you need to run it at a Document_Open event that you put a call to the Main Module and its Public variables in the Private Sub Document_Open event of the ThisDocument Class Module.</p>\n\n<p>Your Msgbox is appearing at the wrong time because you are displaying a modeless user form, which means the VBA script thread continues to run after the UserForm is displayed. Move the Msgbox to the UserForm_Activate routine of the second UserForm you are displaying or move it to the Click_Done routine of the first UserForm before you Hide or Unload it.</p>\n\n<p>Finally, you are not really using the Clipboard and using that term makes your code confusing in my opinion. I think you should rename it. Your code also appears to just be building one continuous string of text. Is that really what you want to do? Or, do you really mean to capture each selected text string and ultimately place each into separate cells within an Excel Worksheet? If that is the case, use an Array for the separate text strings.</p>\n"}], "owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "accepted_answer_id": 52088398, "answer_count": 1, "score": 1, "last_activity_date": 1535595778, "creation_date": 1535584802, "last_edit_date": 1535590506, "question_id": 52087303, "link": "https://stackoverflow.com/questions/52087303/vba-word-macro-to-allow-user-to-select-and-copy-text-multiple-times", "title": "VBA Word Macro to Allow User to Select and Copy Text Multiple Times", "body": "<p>I am working on a VBA script with Microsoft Word that allows the user to select text that will be be copied to the clipboard so that it can exported to an Excel file. The user will make a number of selections and finally indicate he/she is done when the contents of the clipboard will be copied to a template Excel file.</p>\n\n<p>There are two forms: the first (UserForm1 in the code below) queries the user for the Word filename.  The filename variable is passed to the second form. The second form (frmModeLessForInput) is a modeless form. The behavior I need is that program control goes to the second form with two buttons \"Continue\" and \"Done\". </p>\n\n<p>The user is allowed to navigate the document and place the cursor anywhere in the document. Then when \"Continue\" is pressed the form will call a subroutine (Highlight_Sentence) to copy the selected text to a \"clipboard\" variable. When \"Done\" is pressed control will be passed to called main module which will then copy the clipboard to the Excel file.</p>\n\n<p>Below is the code.  I have noted with comments where I am trouble with the code. One problem is the variables defined as Public in the ThisDocument module are not defined in the userforms and their subroutines. </p>\n\n<p>The second problem is in the main module that the frmModelessForInput is supposed to be displayed and control is not supposed to be transferred to next statement {MsgBox \"Sentences will now be copied to Excel file\"....this is where I will put the code to copy the clipboard to the Excel file.} but the message appears before the frmModelessForInput form is run...thus the clipboard will be empty.</p>\n\n<p>The third problem is that in frmModelessForInput form the statement str_clipboard = str_clipboard + str_clipboard_line is not working.  Each time the \"Continue\" button is pushed str_clipboard loses it previous contents.</p>\n\n<p>Any assistance in resolving these problems is appreciated.  As VBA programming is a sideline for me I am still learning.</p>\n\n<p>Note this an updated question <a href=\"https://stackoverflow.com/questions/52022737/pause-vba-word-macro-allow-user-to-make-a-selection-and-restart-where-it-left\">Pause VBA Word macro, allow user to make a selection, and restart where it left off</a> adding some more detail on the requirement and the sample code.</p>\n\n<p>MAIN MODULE:</p>\n\n<pre><code>Option Explicit\nPublic str_clipboard As String\nPublic txt_active_document As String\nPublic i_how_many_sentences As Integer\nPrivate Sub Test_master_macro()\n    UserForm1.Show\n    i_how_many_sentences = 0\n    Call DisplayModeless\n    MsgBox \"Sentences will now be copied to Excel file\" 'Problem: this msg displays before the frmModelessForInput is displayed\nEnd Sub\nSub DisplayModeless()\n    Dim frm As frmModelessForInput\n    Set frm = New frmModelessForInput\n    With frmModelessForInput\n        .str_word_doc_filename = txt_active_document\n        .str_no_copied = \"0\"\n        .Show False\n    End With\n    Set frm = Nothing\nEnd Sub\n</code></pre>\n\n<p>USERFORM1: form has field for user entering the document filename to user (str_filename) and a command button to close form (cmd_start_selecting_text) </p>\n\n<pre><code>Private Sub cmd_start_selecting_text_Click()\n    'User enters filename on form for use in frmModelessForInput subroutine \n    txt_active_document = UserForm1.str_filename  'Problem: VBA reports txt_active_document as undefined even though it is a Public variable\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>FRMMODELESSFORINPUT: Form displays filename of Word file entered in UserForm1 and how many sentences have been copied to the clipboard</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub cmdContinue_Click()\n Dim str_clipboard, str_clipboard_line As String\n       Call Highlight_Sentence(str_clipboard_line)\n        i_how_many_sentences = i_how_many_sentences + 1 'Problem: VBA reports i_how_many_sentences as undefined even though it is a Public variable \n        frmModelessForInput.str_no_copied = i_how_many_sentences  'Same Problem\n    str_clipboard = str_clipboard + str_clipboard_line 'Problem: each time I select a new text/sentence str_clipboard does not contain the contents of the previous selection\nEnd Sub\n\n\nPrivate Sub cmdDone_Click()\n    Me.Hide\nEnd Sub\n\nPrivate Sub UserForm_Activate()\n    'Position the form near the top-left of the window\n    'So that the user can work with the document\n    Me.Top = Application.ActiveWindow.Top + 15\n    Me.Left = Application.ActiveWindow.Left + 15\nEnd Sub\n\nPrivate Sub Highlight_Sentence(clipboard As String)\n    'This sub extends the selection to the entire sentence and copies the selection, the page number on which the selection is contained and the filename to the clipboard variable\n    Dim txt_sentence, txt_page_no As String\n    With Selection\n     ' Collapse current selection.\n     .Collapse\n     ' Expand selection to current sentence.\n     .Expand Unit:=wdSentence\n    End With\n    txt_sentence = Selection.Text\n    txt_page_no = Selection.Information(wdActiveEndPageNumber)\n    clipboard = txt_active_document &amp; vbTab &amp; txt_page_no &amp; vbTab &amp; txt_sentence &amp; vbCrLf 'Problem: VBA reports txt_active_document as undefined even though it is a Public variable \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "copy-paste"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1535581611, "post_id": 52086634, "comment_id": 91124043, "body": "Depending on the sheet, it may be easier to copy the sheet and clear what you don&#39;t need. This will preserve all formats"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10291971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b1c71a54c649ba6a704f47331cf258?s=128&d=identicon&r=PG&f=1", "display_name": "Hiimtroymcclure", "link": "https://stackoverflow.com/users/10291971/hiimtroymcclure"}, "edited": false, "score": 0, "creation_date": 1535644889, "post_id": 52087952, "comment_id": 91153218, "body": "Thank you! The formatting keeps the same but for some reason the groupings disappear. Is there a way to include the groupings from the &quot;DNU&quot; worksheet? Or does this have to get automated for each worksheet?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 3, "user_id": 10291971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b1c71a54c649ba6a704f47331cf258?s=128&d=identicon&r=PG&f=1", "display_name": "Hiimtroymcclure", "link": "https://stackoverflow.com/users/10291971/hiimtroymcclure"}, "edited": false, "score": 0, "creation_date": 1535651336, "post_id": 52087952, "comment_id": 91156398, "body": "@Hiimtroymcclure; I updated the answer to copy your groupings. I don&#39;t use groups so it may not work. please use it on a copy. If it does not work you may have to reapply your groups using vba."}, {"owner": {"reputation": 3, "user_id": 10291971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b1c71a54c649ba6a704f47331cf258?s=128&d=identicon&r=PG&f=1", "display_name": "Hiimtroymcclure", "link": "https://stackoverflow.com/users/10291971/hiimtroymcclure"}, "edited": false, "score": 0, "creation_date": 1535653260, "post_id": 52087952, "comment_id": 91157284, "body": "Thanks GMalc, I&#39;m running into a Run-Time Error: Unable to get the OutlineLevel property of the Range Class. Like you mentioned, I&#39;ll probably have to reapply the groupings."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 1, "last_activity_date": 1535651196, "last_edit_date": 1535651196, "creation_date": 1535591400, "answer_id": 52087952, "question_id": 52086634, "link": "https://stackoverflow.com/questions/52086634/vba-excel-copying-and-pasting-column-width-groupings/52087952#52087952", "title": "VBA Excel - Copying and Pasting Column Width/Groupings", "body": "<p>You dont't need to use <code>copy/paste</code>. <code>Value</code> can have <code>arguments</code>, <code>11</code> transfers both value and formats.</p>\n\n<pre><code>Dim i As Integer\nWith ThisWorkbook\n    For i = 2 To .Worksheets.Count\n        .Worksheets(i).Range(\"A1:Y200\").Value(11) = .Worksheets(\"Sheet1\").Range(\"A1:Y200\").Value(11)\n        'Unsure how you accomplish your grouping,\n        .Worksheets(i).Range(\"A1:Y200\").OutlineLevel = .Worksheets(\"Sheet1\").Range(\"A1:Y200\").OutlineLevel\n\n        Dim colx As Long\n        For colx = 1 To 25\n            Worksheets(i).Columns(colx).ColumnWidth = Worksheets(\"Sheet1\").Columns(colx).ColumnWidth\n            Worksheets(i).Columns(colx).OutlineLevel = Worksheets(\"Sheet1\").Columns(colx).OutlineLevel\n        Next\n\n        Dim rowx As Long\n        For rowx = 1 To 200\n            Worksheets(i).Rows(rowx).OutlineLevel = Worksheets(\"Sheet1\").Rows(rowx).OutlineLevel\n        Next\n\n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10291971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b1c71a54c649ba6a704f47331cf258?s=128&d=identicon&r=PG&f=1", "display_name": "Hiimtroymcclure", "link": "https://stackoverflow.com/users/10291971/hiimtroymcclure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535651196, "creation_date": 1535579941, "last_edit_date": 1535580194, "question_id": 52086634, "link": "https://stackoverflow.com/questions/52086634/vba-excel-copying-and-pasting-column-width-groupings", "title": "VBA Excel - Copying and Pasting Column Width/Groupings", "body": "<p>I'm trying to copy the entire worksheet from \"DNU\" into each proceeding worksheet. I'm looking to do a regular paste to keep the width and groupings but this will only paste the formulas and table format. Thank you.</p>\n\n<p>Here is the code:</p>\n\n<p>~</p>\n\n<pre><code>Dim wsVar As Worksheet\nDim i as Integer\nWith ThisWorkbook\n    For i = 6 to .Worksheets.Count\n        .Worksheets(\"DNU\").Range(\"A1:Y200\").Copy destination:=.Worksheets(i).Range(\"A1:Y200\")\n    Next \nEnd With\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1535587050, "post_id": 52086316, "comment_id": 91125365, "body": "Edit the question to apply this advice <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1535589619, "post_id": 52086316, "comment_id": 91125836, "body": "Describe where the calendar appears in the folder tree. Perhaps a diagram similar to this. <a href=\"https://stackoverflow.com/questions/9076634/get-reference-to-additional-inbox\" title=\"get reference to additional inbox\">stackoverflow.com/questions/9076634/&hellip;</a>"}, {"owner": {"reputation": 43, "user_id": 2919847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a80b620548f4abe97205ebaf2d93b3?s=128&d=identicon&r=PG&f=1", "display_name": "jingle123", "link": "https://stackoverflow.com/users/2919847/jingle123"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1535637516, "post_id": 52086316, "comment_id": 91148217, "body": "Hi, This is office 365 group. Lets call it abc. The group email is abc@somedoamin.com  In the folder structure it appear like this: My Mailbox-    -Groups        ---abc  Also edited the question with this information. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 2919847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a80b620548f4abe97205ebaf2d93b3?s=128&d=identicon&r=PG&f=1", "display_name": "jingle123", "link": "https://stackoverflow.com/users/2919847/jingle123"}, "edited": false, "score": 0, "creation_date": 1535578972, "post_id": 52086358, "comment_id": 91123257, "body": "Thanks for your quick response. I tried your approach. But now its giving me a runtime error: &quot;The server mailbox cannot be opened because this address book entry is not a mail user&quot;"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 43, "user_id": 2919847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a80b620548f4abe97205ebaf2d93b3?s=128&d=identicon&r=PG&f=1", "display_name": "jingle123", "link": "https://stackoverflow.com/users/2919847/jingle123"}, "edited": false, "score": 0, "creation_date": 1535579202, "post_id": 52086358, "comment_id": 91123332, "body": "Does the same name work in Outlook if you click &quot;File | Open | Other User&#39;s Folder&quot;?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 43, "user_id": 2919847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a80b620548f4abe97205ebaf2d93b3?s=128&d=identicon&r=PG&f=1", "display_name": "jingle123", "link": "https://stackoverflow.com/users/2919847/jingle123"}, "edited": false, "score": 0, "creation_date": 1535638710, "post_id": 52086358, "comment_id": 91149102, "body": "Here you go. Exchange is telling you there is no mailbox that belongs to the specified name. Is that the name of a distribution list?"}, {"owner": {"reputation": 43, "user_id": 2919847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a80b620548f4abe97205ebaf2d93b3?s=128&d=identicon&r=PG&f=1", "display_name": "jingle123", "link": "https://stackoverflow.com/users/2919847/jingle123"}, "edited": false, "score": 0, "creation_date": 1535639123, "post_id": 52086358, "comment_id": 91149398, "body": "But it does have a mailbox. It has shared mailbox and has its own calendar too. Office 365 groups are different than distribution lists. I am able to send and receive emails and create events on this calendar. I have updated the question with the folder structure"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 43, "user_id": 2919847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a80b620548f4abe97205ebaf2d93b3?s=128&d=identicon&r=PG&f=1", "display_name": "jingle123", "link": "https://stackoverflow.com/users/2919847/jingle123"}, "edited": false, "score": 1, "creation_date": 1535645605, "post_id": 52086358, "comment_id": 91153612, "body": "Groups, even if they are exposed in the Outlook UI, are not (at least yet) exposed through OOM or even MAPI - on the MAPI level, there is a store, but it is not in the session stores table."}, {"owner": {"reputation": 43, "user_id": 2919847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a80b620548f4abe97205ebaf2d93b3?s=128&d=identicon&r=PG&f=1", "display_name": "jingle123", "link": "https://stackoverflow.com/users/2919847/jingle123"}, "edited": false, "score": 0, "creation_date": 1535649107, "post_id": 52086358, "comment_id": 91155377, "body": "Ohh. Well that&#39;s a bummer! I will stick to my original code then. Thank you!"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1535578352, "creation_date": 1535578352, "answer_id": 52086358, "question_id": 52086316, "link": "https://stackoverflow.com/questions/52086316/access-o365-group-calendar-folder-in-vba/52086358#52086358", "title": "Access O365 group calendar folder in VBA", "body": "<p>You need to use <code>GetSharedDefaultFolder</code>, but its first argument is a <code>Recipient</code> object, not a string. Call <code>Namespace.CreateRecipient</code> (passing a string), then pass that <code>Recipient</code> object to <code>GetSharedDefaultFolder</code>.</p>\n"}], "owner": {"reputation": 43, "user_id": 2919847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a80b620548f4abe97205ebaf2d93b3?s=128&d=identicon&r=PG&f=1", "display_name": "jingle123", "link": "https://stackoverflow.com/users/2919847/jingle123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 618, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592942984, "creation_date": 1535578109, "last_edit_date": 1592942984, "question_id": 52086316, "link": "https://stackoverflow.com/questions/52086316/access-o365-group-calendar-folder-in-vba", "title": "Access O365 group calendar folder in VBA", "body": "<p>I am trying to write a macro which would create an appointment in O365 group calendar.<br>\nI am able to create the appointment if the current folder is the group calender. However, I want the macro to always create the appointment for the group calendar, irrespective of the current folder.\nI have looked at other posts on accessing shared calendar and other subfolders under default calendar, but I am not able to find anything that works for a group calender.</p>\n\n<p>I have tried these things:</p>\n\n<pre><code>    ' option1\n  Set calFolder = GetFolderPath(\"abc@email.com\\Calendars\\groupname\")\n  Set NameSpace = Application.GetNamespace(\"MAPI\")\n  ' option 2\n  Set calFolder = NameSpace.GetDefaultFolder(9).Folders(\"groupname\")\n  NameSpace.GetSharedDefaultFolder(\"groupemail\", olFolderCalendar)\n  Set Items = calFolder.Items\n  ' option 3  \n  Set Items = Application.Session.GetDefaultFolder(olFolderCalendar).Parent.Folders(\"groupname\").Items\n</code></pre>\n\n<p>This is office 365 group. Lets call it abc. The group email is abc@somedoamin.com</p>\n\n<p>In the folder structure it appear like this:</p>\n\n<blockquote>\n  <p>My Mailbox</p>\n  \n  <blockquote>\n    <p>-Groups</p>\n    \n    <blockquote>\n      <p>--abc</p>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<p>Appreciate any pointers. Thanks in advance!</p>\n\n<p>EDIT:\nI found this structure for the group I am looking for in the debugger:  </p>\n\n<p>Namespace<br>\n|<br>\nAddressLists<br>\n|<br>\n |<br>\n  Item 7 : Name: All groups<br>\n   |<br>\n   AddressEntries<br>\n    |<br>\n    Item 18: Name: abc  </p>\n\n<p>Is there a way I can use this information to get the folder?</p>\n\n<p><a href=\"https://i.stack.imgur.com/aNx4o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aNx4o.png\" alt=\"Screenshot of structure under namespace\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1535577682, "post_id": 52086190, "comment_id": 91122791, "body": "not sure if this is your problem our not, but your lastRow reference is not appropriately qualified.  Depending on the complexity of your code, this will cause you all kinds of headaches once you stop debugging and run the code end-to-end."}, {"owner": {"reputation": 61, "user_id": 2596457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a565780fb86823a1e40f248cb34f1b?s=128&d=identicon&r=PG", "display_name": "user2596457", "link": "https://stackoverflow.com/users/2596457/user2596457"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1535578122, "post_id": 52086190, "comment_id": 91122960, "body": "When I apply that filter, the last row is 104. The lastRow that pops up via &quot;MsgBox lastRow&quot;, shows a value of 104. So to me, that means that part is working properly."}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1535578250, "post_id": 52086190, "comment_id": 91123003, "body": "it&#39;s only working because you have the sheet selected.  Select another sheet and run the code.  Unless you&#39;re selecting the sheet somewhere else in the code, your lastRow is returning the value of the currently selected sheet, not necessarily Sheets(2)."}, {"owner": {"reputation": 61, "user_id": 2596457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a565780fb86823a1e40f248cb34f1b?s=128&d=identicon&r=PG", "display_name": "user2596457", "link": "https://stackoverflow.com/users/2596457/user2596457"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1535579003, "post_id": 52086190, "comment_id": 91123271, "body": "I was very cautious that only the current sheet was working, whether it be Sheets(2) or ActiveSheet. I walk through the code - it&#39;s working until the .Range part of &quot;SortThree:&quot;."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1535586392, "creation_date": 1535586392, "answer_id": 52087454, "question_id": 52086190, "link": "https://stackoverflow.com/questions/52086190/how-can-i-sort-using-more-than-one-criteria-with-a-usedrange/52087454#52087454", "title": "How can I sort using more than one criteria with a UsedRange?", "body": "<p>The order argument for a VBA <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.sort\" rel=\"nofollow noreferrer\">Range.Sort</a> is Order1, Order2 and (if necessary) Order3. These coincide with Key1, Key2 and Key3. You do not require .Apply. SortOn:=xlSortOnValues is not a valid argument; it belongs to Sort.SortFields.Add which is another type of Sort altogether. You cannot mix-and-match the two Sort methods.</p>\n\n<pre><code>...\n.Range(\"A2:AA\" &amp; lastRow).Sort Key1:=.Cells(2, 19), Order1:=xlAscending, _\n                               Key2:=.Cells(2, 16), Order2:=xlAscending, _\n                               Orientation:=xlTopToBottom, Header:=xlNo\n...\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 2596457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a565780fb86823a1e40f248cb34f1b?s=128&d=identicon&r=PG", "display_name": "user2596457", "link": "https://stackoverflow.com/users/2596457/user2596457"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593770582, "creation_date": 1535577413, "last_edit_date": 1593770582, "question_id": 52086190, "link": "https://stackoverflow.com/questions/52086190/how-can-i-sort-using-more-than-one-criteria-with-a-usedrange", "title": "How can I sort using more than one criteria with a UsedRange?", "body": "<p>I am wracking my brain trying to get this one sorted out. What I am trying to accomplish is to sort a number of rows in a spreadsheet based upon criteria of a cell in that row.</p>\n<p>So, out of 200 rows, for example, I want to sort 50 of them by columns S &amp; P. Then, for maybe 20 other rows, I want to sort them by column N. The number of rows is dependent upon using a row count. I verified the row count was working with the MsgBox lastRow command.</p>\n<p>All of my other code works fine - I sort, delete UsedRange.Rows, etc (VMC:).</p>\n<p>In SortThree: is the failure.</p>\n<p>I turn filter mode off, it sorts the sheet using my criteria, lastRow is the correct number, and then when I try to apply the actual filter to sort it by Column S (19) and then Column P (16), it does nothing.</p>\n<pre><code>VMC:\n        If Sheets(2).FilterMode Then Sheets(2).AutoFilterMode = False\n        .AutoFilter field:=16, Criteria1:=&quot;0-VMC&quot;\n        If ActiveSheet.UsedRange.Row.Count = 0 Then GoTo SortThree\n        .Offset(1, 0).Resize(ActiveSheet.UsedRange.Rows.Count - 1).Rows.Delete\n\nSortThree:\nIf Sheets(2).FilterMode Then Sheets(2).AutoFilterMode = False\n        .AutoFilter field:=16, Criteria1:=&quot;3*&quot;\n        lastRow = Cells(Rows.Count, 1).End(xlUp).Row\n        MsgBox lastRow\n        .Range(&quot;A2:AA&quot; &amp; lastRow).Sort Key1:=.Cells(2, 19), Order:=xlAscending, SortOn:=xlSortOnValues, _\n                  Key2:=.Cells(2, 16), Order:=xlAscending, SortOn:=xlSortOnValues, _\n                  Orientation:=xlTopToBottom, Header:=xlNo\n                  .Apply\n.AutoFilterMode = False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1535577770, "post_id": 52086156, "comment_id": 91122826, "body": "What do you mean where &quot;col A = &#39;stack&#39;&quot;?  Do you mean where &quot;stack&quot; first appears in Column A?  It&#39;s unclear what you want the range <code>stack</code> to be/do"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1535577827, "post_id": 52086156, "comment_id": 91122853, "body": "I mean only clearcontents when Col A is Stack, if its overflow or anything else, do not clear contents for those rows."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1535577879, "post_id": 52086156, "comment_id": 91122881, "body": "Column A quite simply cannot be &quot;stack&quot; (what would that mean, every cell has &quot;stack&quot; in it? The only cell in column A is &quot;stack&quot;?...).  Do you mean a cell <i>in</i> column A?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535578544, "post_id": 52086156, "comment_id": 91123101, "body": "Offset(&quot;stack&quot;, 0) ?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535578604, "post_id": 52086156, "comment_id": 91123127, "body": "Are you saying all rows in column A that have &quot;stack&quot; in you want corresponding cells in same rows in CJ:CW cleared?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1535578793, "post_id": 52086156, "comment_id": 91123194, "body": "@BruceWayne I&#39;d be surprised if you can."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535580896, "post_id": 52086156, "comment_id": 91123840, "body": "@QHarr - Ah, I misread your comment. I thought you were suggestion a way to do that, not questioning it :P"}], "answers": [{"comments": [{"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1535583850, "post_id": 52086533, "comment_id": 91124645, "body": "Thanks. Can you describe the <code>resize</code> part? What is 1,14?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1535583953, "post_id": 52086533, "comment_id": 91124668, "body": "@excelguy see <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.resize\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1535588215, "post_id": 52086533, "comment_id": 91125566, "body": "why resize range?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535607108, "post_id": 52086533, "comment_id": 91129470, "body": "do you not wish to clear CJ:CW? That is 14 columns wide."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1535634508, "post_id": 52086533, "comment_id": 91146061, "body": "@QHarr Yes, I am sorry. Anyway to speed this up? I have to go through 6k rows and clear them for these 14 cols?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535634649, "post_id": 52086533, "comment_id": 91146166, "body": "Yes. 1) Use arrays or 2) Use autofilter. I will update with an arrays version for you."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535635115, "post_id": 52086533, "comment_id": 91146498, "body": "Array version added"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 1, "creation_date": 1535635684, "post_id": 52086533, "comment_id": 91146874, "body": "thank you @QHarr . Any chance you could explain vbnullstring?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1535635108, "last_edit_date": 1535635108, "creation_date": 1535579352, "answer_id": 52086533, "question_id": 52086156, "link": "https://stackoverflow.com/questions/52086156/vba-clearcontents-in-columns-only-where-range-string/52086533#52086533", "title": "VBA, ClearContents in columns only where range = string", "body": "<p>I am going to take a punt on what you have described rather than the code.</p>\n\n<blockquote>\n  <p>I want to clear contents in a specified column(s) where col A =\n  \"stack\". I don't want to use range(\"A2:A1000\") as this can change.</p>\n</blockquote>\n\n<p>I will take that as being dynamically determine the end row in column A and then loop from <code>A2</code> to it. If column A value, for a given cell, is \"stack\" then clear the contents of <code>CJ:CW</code> in the same row.</p>\n\n<pre><code>Option Explicit\nPublic Sub ClearCells()\n    Dim mainRange As Range, rng As Range\n    Application.ScreenUpdating = False\n    With ThisWorkbook.Worksheets(\"database\")\n        Set mainRange = .Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row)\n        For Each rng In mainRange.SpecialCells(xlCellTypeConstants)\n            If rng.Value = \"stack\" Then\n                rng.Offset(, 87).Resize(1, 14).ClearContents\n            End If\n        Next\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Array version:</p>\n\n<pre><code>Option Explicit\nPublic Sub ClearCells()\n    Dim mainRange As Range, arr(), i As Long, j As Long\n    Application.ScreenUpdating = False\n    With ThisWorkbook.Worksheets(\"database\")\n        Set mainRange = .Range(\"A2:CW\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row)\n        arr = mainRange.Value\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            If arr(i, 1) = \"stack\" Then\n                 For j = 1 To 14\n                     arr(i, 87 + j) = vbNullString\n                 Next\n            End If\n        Next\n        mainRange = arr\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 52086533, "answer_count": 1, "score": 0, "last_activity_date": 1535635108, "creation_date": 1535577262, "question_id": 52086156, "link": "https://stackoverflow.com/questions/52086156/vba-clearcontents-in-columns-only-where-range-string", "title": "VBA, ClearContents in columns only where range = string", "body": "<p>I want to clear contents in a specified column(s) where <code>col A = \"stack\"</code>. I don't want to use <code>range(\"A2:A1000\")</code> as this can change.</p>\n\n<p>having some trouble here, not sure if I need to loop through each row, can anyone help me start this off.</p>\n\n<pre><code>Sub Clear()\n\nDim stack As Range\nstack= Sheets(\"database\").Range(\"A2\").Offset(\"stack\", 0).endxlup.Select\nRange(\"CJ:CW\").stack.ClearContents\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 3, "creation_date": 1535576855, "post_id": 52086070, "comment_id": 91122488, "body": "How do we reproduce this error?"}, {"owner": {"reputation": 3, "user_id": 7024547, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R4SI-TyyMKc/AAAAAAAAAAI/AAAAAAAAANY/L6_Rbv4wfaE/photo.jpg?sz=128", "display_name": "Sergio Pastor", "link": "https://stackoverflow.com/users/7024547/sergio-pastor"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1535577136, "post_id": 52086070, "comment_id": 91122593, "body": "I can&#39;t understand.... What&#39;s your question and thanks for answering"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1535579658, "post_id": 52086070, "comment_id": 91123465, "body": "It is almost impossible to help you without more details about your problem. Put yourself in my position: what would you want to know?"}, {"owner": {"reputation": 3, "user_id": 7024547, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R4SI-TyyMKc/AAAAAAAAAAI/AAAAAAAAANY/L6_Rbv4wfaE/photo.jpg?sz=128", "display_name": "Sergio Pastor", "link": "https://stackoverflow.com/users/7024547/sergio-pastor"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1535583381, "post_id": 52086070, "comment_id": 91124550, "body": "If I call the worksheets by their names it gives errors of indexes... The question is: How can I make that &quot;Set&quot; line without giving error.... It works sometimes"}], "owner": {"reputation": 3, "user_id": 7024547, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R4SI-TyyMKc/AAAAAAAAAAI/AAAAAAAAANY/L6_Rbv4wfaE/photo.jpg?sz=128", "display_name": "Sergio Pastor", "link": "https://stackoverflow.com/users/7024547/sergio-pastor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535584335, "creation_date": 1535576721, "last_edit_date": 1535584335, "question_id": 52086070, "link": "https://stackoverflow.com/questions/52086070/out-of-index-error-with-worksheets-collection-and-combobox-on-vba-from-excel", "title": "Out of index error with worksheets collection and combobox on VBA from excel", "body": "<p>I have an exception when trying to access the worksheets collection. <br>\nMy program already populates a Combobox with the sheet names of the workbook, but when I try to access the collection It gives me an Error 9 (Out of index)\nThe code is the next one:</p>\n\n<pre><code>With Me.cmbHojas\nSet regis.Hoja = ThisWorkbook.Worksheets(.List(.ListIndex))\nEnd With\n</code></pre>\n\n<p>cmbHojas is the combobox's name and it's fully populated by the initialize event from the form... It has all the sheet names, and I don't know what's the reason for this error to happen... <br>\nregis.Hoja is a property (Worksheet Type) of one of my objects<br>\nThe error comes from the right side of the assignment <br>\nThank you very much </p>\n\n<p>EDIT: I'll post the entire code that give problems</p>\n\n<pre><code>Private Sub btnTabla_Click() \nDim i As Long\nDim c1 As Integer\nDim fila As Variant\nDim f As Long, c As Long\nDim leer As String\nDim celda As Range\nDim regis As New Registro\nDim work As Worksheet\nWith Me.cmbHojas\nSet regis.Hoja = ThisWorkbook.Worksheets(.List(.ListIndex))\nEnd With\norigen:\nOn Error Resume Next\nSet celda = Application.InputBox(\"Seleccione la celda de origen\", _\n\"Entrada\", Type:=8)\nOn Error GoTo 0\nIf celda Is Nothing Then\nMsgBox \"No seleccion\u00f3 celda\", vbCritical, \"Entrada requerida\"\nGoTo origen\nEnd If \nSet regis.CeldaInicial = celda\n\n'Primera celda de escritura de la consulta\n\ndestino:\nOn Error Resume Next\nSet celda = Application.InputBox(\"Seleccione la celda de insercion\", _\n\"Entrada\", Type:=8)\nOn Error GoTo 0\nIf celda Is Nothing Then\nMsgBox \"No seleccion\u00f3 celda\", vbCritical, \"Entrada requerida\"\nGoTo destino\nEnd If\n\n' Iterador hasta que se termina la hoja\n\nf = celda.Row: c = celda.Column\n\nDo While True\nregis.linea\n\nfila = regis.regis\ni = regis.FilaComparacion\n\nFor c1 = 0 To UBound(fila)\nActiveWorkbook.ActiveSheet.Cells(f, c + c1).Value = fila(c1)\nDebug.Print fila(c1) + \" \" + Str(i)\nNext c1\nf = f + 1 \nIf (regis.Terminado) Then\nMsgBox (\"Se han terminado de leer los datos\")\nExit Do\nEnd If\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>I'm spanish-speaking so it's in spanish...\nThe aim of that program is to make a query in a long excel sheet... The class \"Registro\" is working... I've tested it several times with my program.... That's not the problem...\nThe problem is in the code above</p>\n"}, {"tags": ["vba", "excel", "loops", "copy-paste"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1535574705, "post_id": 52085612, "comment_id": 91121585, "body": "<code>ThisWorkbook.Worksheets(&quot;DNU&quot;).Range(&quot;A1:Y200&quot;).Copy ThisWorkbook.Worksheets(i).Range(&quot;A1&quot;)</code>"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535574893, "post_id": 52085612, "comment_id": 91121673, "body": "@BigBen Yes, thanks) Fixed)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10291971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b1c71a54c649ba6a704f47331cf258?s=128&d=identicon&r=PG&f=1", "display_name": "Hiimtroymcclure", "link": "https://stackoverflow.com/users/10291971/hiimtroymcclure"}, "edited": false, "score": 0, "creation_date": 1535577514, "post_id": 52085692, "comment_id": 91122725, "body": "Running into another issue where the column widths in the new worksheets are not the same as the &quot;DNU&quot; worksheet. Is there a way to copy the width formatting?"}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1535582799, "post_id": 52085692, "comment_id": 91124374, "body": "For i = 6 To .Worksheets.Count         .Worksheets(&quot;DNU&quot;).Range(&quot;A1:Y200&quot;).Copy         .Worksheets(i).Range(&quot;A1:Y200&quot;).PasteSpecial Paste:=xlPasteAll         .Worksheets(i).Range(&quot;A1:Y200&quot;).PasteSpecial Paste:=xlPasteColumnWidths     Next"}, {"owner": {"reputation": 3, "user_id": 10291971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b1c71a54c649ba6a704f47331cf258?s=128&d=identicon&r=PG&f=1", "display_name": "Hiimtroymcclure", "link": "https://stackoverflow.com/users/10291971/hiimtroymcclure"}, "edited": false, "score": 0, "creation_date": 1535584637, "post_id": 52085692, "comment_id": 91124844, "body": "Thank you! Is there a reason why the groupings from &quot;DNU&quot; wouldn&#39;t be saved into the new worksheets? Is there a way around this or do they need to be regrouped in each worksheet?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 3, "user_id": 10291971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b1c71a54c649ba6a704f47331cf258?s=128&d=identicon&r=PG&f=1", "display_name": "Hiimtroymcclure", "link": "https://stackoverflow.com/users/10291971/hiimtroymcclure"}, "edited": false, "score": 0, "creation_date": 1536505569, "post_id": 52085692, "comment_id": 91439676, "body": "@Hiimtroymcclure, I don&#39;t use groups and hence can&#39;t give you help on that. But if my answer solved your original question you may want to mark it as accepted. thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1535574881, "creation_date": 1535574881, "answer_id": 52085692, "question_id": 52085612, "link": "https://stackoverflow.com/questions/52085612/excel-vba-copy-paste-range-from-one-sheet-to-all-proceeding-sheets/52085692#52085692", "title": "Excel VBA - Copy/Paste range from one sheet to all proceeding sheets", "body": "<p>Use Copy() method of Range object </p>\n\n<pre><code>Dim wsVar As Worksheet\nDim i as Integer\nWith ThisWorkbook\n    For i = 6 to .Worksheets.Count\n        .Worksheets(\"DNU\").Range(\"A1:Y200\").Copy destination:=.Worksheets(i).Range(\"A1:Y200\")\n    Next \nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10291971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b1c71a54c649ba6a704f47331cf258?s=128&d=identicon&r=PG&f=1", "display_name": "Hiimtroymcclure", "link": "https://stackoverflow.com/users/10291971/hiimtroymcclure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 52085692, "answer_count": 1, "score": 0, "last_activity_date": 1535574881, "creation_date": 1535574521, "last_edit_date": 1535574607, "question_id": 52085612, "link": "https://stackoverflow.com/questions/52085612/excel-vba-copy-paste-range-from-one-sheet-to-all-proceeding-sheets", "title": "Excel VBA - Copy/Paste range from one sheet to all proceeding sheets", "body": "<p>First time asking a question so please let me know if I'm missing anything. </p>\n\n<p>I found this code from another SO post. I'm trying to copy the entire worksheet from \"DNU\" into each proceeding worksheet. The issue I'm having is that this will paste values but I'm looking to do a regular paste to keep the formatting and formulas. I've tried changing from the \"Value\" to Copy and Paste but this end up in an error. Any help is appreciated. Thank you.</p>\n\n<p>Here is the code:\n~</p>\n\n<pre><code>Dim wsVar As Worksheet\n\nDim i as Integer\nFor i = 6 to ThisWorkbook.Worksheets.Count\n    ThisWorkbook.Worksheets(i).Range(\"A1:y200\").Value = ThisWorkbook.Worksheets(\"DNU\").Range(\"A1:Y200\").Value\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 10237340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bb9ae5e78125f68d9bc449077804f0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryeo", "link": "https://stackoverflow.com/users/10237340/ryeo"}, "is_accepted": false, "score": 0, "last_activity_date": 1535597483, "creation_date": 1535597483, "answer_id": 52088587, "question_id": 52085488, "link": "https://stackoverflow.com/questions/52085488/how-to-create-folder-by-cell-value/52088587#52088587", "title": "How to create folder by cell value?", "body": "<p>could you explain how your data is structured and what do you mean? i.e. are you trying to pick out the managers from the current dataset from another sheet? </p>\n\n<p>generally if you are looping through the list and creating a folder for each you could do something like</p>\n\n<pre><code>Dim MainPath As String\nDim ManagerName As String\nDim ManagerFolder As String\n\nMainPath = \"M:\\Lvl3-5Mgrs\\\"\n\nWith Worksheets(\"Lvl4\")\n    For Each Manager In Managers\n        ManagerFolder = MainPath &amp; Manager.Value\n        If Dir(ManagerFolder, vbDirectory) = vbNullString Then\n            MkDir (ManagerFolder)\n        End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535597483, "creation_date": 1535573933, "question_id": 52085488, "link": "https://stackoverflow.com/questions/52085488/how-to-create-folder-by-cell-value", "title": "How to create folder by cell value?", "body": "<p>How would I turn this:</p>\n\n<pre><code> Dim sPath As String\n  sPath = \"M:\\Lvl3-5Mgrs\\\"\nIf Len(Dir(sPath &amp; Format(Date, \"yyyy_mm_dd\"), vbDirectory)) = 0 Then\n MkDir (sPath &amp; Format(Date, \"yyyy_mm_dd\"))\nEnd If\nEnd Sub\n</code></pre>\n\n<p>into a way to create folders by a cell values in a list I put as filename: \n<strong>VBA_2018_Mid_Year_File</strong> list located in sheet(\"mrkt_leader\"). </p>\n\n<p>So if I have 10 market leaders in that sheet, I want 10 folders with a market leader having their own folder. </p>\n\n<p>Then how would I have each filtered new file save in that additional folder layer if this is what I have currently? </p>\n\n<pre><code>.SaveAs Filename:=\"M:\\Pittsburgh\\GRP4\\HR_PCorpComp\\Retail\\!Mid-Year\\Mid Year 2018\\Reporting\\TCR\\Lvl3-5Mgrs\\\" &amp; Format(Date, \"yyyy_mm_dd\") &amp; \"\\\" &amp; Format(Date, \"yyyy_mm_dd_\") &amp; Manager, FileFormat:=xlOpenXMLWorkbook\n</code></pre>\n\n<p>Here's the whole script if that helps (it filters down to specific manager spans based on helper worksheet lists with the managers I want to pick out): </p>\n\n<pre><code>    Option Explicit\n\n        Sub Lvl4Mgr()\n              Dim Managers, Manager, Leader\n              Dim Header As Range, Where As Range, This As Range\n              Dim Wb As Workbook\n\n              'Prepare\n              Application.ScreenUpdating = False\n              Application.DisplayAlerts = False\n\n              'Refer to the headings\n              Set Header = Range(\"A1\").EntireRow\n              'Refer to all managers in level4\n              Set Where = Range(\"AS2\", Range(\"AS\" &amp; Rows.Count).End(xlUp))\n              'Get the managers\n              With Worksheets(\"Lvl4\")\n                Set Managers = .Range(\"A2\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\n              End With\n              'Loop through\n              For Each Manager In Managers\n                'Find them\n                Set This = FindAll(Where, Manager)\n                If This Is Nothing Then GoTo Skip\n                'Create a new file\n                Set Wb = Workbooks.Add(XlWBATemplate.xlWBATWorksheet)\n                With Wb\n                  With .Sheets(1)\n                    'Copy the header\n                    Header.Copy .Range(\"A1\")\n                    'Copy the data\n                    This.EntireRow.Copy .Range(\"A2\")\n                  End With\n                  With .Sheets(1)\n                  Cells.EntireColumn.AutoFit\n                  End With\n                   Columns(\"C:C\").NumberFormat = \"mm/dd/yyyy\"\n                   Columns(\"BN:BN\").NumberFormat = \"mm/dd/yyyy\"\n                    Rows(\"1:1\").AutoFilter\n                 'Save it\n                  .SaveAs Filename:=\"M:\\Lvl3-5Mgrs\\\" &amp; Format(Date, \"yyyy_mm_dd\") _\n                  &amp; \"\\\" &amp; Format(Date, \"yyyy_mm_dd_\") &amp; Manager, FileFormat:=xlOpenXMLWorkbook, Password:=\"Ville18$\"\n        .Close\n                End With\nSkip:\n                    Next\n                    'Done\n\n\n\n\n            End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1535572636, "post_id": 52085153, "comment_id": 91120610, "body": "Format returns text, not a true date."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1535572710, "creation_date": 1535572710, "answer_id": 52085212, "question_id": 52085153, "link": "https://stackoverflow.com/questions/52085153/converting-short-date-to-long-date/52085212#52085212", "title": "Converting short date to long date", "body": "<p>Format returns text, not a true date. Change the cell's number format.</p>\n\n<pre><code>wkSheet.Cells(3, i).NumberFormat = \"[$-F800]dddd, mmmm dd, yyyy\"\n</code></pre>\n\n<p>Note that date formats do not include <sup>st</sup>, <sup>nd</sup>, <sup>rd</sup>, <sup>th</sup>, etc. and your supplied date format is a forced two digit day (e.g. 01, not 1<sup>st</sup>)</p>\n"}], "owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 52085212, "answer_count": 1, "score": 0, "last_activity_date": 1594072257, "creation_date": 1535572467, "last_edit_date": 1594072257, "question_id": 52085153, "link": "https://stackoverflow.com/questions/52085153/converting-short-date-to-long-date", "title": "Converting short date to long date", "body": "<p>Hi I have the following code:</p>\n\n<pre><code>dim currentDate as Date\ncurrentDate = Format(wkSheet.Cells(3, i), \"[$-F800]dddd, mmmm dd, yyyy\")\n</code></pre>\n\n<p>Cells(3, i) is a date in short form\nI'm trying to convert it to a long form so for instance 7/1/2018 would become Sunday, July 1st, 2018. How to do this? The above code is based on the \"record a macro\" function.</p>\n"}, {"tags": ["excel", "vba", "vlookup", "worksheet-function"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10112280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c5847d7e2bfafcf5ebd3d9ee7db5c5?s=128&d=identicon&r=PG&f=1", "display_name": "Gokuba", "link": "https://stackoverflow.com/users/10112280/gokuba"}, "edited": false, "score": 0, "creation_date": 1535573325, "post_id": 52085313, "comment_id": 91120937, "body": "Could u elaborate please?     @Jeeped                                                                                    Sub znajdzadres() Dim ws As Worksheet Dim eadr As Variant Dim nameW As Variant nameW = ActiveSheet.Name  eadr = Application.WorksheetFunction.VLookup(nameW, DOSTAWCY!R2C1:R83C3, 3, 0) Debug.Print eadr     End Sub"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 11, "user_id": 10112280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c5847d7e2bfafcf5ebd3d9ee7db5c5?s=128&d=identicon&r=PG&f=1", "display_name": "Gokuba", "link": "https://stackoverflow.com/users/10112280/gokuba"}, "edited": false, "score": 0, "creation_date": 1535573859, "post_id": 52085313, "comment_id": 91121188, "body": "Yes, the worksheet and range shouldn&#39;t have been left as worksheet formula syntax; I&#39;ve updated."}, {"owner": {"reputation": 11, "user_id": 10112280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c5847d7e2bfafcf5ebd3d9ee7db5c5?s=128&d=identicon&r=PG&f=1", "display_name": "Gokuba", "link": "https://stackoverflow.com/users/10112280/gokuba"}, "edited": false, "score": 0, "creation_date": 1535573965, "post_id": 52085313, "comment_id": 91121236, "body": "Runtime 91  now. Asking for nameW debug"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 11, "user_id": 10112280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c5847d7e2bfafcf5ebd3d9ee7db5c5?s=128&d=identicon&r=PG&f=1", "display_name": "Gokuba", "link": "https://stackoverflow.com/users/10112280/gokuba"}, "edited": false, "score": 0, "creation_date": 1535574291, "post_id": 52085313, "comment_id": 91121400, "body": "Works fine for me once I create a worksheet named DOSTAWCY with a table containing the active worksheet name in column A."}, {"owner": {"reputation": 11, "user_id": 10112280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c5847d7e2bfafcf5ebd3d9ee7db5c5?s=128&d=identicon&r=PG&f=1", "display_name": "Gokuba", "link": "https://stackoverflow.com/users/10112280/gokuba"}, "edited": false, "score": 0, "creation_date": 1535574621, "post_id": 52085313, "comment_id": 91121552, "body": "Sows NameW as empty and cant proceed forward"}, {"owner": {"reputation": 11, "user_id": 10112280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c5847d7e2bfafcf5ebd3d9ee7db5c5?s=128&d=identicon&r=PG&f=1", "display_name": "Gokuba", "link": "https://stackoverflow.com/users/10112280/gokuba"}, "edited": false, "score": 1, "creation_date": 1535574950, "post_id": 52085313, "comment_id": 91121695, "body": "I take iT back , works like a charm!!!!!!!!!!!!!!!!!! THANK YOU @Jeeped"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1535574222, "last_edit_date": 1535574222, "creation_date": 1535573104, "answer_id": 52085313, "question_id": 52085134, "link": "https://stackoverflow.com/questions/52085134/worksheets-name-as-seeked-value-for-vlookup/52085313#52085313", "title": "worksheets name as seeked value for Vlookup", "body": "<p>Don't quote the formula when applying a worksheet function and apply the string var as-is with the appropriate worksheet/range reference.</p>\n\n<pre><code>Dim eadr As Variant\nDim nameW As Variant\n\nnameW = ActiveSheet.Name\n\neadr = Application.WorksheetFunction.VLookup(nameW, worksheets(\"DOSTAWCY\").range(\"A2:C83\"), 3, 0)\n\ndebug.print eadr \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10112280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c5847d7e2bfafcf5ebd3d9ee7db5c5?s=128&d=identicon&r=PG&f=1", "display_name": "Gokuba", "link": "https://stackoverflow.com/users/10112280/gokuba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 52085313, "answer_count": 1, "score": 1, "last_activity_date": 1594072251, "creation_date": 1535572383, "last_edit_date": 1594072251, "question_id": 52085134, "link": "https://stackoverflow.com/questions/52085134/worksheets-name-as-seeked-value-for-vlookup", "title": "worksheets name as seeked value for Vlookup", "body": "<p>For my sending email macro, I would like to use vlookup where seeked value is the tabs name. By  using tabs name I would get an email address from one of the worksheets. Unfortunately, my code is not working:</p>\n\n<pre><code>Sub znajdzadres()\nDim ws As Worksheet\nDim eadr As Variant\nDim nameW As Variant\nnameW = ws.Name\n\neadr = \"Application.WorksheetFunction.VLookup([nameW],DOSTAWCY!R2C1:R83C3,3,0)\"\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9650296, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215755638833733/picture?type=large", "display_name": "Jarrod Maverick Kassels", "link": "https://stackoverflow.com/users/9650296/jarrod-maverick-kassels"}, "edited": false, "score": 0, "creation_date": 1535572744, "post_id": 52085159, "comment_id": 91120654, "body": "Thank you so much for expedient response and best practices!"}, {"owner": {"reputation": 25, "user_id": 9650296, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215755638833733/picture?type=large", "display_name": "Jarrod Maverick Kassels", "link": "https://stackoverflow.com/users/9650296/jarrod-maverick-kassels"}, "edited": false, "score": 0, "creation_date": 1535573179, "post_id": 52085159, "comment_id": 91120857, "body": "Do you have any idea why it&#39;s still changing the naming convention of the attachment and routing everything to      Else                 sSaveFolder = &quot;C:\\Users\\jkassels\\Desktop\\test&quot;"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 25, "user_id": 9650296, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215755638833733/picture?type=large", "display_name": "Jarrod Maverick Kassels", "link": "https://stackoverflow.com/users/9650296/jarrod-maverick-kassels"}, "edited": false, "score": 0, "creation_date": 1535573243, "post_id": 52085159, "comment_id": 91120890, "body": "Is it saving them as <code>test4MyDocument</code> or something? I didn&#39;t notice you were missing some back slashes. I&#39;ve added the back slashes, although unless you really have folders named <code>test</code> through <code>test5</code>, those might be unnecessary - I&#39;ll need your clarification."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 25, "user_id": 9650296, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215755638833733/picture?type=large", "display_name": "Jarrod Maverick Kassels", "link": "https://stackoverflow.com/users/9650296/jarrod-maverick-kassels"}, "edited": false, "score": 0, "creation_date": 1535573378, "post_id": 52085159, "comment_id": 91120957, "body": "Where are you trying to save these files to? Just to the <code>test</code> folder, or the <code>test1, test2, test3, test4, test5</code> folders <i>inside</i> this test folder?"}, {"owner": {"reputation": 25, "user_id": 9650296, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215755638833733/picture?type=large", "display_name": "Jarrod Maverick Kassels", "link": "https://stackoverflow.com/users/9650296/jarrod-maverick-kassels"}, "edited": false, "score": 0, "creation_date": 1535573710, "post_id": 52085159, "comment_id": 91121128, "body": "I&#39;m trying to route attachments to the subfolders <i>inside</i> the <code>test</code> folder. If there&#39;s no match, default to the root <code>test</code> folder"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 25, "user_id": 9650296, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215755638833733/picture?type=large", "display_name": "Jarrod Maverick Kassels", "link": "https://stackoverflow.com/users/9650296/jarrod-maverick-kassels"}, "edited": false, "score": 0, "creation_date": 1535573729, "post_id": 52085159, "comment_id": 91121139, "body": "The code should work now then - you were missing backslashes at the end of your file paths."}, {"owner": {"reputation": 25, "user_id": 9650296, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215755638833733/picture?type=large", "display_name": "Jarrod Maverick Kassels", "link": "https://stackoverflow.com/users/9650296/jarrod-maverick-kassels"}, "edited": false, "score": 0, "creation_date": 1535573780, "post_id": 52085159, "comment_id": 91121152, "body": "Thank you @dwirony"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 2, "last_activity_date": 1536087002, "last_edit_date": 1536087002, "creation_date": 1535572495, "answer_id": 52085159, "question_id": 52084999, "link": "https://stackoverflow.com/questions/52084999/why-does-a-saved-attachments-file-name-include-the-name-of-the-expected-save-fo/52085159#52085159", "title": "Why does a saved attachment&#39;s file name include the name of the expected save folder?", "body": "<p>I've made quite a few changes to your code to clean up some things:</p>\n\n<ul>\n<li><p>I removed <code>id</code>, as it seems to serve no purpose. Why not just skip\nthe assignment of <code>id</code> and go right to assigning the save paths?</p></li>\n<li><p>I've also moved all declarations to the top, as you shouldn't be using<br>\n<code>Dim</code> inside a loop.</p></li>\n<li><p>I've removed a lot of the comments - comments should be reserved for \nmaking clarifications where confusion can occur - no need to explain \nthat all your <code>Dim</code> lines are declarations, and what they're being declared as. If anything, just start that snippet with <code>'Declarations</code> if you feel the need to.</p></li>\n</ul>\n\n<p>Also, <code>Select Case</code> is great - but you can't use <code>Select Case</code> to evaluate <code>True</code>. In your scenario, and <code>If/ElseIf</code> statement will suffice:</p>\n\n<pre><code>Public Sub ProcessEmails()\n\nDim oItems As Outlook.Items\nDim oItem As Object\n\nSet oItems = Session.GetDefaultFolder(olFolderInbox).Items\n\nFor Each oItem In oItems\n    If TypeName(oItem) = \"MailItem\" Then Call SaveAttachmentsToDisk(oItem)\nNext oItem\n\nEnd Sub\n\nPrivate Sub SaveAttachmentsToDisk(oItem As Outlook.MailItem)\n\nDim objAtt As Attachment\nDim i As Integer\nDim objFSO As Object\nDim sExt As String\nDim sSaveFolder As String\n\n'Only proceed if the email contains attachements.\nIf oItem.Attachments.Count &gt; 0 Then\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    For i = 1 To oItem.Attachments.Count\n        Set objAtt = oItem.Attachments(i)\n\n        sExt = objFSO.GetExtensionName(objAtt.Filename)\n\n        If sExt = \"pdf\" Then\n            If InStr(1, objAtt.DisplayName, \"APP\", vbTextCompare) &gt; 0 Then\n                sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\\test1\\\"\n            ElseIf InStr(1, objAtt.DisplayName, \"B2B - Asset\", vbTextCompare) &gt; 0 Then\n                sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\\test2\\\"\n            ElseIf InStr(1, objAtt.DisplayName, \"B2B - Business\", vbTextCompare) &gt; 0 Then\n                sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\\test3\\\"\n            ElseIf InStr(1, objAtt.DisplayName, \"B2B Fair\", vbTextCompare) &gt; 0 Then\n                sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\\test4\\\"\n            ElseIf InStr(1, objAtt.DisplayName, \"BDL\", vbTextCompare) &gt; 0 Then\n                sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\\test5\\\"\n            Else\n                sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\\\"\n            End If\n\n            objAtt.SaveAsFile sSaveFolder &amp; objAtt.DisplayName\n        End If\n\n        Set objAtt = Nothing\n    Next i\n\n    Set objFSO = Nothing\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9650296, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215755638833733/picture?type=large", "display_name": "Jarrod Maverick Kassels", "link": "https://stackoverflow.com/users/9650296/jarrod-maverick-kassels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 52085159, "answer_count": 1, "score": 2, "last_activity_date": 1592943005, "creation_date": 1535571679, "last_edit_date": 1592943005, "question_id": 52084999, "link": "https://stackoverflow.com/questions/52084999/why-does-a-saved-attachments-file-name-include-the-name-of-the-expected-save-fo", "title": "Why does a saved attachment&#39;s file name include the name of the expected save folder?", "body": "<p><strong>I'm trying to:</strong></p>\n\n<ol>\n<li><p>Check the email for attachments</p></li>\n<li><p>If the email contains an attachment cycle through the method for each attachment in the email.</p></li>\n<li><p>The method will search the attachment display name for a string match anywhere in the name, and assign it an ID accordingly</p></li>\n<li><p>It will then save a copy of the attachment to the matching subfolder based on the ID if the attachment is a .pdf</p></li>\n</ol>\n\n<p><strong>Issues I'm running into:</strong></p>\n\n<ul>\n<li><p>InStr doesn't seem to be assigning id's properly</p></li>\n<li><p>The macro is saving copies of the attachment, but it's renaming them to the file folder name, and doesn't seem to be sorting based on id. </p></li>\n<li><p>Once copies are saved, the only way I can delete them is through the cmd.  </p></li>\n</ul>\n\n<hr>\n\n<pre><code>Public Sub ProcessEmails()\n\nDim oItems As Outlook.Items\nDim oItem As Object\n\nSet oItems = Session.GetDefaultFolder(olFolderInbox).Items\n\nFor Each oItem In oItems\n    If TypeName(oItem) = \"MailItem\" Then Call SaveAttachmentsToDisk(oItem)\nNext oItem\n\nEnd Sub\n\n\n\nPrivate Sub SaveAttachmentsToDisk(oItem As Outlook.MailItem)\n\n'Declares objAtt as an outlook attachment\nDim objAtt As Attachment\n'Declares i as data type Integer\nDim i As Integer\n'Declares objFSO as any Data Type\nDim objFSO As Object\n'Declares sExt as data type string\nDim sExt As String\n'Declares sSaveFolder as data Type string\nDim sSaveFolder As String\n\n'Only proceed if the email contains attachements.\nIf oItem.Attachments.Count &gt; 0 Then\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n\n    'Cycle through each attachment on the email.\n    For i = 1 To oItem.Attachments.Count\n        Set objAtt = oItem.Attachments(i)\n\n       'Get the extension of the attached file name.\n        sExt = objFSO.GetExtensionName(objAtt.FileName)\n\n        'declares an Id used for file path routing\n        Dim id As Integer\n\n        'Checks the email attachment name for a string match. If a match occurs, assigns an ID used for file path routing\n        Select Case True\n\n        Case InStr(1, objAtt.DisplayName, \"APP\", vbTextCompare) &gt; 0\n            id = \"1\"\n        Case InStr(1, objAtt.DisplayName, \"B2B - Asset\", vbTextCompare) &gt; 0\n            id = \"2\"\n        Case InStr(1, objAtt.DisplayName, \"B2B - Business\", vbTextCompare) &gt; 0\n            id = \"3\"\n        Case InStr(1, objAtt.DisplayName, \"B2B Fair\", vbTextCompare) &gt; 0\n            id = \"4\"\n        Case InStr(1, objAtt.DisplayName, \"BDL\", vbTextCompare) &gt; 0\n            id = \"5\"\n        Case Else\n\n        End Select\n\n\n        'Saves outlook attachment to 'sSaveFolder' declared path if file extension is 'pdf'\n        If sExt = \"pdf\" Then\n            'Saves attachment to related subfolder based on ID\n            Select Case id\n                Case \"1\"\n                    sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\\test1\"\n                Case \"2\"\n                    sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\\test2\"\n                Case \"3\"\n                    sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\\test3\"\n                Case \"4\"\n                    sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\\test4\"\n                Case \"5\"\n                    sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\\test5\"\n                Case Else\n                    sSaveFolder = \"C:\\Users\\jkassels\\Desktop\\test\"\n            End Select\n\n            objAtt.SaveAsFile sSaveFolder &amp; objAtt.DisplayName\n        End If\n\n\n        Set objAtt = Nothing\n    Next i\n    Set objFSO = Nothing\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1535597098, "post_id": 52084917, "comment_id": 91127296, "body": "What is the error message you receive when the macro crashes?  If you step through the macro using F8, you should be able to see the value of <code>(c)</code> prior to that line executing.  These two pieces of information will be helpful in determining the problem."}, {"owner": {"reputation": 53, "user_id": 10291791, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RD3_OFYOlPI/AAAAAAAAAAI/AAAAAAAAAHw/qOOHNajuP_I/photo.jpg?sz=128", "display_name": "Jonathan Gariepy", "link": "https://stackoverflow.com/users/10291791/jonathan-gariepy"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1535633313, "post_id": 52084917, "comment_id": 91145165, "body": "In french : Erreur d&#39;ex&#233;cution &#39;1004&#39; : Erreur d&#233;finie par l&#39;application ou par l&#39;objet. (Guessing this is Runtime Error 1004 &#39; Application-defined or Object-defined error&#39;."}, {"owner": {"reputation": 53, "user_id": 10291791, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RD3_OFYOlPI/AAAAAAAAAAI/AAAAAAAAAHw/qOOHNajuP_I/photo.jpg?sz=128", "display_name": "Jonathan Gariepy", "link": "https://stackoverflow.com/users/10291791/jonathan-gariepy"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1535633908, "post_id": 52084917, "comment_id": 91145632, "body": "I tried running it and interrogated the c variable through the Immediate window (?c) and it returned payB."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1535652222, "post_id": 52084917, "comment_id": 91156792, "body": "There is good advice in the answer below.  I tried to duplicate your error and could not.  I concatenated by using <code>=&quot;Pay&quot;&amp;A5</code>, this formula being in your <code>E38</code>, and received <code>PayB</code>, which worked. As said below, you may want to make sure there are no spaces or other formatting causing problems."}, {"owner": {"reputation": 53, "user_id": 10291791, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RD3_OFYOlPI/AAAAAAAAAAI/AAAAAAAAAHw/qOOHNajuP_I/photo.jpg?sz=128", "display_name": "Jonathan Gariepy", "link": "https://stackoverflow.com/users/10291791/jonathan-gariepy"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1535654388, "post_id": 52084917, "comment_id": 91157841, "body": "I seem to have solved it with by changing ActiveSheet.ChartObjects(c).Copy to ActiveSheet.ChartObjects(c).Chart.ChartArea.Copy... I do plan to make some change based on the answer below though. Definitely learning a lot !"}], "answers": [{"tags": [], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "is_accepted": true, "score": 1, "last_activity_date": 1535634783, "creation_date": 1535634783, "answer_id": 52098015, "question_id": 52084917, "link": "https://stackoverflow.com/questions/52084917/macro-that-copy-paste-a-chart-depending-on-cell-content/52098015#52098015", "title": "Macro that copy-paste a chart depending on cell content", "body": "<p>Ok, I think I can help you:</p>\n\n<p>please check how the cell EY38 is formatted. Remove any \" or ' those will cause an error. </p>\n\n<p>Secondly an advice from a guy who also started recording macros:</p>\n\n<p>Do whenever possible not use activate and select. This is slow, painfull to analyse and prone to errors. </p>\n\n<p>Here an example of a code that does the same thing as your but without activate and select.</p>\n\n<pre><code>Sub Change_Pay()\n    Dim c As String\n    Dim COdel As ChartObject\n    Dim COcopy As ChartObject\n    Dim sht As Worksheet\n    c = Range(\"EY34\").Value\n    Set sht = Worksheets(1) ' worksheet object instead of activesheet\n\n    Set COdel = sht.ChartObjects(\"payDisplay\") ' Chartobject instead of activesheet.chartobjects(\"\")\n    Set COcopy = sht.ChartObjects(c)\n\n    COdel.Delete\n    COcopy.Copy Destination:=sht.Range(\"B34\") ' No need to select and paste if you give it the destination\n    COcopy.Parent.Name = \"payDisplay\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10291791, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RD3_OFYOlPI/AAAAAAAAAAI/AAAAAAAAAHw/qOOHNajuP_I/photo.jpg?sz=128", "display_name": "Jonathan Gariepy", "link": "https://stackoverflow.com/users/10291791/jonathan-gariepy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52098015, "answer_count": 1, "score": 4, "last_activity_date": 1535634783, "creation_date": 1535571394, "question_id": 52084917, "link": "https://stackoverflow.com/questions/52084917/macro-that-copy-paste-a-chart-depending-on-cell-content", "title": "Macro that copy-paste a chart depending on cell content", "body": "<p>Beginner macro-ist here with a question! I am trying to have a drop-down menu control what chart is displayed on a worksheet.</p>\n\n<p>Right now I have a drop-down menu with categories (say A, B and C).</p>\n\n<p>Somewhere on my sheet I have created a chart for each of these category (say a chart named payA, payB and payC).</p>\n\n<p>Next, I have a cell that refer that concatenate both the word \"pay\" and the letter of the drop-down menu to make up the equivalent of the chart name.</p>\n\n<p>I want my macro to delete the chart on the dashboard (named payDisplay), copy the appropriate chart depending on the cell (the concatenate would be in the cell EY38 in this example), paste it in the appropriate cell (B34 in this example, where payDisplay was originally) and then rename the new chart payDisplay.</p>\n\n<pre><code>Sub Change_Pay()\n    Dim c As String\n\n    c = Range(\"EY38\").Value\n\n    ActiveSheet.ChartObjects(\"payDisplay\").Delete\n    ActiveSheet.ChartObjects(c).Copy\n    ActiveSheet.Range(\"B34\").Select\n    ActiveSheet.Paste\n    ActiveChart.Parent.Name = \"payDisplay\"\nEnd Sub\n</code></pre>\n\n<p>My macro keeps crashing on the  ActiveSheet.ChartObjects(c).Copy line.</p>\n\n<p>Whenever I open the worksheet, I get the bug and proceed to paste a chart in the right place and name is payDisplay and the macro is working just fine at that point. After saving and reopening the file, the macro doesn't work anymore (maybe that info is useful).</p>\n"}, {"tags": ["vba", "for-loop", "worksheet"], "comments": [{"owner": {"reputation": 1403, "user_id": 10210511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d05fb1a7498067d7e438c7976bac27a8?s=128&d=identicon&r=PG&f=1", "display_name": "J. Blackadar", "link": "https://stackoverflow.com/users/10210511/j-blackadar"}, "edited": false, "score": 0, "creation_date": 1535576659, "post_id": 52084799, "comment_id": 91122415, "body": "Welcome to Stack Overflow! If it is possible, this post might benefit from a more detailed runtime error. Is there an associated line that caused the error?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10226338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73ea46a9aa9c37dd134a6437115484be?s=128&d=identicon&r=PG&f=1", "display_name": "gary0418", "link": "https://stackoverflow.com/users/10226338/gary0418"}, "edited": false, "score": 0, "creation_date": 1535572100, "post_id": 52084953, "comment_id": 91120383, "body": "Solution verified! It worked after I add <code>set rng = Nothing</code> after <code>rng.ClearContents</code>.   Could you elaborate a bit about the solution and the problem that I had? Thanks for the help!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 5, "user_id": 10226338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73ea46a9aa9c37dd134a6437115484be?s=128&d=identicon&r=PG&f=1", "display_name": "gary0418", "link": "https://stackoverflow.com/users/10226338/gary0418"}, "edited": false, "score": 0, "creation_date": 1535572163, "post_id": 52084953, "comment_id": 91120408, "body": "The problem is that on your next iteration, <code>rng</code> was set to something on Sheet1 - When it saw that <code>rng</code> was not set to <code>Nothing</code> it attempted to do a <code>Union</code> of a range on Sheet1 with a range on Sheet2 - which you can&#39;t do, throwing an error :)"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1535572272, "last_edit_date": 1535572272, "creation_date": 1535571501, "answer_id": 52084953, "question_id": 52084799, "link": "https://stackoverflow.com/questions/52084799/applying-the-same-macro-to-all-worksheets/52084953#52084953", "title": "Applying the same Macro to All Worksheets", "body": "<p>Looks like you need to reset <code>rng</code> to <code>Nothing</code> before starting moving to the next sheet:</p>\n\n<pre><code>...\nNext column\nrng.ClearContents\n\nSet rng = Nothing\n...\n</code></pre>\n\n<p>To expand off my comments:</p>\n\n<p>When you got to Sheet2, your first iteration of this loop</p>\n\n<pre><code>If rng Is Nothing Then\n    Set rng = ActiveCell.Offset(row, column)\nElse\n    Set rng = Union(rng, ActiveCell.Offset(row, column))\nEnd If\n</code></pre>\n\n<p>Is going to go right to <code>Set rng = Union(rng, ActiveCell.Offset(row, column))</code> because <code>rng</code> wasn't reset to <code>Nothing</code>. Then it attempts a <code>Union</code> across two worksheets which you can't do.</p>\n"}], "owner": {"reputation": 5, "user_id": 10226338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73ea46a9aa9c37dd134a6437115484be?s=128&d=identicon&r=PG&f=1", "display_name": "gary0418", "link": "https://stackoverflow.com/users/10226338/gary0418"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 52084953, "answer_count": 1, "score": 0, "last_activity_date": 1535572272, "creation_date": 1535570925, "last_edit_date": 1535571886, "question_id": 52084799, "link": "https://stackoverflow.com/questions/52084799/applying-the-same-macro-to-all-worksheets", "title": "Applying the same Macro to All Worksheets", "body": "<p>I am trying to run a macro through all worksheets in an Excel workbook. I have the code below, but I am getting a Run-time error '1004': Method 'Union' of object'_Global\" failed.</p>\n\n<p>I have looked up the error and tried to \"go into Tools/Options and select the option to Require Variable Declaration\" from the suggestion below, but it didn't work.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/32147200/method-union-of-object-global-failed-on-cells-that-are-on-the-same-sheet\">Method &#39;Union&#39; of object &#39;_Global&#39; failed on cells that are on the same sheet</a></p>\n\n<p>Below is my VBA code that will loop through the entire worksheets. </p>\n\n<pre><code>    Sub Bagasse_YG_Update()\n\n    Dim rng As Range, column As Long, row As Long\n    Dim WS_Count As Integer\n    Dim I As Integer\n\n    ' Set WS_Count equal to the number of worksheets in the active\n    ' workbook.\n    WS_Count = ActiveWorkbook.Worksheets.Count\n\n    ' Begin the loop.\n    For I = 1 To WS_Count\n\n    'do whatever you need'\n    Sheets(I).Select ' Added this command to loop through the sheets\n\n    Range(\"A1\").Select\n    Selection.End(xlDown).Select\n    Selection.End(xlDown).Select\n    Union(ActiveCell.EntireRow, ActiveCell.Resize(1).Offset   (-1).EntireRow).Copy\n    ActiveCell.Resize(1).Offset(1).EntireRow.Insert Shift:=xlDown\n    Application.CutCopyMode = False\n\n    For column = 4 To 43\n        If (column + 1) Mod 4 &gt; 0 Then\n            For row = 1 To 2\n                If rng Is Nothing Then\n                    Set rng = ActiveCell.Offset(row, column)\n                Else\n                    Set rng = Union(rng, ActiveCell.Offset(row, column))\n                End If\n                Next row\n            End If\n            Next column\n            rng.ClearContents\n\n    ActiveCell.End(xlDown).Select\n    ActiveCell.End(xlDown).Select\n    ActiveCell.Offset(-6).EntireRow.Copy\n    ActiveCell.Offset(-5).Select\n    ActiveCell.EntireRow.Insert Shift:=xlDown\n    Application.CutCopyMode = False\n\n\n\n    Dim row2 As Long, column2 As Long\n    row2 = -2\n    For column2 = 5 To 25 Step 4\n        ActiveCell.Offset(row2, column2).Copy\n        ActiveSheet.Paste Destination:=ActiveCell.Offset(row2 + 1, column2)\n        Next column2\n\n    Next I\n  Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1535569286, "post_id": 52084248, "comment_id": 91119142, "body": "Have your tried setting the visibility of the comment to <code>false</code> <i>after</i> inserting the text?"}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1535572392, "post_id": 52084248, "comment_id": 91120507, "body": "Yes it is false"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1535572450, "post_id": 52084248, "comment_id": 91120528, "body": "I can see that. I am asking if you tried moving the line setting it to false <b>AFTER</b> inserting the text"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1535572874, "post_id": 52084248, "comment_id": 91120706, "body": "What is the value of <code>OldVal</code>?"}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1535573189, "post_id": 52084248, "comment_id": 91120864, "body": "Value of Oldval is showing Empty"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535573403, "post_id": 52084248, "comment_id": 91120971, "body": "Where do you declare <code>OldVal</code>? Is it a <code>Public</code> variable? Assuming it is, if the selection is changed to an empty cell, <code>OldVal</code> will be empty, and then you won&#39;t be able to use as the text of a comment."}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1535573727, "post_id": 52084248, "comment_id": 91121137, "body": "Yes Oldval is a public variant"}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1535574358, "post_id": 52084248, "comment_id": 91121433, "body": "The cells are getting highlightend with yellow color but the comment box is empty and in &quot;Edits Log&quot; sheet the track records are not visible."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1535574360, "post_id": 52084248, "comment_id": 91121435, "body": "@Santo - How and where is <code>Oldval</code> declared?"}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1535574611, "post_id": 52084248, "comment_id": 91121544, "body": "I declared before this line &quot;Sub Worksheet_Change(ByVal Target As Range)&quot; as Public Oldval As String."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535575241, "post_id": 52084248, "comment_id": 91121827, "body": "@Santo if you are tracking the changes in a cell, if the cell was previously empty then <code>oldVal</code> will be Empty. <code>Cstr(oldVal)</code> will then produce an empty string, and then you&#39;ll have a blank comment if you use that as the comment&#39;s text."}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1535575273, "post_id": 52084248, "comment_id": 91121840, "body": "Yes i tried now but the same problem i.e. cells are getiing highlighted but the comment box is empty."}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1535575364, "post_id": 52084248, "comment_id": 91121871, "body": "Then how i can get the oldval as a text in the comment box,"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535576413, "post_id": 52084248, "comment_id": 91122305, "body": "@Santo, if you change a non-blank cell, is the added comment still blank?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1535598434, "post_id": 52088260, "comment_id": 91127564, "body": "I am getting &quot;Previously blank or an error&quot; this in the comment box when i update the cell values and still my edits log sheet not getting any data regarding my updations."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1535598513, "post_id": 52088260, "comment_id": 91127572, "body": "Even if you change a non-empty cell?"}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1535603321, "post_id": 52088260, "comment_id": 91128526, "body": "Yes even with a non-empty cell."}, {"owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "edited": false, "score": 0, "creation_date": 1535603947, "post_id": 52088260, "comment_id": 91128670, "body": "I tried again now and this time the comment box is displaying the oldvalues of the cells now i Need to find why this updates are not getting recorded in the Edits Log Excel sheet."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1535594504, "creation_date": 1535594504, "answer_id": 52088260, "question_id": 52084248, "link": "https://stackoverflow.com/questions/52084248/how-to-track-changes-with-the-comment-box-on-the-cells-after-updating-from-the-u/52088260#52088260", "title": "How to track changes with the comment box on the cells after updating from the userform?", "body": "<p>From the comments, the error is thrown because <code>oldVal</code> is <code>Empty</code>. When a previously blank cell is changed, the <code>Selection Change</code> fires, and since there was no previous value in the cell, <code>oldVal</code> will be <code>Empty</code>.</p>\n\n<p>The <code>Worksheet Change</code> code needs to handle that possibility, as well as the possibility that <code>Target</code> contains an error - e.g. #VALUE! or #N/A. </p>\n\n<p>Stripping out the portion that writes to the \"Edits Log\" tab, your <code>Worksheet Change</code> might look something like the code below:</p>\n\n<pre><code>Option Explicit\n\nPublic oldVal 'should be a Variant\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    oldVal = Target.Value\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n    Target.Interior.ColorIndex = 6\n\n    On Error Resume Next\n    Target.AddComment\n    On Error GoTo 0\n\n    With Target.Comment\n        .Visible = False\n        If Not IsEmpty(oldVal) And Not IsError(oldVal) Then\n            .Text CStr(oldVal)\n        Else\n            .Text \"Previously blank or an error\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8990499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ec7b7f395f537f3fbc57717fc0578f?s=128&d=identicon&r=PG&f=1", "display_name": "Santo", "link": "https://stackoverflow.com/users/8990499/santo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594072235, "creation_date": 1535568403, "last_edit_date": 1594072235, "question_id": 52084248, "link": "https://stackoverflow.com/questions/52084248/how-to-track-changes-with-the-comment-box-on-the-cells-after-updating-from-the-u", "title": "How to track changes with the comment box on the cells after updating from the userform?", "body": "<p>I am trying to write a VBA macro to track changes of a worksheet in a separate sheet(showing the history of changes) by displaying a comment box on the cell with some color, automatically when the user search and updates the data in the userform. </p>\n\n<p>Below code is for search and update:</p>\n\n<p>''this code is for updating the data in the userform''</p>\n\n<pre><code>Private Sub cmdupdate_Click()\nIf Me.TextBox1.Value = \"\" Then\nMsgBox \"SL No Can Not be Blank!!!\", vbExclamation, \"SL No\"\nExit Sub\nEnd If\nSLNo = Me.TextBox1.Value\nSheets(\"Sheet1\").Select\nDim rowselect As Double\nrowselect = Me.TextBox1.Value\nrowselect = rowselect + 1\nRows(rowselect).Select\nCells(rowselect, 2) = Me.TextBox2.Value\nCells(rowselect, 3) = Me.TextBox3.Value\nCells(rowselect, 4) = Me.TextBox4.Value\nCells(rowselect, 5) = Me.TextBox5.Value\nCells(rowselect, 6) = Me.TextBox6.Value\n\nEnd Sub\n</code></pre>\n\n<p>''The below code is used to search from the excel sheet and displays in the userform''</p>\n\n<pre><code>Private Sub cmdSearch_Click()\nDo\n        DoEvents\n        row_number = row_number + 1\n        item_in_review = Sheets(\"Sheet1\").Range(\"A\" &amp; row_number)\n        If item_in_review = TextBox1.Text Then\n            TextBox2.Text = Sheets(\"Sheet1\").Range(\"B\" &amp; row_number)\n            TextBox3.Text = Sheets(\"Sheet1\").Range(\"C\" &amp; row_number)\n            TextBox4.Text = Sheets(\"Sheet1\").Range(\"D\" &amp; row_number)\n            TextBox5.Text = Sheets(\"Sheet1\").Range(\"F\" &amp; row_number)\n            TextBox6.Text = Sheets(\"Sheet1\").Range(\"E\" &amp; row_number)\n        End If\n    Loop Until item_in_review = \"\"\nEnd Sub\n</code></pre>\n\n<p>Now I try to add the below code for track changes after updating the excel sheet with userform but I am getting an error in this line \"Target.Comment.Text Text:=OldVal\" not able to get the solution to complete my task.</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\nDim X As Integer\n    Set Wb = ThisWorkbook\n        ShtName = \"Edits Log\"\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    X = EndRow + 1\n    Wb.Sheets(ShtName).Range(\"A\" &amp; X).Value = ActiveSheet.Name\n    Wb.Sheets(ShtName).Range(\"B\" &amp; X).Value = Target.Address\n    Wb.Sheets(ShtName).Range(\"C\" &amp; X).Value = OldVal\n    Wb.Sheets(ShtName).Range(\"D\" &amp; X).Value = Target.Value\n    Wb.Sheets(ShtName).Range(\"E\" &amp; X).Value = Now()\n    Wb.Sheets(ShtName).Range(\"F\" &amp; X).Value = Environ(\"username\")\n    Target.Interior.ColorIndex = 6\n    On Error Resume Next\n    Target.AddComment\n    On Error GoTo 0\n    Target.Comment.Visible = False\n    Target.Comment.Text Text:=OldVal\nEnd Sub\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    OldVal = Target.Value\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "nested-loops"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1535575063, "post_id": 52083977, "comment_id": 91121735, "body": "One thing i noticed, you should not use variables that can be mistaken as cell references, it can be confusing. I think your problem is <code>If count &lt; LastA2 Then</code> it should be <code>count2</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 0, "last_activity_date": 1535576307, "creation_date": 1535576307, "answer_id": 52085991, "question_id": 52083977, "link": "https://stackoverflow.com/questions/52083977/nested-do-until-and-for-loop-in-vba/52085991#52085991", "title": "Nested &quot;Do Until&quot; and &quot;For&quot; loop in VBA", "body": "<p>You only have one loop. The place where your comment starts \"create a loop\" isn't a loop, it's an If statement. Here's how you might rewrite your code if I understand the logic correctly.</p>\n\n<pre><code>Sub PullNames()\n\n    Dim A As Range\n    Dim B As Range\n    Dim C As Range\n    Dim A2 As Range\n    Dim B2 As Range\n    Dim C2 As Range\n    Dim LastA As Long\n    Dim LastB As Long\n    Dim LastC As Long\n    Dim LastA2 As Long\n    Dim CheckName As String\n    Dim CheckName2 As String\n    Dim count As Long, count2 As Long\n    Dim Name_ As String\n    Dim Name2 As String\n\n    LastA = Sheets(\"Sheet1\").Cells(Rows.count, 1).End(xlUp).Row\n    LastB = Sheets(\"Sheet1\").Cells(Rows.count, 2).End(xlUp).Row\n    LastC = Sheets(\"Sheet1\").Cells(Rows.count, 3).End(xlUp).Row\n    count = 2\n\n    Set A = Sheets(\"Sheet1\").Range(\"A2:A\" &amp; LastA)\n    Set B = Sheets(\"Sheet1\").Range(\"B2:B\" &amp; LastB)\n    Set C = Sheets(\"Sheet1\").Range(\"C2:c\" &amp; LastC)\n    Set A2 = Sheets(\"Sheet2\").Range(\"A\" &amp; count)\n    Set B2 = Sheets(\"Sheet2\").Range(\"B\" &amp; count)\n    Set C2 = Sheets(\"Sheet2\").Range(\"C\" &amp; count)\n\n    Sheets(\"Sheet2\").Activate\n    A2.Activate\n\n    A.Copy Destination:=A2\n    A2.RemoveDuplicates Columns:=1, Header:=xlNo\n    A2.Columns.AutoFit\n\n    Sheets(\"Sheet1\").Activate\n\n    LastA2 = Sheets(\"Sheet2\").Cells(Rows.count, 1).End(xlUp).Row\n\n    Do Until count &gt; LastA\n        CheckName = Sheets(\"Sheet1\").Range(\"A\" &amp; count)\n        Name_ = CheckName\n\n            'creates a loop for the macro to go through the names on Sheet2\n            'If count &lt; LastA2 Then\n            count2 = 2\n            Do While count2 &lt;= LastA2\n                CheckName2 = Sheets(\"Sheet2\").Range(\"A\" &amp; count2)\n                Name2 = CheckName2\n                    If Name_ = Name2 Then\n                        'B2 = B.Value\n                        Sheets(\"Sheet2\").Range(\"B\" &amp; count2).Value = Sheets(\"Sheet1\").Range(\"B\" &amp; count).Value\n                    End If\n\n                count2 = count2 + 1\n            Loop\n            'End If\n\n    count = count + 1\n    Loop\n\n\nEnd Sub\n</code></pre>\n\n<p>If there are duplicates (that you removed), this code will pull the last value it encounters, which you may not want. If, for instance, B is a number, you may want to add those numbers together in column B.</p>\n\n<p>Here's how I would have written the code.</p>\n\n<pre><code>Public Sub PullNames2()\n\n    Dim rCell As Range\n    Dim rFound As Range\n    Dim rNames As Range\n\n    'Define the range that contains the names\n    'copy that range to sheet2 and remove the dupes\n    Set rNames = Sheet1.Range(\"A2\").CurrentRegion.Columns(1)\n    rNames.Copy Sheet2.Range(\"A2\")\n    With Sheet2.Range(\"A2\").CurrentRegion\n        .RemoveDuplicates 1, xlNo\n        .Columns.AutoFit\n    End With\n\n    'Loop through all the names\n    For Each rCell In rNames.Cells\n        'use the Find method to find the name on sheet2\n        Set rFound = Nothing\n        Set rFound = Sheet2.Columns(1).Find(rCell.Value, , xlValues, xlWhole)\n\n        'If you found the name, add the value in B to whatever is already there\n        If Not rFound Is Nothing Then\n            rFound.Offset(0, 1).Value = rFound.Offset(0, 1).Value + rCell.Offset(0, 1).Value\n        End If\n    Next rCell\n\nEnd Sub\n</code></pre>\n\n<p>A couple of notes:</p>\n\n<ul>\n<li>I use codenames of sheets. These are the names VBA knows and are not the tab names. You don't have to use them, it's just my preference.</li>\n<li>CurrentRegion is good if you don't have any gaps. If it doesn't work for your data, you can set rNames however you like to define ranges. You'll just need to use the same methodology for sheet2.</li>\n<li>You have to set rFound to Nothing every time because it will remember the last time it found something. That way you can check for Nothing - that's what rFound is if it can't find what it's looking for.</li>\n</ul>\n\n<p><strong>Always</strong> test code from the internet on a copy of your data. Particularly code that changes stuff.</p>\n"}], "owner": {"reputation": 3, "user_id": 10291436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9d4e2c546d6aa7be3571df790114eb?s=128&d=identicon&r=PG&f=1", "display_name": "VBABeginner", "link": "https://stackoverflow.com/users/10291436/vbabeginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "accepted_answer_id": 52085991, "answer_count": 1, "score": 0, "last_activity_date": 1594072243, "creation_date": 1535567258, "last_edit_date": 1594072243, "question_id": 52083977, "link": "https://stackoverflow.com/questions/52083977/nested-do-until-and-for-loop-in-vba", "title": "Nested &quot;Do Until&quot; and &quot;For&quot; loop in VBA", "body": "<p>I am trying to create a macro that takes the data in column B from Sheet1 to Sheet2 if the names in column A Sheet1 corresponds to the names in column A in Sheet2. The first part of the code works fine, but the second part which is the \"Do Until\" loop is the problem. With the code I currently have, the loop runs through the outer loop and inner loop for the first name in Column A, but then it does not go through the outer loop for the rest of the names in Column A. The code is below:</p>\n\n<pre><code>Sub PullNames()\n\nDim A As Range\nDim B As Range\nDim C As Range\nDim A2 As Range\nDim B2 As Range\nDim C2 As Range\nDim LastA As Long\nDim LastB As Long\nDim LastC As Long\nDim LastA2 As Long\nDim CheckName As String\nDim CheckName2 As String\nDim count As Long\n\n\nLastA = Sheets(\"Sheet1\").Cells(Rows.count, 1).End(xlUp).Row\nLastB = Sheets(\"Sheet1\").Cells(Rows.count, 2).End(xlUp).Row\nLastC = Sheets(\"Sheet1\").Cells(Rows.count, 3).End(xlUp).Row\ncount = 2\n\nSet A = Sheets(\"Sheet1\").Range(\"A2:A\" &amp; LastA)\nSet B = Sheets(\"Sheet1\").Range(\"B2:B\" &amp; LastB)\nSet C = Sheets(\"Sheet1\").Range(\"C2:c\" &amp; LastC)\nSet A2 = Sheets(\"Sheet2\").Range(\"A\" &amp; count)\nSet B2 = Sheets(\"Sheet2\").Range(\"B\" &amp; count)\nSet C2 = Sheets(\"Sheet2\").Range(\"C\" &amp; count)\n\nSheets(\"Sheet2\").Activate\nA2.Activate\n\n    A.Copy Destination:=A2\n    A2.RemoveDuplicates Columns:=1, Header:=xlNo\n    A2.Columns.AutoFit\n\n\nSheets(\"Sheet1\").Activate\n\nLastA2 = Sheets(\"Sheet2\").Cells(Rows.count, 1).End(xlUp).Row\n\nDo Until count &gt; LastA\n    CheckName = Sheets(\"Sheet1\").Range(\"A\" &amp; count)\n    Name = CheckName\n\n        'creates a loop for the macro to go through the names on Sheet2\n        If count &lt; LastA2 Then\n            CheckName2 = A2\n            Name2 = CheckName2\n                If Name = Name2 Then\n                    B2 = B.Value\n                End If\n\n        count2 = count2 + 1\n        End If\n\ncount = count + 1\nLoop\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535567506, "post_id": 52083952, "comment_id": 91118346, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14985261/how-can-i-use-outlook-to-send-email-to-multiple-recipients-in-excel-vba\">How can I use outlook to send email to multiple recipients in excel vba</a>"}, {"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 0, "creation_date": 1535568138, "post_id": 52083952, "comment_id": 91118627, "body": "You&#39;re trying to put a range in a text field. Go through the range and put the contents in <code>.To</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1535569674, "creation_date": 1535569674, "answer_id": 52084518, "question_id": 52083952, "link": "https://stackoverflow.com/questions/52083952/how-to-paste-email-addresses-from-clipboard-into-outlook-to-field/52084518#52084518", "title": "How to paste email addresses from clipboard into Outlook &quot;To&quot; field?", "body": "<p>Try creating a string of recipients instead - you can't paste a range to the <code>.To</code> like that.</p>\n\n<pre><code>Sub Test2()\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim Subj As String\n    Dim oiInsp As Object\n    Dim wdDoc As Object\n    Dim oRng As Object\n\n    Dim lastrow As Long, i As Long\n    Dim recipstring As String\n\n    lastrow = Cells(Rows.Count, 2).End(xlUp).Row\n\n    For i = 2 To lastrow\n        If i = 2 Then\n            recipstring = Range(\"B\" &amp; i).Value\n        Else\n            recipstring = recipstring &amp; \";\" &amp; Range(\"B\" &amp; i).Value\n        End If\n    Next i\n\n    'Create Outlook object\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n\n    'Trying to add the email address to the \"To\" field in the email\n    With OutMail\n        .Display\n        Set olInsp = .GetInspector\n        Set wdDoc = olInsp.WordEditor\n        Set oRng = wdDoc.Range\n        .to = recipstring\n\n        'This will resolve all the addresses in the email to ensure they exist in your contacts, otherwise pops up error\n        If Not .Recipients.ResolveAll Then\n            For Each Recipient In .Recipients\n                If Not Recipient.Resolved Then\n                    MsgBox Recipient.Name &amp; \" could not be resolved\"\n                End If\n            Next\n        End If\n    End With\n\n    On Error GoTo 0\n\n    Set OutApp = Nothing\n    Set OutMail = Nothing\n    Set olInsp = Nothing\n    Set wdDoc = Nothing\n    Set oRng = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10291551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3b64f173ba7ab2678feacec2fda8686?s=128&d=identicon&r=PG&f=1", "display_name": "George C", "link": "https://stackoverflow.com/users/10291551/george-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535569674, "creation_date": 1535567154, "last_edit_date": 1535567361, "question_id": 52083952, "link": "https://stackoverflow.com/questions/52083952/how-to-paste-email-addresses-from-clipboard-into-outlook-to-field", "title": "How to paste email addresses from clipboard into Outlook &quot;To&quot; field?", "body": "<p>Trying to setup VBA code that will take a selection of Excel cells which contain email addresses (with a semi-colon at the end of each address to allow for multiple emails when pasted) and insert those into the \"To\" field in an new Outlook email. When I execute the below code, it only inserts the email addresses into the Body of the Outlook email, not the \"To\" field. Is there a way to fix this or will I need to approach this in a completely different fashion?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Test2()\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim Subj As String\n    Dim oiInsp As Object\n    Dim wdDoc As Object\n    Dim oRng As Object\n\n    'Copy the email addresses to the clipboard\n    Range(\"B2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n\n    'Create Outlook object\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n\n    'Trying to add the email address to the \"To\" field in the email\n    With OutMail\n        .Display\n        Set olInsp = .GetInspector\n        Set wdDoc = olInsp.WordEditor\n        Set oRng = wdDoc.Range\n        .To = oRng.Paste\n\n        'This will resolve all the addresses in the email to ensure they exist in your contacts, otherwise pops up error\n        If Not .Recipients.ResolveAll Then\n            For Each Recipient In .Recipients\n                If Not Recipient.Resolved Then\n                    MsgBox Recipient.Name &amp; \" could not be resolved\"\n                End If\n            Next\n        End If\n    End With\n\n    On Error GoTo 0\n\n    Set OutApp = Nothing\n    Set OutMail = Nothing\n    Set olInsp = Nothing\n    Set wdDoc = Nothing\n    Set oRng = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "vba", "excel", "resx", "msxml2"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1535567440, "post_id": 52083649, "comment_id": 91118318, "body": "Searching the error code (it translates to an HRESULT of 0xC00CE556) <a href=\"https://stackoverflow.com/questions/13188815/hresult-0xc00ce556-loading-string-to-xml\">turned this up</a>. Are you getting a BOM marker at the start of the string?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535569083, "post_id": 52083649, "comment_id": 91119055, "body": "Can you give a single example of one part of the above that you want to alter and what you want to alter it to please? A currently failing example. Include the actual values. I can load this just fine."}, {"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1535612831, "post_id": 52083649, "comment_id": 91131869, "body": "@Comintern, thanks a lot for the link, I will have a look. @qharr this is weird, but might have to do with the above. I would want to alter the  <code>&lt;data name=&quot;Change_phone_number&quot;&gt;&lt;value&gt;</code> field."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535616759, "post_id": 52083649, "comment_id": 91134214, "body": "What is weird? Sorry I may have missed something."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535617359, "post_id": 52083649, "comment_id": 91134560, "body": "And did you want to change: \t&lt;value&gt;Change phone number&lt;/value&gt;  or &lt;data name=&quot;Change_phone_number&quot;&gt;&lt;value&gt; ?"}, {"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1535636284, "post_id": 52083649, "comment_id": 91147310, "body": "My mistake, the XML load method did not work as expected, using regular Load worked fine with a second file."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1535617716, "creation_date": 1535617716, "answer_id": 52092461, "question_id": 52083649, "link": "https://stackoverflow.com/questions/52083649/loading-xml-not-working-invalid-at-the-top-level-of-the-document/52092461#52092461", "title": "Loading XML not working: Invalid at the top level of the document", "body": "<p>The following works perfectly for me, reading your xml from a file on desktop</p>\n\n<pre><code>Option Explicit\nPublic Sub testing()\n    Dim xDoc As New MSXML2.DOMDocument60, node As IXMLDOMElement\n\n    Set xDoc = New MSXML2.DOMDocument60\n\n    With xDoc\n        .async = False\n        .validateOnParse = True\n\n        If Not xDoc.Load(\"C:\\Users\\User\\Desktop\\Testing.xml\") Then\n            Debug.Print .parseError.reason, .parseError.ErrorCode\n            Exit Sub\n        End If\n\n        Set node = xDoc.SelectSingleNode(\"//data[@name='Change_phone_number']\")\n\n        If Not node Is Nothing Then\n            node.Text = \"Ain't nobody got time for that\"\n        End If\n        Debug.Print node.Text\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2277, "favorite_count": 0, "accepted_answer_id": 52092461, "answer_count": 1, "score": 1, "last_activity_date": 1535617716, "creation_date": 1535565707, "last_edit_date": 1535613425, "question_id": 52083649, "link": "https://stackoverflow.com/questions/52083649/loading-xml-not-working-invalid-at-the-top-level-of-the-document", "title": "Loading XML not working: Invalid at the top level of the document", "body": "<p>I want to parse and modify the following <code>.resx</code> file using <code>Excel VBA</code>.</p>\n\n<p>The <code>.resx</code> is exactly like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;root&gt;\n  &lt;!-- \n    Microsoft ResX Schema \n\n    Version 2.0\n\n    The primary goals of this format is to allow a simple XML format \n    that is mostly human readable. The generation and parsing of the \n    various data types are done through the TypeConverter classes \n    associated with the data types.\n\n    Example:\n\n    ... ado.net/XML headers &amp; schema ...\n    &lt;resheader name=\"resmimetype\"&gt;text/microsoft-resx&lt;/resheader&gt;\n    &lt;resheader name=\"version\"&gt;2.0&lt;/resheader&gt;\n    &lt;resheader name=\"reader\"&gt;System.Resources.ResXResourceReader, System.Windows.Forms, ...&lt;/resheader&gt;\n    &lt;resheader name=\"writer\"&gt;System.Resources.ResXResourceWriter, System.Windows.Forms, ...&lt;/resheader&gt;\n    &lt;data name=\"Name1\"&gt;&lt;value&gt;this is my long string&lt;/value&gt;&lt;comment&gt;this is a comment&lt;/comment&gt;&lt;/data&gt;\n    &lt;data name=\"Color1\" type=\"System.Drawing.Color, System.Drawing\"&gt;Blue&lt;/data&gt;\n    &lt;data name=\"Bitmap1\" mimetype=\"application/x-microsoft.net.object.binary.base64\"&gt;\n        &lt;value&gt;[base64 mime encoded serialized .NET Framework object]&lt;/value&gt;\n    &lt;/data&gt;\n    &lt;data name=\"Icon1\" type=\"System.Drawing.Icon, System.Drawing\" mimetype=\"application/x-microsoft.net.object.bytearray.base64\"&gt;\n        &lt;value&gt;[base64 mime encoded string representing a byte array form of the .NET Framework object]&lt;/value&gt;\n        &lt;comment&gt;This is a comment&lt;/comment&gt;\n    &lt;/data&gt;\n\n    There are any number of \"resheader\" rows that contain simple \n    name/value pairs.\n\n    Each data row contains a name, and value. The row also contains a \n    type or mimetype. Type corresponds to a .NET class that support \n    text/value conversion through the TypeConverter architecture. \n    Classes that don't support this are serialized and stored with the \n    mimetype set.\n\n    The mimetype is used for serialized objects, and tells the \n    ResXResourceReader how to depersist the object. This is currently not \n    extensible. For a given mimetype the value must be set accordingly:\n\n    Note - application/x-microsoft.net.object.binary.base64 is the format \n    that the ResXResourceWriter will generate, however the reader can \n    read any of the formats listed below.\n\n    mimetype: application/x-microsoft.net.object.binary.base64\n    value   : The object must be serialized with \n            : System.Runtime.Serialization.Formatters.Binary.BinaryFormatter\n            : and then encoded with base64 encoding.\n\n    mimetype: application/x-microsoft.net.object.soap.base64\n    value   : The object must be serialized with \n            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter\n            : and then encoded with base64 encoding.\n\n    mimetype: application/x-microsoft.net.object.bytearray.base64\n    value   : The object must be serialized into a byte array \n            : using a System.ComponentModel.TypeConverter\n            : and then encoded with base64 encoding.\n    --&gt;\n  &lt;xsd:schema id=\"root\" xmlns=\"\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\"&gt;\n    &lt;xsd:import namespace=\"http://www.w3.org/XML/1998/namespace\" /&gt;\n    &lt;xsd:element name=\"root\" msdata:IsDataSet=\"true\"&gt;\n      &lt;xsd:complexType&gt;\n        &lt;xsd:choice maxOccurs=\"unbounded\"&gt;\n          &lt;xsd:element name=\"metadata\"&gt;\n            &lt;xsd:complexType&gt;\n              &lt;xsd:sequence&gt;\n                &lt;xsd:element name=\"value\" type=\"xsd:string\" minOccurs=\"0\" /&gt;\n              &lt;/xsd:sequence&gt;\n              &lt;xsd:attribute name=\"name\" use=\"required\" type=\"xsd:string\" /&gt;\n              &lt;xsd:attribute name=\"type\" type=\"xsd:string\" /&gt;\n              &lt;xsd:attribute name=\"mimetype\" type=\"xsd:string\" /&gt;\n              &lt;xsd:attribute ref=\"xml:space\" /&gt;\n            &lt;/xsd:complexType&gt;\n          &lt;/xsd:element&gt;\n          &lt;xsd:element name=\"assembly\"&gt;\n            &lt;xsd:complexType&gt;\n              &lt;xsd:attribute name=\"alias\" type=\"xsd:string\" /&gt;\n              &lt;xsd:attribute name=\"name\" type=\"xsd:string\" /&gt;\n            &lt;/xsd:complexType&gt;\n          &lt;/xsd:element&gt;\n          &lt;xsd:element name=\"data\"&gt;\n            &lt;xsd:complexType&gt;\n              &lt;xsd:sequence&gt;\n                &lt;xsd:element name=\"value\" type=\"xsd:string\" minOccurs=\"0\" msdata:Ordinal=\"1\" /&gt;\n                &lt;xsd:element name=\"comment\" type=\"xsd:string\" minOccurs=\"0\" msdata:Ordinal=\"2\" /&gt;\n              &lt;/xsd:sequence&gt;\n              &lt;xsd:attribute name=\"name\" type=\"xsd:string\" use=\"required\" msdata:Ordinal=\"1\" /&gt;\n              &lt;xsd:attribute name=\"type\" type=\"xsd:string\" msdata:Ordinal=\"3\" /&gt;\n              &lt;xsd:attribute name=\"mimetype\" type=\"xsd:string\" msdata:Ordinal=\"4\" /&gt;\n              &lt;xsd:attribute ref=\"xml:space\" /&gt;\n            &lt;/xsd:complexType&gt;\n          &lt;/xsd:element&gt;\n          &lt;xsd:element name=\"resheader\"&gt;\n            &lt;xsd:complexType&gt;\n              &lt;xsd:sequence&gt;\n                &lt;xsd:element name=\"value\" type=\"xsd:string\" minOccurs=\"0\" msdata:Ordinal=\"1\" /&gt;\n              &lt;/xsd:sequence&gt;\n              &lt;xsd:attribute name=\"name\" type=\"xsd:string\" use=\"required\" /&gt;\n            &lt;/xsd:complexType&gt;\n          &lt;/xsd:element&gt;\n        &lt;/xsd:choice&gt;\n      &lt;/xsd:complexType&gt;\n    &lt;/xsd:element&gt;\n  &lt;/xsd:schema&gt;\n  &lt;resheader name=\"resmimetype\"&gt;\n    &lt;value&gt;text/microsoft-resx&lt;/value&gt;\n  &lt;/resheader&gt;\n  &lt;resheader name=\"version\"&gt;\n    &lt;value&gt;2.0&lt;/value&gt;\n  &lt;/resheader&gt;\n  &lt;resheader name=\"reader\"&gt;\n    &lt;value&gt;System.Resources.ResXResourceReader, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/value&gt;\n  &lt;/resheader&gt;\n  &lt;resheader name=\"writer\"&gt;\n    &lt;value&gt;System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/value&gt;\n  &lt;/resheader&gt;\n  &lt;data name=\"Change_phone_number\" xml:space=\"preserve\"&gt;\n    &lt;value&gt;Change phone number&lt;/value&gt;\n  &lt;/data&gt;\n  &lt;data name=\"Change_your_mobile_phone_number\" xml:space=\"preserve\"&gt;\n    &lt;value&gt;Please change your mobile phone number&lt;/value&gt;\n  &lt;/data&gt;\n&lt;/root&gt;\n</code></pre>\n\n<p>The VBA code looks like this:</p>\n\n<pre><code>Sub ReadXMLDateFromFiles()\nDim ws As Worksheet\nDim XDoc As New MSXML2.DOMDocument\nDim i As Long\n\nSet ws = ThisWorkbook.Sheets(\"Files\")\nXDoc.async = False: XDoc.validateOnParse = False\n\ni = 2\nDo While ws.Cells(1, i).Value &lt;&gt; \"\"\n    XDoc.Load ws.Cells(1, i).Value\n    XDoc.LoadXML ws.Cells(1, i).Value\n    Debug.Print XDoc.parseError.reason, XDoc.parseError.ErrorCode\n    i = i + 1\nLoop\nSet XDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>As mentioned in the heading, the error:</p>\n\n<pre><code>Error message: Invalid at the top level of the document\nError code: -1072896682\n</code></pre>\n\n<p>I am not sure why I receive the error message.</p>\n\n<p>Removing the commentary part as well as the <code>&lt;xsd:&gt;</code> tags does not help either.</p>\n\n<p>I have tried the code with other XML files and it works. I have changed the ending of the file to xml and it doesn't work.</p>\n\n<p>I don't know what else to try. The file is saved as UTF8. I can open it in Webstorm without a problem and it is being recognized.</p>\n\n<p>The XPath I would want to use: <code>XDoc.SelectNodes(\"/root/data[@name='Change_phone_number']/value\")</code></p>\n\n<p>I have the following start in the document in <code>notepad++</code>: <a href=\"https://i.stack.imgur.com/KNL6x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KNL6x.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1535564604, "post_id": 52083320, "comment_id": 91116927, "body": "Put <code>Exit For</code> inside your <code>If</code> statement."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1535566211, "post_id": 52083320, "comment_id": 91117757, "body": "There&#39;s actually no <code>ElseIf</code> in your code. There&#39;s also no reason to have <code>&#39;Do the rest of the code here</code> because the <code>Exit Sub</code> will prevent execution from ever reaching that point."}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 1, "creation_date": 1535567167, "post_id": 52083320, "comment_id": 91118169, "body": "@Luis The code you wrote <i>requires</i> the message box to always come up. Why are you surprised?"}], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1535566135, "post_id": 52083421, "comment_id": 91117722, "body": "A little more detail on using the <code>.Find()</code> for the OPs benefit would go a long way toward making this a good answer."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1535567021, "post_id": 52083421, "comment_id": 91118112, "body": "Feel free to add details on <code>.find</code>. At the moment I am not even sure what the OP really wants."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1535565182, "last_edit_date": 1535565182, "creation_date": 1535564829, "answer_id": 52083421, "question_id": 52083320, "link": "https://stackoverflow.com/questions/52083320/if-else-not-being-recognized/52083421#52083421", "title": "If Else not being recognized", "body": "<p>Change the code to</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub TextBox1_Change()\n\nEnd Sub\nPrivate Sub CommandButton3_Click()\n\nDim number As Integer, i As Integer\n\n    For i = 10 To 10020\n        If TextBox1.Value = Tabelle1.Cells(i, 2).Text Then\n            number = TextBox1.Value\n            Exit Sub\n        End If\n    Next i\n\n    MsgBox \"A dica n\u00famero \" &amp; TextBox1.Value &amp; \" n\u00e3o consta na lista.\", vbOKOnly, \"Dica n\u00e3o encontrada!\"\n\n    Exit Sub\n\n    'Do the rest of the code here\nEnd Sub\n</code></pre>\n\n<p><strong>Update</strong> But maybe this is what you really want</p>\n\n<pre><code>Private Sub CommandButton3_Click()\nDim number As Integer\nDim rg As Range\n    With Sheet1\n        Set rg = .Range(.Cells(10, 2), .Cells(10020, 2))\n    End With\n    Dim rgRes As Range\n    Set rgRes = rg.Find(TextBox1.Value)\n    If Not (rgRes Is Nothing) Then\n        number = TextBox1.Value\n    Else\n        MsgBox \"A dica n\u00famero \" &amp; TextBox1.Value &amp; \" n\u00e3o consta na lista.\", vbOKOnly, \"Dica n\u00e3o encontrada!\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 8676006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1418109648308368/picture?type=large", "display_name": "Luis Eduardo", "link": "https://stackoverflow.com/users/8676006/luis-eduardo"}, "edited": false, "score": 0, "creation_date": 1535568612, "post_id": 52083443, "comment_id": 91118845, "body": "Thanks! The <code>.CountIf</code> did a better job than <code>If</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 45, "user_id": 8676006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1418109648308368/picture?type=large", "display_name": "Luis Eduardo", "link": "https://stackoverflow.com/users/8676006/luis-eduardo"}, "edited": false, "score": 2, "creation_date": 1535569012, "post_id": 52083443, "comment_id": 91119028, "body": "@LuisEduardo note that <code>Application.CountIf</code> is the late-bound equivalent of the early-bound <code>Application.WorksheetFunction.CountIf</code> - the latter will happily compile a typo, the former gives you intellisense, compile-time validation, and trappable run-time errors given invalid arguments."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 2, "last_activity_date": 1535564919, "creation_date": 1535564919, "answer_id": 52083443, "question_id": 52083320, "link": "https://stackoverflow.com/questions/52083320/if-else-not-being-recognized/52083443#52083443", "title": "If Else not being recognized", "body": "<p>First thing, the number entered in the TextBox would be considered as a String not a number. So you will need to convert it into a number and to do that, try this...</p>\n\n<pre><code>If Val(Me.TextBox1.Value) = Sheet1.Cells(i, 2).Value Then\n</code></pre>\n\n<p>Second thing, you don't need to loop through the cells just to check whether the number entered in the TextBox is found in a certain range. You may utilize the CountIf function to do that like below example. </p>\n\n<pre><code>If Application.CountIf(Sheet1.Range(\"B10:B10020\"), Me.TextBox1.Value) &gt; 0 Then\n    MsgBox \"Found\"\nElse\n    MsgBox \"Not Found\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8676006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1418109648308368/picture?type=large", "display_name": "Luis Eduardo", "link": "https://stackoverflow.com/users/8676006/luis-eduardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 52083443, "answer_count": 2, "score": 0, "last_activity_date": 1535565182, "creation_date": 1535564387, "question_id": 52083320, "link": "https://stackoverflow.com/questions/52083320/if-else-not-being-recognized", "title": "If Else not being recognized", "body": "<p>I have a form in which the user inputs a number, and I want my macro to check whether the number exists in a specific list in order to do some stuff. Here's how I did it:</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n Dim number As Integer, i As Integer\n For i = 10 To 10020\n     If TextBox1.Value = Sheet1.Cells(i, 2).Value Then\n         number = TextBox1.Value\n     End If\n Next i\n     MsgBox \"A dica n\u00famero \" &amp; TextBox1.Value &amp; \" n\u00e3o consta na lista.\", vbOKOnly, \"Dica n\u00e3o encontrada!\"\n     Exit Sub\n\n 'Do the rest of the code here\nEnd Sub\n</code></pre>\n\n<p>The thing is: no matter what number I input, the message box always comes up. <code>number = TextBox1.Value</code> is never read.\nI've tried manually checking if the values were the same for a specific input with message boxes, and even though they were the same, If/Else was never accessed.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1535572615, "post_id": 52082790, "comment_id": 91120597, "body": "What is <code>FilePath</code>?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1535809092, "post_id": 52082790, "comment_id": 91207763, "body": "The title &quot;renaming and deleting attachment&quot; does not match body &quot;rename the file and delete the email&quot;. Which is correct?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3276087, "user_type": "registered", "profile_image": "https://graph.facebook.com/559803444/picture?type=large", "display_name": "Mindbender", "link": "https://stackoverflow.com/users/3276087/mindbender"}, "edited": false, "score": 0, "creation_date": 1535648419, "post_id": 52085309, "comment_id": 91155064, "body": "Everything is working but the delete. I am wondering if it is because the first step is to move it from the inbox to the CBM subfolder and if the delete is looking in the inbox where the message no longer is. Not sure how to specify the folder name...basically once the script it run go to CBM folder and delte everything in it"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 11, "user_id": 3276087, "user_type": "registered", "profile_image": "https://graph.facebook.com/559803444/picture?type=large", "display_name": "Mindbender", "link": "https://stackoverflow.com/users/3276087/mindbender"}, "edited": false, "score": 0, "creation_date": 1535648670, "post_id": 52085309, "comment_id": 91155163, "body": "@Mindbender I&#39;ve added <code>Item.Save</code> in there, looks like you have to save it without the attachment."}, {"owner": {"reputation": 11, "user_id": 3276087, "user_type": "registered", "profile_image": "https://graph.facebook.com/559803444/picture?type=large", "display_name": "Mindbender", "link": "https://stackoverflow.com/users/3276087/mindbender"}, "edited": false, "score": 0, "creation_date": 1536072915, "post_id": 52085309, "comment_id": 91288454, "body": "It does not appear to be overwriting the file that is in the folder. Is there a way to force it to overwrite it?"}, {"owner": {"reputation": 11, "user_id": 3276087, "user_type": "registered", "profile_image": "https://graph.facebook.com/559803444/picture?type=large", "display_name": "Mindbender", "link": "https://stackoverflow.com/users/3276087/mindbender"}, "edited": false, "score": 1, "creation_date": 1536085859, "post_id": 52085309, "comment_id": 91294936, "body": "I figured out a work around by using task scheduler to archive and delete the file each night so the new file can get created in the folder. Will test over the next few days...thanks for all the help"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1535648657, "last_edit_date": 1535648657, "creation_date": 1535573082, "answer_id": 52085309, "question_id": 52082790, "link": "https://stackoverflow.com/questions/52082790/trouble-renaming-and-deleting-attachment-from-code-in-a-rule/52085309#52085309", "title": "Trouble renaming and deleting attachment from code in a rule", "body": "<p>Try this:</p>\n\n<pre><code>Public Sub SaveAttachments(Item As Outlook.MailItem)\n\nDim objAttachments As Outlook.Attachments\nDim lngCount As Long\nDim i As Long\n\nIf Item.Attachments.Count &gt; 0 Then\n\n    Set objAttachments = Item.Attachments\n\n    lngCount = objAttachments.Count\n\n    For i = lngCount To 1 Step -1\n\n        'Save the attachment as a file.\n        objAttachments.Item(i).SaveAsFile \"C:\\Automation\\CBM\\Daily_Activity_Report.xlsx\"\n\n        'Delete the attachment.\n        objAttachments.Item(i).Delete\n\n    Next i\n\n    Item.Save\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3276087, "user_type": "registered", "profile_image": "https://graph.facebook.com/559803444/picture?type=large", "display_name": "Mindbender", "link": "https://stackoverflow.com/users/3276087/mindbender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535648657, "creation_date": 1535562454, "last_edit_date": 1535572605, "question_id": 52082790, "link": "https://stackoverflow.com/questions/52082790/trouble-renaming-and-deleting-attachment-from-code-in-a-rule", "title": "Trouble renaming and deleting attachment from code in a rule", "body": "<p>I have this code and it worked to get the attachment out of outlook and into the local folder. I have since tried to modify it to rename the file and delete the email from outlook and that is where it stopped working.</p>\n\n<p>The rule moves the email when it comes in to a new folder, then saves the attachment to a folder on my C drive. Only 1 email per day and one attachment per day. </p>\n\n<p>I would like to save the attachment to the folder, rename the attachment (overwriting the existing file), and delete the email from outlook.</p>\n\n<p>This is the code I have so far.</p>\n\n<p>Any help would be appreciated</p>\n\n<pre><code>Public Sub SaveAttachments(Item As Outlook.MailItem)\n\nIf Item.Attachments.Count &gt; 0 Then\n\nDim objAttachments As Outlook.Attachments\nDim lngCount As Long\nDim strFile As String\nDim sFileType As String\nDim i As Long\n\nSet objAttachments = Item.Attachments\nlngCount = objAttachments.Count\nFor i = lngCount To 1 Step -1\n\n' Get the file name.\nstrFile = objAttachments.Item(i).FileName\n\n' Get the path to your My Documents folder\nstrfolderpath = \"C:\\Automation\\CBM\\\"\n'strfolderpath = strfolderpath &amp; \"\\Attachments\\\"\n\n' Combine with the path to the folder.\nstrFile = strfolderpath &amp; strFile\n\n' Save the attachment as a file.\nobjAttachments.Item(i).SaveAsFile FilePath &amp; \"Daily_Activity_Report\" &amp; \n\".xlsx\"\n\n' Delete the attachment.\nobjAttachments.Item(i).Delete\n\nNext i\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "late-binding"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1535563327, "post_id": 52082775, "comment_id": 91116300, "body": "You have to create a class instead of a user defined type."}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 2, "last_activity_date": 1535563520, "creation_date": 1535563520, "answer_id": 52083121, "question_id": 52082775, "link": "https://stackoverflow.com/questions/52082775/trouble-with-late-bound-functions/52083121#52083121", "title": "Trouble with late-bound functions", "body": "<p>This might be the quickest way. Create a class and name it dateValueItem</p>\n\n<pre><code>Option Explicit\n\nPublic total_value As Long\nPublic items As String\nPublic student_value As Long\n</code></pre>\n\n<p>And change your code to</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub makeNewReports()\nDim wkSheet As Worksheet\n    Set wkSheet = ActiveWorkbook.Worksheets(\"Grades\")\n\n    Dim i As Long\n\n    Dim myMap As Dictionary\n    Set myMap = New Dictionary\n\n    Dim myVals As dateValueItem\n    For i = 4 To 6    'wkSheet.Range(\"a1\").End(xlToRight).Column - 1\n        Set myVals = New dateValueItem\n        myVals.total_value = wkSheet.Cells(2, i)\n        myVals.items = wkSheet.Cells(1, i)\n        myVals.student_value = wkSheet.Cells(4, i)\n        myMap.Add wkSheet.Cells(3, i), myVals\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 52083121, "answer_count": 1, "score": 0, "last_activity_date": 1594072264, "creation_date": 1535562405, "last_edit_date": 1594072264, "question_id": 52082775, "link": "https://stackoverflow.com/questions/52082775/trouble-with-late-bound-functions", "title": "Trouble with late-bound functions", "body": "<p>Greetings I have the following code:</p>\n\n<pre><code>Private Sub makeNewReports()\n\n\nDim wkSheet As Worksheet\nSet wkSheet = ActiveWorkbook.Worksheets(\"Grades\")\n\nDim i As Long\n\nDim myMap As Dictionary\nSet myMap = New Dictionary\n\n\nFor i = 4 To 6 'wkSheet.Range(\"a1\").End(xlToRight).Column - 1\n    Dim myVals As dateValueItem\n    myVals.total_value = wkSheet.Cells(2, i)\n    myVals.items = wkSheet.Cells(1, i)\n    myVals.student_value = wkSheet.Cells(4, i)\n    myMap.Add wkSheet.Cells(3, i), myVals\nNext i\nEnd Sub\n</code></pre>\n\n<p>and the following code for dateValueItem</p>\n\n<pre><code>Option Explicit\n\nPublic Type dateValueItem\n      total_value As Long\n      items As String\n      student_value As Long\nEnd Type\n</code></pre>\n\n<p>when I run the above code I get the problem </p>\n\n<p>'Compile Error: Only user-defined types defined in public object modules can be coerced to or from a variant or passed to late bound functions'</p>\n\n<p>I'm trying to map together 3 different values to a specific date; the dates are held in row three. Row 2 and 4 has numerical values, and row 1 has string values. The hope is to be able to organize all of these together so I can eventually connect descriptions and values to dates.</p>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 1, "creation_date": 1535562340, "post_id": 52082580, "comment_id": 91115726, "body": "Your code writes everything to the same cell, is that what you want? Moreover, instead of selecting the item, using <code>ListBox1.Value</code> and then deselecting it, you can use <code>ListBox1.List(i)</code>."}, {"owner": {"reputation": 11, "user_id": 8173684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e131be8893e91fec4345fa266ee0319?s=128&d=identicon&r=PG&f=1", "display_name": "Meru", "link": "https://stackoverflow.com/users/8173684/meru"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1535562906, "post_id": 52082580, "comment_id": 91116064, "body": "I reduced the code to it&#39;s essential parts. Usually I search also for the right cell, but the loop would be just distracting for the problem itself. So it&#39;s writting everything to one cell for now. So by using ListBox1.List(i) it automatically select the item and copies it to the cell? I&#39;ll try it."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1535563112, "post_id": 52082580, "comment_id": 91116175, "body": "When you remove parts of your code, you should make sure that the new code produces the same problem. Read <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> for more. That being said, the code in your question should work fine <i>although it&#39;s not the right way to do what you&#39;re trying to do</i>. Anyway, try with <code>ListBox1.List(i)</code> as I suggested and let us know if you still have the same problem. <b>Make sure to try it with the shortened version of your code first</b>"}, {"owner": {"reputation": 11, "user_id": 8173684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e131be8893e91fec4345fa266ee0319?s=128&d=identicon&r=PG&f=1", "display_name": "Meru", "link": "https://stackoverflow.com/users/8173684/meru"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1535657592, "post_id": 52082580, "comment_id": 91159437, "body": "Thank you, your hint worked! And I tested the code before."}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1535564344, "creation_date": 1535564344, "answer_id": 52083312, "question_id": 52082580, "link": "https://stackoverflow.com/questions/52082580/copy-values-from-a-listbox-to-worksheet-cells/52083312#52083312", "title": "Copy values from a ListBox to worksheet cells", "body": "<p>If you want to place the items from the already populated ListBox onto the Sheet, you may try something like this...</p>\n\n<pre><code>Dim x\nx = Me.ListBox1.List\nRange(\"C2\").Resize(UBound(x) + 1, 1).Value = x\n</code></pre>\n\n<p>Tweak it as per your requirement.</p>\n"}], "owner": {"reputation": 11, "user_id": 8173684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e131be8893e91fec4345fa266ee0319?s=128&d=identicon&r=PG&f=1", "display_name": "Meru", "link": "https://stackoverflow.com/users/8173684/meru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6872, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1615359735, "creation_date": 1535561717, "last_edit_date": 1535563406, "question_id": 52082580, "link": "https://stackoverflow.com/questions/52082580/copy-values-from-a-listbox-to-worksheet-cells", "title": "Copy values from a ListBox to worksheet cells", "body": "<p>I'm working with VBA and have a problem I just can't find a solution for. I created a UserForm with a TextBox, a ListBox, and two Buttons. If you enter a text to the TextBox and click the <code>Button1</code>, then the text of the TextBox will be added via the command <code>ListBox.AddItem</code> to the Listbox. This part works perfectly fine.</p>\n\n<p>If you click on <code>Button2</code>, it shall copy the entries of the ListBox to the Excel Sheet. I'm having a problem with this part. The code is as follows:</p>\n\n<pre><code>For i = 0 To ListBox1.ListCount - 1\n    ListBox1.Selected(i) = True\n    ActiveSheet.Cells(2, 3) = ListBox1.Value\n    ListBox1.Selected(i) = False\nNext i\n</code></pre>\n\n<p>This code works perfectly fine if I open the UserForm and click once just anywhere in the ListBox. From then the code works without problems. I also can close the UserForm and open it again. It will still work.</p>\n\n<p>The problem appears if I open the whole Excel File and the UserForm <strong>and don't click once somewhere in the ListBox</strong>, it just doesn't copy the content. The code itself still works and is performed. It just seems as the command <code>ListBox1.Value</code> has no content. Is there a better way to solve my issue?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1535562136, "creation_date": 1535562136, "answer_id": 52082686, "question_id": 52082503, "link": "https://stackoverflow.com/questions/52082503/calling-macro-from-another-workbook-error/52082686#52082686", "title": "Calling macro from another workbook error", "body": "<p>If the workbook name includes <strong>spaces</strong> or some other particular characters it is necessary to enclose the name with single quotes, like this :</p>\n\n<pre><code>Application.Run \"'Book 1.xls'!MyMacroName\"\n</code></pre>\n\n<p><strong>Source</strong>: Ron deBruin : <a href=\"https://www.rondebruin.nl/win/s9/win001.htm\" rel=\"nofollow noreferrer\"><strong>How do I use Application.Run in Excel?</strong></a></p>\n\n<hr>\n\n<p>To ensure that macros are not disabled in Excel, you could go:<br>\n<code>File</code>><code>Options</code>><code>Trust Center</code>><code>Trust Center Settings</code>><code>Macro Settings</code>><code>Enable All Macros</code> </p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 10237340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bb9ae5e78125f68d9bc449077804f0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryeo", "link": "https://stackoverflow.com/users/10237340/ryeo"}, "is_accepted": false, "score": 0, "last_activity_date": 1535610191, "last_edit_date": 1535610191, "creation_date": 1535609064, "answer_id": 52090169, "question_id": 52082503, "link": "https://stackoverflow.com/questions/52082503/calling-macro-from-another-workbook-error/52090169#52090169", "title": "Calling macro from another workbook error", "body": "<p>code looks fine, probably you need to do some debugging to rule out wrong filename \npress CTRL G , which will open your Immediate Window </p>\n\n<p>type in the debug.print commands as below , if the line \"Exists?\" is follow by an empty space it means there's a problem with your file name or directory. </p>\n\n<p>hit F8 to run the code line by line instead of F5</p>\n\n<pre><code>Sub move()\n\nDim wb As Workbook\nDim MacroFolder As String\nDim MacroWb As String\n\nMacroFolder = \"C:\\Users\\zhill\\Desktop\\macro learn\\\"\nMacroWb = \"IMECM_To_LDW_CSV_Format-20151023-for-2015Q3-for-udf-version-13.0.015.xlsm\"\n\nDebug.Print MacroFolder &amp; MacroWb\nDebug.Print \"Exists?\", Dir(MacroFolder &amp; MacroWb)\n\nSet wb = Workbooks.Open(MacroFolder &amp; MacroWb)\n\nwb.Sheets(\"ALFA to Corp CSV\").Cells(13, 2) = ThisWorkbook.Sheets(\"sheet1\").Range(\"IntexFolderList\").Cells(1, 1)\nwb.Sheets(\"ALFA to Corp CSV\").Cells(14, 2) = ThisWorkbook.Sheets(\"sheet1\").Range(\"OutputFolderList\").Cells(1, 1)\nwb.Sheets(\"ALFA to Corp CSV\").Cells(9, 9) = ThisWorkbook.Sheets(\"sheet1\").Range(\"RunNbr\").Cells(1, 1)\n\nwb.Sheets(\"ALFA to Corp CSV\").Application.Run (MacroWb &amp; \"!ALFAtoCorpCsvFormat\")\n\nEnd Sub\n</code></pre>\n\n<p>if you still cant seem to arrow into the problem \nrun this code to see what are the files that excel has picked up in your directory. </p>\n\n<pre><code>Sub PrintDirectoryFiles()\n\nDim myfile As String\nDim MacroFolder As String\n\nMacroFolder = \"C:\\Users\\zhill\\Desktop\\macro learn\\\"\nmyfile = Dir(MacroFolder &amp; \"*.xlsm\")  'or *.*\n\nDo While myfile &lt;&gt; \"\"\n    Debug.Print myfile\n    myfile = Dir\nLoop\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10167060, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--19_b5XgpGU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qMkpdK6n6gKcA57RYEZexXJGkbQg/mo/photo.jpg?sz=128", "display_name": "Zach Hill", "link": "https://stackoverflow.com/users/10167060/zach-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1242, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1535610191, "creation_date": 1535561409, "last_edit_date": 1535562172, "question_id": 52082503, "link": "https://stackoverflow.com/questions/52082503/calling-macro-from-another-workbook-error", "title": "Calling macro from another workbook error", "body": "<p>I am trying to call a macro from another workbook, and I keep getting the following error.  </p>\n\n<p>Cannot run the macro  </p>\n\n<pre><code>'IMECM_To... \n</code></pre>\n\n<p>The macro may not be available in this workbook or all macros may be disabled.  </p>\n\n<p>I have made sure the macro name is spelled correctly, and have made sure that the macro is spelled correctly.<br>\nI have looked online and have not been able to figure out how to fix this.<br>\nThanks  </p>\n\n<p>Here is the code  </p>\n\n<pre><code>Sub move()\n\nDim wb As Workbook\nDim MacroFolder As String\nDim MacroWb As String\n\nMacroFolder = \"C:\\Users\\zhill\\Desktop\\macro learn\\\"\nMacroWb = \"IMECM_To_LDW_CSV_Format-20151023-for-2015Q3-for-udf-version-13.0.015.xlsm\"\n\nSet wb = Workbooks.Open(MacroFolder &amp; MacroWb)\n\nwb.Sheets(\"ALFA to Corp CSV\").Cells(13, 2) = ThisWorkbook.Sheets(\"sheet1\").Range(\"IntexFolderList\").Cells(1, 1)\nwb.Sheets(\"ALFA to Corp CSV\").Cells(14, 2) = ThisWorkbook.Sheets(\"sheet1\").Range(\"OutputFolderList\").Cells(1, 1)\nwb.Sheets(\"ALFA to Corp CSV\").Cells(9, 9) = ThisWorkbook.Sheets(\"sheet1\").Range(\"RunNbr\").Cells(1, 1)\n\nwb.Sheets(\"ALFA to Corp CSV\").Application.Run (MacroWb &amp; \"!ALFAtoCorpCsvFormat\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vb.net"], "comments": [{"owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 1, "creation_date": 1535559600, "post_id": 52081821, "comment_id": 91114374, "body": "Re-read my answer to your <a href=\"https://stackoverflow.com/a/51989319/2592875\">last question</a>. <code>PivotTables</code> is a function that returns one of two types.  Select the proper type."}, {"owner": {"reputation": 125, "user_id": 2569203, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/22920fc7e807bab3fddbed4bdcf94a67?s=128&d=identicon&r=PG", "display_name": "Tilting Code", "link": "https://stackoverflow.com/users/2569203/tilting-code"}, "reply_to_user": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 0, "creation_date": 1536341409, "post_id": 52081821, "comment_id": 91403768, "body": "@TnTinMin. I re-read your answer and found the usage and difference between CType &amp; TryCast in the link you provided. After using TryCast it worked as it did not return an error. Thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 2569203, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/22920fc7e807bab3fddbed4bdcf94a67?s=128&d=identicon&r=PG", "display_name": "Tilting Code", "link": "https://stackoverflow.com/users/2569203/tilting-code"}, "is_accepted": true, "score": 0, "last_activity_date": 1536341535, "creation_date": 1536341535, "answer_id": 52227208, "question_id": 52081821, "link": "https://stackoverflow.com/questions/52081821/get-name-of-chart-for-current-pivot-table/52227208#52227208", "title": "Get name of chart for current pivot table", "body": "<p>@TnTinMn pretty much supplied the answer in another question they answered for me. As I mentioned in my last comment using TryCast worked as it did not return an error. </p>\n"}], "owner": {"reputation": 125, "user_id": 2569203, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/22920fc7e807bab3fddbed4bdcf94a67?s=128&d=identicon&r=PG", "display_name": "Tilting Code", "link": "https://stackoverflow.com/users/2569203/tilting-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 52227208, "answer_count": 1, "score": 0, "last_activity_date": 1593761442, "creation_date": 1535558727, "last_edit_date": 1593761442, "question_id": 52081821, "link": "https://stackoverflow.com/questions/52081821/get-name-of-chart-for-current-pivot-table", "title": "Get name of chart for current pivot table", "body": "<p>I have an Excel spreadsheet with four pivot tables and each has a related chart. Using VB.Net I update the Data Source which updates the pivot tables which automatically updates their related charts. All this works great. But now I have to update the title in each chart.</p>\n\n<p>What I think I need to do is access the charts by knowing the name of their related pivot table. </p>\n\n<p>I tried looping through <strong>worksheet.pivotTables</strong> to get each PivotTable name but get an error at the For Each line:</p>\n\n<pre><code>For Each xlPivotTable As Excel.PivotTable In xlWorkSheetShippedSQ.PivotTables\n            strCurrentPivotTable = xlPivotTable.Name\n\nNext\n</code></pre>\n\n<p>At <strong>xlWorkSheetShippedSQ.PivotTables</strong> it displays </p>\n\n<blockquote>\n  <p>implicit conversion from object to ienumerable</p>\n</blockquote>\n\n<p>and wants me to use <code>CType(xlWorkSheetShippedSQ.PivotTables, IEnumerable(Of Excel.PivotTable))</code> but when I do this I get an InvalidCastException. xlWorkSheetShippedSQ is the current worksheet and I've successfully used it in other places.</p>\n\n<p>Is there a way to access each chart to change each name? if so please share how?</p>\n"}, {"tags": ["vba", "bloomberg"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1535559204, "post_id": 52081722, "comment_id": 91114170, "body": "You could try using <code>Application.Wait</code>. Although you&#39;re going to have to include your code if you want help figuring out <i>why</i> this happening."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1535559732, "post_id": 52081722, "comment_id": 91114446, "body": "Possibly answered by <a href=\"https://stackoverflow.com/q/10279404/1531971\">stackoverflow.com/q/10279404/1531971</a> but as suggested we don&#39;t know until we see the code."}, {"owner": {"reputation": 39, "user_id": 10230628, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156869033434172/picture?type=large", "display_name": "Henry Cao", "link": "https://stackoverflow.com/users/10230628/henry-cao"}, "edited": false, "score": 0, "creation_date": 1535561050, "post_id": 52081722, "comment_id": 91115093, "body": "Effectively, I am trying to provide a few seconds of delay for Application.Run &quot;RefreshAllStaticData&quot; to complete before running the next line of code. It is a simple script that involves pulling prices, then copy-and-paste the updated prices to a new sheet in the same workbook, then save and close the workbook. The complete code is: Sub update()  Application.Run &quot;RefreshAllStaticData&quot;  Worksheets(&quot;BB&quot;).Range(&quot;B2:G1000&quot;).Copy Worksheets(&quot;Upload&quot;).Range(&quot;B2&quot;).PasteSpecial Paste:=xlPasteValues  ActiveWorkbook.Save ActiveWorkbook.Close  End Sub"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1535561178, "post_id": 52081722, "comment_id": 91115152, "body": "If <code>RefreshAllStaticData</code> is in the same VBA project you&#39;re coding in, you can invoke it like this: <code>RefreshAllStaticData</code>. No need for <code>Application.Run</code> and stringly-typed method names."}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1535576080, "post_id": 52081722, "comment_id": 91122166, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4298934/vba-waiting-for-bloomberg-bdp-calls-to-finish\">VBA: Waiting for Bloomberg BDP calls to finish</a>"}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1535576106, "post_id": 52081722, "comment_id": 91122177, "body": "@HenryCao you asked the same question yesterday - I suggest you delete one of them."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10230628, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156869033434172/picture?type=large", "display_name": "Henry Cao", "link": "https://stackoverflow.com/users/10230628/henry-cao"}, "edited": false, "score": 0, "creation_date": 1535563493, "post_id": 52082619, "comment_id": 91116387, "body": "How do I find out the code for Application.Run &quot;RefreshAllStaticData&quot;? Bloomberg Excel API is an external Excel API provided by Bloomberg that grabs data provided by Bloomberg."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 39, "user_id": 10230628, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156869033434172/picture?type=large", "display_name": "Henry Cao", "link": "https://stackoverflow.com/users/10230628/henry-cao"}, "edited": false, "score": 0, "creation_date": 1535565788, "post_id": 52082619, "comment_id": 91117534, "body": "&quot;RefreshAllStaticData&quot; has to be a subroutine in your workbook, somewhere."}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1535576057, "post_id": 52082619, "comment_id": 91122155, "body": "You don&#39;t know if it&#39;s going to take 5 or 20 seconds. You should use <code>onTime</code> instead."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1535561877, "creation_date": 1535561877, "answer_id": 52082619, "question_id": 52081722, "link": "https://stackoverflow.com/questions/52081722/vba-how-to-give-excel-time-to-calculate-before-jumping-into-the-next-command/52082619#52082619", "title": "VBA: How to give Excel time to calculate before jumping into the next command?", "body": "<p>Again, we haven't seen all your code (since we don't know what <code>Application.Run \"RefreshAllStaticData\"</code> entails) but this:</p>\n\n<pre><code>Sub update()\n\nApplication.Run \"RefreshAllStaticData\"\n\n'Refresh everything\nActiveWorkbook.RefreshAll\n'Wait 5 seconds just in case\nApplication.Wait (Now + TimeValue(\"00:00:05\"))\n\nWorksheets(\"BB\").Range(\"B2:G1000\").Copy\nWorksheets(\"Upload\").Range(\"B2\").PasteSpecial Paste:=xlPasteValues\n\nActiveWorkbook.Save\nActiveWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10230628, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156869033434172/picture?type=large", "display_name": "Henry Cao", "link": "https://stackoverflow.com/users/10230628/henry-cao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535561877, "creation_date": 1535558385, "last_edit_date": 1535561564, "question_id": 52081722, "link": "https://stackoverflow.com/questions/52081722/vba-how-to-give-excel-time-to-calculate-before-jumping-into-the-next-command", "title": "VBA: How to give Excel time to calculate before jumping into the next command?", "body": "<p>I am using Bloomberg's BDP formula to pull prices, which generally takes about 1-4 seconds. However, VBA runs the next line of codes before the price pull has been completed, resulting in errors. I am wondering if there is a way to tell Excel to take 5 seconds to run:</p>\n\n<p>Application.Run \"RefreshAllStaticData\"</p>\n\n<p>The complete code is: </p>\n\n<pre><code>Sub update()\n\nApplication.Run \"RefreshAllStaticData\"\n\nWorksheets(\"BB\").Range(\"B2:G1000\").Copy\nWorksheets(\"Upload\").Range(\"B2\").PasteSpecial Paste:=xlPasteValues\n\nActiveWorkbook.Save\nActiveWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "rubberduck"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1535557866, "post_id": 52081487, "comment_id": 91113364, "body": "<a href=\"https://rubberduckvba.wordpress.com/2016/02/06/what-do-parsing-and-resolving-mean-anyway/\" rel=\"nofollow noreferrer\">This</a> might help."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1535557983, "post_id": 52081487, "comment_id": 91113441, "body": "@JohnColeman the documentation is rather thin on this subject. OP: what version are you using? The parser/resolver has seen very significant changes lately. You can copy version information to the clipboard by clicking the &quot;version&quot; box in the &quot;about&quot; dialog."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1535558024, "post_id": 52081487, "comment_id": 91113464, "body": "@MathieuGuindon I noticed that hence changed my comment."}, {"owner": {"reputation": 227, "user_id": 9956726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57243f6188efc71d6eb25a13151e6a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Akita", "link": "https://stackoverflow.com/users/9956726/akita"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1535614910, "post_id": 52081487, "comment_id": 91133072, "body": "@MathieuGuindon My version was 2.2.0.3439-pre. I have now installed the 2.2.0.3723-pre, but I still got the same error. Version 2.2.0.3723 OS: Microsoft Windows NT 10.0.16299.0, x64 Host Product: Microsoft Office 2016 x64 Host Version: 16.0.8730.2175 Host Executable: EXCEL.EXE"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1535628203, "post_id": 52081487, "comment_id": 91141607, "body": "Thanks for reporting it! We have hundreds of passing automated tests for the parser &amp; resolver, but it&#39;s hard to cover <i>everything</i> =)"}], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 9956726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57243f6188efc71d6eb25a13151e6a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Akita", "link": "https://stackoverflow.com/users/9956726/akita"}, "edited": false, "score": 0, "creation_date": 1535614964, "post_id": 52081939, "comment_id": 91133104, "body": "Ok, I&#39;m going to open an issue."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 6, "last_activity_date": 1535559144, "creation_date": 1535559144, "answer_id": 52081939, "question_id": 52081487, "link": "https://stackoverflow.com/questions/52081487/rubberduck-vba-what-can-cause-a-resolver-error/52081939#52081939", "title": "Rubberduck VBA: What can cause a Resolver Error?", "body": "<h3>TL;DR: Rubberduck is past due for a new \"official\" release!</h3>\n\n<blockquote>\n  <p>Disclaimer: I manage &amp; contribute to the Rubberduck OSS project.</p>\n</blockquote>\n\n<p>An exception was thrown while traversing the parse trees. It's hard to tell exactly what happened, because parsing+resolving VBA code is a <a href=\"https://rubberduckvba.wordpress.com/2017/07/19/inside-rubberduck-pt-2/\" rel=\"noreferrer\">very complex, multiple-steps process</a>.</p>\n\n<p>To find out specifically what went wrong, you need to look at the logs - logging being disabled by default (it's rather verbose), you need to enable it through the <em>settings</em> dialog:</p>\n\n<p><img src=\"https://i.stack.imgur.com/9Jgqa.png\" alt=\"Rubberduck settings dialog\"></p>\n\n<p>Set the <em>minimum log level</em> to <strong>Trace</strong> for the full gory details of everything the parser/resolver is doing, or <strong>Error</strong> for a less verbose log that only includes the exception information; you can then post this log (or parts of it) into a <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/new\" rel=\"noreferrer\">new issue</a>, and the project devs will promptly tag/label it accordingly, inspect the log/exception details, and determine whether the problem was fixed in a later pre-release build, or if it's a new bug that needs to be fixed.</p>\n\n<p>Since pretty much every single feature needs an accurate understanding of the code in the VBE, Rubberduck devs take parser/resolver issues extremely seriously.</p>\n\n<p>If you're using the latest \"green\" release (v2.2.0), I'm pretty sure the problem was fixed since then. Latest \"pre-release\" build has annoying problems with the <em>autocompletion</em> feature (will definitely be fixed by v2.3.0), but the resolver works very well now :)</p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535704350, "post_id": 52111134, "comment_id": 91173416, "body": "You sure this wasn\u2019t spotted? When you clicked on the x indicating a compile error where did it take you?"}, {"owner": {"reputation": 227, "user_id": 9956726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57243f6188efc71d6eb25a13151e6a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Akita", "link": "https://stackoverflow.com/users/9956726/akita"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535704617, "post_id": 52111134, "comment_id": 91173554, "body": "When I say &quot;not spotted&quot;, I mean &quot;not spotted by me, when running the main sub of the project&quot;. I don&#39;t mean &quot;not spotted by Rubberduck&quot;."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535704778, "post_id": 52111134, "comment_id": 91173617, "body": "Lol. Sorry! My bad."}, {"owner": {"reputation": 227, "user_id": 9956726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57243f6188efc71d6eb25a13151e6a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Akita", "link": "https://stackoverflow.com/users/9956726/akita"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535725949, "post_id": 52111134, "comment_id": 91186209, "body": "I wasn&#39;t super explicit. I updated my answer to make it clearer."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1535731623, "post_id": 52111134, "comment_id": 91189295, "body": "For the record (and the curious): <code>MemberAccessDefaultBinding</code> means Rubberduck was trying to resolve what it parsed as a &quot;member access&quot;, but couldn&#39;t figure out what object the member access was referring to (because of the missing <code>With</code> block) - also, you can manually compile your VBA project at any time, from the &quot;Debug&quot; menu; the VBE would then have highlighted the first unqualified member access causing the compile error. Glad it wasn&#39;t a resolver bug!"}], "tags": [], "owner": {"reputation": 227, "user_id": 9956726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57243f6188efc71d6eb25a13151e6a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Akita", "link": "https://stackoverflow.com/users/9956726/akita"}, "is_accepted": true, "score": 1, "last_activity_date": 1535726063, "last_edit_date": 1535726063, "creation_date": 1535702891, "answer_id": 52111134, "question_id": 52081487, "link": "https://stackoverflow.com/questions/52081487/rubberduck-vba-what-can-cause-a-resolver-error/52111134#52111134", "title": "Rubberduck VBA: What can cause a Resolver Error?", "body": "<p><strong>At least one of the case is the following:</strong> </p>\n\n<p><strong>A Function or Sub doesn't compile and the developer is not aware of that when running the VBA project because the Sub is never called.</strong></p>\n\n<p><strong><em>Solution:</em></strong> </p>\n\n<p><strong>This \"junk\" code can be spotted in <a href=\"https://stackoverflow.com/a/52081939/9956726\">Trace-level logs</a> of Rubberduck.</strong> </p>\n\n<p>For exemple in my case: </p>\n\n<pre><code>Sub CleanSheetOut()\nWorksheets(sheetOut).Range(\"A1:XFD10485576\").Clear\nWorksheets(sheetOut).Range(\"A1:XFD10485576\").Interior\n        .Pattern = xlNone\n       .TintAndShade = 0\n     .PatternTintAndShade = 0\nEnd Sub\n</code></pre>\n\n<p>...was incorrect (didn't compile) but was never called, so the project was running fine but Rubberduck couldn't resolve.</p>\n\n<p>The correct code :</p>\n\n<pre><code>Sub CleanSheetOut()\n   Worksheets(sheetOut).Range(\"A1:XFD10485576\").Clear\n   With Worksheets(sheetOut).Range(\"A1:XFD10485576\").Interior\n      .Pattern = xlNone\n      .TintAndShade = 0\n      .PatternTintAndShade = 0\n   End With\nEnd Sub\n</code></pre>\n\n<p>...compiles and lets Rubberduck parse and resolve normally. </p>\n\n<p>The logs: \n<a href=\"https://i.stack.imgur.com/pkIAP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pkIAP.png\" alt=\"enter image description here\"></a>\n... showed the faulty Sub and in which module I could find it.</p>\n\n<p>Insight from the Rubberduck development team:</p>\n\n<blockquote>\n  <p>Whether the VBE compiles on the fly depends on the compile settings in\n  the bottom right of the Editor tab of the Tools->Options menu.</p>\n  \n  <p>We actually try to compile the project and warn the user that the\n  project does not compile. However, the forementioned VBE settings can\n  interfere with that. Moreover, compilation before refresh might be\n  deactivated in Rubberduck's own settings.</p>\n</blockquote>\n\n<p>See this <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/4323\" rel=\"nofollow noreferrer\">Github thread</a> for more details.</p>\n"}], "owner": {"reputation": 227, "user_id": 9956726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57243f6188efc71d6eb25a13151e6a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Akita", "link": "https://stackoverflow.com/users/9956726/akita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 52111134, "answer_count": 2, "score": 4, "last_activity_date": 1535726063, "creation_date": 1535557660, "last_edit_date": 1535560891, "question_id": 52081487, "link": "https://stackoverflow.com/questions/52081487/rubberduck-vba-what-can-cause-a-resolver-error", "title": "Rubberduck VBA: What can cause a Resolver Error?", "body": "<p>Thank to this question : <a href=\"https://stackoverflow.com/questions/41601588/rubberduck-ui-submenus-are-disabled/41601886#41601886\">Rubberduck UI submenus are disabled</a>, I know that I may have to hit the \"Refresh button\" to use <a href=\"http://rubberduckvba.com/\" rel=\"nofollow noreferrer\">RubberduckVBA</a>.</p>\n\n<p>One of the error that can follow is apparently the \"Resolver Error\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/zpfdn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zpfdn.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>What are the different cases in which such a Resolver Error may occur?</strong></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1535558636, "post_id": 52081695, "comment_id": 91113864, "body": "swapped olApp.ActiveInspector.WordEditor for olApp.ActiveExplorer.ActiveInlineResponseWordEditor and was good to go! Accepted so anyone if future can see !"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1535558303, "creation_date": 1535558303, "answer_id": 52081695, "question_id": 52081165, "link": "https://stackoverflow.com/questions/52081165/inserting-emojis-into-body-of-an-email-popped-out-email-works-ok/52081695#52081695", "title": "Inserting Emojis Into Body of An Email | &quot;popped out&quot; email works OK", "body": "<p>For inline responses, use <code>Explorer.ActiveInlineResponse</code> / <code>ActiveInlineResponseWordEditor</code> properties and <code>Explorer.InlineResponse</code> / <code>InlineResponseClose</code> events.\nTake a look at the objects with <a href=\"http://www.dimastr.com/outspy\" rel=\"nofollow noreferrer\">OutlookSpy</a> to see what is available in the Outlook Object Model.</p>\n"}], "owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 52081695, "answer_count": 1, "score": 0, "last_activity_date": 1592943038, "creation_date": 1535556475, "last_edit_date": 1592943038, "question_id": 52081165, "link": "https://stackoverflow.com/questions/52081165/inserting-emojis-into-body-of-an-email-popped-out-email-works-ok", "title": "Inserting Emojis Into Body of An Email | &quot;popped out&quot; email works OK", "body": "<p>But how do I edit emails being written inside the application itself, aka not \"popped out\"?</p>\n\n<pre><code>Private Sub TransferToEmail(picControl)\nOn Error GoTo Delete\n\n    Dim pictureFilePath As String\n        pictureFilePath = \"Z:\\tempPic\"\n\n    SavePicture picControl.picture, pictureFilePath\n\n    Dim olApp As Outlook.Application\n        Set olApp = GetObject(, \"Outlook.Application\")\n\n    Dim objDoc As Word.Document\n        Set objDoc = olApp.ActiveInspector.WordEditor\n\n    Dim objselect As Word.Selection\n        Set objselect = objDoc.Windows(1).Selection\n\n    objselect.InlineShapes.AddPicture pictureFilePath\nDelete:\n    Dim fso As Object\n        Set fso = CreateObject(\"scripting.filesystemobject\")\n    If fso.fileexists(pictureFilePath) Then fso.deletefile (\"\" &amp; pictureFilePath &amp; \"\")\nEnd Sub\n</code></pre>\n\n<p>This works when I have window popped out, but not when working with new mail items that are \"inside\" of the application itself</p>\n"}, {"tags": ["excel", "vba", "sharepoint"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535561362, "post_id": 52081096, "comment_id": 91115219, "body": "If you inspect the actual workbook connections what do you see after this?"}, {"owner": {"reputation": 141, "user_id": 1765605, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb48937deda99660b8de062f56594bfd?s=128&d=identicon&r=PG", "display_name": "kmypwn", "link": "https://stackoverflow.com/users/1765605/kmypwn"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535563411, "post_id": 52081096, "comment_id": 91116351, "body": "Weirdly, I don&#39;t see any connections... including in the query builder. Or rather, one connection is there, but it doesn&#39;t seem to &quot;contain&quot; anything."}, {"owner": {"reputation": 141, "user_id": 1765605, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb48937deda99660b8de062f56594bfd?s=128&d=identicon&r=PG", "display_name": "kmypwn", "link": "https://stackoverflow.com/users/1765605/kmypwn"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535565200, "post_id": 52081096, "comment_id": 91117270, "body": "When it loops, the connections currently are added to entirely different workbooks! (since you see the dim for a new workbook). In any case, even if I pass in &quot;dog&quot; as the filepath on the first go-round, it still pulls the wrong file, which signals that excel is saving this somewhere that&#39;s persisting through reboots."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11638993, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e733a0cab991be358eff12bbf459e484?s=128&d=identicon&r=PG", "display_name": "Robert Dombroski", "link": "https://stackoverflow.com/users/11638993/robert-dombroski"}, "is_accepted": false, "score": 0, "last_activity_date": 1560370352, "creation_date": 1560370352, "answer_id": 56569719, "question_id": 52081096, "link": "https://stackoverflow.com/questions/52081096/querytables-add-in-vba-adds-same-file-regardless-of-filepath/56569719#56569719", "title": "QueryTables.Add in VBA Adds Same File Regardless Of Filepath", "body": "<p>I realize this questions is pretty old by now but I've not seen a solution to this problem anywhere.  I only seen 2 reference total about this problem.</p>\n\n<p>I had the same problem occur. 2 other examples that I have work fine and I test a third that worked fine too.</p>\n\n<p>My conclusion is the SharePoint list is generating a bad or corrupt .IQY file. I've tried various Exports form my SharePoint list and they all fail. So I don't have a solution for it!  My workaround plan to is Power Query in O365 to access the data from an Excel file.  This avoids the popups the .IQY file has.</p>\n"}], "owner": {"reputation": 141, "user_id": 1765605, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb48937deda99660b8de062f56594bfd?s=128&d=identicon&r=PG", "display_name": "kmypwn", "link": "https://stackoverflow.com/users/1765605/kmypwn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560370352, "creation_date": 1535556259, "question_id": 52081096, "link": "https://stackoverflow.com/questions/52081096/querytables-add-in-vba-adds-same-file-regardless-of-filepath", "title": "QueryTables.Add in VBA Adds Same File Regardless Of Filepath", "body": "<p>Thanks in advance for the help!</p>\n\n<p>In VBA, I'm using the following code to pull in data from an IQY file stored in Sharepoint (Workbooks.Open was not a great option, due to the \"Import Data\" prompt):</p>\n\n<pre><code>Function getIQYWorkbook(ByVal filename As String) As Workbook\nDim wb As Workbook\nSet wb = Workbooks.Add\nDim IQYFile As String\nIQYFile = ThisWorkbook.Path &amp; \"/\" &amp; filename\n\nWith wb.Sheets(\"Sheet1\").QueryTables.Add(Connection:= _\n   \"FINDER;\" &amp; IQYFile, Destination:=Range(\"A1\"))\n\n    .BackgroundQuery = True\n    .TablesOnlyFromHTML = True\n    .Refresh BackgroundQuery:=False\n    .SaveData = True\nEnd With\n\nSet getIQYWorkbook = wb\n\nEnd Function\n</code></pre>\n\n<p>What is so bizzare, though, is that the data that gets pulled in does <em>not</em> correspond to the actual file I pass in. No matter what I pass in, one particular IQY file in the Sharepoint folder is downloaded. Which makes it frustrating, as this function is called in a loop that passes in different filenames. </p>\n\n<p>For instance, when I use the following code (notice me setting the filepath to the word \"dogs\", which is ridiculous), that same sharepoint file is still pulled in. </p>\n\n<pre><code>Function getIQYWorkbook(ByVal filename As String) As Workbook\nDim wb As Workbook\nSet wb = Workbooks.Add\nDim IQYFile As String\nIQYFile = \"dogs\"\n\nWith wb.Sheets(\"Sheet1\").QueryTables.Add(Connection:= _\n   \"FINDER;\" &amp; IQYFile, Destination:=Range(\"A1\"))\n\n    .BackgroundQuery = True\n    .TablesOnlyFromHTML = True\n    .Refresh BackgroundQuery:=False\n    .SaveData = True\nEnd With\n\nSet getIQYWorkbook = wb\n\nEnd Function\n</code></pre>\n\n<p>This has persisted across reboots/closing Excel/etc.... it's as if QueryTables.Add is \"stuck\" in pulling the same file regardless of which filepath I pass in. Any ideas of what's going on?</p>\n\n<p>Thank you so much!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1535556839, "post_id": 52081052, "comment_id": 91112661, "body": "<i>&quot;The problem is that there are some files and folders that don&#39;t appear on the spreadsheet, but still need to be deleted.&quot;</i> And what is particular to those file names? How do you know which you want to delete? Can you give an example?"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1535557866, "post_id": 52081052, "comment_id": 91113363, "body": "So your code works but you want to find another way?"}, {"owner": {"reputation": 19, "user_id": 9805442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807dbd9022b3069a5b4854bfde1f3dfa?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/9805442/dimitri"}, "edited": false, "score": 0, "creation_date": 1535558104, "post_id": 52081052, "comment_id": 91113521, "body": "The code just deletes the files and folders that appear on the spreadsheet."}, {"owner": {"reputation": 19, "user_id": 9805442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807dbd9022b3069a5b4854bfde1f3dfa?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/9805442/dimitri"}, "edited": false, "score": 0, "creation_date": 1535558483, "post_id": 52081052, "comment_id": 91113766, "body": "The first part of the code deletes unnecessary folders called &quot;Extracted Flat files&quot; and &quot;Flat Files&quot; that match the names found on the spreadsheet. If you click on the actual folder, you would see some folders that are still there, because they didn&#39;t appear on the spreadsheet.  The 2nd part of the code deletes specific txt files and doesn&#39;t need any tweeking."}, {"owner": {"reputation": 19, "user_id": 9805442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807dbd9022b3069a5b4854bfde1f3dfa?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/9805442/dimitri"}, "edited": false, "score": 0, "creation_date": 1535560006, "post_id": 52081052, "comment_id": 91114583, "body": "{Const path = &quot;C:\\Users\\NikolouzosD\\Desktop\\Kill_function_test\\Test folder for deleting\\&quot; Set r2 = Cells(2, 1)  Do Until r2 = &quot;&quot; folderpath = path &amp; r2 &amp; &quot;\\&quot; &amp; &quot;Extracted Files&quot;} To be more specific: r2 gets the folder name for each row and pastes it into the path above. Then the code finds this folder and deletes it."}, {"owner": {"reputation": 137, "user_id": 10266800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1k8s6qIs0Os/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM-STS8DsbrkF6qW85WX2cdq7B5JQ/mo/photo.jpg?sz=128", "display_name": "Khalid Saifaldeen", "link": "https://stackoverflow.com/users/10266800/khalid-saifaldeen"}, "edited": false, "score": 0, "creation_date": 1535560267, "post_id": 52081052, "comment_id": 91114715, "body": "@Dimitri So what you want is to delete the folders that exists in C:\\Users\\NikolouzosD\\Desktop\\Kill_function_test\\Test folder for deleting... But are not written in the excel?"}, {"owner": {"reputation": 19, "user_id": 9805442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807dbd9022b3069a5b4854bfde1f3dfa?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/9805442/dimitri"}, "reply_to_user": {"reputation": 137, "user_id": 10266800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1k8s6qIs0Os/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM-STS8DsbrkF6qW85WX2cdq7B5JQ/mo/photo.jpg?sz=128", "display_name": "Khalid Saifaldeen", "link": "https://stackoverflow.com/users/10266800/khalid-saifaldeen"}, "edited": false, "score": 0, "creation_date": 1535622444, "post_id": 52081052, "comment_id": 91137887, "body": "@KhalidSaifaldeen I want to delete the folders tha don&#39;t exist in the Excel Spreadsheet. Yes"}, {"owner": {"reputation": 137, "user_id": 10266800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1k8s6qIs0Os/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM-STS8DsbrkF6qW85WX2cdq7B5JQ/mo/photo.jpg?sz=128", "display_name": "Khalid Saifaldeen", "link": "https://stackoverflow.com/users/10266800/khalid-saifaldeen"}, "edited": false, "score": 0, "creation_date": 1535643366, "post_id": 52081052, "comment_id": 91152247, "body": "@Dimitri So if you want to delete what exists in the excel sheet and delete what does not exists. You want to delete everything?"}, {"owner": {"reputation": 19, "user_id": 9805442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807dbd9022b3069a5b4854bfde1f3dfa?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/9805442/dimitri"}, "reply_to_user": {"reputation": 137, "user_id": 10266800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1k8s6qIs0Os/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM-STS8DsbrkF6qW85WX2cdq7B5JQ/mo/photo.jpg?sz=128", "display_name": "Khalid Saifaldeen", "link": "https://stackoverflow.com/users/10266800/khalid-saifaldeen"}, "edited": false, "score": 0, "creation_date": 1535646717, "post_id": 52081052, "comment_id": 91154270, "body": "@KhalidSaifaldeen exactly."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9805442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807dbd9022b3069a5b4854bfde1f3dfa?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/9805442/dimitri"}, "edited": false, "score": 0, "creation_date": 1535713467, "post_id": 52105450, "comment_id": 91178529, "body": "brilliant! It works like a charm.  Thank you very much for your help. :)"}], "tags": [], "owner": {"reputation": 137, "user_id": 10266800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1k8s6qIs0Os/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM-STS8DsbrkF6qW85WX2cdq7B5JQ/mo/photo.jpg?sz=128", "display_name": "Khalid Saifaldeen", "link": "https://stackoverflow.com/users/10266800/khalid-saifaldeen"}, "is_accepted": false, "score": 0, "last_activity_date": 1535663628, "creation_date": 1535663628, "answer_id": 52105450, "question_id": 52081052, "link": "https://stackoverflow.com/questions/52081052/delete-files-in-a-folder-that-are-not-found-in-excel-spreadsheet/52105450#52105450", "title": "Delete files in a folder that are not found in Excel Spreadsheet", "body": "<p>Try the code below. I used the <code>Dir()</code> command/function. This allows you to obtain all the folder/files that exists in a path. </p>\n\n<pre><code>Sub DeleteSpecificFilesAndFolders()\n\n'This module deletes Extracted Files folders, Flat Files folders and Final Flat Files (.txt format)\n\nConst path = \"C:\\Users\\N\\Desktop\\Kill_function_test\\Test folder for deleting\\\"\n\nDim r As Range\nDim folderpath As String\nDim folderpath_1 As String\nDim FolderName As String \n\nDim fso As FileSystemObject\nSet fso = New Scripting.FileSystemObject\n\nFolderName=Dir(Path &amp; \"*\", vbDirectory)\n\nWhile FolderName &lt;&gt; \"\"\n\nif Not FolderName like \"*.*\" then  'This is because when using Dir(,vbdirectory) you can get . and .. or if files exist\n\n  folderpath = path &amp; FolderName &amp; \"\\\" &amp; \"Extracted Files\"\n\n\n  'Checks if the folder exists and then deletes it.\n  If fso.FolderExists(folderpath) Then\n\n      fso.DeleteFolder (folderpath)\n\n  End If\n\n\n  'Checks if the folder exists and then deletes it\n  folderpath_1 = path &amp; FolderName &amp; \"\\\" &amp; \"Flat Files\"\n\n  If fso.FolderExists(folderpath_1) Then\n\n      fso.DeleteFolder (folderpath_1)\n\n  End If\n\nend if\n\nFolderName=Dir() 'This will set FolderName to the next folder \n\nDoEvents\nwend\n\n'Loops through and deletes the \"INACTIVE\" Final Flat Files (.txt)\nSet r = Cells(1, 5)\n\nDo Until r = \"\"\n    If UCase(r.Value) = \"INACTIVE\" Then\n        'Checks if the extracted flat file exists.\n        If Dir(path &amp; r.Offset(0, -4) &amp; \"\\\" &amp; \"Final Flat Files\" &amp; \"\\\" &amp; r.Offset(0, 1) &amp; \".txt\") &lt;&gt; \"\" Then\n            Kill path &amp; r.Offset(0, -4) &amp; \"\\\" &amp; \"Final Flat Files\" &amp; \"\\\" &amp; r.Offset(0, 1) &amp; \".txt\"\n        End If\n    End If\n    Set r = r.Offset(1, 0)\nLoop\nEnd Sub\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 19, "user_id": 9805442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807dbd9022b3069a5b4854bfde1f3dfa?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/9805442/dimitri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 490, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536493990, "creation_date": 1535556100, "question_id": 52081052, "link": "https://stackoverflow.com/questions/52081052/delete-files-in-a-folder-that-are-not-found-in-excel-spreadsheet", "title": "Delete files in a folder that are not found in Excel Spreadsheet", "body": "<p>I developed a code that loops through files and folders' names found in an Excel Spreadsheet, finds them in a folder and deletes them.</p>\n\n<p>The problem is that there are some files and folders that don't appear on the spreadsheet, but still need to be deleted.\nMy goal is to have more free space.</p>\n\n<p>Someone suggested i copied the folder list into another column, match the file names and then delete the ones that don't match.</p>\n\n<p>I'd prefer automation, though.\nAny suggestions?</p>\n\n<p>Thanks in advance!</p>\n\n<p>Code:</p>\n\n<pre><code>Sub DeleteSpecificFilesAndFolders()\n\n'This module deletes Extracted Files folders, Flat Files folders and Final Flat Files (.txt format)\n\nConst path = \"C:\\Users\\N\\Desktop\\Kill_function_test\\Test folder for deleting\\\"\n\nDim r As Range\nDim r2 As Range\nDim folderpath As String\nDim folderpath_1 As String\n\nDim fso As FileSystemObject\nSet fso = New Scripting.FileSystemObject\n\n\n\nSet r2 = Cells(2, 1)\n\nDo Until r2 = \"\"\n\n\nfolderpath = path &amp; r2 &amp; \"\\\" &amp; \"Extracted Files\"\n\n\n'Checks if the folder exists and then deletes it.\nIf fso.FolderExists(folderpath) Then\n\n    fso.DeleteFolder (folderpath)\n\nEnd If\n\n\n'Checks if the folder exists and then deletes it\nfolderpath_1 = path &amp; r2 &amp; \"\\\" &amp; \"Flat Files\"\n\nIf fso.FolderExists(folderpath_1) Then\n\n    fso.DeleteFolder (folderpath_1)\n\nEnd If\n\nSet r2 = r2.Offset(1, 0)\n\nDoEvents\nLoop\n\n'Loops through and deletes the \"INACTIVE\" Final Flat Files (.txt)\nSet r = Cells(1, 5)\n\nDo Until r = \"\"\n    If UCase(r.Value) = \"INACTIVE\" Then\n        'Checks if the extracted flat file exists.\n        If Dir(path &amp; r.Offset(0, -4) &amp; \"\\\" &amp; \"Final Flat Files\" &amp; \"\\\" &amp; r.Offset(0, 1) &amp; \".txt\") &lt;&gt; \"\" Then\n            Kill path &amp; r.Offset(0, -4) &amp; \"\\\" &amp; \"Final Flat Files\" &amp; \"\\\" &amp; r.Offset(0, 1) &amp; \".txt\"\n        End If\n    End If\n    Set r = r.Offset(1, 0)\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["json", "excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1535557467, "post_id": 52081017, "comment_id": 91113086, "body": "I don&#39;t know anything about JSON, but have you already extracted this data to Excel? Are you just trying to extract from the file into Excel? Where is the file location, where is the destination for your values, how big is the file... There are too many questions here and not enough specifics."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1535568314, "last_edit_date": 1535568314, "creation_date": 1535558856, "answer_id": 52081854, "question_id": 52081017, "link": "https://stackoverflow.com/questions/52081017/write-partial-data-using-vba/52081854#52081854", "title": "Write partial data using VBA", "body": "<p>If it is a JSON file you can read as follows and empty into sheet</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim strJSON As String, json As Object, rowNumber As Long\n    Application.ScreenUpdating = False\n    Const PATH As String = \"C:\\Users\\User\\Desktop\\test.JSON\"\n    strJSON = GetJSONFromFile(PATH)\n    Set json = JsonConverter.ParseJson(strJSON)\n    Set json = json(\"widget\")(\"text\")\n    Dim key As Variant\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        For Each key In json\n            rowNumber = rowNumber + 1\n            .Cells(rowNumber, 1) = key\n            .Cells(rowNumber, 2) = json(key)\n        Next key\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n\nPublic Function GetJSONFromFile(ByVal PATH As String) As String\n    Dim fso As Object, f As Object, outputString As String\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set f = fso.OpenTextFile(PATH)\n\n    Do Until f.AtEndOfStream\n        outputString = f.ReadAll()\n    Loop\n    f.Close\n\n    GetJSONFromFile = outputString\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>If you inspect the JSON you can see the the top level dictionary has a key <code>\"widget\"</code> which gives access to inner dictionaries. One of these has the key <code>\"text\"</code>; that is the one you are after and can be accessed with the syntax</p>\n\n<pre><code>Set json = json(\"widget\")(\"text\")\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/zMXb9.png\" width=\"300\"></p>\n\n<hr>\n\n<p>You could shorten the sub code at the top to:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim strJSON As String, json As Object, rowNumber As Long\n    Application.ScreenUpdating = False\n    Const PATH As String = \"C:\\Users\\HarrisQ\\Desktop\\test.JSON\"\n    strJSON = GetJSONFromFile(PATH)\n    Set json = JsonConverter.ParseJson(strJSON)\n    Set json = json(\"widget\")(\"text\")\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        .Cells(1, 1).Resize(json.Count) = Application.WorksheetFunction.Transpose(json.keys)\n        .Cells(1, 2).Resize(json.Count) = Application.WorksheetFunction.Transpose(json.Items)\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10260675, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iu0OesSbMWw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNv8vbpm2RrV1w2EiQB-ole_1WbLA/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10260675/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 52081854, "answer_count": 1, "score": 1, "last_activity_date": 1549346776, "creation_date": 1535556001, "last_edit_date": 1549346776, "question_id": 52081017, "link": "https://stackoverflow.com/questions/52081017/write-partial-data-using-vba", "title": "Write partial data using VBA", "body": "<p>I have a large JSON file but the information I need is only a small part of it. Is there any way I can extract the part I want and write to an Excel sheet instead of writing the whole file? Please see the following example. I only want to extract the \"text\" part</p>\n\n<pre><code>{\"widget\": {\n    \"debug\": \"on\",\n    \"window\": {\n        \"title\": \"Sample Konfabulator Widget\",\n        \"name\": \"main_window\",\n        \"width\": 500,\n        \"height\": 500\n    },\n    \"image\": { \n        \"src\": \"Images/Sun.png\",\n        \"name\": \"sun1\",\n        \"hOffset\": 250,\n        \"vOffset\": 250,\n        \"alignment\": \"center\"\n    },\n    \"text\": {\n        \"data\": \"Click Here\",\n        \"size\": 36,\n        \"style\": \"bold\",\n        \"name\": \"text1\",\n        \"hOffset\": 250,\n        \"vOffset\": 100,\n        \"alignment\": \"center\",\n        \"onMouseUp\": \"sun1.opacity = (sun1.opacity / 100) * 90;\"\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1323, "user_id": 6826479, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kFsmmJsA9cU/AAAAAAAAAAI/AAAAAAAAAkQ/fgsvbyNstTE/photo.jpg?sz=128", "display_name": "Jaime Drq", "link": "https://stackoverflow.com/users/6826479/jaime-drq"}, "edited": false, "score": 0, "creation_date": 1535556197, "post_id": 52081016, "comment_id": 91112225, "body": "I am not an expert on access sql, but that where... INTO looks weird to me"}, {"owner": {"reputation": 47, "user_id": 9974427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ced26ded25f623500f7ffabf3f6d712?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/9974427/lisa"}, "reply_to_user": {"reputation": 1323, "user_id": 6826479, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kFsmmJsA9cU/AAAAAAAAAAI/AAAAAAAAAkQ/fgsvbyNstTE/photo.jpg?sz=128", "display_name": "Jaime Drq", "link": "https://stackoverflow.com/users/6826479/jaime-drq"}, "edited": false, "score": 0, "creation_date": 1535558072, "post_id": 52081016, "comment_id": 91113494, "body": "I agree, but I adapted this from <a href=\"https://stackoverflow.com/questions/35950796/ms-access-vba-issue\">stackoverflow.com/questions/35950796/ms-access-vba-issue</a>"}, {"owner": {"reputation": 47, "user_id": 9974427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ced26ded25f623500f7ffabf3f6d712?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/9974427/lisa"}, "reply_to_user": {"reputation": 1323, "user_id": 6826479, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kFsmmJsA9cU/AAAAAAAAAAI/AAAAAAAAAkQ/fgsvbyNstTE/photo.jpg?sz=128", "display_name": "Jaime Drq", "link": "https://stackoverflow.com/users/6826479/jaime-drq"}, "edited": false, "score": 0, "creation_date": 1535563336, "post_id": 52081016, "comment_id": 91116308, "body": "Pictures added, so hopefully that helps!"}, {"owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "edited": false, "score": 0, "creation_date": 1535615938, "post_id": 52081016, "comment_id": 91133733, "body": "Your sql string doesnt work that way. You have two options for an INSERT INTO. <code>INSERT INTO TargetTable (Field1, Field2) SELECT SourceColumn1, SourceColumn2 FROM SourceTable WHERE ID = 67</code> or <code>INSERT INTO TargetTable (Field1, Field2) VALUES (ValueForField1, ValueForField2)</code> And then if you want to make it variable for strings you have <code>...VALUES (&#39;&quot; &amp; StringVariable &amp; &quot;&#39;, ValueForField2)</code> or as number <code>...VALUES (&quot; &amp; NumberVariable &amp; &quot;, ValueForField2)</code>"}, {"owner": {"reputation": 47, "user_id": 9974427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ced26ded25f623500f7ffabf3f6d712?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/9974427/lisa"}, "edited": false, "score": 0, "creation_date": 1535625735, "post_id": 52081016, "comment_id": 91140029, "body": "I modified to match your example closer, but I am still getting syntax error. Is this only going to work when I have a specific form open (have to specify each field for the value to insert)? Or can I do this dynamically in VBA for all relational tables at once? Here is my updated SQL: <code>strSQL = &quot;INSERT INTO Report_Start as r (r.Report_ID, r.Report_Date, r.Vendor, r.Buyer, r.MRPC, r.SQE, rMEP) WHERE (((r.Report_ID) = (&#39;&quot; &amp; OldID &amp; &quot;&#39;) VALUES (&#39;&quot; &amp; NewID &amp; &quot;&#39;, #&quot; &amp; NewDate &amp; &quot;#, r.Vendor, r.Buyer, r.MRPC, r.SQE r.MEP)&quot;</code>  I assume I can&#39;t use a WHERE statement to specify which record to copy?"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9974427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ced26ded25f623500f7ffabf3f6d712?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/9974427/lisa"}, "edited": false, "score": 0, "creation_date": 1535634394, "post_id": 52097714, "comment_id": 91145987, "body": "I corrected some syntax and had to add the field names to the INSERT INTO portion, but this works! Updated SQL is <code>strSQL = &quot;INSERT INTO Report_Start (Report_ID, Report_Date, Vendor, Buyer, MRPC, SQE, MEP) SELECT &#39;&quot; &amp; NewID &amp; &quot;&#39;, #&quot; &amp; NewDate &amp; &quot;#, r.Vendor, r.Buyer, r.MRPC, r.SQE, r.MEP FROM  Report_Start as r WHERE r.Report_ID = &#39;&quot; &amp; OldID &amp; &quot;&#39;;&quot;</code>. THANK YOU! I am going to make an attempt to add to this to update the relational tables now."}], "tags": [], "owner": {"reputation": 1868, "user_id": 1359794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f7dfa7ac7d032d1a0d71bfffffb803?s=128&d=identicon&r=PG", "display_name": "Zaider", "link": "https://stackoverflow.com/users/1359794/zaider"}, "is_accepted": true, "score": 2, "last_activity_date": 1535633901, "creation_date": 1535633901, "answer_id": 52097714, "question_id": 52081016, "link": "https://stackoverflow.com/questions/52081016/duplicate-records-in-all-related-access-tables-with-new-pk-fk-assigned-at-button/52097714#52097714", "title": "Duplicate records in all related Access tables with new PK/FK assigned at button click event", "body": "<p>You can perform and insert into with a select and where like this:</p>\n\n<pre><code>strSQL = \"INSERT INTO Report_Start \" &amp; _\n         \" SELECT \" &amp; newID &amp; \", #\" &amp; newDate &amp; \"#, r.Vendor, r.Buyer, r.MRPC, r.SQE, r.MEP\" &amp; _\n         \" FROM  Report Start as r \" &amp; _\n         \" WHERE r.Report_ID = \" &amp; oldID\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9974427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ced26ded25f623500f7ffabf3f6d712?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/9974427/lisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 52097714, "answer_count": 1, "score": 0, "last_activity_date": 1594629788, "creation_date": 1535556000, "last_edit_date": 1594629788, "question_id": 52081016, "link": "https://stackoverflow.com/questions/52081016/duplicate-records-in-all-related-access-tables-with-new-pk-fk-assigned-at-button", "title": "Duplicate records in all related Access tables with new PK/FK assigned at button click event", "body": "<p>I have an Access database with 5 tables:</p>\n\n<ol>\n<li><p>Report_Start holds PK on [Report_ID]</p></li>\n<li><p>CommSummary holds FK on [Report_ID]</p></li>\n<li><p>MRPCSummary holds FK on [Report_ID]</p></li>\n<li><p>SQESummary holds FK on [Report_ID]</p></li>\n<li><p>MEPSummary holds FK on [Report_ID]</p></li>\n</ol>\n\n<p>Report_ID links tables 2-4 to Table 1.\n<a href=\"https://i.stack.imgur.com/agcIN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/agcIN.jpg\" alt=\"relations\"></a></p>\n\n<p>User enters new report info on a user form (Report Date, Vendor, buyer, planner, etc), which is stored in Report_Start table. At different times, different users use different forms to populate tables 2-4, and all data is linked by [Report_ID], which is the report date and vendor name concatenated together.</p>\n\n<p>I added a button on the start-up form that needs to allow the user to duplicate existing data from all 5 tables and assign a new Report_ID and new Report_Date.  This is needed because the users only have one or two fields to update each time we report out on the vendor status.  They want to copy the old record to a new one and then make their one or two updates.  (I already have forms and code that allows the existing records to be updated from each table.)\n<a href=\"https://i.stack.imgur.com/U5otD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U5otD.jpg\" alt=\"copy button\"></a></p>\n\n<p>The new Report_ID and Report_Date will be generated by the user selecting from a dialog window:</p>\n\n<p>a) Existing report date (Me.Cbo_OldDate)</p>\n\n<p>b) Vendor (Me.Cbo_Vendor)</p>\n\n<p>c) New report date (Me.Txt_NewDate)\n<a href=\"https://i.stack.imgur.com/9bIEt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9bIEt.jpg\" alt=\"new data\"></a></p>\n\n<p>After several days of research, I found a SQL statement that was close to what I wanted to accomplish, but I am getting syntax errors.  And I am only trying to duplicate in the #1 table above to prove out my code before attacking the relational tables 2-5.</p>\n\n<p>My code so far:</p>\n\n<p>Start-up Form (user clicks on COPY RECORD button):</p>\n\n<pre><code>Private Sub Cmd_Copy_Click()\n\nDoCmd.OpenForm \"New_Data\", acNormal, , , , acDialog\n\nEnd Sub\n</code></pre>\n\n<p>New_Data form where user selects existing report info and new report date:</p>\n\n<pre><code>Private Sub Cmd_OK_Click()\n\nDim OldID As String\nDim NewID As String\nDim NewDate As Date\nDim strSQL As String\n\n\n    OldID = Me.Cbo_OldDate &amp; Me.Cbo_Vendor\n    NewID = Me.Txt_NewDate &amp; Me.Cbo_Vendor\n\n    NewDate = Me.Txt_NewDate\n\n    Me.Txt_Old_ID = OldID\n    Me.Txt_New_ID = NewID\n\nstrSQL = \"SELECT r.Report_ID, r.Report_Date, r.Vendor, r.Buyer, r.MRPC, r.SQE, r.MEP WHERE (((r.Report_ID) = ('\" &amp; OldID &amp; \"') INTO Report_Start as r WHERE (((r.Report_ID) = '\" &amp; NewID &amp; \"' and ((r.Report_Date) = (#\" &amp; NewDate &amp; \"#)));\"\n\nCurrentDb.Execute strSQL, dbFailOnError\n\nEnd Sub\n</code></pre>\n\n<p>The error I am getting is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/genaE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/genaE.jpg\" alt=\"error\"></a></p>\n\n<p>If someone can help me determine where the error is, and then give me some guidance on how to duplicate the information in the relational tables and assign the new FK equal to the new PK, I would GREATLY appreciate it!  I do not want to have each user open their individual form to duplicate only their data.  </p>\n\n<p>Lastly, due to the relationships between the tables, I want one button to duplicate all, and then each user can look up their info by date and provide their updates.</p>\n"}, {"tags": ["excel", "vba", "outlook", "character"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1535556741, "post_id": 52080937, "comment_id": 91112599, "body": "You might take a look at <a href=\"https://stackoverflow.com/q/22542834/4088852\">using a regular expression</a> instead."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10290627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be295b5e1f41003da79b5c0ca9dd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/10290627/grzegorz"}, "edited": false, "score": 0, "creation_date": 1535613894, "post_id": 52081069, "comment_id": 91132466, "body": "Ok, big thanks for You it&#39;s working only for numbers, but what if: numerek = &quot;RDY1012JG101&quot; It can&#39;t read my &quot;RDY&quot; and &quot;JG&quot;  and it read only &quot;1012101&quot; what should I do?"}, {"owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "reply_to_user": {"reputation": 5, "user_id": 10290627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be295b5e1f41003da79b5c0ca9dd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/10290627/grzegorz"}, "edited": false, "score": 0, "creation_date": 1535637284, "post_id": 52081069, "comment_id": 91148056, "body": "@Grzegorz <a href=\"https://stackoverflow.com/questions/15723672/how-to-remove-all-non-alphanumeric-characters-from-a-string-except-period-and-sp\" title=\"how to remove all non alphanumeric characters from a string except period and sp\">stackoverflow.com/questions/15723672/&hellip;</a> maybe try this solution?"}, {"owner": {"reputation": 5, "user_id": 10290627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be295b5e1f41003da79b5c0ca9dd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/10290627/grzegorz"}, "edited": false, "score": 0, "creation_date": 1535717568, "post_id": 52081069, "comment_id": 91180877, "body": "@PGCodeRider Thanks for answer, it&#39;s working and I clicked the green check, thank you one more time ;)"}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 1, "last_activity_date": 1535825877, "last_edit_date": 1535825877, "creation_date": 1535556161, "answer_id": 52081069, "question_id": 52080937, "link": "https://stackoverflow.com/questions/52080937/delete-unwanted-characters/52081069#52081069", "title": "Delete unwanted characters", "body": "<p><strong>UPDATED based on clarified requirements of not truly wanting \"numeric\"</strong></p>\n\n<p>The below function allows you to list out exactly what characters you want to include in <code>numerek</code>. I filled in a couple letters for you to get you started. You could also try to leverage the character number, but it would probably take more time to research than to just type them out. Don't forget upper/lower case.</p>\n\n<p><strong>Sample results:</strong>\n<code>=fixerThing(\"12 3b   \")</code> = <code>\"123b\"</code></p>\n\n<pre><code>Function fixerThing(inputValue As String) As String\nDim i As Long, theCharacter As String\n\nFor i = 1 To Len(inputValue)\n\n    theCharacter = Mid(inputValue, i, 1)\n\n    Select Case theCharacter\n        Case \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"0\", \"a\", \"b\", \"c\", \"d\", _\n         \"e\", \"f\" 'you can type out the rest.\n            fixerThing = fixerThing &amp; theCharacter\n\n    End Select\n\nNext i\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10290627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be295b5e1f41003da79b5c0ca9dd7346?s=128&d=identicon&r=PG&f=1", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/10290627/grzegorz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 52081069, "answer_count": 1, "score": 0, "last_activity_date": 1535825877, "creation_date": 1535555742, "question_id": 52080937, "link": "https://stackoverflow.com/questions/52080937/delete-unwanted-characters", "title": "Delete unwanted characters", "body": "<p>I have a little issue with unwanted characters at the end of number. I mean \"numerek\". There is no blank space, because function Replace work and it is no help. I tried use function Trim, but still no help for me. For example \"numerek\" = \"1121123123\" and it is 13 characters for VBA, but there is no space and exactly we can see that there is 10 characters! When I use MsgBox (numerek) it gives \"1121123123   \" . How can I delete this \"   \" characters, when I know that it is no blank space? This program has to give me all number without \"blank space\" but it is not blank space. I'm using it in Outlook VBA. Please help :)</p>\n\n<pre><code>Dim MyOlNamespace As NameSpace\nDim MySelectedItem As MailItem\nDim Response As String\nDim fso As Object, TmpFolder As Object\nDim tmpFileName As String\nDim wrdApp As Object\nDim wrdDoc As Object\nDim bStarted As Boolean\nDim dlgSaveAs As FileDialog\nDim fdfs As FileDialogFilters\nDim fdf As FileDialogFilter\nDim i As Integer\nDim WshShell As Object\nDim SpecialPath As String\nDim msgFileName As String\nDim strCurrentFile As String\nDim strName As String\nDim oRegEx As Object\nDim intPos As Long\nDim itm As Outlook.MailItem\nDim currentExplorer As Explorer\nDim Selection As Selection\n\nDim objAtt As Outlook.Attachment\nDim saveFolder As String\nDim oldName\n\nDim file As String\nDim DateFormat As String\nDim newName As String\nDim numerek As String\nDim tytul_maila\n\nDim enviro As String\n\n'Set currentExplorer = Application.ActiveExplorer\n'Set Selection = currentExplorer.Selection\n\nSet MyOlNamespace = Application.GetNamespace(\"MAPI\")\nSet MySelectedItem = ActiveExplorer.Selection.Item(1)\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nserwer = \"C:\\Users\\GZ76576\\Documents\\\"\n\nIf InStr(MySelectedItem.Body, \"faktury/rachunku\") &gt; 0 Then\nwiersz = InStr(MySelectedItem.Body, \"faktury/rachunku\")\nwiersz_koniec = InStr(MySelectedItem.Body, \"Data wp\u0142ywu\")\n    If wiersz_koniec &gt; wiersz Then\n\nnumerek = Mid(MySelectedItem.Body, wiersz + 20, wiersz_koniec - wiersz - 24)\nnumerek = Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(numerek, \":\", \"\"), \"/\", \"\"), \"-\", \"\"), \"*\", \"\"), \"\\\", \"\"), \" \", \"\"), \" \", \"\"), \"    \", \"\"), \"|\", \"\"), \" \", \"\"), \"_\", \"\")\n\n\nEnd If\nEnd If\n\nnrfaktury = InputBox(\"Wpisz numer\" &amp; vbNewLine &amp; vbNewLine &amp; \"Zachowaj format\" &amp; vbNewLine &amp; vbNewLine &amp; \"PRZYKLAD\", , numerek)\n\nIf nrfaktury = \"\" Then\nExit Sub\nEnd If\n...\n</code></pre>\n"}, {"tags": ["vba", "autocad", "qgis"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1535575384, "post_id": 52080924, "comment_id": 91121879, "body": "Actually impossible to help you with such little data/info from you: you may want to give more explanations and show your code till now"}, {"owner": {"reputation": 1, "user_id": 10290725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d94b55d47b43cc9cac2c27f4f654df?s=128&d=identicon&r=PG&f=1", "display_name": "M.J", "link": "https://stackoverflow.com/users/10290725/m-j"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1535617725, "post_id": 52080924, "comment_id": 91134770, "body": "Sub draw_polyline1() Dim lineobj As AcadLine Dim entite As AcadEntity Dim ptd As Variant Dim pta As Variant  ThisDrawing.Utility.GetEntity entite, ptClique, &quot;select the path to follow&quot;  ptd = ThisDrawing.Utility.GetPoint(, &quot;select the start point&quot;) pta = ThisDrawing.Utility.GetPoint(, &quot;select the end point&quot;)  Set lineobj = ThisDrawing.ModelSpace.AddPolyline(entite, ptd, pta)  ZoomExtents  End Sub"}, {"owner": {"reputation": 1, "user_id": 10290725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d94b55d47b43cc9cac2c27f4f654df?s=128&d=identicon&r=PG&f=1", "display_name": "M.J", "link": "https://stackoverflow.com/users/10290725/m-j"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1535617779, "post_id": 52080924, "comment_id": 91134807, "body": "this code just draw a polyline between the two points but doesn&#39;t follow the path"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1536721055, "post_id": 52080924, "comment_id": 91521638, "body": "a polyline, unlike a basic line, can consist of multiple points.  It is my understanding that you will need to provide each coordinate that the polyline will need to pass through.  In addition, if some portions of the path are curved, you will need to define curved segments of the polyline.  I am still working that part out for myself when I get the opportunity so I cant help you much more than cover the concept."}], "answers": [{"tags": [], "owner": {"reputation": 1022, "user_id": 5796526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/90cyo.jpg?s=128&g=1", "display_name": "CAD Developer", "link": "https://stackoverflow.com/users/5796526/cad-developer"}, "is_accepted": false, "score": 0, "last_activity_date": 1536839657, "creation_date": 1536839657, "answer_id": 52313185, "question_id": 52080924, "link": "https://stackoverflow.com/questions/52080924/vba-autocad-drawing-polyline-from-two-given-points-and-following-a-specific-pat/52313185#52313185", "title": "VBA AutoCAD: drawing polyline from two given points and following a specific path", "body": "<p>I think the easiest way is to clone the path You want to follow, and \"cut\" endings outside clicked point. To cut, You may use command _break, then check which one of the new curves have the start point, end point on selected points.</p>\n"}], "owner": {"reputation": 1, "user_id": 10290725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d94b55d47b43cc9cac2c27f4f654df?s=128&d=identicon&r=PG&f=1", "display_name": "M.J", "link": "https://stackoverflow.com/users/10290725/m-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 866, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537012876, "creation_date": 1535555692, "last_edit_date": 1537012876, "question_id": 52080924, "link": "https://stackoverflow.com/questions/52080924/vba-autocad-drawing-polyline-from-two-given-points-and-following-a-specific-pat", "title": "VBA AutoCAD: drawing polyline from two given points and following a specific path", "body": "<p>I'm trying to draw a polyline from two given points and following a specific path (another polyline) otherwise the 2 polylines will be superimposed with VBA AutoCAD or qgis</p>\n\n<p><a href=\"https://i.stack.imgur.com/9Q4Ae.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9Q4Ae.png\" alt=\"screenshot\"></a></p>\n\n<pre><code>Sub draw_polyline1()\n    Dim lineobj As AcadLine\n    Dim entite As AcadEntity \n    Dim ptd As Variant\n    Dim pta As Variant\n\n    ThisDrawing.Utility.GetEntity entite, ptClique, \"select the path to follow\" \n    ptd = ThisDrawing.Utility.GetPoint(, \"select the start point\")\n    pta = ThisDrawing.Utility.GetPoint(, \"select the end point\")\n    Set lineobj = ThisDrawing.ModelSpace.AddPolyline(entite, ptd, pta) \n    ZoomExtents \nEnd Sub\n</code></pre>\n\n<p>The blue line is the path and the red one is the polyline that I want to draw automatically between the 2 points(the stars in the schema)</p>\n"}, {"tags": ["excel", "vba", "parsing", "fixed-width"], "comments": [{"owner": {"reputation": 84, "user_id": 7489442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b58c475359a809cffe9ba487dd8c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Srijan", "link": "https://stackoverflow.com/users/7489442/srijan"}, "edited": false, "score": 0, "creation_date": 1535555696, "post_id": 52080811, "comment_id": 91111894, "body": "in Array - The first element is the column number (position), and the second element is based on format of that column."}, {"owner": {"reputation": 5, "user_id": 10177126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6175cd29571ecb126045f041cb0391b?s=128&d=identicon&r=PG&f=1", "display_name": "Benji Kenobi", "link": "https://stackoverflow.com/users/10177126/benji-kenobi"}, "reply_to_user": {"reputation": 84, "user_id": 7489442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b58c475359a809cffe9ba487dd8c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Srijan", "link": "https://stackoverflow.com/users/7489442/srijan"}, "edited": false, "score": 0, "creation_date": 1535555908, "post_id": 52080811, "comment_id": 91112030, "body": "Do you know how I can use the default parameters excel chooses when I go into the text column wizard and choose fixed width, in a macro?"}, {"owner": {"reputation": 5, "user_id": 10177126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6175cd29571ecb126045f041cb0391b?s=128&d=identicon&r=PG&f=1", "display_name": "Benji Kenobi", "link": "https://stackoverflow.com/users/10177126/benji-kenobi"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535556965, "post_id": 52080811, "comment_id": 91112760, "body": "@BigBen Just edited it. The code itself doesn&#39;t really matter just trying to see if what I am asking is even possible."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1535557565, "post_id": 52080811, "comment_id": 91113162, "body": "Here is a attempt to write something to figure out the defaults  &gt;&gt; <a href=\"http://dailydoseofexcel.com/archives/2013/05/08/importing-fixed-width-text-files/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2013/05/08/&hellip;</a>   and it seems they gave up in the end"}, {"owner": {"reputation": 5, "user_id": 10177126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6175cd29571ecb126045f041cb0391b?s=128&d=identicon&r=PG&f=1", "display_name": "Benji Kenobi", "link": "https://stackoverflow.com/users/10177126/benji-kenobi"}, "edited": false, "score": 0, "creation_date": 1535562959, "post_id": 52080811, "comment_id": 91116084, "body": "Thanks Pablo the link was informative. Looks like I need to find another solution."}], "owner": {"reputation": 5, "user_id": 10177126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6175cd29571ecb126045f041cb0391b?s=128&d=identicon&r=PG&f=1", "display_name": "Benji Kenobi", "link": "https://stackoverflow.com/users/10177126/benji-kenobi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1755, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535556892, "creation_date": 1535555323, "last_edit_date": 1535556892, "question_id": 52080811, "link": "https://stackoverflow.com/questions/52080811/automate-text-to-columns-with-the-fixed-width-setting", "title": "Automate Text to Columns with the Fixed Width setting?", "body": "<p>I am trying to automate the text to columns feature in Excel. I want to use the default settings Excel chooses in the Fixed Width setting, because it always chooses the correct breaks with my particular datasets. When I record a macro for 2 different sheets that need to be parsed, and I choose the default fixed width setting, the macros look very different in terms of Array arguments. I figure there must be some way to just use Excel's default selection for array arguments, but can't seem to figure it out! Thanks in advance!</p>\n\n<p>Macro1:</p>\n\n<pre><code>Sub Macro1()\n'\n' -Macro1 Macro\n\nRange(\"B10:B46\").Select\nSelection.TextToColumns Destination:=Range(\"B10\"), DataType:=xlFixedWidth, _\n    FieldInfo:=Array(Array(0, 1), Array(47, 1), Array(65, 1), Array(71, 1), \nArray(90, 1), _\n    Array(95, 1), Array(113, 1), Array(126, 1)), TrailingMinusNumbers:=True\nActiveWindow.SmallScroll Down:=-12\nEnd Sub\n</code></pre>\n\n<p>Macro2:</p>\n\n<pre><code>Sub Macro2()\n' Macro2 Macro\n\nRange(\"B8:B46\").Select\nSelection.TextToColumns Destination:=Range(\"B8\"), DataType:=xlFixedWidth, _\n    FieldInfo:=Array(Array(0, 1), Array(53, 1), Array(78, 1), Array(101, 1), \nArray(119, 1) _\n    , Array(134, 1)), TrailingMinusNumbers:=True\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1535557018, "post_id": 52080775, "comment_id": 91112806, "body": "<i>How</i> is the region defined in Sheet2?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1535632545, "post_id": 52080775, "comment_id": 91144611, "body": "100 000 000 lines ? Is that Excel 2024 ?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1535632757, "post_id": 52080775, "comment_id": 91144772, "body": "You should really use <code>Option Explicit</code> and I doubt that <code>ThisWorkbook.Sheets(&quot;Sheet2&quot;).Range(BU).CurrentRegion </code> does even work."}, {"owner": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535635490, "post_id": 52080775, "comment_id": 91146737, "body": "No! That one doesn&#39;t work. The only code that work is the second one that i added to my question."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535627427, "post_id": 52080849, "comment_id": 91141124, "body": "Thanks, It works. The problem is that 1 - it replaces values, and i want it to skip cells with values; 2 - It doesn&#39;t continue to next row."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535635639, "post_id": 52080849, "comment_id": 91146848, "body": "@jps17183 you can put in an if statement, which would take care of that issue.  Will edit"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535635892, "post_id": 52080849, "comment_id": 91147022, "body": "@jps17183 note that the loop is for row i, col j, and loops FIRST through the columns of a single row, then moves to the next row, hence the j loop is inside the i loop."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1535635840, "last_edit_date": 1535635840, "creation_date": 1535555437, "answer_id": 52080849, "question_id": 52080775, "link": "https://stackoverflow.com/questions/52080775/fill-empty-blank-cells-with-value-within-a-region-horizontaly-defined/52080849#52080849", "title": "Fill Empty Blank Cells with value within a region horizontaly defined", "body": "<p>Try using cells() references, such as:</p>\n\n<pre><code>For i = cells(1,\"BU\").Column to cells(1,\"CQ\").Column\n    cells(1,i).value = \"Moo\"\nNext i\n</code></pre>\n\n<p>In your current code you list <em>Range(BU)</em> which is not appropriate syntax.  Note that Range() can be used for named ranges, e.g., Range(\"TheseCells\"), but the actual cell references are written as Range(\"A1\"), etc.  For Cell(), you would use Cells(row,col).</p>\n\n<hr>\n\n<p><strong>Edit1</strong></p>\n\n<p>With if statement, with second loop:</p>\n\n<pre><code>Dim i as long, j as long, lr as long\nlr = cells(rows.count,1).end(xlup).row\nFor i = 2 to lr 'assumes headers in row 1\n    For j = cells(1,\"BU\").Column to cells(1,\"CQ\").Column\n        If cells(i,j).value = \"\" then cells(i,j).value = \"Moo\"\n    Next j\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "reply_to_user": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535625168, "post_id": 52082956, "comment_id": 91139712, "body": "@jps17183 AFAIK, comments dont support writing actual code."}, {"owner": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535627500, "post_id": 52082956, "comment_id": 91141165, "body": "It doesn&#39;t even do nothing (not even an error). Its inocuous. But thanks anyway."}, {"owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "reply_to_user": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535631212, "post_id": 52082956, "comment_id": 91143693, "body": "@jps17183 Well, that definitely is an English error (should be &#39;doesn&#39;t do <i>anything</i>&#39;), but I digress. I changed my answer to something that works."}, {"owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "reply_to_user": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535636441, "post_id": 52082956, "comment_id": 91147426, "body": "@jps17183 If the height is dependent upon column A&#39;s height, then that&#39;s easily done. Just give me a minute."}, {"owner": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535637296, "post_id": 52082956, "comment_id": 91148068, "body": "Thanks for the reply but what do you mean by &quot;file max height&quot;? Is it the max height of the table with values or the last row of the sheet? The row limit varies according to the length of column A with non-empty rows (consecutive values)... Collumn A always starts in the 2nd row and continues through an n-number of rows down (variable). Do you have any idea by the way? How can i make the routine last as long as the number of rows &quot;n&quot; defined by collumns A?"}, {"owner": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535637504, "post_id": 52082956, "comment_id": 91148208, "body": "I know it is supposed to work but I got an error &quot;object required&quot;. It stopped at --&gt;      Set MyRange = testWS.Range(&quot;BU:CQ&quot;)   . Equivalent to your   Set MyRange = testWS.Range(&quot;P:W&quot;)  PS: Sorry for my English"}, {"owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "reply_to_user": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535638109, "post_id": 52082956, "comment_id": 91148672, "body": "@jps17183 Don&#39;t worry about the English; I thought you were a native English speaker being a smartass lol.  <code>testWS</code> is the global worksheet variable on my worksheet. Just set your worksheet using <code>Set ws = Excel.Application.ThisWorkbook.Worksheets(YourWorksheetName)</code> and then you can set the range using <code>Set MyRange = ws.Range(&quot;P:W&quot;)</code>. Again, you&#39;ll need to change the range to the one <i>you</i> actually need instead of P:Q."}, {"owner": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535639343, "post_id": 52082956, "comment_id": 91149565, "body": "Forget it! It was the word &quot;test&quot; it&#39;s not doing anything before the word &quot;WS&quot;. However it works, it doesn&#39;t function within the range &quot;BU:CQ&quot; (even after i adapt your interval to mine &quot;P:W&quot; ---&gt; &quot;BU:CQ&quot;). Mysteriously, it rather works within the interval &quot;A:AS&quot; Do you know why?"}, {"owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "reply_to_user": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535640324, "post_id": 52082956, "comment_id": 91150273, "body": "Did you change <code>offsetLen = .Range(&quot;A:P&quot;).Columns.Count - 1</code> to <code>offsetLen = .Range(&quot;A:BU&quot;).Columns.Count - 1</code>?"}, {"owner": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 0, "creation_date": 1535640987, "post_id": 52082956, "comment_id": 91150728, "body": "No I didn&#39;t! Now i realized i didn&#39;t understood the syntax. IT WORKED!! But the &quot;prize will go to Patrick Honorez because his code is much faster and more efficient. But you rock man... Thanks"}], "tags": [], "owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "is_accepted": false, "score": 0, "last_activity_date": 1535640238, "last_edit_date": 1535640238, "creation_date": 1535563058, "answer_id": 52082956, "question_id": 52080775, "link": "https://stackoverflow.com/questions/52080775/fill-empty-blank-cells-with-value-within-a-region-horizontaly-defined/52082956#52082956", "title": "Fill Empty Blank Cells with value within a region horizontaly defined", "body": "<p>First off, you should reference the worksheet you're working with using:</p>\n\n<pre><code>Set ws = Excel.Application.ThisWorkbook.Worksheets(MyWorksheetName)\n</code></pre>\n\n<p>Otherwise VBA is going to choose the worksheet for you, and it may or may not be the worksheet you want to work with.</p>\n\n<p>And then use it to specify ranges on specific worksheets such as <code>ws.Range</code> or <code>ws.Cells</code>. This is a much better method for specifying which worksheet you're working on.</p>\n\n<p>Now for your question:</p>\n\n<p>I would reference the range using the following syntax:</p>\n\n<pre><code>Dim MyRange As Range\nSet MyRange = ws.Range(\"BU:CQ\")\n</code></pre>\n\n<p>I would iterate through the range like so:</p>\n\n<p><strong>Edit:</strong> I tested this and it works. Obviously you will want to change the range and worksheet reference; I assume you're competent enough to do this yourself. I didn't make a variable for my worksheet because another way to reference a worksheet is to use the worksheet's (Name) property in the property window, which you can set to whatever you want; this is a free, global variable.</p>\n\n<p>Where I defined testWS in the properties window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0g5c8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0g5c8.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Public Sub test()\n    Dim MyRange As Range\n    Dim tblHeight As Long\n    Dim tblLength As Long\n    Dim offsetLen As Long\n    Dim i As Long\n    Dim j As Long\n\n    With testWS\n        'set this this to your \"BU:CQ\" range\n        Set MyRange = .Range(\"P:W\")\n        'set this to \"A:BU\" to get the offset from A to BU\n        offsetLen = .Range(\"A:P\").Columns.Count - 1\n        'set this to your \"A\" range\n        tblHeight = .Range(\"P\" &amp; .Rows.Count).End(xlUp).Row\n        tblLength = MyRange.Columns.Count\n    End With\n\n    'iterate through the number of rows\n    For i = 1 To tblHeight\n        'iterate through the number of columns\n        For j = 1 To tblLength\n            If IsEmpty(testWS.Cells(i, offsetLen + j).Value) Then\n                testWS.Cells(i, offsetLen + j).Value = 0\n            End If\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/57kJY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/57kJY.png\" alt=\"enter image description here\"></a></p>\n\n<p>After (I stopped it early, so it didn't go through all the rows in the file):</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZWrye.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZWrye.png\" alt=\"enter image description here\"></a></p>\n\n<p>If there's a better way to do this, then let me know.</p>\n"}, {"comments": [{"owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "reply_to_user": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "edited": false, "score": 1, "creation_date": 1535640817, "post_id": 52096987, "comment_id": 91150613, "body": "@PatrickHonorez I would consider changing the <code>.UsedRange</code> to <code>.Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row</code> since @jps17183 specified the A column is non-sparse and <code>.UsedRange</code> isn&#39;t as reliable to use when the data is non-sparse."}, {"owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "edited": false, "score": 0, "creation_date": 1535640890, "post_id": 52096987, "comment_id": 91150655, "body": "@PatrickHonorez <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\" title=\"error in finding last used cell in vba\">stackoverflow.com/questions/11169445/&hellip;</a>"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "edited": false, "score": 1, "creation_date": 1535641148, "post_id": 52096987, "comment_id": 91150832, "body": "@jcrizk you&#39;re perfectly right. It&#39;s just I am a bit lazy and sometimes I leave it to the OP to make a synthesis and pick the best parts of the proposed answers ;-) My goal with usedRange here was just to avoid filling the whole column."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 1, "last_activity_date": 1535633922, "last_edit_date": 1535633922, "creation_date": 1535631784, "answer_id": 52096987, "question_id": 52080775, "link": "https://stackoverflow.com/questions/52080775/fill-empty-blank-cells-with-value-within-a-region-horizontaly-defined/52096987#52096987", "title": "Fill Empty Blank Cells with value within a region horizontaly defined", "body": "<p>Use SpecialsCells:</p>\n\n<pre><code>On Error Resume Next  'for the case the range would be all filled\nWith ws\n    Intersect(.UsedRange, .Range(\"BU:CQ\")).SpecialCells(xlCellTypeBlanks).Value = 0\nEnd With\nOn Error GoTo 0\n</code></pre>\n\n<p>MUCH faster than looping !</p>\n"}], "owner": {"reputation": 133, "user_id": 9726176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd85ef149e2049219d6998a4d21fc37?s=128&d=identicon&r=PG&f=1", "display_name": "jps17183", "link": "https://stackoverflow.com/users/9726176/jps17183"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 52096987, "answer_count": 3, "score": -1, "last_activity_date": 1535640238, "creation_date": 1535555220, "last_edit_date": 1535620372, "question_id": 52080775, "link": "https://stackoverflow.com/questions/52080775/fill-empty-blank-cells-with-value-within-a-region-horizontaly-defined", "title": "Fill Empty Blank Cells with value within a region horizontaly defined", "body": "<p>I'm trying to fill blank cells in a certain region with <code>0</code>. The reagion should be defined in the current workbook but in sheet2 (not the current sheet). Also the place where it is supposed to fill is between columns \nBU:CQ in the current region (not all 100 000 000 lines). Just the number of lines that define the table between columns BU and CQ. I know the problem lies in defining the region... See the code below.\nWhat is missing?</p>\n\n<pre><code>Sub FillEmptyBlankCellWithValue()\n    Dim cell As Range\n    Dim InputValue As String\n\n    On Error Resume Next\n    InputValue = \"0\"\n    For Each cell In ThisWorkbook.Sheets(\"Sheet2\").Range(BU).CurrentRegion\n      '.Cells(Rows.Count, 2).End(xlUp).Row\n      If IsEmpty(cell) Then\n        cell.Value = InputValue\n      End If\n    Next\n End Sub\n</code></pre>\n\n<p>I've this code that i'm positive that works! But i don't wnat selection! I want somthing that specifies the sheet and a fixed range.\nNow my idea is to replace \"selection\" with the desired range. - In this case in particular the range should be 1 - between BU:CQ; 2 - starting at row 2; 3 - working the way down until last row (not empty = end of the table that goes from column A to DE)</p>\n\n<pre><code> Sub FillEmptyBlankCellWithValue()\n     Dim cell As Range\n     Dim InputValue As String\n     On Error Resume Next\n     For Each cell In Selection\n        If IsEmpty(cell) Then\n           cell.Value = \"0\"\n        End If\n     Next\n End Sub'\n</code></pre>\n\n<p>PS: And I also need to specify the sheet, since the button that will execute the code will be in the same workbook but not in the same sheet.</p>\n"}, {"tags": ["vba", "delphi", "com"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1535555544, "post_id": 52080187, "comment_id": 91111794, "body": "Shouldn&#39;t <code>ILCCAMQM_Project*</code> be <code>[out, retval]</code> instead of the return type? That looks to me like <code>OpenProject</code> should return an <code>HRESULT</code>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1535572034, "post_id": 52080187, "comment_id": 91120351, "body": "In the IDL, yes.  You must use an <code>[out, retval]</code> parameter with an <code>HRESULT</code> return value: <code>HRESULT _stdcall OpenProject([in] BSTR aFolderOrAlias, [out,retval] ILCCAMQM_Project** Result);</code>. In the Delphi code, declare <code>OpenProject()</code> as <code>safecall</code> with an <code>ILCCAMQM_Project</code> return value and no output parameter: <code>function OpenProject(const aFolderOrAlias: WideString): ILCCAMQM_Project; safecall;</code> Let <code>OpenProject()</code> raise exceptions without catching them, <code>safecall</code> will convert it to an <code>HRESULT</code> and populate <code>GetErrorInfo()</code> with the exception details.  Same with <code>Connected()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 892, "user_id": 3057591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a03c39a96bfa62ae1879fe3cde83389?s=128&d=identicon&r=PG", "display_name": "H.Hasenack", "link": "https://stackoverflow.com/users/3057591/h-hasenack"}, "edited": false, "score": 0, "creation_date": 1535638358, "post_id": 52096460, "comment_id": 91148839, "body": "As it turned out, my propertieds being unaccessible was caused by my class being derived of tAutoIntfObject rather than TAutoObject, so that&#39;s cleared too now."}], "tags": [], "owner": {"reputation": 892, "user_id": 3057591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a03c39a96bfa62ae1879fe3cde83389?s=128&d=identicon&r=PG", "display_name": "H.Hasenack", "link": "https://stackoverflow.com/users/3057591/h-hasenack"}, "is_accepted": true, "score": 0, "last_activity_date": 1536008044, "last_edit_date": 1536008044, "creation_date": 1535630134, "answer_id": 52096460, "question_id": 52080187, "link": "https://stackoverflow.com/questions/52080187/unable-to-pass-a-string-from-vba-excel-to-my-com-object/52096460#52096460", "title": "Unable to pass a string from VBA (Excel) to my COM object", "body": "<p>As it turned out, ComIntern and Remy were right. I had completely misunderstood the whole <code>stdcall</code> and <code>safecall</code> interfaces.</p>\n\n<p>The .ridl file now looks like this:</p>\n\n<pre><code>....\n  interface ILCCAMQM_Application: IDispatch\n  {\n    [id(0x000000C9)]\n    int _stdcall Connect(void);\n    [id(0x000000CA)]\n    int _stdcall Disconnect(void);\n    [propget, id(0x000000CC)]\n    HRESULT _stdcall Connected([out, retval] VARIANT_BOOL* Value);\n    [id(0x000000CB)]\n    HRESULT _stdcall OpenProject([in] BSTR aFolderOrAlias, [out, retval] ILCCAMQM_Project** Value);\n  };\n....\n</code></pre>\n\n<p>And the generated ...TLB.pas file looks like this:</p>\n\n<pre><code>....\n// *********************************************************************//\n// Interface: ILCCAMQM_Application\n// Flags:     (4416) Dual OleAutomation Dispatchable\n// GUID:      {EDD8E7FC-5D96-49F1-ADB7-F04EE9FED7B5}\n// *********************************************************************//\n  ILCCAMQM_Application = interface(IDispatch)\n    ['{EDD8E7FC-5D96-49F1-ADB7-F04EE9FED7B5}']\n    function Connect: SYSINT; stdcall;\n    function Disconnect: SYSINT; stdcall;\n    function Get_Connected: WordBool; safecall;\n    function OpenProject(const aFolderOrAlias: WideString): ILCCAMQM_Project; safecall;\n    property Connected: WordBool read Get_Connected;\n  end;\n\n// *********************************************************************//\n// DispIntf:  ILCCAMQM_ApplicationDisp\n// Flags:     (4416) Dual OleAutomation Dispatchable\n// GUID:      {EDD8E7FC-5D96-49F1-ADB7-F04EE9FED7B5}\n// *********************************************************************//\n  ILCCAMQM_ApplicationDisp = dispinterface\n    ['{EDD8E7FC-5D96-49F1-ADB7-F04EE9FED7B5}']\n    function Connect: SYSINT; dispid 201;\n    function Disconnect: SYSINT; dispid 202;\n    property Connected: WordBool readonly dispid 204;\n    function OpenProject(const aFolderOrAlias: WideString): ILCCAMQM_Project; dispid 203;\n  end;\n....\n</code></pre>\n\n<p>And the OpenProject now works from my internal unit test (written in delphi) as well as from Excel-VBA.</p>\n\n<p>Now I am struggling with properties to set and get through Excel VBA as well as through an OleVariant in delphi. But I will have to put that in <a href=\"https://stackoverflow.com/questions/52114727/what-interface-to-i-need-to-implement-to-allow-foreach-in-vba-on-a-com-object-wr\">another Q</a>.</p>\n"}], "owner": {"reputation": 892, "user_id": 3057591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a03c39a96bfa62ae1879fe3cde83389?s=128&d=identicon&r=PG", "display_name": "H.Hasenack", "link": "https://stackoverflow.com/users/3057591/h-hasenack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 52096460, "answer_count": 1, "score": 2, "last_activity_date": 1536008044, "creation_date": 1535553553, "last_edit_date": 1535571837, "question_id": 52080187, "link": "https://stackoverflow.com/questions/52080187/unable-to-pass-a-string-from-vba-excel-to-my-com-object", "title": "Unable to pass a string from VBA (Excel) to my COM object", "body": "<p>I am experimenting with creating a COM interface for my application in order to allow eg. VBA to drive certain parts of my application.</p>\n\n<p>I have my COM library up and running and installed, even to the part where a routine called in Excel can be debugged in the Delphi IDE.</p>\n\n<p>Here's the VBA code that I activate from Excel using a button:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub TestAMQMOLE_OpenProject()\n  Dim vConnection As String\n  Dim vAMQM As Object\n  Dim vAMProject As Object\n\n  vConnection = \"$(MYSRC)\\LCCAMQM38\\UnitTestData\\AnalyseSortingAndGrouping\"\n  Set vAMQM = CreateObject(\"LCCAMQM_AX.LCCAMQM_Application\")\n  vAMQM.Connect\n  Set vAMQMProject = vAMQM.OpenProject(vConnection) 'This parameter does not get through\n  Set vAMQMProject.Active = True\n  Set vAMQMProject = Nothing\n\n\n  vAMQM.Disconnect\n  Set vAMQM = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>And the part in Delphi handling it looks like this:</p>\n\n<pre class=\"lang-pascal prettyprint-override\"><code>function TLCCAMQM_Application.OpenProject(const aFolderOrAlias: WideString): ILCCAMQM_Project;\nbegin\n  try\n    Result:=TLCCAMQM_Project.Create(aFolderOrAlias); // wrapper om TdmAMEditBase\n  except\n    SHowMessage(ExceptionToString(ExceptObject,ExceptAddr));\n  end;\nend;\n</code></pre>\n\n<p>Where the code fails because the <code>aFolderOrAlias</code> parameter string is empty. I added the exception handler in order to debug outside the Delphi IDE. when debugging inside the IDE, the parameter string indeed appears as empty.</p>\n\n<p>I have also tried to pass the parameter as a <code>Variant</code>, or <code>const Variant</code> (and adjusting the type library accordingly), but in that case I get a <code>VT_RECORD</code> variant type (0x0024) which does not make any sense to me.</p>\n\n<p>Here is what the interface definition of the type library looks like.</p>\n\n<pre><code>....\n [\n    uuid(EDD8E7FC-5D96-49F1-ADB7-F04EE9FED7B5),\n    helpstring(\"Dispatch interface for LCCAMQM_Application Object\"),\n    dual,\n    oleautomation\n  ]\n  interface ILCCAMQM_Application: IDispatch\n  {\n    [id(0x000000C9)]\n    int _stdcall Connect(void);\n    [id(0x000000CA)]\n    int _stdcall Disconnect(void);\n    [id(0x000000CB)]\n    ILCCAMQM_Project* _stdcall OpenProject([in] BSTR aFolderOrAlias);\n    [propget, id(0x000000CC)]\n    HRESULT _stdcall Connected([out, retval] VARIANT_BOOL* Value);\n  };\n\n  [\n    uuid(590DBF46-76C9-4877-8F47-5A926AFF389F),\n    helpstring(\"LCCAMQM_Application Object\")\n  ]\n  coclass LCCAMQM_Application\n  {\n    [default] interface ILCCAMQM_Application;\n  };\n....\n</code></pre>\n\n<p>I am fairly sure there must be a way to pass strings from VBA to COM objects. But after fiddling around for several hours I am lost :s.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 6, "creation_date": 1535553132, "post_id": 52079954, "comment_id": 91109957, "body": "<code>Workbook_Change</code> or <code>Worksheet_Change</code>? <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.worksheet.chan&zwnj;&#8203;ge</a> Also, you shouldn&#39;t <code>Set OutlookApp = Nothing</code> within your <code>For Each</code> loop, but outside it. Are you missing a closing <code>End If</code> as well, or is it just not included in this snippet?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535553825, "post_id": 52079954, "comment_id": 91110445, "body": "Thank you @BigBen sorry it should be Worksheet_Change and i have taken out the Set OutlookApp = Nothing from the loop.  I definitely need more caffeine this morning :).  Also i noticed that CustName Reference is grabbing the info from the last cell with &quot;Bob&quot;  in the RgCell range when i thought it would grab the value from the cell in Column B that was adjacent to the cell that went from null to &quot;BoB&quot;.  Would you have any guidance on that issue as well?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1535554229, "post_id": 52079954, "comment_id": 91110728, "body": "If you want <code>custName</code> to reference the cell in column B that is adjacent to a cell in column C with the value of &quot;Bob&quot;, then <code>Offset</code> is the way to go. Also, did you mean to loop <code>For Each cell In RgCell</code> or <code>For Each cell in RgSel</code> (which btw, not sure why you have <code>Set RgSel = Nothing</code> within the loop either)."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535554701, "post_id": 52079954, "comment_id": 91111116, "body": "I changed RgCell to RgSel and it now works as expected and I removed the three lines that  set values to =Nothing.  Also please forgive my ignorance in designating code items in comments as I am still learning how everything works  in here.  Thank you again @BigBen for your guidance and assistance.  I really appreciate it."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1535556626, "post_id": 52079954, "comment_id": 91112516, "body": "@ZackE Welcome Zack - for future reference, no need to make comments saying how you&#39;ve redacted the real information - that&#39;s very common around here and none of us would ever expect you (or anyone) to use the real emails/information. In fact, sometimes we&#39;ll remove it purposefully to maintain user confidentiality."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1535563436, "post_id": 52079954, "comment_id": 91116360, "body": "Thanks @dwirony.  That is good to know."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1535556426, "creation_date": 1535556426, "answer_id": 52081150, "question_id": 52079954, "link": "https://stackoverflow.com/questions/52079954/sending-email-based-on-name-in-a-cell/52081150#52081150", "title": "Sending Email based on name in a cell", "body": "<p>I think you've intended to use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\"><code>Worksheet_Change</code></a> event but have <code>Private Sub Workbook_Change...</code> instead.</p>\n\n<p>Additional issues:</p>\n\n<ul>\n<li><code>For Each cell In RgCell</code> should probably be <code>For Each cell in RgSel</code>, or <code>For Each cell in Target</code> - otherwise the code runs through each cell in <code>C2:C100</code>, and not just the cell(s) changed, or <code>Target</code>.</li>\n<li>There is no need to <code>Set RgSel = Nothing</code></li>\n<li>With <code>Set MItem = OutlookApp.CreateItem(0)</code>, you create an email message <em>before</em> you've checked <code>If cell.Value = \"Bob\"</code>. Move this line <em>within</em> the <code>If</code> statement.</li>\n<li><code>Set OutlookApp = Nothing</code> should be <em>outside</em> the <code>For Each</code> loop, i.e. it should be done <em>after</em> you've finished looping.</li>\n<li><code>On Error GoTo NX</code>, and then <code>NX: Resume Next</code>, is equivalent to <code>On Error Resume Next</code>, which doesn't handle any errors, but rather ignores them. </li>\n<li>You may be missing a closing <code>End If</code>, or it is not included in this snippet.</li>\n</ul>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 52081150, "answer_count": 1, "score": 0, "last_activity_date": 1535556426, "creation_date": 1535552962, "question_id": 52079954, "link": "https://stackoverflow.com/questions/52079954/sending-email-based-on-name-in-a-cell", "title": "Sending Email based on name in a cell", "body": "<p>I have looked through multiple posts to send an email if a value in a range of cells changes and adapted the code I found in those posts to suit my needs, but for some reason the email is not being sent when the value in any cell of the range defined changes, and I am a little lost at why.  Any guidance is greatly appreciated.  Please see code below (please note that for confidentiality purposes the emails and names are fake).</p>\n\n<pre><code>Private Sub Workbook_Change(ByVal Target As Range)\n'   Uses early binding\n'   Requires a reference to the Outlook Object Library\n    Dim RgSel As Range, RgCell As Range\n    Dim OutlookApp As Object, MItem As Object\n    Dim Subj As String, EmailAddr As String, Recipient As String\n    Dim CustName As String, Msg As String\n    Dim pEmail As String\n\n    On Error GoTo NX\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Set RgCell = Range(\"C2:C100\")\n    Set RgSel = Intersect(Target, RgCell)\n\n    If Not RgSel Is Nothing Then\n        Set OutlookApp = CreateObject(\"Outlook.Application\")\n        Set MItem = OutlookApp.CreateItem(0)\n            For Each cell In RgCell\n                If cell.Value = \"Bob\" Then                      'Fake Name for posting question\n                    pEmail = \"BobT@SomethingBlahBlahBlah.com\"   'Fake email address used for posting question\n                    CustName = cell.Offset(0, -1).Value\n                    Subj = \"***NEW ITEM ASSIGNED***\" &amp; \" - \" &amp; UCase(CustName)\n                    Recipient = \"Bob T. Builder\"                'Fake name for posting question\n                    EmailAddr = pEmail\n\n                '   Compose Message\n                    Msg = \"Dear, \" &amp; Recipient &amp; vbCrLf &amp; vbCrLf\n                    Msg = Msg &amp; \"I have assigned \" &amp; CustName &amp; \"'s\" &amp; \" item to you.\" &amp; vbCrLf\n                    Msg = Msg &amp; \"Please review the information in their customer folder in the L: Drive.\" &amp; vbCrLf &amp; vbCrLf\n                    Msg = Msg &amp; \"Sincerely,\" &amp; vbCrLf &amp; vbCrLf &amp; vbCrLf\n                    Msg = Msg &amp; \"Bob's Boss\" &amp; vbCrLf           'Fake name for posting question\n                    Msg = Msg &amp; \"Vice President\"\n\n                '   Create Mail Item and send\n                    With MItem\n                        .to = EmailAddr\n                        .Subject = Subj\n                        .body = Msg\n                        .Save   'This will change to .send after testing is complete\n                    End With\n                    Set RgSel = Nothing\n                    Set OutlookApp = Nothing\n                    Set MItem = Nothing\n                End If\n\n            Next cell\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\nNX:\n    Resume Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 9078057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba2501f267e5133e981e8860e485f9bc?s=128&d=identicon&r=PG", "display_name": "user9078057", "link": "https://stackoverflow.com/users/9078057/user9078057"}, "edited": false, "score": 0, "creation_date": 1535619769, "post_id": 52080417, "comment_id": 91136050, "body": "I&#39;m sure you need to declare a value for j too"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1535554210, "creation_date": 1535554210, "answer_id": 52080417, "question_id": 52079924, "link": "https://stackoverflow.com/questions/52079924/how-to-program-a-userform-based-on-selections-of-markets-using-listbox/52080417#52080417", "title": "How to program a UserForm Based on Selections of Markets using ListBox", "body": "<p>There are plenty of examples online. Here is a basic example which puts selected items in A1 (and down) of sheet1.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim i As Long, j As Long\n\nFor i = 0 To ListBox1.ListCount - 1\n    If ListBox1.Selected(i) Then\n        j = j + 1\n        Sheet1.Cells(j, 1).Value = ListBox1.List(i)\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 9078057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba2501f267e5133e981e8860e485f9bc?s=128&d=identicon&r=PG", "display_name": "user9078057", "link": "https://stackoverflow.com/users/9078057/user9078057"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 52080417, "answer_count": 1, "score": -1, "last_activity_date": 1535554210, "creation_date": 1535552909, "question_id": 52079924, "link": "https://stackoverflow.com/questions/52079924/how-to-program-a-userform-based-on-selections-of-markets-using-listbox", "title": "How to program a UserForm Based on Selections of Markets using ListBox", "body": "<p>I have created the following UserForm:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2itGU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2itGU.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The underlying Subs that were created are: </p>\n\n<pre><code>Private Sub ListBox1_Click()\n\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n\nEnd Sub\n</code></pre>\n\n<p>What I basically wanted to do was: Selecting the relevant markets and on that basis entering those exchanges that were selected into separate cells in a listed format on the active sheet. </p>\n\n<p>A process example in short: Selects Xetra, Xontro and Euronext --> Clicks OK --> populates A1 to A3 with the above mentioned names.</p>\n\n<p>I would send my ideas but since I am relatively new in VBA and do not know how to take values out of a ListBox and then use them in a Sub. Any help would be greatly appreciated...</p>\n"}, {"tags": ["vba", "automation", "vlookup"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535554910, "post_id": 52079838, "comment_id": 91111273, "body": "<code>&quot;I want to input in some cells of the tool (which is an Excel file) the parameters for the VLookup&quot;</code> I&#39;m not sure I understand what you mean by this?"}, {"owner": {"reputation": 15, "user_id": 9745215, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qr8M9355hsU/AAAAAAAAAAI/AAAAAAAAAAg/h55K8wcWg1o/photo.jpg?sz=128", "display_name": "MYPE", "link": "https://stackoverflow.com/users/9745215/mype"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535555091, "post_id": 52079838, "comment_id": 91111405, "body": "It means : in the cell D4, input the position of  Key Column , in cell D5 input the Position of &quot;Returned Value&quot; Column ... thanks @Marcucciboy2"}, {"owner": {"reputation": 15, "user_id": 9745215, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qr8M9355hsU/AAAAAAAAAAI/AAAAAAAAAAg/h55K8wcWg1o/photo.jpg?sz=128", "display_name": "MYPE", "link": "https://stackoverflow.com/users/9745215/mype"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535555233, "post_id": 52079838, "comment_id": 91111526, "body": "@Marcucciboy2 I can send you the tool if you want, but I didn&#39;t figure how to attach the excel file to this Post... :("}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535555330, "post_id": 52079838, "comment_id": 91111608, "body": "You&#39;re better off not attaching anything - I know I dont click on external links and if someone wants to reference this in the future link rot is a serious problem :)"}, {"owner": {"reputation": 15, "user_id": 9745215, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qr8M9355hsU/AAAAAAAAAAI/AAAAAAAAAAg/h55K8wcWg1o/photo.jpg?sz=128", "display_name": "MYPE", "link": "https://stackoverflow.com/users/9745215/mype"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535555439, "post_id": 52079838, "comment_id": 91111709, "body": "ok @Marcucciboy2, thanks for the advice"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1535555320, "last_edit_date": 1535555320, "creation_date": 1535553570, "answer_id": 52080189, "question_id": 52079838, "link": "https://stackoverflow.com/questions/52079838/automated-tool-for-vlook-up/52080189#52080189", "title": "Automated tool for VLOOK UP", "body": "<p>I'm not well versed in <code>R1C1</code> notation, but if you were using regular <code>.Formula</code> notation:</p>\n\n<p>The following code assumes that <code>A1</code> = Key column, <code>A2</code> = Returned value column, <code>A3</code> = Number of columns in the range (which is really just your return column).</p>\n\n<p><code>lastrow = 10</code> just for the example</p>\n\n<p>Also note - you must be missing a field... since you should have 4 variables - key column for first parameter, 2 column letters for second parameter, and the number of columns for 3rd parameter.</p>\n\n<pre><code>Sub Test()\n\nlastrow = 10\n\nFor myrow = 3 To lastrow\n\n    'Range(\"B\" &amp; myrow).Formula = \"=VLOOKUP(\" &amp; Range(\"A1\").Value &amp; myrow &amp; \",Input!$\" &amp; Range(\"A1\").Value &amp; \":$\" &amp; Range(\"A2\").Value &amp; \",\" &amp; Range(\"A3\").Value &amp; \",FALSE)\"\n    Debug.Print \"=VLOOKUP(\" &amp; Range(\"A1\").Value &amp; myrow &amp; \",Input!$\" &amp; Range(\"A1\").Value &amp; \":$\" &amp; Range(\"A2\").Value &amp; \",\" &amp; Range(\"A3\").Value &amp; \",FALSE)\"\n\nNext myrow\n\nEnd Sub\n</code></pre>\n\n<p>Values on <code>ActiveSheet</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9STxn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9STxn.png\" alt=\"img1\"></a></p>\n\n<p>Immediate window returns:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rBa0f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rBa0f.png\" alt=\"img2\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 9745215, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qr8M9355hsU/AAAAAAAAAAI/AAAAAAAAAAg/h55K8wcWg1o/photo.jpg?sz=128", "display_name": "MYPE", "link": "https://stackoverflow.com/users/9745215/mype"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535555320, "creation_date": 1535552694, "last_edit_date": 1535554774, "question_id": 52079838, "link": "https://stackoverflow.com/questions/52079838/automated-tool-for-vlook-up", "title": "Automated tool for VLOOK UP", "body": "<p>I need to perform many VLookup in a set of excel files, and for that I built a tool that can make automated VLookup from a file to another but I need to be make it scalable and adaptable.</p>\n\n<p>For that, I want to input in some cells of the tool (which is an Excel file) the parameters for the VLookup:</p>\n\n<ul>\n<li>Position of Key Column </li>\n<li>Position of \"Returned Value\" Column</li>\n<li>Number of Columns in the range</li>\n</ul>\n\n<p>Do you know how to change my tool in order for it to include these entry parameters ?</p>\n\n<p>a sample of the code here:</p>\n\n<pre><code>For myrow = 3 To lastrow\n    Range(\"b\" &amp; myrow).FormulaR1C1 = _\n      \"=VLOOKUP(RC[-1], Input!C[-1]:C[2],2,FALSE)\"\nNext myrow\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1535552498, "post_id": 52079682, "comment_id": 91109469, "body": "Which line was the error and what error code?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1535552558, "post_id": 52079682, "comment_id": 91109525, "body": "Also, if you&#39;re using a UDF, should you not be using Sub UserForm_Initialize() to pull the data in?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1535552769, "post_id": 52079682, "comment_id": 91109677, "body": "Isn&#39;t  <code>EditData</code> the form, not the listbox?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1535552891, "post_id": 52079682, "comment_id": 91109760, "body": "<code>Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row</code> is looking at the active sheet.  <code>.Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row</code> would look at <code>MainDataBase</code> (note the <code>.</code> at the start)."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1535553066, "post_id": 52079682, "comment_id": 91109907, "body": "<code>MTable</code> should be <code>Set MTable = </code> as it&#39;s a range."}, {"owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1535611286, "post_id": 52079682, "comment_id": 91131095, "body": "@DarrenBartrup-Cook actually I&#39;d try to use MTable as array to make faster my code. I got ten columns to add ListBox"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1535610357, "post_id": 52080161, "comment_id": 91130680, "body": "Thanks for all your support, I appreciate it. But in fact the first code which is similar mine didn&#39;t work with me. I got 10 columns in range, may be it cause error. actually I&#39;d like to use my table like array to make much more faster my code."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1535617843, "post_id": 52080161, "comment_id": 91134844, "body": "I&#39;ve updated the answer with code for an array.  The only problem you were really having is that you weren&#39;t referencing the listbox.  <code>With EditData</code> is a reference to the form.  You&#39;d need <code>With EditData.ListBoxName</code> and have the listbox populate on the initialize event."}, {"owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1535625013, "post_id": 52080161, "comment_id": 91139619, "body": "thanks a lot for your help. Code for Array source  is working properly. I did some mistakes when I wrote that code for the first time. Actually I make right reference for listbox then but I think the problem happen because of  10 columns, that&#39;s why I&#39;d prefer use array, Everything is ok now. Thanks again!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 3, "last_activity_date": 1535617567, "last_edit_date": 1535617567, "creation_date": 1535553467, "answer_id": 52080161, "question_id": 52079682, "link": "https://stackoverflow.com/questions/52079682/pull-range-of-data-into-list-box/52080161#52080161", "title": "Pull range of data into List Box", "body": "<p>As @Cyril said.  Use the <code>Initialize</code> event so the listbox is populated when the form opens.</p>\n\n<p>As the code is in the form you can refer to the form using the <code>Me</code> keyword.  </p>\n\n<p><strong>Using array as a source:</strong>  </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Dim LRow As Long, LCol As Long\n    Dim MTable As Variant\n\n    With Worksheets(\"MainDataBase\")\n        LRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        LCol = .Cells(4, .Columns.Count).End(xlToLeft).Column\n        MTable = .Range(.Cells(5, 1), .Cells(LRow, LCol))\n    End With\n\n    With Me.ListBox1\n        .ColumnCount = UBound(MTable, 2)\n        .List = MTable\n    End With\n\nEnd Sub  \n</code></pre>\n\n<p>Or if you'd prefer to have the code in a normal module you can call it from the <em>Initialize</em> event:  </p>\n\n<p>In the form:  </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    PullDataIntoListBox Me.ListBox1\n\nEnd Sub  \n</code></pre>\n\n<p>In a normal module:</p>\n\n<pre><code>Public Sub PullDataIntoListBox(lstbx As MSForms.ListBox)\n\n    Dim LRow As Long, LCol As Long\n    Dim MTable As Variant\n\n    With Worksheets(\"MainDataBase\")\n        LRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        LCol = .Cells(4, .Columns.Count).End(xlToLeft).Column\n        MTable = .Range(.Cells(5, 1), .Cells(LRow, LCol))\n    End With\n\n    With lstbx\n        .ColumnCount = UBound(MTable, 2)\n        .List = MTable\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Using range as a source:</strong>  </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Dim LRow As Long, LCol As Long\n    Dim MTable As Range\n\n    With Worksheets(\"MainDataBase\")\n        LRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        LCol = .Cells(4, .Columns.Count).End(xlToLeft).Column\n        Set MTable = .Range(.Cells(5, 1), .Cells(LRow, LCol))\n    End With\n\n    With Me.Controls(\"ListBox1\")\n        .ColumnCount = MTable.Columns.Count\n        .RowSource = \"'\" &amp; MTable.Parent.Name &amp; \"'!\" &amp; MTable.Address\n    End With\n\nEnd Sub   \n</code></pre>\n\n<p>To open the form and populate the listbox you'd just use <code>EditData.Show</code>.  </p>\n\n<pre><code>Sub SomeOtherProcedure()\n\n    EditData.Show\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong><br>\nIf you want two instances of the same form open but using different values in the listbox you could use code similar to this:  </p>\n\n<p>In a normal module add this code:  </p>\n\n<pre><code>Option Explicit\n\nPublic colForms As New Collection\n\n'Accepts a range reference as an argument which is passed to the ListBox control on the form.\n'The form reference is then added to the colForms collection.\nSub OpenInstance(ListRange As Range)\n\n    Dim frm As New EditData\n\n    With frm.Controls(\"ListBox1\")\n        .ColumnCount = ListRange.Columns.Count\n        .RowSource = \"'\" &amp; ListRange.Parent.Name &amp; \"'!\" &amp; ListRange.Address\n    End With\n\n    colForms.Add frm, CStr(frm.Hwnd)\n\nEnd Sub\n\n'Starts two new forms, passing a different range to each one.\n'Each form in the colForms collection is then displayed.\nSub OpenForms()\n\n    Dim f As Variant\n\n    OpenInstance ThisWorkbook.Worksheets(\"MainDataBase\").Range(\"A1:D16\")\n    OpenInstance ThisWorkbook.Worksheets(\"Sheet2\").Range(\"D3:E5\")\n\n    For Each f In colForms\n        f.Show vbModeless\n    Next f\n\nEnd Sub\n\n'Called when the form closes.\n'The form is hidden before removing it from the collection.\nSub CloseForm(Hwnd As String)\n    colForms(Hwnd).Hide\n    colForms.Remove Hwnd\nEnd Sub  \n</code></pre>\n\n<p>In the form add this code:  </p>\n\n<pre><code>Option Explicit\n\n'Code for capturing forms Hwnd taken from:\n'https://colinlegg.wordpress.com/2016/05/06/getting-a-handle-on-userforms-vba/\n#If Win64 Then\n\n    Private Declare PtrSafe Function FindWindowA _\n        Lib \"user32.dll\" ( _\n        ByVal lpClassName As String, _\n        ByVal lpWindowName As String) As LongPtr\n\n    Private mlnghWnd As LongPtr\n\n    Public Property Get Hwnd() As LongPtr\n        Hwnd = mlnghWnd\n    End Property\n\n#Else\n\n    Private Declare Function FindWindowA _\n        Lib \"user32.dll\" ( _\n        ByVal lpClassName As String, _\n        ByVal lpWindowName As String) As Long\n\n    Private mlnghWnd As Long\n\n    Public Property Get Hwnd() As Long\n        Hwnd = mlnghWnd\n    End Property\n\n#End If\n\nPrivate Sub UserForm_Initialize()\n\n    StorehWnd\n\nEnd Sub\n\nPrivate Sub StorehWnd()\n\n    Dim strCaption As String\n    Dim strClass As String\n\n    'class name changed in Office 2000\n    If Val(Application.Version) &gt;= 9 Then\n        strClass = \"ThunderDFrame\"\n    Else\n        strClass = \"ThunderXFrame\"\n    End If\n\n    'remember the caption so we can\n    'restore it when we're done\n    strCaption = Me.Caption\n\n    'give the userform a random\n    'unique caption so we can reliably\n    'get a handle to its window\n    Randomize\n    Me.Caption = CStr(Rnd)\n\n    'store the handle so we can use\n    'it for the userform's lifetime\n    mlnghWnd = FindWindowA(strClass, Me.Caption)\n\n    'set the caption back again\n    Me.Caption = strCaption\n\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n    CloseForm CStr(Me.Hwnd)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 52080161, "answer_count": 1, "score": -2, "last_activity_date": 1535617567, "creation_date": 1535552268, "question_id": 52079682, "link": "https://stackoverflow.com/questions/52079682/pull-range-of-data-into-list-box", "title": "Pull range of data into List Box", "body": "<p>I got range of data in which I have 10 columns, and I'd like to pull that data into list box.</p>\n\n<p>Here is my code: - when I run I got compile error .</p>\n\n<pre><code>Sub PullDataIntoListBox()\n\nDim LRow As Long\nDim LCol As Long\nDim MTable\nEditData.Show\n\nWith Worksheets(\"MainDataBase\")\n    LRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    LCol = Cells(4, Columns.Count).End(xlToLeft).Column\n    MTable = Range(Cells(5, 1), Cells(LRow, LCol))\nEnd With\n\nWith EditData\n    .ColumnCount = UBound(MTable, 2)\n    .List = MTable\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1535552273, "post_id": 52079230, "comment_id": 91109321, "body": "I&#39;d use this method <a href=\"https://peltiertech.com/Excel/Charts/AddLineHorzErrBar.html\" rel=\"nofollow noreferrer\">Add a Horizontal Line to a Column or Line Chart: Error Bar Method</a>.  You then just have to transfer the value from the <i>Userform</i> to a worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 10285075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqsUT.jpg?s=128&g=1", "display_name": "Narjems", "link": "https://stackoverflow.com/users/10285075/narjems"}, "edited": false, "score": 0, "creation_date": 1535554644, "post_id": 52079837, "comment_id": 91111078, "body": "Thanks for your answer! It works better now, but with the 10 points (of the array), it&#39;s only a tiny point. I need much more. Do you have an idea how to do that, not manually?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 111, "user_id": 10285075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqsUT.jpg?s=128&g=1", "display_name": "Narjems", "link": "https://stackoverflow.com/users/10285075/narjems"}, "edited": false, "score": 0, "creation_date": 1535555399, "post_id": 52079837, "comment_id": 91111669, "body": "@Narjems It&#39;d be easiest to get the number from where your original date series is stored - could you give me an example of how/where you store it?"}, {"owner": {"reputation": 111, "user_id": 10285075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqsUT.jpg?s=128&g=1", "display_name": "Narjems", "link": "https://stackoverflow.com/users/10285075/narjems"}, "edited": false, "score": 0, "creation_date": 1535555633, "post_id": 52079837, "comment_id": 91111859, "body": "I modified it such that both the date and price columns are next to the chart."}, {"owner": {"reputation": 111, "user_id": 10285075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqsUT.jpg?s=128&g=1", "display_name": "Narjems", "link": "https://stackoverflow.com/users/10285075/narjems"}, "edited": false, "score": 0, "creation_date": 1535555824, "post_id": 52079837, "comment_id": 91111983, "body": "I tried adding  <code>Dim e, f As Date e = DateSerial(1998, 3, 27) f = DateSerial(2018, 3, 27)                                                               .XValues = Array(e, f) </code>  . But not working"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 111, "user_id": 10285075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqsUT.jpg?s=128&g=1", "display_name": "Narjems", "link": "https://stackoverflow.com/users/10285075/narjems"}, "edited": false, "score": 0, "creation_date": 1535556039, "post_id": 52079837, "comment_id": 91112119, "body": "I&#39;ve edited my post with an example of how we get our number of data points from the original data, then use that to build the array for the straight line series."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1535555962, "last_edit_date": 1535555962, "creation_date": 1535552694, "answer_id": 52079837, "question_id": 52079230, "link": "https://stackoverflow.com/questions/52079230/draw-horizontal-line-according-to-value-entered-in-userform-vba/52079837#52079837", "title": "Draw horizontal line according to value entered in userform (VBA)", "body": "<p>Remove the <code>ActiveChart</code> from your second <code>With</code> line - you never activated a chart, so it's hard to know which chart is receiving that new series. This code worked fine for me:</p>\n\n<p>It's hard to tell what you were trying to do, but it looks like you only wanted 2 data points. It'd be best to add something dynamic to this to figure out how many data points you need, then create the array to assign to <code>.Values</code>.</p>\n\n<pre><code>Sub Test3()\n    Dim d As Double\n    d = 5 'just assigning it here\n    With ThisWorkbook.Worksheets(\"Sheet1\").ChartObjects(\"Chart 1\").Chart \n        With .SeriesCollection.NewSeries\n            .Values = Array(d, d, d, d, d, d, d, d, d, d) '10 data points\n            .ChartType = xlLine\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/IBLZE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IBLZE.png\" alt=\"img1\"></a></p>\n\n<p><strong>Edit:</strong></p>\n\n<pre><code>Sub Test3()\nDim d As Double\nDim numberofpoints As Long, i As Long\nDim arr As Variant\n\nd = 5 'just assigning it here\nnumberofpoints = Cells(Rows.Count, 1).End(xlUp).Row - 1\nReDim arr(0 To 0)\n\nFor i = 0 To numberofpoints - 1\n    arr(i) = d\n    If i &lt;&gt; numberofpoints - 1 Then ReDim Preserve arr(0 To i + 1)\nNext i\n\nWith ThisWorkbook.Worksheets(\"Sheet1\").ChartObjects(\"Chart 1\").Chart\n    With .SeriesCollection.NewSeries\n        .Values = arr\n        .ChartType = xlLine\n    End With\nEnd With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/juflb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/juflb.png\" alt=\"img2\"></a></p>\n"}], "owner": {"reputation": 111, "user_id": 10285075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqsUT.jpg?s=128&g=1", "display_name": "Narjems", "link": "https://stackoverflow.com/users/10285075/narjems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "accepted_answer_id": 52079837, "answer_count": 1, "score": 0, "last_activity_date": 1535555962, "creation_date": 1535551109, "last_edit_date": 1535551758, "question_id": 52079230, "link": "https://stackoverflow.com/questions/52079230/draw-horizontal-line-according-to-value-entered-in-userform-vba", "title": "Draw horizontal line according to value entered in userform (VBA)", "body": "<p>I want my command button to draw a horizontal line, on an existing chart, such that it is equal to the value entered in that same userform. </p>\n\n<p>A similar question was asked before, so I got inspired by their answers to code. But it doesn't work. </p>\n\n<p>Here is my code : </p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    Dim d As Double\n    d = res\n    With ThisWorkbook.Worksheets(\"Feuil3\").ChartObjects(\"Graphique 2\").Chart \n        With ActiveChart.SeriesCollection.NewSeries\n            .Values = Array(d, d)\n            .ChartType = xlLine\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>Where <code>res</code> is that value that the user enters. </p>\n\n<p>Here is my result (it seems like it draws a line at 0, not at the <code>res</code> value; It also shifts all my x axis to the right). </p>\n\n<p><a href=\"https://i.stack.imgur.com/j1aFK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j1aFK.png\" alt=\"Screenshot\"></a></p>\n\n<p>Thank you in advance for your help ! </p>\n"}, {"tags": ["vba", "internet-explorer", "browser", "login", "web"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1535551780, "post_id": 52079377, "comment_id": 91108955, "body": "Thanks, but I tried to replace &quot;q&quot; with &quot;lst-ib&quot; just now, but still not working, and returned the same error message... And there is another statement &quot;.getElementsByName&quot;, with &quot;q&quot; the result is still the same..."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1535552608, "post_id": 52079377, "comment_id": 91109554, "body": "@Passer-by added code, not sure what the problem your experiencing was, a lot of times you need to wait for IE to finish processing a task"}, {"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1535723920, "post_id": 52079377, "comment_id": 91184967, "body": "So the &quot;Do While ie.Busy&quot; a statement to wait for IE? And I also see quite a lot in addition to .Busy, people use .readyState, not sure what do these statements exactly do, but appears to wait for IE. What is the purpose to add another &quot;Wait&quot; program you&#39;ve created right after the loop? Thanks!"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1535724188, "post_id": 52079377, "comment_id": 91185153, "body": "@Passer-by  yes the while .busy statement just makes the program wait until internet explorer has loaded a page but sometimes when there\u2019s heavy javascript I need to make my program wait longer for safety measures thats why I use that Wait function I created"}, {"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1535729032, "post_id": 52079377, "comment_id": 91187972, "body": "Thanks, and it seems the command SendKeys &quot;{ENTER}&quot; does not specify which button, on the Google search it&#39;s simply that only has one search button, but what if for example there are &quot;Next&quot; and &quot;Previous&quot; buttons, and possible more other button on the same page, how would I refer to a button that I want to click? Much appreciated!"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1535729199, "post_id": 52079377, "comment_id": 91188050, "body": "@Passer-by  the sendkeys line just acts if you actually pressed \u201center\u201d on your keyboard. To refer to a button use the findelementbyid().click method... not sure why it wasn\u2019t working on google search but it works 95% of the time"}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": false, "score": 1, "last_activity_date": 1536332524, "last_edit_date": 1536332524, "creation_date": 1535551521, "answer_id": 52079377, "question_id": 52079094, "link": "https://stackoverflow.com/questions/52079094/how-to-use-vba-to-input-text-into-google-and-click-search/52079377#52079377", "title": "How to use VBA to input text into Google and click search", "body": "<p>The name of an HTML element is not the same as the ID. </p>\n\n<p>For example, <code>\"q\"</code> is not the ID of the search bar but it's name. It's ID is <code>\"lst-ib\"</code></p>\n\n<p>Adding code:</p>\n\n<pre><code>Sub test()\n\n    Dim ie As Object\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    my_url = \"https://www.google.ca/?gws_rd=ssl\"\n    ie.Visible = True\n    ie.navigate my_url\n\n    Do While ie.Busy\n        DoEvents\n    Loop\n    Wait 3\n\n    'For example, if I want to search \"123\"\n    ie.Document.getElementById(\"lst-ib\").Value = \"123\"\n\n    ' Pressing enter\n    SendKeys \"{ENTER}\"\n\nEnd Sub\n\nSub Wait(seconds As Integer)\n\n    Application.Wait Now + timeValue(\"00:00:0\" &amp; CStr(seconds))\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1535558780, "post_id": 52080088, "comment_id": 91113959, "body": "By adding a &quot;While .Busy Or .readyState &lt; 4: DoEvents: Wend&quot;, 123 was input in the search bar! What does this statement do? But seems the click did not work..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1535559761, "post_id": 52080088, "comment_id": 91114457, "body": "The statement ensures that the page has loaded (except in cases of javascript heavy pages.)"}, {"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1535723709, "post_id": 52080088, "comment_id": 91184824, "body": "What is &quot;readyState&quot;, and what value it can take? And what is &quot;document.forms(0)&quot;? So I tried with another website, the statement will stop at &quot;While .Busy Or .readyState &lt; 4: DoEvents: Wend&quot;, probably that&#39;s the javascript heavy pages you&#39;ve mentioned? How to possibly improve this? Thank you!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535723877, "post_id": 52080088, "comment_id": 91184938, "body": "Is this question answered? <a href=\"https://msdn.microsoft.com/en-us/library/bb268229(v=vs.85).aspx\" rel=\"nofollow noreferrer\">readystate</a> can take values 0-4. You are entering data into a form which you then submit by pressing the search button. The above targets the form itself and submits it direct."}, {"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1536326551, "post_id": 52080088, "comment_id": 91395870, "body": "Thanks, but what does the parameter &quot;0&quot; mean? And how do you specify which button to press if multiple button showing on the same page?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536326624, "post_id": 52080088, "comment_id": 91395933, "body": "The parameter 0 means the first form on the page. I am not pushing any buttons as I am submitting the form direct (which is what the correct button would be doing anyway)."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549633736, "post_id": 52080088, "comment_id": 95983654, "body": "Is this now answered please?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1535560119, "last_edit_date": 1535560119, "creation_date": 1535553262, "answer_id": 52080088, "question_id": 52079094, "link": "https://stackoverflow.com/questions/52079094/how-to-use-vba-to-input-text-into-google-and-click-search/52080088#52080088", "title": "How to use VBA to input text into Google and click search", "body": "<p>Ensure you use the right wait syntax so page has loaded. You also don't need to loop to submit the form. Just submit direct with </p>\n\n<pre><code>.forms(0).submit\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Const MY_URL = \"https://www.google.ca/?gws_rd=ssl\"\n    With CreateObject(\"InternetExplorer.Application\")\n        .Visible = True\n        .navigate MY_URL\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            .getElementById(\"lst-ib\").Value = \"123\"\n            .forms(0).submit\n        End With\n        'Other code\n        '.Quit  '&lt;== Uncomment me later\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2152, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1536332524, "creation_date": 1535550738, "last_edit_date": 1535551511, "question_id": 52079094, "link": "https://stackoverflow.com/questions/52079094/how-to-use-vba-to-input-text-into-google-and-click-search", "title": "How to use VBA to input text into Google and click search", "body": "<p>My ultimate goal is to automate using VBA to open a browser, and input username and password for a website, and then click login to further navigate to different pages and download files!</p>\n\n<p>I want to begin with the simplest trial, however, of doing a Google search! I think the idea would be similar because both require to input something and click something. </p>\n\n<p>I found in IE -> Tools(Alt+X) -> F12 Developer Tools can show html codes of website, and even more convenient, it seems I can select regions and get keywords that I'm interested in! Here are 2 screenshots of those regions, <a href=\"https://i.stack.imgur.com/5Hjon.jpg\" rel=\"nofollow noreferrer\">the first one is for the search bar</a>, I found <code>\"input name = \"q\"</code>, <a href=\"https://i.stack.imgur.com/TjCg3.jpg\" rel=\"nofollow noreferrer\">and the second one is for the search button</a>, where I found <code>\"input name = \"btnK\"</code>.</p>\n\n<p>And here are my codes:</p>\n\n<pre><code>Sub test()\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nmy_url = \"https://www.google.ca/?gws_rd=ssl\"\nIE.Visible = True\nIE.navigate my_url\n\n'For example, if I want to search \"123\"\nIE.Document.getElementById(\"q\").Value = \"123\"\n\n'Click the \"Search\" button\nIE.Document.getElementById(\"btnK\").Click\n\n\nEnd Sub\n</code></pre>\n\n<p>It returns error at <code>IE.Document.getElementById(\"q\").Value = \"123\"</code>, </p>\n\n<blockquote>\n  <p>Method 'Document' of object 'iwebbrowser2' failed. </p>\n</blockquote>\n\n<p>Don't understand where has gone wrong. I'm really new to how to use VBA to control browsers... Please help, thank you all!</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8726259, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154967712222584/picture?type=large", "display_name": "Jegan", "link": "https://stackoverflow.com/users/8726259/jegan"}, "edited": false, "score": 0, "creation_date": 1535603465, "post_id": 52080335, "comment_id": 91128560, "body": "wow, thats a way simpler fix than what I expected!! Thanks Steve! Yes, just Brightness is suffice."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1535553953, "creation_date": 1535553953, "answer_id": 52080335, "question_id": 52078908, "link": "https://stackoverflow.com/questions/52078908/change-one-theme-accent-color-to-another-accent-color-for-all-shapes-in-a-ppt-fi/52080335#52080335", "title": "Change one theme/accent color to another accent color for all shapes in a PPT file", "body": "<p>Before changing the ObjectThemeColor, pick up the current TintAndShade and brightness, then apply them again after changing the ObjectThemeColor.  Simplified example:</p>\n\n<pre><code>With oSh.Fill.ForeColor\n\n    lThemeColor = .ObjectThemeColor\n    sBrightness = .Brightness\n    sTintShade = .TintAndShade\n\n    .ObjectThemeColor = lThemeColor + 1\n    .Brightness = sBrightness\n    .TintAndShade = sTintShade\n\nEnd With\n</code></pre>\n\n<p>Actually, I think preserving Brightness alone <em>might</em> be sufficient; give it a try and let us know.</p>\n"}], "owner": {"reputation": 19, "user_id": 8726259, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154967712222584/picture?type=large", "display_name": "Jegan", "link": "https://stackoverflow.com/users/8726259/jegan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1535553953, "creation_date": 1535550138, "last_edit_date": 1535550546, "question_id": 52078908, "link": "https://stackoverflow.com/questions/52078908/change-one-theme-accent-color-to-another-accent-color-for-all-shapes-in-a-ppt-fi", "title": "Change one theme/accent color to another accent color for all shapes in a PPT file", "body": "<p>I have created this code to replace one accent colors of the template with another (ObjectThemeColors), the Brightness (tint and shade) element is over-ruled and all shades of the old accent colors are replaced with the same shade as that of the given new color, can anybody help to preserve the brightness/shades while changing to new accent colors?</p>\n\n<p><a href=\"https://i.stack.imgur.com/D9Neb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D9Neb.png\" alt=\"Form Screenshot\"></a></p>\n\n<pre><code>Sub ReplaceColorNew(OldColor As String, NewColor As String)\n\nDim oeff As Effect\nDim i As Integer\nDim t As Integer\nDim oSld As Slide\nDim oShp As Shape\nDim x, y As Integer\nDim oPP As Placeholders\n\nFor Each oSld In ActivePresentation.Slides\n    For Each oShp In oSld.Shapes\n    'groups\n        If oShp.Type = msoGroup Then\n            For x = 1 To oShp.GroupItems.Count\n                With oShp.GroupItems(x)\n                    If .Fill.ForeColor.ObjectThemeColor = Conversion.CLng(OldColor) + 5 Then\n                       .Fill.ForeColor.ObjectThemeColor = Conversion.CLng(NewColor) + 5\n                    End If\n\n                    If .Line.Visible Then\n                        If .Line.ForeColor.ObjectThemeColor = Conversion.CLng(OldColor) + 5 Then\n                           .Line.ForeColor.ObjectThemeColor = Conversion.CLng(NewColor) + 5\n                        End If\n                    End If\n\n                    If .HasTextFrame Then\n                        If .TextFrame.HasText Then\n                            For y = 1 To .TextFrame.TextRange.Runs.Count\n                                If .TextFrame.TextRange.Runs(y).Font.Color.ObjectThemeColor = Conversion.CLng(OldColor) + 5 Then\n                                   .TextFrame.TextRange.Runs(y).Font.Color.ObjectThemeColor = Conversion.CLng(NewColor) + 5\n                                End If\n                            Next\n                        End If\n                    End If\n                End With\n            Next\n        Else\n            With oShp 'other shapes\n            ' Fill\n                If .Fill.ForeColor.ObjectThemeColor = Conversion.CLng(OldColor) + 5 Then\n                    .Fill.ForeColor.ObjectThemeColor = Conversion.CLng(NewColor) + 5\n                End If\n\n                ' Line\n                If Not .Type = msoTable Then\n                    If .Line.Visible = msoTrue Then\n                        If .Line.ForeColor.ObjectThemeColor = Conversion.CLng(OldColor) + 5 Then\n                            .Line.ForeColor.ObjectThemeColor = Conversion.CLng(NewColor) + 5\n                        End If\n                    End If\n                End If\n\n                ' Text\n                If .HasTextFrame Then\n                    If .TextFrame.HasText Then\n                        For y = 1 To .TextFrame.TextRange.Runs.Count\n                            If .TextFrame.TextRange.Runs(y).Font.Color.ObjectThemeColor = Conversion.CLng(OldColor) + 5 Then\n                                .TextFrame.TextRange.Runs(y).Font.Color.ObjectThemeColor = Conversion.CLng(NewColor) + 5\n                            End If\n                        Next\n                    End If\n                End If\n            End With\n        End If\n'oShp = Nothing\n    Next oShp\nNext oSld\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1535550651, "post_id": 52078880, "comment_id": 91108128, "body": "Does stuck mean it errors on that line? What does the error say?"}, {"owner": {"reputation": 11, "user_id": 8371846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7fd4de47536f9ff48e04f797875408?s=128&d=identicon&r=PG&f=1", "display_name": "Ebraham", "link": "https://stackoverflow.com/users/8371846/ebraham"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1535551407, "post_id": 52078880, "comment_id": 91108716, "body": "No it does not gives error. Stuck means does not move to the next code to the wait code. You can refer the link [<a href=\"https://stackoverflow.com/questions/45377777/choose-file-to-upload-dialog-merge-vbs-and-vba-process/52076720#52076720]\" title=\"choose file to upload dialog merge vbs and vba process\">stackoverflow.com/questions/45377777/&hellip;</a> which landed me till here. i do not allowed to use vb6 in my organization."}], "owner": {"reputation": 11, "user_id": 8371846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7fd4de47536f9ff48e04f797875408?s=128&d=identicon&r=PG&f=1", "display_name": "Ebraham", "link": "https://stackoverflow.com/users/8371846/ebraham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593904949, "creation_date": 1535550071, "last_edit_date": 1593904949, "question_id": 52078880, "link": "https://stackoverflow.com/questions/52078880/how-to-upload-a-file-on-prompt-choose-to-upload-the-file-with-vba", "title": "How to upload a file on prompt &quot;Choose to upload the file&quot; with VBA", "body": "<p>I have my below code which does the same thing which i want but it gets stuck at the code line after clicking the browse button <code>HTMLdoc.forms(\"upload\").Item(\"fileobj\").Click</code> it does not move further. Kindly advise ?</p>\n\n<pre><code>Private Declare Function FindWindow Lib \"user32.dll\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\nPrivate Declare Function SendMessage Lib \"user32.dll\" Alias \"SendMessageA\" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByRef lParam As Any) As Long\nPrivate Declare Function FindWindowEx Lib \"user32.dll\" Alias \"FindWindowExA\" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long\nPrivate Declare Function SendMessageByString Lib \"user32.dll\" Alias \"SendMessageA\" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Any) As Long\nPrivate Declare Function SetActiveWindow Lib \"user32.dll\" (ByVal hWnd As Long) As Long\nPrivate Declare Function ShowWindow Lib \"user32\" (ByVal hWnd As Long, ByVal nCmdSHow As Long) As Long\nPrivate Declare Function BringWindowToTop Lib \"user32\" (ByVal lngHWnd As Long) As Long\nPrivate Declare Function EnableWindow Lib \"user32.dll\" (ByVal hWnd As Long, ByVal fEnable As Long) As Long\nPrivate Declare Function GetActiveWindow Lib \"user32\" () As Long\nPrivate Declare Function GetFocus Lib \"user32.dll\" () As Long\nPrivate Declare Sub Sleep Lib \"kernel32.dll\" (ByVal dwMilliseconds As Long)\nPrivate Const WM_CLOSE As Long = &amp;H10\nPrivate Const SW_SHOW As Integer = 5\nPrivate Const WM_SETTEXT As Long = &amp;HC\nPrivate Const BM_CLICK As Long = &amp;HF5&amp;\n\nFunction Main(strCommandLine As String) 'is nessesary to execute on launch\n    'Dim strCommandLine As String 'path passed from VBA\n    'strCommandLine = \"C:\\Users\\jk99991\\Desktop\\Automation\\MVA\\OutputFiles\\BG\\F3140.000\" 'path passed from VBA\n    'Sleep 25000 'wait to execute, can be smarter way to check if dialog is already open\n\n    SaveAsWindow = FindWindow(vbNullString, \"Choose file to Upload\")\n\n    If SaveAsWindow = 0 Then\n        MsgBox \"Couldn't find the SaveAsWindow\" 'msg boxes are just for troubleshooting to see if right elements are found or not\n    End If\n\n    TextComboBox = FindWindowEx(SaveAsWindow, 0&amp;, \"ComboBoxEx32\", vbNullString)\n    If SaveAsWindow = 0 Then\n        MsgBox \"Couldn't find the SaveAsWindow\"\n        Stop\n    End If\n\n    ComboBox = FindWindowEx(TextComboBox, 0&amp;, \"ComboBox\", vbNullString)\n    If ComboBox = 0 Then\n        MsgBox \"Couldn't find the ComboBox\"  \n    End If\n\n    EditComboBox = FindWindowEx(ComboBox, 0&amp;, \"Edit\", vbNullString)\n    If EditComboBox = 0 Then\n        MsgBox \"Couldn't find the EditComboBox\"\n    End If\n\n    ''and wait/sleep\n    Call SendMessageByString(EditComboBox, WM_SETTEXT, 0, strCommandLine) 'here goes variable from VBA \"strCommandLine\"\n    DoEvents\n    SaveButton = FindWindowEx(SaveAsWindow, 0&amp;, \"Button\", \"&amp;Open\")\n    Call EnableWindow(SaveButton, True)\n    Call SendMessage(SaveButton, BM_CLICK, 0&amp;, ByVal 0&amp;)\n\nEnd Function\n</code></pre>\n\n<p>Below is the VBA code but it gets stuck after clicking the browse button. The script does not executes further till i manually cancel the window promt.</p>\n\n<pre><code>Set HTMLdoc = IE.Document\n\nHTMLdoc.forms(\"upload\").Item(\"fileobj\").Click'Stops here does not move ahead \nApplication.Wait (Now() + TimeValue(\"00:00:04\"))\n\nCall Main(nPath)  \nSet HTMLAs = HTMLdoc.getElementsByTagName(\"strong\")\n\nFor Each HTMLa In HTMLAs\n    Debug.Print HTMLa.innerText\n    If InStr(1, HTMLa.innerText, \"Upload\") &lt;&gt; 0 Then\n        HTMLa.Click\n    End If\nNext HTMLa\n</code></pre>\n"}, {"tags": ["vba", "excel", "object"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1535548688, "post_id": 52078428, "comment_id": 91106794, "body": "Which line of code is triggering the error?"}, {"owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1535548741, "post_id": 52078428, "comment_id": 91106828, "body": "Also I don&#39;t know if I should be using the Do While - Loop command or the For - Next command"}, {"owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1535548779, "post_id": 52078428, "comment_id": 91106853, "body": "@CindyMeister sorry forgot to mention it. The error occurs at the If statement."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 3, "creation_date": 1535548821, "post_id": 52078428, "comment_id": 91106877, "body": "Cells(row,col) versus Range(&quot;A1&quot;)... different syntax.  Swap Range to Cells and you should get through that section.  Verify what you&#39;re trying to change inside of the if-statement, too.  <i>Base.Range(&quot;Changes_Made&quot;) = &quot;Yes&quot;</i> doesn&#39; tlook correct, either."}, {"owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1535549084, "post_id": 52078428, "comment_id": 91107055, "body": "@Cyril awesome!! It works like a charm :-) BTW Base. was define earlier in the code. I forgot to add that information with this example. Thanks again :-)"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1535549310, "post_id": 52078428, "comment_id": 91107198, "body": "@ValS Thanks for the heads up on Base; I was more focused on the format for Range() = &quot;Yes&quot; rather than Range().Value = &quot;Yes&quot;, which will work either way, but still looks odd as you&#39;re not clearly stating what is occurring."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1535549389, "post_id": 52078428, "comment_id": 91107267, "body": "@ValS post-script... if you can self-answer so this post can be closed and not linger, that would be appreciated!"}], "owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535548649, "creation_date": 1535548649, "question_id": 52078428, "link": "https://stackoverflow.com/questions/52078428/application-define-or-object-define-error-vba", "title": "application define or object define error (VBA)", "body": "<p>I have read the following : <a href=\"https://stackoverflow.com/questions/42682317/vba-application-defined-or-object-defined-error\">VBA &quot;Application defined or object defined error &quot;</a></p>\n\n<p>However I can't seem to link it to my problem, even if it looks similar. Here is my code:</p>\n\n<pre><code>If Range(\"What\").Value &lt;&gt; \"New Entry\" Then\n    current = 2\n    Updated = 3\n    For coll = 1 To 49\n    'Do While current &lt;&gt; Updated\n        If Sheets(\"GoodDBData\").Range(current, coll).Value &lt;&gt; Sheets(\"GoodDBData\").Range(Updated, coll).Value Then\n            Base.Range(\"Changes_Made\") = \"Yes\"\n    '        coll = coll + 1\n        End If\n    'Loop\n    Next\nEnd If\n</code></pre>\n\n<p>I basically want to know if the user change anything in current. Basically current and Update or initially the same however if the user make some changes it will appear in current only. Hence when the user is done, if current is different then Update then I want YES in range changes_made.</p>\n\n<p>Anyone know why I get the application define or object define error?\nThanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1535548369, "post_id": 52078279, "comment_id": 91106553, "body": "I&#39;m wondering. The life of question is 1 minute - and it already got +1"}, {"owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1535548674, "post_id": 52078279, "comment_id": 91106783, "body": "@JohnyL, lol I have no clue"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1535548735, "post_id": 52078279, "comment_id": 91106824, "body": "<code>With cib_ws.Range(&quot;A1&quot; &amp; lcol2)</code> should probably be: <code>With cib_ws.Range(&quot;A1&quot;, cib_ws.Cells(Lrow2,lcol2))</code>"}, {"owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1535548987, "post_id": 52078279, "comment_id": 91106986, "body": "@ScottCraner and that will still only select visible cells after the filter?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535549023, "post_id": 52078279, "comment_id": 91107011, "body": "@bloomfieldhero9219 you&#39;ve got the order backwards. First autofilter, and then <code>Set cib_rng</code> equal to the resulting visible cells."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1535549086, "post_id": 52078279, "comment_id": 91107058, "body": "all I know is <code>With cib_ws.Range(&quot;A1&quot; &amp; lcol2)</code> is only select one cell.  Say <code>lcol2</code> is 50.  The cell it is selecting is <code>A150</code> as the two get concatenated."}, {"owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1535549126, "post_id": 52078279, "comment_id": 91107075, "body": "@ScottCraner That didn&#39;t select and copy any of the cells, that part is only autofiltering (which is working just fine), it&#39;s the copying that autofiltered section and transferring it to the <code>comp_ws</code> last row +1 offset that isn&#39;t working"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535549225, "post_id": 52078279, "comment_id": 91107139, "body": "See @BigBen comment and move the set cib_rng line after the filter."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "edited": false, "score": 0, "creation_date": 1535555842, "post_id": 52078667, "comment_id": 91111987, "body": "this still only copies over the legal_ws data, doesn&#39;t select and copy the cib_ws data"}, {"owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "edited": false, "score": 0, "creation_date": 1535558442, "post_id": 52078667, "comment_id": 91113744, "body": "<code>Set cib_rng = cib_ws.Range(cib_ws.Cells(2, 1), cib_ws.Cells(lrow2, lcol2)).SpecialCells(xlCellTypeVisible)</code>   after the filter"}, {"owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "edited": false, "score": 0, "creation_date": 1535558464, "post_id": 52078667, "comment_id": 91113757, "body": "the if not statement wrapped around   <code>With cib_ws.Range(cib_ws.Cells(2, 1), cib_ws.Cells(lrow2, lcol2)).SpecialCells(xlCellTypeVisible)             .Copy Destination:=comp_ws.Range(&quot;A&quot; &amp; lrow3 + 1)</code>"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1535549388, "creation_date": 1535549388, "answer_id": 52078667, "question_id": 52078279, "link": "https://stackoverflow.com/questions/52078279/why-is-my-second-table-range-not-transferring-over-to-destination-worksheet/52078667#52078667", "title": "Why is my second table range not transferring over to destination worksheet?", "body": "<p>The main issues:</p>\n\n<ol>\n<li>Use <code>lrow2</code> and <code>lcol2</code> instead of <code>lrow</code> and <code>lcol</code> (must just be a simple oversight).</li>\n<li>As @Scott Craner pointed out in the comments, <code>With cib_ws.Range(\"A1\" &amp; lcol2)</code> refers to <em>one cell</em>, not the <em>entire range to be auto filtered</em>. That should probably be changed to <code>With cib_ws.Range(\"A1\", cib_ws.Cells(Lrow2,lcol2))</code></li>\n<li>Switch the order around: <strong>first</strong> auto filter, and <strong>then</strong> <code>Set cib_rng</code> equal to the resulting visible cells. Note that you need to test if there are any visible cells before attempting to copy, otherwise <code>cib_rng</code> will be <code>Nothing</code>. So wrap your <code>cib_rng.Copy</code> statement within an <code>If Not cib_rng Is Nothing Then...End If</code>. </li>\n</ol>\n"}], "owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535549447, "creation_date": 1535548211, "question_id": 52078279, "link": "https://stackoverflow.com/questions/52078279/why-is-my-second-table-range-not-transferring-over-to-destination-worksheet", "title": "Why is my second table range not transferring over to destination worksheet?", "body": "<p>I have a script that combines two worksheets into a comprehensive worksheet: <code>legal_ws</code> + <code>cib_ws</code> ---> <code>comp_ws</code></p>\n\n<p>The <code>legal_ws</code> moves over just fine with this: </p>\n\n<pre><code>        lrow = legal_ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        lcol = legal_ws.Cells(1, legal_ws.Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Set legal_rng = legal_ws.Range(legal_ws.Cells(2, 1), legal_ws.Cells(lrow, lcol))\n</code></pre>\n\n<p>and this</p>\n\n<pre><code>legal_rng.Copy Destination:=comp_ws.Range(\"A2\")\n</code></pre>\n\n<p>but the <code>cib_ws</code> method of transferring it the same way doesn't work. the <code>cib_ws</code> transfer requires an autofilter and copy only visible cells minus the header, but it's not copying those cells. </p>\n\n<pre><code>        lrow2 = cib_ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        lcol2 = cib_ws.Cells(1, cib_ws.Columns.Count).End(xlToLeft).Column\n\nSet cib_rng = cib_ws.Range(cib_ws.Cells(2, 1), cib_ws.Cells(lrow, lcol)).SpecialCells(xlCellTypeVisible)\n\n        With cib_ws.Range(\"A1\" &amp; lcol2)\n                    .AutoFilter\n                    .AutoFilter Field:=61, Criteria1:=\"Regional Presidents\"\n        End With\n\n            cib_rng.Copy Destination:=comp_ws.Range(\"A\" &amp; lrow3 + 1)\n</code></pre>\n\n<p>Why isn't the <code>cib_ws</code> transfer working but the <code>legal_ws</code> one is?</p>\n\n<p>Here's the whole script:</p>\n\n<pre><code>    Sub TCR_Update()\n\n\n\n    'File Paths\n    Dim Legal As String, CIB As String, Comp_TCR As String\n\n    Legal = \"M:\\Legal-TCR-Template.xlsx\"\n    CIB = \"M:\\CIB-TCR-Template.xlsx\"\n    Comp_TCR = \"M:\\Total_TCR.xlsx\"\n\n    Dim legal_wb As Workbook, cib_wb As Workbook, comp_wb As Workbook\n    Set legal_wb = Workbooks.Open(Filename:=Legal)\n    Set cib_wb = Workbooks.Open(Filename:=CIB)\n    Set comp_wb = Workbooks.Open(Filename:=Comp_TCR)\n\n    Dim legal_ws As Worksheet, cib_ws As Worksheet, comp_ws As Worksheet\n    Set legal_ws = legal_wb.Sheets(\"ps\")\n    Set cib_ws = cib_wb.Sheets(\"ps\")\n    Set comp_ws = comp_wb.Sheets(\"Sheet1\")\n\n    Dim lrow As Long, lcol As Long, lrow2 As Long, lcol2 As Long, lrow3 As Long\n\n    Dim legal_rng As Range\n\n\n\n            lrow = legal_ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n            lcol = legal_ws.Cells(1, legal_ws.Columns.Count).End(xlToLeft).Column\n            lrow2 = cib_ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n            lcol2 = cib_ws.Cells(1, cib_ws.Columns.Count).End(xlToLeft).Column\n           lrow3 = comp_ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n                Set legal_rng = legal_ws.Range(legal_ws.Cells(2, 1), legal_ws.Cells(lrow, lcol))\n                Set cib_rng = cib_ws.Range(cib_ws.Cells(2, 1), cib_ws.Cells(lrow, lcol)).SpecialCells(xlCellTypeVisible)\n\n\n        legal_rng.Copy Destination:=comp_ws.Range(\"A2\")\n\n            With cib_ws.Range(\"A1\" &amp; lcol2)\n                        .AutoFilter\n                        .AutoFilter Field:=61, Criteria1:=\"Regional Presidents\"\n            End With\n\n                cib_rng.Copy Destination:=comp_ws.Range(\"A\" &amp; lrow + 1)\n\n              legal_wb.Close SaveChanges:=False\n              cib_wb.Close SaveChanges:=False\n\n            Cells.Select\n            Cells.Copy\n            Cells.PasteSpecial Paste:=xlPasteValues\n\n\n              With comp_ws\n              .Cells.WrapText = False\n              .Rows.AutoFit\n              .Columns.AutoFit\n              End With\n</code></pre>\n"}, {"tags": ["python", "vba", "excel", "xlwings"], "answers": [{"tags": [], "owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "is_accepted": false, "score": 1, "last_activity_date": 1535551946, "last_edit_date": 1535551946, "creation_date": 1535551557, "answer_id": 52079392, "question_id": 52078155, "link": "https://stackoverflow.com/questions/52078155/how-do-i-assign-an-xlwings-function-to-a-button/52079392#52079392", "title": "How do I assign an xlwings function to a button", "body": "<p>I don't think you can assign a Python script to an Excel button, but I think a solution could be to assign VBA code to the button's click event that calls the Python script.</p>\n\n<p>To do this:</p>\n\n<ol>\n<li><p>Go to the Developer tab (<a href=\"https://www.techonthenet.com/excel/questions/developer_tab2013.php\" rel=\"nofollow noreferrer\">Developer tab?!</a>) -> Click 'Visual Basic'</p></li>\n<li><p>At the top, select 'Insert' -> 'Module'</p></li>\n<li><p>Create a <code>Public Sub MySubName()</code> in the module that calls the Python script.</p></li>\n<li><p>Right click the button you want to assign the <code>Sub</code> to -> \"Assign Macro...\" -> choose the <code>Sub</code>'s name.</p></li>\n</ol>\n\n<p>And that should be it, assuming you know how to call Python from VBA.</p>\n"}, {"tags": [], "owner": {"reputation": 681, "user_id": 8173159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3985aa8d03a6e360e233ef4eaec34691?s=128&d=identicon&r=PG&f=1", "display_name": "James Carter", "link": "https://stackoverflow.com/users/8173159/james-carter"}, "is_accepted": false, "score": 0, "last_activity_date": 1544591392, "creation_date": 1544591392, "answer_id": 53736429, "question_id": 52078155, "link": "https://stackoverflow.com/questions/52078155/how-do-i-assign-an-xlwings-function-to-a-button/53736429#53736429", "title": "How do I assign an xlwings function to a button", "body": "<p>After adding the excel add-in to VBA, insert a new module (insert->module) and write the following code. Then, create a button under the developer tab, right click on the button, and click assign macro. Then find the macro you wrote called Button. </p>\n\n<pre><code>Sub Button()\n    RunPython(\"import filename\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 372, "user_id": 3706478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/exY21.jpg?s=128&g=1", "display_name": "Tony Roberts", "link": "https://stackoverflow.com/users/3706478/tony-roberts"}, "is_accepted": false, "score": 0, "last_activity_date": 1545063628, "creation_date": 1545063628, "answer_id": 53819140, "question_id": 52078155, "link": "https://stackoverflow.com/questions/52078155/how-do-i-assign-an-xlwings-function-to-a-button/53819140#53819140", "title": "How do I assign an xlwings function to a button", "body": "<p>To write Excel macros in Python that are available for all workbooks, you can use PyXLL.</p>\n\n<p>See the following link to the docs for details of how to expose Python functions as macros and call them from Excel.</p>\n\n<p><a href=\"https://www.pyxll.com/docs/userguide/macros.html#calling-macros-from-excel\" rel=\"nofollow noreferrer\">https://www.pyxll.com/docs/userguide/macros.html#calling-macros-from-excel</a></p>\n"}], "owner": {"reputation": 378, "user_id": 8300107, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8d884c95bf0c6f08cdd2e725dfbb9e9f?s=128&d=identicon&r=PG&f=1", "display_name": "hegdep", "link": "https://stackoverflow.com/users/8300107/hegdep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1383, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1545063628, "creation_date": 1535547793, "last_edit_date": 1535548260, "question_id": 52078155, "link": "https://stackoverflow.com/questions/52078155/how-do-i-assign-an-xlwings-function-to-a-button", "title": "How do I assign an xlwings function to a button", "body": "<p>When I create a module under xlwings to call a Python script, how do I assign it to a button on excel? </p>\n\n<p>Trying to assign a macros to a button seems to only provide options of functions in the main workbook. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1535624485, "post_id": 52078111, "comment_id": 91139293, "body": "Where do you get an error message? At which line? You say: &quot;The first three lines are well interpreted&quot; do you mean that line 4 gives you the error? Is there a number greater to 2 in the cell &quot;E2&quot;?"}], "owner": {"reputation": 11, "user_id": 10289984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec45749b1c2eabc3b276fb89d2e5577?s=128&d=identicon&r=PG&f=1", "display_name": "Madian Al Abbas", "link": "https://stackoverflow.com/users/10289984/madian-al-abbas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1535554258, "creation_date": 1535547653, "last_edit_date": 1535554258, "question_id": 52078111, "link": "https://stackoverflow.com/questions/52078111/export-cells-of-a-certain-row-to-a-txt-document", "title": "Export cells of a certain row to a .txt document", "body": "<p>I got an excel document, and I am trying to get all the cells of a row into an txt document.</p>\n\n<pre><code>Sub ExportTxt()\n    Dim CheminFichierTxt As String\n    Dim Tablo() As Variant\n    Dim nombreligne As Integer\n    nombreligne = Sheets(\"Operation sab\").Range(\"E2\").Value\n\n    Tablo = Worksheets(\"G\u00e9n\u00e9ration fichier SAB\").Range(\"E2:E\" &amp; nombreligne).Value\n    CheminFichierTxt = \"C:\\Users\\GB4678\\Documents\\fichier excel\\fichiersab.txt\"\n    NumFichier = FreeFile()\n\n    Open \"C:\\Users\\GB4678\\Documents\\fichier excel\\fichiersab.txt\" For Output As #NumFichier\n\n    'tu parcours le tableau\n    For i = 1 To UBound(Tablo)\n        For j = 1 To UBound(Tablo, 2)\n            Print #NumFichier, Tablo(i, j)\n        Next j\n    Next i\n\n    Close #NumFichier ' Ferme le fichier.\n\nEnd Sub\n</code></pre>\n\n<p>But since the lines i am trying to copy are very big like this : </p>\n\n<pre><code>=\",{\n\n   \"&amp;$C$1&amp;\"date\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;'Cr\u00e9ation login'!$F$3&amp;\"-\"&amp;'Cr\u00e9ation login'!$E$3&amp;\"-\"&amp;'Cr\u00e9ation login'!$D$3&amp;$C$1&amp;\",\n\n   \"&amp;$C$1&amp;\"extraction\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;'Cr\u00e9ation login'!$F$3&amp;\"-\"&amp;'Cr\u00e9ation login'!$E$3&amp;\"-\"&amp;'Cr\u00e9ation login'!$D$3&amp;\"T15:13:24.000+0100\"&amp;$C$1&amp;\",\n\n   \"&amp;$C$1&amp;\"description\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;A4&amp;B4&amp;$C$1&amp;\",\n\n   \"&amp;$C$1&amp;\"movement\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;SI(A4=\"REMCBP\";\"credit\";\"debit\")&amp;$C$1&amp;\",\n\n   \"&amp;$C$1&amp;\"currency\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"EUR\"&amp;$C$1&amp;\",\n\n   \"&amp;$C$1&amp;\"amount\"&amp;$C$1&amp;\": \"&amp;ALEA.ENTRE.BORNES(10;99)&amp;\".\"&amp;ALEA.ENTRE.BORNES(10;99)&amp;\",\n\n   \"&amp;$C$1&amp;\"status\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"posted\"&amp;$C$1&amp;\",\n\n   \"&amp;$C$1&amp;\"custom_fields\"&amp;$C$1&amp;\": [        {\n          \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"POSTING_DATE\"&amp;$C$1&amp;\",\n          \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;'Cr\u00e9ation login'!$F$3&amp;\"-\"&amp;'Cr\u00e9ation login'!$E$3&amp;\"-\"&amp;'Cr\u00e9ation login'!$D$3&amp;$C$1&amp;\"\n        },{\n     \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"FEES_NUMBER\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"0\"&amp;$C$1&amp;\"\n    },\n            {\n          \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"LIB3\"&amp;$C$1&amp;\",\n          \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"EUR\"&amp;$C$1&amp;\"\n        },            {\n          \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"LIB2\"&amp;$C$1&amp;\",\n          \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"20,00 FR\"&amp;$C$1&amp;\"\n        },\n    {\n     \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"TNX_TYPE\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;A4&amp;$C$1&amp;\"\n    },\n    {\n     \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"TNX_TAG\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;B4&amp;$C$1&amp;\"\n    },\n    {\n     \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"TNX_NATURE\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"CBP\"&amp;$C$1&amp;\"\n    },\n\n    {\n     \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"LIB2\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"Paiement carte n\u00b01234XXXXXX\"&amp;$C$1&amp;\"\n    },\n    {\n     \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"CARD_ALIAS\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;'Cr\u00e9ation login'!$C$3&amp;$C$1&amp;\"\n    },\n    {\n     \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"TNX_DATE\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;'Cr\u00e9ation login'!$F$3&amp;\"-\"&amp;'Cr\u00e9ation login'!$E$3&amp;\"-\"&amp;'Cr\u00e9ation login'!$D$3&amp;$C$1&amp;\"\n    },   {\n     \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"TNX_NOM\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"Test \"&amp;A4&amp;$C$1&amp;\"\n    },\n    {\n     \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"TNX_ADR\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"Vincennes\"&amp;$C$1&amp;\"\n    },\n    {\n     \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"TNX_CB_AVIS\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;ALEA.ENTRE.BORNES(1000000000000;9999999999999)&amp;$C$1&amp;\"\n    },    {\n     \"&amp;C1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"TNX_SABID\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;ALEA.ENTRE.BORNES(1000000000000;9999999999999)&amp;$C$1&amp;\"\n    },\n    {\n     \"&amp;$C$1&amp;\"name\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;\"TNX_CB\"&amp;$C$1&amp;\",\n     \"&amp;$C$1&amp;\"value\"&amp;$C$1&amp;\": \"&amp;$C$1&amp;ALEA.ENTRE.BORNES(1000000000000;9999999999999)&amp;$C$1&amp;\"\n    }\n   ]\n\n  }\"\n</code></pre>\n\n<p>He is unable to copy them, the first three lines are well interpreted but the rest isn't and I can't figure why.\nI tried many things but with some numbers or some text, this code does the job, but with these cells it always bug and it don't copy properly the cells contained in the row.</p>\n\n<p>Does anybody have an idea of the reason why? Thank you in advance.</p>\n\n<p>Best regards.\nMadian</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1535547923, "post_id": 52078106, "comment_id": 91106243, "body": "This is good progress! I&#39;m not sure what the next step is though. Are you wanting this script to input the ip address at this point? Since we don&#39;t have any control over how your batch file runs (I assume) then I think <code>Application.SendKeys()</code> to actually mimic keyboard strokes/typing is probably your best bet. Unless the batch file can take in parameters, then those could be passed in your <code>.Run</code> command."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1535548941, "post_id": 52078106, "comment_id": 91106952, "body": "If you need to open a shell in interactive mode, <a href=\"https://stackoverflow.com/a/41416923/4088852\">this answer</a> demonstrates how to do that."}], "owner": {"reputation": 1, "user_id": 10290020, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1SMkmwGMNH8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMUWyop31Y5XA6CgouPfVnqzKcTcw/mo/photo.jpg?sz=128", "display_name": "Nia Ray", "link": "https://stackoverflow.com/users/10290020/nia-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535547632, "creation_date": 1535547632, "question_id": 52078106, "link": "https://stackoverflow.com/questions/52078106/execute-bat-file-then-input-ip-address-to-open-putty-session-that-will-then-ha", "title": "Execute .bat file then input IP Address, to open PuTTY session that will then have further commands", "body": "<p>Issue: We have a list of over 1000 intersections that routinely need firmware upgrades. The excel sheet have the device ID, intersection name and IP address.</p>\n\n<p>Goal: We would like to use our excel directory to ping these intersection devices (controllers) and then run the firmware upgrade. The batch file runs a program that requires us to input the IP address for the intersection in question and then it opens a PuTTY session that has a number of menus that guide you through upgrading the firmware (these are commands like \"1\",\"5\", etc)</p>\n\n<p>I have tried this for a day, and I have gotten to the point of being able to open the batch file if I get a positive result from ping. </p>\n\n<p>Current Code:</p>\n\n<pre><code>Sub FirmwareUpgradeStatus()\n\n'setting values of variables\nSet Wks = Worksheets(\"Upgrade\")\n\nSet ipRng = Wks.Range(\"F2\")\nSet RngEnd = Wks.Cells(Rows.Count, ipRng.Column).End(xlUp)\nSet ipRng = IIf(RngEnd.Row &lt; ipRng.Row, ipRng, Wks.Range(ipRng, RngEnd))\n\nDim FirmwareUpgrade As Object\nSet FirmwareUpgrade = VBA.CreateObject(\"WScript.Shell\")\n\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowStyle As Integer: windowStyle = 1\n\n'this is a loop that feeds each server from the list into the GetPingResult \nfunction\n\nFor Each Cell In ipRng\nResult = GetPingResult(Cell)\n    If Result = \"Connected\" Then\n    ChDir \"C:\\Users\\C000XXXX\\Desktop\\maxtime_1.9.11\"\n    FirmwareUpgrade.Run \"C:\\Users\\C000XXXX\\Desktop\\maxtime_1.9.11\\install.cmd /c \"\"Cell\"\"\", windowStyle, waitOnReturn\n    'Shell \"C:\\Users\\C000XXXX\\Desktop\\maxtime_1.9.11\\install.cmd\" &amp; \"&amp;&amp;Cell\"\n    End If\n  Next Cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "double-quotes"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1535548381, "post_id": 52078029, "comment_id": 91106562, "body": "I have it in my head that you need spaces to separate the <code>&amp;</code>s."}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1535548646, "creation_date": 1535548646, "answer_id": 52078424, "question_id": 52078029, "link": "https://stackoverflow.com/questions/52078029/qutation-marks-within-vba-for-if-statement/52078424#52078424", "title": "Qutation Marks within VBA for IF statement", "body": "<p>I believe the following should work as you expect it to, I simply changed the variable name from <code>on</code> to <code>oni</code> as I don't think you can have a variable named <code>on</code> also I separated the &amp;'s with spaces:</p>\n\n<pre><code>ActiveCell.Formula = \"=IF(D2=\" &amp; team &amp; \", \" &amp; Chr(34) &amp; Chr(34) &amp; \",IF(D2=\"\" &amp; oni &amp; \"\",\" &amp; Chr(34) &amp; \" - Type1\" &amp; Chr(34) &amp; \",IF(OR(D2=\" &amp; lr &amp; \",D2=\" &amp; sn &amp; \"),\" &amp; Chr(34) &amp; \"*\" &amp; Chr(34) &amp; \",\" &amp; Chr(34) &amp; \" - Type3\" &amp; Chr(34) &amp; \")))\"\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10264295"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 52078424, "answer_count": 1, "score": 0, "last_activity_date": 1594072274, "creation_date": 1535547370, "last_edit_date": 1594072274, "question_id": 52078029, "link": "https://stackoverflow.com/questions/52078029/qutation-marks-within-vba-for-if-statement", "title": "Qutation Marks within VBA for IF statement", "body": "<p>I am trying to copy an <code>IF</code> formula in a range, but my issue, much like others, comes from the double quotes. I currently have <code>CHR(34)</code> to indicate I want the double quote, but my VBA error is <code>Expected end of line.</code></p>\n\n<p>How I need it to appear as a formula:</p>\n\n<pre><code>=IF(D2=team,\"\",IF(D2=on,\" - Type1\",IF(OR(D2=lr,D2=sn),\"*\",\" - Type3\")))\n</code></pre>\n\n<p><code>team, on, lr, sign</code> are variables that refer to strings. </p>\n\n<pre><code>Range()= \"=IF(D2=\" &amp; team &amp; \", \"&amp;Chr(34)&amp;Chr(34)&amp;\",IF(D2=\" &amp; on &amp; \",\"&amp;Chr(34)&amp;\" - Type1\"&amp;Chr(34)&amp;\",IF(OR(D2=\" &amp;lr&amp; \",D2=\" &amp;sn&amp; \"),\"&amp;Chr(34)&amp;\"*\"&amp;Chr(34)&amp;\",\"&amp;Chr(34)&amp;\" - Type3\"&amp; Chr(34)&amp;\")))\"\n</code></pre>\n\n<p>It presents the error in the second instance of <code>D2</code> in the <code>OR</code> statement</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1535546846, "post_id": 52077668, "comment_id": 91105425, "body": "I&#39;ve had this happen occasionally when working with a Word document from a network location (not via VBA). Just delete the shadow file."}, {"owner": {"reputation": 41, "user_id": 9354065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d266649f004299b683f90cba6ddf9fc?s=128&d=identicon&r=PG&f=1", "display_name": "RAH", "link": "https://stackoverflow.com/users/9354065/rah"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1535547133, "post_id": 52077668, "comment_id": 91105634, "body": "Thats the thing. At home im not on any network, even after deleting the file it seems to think it either doesnt exit or is in use"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1535548180, "post_id": 52077668, "comment_id": 91106427, "body": "Ah, in the code you post you Dim <code>testDoc</code> as <b><code>Word.Application</code></b> rather than <code>Word.Document</code>. So VBA is not going to want to let you assign a Document to it...?"}, {"owner": {"reputation": 41, "user_id": 9354065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d266649f004299b683f90cba6ddf9fc?s=128&d=identicon&r=PG&f=1", "display_name": "RAH", "link": "https://stackoverflow.com/users/9354065/rah"}, "edited": false, "score": 0, "creation_date": 1535548396, "post_id": 52077668, "comment_id": 91106572, "body": "That is a good observation. Upon testing, it didnt seem to work."}], "answers": [{"comments": [{"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 1, "creation_date": 1535559675, "post_id": 52078437, "comment_id": 91114419, "body": "Was going to make reference to this in the original question but, in order to dim to Word.Application, you will need the <code>Microsoft Word xx.x Object Library</code> reference.  (Tools --&gt; References).  And once you do that you don&#39;t need your <code>Set wrd = CreateObject(&quot;Word.Application&quot;)</code> line, plus you get the intellisense  when working with the objects.  :)"}, {"owner": {"reputation": 41, "user_id": 9354065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d266649f004299b683f90cba6ddf9fc?s=128&d=identicon&r=PG&f=1", "display_name": "RAH", "link": "https://stackoverflow.com/users/9354065/rah"}, "edited": false, "score": 0, "creation_date": 1535561145, "post_id": 52078437, "comment_id": 91115136, "body": "The file opened smoothly after the first run. Im still not sure why it didnt close properly in the first place, but my thanks for this answer."}, {"owner": {"reputation": 41, "user_id": 9354065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d266649f004299b683f90cba6ddf9fc?s=128&d=identicon&r=PG&f=1", "display_name": "RAH", "link": "https://stackoverflow.com/users/9354065/rah"}, "edited": false, "score": 1, "creation_date": 1535633845, "post_id": 52078437, "comment_id": 91145585, "body": "Final answer: If error occurs, close all word processes via task manager. Make sure your code has a error handling which has a wrd.quit line in it, to make sure the next time an error occurs the app closed correctly."}], "tags": [], "owner": {"reputation": 56, "user_id": 8177594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f32e63365773322585c847ebefe2a11c?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Bland", "link": "https://stackoverflow.com/users/8177594/mitchell-bland"}, "is_accepted": true, "score": 2, "last_activity_date": 1535548681, "creation_date": 1535548681, "answer_id": 52078437, "question_id": 52077668, "link": "https://stackoverflow.com/questions/52077668/documents-open-gives-locked-for-editing-error-while-document-is-closed/52078437#52078437", "title": "Documents.Open gives &#39;Locked for editing&#39; error while document is closed", "body": "<p>I've had this happen before, the issue for me was that a previous run of the macro wasn't able to close the file properly. Give this thread a read:\n<a href=\"https://stackoverflow.com/questions/18738677/vba-application-quit-command-not-closing-the-entire-excel-application\">VBA Application.Quit command not closing the entire Excel Application</a></p>\n\n<p>You could test to see if this is the case by \"End Task\"ing all MS Word instances and running your macro again, If it's able to run the first time, then this is your issue.</p>\n\n<p>Also, This is the code I used for testing. Dim'ing the variables as \"Word.Application\" didn't work for me, so if my earlier suggestion doesn't work then try just \"Object\" instead:</p>\n\n<pre><code>Sub openWord()\n\n    Dim wrd As Object\n    Dim doc As Object\n\n    Set wrd = CreateObject(\"Word.Application\")\n    wrd.Visible = True\n    Set doc = wrd.Documents.Open(\"C:\\Users\\mitchellb\\Desktop\\doc.docx\")\n\n    doc.Close\n    wrd.Quit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9354065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d266649f004299b683f90cba6ddf9fc?s=128&d=identicon&r=PG&f=1", "display_name": "RAH", "link": "https://stackoverflow.com/users/9354065/rah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2076, "favorite_count": 0, "accepted_answer_id": 52078437, "answer_count": 1, "score": 0, "last_activity_date": 1593415313, "creation_date": 1535546287, "last_edit_date": 1593415313, "question_id": 52077668, "link": "https://stackoverflow.com/questions/52077668/documents-open-gives-locked-for-editing-error-while-document-is-closed", "title": "Documents.Open gives &#39;Locked for editing&#39; error while document is closed", "body": "<p>When using the Documents.Open(\"XX\") command in excel. My excel prompts the window where it says that the document is lock for editing, by ME. Which isn't the case. </p>\n\n<p>This command does seem to work when i'm using microsoft word/excel 2010 at work. But at home, using office 2016, it doesn't. This goes for my personal laptop with office 2016 aswell.</p>\n\n<p>The following code is used:</p>\n\n<pre><code>Sub test()\n\nDim wordDoc As Word.Application\nDim testDoc As Word.Application\n\nSet wordDoc = CreateObject(\"Word.Application\")\nSet testDoc = wordDoc.Documents.Open(\"C:\\Users\\Me\\Desktop\\Test.docm\")\n\n' Do stuff\n\nEnd Sub\n</code></pre>\n\n<p>My thoughts:</p>\n\n<p>Office 2016 seems to open a 'Shadow file' which gives the document 'Open' status. But when restarting my PC the code simply does NOT work. Giving an 'Filename' error, upon restarting the code the 'Locked for editing' error appears.</p>\n\n<p>My question:</p>\n\n<p>Am i using the wrong approach on opening a document in Office 2016? If so, what is the right approach? If not, are there settings that need to be changed in order for this to work?</p>\n\n<p>Thanks in advance,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1535544836, "post_id": 52077165, "comment_id": 91104046, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Get rid of .Select to start with</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1535544969, "post_id": 52077165, "comment_id": 91104146, "body": "The above has typos and is missing line breaks btw. E.g. Applicaation.Calculation = xlCalculationAutomatic So it shouldn&#39;t run at all. Correct those and see what happens."}, {"owner": {"reputation": 53, "user_id": 10289768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bba7cbc68c04f5d4bba31faa430147?s=128&d=identicon&r=PG&f=1", "display_name": "ya23", "link": "https://stackoverflow.com/users/10289768/ya23"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535545989, "post_id": 52077165, "comment_id": 91104792, "body": "But the issue is, when it runs to xlCalculationAutomatic, it takes a long time to process"}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1535546255, "post_id": 52077165, "comment_id": 91104983, "body": "@Zy23 then it sounds like this VBA is not your problem at all, but that your workbook it self is just very slow. Do you have a lot of <a href=\"http://www.decisionmodels.com/calcsecretsi.htm\" rel=\"nofollow noreferrer\">volatile functions</a> in your workbook? Or maybe a lot of <code>VLOOKUP</code> or <code>MATCH</code> over very large ranges?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535546408, "post_id": 52077165, "comment_id": 91105086, "body": "Should your initial ActiveWorkbook referenced here: Set wbThis = ActiveWorkbook  be ThisWorkbook? i.e. the workbook containing the code?"}, {"owner": {"reputation": 53, "user_id": 10289768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bba7cbc68c04f5d4bba31faa430147?s=128&d=identicon&r=PG&f=1", "display_name": "ya23", "link": "https://stackoverflow.com/users/10289768/ya23"}, "reply_to_user": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1535546576, "post_id": 52077165, "comment_id": 91105213, "body": "@Dan Yes it has a lot of volatile functions but then I&#39;ve another code which copies a larger set of data than this but it takes 3-4mins to run. The code is similar to the one above."}, {"owner": {"reputation": 53, "user_id": 10289768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bba7cbc68c04f5d4bba31faa430147?s=128&d=identicon&r=PG&f=1", "display_name": "ya23", "link": "https://stackoverflow.com/users/10289768/ya23"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535546596, "post_id": 52077165, "comment_id": 91105234, "body": "@QHarr Yes the ActiveWorkbook is containing the code"}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1535547310, "post_id": 52077165, "comment_id": 91105765, "body": "@Zy23 perhaps you can paste over some of those functions as values? Either keep the bottom few rows as formulae in case you need to expand them down, or else use VBA to paste the formulae in (using R1C1 notation) and then paste them as values..."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1535547935, "post_id": 52077800, "comment_id": 91106254, "body": "Hummm.... a downvote for being helpful. Would the downvoter care to comment on how the above is not helpful?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1535549626, "last_edit_date": 1535549626, "creation_date": 1535546629, "answer_id": 52077800, "question_id": 52077165, "link": "https://stackoverflow.com/questions/52077165/vba-code-takes-too-long-to-run/52077800#52077800", "title": "VBA Code takes too long to Run", "body": "<p>Maybe something like as follows for starters. Ideally, the optimization steps would go in their own subs. One to switch on optimization at the start and the other to return everything to how it was at the end (or on error). </p>\n\n<p>As requested, this shows you how to remove the .Select parts of your code by using With statements. It also includes a safe exit, in case of error, to switch back on everything you disabled.</p>\n\n<pre><code>Option Explicit\nPublic Sub ImportRemarks()\n    Dim PLPath As String, wbThis As Workbook, wbTarget As Workbook\n\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    On Error GoTo Errhand\n    Set wbThis = ThisWorkbook\n    Set wbTarget = Workbooks.Open(PLPath)\n    PLPath = wbThis.Worksheets(\"Instructions\").Range(\"C16\").Text\n\n    wbTarget.Worksheets(\"Performance List\").Rows(\"1:2\").UnMerge\n\n    With wbThis.Worksheets(\"keys\")\n        .Range(\"I:I\") = wbTarget.Worksheets(\"Performance List\").Range(\"F:F\")\n        .Range(\"J:L\") = wbTarget.Worksheets(\"Performance List\").Range(\"P:R\")\n    End With\n\n    wbTarget.Close savechanges:=False\n\n    With wbThis\n        .Activate\n        ' .Worksheets(\"Instructions\").Range(\"C22\").Activate '&lt;=consider whether this is needed?\n    End With\n\nErrhand:\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>More info on optimization here:</p>\n\n<p><a href=\"https://www.thespreadsheetguru.com/blog/2015/2/25/best-way-to-improve-vba-macro-performance-and-prevent-slow-code-execution\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2015/2/25/best-way-to-improve-vba-macro-performance-and-prevent-slow-code-execution</a></p>\n\n<p><a href=\"http://www.cpearson.com/excel/optimize.htm\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/optimize.htm</a></p>\n"}], "owner": {"reputation": 53, "user_id": 10289768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4bba7cbc68c04f5d4bba31faa430147?s=128&d=identicon&r=PG&f=1", "display_name": "ya23", "link": "https://stackoverflow.com/users/10289768/ya23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1535549626, "creation_date": 1535544735, "last_edit_date": 1535546301, "question_id": 52077165, "link": "https://stackoverflow.com/questions/52077165/vba-code-takes-too-long-to-run", "title": "VBA Code takes too long to Run", "body": "<p>Please see the below VBA Code that I've came up with. Essentially, this is to open another workbook, Unmerge the Rows, Copy the Columns and Paste it into my Active Workbook. However after copy pasting, when the code runs to the CalculationAutomatic line, it takes around 15mins. Is there any other way to make it more efficient?\nThank you</p>\n\n<pre><code>Option Explicit\n\nSub ImportRemarks()\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n\nDim PLPath As String\nPLPath = Sheets(\"Instructions\").Range(\"C16\").Text\nDim wbThis As Workbook\nDim wbTarget As Workbook\nSet wbThis = ActiveWorkbook\nSet wbTarget = Workbooks.Open(PLPath)\n\nwbTarget.Worksheets(\"Performance List\").Select\nRows(\"1:2\").Select\nSelection.UnMerge\nwbThis.Worksheets(\"keys\").Range(\"I:I\").Value = \nwbTarget.Worksheets(\"Performance List\").Range(\"F:F\").Value\nwbThis.Worksheets(\"keys\").Range(\"J:L\").Value = \nwbTarget.Worksheets(\"Performance List\").Range(\"P:R\").Value\nwbThis.Activate\nApplication.CutCopyMode = False\nwbTarget.Close savechanges:=False\n\nActiveWorkbook.Sheets(\"Instructions\").Select\nRange(\"C22\").Select\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10234276, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-32Rgbv29KR4/AAAAAAAAAAI/AAAAAAAAACg/WbIyM-r0DlA/photo.jpg?sz=128", "display_name": "Patrick Honey", "link": "https://stackoverflow.com/users/10234276/patrick-honey"}, "edited": false, "score": 0, "creation_date": 1535609992, "post_id": 52077050, "comment_id": 91130515, "body": "Thanks, @Darren your solution works. There is one minor though. <code>ActiveWorkbook.Name</code> includes the original file extension, so currently the result is <b>Sheetname.xlsm 30-08-2018.xlsx</b> No exactly what is needed. Is there a way to remove the <i>.xlsm</i> from the original file name?"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1535544406, "creation_date": 1535544406, "answer_id": 52077050, "question_id": 52076847, "link": "https://stackoverflow.com/questions/52076847/save-under-current-file-name-with-date-attached/52077050#52077050", "title": "Save under current file name with date attached", "body": "<p>You've included <code>FName</code> within the string so it's being treated as just text.</p>\n\n<pre><code>ActiveWorkbook.SaveAs (\"C:\\Users\\ME\\FOLDER1\\FOLDER2\\SHEETS1\\SHEETS2\\ FName \" &amp; Format(Now(), \"DD-MM-YYYY\" &amp; \".xlsx\"))  \n</code></pre>\n\n<p>should be  </p>\n\n<pre><code>ActiveWorkbook.SaveAs (\"C:\\Users\\ME\\FOLDER1\\FOLDER2\\SHEETS1\\SHEETS2\\\" &amp; FName &amp; Format(Now(), \"DD-MM-YYYY\" &amp; \".xlsx\"))  \n</code></pre>\n\n<p>or you could remove <code>FName</code> completely and use the <code>ActiveWorkbook.Name</code>:  </p>\n\n<pre><code>ActiveWorkbook.SaveAs (\"C:\\Users\\ME\\FOLDER1\\FOLDER2\\SHEETS1\\SHEETS2\\\" &amp; ActiveWorkbook.Name &amp; Format(Now(), \"DD-MM-YYYY\" &amp; \".xlsx\"))\n</code></pre>\n\n<p>You may want to add a space between <code>FName</code> and the date.  Rather than include an extra <code>&amp; \" \" &amp;</code> next to <code>Fname</code> you could use:   </p>\n\n<pre><code>Format(Now(), \" DD-MM-YYYY\" &amp; \".xlsx\")  \n</code></pre>\n\n<p>This adds the extra space in the date formatting.</p>\n"}], "owner": {"reputation": 3, "user_id": 10234276, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-32Rgbv29KR4/AAAAAAAAAAI/AAAAAAAAACg/WbIyM-r0DlA/photo.jpg?sz=128", "display_name": "Patrick Honey", "link": "https://stackoverflow.com/users/10234276/patrick-honey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3907, "favorite_count": 0, "accepted_answer_id": 52077050, "answer_count": 1, "score": 0, "last_activity_date": 1565525707, "creation_date": 1535543727, "last_edit_date": 1565525707, "question_id": 52076847, "link": "https://stackoverflow.com/questions/52076847/save-under-current-file-name-with-date-attached", "title": "Save under current file name with date attached", "body": "<p>I have several Excel files to save under their current file name with today's date attached but in a different folder.</p>\n\n<p>As these files all have different names my approach is get their file name as a variable and use it for the name to save under. Since I want to avoid writing a macro for each file, the idea of putting the desired name into one cell and then using that value (which works) for saving it, is not an option.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Save_Workbook()\n\n' Save Sheet with Current Date\n' Adjust Absolute Path to Location Where to Save the Workbook\n\nDim FName As String\n\nFName = ActiveWorkbook.Name\n\nActiveWorkbook.SaveAs (\"C:\\Users\\ME\\FOLDER1\\FOLDER2\\SHEETS1\\SHEETS2\\ FName \" &amp; Format(Now(), \"DD-MM-YYYY\" &amp; \".xlsx\"))\n\nEnd Sub\n</code></pre>\n\n<p>This macro saves the file in the desired folder and with the date attached, but it does not pick up the self-defined variable <strong>FName</strong>. The resulting file name is <em>FName 29-09-2018</em> for example.</p>\n"}, {"tags": ["vba", "excel", "merge"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 10172189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47d805f29d632e6a7b58a1d4d215c6f?s=128&d=identicon&r=PG&f=1", "display_name": "ilyes", "link": "https://stackoverflow.com/users/10172189/ilyes"}, "edited": false, "score": 0, "creation_date": 1535548881, "post_id": 52077319, "comment_id": 91106920, "body": "Hello - thank you for your feedback :-) - I tries but it seems that my knowledge is not enought to fix it - could you please update my code and send it to me to check if it works after the update ? if you refuse and I understand :-) - thank you"}], "tags": [], "owner": {"reputation": 81, "user_id": 5467038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d9a00b37650ee367d006d1daebb007?s=128&d=identicon&r=PG&f=1", "display_name": "Sama Tori", "link": "https://stackoverflow.com/users/5467038/sama-tori"}, "is_accepted": false, "score": 1, "last_activity_date": 1535545142, "creation_date": 1535545142, "answer_id": 52077319, "question_id": 52076564, "link": "https://stackoverflow.com/questions/52076564/merge-several-sheets-from-different-workbooks-in-1-file-to-workbook-which-cont/52077319#52077319", "title": "merge several sheets from different workbooks (in 1 file) to workbook which contain 1 sheet &quot;sheets1&quot;", "body": "<p>There's some flaws in your code. For example, when you assign lastrow, you position the cell in last row (rows.count) and then end(xlDown), which will remain in last row. That should be end(xlUp) if you intend to get the last used row in column 1. The same issue goes for lastcolumn.</p>\n\n<p>Also, I don't see how filename is going to change with every iteration. I normally do the following if I want to iterate a list of files within a directory:</p>\n\n<pre><code>Dim fs, f, files, curfile\nDim i As Integer\n\nSet fs = CreateObject(\"Scripting.FileSystemObject\")\nSet f = fs.GetFolder(path-to-folder)\nSet files = f.Files\ni = 5\n\nFor Each curfile In files\n   ... whatever you need to be done with every file ...\nNext\n</code></pre>\n\n<p>Also, when pasting the data you have to first select the upper left corner, and then do Activesheet.Paste. In this case:</p>\n\n<pre><code>x.Worksheets(\"sheet1\").Cells(erow, 1).Select\nActiveSheet.Paste\n</code></pre>\n\n<p>But bear in mind that you are closing the source of the data being pasted before the actual pasting, and also that every iteration of the loop you are opening the destination file (smer), which will result in error. That destination file should be already open when the loop begins.</p>\n\n<p>Hope this helps for your workings</p>\n"}], "owner": {"reputation": 55, "user_id": 10172189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47d805f29d632e6a7b58a1d4d215c6f?s=128&d=identicon&r=PG&f=1", "display_name": "ilyes", "link": "https://stackoverflow.com/users/10172189/ilyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1535545142, "creation_date": 1535542711, "question_id": 52076564, "link": "https://stackoverflow.com/questions/52076564/merge-several-sheets-from-different-workbooks-in-1-file-to-workbook-which-cont", "title": "merge several sheets from different workbooks (in 1 file) to workbook which contain 1 sheet &quot;sheets1&quot;", "body": "<p>The idea is to merge all sheets1 which are in workbooks which are located in file \"Filepath\" to  workbooks , sheet \"Summary\"\nall files having the same header so there is no a need to copy past the header\nEx : 2 files <a href=\"https://i.stack.imgur.com/9PJy0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9PJy0.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hereby my code which I manage to type : </p>\n\n<pre><code>Sub collate_data()\nDim folderpath As String\nDim filepath As String\nDim filename As String\nDim final As String\n\n\n\nfolderpath = ThisWorkbook.Sheets(\"input\").Cells(1, 2).Text\nfilepath = folderpath &amp; \"*xlsx*\"\nfilename = Dir(filepath)\nsmer = ThisWorkbook.Sheets(\"input\").Cells(3, 2).Text\nDim lastrow As Long\nDim lastcolumn As Long\n\nDo While filename &lt;&gt; \"\"\nfinal = ThisWorkbook.Sheets(\"input\").Cells(6, 2).Text\n y = final &amp; \"Summary.xlsx\"\n\nWorkbooks.Open (folderpath &amp; filename)\n\nlastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlDown).Row\nlastcolumn = ActiveSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nRange(Cells(2, 1), Cells(lastrow, lastcolumn)).Select\nRange(Cells(2, 1), Cells(lastrow, lastcolumn)).Copy\nApplication.DisplayAlerts = False\nActiveWorkbook.Close\n\nSet x = Workbooks.Open(smer)\nerow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\nActiveSheet.Paste = Worksheets(\"sheet1\").Range(Cells(erow, 1), Cells(erow, 1))\n\n\nfilename = Dir\nLoop\nApplication.DisplayAlerts = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 1, "creation_date": 1535542552, "post_id": 52076442, "comment_id": 91102571, "body": "Please be aware that this website does is not a code writing service, (sometimes you may be lucky and someone will help). Please look at creating a good question. provide examples of what you have tried and where the issues are along with sample data and expected outcome."}], "answers": [{"comments": [{"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1535544494, "post_id": 52076655, "comment_id": 91103808, "body": "I did not vote, however <a href=\"https://stackoverflow.com/help/how-to-answer\">answer well-asked questions</a> might be the cause. Again - it is just an assumption."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1535544787, "post_id": 52076655, "comment_id": 91104012, "body": "I up-voted the answer and down-voted the question and also flagged it to  be closed as too broad. I do not think this question deserves an answer but if one answers this might be the best way to do it. Question is: Is there anything here to link to in the comment in such cases. I sometimes link to this <a href=\"https://excelmacromastery.com/vba-tutorial-1/\" rel=\"nofollow noreferrer\">site</a>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1535547024, "post_id": 52076655, "comment_id": 91105556, "body": "@Storax - agreed. This is one of my &quot;standard&quot; comments on questions - then I realized this time it actually works as an answer.  ...also thank - that tutorial is indeed another good VBA tutorial to recommend, whose URL I lost a while back."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1535547258, "post_id": 52076655, "comment_id": 91105716, "body": "@scopchanov - I also vtc but I believe it&#39;s helpful if a user get a clue on how to proceed next time, be it tips on <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> or even a vague answer like mine - thus helping prevent unclear questions in the future."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1535547712, "post_id": 52076655, "comment_id": 91106063, "body": "@ashleedawg, I understand you, however it was just a guess, what might have been the cause."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1535547112, "last_edit_date": 1535547112, "creation_date": 1535543067, "answer_id": 52076655, "question_id": 52076442, "link": "https://stackoverflow.com/questions/52076442/creating-macro-in-excel/52076655#52076655", "title": "creating macro in excel", "body": "<p>Macros are recorded with the Macro Recorder, where Excel generates VBA code based on your actions, which you can then modify as required.  </p>\n\n<p>See:  </p>\n\n<ul>\n<li><p>MSDN : <a href=\"//msdn.microsoft.com/vba/word-vba/articles/recording-a-macro-to-generate-code\" rel=\"nofollow noreferrer\"><strong>Recording a Macro to Generate Code</strong></a>, <em>and,</em>  </p></li>\n<li><p>MSDN : <a href=\"//msdn.microsoft.com/vba/word-vba/articles/revising-recorded-visual-basic-macros\" rel=\"nofollow noreferrer\"><strong>Revising Recorded Visual Basic Macros</strong></a>. </p></li>\n</ul>\n\n<hr>\n\n<p>It's best to be <em>\"very familiar\"</em> with Excel before trying to automate tasks with VBA.  </p>\n\n<p>These is a VBA tutorials are recommended as quite good/thorough/accurate:  </p>\n\n<ul>\n<li><a href=\"//www.homeandlearn.org/\" rel=\"nofollow noreferrer\"><strong>Excel VBA For Beginners</strong></a>  </li>\n<li><a href=\"https://excelmacromastery.com/vba-tutorial-1/\" rel=\"nofollow noreferrer\"><strong>Ultimate VBA Tutorial</strong></a></li>\n</ul>\n\n<p>The most important documentation for VBA is from the 'official' source:   </p>\n\n<ul>\n<li><a href=\"//msdn.microsoft.com/vba/vba-language-reference\" rel=\"nofollow noreferrer\"><strong>Microsoft's VBA Documentation</strong></a>.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 10289614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2deb2ca90fed969d2ee7e50ece7e49c7?s=128&d=identicon&r=PG&f=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/10289614/siva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1535611216, "creation_date": 1535542306, "last_edit_date": 1535611216, "question_id": 52076442, "link": "https://stackoverflow.com/questions/52076442/creating-macro-in-excel", "title": "creating macro in excel", "body": "<p>Please help me on creating a macro which search multiple sheets in a workbook for a particular column and display the count of values in that column and display in a new sheet with sheet name and the count.</p>\n\n<p>Am having 3 sheets with the name A, B &amp; C. I have tried the below code, but it is not calculating based on the column header name.</p>\n\n<p>I have columns like </p>\n\n<p>Company     Company     Company\nABC         ABC         ABC \n            DEF\nGHI<br>\nJKL     </p>\n\n<p>and the result should looks like</p>\n\n<p>Sheet name  Count\nA             1\nB             3\nC             2</p>\n\n<p>Sub Click()\n    Dim sh As Worksheet, ws As Worksheet, LstRw As Long, x, s As String\n    Dim rng1 As Range</p>\n\n<pre><code>Set ws = Sheets.Add\nws.Name = \"Report\"\ns = \"A\"\nFor Each sh In Sheets\n    If sh.Name &lt;&gt; ws.Name Then\n        With sh\n\n              x = Application.WorksheetFunction.CountA(.Range(\"A:A\"))\n            With ws\n                LstRw = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n                .Cells(LstRw, 1) = sh.Name\n                .Cells(LstRw, 2) = x\n\n            End With\n        End With\n    End If\nNext sh\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-access", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1535541870, "creation_date": 1535541870, "answer_id": 52076321, "question_id": 52076102, "link": "https://stackoverflow.com/questions/52076102/word-vba-add-inlineshape-object-to-table-cell/52076321#52076321", "title": "Word VBA Add Inlineshape Object to Table Cell", "body": "<p>Try adding the table first, and then directly adding the <em>Foto</em> to that table by specifying the range on <code>.AddPicture</code>:</p>\n\n<pre><code>Set tblNew = WordObj.Tables.Add(Range:=myRange, NumRows:=2, NumColumns:=1, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:=wdAutoFitWindow)\nDim Foto As Inlineshape\nSet Foto = WordObj.InlineShapes.AddPicture(FileName:=\"C:\\Test.jpg\", Range:=tblNew.Cell(1, 1).Range)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10097744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFW1a5m_rd4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o3bCk3_FGs8Ox42Z5MZI6Tv7cuSw/mo/photo.jpg?sz=128", "display_name": "Andwee", "link": "https://stackoverflow.com/users/10097744/andwee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 52076321, "answer_count": 1, "score": 2, "last_activity_date": 1593415330, "creation_date": 1535541208, "last_edit_date": 1593415330, "question_id": 52076102, "link": "https://stackoverflow.com/questions/52076102/word-vba-add-inlineshape-object-to-table-cell", "title": "Word VBA Add Inlineshape Object to Table Cell", "body": "<p>I'm creating a Word Document from MS Access VBA\nI want to add an Inlineshape Object to a Table Cell:</p>\n\n<p>I create the Foto Object like that:</p>\n\n<pre><code>Dim Foto As Inlineshape\nSet Foto = WordObj.InlineShapes.AddPicture(FileName:=\"C:\\Test.jpg\")\n</code></pre>\n\n<p>then I create my table to insert it.</p>\n\n<pre><code>Set tblNew = WordObj.Tables.Add(Range:=myRange, NumRows:=2, NumColumns:=1, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:=wdAutoFitWindow)\n</code></pre>\n\n<p>How can I add the Foto object to a table cell?\nI tried something like this</p>\n\n<pre><code>tblNew.Cell(1, 1).Range = Foto\n</code></pre>\n\n<p>but it does not work</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535543443, "post_id": 52075448, "comment_id": 91103129, "body": "You can use <code>WorksheetFunction.CountA( &lt;row&gt; )</code> to see which rows are empty"}, {"owner": {"reputation": 11, "user_id": 7766641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf91bd7f7399d237cb1cfbe910b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Hadjiev", "link": "https://stackoverflow.com/users/7766641/nicholas-hadjiev"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535554415, "post_id": 52075448, "comment_id": 91110896, "body": "I am not a coder this is for a work project to simplify my data into a master sheet if you could please provide an example."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536169194, "post_id": 52075448, "comment_id": 91331174, "body": "Could you upload a picture of mock data that you&#39;re working with and then explain more clearly what it is you&#39;re looking to be done to that data?"}, {"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1593771247, "post_id": 52075448, "comment_id": 110902038, "body": "Consider using <code>SpecialCells(xlCellTypeBlank)</code> on your range object (<code>B5:N5</code>). See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.specialcells\" rel=\"nofollow noreferrer\">msdn documentation</a> and also <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlcelltype\" rel=\"nofollow noreferrer\">xlType enumeration</a>."}], "owner": {"reputation": 11, "user_id": 7766641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf91bd7f7399d237cb1cfbe910b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Hadjiev", "link": "https://stackoverflow.com/users/7766641/nicholas-hadjiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593770923, "creation_date": 1535539262, "last_edit_date": 1593770923, "question_id": 52075448, "link": "https://stackoverflow.com/questions/52075448/excel-vb-macro-copy-data", "title": "Excel VB macro copy data", "body": "<p>This macro serves the purpose to copy data from multiple excel sheets from a designated source range and then copies it to a master sheet.</p>\n\n<p>I'm very limited when it comes to VB knowledge. If possible can we augment the macro to skip copying any rows that have blank cells, like a filter? Below the source range is set to B5:N6. Based on our excel sheets column B can be used as a means to apply this filter, i.e. if any cell in column B is empty, then skip that entire row in the copy process. The output would then need to be condensed and not include any spaces between the copied entries as a result of the skipped rows. </p>\n\n<pre><code>If VBA7 Then\n   Declare PtrSafe Function SetCurrentDirectoryA Lib _\n   \"kernel32\" (ByVal lpPathName As String) As Long\nElse\n   Declare Function SetCurrentDirectoryA Lib _\n   \"kernel32\" (ByVal lpPathName As String) As Long\nEnd If\n\n\nSub ChDirNet(szPath As String)\n    SetCurrentDirectoryA szPath\nEnd Sub\n\nSub Basic_Example_2()\n    Dim MyPath As String\n    Dim SourceRcount As Long, Fnum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n    Dim SaveDriveDir As String\n    Dim FName As Variant\n\n\n    'Change ScreenUpdating, Calculation and EnableEvents\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    SaveDriveDir = CurDir\n    ChDirNet \"C:\\Test\\\"\n\n    FName = Application.GetOpenFilename(filefilter:=\"Excel Files (*.xl*), *.xl*\", _\n                                        MultiSelect:=True)\n    If IsArray(FName) Then\n\n        'Add a new workbook with one sheet\n        Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n        rnum = 1\n\n\n        'Loop through all files in the array(myFiles)\n        For Fnum = LBound(FName) To UBound(FName)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(FName(Fnum))\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n\n                On Error Resume Next\n                With mybook.Worksheets(1)\n                    Set sourceRange = .Range(\"B5:N6\")\n\n                End With\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    'if SourceRange use all columns then skip this file\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n                On Error GoTo 0\n\n\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.Rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                        MsgBox \"Sorry there are not enough rows in the sheet\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close savechanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        'Set the destrange\n                        Set destrange = BaseWks.Range(\"A\" &amp; rnum)\n\n                        'we copy the values from the sourceRange to the destrange\n                        With sourceRange\n                            Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                        End With\n                        destrange.Value = sourceRange.Value\n\n                        rnum = rnum + SourceRcount\n                    End If\n                End If\n                mybook.Close savechanges:=False\n            End If\n\n        Next Fnum\n        BaseWks.Columns.AutoFit\n    End If\n\nExitTheSub:\n    'Restore ScreenUpdating, Calculation and EnableEvents\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n    ChDirNet SaveDriveDir\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 270, "user_id": 2497152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OfDad.jpg?s=128&g=1", "display_name": "spikey_richie", "link": "https://stackoverflow.com/users/2497152/spikey-richie"}, "edited": false, "score": 0, "creation_date": 1535539047, "post_id": 52075201, "comment_id": 91100342, "body": "I had a quick play with it and I couldn&#39;t get it to break. You might want to try debugging it using debug.print x and enable the immediate window to review the values being assigned to x as you change selection"}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 2, "creation_date": 1535539065, "post_id": 52075201, "comment_id": 91100355, "body": "Do you only get the error when you are clearing more than one cell at a time?"}, {"owner": {"reputation": 73, "user_id": 5568341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6560ef49bbfb8c411bfb3ed015ceb518?s=128&d=identicon&r=PG&f=1", "display_name": "Georgi", "link": "https://stackoverflow.com/users/5568341/georgi"}, "reply_to_user": {"reputation": 270, "user_id": 2497152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OfDad.jpg?s=128&g=1", "display_name": "spikey_richie", "link": "https://stackoverflow.com/users/2497152/spikey-richie"}, "edited": false, "score": 0, "creation_date": 1535539726, "post_id": 52075201, "comment_id": 91100757, "body": "@spikey_richie , when I press space on a selected cell(when I want to clear the cell) then in shows the error. I tried the debugging with debug.print and the right values are assigned, when I change the selection"}, {"owner": {"reputation": 73, "user_id": 5568341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6560ef49bbfb8c411bfb3ed015ceb518?s=128&d=identicon&r=PG&f=1", "display_name": "Georgi", "link": "https://stackoverflow.com/users/5568341/georgi"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 1, "creation_date": 1535539752, "post_id": 52075201, "comment_id": 91100781, "body": "@Olly I am getting the error when clearing one or more cells(when pressing a space), or selecting more cells."}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 3, "creation_date": 1535539875, "post_id": 52075201, "comment_id": 91100857, "body": "@Georgi Pressing space is not the same as clearing a cell. You&#39;re then trying to ADD a space to a number value. You need to test that your <code>Target.Value</code> is a number before you try to add it to <code>x</code>."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1535540964, "post_id": 52075201, "comment_id": 91101570, "body": "@Georgi what exactly are you trying to achieve? I can tell you why your code isn&#39;t working, but I can&#39;t answer what you should do to fix it unless you provide further context of the expected behaviour of your program"}, {"owner": {"reputation": 73, "user_id": 5568341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6560ef49bbfb8c411bfb3ed015ceb518?s=128&d=identicon&r=PG&f=1", "display_name": "Georgi", "link": "https://stackoverflow.com/users/5568341/georgi"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1535541373, "post_id": 52075201, "comment_id": 91101840, "body": "@Olly I added this statement, so I can test the Target: &quot;If IsNumeric(Target.Value) Then Target = Target + x&quot;. Now I think, it works fine. Thank you"}, {"owner": {"reputation": 73, "user_id": 5568341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6560ef49bbfb8c411bfb3ed015ceb518?s=128&d=identicon&r=PG&f=1", "display_name": "Georgi", "link": "https://stackoverflow.com/users/5568341/georgi"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1535541551, "post_id": 52075201, "comment_id": 91101951, "body": "@Rawrplus The idea is to ADD values to a cell(number), now I clear the cell with a space, because when I type 0, it adds 0 to the cell."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1535541747, "post_id": 52075201, "comment_id": 91102095, "body": "@Georgi <code>0</code> does not equal to <code>Empty</code> though. Further proven by the fact, the native <code>IsEmpty()</code> method returns as <code>False</code> on Cell containing <code>0</code>, you can explicitly check for values that are 0 and delete them though. Neither is a space, that is equal to string <code>&#39; &#39;</code>. If you do <code>Range</code> + <code>&#39; &#39;</code> it implicitly coerces to <code>Range.Value</code> and + acts as an implicit string concatenation in this case"}], "answers": [{"tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 0, "last_activity_date": 1535541129, "creation_date": 1535541129, "answer_id": 52076074, "question_id": 52075201, "link": "https://stackoverflow.com/questions/52075201/error-when-pressing-a-space-or-selecting-more-cells-run-time-error-13-type/52076074#52076074", "title": "Error when pressing a space, or selecting more cells: &quot;Run-Time error 13, type: mismatch&quot;", "body": "<p>Assuming you're trying to maintain an incremental sum of values entered in each cell that is colored light green...</p>\n\n<p>You need to deal with single cell values, and test they contain numbers:</p>\n\n<pre><code>Option Explicit\n\nPublic x As Double\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim c As Range\n    For Each c In Target.Cells\n        If c.Interior.ColorIndex = 35 Then\n            With Application\n                .EnableEvents = False\n                If IsNumeric(Target.Value) Then Target.Value = Target.Value + x\n                .EnableEvents = True\n            End With\n        End If\n    Next c\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Cells.Count = 1 Then\n        If IsNumeric(Target.Value) Then x = Target.Value\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5568341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6560ef49bbfb8c411bfb3ed015ceb518?s=128&d=identicon&r=PG&f=1", "display_name": "Georgi", "link": "https://stackoverflow.com/users/5568341/georgi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558728644, "creation_date": 1535538415, "last_edit_date": 1558728644, "question_id": 52075201, "link": "https://stackoverflow.com/questions/52075201/error-when-pressing-a-space-or-selecting-more-cells-run-time-error-13-type", "title": "Error when pressing a space, or selecting more cells: &quot;Run-Time error 13, type: mismatch&quot;", "body": "<p>My macro adds multiple values to a selected cell.</p>\n\n<p>When clearing one or more cells (when pressing a space), or selecting more cells, I am getting the error:</p>\n\n<blockquote>\n  <p>Run-Time error 13, type: mismatch</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nPublic x\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Interior.ColorIndex &lt;&gt; 35 Then Exit Sub\n\n    Application.EnableEvents = False\n    Target = Target + x\n\n    Application.EnableEvents = True\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    x = Target\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535543700, "post_id": 52075143, "comment_id": 91103298, "body": "Is this an option for you <a href=\"https://stackoverflow.com/questions/44127072/trigger-macro-when-any-cell-containing-formula-changes\" title=\"trigger macro when any cell containing formula changes\">stackoverflow.com/questions/44127072/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10054066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qph3Mse1ZIg/AAAAAAAAAAI/AAAAAAAADyQ/ynncgOngn0Q/photo.jpg?sz=128", "display_name": "Premier Hottubs", "link": "https://stackoverflow.com/users/10054066/premier-hottubs"}, "edited": false, "score": 0, "creation_date": 1535540794, "post_id": 52075843, "comment_id": 91101452, "body": "Yes but I don&#39;t think you can use Set xRg = Intersect(Target, Range(&quot;N1:N999&quot;)) in the same way. And Target isn&#39;t an object for Worksheet_Calculate()"}], "tags": [], "owner": {"reputation": 364, "user_id": 5229863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9106274e202c226490fa7f85b069f9?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/5229863/wouter"}, "is_accepted": false, "score": 0, "last_activity_date": 1535540450, "creation_date": 1535540450, "answer_id": 52075843, "question_id": 52075143, "link": "https://stackoverflow.com/questions/52075143/vba-send-email-when-cell-changes/52075843#52075843", "title": "VBA Send Email When Cell Changes", "body": "<p>you could use Worksheet_Calculate() event. each time your formulas are calculate, the event will be triggered</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 10054066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qph3Mse1ZIg/AAAAAAAAAAI/AAAAAAAADyQ/ynncgOngn0Q/photo.jpg?sz=128", "display_name": "Premier Hottubs", "link": "https://stackoverflow.com/users/10054066/premier-hottubs"}, "edited": false, "score": 0, "creation_date": 1535568376, "post_id": 52078839, "comment_id": 91118740, "body": "This looks great. I need to compare the changed cell in range N1:N999 with the correspoding row value for column F. So if Range(&quot;N1) = Range (&quot;F1&quot;) then. How would I modify this? Cheers"}, {"owner": {"reputation": 23, "user_id": 5417476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D3oXP.png?s=128&g=1", "display_name": "MehmetCanbulat", "link": "https://stackoverflow.com/users/5417476/mehmetcanbulat"}, "reply_to_user": {"reputation": 21, "user_id": 10054066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qph3Mse1ZIg/AAAAAAAAAAI/AAAAAAAADyQ/ynncgOngn0Q/photo.jpg?sz=128", "display_name": "Premier Hottubs", "link": "https://stackoverflow.com/users/10054066/premier-hottubs"}, "edited": false, "score": 0, "creation_date": 1536040098, "post_id": 52078839, "comment_id": 91268690, "body": "OldVal array holds the previous values and the cll range object holds the new value. You may embed your if statement inside for each loop construction. If you clarify your problem a little bit more, we can modify code. Right now i modified as much as i understand"}], "tags": [], "owner": {"reputation": 23, "user_id": 5417476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D3oXP.png?s=128&g=1", "display_name": "MehmetCanbulat", "link": "https://stackoverflow.com/users/5417476/mehmetcanbulat"}, "is_accepted": false, "score": 1, "last_activity_date": 1535549936, "creation_date": 1535549936, "answer_id": 52078839, "question_id": 52075143, "link": "https://stackoverflow.com/questions/52075143/vba-send-email-when-cell-changes/52078839#52078839", "title": "VBA Send Email When Cell Changes", "body": "<p>I hope it helps. I tried code as much as i understand the problem but in case of errors, you can modify it</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\nStatic OldVal() As Variant\nDim cll As Range\n\nReDim OldVal(1 To Range(\"N1:N999\").Cells.Count)\n\ni = 1\nFor Each cll In Range(\"N1:N999\")\n    If cll.Value &lt;&gt; OldVal(i) Then\n        OldVal(i) = cll.Value\n        i = i + 1\n    End If\nNext cll\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 5417476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D3oXP.png?s=128&g=1", "display_name": "MehmetCanbulat", "link": "https://stackoverflow.com/users/5417476/mehmetcanbulat"}, "is_accepted": false, "score": 0, "last_activity_date": 1536040180, "creation_date": 1536040180, "answer_id": 52159551, "question_id": 52075143, "link": "https://stackoverflow.com/questions/52075143/vba-send-email-when-cell-changes/52159551#52159551", "title": "VBA Send Email When Cell Changes", "body": "<pre><code>Private Sub Worksheet_Calculate()\n\nStatic OldVal() As Variant\nDim cll As Range\n\nReDim OldVal(1 To Range(\"N1:N999\").Cells.Count)\n\ni = 1\nFor Each cll In Range(\"N1:N999\")\n    If cll.Value &lt;&gt; OldVal(i) Then\n        OldVal(i) = cll.Value\n        i = i + 1\n        'This part compares your new value to F column value\n        'Change cll.value statement to oldval(i) to compare oldvalue and F column value\n        If cll.Value = Cells(cll.Row, \"F\").Value Then\n            'Your Code\n        End If\n    End If\nNext cll\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10054066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qph3Mse1ZIg/AAAAAAAAAAI/AAAAAAAADyQ/ynncgOngn0Q/photo.jpg?sz=128", "display_name": "Premier Hottubs", "link": "https://stackoverflow.com/users/10054066/premier-hottubs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "closed_date": 1547007483, "answer_count": 3, "score": 0, "last_activity_date": 1536040180, "creation_date": 1535538203, "last_edit_date": 1535540719, "question_id": 52075143, "link": "https://stackoverflow.com/questions/52075143/vba-send-email-when-cell-changes", "closed_reason": "Duplicate", "title": "VBA Send Email When Cell Changes", "body": "<p>This works great but only if the cells are changed directly erasing the formula. Each of the cells in my range contains a VLOOKUP formula that fetches a value from a long list of data in a separate sheet. These values are imported from a database and are refreshed every so often. Basically I need an alternative that triggers the email when cells change through the formula. I hope that makes sense.</p>\n\n<pre><code>Dim xRg As Range\n'Update by Extendoffice 2018/3/7\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    On Error Resume Next\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    Set xRg = Intersect(Target, Range(\"N1:N999\"))\n    If xRg Is Nothing Then Exit Sub\n    If (Range(\"N45\") = Range(\"F45\")) Then\n        Call Mail_small_Text_Outlook\n    End If\nEnd Sub\nSub Mail_small_Text_Outlook()\n    Dim xOutApp As Object\n    Dim xOutMail As Object\n    Dim xMailBody As String\n    Set xOutApp = CreateObject(\"Outlook.Application\")\n    Set xOutMail = xOutApp.CreateItem(0)\n    xMailBody = \"Hi there\" &amp; vbNewLine &amp; vbNewLine &amp; _\n          xRg.Offset(0, -12) &amp; \" has reached its target\"\n\n    On Error Resume Next\n    With xOutMail\n        .To = \"***@****.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Target Reached\"\n        .Body = xMailBody\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n    Set xOutMail = Nothing\n    Set xOutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "shift"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10263703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d980a004ef5fb9898289f3965f6f58?s=128&d=identicon&r=PG&f=1", "display_name": "Moby", "link": "https://stackoverflow.com/users/10263703/moby"}, "edited": false, "score": 0, "creation_date": 1535541739, "post_id": 52075674, "comment_id": 91102091, "body": "Yes and No. Yes, you answerd my question, the code works like that. But it inserts a new column two positions to the left and left one column free. Which makes sense.  And No, I hoped it will insert the new column between two existing columns"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 10263703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d980a004ef5fb9898289f3965f6f58?s=128&d=identicon&r=PG&f=1", "display_name": "Moby", "link": "https://stackoverflow.com/users/10263703/moby"}, "edited": false, "score": 1, "creation_date": 1535541796, "post_id": 52075674, "comment_id": 91102118, "body": "It moves the rmentioned column two to the right. Isn&#39;t that what you were after?"}, {"owner": {"reputation": 13, "user_id": 10263703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d980a004ef5fb9898289f3965f6f58?s=128&d=identicon&r=PG&f=1", "display_name": "Moby", "link": "https://stackoverflow.com/users/10263703/moby"}, "edited": false, "score": 0, "creation_date": 1535544190, "post_id": 52075674, "comment_id": 91103612, "body": "It shoud jump two positions to the left and insert there the new column. So it will be between two existing columns. Now it just inserts the column two positions to the left and leaves a free column."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 10263703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d980a004ef5fb9898289f3965f6f58?s=128&d=identicon&r=PG&f=1", "display_name": "Moby", "link": "https://stackoverflow.com/users/10263703/moby"}, "edited": false, "score": 0, "creation_date": 1535544552, "post_id": 52075674, "comment_id": 91103849, "body": "Have a look at the edit where it goes back two columns and inserts a column. Is that closer?"}, {"owner": {"reputation": 13, "user_id": 10263703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d980a004ef5fb9898289f3965f6f58?s=128&d=identicon&r=PG&f=1", "display_name": "Moby", "link": "https://stackoverflow.com/users/10263703/moby"}, "edited": false, "score": 0, "creation_date": 1535548282, "post_id": 52075674, "comment_id": 91106495, "body": "Somehow I&#180;m confused, how to address the variable column &quot;zelle_kostenstelle&quot; properly..."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1535549727, "last_edit_date": 1535549727, "creation_date": 1535539958, "answer_id": 52075674, "question_id": 52075046, "link": "https://stackoverflow.com/questions/52075046/excel-vba-shift-xltoleft-twice-possible/52075674#52075674", "title": "Excel VBA: Shift:=xlToLeft twice possible?", "body": "<p>Perhaps something like:</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim Zelle_kostenstelle As Range\n    Dim kostenstelle As String\n    kostenstelle = \"FindMe\"\n    With Worksheets(\"Tabelle1\")\n        Set Zelle_kostenstelle = .Range(\"1:1\").Find(kostenstelle)\n        If Not Zelle_kostenstelle Is Nothing Then '&lt; Test if anything was found\n            If Zelle_kostenstelle.Column &gt; 2 Then '&lt;Make sure you can go back to columns to do an insert\n                .Columns(Zelle_kostenstelle.Column - 2).Insert Shift:=xlToRight '&lt;perform the insert 2 columns to the left\n            End If\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10263703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d980a004ef5fb9898289f3965f6f58?s=128&d=identicon&r=PG&f=1", "display_name": "Moby", "link": "https://stackoverflow.com/users/10263703/moby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535549727, "creation_date": 1535537879, "last_edit_date": 1535547404, "question_id": 52075046, "link": "https://stackoverflow.com/questions/52075046/excel-vba-shift-xltoleft-twice-possible", "title": "Excel VBA: Shift:=xlToLeft twice possible?", "body": "<p><a href=\"https://i.stack.imgur.com/AVhzK.png\" rel=\"nofollow noreferrer\">Looks like this</a>I'm new to vba and struggling with the following problems.</p>\n\n<p>I have a formula in the column (let\u00b4s say) \"E:E\"* written (not in the VBA Code), now I insert a new column just right next to it (with the VBA Code). The problem is, my formula won\u00b4t extend automatically.</p>\n\n<p>Therefore when I change the place/position for the new added column, it will be between at least two already existing columns and the the formula will extend automatically...</p>\n\n<pre><code>Sub spalteeinfuegen1()\n    Set Zelle_kostenstelle = Worksheets(\"Tabelle1\").Range(\"1:1\").Find(kostenstelle) 'Suche der Kostenstelle in der Tabelle1\n    If Not Zelle_kostenstelle Is Nothing Then\n       Zelle_kostenstelle.EntireColumn.Insert Shift:=xlToLeft 'Einf\u00fcgen der Tabelle auf der linken Seite und Abbruch falls er den Eintrag nicht findet\n       Worksheets(\"Tabelle1\").Cells(1, Zelle_kostenstelle.Column - 1) = UserForm4.TextBox1.Text 'Text aus der UserForm \u00fcbertragen\n    End If\nEnd Sub\n</code></pre>\n\n<p>But how can I use Shift:=xlToLeft twice?</p>\n\n<p>*the column \"E:E\" is just an example. In the VBA code I call it \"kostenstelle\" as it changes with each new insert it\u00b4s Position.</p>\n\n<pre><code>Sub spalteeinfuegen1()\nSet Zelle_kostenstelle = Worksheets(\"Tabelle1\").Range(\"1:1\").Find(kostenstelle)\nZelle_kostenstelle.EntireColumn.Select\nWith Selection\n        If Selection.Column &gt; 2 Then\n        Debug.Print \",e\"\n        .Columns(.Columns(Selection).Column - 2).Insert Shift:=xlToLeft\n        Worksheets(\"Tabelle1\").Cells(1, Zelle_kostenstelle.Column - 2) = UserForm4.TextBox1.Text\n        End If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Somehow I\u00b4m confused, how to address the variable column \"zelle_kostenstelle\" properly...</p>\n"}, {"tags": ["vba", "excel", "directory", "wildcard"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1535537708, "post_id": 52074858, "comment_id": 91099473, "body": "How about <code>DirPath = Dir(&quot;C:\\Data\\* &quot; &amp; Batch &amp; &quot;*.csv&quot;, vbDirectory)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 8500782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rR2vM.png?s=128&g=1", "display_name": "the_big_goat", "link": "https://stackoverflow.com/users/8500782/the-big-goat"}, "edited": false, "score": 0, "creation_date": 1535539346, "post_id": 52075018, "comment_id": 91100526, "body": "Many thanks Xabier! Such a simple solution but it works perfectly. Thanks for taking the time to reply"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1535537791, "creation_date": 1535537791, "answer_id": 52075018, "question_id": 52074858, "link": "https://stackoverflow.com/questions/52074858/can-you-use-multiple-wildcards-in-the-vba-dir-function/52075018#52075018", "title": "Can you use multiple wildcards in the VBA Dir function?", "body": "<p>I believe the following will work as you expect it to, just added the <code>.csv</code> in your DirPath:</p>\n\n<pre><code>Sub FindBatchFile()\nDim Batch As Double\nDim DirPath As String, r As Integer\n\nBatch = InputBox(\"Enter Batch Number\")\n\nDirPath = Dir(\"C:\\Data\\* \" &amp; Batch &amp; \"*.csv\", vbDirectory)\nr = 1\nWorkbooks.Add\nMsgBox (DirPath)\n\nDo Until DirPath = \"\"\n    Cells(r, 1).Value = DirPath\n    MsgBox (DirPath)\n    r = r + 1\n    DirPath = Dir\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8500782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rR2vM.png?s=128&g=1", "display_name": "the_big_goat", "link": "https://stackoverflow.com/users/8500782/the-big-goat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "accepted_answer_id": 52075018, "answer_count": 1, "score": 1, "last_activity_date": 1535537791, "creation_date": 1535537350, "question_id": 52074858, "link": "https://stackoverflow.com/questions/52074858/can-you-use-multiple-wildcards-in-the-vba-dir-function", "title": "Can you use multiple wildcards in the VBA Dir function?", "body": "<p>I am working on a macro to output filenames. I have a directory containing log files for an industrial batch process. Each batch is assigned a 5-digit batch number, and for each batch there is a .csv and .txt file. The filename for both files is the same and contains the batch number, for example:</p>\n\n<pre><code>XYZ 53482 20180827.csv\nXYZ 53482 20180827.txt\nXYZ 53483 20180828.csv\nXYZ 53483 20180828.txt\nXYZ 53484 20180829.csv\nXYZ 53484 20180829.txt\n</code></pre>\n\n<p>My macro so far is:</p>\n\n<pre><code>Sub FindBatchFile()\nDim Batch As Double\nDim DirPath As String, r As Integer\n\nBatch = InputBox(\"Enter Batch Number\")\n\nDirPath = Dir(\"C:\\Data\\* \" &amp; Batch &amp; \"*\", vbDirectory)\nr = 1\nWorkbooks.Add\nMsgBox (DirPath)\n\nDo Until DirPath = \"\"\nCells(r, 1).Value = DirPath\nMsgBox (DirPath)\nr = r + 1\nDirPath = Dir\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>This works adequately but the output contains both .csv and .txt files. Is there a way of using multiple wildcards in the Dir function (ie. include a \"<code>*.csv</code>\" criterion as well as the \"<code>*Batch*</code>\")?</p>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1535536654, "post_id": 52074549, "comment_id": 91098835, "body": "what do you mean &quot;it stops&quot;?  Errors?  What have you tried?  There&#39;s tips in &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; as also <b>how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b>.  Also a handy checklist from the site&#39;s top user <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1535536992, "post_id": 52074549, "comment_id": 91099016, "body": "Also, <code>On Error Resume Next</code> should generally be avoided - and especially when troubleshooting a problem - since you&#39;re telling VBA that you don&#39;t even want to <i>know</i> about errors/mistakes.  It&#39;s beneficial to add <code>Option Explicit</code> as the first line of [every] module [always] to help ensure variables are properly declared/handled, this preventing mamy potential issues."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 6813404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f9fb414484cb5a7aeb91b6de19ce9e?s=128&d=identicon&r=PG&f=1", "display_name": "mhaverk", "link": "https://stackoverflow.com/users/6813404/mhaverk"}, "edited": false, "score": 0, "creation_date": 1535539995, "post_id": 52074647, "comment_id": 91100923, "body": "Thanks so much. That was the problem.:)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1535536727, "creation_date": 1535536727, "answer_id": 52074647, "question_id": 52074549, "link": "https://stackoverflow.com/questions/52074549/if-file-exists-save-as-with-timestamp/52074647#52074647", "title": "If file exists save as with timestamp", "body": "<p>You can't have <code>:</code> in filenames also you were missing a full stop <code>Format(DateTime.Now, \"yyyy-MM-dd hh:mm:ss\") &amp; \"xlsx\")</code> before the \"<strong>xlsx</strong>\" so the following will achieve what you expect:</p>\n\n<pre><code>Dim TestStr As String\n\nTestStr = \"\"\n\nOn Error Resume Next\nTestStr = Dir(FPath &amp; \"\\\" &amp; FName &amp; \".xlsx\")\n\nOn Error GoTo 0\nIf TestStr = \"\" Then\n    MsgBox \"New file name: \" &amp; FName &amp; \".xlsx\"\n    ActiveWorkbook.SaveAs Filename:=FPath &amp; \"\\\" &amp; FName &amp; \".xlsx\", FileFormat:=51\n    Workbooks(FName &amp; \".xlsx\").Close\n\n    '~~&gt; Mark as saved\n    Workbooks(\"Sample.xlsm\").Worksheets(\"Front Page\").Cells(Application.Match(\"Vendor\", Worksheets(\"Front Page\").Range(\"A1:A42\"), 0), 3).Value = \"OK\"\nElse\n    MsgBox \"File \" &amp; FName &amp; \".xslx\" &amp; \" already exist.\" &amp; vbCrLf &amp; \"New vesion saved with timestamp.\"\n    ActiveWorkbook.SaveAs (FPath &amp; \"\\\" &amp; FName &amp; Format(DateTime.Now, \"yyyy-MM-dd hh-mm-ss\") &amp; \".xlsx\")\n    Workbooks(FName &amp; Format(Now(), \"yyyy-MM-dd hh-mm-ss\") &amp; \".xlsx\").Close\nEnd If\n\nExit Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 6813404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f9fb414484cb5a7aeb91b6de19ce9e?s=128&d=identicon&r=PG&f=1", "display_name": "mhaverk", "link": "https://stackoverflow.com/users/6813404/mhaverk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 52074647, "answer_count": 1, "score": 0, "last_activity_date": 1594072283, "creation_date": 1535536429, "last_edit_date": 1594072283, "question_id": 52074549, "link": "https://stackoverflow.com/questions/52074549/if-file-exists-save-as-with-timestamp", "title": "If file exists save as with timestamp", "body": "<p>I am trying to get the following to work in my code. I was the macro to svae the file and if it already exists then to save as with an additional timestamp at the end. I have the following but it stops at \"ActiveWorkbook.SaveAs (FPath &amp; \"\\\" &amp; FName &amp; Format(DateTime.Now, \"yyyy-MM-dd hh:mm:ss\") &amp; \"xlsx\")\" Any suggestions what I am doing wrong? </p>\n\n<pre><code>'~~&gt; Save the file\n\nDim TestStr As String\n\nTestStr = \"\"\n\nOn Error Resume Next\nTestStr = Dir(FPath &amp; \"\\\" &amp; FName &amp; \".xlsx\")\n\nOn Error GoTo 0\nIf TestStr = \"\" Then\nMsgBox \"New file name: \" &amp; FName &amp; \".xlsx\"\nActiveWorkbook.SaveAs filename:=FPath &amp; \"\\\" &amp; FName &amp; \".xlsx\", FileFormat:=51\nWorkbooks(FName &amp; \".xlsx\").Close\n\n'~~&gt; Mark as saved\nWorkbooks(\"Sample.xlsm\").Worksheets(\"Front Page\").Cells(Application.Match(\"Vendor\", Worksheets(\"Front Page\").Range(\"A1:A42\"), 0), 3).Value = \"OK\"\n\nElse\nMsgBox \"File \" &amp; FName &amp; \".xslx\" &amp; \" already exist.\" &amp; vbCrLf &amp; \"New vesion saved with timestamp.\"\nActiveWorkbook.SaveAs (FPath &amp; \"\\\" &amp; FName &amp; Format(DateTime.Now, \"yyyy-MM-dd hh:mm:ss\") &amp; \"xlsx\")\nWorkbooks(FName &amp; Format(Now(), \"yyyy-MM-dd hh:mm:ss\") &amp; \".xlsx\").Close\n\nEnd If\n\nExit Sub\n</code></pre>\n"}, {"tags": ["excel", "string", "vba"], "comments": [{"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 2, "creation_date": 1535535996, "post_id": 52074343, "comment_id": 91098377, "body": "Welcome to Stackoverflow. This question is offtopic, because you ask us for you to find a tool to solve your problem. This is not how SO works :/"}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 1, "creation_date": 1535536036, "post_id": 52074343, "comment_id": 91098403, "body": "Btw, why are you tagging C++? There is nothing C++ related in your question :("}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1535536156, "post_id": 52074343, "comment_id": 91098489, "body": "You originally tagged this question with the C++ language tag (now edited away). Why? Are you programming in C++? Do you want a C++ solution? Or is this a pure Excel question?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 3, "creation_date": 1535536186, "post_id": 52074343, "comment_id": 91098515, "body": "<i>Welcome to Stack Overflow</i>  Be sure to check out the <a href=\"https://stackoverflow.com/tour\">tour</a> (you&#39;ll earn your first badge!) Could you please show a <b>sample</b> of your data, and expand on your explanation of what you&#39;re trying to do, what you&#39;ve tried, and what the end result would look like?  Also check out tips in &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as <b>how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.</b>"}, {"owner": {"reputation": 19, "user_id": 10289121, "user_type": "registered", "profile_image": "https://graph.facebook.com/1913056285400454/picture?type=large", "display_name": "Hania Ciu\u0107ka", "link": "https://stackoverflow.com/users/10289121/hania-ciu%c4%87ka"}, "edited": false, "score": 0, "creation_date": 1535536231, "post_id": 52074343, "comment_id": 91098547, "body": "sorry guys, just chaged the tags"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1535536250, "post_id": 52074343, "comment_id": 91098566, "body": "@HaniaCiu\u0107ka why the tag <a href=\"https://stackoverflow.com/questions/tagged/dax\">dax</a>?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 2, "creation_date": 1535536343, "post_id": 52074343, "comment_id": 91098620, "body": "@hellow - there&#39;s nothing related to <a href=\"https://stackoverflow.com/questions/tagged/excel\">excel</a> or <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a> in the question either... just saying&#39;.  ;)"}, {"owner": {"reputation": 19, "user_id": 10289121, "user_type": "registered", "profile_image": "https://graph.facebook.com/1913056285400454/picture?type=large", "display_name": "Hania Ciu\u0107ka", "link": "https://stackoverflow.com/users/10289121/hania-ciu%c4%87ka"}, "edited": false, "score": 0, "creation_date": 1535536419, "post_id": 52074343, "comment_id": 91098685, "body": "i thought that i could use &#39;search&#39; function but the problem is, the string i wanna find is unknown"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1535536719, "post_id": 52074343, "comment_id": 91098874, "body": "Your looking for search using regex or globbing."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1535536777, "post_id": 52074343, "comment_id": 91098908, "body": "@ashleedawg &quot;...in one column of excel sheet.&quot; is kinda excel related, no? ;)"}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 3, "creation_date": 1535536616, "post_id": 52074520, "comment_id": 91098808, "body": "How is it that I&#39;ve <i>never</i> used <a href=\"https://support.office.com/article/search-searchb-functions-9ab04538-0e55-4719-a72e-b6f54513b495\" rel=\"nofollow noreferrer\">the <code>SEARCH</code> function</a>?"}, {"owner": {"reputation": 19, "user_id": 10289121, "user_type": "registered", "profile_image": "https://graph.facebook.com/1913056285400454/picture?type=large", "display_name": "Hania Ciu\u0107ka", "link": "https://stackoverflow.com/users/10289121/hania-ciu%c4%87ka"}, "edited": false, "score": 0, "creation_date": 1535536767, "post_id": 52074520, "comment_id": 91098902, "body": "amazing thank you, i would need to do some adjustments but that exactly what I&#39;ve been looking for !"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1535537212, "post_id": 52074520, "comment_id": 91099155, "body": "@Jeeped: good answer, unfortunately, as it&#39;s very likely to get positive upvotes, it means the question won&#39;t be deleted :)  Perhaps we can edit the question to fit your answer :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 1, "creation_date": 1535537440, "post_id": 52074520, "comment_id": 91099303, "body": "@OurManinBananas, I just based this response on <i>has a format xx.xx.xx (could be numbers or letters)&#39;</i>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 4, "last_activity_date": 1535536359, "creation_date": 1535536359, "answer_id": 52074520, "question_id": 52074343, "link": "https://stackoverflow.com/questions/52074343/finding-unknown-string-with-known-format-in-a-text/52074520#52074520", "title": "Finding unknown string with known format in a text", "body": "<p>Try,</p>\n\n<pre><code>=MID(A1, SEARCH(\"??.??.??\", A1), 8)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/EMuh1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EMuh1.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1535540943, "post_id": 52075486, "comment_id": 91101552, "body": "You probably want to add the word boundary tokens around it.  Maybe <code>(?:[A-Za-z0-9]{2}\\.){2}[A-Za-z0-9]{2}\\b</code>.  And, of course, with <code>Global = True</code>, it will return multiple matches.  Then you don&#39;t need the <code>Trim</code> or looking for spaces, start/end of string"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1535541045, "post_id": 52075486, "comment_id": 91101624, "body": "Thanks @RonRosenfeld I will go through your suggestions. I am only returning one match at present from the function but left open the possibility of extending to return an array of matches potentially."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1535541178, "post_id": 52075486, "comment_id": 91101724, "body": "@RonRosenfeld It matches on these cases 11.22.33.22 ,  dd.dd.dd.dd   when it shouldn&#39;t. The problem I had with trying to shorten using syntax for repeating group such as {2} was that I could no longer specify the total length at the end with {1,8}. I am a regex beginner so any further pointers welcome."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1535541178, "post_id": 52075486, "comment_id": 91101726, "body": "With the above pattern, <code>Set MC = .Execute(inputString)</code>.  Where MC has been declared as an <code>Object</code>, will return a collection of all the Matches in the string."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1535541364, "post_id": 52075486, "comment_id": 91101836, "body": "Of course, (slapping forehead), that&#39;s because of the dot triggering the \\b.  Let me think"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1535541528, "post_id": 52075486, "comment_id": 91101939, "body": "I still have a leading space character to eliminate from the regex which I am currently using Trim for so bear that in mind as there is definitely scope for lots of improvement! I don&#39;t think I can use a lookbehind to get rid of that though."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1535541759, "post_id": 52075486, "comment_id": 91102099, "body": "Try:  <code>(?:^|[^.])\\b((?:[A-Za-z0-9]{2}\\.){2}[A-Za-z0-9]{2}\\b)(?!\\.)</code> and return capturing group #1.  And you are correct about look-behinds -- don&#39;t exist in vbscript"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1535541870, "post_id": 52075486, "comment_id": 91102168, "body": "@RonRosenfeld Very nice answer. Do you want to post that yourself?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1535541996, "post_id": 52075486, "comment_id": 91102243, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/179017/discussion-between-qharr-and-ron-rosenfeld\">continue this discussion in chat</a>."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1535643241, "post_id": 52075486, "comment_id": 91152179, "body": "@QHarr: it&#39;s a shame the question wasn&#39;t written better originally, as it has two excellent answers!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1535645927, "post_id": 52075486, "comment_id": 91153795, "body": "@OurManinBananas That is true :-( It was a nice experience for me though have another SO user help me out. Nicer when that happens than the fly by down votes."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1535543553, "last_edit_date": 1535543553, "creation_date": 1535539368, "answer_id": 52075486, "question_id": 52074343, "link": "https://stackoverflow.com/questions/52074343/finding-unknown-string-with-known-format-in-a-text/52075486#52075486", "title": "Finding unknown string with known format in a text", "body": "<p>Here is a regex that can be used as an user defined function in the sheet. Currently set up to only retrieve one result per cell but could be extended easily.</p>\n\n<p>Try the <a href=\"https://regex101.com/r/LO8Hz0/2\" rel=\"nofollow noreferrer\">regex here</a>.</p>\n\n<pre><code>Option Explicit\nPublic Sub TEST()\n    Dim tests(), i As Long\n    tests = Array(\"11.22.33 avx\", \"abc 11.22.33 cdvdsds\", \"111.22.33\", \"1.22.33\", \"11.22.33.22\", \"dd.dd.dd.dd\", \"dd.dd.dd\")\n\n    For i = LBound(tests) To UBound(tests)\n        Debug.Print GetID(tests(i))\n    Next\nEnd Sub\n\nPublic Function GetID(ByVal inputString As String) As String\n  With CreateObject(\"VBScript.RegExp\")\n            .Global = True\n            .MultiLine = True\n            .Pattern = \"(?:^|[^.])\\b((?:[A-Za-z0-9]{2}\\.){2}[A-Za-z0-9]{2}\\b)(?!\\.)\"\n            If .TEST(inputString) Then\n              GetID = .Execute(inputString)(0).submatches(0)\n            Else\n              GetID = vbNullString\n            End If\n  End With\nEnd Function\n</code></pre>\n\n<p>Thanks to @RonRosenfeld for improving the regex from an initial horror of:</p>\n\n<pre><code>.Pattern = \"(:?^|\\s)([A-Za-z0-9][A-Za-z0-9]\\.[A-Za-z0-9][A-Za-z0-9]\\.[A-Za-z0-9][A-Za-z0-9]){1,8}(?=\\s|$)\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>.Pattern = \"(?:^|[^.])\\b((?:[A-Za-z0-9]{2}\\.){2}[A-Za-z0-9]{2}\\b)(?!\\.)\"\n</code></pre>\n\n<hr>\n\n<p><strong>All matches:</strong></p>\n\n<p>For a comma separated list of all matches adapt the function as follows:</p>\n\n<pre><code>Public Function GetID(ByVal inputString As String) As String\n    Dim matches As Object, total As Long, arr(), i As Long\n    With CreateObject(\"VBScript.RegExp\")\n        .Global = True\n        .MultiLine = True\n        .Pattern = \"(?:^|[^.])\\b((?:[A-Za-z0-9]{2}\\.){2}[A-Za-z0-9]{2}\\b)(?!\\.)\"\n        If .TEST(inputString) Then\n            Set matches = .Execute(inputString): total = matches.Count - 1\n            ReDim arr(0 To total)\n            For i = 0 To total\n                arr(i) = matches(i).Submatches(0)\n            Next\n            GetID = Join(arr, Chr$(44))\n        Else\n            GetID = vbNullString\n        End If\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10289121, "user_type": "registered", "profile_image": "https://graph.facebook.com/1913056285400454/picture?type=large", "display_name": "Hania Ciu\u0107ka", "link": "https://stackoverflow.com/users/10289121/hania-ciu%c4%87ka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1535543553, "creation_date": 1535535828, "last_edit_date": 1535537614, "question_id": 52074343, "link": "https://stackoverflow.com/questions/52074343/finding-unknown-string-with-known-format-in-a-text", "title": "Finding unknown string with known format in a text", "body": "<p>How can I find a string with format <code>xx.xx.xx</code> (could be numbers or letters) using a formula in MS Excel? </p>\n"}, {"tags": ["vba", "internet-explorer"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1535535330, "creation_date": 1535535330, "answer_id": 52074186, "question_id": 52073754, "link": "https://stackoverflow.com/questions/52073754/vbe-ie-how-to-click-title-and-or-onclick/52074186#52074186", "title": "VBE IE How to click title and/or onclick?", "body": "<p>Look through all the anchor (i.e. A) tags and find the one with with the correct .innerText or .title.</p>\n\n<pre><code>for each obj in IE.Document.GetElementsByTagName(\"A\")\n    if obj.title = \"ALPHA\" or obj.innertext = \"ALPHA\" then\n        obj.click\n        exit for\n    end if\nnext obj\n</code></pre>\n\n<p>You can reduce the loop by only looping through the anchor tags within that table instead of the entire document.</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1535535377, "creation_date": 1535535377, "answer_id": 52074202, "question_id": 52073754, "link": "https://stackoverflow.com/questions/52073754/vbe-ie-how-to-click-title-and-or-onclick/52074202#52074202", "title": "VBE IE How to click title and/or onclick?", "body": "<p>Try</p>\n\n<pre><code>ie.document.querySelector(\"a[title=ALPHA]\").Click\n</code></pre>\n\n<p>Worth noting, we cannot see from the HTML provided whether there are parent form/frame/iframe tags to navigate. If there are, you will need to update the HTML provided to show these.</p>\n\n<p>This applied a CSS selector to target the element. It looks for an element with an <code>a</code> tag that has an attribute <code>title</code> whose value is <code>ALPHA</code>.</p>\n"}], "owner": {"reputation": 519, "user_id": 9245245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mcgHy.jpg?s=128&g=1", "display_name": "Wheeliam", "link": "https://stackoverflow.com/users/9245245/wheeliam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 52074202, "answer_count": 2, "score": 0, "last_activity_date": 1535535377, "creation_date": 1535534083, "question_id": 52073754, "link": "https://stackoverflow.com/questions/52073754/vbe-ie-how-to-click-title-and-or-onclick", "title": "VBE IE How to click title and/or onclick?", "body": "<p>Can someone advise how to \"click\" on ALPHA ?</p>\n\n<pre><code>&lt;/td&gt;\n&lt;td class=\"center\"&gt;&lt;a href=\"#\" onclick=\"javascript:doSubmit('Edit-1');\" title=\"ALPHA\"&gt;\nALPHA\n&lt;/a&gt;\n&lt;input type=\"hidden\" id=\"Org1\" value=\"ALPHA\"/&gt;\n</code></pre>\n\n<p>I have tried multiple different methods but nothing seems to work, e.g.</p>\n\n<pre><code>IE.Document.GetElementsByClassName(\"ALPHA\")(0).Click\n</code></pre>\n\n<p>or</p>\n\n<pre><code>IE.Document.GetElementsByTagName(\"ALPHA\")(0).Click\n</code></pre>\n\n<p>or</p>\n\n<pre><code>   .Document.all.Item(\"Org1\").Value = \"ALPHA\"\n   .Document.GetElementsByClassName(\"ALPHA\")(0).Click\n   .Visible = True\n</code></pre>\n\n<p>as well as</p>\n\n<pre><code>IE.Document.all.Item(\"ALPHA\")(0).Click\n</code></pre>\n"}, {"tags": ["excel", "vba", "plot", "scatter-plot"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1535535082, "post_id": 52073714, "comment_id": 91097791, "body": "That is a lot of charts ..."}, {"owner": {"reputation": 27, "user_id": 10288965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf049863387da32c65f064199da4481?s=128&d=identicon&r=PG&f=1", "display_name": "user10288965", "link": "https://stackoverflow.com/users/10288965/user10288965"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1535537205, "post_id": 52073714, "comment_id": 91099152, "body": "Sometimes I will have only 6 or 5 columns. I would like to use the same macro then."}], "answers": [{"comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1535536197, "post_id": 52073930, "comment_id": 91098523, "body": "how does this answer the question about creating charts? This simply colours cells in a loop..."}, {"owner": {"reputation": 27, "user_id": 10288965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf049863387da32c65f064199da4481?s=128&d=identicon&r=PG&f=1", "display_name": "user10288965", "link": "https://stackoverflow.com/users/10288965/user10288965"}, "edited": false, "score": 0, "creation_date": 1535537153, "post_id": 52073930, "comment_id": 91099117, "body": "Looping columns is where my problem is. I am just a beginner. I have to use numbers and not &quot;A&quot; and &quot;C&quot;."}], "tags": [], "owner": {"reputation": 261, "user_id": 10169396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2397326b698fceea111953d14aefd02a?s=128&d=identicon&r=PG&f=1", "display_name": "Lina", "link": "https://stackoverflow.com/users/10169396/lina"}, "is_accepted": false, "score": 1, "last_activity_date": 1537932542, "last_edit_date": 1537932542, "creation_date": 1535534535, "answer_id": 52073930, "question_id": 52073714, "link": "https://stackoverflow.com/questions/52073714/excel-vba-plotting-every-column-against-another/52073930#52073930", "title": "Excel VBA plotting every column against another", "body": "<p>What you are looking for is a syntax like this:</p>\n\n<pre><code>Sub LoopRows()\n  Dim i As Integer\n  For i = 9 To 30\n    ActiveSheet.Range(\"L\" &amp; i &amp; \":DC\" &amp; i).Interior.Color = RGB(100, 100, 100)\n  Next i\nEnd Sub\n</code></pre>\n\n<p>This example just formats the color of the cell in each row. Notice how I use the for-loop to create a looping range selection.</p>\n"}, {"tags": [], "owner": {"reputation": 261, "user_id": 10169396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2397326b698fceea111953d14aefd02a?s=128&d=identicon&r=PG&f=1", "display_name": "Lina", "link": "https://stackoverflow.com/users/10169396/lina"}, "is_accepted": false, "score": 0, "last_activity_date": 1535538297, "creation_date": 1535538297, "answer_id": 52075168, "question_id": 52073714, "link": "https://stackoverflow.com/questions/52073714/excel-vba-plotting-every-column-against-another/52075168#52075168", "title": "Excel VBA plotting every column against another", "body": "<p>Please try the code below:</p>\n\n<pre><code>Set rng = Worksheets(\"No-Funding\").Cells(x, 2)\nSet rng = Worksheets(\"No-Funding\").Range(Chr(64 + x) &amp; 2)\n</code></pre>\n\n<p>For more information, please review the following link:\n   <a href=\"https://stackoverflow.com/questions/31678789/excel-vba-change-a-range-with-a-loop\">EXCEL-VBA Change a range with a loop</a></p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 10288965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf049863387da32c65f064199da4481?s=128&d=identicon&r=PG&f=1", "display_name": "user10288965", "link": "https://stackoverflow.com/users/10288965/user10288965"}, "edited": false, "score": 0, "creation_date": 1535541827, "post_id": 52075527, "comment_id": 91102140, "body": "Thanks. I have to learn this thing: Union(r.Columns(c1),r.Columns(c2))  What is the point of Set r = Range(&quot;A1:D20&quot;)? Can the whole table from Ctrl-home to Ctrl-end (Rows.Count, Columns.Count) not be the range?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 10288965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf049863387da32c65f064199da4481?s=128&d=identicon&r=PG&f=1", "display_name": "user10288965", "link": "https://stackoverflow.com/users/10288965/user10288965"}, "edited": false, "score": 0, "creation_date": 1535544866, "post_id": 52075527, "comment_id": 91104070, "body": "Yes you can define the range however you like, that was just an example."}, {"owner": {"reputation": 27, "user_id": 10288965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf049863387da32c65f064199da4481?s=128&d=identicon&r=PG&f=1", "display_name": "user10288965", "link": "https://stackoverflow.com/users/10288965/user10288965"}, "edited": false, "score": 0, "creation_date": 1535547126, "post_id": 52075527, "comment_id": 91105629, "body": "Thank you for the help. Defining the range is precisely what I am trying to learn. How do I specify say rows 3 to 20 of column 8 against rows 3 to 20 of column 15? When I plot the series manually, I can see what Excel writes, but how do I change those numbers to specify them as (integer or long) variables?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 10288965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf049863387da32c65f064199da4481?s=128&d=identicon&r=PG&f=1", "display_name": "user10288965", "link": "https://stackoverflow.com/users/10288965/user10288965"}, "edited": false, "score": 0, "creation_date": 1535551957, "post_id": 52075527, "comment_id": 91109094, "body": "Are you saying you don&#39;t want to do all combinations, but only selected ones? In the code above you could use <code>Union(r.Columns(8), r.Columns(15))</code> and define <code>r</code> accordingly."}, {"owner": {"reputation": 27, "user_id": 10288965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf049863387da32c65f064199da4481?s=128&d=identicon&r=PG&f=1", "display_name": "user10288965", "link": "https://stackoverflow.com/users/10288965/user10288965"}, "edited": false, "score": 0, "creation_date": 1535556322, "post_id": 52075527, "comment_id": 91112302, "body": "No, no. Your solution is perfect for my actual work, but I am also trying to learn in parallel. If I plot manually, I get something like =SERIES(,Sheet1!$F$3:$F$8,Sheet1!$H$3:$H$8,1). How I can write this in terms of variables? Is there a decent way? Say I do not want the whole column but a limited set from row k1 to row k2."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 10288965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf049863387da32c65f064199da4481?s=128&d=identicon&r=PG&f=1", "display_name": "user10288965", "link": "https://stackoverflow.com/users/10288965/user10288965"}, "edited": false, "score": 0, "creation_date": 1535556859, "post_id": 52075527, "comment_id": 91112677, "body": "If you define a range variable then you can access its properties such as address which will return a string like $F$3:$F$8. This sounds like it&#39;s veering towards a different sort of question so you might want to consider starting a new one."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1535539506, "creation_date": 1535539506, "answer_id": 52075527, "question_id": 52073714, "link": "https://stackoverflow.com/questions/52073714/excel-vba-plotting-every-column-against-another/52075527#52075527", "title": "Excel VBA plotting every column against another", "body": "<p>This might give you a steer. With 17 columns I think you will be in trouble.</p>\n\n<pre><code>Sub x()\n\nDim r As Range, c1 As Long, c2 As Long, ch As Chart\n\nSet r = Range(\"A1:D20\")\n\nFor c1 = 1 To r.Columns.Count\n    For c2 = 1 To r.Columns.Count\n        If c1 &lt;&gt; c2 Then\n            Set ch = ActiveSheet.Shapes.AddChart.Chart\n            ch.ChartType = xlXYScatter\n            ch.SetSourceData Source:=Union(r.Columns(c1), r.Columns(c2))\n        End If\n    Next c2\nNext c1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10288965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf049863387da32c65f064199da4481?s=128&d=identicon&r=PG&f=1", "display_name": "user10288965", "link": "https://stackoverflow.com/users/10288965/user10288965"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1593645179, "creation_date": 1535533987, "last_edit_date": 1593645179, "question_id": 52073714, "link": "https://stackoverflow.com/questions/52073714/excel-vba-plotting-every-column-against-another", "title": "Excel VBA plotting every column against another", "body": "<p>It is trivial to do this in R with the command pairs(). But in Excel VBA, it seems complicated. </p>\n\n<p>I have 17 columns with about 100 rows. I want to plot each column against another. Defining the range as A1:S100 is not the solution.</p>\n\n<p>I should plot A vs B, A vs C, A vs D, and so on until A vs S, then B vs A, B vs C, B vs D and so on until finally S vs R. I am not able to figure out how to write a range numerically and put it in a loop. The following code won't work.</p>\n\n<pre><code>    ActiveSheet.Shapes.AddChart(xlXYScatter).Select\n    ActiveChart.SetSourceData Source:=Range(Cells(k1, 1), Cells(k2, N)), PlotBy:=xlColumns\n</code></pre>\n"}, {"tags": ["vba", "excel", "google-sheets", "formula"], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 2735624, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11810d8febb8afad1a8601e495f55653?s=128&d=identicon&r=PG&f=1", "display_name": "Konata", "link": "https://stackoverflow.com/users/2735624/konata"}, "edited": false, "score": 0, "creation_date": 1535534367, "post_id": 52073751, "comment_id": 91097364, "body": "That&#39;s so simple, and it works! Thank you, I couldn&#39;t come up on how to incorporate a filter in there (never used SPLIT or LEN before today)  Any chance you could recommend something to read about Google Sheets formula&#39;s?  The defaults google wiki is good if you want to know about a certain function, rather than a few of them jammed together"}, {"owner": {"reputation": 8010, "user_id": 1329498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bmA6I.png?s=128&g=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/1329498/diego"}, "reply_to_user": {"reputation": 303, "user_id": 2735624, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11810d8febb8afad1a8601e495f55653?s=128&d=identicon&r=PG&f=1", "display_name": "Konata", "link": "https://stackoverflow.com/users/2735624/konata"}, "edited": false, "score": 1, "creation_date": 1535534711, "post_id": 52073751, "comment_id": 91097574, "body": "Found this guy on Stack Overflow. Lots to pick up on from his blog. <a href=\"https://sheetswithmaxmakhrov.wordpress.com\" rel=\"nofollow noreferrer\">sheetswithmaxmakhrov.wordpress.com</a>"}], "tags": [], "owner": {"reputation": 8010, "user_id": 1329498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bmA6I.png?s=128&g=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/1329498/diego"}, "is_accepted": true, "score": 2, "last_activity_date": 1535534079, "creation_date": 1535534079, "answer_id": 52073751, "question_id": 52073611, "link": "https://stackoverflow.com/questions/52073611/count-amount-of-words-that-are-specific-length/52073751#52073751", "title": "Count amount of words that are specific length", "body": "<p>Maybe there's a shorter formula, but this works in Sheets.</p>\n\n<pre><code>=COUNTA(IFERROR(FILTER(SPLIT(D2, \" \"), LEN(SPLIT(D2, \" \"))&gt;=3)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 4, "last_activity_date": 1535534376, "creation_date": 1535534376, "answer_id": 52073868, "question_id": 52073611, "link": "https://stackoverflow.com/questions/52073611/count-amount-of-words-that-are-specific-length/52073868#52073868", "title": "Count amount of words that are specific length", "body": "<p>Something like</p>\n\n<pre><code>=SUMPRODUCT(--ARRAYFORMULA(len(SPLIT(D2,\" \"))&gt;=3))\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 2735624, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11810d8febb8afad1a8601e495f55653?s=128&d=identicon&r=PG&f=1", "display_name": "Konata", "link": "https://stackoverflow.com/users/2735624/konata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "accepted_answer_id": 52073751, "answer_count": 2, "score": 3, "last_activity_date": 1537761428, "creation_date": 1535533681, "last_edit_date": 1537761428, "question_id": 52073611, "link": "https://stackoverflow.com/questions/52073611/count-amount-of-words-that-are-specific-length", "title": "Count amount of words that are specific length", "body": "<p>Im trying to count amount of words in a cell that are larger or equal to 3 characters.</p>\n\n<p>I've got the simple \"counta\" working, which is </p>\n\n<pre><code>=IF(ISBLANK(D2);0;LEN(TRIM(D2))-LEN(SUBSTITUTE(D2;\" \";\"\"))+1)\n</code></pre>\n\n<p>or </p>\n\n<pre><code>=IF(LEN(D2)=0;0;COUNTA(SPLIT(D2;\" \"))\n</code></pre>\n\n<p>)</p>\n\n<p>I know that in regex it would be something simple like this</p>\n\n<pre><code>\"\\w{3,}\"\n</code></pre>\n\n<p>But I can't come up with a solution to only count the words that are specific length in Sheet syntax.\nCan someone help me with that, or at least guide me in the right direction.</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1535533648, "post_id": 52073476, "comment_id": 91096904, "body": "can you post a data sample of the Excel sheet? If you step through the code, what is the initial value of <code>lonLaatsteRij</code> ? Do you have empty rows?"}, {"owner": {"reputation": 15, "user_id": 10090127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de8eb5b0bd8fad91af251af8e1a6ed60?s=128&d=identicon&r=PG&f=1", "display_name": "Sypie", "link": "https://stackoverflow.com/users/10090127/sypie"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1535533725, "post_id": 52073476, "comment_id": 91096952, "body": "For this macro it&#39;s this data: Column A: surname (voornaam) Column B: last name (achternam) Column M: mentor (SLB&#39;er in Dutch)  There are no empty rows between the first and last row. There are also no special characters in these data.  Due to privacy I can&#39;t post my data."}, {"owner": {"reputation": 15, "user_id": 10090127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de8eb5b0bd8fad91af251af8e1a6ed60?s=128&d=identicon&r=PG&f=1", "display_name": "Sypie", "link": "https://stackoverflow.com/users/10090127/sypie"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1535534131, "post_id": 52073476, "comment_id": 91097223, "body": "The initial value of lonLaatsteRij: I don&#39;t understand exactly what you mean by this. My data starts at row 2 and ends (in this file) on row 14. In another file (as teachers we have a file for every class) there might be even more rows."}, {"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1535537797, "post_id": 52073476, "comment_id": 91099544, "body": "Just before the <code>End Sub</code> in your first sub routine (Akkoordverklaring), add the following code <code>MsgBox lonLaatsteRij</code> run the sub routine and it will display a message box with the number of rows it has counted with value data."}, {"owner": {"reputation": 15, "user_id": 10090127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de8eb5b0bd8fad91af251af8e1a6ed60?s=128&d=identicon&r=PG&f=1", "display_name": "Sypie", "link": "https://stackoverflow.com/users/10090127/sypie"}, "reply_to_user": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1535539316, "post_id": 52073476, "comment_id": 91100503, "body": "@5202456: I did. Thanks, that also works nice as a confirmation of what is done."}, {"owner": {"reputation": 15, "user_id": 10090127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de8eb5b0bd8fad91af251af8e1a6ed60?s=128&d=identicon&r=PG&f=1", "display_name": "Sypie", "link": "https://stackoverflow.com/users/10090127/sypie"}, "edited": false, "score": 1, "creation_date": 1535539980, "post_id": 52073476, "comment_id": 91100918, "body": "I solved it. It was just stupid of me.  I have like 10 sheets visible and 2 sheets invisible. One of the invisible sheets gathers information from all the sheets. In this way my VBA only has to look into 1 sheet.  But... in this invisible sheet my formulas, to get data from other sheets, didn&#39;t go further then row 10... So copying the formula further was my solution to this issue.  Just stupid of me."}, {"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1535542911, "post_id": 52073476, "comment_id": 91102810, "body": "I am glad you have sorted the issue. An oversight when working on complex worksheet is not you being stupid, many of us have had oversights like this. It may be possible to solve the issue in the future by checking how many rows of formula are on your hidden sheet and if not enough exist, then use vba to create the extra rows of formulas."}], "owner": {"reputation": 15, "user_id": 10090127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de8eb5b0bd8fad91af251af8e1a6ed60?s=128&d=identicon&r=PG&f=1", "display_name": "Sypie", "link": "https://stackoverflow.com/users/10090127/sypie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535533259, "creation_date": 1535533259, "question_id": 52073476, "link": "https://stackoverflow.com/questions/52073476/excel-macro-stops-generating-word-documents-after-9-rows", "title": "Excel Macro stops generating Word documents after 9 rows", "body": "<p>I made a nice Excel file with several (almost the same) macros. Goal is to fill open a Word template, fill in the bookmarks and save every individual document with predefined fields in the filename. Works like a charm... but it doesn't go further then the 10th row of my Excel file. All 12 macros have the same issue, basically the macro is the same only the fields are different.</p>\n\n<p>The VBA I have now is this:</p>\n\n<pre><code>Option Explicit\n\nSub Akkoordverklaring()\n\n  Dim lonLaatsteRij As Long\n  Dim rngData As Range\n  Dim strVoornaam As String, strAchternaam As String, strSlber As String\n  Dim c As Range\n\nWith Sheets(\"Cijferlijst\")\n    lonLaatsteRij = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set rngData = .Range(.Cells(2, 1), .Cells(lonLaatsteRij, 1))\nEnd With\n\n  For Each c In rngData\n    strVoornaam = c.Value\n    strAchternaam = c.Offset(0, 1).Value\n    strSlber = c.Offset(0, 12).Value\n    Call maakWordDocument(strVoornaam, strAchternaam, strSlber)\n  Next c\n\nEnd Sub\n\nPrivate Sub maakWordDocument(strVoornaam As String, strAchternaam As String, strSlber As String)\n\n    'maak een verwijzing naar de Microsoft Word 16.0 Object Library!!\n\n    Dim wordApp As Object, WordDoc As Object\n\n    On Error Resume Next\n\n    'kijk of word al open staat\n    Set wordApp = GetObject(\"\", \"Word.Application\")\n    'open word\n    If wordApp Is Nothing Then\n      'If Not open, open Word Application\n      Set wordApp = CreateObject(\"Word.Application\")\n    End If\n    'toon word (of niet, dan op false)\n    wordApp.Visible = False\n    'open het 'bron'-bestand\n    Set WordDoc = wordApp.Documents.Open(ThisWorkbook.Path &amp; \"Formulieren\\Akkoordverklaring.docx\")\n\n    'bladwijzers invullen\n    Call InvullenBladwijzer(wordApp, \"voornaam\", strVoornaam)\n    Call InvullenBladwijzer(wordApp, \"achternaam\", strAchternaam)\n    Call InvullenBladwijzer(wordApp, \"slber\", strSlber)\n\n    'bestand opslaan en alles netjes afsluiten\n    wordApp.DisplayAlerts = False\n    WordDoc.SaveAs Filename:=ThisWorkbook.Path &amp; \"Akkoordverklaring\\Akkoordverklaring \" &amp; strVoornaam &amp; Space(1) &amp; strAchternaam, FileFormat:=wdFormatDocumentDefault\n    WordDoc.Close\n    wordApp.Quit\n    Set WordDoc = Nothing\n    Set wordApp = Nothing\n    'wordApp.DisplayAlerts = True\n\n    'On Error GoTo 0\n\n\nEnd Sub\n\n\nSub InvullenBladwijzer(wordApp As Object, strBladwijzer As String, strTekst As String)\n\n  'tekst invullen in relevante strBladwijzer\n  wordApp.Selection.Goto What:=wdGoToBookmark, Name:=strBladwijzer\n  wordApp.Selection.TypeText strTekst\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nEnd Sub\n</code></pre>\n\n<p>As I'm not a programmer I just know how to read some VBA. Some users in here also helped me out with the VBA above (<a href=\"https://stackoverflow.com/questions/51369063/excel-change-vba-action-frome-same-sheet-to-another-sheet\">Excel: change VBA action frome same sheet to another sheet</a>)</p>\n"}, {"tags": ["vba", "excel", "plot"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1535533151, "post_id": 52073260, "comment_id": 91096578, "body": "Please share what you have tried and where you are stuck."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 1, "creation_date": 1535538344, "post_id": 52073260, "comment_id": 91099897, "body": "@Tiffany: take a look at <a href=\"https://stackoverflow.com/questions/13236127/extract-top-10-of-column-values-in-excel-and-place-in-another-column\">SO: Extract top 10% of column values in Excel and place in another column</a>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1535538437, "post_id": 52073260, "comment_id": 91099959, "body": "@tiffany: also, take a look at <a href=\"http://www.java2s.com/Code/VBA-Excel-Access-Word/Access/Getthetop10percent.htm\" rel=\"nofollow noreferrer\">Get the top 10 percent : SQL Select &#171; Access &#171; VBA / Excel / Access / Word</a> - you can change the connection to your MS Excel worksheet, and use SQL to get the percentage you want!"}, {"owner": {"reputation": 11, "user_id": 10288786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9de23922c50854d562dd518b5642f3c2?s=128&d=identicon&r=PG&f=1", "display_name": "Tiffany", "link": "https://stackoverflow.com/users/10288786/tiffany"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1535550611, "post_id": 52073260, "comment_id": 91108102, "body": "@OurManinBananas thank you! unfortunated still havent found a way of making it do the same thing for each age, but thats okay"}], "owner": {"reputation": 11, "user_id": 10288786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9de23922c50854d562dd518b5642f3c2?s=128&d=identicon&r=PG&f=1", "display_name": "Tiffany", "link": "https://stackoverflow.com/users/10288786/tiffany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535536183, "creation_date": 1535532500, "last_edit_date": 1535536183, "question_id": 52073260, "link": "https://stackoverflow.com/questions/52073260/select-lowest-percentage-values", "title": "select lowest percentage values", "body": "<p>With a set of data that has for each user an age and a score, I would like to select and plot the lowest 15% of the scores for each age. </p>\n\n<p>Is there a way to simply take out the lowest 15% of scores for each age? This would be preferably in an automated way (don't want to have to repeat process for all 100 ages)</p>\n\n<p><a href=\"https://i.stack.imgur.com/zImlF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zImlF.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried the conditional formatting but then I would have to manually select what data to keep. I suspect it is a complicated if function that hopefully I wont have to rewrite for each age.</p>\n\n<p>I've created a column that ranks the scores with respect to the other of that age:</p>\n\n<pre><code>RANK(B4,$B$4:$B$426,1)\n</code></pre>\n\n<p>Then in a new column convert that to a percentage of the total number of entries for that age:</p>\n\n<pre><code>(E4/COUNT($E$4:$E$426))*100\n</code></pre>\n\n<p>Then an IF statement where it copies the score only if it is in the bottom 15% of scores;</p>\n\n<pre><code>IF(F4&lt;15,B4,\"-\")\n</code></pre>\n\n<p>This process is long and messy doesn't seem logical to repeat it 100 times so how to I automate it?</p>\n"}, {"tags": ["excel", "vba", "ms-access", "ado"], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "edited": false, "score": 0, "creation_date": 1535664566, "post_id": 52073330, "comment_id": 91162261, "body": "Thanks however I would like to extract the data from the recordset and have that be the output of the function. How is data inside the &quot;rs&quot; object accessed ? Also, what would happen if the mdb file is currently being accessed by another process ? thanks"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "edited": false, "score": 0, "creation_date": 1535693384, "post_id": 52073330, "comment_id": 91168552, "body": "Yes, right, as written in my post, now you need to do something on your own now. I showed you how to access a field name. Accessing a value of a field is quite similar. With the help of google you find this s<a href=\"https://docs.microsoft.com/en-us/sql/ado/guide/data/the-fields-collection?view=sql-server-2017\" rel=\"nofollow noreferrer\">ite</a> or this <a href=\"https://bytes.com/topic/access/insights/635678-accessing-field-values-recordsets\" rel=\"nofollow noreferrer\">one</a>. If you get stuck then open another question put some code you tried and explain what your problem is. Also read <a href=\"https://stackoverflow.com/help/how-to-ask\">this</a>."}, {"owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "edited": false, "score": 0, "creation_date": 1535694040, "post_id": 52073330, "comment_id": 91168766, "body": "Ah ok , I see what you mean by too broad of a question, I should have cut that into several bite sized questions instead. I think the last line in my question, is a big question just on it&#39;s own and I couldn&#39;t really find a good answer."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "edited": false, "score": 0, "creation_date": 1535694348, "post_id": 52073330, "comment_id": 91168856, "body": "You should also try something on your own. Try some code and you will get better insights."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1535532768, "creation_date": 1535532768, "answer_id": 52073330, "question_id": 52073221, "link": "https://stackoverflow.com/questions/52073221/reading-a-value-from-a-row-in-a-table-in-an-mdb-file-from-excel-vba/52073330#52073330", "title": "Reading a value, from a row, in a table, in an mdb file , from excel/vba?", "body": "<p>IMO this question should be closed as too broad but let's give it a try\nThe following function will connect to a Access database via ADODbD</p>\n\n<pre><code>Function ConnectToDB(ByVal fileName As String)\n\nDim conn As New ADODB.Connection\n\n    If Dir(fileName) = \"\" Then\n        MsgBox \"Could not find file \" &amp; fileName\n        Exit Function\n    End If\n\n    Dim connectionString As String\n\n    ' https://www.connectionstrings.com/access/\n    connectionString = \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" _\n                       &amp; fileName &amp; \";Persist Security Info=False;\"\n\n    conn.Open connectionString\n\n    Set ConnectToDB = conn\n\nEnd Function\n</code></pre>\n\n<p>And this might give you what you want. You need a sheet with the codename <code>shRepAllRecords</code> to make it work.</p>\n\n<pre><code>Option Explicit\n\nSub ReadFromDB()\n\n    ' Get datbase name\n    Dim dbName As String\n    dbName = &lt;fule filename of the database&gt;\n\n    ' Connect to the databse\n    Dim conn As ADODB.Connection\n    Set conn = ConnectToDB(dbName)\n\n    ' read the data\n    Dim rs As New ADODB.Recordset\n    Dim query As String\n\n    ' First example to use an SQL statement\n   query = \"SELECT * From myParts WHERE PartNumber = '123'\"\n\n    ' Second example to use a query name defined in the database itself\n    ' query = \"qryCustomer\"\n\n    rs.Open query, conn\n\n    ' shRepAllRecords is the codename of the sheet where the \n    ' data is written to\n\n    ' Write header\n    Dim i As Long\n    For i = 0 To rs.Fields.Count - 1\n        'shRepAllRecords.Cells(1, i + 1).Value = rs.Fields(i).Name\n        shRepAllRecords.Range(\"A1\").Offset(0, i) = rs.Fields(i).Name\n    Next i\n\n    ' Write Data\n    shRepAllRecords.Range(\"A2\").CopyFromRecordset rs\n    shRepAllRecords.Activate\n\n\n    ' clean up\n    conn.Close\n\nEnd Sub\n</code></pre>\n\n<p>You need to adjust the code in order to get excatly what you need but I leave that to you.</p>\n"}], "owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594072306, "creation_date": 1535532379, "last_edit_date": 1594072306, "question_id": 52073221, "link": "https://stackoverflow.com/questions/52073221/reading-a-value-from-a-row-in-a-table-in-an-mdb-file-from-excel-vba", "title": "Reading a value, from a row, in a table, in an mdb file , from excel/vba?", "body": "<p>I want to make a simple function that will open and read from a database (and mdb file). As simply and cleanly as possible. Preferably using only ADODB.</p>\n\n<p>For now I need this from excel/vba and I will later migrate to vb.net</p>\n\n<p>First the structure of my database</p>\n\n<p>A single mdb file (actually, accdb, it doesn't matter I hope)</p>\n\n<p>It has a single table called \"myParts\"</p>\n\n<p>This table has 3 columns:  id, part number, part description </p>\n\n<p>Here is how the function I want to make</p>\n\n<p>function GetPartDescription (PartNumber as string) as string</p>\n\n<p>The part number should exist only once in the entire table.</p>\n\n<p>So this function should, open the database, find the row with the exact matching part number and then return whatever is in the \"part description\" column for that row</p>\n\n<p>How should I do this ?  I tried getting started by just choosing which api, I get lost !  DAO , ADO, ACEDAO, ADODB, ADO.NET, OLEDB ??? What a nightmare !</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1535533112, "post_id": 52073196, "comment_id": 91096555, "body": "<code>Calculate</code> doesn&#39;t work like that - there is no <code>Target</code> parameter. Perhaps you could check the values of those two cells or use the change event for the source sheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1535533303, "post_id": 52073196, "comment_id": 91096669, "body": "You have a volatile function in that worksheet. Look up volatile function."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1535534263, "post_id": 52073196, "comment_id": 91097302, "body": "You could use the Change event and point the Target to wherever <code>These values are referenced from another sheet in the same workbook</code>, and if any of these values change then fire the event..."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6770398, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9afNBw0eK50/AAAAAAAAAAI/AAAAAAAAAB0/SmurK82wACc/photo.jpg?sz=128", "display_name": "Paa Willie", "link": "https://stackoverflow.com/users/6770398/paa-willie"}, "edited": false, "score": 0, "creation_date": 1535571609, "post_id": 52075604, "comment_id": 91120150, "body": "Thanks, The code seems not to work because I might be confused or I&#39;ve managed to confuse you? I should  have specified the sheets in the question. Data is inputted in Cell J2 on Sheet 5 The data is referenced into Cells W4656 and W4657 on Sheet 38 Could the code be updated to reflect these changes? Thanks"}, {"owner": {"reputation": 1, "user_id": 6770398, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9afNBw0eK50/AAAAAAAAAAI/AAAAAAAAAB0/SmurK82wACc/photo.jpg?sz=128", "display_name": "Paa Willie", "link": "https://stackoverflow.com/users/6770398/paa-willie"}, "edited": false, "score": 0, "creation_date": 1535613908, "post_id": 52075604, "comment_id": 91132473, "body": "I have tried but it seems not to work. In a fresh workbook to simulate your code, the message box pops up the first time input is made in any cell only. In the workbook to use the code, the message box pops up whenever data is inputted anywhere. I have uploaded the workbook for your perusal here: <a href=\"http://www.mediafire.com/file/h3fd5bfpirb2wf7/my_work.zip/file\" rel=\"nofollow noreferrer\">mediafire.com/file/h3fd5bfpirb2wf7/my_work.zip/file</a>"}, {"owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "reply_to_user": {"reputation": 1, "user_id": 6770398, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9afNBw0eK50/AAAAAAAAAAI/AAAAAAAAAB0/SmurK82wACc/photo.jpg?sz=128", "display_name": "Paa Willie", "link": "https://stackoverflow.com/users/6770398/paa-willie"}, "edited": false, "score": 0, "creation_date": 1535615713, "post_id": 52075604, "comment_id": 91133589, "body": "Hi Paa. I now better understand your intent \u2026 which is quite complex. The issue is the possibility for people to bypass your checks. One idea is to create a module which continually validates against an internal list of school names. Once created, password protect the VBA project. If the name is changes the routine can stop key functionality working (and potentially lock down sheets, etc). That way you&#39;re not reliant on &quot;event&quot; code which someone can easily bypass or by changing structure or formulas in the spreadsheet. Sorry that I can&#39;t help more except for the above advice. Best of luck."}], "tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": false, "score": 0, "last_activity_date": 1608715531, "last_edit_date": 1608715531, "creation_date": 1535539742, "answer_id": 52075604, "question_id": 52073196, "link": "https://stackoverflow.com/questions/52073196/worksheet-calculate-event-is-fired-whenever-data-is-entered-anywhere-in-workbook/52075604#52075604", "title": "worksheet_calculate event is fired whenever data is entered anywhere in workbook", "body": "<p>I've updated my code and made it cleaner, and shamelessly stole some of\nChronocidal's approach (my original code required the workbook to be closed and opened to work). So here is what Sheet5 looks like in my example:</p>\n<p><a href=\"https://i.stack.imgur.com/sliZf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sliZf.jpg\" alt=\"Sheet5\" /></a></p>\n<p>And here is Sheet38. In my example I simply setup formulas in Sheet38!W4656:W4657 to equal Sheet5!$J$2 ... so when Sheet5!$J$2 changes so does Sheet38!W4656:W4657 which will trigger the code.</p>\n<p><a href=\"https://i.stack.imgur.com/i3UgJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i3UgJ.jpg\" alt=\"Sheet38\" /></a></p>\n<p>And copy this code into <strong>ThisWorkbook</strong> ...</p>\n<pre><code>Option Explicit\n\nDim vCheck1 As Variant\nDim vCheck2 As Variant\n\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    If vCheck1 &lt;&gt; Sheet38.Range(&quot;W4656&quot;) Or vCheck2 &lt;&gt; Sheet38.Range(&quot;W4657&quot;) Then\n        MsgBox (&quot;CHANGE DETECTED!!&quot;)\n        Application.DisplayAlerts = False\n        ActiveWorkbook.Save\n        Application.DisplayAlerts = True\n        vCheck1 = Sheet38.Range(&quot;W4656&quot;)\n        vCheck2 = Sheet38.Range(&quot;W4657&quot;)\n    End If\nEnd Sub\n</code></pre>\n<p>Like this ...</p>\n<p><a href=\"https://i.stack.imgur.com/4lMeo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4lMeo.jpg\" alt=\"Workbook\" /></a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6770398, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9afNBw0eK50/AAAAAAAAAAI/AAAAAAAAAB0/SmurK82wACc/photo.jpg?sz=128", "display_name": "Paa Willie", "link": "https://stackoverflow.com/users/6770398/paa-willie"}, "edited": false, "score": 0, "creation_date": 1535571589, "post_id": 52077345, "comment_id": 91120138, "body": "Thanks, The code seems not to work because I might be confused or I&#39;ve managed to confuse you? I should  have specified the sheets in the question. Data is inputted in Cell J2 on Sheet 5 The data is referenced into Cells W4656 and W4657 on Sheet 38 Could the code be updated to reflect these changes? Thanks"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 1, "user_id": 6770398, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9afNBw0eK50/AAAAAAAAAAI/AAAAAAAAAB0/SmurK82wACc/photo.jpg?sz=128", "display_name": "Paa Willie", "link": "https://stackoverflow.com/users/6770398/paa-willie"}, "edited": false, "score": 0, "creation_date": 1535615324, "post_id": 52077345, "comment_id": 91133331, "body": "@PaaWillie Where are you putting the code?  It should be in <code>Sheet 38</code> - I have just checked &amp; tested myself (albeit with <code>A1</code> and <code>A2</code> instead of <code>W4656</code> and <code>W4657</code>) and it works fine.  You could also set up break-points to see if the code is being called correctly (e.g. is <code>Application.EnableEvents</code> set to <code>True</code>?)"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1535545229, "creation_date": 1535545229, "answer_id": 52077345, "question_id": 52073196, "link": "https://stackoverflow.com/questions/52073196/worksheet-calculate-event-is-fired-whenever-data-is-entered-anywhere-in-workbook/52077345#52077345", "title": "worksheet_calculate event is fired whenever data is entered anywhere in workbook", "body": "<p>\nWell, if we examine these lines of your code</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim Xrg As Range\nSet Xrg = Range(\"W4656:W4657\")\nIf Not Intersect(Xrg, Range(\"W4656:W4657\")) Is Nothing Then\n</code></pre>\n\n<p>Since we set <code>Xrg</code>, then immediately use it, we can rewrite that as</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Not Intersect(Range(\"W4656:W4657\"), Range(\"W4656:W4657\")) Is Nothing Then\n</code></pre>\n\n<p>which will always be true.  So, every time the worksheet Calculates, it will say \"CHANGE DETECTED!\"</p>\n\n<p>Ideally, you want to store the values in those Cells somewhere, and then just run a comparison between the cells and the stored values.  Using Worksheet Variables, you could get the following:  (You could also store the values in hidden worksheet as an alternative)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit 'This line should almost ALWAYS be at the start of your code modules\n\nPrivate StoredW4656 As Variant 'Worksheet Variable 1\nPrivate StoredW4657 As Variant 'Worksheet Variable 2\n\nPrivate Sub Worksheet_Calculate()\n    On Error GoTo SaveVars 'In case the Variables are \"dropped\"\n\n    'If the values haven't changed, do nothing\n    If (Me.Range(\"W4656\").Value = StoredW4656) And _\n        (Me.Range(\"W4657\").Value = StoredW4657) Then Exit Sub\n\n    MsgBox \"CHANGE DETECTED!\", vbInformation\nSaveVars:\n    StoredW4656 = Me.Range(\"W4656\").Value\n    StoredW4657 = Me.Range(\"W4657\").Value\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6770398, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9afNBw0eK50/AAAAAAAAAAI/AAAAAAAAAB0/SmurK82wACc/photo.jpg?sz=128", "display_name": "Paa Willie", "link": "https://stackoverflow.com/users/6770398/paa-willie"}, "is_accepted": true, "score": 0, "last_activity_date": 1535787947, "creation_date": 1535787947, "answer_id": 52126060, "question_id": 52073196, "link": "https://stackoverflow.com/questions/52073196/worksheet-calculate-event-is-fired-whenever-data-is-entered-anywhere-in-workbook/52126060#52126060", "title": "worksheet_calculate event is fired whenever data is entered anywhere in workbook", "body": "<p>So I've managed to find a solution (work around?) to my problem.\nI ended up using a macro to check if the the number in Sheet 38, Cell W4656 which was referenced from Sheet 5, Cell J2, has changed. If yes, fire a macro. If not, do nothing.\nI've realized that with the code below, worksheet_calculate event is fired only when there is change in Sheet 5, Cell J2 or Sheet 38, Cell W4656 which is what I want.</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nStatic OldVal As Variant\n If Range(\"w6\").Value &lt;&gt; 24 Then\n  MsgBox (\"XX\")\n'Call Macro\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6770398, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9afNBw0eK50/AAAAAAAAAAI/AAAAAAAAAB0/SmurK82wACc/photo.jpg?sz=128", "display_name": "Paa Willie", "link": "https://stackoverflow.com/users/6770398/paa-willie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "accepted_answer_id": 52126060, "answer_count": 3, "score": 0, "last_activity_date": 1608715531, "creation_date": 1535532297, "last_edit_date": 1593761926, "question_id": 52073196, "link": "https://stackoverflow.com/questions/52073196/worksheet-calculate-event-is-fired-whenever-data-is-entered-anywhere-in-workbook", "title": "worksheet_calculate event is fired whenever data is entered anywhere in workbook", "body": "<p>I'm somewhat new to excel. I have (through online searches) managed to finally create a worksheet_calculate event macro that seems to work. The macro is to return a message box (CHANGE DETECTED!) whenever the value in the cells W4656:W4657 change. These values are referenced from another sheet in the same workbook.\nMy problem is the worksheet_calculate event is fired whenever data is entered anywhere in the workbook. \nWould be super glad if my macro could be modified such that worksheet_calculate event is fired only when data in a specific cell (a cell in a different sheet) is changed and not whenever data is entered anywhere else in workbook.\nThanks.</p>\n\n<p>Here is the code i seek to modify:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim Xrg As Range\nSet Xrg = Range(\"W4656:W4657\")\nIf Not Intersect(Xrg, Range(\"W4656:W4657\")) Is Nothing Then\nMsgBox (\"CHANGE DETECTED!!\")\n      ActiveWorkbook.Save\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10786, "user_id": 4158862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKDhB.png?s=128&g=1", "display_name": "SomethingDark", "link": "https://stackoverflow.com/users/4158862/somethingdark"}, "edited": false, "score": 1, "creation_date": 1535530233, "post_id": 52072477, "comment_id": 91094741, "body": "Change the comma to a decimal"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1535530239, "post_id": 52072477, "comment_id": 91094744, "body": "How does 67569 equate to 16:13?"}, {"owner": {"reputation": 10786, "user_id": 4158862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKDhB.png?s=128&g=1", "display_name": "SomethingDark", "link": "https://stackoverflow.com/users/4158862/somethingdark"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1535530333, "post_id": 52072477, "comment_id": 91094808, "body": "@SJR - It seems that M1rz&#196; is in a country that switches decimals and commas, so a normal timestamp would read 43298.67569."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1535530423, "post_id": 52072477, "comment_id": 91094876, "body": "Comma is the decimal separator in Germany, so why don&#39;t you try to format the cell as date and time? Works for me. No VBA needed."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 10786, "user_id": 4158862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKDhB.png?s=128&g=1", "display_name": "SomethingDark", "link": "https://stackoverflow.com/users/4158862/somethingdark"}, "edited": false, "score": 0, "creation_date": 1535530462, "post_id": 52072477, "comment_id": 91094897, "body": "@SomethingDark - ah yes, thanks, should have spotted that."}, {"owner": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "reply_to_user": {"reputation": 10786, "user_id": 4158862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKDhB.png?s=128&g=1", "display_name": "SomethingDark", "link": "https://stackoverflow.com/users/4158862/somethingdark"}, "edited": false, "score": 0, "creation_date": 1535530791, "post_id": 52072477, "comment_id": 91095118, "body": "@SomethingDark  For me doesnt work. In one cell you have DATE and TIME so 2 parameters, that is what I forgot to mention. It is easy if there will be 2 cells."}, {"owner": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "edited": false, "score": 2, "creation_date": 1535530878, "post_id": 52072477, "comment_id": 91095182, "body": "I managed!!! Thank you guys, it was like in USER defined formats...damn :/"}, {"owner": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "edited": false, "score": 0, "creation_date": 1535530958, "post_id": 52072477, "comment_id": 91095232, "body": "TT:MM:YY hh:mm   =)"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "edited": false, "score": 0, "creation_date": 1535629685, "post_id": 52073124, "comment_id": 91142661, "body": "Yeah,,it will be always the same, tons of data, same amount, same graphs. Some minor changes could be expected! I did not use PQ so far, will check it out for myself! Thank you"}], "tags": [], "owner": {"reputation": 32, "user_id": 3766625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafb4539d640cff7cd0e253097333c71?s=128&d=identicon&r=PG&f=1", "display_name": "sneakysheila", "link": "https://stackoverflow.com/users/3766625/sneakysheila"}, "is_accepted": true, "score": -1, "last_activity_date": 1535532090, "creation_date": 1535532090, "answer_id": 52073124, "question_id": 52072477, "link": "https://stackoverflow.com/questions/52072477/converting-specific-numbers-into-date-time-using-vba-excel/52073124#52073124", "title": "Converting specific numbers into Date/Time using VBA Excel", "body": "<p>You do not mention how you are importing the data. If you are frequently performing this import, you might want to consider using PowerQuery to do the import where you can use <a href=\"https://support.office.com/en-us/article/internationalization-power-query-d42b9390-1fff-413f-8120-d7df0ced20b9\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/internationalization-power-query-d42b9390-1fff-413f-8120-d7df0ced20b9</a></p>\n\n<p>Aside: PowerQuery in Excel 2016 is much improved in my opinion and worth checking out again if you were put off by Excel 2013</p>\n"}], "owner": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 52073124, "answer_count": 1, "score": -1, "last_activity_date": 1535534428, "creation_date": 1535529845, "last_edit_date": 1535534428, "question_id": 52072477, "link": "https://stackoverflow.com/questions/52072477/converting-specific-numbers-into-date-time-using-vba-excel", "title": "Converting specific numbers into Date/Time using VBA Excel", "body": "<p>I have some imported data and it looks like this: 43298,67569 </p>\n\n<p>supposing that first number (before comma) is DATE and after comma is Time(h/m):\n17.07.2018 16:13 -> like this</p>\n\n<p>Is there any kind of command, VBA or else that I can transfer this into normal DATE and TIME? So I tried with changing formats, also tried using Data->Text to Columns Option with different spacings and so on. Did not work. </p>\n\n<p>And it is not only one cell, but like thousands (whole column) and make me a problem to make a certain Charts.</p>\n"}, {"tags": ["vba", "outlook", "exchange-server", "outlook-addin"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 7833533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7bbbd0d49d573e35706e0058452de39?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/7833533/joey"}, "edited": false, "score": 0, "creation_date": 1606839201, "post_id": 52081077, "comment_id": 115080663, "body": "I see what you are saying but can you please elaborate on what would cause the &quot;Thread-Index&quot; header to disappear. I read somewhere that sometimes using email clients different than Outlook can cause this, but I still see this behavior where conversation IDs randomly change even when intracompany emails are sent using Outlook through Exchange Server. This is really annoying as it makes Conversation view useless."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 173, "user_id": 7833533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7bbbd0d49d573e35706e0058452de39?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/7833533/joey"}, "edited": false, "score": 0, "creation_date": 1606848115, "post_id": 52081077, "comment_id": 115084870, "body": "Hard to say - it really depends on the SMTP server the email goes through."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1535556197, "creation_date": 1535556197, "answer_id": 52081077, "question_id": 52072475, "link": "https://stackoverflow.com/questions/52072475/can-conversationid-change-for-existing-item-in-conversation/52081077#52081077", "title": "Can ConversationID change for existing item in conversation?", "body": "<p>Conversation index can change if the \"Thread-Index\" MIME header is missing from a message in the conversation. But it will not change for the existing older messages in a conversation. For that to happen, each and every one of them would need to be updated, and if that happened, you should see the updated last modified date.</p>\n"}], "owner": {"reputation": 398, "user_id": 1878655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4iqZj.jpg?s=128&g=1", "display_name": "Sergey Belikov", "link": "https://stackoverflow.com/users/1878655/sergey-belikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 532, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592943068, "creation_date": 1535529843, "last_edit_date": 1592943068, "question_id": 52072475, "link": "https://stackoverflow.com/questions/52072475/can-conversationid-change-for-existing-item-in-conversation", "title": "Can ConversationID change for existing item in conversation?", "body": "<p>We are writing Outlook VSTO add-in and save info about mail items in database. Some features are relying on conversations in Outlook, so we save ConversationID in the database to detect that all messages are from the same thread.</p>\n\n<p>Recently I found that at some point conversationID is changed for the entire conversation! So I have first message with ID\n5E2C809C8D7E4BEBA402613311DD8C7B\nAnd then suddenly it becomes \n347B0DEB35C68E1EE882EFABE4BCC373\nfor the next messages. And when I select previous messages they also have this 347 id.\nIt seems that it broke when I answered an e-mail with changed subject (and it gets out of thread) or after I answered from Win10 mail client. But I can't reproduce this anymore.</p>\n\n<p>Does anyone know in which cases this can happen?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 703, "user_id": 5142585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWQdR.jpg?s=128&g=1", "display_name": "Pm Duda", "link": "https://stackoverflow.com/users/5142585/pm-duda"}, "edited": false, "score": 1, "creation_date": 1535530916, "post_id": 52072367, "comment_id": 91095207, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/296696/making-sure-public-vba-methods-dont-show-up-in-the-list-of-excel-macros\">Making sure public VBA methods don&#39;t show up in the list of Excel macros</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 1, "creation_date": 1535529886, "post_id": 52072468, "comment_id": 91094536, "body": "If I do that, then I will not be able to access this function in another module. Correct?"}, {"owner": {"reputation": 703, "user_id": 5142585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWQdR.jpg?s=128&g=1", "display_name": "Pm Duda", "link": "https://stackoverflow.com/users/5142585/pm-duda"}, "edited": false, "score": 1, "creation_date": 1535529978, "post_id": 52072468, "comment_id": 91094593, "body": "Correct. Check comment under your question."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1535530688, "post_id": 52072468, "comment_id": 91095055, "body": "While this does limit the scope to <code>Private</code> I do have a feeling, that OP&#39;s intention is to access the function&#39;s scope in his other functions, just not outside of the module. But well, since it is not specified, this is technically a correct answer"}], "tags": [], "owner": {"reputation": 340, "user_id": 10259066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZVBX.png?s=128&g=1", "display_name": "DaanV", "link": "https://stackoverflow.com/users/10259066/daanv"}, "is_accepted": false, "score": 1, "last_activity_date": 1535529821, "creation_date": 1535529821, "answer_id": 52072468, "question_id": 52072367, "link": "https://stackoverflow.com/questions/52072367/custom-function-disable-in-excel/52072468#52072468", "title": "Custom Function Disable in Excel", "body": "<p>you can add the keywords Public or Private to your functions, subs or global variable to have that specified.</p>\n\n<p>so if you want to only want this function to be accessible by your code and not in excel sheets you can add private:</p>\n\n<pre><code>Private Function Coverts(ByVal inputString As String) As String\n   'Coverts code here\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1535534242, "post_id": 52072534, "comment_id": 91097294, "body": "no problem, it&#39;s a collaborative effort afterall :)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1535534648, "post_id": 52072534, "comment_id": 91097531, "body": "@Rawrplus - if I could share one of those votes with you I surely would..."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 4, "last_activity_date": 1535530473, "last_edit_date": 1535530473, "creation_date": 1535530078, "answer_id": 52072534, "question_id": 52072367, "link": "https://stackoverflow.com/questions/52072367/custom-function-disable-in-excel/52072534#52072534", "title": "Custom Function Disable in Excel", "body": "<p>Put</p>\n\n<pre><code>Option Private Module\n</code></pre>\n\n<p>at the top of the module containing your function.</p>\n\n<hr>\n\n<p>From <a href=\"https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-basic-6/aa266185(v=vs.60)\" rel=\"nofollow noreferrer\">MSDN</a>:</p>\n\n<blockquote>\n  <p>When a module contains <code>Option Private Module</code>, the public parts, for example, variables, objects, and user-defined types declared at module level, are still available within the project containing the module, but they are not available to other applications or projects.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1535530970, "last_edit_date": 1535530970, "creation_date": 1535530500, "answer_id": 52072662, "question_id": 52072367, "link": "https://stackoverflow.com/questions/52072367/custom-function-disable-in-excel/52072662#52072662", "title": "Custom Function Disable in Excel", "body": "<p>You can make the function inoperable if called from the worksheet by identifying the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Application.Caller\" rel=\"nofollow noreferrer\">Application.Caller</a>. If called as a function from the XL UI, this will be Range (i.e. the cell the function is within).</p>\n\n<pre><code>Function Coverts(ByVal inputString As String) As String\n\n   If TypeName(Application.Caller) = \"Range\" then\n      Coverts = cverr(xlerrna)\n      exit function\n   end if\n\n   'Coverts code here\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1535530970, "creation_date": 1535529459, "question_id": 52072367, "link": "https://stackoverflow.com/questions/52072367/custom-function-disable-in-excel", "title": "Custom Function Disable in Excel", "body": "<p>I have created a custom function that I am using excplicitly in another module in VBA. Function looks something like this:</p>\n\n<pre><code>Function Coverts(ByVal inputString As String) As String\n   'Coverts code here\nEnd Function\n</code></pre>\n\n<p>It works perfectly fine in both VBA and Excel UI. However, I do not want it to work or appear in Excel UI as I only want to use it in VBA. Is there a way to do this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1535531583, "post_id": 52072151, "comment_id": 91095601, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/36378476/why-does-the-date-returns-31-12-1899-when-1-is-passed-to-it\">Why does the date returns &quot;31-12-1899&quot; when 1 is passed to it?</a>"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1535531918, "post_id": 52072151, "comment_id": 91095791, "body": "Also as a useful future advice, <code>Date</code> has no literal type character, or identifier character. However, the compiler does implicitly coerce number-literals enclosed with <code>#</code> to a date. For example <code>#01-01-0001#</code> is a valid <code>Date</code>"}, {"owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1535593029, "post_id": 52072151, "comment_id": 91126448, "body": "Thanks Rawrplus but I still don&#39;t get it - the default is set to January 1, 0001 in VBA if you don&#39;t specify a date -  so I don&#39;t understand how that default translates to December 30, 1899 in Excel? Is January 1, 0001 in VBA technically stored as 0 - and then as a result displayed as December 30, 1899 in Excel? This is what I&#39;m trying to figure out."}, {"owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1535598789, "post_id": 52072151, "comment_id": 91127620, "body": "Also, if 0 = December 30, 1899 and 1 = January 1, 1900...what about December 31, 1899?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1535626007, "post_id": 52072151, "comment_id": 91140204, "body": "Yeah that&#39;s sadly kind of misleading thing in documentation as <code>Date</code> in VB (Visual Basic) returns <code>January 1, 001</code> while in VBA <code>December 30th, 1899</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1535531392, "post_id": 52072392, "comment_id": 91095495, "body": "Setting <code>Birthtime = 0</code> is excessive here. <code>Date</code> literal automatically defaults to <code>0</code> when it is left unassigned."}, {"owner": {"reputation": 703, "user_id": 5142585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWQdR.jpg?s=128&g=1", "display_name": "Pm Duda", "link": "https://stackoverflow.com/users/5142585/pm-duda"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1535532458, "post_id": 52072392, "comment_id": 91096145, "body": "Yeah, I know - it is only for explanation purpose."}, {"owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "edited": false, "score": 0, "creation_date": 1535593078, "post_id": 52072392, "comment_id": 91126454, "body": "Thanks Pm Duda. Please see comment directed to Rawrplus in first answer. I still don&#39;t &quot;get it&quot;."}, {"owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "edited": false, "score": 0, "creation_date": 1535598731, "post_id": 52072392, "comment_id": 91127610, "body": "Also, if 0 = December 30, 1899 and 1 = January 1, 1900...what about December 31, 1899?"}, {"owner": {"reputation": 703, "user_id": 5142585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWQdR.jpg?s=128&g=1", "display_name": "Pm Duda", "link": "https://stackoverflow.com/users/5142585/pm-duda"}, "edited": false, "score": 0, "creation_date": 1535719894, "post_id": 52072392, "comment_id": 91182289, "body": "No problem at all. Answer acceptance would be appreciated :)"}], "tags": [], "owner": {"reputation": 703, "user_id": 5142585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWQdR.jpg?s=128&g=1", "display_name": "Pm Duda", "link": "https://stackoverflow.com/users/5142585/pm-duda"}, "is_accepted": true, "score": 3, "last_activity_date": 1535616426, "last_edit_date": 1535616426, "creation_date": 1535529561, "answer_id": 52072392, "question_id": 52072151, "link": "https://stackoverflow.com/questions/52072151/default-date-is-not-what-i-expected-for-a-date-variable-initialized-with-time-on/52072392#52072392", "title": "Default date is not what I expected for a Date variable initialized with time only", "body": "<p>Excel treats date as a number. Since you provide only Time, he assumes that Date = 0.</p>\n\n<p>And Date 0 is December 30, 1899.</p>\n\n<h3>Edit</h3>\n\n<hr>\n\n<p>To answer your question from comments:</p>\n\n<ol>\n<li><code>Date</code> defaults to <code>January 1, 0001</code> in VB.NET. </li>\n<li><code>Date</code> default to <code>December 30, 1899</code> in VBA and is stored as 0.</li>\n<li><p><code>Date = 1</code> not equals to <code>January 1, 1900</code>, but to <code>December 31, 1899</code>. <code>January 1, 1900</code> is equal to <code>2</code>. Check code below.</p>\n\n<pre><code>Sub TimeOfBirth()\n    MsgBox Format(0, \"yyyy-mm-dd\") '1899-12-30\n    MsgBox Format(1, \"yyyy-mm-dd\") '1899-12-31\n    MsgBox Format(2, \"yyyy-mm-dd\") '1900-01-01\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 52072392, "answer_count": 1, "score": 1, "last_activity_date": 1544784330, "creation_date": 1535528719, "last_edit_date": 1544784330, "question_id": 52072151, "link": "https://stackoverflow.com/questions/52072151/default-date-is-not-what-i-expected-for-a-date-variable-initialized-with-time-on", "title": "Default date is not what I expected for a Date variable initialized with time only", "body": "<p>With a <code>Date</code> variable, apparently it defaults to <code>January 1, 0001</code> if you don't enter a date in a date/time literal. </p>\n\n<p>However, if I choose to display that default date, it shows the date <code>December 30, 1899</code> which isn't even an acceptable date in Excel. Here's the code:</p>\n\n<pre><code>Sub TimeOfBirth()  \n  Dim BirthTime As Date  \n  BirthTime = \"2:00:00 PM\"  \n  MsgBox Format(BirthTime, \"yyyy-mm-dd\")  \nEnd Sub\n</code></pre>\n\n<p>Can anyone explain this? I get that VBA stores a much greater range of dates, but I don't understand why <code>December 30, 1899</code> is being displayed?</p>\n\n<p>What's the math/logic there?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1535528588, "post_id": 52071945, "comment_id": 91093774, "body": "There is some information here that may relevent to your question: <a href=\"https://peltiertech.com/Excel/ChartsHowTo/ChartProtection.html\" rel=\"nofollow noreferrer\">peltiertech.com/Excel/ChartsHowTo/ChartProtection.html</a> You will also have to consider the possibility of the chart being removed through cutting. A possible solution would be to have a vba script that checks the charts exist and if any are missing to recreate them."}], "answers": [{"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 1, "last_activity_date": 1535534583, "last_edit_date": 1535534583, "creation_date": 1535533613, "answer_id": 52073595, "question_id": 52071945, "link": "https://stackoverflow.com/questions/52071945/blocking-charts-from-removing/52073595#52073595", "title": "Blocking charts from removing", "body": "<p><strong>It is impossible to prevent <code>Chart</code> deletion, while simultaneously enabling it to be moved</strong></p>\n\n<p>There are two following options, which *sorta* achieve what you want:</p>\n\n<ol>\n<li><p><strong>Enable Sheet Protection</strong> (<code>Review -&gt; Protect Sheet</code>) which will achieve the following:</p>\n\n<ul>\n<li>prevent the Chart from being deleted </li>\n<li>unfortunately also prevent chart from being moved</li>\n</ul></li>\n<li><p><strong>Use <code>Application.OnKey</code> to detect press of <kbd>Delete</kbd></strong></p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Application.OnKey \"{DELETE}\", \"PreventDeletion\"\nEnd Sub\n\nPrivate Sub PreventDeletion()\n    MsgBox (\"Deletion not allowed in this worksheet\")\nEnd Sub\n</code></pre>\n\n<ul>\n<li>this allows the chart to be moved</li>\n<li>unfortunately only creates an illusion of delete protection. If user uses mouse2 and selects the delete option, it will still be available to him. This only interrupts pressing the <kbd>Delete</kbd> </li>\n<li>also this renders <kbd>Delete</kbd> obsolete for entire Sheet, which can be annoying (for the users)</li>\n</ul></li>\n</ol>\n\n<p>Neither option is ideal, though personally I prefer the first one, as preventing usage of <kbd>Delete</kbd> altogether is bound to annoy your users. </p>\n"}], "owner": {"reputation": 37, "user_id": 10218445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77103e595d31b11b2dcb85242af8e01c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/10218445/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1535534583, "creation_date": 1535528056, "question_id": 52071945, "link": "https://stackoverflow.com/questions/52071945/blocking-charts-from-removing", "title": "Blocking charts from removing", "body": "<p>I have a chart that I want user not to delete. Yet I'd like to give him option to move or resize it if he wants to, so I think, that option <code>locked</code> in properties is not appropriate here (I use <code>secure worksheet</code> too).</p>\n\n<p>Is there any possibility here to make code that works when user clicks <code>Del</code> on the keyboard, then some <code>msgBox</code> with information with error, that this chart is not deletable appears and then discard this action of removing?</p>\n"}, {"tags": ["arrays", "vba", "ms-word"], "comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1535528853, "post_id": 52071770, "comment_id": 91093907, "body": "You need to tell us how the data in the textfile are arranged and how they relate to what&#39;s in the Word document."}, {"owner": {"reputation": 65, "user_id": 4331840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ce85202d07a975374734884b3f77492?s=128&d=identicon&r=PG&f=1", "display_name": "Lu&#237;s Baptista Louren&#231;o", "link": "https://stackoverflow.com/users/4331840/lu%c3%ads-baptista-louren%c3%a7o"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1535530256, "post_id": 52071770, "comment_id": 91094754, "body": "Hello @macropod, I edited the main question with the way the textfile is arranged."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 4331840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ce85202d07a975374734884b3f77492?s=128&d=identicon&r=PG&f=1", "display_name": "Lu&#237;s Baptista Louren&#231;o", "link": "https://stackoverflow.com/users/4331840/lu%c3%ads-baptista-louren%c3%a7o"}, "edited": false, "score": 0, "creation_date": 1535536808, "post_id": 52072846, "comment_id": 91098924, "body": "Thank you a lot for your kind help! I will work with this information! :)"}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 1, "last_activity_date": 1535531186, "creation_date": 1535531186, "answer_id": 52072846, "question_id": 52071770, "link": "https://stackoverflow.com/questions/52071770/how-to-fill-an-array-with-the-information-of-a-txt-file-and-then-using-that-arra/52072846#52072846", "title": "How to fill an array with the information of a txt file and then using that array?", "body": "<p>Try something along the lines of:</p>\n\n<pre><code>Sub Demo()\nApplication.ScreenUpdating = False\nDim SrcDoc As Document, RList, i As Long\nConst FList As String = \"CLIENTNumber,CLIENTName\"\n'Load the strings from the reference file into a text string to be used as an array.\nSet SrcDoc = Documents.Open(\"Drive:\\FilePath\\DataList.txt\", ReadOnly:=True, AddToRecentFiles:=False, Visible:=False)\nWith SrcDoc\n  RList = .Range.Text\n  .Close False\nEnd With\nSet SrcDoc = Nothing\nWith ActiveDocument.Range.Find\n  .ClearFormatting\n  .Replacement.ClearFormatting\n  .MatchWholeWord = True\n  .MatchCase = True\n  For i = 0 To UBound(Split(FList, \",\"))\n    .Text = Split(FList, vbCr)(i)\n    .Replacement.Text = Split(RList, vbCr)(i)\n    .Execute Replace:=wdReplaceAll\n  Next\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Simply supply all the items for the FList string, with nothing but a comma separating them and in the order in which they appear in the text file, and the full path &amp; name to the text file where indicated.</p>\n"}], "owner": {"reputation": 65, "user_id": 4331840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ce85202d07a975374734884b3f77492?s=128&d=identicon&r=PG&f=1", "display_name": "Lu&#237;s Baptista Louren&#231;o", "link": "https://stackoverflow.com/users/4331840/lu%c3%ads-baptista-louren%c3%a7o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593415343, "creation_date": 1535527541, "last_edit_date": 1593415343, "question_id": 52071770, "link": "https://stackoverflow.com/questions/52071770/how-to-fill-an-array-with-the-information-of-a-txt-file-and-then-using-that-arra", "title": "How to fill an array with the information of a txt file and then using that array?", "body": "<p>sorry all if this question was done before but couldn't find it and similar examples didn't work.</p>\n\n<p>I want to put the information of a txt file in an array on VBA. And then use that array to fill different strings of the code. Can you help me? Right now I can't get read the file and fill the array.</p>\n\n<p>The idea is this:\nDocument with number of client, address, etc for each line\nVBA reads the txt and fills an array, each position is a line of the txt.\nI use the array to fill the template:</p>\n\n<pre><code>Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n        .Text = \"CLIENTENumber\"\n        .Replacement.Text = ARRAY[Positionwithclient]\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n\n<p>Thank you!!</p>\n\n<p>For extra info, the information on txt is arranged the following way:</p>\n\n<pre><code>565656\nPeter\n(etc)\n</code></pre>\n\n<p>Being the first the client number, the second the name, etc. Then I will replace the \"CLIENTNumber\" in the word document with the 565656, for example. The replacement code is above and works well.</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 361, "user_id": 7750399, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/03ef02687a1c76445f99f533230a1184?s=128&d=identicon&r=PG&f=1", "display_name": "diem_L", "link": "https://stackoverflow.com/users/7750399/diem-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1535527345, "creation_date": 1535527345, "question_id": 52071704, "link": "https://stackoverflow.com/questions/52071704/vba-change-scatter-point-to-pentagonshape", "title": "VBA Change Scatter Point to PentagonShape", "body": "<p>I created a Macro which creates ten scatter with color stops. Now i want that the scatter point looks like a pentagon. I created a pentagon and copy paste it to the diagram. </p>\n\n<p>Here you can see how it should look:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iWdP2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iWdP2.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is what happens when i run the Macro:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WBSng.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WBSng.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub Diagramm_OV()\n\n    Dim a As Integer\n\n    a = 1\n    Do\n        ActiveSheet.Shapes.AddChart2(240, xlXYScatter).Select\n        With ActiveChart\n            .SeriesCollection.NewSeries\n            .FullSeriesCollection(1).XValues = \"='Project Overview'!$E$8\"\n            .FullSeriesCollection(1).Values = \"={1}\"\n            .Axes(xlCategory).Select\n            .Axes(xlCategory).MaximumScale = 100\n        End With\n\n        ActiveChart.ChartTitle.Select\n        Selection.Delete\n        ActiveChart.Axes(xlValue).Select\n        Selection.Delete\n        ActiveChart.Axes(xlValue).MajorGridlines.Select\n        Selection.Delete\n        ActiveChart.PlotArea.Select\n\n        With ActiveChart.PlotArea.Format.Fill\n            .Visible = msoTrue\n            .TwoColorGradient msoGradientVertical, 1\n            .ForeColor.RGB = RGB(255, 0, 0)\n            .BackColor.RGB = RGB(0, 255, 0)\n            .GradientStops(1).Position = 0\n            .GradientStops(2).Position = 1\n        End With\n\n        With ActiveSheet\n            .Shapes(\"Diagramm \" &amp; a).ScaleHeight 0.3361111111, msoFalse, _\n            msoScaleFromTopLeft\n            .Shapes(\"Diagramm \" &amp; a).IncrementLeft 117.6\n            .Shapes(\"Diagramm \" &amp; a).IncrementTop -107.4\n            .ChartObjects(\"Diagramm \" &amp; a).Activate\n            .Shapes.AddShape(msoShapePentagon, 150, 244.8, 24.6, 7.8).Select\n        End With\n\n        ' Create Pentagon and copy it\n        Selection.ShapeRange.IncrementRotation 90\n        Selection.Copy\n\n        ActiveSheet.ChartObjects(\"Diagramm \" &amp; a).Activate\n\n        ' Paste Pentagon to Scatter\n        With ActiveChart\n            .FullSeriesCollection(1).Select\n            .Paste\n        End With\n\n        ActiveSheet.Shapes(\"Diagramm \" &amp; a).ScaleHeight 0.7685950413, msoFalse, _\n            msoScaleFromTopLeft\n        a = a + 2\n    Loop Until a = 10\nEnd Sub\n</code></pre>\n\n<p>I hope someone can help me, that the pentagon will be the scatter.</p>\n"}, {"tags": ["arrays", "excel", "vba", "dictionary"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4045015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8621aca2f2d4fc9aca2eb7c32983098b?s=128&d=identicon&r=PG&f=1", "display_name": "Bernhard", "link": "https://stackoverflow.com/users/4045015/bernhard"}, "edited": false, "score": 0, "creation_date": 1535541907, "post_id": 52070968, "comment_id": 91102191, "body": "Wow, great! I had to use &quot;Dim rv as New Dictionary&quot; but apart from that, it now works great. Thanks a lot!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1535524615, "creation_date": 1535524615, "answer_id": 52070968, "question_id": 52070570, "link": "https://stackoverflow.com/questions/52070570/how-to-add-dictionary-values-to-an-array-in-vba-instead-of-reference/52070968#52070968", "title": "How to add dictionary values to an Array in VBA instead of reference", "body": "<p>Creating objects in a loop is easier to manage if you use a \"factory\" function.</p>\n\n<p>E.g:</p>\n\n<pre><code>Sub Tester()\n\n    Dim body As New Collection, i As Long\n\n    For i = 1 To 10\n        body.Add Progress(Cells(i, 1), Cells(i, 2))\n    Next i\n\nEnd Sub\n\nFunction Progress(grp, prog) As Object\n    Dim rv As New scripting.dictionary\n    rv.Add \"Group\", grp\n    rv.Add \"Progress\", prog\n    Set Progress = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4045015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8621aca2f2d4fc9aca2eb7c32983098b?s=128&d=identicon&r=PG&f=1", "display_name": "Bernhard", "link": "https://stackoverflow.com/users/4045015/bernhard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 52070968, "answer_count": 1, "score": 0, "last_activity_date": 1535524615, "creation_date": 1535523153, "last_edit_date": 1535523439, "question_id": 52070570, "link": "https://stackoverflow.com/questions/52070570/how-to-add-dictionary-values-to-an-array-in-vba-instead-of-reference", "title": "How to add dictionary values to an Array in VBA instead of reference", "body": "<p>I am sending data from Excel to the dashing.io dashboard via JSON. \nThe data which I am sending consist of several touples of data like</p>\n\n<pre><code>[{\"Group\":\"Interface\",\"progress\";\"10\"},{\"Group\":\"HMI\",\"progress\";\"20\"}]\n</code></pre>\n\n<p>Right now I am using several dictionary objects progress1, progress2 to hold the data like:</p>\n\n<pre><code>DIM progress1 as new Dictionary\nDIM progress2 as new Dictionary\nprogress1.add \"Group\", \"Interface\"\nprogress1.add \"Progress\", 10\nprogress2.add \"Group\", \"HMI\"\nprogress2.add \"Progress\", 20\n</code></pre>\n\n<p>And finally for creating the JSON object, the two progress dictionaries are added to one object:</p>\n\n<pre><code>Dim body as new Dictionary\nbody.add Array(progress1, progress2)\n</code></pre>\n\n<p>As there are more than just two progress items, I wanted to create a for-loop to add data to a dictionary and then add that dictionary item to an array like</p>\n\n<pre><code>for i=1 to 10\n  progress.add \"Group\", Range(i,1)\n  progress.add \"progress\", Range (i,2)\nnext i\noverall_progress.add (progress)\n</code></pre>\n\n<p>It seems that I am adding the object as reference, instead of the values of the object. If the loop runs 10 times, I end up having ten times the same entry.</p>\n\n<p>Any idea how to add the values of a dictionary to an array, instead of the reference?</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 277, "user_id": 6457250, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c724842d23e226e2dbfe2c80514194da?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Jensen", "link": "https://stackoverflow.com/users/6457250/simon-jensen"}, "edited": false, "score": 0, "creation_date": 1535523006, "post_id": 52070470, "comment_id": 91090787, "body": "What have you tried? A quick search gave this: <a href=\"https://stackoverflow.com/questions/48101010/how-to-create-a-filtering-search-box-in-excel-with-radio-buttons\" title=\"how to create a filtering search box in excel with radio buttons\">stackoverflow.com/questions/48101010/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 261, "user_id": 10169396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2397326b698fceea111953d14aefd02a?s=128&d=identicon&r=PG&f=1", "display_name": "Lina", "link": "https://stackoverflow.com/users/10169396/lina"}, "is_accepted": false, "score": 0, "last_activity_date": 1535527486, "creation_date": 1535527486, "answer_id": 52071746, "question_id": 52070470, "link": "https://stackoverflow.com/questions/52070470/how-to-convert-a-filter-to-work-as-a-radio-button-in-pivot-tabel-excel/52071746#52071746", "title": "How to convert a Filter to work as a radio button in Pivot Tabel Excel", "body": "<p>My advice to you about removing filters</p>\n\n<p>If the sheet already has a filter on it then:</p>\n\n<pre><code>Sub AutoFilter_Remove()\n  Cells.AutoFilter\nEnd Sub\n</code></pre>\n\n<p>Or you could code it this way:</p>\n\n<pre><code>Sub AutoFilter_Remove()\n  If ActiveSheet.AutoFilterMode Then ActiveSheet.ShowAllData  \nEnd Sub\n</code></pre>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 273, "user_id": 4065483, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c42a5d98cebf8e61f6e4b26bcfb77832?s=128&d=identicon&r=PG&f=1", "display_name": "Mehaboob Khan", "link": "https://stackoverflow.com/users/4065483/mehaboob-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594072315, "creation_date": 1535522648, "last_edit_date": 1594072315, "question_id": 52070470, "link": "https://stackoverflow.com/questions/52070470/how-to-convert-a-filter-to-work-as-a-radio-button-in-pivot-tabel-excel", "title": "How to convert a Filter to work as a radio button in Pivot Tabel Excel", "body": "<p>I have created a Pivot Table which has a filter on a column. Image given below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ceGDe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ceGDe.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want this to work like a radio button. Only one option should be selected at a time. And I also want \"All\" filter and \"Select Multiple Items\" checkbox to be removed. \nI have no knowledge about coding in Excel. I need layman explanation of doing this.</p>\n\n<p>Thanks in Advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1447, "user_id": 6771046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K59fa.png?s=128&g=1", "display_name": "U880D", "link": "https://stackoverflow.com/users/6771046/u880d"}, "edited": false, "score": 2, "creation_date": 1535520724, "post_id": 52069937, "comment_id": 91089929, "body": "I am afraid that providing just the expected output without the given input and the algorithm/formula will not be enough to answer. From your post I understand that the series is <code>a,b ; c,d ; ...</code>. How do you like to calculate <code>c</code> first? Will it be <code>a+1</code> or <code>b+1</code>? Than, should <code>d=a</code> and <code>f=c</code> and so on?"}, {"owner": {"reputation": 65, "user_id": 10287976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnTEYhqoFOA/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOnhK2SwCMkCIv3EtyrzOjg8Q8Fzw/mo/photo.jpg?sz=128", "display_name": "Norbert", "link": "https://stackoverflow.com/users/10287976/norbert"}, "reply_to_user": {"reputation": 1447, "user_id": 6771046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K59fa.png?s=128&g=1", "display_name": "U880D", "link": "https://stackoverflow.com/users/6771046/u880d"}, "edited": false, "score": 2, "creation_date": 1535521918, "post_id": 52069937, "comment_id": 91090350, "body": "i mean x = 1 and y = 1. and the coordinates are: x,y then 2x,y then 2x,2y then 3x,2y then 3x,3y and so on..."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 10287976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnTEYhqoFOA/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOnhK2SwCMkCIv3EtyrzOjg8Q8Fzw/mo/photo.jpg?sz=128", "display_name": "Norbert", "link": "https://stackoverflow.com/users/10287976/norbert"}, "edited": false, "score": 0, "creation_date": 1535529358, "post_id": 52072177, "comment_id": 91094213, "body": "Thank you for the answer but i must not use arrays."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1535551138, "post_id": 52072177, "comment_id": 91108534, "body": "Just a note: The <code>arrA</code> is unnecessary because it is represented by <code>Z</code> already, so <code>A = Z</code> and the other arrays can be calculated by using <code>Z</code> and div operator too: <code>X = (Z \\ 2) + 1</code> and <code>Y = ((Z - 1) \\ 2) + 1</code>. Advantage is that you don&#39;t need to define arrays and it&#39;s much easier to extend the logic. See <a href=\"https://stackoverflow.com/a/52078683/3219613\">my answer</a> too."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1535553277, "post_id": 52072177, "comment_id": 91110052, "body": "@Peh, I included arrA for full coverage. Just wanted to be as clear as possible. Yes there are easier ways but wanted to give this possibility. Wasn\u2019t sure if the sequence would always apply. Thanks for thinking along! :)"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1535529508, "last_edit_date": 1535529508, "creation_date": 1535528810, "answer_id": 52072177, "question_id": 52069937, "link": "https://stackoverflow.com/questions/52069937/how-can-i-write-a-code-where-the-values-are-stepped/52072177#52072177", "title": "How can I write a code where the values are &#39;stepped&#39;?", "body": "<p>You can step through your sequence in VBA using arrays like so:</p>\n\n<pre><code>Sub StepAXY()\n\nDim Z As Long, A As Long, X As Long, Y As Long\nDim arrA() As Variant, arrX() As Variant, arrY() As Variant\n\narrA = Array(1, 2, 3, 4, 5, 6, 7)\narrX = Array(1, 2, 2, 3, 3, 4, 4)\narrY = Array(1, 1, 2, 2, 3, 3, 4)\n\nFor Z = 1 To 7 Step 1\n    A = arrA(Z - 1)\n    X = arrX(Z - 1)\n    Y = arrY(Z - 1)\n    Cells(X * 1, Y * 1) = A * 1\nNext Z\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 10287976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnTEYhqoFOA/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOnhK2SwCMkCIv3EtyrzOjg8Q8Fzw/mo/photo.jpg?sz=128", "display_name": "Norbert", "link": "https://stackoverflow.com/users/10287976/norbert"}, "edited": false, "score": 1, "creation_date": 1535531053, "post_id": 52072339, "comment_id": 91095278, "body": "I modified your code but you helped me very much! Thank you everyone!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1535537368, "last_edit_date": 1535537368, "creation_date": 1535529347, "answer_id": 52072339, "question_id": 52069937, "link": "https://stackoverflow.com/questions/52069937/how-can-i-write-a-code-where-the-values-are-stepped/52072339#52072339", "title": "How can I write a code where the values are &#39;stepped&#39;?", "body": "<p>Here is a different approach. This will give you an extra row (5x,4y) so if this is not desired can be excluded using an If statement.</p>\n\n<pre><code>Sub Generate()\n\nDim x As Long, y As Long, a As Long, b As Long, c As Long\n\nFor b = 1 To 4\n    Cells(b * x, b * y) = (2 * b - 1) * a\n    Cells((b + 1) * x, b * y) = 2 * b * a\nNext b\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 10287976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnTEYhqoFOA/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOnhK2SwCMkCIv3EtyrzOjg8Q8Fzw/mo/photo.jpg?sz=128", "display_name": "Norbert", "link": "https://stackoverflow.com/users/10287976/norbert"}, "edited": false, "score": 0, "creation_date": 1535607462, "post_id": 52078683, "comment_id": 91129566, "body": "Thanks for the help!  It is a really smart solution!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1535549453, "creation_date": 1535549453, "answer_id": 52078683, "question_id": 52069937, "link": "https://stackoverflow.com/questions/52069937/how-can-i-write-a-code-where-the-values-are-stepped/52078683#52078683", "title": "How can I write a code where the values are &#39;stepped&#39;?", "body": "<p>This would be an alternative version to do it</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Generate()\n    Dim a As Long: a = 1\n\n    Dim i As Long\n    For i = 1 To 7\n        Cells((i \\ 2) + 1, ((i - 1) \\ 2) + 1).Value = i * a\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Note that this uses the <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/integer-division-operator\" rel=\"nofollow noreferrer\">div Operator</a> <code>5 \\ 2</code> which is not a standard division <code>5 / 2</code>. The div operator divides two numbers and returns an integer result.</p>\n\n<ul>\n<li>Standard division of <code>5 / 2 = 2.5</code></li>\n<li>Div Operator of <code>5 / 2 = 2</code></li>\n</ul>\n\n<p>So <code>(i \\ 2) + 1, ((i - 1) \\ 2) + 1</code> results in</p>\n\n<pre><code>1, 1 \n2, 1 \n2, 2 \n3, 2 \n3, 3 \n4, 3 \n4, 4 \n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 10287976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnTEYhqoFOA/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOnhK2SwCMkCIv3EtyrzOjg8Q8Fzw/mo/photo.jpg?sz=128", "display_name": "Norbert", "link": "https://stackoverflow.com/users/10287976/norbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 52078683, "answer_count": 3, "score": 1, "last_activity_date": 1549012549, "creation_date": 1535519951, "last_edit_date": 1549012549, "question_id": 52069937, "link": "https://stackoverflow.com/questions/52069937/how-can-i-write-a-code-where-the-values-are-stepped", "title": "How can I write a code where the values are &#39;stepped&#39;?", "body": "<p>I just started programming in Excel VBA and I have a question.</p>\n\n<p>How can I write a code where the values are 'stepped'?</p>\n\n<p>I want to code this by using <code>do until</code>, <code>do while</code> and <code>for</code> only. </p>\n\n<p>I'm using two variables: <code>x = 1</code> and <code>y = 1</code>. The value must be the number of the cycle.</p>\n\n<p><strong>The output would look like this:</strong></p>\n\n<pre><code>cells(x,y). value = a\ncells(2x,y). value = 2a\ncells(2x,2y). value = 3a\ncells(3x,2y). value = 4a\ncells(3x,3y). value = 5a\ncells(4x,3y). value = 6a\ncells(4x,4y). value = 7a\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1535520246, "creation_date": 1535520246, "answer_id": 52069983, "question_id": 52069921, "link": "https://stackoverflow.com/questions/52069921/count-number-of-comma-separated-values-divide-next-cell-by-that-number/52069983#52069983", "title": "Count number of comma separated values, divide next cell by that number?", "body": "<p>Split the first cell value on the commas and adjust the ubound dimension of the resulting array.</p>\n\n<pre><code>dim i as long\ni = ubound(split(range(\"b2\").value, chr(44))) + 1\nrange(\"d2\") = cdbl(range(\"c2\").value / i)\n</code></pre>\n\n<p>Without the compiler directive Option Base 1, a split array is zero-based.</p>\n"}, {"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 1, "last_activity_date": 1535523851, "creation_date": 1535523851, "answer_id": 52070762, "question_id": 52069921, "link": "https://stackoverflow.com/questions/52069921/count-number-of-comma-separated-values-divide-next-cell-by-that-number/52070762#52070762", "title": "Count number of comma separated values, divide next cell by that number?", "body": "<p>Unless you really want it, I'm not sure you need a VBA solution for this. The calculation can be done using Excel's formulas: simply subtract the length of the string from the length of it with commas removed. Your cell formula could look something like this:</p>\n\n<pre><code>=C3/(LEN(B3)-LEN(SUBSTITUTE(B3,\",\",\"\"))+1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1535531128, "last_edit_date": 1535531128, "creation_date": 1535530805, "answer_id": 52072735, "question_id": 52069921, "link": "https://stackoverflow.com/questions/52069921/count-number-of-comma-separated-values-divide-next-cell-by-that-number/52072735#52072735", "title": "Count number of comma separated values, divide next cell by that number?", "body": "<p>You could use a formula as well</p>\n\n<p>In D2 entered as array formula with <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd></p>\n\n<pre><code>=IF(ISBLANK(B2),\"\",C2/COUNT(FILTERXML(\"&lt;t&gt;&lt;s&gt;\" &amp; SUBSTITUTE(B2,CHAR(44), \"&lt;/s&gt;&lt;s&gt;\") &amp; \"&lt;/s&gt;&lt;/t&gt;\", \"//s\")))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10286964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d17a56a833b90d948015a0c66be6001?s=128&d=identicon&r=PG&f=1", "display_name": "jfailing", "link": "https://stackoverflow.com/users/10286964/jfailing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1535531128, "creation_date": 1535519835, "last_edit_date": 1535520120, "question_id": 52069921, "link": "https://stackoverflow.com/questions/52069921/count-number-of-comma-separated-values-divide-next-cell-by-that-number", "title": "Count number of comma separated values, divide next cell by that number?", "body": "<p>I have a table in which one column occasionally contains a sequence of numbers separated by commas (Units). I'd like to find a script that will count the amount of values in that cell (Values), then divide the adjacent cell by that amount, ultimately replacing the value of that cell (NeedResult, replacing Values).</p>\n\n<p>I've played around with formulas, but my VBA skills are rudimentary... Any help mucho appreciated!</p>\n\n<p>table image here</p>\n\n<p><a href=\"https://i.stack.imgur.com/0mfqI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0mfqI.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1535517911, "post_id": 52069571, "comment_id": 91089037, "body": "it&#39;s an age old problem/limitation of evaluate. If the returned value&#39;s length is &gt; 255  chars, Error 2015 pops up.  As far as I know, there is now workaround, not at least with <b>Evaluate</b>. Check if the library is COM enabled i.e  exposes/allows methods to be used in VBA directly."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1535522639, "post_id": 52069571, "comment_id": 91090638, "body": "@cyboashu You meant <i>there is <b>no</b> workaround</i>?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1535523183, "post_id": 52069571, "comment_id": 91090891, "body": "i don&#39;t know any.But that&#39;s just me. (and few more ) :) I see I wrote <b>now</b> instead of <b>no</b>, long day and few beers!!"}, {"owner": {"reputation": 2287, "user_id": 5557126, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/10207963011092502/picture?type=large", "display_name": "Nicholas Muir", "link": "https://stackoverflow.com/users/5557126/nicholas-muir"}, "edited": false, "score": 0, "creation_date": 1535640694, "post_id": 52069571, "comment_id": 91150527, "body": "Thank you very much for your response. I am talking to OsiSoft so I will check if it is com enabled."}], "answers": [{"comments": [{"owner": {"reputation": 2287, "user_id": 5557126, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/10207963011092502/picture?type=large", "display_name": "Nicholas Muir", "link": "https://stackoverflow.com/users/5557126/nicholas-muir"}, "edited": false, "score": 0, "creation_date": 1535640839, "post_id": 52070374, "comment_id": 91150628, "body": "Thank you! I will try this out when I get access to the database again."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 2, "last_activity_date": 1535522729, "last_edit_date": 1535522729, "creation_date": 1535522164, "answer_id": 52070374, "question_id": 52069571, "link": "https://stackoverflow.com/questions/52069571/vba-evaluate-function-not-working-error-2015/52070374#52070374", "title": "VBA Evaluate function not working. Error 2015", "body": "<p>The point that cyboashu makes is a good one. It might also be the case, though, that you are receiving this error because of your syntax.</p>\n\n<p>When using <code>Evaluate</code>, you must pass in the string exactly as you want it to be evaluated. Your code is passing the name of the variables instead of their values. If I could simplify an example. The following code would return an Error (2029 in this case, which is a #NAME error):</p>\n\n<pre><code>Dim dat As Variant\nDim txt As String\n\ntxt = \"25 December 1966\"\n\ndat = Application.Evaluate(\"=DateValue(txt)\")\n</code></pre>\n\n<p>In this example you would need to create the string so that the <strong>value</strong> of <code>txt</code> were evaluated, like so:</p>\n\n<pre><code>Dim dat As Variant\nDim txt As String\n\ntxt = \"25 December 1966\"\n\ndat = Application.Evaluate(\"=DateValue(\"\"\" &amp; txt &amp; \"\"\")\")\n</code></pre>\n\n<p>I suspect this is the cause because if inverted commas are missing from a required string, then Evaluate will return a 2015 Error. This would do it for example:</p>\n\n<pre><code>Dim dat As Variant\nDim txt As String\n\ntxt = \"25 December 1966\"\n\ndat = Application.Evaluate(\"=DateValue(\" &amp; txt &amp; \")\")\n</code></pre>\n\n<p>I don't have the library to test your exact code, but try rewriting your evaluation string to incorporate the values of your variables instead and remember to pass in the inverted commas too.</p>\n"}], "owner": {"reputation": 2287, "user_id": 5557126, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/10207963011092502/picture?type=large", "display_name": "Nicholas Muir", "link": "https://stackoverflow.com/users/5557126/nicholas-muir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4449, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535522729, "creation_date": 1535517486, "last_edit_date": 1535520614, "question_id": 52069571, "link": "https://stackoverflow.com/questions/52069571/vba-evaluate-function-not-working-error-2015", "title": "VBA Evaluate function not working. Error 2015", "body": "<p>I am trying to connect OsiSoft Pi Datalink with Excel VBA and put the output into a variable for further VBA procesing.</p>\n\n<p>When running the command in the excel cell it works fine but when I try to run it in VBA I get \u201cError 2015\u201d</p>\n\n<p><a href=\"https://i.stack.imgur.com/nu3sW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nu3sW.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the code that is working fine in the cell:</p>\n\n<pre><code>= PITimeDat(\"PP2941FIC01_PV_S\", \"7/07/2018  11:01:58 AM\", \"\", \"interpolated\")\n</code></pre>\n\n<p>Converting this to VBA: </p>\n\n<pre><code>Sub getPiData()\n\n    Dim tagName As String\n    tagName = \"PP2941FIC01_PV_S\"\n\n    Dim timeStamp As String\n    timeStamp = \"7/07/2018  11:01:58 AM\"\n\n    Dim rootPath As String\n    rootPath = \"\"\n\n    Dim retrieveMode As String\n    retrieveMode = \"interpolated\"\n\n    Dim result As String\n    result = CStr(Application.Evaluate(\"=PITimeDat(tagName, timeStamp, rootPath, retrieveMode)\"))\n\n    Debug.Print (result)\n\nEnd Sub\n</code></pre>\n\n<p>I have checked the VBA references as below and they also seem correct:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WWzQT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WWzQT.png\" alt=\"enter image description here\"></a></p>\n\n<p>There is no information in the user guides or available that I could find on the internet for corretcly connecting VBA to Pi Datalink. </p>\n\n<p>I found this on stackoverflow but it didn't explain the issue:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/39174744/pulling-data-from-pi-datalink-using-vba\">Pulling data from PI DataLink using VBA</a></p>\n\n<p>I am possibly missing somthing really basic but it seems like I am executing the exact same code in VBA as in the cell. The cell is returning a value and VBA is just returning an error.</p>\n\n<p>Thanks in advance for your help</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1535514013, "post_id": 52068969, "comment_id": 91088101, "body": "Is <code>If Not ExitAsk = vbYes Then Cancel = True</code> the line that is supposed to exit?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1535514730, "post_id": 52068969, "comment_id": 91088241, "body": "Perhaps you could re-phrase your question to make it more clear what you&#39;re trying to do, and where the problem lies."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1535531323, "post_id": 52068969, "comment_id": 91095456, "body": "<code>even after I select &quot;yes to terminate&quot; my sheet content still unhides.</code> isn&#39;t this to do with the fact that you call <code>Call unhide</code> under your worksheet?"}, {"owner": {"reputation": 75, "user_id": 10189458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbfb99e9cc10c16f4b2f21300b01a34?s=128&d=identicon&r=PG&f=1", "display_name": "Lim", "link": "https://stackoverflow.com/users/10189458/lim"}, "edited": false, "score": 0, "creation_date": 1535599919, "post_id": 52068969, "comment_id": 91127826, "body": "yes to terminate means &quot;yes&quot; to exit userform"}], "owner": {"reputation": 75, "user_id": 10189458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbfb99e9cc10c16f4b2f21300b01a34?s=128&d=identicon&r=PG&f=1", "display_name": "Lim", "link": "https://stackoverflow.com/users/10189458/lim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535517975, "creation_date": 1535512588, "last_edit_date": 1535514254, "question_id": 52068969, "link": "https://stackoverflow.com/questions/52068969/warning-message-doesnt-work-for-user-form", "title": "warning message doesn&#39;t work for user-form", "body": "<p>My content in sheet2 was hidden and only after user form popped up and enter the password before the content can unhide. However with the warning message, even after I select \"yes to terminate\" my sheet content still unhides. </p>\n\n<p><strong>Expected outcome:</strong><br>\nAfter the user selects \"yes to terminate\" on the warning message, it is suppose to drop the user form. Can anyone help me solve it?</p>\n\n<p><strong>Under worksheet(sheet2):</strong></p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    If Sheets(\"Reference\").Columns(\"A:K\").EntireColumn.Hidden = True Then\n        Password.Show\n        Call unhide\n    Else\n        Sheets(\"Reference\").Columns(\"A:K\").EntireColumn.Hidden = False\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Under userform (Password):</strong></p>\n\n<pre><code>Private Sub Submit_Click()\n    If Me.Pword.Value = \"123\" Then\n        Unload Me\n        Call unhide\n    Else\n        Me.Hide\n        Retry = MsgBox(\"The password is incorrect. Do you wish to try again?\", _\n            vbYesNo, \"Retry?\")\n        Select Case Retry\n            Case Is = vbYes\n                Me.Pword.Value = \"\"\n                Me.Pword.SetFocus\n                Me.Show\n            Case Is = vbNo\n                Unload Me\n        End Select\n    End If\nEnd Sub\n\nPrivate Sub cmdExit_Click()\n    If ExitAsk = vbYes Then Unload Password\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = vbFormControlMenu Then\n        If Not ExitAsk = vbYes Then Cancel = True\n    End If\nEnd Sub\n\nPrivate Function ExitAsk() As VbMsgBoxResult\n    Dim Smsg As String\n    Smsg = \"Do you really want to exit? Click Yes to Quit or No to Continue.\"\n    ExitAsk = MsgBox(Smsg, vbYesNo + vbDefaultButton2 + vbQuestion, \"Exit!\")\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1535512357, "post_id": 52068919, "comment_id": 91087785, "body": "Does she ever see the <code>&quot;Unable to open file, check path&quot;</code> message box before it crashes? I suspect based on your description that you just need an error trap around the <code>Set wb_td = Workbooks.Open</code> line."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535514282, "post_id": 52068919, "comment_id": 91088145, "body": "You can establish some form of logging so you can debug later. Refine it over time. I guess it partly depends on what you mean by crash."}, {"owner": {"reputation": 1073, "user_id": 1324833, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/90a0ee40beee8eb81ff9b1e7ef512aa4?s=128&d=identicon&r=PG", "display_name": "marcp", "link": "https://stackoverflow.com/users/1324833/marcp"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1535548282, "post_id": 52068919, "comment_id": 91106497, "body": "@Comintern no she never gets the error message."}, {"owner": {"reputation": 1073, "user_id": 1324833, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/90a0ee40beee8eb81ff9b1e7ef512aa4?s=128&d=identicon&r=PG", "display_name": "marcp", "link": "https://stackoverflow.com/users/1324833/marcp"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535548345, "post_id": 52068919, "comment_id": 91106536, "body": "@QHarr  I mean that Excel completely crashes. It has to be opened again."}], "answers": [{"comments": [{"owner": {"reputation": 1073, "user_id": 1324833, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/90a0ee40beee8eb81ff9b1e7ef512aa4?s=128&d=identicon&r=PG", "display_name": "marcp", "link": "https://stackoverflow.com/users/1324833/marcp"}, "edited": false, "score": 0, "creation_date": 1535548202, "post_id": 52069806, "comment_id": 91106441, "body": "I don&#39;t think it is a corrupt file issue. In the USB stick scenario it generally will load after copying it to the hard drive."}], "tags": [], "owner": {"reputation": 1, "user_id": 8909964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df420517363b09ff99c2070fdcab962?s=128&d=identicon&r=PG", "display_name": "freeflyz", "link": "https://stackoverflow.com/users/8909964/freeflyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1535519067, "creation_date": 1535519067, "answer_id": 52069806, "question_id": 52068919, "link": "https://stackoverflow.com/questions/52068919/excel-vba-hardening-a-fragile-function/52069806#52069806", "title": "excel vba hardening a fragile function", "body": "<p>You may be dealing with a corrupted file.  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Workbooks.Open\" rel=\"nofollow noreferrer\">Look at the workbooks.open method.</a> There are a few options under corruptload that may help. Try this one and experiment to see if any of the others work better in your situation.</p>\n\n<pre><code>Set wb_td = Workbooks.Open(Filename:=file_name, UpdateLinks:=False, ReadOnly:=False, corruptload:=xlRepairFile)\n</code></pre>\n"}], "owner": {"reputation": 1073, "user_id": 1324833, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/90a0ee40beee8eb81ff9b1e7ef512aa4?s=128&d=identicon&r=PG", "display_name": "marcp", "link": "https://stackoverflow.com/users/1324833/marcp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535519067, "creation_date": 1535512157, "question_id": 52068919, "link": "https://stackoverflow.com/questions/52068919/excel-vba-hardening-a-fragile-function", "title": "excel vba hardening a fragile function", "body": "<p>I've created a spreadsheet for tracking student data for my wife. There are 2 versions, the master and the teacher version. The only difference is that the teacher version has a couple of tabs and buttons hidden. </p>\n\n<p>At the end of every day she gathers the teacher versions and merges their data into the master version using a macro attached to a button. On a regular basis it causes Excel to crash. It seems like trying to merge a workbook that is on a usb stick is a surefire way to make it crash, but there are other circumstances that I haven't identified yet.</p>\n\n<p>She isn't technical enough to step through the code until it blows and I can't be there when she is doing it.</p>\n\n<p>Previous attempts to harden the code involved getting rid of any instance of Activesheet or Activeworkbook, and always using a direct reference to the worksheet (ie Sheet1, but renamed to something meaningful - \"merge\" in the example below). </p>\n\n<p>The function below, LoadTeacherData, is called once for each workbook to merge. All it does is copy the existing records on the teacher's data tab, copy them to the master merge tab and then delete them from the source. When it crashes it is immediately after selecting the file to load, I think.</p>\n\n<pre><code>Sub LoadTeacherData()\nDim wb_td As Workbook\nDim td As Worksheet\nDim newdata As Range\n\nWith Application.FileDialog(msoFileDialogOpen)\n    .AllowMultiSelect = False\n    .Filters.Clear\n    .Filters.Add \"Excel files\", \"*.xlsm\"\n\n    If .Show = -1 Then\n        file_name = .SelectedItems(1)\n    Else\n        Exit Sub\n    End If\nEnd With\n\nApplication.ScreenUpdating = False\nSet wb_td = Workbooks.Open(Filename:=file_name, UpdateLinks:=False, ReadOnly:=False)\nIf wb_td Is Nothing Then\n    MsgBox \"Unable to open file, check path\", vbOKOnly\n    Exit Sub\nEnd If\n\nfile_name = wb_td.Name\nSet td = wb_td.Worksheets(\"data\")\n\nrow = LastRow(td, \"C\")\ncol = LastCol(td, 1)\nSet newdata = td.Range(\"a2\", td.Cells(row, col))\nnewdata.Copy Destination:=Merge.Cells(LastRow(Merge, \"C\") + 1, 1)\nnewdata.Clear\nMsgBox (row - 1 &amp; \" records merged\")\nwb_td.Close\nThisWorkbook.Activate\nThisWorkbook.Save\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n\n\nFunction LastRow(ByRef ws As Worksheet, ByVal colname As String)\n    LastRow = ws.Range(colname &amp; ws.Rows.Count).End(xlUp).row\nEnd Function\n\nFunction LastCol(ByRef ws As Worksheet, ByVal rownum As Long)\n    LastCol = ws.Cells(rownum, ws.Columns.Count).End(xlToLeft).Column\nEnd Function\n</code></pre>\n\n<p>My suspicion is that it has something to do with permissions when opening the file. Her excel version is configured so that she has to enable content every time when opening a file.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1064, "user_id": 4722577, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df632265f05cfef80f4d3da89de8cd7b?s=128&d=identicon&r=PG&f=1", "display_name": "CAM_344", "link": "https://stackoverflow.com/users/4722577/cam-344"}, "edited": false, "score": 0, "creation_date": 1535508181, "post_id": 52068468, "comment_id": 91086939, "body": "For rRate to be 0, I wonder if the variable Rejects being assigned a value correctly?"}, {"owner": {"reputation": 49, "user_id": 9895501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0fe47db67a68d8a5a15426b0eaa5faf?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/9895501/matt"}, "reply_to_user": {"reputation": 1064, "user_id": 4722577, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df632265f05cfef80f4d3da89de8cd7b?s=128&d=identicon&r=PG&f=1", "display_name": "CAM_344", "link": "https://stackoverflow.com/users/4722577/cam-344"}, "edited": false, "score": 0, "creation_date": 1535508327, "post_id": 52068468, "comment_id": 91086978, "body": "Rejects gets input into the spreadsheet too and it is the correct value. Same with tProd. When I go into the spreadsheet and divide those two cells I get the correct answer"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1535508343, "post_id": 52068468, "comment_id": 91086984, "body": "Declare them <code>As Double</code> instead of <code>As Long</code>. As they&#39;re the result of division, any decimal places they have will be discarded if you declare them <code>As Long</code>"}, {"owner": {"reputation": 49, "user_id": 9895501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0fe47db67a68d8a5a15426b0eaa5faf?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/9895501/matt"}, "edited": false, "score": 0, "creation_date": 1535508723, "post_id": 52068468, "comment_id": 91087073, "body": "Excellent, thank you! All fixed"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1535509418, "creation_date": 1535509418, "answer_id": 52068600, "question_id": 52068468, "link": "https://stackoverflow.com/questions/52068468/dividing-variables-giving-false-zero-result/52068600#52068600", "title": "Dividing variables giving false zero result", "body": "<p>The issue is variable declaration, as you guessed. </p>\n\n<p><code>rRate</code> and <code>pRate</code> both are the result of division: <code>rRate = Rejects / tProd</code> and <code>pRate = tTime / tProd</code>. Any decimal places that result will be silently discarded since the variables are declared <code>As Long</code>. </p>\n\n<p>For example, if you expect <code>rRate</code> to be 0.475, if declared <code>As Long</code> the decimal places will be discarded, it will equal 0, and your <code>msgBox</code> will return 0. Instead, you can declare them <code>As Double</code>.</p>\n\n<p>See the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/long-data-type\" rel=\"nofollow noreferrer\">Long</a> vs <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/double-data-type\" rel=\"nofollow noreferrer\">Double</a> data types for more detail.</p>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 9895501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0fe47db67a68d8a5a15426b0eaa5faf?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/9895501/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1535509441, "creation_date": 1535509441, "answer_id": 52068604, "question_id": 52068468, "link": "https://stackoverflow.com/questions/52068468/dividing-variables-giving-false-zero-result/52068604#52068604", "title": "Dividing variables giving false zero result", "body": "<p>For the sake of closing this question here is the now working code. Thanks BigBen for the input.</p>\n\n<pre><code>Dim rRate As Double\nDim sTime As Date\nDim fTime As Date\nDim tTime As Date\nDim pRate As Double\nDim Rejects As Long\nDim tProd As Long\n\nRejects = frmProduction.lblTotalRejects.Caption\ntProd = frmProduction.lblTotal.Caption\n\nrRate = Rejects / tProd\n\nsTime = ThisWorkbook.ActiveSheet.Cells(lRow, \"B\")\nfTime = Now\ntTime = fTime - sTime\n\npRate = tTime / tProd\n\nThisWorkbook.ActiveSheet.Cells(lRow, \"AH\") = Format(rRate, Percent)\nThisWorkbook.ActiveSheet.Cells(lRow, \"AL\") = Format(pRate, \"h:mm:ss\")\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 9895501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0fe47db67a68d8a5a15426b0eaa5faf?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/9895501/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 52068600, "answer_count": 2, "score": 2, "last_activity_date": 1535509441, "creation_date": 1535507945, "question_id": 52068468, "link": "https://stackoverflow.com/questions/52068468/dividing-variables-giving-false-zero-result", "title": "Dividing variables giving false zero result", "body": "<p>I have some code which is taking some inputs from a userform and then entering them into my spreadsheet, nothing tricky. The issue is 2 of my pieces of data, which are the result of dividing 2 other variables, always give a result of zero regardless of what the true answer should be. But if I go into the spreadsheet itself and do the calculations using the same inputs it works exactly as I need. The variables causing me grief are \"rRate\" and \"pRate\". Is there an issue with my variable declarations or something else entirely?</p>\n\n<pre><code>Dim rRate As Long\nDim sTime As Date\nDim fTime As Date\nDim tTime As Date\nDim pRate As Long\nDim Rejects As Long\nDim tProd As Long\n\nRejects = frmProduction.lblTotalRejects.Caption\ntProd = frmProduction.lblTotal.Caption\n\nrRate = Rejects / tProd 'msgbox gives 0\n\nsTime = ThisWorkbook.ActiveSheet.Cells(lRow, \"B\")\nfTime = Now\ntTime = fTime - sTime\n\npRate = tTime / tProd 'msgbox gives 0\n\nThisWorkbook.ActiveSheet.Cells(lRow, \"O\") = Rejects\nThisWorkbook.ActiveSheet.Cells(lRow, \"P\") = tProd\nThisWorkbook.ActiveSheet.Cells(lRow, \"AH\") = Format(rRate, Percent) 'not working\nThisWorkbook.ActiveSheet.Cells(lRow, \"AI\") = Format(tTime, \"h:mm\")\nThisWorkbook.ActiveSheet.Cells(lRow, \"AL\") = Format(pRate, \"h:mm:ss\") 'not working\n</code></pre>\n"}, {"tags": ["excel", "vba", "textbox", "userform"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1535505308, "post_id": 52068166, "comment_id": 91086390, "body": "I don&#39;t think it is a good idea to set the value of textbox3 within a TextBox3_Change event procedure."}, {"owner": {"reputation": 1064, "user_id": 4722577, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df632265f05cfef80f4d3da89de8cd7b?s=128&d=identicon&r=PG&f=1", "display_name": "CAM_344", "link": "https://stackoverflow.com/users/4722577/cam-344"}, "edited": false, "score": 1, "creation_date": 1535505656, "post_id": 52068166, "comment_id": 91086482, "body": "to follow what Jeeped said above, could you put this code in another method, such as whenever textbox1 or 2 is changed?"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10278069, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215575113627540/picture?type=large", "display_name": "April Parker", "link": "https://stackoverflow.com/users/10278069/april-parker"}, "edited": false, "score": 0, "creation_date": 1535546776, "post_id": 52069512, "comment_id": 91105372, "body": "This worked! Can you help me understand why using textbox 2_change worked while textbox3_change did not?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 101, "user_id": 10278069, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215575113627540/picture?type=large", "display_name": "April Parker", "link": "https://stackoverflow.com/users/10278069/april-parker"}, "edited": false, "score": 0, "creation_date": 1535549656, "post_id": 52069512, "comment_id": 91107463, "body": "Because you are putting the values from TextBox 1 and 2 into TextBox 3. TextBox 3 does not change until the values are transferred there, the only way to get them to there is when you update either of the other two TextBoxes."}, {"owner": {"reputation": 101, "user_id": 10278069, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215575113627540/picture?type=large", "display_name": "April Parker", "link": "https://stackoverflow.com/users/10278069/april-parker"}, "edited": false, "score": 0, "creation_date": 1535549864, "post_id": 52069512, "comment_id": 91107582, "body": "Ahhh I see! Thank you for taking the time to explain the logic to me. :)"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 101, "user_id": 10278069, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215575113627540/picture?type=large", "display_name": "April Parker", "link": "https://stackoverflow.com/users/10278069/april-parker"}, "edited": false, "score": 0, "creation_date": 1535549952, "post_id": 52069512, "comment_id": 91107653, "body": "I am glad i could help."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 1, "last_activity_date": 1535517035, "creation_date": 1535517035, "answer_id": 52069512, "question_id": 52068166, "link": "https://stackoverflow.com/questions/52068166/vba-combine-values-in-2-userform-textboxes-into-a-third-textbox/52069512#52069512", "title": "VBA Combine values in 2 userform textboxes into a third textbox", "body": "<p>I found that the code below works best, your values will be combined. I placed a space between the values for s&amp;g's.</p>\n\n<pre><code>Private Sub TextBox2_Change()\n    Me.TextBox3.Value = Me.TextBox1.Value &amp; \" \" + Me.TextBox2.Value\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 261, "user_id": 10169396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2397326b698fceea111953d14aefd02a?s=128&d=identicon&r=PG&f=1", "display_name": "Lina", "link": "https://stackoverflow.com/users/10169396/lina"}, "is_accepted": false, "score": 0, "last_activity_date": 1535517674, "creation_date": 1535517674, "answer_id": 52069608, "question_id": 52068166, "link": "https://stackoverflow.com/questions/52068166/vba-combine-values-in-2-userform-textboxes-into-a-third-textbox/52069608#52069608", "title": "VBA Combine values in 2 userform textboxes into a third textbox", "body": "<p>You could try to code below:</p>\n\n<pre><code>Private Sub TextBox2_Change()\n   TextBox3.Value = TextBox1.text &amp; TextBox2.text\nEnd Sub\n</code></pre>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 101, "user_id": 10278069, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215575113627540/picture?type=large", "display_name": "April Parker", "link": "https://stackoverflow.com/users/10278069/april-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2857, "favorite_count": 0, "accepted_answer_id": 52069512, "answer_count": 2, "score": 2, "last_activity_date": 1594072332, "creation_date": 1535505115, "last_edit_date": 1594072332, "question_id": 52068166, "link": "https://stackoverflow.com/questions/52068166/vba-combine-values-in-2-userform-textboxes-into-a-third-textbox", "title": "VBA Combine values in 2 userform textboxes into a third textbox", "body": "<p>I am having difficulty getting the value from textbox 1 and textbox 2 to combine and display in a textbox3 on a userform. Textbox1 and Textbox2 are locked, the values are dynamic and auto-filled from radio button controls. I have tried the following but it doesn't display the combined result in textbox3 and I think it's because the values in textbox 1 &amp; 2 are the result of counter controls on the radio buttons. See image link.</p>\n\n<pre><code>Private Sub TextBox3_Change()\n    textbox3.text=Textbox1.text &amp; Textbox2.text\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/FGobu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FGobu.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 1, "creation_date": 1535503638, "post_id": 52067805, "comment_id": 91086083, "body": "Does it help if you refer to the source data as <code>SourceData:=Range(&quot;CE_2_Table&quot;).Address(ReferenceStyle:=xlR1&zwnj;&#8203;C1, External:=True)</code>?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1535509719, "post_id": 52067805, "comment_id": 91087278, "body": "@Domenic though would External be True? It doesn&#39;t seem like it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1535511223, "post_id": 52067805, "comment_id": 91087567, "body": "You&#39;re creating multiple pivot caches with the same source: have you tried creating only one of each, and pointing your pivot table to it?"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535515765, "post_id": 52067805, "comment_id": 91088473, "body": "@BigBen That&#39;s strange, it did accept it when I tested it.  I tested it using Excel 2016."}, {"owner": {"reputation": 13, "user_id": 1781403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4270042f53cddb13d890e95c2bdeb5cf?s=128&d=identicon&r=PG", "display_name": "Rodrigo Jimenez", "link": "https://stackoverflow.com/users/1781403/rodrigo-jimenez"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1535553241, "post_id": 52067805, "comment_id": 91110029, "body": "@Domenic I tried as you said on your first comment and I got a  &quot;runtime error -2147024809 (80070057) - Pivot Table field name is not valid&quot;  if I try with the actual range name instead of the table, I get the same &quot;runtime error 5 invalid procedure call or argument&quot;"}, {"owner": {"reputation": 13, "user_id": 1781403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4270042f53cddb13d890e95c2bdeb5cf?s=128&d=identicon&r=PG", "display_name": "Rodrigo Jimenez", "link": "https://stackoverflow.com/users/1781403/rodrigo-jimenez"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1535554745, "post_id": 52067805, "comment_id": 91111145, "body": "@TimWilliams I tried to do this but i got a   <b>runtime error 424 object required</b>  following this example   <code>Dim pvtcch As PivotCache</code>   <code>Dim pvtcchs As PivotCaches</code>   <code>Set pvtcch = pvtcchs.Create(SourceType:=xlDatabase, SourceData:=&quot;CE_2_Table&quot;)</code>   <code>sh.PivotTables(&quot;PivotTable1&quot;). _</code>   <code>ChangePivotCache pvtcch</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1535554827, "post_id": 52067805, "comment_id": 91111203, "body": "Try <code>Dim pvtcch As PivotCache:   Set pvtcch = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=&quot;CE_2_Table&quot;)</code>"}, {"owner": {"reputation": 13, "user_id": 1781403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4270042f53cddb13d890e95c2bdeb5cf?s=128&d=identicon&r=PG", "display_name": "Rodrigo Jimenez", "link": "https://stackoverflow.com/users/1781403/rodrigo-jimenez"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1535555375, "post_id": 52067805, "comment_id": 91111642, "body": "@TimWilliams now it&#39;s the same <b>runtime error 5 invalid procedure call or argument</b> again"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1535563282, "post_id": 52067805, "comment_id": 91116275, "body": "Make sure that you don&#39;t have one or more empty column headers.  Also, if you have any columns that are hidden, try un-hiding them."}, {"owner": {"reputation": 13, "user_id": 1781403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4270042f53cddb13d890e95c2bdeb5cf?s=128&d=identicon&r=PG", "display_name": "Rodrigo Jimenez", "link": "https://stackoverflow.com/users/1781403/rodrigo-jimenez"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1535565095, "post_id": 52067805, "comment_id": 91117200, "body": "@Domenic all the ranges have their respective headers and no hidden columns whatsoever. I do have blank values inside the table but that shouldn&#39;t be a problem &#191;right?"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1535566540, "post_id": 52067805, "comment_id": 91117907, "body": "No, it shouldn&#39;t make a difference.  I tested it with Excel 2016 and 2007.  For me, both your original reference and the one I offered worked with Excel 2016 and 2007."}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1535566578, "post_id": 52067805, "comment_id": 91117924, "body": "If you supplied it a string that refers to the source data in an R1C1 reference style will it accept it <code>(ie. &quot;&#39;Sheet1&#39;!R1C1:R100C5&quot;)</code> ?"}, {"owner": {"reputation": 13, "user_id": 1781403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4270042f53cddb13d890e95c2bdeb5cf?s=128&d=identicon&r=PG", "display_name": "Rodrigo Jimenez", "link": "https://stackoverflow.com/users/1781403/rodrigo-jimenez"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1535571016, "post_id": 52067805, "comment_id": 91119896, "body": "@Domenic nope, still getting the runtime error 5. I tried this way  <code>Dim kCE As Long     kCE = ce.Range(&quot;B28&quot;, ce.Range(&quot;B28&quot;).End(xlDown)).Rows.Count + 27</code> <code>ChangePivotCache ActiveWorkbook. _     PivotCaches.Create(SourceType:=xlDatabase, SourceData:=&quot;&#39;CE-Cases-OP&#39;!B28:S&quot; &amp; kCE)</code> and i also tried by creating a Range variable, but still nothing"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 1781403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4270042f53cddb13d890e95c2bdeb5cf?s=128&d=identicon&r=PG", "display_name": "Rodrigo Jimenez", "link": "https://stackoverflow.com/users/1781403/rodrigo-jimenez"}, "is_accepted": true, "score": 0, "last_activity_date": 1535655353, "creation_date": 1535655353, "answer_id": 52103685, "question_id": 52067805, "link": "https://stackoverflow.com/questions/52067805/change-pivottable-sourcedata-via-vba-code/52103685#52103685", "title": "Change Pivottable SourceData via VBA code", "body": "<p>I finally found the problem. I had some slicers that were the ones that made the code fail.   All i had to do was erase them and then the Sub worked again</p>\n"}], "owner": {"reputation": 13, "user_id": 1781403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4270042f53cddb13d890e95c2bdeb5cf?s=128&d=identicon&r=PG", "display_name": "Rodrigo Jimenez", "link": "https://stackoverflow.com/users/1781403/rodrigo-jimenez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "accepted_answer_id": 52103685, "answer_count": 1, "score": 0, "last_activity_date": 1535655353, "creation_date": 1535501917, "last_edit_date": 1535504293, "question_id": 52067805, "link": "https://stackoverflow.com/questions/52067805/change-pivottable-sourcedata-via-vba-code", "title": "Change Pivottable SourceData via VBA code", "body": "<p>I have a macro enabled template which includes a lot of pivotTables which need to be manually update (including the sourcedata change) \nA few days ago i was working with this code solution, which was actually working so well </p>\n\n<pre><code>Sub Button12_Click()\n\n    Dim sh As Worksheet\n    Set sh = ThisWorkbook.Sheets(\"Pivots\")\n\n'CE OP Pivot Tables\n    sh.PivotTables(\"PivotTable1\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_2_Table\")\n    sh.PivotTables(\"PivotTable1\").RefreshTable\n\n    sh.PivotTables(\"PivotTable2\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_2_Table\")\n    sh.PivotTables(\"PivotTable2\").RefreshTable\n\n    sh.PivotTables(\"PivotTable3\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_2_Table\")\n    sh.PivotTables(\"PivotTable3\").RefreshTable\n\n    sh.PivotTables(\"PivotTable4\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_2_Table\")\n    sh.PivotTables(\"PivotTable4\").RefreshTable\n\n    sh.PivotTables(\"PivotTable5\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_2_Table\")\n    sh.PivotTables(\"PivotTable5\").RefreshTable\n\n    sh.PivotTables(\"PivotTable6\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_2_Table\")\n    sh.PivotTables(\"PivotTable6\").RefreshTable\n\n    sh.PivotTables(\"PivotTable7\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_2_Table\")\n    sh.PivotTables(\"PivotTable7\").RefreshTable\n\n    sh.PivotTables(\"PivotTable27\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_2_Table\")\n    sh.PivotTables(\"PivotTable27\").RefreshTable\n\n'SLED Pivot Tables\n    sh.PivotTables(\"PivotTable8\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"SLED_2_Table\")\n    sh.PivotTables(\"PivotTable8\").RefreshTable\n\n    sh.PivotTables(\"PivotTable9\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"SLED_2_Table\")\n    sh.PivotTables(\"PivotTable9\").RefreshTable\n\n    sh.PivotTables(\"PivotTable10\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"SLED_2_Table\")\n    sh.PivotTables(\"PivotTable10\").RefreshTable\n\n    sh.PivotTables(\"PivotTable11\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"SLED_2_Table\")\n    sh.PivotTables(\"PivotTable11\").RefreshTable\n\n    sh.PivotTables(\"PivotTable12\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"SLED_2_Table\")\n    sh.PivotTables(\"PivotTable12\").RefreshTable\n\n    sh.PivotTables(\"PivotTable13\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"SLED_2_Table\")\n    sh.PivotTables(\"PivotTable13\").RefreshTable\n\n    sh.PivotTables(\"PivotTable14\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"SLED_2_Table\")\n    sh.PivotTables(\"PivotTable14\").RefreshTable\n\n    sh.PivotTables(\"PivotTable30\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"SLED_2_Table\")\n    sh.PivotTables(\"PivotTable30\").RefreshTable\n\n'CA Pivot tables\n    sh.PivotTables(\"PivotTable15\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CA_2_Table\")\n    sh.PivotTables(\"PivotTable15\").RefreshTable\n\n    sh.PivotTables(\"PivotTable16\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CA_2_Table\")\n    sh.PivotTables(\"PivotTable16\").RefreshTable\n\n    sh.PivotTables(\"PivotTable17\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CA_2_Table\")\n    sh.PivotTables(\"PivotTable17\").RefreshTable\n\n    sh.PivotTables(\"PivotTable18\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CA_2_Table\")\n    sh.PivotTables(\"PivotTable18\").RefreshTable\n\n    sh.PivotTables(\"PivotTable19\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CA_2_Table\")\n    sh.PivotTables(\"PivotTable19\").RefreshTable\n\n    sh.PivotTables(\"PivotTable20\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CA_2_Table\")\n    sh.PivotTables(\"PivotTable20\").RefreshTable\n\n    sh.PivotTables(\"PivotTable21\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CA_2_Table\")\n    sh.PivotTables(\"PivotTable21\").RefreshTable\n\n    sh.PivotTables(\"PivotTable31\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CA_2_Table\")\n    sh.PivotTables(\"PivotTable31\").RefreshTable\n\n'CE Future POs\n    sh.PivotTables(\"PivotTable22\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_Future_POs_Table\")\n    sh.PivotTables(\"PivotTable22\").RefreshTable\n\n    sh.PivotTables(\"PivotTable23\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_Future_POs_Table\")\n    sh.PivotTables(\"PivotTable23\").RefreshTable\n\n    sh.PivotTables(\"PivotTable24\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_Future_POs_Table\")\n    sh.PivotTables(\"PivotTable24\").RefreshTable\n\n    sh.PivotTables(\"PivotTable25\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_Future_POs_Table\")\n    sh.PivotTables(\"PivotTable25\").RefreshTable\n\n    sh.PivotTables(\"PivotTable26\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_Future_POs_Table\")\n    sh.PivotTables(\"PivotTable26\").RefreshTable\n\n    sh.PivotTables(\"PivotTable28\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_Future_POs_Table\")\n    sh.PivotTables(\"PivotTable28\").RefreshTable\n\n    sh.PivotTables(\"PivotTable29\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_Future_POs_Table\")\n    sh.PivotTables(\"PivotTable29\").RefreshTable\n\n    sh.PivotTables(\"PivotTable32\"). _\n    ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_Future_POs_Table\")\n    sh.PivotTables(\"PivotTable32\").RefreshTable\n\n\nEnd Sub\n</code></pre>\n\n<p>But since this morning, every time I click the button that runs this macro, I have been receiving the same message</p>\n\n<blockquote>\n  <p>runtime error 5 invalid procedure call or argument</p>\n</blockquote>\n\n<p>So far I have tried to use a table instead of a range (as you can see in the posted code. Also, the range names are exactly the same minus the _Table part) but I still see that annoying message. </p>\n\n<p>I have also validated and none of the PivotTables, nor the Sheet have changed its name so I think that's not one of the issues.</p>\n\n<p>Also,  I have changed the ranges to include and ignore the headers of the table and still nothing.</p>\n\n<p>Also (x3) the same ranges are used on another modules to perform some formatting to the cells</p>\n\n<p>The debugger always stops on the first pivot table </p>\n\n<pre><code>sh.PivotTables(\"PivotTable1\"). _\nChangePivotCache ActiveWorkbook. _\nPivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"CE_2_Table\")\n</code></pre>\n\n<p>Any idea what I'm missing or not doing right or changed without noticing?</p>\n\n<p>Thanks for your time.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1535528751, "post_id": 52067705, "comment_id": 91093855, "body": "It&#39;s currently unclear what you&#39;re asking. If you&#39;re going to use such complex logic, I highly recommend you store these operator levels in a table, so you don&#39;t have them clogging up queries and can query the highest valid operator ID for a certain employee"}, {"owner": {"reputation": 79, "user_id": 1875160, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/dltq2.gif?s=128&g=1", "display_name": "SoggyCashew", "link": "https://stackoverflow.com/users/1875160/soggycashew"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1535551086, "post_id": 52067705, "comment_id": 91108490, "body": "I updated my post and made it less confusing"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1535551411, "post_id": 52067705, "comment_id": 91108717, "body": "Please share some sample data, with expected output. Without knowing how you&#39;ve stored the data we can&#39;t answer your question. See <a href=\"https://meta.stackoverflow.com/q/271055/7296893\">Tips for asking a good Structured Query Language (SQL) question</a>"}, {"owner": {"reputation": 79, "user_id": 1875160, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/dltq2.gif?s=128&g=1", "display_name": "SoggyCashew", "link": "https://stackoverflow.com/users/1875160/soggycashew"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1535552473, "post_id": 52067705, "comment_id": 91109450, "body": "I could share the DB im working on... Im having a few other issues I needed help with anyway if so how?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1535552683, "post_id": 52067705, "comment_id": 91109610, "body": "Sorry, I don&#39;t do that. Downloading accdb files is a substantial security risk, and I will likely get too involved with improving it. There are other fora, like UtterAccess and Access Programmers that are better suited for that kind of localized guidance."}, {"owner": {"reputation": 79, "user_id": 1875160, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/dltq2.gif?s=128&g=1", "display_name": "SoggyCashew", "link": "https://stackoverflow.com/users/1875160/soggycashew"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1535553919, "post_id": 52067705, "comment_id": 91110526, "body": "not sure what kind of data your looking for then...I showed you what Im looking for in my post. and you want me to redo...."}, {"owner": {"reputation": 79, "user_id": 1875160, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/dltq2.gif?s=128&g=1", "display_name": "SoggyCashew", "link": "https://stackoverflow.com/users/1875160/soggycashew"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1535556415, "post_id": 52067705, "comment_id": 91112356, "body": "ok I added a what im hoping will work expresion named ElegibleLevel: in my post, it just needs fixed up to work corectly. The counts in the for the last 3 arent correct and im not sure about the rest."}], "answers": [{"tags": [], "owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "is_accepted": false, "score": 0, "last_activity_date": 1535540109, "creation_date": 1535540109, "answer_id": 52075717, "question_id": 52067705, "link": "https://stackoverflow.com/questions/52067705/query-with-a-bunch-of-if/52075717#52075717", "title": "Query with a bunch of If", "body": "<p>I suggest to use a database schema similar to this one (simplified):</p>\n\n<p><a href=\"https://i.stack.imgur.com/G1cRy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G1cRy.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>To determine the <em>operator level</em> of an employee, we need only 2 calculated numbers per employee:</p>\n\n<ul>\n<li>the number of assigned functions out of all 8 possible functions</li>\n<li>the number of assigned functions out of only the first 2 functions</li>\n</ul>\n\n<p>The first of these would be your <code>CountOfReqCompleted</code>. Both can be calculated using queries like this:</p>\n\n<p>EmployeesFunctionsAll:</p>\n\n<pre><code>SELECT EmployeesFunctions.EmployeeID,\n  Count(EmployeesFunctions.FuncID) AS FunctionsCount\nFROM EmployeesFunctions\nGROUP BY EmployeesFunctions.EmployeeID;\n</code></pre>\n\n<p>EmployeesFunctionsBasic:</p>\n\n<pre><code>SELECT EmployeesFunctions.EmployeeID,\n  Count(EmployeesFunctions.FuncID) AS FunctionsCount\nFROM EmployeesFunctions\nWHERE (((EmployeesFunctions.FuncID) In (1,2)))\nGROUP BY EmployeesFunctions.EmployeeID;\n</code></pre>\n\n<p>Finally, to calculate the <em>operator level</em> for each employee, we can join these 2 queries to the <em>Employees</em> table using a <code>LEFT JOIN</code> such that \"all records of 'Employees' are returned\". Instead of nesting several <code>Iif</code> functions, we can use the <code>Switch</code> function to accomplish the task:</p>\n\n<pre><code>SELECT Employees.EmployeeID, Employees.EmployeeName, \n  Switch(\n    EmployeesFunctionsAll.FunctionsCount &gt;= 8, \"Operator 5\",\n    EmployeesFunctionsAll.FunctionsCount &gt;= 6, \"Operator 4\",\n    EmployeesFunctionsAll.FunctionsCount &gt;= 4, \"Operator 3\",\n    EmployeesFunctionsBasic.FunctionsCount &gt;= 2, \"Operator 2\",\n    EmployeesFunctionsBasic.FunctionsCount &gt;= 1, \"Operator 1\"\n  ) AS OperatorLevel\nFROM (Employees LEFT JOIN EmployeesFunctionsAll \n  ON Employees.EmployeeID = EmployeesFunctionsAll.EmployeeID) \nLEFT JOIN EmployeesFunctionsBasic \n  ON Employees.EmployeeID = EmployeesFunctionsBasic.EmployeeID;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 1875160, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/dltq2.gif?s=128&g=1", "display_name": "SoggyCashew", "link": "https://stackoverflow.com/users/1875160/soggycashew"}, "is_accepted": true, "score": 0, "last_activity_date": 1550672647, "creation_date": 1550672647, "answer_id": 54788581, "question_id": 52067705, "link": "https://stackoverflow.com/questions/52067705/query-with-a-bunch-of-if/54788581#54788581", "title": "Query with a bunch of If", "body": "<p>Im now calling a function that will be able to decide based on a count to see if I completed the requirements ect based on my querys outcome instead of all the Iffs.</p>\n\n<pre><code>Function SetLevel(lngFuncID As Long, lngEmpID As Long, varDateCompleted As Variant)\n\n  Dim lngPosID As Long\n  Dim lngEmpPosID  As Long\n  Dim strSQL As String\n  Dim strCriteria As String\n\n  strCriteria = \"EmpID = \" &amp; lngEmpID\n\n  If DCount(\"*\", \"qryMetalShopEmployeeFunctions\", strCriteria) = 8 Then\n      lngPosID = DLookup(\"PosID\", \"tblMetalShopLevel\", \"Position = \"\"Operator 5\"\"\")\n\n  ElseIf DCount(\"*\", \"qryMetalShopEmployeeFunctions\", strCriteria) = 7 Then\n      lngPosID = 0\n\n  ElseIf DCount(\"*\", \"qryMetalShopEmployeeFunctions\", strCriteria) = 6 Then\n      lngPosID = DLookup(\"PosID\", \"tblMetalShopLevel\", \"Position = \"\"Operator 4\"\"\")\n\n  ElseIf DCount(\"*\", \"qryMetalShopEmployeeFunctions\", strCriteria) = 5 Then\n       lngPosID = 0\n\n  ElseIf DCount(\"*\", \"qryMetalShopEmployeeFunctions\", strCriteria) = 4 Then\n      lngPosID = DLookup(\"PosID\", \"tblMetalShopLevel\", \"Position = \"\"Operator 3\"\"\")\n\n  ElseIf DCount(\"*\", \"qryMetalShopEmployeeFunctions\", strCriteria) = 3 Then\n       lngPosID = 0\n\n  ElseIf DCount(\"*\", \"qryMetalShopEmployeeFunctions\", _\n       strCriteria &amp; \" And (FuncID = 1 Or FuncID = 2)\") = 2 Then\n       lngPosID = DLookup(\"PosID\", \"tblMetalShopLevel\", \"Position = \"\"Operator 2\"\"\")\n\n  ElseIf lngFuncID = 1 Or lngFuncID = 2 Then\n      lngPosID = DLookup(\"PosID\", \"tblMetalShopLevel\", \"Position = \"\"Operator 1\"\"\")\n  End If\n\n  If lngPosID &gt; 0 Then\n\n     lngEmpPosID = Nz(DMax(\"EmpPosID\", \"tblMetalShopEmployeeLevel\"), 0) + 1\n\n     strSQL = \"INSERT INTO tblMetalShopEmployeeLevel(EmpPosID, EmpID, PosID, DateAchieved) \" &amp; _\n            \"VALUES(\" &amp; lngEmpPosID &amp; \",\" &amp; lngEmpID &amp; \",\" &amp; lngPosID &amp; \",\" &amp; _\n              IIf(IsNull(varDateCompleted), \"NULL\", \"#\" &amp; Format(varDateCompleted, \"yyyy-mm-dd hh:nn:ss\") &amp; \"#\") &amp; \")\"\n\n        CurrentDb.Execute strSQL, dbFailOnError\n  End If\n</code></pre>\n\n<p>End Function</p>\n"}], "owner": {"reputation": 79, "user_id": 1875160, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/dltq2.gif?s=128&g=1", "display_name": "SoggyCashew", "link": "https://stackoverflow.com/users/1875160/soggycashew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 54788581, "answer_count": 2, "score": -1, "last_activity_date": 1550672647, "creation_date": 1535500936, "last_edit_date": 1535556265, "question_id": 52067705, "link": "https://stackoverflow.com/questions/52067705/query-with-a-bunch-of-if", "title": "Query with a bunch of If", "body": "<p>I have a query field that gives a result text \"Completed\" or \"Not completed\" for a field FuncID. I need to create another expression with IFF(s) that what say that operator level 1-5 they are in based on what FuncID(s) are completed using the below formulas</p>\n\n<pre><code>FuncID 1 \nFuncID 2 \nFuncID 3 \nFuncID 4 \nFuncID 5 \nFuncID 6 \nFuncID 7 \nFuncID 8 \n</code></pre>\n\n<p>Operator 1 =\nFuncID 1 <strong>OR</strong> FuncID 2 has to be completed </p>\n\n<p>Operator 2 =\nFuncID 1 <strong>AND</strong> FuncID 2 has to be completed </p>\n\n<p>Operator 3 =\nFour (4) of the eight (8) FuncID(s) has to be completed </p>\n\n<p>Operator 4 =\nSix (6) of the eight (8) FuncID(s) has to be completed </p>\n\n<p>Operator 5 =\nEight (8) of the eight (8) FuncID(s) has to be completed </p>\n\n<pre><code>ElegibleLevel: Iff[FuncID]=1 AND [Expr1] = 1,\"OPERATOR 1\",0,\n\nIff[FuncID]=1 OR [FuncID]=2 AND [Expr1] = 1,\"OPERATOR 1\",0,\n\nIff[FuncID]=1 AND [FuncID]=2 AND [Expr1] = 1,\"OPERATOR 2\",0,\n\nIff(Count[FuncID]=3) = 4 AND [Expr1] = 1,\"OPERATOR 3\",0,\n\nIff(Count[FuncID]=4) = 6 AND [Expr1] = 1,\"OPERATOR 4\",0,\n\nIff(Count[FuncID]=5) = 8 AND [Expr1] = 1,\"OPERATOR 5\",0,\n</code></pre>\n"}, {"tags": ["excel", "vba", "oracle", "adodb"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1535511439, "post_id": 52067585, "comment_id": 91087605, "body": "It will make a difference what database you&#39;re using so it would be useful to say...  Looks like Oracle?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1535511639, "post_id": 52067585, "comment_id": 91087644, "body": "<a href=\"https://stackoverflow.com/questions/2316886/why-cant-i-do-a-with-x-as-with-adodb-and-oracle\" title=\"why cant i do a with x as with adodb and oracle\">stackoverflow.com/questions/2316886/&hellip;</a>"}, {"owner": {"reputation": 185, "user_id": 2357267, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1025d5e0ae22bca65697f606795a94ab?s=128&d=identicon&r=PG&f=1", "display_name": "Chito", "link": "https://stackoverflow.com/users/2357267/chito"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1535560855, "post_id": 52067585, "comment_id": 91115012, "body": "Thanks @TimWilliams, I couldn&#39;t find that question you provided before I post this. I can&#39;t believe there is so simple workaround :)"}], "answers": [{"tags": [], "owner": {"reputation": 261, "user_id": 10169396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2397326b698fceea111953d14aefd02a?s=128&d=identicon&r=PG&f=1", "display_name": "Lina", "link": "https://stackoverflow.com/users/10169396/lina"}, "is_accepted": false, "score": 0, "last_activity_date": 1535519783, "creation_date": 1535519783, "answer_id": 52069909, "question_id": 52067585, "link": "https://stackoverflow.com/questions/52067585/adodb-recordset-operation-not-allowed-when-the-object-is-closed/52069909#52069909", "title": "ADODB Recordset: Operation not allowed when the object is closed", "body": "<p>Before the select statement, attach a declaration like this:</p>\n\n<pre><code>    Dim sqlText As String\n    sqlText = \"with t as (select * from dual) select * from t\"\n</code></pre>\n\n<p>Hope that helps!</p>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 2357267, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1025d5e0ae22bca65697f606795a94ab?s=128&d=identicon&r=PG&f=1", "display_name": "Chito", "link": "https://stackoverflow.com/users/2357267/chito"}, "edited": false, "score": 0, "creation_date": 1535561015, "post_id": 52070174, "comment_id": 91115084, "body": "This didn&#39;t solve the issue, this one did <a href=\"https://stackoverflow.com/questions/2316886/why-cant-i-do-a-with-x-as-with-adodb-and-oracle\">link</a>"}], "tags": [], "owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "is_accepted": false, "score": 0, "last_activity_date": 1535521346, "creation_date": 1535521346, "answer_id": 52070174, "question_id": 52067585, "link": "https://stackoverflow.com/questions/52067585/adodb-recordset-operation-not-allowed-when-the-object-is-closed/52070174#52070174", "title": "ADODB Recordset: Operation not allowed when the object is closed", "body": "<p>Your code should be like this:</p>\n\n<pre><code>Cmd.CommandText = sqlText\nSet rs.Source = cmd\nrs.Open\n\nDo Until rs.EOF\n</code></pre>\n\n<p><code>Cmd.Execute</code> is used for commands, e.g. <code>INSERT</code> or <code>UPDATE</code>. For queries you have to use <code>Open</code></p>\n\n<p>Which provide do you use? Most likely the <em>Microsoft OLE DB Provider for Oracle</em> (<code>MSDAORA</code>). This provider is <a href=\"https://docs.microsoft.com/en-us/sql/ado/guide/appendixes/microsoft-ole-db-provider-for-oracle?view=sql-server-2017\" rel=\"nofollow noreferrer\">deprecated</a> for I think 20 years and should not be used. Certainly it does not support subquery factoring, i.e. <code>WITH</code>-Clause.</p>\n"}], "owner": {"reputation": 185, "user_id": 2357267, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1025d5e0ae22bca65697f606795a94ab?s=128&d=identicon&r=PG&f=1", "display_name": "Chito", "link": "https://stackoverflow.com/users/2357267/chito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "closed_date": 1535536452, "answer_count": 2, "score": 0, "last_activity_date": 1594072324, "creation_date": 1535499912, "last_edit_date": 1594072324, "question_id": 52067585, "link": "https://stackoverflow.com/questions/52067585/adodb-recordset-operation-not-allowed-when-the-object-is-closed", "closed_reason": "Duplicate", "title": "ADODB Recordset: Operation not allowed when the object is closed", "body": "<p>This a sample query producing the same error but I have much complex query.</p>\n\n<pre><code>sqlText = \"with t as (select * from dual) select * from t\"\n\nCmd.CommandText = sqlText\nSet rs = Cmd.Execute\n\nDo While Not rs.EOF\n    For col = 0 To rs.Fields.Count - 1\n        Str = Str &amp; \" - \" &amp; rs.Fields(col).Value\n    Next col\n    rs.MoveNext\n    Str = Str &amp; vbNewLine\nLoop\n</code></pre>\n\n<p>I don't get any error if I use the query without \"with\", example as </p>\n\n<pre><code>sqlText = \"select * from dual\"\n</code></pre>\n\n<p>That's why I wonder what difference it makes in excel VBA with the above two sql queries and like to know if there is workaround. I still can write the sql query differently to produce the same output without using \"with\" but that won't just make my doubt go away, so like to hear an explanation from experts.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1535497116, "post_id": 52067199, "comment_id": 91084810, "body": "Why not just use Conditional Formatting?"}, {"owner": {"reputation": 2590, "user_id": 6639020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-whhL_OMI28g/AAAAAAAAAAI/AAAAAAAAI2Q/lcFD5k2Trk4/photo.jpg?sz=128", "display_name": "Ragavan Rajan", "link": "https://stackoverflow.com/users/6639020/ragavan-rajan"}, "edited": false, "score": 0, "creation_date": 1535497682, "post_id": 52067199, "comment_id": 91084962, "body": "Yes. good idea to use conditional formatting. I believe something else is required apart from that function"}, {"owner": {"reputation": 1, "user_id": 10287064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18f0d3c5aebb73f22084a16f1b9b2a6?s=128&d=identicon&r=PG&f=1", "display_name": "jxlin", "link": "https://stackoverflow.com/users/10287064/jxlin"}, "edited": false, "score": 0, "creation_date": 1535500954, "post_id": 52067199, "comment_id": 91085609, "body": "Can you use conditional formatting to highlight when someone makes a change in the cell? Essentially cells that are highlighted yellow will be filtered, used to make changes in another sheet, and then reset back to white so that if it is changed again it will update again."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1535562306, "post_id": 52067199, "comment_id": 91115708, "body": "The short answer is yes, but having that &quot;color switching back and forth&quot; type feature will require some workarounds.  You should do some web searching on conditional formatting, there are many many results on this robust feature.  Consider that this feature is highly dependent on your version, so find appropriate info for you."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10287064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18f0d3c5aebb73f22084a16f1b9b2a6?s=128&d=identicon&r=PG&f=1", "display_name": "jxlin", "link": "https://stackoverflow.com/users/10287064/jxlin"}, "edited": false, "score": 0, "creation_date": 1535501061, "post_id": 52067285, "comment_id": 91085626, "body": "Essentially cells that are highlighted yellow will be filtered, used to make changes in another sheet, and then reset back to white so that if it is changed again it will update again. My fear is that someone other than me will make a change outside of the chart area, which will then be filtered in since I am filtering by color."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "reply_to_user": {"reputation": 1, "user_id": 10287064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18f0d3c5aebb73f22084a16f1b9b2a6?s=128&d=identicon&r=PG&f=1", "display_name": "jxlin", "link": "https://stackoverflow.com/users/10287064/jxlin"}, "edited": false, "score": 0, "creation_date": 1535562132, "post_id": 52067285, "comment_id": 91115607, "body": "You&#39;re introducing a set of other problems not in the original concern.&quot;Someone other than me&quot; is a challenging concern, there are solutions but you should address that as a distinct question.  Changing the color of the cell based on multiple criteria should also be addressed distinctly.  Consider this community as a group of people who will help you on specific concerns, to help you learn and solve problems, and please avoid &quot;scope creep&quot;.  Please reward your answerers with upvotes and flag answers as such, and if you have additional questions, submit a new post after you do some research."}], "tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 0, "last_activity_date": 1535497822, "last_edit_date": 1535497822, "creation_date": 1535497356, "answer_id": 52067285, "question_id": 52067199, "link": "https://stackoverflow.com/questions/52067199/macro-highlighting-changes-in-cells-with-range-constantly-changing/52067285#52067285", "title": "Macro highlighting changes in cells with range constantly changing", "body": "<p>It depends on your need.  If it will always be in the J column then:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n' Tracking Changes In Yellow\n    Dim KeyCells As Range\n    Set KeyCells = Range(\"L12\", Range(\"L\" &amp; Rows.Count))\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n           Is Nothing Then\n           Target.Interior.ColorIndex = 6\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10287064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18f0d3c5aebb73f22084a16f1b9b2a6?s=128&d=identicon&r=PG&f=1", "display_name": "jxlin", "link": "https://stackoverflow.com/users/10287064/jxlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535499103, "creation_date": 1535496648, "last_edit_date": 1535499103, "question_id": 52067199, "link": "https://stackoverflow.com/questions/52067199/macro-highlighting-changes-in-cells-with-range-constantly-changing", "title": "Macro highlighting changes in cells with range constantly changing", "body": "<p>I wrote the following macro in order to highlight any changes in a particular range:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n' Tracking Changes In Yellow\n    Dim KeyCells As Range\n    Set KeyCells = Range(\"L12\", Range(\"L12\").End(xlDown))\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n           Is Nothing Then\n           Target.Interior.ColorIndex = 6\n    End If\n</code></pre>\n\n<p>The macro is running perfectly with the exception of when I input a new value into a cell beyond the chart area, which I can't have and it is causing me issues since I am using the range <code>Range(\"L12\", Range(\"L12\").End(xlDown)</code>.  </p>\n\n<p>As you can see in the picture, if I input a new value right under it, it will highlight it yellow due to <code>End(xlDown)</code> but not if I do it two cells away. What is the best way to fix this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/disnC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/disnC.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1535495917, "post_id": 52067028, "comment_id": 91084466, "body": "Hi there, I edited your question with some formatting, but please for future reference, use some indenting  in your code and stop putting empty newline after every line of code. It actively hurts the readability"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10287047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b27a915b6eb75e6dfb2ef09d06b14016?s=128&d=identicon&r=PG&f=1", "display_name": "S.GATI", "link": "https://stackoverflow.com/users/10287047/s-gati"}, "edited": false, "score": 0, "creation_date": 1535575350, "post_id": 52067094, "comment_id": 91121865, "body": "Thanks for the help, twenty49! This solved my problem."}], "tags": [], "owner": {"reputation": 53, "user_id": 3000822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/765668968/picture?type=large", "display_name": "twenty49", "link": "https://stackoverflow.com/users/3000822/twenty49"}, "is_accepted": false, "score": 0, "last_activity_date": 1535498458, "last_edit_date": 1535498458, "creation_date": 1535495881, "answer_id": 52067094, "question_id": 52067028, "link": "https://stackoverflow.com/questions/52067028/vba-code-to-only-show-rows-that-contain-similar-text-to-an-input-field/52067094#52067094", "title": "VBA code to only show rows that contain similar text to an input field?", "body": "<p>instead of instr(), consider range.find().</p>\n\n<pre><code>Sub Find_Possible_Task()\n\nDim SEARCH_STRING As String\nDim ITEM_IN_REVIEW As Range\nDim found As Range\nDim i As Integer\n\nSEARCH_STRING = Sheets(\"Sheet1\").Range(\"B3\").Value\ni = 1\n\nDo\n    Set ITEM_IN_REVIEW = Sheets(\"Sheet1\").Cells(i, 6)\n    Set found = ITEM_IN_REVIEW.Find(What:=SEARCH_STRING)\n    If found Is Nothing Then\n\n        ITEM_IN_REVIEW.EntireRow.Hidden = True\n    End If\n    i = i + 1\nLoop Until ITEM_IN_REVIEW = \"\"\n\nEnd Sub\n</code></pre>\n\n<p>alternatively, consider using filter table:\n1. check if your table has filter on ==> if yes, pass. if no, turn on filter.\n2. filter column F for keyword to contain value in cell B3.</p>\n"}, {"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 0, "last_activity_date": 1535497436, "creation_date": 1535497436, "answer_id": 52067298, "question_id": 52067028, "link": "https://stackoverflow.com/questions/52067028/vba-code-to-only-show-rows-that-contain-similar-text-to-an-input-field/52067298#52067298", "title": "VBA code to only show rows that contain similar text to an input field?", "body": "<p>Few bad coding conventions or even possibly downright errors:</p>\n\n<ol>\n<li>It's a good practice to explicity declare the scope <code>Public/Private</code> of your <code>Sub</code> procedure</li>\n<li>Unless you're passing the variables from some place else, they need to be declared with <code>Dim</code> keyword</li>\n<li>Using <code>Option Explicit</code> will help you prevent aforementioned error(s)</li>\n<li><p>(Subjective) variables in all caps are ugly and in most programming languages it is convention to reserve all caps variables names for constants (<code>Const</code>)</p>\n\n<pre><code>Option Explicit\nPrivate Sub keep_matches()\n  Dim what As Range\n  Dim where As Range\n  Dim res As Range ' result\n  Dim lr As Long ' last active row\n  Dim ws As Worksheet: Set ws = Sheets(\"codeset\")\n\n  lr = ws.Cells(ws.Rows.Count, \"F\").End(xlUp).Row\n  Set what = ws.Range(\"B3\")\n  Set where = ws.Range(\"F1:F\" &amp; lr)\n\n  ' we'll create an extra column for a loop in our .Find method\n  where.Copy\n  ws.Range(\"F1\").EntireColumn.Insert\n  ws.Range(\"F1\").PasteSpecial xlPasteValues\n\n  where.EntireRow.Hidden = True ' preemptively hide them all\n\n  Set where = ws.Range(\"F1:F\" &amp; lr)\n  Set res = where.Find(what, lookIn:=xlValues) ' ilook for matches, 1st attempt\n  If Not res Is Nothing Then ' if found\n     Do Until res Is Nothing ' repeat for all results\n       res.EntireRow.Hidden = False\n       res = \"Checked\"\n       Set res = where.FindNext(res)\n     Loop\n  Else\n     MsgBox(\"No matches were found\")\n     where.EntireRow.Hidden = False ' we don't wanna hide anything\n  End If\n\n  ws.Range(\"F1\").EntireColumn.Delete ' remove the extra help column for Find method\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>Should work as expected.<br>\nIf there are any question, let me know.</p>\n"}], "owner": {"reputation": 1, "user_id": 10287047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b27a915b6eb75e6dfb2ef09d06b14016?s=128&d=identicon&r=PG&f=1", "display_name": "S.GATI", "link": "https://stackoverflow.com/users/10287047/s-gati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1535498458, "creation_date": 1535495333, "last_edit_date": 1535495856, "question_id": 52067028, "link": "https://stackoverflow.com/questions/52067028/vba-code-to-only-show-rows-that-contain-similar-text-to-an-input-field", "title": "VBA code to only show rows that contain similar text to an input field?", "body": "<p>I'm new to VBA and am trying to cobble together some code to allow a user to input a word (or several words) into a cell and then show a list of matching row entries.</p>\n\n<p>I have tried the following code but am getting an \"<code>instring = type mismatch</code>\" error.</p>\n\n<p>Note that \"<code>B3</code>\" is the field dedicated for the \"search word\" and column <code>F</code> is the column containing the text I want to search within. If the word is contained, I want to show that row and hide all rows that don't contain that word.</p>\n\n<pre><code>Sub Find_Possible_Task()\n\n  ROW_NUMBER = 0\n  SEARCH_STRING = Sheets(\"codeset\").Range(\"B3\")\n  ROW_NUMBER = ROW_NUMBER + 1\n  ITEM_IN_REVIEW = Sheets(\"codeset\").Range(\"F:F\")\n\n  If InStr(ITEM_IN_REVIEW, SEARCH_STRING) Then\n    Do\n      Cells(c.Row).EntireRow.Hidden = False\n    Loop Until ITEM_IN_REVIEW = \"\"\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>TIA!    </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1535494466, "post_id": 52066878, "comment_id": 91084116, "body": "<a href=\"https://stackoverflow.com/questions/28439376/what-is-the-default-scope-of-worksheets-and-cells-and-range/28439984#28439984\" title=\"what is the default scope of worksheets and cells and range\">stackoverflow.com/questions/28439376/&hellip;</a>  You aren&#39;t using your With block"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10286991, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OtO96VXY5nw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOg73xHl3fOacqxBN8Q8M3rv171dQ/mo/photo.jpg?sz=128", "display_name": "Dylan Fernando", "link": "https://stackoverflow.com/users/10286991/dylan-fernando"}, "edited": false, "score": 0, "creation_date": 1535564400, "post_id": 52066907, "comment_id": 91116828, "body": "Thanks so much! Works like a charm. I am also wondering if it wasn&#39;t working as well since my code wasn&#39;t aligned like the way you had it. My last end with wasn&#39;t indented aligned with the &quot;.columns&quot; section of code?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 10286991, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OtO96VXY5nw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOg73xHl3fOacqxBN8Q8M3rv171dQ/mo/photo.jpg?sz=128", "display_name": "Dylan Fernando", "link": "https://stackoverflow.com/users/10286991/dylan-fernando"}, "edited": false, "score": 0, "creation_date": 1535573919, "post_id": 52066907, "comment_id": 91121214, "body": "Alignment has nothing to do with how it works. Just looks better"}, {"owner": {"reputation": 1, "user_id": 10286991, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OtO96VXY5nw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOg73xHl3fOacqxBN8Q8M3rv171dQ/mo/photo.jpg?sz=128", "display_name": "Dylan Fernando", "link": "https://stackoverflow.com/users/10286991/dylan-fernando"}, "edited": false, "score": 0, "creation_date": 1535663565, "post_id": 52066907, "comment_id": 91161870, "body": "Thanks so much Scott!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1535494487, "creation_date": 1535494487, "answer_id": 52066907, "question_id": 52066878, "link": "https://stackoverflow.com/questions/52066878/vba-excel-macro-only-works-on-current-sheet/52066907#52066907", "title": "VBA-Excel macro only works on current sheet", "body": "<p>You need to add <code>.</code> in front of the range object that are assigned to the sheet noted in the with:</p>\n\n<pre><code>Sub roll()\n\nDim sh As Worksheet\nDim c As Range\n\n\nFor Each sh In ActiveWorkbook.Sheets\n\nWith sh\n\n    Application.ScreenUpdating = False\n\n    .Columns(\"B:AB\").Hidden = False\n\n\n        For Each c In .Range(\"b8:ab8\").Cells\n            If c.Value = \"X\" Then\n                c.EntireColumn.Hidden = True\n            End If\n        Next c\n    End With\n\nNext sh\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10286991, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OtO96VXY5nw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOg73xHl3fOacqxBN8Q8M3rv171dQ/mo/photo.jpg?sz=128", "display_name": "Dylan Fernando", "link": "https://stackoverflow.com/users/10286991/dylan-fernando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535494487, "creation_date": 1535494371, "question_id": 52066878, "link": "https://stackoverflow.com/questions/52066878/vba-excel-macro-only-works-on-current-sheet", "title": "VBA-Excel macro only works on current sheet", "body": "<p>Hi all pretty new to VBA here and I am struggling to get my macro to work on multiple sheets. I basically want to hide and unhide columns \"B-AB\" if they have an \"X\" in row 8. Currently the macro only works on the active sheet and not the active workbook. Thanks!</p>\n\n<pre><code>Sub roll()\n\nDim sh As Worksheet\nDim c As Range\n\n\nFor Each sh In ActiveWorkbook.Sheets\n\nWith sh\n\nApplication.ScreenUpdating = False\n\nColumns(\"B:AB\").Select\nSelection.EntireColumn.Hidden = False\n\n\n        For Each c In Range(\"b8:ab8\").Cells\n            If c.Value = \"X\" Then\n            c.EntireColumn.Hidden = True\n            End If\n\n        Next c\n            End With\n\nNext sh\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 4, "creation_date": 1535493052, "post_id": 52066580, "comment_id": 91083666, "body": "Where do you define and set \u201cblockDict\u201d?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1535494419, "post_id": 52066580, "comment_id": 91084101, "body": "Where and how is <code>nextBlock</code> declared?"}], "answers": [{"comments": [{"owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "edited": false, "score": 0, "creation_date": 1535560166, "post_id": 52068841, "comment_id": 91114665, "body": "There does appear to be a problem with <code>blockDict(downstreamFeatureNumber)</code>.  I&#39;ll try to isolate what&#39;s going on and revise the question as a self-contained example."}], "tags": [], "owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "is_accepted": false, "score": 1, "last_activity_date": 1535511390, "creation_date": 1535511390, "answer_id": 52068841, "question_id": 52066580, "link": "https://stackoverflow.com/questions/52066580/object-required-error-in-vba-but-im-using-set-to-assign-object/52068841#52068841", "title": "&quot;Object required&quot; error in VBA but I&#39;m using Set to assign object", "body": "<p>Clearly, the <code>blockDict(downstreamFeatureNumber)</code> Is Nothing and this is your problem. You need to qualify it before attempting to assign to <code>nextBlock</code> (if it should not happen then it is an entirely different issue-- not a VBA problem).</p>\n\n<pre><code>If isNumericNonBlank(downstreamFeatureNumber) _\n    AND (Not (blockDict(downstreamFeatureNumber) Is Nothing)) Then\n</code></pre>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "closed_date": 1535530881, "answer_count": 1, "score": 0, "last_activity_date": 1535511390, "creation_date": 1535492597, "question_id": 52066580, "link": "https://stackoverflow.com/questions/52066580/object-required-error-in-vba-but-im-using-set-to-assign-object", "closed_reason": "Not suitable for this site", "title": "&quot;Object required&quot; error in VBA but I&#39;m using Set to assign object", "body": "<p>I have this function:</p>\n\n<pre><code>Public Function nextBlock(featureBlockObj As FeatureBlock, endFeatureNumber As Variant) As FeatureBlock\n\nDim downstreamFeatureNumber As Variant\n\n'get the feature number that this endpoint connects to\ndownstreamFeatureNumber = featureBlockObj.connectedFeatureNumber(endFeatureNumber)\n\n'if it connects to a feature number, look that feature number up in blockDict\nIf isNumericNonBlank(downstreamFeatureNumber) Then\n    Set nextBlock = blockDict(downstreamFeatureNumber)\n'if it does not connect, this is the last block in the sequence\nElse\n    Set nextBlock = Nothing\nEnd If\n\nEnd Function\n</code></pre>\n\n<p><code>blockDict</code> is a Dictionary; <code>FeatureBlock</code> is a user-defined class.</p>\n\n<p>This line:</p>\n\n<pre><code>Set nextBlock = blockDict(downstreamFeatureNumber)\n</code></pre>\n\n<p>is throwing the error:</p>\n\n<pre><code>Object required.\n</code></pre>\n\n<p>I've verified the following:</p>\n\n<ul>\n<li><code>downstreamFeatureNumber</code> exists as a key in <code>blockDict</code></li>\n<li><code>blockDict(downstreamFeatureNumber)</code> is an object of type <code>FeatureBlock</code></li>\n</ul>\n\n<p>So why can't I assign the <code>blockDict()</code> reference to <code>nextBlock</code> using <code>Set</code>?</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1535489912, "post_id": 52066056, "comment_id": 91082628, "body": "Please use the <a href=\"https://stackoverflow.com/posts/52066056/edit\">edit</a> link below your question to include code examples."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1535490569, "post_id": 52066056, "comment_id": 91082881, "body": "<i>But this has caused a conflict with another best practice of using named constants</i> - huh, how?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535490688, "post_id": 52066056, "comment_id": 91082911, "body": "I think you might be confusing variables with constants"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1535490997, "post_id": 52066056, "comment_id": 91083017, "body": "@MathieuGuindon late binding Word and then trying to use the Word enum? That&#39;s all I can decipher."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1535491030, "post_id": 52066056, "comment_id": 91083028, "body": "@BigBen that&#39;s what I went and assumed below :)"}], "answers": [{"comments": [{"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 1, "creation_date": 1535556484, "post_id": 52066316, "comment_id": 91112401, "body": "Another thing I&#39;ve done in the past is use <a href=\"https://usefulgyaan.wordpress.com/2013/06/26/vba-trick-of-the-week-conditional-compiling/\" rel=\"nofollow noreferrer\">conditional compilation</a> so you won&#39;t run into issues in the future if you decide to switch to early binding and add the Word reference. You can add a conditional compilation constant like <code>USE_EARLY_BINDING</code>, and then wrap your constant declarations in conditional compilation <code>#IF</code> blocks."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1535556736, "post_id": 52066316, "comment_id": 91112595, "body": "@Zack good point - <code>#Const</code> precompiler constants are module-scope though, so they need to be <i>everywhere</i>. Better to define them at project-level =)"}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1535557208, "post_id": 52066316, "comment_id": 91112919, "body": "Yes, I would agree to define the constant at the project level."}, {"owner": {"reputation": 76, "user_id": 7679258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307b4b9d88d8dbefec74127e030b6126?s=128&d=identicon&r=PG&f=1", "display_name": "Inflorescence", "link": "https://stackoverflow.com/users/7679258/inflorescence"}, "edited": false, "score": 0, "creation_date": 1535571941, "post_id": 52066316, "comment_id": 91120313, "body": "Thank you very much for the answer! I&#39;m pretty positive you assumed the issue correctly, but I&#39;ve added code examples above just to be sure. If I&#39;m understanding it correctly, it seems like both <code>xlFalse</code> and <code>wdDoNotSaveChanges</code> are enumerated at 0, which is why there were no issues with the code&#39;s behavior.  Which is pretty scary! Hypothetically, the same thing would happen if I used <code>wdSaveChanges</code> instead, right? But it wouldn&#39;t actually save the changes. So <i>this</i> is why you&#39;re supposed to use <code>Option Explicit</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 76, "user_id": 7679258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307b4b9d88d8dbefec74127e030b6126?s=128&d=identicon&r=PG&f=1", "display_name": "Inflorescence", "link": "https://stackoverflow.com/users/7679258/inflorescence"}, "edited": false, "score": 0, "creation_date": 1535572006, "post_id": 52066316, "comment_id": 91120344, "body": "@Inflorescence I&#39;m pretty sure <code>xlFalse</code> doesn&#39;t exist anywhere. Did you mean it to be the Boolean literal value <code>False</code>? If so, it&#39;s just &quot;<code>False</code>&quot;."}, {"owner": {"reputation": 76, "user_id": 7679258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307b4b9d88d8dbefec74127e030b6126?s=128&d=identicon&r=PG&f=1", "display_name": "Inflorescence", "link": "https://stackoverflow.com/users/7679258/inflorescence"}, "edited": false, "score": 0, "creation_date": 1535572618, "post_id": 52066316, "comment_id": 91120599, "body": "To be honest, I don&#39;t know where I picked up the usage, since it&#39;s only in my project in this one section, which I wrote 2 years ago. I probably saw it on some page like <a href=\"https://www.tek-tips.com/viewthread.cfm?qid=1123584\" rel=\"nofollow noreferrer\">this</a> or <a href=\"https://www.mrexcel.com/forum/excel-questions/836134-object-variable-block-variable-not-set.html\" rel=\"nofollow noreferrer\">this</a>, since I know I&#39;ve looked for answers to both of those problems. And now I&#39;m assuming that those pages either left out the code that says <code>Const xlFalse = 0</code>, or are unknowingly causing this same late binding issue, where <code>xlFalse</code> gets evaluated to 0, anyway."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 7, "last_activity_date": 1535491004, "creation_date": 1535491004, "answer_id": 52066316, "question_id": 52066056, "link": "https://stackoverflow.com/questions/52066056/how-to-use-named-constants-with-option-explicit/52066316#52066316", "title": "How to use named constants with option explicit?", "body": "<p>If I understand correctly, you're discovering how <code>Option Explicit</code> is saving you from very serious bugs!</p>\n\n<p>If your code refuses to compile because <code>wdDoNotSaveChanges</code> is undefined, it's because the Microsoft Word object library isn't referenced (i.e. you're probably late-binding it).</p>\n\n<p>Without <code>Option Explicit</code>, VBA happily compiles, and the undefined identifiers are, at execution time, defined on-the-fly as implicit <code>Variant</code> local variables holding the default value for any <code>Variant</code> variable: <code>Empty</code>... which, when passed to a function/procedure/method that accepts an integer type, silently gets converted to a <code>0</code>, <strong>regardless of what you named it</strong>.</p>\n\n<p>Constants defined in the Word object library are not loaded if you're late-binding the Word object model, so in order to use named constants and <em>avoid magic numbers</em> (the best practice you're referring to), you need to <strong>define your own</strong> - so you hit <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.office.interop.word.wdsaveoptions?view=word-pia\" rel=\"noreferrer\">MSDN</a> (or temporarily reference the object model and hit F2 to find the values you need) and reproduce the values in your own code:</p>\n\n<pre><code>Private Enum WdSaveOptions\n    wdDoNotSaveChanges = 0 ' equivalent to Boolean value False\n    wdPromptToSaveChanges = -2\n    wdSaveChanges = -1 ' equivalent to Boolean value True\nEnd Enum\n</code></pre>\n\n<p>And now not only <code>Option Explicit</code> won't interfere, <em>your code will also work correctly</em>!</p>\n"}], "owner": {"reputation": 76, "user_id": 7679258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307b4b9d88d8dbefec74127e030b6126?s=128&d=identicon&r=PG&f=1", "display_name": "Inflorescence", "link": "https://stackoverflow.com/users/7679258/inflorescence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 52066316, "answer_count": 1, "score": 0, "last_activity_date": 1593415369, "creation_date": 1535489618, "last_edit_date": 1593415369, "question_id": 52066056, "link": "https://stackoverflow.com/questions/52066056/how-to-use-named-constants-with-option-explicit", "title": "How to use named constants with option explicit?", "body": "<p>As I am trying to conform to best practices, I'm putting <code>Option Explicit</code> at the top of my code and declaring all of my variables. But this has caused a conflict with another best practice of using named constants. What should I do?</p>\n\n<p>The first issue was with <code>xlFalse</code>; I'm not having any issues with any of the other <code>xl</code> variables, so this seems like a standalone case. But I'm not really worried about it, because I can just put in <code>False</code> and the code works. (It works, right?)</p>\n\n<pre><code>Sub GetEOP()\n\n    'Executes when the user clicks the \"Import Data\" button, imports the EOP data\n\n    GlobalDeclarations\n\n    'Open Open dialog, assigns selected file path to wordFileName\n    wordFileName = Application.GetOpenFilename(\"Rich Text Files (*.rtf), *.rtf,\" &amp; \"Word Files (*.doc;*.docx), *.doc;*.docx\", , \"EOP Table File?\")\n\n    'Stop code if the user clicks Cancel (otherwise, wordFileName would be assigned a value of \"False\")\n    If wordFileName = False Then Exit Sub\n\n    'Open the selected file in Word\n    Set wordDoc = GetObject(wordFileName)\n\n    'Copy the values of the first table in the Word document to Excel\n    With wordDoc.Tables(1)\n        For wordRow = 1 To .Rows.Count\n            For wordCol = 1 To .Columns.Count\n                EOP.Cells(wordRow, wordCol).Value = WorksheetFunction.Clean(.cell(wordRow, wordCol).Range.Text)\n            Next wordCol\n        Next wordRow\n    End With\n\n    'Close Word\n    Set wordDoc = Nothing\n\n    'Find the last row and column of the EOP sheet.\n    rw2 = EOP.Cells.Find(\"*\", after:=Range(\"A1\"), LookAt:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=xlFalse).Row 'ERROR: Variable not defined -- xlFalse\n    cl2 = EOP.Cells.Find(\"*\", after:=Range(\"A1\"), LookAt:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=xlFalse).Column 'ERROR: Variable not defined -- xlFalse\n\n    'Format EOP worksheet\n    EOP.Cells(1, 1).RowHeight = 15\n    EOP.Cells(2, 1).RowHeight = 15\n    EOP.Cells(1, 1).Resize(50, 12).Interior.Color = clrbg\n    EOP.Cells(1, 1).Resize(1, cl2).Interior.Color = clr2\n    EOP.Cells(2, 1).Resize(rw2 - 1, cl2).Interior.Color = clr1\n\nEnd Sub\n</code></pre>\n\n<p>But the more serious issue is when I'm running Word code from Excel, as in <code>wordDoc.Close savechanges:=wdDoNotSaveChanges</code>. I can just use <code>wdDoNotSaveChanges = 0</code> instead and not worry about it, but I figured there's probably a better way to handle this scenario.</p>\n\n<p>There's a huge amount of code here; the line throwing the error is all the way at the bottom, in the <code>Closes Word Document</code> chunk of code.</p>\n\n<pre><code>Sub DrillFolder(Folder)\n\n    Dim SubFolder\n    For Each SubFolder In Folder.SubFolders\n\n        'Skip Archive and Old folders\n        If InStr(UCase(SubFolder.Name), UCase(\"Archive\")) &gt; 0 Or _\n           InStr(UCase(SubFolder.Name), UCase(\"Old\")) &gt; 0 Or _\n           InStr(UCase(SubFolder.Name), UCase(\"do not use\")) &gt; 0 Then GoTo SkipFolder\n\n        DrillFolder SubFolder\n\nSkipFolder:\n    Next\n\n    Dim File\n    Dim sortFile As Worksheet\n\n    For Each File In Folder.Files\n\n        'Checks if the file name has any of these time points in it.\n        If InStr(UCase(File.Name), UCase(\"bl\")) &gt; 0 Or _\n           InStr(UCase(File.Name), UCase(\"eop\")) &gt; 0 Or _\n           InStr(UCase(File.Name), UCase(\"t2\")) &gt; 0 Or _\n           InStr(UCase(File.Name), UCase(\"t3\")) &gt; 0 Then\n\n            'Only look at RTFs\n            If File.Type = \"Rich Text Format\" Then\n\n                'Sorts the file according to the time point in the file name.\n                If InStr(UCase(File.Name), UCase(\"bl\")) &gt; 0 Then Set sortFile = Worksheets(\"Base\")\n                If InStr(UCase(File.Name), UCase(\"eop\")) &gt; 0 Then Set sortFile = Worksheets(\"EOP\")\n                If InStr(UCase(File.Name), UCase(\"t2\")) &gt; 0 Then Set sortFile = Worksheets(\"T2\")\n                If InStr(UCase(File.Name), UCase(\"t3\")) &gt; 0 Then Set sortFile = Worksheets(\"T3\")\n\n                'sortTotalRow is used to make sure that entries in one worksheet don't skew the alignment of other worksheets\n                Dim sortTotalRow As Integer\n                Select Case sortFile.Name\n\n                    Case \"Base\"\n                        sortTotalRow = baseTotalRow\n                    Case \"EOP\"\n                        sortTotalRow = eopTotalRow\n                    Case \"T2\"\n                        sortTotalRow = t2TotalRow\n                    Case \"T3\"\n                        sortTotalRow = t3TotalRow\n                    Case Else\n                        sortTotalRow = 0\n\n                End Select\n\n                        'Opens the selected file in Word\n                        Set wordDoc = wordApp.Documents.Open(File.Path)\n\n                        'Adds file information to the Import worksheet\n                        With Import.Cells(docCount + 2, 1)\n                            .Value = wordDoc\n                            .Offset(0, 1).Value = wordDoc.Tables(1).Rows.Count\n                            .Offset(0, 2).Value = sortFile.Name\n                            .Offset(0, 3).Value = wordDoc.FullName\n                        End With\n\n\n                        'Copies values of first table in document to Excel\n                        If wordDoc.Tables.Count &gt; 0 Then\nRestart:                       With wordDoc.Tables(1)\n\n                                'Combine Birth Month and Birth Year columns, if they're separate\n                               Dim i As Integer\n                               For i = 1 To .Columns.Count\n                                    If InStr(UCase(WorksheetFunction.Clean(.cell(1, i).Range.Text)), UCase(\"Birth year\")) = 1 Then\n\n                                        'Change Birth Month column to Birth Month and Year column\n                                        Dim k As Long\n                                        For k = 1 To .Rows.Count\n                                            .cell(k, i - 1).Range.Text = .cell(k, i - 1).Range.Text &amp; .cell(k, i).Range.Text\n                                        Next k\n\n                                        'Then delete the Birth Year column, so it doesn't get copied twice\n                                        .Columns(i).Delete\n                                        GoTo Restart\n\n                                    End If\n\n                                    'Delete \"describe yourself\" and \"Where are you taking this survey?\" columns\n                                    If InStr(UCase(WorksheetFunction.Clean(.cell(1, i).Range.Text)), UCase(\"describe\")) &gt; 0 Then\n                                        .Columns(i).Delete\n                                        GoTo Restart\n                                    End If\n                                    If InStr(UCase(WorksheetFunction.Clean(.cell(1, i).Range.Text)), UCase(\"taking this survey\")) &gt; 0 Then\n                                        .Columns(i).Delete\n                                        GoTo Restart\n                                    End If\n                                Next i\n\n                                'Account for Grandma code by putting in dummy values for non-Gcode rounds\n                                Dim gmaFind As Boolean\n\n                                'Check for Gma in the table\n                                With wordDoc.Range.Find\n                                    .Text = \"Grandmother\"\n                                    .MatchCase = False\n                                    gmaFind = .Execute\n                                End With\n\n                                'If you don't find it, add a column and fill it with XXX\n                                If gmaFind = True Then\n\n                                Else\n                                    .Columns.Add\n                                    For i = 1 To .Rows.Count\n                                        .cell(i, .Columns.Count).Range.Text = \"XXX\"\n                                    Next i\n                                End If\n\n\n\n                                For wordRow = 1 To .Rows.Count\n                                    For wordCol = 1 To .Columns.Count\n\n                                        'Takes off headers for the tables after the first\n                                        If sortTotalRow &lt;&gt; 0 And wordRow = 1 Then GoTo Skip\n\n                                        'Skip \"How do you describe yourself?\" column\n                                        If InStr(WorksheetFunction.Clean(.cell(1, wordCol).Range.Text), \"describe\") &gt; 0 Then GoTo Skip\n\n                                        'Skip \"Please tell us the place where you are taking this survey.\" column\n                                        If InStr(WorksheetFunction.Clean(.cell(1, wordCol).Range.Text), \"taking this survey\") &gt; 0 Then GoTo Skip\n\n                                        'If you're in the Obs column, also add in the name of the round.\n                                        If wordCol = 1 Then\n                                            sortFile.Cells(wordRow + sortTotalRow, wordCol).Value = Left(wordDoc.Name, 8) &amp; \" \" &amp; WorksheetFunction.Clean(.cell(wordRow, wordCol).Range.Text)\n                                        Else\n                                            sortFile.Cells(wordRow + sortTotalRow, wordCol).Value = WorksheetFunction.Clean(.cell(wordRow, wordCol).Range.Text)\n                                        End If\n'This is a flag\n'to tell GoTo\n'where to go.\nSkip:                               Next wordCol\n                                Next wordRow\n\n                                'Adds number of records to totalRow, so the next table appears under the previous.\n                                Select Case sortFile.Name\n\n                                    Case \"Base\"\n                                        'The -1 is accounting for the headers of the tables that have been omitted\n                                        '(otherwise it would be a blank row)\n                                        baseTotalRow = baseTotalRow + .Rows.Count - 1\n                                    Case \"EOP\"\n                                        eopTotalRow = eopTotalRow + .Rows.Count - 1\n                                    Case \"T2\"\n                                        t2TotalRow = t2TotalRow + .Rows.Count - 1\n                                    Case \"T3\"\n                                        t3TotalRow = t3TotalRow + .Rows.Count - 1\n                                    Case Else\n\n                                End Select\n\n                            End With\n                        End If\n\n                'At the end of importing, docCount is used as \"Debug.print \"Time taken to import docCount documents\"\"\n                docCount = docCount + 1\n\n                'Closes Word Document\n                'Const wdDoNotSaveChanges As Integer = 0\n                wordDoc.Close savechanges:=wdDoNotSaveChanges 'ERROR: Variable not defined -- wdDoNotSaveChanges\n\n            End If\n        End If\n\n\n    Next\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 81, "user_id": 6788055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddce7721ed011680328cac9f9cf0f9b?s=128&d=identicon&r=PG&f=1", "display_name": "Dillon_Su", "link": "https://stackoverflow.com/users/6788055/dillon-su"}, "edited": false, "score": 1, "creation_date": 1535490100, "post_id": 52066055, "comment_id": 91082706, "body": "easiest way to me seems to be to delete the cell you don&#39;t want after you copy the row.  Other than that you are going to have to loop through all cells in that row and copy them individually."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1535490039, "creation_date": 1535490039, "answer_id": 52066140, "question_id": 52066055, "link": "https://stackoverflow.com/questions/52066055/vba-copying-a-row-without-a-specific-column/52066140#52066140", "title": "VBA- Copying a Row without a specific column", "body": "<p>Try this if you know there are four cells to copy.</p>\n\n<pre><code>Source.cells(c.Row,2).resize(,4).Copy Target.cells(j,1)\n</code></pre>\n\n<p>Not sure why you have two loops? Autofilter would be more efficient as you could do away with the loops altogether.</p>\n"}], "owner": {"reputation": 3, "user_id": 10251748, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JEKIRJ_wN-Y/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOCYBKRP7MFtzPK3sy2ClvLoXvZHQ/mo/photo.jpg?sz=128", "display_name": "Camilo Matamoros", "link": "https://stackoverflow.com/users/10251748/camilo-matamoros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 52066140, "answer_count": 1, "score": 0, "last_activity_date": 1535490278, "creation_date": 1535489617, "last_edit_date": 1535489908, "question_id": 52066055, "link": "https://stackoverflow.com/questions/52066055/vba-copying-a-row-without-a-specific-column", "title": "VBA- Copying a Row without a specific column", "body": "<p>I have a code that will copy a row based on an abbreviation and send it to another excel sheet starting at a certain cell. I need the code to not copy the abbreviation and just the rest of the row. How can I fix my code for it to do this. The column I need excluded is Column A </p>\n\n<p>Table? Data \n<img src=\"https://i.stack.imgur.com/NSvsq.jpg\" alt=\"enter image description here\"></p>\n\n<p>Here is the code:</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\nDim c As Range\nDim j As Integer\nDim Source As Worksheet\nDim Target As Worksheet\n\n' Change worksheet designations as needed\nSet Source = ActiveWorkbook.Worksheets(\"Sheet1\")\nSet Target = ActiveWorkbook.Worksheets(\"Sheet2\")\n\nj = 11     ' Start copying to row # in target sheet\nFor Each c In Source.Range(\"A1:A1000\")   ' range of the running log input\n    If c = \"PP\" Then\n     Source.Rows(c.Row).Copy Target.Rows(j) ' where i think problem is\n       j = j + 1 ' makes it paste to the next open row\n\n    End If\nNext c\n\n j = 30\nFor Each c In Source.Range(\"A1:A1000\")\n    If c = \"FA\" Then\n     Source.Rows(c.Row).Copy Target.Rows(j)\n       j = j + 1\n\n    End If\nNext c\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1535489125, "post_id": 52065941, "comment_id": 91082330, "body": "This would be better suited to <a href=\"https://codereview.stackexchange.com\">Code Review</a>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1535490378, "post_id": 52065941, "comment_id": 91082810, "body": "@mark  your Q is not off topic on SO, so please don&#39;t feel you have to move it to CR.  But if you do, please read their help first  they have different rules"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1535491209, "post_id": 52065941, "comment_id": 91083079, "body": "BTW a simple array formula will do this without the need for vba: <code>=AND(ISNUMBER(SEARCH({&quot;red&quot;,&quot;white&quot;,&quot;blue&quot;},A1)))</code> and <code>=AND(ISNUMBER(SEARCH(B1:B3,A1)))</code> confirmed with Ctrl-Shift-Enter instead of Enter when exiting edit mode."}, {"owner": {"reputation": 7, "user_id": 1290451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff639e576fffbc74a387d93522d00ca8?s=128&d=identicon&r=PG", "display_name": "Mark Main", "link": "https://stackoverflow.com/users/1290451/mark-main"}, "edited": false, "score": 0, "creation_date": 1535563986, "post_id": 52065941, "comment_id": 91116632, "body": "This is very interesting, I&#39;ve not seen ISNUMBER() used with AND with multiple search text. I notice this also works with using OR, XOR and NOT operators in place of the AND operator. Thanks for sharing this."}, {"owner": {"reputation": 7, "user_id": 1290451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff639e576fffbc74a387d93522d00ca8?s=128&d=identicon&r=PG", "display_name": "Mark Main", "link": "https://stackoverflow.com/users/1290451/mark-main"}, "edited": false, "score": 0, "creation_date": 1535590411, "post_id": 52065941, "comment_id": 91125983, "body": "I want to add to my comment: use of the NOT operator did not provide results that I could figure out.  The AND operator is True when ALL of the search words are found; OR operator is True for 1 or more matches; XOR was True for an odd number of matches. If you want to check for None (no matches) then a NOT of the OR formula above would handle this, and the NOT of the XOR formula would provide True for even numbered matches."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1535510142, "last_edit_date": 1535510142, "creation_date": 1535490384, "answer_id": 52066195, "question_id": 52065941, "link": "https://stackoverflow.com/questions/52065941/excel-vba-function-needs-to-receive-either-a-hardcoded-paramarray-list-or-range/52066195#52066195", "title": "Excel VBA Function needs to receive either a hardcoded ParamArray list or Range", "body": "<p>Sadly, VBA does not have anything like function/method overloads.</p>\n\n<p>I have not tested this, but I think it should work for the two specific cases (<em>either</em> a paramarray of string literal, or a single range object):</p>\n\n<pre><code>Function AndSearch1(ByRef target As Range, ParamArray searchList() As Variant) As Boolean\n    'AND Boolean logic search using a hardcoded list\n    Dim i As Long\n    Dim myArray as Variant\n    myArray = searchList\n    If UBound(searchList) = 0 Then\n        If TypeName(searchList(0)) = \"Range\" Then\n             If searchList(0).Rows.Count = 1 and searchList(0).Columns.Count &gt; 1 Then\n                 myArray = Application.Transpose(Application.Transpose(searchList(0).Value))\n             ElseIf searchList(0).Rows.Count &gt; 1 and searchList(0).Columns.Count = 1 Then\n                 myArray = searchList(0).Value\n             Else\n                 'you'd need additional logic to handle 2-dimensional ranges\n             End If             \n        End If\n    End If\n    For Each cell In myArray # iterate the myArray instead of the searchList\n</code></pre>\n\n<p>NOTE: I don't think this will work (but could be revised to handle different edge cases) if you pass a <code>ParamArray</code> of ranges, like:</p>\n\n<pre><code>=AndSearch1(\"A1:B1\",\"C2:C15\")\n</code></pre>\n\n<p>Nor if it's a 2-dimensional range. </p>\n\n<pre><code>=AndSearch1(\"A1:D4\")\n</code></pre>\n\n<p>But it could be adapted for those cases, the idea is to just take <em>whatever</em> argument(s) the function receives, and assign them to an appropriately iterable one-dimensional Variant.</p>\n"}], "owner": {"reputation": 7, "user_id": 1290451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff639e576fffbc74a387d93522d00ca8?s=128&d=identicon&r=PG", "display_name": "Mark Main", "link": "https://stackoverflow.com/users/1290451/mark-main"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1591099119, "creation_date": 1535489013, "last_edit_date": 1591099119, "question_id": 52065941, "link": "https://stackoverflow.com/questions/52065941/excel-vba-function-needs-to-receive-either-a-hardcoded-paramarray-list-or-range", "title": "Excel VBA Function needs to receive either a hardcoded ParamArray list or Range", "body": "<pre><code>Function AndSearch1(ByRef target As Range, ParamArray searchList() As Variant) As Boolean\n    'AND Boolean logic search using a hardcoded list\n    Dim i As Long\n    For Each cell In searchList\n        i = InStr(target.Value, cell): If i = 0 Then AndSearch1 = False: Exit Function\n    Next\n    AndSearch1 = True\nEnd Function\n\nFunction AndSearch2(ByRef target As Range, ByRef searchList As Range) As Boolean\n    'AND Boolean logic search using a list Range\n    Dim i As Long\n    For Each cell In searchList\n        i = InStr(target.Value, cell): If i = 0 Then AndSearch2 = False: Exit Function\n    Next\n    AndSearch2 = True\nEnd Function\n</code></pre>\n\n<p>\n<p>\nThe following will work fine within Excel:</p>\n\n<pre><code>=AndSearch1(A1,\"red\",\"white\",\"blue\")\n</code></pre>\n\n<p>where red, white and blue are within cells B1:B3</p>\n\n<pre><code>=AndSearch2(A1,B1:B3)\n</code></pre>\n\n<p>But is it possible to code a single AndSearch function so that it can receive either the hardcoded strings or the Range?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 3, "last_activity_date": 1535488844, "creation_date": 1535488844, "answer_id": 52065908, "question_id": 52065782, "link": "https://stackoverflow.com/questions/52065782/adjust-values-as-they-are-being-stored-in-vba-array/52065908#52065908", "title": "Adjust Values As They Are Being Stored In VBA Array", "body": "<p>You can do it like this, but easier to use pastespecial (multiply or divide).</p>\n\n<pre><code>Sub x()\n\nDim v As Variant, i As Long\n\nv = Range(\"A2:A6\").Value\n\nFor i = LBound(v) To UBound(v)\n    v(i, 1) = v(i, 1) * 0.01\n    Debug.Print v(i, 1)\nNext i\n\nRange(\"A2:A6\").Value = v\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "edited": false, "score": 0, "creation_date": 1535489500, "post_id": 52065981, "comment_id": 91082481, "body": "thanks - your &quot;B2&quot; here:<code>sht.Range(&quot;B2&quot;).Resize</code> I had to change to &quot;A2&quot; to fit with the example.  But this works well and is much cleaner. Cheers!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "edited": false, "score": 1, "creation_date": 1535489646, "post_id": 52065981, "comment_id": 91082539, "body": "That was just an example - added a second snippet to address your specific question."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1535489757, "post_id": 52065981, "comment_id": 91082578, "body": "Tim, as I&#39;m not very familiar with .Parent (I thought it was part of Chart Objects), is there a particular reason to use it in the array?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1535490412, "post_id": 52065981, "comment_id": 91082822, "body": "The <code>Parent</code> of a <code>Range</code> Object is the containing worksheet: it&#39;s important when using <code>Evaluate</code> to use the correct context for the formula being evaluated, otherwise it will default to the Activesheet.  That&#39;s not important here (since we&#39;re working on the ActiveSheet anyway) but it&#39;s good practice never to rely on defaults and instead always be specific.  Note you can use <code>.Worksheet</code> instead of <code>.Parent</code> - it means the same thing in this case."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1535644783, "post_id": 52065981, "comment_id": 91153160, "body": "@TimWilliams thanks for the rundown!  i think i may have a few specific uses for that offhand..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1535489601, "last_edit_date": 1535489601, "creation_date": 1535489172, "answer_id": 52065981, "question_id": 52065782, "link": "https://stackoverflow.com/questions/52065782/adjust-values-as-they-are-being-stored-in-vba-array/52065981#52065981", "title": "Adjust Values As They Are Being Stored In VBA Array", "body": "<p>Here's a \"no loop\" approach:</p>\n\n<pre><code>Sub Tester()\n\n    Dim arr, rngSrc As Range, sht As Worksheet\n\n    Set sht = ActiveSheet\n\n    Set rngSrc = sht.Range(\"A2:A6\")\n\n    arr = rngSrc.Parent.Evaluate(rngSrc.Address() &amp; \" * 10\") '&lt;&lt; returns an array\n\n    sht.Range(\"B2\").Resize(UBound(arr, 1), UBound(arr, 2)).Value = arr\n\nEnd Sub\n</code></pre>\n\n<p>For your specific case:</p>\n\n<pre><code>With Range(\"A2:A6\")\n    .Value = .Parent.Evaluate(.Address &amp; \" * 0.01\")\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1535489435, "creation_date": 1535489435, "answer_id": 52066024, "question_id": 52065782, "link": "https://stackoverflow.com/questions/52065782/adjust-values-as-they-are-being-stored-in-vba-array/52066024#52066024", "title": "Adjust Values As They Are Being Stored In VBA Array", "body": "<p>Was working on this as I saw Tim post... similar use of evaluate, but doesn't need an additional array or loop:</p>\n\n<pre><code>Dim rng As Range, lr As Long\nlr = Cells(Rows.Count, 1).End(xlUp).Row\nSet rng = Range(Cells(1, 1), Cells(lr, 1))\nrng = Evaluate(rng.Address &amp; \"*0.01\")\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1535490644, "creation_date": 1535490644, "answer_id": 52066244, "question_id": 52065782, "link": "https://stackoverflow.com/questions/52065782/adjust-values-as-they-are-being-stored-in-vba-array/52066244#52066244", "title": "Adjust Values As They Are Being Stored In VBA Array", "body": "<p>Perhaps you should collect the values first and process the adjustment(s) in memory.</p>\n\n<pre><code>dim i as long, arr as variant\n\nwith worksheets(\"sheet1\")\n\n    arr = .range(.cells(2, \"A\"), .cells(.rows.count, \"A\").end(xlup)).value2\n\n    for i=lbound(arr, 1) to ubound(arr, 1)\n        arr(i, 1) = arr(i, 1)/100\n    next i\n\n    for i=lbound(arr, 1) to ubound(arr, 1)\n        debug.print arr(i, 1)\n    next i\n\n    .cells(1, \"K\").resize(ubound(arr, 1), ubound(arr, 2)) = arr\n    .cells(1, \"L\").resize(ubound(arr, 2), ubound(arr, 1)) = application.transpose(arr)\n\nend with\n</code></pre>\n"}], "owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 52065981, "answer_count": 4, "score": 0, "last_activity_date": 1535490644, "creation_date": 1535488254, "question_id": 52065782, "link": "https://stackoverflow.com/questions/52065782/adjust-values-as-they-are-being-stored-in-vba-array", "title": "Adjust Values As They Are Being Stored In VBA Array", "body": "<p>I am trying to write Column A to an array and while passing into the array or when writing the array to the sheet, I would like to multiple each value stored by a set number (specifically .01).  I will be writing the array back over the same column it was set from.</p>\n\n<p>Ex.\nSheet before macro:</p>\n\n<pre><code>Col A     Col B     Col C\nHeader    Header    Header\n100\n50\n50\n40\n100\n</code></pre>\n\n<p>Sheet after macro:</p>\n\n<pre><code>Col A     Col B     Col C\nHeader    Header    Header\n1\n.5\n.5\n.4\n1\n</code></pre>\n\n<p>So far I have been working off a basic array portion of code from a tutorial I saw online shown below:</p>\n\n<pre><code>Sub ArrayTest\nDim Arr() As Variant\nArr = Range(\"A1:A6\")\nDim R As Long\nDim C As Long\n  For R = 1 To UBound(Arr, 1) ' First array dimension is rows.\n  For C = 1 To UBound(Arr, 2) ' Second array dimension is columns.\n   Debug.Print Arr(R, C)\nNext C\nNext R\n\n'resize range array will be written to\nDim Destination As Range\n  Set Destination = Range(\"K1\")\nDestination.Resize(UBound(Arr, 1), UBound(Arr, 2)).Value = Arr\n\n'transpose / write array to range\nSet Destination = Range(\"A1\")\nDestination.Resize(UBound(Arr, 2), UBound(Arr, 1)).Value = Application.Transpose(Arr)\n</code></pre>\n\n<p>End Sub</p>\n\n<p>This code has no errors, but I'm unsure of where / how I can \"manipulate\" the values (either on the way into the array or on the way back to the sheet).  </p>\n\n<p>An array may not even be the best way to achieve this overall goal of overwriting a columns values with itself multiplied by a another number.  I know I could write the column to a dummy sheet, do the calculation then move back over the original sheet and column, but I was trying to find something cleaner and potentially faster than that.  This is also a simplified example, my actual data set is much larger and more variable, but for the ease of discussion I created this example.</p>\n\n<p>Any advice is much appreciated!</p>\n"}, {"tags": ["email", "ms-access", "pdf", "vba", "report"], "answers": [{"tags": [], "owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "is_accepted": true, "score": 0, "last_activity_date": 1535517508, "creation_date": 1535517508, "answer_id": 52069576, "question_id": 52065729, "link": "https://stackoverflow.com/questions/52065729/send-each-user-their-own-individual-emailed-pdf-report-in-access/52069576#52069576", "title": "send each user their own individual emailed PDF report in Access", "body": "<p>Your account number is a String <strong>1RV80014</strong> and your <code>Where condition:=\"AccountNumber = \" &amp; !AccountNumber</code> states an Integer. So change it to a String <code>Where condition:= \"AccountNumber = '\" &amp; !AccountNumber &amp; \"'\"</code> </p>\n"}], "owner": {"reputation": 15, "user_id": 10286667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4785a3993d8018642b3e5bdb1cfbc072?s=128&d=identicon&r=PG&f=1", "display_name": "bobby", "link": "https://stackoverflow.com/users/10286667/bobby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 52069576, "answer_count": 1, "score": 0, "last_activity_date": 1536051405, "creation_date": 1535487960, "last_edit_date": 1536051405, "question_id": 52065729, "link": "https://stackoverflow.com/questions/52065729/send-each-user-their-own-individual-emailed-pdf-report-in-access", "title": "send each user their own individual emailed PDF report in Access", "body": "<p>I've looked up the following code from another question on this site and have tried to apply it to my own, to no avail - I am trying to email out a pdf of my report to each user with only their specific information contained therein. If there are 15 users, then there will be 15 different emails sent out containing only their info. any help is very much appreciated.</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Option Compare Database\n\n\nSub Mac1()\nDim rsAccountNumber As DAO.Recordset\n\nSet rsAccountNumber = CurrentDb.OpenRecordset( _\n    \"SELECT DISTINCT AccountNumber FROM UnAffirmed_Report_for_En Query\")\n\nWith rsAccountNumber\n\n    Do Until .EOF\n\n        DoCmd.OpenReport \"Unaffirmed Report\", _\n            acViewPreview, _\n            WhereCondition:=\"AccountNumber = \" &amp; !AccountNumber, _\n            WindowMode:=acHidden\n\n        DoCmd.OutputTo acOutputReport, _\n            \"Unaffirmed Report\", _\n            acFormatPDF, _\n            \"C:\\users\\rv\\folder_name\" &amp; !AccountNumber &amp; \".pdf\"\n\n        DoCmd.Close acReport, \"Unaffirmed Report\", acSaveNo\n\n        .MoveNext\n\n    Loop\n\n    .Close\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>when I do though, I receive Run-time error '3075':</p>\n\n<blockquote>\n  <p>Syntax error (missing operator) in query expression 'AccountNumber = 1RV80014'</p>\n</blockquote>\n\n<p>the account # is valid, but not sure why I am getting stuck here or how to fix it - super newbe to this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535489223, "post_id": 52065662, "comment_id": 91082372, "body": "Did you perhaps mean Filename:=FolderPath &amp; thisFile2.Value ?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535489276, "post_id": 52065662, "comment_id": 91082393, "body": "@QHarr must be, now I get your answer. <code>B2:B5</code> all have the same value so the PDF is getting overwritten each time."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1535489364, "post_id": 52065662, "comment_id": 91082424, "body": "I&#39;m losing the plot with tiredness myself :-)"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1535492244, "last_edit_date": 1535492244, "creation_date": 1535488705, "answer_id": 52065881, "question_id": 52065662, "link": "https://stackoverflow.com/questions/52065662/loop-through-data-to-populate-form-and-export-to-individual-pdfs/52065881#52065881", "title": "Loop through Data to Populate Form and Export to individual PDFs", "body": "<p>Perhaps you need to use <code>thisFile2</code> in the loop.</p>\n\n<pre><code>For i = 2 To 5\n        Set thisFile2 = dataWS.Range(\"A\" &amp; i)\n\n         Worksheets(\"PAF Form\").ExportAsFixedFormat _\n        Type:=xlTypePDF, Filename:=FolderPath &amp; thisFile2.Value &amp; \".pdf\", _\n        openafterpublish:=False, ignoreprintareas:=False\n\nNext\n</code></pre>\n\n<p>As <code>formWS.Range(\"B16:I16\")</code>  is a merged then the <code>Countif</code> test should actually be <code>=1</code> or, as @BigBen points out, simply <code>If formWS.Range(\"B16\") = \"Coordinator\" Then \"East Quad\"</code></p>\n"}], "owner": {"reputation": 65, "user_id": 8807114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c77cc8fe622c7e0a6921c9c987779a?s=128&d=identicon&r=PG&f=1", "display_name": "ChunkyFresh", "link": "https://stackoverflow.com/users/8807114/chunkyfresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 52065881, "answer_count": 1, "score": 0, "last_activity_date": 1535492244, "creation_date": 1535487648, "last_edit_date": 1535489051, "question_id": 52065662, "link": "https://stackoverflow.com/questions/52065662/loop-through-data-to-populate-form-and-export-to-individual-pdfs", "title": "Loop through Data to Populate Form and Export to individual PDFs", "body": "<p>I posted a question about this recently, but I didn't provide a full scope of what I was trying to do. Thank you to whoever helped me out the first time!</p>\n\n<p>Here is what I'm trying to do.</p>\n\n<p>I'm trying to populate a form with data from another sheet. The code below runs. However, when I look at the folder where the files would be placed in, I only get one file. I should see 4 files as I'm intending with For i = 2 To 5. </p>\n\n<p><a href=\"https://i.stack.imgur.com/NKcfu.jpg\" rel=\"nofollow noreferrer\">Form</a>\n<a href=\"https://i.stack.imgur.com/xqPKF.jpg\" rel=\"nofollow noreferrer\">Data</a></p>\n\n<p>Things to note: \nData from Column A populates Range(\"B4:I4\") &lt;--- Cell of Name in Form. \nData from Column B populates Range(\"B16:I16\") &lt;--- Cell of Job Title in Form. </p>\n\n<pre><code>Sub FormPop_Export_Click()\nDim i As Long\nDim Building_Location As String\nDim dataWS As Worksheet, formWS As Worksheet\nDim thisFile As Range, destRange As Range\nDim thisFile2 As Range, destRange2 As Range\n\n\nFolderPath = \"C:\\Users\\Lenovo\\Documents\\PAF_Output\\\"\n\nMkDir FolderPath\n\nSet dataWS = Sheets(\"Data\")\nSet formWS = Sheets(\"Form\")\nFor i = 2 To 5\nSet thisFile2 = dataWS.Range(\"A\" &amp; i)\nSet destRange2 = formWS.Range(\"B4:I4\")\nthisFile2.Copy destRange2\n\nSet thisFile = dataWS.Range(\"B\" &amp; i)\nSet destRange = formWS.Range(\"B16:I16\")\nthisFile.Copy destRange\n\n\nIf WorksheetFunction.CountIf(formWS.Range(\"B16:I16\"), \"Coordinator\") = \ndestRange.Cells.Count Then\n    Building_Location = \"East Quad\"\nElse\n    Building_Location = \"\"\nEnd If\nformWS.Range(\"D14:H14\").Value = Building_Location\n\n\nSheets(Array(\"Form\")).Select\nActiveSheet.ExportAsFixedFormat _\nType:=xlTypePDF, FileName:=FolderPath &amp; thisFile &amp; \".pdf\", _\nopenafterpublish:=False, ignoreprintareas:=False\n\nNext i\n\nMsgBox \"All PDF's have been exported to folder.\"\n\n\nEnd Sub\n</code></pre>\n\n<p>May I ask for someone's help with this? I'm ripping my hair out!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 3033348, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1219749925/picture?type=large", "display_name": "user3033348", "link": "https://stackoverflow.com/users/3033348/user3033348"}, "edited": false, "score": 0, "creation_date": 1535554869, "post_id": 52068291, "comment_id": 91111241, "body": "Had tried that nosave (acSaveNo). Didn&#39;t work. I also tried Cancel = True. No luck. For checking the SSN, I can move the part that checks if it&#39;s in system to AfterUpdate, but for part that checks if it&#39;s blank, it&#39;s blank so there&#39;s no update... I want it to check right away if it&#39;s blank when the user exits the SSN field to make sure the user typed something in that field so they don&#39;t enter a bunch of data that already exists. Make sense?  How to get the stupid Cancel to work if they don&#39;t type anything in SSN field.. Any other ideas? Thanks!"}, {"owner": {"reputation": 7, "user_id": 10174282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6c47c586ce9e6bbb2961c6fe7fcca15?s=128&d=identicon&r=PG&f=1", "display_name": "Grunkle Stan", "link": "https://stackoverflow.com/users/10174282/grunkle-stan"}, "reply_to_user": {"reputation": 123, "user_id": 3033348, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1219749925/picture?type=large", "display_name": "user3033348", "link": "https://stackoverflow.com/users/3033348/user3033348"}, "edited": false, "score": 0, "creation_date": 1535598091, "post_id": 52068291, "comment_id": 91127488, "body": "Leave the code out of the onExit. That&#39;s causing the issue.  Instead a loop in the AfterUpdate event of the same text box that prompts the user if they want to leave the field blank. &amp; warns them of the issue. on cancel click; You may wish to check for duplicate SSN if there is such a thing. check if the me.dirty property is true;  Yes : confirm exit or continue editing  No : drop it like a hot potato and close out the form. with me.undo and a NoSave just for kicks. \u2013 and before saving the record... do another check. to see if txtSSN is blank."}, {"owner": {"reputation": 123, "user_id": 3033348, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1219749925/picture?type=large", "display_name": "user3033348", "link": "https://stackoverflow.com/users/3033348/user3033348"}, "edited": false, "score": 0, "creation_date": 1535644593, "post_id": 52068291, "comment_id": 91153020, "body": "If I put the code in AfterUpdate, if the field is blank it does not trigger anything to run, so it doesn&#39;t give an error if the SSN is blank asking what the user wants to do.  I think it&#39;s because a blank field wasn&#39;t updated, so there&#39;s no after update.  I&#39;ve been playing with this so much.  There has to be a way to do it!  Thanks for all your help!"}, {"owner": {"reputation": 7, "user_id": 10174282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6c47c586ce9e6bbb2961c6fe7fcca15?s=128&d=identicon&r=PG&f=1", "display_name": "Grunkle Stan", "link": "https://stackoverflow.com/users/10174282/grunkle-stan"}, "reply_to_user": {"reputation": 123, "user_id": 3033348, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1219749925/picture?type=large", "display_name": "user3033348", "link": "https://stackoverflow.com/users/3033348/user3033348"}, "edited": false, "score": 0, "creation_date": 1535683223, "post_id": 52068291, "comment_id": 91166255, "body": "@user3033348 on the Form_BeforeUpdate; you could have a bit of code to ensure that the txtSSN is filled before it can save. With error message and setfocus to the point after it exits"}, {"owner": {"reputation": 123, "user_id": 3033348, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1219749925/picture?type=large", "display_name": "user3033348", "link": "https://stackoverflow.com/users/3033348/user3033348"}, "edited": false, "score": 0, "creation_date": 1536163710, "post_id": 52068291, "comment_id": 91328588, "body": "I moved the code to go with the field txtSSN.  So it fills in before running Before Update code, on Key Down, I have it fill in txtSSN with 000000000 - works. But the Before Update code doesn&#39;t run.  I&#39;ve been researching the order that the Events run in, and it should work.  Key Down 1st, and then Before Update 2nd.  Any suggestions?"}, {"owner": {"reputation": 7, "user_id": 10174282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6c47c586ce9e6bbb2961c6fe7fcca15?s=128&d=identicon&r=PG&f=1", "display_name": "Grunkle Stan", "link": "https://stackoverflow.com/users/10174282/grunkle-stan"}, "reply_to_user": {"reputation": 123, "user_id": 3033348, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1219749925/picture?type=large", "display_name": "user3033348", "link": "https://stackoverflow.com/users/3033348/user3033348"}, "edited": false, "score": 0, "creation_date": 1536193789, "post_id": 52068291, "comment_id": 91339467, "body": "Perhaps a check against existing SSN in the database to see if such an SSN is already in the database. Sounds like you got this beat !"}, {"owner": {"reputation": 123, "user_id": 3033348, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1219749925/picture?type=large", "display_name": "user3033348", "link": "https://stackoverflow.com/users/3033348/user3033348"}, "edited": false, "score": 0, "creation_date": 1536682023, "post_id": 52068291, "comment_id": 91508112, "body": "Already do that just didn&#39;t show code.  Thanks everyone for your help but I&#39;m giving up.  I changed it so it says that the SSN can&#39;t be blank and just goes to the SSN field.  If the user wants to cancel, they could just hit the cancel button.  One more step for the user, but 3 forums later, we can&#39;t figure it out.  I appreciate all your suggestions!"}, {"owner": {"reputation": 7, "user_id": 10174282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6c47c586ce9e6bbb2961c6fe7fcca15?s=128&d=identicon&r=PG&f=1", "display_name": "Grunkle Stan", "link": "https://stackoverflow.com/users/10174282/grunkle-stan"}, "reply_to_user": {"reputation": 123, "user_id": 3033348, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1219749925/picture?type=large", "display_name": "user3033348", "link": "https://stackoverflow.com/users/3033348/user3033348"}, "edited": false, "score": 0, "creation_date": 1536715912, "post_id": 52068291, "comment_id": 91520644, "body": "@user3033348 You could have a counter to see how many times the User left the SSN blank. A different message for every attempt to leave the SSN field blank is increasing in urgency. eg You really shouldn&#39;t leave it blank.... I can&#39;t accept a blank SSN ....... and If you leave it blank there is no point of using this form. and once they hit the limit close the form out."}], "tags": [], "owner": {"reputation": 7, "user_id": 10174282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6c47c586ce9e6bbb2961c6fe7fcca15?s=128&d=identicon&r=PG&f=1", "display_name": "Grunkle Stan", "link": "https://stackoverflow.com/users/10174282/grunkle-stan"}, "is_accepted": false, "score": 0, "last_activity_date": 1535508277, "last_edit_date": 1535508277, "creation_date": 1535506257, "answer_id": 52068291, "question_id": 52065037, "link": "https://stackoverflow.com/questions/52065037/when-click-cancel-button-on-form-do-not-run-on-exit-code-on-a-field/52068291#52068291", "title": "When click Cancel button on form, do not run On Exit code on a field", "body": "<p>OnExit events occur everytime you leave the textbox, even a simple tab or click to go to another combo box or select some text will trigger it. \nYou may want to try the code in the AfterUpdates. </p>\n\n<p>and try a ,nosave after the close form command... </p>\n\n<p>In addition, any checks to ensure a field is filled/has data is usually encouraged to be performed in the Form_BeforeUpdate section... Or so I have been advised</p>\n"}], "owner": {"reputation": 123, "user_id": 3033348, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1219749925/picture?type=large", "display_name": "user3033348", "link": "https://stackoverflow.com/users/3033348/user3033348"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594629849, "creation_date": 1535484665, "last_edit_date": 1594629849, "question_id": 52065037, "link": "https://stackoverflow.com/questions/52065037/when-click-cancel-button-on-form-do-not-run-on-exit-code-on-a-field", "title": "When click Cancel button on form, do not run On Exit code on a field", "body": "<p>On my form, the first field has to be entered, so I have an On Exit command.  Since it also checks to see if the value exists in my table, I want it to check right away - is it blank (thus require data to be put into field) OR does it already exist.  My question has to do with the first part - is it blank.</p>\n\n<p>On this form, I also have a Cancel button.  When the user click Cancel, I want it to close the form without saving any of the data.</p>\n\n<p>Problem - If the user doesn't enter anything in the first field and clicks Cancel, it's running the On Exit code requiring data to be entered into the first field - which they don't have to because they are cancelling.  I'm getting a Run-time error '2585'.</p>\n\n<p>Is there anyway to have the Cancel code stop the On Exit code from running? Any other ideas?  </p>\n\n<p>Here is my code for Cancel:</p>\n\n<pre><code>Private Sub CancelFormButton_Click()\n  Me.Undo\n  DoCmd.OpenForm \"fmuMainMenu\"\n  DoCmd.Close acForm, \"frmVetNewMainForm\"\nEnd Sub\n</code></pre>\n\n<p>Here is part of my On Exit code for the field:</p>\n\n<pre><code>If IsNull(Me.txtSSN) Then\n\n  strMsg = \"Social Security Number Must Not Be Left Blank!\" &amp; vbCrLf\n  strMsg = strMsg &amp; \"Do you want to add new veteran's record?\" &amp; vbCrLf\n\n  If MsgBox(strMsg, vbQuestion + vbYesNo, \"Go to Record?\") = vbYes Then\n\n    Me.txtSSN.SetFocus\n    Exit Sub\n\n  Else\n\n    Me.Undo\n    DoCmd.OpenForm \"fmuMainMenu\"\n    DoCmd.Close acForm, \"frmVetNewMainForm\"\n\n  End If\n\nElse\n  'RUNS THE REST OF CODE\nEnd if\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 6, "creation_date": 1535484362, "post_id": 52064919, "comment_id": 91080426, "body": "Get rid of the space after the <code>E</code>."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1535484450, "creation_date": 1535484450, "answer_id": 52064984, "question_id": 52064919, "link": "https://stackoverflow.com/questions/52064919/variable-syntax-inside-formula-vba-excel/52064984#52064984", "title": "Variable Syntax Inside Formula VBA Excel", "body": "<p>Something like</p>\n\n<pre><code> Range(\"E\" &amp; (i + 2) &amp; \":AL\" &amp; (i + 2)).Formula = \"=sum(E49:E\" &amp; (i + 3) &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1535532887, "accepted_answer_id": 52064984, "answer_count": 1, "score": 0, "last_activity_date": 1535484450, "creation_date": 1535484086, "question_id": 52064919, "link": "https://stackoverflow.com/questions/52064919/variable-syntax-inside-formula-vba-excel", "closed_reason": "Not suitable for this site", "title": "Variable Syntax Inside Formula VBA Excel", "body": "<p>This one has me stumped. Syntax inside the sum formula is throwing an object error. According to what I read, it should work, but I'm missing something. Anyone know what's wrong? Thanks for your help!</p>\n\n<pre><code>Range(\"E\" &amp; (i + 2) &amp; \":AL\" &amp; (i + 2)).Formula = \"=sum(E49:E \" &amp; (i + 3) &amp; \")\"\n</code></pre>\n"}]